         TITLE '*********** IDCDL01:  DELETE FUNCTION SUPPORT ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCDL01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCDL01   78.251'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         USING @PSTART,@12                                         0002 00024000
         USING @PSTART+4095,@11                                    0002 00025000
         USING @PSTART+8190,@10                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @09,@01                                             0002 00029000
         USING @DATD,@09                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @09,8(,@13)                                         0002 00033000
         LR    @13,@09                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
*                                      /*CATALOG WORK AREA   @Y30SSFR*/ 00036000
*                                                                  0259 00037000
*        /************************************************************/ 00038000
*        /*                                                          */ 00039000
*        /*  THIS IS THE CENTRAL SECTION OF THE DELETE ROUTINE.      */ 00040000
*        /*  THIS SECTION PERFORMS INITIALIZATION AND TERMINATION    */ 00041000
*        /*  FUNCTIONS AND ROUTES CONTROL AMONG THE SUB-PROCEDURES.  */ 00042000
*        /*  ALL EXITS FROM THE DELETE ROUTINE OCCUR FROM HERE       */ 00043000
*        /*                                                          */ 00044000
*        /************************************************************/ 00045000
*                                                                  0259 00046000
*        OLDERID2 = NEWERID2;                                      0259 00047000
         L     @08,@PC00001                                        0259 00048000
         L     @15,GDTTR2(,@08)                                    0259 00049000
         MVC   @TS00001(95),NEWERID2(@15)                          0259 00050000
         MVC   OLDERID2(95,@15),@TS00001                           0259 00051000
*        NEWID2 = 'DLBG';                                          0260 00052000
*                                                                  0260 00053000
         MVC   NEWID2(4,@15),@CC00940                              0260 00054000
*        IF GDTDBG = NULLPTR                                       0261 00055000
*          THEN;                                                   0261 00056000
         L     @08,GDTDBG(,@08)                                    0261 00057000
         LTR   @08,@08                                             0261 00058000
         BZ    @RT00261                                            0261 00059000
*          ELSE                                                    0263 00060000
*            CALL IDCDB010 (GDTTBL,'DLBG');                        0263 00061000
*                                                                  0263 00062000
         L     @08,@PC00001                                        0263 00063000
         ST    @08,@AL00001                                        0263 00064000
         LA    @15,@CC00940                                        0263 00065000
         ST    @15,@AL00001+4                                      0263 00066000
         MVI   @AL00001+4,X'80'                                    0263 00067000
         L     @15,GDTDBG(,@08)                                    0263 00068000
         LA    @01,@AL00001                                        0263 00069000
         BALR  @14,@15                                             0263 00070000
*        /************************************************************/ 00071000
*        /*                                                          */ 00072000
*        /*  INITIALIZE PRINT ARGUMENT LIST AND CATALOG PARAMETER    */ 00073000
*        /*  LIST POINTERS AND REMOVE THE CATALOG DNAME PTR  @YL026UA*/ 00074000
*        /*  SO THE CATALOG CAN BE DYNAMICALLY ALLOCATED BY  @YL026UA*/ 00075000
*        /*  VSAM CATALOG MGMT.                              @YL026UA*/ 00076000
*        /*                                                  @YL026UA*/ 00077000
*        /************************************************************/ 00078000
*                                                                  0264 00079000
*        DDSTRU = ADDR(PRINTTAB);                                  0264 00080000
@RT00261 LA    @08,PRINTTAB                                        0264 00081000
         ST    @08,DDSTRU                                          0264 00082000
*        PRINTTAB = ''B;                                           0265 00083000
         XC    PRINTTAB(20),PRINTTAB                               0265 00084000
*        CTGPLPTR = ADDR(CPLSTOR);                                 0266 00085000
         LA    @08,CPLSTOR                                         0266 00086000
         ST    @08,CTGPLPTR                                        0266 00087000
*        CTGFLPTR = ADDR(FPLTYPE);                         /*@YL026UA*/ 00088000
         LA    CTGFLPTR,FPLTYPE                                    0267 00089000
*        FDTPTR(4) = NULLPTR;                              /*@YL026UA*/ 00090000
*                                                                  0268 00091000
         SLR   @08,@08                                             0268 00092000
         L     @15,@PC00001+4                                      0268 00093000
         ST    @08,FDTPTR+12(,@15)                                 0268 00094000
*        /************************************************************/ 00095000
*        /*                                                          */ 00096000
*        /*  SET A FLAG IF THE TYPE FIELD WAS SPECIFIED ON THE       */ 00097000
*        /*  DELETE COMMAND.                                         */ 00098000
*        /*                                                          */ 00099000
*        /************************************************************/ 00100000
*                                                                  0269 00101000
*        IF ADDR(CLUST) ^= NULLPTR | ADDR(UCAT) ^= NULLPTR |       0269 00102000
*           ADDR(MCAT) ^= NULLPTR | ADDR(ALIEN) ^= NULLPTR |       0269 00103000
*           ADDR(SPACE) ^= NULLPTR |                               0269 00104000
*           ADDR(GDG) ^= NULLPTR | ADDR(PGSPC) ^= NULLPTR |        0269 00105000
*           ADDR(ALIAS) ^= NULLPTR |                       /*@Y30SSFR*/ 00106000
*           ADDR(AIX) ^= NULLPTR |                         /*@Y30SSFR*/ 00107000
*           ADDR(PATH) ^= NULLPTR                          /*@Y30SSFR*/ 00108000
*          THEN                                                    0269 00109000
         C     @08,FDTPTR+40(,@15)                                 0269 00110000
         BNE   @RT00269                                            0269 00111000
         C     @08,FDTPTR+48(,@15)                                 0269 00112000
         BNE   @RT00269                                            0269 00113000
         C     @08,FDTPTR+52(,@15)                                 0269 00114000
         BNE   @RT00269                                            0269 00115000
         C     @08,FDTPTR+56(,@15)                                 0269 00116000
         BNE   @RT00269                                            0269 00117000
         C     @08,FDTPTR+44(,@15)                                 0269 00118000
         BNE   @RT00269                                            0269 00119000
         C     @08,FDTPTR+72(,@15)                                 0269 00120000
         BNE   @RT00269                                            0269 00121000
         C     @08,FDTPTR+68(,@15)                                 0269 00122000
         BNE   @RT00269                                            0269 00123000
         C     @08,FDTPTR+76(,@15)                                 0269 00124000
         BNE   @RT00269                                            0269 00125000
         C     @08,FDTPTR+80(,@15)                                 0269 00126000
         BNE   @RT00269                                            0269 00127000
         C     @08,FDTPTR+84(,@15)                                 0269 00128000
         BE    @RF00269                                            0269 00129000
@RT00269 DS    0H                                                  0270 00130000
*            TYPEFLAG = ON;                                /*@YL026UA*/ 00131000
         OI    TYPEFLAG,B'10000000'                                0270 00132000
*          ELSE                                                    0271 00133000
*            TYPEFLAG = OFF;                                       0271 00134000
*                                                                  0271 00135000
         B     @RC00269                                            0271 00136000
@RF00269 NI    TYPEFLAG,B'01111111'                                0271 00137000
*        /************************************************************/ 00138000
*        /*                                                          */ 00139000
*        /*  INITIALIZE ACB AND ALLOCATION INDICATORS.       @YL026UA*/ 00140000
*        /*  INDICATE THAT THE DELETE CPL HAS NOT BEEN INITIALIZED   */ 00141000
*        /*  INDICATE THAT THE LOCATE CPL HAS NOT BEEN INITIALIZED   */ 00142000
*        /*  ESTABLISH BASE POINTERS FOR ALLAGL AND CIRAGL   @YL026UA*/ 00143000
*        /*                                                          */ 00144000
*        /************************************************************/ 00145000
*                                                                  0272 00146000
*        ACBFLAG = OFF;                                    /*@YL026UA*/ 00147000
@RC00269 NI    ACBFLAG,B'01111111'                                 0272 00148000
*        DEALLOC = OFF;                                    /*@YL026UA*/ 00149000
         NI    DEALLOC,B'01111111'                                 0273 00150000
*        DCPLINIT = OFF;                                   /*@YL026UA*/ 00151000
         NI    DCPLINIT,B'01111111'                                0274 00152000
*        LCPLINIT = OFF;                                   /*@YL026UA*/ 00153000
         NI    LCPLINIT,B'01111111'                                0275 00154000
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/ 00155000
*        RESPECIFY CIRAGL BASED(CIRPTR);                   /*@YL026UA*/ 00156000
*                                                                  0277 00157000
*        /************************************************************/ 00158000
*        /*                                                          */ 00159000
*        /*  FOR EACH ENTRY TO BE DELETED, DETERMINE THE TYPE OF     */ 00160000
*        /*  ENTRY TO BE DELETED, BUILD THE CATALOG PARAMETER        */ 00161000
*        /*  LIST AND CALL THE CATALOG TO DELETE THE ENTRY.          */ 00162000
*        /*  CONTINUE DELETING ENTRIES UNTIL A TERMINATING           */ 00163000
*        /*  CONDITION OCCURS.                                       */ 00164000
*        /*                                                          */ 00165000
*        /************************************************************/ 00166000
*                                                                  0278 00167000
*NTRYLOOP: DO INDEX = 1 TO NTRYCNT WHILE LASTCOND < LASTCC12;      0278 00168000
*                                                                  0278 00169000
NTRYLOOP LA    @08,1                                               0278 00170000
         B     @DE00278                                            0278 00171000
@DL00278 L     @08,@PC00001+8                                      0278 00172000
         LH    @08,LASTCOND(,@08)                                  0278 00173000
         C     @08,@CF00035                                        0278 00174000
         BNL   @DC00278                                            0278 00175000
*          /**********************************************************/ 00176000
*          /*                                                @Y30SSFR*/ 00177000
*          /*  SAVE THE CATALOG NAME IF GIVEN IN THE FDT     @Y30SSFR*/ 00178000
*          /*                                                @Y30SSFR*/ 00179000
*          /**********************************************************/ 00180000
*                                                                  0279 00181000
*          IF ADDR(CAT) ^= NULLPTR                                 0279 00182000
*            THEN                                                  0279 00183000
         L     @08,@PC00001+4                                      0279 00184000
         L     @08,FDTPTR+8(,@08)                                  0279 00185000
         LTR   @08,@08                                             0279 00186000
         BZ    @RF00279                                            0279 00187000
*              CATNAME = CATVAL;                           /*@Y30SSFR*/ 00188000
         MVC   CATNAME(44),CATVAL(@08)                             0280 00189000
*            ELSE                                                  0281 00190000
*              CATNAME = ' ';                              /*@Y30SSFR*/ 00191000
*                                                                  0281 00192000
         B     @RC00279                                            0281 00193000
@RF00279 MVI   CATNAME+1,C' '                                      0281 00194000
         MVC   CATNAME+2(42),CATNAME+1                             0281 00195000
         MVI   CATNAME,C' '                                        0281 00196000
*          /**********************************************************/ 00197000
*          /*                                                        */ 00198000
*          /*  INITIALIZE THE CONDITION CODE FOR THIS ENTRY.         */ 00199000
*          /*  CONTINUE ALL THE OPERATIONS FOR AN ENTRY IF THE ENTRY */ 00200000
*          /*  CONDITION CODE INDICATES NO SEVERE ERRORS.            */ 00201000
*          /*  ASSIGN ENTRYNAME & LENGTH TO WORK AREAS SO    @YL026UA*/ 00202000
*          /*  THE FDT ISN'T MODIFIED.                       @YL026UA*/ 00203000
*          /*                                                @YL026UA*/ 00204000
*          /**********************************************************/ 00205000
*                                                                  0282 00206000
*          ENTRYRC = 0;                                            0282 00207000
@RC00279 SLR   ENTRYRC,ENTRYRC                                     0282 00208000
*          ENTRYLEN = NTRYLEN(INDEX);                      /*@YL026UA*/ 00209000
         LH    @08,INDEX                                           0283 00210000
         MH    @08,@CH01079                                        0283 00211000
         L     @02,@PC00001+4                                      0283 00212000
         L     @02,FDTPTR(,@02)                                    0283 00213000
         LA    @01,0(@08,@02)                                      0283 00214000
         AL    @01,@CF01096                                        0283 00215000
         SLR   @00,@00                                             0283 00216000
         IC    @00,NTRYLEN-22(,@01)                                0283 00217000
         STH   @00,ENTRYLEN                                        0283 00218000
*          ENTRYVAL = NTRYVAL(INDEX);                      /*@YL026UA*/ 00219000
*                                                                  0284 00220000
         ST    @08,@TF00001                                        0284 00221000
         ALR   @08,@02                                             0284 00222000
         AL    @08,@CF01097                                        0284 00223000
         MVC   ENTRYVAL(44),NTRYVAL-23(@08)                        0284 00224000
*          /**********************************************************/ 00225000
*          /*                                                @Y30SSFR*/ 00226000
*          /*  IF THE ENTRY IS NOT FULLY QUALIFIED - ISSUE   @Y30SSFR*/ 00227000
*          /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIER      */ 00228000
*          /*                                                @Y30SSFR*/ 00229000
*          /**********************************************************/ 00230000
*                                                                  0285 00231000
*          IF NTRYFUQ(INDEX) = ON                                  0285 00232000
*            THEN                                                  0285 00233000
         LR    @08,@02                                             0285 00234000
         AL    @08,@TF00001                                        0285 00235000
         AL    @08,@CF01098                                        0285 00236000
         TM    NTRYFUQ-12(@08),B'10000000'                         0285 00237000
         BNO   @RF00285                                            0285 00238000
*              DO;                                         /*@YL026UA*/ 00239000
*                                                                  0286 00240000
*              /******************************************************/ 00241000
*              /*                                            @Y30SSFR*/ 00242000
*              /*  CLEAR THE STORAGE THAT IS TO BE OCCUPIED  @Y30SSFR*/ 00243000
*              /*  BY THE PARAMETER LIST PASSED TO UQUAL.    @Y30SSFR*/ 00244000
*              /*  PLACE THE ADDRESS OF THE ENTRY NAME TO    @Y30SSFR*/ 00245000
*              /*  BE QUALIFIED AND THE PASSWORD INTO THE    @Y30SSFR*/ 00246000
*              /*  PARAMETER LIST.                           @Y30SSFR*/ 00247000
*              /*                                            @Y30SSFR*/ 00248000
*              /******************************************************/ 00249000
*                                                                  0287 00250000
*              QUALLIST = ''B;                             /*@Y30SSFR*/ 00251000
         XC    QUALLIST(12),QUALLIST                               0287 00252000
*              QUALADDR = ADDR(ENTRYVAL);                  /*@Y30SSFR*/ 00253000
         LA    @08,ENTRYVAL                                        0288 00254000
         ST    @08,QUALADDR                                        0288 00255000
*              IF NTRYPLN(INDEX) ^= 0                      /*@Y30SSFR*/ 00256000
*                THEN                                      /*@Y30SSFR*/ 00257000
         L     @08,@TF00001                                        0289 00258000
         AL    @08,@CF01099                                        0289 00259000
         SLR   @15,@15                                             0289 00260000
         IC    @15,NTRYPLN-2(@08,@02)                              0289 00261000
         C     @15,@CF00115                                        0289 00262000
         BE    @RF00289                                            0289 00263000
*                  QUALPAS = ADDR(NTRYPAS(INDEX));         /*@Y30SSFR*/ 00264000
*                                                                  0290 00265000
         L     @08,@TF00001                                        0290 00266000
         AL    @02,@CF01100                                        0290 00267000
         LA    @08,NTRYPAS-3(@08,@02)                              0290 00268000
         ST    @08,QUALPAS                                         0290 00269000
*              /******************************************************/ 00270000
*              /*                                            @Y30SSFR*/ 00271000
*              /*  IF THE USER HAS SPECIFIED THE CATALOG     @Y30SSFR*/ 00272000
*              /*  PARAMETER ON THE AMS DELETE COMMAND,      @Y30SSFR*/ 00273000
*              /*  PLACE THIS INFORMATION IN THE UQUAL       @Y30SSFR*/ 00274000
*              /*  PARAMETER LIST.                           @Y30SSFR*/ 00275000
*              /*                                            @Y30SSFR*/ 00276000
*              /******************************************************/ 00277000
*                                                                  0291 00278000
*              IF ADDR(CAT) ^= NULLPTR & CATLEN ^= 0       /*@Y30SSFR*/ 00279000
*                THEN                                      /*@Y30SSFR*/ 00280000
@RF00289 L     @08,@PC00001+4                                      0291 00281000
         L     @08,FDTPTR+8(,@08)                                  0291 00282000
         LTR   @08,@08                                             0291 00283000
         BZ    @RF00291                                            0291 00284000
         CLI   CATLEN(@08),0                                       0291 00285000
         BE    @RF00291                                            0291 00286000
*                  DO;                                     /*@Y30SSFR*/ 00287000
*                  QUALCAT = ADDR(CATVAL);                 /*@Y30SSFR*/ 00288000
         LA    @02,CATVAL(,@08)                                    0293 00289000
         ST    @02,QUALCAT                                         0293 00290000
*                  IF CATPLN ^= 0                          /*@Y30SSFR*/ 00291000
*                    THEN                                  /*@Y30SSFR*/ 00292000
         CLI   CATPLN(@08),0                                       0294 00293000
         BE    @RF00294                                            0294 00294000
*                      QUALPAS = ADDR(CATPAS);             /*@Y30SSFR*/ 00295000
         LA    @08,CATPAS(,@08)                                    0295 00296000
         ST    @08,QUALPAS                                         0295 00297000
*                  END;                                    /*@Y30SSFR*/ 00298000
*                                                                  0296 00299000
@RF00294 DS    0H                                                  0297 00300000
*              /******************************************************/ 00301000
*              /*                                            @Y30SSFR*/ 00302000
*              /*  ISSUE THE UQUAL MACRO OF THE SYSTEM       @Y30SSFR*/ 00303000
*              /*  ADAPTER TO OBTAIN THE FULLY QUALIFIED     @Y30SSFR*/ 00304000
*              /*  ENTRY NAME.  TEST THE RETURN, AND IF AN   @Y30SSFR*/ 00305000
*              /*  ERROR IS INDICATED, SET ENTRYRC TO 8.     @Y30SSFR*/ 00306000
*              /*                                            @Y30SSFR*/ 00307000
*              /******************************************************/ 00308000
*                                                                  0297 00309000
*              CALL IDCSAQL0(GDTTBL,QUALADDR,ENTRYLEN,QUALCAT,QUALPAS); 00310000
@RF00291 L     @08,@PC00001                                        0297 00311000
         ST    @08,@AL00001                                        0297 00312000
         LA    @15,QUALADDR                                        0297 00313000
         ST    @15,@AL00001+4                                      0297 00314000
         LA    @15,ENTRYLEN                                        0297 00315000
         ST    @15,@AL00001+8                                      0297 00316000
         LA    @15,QUALCAT                                         0297 00317000
         ST    @15,@AL00001+12                                     0297 00318000
         LA    @15,QUALPAS                                         0297 00319000
         ST    @15,@AL00001+16                                     0297 00320000
         MVI   @AL00001+16,X'80'                                   0297 00321000
         L     @15,GDTQAL(,@08)                                    0297 00322000
         LA    @01,@AL00001                                        0297 00323000
         BALR  @14,@15                                             0297 00324000
*                                                          /*#YL026UA*/ 00325000
*              RESPECIFY RTNREG RSTD;                              0298 00326000
*              TESTRC = RTNREG;                                    0299 00327000
         LR    TESTRC,RTNREG                                       0299 00328000
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/ 00329000
*              IF TESTRC ^= 0                              /*@Y30SSFR*/ 00330000
*                THEN                                      /*@Y30SSFR*/ 00331000
         LTR   TESTRC,TESTRC                                       0301 00332000
         BZ    @RF00301                                            0301 00333000
*                  ENTRYRC = LASTCC08;                     /*@Y30SSFR*/ 00334000
         LA    ENTRYRC,8                                           0302 00335000
*              END;                                        /*#YL026UA*/ 00336000
*                                                                  0303 00337000
@RF00301 DS    0H                                                  0304 00338000
*          /**********************************************************/ 00339000
*          /*                                                @Y30SSFR*/ 00340000
*          /*  IF THE ENTRY IS FOR PDS MEMBER DELETION -     @Y30SSFR*/ 00341000
*          /*  DELETE THE MEMBER FROM ITS DIRECTORY          @Y30SSFR*/ 00342000
*          /*                                                @Y30SSFR*/ 00343000
*          /**********************************************************/ 00344000
*                                                                  0304 00345000
*          IF NTRYMLN(INDEX) ^= 0                                  0304 00346000
*            THEN                                                  0304 00347000
@RF00285 LH    @08,INDEX                                           0304 00348000
         MH    @08,@CH01079                                        0304 00349000
         L     @02,@PC00001+4                                      0304 00350000
         L     @02,FDTPTR(,@02)                                    0304 00351000
         AL    @02,@CF01101                                        0304 00352000
         SLR   @15,@15                                             0304 00353000
         IC    @15,NTRYMLN-13(@08,@02)                             0304 00354000
         C     @15,@CF00115                                        0304 00355000
         BE    @RF00304                                            0304 00356000
*              DO;                                         /*#YL026UA*/ 00357000
*              CALL MEMDLETE;                              /*@Y30SSFR*/ 00358000
         BAL   @14,MEMDLETE                                        0306 00359000
*              RESPECIFY RTNREG RSTD;                              0307 00360000
*              TESTRC = RTNREG;                                    0308 00361000
         LR    TESTRC,RTNREG                                       0308 00362000
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/ 00363000
*              LASTCOND = MAX(TESTRC,LASTCOND);            /*@Y30SSFR*/ 00364000
         L     @08,@PC00001+8                                      0310 00365000
         LH    @15,LASTCOND(,@08)                                  0310 00366000
         CR    @15,TESTRC                                          0310 00367000
         BNL   *+6                                                      00368000
         LR    @15,TESTRC                                          0310 00369000
         STH   @15,LASTCOND(,@08)                                  0310 00370000
*              END;                                        /*#YL026UA*/ 00371000
*            ELSE                                                  0312 00372000
*                                                                  0312 00373000
*        /************************************************************/ 00374000
*        /*                                                  #YL026UA*/ 00375000
*        /*  IF THE ENTRY IS FOR PDS MEMBER DELETION -       #YL026UA*/ 00376000
*        /*  PROCESSING IS COMPLETE AT THIS POINT            #YL026UA*/ 00377000
*        /*                                                  #YL026UA*/ 00378000
*        /************************************************************/ 00379000
*                                                                  0312 00380000
*NOTPDS:       DO;                                         /*@Y30SSFR*/ 00381000
*                                                                  0312 00382000
         B     @RC00304                                            0312 00383000
@RF00304 DS    0H                                                  0312 00384000
NOTPDS   DS    0H                                                  0313 00385000
*              GENCNT = 0;             /* SET # GENERIC  *//*@ZA00605*/ 00386000
         SLR   GENCNT,GENCNT                                       0313 00387000
*                                      /* ENTRIES TO 0   *//*@ZA00605*/ 00388000
*                                                                  0314 00389000
*              /******************************************************/ 00390000
*              /*                                            @Y30SSFR*/ 00391000
*              /*  IF THE ENTRY NAME GIVEN BY THE USER IS    @Y30SSFR*/ 00392000
*              /*  GENERIC, THEN ISSUE THE UCIR MACRO TO     @Y30SSFR*/ 00393000
*              /*  OBTAIN THE LIST OF NAMES DESCRIBED BY     @Y30SSFR*/ 00394000
*              /*  THE GENERIC NAME.                         @Y30SSFR*/ 00395000
*              /*                                            @Y30SSFR*/ 00396000
*              /******************************************************/ 00397000
*                                                                  0314 00398000
*              IF NTRYPOS(INDEX) ^= 0                              0314 00399000
*                THEN                                              0314 00400000
         LH    @08,INDEX                                           0314 00401000
         MH    @08,@CH01079                                        0314 00402000
         L     @05,@PC00001+4                                      0314 00403000
         L     @05,FDTPTR(,@05)                                    0314 00404000
         AL    @05,@CF01102                                        0314 00405000
         SLR   @02,@02                                             0314 00406000
         IC    @02,NTRYPOS-11(@08,@05)                             0314 00407000
         C     @02,@CF00115                                        0314 00408000
         BE    @RF00314                                            0314 00409000
*GENLOC:           DO;                                     /*@Y30SSFR*/ 00410000
*                                                                  0315 00411000
GENLOC   DS    0H                                                  0316 00412000
*                  /**************************************************/ 00413000
*                  /*                                        @Y30SSFR*/ 00414000
*                  /*  POINT TO THE STORAGE FOR THE CIRAGL,  @Y30SSFR*/ 00415000
*                  /*  AND ZERO OUT THAT AREA OF CORE.       @Y30SSFR*/ 00416000
*                  /*                                        @Y30SSFR*/ 00417000
*                  /**************************************************/ 00418000
*                                                                  0316 00419000
*                  CIRPTR = ADDR(CIRLIST);                 /*@Y30SSFR*/ 00420000
         LA    CIRPTR,CIRLIST                                      0316 00421000
*                  CIRLIST = ''B;                          /*@Y30SSFR*/ 00422000
*                                                                  0317 00423000
         XC    CIRLIST(32),CIRLIST                                 0317 00424000
*                  /**************************************************/ 00425000
*                  /*                                        @Y30SSFR*/ 00426000
*                  /*  INDICATE THAT ONLY ASTERISK IS        @Y30SSFR*/ 00427000
*                  /*  PRESENT IN THE ENTRY NAME.            @Y30SSFR*/ 00428000
*                  /*                                        @Y30SSFR*/ 00429000
*                  /**************************************************/ 00430000
*                                                                  0318 00431000
*                  CIRTYP1Q = ON;                          /*@Y30SSFR*/ 00432000
*                                                                  0318 00433000
         OI    CIRTYP1Q(CIRPTR),B'10000000'                        0318 00434000
*                  /**************************************************/ 00435000
*                  /*                                        @Y30SSFR*/ 00436000
*                  /*  SET THE LENGTH AND ADDRESS OF THE     @Y30SSFR*/ 00437000
*                  /*  HEADER (THE PART OF THE NAME PRIOR    @Y30SSFR*/ 00438000
*                  /*  TO THE ASTERISK).                     @Y30SSFR*/ 00439000
*                  /*                                        @Y30SSFR*/ 00440000
*                  /**************************************************/ 00441000
*                                                                  0319 00442000
*                  CIRHLN = NTRYPOS(INDEX) - 1;            /*@Y30SSFR*/ 00443000
         LH    @08,INDEX                                           0319 00444000
         MH    @08,@CH01079                                        0319 00445000
         L     @05,@PC00001+4                                      0319 00446000
         L     @05,FDTPTR(,@05)                                    0319 00447000
         AL    @05,@CF01102                                        0319 00448000
         SLR   @15,@15                                             0319 00449000
         IC    @15,NTRYPOS-11(@08,@05)                             0319 00450000
         LR    @08,@15                                             0319 00451000
         BCTR  @08,0                                               0319 00452000
         STH   @08,CIRHLN(,CIRPTR)                                 0319 00453000
*                  CIRHDR = ADDR(ENTRYVAL);                /*@Y30SSFR*/ 00454000
*                                                                  0320 00455000
         LA    @08,ENTRYVAL                                        0320 00456000
         ST    @08,CIRHDR(,CIRPTR)                                 0320 00457000
*                  /**************************************************/ 00458000
*                  /*                                        @Y30SSFR*/ 00459000
*                  /*  SET THE LENGTH AND ADDRESS OF THE     @Y30SSFR*/ 00460000
*                  /*  TRAILER IF ANY.                       @Y30SSFR*/ 00461000
*                  /*                                        @Y30SSFR*/ 00462000
*                  /**************************************************/ 00463000
*                                                                  0321 00464000
*                  IF ENTRYLEN ^= NTRYPOS(INDEX)                   0321 00465000
*                    THEN                                          0321 00466000
         LH    @05,ENTRYLEN                                        0321 00467000
         CR    @05,@15                                             0321 00468000
         BE    @RF00321                                            0321 00469000
*                      DO;                                 /*@Y30SSFR*/ 00470000
*                      CIRTLR = CIRHDR + NTRYPOS(INDEX);   /*@Y30SSFR*/ 00471000
         ALR   @08,@15                                             0323 00472000
         ST    @08,CIRTLR(,CIRPTR)                                 0323 00473000
*                      CIRTLN = ENTRYLEN - NTRYPOS(INDEX); /*@Y30SSFR*/ 00474000
         SLR   @05,@15                                             0324 00475000
         STH   @05,CIRTLN(,CIRPTR)                                 0324 00476000
*                      END;                                /*@Y30SSFR*/ 00477000
*                                                                  0325 00478000
*                  /**************************************************/ 00479000
*                  /*                                        @Y30SSFR*/ 00480000
*                  /*  SET THE ADDRESS OF THE POINTER FOR    @Y30SSFR*/ 00481000
*                  /*  THE LIST OF NAMES RETURNED BY GENERIC @Y30SSFR*/ 00482000
*                  /*  LOCATE.                               @Y30SSFR*/ 00483000
*                  /*                                        @Y30SSFR*/ 00484000
*                  /**************************************************/ 00485000
*                                                                  0326 00486000
*                  CIRWKP = ADDR(GENWKPTR);                /*@Y30SSFR*/ 00487000
*                                                                  0326 00488000
@RF00321 LA    @08,GENWKPTR                                        0326 00489000
         ST    @08,CIRWKP(,CIRPTR)                                 0326 00490000
*                  /**************************************************/ 00491000
*                  /*                                        @Y30SSFR*/ 00492000
*                  /*  PLACE PASSWORD AND CATALOG            @Y30SSFR*/ 00493000
*                  /*  INFORMATION IN THE CIRAGL IF THEY     @Y30SSFR*/ 00494000
*                  /*  ARE AVAILABLE.                        @Y30SSFR*/ 00495000
*                  /*                                        @Y30SSFR*/ 00496000
*                  /**************************************************/ 00497000
*                                                                  0327 00498000
*                  IF NTRYPLN(INDEX) ^= NULLPTR            /*@Y30SSFR*/ 00499000
*                    THEN                                          0327 00500000
         LH    @08,INDEX                                           0327 00501000
         MH    @08,@CH01079                                        0327 00502000
         L     @05,@PC00001+4                                      0327 00503000
         L     @05,FDTPTR(,@05)                                    0327 00504000
         LA    @01,0(@08,@05)                                      0327 00505000
         AL    @01,@CF01099                                        0327 00506000
         SLR   @00,@00                                             0327 00507000
         IC    @00,NTRYPLN-2(,@01)                                 0327 00508000
         C     @00,@CF00115                                        0327 00509000
         BE    @RF00327                                            0327 00510000
*                      CIRPWD = ADDR(NTRYPAS(INDEX));      /*@Y30SSFR*/ 00511000
         AL    @05,@CF01100                                        0328 00512000
         LA    @08,NTRYPAS-3(@08,@05)                              0328 00513000
         ST    @08,CIRPWD(,CIRPTR)                                 0328 00514000
*                  IF ADDR(CAT) ^= NULLPTR & CATLEN ^= 0           0329 00515000
*                    THEN                                          0329 00516000
@RF00327 L     @08,@PC00001+4                                      0329 00517000
         L     @08,FDTPTR+8(,@08)                                  0329 00518000
         LTR   @08,@08                                             0329 00519000
         BZ    @RF00329                                            0329 00520000
         CLI   CATLEN(@08),0                                       0329 00521000
         BE    @RF00329                                            0329 00522000
*                      DO;                                 /*@Y30SSFR*/ 00523000
*                      CIRCAT = ADDR(CATVAL);              /*#YL026UA*/ 00524000
         LA    @05,CATVAL(,@08)                                    0331 00525000
         ST    @05,CIRCAT(,CIRPTR)                                 0331 00526000
*                      IF CATPLN ^= 0                              0332 00527000
*                        THEN                                      0332 00528000
         CLI   CATPLN(@08),0                                       0332 00529000
         BE    @RF00332                                            0332 00530000
*                          CIRPWD = ADDR(CATPAS);          /*#YL026UA*/ 00531000
         LA    @08,CATPAS(,@08)                                    0333 00532000
         ST    @08,CIRPWD(,CIRPTR)                                 0333 00533000
*                      END;                                /*@Y30SSFR*/ 00534000
*                                                                  0334 00535000
@RF00332 DS    0H                                                  0335 00536000
*                  /**************************************************/ 00537000
*                  /*                                        @Y30SSFR*/ 00538000
*                  /*  PLACE THE GETPOOL ID TO BE USED BY    @Y30SSFR*/ 00539000
*                  /*  GENERIC LOCATE IN GETTING THE         @Y30SSFR*/ 00540000
*                  /*  STORAGE FOR THE LIST OF NAMES TO BE   @Y30SSFR*/ 00541000
*                  /*  RETURNED IN THE CIRAGL.               @Y30SSFR*/ 00542000
*                  /*                                        @Y30SSFR*/ 00543000
*                  /**************************************************/ 00544000
*                                                                  0335 00545000
*                  CIRPID = DLGPID;                        /*@Y30SSFR*/ 00546000
*                                                                  0335 00547000
@RF00329 MVC   CIRPID(4,CIRPTR),DLGPID                             0335 00548000
*                  /**************************************************/ 00549000
*                  /*                                        @Y30SSFR*/ 00550000
*                  /*  ISSUE THE UCIR AND TEST THE RETURN    @Y30SSFR*/ 00551000
*                  /*  CODE.  IF IT IS NONZERO, INDICATE     @Y30SSFR*/ 00552000
*                  /*  AN ERROR.                             @Y30SSFR*/ 00553000
*                  /*                                        @Y30SSFR*/ 00554000
*                  /**************************************************/ 00555000
*                                                                  0336 00556000
*                  CALL IDCSACR0(GDTTBL,CIRAGL);           /*@Y30SSFR*/ 00557000
*                                                                  0336 00558000
         L     @08,@PC00001                                        0336 00559000
         ST    @08,@AL00001                                        0336 00560000
         ST    CIRPTR,@AL00001+4                                   0336 00561000
         MVI   @AL00001+4,X'80'                                    0336 00562000
         L     @15,GDTCIR(,@08)                                    0336 00563000
         LA    @01,@AL00001                                        0336 00564000
         BALR  @14,@15                                             0336 00565000
*                  RESPECIFY RTNREG RSTD;                          0337 00566000
*                  TESTRC = RTNREG;                                0338 00567000
         LR    TESTRC,RTNREG                                       0338 00568000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30SSFR*/ 00569000
*                  IF TESTRC ^= 0                                  0340 00570000
*                    THEN                                          0340 00571000
         LTR   TESTRC,TESTRC                                       0340 00572000
         BZ    @RF00340                                            0340 00573000
*                      ENTRYRC = MAX(ENTRYRC,LASTCC08);    /*@Y30SSFR*/ 00574000
         LA    @08,8                                               0341 00575000
         CR    ENTRYRC,@08                                         0341 00576000
         BNL   *+6                                                      00577000
         LR    ENTRYRC,@08                                         0341 00578000
*                    ELSE                                          0342 00579000
*                                                                  0342 00580000
*                    /************************************************/ 00581000
*                    /*                                      @Y30SSFR*/ 00582000
*                    /*  SET THE VALUE OF THE GENERIC LOOP   @Y30SSFR*/ 00583000
*                    /*  COUNTER ON THE BASIS OF THE NUMBER  @Y30SSFR*/ 00584000
*                    /*  OF NAMES RETURNED BY GENERIC        @Y30SSFR*/ 00585000
*                    /*  LOCATE.                             @Y30SSFR*/ 00586000
*                    /*  IF THE ENTRY NAME WAS NOT GENERIC,  @Y30SSFR*/ 00587000
*                    /*  THE LOOP CONTROL IS SET TO 1.       @Y30SSFR*/ 00588000
*                    /*                                      @Y30SSFR*/ 00589000
*                    /************************************************/ 00590000
*                                                                  0342 00591000
*                      GENCNT = GENNUM;                    /*@Y30SSFR*/ 00592000
         B     @RC00340                                            0342 00593000
@RF00340 L     @08,GENWKPTR                                        0342 00594000
         L     GENCNT,GENNUM(,@08)                                 0342 00595000
*                  END GENLOC;                             /*@Y30SSFR*/ 00596000
*                ELSE                                              0344 00597000
*                                                                  0344 00598000
*                  /**************************************************/ 00599000
*                  /*                                        @Y30SSFR*/ 00600000
*                  /*  THE ENTRY NAME GIVEN WAS NOT GENERIC, @Y30SSFR*/ 00601000
*                  /*  SO THAT THE COUNTER VALUE IS SET TO   @Y30SSFR*/ 00602000
*                  /*  ONE.  ALSO, THE GENERIC WORKAREA      @Y30SSFR*/ 00603000
*                  /*  POINTER IS SET TO POINT TO THE AREA   @Y30SSFR*/ 00604000
*                  /*  OF STORAGE THAT HOLDS THE ENTRY NAME  @Y30SSFR*/ 00605000
*                  /*  OF THE OBJECT TO BE DELETED.          @Y30SSFR*/ 00606000
*                  /*                                        @Y30SSFR*/ 00607000
*                  /**************************************************/ 00608000
*                                                                  0344 00609000
*                  DO;                                     /*@Y30SSFR*/ 00610000
         B     @RC00314                                            0344 00611000
@RF00314 DS    0H                                                  0345 00612000
*                  GENCNT = 1;                             /*@Y30SSFR*/ 00613000
         LA    GENCNT,1                                            0345 00614000
*                  ATYPE = 0;                              /*@Y30SSFR*/ 00615000
         MVI   ATYPE,X'00'                                         0346 00616000
*                  GENWKPTR = ADDR(ENTRIES);               /*@Y30SSFR*/ 00617000
         LA    @08,ENTRIES                                         0347 00618000
         ST    @08,GENWKPTR                                        0347 00619000
*                  END;                                    /*@Y30SSFR*/ 00620000
*                                                                  0348 00621000
*              /******************************************************/ 00622000
*              /*                                            @Y30SSFR*/ 00623000
*              /*  LOOP, DELETING THE CATALOG ENTRIES FOR    @Y30SSFR*/ 00624000
*              /*  FOR THE NAMES IN THE GENERIC WORK AREA.   @Y30SSFR*/ 00625000
*              /*  THE SECOND LEVEL PROCESSOR DELTPROC       @Y30SSFR*/ 00626000
*              /*  ACTUALLY SETS UP THE DELETES.             @Y30SSFR*/ 00627000
*              /*                                            @Y30SSFR*/ 00628000
*              /******************************************************/ 00629000
*                                                                  0349 00630000
*GENLOOP:      DO ENT = 1 TO GENCNT                        /*@Y30SSFR*/ 00631000
*                 WHILE LASTCOND < LASTCC12;               /*@Y30SSFR*/ 00632000
@RC00314 DS    0H                                                  0349 00633000
GENLOOP  LA    ENT,1                                               0349 00634000
         B     @DE00349                                            0349 00635000
@DL00349 L     @08,@PC00001+8                                      0349 00636000
         LH    @08,LASTCOND(,@08)                                  0349 00637000
         C     @08,@CF00035                                        0349 00638000
         BNL   @DC00349                                            0349 00639000
*                CALL DELTPROC;                            /*@Y30SSFR*/ 00640000
         BAL   @14,DELTPROC                                        0350 00641000
*              END GENLOOP;                                /*@Y30SSFR*/ 00642000
         AL    ENT,@CF00219                                        0351 00643000
@DE00349 CR    ENT,GENCNT                                          0351 00644000
         BNH   @DL00349                                            0351 00645000
@DC00349 DS    0H                                                  0352 00646000
*            END NOTPDS;                                   /*@Y30SSFR*/ 00647000
*                                                                  0352 00648000
*          /**********************************************************/ 00649000
*          /*                                                @Y30SSFR*/ 00650000
*          /*  SET THE LAST CONDITION CODE TO THE MAXIMUM    @Y30SSFR*/ 00651000
*          /*  VALUE ENCOUNTERRED FOR THIS ENTRY.  THIS IS   @Y30SSFR*/ 00652000
*          /*  DONE TO PICK UP THE VALUE ENCOUNTERED IN      @Y30SSFR*/ 00653000
*          /*  A FAILING GENERIC LOCATE IF ANY.              @Y30SSFR*/ 00654000
*          /*                                                @Y30SSFR*/ 00655000
*          /**********************************************************/ 00656000
*                                                                  0353 00657000
*          LASTCOND = MAX(ENTRYRC,LASTCOND);               /*@Y30SSFR*/ 00658000
@RC00304 L     @08,@PC00001+8                                      0353 00659000
         LH    @02,LASTCOND(,@08)                                  0353 00660000
         CR    @02,ENTRYRC                                         0353 00661000
         BNL   *+6                                                      00662000
         LR    @02,ENTRYRC                                         0353 00663000
         STH   @02,LASTCOND(,@08)                                  0353 00664000
*          ENTRYRC = 0;                                    /*@Y30SSFR*/ 00665000
         SLR   ENTRYRC,ENTRYRC                                     0354 00666000
*        END NTRYLOOP;                                     /*#Y30SSFR*/ 00667000
*                                                                  0355 00668000
         LA    @08,1                                               0355 00669000
         AH    @08,INDEX                                           0355 00670000
@DE00278 STH   @08,INDEX                                           0355 00671000
         L     @15,@PC00001+4                                      0355 00672000
         L     @01,FDTPTR(,@15)                                    0355 00673000
         CH    @08,NTRYCNT(,@01)                                   0355 00674000
         BNH   @DL00278                                            0355 00675000
@DC00278 DS    0H                                                  0356 00676000
*        /************************************************************/ 00677000
*        /*                                                  #Y30SSFR*/ 00678000
*        /*  ISSUE A COMPLETION MESSAGE IF SOME FUNCTION HAS BEEN    */ 00679000
*        /*  COMPLETED.                                      #Y30SSFR*/ 00680000
*        /*                                                  #Y30SSFR*/ 00681000
*        /************************************************************/ 00682000
*                                                                  0356 00683000
*        IF (LASTCOND > LASTCC00) & (GDTECT ^= NULLPTR)    /*#Y30SSFR*/ 00684000
*          THEN                                                    0356 00685000
         SLR   @08,@08                                             0356 00686000
         L     @15,@PC00001+8                                      0356 00687000
         CH    @08,LASTCOND(,@15)                                  0356 00688000
         BNL   @RF00356                                            0356 00689000
         L     @14,@PC00001                                        0356 00690000
         C     @08,GDTECT(,@14)                                    0356 00691000
         BE    @RF00356                                            0356 00692000
*            DO;                                           /*#Y30SSFR*/ 00693000
*            DARGSMOD = UNIVMSG;                           /*#Y30SSFR*/ 00694000
         L     @08,DDSTRU                                          0358 00695000
         MVC   DARGSMOD(3,@08),@CC00892                            0358 00696000
*            DARGSENT = TSOCOMP;                           /*#Y30SSFR*/ 00697000
         MVI   DARGSENT(@08),X'0F'                                 0359 00698000
*            DARGILP = 2;                                  /*#Y30SSFR*/ 00699000
         MVC   DARGILP(2,@08),@CH00153                             0360 00700000
*            DARGDBP = ADDR(LASTCOND);                     /*#Y30SSFR*/ 00701000
*                                                                  0361 00702000
         ST    @15,DARGDBP(,@08)                                   0361 00703000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*#Y30SSFR*/ 00704000
*                                                                  0362 00705000
         ST    @14,@AL00001                                        0362 00706000
         LA    @08,@CF00115                                        0362 00707000
         ST    @08,@AL00001+4                                      0362 00708000
         LA    @08,DDSTRU                                          0362 00709000
         ST    @08,@AL00001+8                                      0362 00710000
         MVI   @AL00001+8,X'80'                                    0362 00711000
         L     @15,GDTPRT(,@14)                                    0362 00712000
         LA    @01,@AL00001                                        0362 00713000
         BALR  @14,@15                                             0362 00714000
*            END;                                          /*#Y30SSFR*/ 00715000
*          ELSE                                            /*#Y30SSFR*/ 00716000
*            DO;                                           /*#Y30SSFR*/ 00717000
         B     @RC00356                                            0364 00718000
@RF00356 DS    0H                                                  0365 00719000
*            DARGSMOD = UNIVMSG;                           /*#Y30SSFR*/ 00720000
         L     @08,DDSTRU                                          0365 00721000
         MVC   DARGSMOD(3,@08),@CC00892                            0365 00722000
*            IF LASTCOND = LASTCC12                        /*#Y30SSFR*/ 00723000
*              THEN                                                0366 00724000
         L     @15,@PC00001+8                                      0366 00725000
         CLC   LASTCOND(2,@15),@CH00035                            0366 00726000
         BNE   @RF00366                                            0366 00727000
*                DARGSENT = TERMMSG;                       /*#Y30SSFR*/ 00728000
         MVI   DARGSENT(@08),X'03'                                 0367 00729000
*              ELSE                                        /*#Y30SSFR*/ 00730000
*                DARGSENT = ENDMSG;                        /*#Y30SSFR*/ 00731000
         B     @RC00366                                            0368 00732000
@RF00366 L     @08,DDSTRU                                          0368 00733000
         MVI   DARGSENT(@08),X'01'                                 0368 00734000
*            DARGDBP = ADDR(LASTCOND);                     /*#Y30SSFR*/ 00735000
@RC00366 L     @08,DDSTRU                                          0369 00736000
         L     @15,@PC00001+8                                      0369 00737000
         ST    @15,DARGDBP(,@08)                                   0369 00738000
*            DARGILP = 2;                                  /*#Y30SSFR*/ 00739000
*                                                                  0370 00740000
         MVC   DARGILP(2,@08),@CH00153                             0370 00741000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*#Y30SSFR*/ 00742000
*                                                                  0371 00743000
         L     @08,@PC00001                                        0371 00744000
         ST    @08,@AL00001                                        0371 00745000
         LA    @15,@CF00115                                        0371 00746000
         ST    @15,@AL00001+4                                      0371 00747000
         LA    @15,DDSTRU                                          0371 00748000
         ST    @15,@AL00001+8                                      0371 00749000
         MVI   @AL00001+8,X'80'                                    0371 00750000
         L     @15,GDTPRT(,@08)                                    0371 00751000
         LA    @01,@AL00001                                        0371 00752000
         BALR  @14,@15                                             0371 00753000
*            END;                                          /*#Y30SSFR*/ 00754000
*                                                                  0372 00755000
*        /************************************************************/ 00756000
*        /*                                                  #Y30SSFR*/ 00757000
*        /*  RETURN TO THE AMS EXECUTIVE                     #Y30SSFR*/ 00758000
*        /*                                                  #Y30SSFR*/ 00759000
*        /************************************************************/ 00760000
*                                                                  0373 00761000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                     0373 00762000
@RC00356 L     @08,@PC00001                                        0373 00763000
         ST    @08,@AL00001                                        0373 00764000
         LA    @15,MODID                                           0373 00765000
         ST    @15,@AL00001+4                                      0373 00766000
         L     @15,@PC00001+8                                      0373 00767000
         ST    @15,@AL00001+8                                      0373 00768000
         MVI   @AL00001+8,X'80'                                    0373 00769000
         L     @15,GDTEPL(,@08)                                    0373 00770000
         LA    @01,@AL00001                                        0373 00771000
         BALR  @14,@15                                             0373 00772000
*       /*#Y30SSFR*/                                               0374 00773000
*        /************************************************************/ 00774000
*        /*                                                  #Y30SSFR*/ 00775000
*        /*  PROCEDURE NAME - DELTPROC (SECOND               #Y30SSFR*/ 00776000
*        /*      LEVEL PROCESSOR)                            #Y30SSFR*/ 00777000
*        /*                                                  #Y30SSFR*/ 00778000
*        /*  FUNCTION - DELTPROC HANDLES THE DELETION OF ONE #Y30SSFR*/ 00779000
*        /*  ENTRY FROM THE CATALOG.  THAT ENTRY IS EITHER   #Y30SSFR*/ 00780000
*        /*  ONE SPECIFIED DIRECTLY BY THE USER OR ONE THAT  #Y30SSFR*/ 00781000
*        /*  IS PART OF A GENERIC LIST RETURNED BY GENERIC   #Y30SSFR*/ 00782000
*        /*  LOCATE.                                         #Y30SSFR*/ 00783000
*        /*                                                  #Y30SSFR*/ 00784000
*        /*  INPUT - NONE                                    #Y30SSFR*/ 00785000
*        /*                                                  #Y30SSFR*/ 00786000
*        /*  OUTPUT - THE CATALOG ENTRY IS DELETED OR        #Y30SSFR*/ 00787000
*        /*  APPROPRIATE ERROR MESSAGES ARE PRINTED.         #Y30SSFR*/ 00788000
*        /*                                                  #Y30SSFR*/ 00789000
*        /************************************************************/ 00790000
*                                                                  0374 00791000
*DELTPROC: PROCEDURE;                                      /*#Y30SSFR*/ 00792000
*                                                                  0374 00793000
@EL00001 L     @13,4(,@13)                                         0374 00794000
@EF00001 L     @00,@SIZDATD                                        0374 00795000
         LR    @01,@09                                             0374 00796000
         FREEMAIN R,LV=(0),A=(1)                                        00797000
@ER00001 LM    @14,@12,12(@13)                                     0374 00798000
         BR    @14                                                 0374 00799000
DELTPROC STM   @14,@02,@SA00002                                    0374 00800000
         STM   @04,@12,@SA00002+20                                 0374 00801000
*        /************************************************************/ 00802000
*        /*                                                  #Y30SSFR*/ 00803000
*        /*  SET WAPTR TO POINT TO THAT PART OF CORE THAT    #Y30SSFR*/ 00804000
*        /*  SERVES AS THE FIRST WORKAREA ON ANY CALL TO CMS #Y30SSFR*/ 00805000
*        /*  DELETE.                                         #Y30SSFR*/ 00806000
*        /*                                                  #Y30SSFR*/ 00807000
*        /************************************************************/ 00808000
*                                                                  0375 00809000
*        WAPTR = ADDR(WORKAREA);                           /*#Y30SSFR*/ 00810000
*                                                                  0375 00811000
         LA    @08,WORKAREA                                        0375 00812000
         ST    @08,WAPTR                                           0375 00813000
*        /************************************************************/ 00814000
*        /*                                                  #YL026UA*/ 00815000
*        /*  IF THE ENTRY IS GENERIC - GET THE CATALOG NAME  #YL026UA*/ 00816000
*        /*  FROM THE LIST TO USE IN DIRECTING THE DELETE    #YL026UA*/ 00817000
*        /*                                                  #YL026UA*/ 00818000
*        /************************************************************/ 00819000
*                                                                  0376 00820000
*        IF ENTTYP(ENT) = '0'                                      0376 00821000
*          THEN                                                    0376 00822000
         L     @08,GENWKPTR                                        0376 00823000
         LR    @04,ENT                                             0376 00824000
         MH    @04,@CH01066                                        0376 00825000
         ST    @04,@TF00001                                        0376 00826000
         ALR   @04,@08                                             0376 00827000
         AL    @04,@CF01103                                        0376 00828000
         CLI   ENTTYP-4(@04),C'0'                                  0376 00829000
         BNE   @RF00376                                            0376 00830000
*            CATNAME = ENTVAL(ENT);                        /*#YL026UA*/ 00831000
         AL    @08,@TF00001                                        0377 00832000
         AL    @08,@CF01104                                        0377 00833000
         MVC   CATNAME(44),ENTVAL-5(@08)                           0377 00834000
*          ELSE                                                    0378 00835000
*SAMECAT:    DO;                                           /*#Y30SSFR*/ 00836000
         B     @RC00376                                            0378 00837000
@RF00376 DS    0H                                                  0378 00838000
SAMECAT  DS    0H                                                  0379 00839000
*            /********************************************************/ 00840000
*            /*                                              #Y30SSFR*/ 00841000
*            /*  INITIALIZE THE NOTFOUND FLAG TO OFF.  IF    #Y30SSFR*/ 00842000
*            /*  THE CATALOG LOCATE DONE IN FINDTYPE RETURNS #Y30SSFR*/ 00843000
*            /*  INDICATING THAT THE ENTRY WAS NOT IN THE    #Y30SSFR*/ 00844000
*            /*  CATALOG, THIS FLAG IS SET TO ON.            #Y30SSFR*/ 00845000
*            /*                                              #Y30SSFR*/ 00846000
*            /********************************************************/ 00847000
*                                                                  0379 00848000
*            NOTFOUND = OFF;                               /*#Y30SSFR*/ 00849000
*                                                                  0379 00850000
         NI    NOTFOUND,B'01111111'                                0379 00851000
*            /********************************************************/ 00852000
*            /*                                              #Y30SSFR*/ 00853000
*            /*  SET COREFLAG TO OFF TO INDICATE THAT WE     #Y30SSFR*/ 00854000
*            /*  HAVE NOT GOTTEN ANY CORE AS YET DURING THE  #Y30SSFR*/ 00855000
*            /*  DELETION OF THIS ENTRY.                     #Y30SSFR*/ 00856000
*            /*                                              #Y30SSFR*/ 00857000
*            /********************************************************/ 00858000
*                                                                  0380 00859000
*            COREFLAG = OFF;                               /*#Y30SSFR*/ 00860000
*                                                                  0380 00861000
         NI    COREFLAG,B'01111111'                                0380 00862000
*            /********************************************************/ 00863000
*            /*                                              #Y30SSFR*/ 00864000
*            /*  IF THE ENTRY TYPE WAS NOT SPECIFIED ON THE DELETE   */ 00865000
*            /*  COMMAND, DO A CATALOG LOCATE TO DETERMINE THE TYPE. */ 00866000
*            /*                                              @Y30SSFR*/ 00867000
*            /********************************************************/ 00868000
*                                                                  0381 00869000
*            IF TYPEFLAG = OFF & ENTRYRC < LASTCC08                0381 00870000
*              THEN                                                0381 00871000
*                                                                  0381 00872000
         TM    TYPEFLAG,B'10000000'                                0381 00873000
         BNZ   @RF00381                                            0381 00874000
         C     ENTRYRC,@CF00179                                    0381 00875000
         BNL   @RF00381                                            0381 00876000
*                /****************************************************/ 00877000
*                /*                                          @Y30SSFR*/ 00878000
*                /*  TEST TO DETERMINE IF A GENERIC LOCATE   @Y30SSFR*/ 00879000
*                /*  HAS ALREADY BEEN DONE.  IF SO, THEN     @Y30SSFR*/ 00880000
*                /*  THE ENTRY TYPE HAS BEEN RETURNED BY     @Y30SSFR*/ 00881000
*                /*  GENERIC LOCATE, AND SO THERE IS NO      @Y30SSFR*/ 00882000
*                /*  NEED TO DO AN ORDINARY VSAM LOCATE.     @Y30SSFR*/ 00883000
*                /*                                          @Y30SSFR*/ 00884000
*                /****************************************************/ 00885000
*                                                                  0382 00886000
*                IF NTRYPOS(INDEX) = 0                             0382 00887000
*                  THEN                                            0382 00888000
         LH    @08,INDEX                                           0382 00889000
         MH    @08,@CH01079                                        0382 00890000
         L     @04,@PC00001+4                                      0382 00891000
         L     @04,FDTPTR(,@04)                                    0382 00892000
         AL    @04,@CF01102                                        0382 00893000
         SLR   @02,@02                                             0382 00894000
         IC    @02,NTRYPOS-11(@08,@04)                             0382 00895000
         C     @02,@CF00115                                        0382 00896000
         BNE   @RF00382                                            0382 00897000
*                    DO;                                   /*@Y30SSFR*/ 00898000
*                                                                  0383 00899000
*                    /************************************************/ 00900000
*                    /*                                      @Y30SSFR*/ 00901000
*                    /*  THE NAME GIVEN BY THE USER WAS AN   @Y30SSFR*/ 00902000
*                    /*  ORDINARY, NON-GENERIC NAME.  AS NO  @Y30SSFR*/ 00903000
*                    /*  TYPE WAS SPECIFIED, CALL FINDTYPE   @Y30SSFR*/ 00904000
*                    /*  TO DO A VSAM LOCATE.  TEST THE      @Y30SSFR*/ 00905000
*                    /*  RETURN CODE FROM FINDTYPE, AND SET  @Y30SSFR*/ 00906000
*                    /*  ENTRYRC ACCORDINGLY.                @Y30SSFR*/ 00907000
*                    /*                                      @Y30SSFR*/ 00908000
*                    /************************************************/ 00909000
*                                                                  0384 00910000
*                    CALL FINDTYPE (INDEX,LOCTYPE);        /*@Y30SSFR*/ 00911000
         LA    @08,INDEX                                           0384 00912000
         ST    @08,@AL00001                                        0384 00913000
         LA    @08,LOCTYPE                                         0384 00914000
         ST    @08,@AL00001+4                                      0384 00915000
         LA    @01,@AL00001                                        0384 00916000
         BAL   @14,FINDTYPE                                        0384 00917000
*                    RESPECIFY RTNREG RSTD;                        0385 00918000
*                    TESTRC = RTNREG;                              0386 00919000
         LR    TESTRC,RTNREG                                       0386 00920000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSFR*/ 00921000
*                    ENTRYRC = MAX(ENTRYRC,TESTRC);        /*@Y30SSFR*/ 00922000
         CR    ENTRYRC,TESTRC                                      0388 00923000
         BNL   *+6                                                      00924000
         LR    ENTRYRC,TESTRC                                      0388 00925000
*                    END;                                  /*@Y30SSFR*/ 00926000
*                  ELSE                                            0390 00927000
*                                                                  0390 00928000
*                    /************************************************/ 00929000
*                    /*                                      @Y30SSFR*/ 00930000
*                    /*  SET LOCTYPE FROM THE VALUE FOR THE  @Y30SSFR*/ 00931000
*                    /*  TYPE RETURNED BY THE GENERIC LOCATE @Y30SSFR*/ 00932000
*                    /*                                      @Y30SSFR*/ 00933000
*                    /************************************************/ 00934000
*                                                                  0390 00935000
*                    LOCTYPE = ENTTYP(ENT);                /*@Y30SSFR*/ 00936000
         B     @RC00382                                            0390 00937000
@RF00382 LR    @08,ENT                                             0390 00938000
         MH    @08,@CH01066                                        0390 00939000
         L     @04,GENWKPTR                                        0390 00940000
         ALR   @04,@08                                             0390 00941000
         AL    @04,@CF01103                                        0390 00942000
         MVC   LOCTYPE(1),ENTTYP-4(@04)                            0390 00943000
*                ELSE                                              0391 00944000
*                                                                  0391 00945000
*                  /**************************************************/ 00946000
*                  /*                                        @Y30SSFR*/ 00947000
*                  /*  SET LOCTYPE TO BLANK TO INDICATE THAT @Y30SSFR*/ 00948000
*                  /*  THE TYPE WAS SPECIFIED ON THE DELETE  @Y30SSFR*/ 00949000
*                  /*  COMMAND.                              @Y30SSFR*/ 00950000
*                  /*                                        @Y30SSFR*/ 00951000
*                  /**************************************************/ 00952000
*                                                                  0391 00953000
*                  LOCTYPE = ' ';                          /*@Y30SSFR*/ 00954000
*                                                                  0391 00955000
         B     @RC00381                                            0391 00956000
@RF00381 MVI   LOCTYPE,C' '                                        0391 00957000
*            /********************************************************/ 00958000
*            /*                                              @Y30SSFR*/ 00959000
*            /*  DETERMINE IF THERE ARE ANY INVALID OR INSUFFICIENT  */ 00960000
*            /*  PARAMETERS FOR THE DELETE FUNCTION WHICH WERE NOT   */ 00961000
*            /*  CHECKED BY THE READER/INTERPRETER BECAUSE THE TYPE  */ 00962000
*            /*  FIELD WAS NOT SPECIFIED ON THE DELETE COMMAND.      */ 00963000
*            /*  ALSO CHECK FOR INSUFFICIENT PARAMETERS IF NON-VSAM  */ 00964000
*            /*  TYPE WAS SPECIFIED BECAUSE READER/INTERPRETER DOES  */ 00965000
*            /*  NOT DO ALL PARAMETER CHECKING FOR NON-VSAM ENTRIES  */ 00966000
*            /*                                              @Y30SSFR*/ 00967000
*            /********************************************************/ 00968000
*                                                                  0392 00969000
*            IF ENTRYRC < LASTCC08 &                               0392 00970000
*              ((ADDR(NSCR) = NULLPTR  & ADDR(ALIEN) ^= NULLPTR) | 0392 00971000
*              TYPEFLAG = OFF)                                     0392 00972000
*              THEN                                                0392 00973000
@RC00381 C     ENTRYRC,@CF00179                                    0392 00974000
         BNL   @RF00392                                            0392 00975000
         SLR   @08,@08                                             0392 00976000
         L     @04,@PC00001+4                                      0392 00977000
         C     @08,FDTPTR+64(,@04)                                 0392 00978000
         BNE   @GL00015                                            0392 00979000
         C     @08,FDTPTR+56(,@04)                                 0392 00980000
         BNE   @RT00392                                            0392 00981000
@GL00015 TM    TYPEFLAG,B'10000000'                                0392 00982000
         BNZ   @RF00392                                            0392 00983000
@RT00392 DS    0H                                                  0393 00984000
*                DO;                                       /*@Y30SSFR*/ 00985000
*                CALL PARAMCHK (LOCTYPE);                  /*@Y30SSFR*/ 00986000
         LA    @08,LOCTYPE                                         0394 00987000
         ST    @08,@AL00001                                        0394 00988000
         LA    @01,@AL00001                                        0394 00989000
         BAL   @14,PARAMCHK                                        0394 00990000
*                RESPECIFY RTNREG RSTD;                            0395 00991000
*                TESTRC = RTNREG;                                  0396 00992000
         LR    TESTRC,RTNREG                                       0396 00993000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/ 00994000
*                ENTRYRC = MAX(ENTRYRC,TESTRC);            /*@Y30SSFR*/ 00995000
         CR    ENTRYRC,TESTRC                                      0398 00996000
         BNL   *+6                                                      00997000
         LR    ENTRYRC,TESTRC                                      0398 00998000
*                END;                                      /*@Y30SSFR*/ 00999000
*                                                                  0399 01000000
*            /********************************************************/ 01001000
*            /*                                              @Y30SSFR*/ 01002000
*            /*  BUILD THE CATALOG PARAMETER LIST FROM PARAMETERS    */ 01003000
*            /*  SPECIFIED ON THE DELETE COMMAND.            @Y30SSFR*/ 01004000
*            /*  CALL THE VSAM CATALOG TO DELETE THE CATALOG ENTRIES.*/ 01005000
*            /*  EXAMINE THE RETURN CODE AND ISSUE DELETION MESSAGES */ 01006000
*            /*                                              @Y30SSFR*/ 01007000
*            /********************************************************/ 01008000
*                                                                  0400 01009000
*            IF ENTRYRC < LASTCC08                                 0400 01010000
*              THEN                                                0400 01011000
@RF00392 C     ENTRYRC,@CF00179                                    0400 01012000
         BNL   @RF00400                                            0400 01013000
*                DO;                                       /*@Y30SSFR*/ 01014000
*                NODEL = OFF;                              /*@Y30SSFR*/ 01015000
         NI    NODEL,B'01111111'                                   0402 01016000
*                CALL BUILDCPL (INDEX,LOCTYPE);            /*@Y30SSFR*/ 01017000
         LA    @08,INDEX                                           0403 01018000
         ST    @08,@AL00001                                        0403 01019000
         LA    @08,LOCTYPE                                         0403 01020000
         ST    @08,@AL00001+4                                      0403 01021000
         LA    @01,@AL00001                                        0403 01022000
         BAL   @14,BUILDCPL                                        0403 01023000
*                RESPECIFY RTNREG RSTD;                            0404 01024000
*                TESTRC = RTNREG;                                  0405 01025000
         LR    TESTRC,RTNREG                                       0405 01026000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/ 01027000
*                ENTRYRC = MAX(TESTRC,ENTRYRC);            /*@Y30SSFR*/ 01028000
         CR    ENTRYRC,TESTRC                                      0407 01029000
         BNL   *+6                                                      01030000
         LR    ENTRYRC,TESTRC                                      0407 01031000
*                IF ENTRYRC < LASTCC08 & NODEL = OFF       /*@Y30SSFR*/ 01032000
*                  THEN                                            0408 01033000
         C     ENTRYRC,@CF00179                                    0408 01034000
         BNL   @RF00408                                            0408 01035000
         TM    NODEL,B'10000000'                                   0408 01036000
         BNZ   @RF00408                                            0408 01037000
*                    DO;                                   /*@Y30SSFR*/ 01038000
*                    CALL CATCALL;                         /*@Y30SSFR*/ 01039000
         BAL   @14,CATCALL                                         0410 01040000
*                    RESPECIFY RTNREG RSTD;                        0411 01041000
*                    TESTRC = RTNREG;                              0412 01042000
         LR    TESTRC,RTNREG                                       0412 01043000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSFR*/ 01044000
*                    ENTRYRC = MAX(TESTRC,ENTRYRC);        /*@Y30SSFR*/ 01045000
         CR    ENTRYRC,TESTRC                                      0414 01046000
         BNL   *+6                                                      01047000
         LR    ENTRYRC,TESTRC                                      0414 01048000
*                    END;                                  /*@Y30SSFR*/ 01049000
*                END;                                      /*@Y30SSFR*/ 01050000
*                                                                  0416 01051000
@RF00408 DS    0H                                                  0417 01052000
*            /********************************************************/ 01053000
*            /*                                              @Y30SSFR*/ 01054000
*            /*  IF THE ENTRY HAS BEEN DYNAMICALLY ALLOCATED @Y30SSFR*/ 01055000
*            /*  ISSUE THE UDEALLOC MACRO TO DEALLOCATE IT   @Y30SSFR*/ 01056000
*            /*                                              @Y30SSFR*/ 01057000
*            /********************************************************/ 01058000
*                                                                  0417 01059000
*            IF DEALLOC = ON                                       0417 01060000
*              THEN                                                0417 01061000
@RF00400 TM    DEALLOC,B'10000000'                                 0417 01062000
         BNO   @RF00417                                            0417 01063000
*                DO;                                       /*@Y30SSFR*/ 01064000
*                                                                  0418 01065000
*                /****************************************************/ 01066000
*                /*                                          @Y30SSFR*/ 01067000
*                /*  IF THE OBJECT THAT WAS DELETED WAS A    @Y30SSFR*/ 01068000
*                /*  NON-VSAM OBJECT,                        @Y30SSFR*/ 01069000
*                /*  SET ALLOPTUN TO BE ON TO INDICATE       @Y30SSFR*/ 01070000
*                /*  TO THE SYSTEM ADAPTOR THAT UDEALLOC     @Y30SSFR*/ 01071000
*                /*  IS TO OVERRIDE THE PERMANENT            @Y30SSFR*/ 01072000
*                /*  ALLOCATION DONE BY TSO ALLOCATE.        @Y30SSFR*/ 01073000
*                /*                                          @Y30SSFR*/ 01074000
*                /****************************************************/ 01075000
*                                                                  0419 01076000
*                IF (ADDR(ALIEN) ^= NULLPTR) |                     0419 01077000
*                   (LOCTYPE = CTGTALIN)                           0419 01078000
*                  THEN                                            0419 01079000
         L     @08,@PC00001+4                                      0419 01080000
         L     @08,FDTPTR+56(,@08)                                 0419 01081000
         LTR   @08,@08                                             0419 01082000
         BNZ   @RT00419                                            0419 01083000
         CLI   LOCTYPE,C'A'                                        0419 01084000
         BNE   @RF00419                                            0419 01085000
@RT00419 DS    0H                                                  0420 01086000
*                    ALLOPTUN = ON;                        /*@Y30SSFR*/ 01087000
*                                                                  0420 01088000
         L     @08,ALLPTR                                          0420 01089000
         OI    ALLOPTUN(@08),B'00010000'                           0420 01090000
*                /****************************************************/ 01091000
*                /*                                          #Y30SSFR*/ 01092000
*                /*  TURN DEALLOC OFF TO INDICATE THAT AN    #Y30SSFR*/ 01093000
*                /*  ATTEMPT HAS BEEN MADE TO UNALLOCATE     #Y30SSFR*/ 01094000
*                /*  THE OBJECT.  THEN ISSUE THE UDEALLOC    #Y30SSFR*/ 01095000
*                /*  MACRO TO DYNAMICALLY UNALLOCATE THE     #Y30SSFR*/ 01096000
*                /*  OBJECT USING THE SAME ALLAGL THAT WAS   #Y30SSFR*/ 01097000
*                /*  USED TO ALLOCATE IT.                    #Y30SSFR*/ 01098000
*                /*                                          #Y30SSFR*/ 01099000
*                /****************************************************/ 01100000
*                                                                  0421 01101000
*                DEALLOC = OFF;                            /*#Y30SSFR*/ 01102000
*                                                                  0421 01103000
@RF00419 NI    DEALLOC,B'01111111'                                 0421 01104000
*                CALL IDCSADL0(GDTTBL,ALLAGL);             /*#Y30SSFR*/ 01105000
*                                                                  0422 01106000
         L     @08,@PC00001                                        0422 01107000
         ST    @08,@AL00001                                        0422 01108000
         L     @04,ALLPTR                                          0422 01109000
         ST    @04,@AL00001+4                                      0422 01110000
         MVI   @AL00001+4,X'80'                                    0422 01111000
         L     @15,GDTDLC(,@08)                                    0422 01112000
         LA    @01,@AL00001                                        0422 01113000
         BALR  @14,@15                                             0422 01114000
*                /****************************************************/ 01115000
*                /*                                          #Y30SSFR*/ 01116000
*                /*  TEST THE RETURN CODE FROM UDEALLOC,     #Y30SSFR*/ 01117000
*                /*  AND SET ENTRYRC TO BE THE MAXIMUM OF    #Y30SSFR*/ 01118000
*                /*  ITS CURRENT VALUE AND THE RETURN CODE   #Y30SSFR*/ 01119000
*                /*  FROM UDEALLOC.                          #Y30SSFR*/ 01120000
*                /*                                          #Y30SSFR*/ 01121000
*                /****************************************************/ 01122000
*                                                                  0423 01123000
*                RESPECIFY RTNREG RSTD;                            0423 01124000
*                TESTRC = RTNREG;                                  0424 01125000
         LR    TESTRC,RTNREG                                       0424 01126000
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/ 01127000
*                ENTRYRC = MAX(TESTRC,ENTRYRC);            /*#Y30SSFR*/ 01128000
         CR    ENTRYRC,TESTRC                                      0426 01129000
         BNL   *+6                                                      01130000
         LR    ENTRYRC,TESTRC                                      0426 01131000
*                END;                                      /*#Y30SSFR*/ 01132000
*                                                                  0427 01133000
*            /********************************************************/ 01134000
*            /*                                              #Y30SSFR*/ 01135000
*            /*  IF THE DATA SET WAS ALREADY ALLOCATED AND   #Y30SSFR*/ 01136000
*            /*  ONE OF THE FOLLOWING THREE CONDITIONS IS    #Y30SSFR*/ 01137000
*            /*  MET, DEALLOCATE IT WITH THE UDEALLOC MACRO. #Y30SSFR*/ 01138000
*            /*  1.  THE DATA SET WAS NOT FOUND BY LOCATE.   #Y30SSFR*/ 01139000
*            /*  2.  THE DATA SET IS DECLARED BY THE USER TO #Y30SSFR*/ 01140000
*            /*  BE NONVSAM.                                 #Y30SSFR*/ 01141000
*            /*  3. THE LOCATE DONE IN FINDTYPE SHOWS THE    #Y30SSFR*/ 01142000
*            /*  DATA SET TO BE NONVSAM.                     #Y30SSFR*/ 01143000
*            /*                                              #Y30SSFR*/ 01144000
*            /********************************************************/ 01145000
*                                                                  0428 01146000
*            ELSE                                          /*#Y30SSFR*/ 01147000
*              IF ((NOTFOUND = ON)                         /*@OZ11656*/ 01148000
*                | (ADDR (ALIEN) ^= NULLPTR)               /*@Y30SSFR*/ 01149000
*                | (LOCTYPE = CTGTALIN)) & DEALLOC = ON    /*@OZ11656*/ 01150000
*                THEN                                      /*#Y30SSFR*/ 01151000
         B     @RC00417                                            0428 01152000
@RF00417 TM    NOTFOUND,B'10000000'                                0428 01153000
         BO    @GL00019                                            0428 01154000
         L     @08,@PC00001+4                                      0428 01155000
         L     @08,FDTPTR+56(,@08)                                 0428 01156000
         LTR   @08,@08                                             0428 01157000
         BNZ   @GL00019                                            0428 01158000
         CLI   LOCTYPE,C'A'                                        0428 01159000
         BNE   @RF00428                                            0428 01160000
@GL00019 TM    DEALLOC,B'10000000'                                 0428 01161000
         BNO   @RF00428                                            0428 01162000
*                  DO;                                     /*#Y30SSFR*/ 01163000
*                  ALLPTR = ADDR(ALLLIST);                 /*#Y30SSFR*/ 01164000
         LA    @08,ALLLIST                                         0430 01165000
         ST    @08,ALLPTR                                          0430 01166000
*                  ALLAGL = ''B;                           /*#Y30SSFR*/ 01167000
         XC    ALLAGL(31,@08),ALLAGL(@08)                          0431 01168000
*                  ALLDSN = ADDR(ENTVAL(ENT));             /*#Y30SSFR*/ 01169000
*                                                                  0432 01170000
         LR    @04,ENT                                             0432 01171000
         MH    @04,@CH01066                                        0432 01172000
         L     @02,GENWKPTR                                        0432 01173000
         AL    @02,@CF01104                                        0432 01174000
         LA    @04,ENTVAL-5(@04,@02)                               0432 01175000
         ST    @04,ALLDSN(,@08)                                    0432 01176000
*                  /**************************************************/ 01177000
*                  /*                                        #Y30SSFR*/ 01178000
*                  /*  SET ALLOPTUN TO BE ON TO INDICATE     #Y30SSFR*/ 01179000
*                  /*  TO THE SYSTEM ADAPTOR THAT UDEALLOC   #Y30SSFR*/ 01180000
*                  /*  IS TO OVERRIDE THE PERMANENT          #Y30SSFR*/ 01181000
*                  /*  ALLOCATION DONE BY TSO ALLOCATE.      #Y30SSFR*/ 01182000
*                  /*                                        #Y30SSFR*/ 01183000
*                  /**************************************************/ 01184000
*                                                                  0433 01185000
*                  ALLOPTUN = ON;                          /*#Y30SSFR*/ 01186000
*                                                                  0433 01187000
         OI    ALLOPTUN(@08),B'00010000'                           0433 01188000
*                  /**************************************************/ 01189000
*                  /*                                        #Y30SSFR*/ 01190000
*                  /*  IF THE USER SPECIFIED NOSCRATCH       #Y30SSFR*/ 01191000
*                  /*  EXPLICITLY, THEN DEALLOCATE WITH      #Y30SSFR*/ 01192000
*                  /*  DISPOSITION KEEP.  OTHERWISE,         #Y30SSFR*/ 01193000
*                  /*  DEALLOCATE WITH DISPOSITION DELETE.   #Y30SSFR*/ 01194000
*                  /*                                        #Y30SSFR*/ 01195000
*                  /**************************************************/ 01196000
*                                                                  0434 01197000
*                  IF ADDR(NSCR) ^= NULLPTR                /*#Y30SSFR*/ 01198000
*                    THEN                                  /*#Y30SSFR*/ 01199000
         L     @04,@PC00001+4                                      0434 01200000
         L     @04,FDTPTR+64(,@04)                                 0434 01201000
         LTR   @04,@04                                             0434 01202000
         BZ    @RF00434                                            0434 01203000
*                      ALLDSPKP = ON;                      /*#Y30SSFR*/ 01204000
         OI    ALLDSPKP(@08),B'00001000'                           0435 01205000
*                    ELSE                                  /*#Y30SSFR*/ 01206000
*                      ALLDSPDE = ON;                      /*#Y30SSFR*/ 01207000
*                                                                  0436 01208000
         B     @RC00434                                            0436 01209000
@RF00434 L     @08,ALLPTR                                          0436 01210000
         OI    ALLDSPDE(@08),B'00000100'                           0436 01211000
*                  /**************************************************/ 01212000
*                  /*                                        #Y30SSFR*/ 01213000
*                  /*  ISSUE THE UDEALLOC AND SAVE THE       #Y30SSFR*/ 01214000
*                  /*  RETURN CODE.                          #Y30SSFR*/ 01215000
*                  /*                                        #Y30SSFR*/ 01216000
*                  /**************************************************/ 01217000
*                                                                  0437 01218000
*                  CALL IDCSADL0(GDTTBL,ALLAGL);           /*#Y30SSFR*/ 01219000
@RC00434 L     @08,@PC00001                                        0437 01220000
         ST    @08,@AL00001                                        0437 01221000
         L     @04,ALLPTR                                          0437 01222000
         ST    @04,@AL00001+4                                      0437 01223000
         MVI   @AL00001+4,X'80'                                    0437 01224000
         L     @15,GDTDLC(,@08)                                    0437 01225000
         LA    @01,@AL00001                                        0437 01226000
         BALR  @14,@15                                             0437 01227000
*                  RESPECIFY RTNREG RSTD;                          0438 01228000
*                  TESTRC = RTNREG;                                0439 01229000
         LR    TESTRC,RTNREG                                       0439 01230000
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/ 01231000
*                  ENTRYRC = MAX(TESTRC,ENTRYRC);          /*#Y30SSFR*/ 01232000
         CR    ENTRYRC,TESTRC                                      0441 01233000
         BNL   *+6                                                      01234000
         LR    ENTRYRC,TESTRC                                      0441 01235000
*                  END;                                    /*#Y30SSFR*/ 01236000
*                                                                  0442 01237000
*            /********************************************************/ 01238000
*            /*                                              #Y30SSFR*/ 01239000
*            /*  IF ANY CORE HAS BEEN GOTTEN WHILE DELETING  #Y30SSFR*/ 01240000
*            /*  THE PRESENT ITEM, ISSUE A UFPOOL TO FREE    #Y30SSFR*/ 01241000
*            /*  IT PRIOR TO GOING ON TO THE NEXT ITEM.      #Y30SSFR*/ 01242000
*            /*                                              #Y30SSFR*/ 01243000
*            /********************************************************/ 01244000
*                                                                  0443 01245000
*            IF COREFLAG = ON                              /*#Y30SSFR*/ 01246000
*              THEN                                        /*#Y30SSFR*/ 01247000
@RF00428 DS    0H                                                  0443 01248000
@RC00417 TM    COREFLAG,B'10000000'                                0443 01249000
         BNO   @RF00443                                            0443 01250000
*                DO;                                       /*#Y30SSFR*/ 01251000
*                                                                  0444 01252000
*                /****************************************************/ 01253000
*                /*                                          #Y30SSFR*/ 01254000
*                /*  ISSUE THE UFPOOL, AND TEST THE RETURN   #Y30SSFR*/ 01255000
*                /*  CODE.  IDCDL01 WILL ATTEMPT TO DELETE   #Y30SSFR*/ 01256000
*                /*  ANY REMAINING ITEMS ALTHOUGH ITS CHANCES#Y30SSFR*/ 01257000
*                /*  OF SUCCESS ARE POOR IF STORAGE CANNOT   #Y30SSFR*/ 01258000
*                /*  BE FREED.                               #Y30SSFR*/ 01259000
*                /*                                          #Y30SSFR*/ 01260000
*                /****************************************************/ 01261000
*                                                                  0445 01262000
*                CALL IDCSAFP0(GDTTBL,DLUGPFG1);           /*#Y30SSFR*/ 01263000
*                                                                  0445 01264000
         L     @08,@PC00001                                        0445 01265000
         ST    @08,@AL00001                                        0445 01266000
         LA    @04,DLUGPFG1                                        0445 01267000
         ST    @04,@AL00001+4                                      0445 01268000
         MVI   @AL00001+4,X'80'                                    0445 01269000
         L     @15,GDTFPL(,@08)                                    0445 01270000
         LA    @01,@AL00001                                        0445 01271000
         BALR  @14,@15                                             0445 01272000
*                RESPECIFY RTNREG RSTD;                            0446 01273000
*                TESTRC = RTNREG;                                  0447 01274000
         LR    TESTRC,RTNREG                                       0447 01275000
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/ 01276000
*                IF TESTRC ^= 0                            /*#Y30SSFR*/ 01277000
*                  THEN                                    /*#Y30SSFR*/ 01278000
         LTR   TESTRC,TESTRC                                       0449 01279000
         BZ    @RF00449                                            0449 01280000
*                    ENTRYRC = MAX(TESTRC,ENTRYRC);        /*#Y30SSFR*/ 01281000
         CR    ENTRYRC,TESTRC                                      0450 01282000
         BNL   *+6                                                      01283000
         LR    ENTRYRC,TESTRC                                      0450 01284000
*                    END;                                  /*#Y30SSFR*/ 01285000
*                                                                  0451 01286000
@RF00449 DS    0H                                                  0452 01287000
*            /********************************************************/ 01288000
*            /*                                              #Y30SSFR*/ 01289000
*            /*  IF THE RETURN CODE FOR THIS ENTRY INDICATES NO ENTRY*/ 01290000
*            /*  WAS DELETED, ISSUE A MESSAGE THAT THE ENTRY WAS NOT */ 01291000
*            /*  DELETED.                                    #Y30SSFR*/ 01292000
*            /*                                              #Y30SSFR*/ 01293000
*            /********************************************************/ 01294000
*                                                                  0452 01295000
*            IF ENTRYRC = LASTCC08                         /*#Y30SSFR*/ 01296000
*              THEN                                        /*#Y30SSFR*/ 01297000
@RF00443 C     ENTRYRC,@CF00179                                    0452 01298000
         BNE   @RF00452                                            0452 01299000
*                DO;                                       /*#Y30SSFR*/ 01300000
*                DARGSMOD = DELMSG;                        /*#Y30SSFR*/ 01301000
         L     @08,DDSTRU                                          0454 01302000
         MVC   DARGSMOD(3,@08),@CC00888                            0454 01303000
*                DARGSENT = NODELMSG;                      /*#Y30SSFR*/ 01304000
         MVI   DARGSENT(@08),X'08'                                 0455 01305000
*                DARGDBP = ADDR (ENTVAL(ENT));             /*#Y30SSFR*/ 01306000
         LR    @04,ENT                                             0456 01307000
         MH    @04,@CH01066                                        0456 01308000
         L     @02,GENWKPTR                                        0456 01309000
         AL    @02,@CF01104                                        0456 01310000
         LA    @04,ENTVAL-5(@04,@02)                               0456 01311000
         ST    @04,DARGDBP(,@08)                                   0456 01312000
*                DARGILP = LENGTH(ENTVAL(ENT));            /*#Y30SSFR*/ 01313000
*                                                                  0457 01314000
         MVC   DARGILP(2,@08),@CH00605                             0457 01315000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*#Y30SSFR*/ 01316000
*                                                                  0458 01317000
         L     @08,@PC00001                                        0458 01318000
         ST    @08,@AL00001                                        0458 01319000
         LA    @04,@CF00115                                        0458 01320000
         ST    @04,@AL00001+4                                      0458 01321000
         LA    @04,DDSTRU                                          0458 01322000
         ST    @04,@AL00001+8                                      0458 01323000
         MVI   @AL00001+8,X'80'                                    0458 01324000
         L     @15,GDTPRT(,@08)                                    0458 01325000
         LA    @01,@AL00001                                        0458 01326000
         BALR  @14,@15                                             0458 01327000
*                END;                                      /*#Y30SSFR*/ 01328000
*                                                                  0459 01329000
*            /********************************************************/ 01330000
*            /*                                              #Y30SSFR*/ 01331000
*            /*  SET THE LAST CONDITION CODE TO THE MAXIMUM CODE     */ 01332000
*            /*  ENCOUNTERED FOR THIS ENTRY.                 #Y30SSFR*/ 01333000
*            /*                                              #Y30SSFR*/ 01334000
*            /********************************************************/ 01335000
*                                                                  0460 01336000
*            LASTCOND = MAX(ENTRYRC,LASTCOND);             /*#Y30SSFR*/ 01337000
@RF00452 L     @08,@PC00001+8                                      0460 01338000
         LH    @04,LASTCOND(,@08)                                  0460 01339000
         CR    @04,ENTRYRC                                         0460 01340000
         BNL   *+6                                                      01341000
         LR    @04,ENTRYRC                                         0460 01342000
         STH   @04,LASTCOND(,@08)                                  0460 01343000
*            ENTRYRC = 0;                                  /*#Y30SSFR*/ 01344000
         SLR   ENTRYRC,ENTRYRC                                     0461 01345000
*            END SAMECAT;                                  /*#Y30SSFR*/ 01346000
*                                                                  0462 01347000
*        /************************************************************/ 01348000
*        /*                                                  @Y30SSFR*/ 01349000
*        /*  RETURN TO THE CALLING PROCESSOR.                @Y30SSFR*/ 01350000
*        /*                                                  @Y30SSFR*/ 01351000
*        /************************************************************/ 01352000
*                                                                  0463 01353000
*        RETURN;                                           /*@Y30SSFR*/ 01354000
*                                                                  0463 01355000
@EL00002 DS    0H                                                  0463 01356000
@EF00002 DS    0H                                                  0463 01357000
@ER00002 LM    @14,@02,@SA00002                                    0463 01358000
         LM    @04,@12,@SA00002+20                                 0463 01359000
         BR    @14                                                 0463 01360000
*END DELTPROC;                                             /*@Y30SSFR*/ 01361000
         B     @EL00002                                            0464 01362000
*        /************************************************************/ 01363000
*        /*                                                          */ 01364000
*        /*  PROCEDURE NAME - FINDTYPE                               */ 01365000
*        /*                                                          */ 01366000
*        /*  FUNCTION - BUILD A CATALOG PARAMETER LIST AND A FIELD   */ 01367000
*        /*  PARAMETER LIST FOR A CATALOG LOCATE TO DETERMINE THE    */ 01368000
*        /*  TYPE OF ENTRY TO BE DELETED.  CALL THE CATALOG AND      */ 01369000
*        /*  ISSUE A MESSAGE IF THE RETURN CODE IS NOT OK.           */ 01370000
*        /*                                                          */ 01371000
*        /*  INPUT - FUNCTION DEFINITION TABLE, PRINT ARGUMENT LIST, */ 01372000
*        /*  AND AN INDEX TO THE ENTRY TO BE DELETED.                */ 01373000
*        /*                                                          */ 01374000
*        /*  OUTPUT - POINTER TO THE TYPE RETURNED BY THE CATALOG    */ 01375000
*        /*                                                          */ 01376000
*        /************************************************************/ 01377000
*                                                                  0465 01378000
*FINDTYPE: PROCEDURE (ENTID,           /*INDEX TO THE ENTRY TO DELETE*/ 01379000
*                    LTYPE);           /*TYPE OF ENTRY               */ 01380000
*                                                                  0465 01381000
FINDTYPE STM   @14,@12,@SA00003                                    0465 01382000
         MVC   @PC00003(8),0(@01)                                  0465 01383000
*        /************************************************************/ 01384000
*        /*                                                  @Y30SSFR*/ 01385000
*        /*  ARGUMENTS OF INVOCATION                         @Y30SSFR*/ 01386000
*        /*                                                  @Y30SSFR*/ 01387000
*        /************************************************************/ 01388000
*                                                                  0466 01389000
*        DCL ENTID FIXED(15);          /*INDEX TO THE ENTRY TO DELETE*/ 01390000
*        DCL LTYPE CHAR(1);            /*TYPE OF ENTRY RETURNED      */ 01391000
*                                      /*BY THIS PROCEDURE   @Y30SSFR*/ 01392000
*                                                                  0468 01393000
*        /************************************************************/ 01394000
*        /*                                                          */ 01395000
*        /*  LOCAL DECLARATIONS                                      */ 01396000
*        /*                                                          */ 01397000
*        /************************************************************/ 01398000
*                                                                  0468 01399000
*        DCL LCPLSAVE CHAR(LENGTH(CPLSTOR)) BDY(WORD);             0468 01400000
*                                      /*SAVE AREA FOR CPL BUILT FOR */ 01401000
*                                      /*LOCATE REQUEST              */ 01402000
*        DCL CATRC FIXED(15);          /*RETURN CODE FROM LOCATE     */ 01403000
*        DCL TYPEAREA CHAR(1) BASED(CTGFLPT(1));                   0470 01404000
*                                      /*TYPE RETURNED IN CATALOG    */ 01405000
*                                      /*LOCATE WORK AREA            */ 01406000
*        DCL NOTFNDRC FIXED(15) CONSTANT(8);               /*@YM06134*/ 01407000
*                        /*CATALOG RETURN CODE               @YM06134*/ 01408000
*                        /*AFTER LOCATE WHEN                 @YM06134*/ 01409000
*                        /*ENTRY IS NOT IN                   @YM06134*/ 01410000
*                        /*CATALOG.                          @YM06134*/ 01411000
*                                                                  0472 01412000
*        DCL ONE BIT(8) CONSTANT('01'X);                   /*@YM07850*/ 01413000
*                                      /*VALUE OF CATTR      @YM07850*/ 01414000
*                                      /*FIELD FOR PAGESPACE @YM07850*/ 01415000
*        OLDERID2 = NEWERID2;                                      0473 01416000
         L     @08,@PC00001                                        0473 01417000
         L     @08,GDTTR2(,@08)                                    0473 01418000
         MVC   @TS00001(95),NEWERID2(@08)                          0473 01419000
         MVC   OLDERID2(95,@08),@TS00001                           0473 01420000
*        NEWID2 = 'DLLC';                                          0474 01421000
*                                                                  0474 01422000
         MVC   NEWID2(4,@08),@CC00980                              0474 01423000
*        /************************************************************/ 01424000
*        /*                                                          */ 01425000
*        /*  IF THIS IS THE FIRST TIME A LOCATE IS ISSUED, SET UP    */ 01426000
*        /*  THE BASIC INFORMATION IN THE CATALOG PARAMETER LIST.    */ 01427000
*        /*  OTHERWISE, RESTORE THE SAVED PARAMETER LIST AND ONLY    */ 01428000
*        /*  SET UP THE ENTRY NAME,PASSWORD AND FIELD PARAMETER LIST.*/ 01429000
*        /*                                                          */ 01430000
*        /************************************************************/ 01431000
*                                                                  0475 01432000
*        IF LCPLINIT = OFF                                 /*@YL026UA*/ 01433000
*          THEN                                                    0475 01434000
         TM    LCPLINIT,B'10000000'                                0475 01435000
         BNZ   @RF00475                                            0475 01436000
*ONETIME:    DO;                                                   0476 01437000
ONETIME  DS    0H                                                  0477 01438000
*            LCPLINIT = ON;                                /*@YL026UA*/ 01439000
*                                                                  0477 01440000
         OI    LCPLINIT,B'10000000'                                0477 01441000
*            /********************************************************/ 01442000
*            /*                                                      */ 01443000
*            /*  INITIALIZE THE CATALOG PARAMETER LIST TO ZEROES     */ 01444000
*            /*                                                      */ 01445000
*            /********************************************************/ 01446000
*                                                                  0478 01447000
*            CPLSTOR = ''B;                                        0478 01448000
*                                                                  0478 01449000
         XC    CPLSTOR(40),CPLSTOR                                 0478 01450000
*            /********************************************************/ 01451000
*            /*                                                      */ 01452000
*            /*  SET FLAGS IN CATALOG PARAMETER LIST TO INDICATE     */ 01453000
*            /*  LOCATE REQUEST.                                     */ 01454000
*            /*                                                      */ 01455000
*            /********************************************************/ 01456000
*                                                                  0479 01457000
*            CTGNAME = ON;                                         0479 01458000
         L     @08,CTGPLPTR                                        0479 01459000
         OI    CTGNAME(@08),B'00000100'                            0479 01460000
*            CTGFUNC = CTGCMS;                             /*@YL026UA*/ 01461000
         NI    CTGFUNC(@08),B'10011111'                            0480 01462000
         OI    CTGFUNC(@08),B'10000000'                            0480 01463000
*            CTGNUM = ON;                                          0481 01464000
*            CTGAM0 = ON;                                          0482 01465000
         OI    CTGNUM(@08),B'00000011'                             0482 01466000
*            CTGOPTNS = CTGLTCAT;                          /*@YL026UA*/ 01467000
*                                                                  0483 01468000
         NI    CTGOPTNS(@08),B'00100111'                           0483 01469000
         OI    CTGOPTNS(@08),B'00100000'                           0483 01470000
*            /********************************************************/ 01471000
*            /*                                                      */ 01472000
*            /*  INDICATE THE NUMBER OF FIELD PARAMETER LISTS AND    */ 01473000
*            /*  SET UP THE POINTER TO THE FIELD PARAMETER LIST.     */ 01474000
*            /*                                                      */ 01475000
*            /********************************************************/ 01476000
*                                                                  0484 01477000
*            CTGNOFLD = 3;                                 /*@YL026UA*/ 01478000
         MVI   CTGNOFLD(@08),X'03'                                 0484 01479000
*            CTGFIELD(1) = ADDR(FPLTYPE);                  /*@YL026UA*/ 01480000
         LA    @04,FPLTYPE                                         0485 01481000
         ST    @04,CTGFIELD(,@08)                                  0485 01482000
*            CTGFIELD(2) = ADDR(FPLACB);                   /*@YL026UA*/ 01483000
         LA    @04,FPLACB                                          0486 01484000
         ST    @04,CTGFIELD+4(,@08)                                0486 01485000
*            CTGFIELD(3) = ADDR(FPLCATTR);                 /*@YL026UA*/ 01486000
*                                                                  0487 01487000
         LA    @04,FPLCATTR                                        0487 01488000
         ST    @04,CTGFIELD+8(,@08)                                0487 01489000
*            /********************************************************/ 01490000
*            /*                                                      */ 01491000
*            /*  SET THE CATALOG NAME (IF ANY) AND THE CATALOG       */ 01492000
*            /*  PASSWORD (IF ANY) IN THE CATALOG PARAMETER LIST.    */ 01493000
*            /*                                                      */ 01494000
*            /********************************************************/ 01495000
*                                                                  0488 01496000
*            IF ADDR(CATDD) = NULLPTR                              0488 01497000
*              THEN                                                0488 01498000
         L     @04,@PC00001+4                                      0488 01499000
         L     @04,FDTPTR+12(,@04)                                 0488 01500000
         LTR   @04,@04                                             0488 01501000
         BNZ   @RF00488                                            0488 01502000
*                DO;                                               0489 01503000
*                CTGCNAME = ON;        /*INDICATE NO ACB     @Y30SSFR*/ 01504000
         OI    CTGCNAME(@08),B'00000010'                           0490 01505000
*                IF CATNAME ^= BLANKS                              0491 01506000
*                  THEN                                            0491 01507000
         CLC   CATNAME(44),BLANKS                                  0491 01508000
         BE    @RF00491                                            0491 01509000
*                    CTGCAT = ADDR(CATNAME);               /*@YL026UA*/ 01510000
         LA    @04,CATNAME                                         0492 01511000
         ST    @04,CTGCAT(,@08)                                    0492 01512000
*                END;                                              0493 01513000
*              ELSE                                                0494 01514000
*                CTGCAT = ADDR(IOCCBP);                            0494 01515000
*                                                                  0494 01516000
         B     @RC00488                                            0494 01517000
@RF00488 L     @08,IOCSPTR                                         0494 01518000
         LA    @08,IOCCBP(,@08)                                    0494 01519000
         L     @04,CTGPLPTR                                        0494 01520000
         ST    @08,CTGCAT(,@04)                                    0494 01521000
*            IF ADDR(CAT) ^= NULLPTR & CATPLN ^= 0                 0495 01522000
*              THEN                                                0495 01523000
@RC00488 L     @08,@PC00001+4                                      0495 01524000
         L     @08,FDTPTR+8(,@08)                                  0495 01525000
         LTR   @08,@08                                             0495 01526000
         BZ    @RF00495                                            0495 01527000
         CLI   CATPLN(@08),0                                       0495 01528000
         BE    @RF00495                                            0495 01529000
*                CTGPSWD = ADDR(CATPAS);                           0496 01530000
*                                                                  0496 01531000
         LA    @08,CATPAS(,@08)                                    0496 01532000
         L     @04,CTGPLPTR                                        0496 01533000
         ST    @08,CTGPSWD(,@04)                                   0496 01534000
*            /********************************************************/ 01535000
*            /*                                                      */ 01536000
*            /*  SET THE ADDRESS OF THE WORK AREA IN THE CATALOG     */ 01537000
*            /*  PARAMETER LIST.                                     */ 01538000
*            /*                                                      */ 01539000
*            /********************************************************/ 01540000
*                                                                  0497 01541000
*            CTGWKA = ADDR(WORKAREA);                              0497 01542000
*                                                                  0497 01543000
@RF00495 LA    @08,WORKAREA                                        0497 01544000
         L     @04,CTGPLPTR                                        0497 01545000
         ST    @08,CTGWKA(,@04)                                    0497 01546000
*            /********************************************************/ 01547000
*            /*                                                      */ 01548000
*            /*  IF MORE THAN ONE LOCATE MUST BE ISSUED FOR MORE     */ 01549000
*            /*  THAN ONE ENTRY TO BE DELETED, SAVE THE CATALOG      */ 01550000
*            /*  PARAMETER LIST.                                     */ 01551000
*            /*                                                      */ 01552000
*            /********************************************************/ 01553000
*                                                                  0498 01554000
*            IF NTRYCNT > 1                                        0498 01555000
*              THEN                                                0498 01556000
         L     @08,@PC00001+4                                      0498 01557000
         L     @08,FDTPTR(,@08)                                    0498 01558000
         LH    @08,NTRYCNT(,@08)                                   0498 01559000
         C     @08,@CF00219                                        0498 01560000
         BNH   @RF00498                                            0498 01561000
*                LCPLSAVE = CPLSTOR;                               0499 01562000
         MVC   LCPLSAVE(40),CPLSTOR                                0499 01563000
*            END ONETIME;                                          0500 01564000
*                                                                  0500 01565000
*          /**********************************************************/ 01566000
*          /*                                                        */ 01567000
*          /*  IF THIS IS NOT THE FIRST LOCATE REQUEST, RESTORE THE  */ 01568000
*          /*  CATALOG PARAMETER LIST THAT WAS CONSTRUCTED FOR THE   */ 01569000
*          /*  FIRST LOCATE REQUEST.                                 */ 01570000
*          /*                                                        */ 01571000
*          /**********************************************************/ 01572000
*                                                                  0501 01573000
*          ELSE                                                    0501 01574000
*            CPLSTOR = LCPLSAVE;                                   0501 01575000
*                                                                  0501 01576000
         B     @RC00475                                            0501 01577000
@RF00475 MVC   CPLSTOR(40),LCPLSAVE                                0501 01578000
*        /************************************************************/ 01579000
*        /*                                                          */ 01580000
*        /*  SET THE ADDRESS OF THE ENTRY NAME AND THE ADDRESS OF    */ 01581000
*        /*  ENTRY PASSWORD IF THE CATALOG PASSWORD WAS NOT ALREADY  */ 01582000
*        /*  SPECIFIED.                                              */ 01583000
*        /*                                                          */ 01584000
*        /************************************************************/ 01585000
*                                                                  0502 01586000
*        CTGENT = ADDR(ENTVAL(ENT));                       /*@YL026UA*/ 01587000
@RC00475 L     @08,CTGPLPTR                                        0502 01588000
         LR    @04,ENT                                             0502 01589000
         MH    @04,@CH01066                                        0502 01590000
         L     @01,GENWKPTR                                        0502 01591000
         AL    @01,@CF01104                                        0502 01592000
         LA    @04,ENTVAL-5(@04,@01)                               0502 01593000
         ST    @04,CTGENT(,@08)                                    0502 01594000
*        IF CTGPSWD = NULLPTR & NTRYPLN(ENTID) ^= 0                0503 01595000
*          THEN                                                    0503 01596000
         SLR   @04,@04                                             0503 01597000
         C     @04,CTGPSWD(,@08)                                   0503 01598000
         BNE   @RF00503                                            0503 01599000
         L     @15,@PC00003                                        0503 01600000
         LH    @15,ENTID(,@15)                                     0503 01601000
         MH    @15,@CH01079                                        0503 01602000
         L     @14,@PC00001+4                                      0503 01603000
         L     @14,FDTPTR(,@14)                                    0503 01604000
         LA    @01,0(@15,@14)                                      0503 01605000
         AL    @01,@CF01099                                        0503 01606000
         SLR   @00,@00                                             0503 01607000
         IC    @00,NTRYPLN-2(,@01)                                 0503 01608000
         CR    @04,@00                                             0503 01609000
         BE    @RF00503                                            0503 01610000
*            CTGPSWD = ADDR(NTRYPAS(ENTID));                       0504 01611000
*                                                                  0504 01612000
         AL    @14,@CF01100                                        0504 01613000
         LA    @04,NTRYPAS-3(@15,@14)                              0504 01614000
         ST    @04,CTGPSWD(,@08)                                   0504 01615000
*        /************************************************************/ 01616000
*        /*                                                          */ 01617000
*        /*  BUILD THREE FPL'S--ONE FOR ENTYPE, ONE FOR      @Y30SSFR*/ 01618000
*        /*  CATACB, AND ONE FOR CATTR.                      @Y30SSFR*/ 01619000
*        /*                                                          */ 01620000
*        /************************************************************/ 01621000
*                                                                  0505 01622000
*        CTGFLPTR = ADDR(FPLTYPE);                         /*@YL026UA*/ 01623000
@RF00503 LA    CTGFLPTR,FPLTYPE                                    0505 01624000
*        FPLTYPE = ''B;                                    /*@YL026UA*/ 01625000
         XC    FPLTYPE(24),FPLTYPE                                 0506 01626000
*        CTGFLDNO = 1;                                             0507 01627000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0507 01628000
*        CTGFLDNM = ADDR(ENTTYPE);                                 0508 01629000
         LA    @08,ENTTYPE                                         0508 01630000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             0508 01631000
*        CTGFLPTR = ADDR(FPLACB);                          /*@YL026UA*/ 01632000
         LA    CTGFLPTR,FPLACB                                     0509 01633000
*        FPLACB = ''B;                                     /*@YL026UA*/ 01634000
         XC    FPLACB(24),FPLACB                                   0510 01635000
*        CTGFLDNO = 1;                                     /*@YL026UA*/ 01636000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0511 01637000
*        CTGFLDNM = ADDR(ACBADDR);                         /*@YL026UA*/ 01638000
         LA    @08,ACBADDR                                         0512 01639000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             0512 01640000
*        CTGFLPTR = ADDR(FPLCATTR);                        /*@YL026UA*/ 01641000
         LA    CTGFLPTR,FPLCATTR                                   0513 01642000
*        FPLCATTR = ''B;                                   /*@YL026UA*/ 01643000
         XC    FPLCATTR(24),FPLCATTR                               0514 01644000
*        CTGFLDNO = 1;                                     /*@YL026UA*/ 01645000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0515 01646000
*        CTGFLDNM = ADDR(CLUSATTR);                        /*@YL026UA*/ 01647000
         LA    @08,CLUSATTR                                        0516 01648000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             0516 01649000
*        /************************************************************/ 01650000
*        /*                                                          */ 01651000
*        /*  INITIALIZE THE CATALOG WORK AREA TO ZEROES AND CALL     */ 01652000
*        /*  THE VSAM CATALOG.                                       */ 01653000
*        /*                                                          */ 01654000
*        /************************************************************/ 01655000
*                                                                  0517 01656000
*        DO IND1 = 1 TO 2;                                 /*@Y30SSFR*/ 01657000
         LA    IND1,1                                              0517 01658000
@DL00517 DS    0H                                                  0518 01659000
*          ENTITEM(IND1) = ''B;                            /*@Y30SSFR*/ 01660000
         LR    @08,IND1                                            0518 01661000
         MH    @08,@CH01066                                        0518 01662000
         L     @04,WAPTR                                           0518 01663000
         ALR   @04,@08                                             0518 01664000
         AL    @04,@CF01103                                        0518 01665000
         XC    ENTITEM-4(45,@04),ENTITEM-4(@04)                    0518 01666000
*        END;                                              /*@Y30SSFR*/ 01667000
         AL    IND1,@CF00219                                       0519 01668000
         C     IND1,@CF00153                                       0519 01669000
         BNH   @DL00517                                            0519 01670000
*        RETURNLN = 0;                                     /*@Y30SSFR*/ 01671000
         SLR   @08,@08                                             0520 01672000
         L     @04,WAPTR                                           0520 01673000
         STH   @08,RETURNLN(,@04)                                  0520 01674000
*        AREALN = 2*LENGTH(ENTITEM)+4;                     /*@Y30SSFR*/ 01675000
         MVC   AREALN(2,@04),@CH01081                              0521 01676000
*        IF GDTDBG = NULLPTR                                       0522 01677000
*          THEN;                                                   0522 01678000
         L     @04,@PC00001                                        0522 01679000
         C     @08,GDTDBG(,@04)                                    0522 01680000
         BE    @RT00522                                            0522 01681000
*          ELSE                                                    0524 01682000
*            CALL IDCDB010 (GDTTBL,'DLLB');                        0524 01683000
         L     @08,@PC00001                                        0524 01684000
         ST    @08,@AL00001                                        0524 01685000
         LA    @04,@CC00983                                        0524 01686000
         ST    @04,@AL00001+4                                      0524 01687000
         MVI   @AL00001+4,X'80'                                    0524 01688000
         L     @15,GDTDBG(,@08)                                    0524 01689000
         LA    @01,@AL00001                                        0524 01690000
         BALR  @14,@15                                             0524 01691000
*                                                          /*@YL026UA*/ 01692000
*                                                                  0525 01693000
*        CALL IDCSACA0 (GDTTBL,CTGPLPTR);                          0525 01694000
*                                                                  0525 01695000
@RT00522 L     @08,@PC00001                                        0525 01696000
         ST    @08,@AL00001                                        0525 01697000
         LA    @04,CTGPLPTR                                        0525 01698000
         ST    @04,@AL00001+4                                      0525 01699000
         L     @15,GDTCAT(,@08)                                    0525 01700000
         LA    @01,@AL00001                                        0525 01701000
         BALR  @14,@15                                             0525 01702000
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/ 01703000
*        CATRC = REG15;                                            0527 01704000
         LR    CATRC,REG15                                         0527 01705000
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/ 01706000
*                                                                  0528 01707000
*        IF GDTDBG = NULLPTR                                       0529 01708000
*          THEN;                                                   0529 01709000
         L     @08,@PC00001                                        0529 01710000
         L     @08,GDTDBG(,@08)                                    0529 01711000
         LTR   @08,@08                                             0529 01712000
         BZ    @RT00529                                            0529 01713000
*          ELSE                                                    0531 01714000
*            CALL IDCDB010 (GDTTBL,'DLLA');                        0531 01715000
         L     @08,@PC00001                                        0531 01716000
         ST    @08,@AL00001                                        0531 01717000
         LA    @04,@CC00984                                        0531 01718000
         ST    @04,@AL00001+4                                      0531 01719000
         MVI   @AL00001+4,X'80'                                    0531 01720000
         L     @15,GDTDBG(,@08)                                    0531 01721000
         LA    @01,@AL00001                                        0531 01722000
         BALR  @14,@15                                             0531 01723000
*                                                          /*@YL026UA*/ 01724000
*                                                                  0532 01725000
*        /************************************************************/ 01726000
*        /*                                                          */ 01727000
*        /*  IF THE CATALOG RETURN CODE IS NOT SUCCESSFUL, ISSUE A   */ 01728000
*        /*  MESSAGE INDICATING THE RETURN CODE.                     */ 01729000
*        /*                                                          */ 01730000
*        /************************************************************/ 01731000
*                                                                  0532 01732000
*        IF CATRC ^= 0                                             0532 01733000
*          THEN                                                    0532 01734000
@RT00529 LTR   CATRC,CATRC                                         0532 01735000
         BZ    @RF00532                                            0532 01736000
*            DO;                                           /*@Y30SSFR*/ 01737000
*                                                                  0533 01738000
*            /********************************************************/ 01739000
*            /*                                              @Y30SSFR*/ 01740000
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     @Y30SSFR*/ 01741000
*            /*  ERROR CONVERSION TABLE.                     @Y30SSFR*/ 01742000
*            /*                                              @Y30SSFR*/ 01743000
*            /********************************************************/ 01744000
*                                                                  0534 01745000
*            ERRORTAB = ''B;                               /*@Y30SSFR*/ 01746000
*                                                                  0534 01747000
*                                                                  0534 01748000
         XC    ERRORTAB(32),ERRORTAB                               0534 01749000
*            /********************************************************/ 01750000
*            /*                                              @Y30SSFR*/ 01751000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    @Y30SSFR*/ 01752000
*            /*  THE ERROR CONVERSION TABLE.                 @Y30SSFR*/ 01753000
*            /*                                              @Y30SSFR*/ 01754000
*            /********************************************************/ 01755000
*                                                                  0535 01756000
*            ERCNVADR = ADDR(ERRORTAB);                    /*@Y30SSFR*/ 01757000
*                                                                  0535 01758000
         LA    @08,ERRORTAB                                        0535 01759000
         ST    @08,ERCNVADR                                        0535 01760000
*            /********************************************************/ 01761000
*            /*                                              @Y30SSFR*/ 01762000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  @Y30SSFR*/ 01763000
*            /*  IS A CATALOG ERROR.  SET ERCATLC TO BE ON   @Y30SSFR*/ 01764000
*            /*  TO INDICATE THAT THE ERROR OCCURRED ON A    @Y30SSFR*/ 01765000
*            /*  CATALOG LOCATE OPERATION.                   @Y30SSFR*/ 01766000
*            /*                                              @Y30SSFR*/ 01767000
*            /********************************************************/ 01768000
*                                                                  0536 01769000
*            ERCATLG = ON;                                 /*@Y30SSFR*/ 01770000
         OI    ERCATLG(@08),B'10000000'                            0536 01771000
*            ERCATLC = ON;                                 /*@Y30SSFR*/ 01772000
*                                                                  0537 01773000
         OI    ERCATLC(@08),B'10000000'                            0537 01774000
*            /********************************************************/ 01775000
*            /*                                              @Y30SSFR*/ 01776000
*            /*  SET ERCATRC TO CATRC, AND SET ERCPLPT TO    @Y30SSFR*/ 01777000
*            /*  POINT TO THE CPL FOR THE LOCATE OPERATION.  @Y30SSFR*/ 01778000
*            /*                                              @Y30SSFR*/ 01779000
*            /********************************************************/ 01780000
*                                                                  0538 01781000
*            ERCATRC = CATRC;                              /*@Y30SSFR*/ 01782000
         ST    CATRC,ERCATRC(,@08)                                 0538 01783000
*            ERCPLPT = CTGPLPTR;                           /*@Y30SSFR*/ 01784000
*                                                                  0539 01785000
         L     @04,CTGPLPTR                                        0539 01786000
         ST    @04,ERCPLPT(,@08)                                   0539 01787000
*            /********************************************************/ 01788000
*            /*                                              @Y30SSFR*/ 01789000
*            /*  SET A POINTER TO THE ENTRY NAME BEING       @Y30SSFR*/ 01790000
*            /*  LOCATED AGAINST IN THE ERROR CONVERSION     @Y30SSFR*/ 01791000
*            /*  TABLE.                                      @Y30SSFR*/ 01792000
*            /*                                              @Y30SSFR*/ 01793000
*            /********************************************************/ 01794000
*                                                                  0540 01795000
*            ERDSNM = CTGENT;                              /*@Y30SSFR*/ 01796000
*                                                                  0540 01797000
         L     @04,CTGENT(,@04)                                    0540 01798000
         ST    @04,ERDSNM(,@08)                                    0540 01799000
*            /********************************************************/ 01800000
*            /*                                              @Y30SSFR*/ 01801000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    @Y30SSFR*/ 01802000
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     @Y30SSFR*/ 01803000
*            /*                                              @Y30SSFR*/ 01804000
*            /********************************************************/ 01805000
*                                                                  0541 01806000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*@Y30SSFR*/ 01807000
*                                                                  0541 01808000
         L     @08,@PC00001                                        0541 01809000
         ST    @08,@AL00001                                        0541 01810000
         LA    @04,ERCNVADR                                        0541 01811000
         ST    @04,@AL00001+4                                      0541 01812000
         MVI   @AL00001+4,X'80'                                    0541 01813000
         L     @15,GDTERR(,@08)                                    0541 01814000
         LA    @01,@AL00001                                        0541 01815000
         BALR  @14,@15                                             0541 01816000
*            IF CATRC = NOTFNDRC                                   0542 01817000
*              THEN                                                0542 01818000
         C     CATRC,@CF00179                                      0542 01819000
         BNE   @RF00542                                            0542 01820000
*                NOTFOUND = ON;                            /*#YM06134*/ 01821000
         OI    NOTFOUND,B'10000000'                                0543 01822000
*            SETRC = LASTCC08;                                     0544 01823000
@RF00542 LA    SETRC,8                                             0544 01824000
*            END;                                                  0545 01825000
*                                                                  0545 01826000
*          /**********************************************************/ 01827000
*          /*                                                        */ 01828000
*          /*  IF THE LOCATE WAS SUCCESSFUL, SET THE ENTRY TYPE      */ 01829000
*          /*  TO RETURN TO THE MAIN PROCEDURE.                      */ 01830000
*          /*                                                @Y30SSFR*/ 01831000
*          /**********************************************************/ 01832000
*                                                                  0546 01833000
*          ELSE                                                    0546 01834000
*                                                                  0546 01835000
*            /********************************************************/ 01836000
*            /*                                              #Y30SSFR*/ 01837000
*            /*  IF THE TYPE RETURNED BY CATALOG IS 'C', AND #Y30SSFR*/ 01838000
*            /*  THE PAGESPACE BIT OF THE CATTR FIELD IS ON, @Y30SSFR*/ 01839000
*            /*  THEN THE OBJECT TO BE DELETED IS REALLY A   @Y30SSFR*/ 01840000
*            /*  PAGESPACE, AND LTYPE MUST BE SET TO 'P'.    @Y30SSFR*/ 01841000
*            /*                                              @Y30SSFR*/ 01842000
*            /********************************************************/ 01843000
*                                                                  0546 01844000
*            DO;                                                   0546 01845000
         B     @RC00532                                            0546 01846000
@RF00532 DS    0H                                                  0547 01847000
*            CTGFLPTR = ADDR(FPLCATTR);                    /*#YL026UA*/ 01848000
         LA    CTGFLPTR,FPLCATTR                                   0547 01849000
*            IF CTGFLPT(1) ^= NULLPTR &                            0548 01850000
*               LOCCATTR = ONE &                           /*#YM07850*/ 01851000
*               CTGFLNG(1) ^= NULLPTR &                    /*#YM07850*/ 01852000
*               ADDR(FPLTYPE) ->                           /*#YM07851*/ 01853000
*               CTGFLPT(1) -> TYPEAREA = 'C'               /*#YM07851*/ 01854000
*             THEN                                                 0548 01855000
         SLR   @08,@08                                             0548 01856000
         L     @04,CTGFLPT(,CTGFLPTR)                              0548 01857000
         CR    @04,@08                                             0548 01858000
         BE    @RF00548                                            0548 01859000
         CLI   LOCCATTR(@04),X'01'                                 0548 01860000
         BNE   @RF00548                                            0548 01861000
         C     @08,CTGFLNG(,CTGFLPTR)                              0548 01862000
         BE    @RF00548                                            0548 01863000
         LA    @04,FPLTYPE                                         0548 01864000
         L     @04,CTGFLPT(,@04)                                   0548 01865000
         CLI   TYPEAREA(@04),C'C'                                  0548 01866000
         BNE   @RF00548                                            0548 01867000
*              DO;                                         /*#YL026UA*/ 01868000
*              LTYPE = 'P';                                /*@Y30SSFR*/ 01869000
*                                                                  0550 01870000
         L     @04,@PC00003+4                                      0550 01871000
         MVI   LTYPE(@04),C'P'                                     0550 01872000
*              /******************************************************/ 01873000
*              /*                                            @Y30SSFR*/ 01874000
*              /*  IF THE OBJECT TO BE DELETED IS A PAGE     @Y30SSFR*/ 01875000
*              /*  SPACE, IT CANNOT BE ERASED.  PRINT AN     @Y30SSFR*/ 01876000
*              /*  ERROR MESSAGE, AND RETURN TO DELTPROC.    @Y30SSFR*/ 01877000
*              /*                                            @Y30SSFR*/ 01878000
*              /******************************************************/ 01879000
*                                                                  0551 01880000
*              IF ADDR(ERASE) ^= NULLPTR                           0551 01881000
*                THEN                                              0551 01882000
         L     @04,@PC00001+4                                      0551 01883000
         C     @08,FDTPTR+28(,@04)                                 0551 01884000
         BE    @RF00551                                            0551 01885000
*                  DO;                                     /*@Y30SSFR*/ 01886000
*                  DARGSMOD = DELMSG;                      /*#YL026UA*/ 01887000
         L     @04,DDSTRU                                          0553 01888000
         MVC   DARGSMOD(3,@04),@CC00888                            0553 01889000
*                  DARGSENT = ERAPARM;                     /*#YL026UA*/ 01890000
         MVI   DARGSENT(@04),X'03'                                 0554 01891000
*                  DARGDBP = NULLPTR;                      /*#YL026UA*/ 01892000
         ST    @08,DARGDBP(,@04)                                   0555 01893000
*                  DARGILP = 0;                            /*#YL026UA*/ 01894000
*                                                                  0556 01895000
         STH   @08,DARGILP(,@04)                                   0556 01896000
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   /*@Y30SSFR*/ 01897000
*                                                                  0557 01898000
         L     @08,@PC00001                                        0557 01899000
         ST    @08,@AL00001                                        0557 01900000
         LA    @04,@CF00115                                        0557 01901000
         ST    @04,@AL00001+4                                      0557 01902000
         LA    @04,DDSTRU                                          0557 01903000
         ST    @04,@AL00001+8                                      0557 01904000
         MVI   @AL00001+8,X'80'                                    0557 01905000
         L     @15,GDTPRT(,@08)                                    0557 01906000
         LA    @01,@AL00001                                        0557 01907000
         BALR  @14,@15                                             0557 01908000
*                  RETURN CODE(LASTCC08);                  /*#YL026UA*/ 01909000
         LA    @15,8                                               0558 01910000
         L     @14,@SA00003                                        0558 01911000
         LM    @00,@12,@SA00003+8                                  0558 01912000
         BR    @14                                                 0558 01913000
*                  END;                                    /*@Y30SSFR*/ 01914000
*              END;                                        /*#YL026UA*/ 01915000
*            ELSE                                                  0561 01916000
*                                                                  0561 01917000
*              /******************************************************/ 01918000
*              /*                                            @Y30SSFR*/ 01919000
*              /*  THE OBJECT TO BE DELETED IS NOT A PAGE    @Y30SSFR*/ 01920000
*              /*  SPACE.  SET THE VALUE OF LTYPE DIRECTLY   @Y30SSFR*/ 01921000
*              /*  FROM THE ENTYPE FIELD RETURNED BY         @Y30SSFR*/ 01922000
*              /*  CATALOG.                                  @Y30SSFR*/ 01923000
*              /*                                            @Y30SSFR*/ 01924000
*              /******************************************************/ 01925000
*                                                                  0561 01926000
*              DO;                                         /*#YL026UA*/ 01927000
         B     @RC00548                                            0561 01928000
@RF00548 DS    0H                                                  0562 01929000
*              CTGFLPTR = ADDR(FPLTYPE);                   /*#YL026UA*/ 01930000
         LA    CTGFLPTR,FPLTYPE                                    0562 01931000
*              LTYPE = TYPEAREA;                           /*#YL026UA*/ 01932000
         L     @08,@PC00003+4                                      0563 01933000
         L     @04,CTGFLPT(,CTGFLPTR)                              0563 01934000
         MVC   LTYPE(1,@08),TYPEAREA(@04)                          0563 01935000
*              END;                                        /*#YL026UA*/ 01936000
*                                                                  0564 01937000
*          /**********************************************************/ 01938000
*          /*                                                @Y30SSFR*/ 01939000
*          /*  POINT TO THE CATACB FPL, AND DETERMINE IF AN  @Y30SSFR*/ 01940000
*          /*  ACB ADDRESS FOR THE CATALOG HAS BEEN RETURNED @Y30SSFR*/ 01941000
*          /*  BY VSAM.  IF SO, SAVE THAT ADDRESS, AND SET   @Y30SSFR*/ 01942000
*          /*  A FLAG.                                       @Y30SSFR*/ 01943000
*          /*                                                @Y30SSFR*/ 01944000
*          /**********************************************************/ 01945000
*                                                                  0565 01946000
*            CTGFLPTR = ADDR(FPLACB);                      /*#YL026UA*/ 01947000
@RC00548 LA    CTGFLPTR,FPLACB                                     0565 01948000
*            IF ADDR(CATDD) = NULLPTR & CTGFLPT(1) ^= NULLPTR      0566 01949000
*              THEN                                                0566 01950000
         SLR   @08,@08                                             0566 01951000
         L     @04,@PC00001+4                                      0566 01952000
         C     @08,FDTPTR+12(,@04)                                 0566 01953000
         BNE   @RF00566                                            0566 01954000
         L     @04,CTGFLPT(,CTGFLPTR)                              0566 01955000
         CR    @04,@08                                             0566 01956000
         BE    @RF00566                                            0566 01957000
*                DO;                                       /*#YL026UA*/ 01958000
*                  ACBPTR = CTGFLPT(1) -> LOCACBPT;        /*#YL026UA*/ 01959000
         L     @08,LOCACBPT(,@04)                                  0568 01960000
         ST    @08,ACBPTR                                          0568 01961000
*                  ACBFLAG = ON;                           /*#YL026UA*/ 01962000
         OI    ACBFLAG,B'10000000'                                 0569 01963000
*                END;                                      /*#YL026UA*/ 01964000
*            SETRC = LASTCC00;                                     0571 01965000
@RF00566 SLR   SETRC,SETRC                                         0571 01966000
*            END;                                                  0572 01967000
*                                                                  0572 01968000
*        RETURN CODE(SETRC);                                       0573 01969000
*                                                                  0573 01970000
@RC00532 LR    @15,SETRC                                           0573 01971000
         L     @14,@SA00003                                        0573 01972000
         LM    @00,@12,@SA00003+8                                  0573 01973000
         BR    @14                                                 0573 01974000
*END FINDTYPE;                                                     0574 01975000
*        /************************************************************/ 01976000
*        /*                                                          */ 01977000
*        /*  PROCEDURE NAME - PARAMCHK                               */ 01978000
*        /*                                                          */ 01979000
*        /*  FUNCTION - DETERMINE WHETHER ANY INVALID OR             */ 01980000
*        /*  INSUFFICIENT PARAMETERS WERE SPECIFIED ON THE DELETE    */ 01981000
*        /*  COMMAND AND WERE NOT DETECTED BY THE READER/INTERPRETER */ 01982000
*        /*  BECAUSE THE TYPE HAD NOT BEEN SPECIFIED.                */ 01983000
*        /*                                                          */ 01984000
*        /*  INPUT - TYPE OF ENTRY AS DETERMINED BY LOCATE.          */ 01985000
*        /*                                                          */ 01986000
*        /*  OUTPUT - A MESSAGE INDICATING ANY INVALID PARAMETERS.   */ 01987000
*        /*                                                          */ 01988000
*        /************************************************************/ 01989000
*                                                                  0575 01990000
*PARAMCHK: PROCEDURE (ETYPE);          /*TYPE OF ENTRY               */ 01991000
*                                                                  0575 01992000
PARAMCHK STM   @14,@12,@SA00004                                    0575 01993000
         MVC   @PC00004(4),0(@01)                                  0575 01994000
*        /************************************************************/ 01995000
*        /*                                                          */ 01996000
*        /*  LOCAL DECLARATIONS                                      */ 01997000
*        /*                                                          */ 01998000
*        /************************************************************/ 01999000
*                                                                  0576 02000000
*        DCL ETYPE CHAR(1);            /*TYPE OF ENTRY TO BE DELETED */ 02001000
*                                                                  0577 02002000
*        OLDERID2 = NEWERID2;                                      0577 02003000
         L     @08,@PC00001                                        0577 02004000
         L     @15,GDTTR2(,@08)                                    0577 02005000
         MVC   @TS00001(95),NEWERID2(@15)                          0577 02006000
         MVC   OLDERID2(95,@15),@TS00001                           0577 02007000
*        NEWID2 = 'DLPC';                                          0578 02008000
         MVC   NEWID2(4,@15),@CC00990                              0578 02009000
*        SETRC = 0;                                        /*@Y30SSFR*/ 02010000
*                                                                  0579 02011000
         SLR   SETRC,SETRC                                         0579 02012000
*        /************************************************************/ 02013000
*        /*                                                          */ 02014000
*        /*  DETERMINE WHETHER THE TYPE IS INVALID FOR A DELETE.     */ 02015000
*        /*  IF THE TYPE IS INVALID, ISSUE AN ERROR MESSAGE.         */ 02016000
*        /*                                                          */ 02017000
*        /************************************************************/ 02018000
*                                                                  0580 02019000
*        IF ETYPE ^= CTGTCL & ETYPE ^= CTGTUCAT            /*@Y30SSFR*/ 02020000
*        & ETYPE ^= CTGTALIN & ETYPE ^= CTGTPGSP           /*@Y30SSFR*/ 02021000
*        & ETYPE ^= CTGTGBS & ETYPE ^= CTGTANM             /*@Y30SSFR*/ 02022000
*        & ETYPE ^= CTGTAIX & ETYPE ^= CTGTPTH             /*@Y30SSFR*/ 02023000
*        & ETYPE ^= ' '                                    /*@Y30SSFR*/ 02024000
*          THEN                                                    0580 02025000
         L     @15,@PC00004                                        0580 02026000
         CLI   ETYPE(@15),C'C'                                     0580 02027000
         BE    @RF00580                                            0580 02028000
         CLI   ETYPE(@15),C'U'                                     0580 02029000
         BE    @RF00580                                            0580 02030000
         CLI   ETYPE(@15),C'A'                                     0580 02031000
         BE    @RF00580                                            0580 02032000
         CLI   ETYPE(@15),C'P'                                     0580 02033000
         BE    @RF00580                                            0580 02034000
         CLI   ETYPE(@15),C'B'                                     0580 02035000
         BE    @RF00580                                            0580 02036000
         CLI   ETYPE(@15),C'X'                                     0580 02037000
         BE    @RF00580                                            0580 02038000
         CLI   ETYPE(@15),C'G'                                     0580 02039000
         BE    @RF00580                                            0580 02040000
         CLI   ETYPE(@15),C'R'                                     0580 02041000
         BE    @RF00580                                            0580 02042000
         CLI   ETYPE(@15),C' '                                     0580 02043000
         BE    @RF00580                                            0580 02044000
*            DO;                                                   0581 02045000
*            DARGSENT = BADTYPE;                                   0582 02046000
         L     @15,DDSTRU                                          0582 02047000
         MVI   DARGSENT(@15),X'02'                                 0582 02048000
*            DARGSMOD = DELMSG;                            /*@Y30SSFR*/ 02049000
         MVC   DARGSMOD(3,@15),@CC00888                            0583 02050000
*            DARGDBP = NULLPTR;                                    0584 02051000
         SLR   @14,@14                                             0584 02052000
         ST    @14,DARGDBP(,@15)                                   0584 02053000
*            DARGILP = 0;                                          0585 02054000
*                                                                  0585 02055000
         STH   @14,DARGILP(,@15)                                   0585 02056000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0586 02057000
*                                                                  0586 02058000
         ST    @08,@AL00001                                        0586 02059000
         LA    @15,@CF00115                                        0586 02060000
         ST    @15,@AL00001+4                                      0586 02061000
         LA    @15,DDSTRU                                          0586 02062000
         ST    @15,@AL00001+8                                      0586 02063000
         MVI   @AL00001+8,X'80'                                    0586 02064000
         L     @15,GDTPRT(,@08)                                    0586 02065000
         LA    @01,@AL00001                                        0586 02066000
         BALR  @14,@15                                             0586 02067000
*            SETRC = LASTCC08;                                     0587 02068000
         LA    SETRC,8                                             0587 02069000
*            END;                                                  0588 02070000
*                                                                  0588 02071000
*        /************************************************************/ 02072000
*        /*                                                          */ 02073000
*        /*  DETERMINE WHETHER THE ERASE OPTION WAS SPECIFIED FOR    */ 02074000
*        /*  A NON-VSAM, A MASTER CATALOG, A USER CATALOG,   #Y30SSFR*/ 02075000
*        /*  A PATH, A PAGESPACE, A GDG BASE, OR AN ALIAS.   #Y30SSFR*/ 02076000
*        /*  IF SO, ISSUE AN ERROR MESSAGE.                  #Y30SSFR*/ 02077000
*        /*                                                          */ 02078000
*        /************************************************************/ 02079000
*                                                                  0589 02080000
*        IF ETYPE ^= 'C' & ETYPE ^= 'G' &                  /*#Y30SSFR*/ 02081000
*        ADDR(ERASE) ^= NULLPTR                                    0589 02082000
*          THEN                                                    0589 02083000
@RF00580 L     @08,@PC00004                                        0589 02084000
         CLI   ETYPE(@08),C'C'                                     0589 02085000
         BE    @RF00589                                            0589 02086000
         CLI   ETYPE(@08),C'G'                                     0589 02087000
         BE    @RF00589                                            0589 02088000
         SLR   @08,@08                                             0589 02089000
         L     @15,@PC00001+4                                      0589 02090000
         C     @08,FDTPTR+28(,@15)                                 0589 02091000
         BE    @RF00589                                            0589 02092000
*            DO;                                                   0590 02093000
*            DARGSMOD = DELMSG;                                    0591 02094000
         L     @15,DDSTRU                                          0591 02095000
         MVC   DARGSMOD(3,@15),@CC00888                            0591 02096000
*            DARGSENT = ERAPARM;                                   0592 02097000
         MVI   DARGSENT(@15),X'03'                                 0592 02098000
*            DARGDBP = NULLPTR;                                    0593 02099000
         ST    @08,DARGDBP(,@15)                                   0593 02100000
*            DARGILP = 0;                                          0594 02101000
*                                                                  0594 02102000
         STH   @08,DARGILP(,@15)                                   0594 02103000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0595 02104000
*                                                                  0595 02105000
         L     @08,@PC00001                                        0595 02106000
         ST    @08,@AL00001                                        0595 02107000
         LA    @15,@CF00115                                        0595 02108000
         ST    @15,@AL00001+4                                      0595 02109000
         LA    @15,DDSTRU                                          0595 02110000
         ST    @15,@AL00001+8                                      0595 02111000
         MVI   @AL00001+8,X'80'                                    0595 02112000
         L     @15,GDTPRT(,@08)                                    0595 02113000
         LA    @01,@AL00001                                        0595 02114000
         BALR  @14,@15                                             0595 02115000
*            SETRC = LASTCC08;                                     0596 02116000
         LA    SETRC,8                                             0596 02117000
*            END;                                                  0597 02118000
*                                                                  0597 02119000
*        /************************************************************/ 02120000
*        /*                                                  #YL026UA*/ 02121000
*        /*  DETERMINE WHETHER THE SCRATCH OPTION WAS        #YL026UA*/ 02122000
*        /*  SPECIFIED FOR A TYPE OTHER THAN NONVSAM,        #Y30SSFR*/ 02123000
*        /*  AIX, CLUSTER, PAGESPACE, OR SPACE.  IF SO,      @Y30SSFR*/ 02124000
*        /*  ISSUE AN ERROR MESSAGE.                         #YL026UA*/ 02125000
*        /*                                                  #Y30SSFR*/ 02126000
*        /************************************************************/ 02127000
*                                                                  0598 02128000
*        IF (ETYPE ^= CTGTALIN &                           /*@Y30SSFR*/ 02129000
*            ETYPE ^= CTGTCL &                             /*@Y30SSFR*/ 02130000
*            ETYPE ^= CTGTAIX &                            /*@Y30SSFR*/ 02131000
*            ETYPE ^= CTGTPGSP) &                          /*@Y30SSFR*/ 02132000
*           ADDR(SCR) ^= NULLPTR &                         /*#Y30SSFR*/ 02133000
*          (ADDR(ALIEN) ^= NULLPTR &                       /*#Y30SSFR*/ 02134000
*           ADDR(CLUST) ^= NULLPTR &                       /*#Y30SSFR*/ 02135000
*           ADDR(AIX) ^= NULLPTR &                         /*@Y30SSFR*/ 02136000
*           ADDR(PGSPC) ^= NULLPTR &                       /*#Y30SSFR*/ 02137000
*           ADDR(SPACE) ^= NULLPTR)                        /*#Y30SSFR*/ 02138000
*          THEN                                            /*#YL026UA*/ 02139000
@RF00589 L     @08,@PC00004                                        0598 02140000
         CLI   ETYPE(@08),C'A'                                     0598 02141000
         BE    @RF00598                                            0598 02142000
         CLI   ETYPE(@08),C'C'                                     0598 02143000
         BE    @RF00598                                            0598 02144000
         CLI   ETYPE(@08),C'G'                                     0598 02145000
         BE    @RF00598                                            0598 02146000
         CLI   ETYPE(@08),C'P'                                     0598 02147000
         BE    @RF00598                                            0598 02148000
         SLR   @08,@08                                             0598 02149000
         L     @15,@PC00001+4                                      0598 02150000
         C     @08,FDTPTR+60(,@15)                                 0598 02151000
         BE    @RF00598                                            0598 02152000
         C     @08,FDTPTR+56(,@15)                                 0598 02153000
         BE    @RF00598                                            0598 02154000
         C     @08,FDTPTR+40(,@15)                                 0598 02155000
         BE    @RF00598                                            0598 02156000
         C     @08,FDTPTR+80(,@15)                                 0598 02157000
         BE    @RF00598                                            0598 02158000
         C     @08,FDTPTR+68(,@15)                                 0598 02159000
         BE    @RF00598                                            0598 02160000
         C     @08,FDTPTR+44(,@15)                                 0598 02161000
         BE    @RF00598                                            0598 02162000
*            DO;                                           /*#YL026UA*/ 02163000
*                                                                  0599 02164000
*            DARGSMOD = DELMSG;                            /*#YL026UA*/ 02165000
         L     @15,DDSTRU                                          0600 02166000
         MVC   DARGSMOD(3,@15),@CC00888                            0600 02167000
*            DARGSENT = SCRPARM;                           /*#YL026UA*/ 02168000
         MVI   DARGSENT(@15),X'07'                                 0601 02169000
*            DARGDBP = NULLPTR;                            /*#YL026UA*/ 02170000
         ST    @08,DARGDBP(,@15)                                   0602 02171000
*            DARGILP = 0;                                  /*#YL026UA*/ 02172000
*                                                                  0603 02173000
         STH   @08,DARGILP(,@15)                                   0603 02174000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*#YL026UA*/ 02175000
*                                                                  0604 02176000
         L     @08,@PC00001                                        0604 02177000
         ST    @08,@AL00001                                        0604 02178000
         LA    @15,@CF00115                                        0604 02179000
         ST    @15,@AL00001+4                                      0604 02180000
         LA    @15,DDSTRU                                          0604 02181000
         ST    @15,@AL00001+8                                      0604 02182000
         MVI   @AL00001+8,X'80'                                    0604 02183000
         L     @15,GDTPRT(,@08)                                    0604 02184000
         LA    @01,@AL00001                                        0604 02185000
         BALR  @14,@15                                             0604 02186000
*            SETRC = LASTCC08;                             /*#YL026UA*/ 02187000
         LA    SETRC,8                                             0605 02188000
*            END;                                          /*#YL026UA*/ 02189000
*                                                                  0606 02190000
*        /************************************************************/ 02191000
*        /*                                                          */ 02192000
*        /*  DETERMINE WHETHER THE FILE PARAMETER WAS SPECIFIED FOR  */ 02193000
*        /*  AN ALIEN TYPE WHEN THE SCRATCH OPTION WAS ALSO SPECIFIED*/ 02194000
*        /*  IF FILE WAS NOT SPECIFIED AND COULD NOT BE ALLOCATED,   */ 02195000
*        /*  ISSUE AN ERROR MESSAGE.                         #YL026UA*/ 02196000
*        /*                                                          */ 02197000
*        /************************************************************/ 02198000
*                                                                  0607 02199000
*        IF (ETYPE = CTGTALIN | ADDR(ALIEN) ^= NULLPTR) & ADDR(NSCR) =  02200000
*        NULLPTR & ADDR(INDD)=NULLPTR                              0607 02201000
*          THEN                                                    0607 02202000
*                                                                  0607 02203000
@RF00598 L     @08,@PC00004                                        0607 02204000
         CLI   ETYPE(@08),C'A'                                     0607 02205000
         BE    @GL00048                                            0607 02206000
         L     @08,@PC00001+4                                      0607 02207000
         L     @08,FDTPTR+56(,@08)                                 0607 02208000
         LTR   @08,@08                                             0607 02209000
         BZ    @RF00607                                            0607 02210000
@GL00048 SLR   @08,@08                                             0607 02211000
         L     @15,@PC00001+4                                      0607 02212000
         C     @08,FDTPTR+64(,@15)                                 0607 02213000
         BNE   @RF00607                                            0607 02214000
         C     @08,FDTPTR+16(,@15)                                 0607 02215000
         BNE   @RF00607                                            0607 02216000
*        /************************************************************/ 02217000
*        /*                                                  #YL026UA*/ 02218000
*        /*  SINCE FILE WAS NOT SPECIFIED ON THE DELETE COMMAND      */ 02219000
*        /*  THE DATA SET MUST BE DYNAMICALLY ALLOCATED.     #YL026UA*/ 02220000
*        /*  CALL ALLOPROC TO DO THE ACTUAL DYNAMIC          #Y30SSFR*/ 02221000
*        /*  ALLOCATION.                                     #Y30SSFR*/ 02222000
*        /*                                                  #YL026UA*/ 02223000
*        /************************************************************/ 02224000
*                                                                  0608 02225000
*            CALL ALLOPROC (ADDR(ENTVAL(ENT)),NULLPARM);   /*@Y30SSFR*/ 02226000
*                                                                  0608 02227000
         LR    @08,ENT                                             0608 02228000
         MH    @08,@CH01066                                        0608 02229000
         L     @01,GENWKPTR                                        0608 02230000
         AL    @01,@CF01104                                        0608 02231000
         LA    @08,ENTVAL-5(@08,@01)                               0608 02232000
         ST    @08,@AFTEMPS                                        0608 02233000
         LA    @08,@AFTEMPS                                        0608 02234000
         ST    @08,@AL00001                                        0608 02235000
         LA    @08,@CF00115                                        0608 02236000
         ST    @08,@AL00001+4                                      0608 02237000
         LA    @01,@AL00001                                        0608 02238000
         BAL   @14,ALLOPROC                                        0608 02239000
*        RETURN CODE(SETRC);                               /*@Y30SSFR*/ 02240000
*                                                                  0609 02241000
@RF00607 LR    @15,SETRC                                           0609 02242000
         L     @14,@SA00004                                        0609 02243000
         LM    @00,@12,@SA00004+8                                  0609 02244000
         BR    @14                                                 0609 02245000
*END PARAMCHK;                                             /*@Y30SSFR*/ 02246000
*        /************************************************************/ 02247000
*        /*                                                          */ 02248000
*        /*  PROCEDURE NAME - BUILDCPL                               */ 02249000
*        /*                                                          */ 02250000
*        /*  FUNCTION - CONSTRUCT THE CATALOG PARAMETER LIST FROM    */ 02251000
*        /*  PARAMETERS SPECIFIED ON THE DELETE COMMAND AND INDICATED*/ 02252000
*        /*  IN THE FUNCTION DEFINITION TABLE.                       */ 02253000
*        /*                                                          */ 02254000
*        /*  INPUT - FUNCTION DEFINITION TABLE, PRINT ARGUMENT LIST, */ 02255000
*        /*  AN INDEX TO THE ENTRY TO BE DELETED, AND THE TYPE OF    */ 02256000
*        /*  ENTRY TO BE DELETED.                                    */ 02257000
*        /*                                                          */ 02258000
*        /*  OUTPUT - CATALOG PARAMETER LIST AND WORK AREA.          */ 02259000
*        /*                                                          */ 02260000
*        /************************************************************/ 02261000
*                                                                  0611 02262000
*BUILDCPL:  PROCEDURE (ENTRYID,        /*INDEX TO THE ENTRY TO DELETE*/ 02263000
*                     TYPE);           /*TYPE OF ENTRY TO DELETE     */ 02264000
*                                                                  0611 02265000
BUILDCPL STM   @14,@03,@SA00005                                    0611 02266000
         STM   @05,@12,@SA00005+24                                 0611 02267000
         MVC   @PC00005(8),0(@01)                                  0611 02268000
*        /************************************************************/ 02269000
*        /*                                                          */ 02270000
*        /*  LOCAL DECLARATIONS                                      */ 02271000
*        /*                                                          */ 02272000
*        /************************************************************/ 02273000
*                                                                  0612 02274000
*        DCL ENTRYID  FIXED(15);       /*INDEX TO THE ENTRY IN THE   */ 02275000
*                                      /*FDT TO BE DELETED           */ 02276000
*        DCL DCPLSAVE CHAR(LENGTH(CTGPL)) BDY(WORD);               0613 02277000
*                                      /*SAVE AREA FOR CATALOG       */ 02278000
*                                      /*PARAMETER LIST BECAUSE IT IS*/ 02279000
*                                      /*DESTROYED BY VSAM CATALOG   */ 02280000
*        DCL TYPE    CHAR(1);          /*TYPE OF ENTRY TO DELETE AS  */ 02281000
*                                      /*SET IN CATALOG ENTRY        */ 02282000
*                                                                  0615 02283000
*        OLDERID2 = NEWERID2;                                      0615 02284000
         L     @08,@PC00001                                        0615 02285000
         L     @08,GDTTR2(,@08)                                    0615 02286000
         MVC   @TS00001(95),NEWERID2(@08)                          0615 02287000
         MVC   OLDERID2(95,@08),@TS00001                           0615 02288000
*        NEWID2 = 'DLBC';                                          0616 02289000
         MVC   NEWID2(4,@08),@CC01000                              0616 02290000
*        SETRC = 0;                                        /*@YL026UA*/ 02291000
*                                                                  0617 02292000
         SLR   SETRC,SETRC                                         0617 02293000
*        /************************************************************/ 02294000
*        /*                                                          */ 02295000
*        /*  IF THIS IS THE FIRST TIME THE CATALOG PARAMETER LIST    */ 02296000
*        /*  IS BUILT, SET UP THE BASIC INFORMATION.  OTHERWISE,     */ 02297000
*        /*  ONLY SET UP THE ENTRY NAME, PASSWORD, AND TYPE          */ 02298000
*        /*                                                          */ 02299000
*        /************************************************************/ 02300000
*                                                                  0618 02301000
*        IF DCPLINIT = OFF                                         0618 02302000
*          THEN                                                    0618 02303000
         TM    DCPLINIT,B'10000000'                                0618 02304000
         BNZ   @RF00618                                            0618 02305000
*INITIAL:    DO;                                                   0619 02306000
INITIAL  DS    0H                                                  0620 02307000
*            DCPLINIT = ON;                                        0620 02308000
*                                                                  0620 02309000
         OI    DCPLINIT,B'10000000'                                0620 02310000
*            /********************************************************/ 02311000
*            /*                                                      */ 02312000
*            /*  INITIALIZE THE CATALOG PARAMETER LIST TO ZEROES     */ 02313000
*            /*                                                      */ 02314000
*            /********************************************************/ 02315000
*                                                                  0621 02316000
*            CTGPL = ''B;                                          0621 02317000
*                                                                  0621 02318000
         L     @08,CTGPLPTR                                        0621 02319000
         XC    CTGPL(28,@08),CTGPL(@08)                            0621 02320000
*            /********************************************************/ 02321000
*            /*                                                      */ 02322000
*            /*  SET APPROPRIATE FLAGS IN CATALOG PARAMETER LIST     */ 02323000
*            /*  TO INDICATE DELETE FUNCTION.                        */ 02324000
*            /*                                                      */ 02325000
*            /********************************************************/ 02326000
*                                                                  0622 02327000
*            CTGOPTNS = CTGDELET;                                  0622 02328000
         NI    CTGOPTNS(@08),B'00011111'                           0622 02329000
         OI    CTGOPTNS(@08),B'00011000'                           0622 02330000
*            CTGFUNC = CTGCMS;                                     0623 02331000
         NI    CTGFUNC(@08),B'10011111'                            0623 02332000
         OI    CTGFUNC(@08),B'10000000'                            0623 02333000
*            CTGNAME = ON;                                         0624 02334000
         OI    CTGNAME(@08),B'00000100'                            0624 02335000
*            CTGAM0 = ON;                                          0625 02336000
*                                                                  0625 02337000
         OI    CTGAM0(@08),B'00000001'                             0625 02338000
*            /********************************************************/ 02339000
*            /*                                                      */ 02340000
*            /*  SET ADDRESS                                         */ 02341000
*            /*  OF DD NAME FOR ENTRY (IF ANY) IN PARAMETER LIST.    */ 02342000
*            /*                                                      */ 02343000
*            /********************************************************/ 02344000
*                                                                  0626 02345000
*            IF ADDR(INDD) ^= NULLPTR                              0626 02346000
*              THEN                                                0626 02347000
         L     @15,@PC00001+4                                      0626 02348000
         L     @15,FDTPTR+16(,@15)                                 0626 02349000
         LTR   @15,@15                                             0626 02350000
         BZ    @RF00626                                            0626 02351000
*                CTGDDNM = ADDR(INDDVAL);                          0627 02352000
*                                                                  0627 02353000
         LA    @15,INDDVAL(,@15)                                   0627 02354000
         ST    @15,CTGDDNM(,@08)                                   0627 02355000
*            /********************************************************/ 02356000
*            /*                                                      */ 02357000
*            /*  SET TYPE OF ENTRY TO BE DELETED                     */ 02358000
*            /*                                                      */ 02359000
*            /********************************************************/ 02360000
*                                                                  0628 02361000
*            IF TYPEFLAG = ON                                      0628 02362000
*              THEN                                                0628 02363000
@RF00626 TM    TYPEFLAG,B'10000000'                                0628 02364000
         BNO   @RF00628                                            0628 02365000
*                DO;                                               0629 02366000
*                IF ADDR(CLUST) ^= NULLPTR                         0630 02367000
*                  THEN                                            0630 02368000
         L     @08,@PC00001+4                                      0630 02369000
         L     @08,FDTPTR+40(,@08)                                 0630 02370000
         LTR   @08,@08                                             0630 02371000
         BZ    @RF00630                                            0630 02372000
*                    CTGTYPE = CTGTCL;                             0631 02373000
         L     @08,CTGPLPTR                                        0631 02374000
         MVI   CTGTYPE(@08),C'C'                                   0631 02375000
*                IF ADDR(UCAT) ^= NULLPTR                          0632 02376000
*                  THEN                                            0632 02377000
@RF00630 L     @08,@PC00001+4                                      0632 02378000
         L     @08,FDTPTR+48(,@08)                                 0632 02379000
         LTR   @08,@08                                             0632 02380000
         BZ    @RF00632                                            0632 02381000
*                    CTGTYPE = CTGTUCAT;                           0633 02382000
         L     @08,CTGPLPTR                                        0633 02383000
         MVI   CTGTYPE(@08),C'U'                                   0633 02384000
*                IF ADDR(MCAT) ^= NULLPTR                          0634 02385000
*                  THEN                                            0634 02386000
@RF00632 L     @08,@PC00001+4                                      0634 02387000
         L     @08,FDTPTR+52(,@08)                                 0634 02388000
         LTR   @08,@08                                             0634 02389000
         BZ    @RF00634                                            0634 02390000
*                    CTGTYPE = CTGTMCAT;                           0635 02391000
         L     @08,CTGPLPTR                                        0635 02392000
         MVI   CTGTYPE(@08),C'M'                                   0635 02393000
*                IF ADDR(ALIEN) ^= NULLPTR                         0636 02394000
*                  THEN                                            0636 02395000
@RF00634 L     @08,@PC00001+4                                      0636 02396000
         L     @08,FDTPTR+56(,@08)                                 0636 02397000
         LTR   @08,@08                                             0636 02398000
         BZ    @RF00636                                            0636 02399000
*                    CTGTYPE = CTGTALIN;                           0637 02400000
         L     @08,CTGPLPTR                                        0637 02401000
         MVI   CTGTYPE(@08),C'A'                                   0637 02402000
*                IF ADDR(SPACE) ^=NULLPTR                          0638 02403000
*                  THEN                                            0638 02404000
@RF00636 L     @08,@PC00001+4                                      0638 02405000
         L     @08,FDTPTR+44(,@08)                                 0638 02406000
         LTR   @08,@08                                             0638 02407000
         BZ    @RF00638                                            0638 02408000
*                    CTGTYPE = CTGTVOL;                            0639 02409000
         L     @08,CTGPLPTR                                        0639 02410000
         MVI   CTGTYPE(@08),C'V'                                   0639 02411000
*                IF ADDR(PGSPC) ^= NULLPTR                         0640 02412000
*                  THEN                                            0640 02413000
@RF00638 L     @08,@PC00001+4                                      0640 02414000
         L     @08,FDTPTR+68(,@08)                                 0640 02415000
         LTR   @08,@08                                             0640 02416000
         BZ    @RF00640                                            0640 02417000
*                    CTGTYPE = CTGTPGSP;                   /*@Y30SSFR*/ 02418000
         L     @08,CTGPLPTR                                        0641 02419000
         MVI   CTGTYPE(@08),C'P'                                   0641 02420000
*                IF ADDR(ALIAS) ^= NULLPTR                         0642 02421000
*                  THEN                                            0642 02422000
@RF00640 L     @08,@PC00001+4                                      0642 02423000
         L     @08,FDTPTR+76(,@08)                                 0642 02424000
         LTR   @08,@08                                             0642 02425000
         BZ    @RF00642                                            0642 02426000
*                    CTGTYPE = CTGTANM;                    /*@YL026UA*/ 02427000
         L     @08,CTGPLPTR                                        0643 02428000
         MVI   CTGTYPE(@08),C'X'                                   0643 02429000
*                IF ADDR(GDG) ^=NULLPTR                            0644 02430000
*                  THEN                                            0644 02431000
@RF00642 L     @08,@PC00001+4                                      0644 02432000
         L     @08,FDTPTR+72(,@08)                                 0644 02433000
         LTR   @08,@08                                             0644 02434000
         BZ    @RF00644                                            0644 02435000
*                    CTGTYPE = CTGTGBS;                    /*@YL026UA*/ 02436000
         L     @08,CTGPLPTR                                        0645 02437000
         MVI   CTGTYPE(@08),C'B'                                   0645 02438000
*                IF ADDR(AIX) ^= NULLPTR                           0646 02439000
*                  THEN                                            0646 02440000
@RF00644 L     @08,@PC00001+4                                      0646 02441000
         L     @08,FDTPTR+80(,@08)                                 0646 02442000
         LTR   @08,@08                                             0646 02443000
         BZ    @RF00646                                            0646 02444000
*                    CTGTYPE = CTGTAIX;                    /*@Y30SSFR*/ 02445000
         L     @08,CTGPLPTR                                        0647 02446000
         MVI   CTGTYPE(@08),C'G'                                   0647 02447000
*                IF ADDR(PATH) ^= NULLPTR                          0648 02448000
*                  THEN                                            0648 02449000
@RF00646 L     @08,@PC00001+4                                      0648 02450000
         L     @08,FDTPTR+84(,@08)                                 0648 02451000
         LTR   @08,@08                                             0648 02452000
         BZ    @RF00648                                            0648 02453000
*                    CTGTYPE = CTGTPTH;                    /*@Y30SSFR*/ 02454000
         L     @08,CTGPLPTR                                        0649 02455000
         MVI   CTGTYPE(@08),C'R'                                   0649 02456000
*                END;                                              0650 02457000
*                                                                  0650 02458000
@RF00648 DS    0H                                                  0651 02459000
*            /********************************************************/ 02460000
*            /*                                                      */ 02461000
*            /*  SET THE PURGE OPTION FLAG IF PURGE WAS SPECIFIED    */ 02462000
*            /*  ON THE DELETE COMMAND                               */ 02463000
*            /*                                                      */ 02464000
*            /********************************************************/ 02465000
*                                                                  0651 02466000
*            IF ADDR(PURGE) ^= NULLPTR                             0651 02467000
*              THEN                                                0651 02468000
@RF00628 L     @08,@PC00001+4                                      0651 02469000
         L     @08,FDTPTR+20(,@08)                                 0651 02470000
         LTR   @08,@08                                             0651 02471000
         BZ    @RF00651                                            0651 02472000
*                CTGPURG = ON;                                     0652 02473000
*                                                                  0652 02474000
         L     @08,CTGPLPTR                                        0652 02475000
         OI    CTGPURG(@08),B'00100000'                            0652 02476000
*            /********************************************************/ 02477000
*            /*                                                      */ 02478000
*            /*  SET THE SCRATCH OPTION FLAG IF SCRATCH WAS SPECIFIED*/ 02479000
*            /*  ON THE DELETE COMMAND AND THE ENTRY IS NON-VSAM     */ 02480000
*            /*                                                      */ 02481000
*            /********************************************************/ 02482000
*                                                                  0653 02483000
*            IF ADDR(NSCR) = NULLPTR & ADDR(ALIEN) ^= NULLPTR      0653 02484000
*              THEN                                                0653 02485000
@RF00651 SLR   @08,@08                                             0653 02486000
         L     @15,@PC00001+4                                      0653 02487000
         C     @08,FDTPTR+64(,@15)                                 0653 02488000
         BNE   @RF00653                                            0653 02489000
         C     @08,FDTPTR+56(,@15)                                 0653 02490000
         BE    @RF00653                                            0653 02491000
*                CTGSCR = ON;                                      0654 02492000
*                                                                  0654 02493000
         L     @08,CTGPLPTR                                        0654 02494000
         OI    CTGSCR(@08),B'00000010'                             0654 02495000
*            /********************************************************/ 02496000
*            /*  SET NOSCRATCH VOLUME CLEANUP OPTION IF NO SCRATCH   */ 02497000
*            /*  WAS SPECIFIED AND THE CLUSTER, PAGESPACE, OR SPACE  */ 02498000
*            /*  TYPE WAS SPECIFIED.                                 */ 02499000
*            /********************************************************/ 02500000
*                                                                  0655 02501000
*            IF ADDR(NSCR) ^= NULLPTR &                    /*@ZA00605*/ 02502000
*               ( ADDR(CLUST) ^= NULLPTR |                 /*@ZA00605*/ 02503000
*                 ADDR(AIX) ^= NULLPTR |                   /*@Y30SSFR*/ 02504000
*                 ADDR(PGSPC) ^= NULLPTR |                 /*@ZA00605*/ 02505000
*                 ADDR(SPACE) ^= NULLPTR )                 /*@ZA00605*/ 02506000
*              THEN                                        /*@ZA00605*/ 02507000
@RF00653 SLR   @08,@08                                             0655 02508000
         L     @15,@PC00001+4                                      0655 02509000
         C     @08,FDTPTR+64(,@15)                                 0655 02510000
         BE    @RF00655                                            0655 02511000
         C     @08,FDTPTR+40(,@15)                                 0655 02512000
         BNE   @RT00655                                            0655 02513000
         C     @08,FDTPTR+80(,@15)                                 0655 02514000
         BNE   @RT00655                                            0655 02515000
         C     @08,FDTPTR+68(,@15)                                 0655 02516000
         BNE   @RT00655                                            0655 02517000
         C     @08,FDTPTR+44(,@15)                                 0655 02518000
         BE    @RF00655                                            0655 02519000
@RT00655 DS    0H                                                  0656 02520000
*                CTGNSVS = ON;                             /*@ZA00605*/ 02521000
*                                                                  0656 02522000
         L     @08,CTGPLPTR                                        0656 02523000
         OI    CTGNSVS(@08),B'10000000'                            0656 02524000
*            /********************************************************/ 02525000
*            /*                                                      */ 02526000
*            /*  SET THE ERASE OPTION FLAG IF ERASE WAS SPECIFIED.   */ 02527000
*            /*  SET THE NOERASE OPTION FLAG IF NOERASE WAS SPECIFIED*/ 02528000
*            /*                                                      */ 02529000
*            /********************************************************/ 02530000
*                                                                  0657 02531000
*            IF ADDR(ERASE) ^= NULLPTR                             0657 02532000
*              THEN                                                0657 02533000
@RF00655 L     @08,@PC00001+4                                      0657 02534000
         L     @08,FDTPTR+28(,@08)                                 0657 02535000
         LTR   @08,@08                                             0657 02536000
         BZ    @RF00657                                            0657 02537000
*                DO;                                               0658 02538000
*                CTGOVRID = ON;                                    0659 02539000
*                CTGERASE = ON;                                    0660 02540000
         L     @08,CTGPLPTR                                        0660 02541000
         OI    CTGOVRID(@08),B'01000100'                           0660 02542000
*                END;                                              0661 02543000
*            IF ADDR(NOERA) ^= NULLPTR                             0662 02544000
*              THEN                                                0662 02545000
@RF00657 L     @08,@PC00001+4                                      0662 02546000
         L     @08,FDTPTR+32(,@08)                                 0662 02547000
         LTR   @08,@08                                             0662 02548000
         BZ    @RF00662                                            0662 02549000
*                CTGOVRID = ON;                                    0663 02550000
*                                                                  0663 02551000
         L     @08,CTGPLPTR                                        0663 02552000
         OI    CTGOVRID(@08),B'00000100'                           0663 02553000
*            /********************************************************/ 02554000
*            /*                                              @Y30SSFR*/ 02555000
*            /*  IF THE USER SPECIFIED FORCE DELETE FOR      @Y30SSFR*/ 02556000
*            /*  EITHER USERCATALOG OR SPACE, SET THE CTGSCR @Y30SSFR*/ 02557000
*            /*  AND THE CTGPURG BITS OF THE CPL TO ON.      @Y30SSFR*/ 02558000
*            /*                                              @Y30SSFR*/ 02559000
*            /********************************************************/ 02560000
*                                                                  0664 02561000
*            IF ADDR(FRC) ^= NULLPTR                       /*@Y30SSFR*/ 02562000
*              THEN                                        /*@Y30SSFR*/ 02563000
@RF00662 L     @08,@PC00001+4                                      0664 02564000
         L     @08,FDTPTR+88(,@08)                                 0664 02565000
         LTR   @08,@08                                             0664 02566000
         BZ    @RF00664                                            0664 02567000
*                DO;                                       /*@Y30SSFR*/ 02568000
*                CTGPURG = ON;                             /*@Y30SSFR*/ 02569000
*                CTGSCR = ON;                              /*@Y30SSFR*/ 02570000
         L     @08,CTGPLPTR                                        0667 02571000
         OI    CTGPURG(@08),B'00100010'                            0667 02572000
*                END;                                      /*@Y30SSFR*/ 02573000
*                                                                  0668 02574000
*            /********************************************************/ 02575000
*            /*                                                      */ 02576000
*            /*  SET THE CATALOG NAME (IF ANY) AND CATALOG PASSWORD  */ 02577000
*            /*  (IF ANY) IN THE PARAMETER LIST.                     */ 02578000
*            /*  SET THE ADDRESS OF THE ACB IN THE                   */ 02579000
*            /*  PARAMETER LIST IF THE CATALOG DD NAME WAS SPECIFIED */ 02580000
*            /*  AND THE CATALOG IS ALREADY OPENED.                  */ 02581000
*            /*                                                      */ 02582000
*            /********************************************************/ 02583000
*                                                                  0669 02584000
*            IF ADDR(CATDD) = NULLPTR                              0669 02585000
*              THEN                                                0669 02586000
@RF00664 L     @08,@PC00001+4                                      0669 02587000
         L     @08,FDTPTR+12(,@08)                                 0669 02588000
         LTR   @08,@08                                             0669 02589000
         BNZ   @RF00669                                            0669 02590000
*                DO;                                               0670 02591000
*                CTGCNAME = ON;            /*INDICATE NO ACB         */ 02592000
         L     @08,CTGPLPTR                                        0671 02593000
         OI    CTGCNAME(@08),B'00000010'                           0671 02594000
*                IF CATNAME ^= BLANKS                              0672 02595000
*                  THEN                                            0672 02596000
         CLC   CATNAME(44),BLANKS                                  0672 02597000
         BE    @RF00672                                            0672 02598000
*                    CTGCAT = ADDR(CATNAME);               /*@YL026UA*/ 02599000
         LA    @15,CATNAME                                         0673 02600000
         ST    @15,CTGCAT(,@08)                                    0673 02601000
*                END;                                              0674 02602000
*              ELSE                                                0675 02603000
*                CTGCAT = ADDR(IOCCBP);                            0675 02604000
*                                                                  0675 02605000
         B     @RC00669                                            0675 02606000
@RF00669 L     @08,IOCSPTR                                         0675 02607000
         LA    @08,IOCCBP(,@08)                                    0675 02608000
         L     @01,CTGPLPTR                                        0675 02609000
         ST    @08,CTGCAT(,@01)                                    0675 02610000
*            IF ADDR(CAT) ^= NULLPTR & CATPLN ^= 0                 0676 02611000
*              THEN                                                0676 02612000
@RC00669 L     @08,@PC00001+4                                      0676 02613000
         L     @08,FDTPTR+8(,@08)                                  0676 02614000
         LTR   @08,@08                                             0676 02615000
         BZ    @RF00676                                            0676 02616000
         CLI   CATPLN(@08),0                                       0676 02617000
         BE    @RF00676                                            0676 02618000
*                CTGPSWD = ADDR(CATPAS);                           0677 02619000
*                                                                  0677 02620000
         LA    @08,CATPAS(,@08)                                    0677 02621000
         L     @01,CTGPLPTR                                        0677 02622000
         ST    @08,CTGPSWD(,@01)                                   0677 02623000
*            /********************************************************/ 02624000
*            /*                                                      */ 02625000
*            /*  SET THE ADDRESS OF THE WORK AREA IN THE PARAMETER   */ 02626000
*            /*  LIST                                                */ 02627000
*            /*                                                      */ 02628000
*            /********************************************************/ 02629000
*                                                                  0678 02630000
*            CTGWKA = ADDR(WORKAREA);                              0678 02631000
*                                                                  0678 02632000
@RF00676 L     @08,CTGPLPTR                                        0678 02633000
         LA    @15,WORKAREA                                        0678 02634000
         ST    @15,CTGWKA(,@08)                                    0678 02635000
*            /********************************************************/ 02636000
*            /*                                                      */ 02637000
*            /*  IF MORE THAN ONE ENTRY IS TO BE DELETED, SAVE       */ 02638000
*            /*  THE CATALOG PARAMTER LIST FOR FUTURE ENTRIES.       */ 02639000
*            /*                                                      */ 02640000
*            /********************************************************/ 02641000
*                                                                  0679 02642000
*            DCPLSAVE = CTGPL;                               /*YM5775*/ 02643000
         MVC   DCPLSAVE(28),CTGPL(@08)                             0679 02644000
*            END INITIAL;                                          0680 02645000
*                                                                  0680 02646000
*          /**********************************************************/ 02647000
*          /*                                                        */ 02648000
*          /*  IF THIS IS NOT THE FIRST ENTRY TO BE DELETED, RESTORE */ 02649000
*          /*  THE CATALOG PARAMETER LIST THAT WAS CONSTRUCTED FOR   */ 02650000
*          /*  THE FIRST ENTRY DELETED.                              */ 02651000
*          /*                                                        */ 02652000
*          /**********************************************************/ 02653000
*                                                                  0681 02654000
*          ELSE                                                    0681 02655000
*            CTGPL = DCPLSAVE;                                     0681 02656000
*                                                                  0681 02657000
         B     @RC00618                                            0681 02658000
@RF00618 L     @08,CTGPLPTR                                        0681 02659000
         MVC   CTGPL(28,@08),DCPLSAVE                              0681 02660000
*        /************************************************************/ 02661000
*        /*                                                          */ 02662000
*        /*  SET THE ADDRESS OF THE ENTRY NAME TO BE DELETED AND THE */ 02663000
*        /*  ADDRESS OF THE ENTRY PASSWORD IF THE CATALOG PASSWORD   */ 02664000
*        /*  WAS NOT ALREADY SPECIFIED.                              */ 02665000
*        /*  IF THE ENTRY IS A SPACE ENTRY, PAD THE NAME WITH ZEROES */ 02666000
*        /*                                                          */ 02667000
*        /************************************************************/ 02668000
*                                                                  0682 02669000
*        IF ADDR(SPACE) ^= NULLPTR                                 0682 02670000
*          THEN                                                    0682 02671000
@RC00618 SLR   @08,@08                                             0682 02672000
         L     @15,@PC00001+4                                      0682 02673000
         C     @08,FDTPTR+44(,@15)                                 0682 02674000
         BE    @RF00682                                            0682 02675000
*           DO;                                            /*@YL026UA*/ 02676000
*            SERNAME = '0'B;                                       0684 02677000
         XC    SERNAME+1(43),SERNAME+1                             0684 02678000
         MVI   SERNAME,B'00000000'                                 0684 02679000
*            SERNAME (1:SERLN) = ENTVAL(ENT,1:SERLN);      /*@YL026UA*/ 02680000
*                                                                  0685 02681000
         LR    @14,ENT                                             0685 02682000
         MH    @14,@CH01066                                        0685 02683000
         L     @01,GENWKPTR                                        0685 02684000
         ALR   @01,@14                                             0685 02685000
         AL    @01,@CF01104                                        0685 02686000
         MVC   SERNAME(6),ENTVAL-5(@01)                            0685 02687000
*            /********************************************************/ 02688000
*            /*                                              @Y30SSFR*/ 02689000
*            /*  IF FILE AND NOSCRATCH WERE NOT SPECIFIED,   @Y30SSFR*/ 02690000
*            /*  CALL ALLOPROC TO DYNAMICALLY                @Y30SSFR*/ 02691000
*            /*  ALLOCATE THE VOLUMES.                       @Y30SSFR*/ 02692000
*            /*                                              @Y30SSFR*/ 02693000
*            /********************************************************/ 02694000
*                                                                  0686 02695000
*            IF ADDR(INDD) = NULLPTR & ADDR(NSCR) = NULLPTR        0686 02696000
*              THEN                                                0686 02697000
         C     @08,FDTPTR+16(,@15)                                 0686 02698000
         BNE   @RF00686                                            0686 02699000
         C     @08,FDTPTR+64(,@15)                                 0686 02700000
         BNE   @RF00686                                            0686 02701000
*                DO;                                       /*@Y30SSFR*/ 02702000
*                CALL ALLOPROC(NULLPARM,ADDR(SERNAME));    /*@Y30SSFR*/ 02703000
         LA    @08,@CF00115                                        0688 02704000
         ST    @08,@AL00001                                        0688 02705000
         LA    @08,SERNAME                                         0688 02706000
         ST    @08,@AFTEMPS+4                                      0688 02707000
         LA    @08,@AFTEMPS+4                                      0688 02708000
         ST    @08,@AL00001+4                                      0688 02709000
         LA    @01,@AL00001                                        0688 02710000
         BAL   @14,ALLOPROC                                        0688 02711000
*                CTGDDNM = ADDR(ALLDDN);                   /*@Y30SSFR*/ 02712000
         L     @08,ALLPTR                                          0689 02713000
         LA    @08,ALLDDN(,@08)                                    0689 02714000
         L     @01,CTGPLPTR                                        0689 02715000
         ST    @08,CTGDDNM(,@01)                                   0689 02716000
*                END;                                      /*@Y30SSFR*/ 02717000
*                                                                  0690 02718000
*            CTGENT = ADDR(SERNAME);                               0691 02719000
@RF00686 LA    @08,SERNAME                                         0691 02720000
         L     @01,CTGPLPTR                                        0691 02721000
         ST    @08,CTGENT(,@01)                                    0691 02722000
*            END;                                          /*@Y30SSFR*/ 02723000
*          ELSE                                                    0693 02724000
*            CTGENT = ADDR(ENTVAL(ENT));                   /*#YL026UA*/ 02725000
*                                                                  0693 02726000
         B     @RC00682                                            0693 02727000
@RF00682 LR    @08,ENT                                             0693 02728000
         MH    @08,@CH01066                                        0693 02729000
         L     @01,GENWKPTR                                        0693 02730000
         AL    @01,@CF01104                                        0693 02731000
         LA    @08,ENTVAL-5(@08,@01)                               0693 02732000
         L     @01,CTGPLPTR                                        0693 02733000
         ST    @08,CTGENT(,@01)                                    0693 02734000
*        IF CTGPSWD = 0 & NTRYPLN(ENTRYID) ^= 0                    0694 02735000
*          THEN                                                    0694 02736000
@RC00682 SLR   @08,@08                                             0694 02737000
         L     @15,CTGPLPTR                                        0694 02738000
         C     @08,CTGPSWD(,@15)                                   0694 02739000
         BNE   @RF00694                                            0694 02740000
         L     @14,@PC00005                                        0694 02741000
         LH    @14,ENTRYID(,@14)                                   0694 02742000
         MH    @14,@CH01079                                        0694 02743000
         L     @07,@PC00001+4                                      0694 02744000
         L     @07,FDTPTR(,@07)                                    0694 02745000
         LA    @01,0(@14,@07)                                      0694 02746000
         AL    @01,@CF01099                                        0694 02747000
         SLR   @00,@00                                             0694 02748000
         IC    @00,NTRYPLN-2(,@01)                                 0694 02749000
         CR    @08,@00                                             0694 02750000
         BE    @RF00694                                            0694 02751000
*            CTGPSWD = ADDR (NTRYPAS(ENTRYID));                    0695 02752000
*                                                                  0695 02753000
         AL    @07,@CF01100                                        0695 02754000
         LA    @08,NTRYPAS-3(@14,@07)                              0695 02755000
         ST    @08,CTGPSWD(,@15)                                   0695 02756000
*        /************************************************************/ 02757000
*        /*                                                  #YM07852*/ 02758000
*        /*  IF DELETING A USERCATALOG, SET                  @Y30SSFR*/ 02759000
*        /*  THE CTGCAT FIELD TO THE ADDRESS OF THE NAME OF  #YM07852*/ 02760000
*        /*  THE USERCATALOG TO BE DELETED.  ALSO SET THE    #YM07852*/ 02761000
*        /*  CTGCNAME FIELD TO INDICATE THAT THE ADDRESS OF  #YM07852*/ 02762000
*        /*  A CATALOG NAME IS GIVEN RATHER THAN A CATALOG   #YM07852*/ 02763000
*        /*  ACB ADDRESS.                                    #YM07852*/ 02764000
*        /*                                                  #YM07852*/ 02765000
*        /************************************************************/ 02766000
*                                                                  0696 02767000
*        IF ADDR(CAT) = NULLPTR & ADDR(UCAT) ^= NULLPTR    /*#YM07852*/ 02768000
*          THEN                                            /*#YM07852*/ 02769000
@RF00694 SLR   @08,@08                                             0696 02770000
         L     @15,@PC00001+4                                      0696 02771000
         C     @08,FDTPTR+8(,@15)                                  0696 02772000
         BNE   @RF00696                                            0696 02773000
         C     @08,FDTPTR+48(,@15)                                 0696 02774000
         BE    @RF00696                                            0696 02775000
*            DO;                                           /*#YM07852*/ 02776000
*            CTGCNAME = ON;                                /*#YM07852*/ 02777000
         L     @08,CTGPLPTR                                        0698 02778000
         OI    CTGCNAME(@08),B'00000010'                           0698 02779000
*            CTGCAT = CTGENT;                              /*#YM07852*/ 02780000
         L     @15,CTGENT(,@08)                                    0699 02781000
         ST    @15,CTGCAT(,@08)                                    0699 02782000
*            END;                                          /*#YM07852*/ 02783000
*                                                                  0700 02784000
*        /************************************************************/ 02785000
*        /*                                                  @Y30SSFR*/ 02786000
*        /*  IF THE USER SPECIFIED THE TYPE ON THE DELETE    @Y30SSFR*/ 02787000
*        /*  AND PROVIDED A GENERIC NAME, COMPARE THE TYPE   @Y30SSFR*/ 02788000
*        /*  GIVEN WITH THAT RETURNED BY GENERIC LOCATE.  IF @Y30SSFR*/ 02789000
*        /*  THEY ARE EQUAL, PROCEED.  OTHERWISE, RETURN TO  @Y30SSFR*/ 02790000
*        /*  THE CALLING PROCESSOR.  THIS IS NOT, HOWEVER,   @Y30SSFR*/ 02791000
*        /*  CONSIDERED TO BE AN ERROR.                      @Y30SSFR*/ 02792000
*        /*                                                  @Y30SSFR*/ 02793000
*        /************************************************************/ 02794000
*                                                                  0701 02795000
*        IF TYPEFLAG = ON                                  /*@Y30SSFR*/ 02796000
*          THEN                                            /*@Y30SSFR*/ 02797000
@RF00696 TM    TYPEFLAG,B'10000000'                                0701 02798000
         BNO   @RF00701                                            0701 02799000
*            IF NTRYPOS(INDEX) ^= 0                        /*@Y30SSFR*/ 02800000
*              THEN                                        /*@Y30SSFR*/ 02801000
         SLR   @08,@08                                             0702 02802000
         LH    @15,INDEX                                           0702 02803000
         MH    @15,@CH01079                                        0702 02804000
         L     @14,@PC00001+4                                      0702 02805000
         L     @01,FDTPTR(,@14)                                    0702 02806000
         AL    @01,@CF01102                                        0702 02807000
         SLR   @14,@14                                             0702 02808000
         IC    @14,NTRYPOS-11(@15,@01)                             0702 02809000
         CR    @08,@14                                             0702 02810000
         BE    @RF00702                                            0702 02811000
*                IF CTGTYPE ^= ENTTYP(ENT)                 /*@Y30SSFR*/ 02812000
*                  THEN                                    /*@Y30SSFR*/ 02813000
         LR    @15,ENT                                             0703 02814000
         MH    @15,@CH01066                                        0703 02815000
         L     @01,CTGPLPTR                                        0703 02816000
         L     @14,GENWKPTR                                        0703 02817000
         ALR   @14,@15                                             0703 02818000
         AL    @14,@CF01103                                        0703 02819000
         CLC   CTGTYPE(1,@01),ENTTYP-4(@14)                        0703 02820000
         BE    @RF00703                                            0703 02821000
*                    DO;                                   /*@Y30SSFR*/ 02822000
*                    NODEL = ON;                           /*@Y30SSFR*/ 02823000
         OI    NODEL,B'10000000'                                   0705 02824000
*                    RETURN CODE(LASTCC00);                /*@Y30SSFR*/ 02825000
         LR    @15,@08                                             0706 02826000
         L     @14,@SA00005                                        0706 02827000
         LM    @00,@03,@SA00005+8                                  0706 02828000
         LM    @05,@12,@SA00005+24                                 0706 02829000
         BR    @14                                                 0706 02830000
*                    END;                                  /*@Y30SSFR*/ 02831000
*                                                                  0707 02832000
*        /************************************************************/ 02833000
*        /*                                                  @Y30SSFR*/ 02834000
*        /*  IF TYPE WAS NOT SPECIFIED ON THE DELETE COMMAND, SET    */ 02835000
*        /*  THE TYPE FIELD FROM THE TYPE FOUND IN THE CATALOG ENTRY */ 02836000
*        /*  IF THE TYPE IS NON-VSAM SET THE SCRATCH FLAG (IF        */ 02837000
*        /*  IF FILE WAS NOT SPECIFIED ON THE DELETE COMMAND AND     */ 02838000
*        /*  NOSCRATCH WAS NOT SPECIFIED).                           */ 02839000
*        /*                                                          */ 02840000
*        /************************************************************/ 02841000
*                                                                  0708 02842000
*        IF TYPEFLAG = OFF                                         0708 02843000
*          THEN                                                    0708 02844000
@RF00703 DS    0H                                                  0708 02845000
@RF00702 DS    0H                                                  0708 02846000
@RF00701 TM    TYPEFLAG,B'10000000'                                0708 02847000
         BNZ   @RF00708                                            0708 02848000
*            DO;                                                   0709 02849000
*            CTGTYPE = TYPE;                                       0710 02850000
         L     @08,CTGPLPTR                                        0710 02851000
         L     @15,@PC00005+4                                      0710 02852000
         MVC   CTGTYPE(1,@08),TYPE(@15)                            0710 02853000
*            IF ADDR(NSCR) = NULLPTR & TYPE = CTGTALIN             0711 02854000
*              THEN                                                0711 02855000
         L     @14,@PC00001+4                                      0711 02856000
         L     @14,FDTPTR+64(,@14)                                 0711 02857000
         LTR   @14,@14                                             0711 02858000
         BNZ   @RF00711                                            0711 02859000
         CLI   TYPE(@15),C'A'                                      0711 02860000
         BNE   @RF00711                                            0711 02861000
*                CTGSCR = ON;                              /*@Y30SSFR*/ 02862000
*                                                                  0712 02863000
         OI    CTGSCR(@08),B'00000010'                             0712 02864000
*            /********************************************************/ 02865000
*            /*                                              @Y30SSFR*/ 02866000
*            /*  SET NOSCRATCH CATALOG CLEANUP OPTION FOR CLUSTER    */ 02867000
*            /*  AND PAGESPACE WHEN NOSCRATCH IS SPECIFIED.  @Y30SSFR*/ 02868000
*            /*                                              @Y30SSFR*/ 02869000
*            /********************************************************/ 02870000
*                                                                  0713 02871000
*            IF ADDR(NSCR) ^= NULLPTR &                    /*@ZA00605*/ 02872000
*               ( TYPE = CTGTCL | TYPE = CTGTAIX |         /*@ZA00605*/ 02873000
*                 TYPE = CTGTPGSP)                         /*@ZA00605*/ 02874000
*              THEN                                        /*@ZA00605*/ 02875000
@RF00711 L     @08,@PC00001+4                                      0713 02876000
         L     @08,FDTPTR+64(,@08)                                 0713 02877000
         LTR   @08,@08                                             0713 02878000
         BZ    @RF00713                                            0713 02879000
         L     @08,@PC00005+4                                      0713 02880000
         CLI   TYPE(@08),C'C'                                      0713 02881000
         BE    @RT00713                                            0713 02882000
         CLI   TYPE(@08),C'G'                                      0713 02883000
         BE    @RT00713                                            0713 02884000
         CLI   TYPE(@08),C'P'                                      0713 02885000
         BNE   @RF00713                                            0713 02886000
@RT00713 DS    0H                                                  0714 02887000
*                CTGNSVS = ON;                             /*@ZA00605*/ 02888000
         L     @08,CTGPLPTR                                        0714 02889000
         OI    CTGNSVS(@08),B'10000000'                            0714 02890000
*            END;                                          /*@Y30SSFR*/ 02891000
*                                                                  0715 02892000
@RF00713 DS    0H                                                  0716 02893000
*        /************************************************************/ 02894000
*        /*                                                  #YL026UA*/ 02895000
*        /*  IF FILE WAS NOT SPECIFIED ON THE DELETE COMMAND AND     */ 02896000
*        /*  THE OBJECT IS TO BE ERASED,                     @Y30SSFR*/ 02897000
*        /*  DYNAMICALLY ALLOCATE THE DATA SET               #YL026UA*/ 02898000
*        /*                                                  #YL026UA*/ 02899000
*        /************************************************************/ 02900000
*                                                                  0716 02901000
*        IF (TYPE = CTGTCL | TYPE = CTGTAIX) &             /*@Y30SSFR*/ 02902000
*        ADDR(ERASE) ^= NULLPTR & ADDR(INDD) = NULLPTR     /*@Y30SSFR*/ 02903000
*          THEN                                            /*#YL026UA*/ 02904000
@RF00708 L     @08,@PC00005+4                                      0716 02905000
         CLI   TYPE(@08),C'C'                                      0716 02906000
         BE    @GL00064                                            0716 02907000
         CLI   TYPE(@08),C'G'                                      0716 02908000
         BNE   @RF00716                                            0716 02909000
@GL00064 SLR   @08,@08                                             0716 02910000
         L     @15,@PC00001+4                                      0716 02911000
         C     @08,FDTPTR+28(,@15)                                 0716 02912000
         BE    @RF00716                                            0716 02913000
         C     @08,FDTPTR+16(,@15)                                 0716 02914000
         BNE   @RF00716                                            0716 02915000
*            DO;                                           /*@Y30SSFR*/ 02916000
*            CALL ALLOPROC(ADDR(ENTVAL(ENT)),NULLPARM);    /*@Y30SSFR*/ 02917000
         LR    @08,ENT                                             0718 02918000
         MH    @08,@CH01066                                        0718 02919000
         L     @01,GENWKPTR                                        0718 02920000
         AL    @01,@CF01104                                        0718 02921000
         LA    @08,ENTVAL-5(@08,@01)                               0718 02922000
         ST    @08,@AFTEMPS+4                                      0718 02923000
         LA    @08,@AFTEMPS+4                                      0718 02924000
         ST    @08,@AL00001                                        0718 02925000
         LA    @08,@CF00115                                        0718 02926000
         ST    @08,@AL00001+4                                      0718 02927000
         LA    @01,@AL00001                                        0718 02928000
         BAL   @14,ALLOPROC                                        0718 02929000
*            CTGDDNM = ADDR(ALLDDN);                       /*@Y30SSFR*/ 02930000
         L     @08,ALLPTR                                          0719 02931000
         LA    @08,ALLDDN(,@08)                                    0719 02932000
         L     @01,CTGPLPTR                                        0719 02933000
         ST    @08,CTGDDNM(,@01)                                   0719 02934000
*            END;                                          /*@Y30SSFR*/ 02935000
*                                                                  0720 02936000
*        /************************************************************/ 02937000
*        /*                                                  #YL026UA*/ 02938000
*        /*  IF THE ACB ADDRESS WAS OBTAINED BY FINDTYPE     #YL026UA*/ 02939000
*        /*  SET THE ADDRESS OF THE ACB IN THE CPL           #YL026UA*/ 02940000
*        /*                                                  #YL026UA*/ 02941000
*        /************************************************************/ 02942000
*                                                                  0721 02943000
*        IF ACBFLAG = ON & ADDR(CATDD) = NULLPTR                   0721 02944000
*          THEN                                                    0721 02945000
@RF00716 TM    ACBFLAG,B'10000000'                                 0721 02946000
         BNO   @RF00721                                            0721 02947000
         L     @08,@PC00001+4                                      0721 02948000
         L     @08,FDTPTR+12(,@08)                                 0721 02949000
         LTR   @08,@08                                             0721 02950000
         BNZ   @RF00721                                            0721 02951000
*            DO;                                           /*#YL026UA*/ 02952000
*            ACBFLAG = OFF;                                /*@Y30SSFR*/ 02953000
         NI    ACBFLAG,B'01111111'                                 0723 02954000
*            CTGCNAME = OFF;                               /*@Y30SSFR*/ 02955000
         L     @08,CTGPLPTR                                        0724 02956000
         NI    CTGCNAME(@08),B'11111101'                           0724 02957000
*            CTGCAT = ADDR(ACBPTR);                        /*@Y30SSFR*/ 02958000
         LA    @15,ACBPTR                                          0725 02959000
         ST    @15,CTGCAT(,@08)                                    0725 02960000
*            END;                                          /*#YL026UA*/ 02961000
*        RETURN CODE (SETRC);                              /*#YL026UA*/ 02962000
@RF00721 LR    @15,SETRC                                           0727 02963000
         L     @14,@SA00005                                        0727 02964000
         LM    @00,@03,@SA00005+8                                  0727 02965000
         LM    @05,@12,@SA00005+24                                 0727 02966000
         BR    @14                                                 0727 02967000
*END BUILDCPL;                                                     0728 02968000
*        /************************************************************/ 02969000
*        /*                                                          */ 02970000
*        /*  PROCEDURE NAME - CATCALL                                */ 02971000
*        /*                                                          */ 02972000
*        /*  FUNCTION - CALL THE VSAM CATALOG TO DELETE THE          */ 02973000
*        /*  CATALOG ENTRIES. EXAMINE THE RETURN CODE FROM THE       */ 02974000
*        /*  CATALOG AND ISSUE APPROPRIATE DELETION MESSAGES.        */ 02975000
*        /*  CERTAIN VSAM CATALOG RETURN CODES CAUSE CATCALL @Y30SSFR*/ 02976000
*        /*  TO INVOKE SERVICE ROUTINES TO HANDLE SPECIAL    @Y30SSFR*/ 02977000
*        /*  FUNCTIONS FOR IT.  A CATALOG RETURN CODE OF     @Y30SSFR*/ 02978000
*        /*  40 INDICATES THAT THE WORKAREA FOR CMS IS TOO   @Y30SSFR*/ 02979000
*        /*  SMALL.  MORESP IS INVOKED TO GET A LARGER WORK  @Y30SSFR*/ 02980000
*        /*  AREA.  CATALOG RETURN CODES OF 72 AND 240 CAUSE @Y30SSFR*/ 02981000
*        /*  CATCALL TO INVOKE ALLOPROC TO DYNAMICALLY ALLO- @Y30SSFR*/ 02982000
*        /*  CATE THE OBJECT REQUIRED BY CMS.                @Y30SSFR*/ 02983000
*        /*                                                          */ 02984000
*        /*  INPUT - NONE                                            */ 02985000
*        /*                                                          */ 02986000
*        /*  OUTPUT - IF AN ERROR IS FOUND, THE RETURN CODE IS SET   */ 02987000
*        /*                                                          */ 02988000
*        /************************************************************/ 02989000
*                                                                  0729 02990000
*CATCALL: PROCEDURE;                                               0729 02991000
*                                                                  0729 02992000
CATCALL  STM   @14,@12,@SA00006                                    0729 02993000
*        /************************************************************/ 02994000
*        /*                                                          */ 02995000
*        /*  LOCAL DECLARATIONS                                      */ 02996000
*        /*                                                          */ 02997000
*        /************************************************************/ 02998000
*                                                                  0730 02999000
*        DCL I        FIXED(31);       /*LOOP CONTROL INDEX  @Y30SSFR*/ 03000000
*        DCL IX       FIXED(31);       /*LOOP CONTROL INDEX  @Y30SSFR*/ 03001000
*                                      /*FOR PRINTING NAMES  @Y30SSFR*/ 03002000
*                                      /*FROM THE WORKAREA   @Y30SSFR*/ 03003000
*        DCL ALLOINDX FIXED(31);       /*INDEX INTO THE WORK @Y30SSFR*/ 03004000
*                                      /*AREA FOR THE NAME   @Y30SSFR*/ 03005000
*                                      /*OF THE THING TO BE  @Y30SSFR*/ 03006000
*                                      /*ALLOCATED           @Y30SSFR*/ 03007000
*        DCL MNOENT   FIXED(31);       /*PARAMETER PASSED TO @Y30SSFR*/ 03008000
*                                      /*MORESP INDICATING   @Y30SSFR*/ 03009000
*                                      /*HOW MANY ENTRIES    @Y30SSFR*/ 03010000
*                                      /*ARE IN THE CURRENT  @Y30SSFR*/ 03011000
*                                      /*WORK AREA           @Y30SSFR*/ 03012000
*        DCL BLANK    CHAR(1) CONSTANT(' ');               /*@OZ02293*/ 03013000
*        OLDERID2 = NEWERID2;                                      0735 03014000
         L     @08,@PC00001                                        0735 03015000
         L     @08,GDTTR2(,@08)                                    0735 03016000
         MVC   @TS00001(95),NEWERID2(@08)                          0735 03017000
         MVC   OLDERID2(95,@08),@TS00001                           0735 03018000
*        NEWID2 = 'DLCT';                                          0736 03019000
*                                                                  0736 03020000
         MVC   NEWID2(4,@08),@CC01011                              0736 03021000
*        /************************************************************/ 03022000
*        /*                                                          */ 03023000
*        /*  INITIALIZE THE CATALOG WORK AREA TO ZEROES AND          */ 03024000
*        /*  SET THE LENGTH OF THE WORK AREA IN THE WORK AREA.       */ 03025000
*        /*                                                          */ 03026000
*        /************************************************************/ 03027000
*                                                                  0737 03028000
*        DO IND1 = 1 TO 12;                                /*#Y30SSFR*/ 03029000
         LA    IND1,1                                              0737 03030000
@DL00737 DS    0H                                                  0738 03031000
*          ENTITEM(IND1) = ''B;                            /*#Y30SSFR*/ 03032000
         LR    @08,IND1                                            0738 03033000
         MH    @08,@CH01066                                        0738 03034000
         L     @03,WAPTR                                           0738 03035000
         ALR   @03,@08                                             0738 03036000
         AL    @03,@CF01103                                        0738 03037000
         XC    ENTITEM-4(45,@03),ENTITEM-4(@03)                    0738 03038000
*        END;                                              /*#Y30SSFR*/ 03039000
         AL    IND1,@CF00219                                       0739 03040000
         C     IND1,@CF00035                                       0739 03041000
         BNH   @DL00737                                            0739 03042000
*        RETURNLN = 0;                                     /*#Y30SSFR*/ 03043000
         L     @08,WAPTR                                           0740 03044000
         SLR   @15,@15                                             0740 03045000
         STH   @15,RETURNLN(,@08)                                  0740 03046000
*        AREALN = LENGTH (WORKAREA);                               0741 03047000
         MVC   AREALN(2,@08),@CH01085                              0741 03048000
*        DEFINED = ON;                                     /*#YL026UA*/ 03049000
*                                                                  0742 03050000
         OI    DEFINED,B'10000000'                                 0742 03051000
*        /************************************************************/ 03052000
*        /*                                                          */ 03053000
*        /*  CALL THE VSAM CATALOG WITH REGISTER 1 POINTING TO THE   */ 03054000
*        /*  CATALOG PARAMETER LIST.                         #Y30SSFR*/ 03055000
*        /*  THE CATALOG IS CALLED ITERATIVELY UNTIL A       #Y30SSFR*/ 03056000
*        /*  TERMINATING ERROR OCCURS OR UNTIL THE ENTIRE    #Y30SSFR*/ 03057000
*        /*  STRUCTURE ASSOCIATED WITH THE ENTRY BEING       #Y30SSFR*/ 03058000
*        /*  DELETED HAS BEEN REMOVED FROM THE CATALOG.      #Y30SSFR*/ 03059000
*        /*                                                          */ 03060000
*        /************************************************************/ 03061000
*                                                                  0743 03062000
*CATALOG: DO WHILE DEFINED = ON;                           /*#YL026UA*/ 03063000
*                                                                  0743 03064000
CATALOG  B     @DE00743                                            0743 03065000
@DL00743 DS    0H                                                  0744 03066000
*          /**********************************************************/ 03067000
*          /*                                                #Y30SSFR*/ 03068000
*          /*  SET THE LOOP CONTROL VARIABLE TO OFF AND SAVE #Y30SSFR*/ 03069000
*          /*  THE CTGPL BEFORE INVOKING VSAM CATALOG        #Y30SSFR*/ 03070000
*          /*  MANAGEMENT.                                   #Y30SSFR*/ 03071000
*          /*                                                #Y30SSFR*/ 03072000
*          /**********************************************************/ 03073000
*                                                                  0744 03074000
*          DEFINED = OFF;                                  /*#Y30SSFR*/ 03075000
         NI    DEFINED,B'01111111'                                 0744 03076000
*          RENEWCPL = CTGPL;                               /*#Y30SSFR*/ 03077000
*                                                                  0745 03078000
         L     @08,CTGPLPTR                                        0745 03079000
         MVC   RENEWCPL(28),CTGPL(@08)                             0745 03080000
*          IF GDTDBG = NULLPTR                                     0746 03081000
*            THEN;                                                 0746 03082000
         L     @08,@PC00001                                        0746 03083000
         L     @08,GDTDBG(,@08)                                    0746 03084000
         LTR   @08,@08                                             0746 03085000
         BZ    @RT00746                                            0746 03086000
*            ELSE                                                  0748 03087000
*              CALL IDCDB010 (GDTTBL,'DLDB');                      0748 03088000
         L     @08,@PC00001                                        0748 03089000
         ST    @08,@AL00001                                        0748 03090000
         LA    @15,@CC01014                                        0748 03091000
         ST    @15,@AL00001+4                                      0748 03092000
         MVI   @AL00001+4,X'80'                                    0748 03093000
         L     @15,GDTDBG(,@08)                                    0748 03094000
         LA    @01,@AL00001                                        0748 03095000
         BALR  @14,@15                                             0748 03096000
*                                                          /*#Y30SSFR*/ 03097000
*                                                                  0749 03098000
*          CALL IDCSACA0 (GDTTBL,CTGPLPTR);                /*#Y30SSFR*/ 03099000
*                                                                  0749 03100000
@RT00746 L     @08,@PC00001                                        0749 03101000
         ST    @08,@AL00001                                        0749 03102000
         LA    @15,CTGPLPTR                                        0749 03103000
         ST    @15,@AL00001+4                                      0749 03104000
         L     @15,GDTCAT(,@08)                                    0749 03105000
         LA    @01,@AL00001                                        0749 03106000
         BALR  @14,@15                                             0749 03107000
*          RESPECIFY REG15 RSTD;                           /*#Y30SSFR*/ 03108000
*          CATLGRC = REG15;                                /*#Y30SSFR*/ 03109000
         STH   REG15,CATLGRC                                       0751 03110000
*          RESPECIFY REG15 UNRSTD;                         /*#Y30SSFR*/ 03111000
*                                                                  0752 03112000
*          IF GDTDBG = NULLPTR                                     0753 03113000
*            THEN;                                                 0753 03114000
         L     @08,@PC00001                                        0753 03115000
         L     @08,GDTDBG(,@08)                                    0753 03116000
         LTR   @08,@08                                             0753 03117000
         BZ    @RT00753                                            0753 03118000
*            ELSE                                                  0755 03119000
*              CALL IDCDB010 (GDTTBL,'DLDA');                      0755 03120000
         L     @08,@PC00001                                        0755 03121000
         ST    @08,@AL00001                                        0755 03122000
         LA    @15,@CC01015                                        0755 03123000
         ST    @15,@AL00001+4                                      0755 03124000
         MVI   @AL00001+4,X'80'                                    0755 03125000
         L     @15,GDTDBG(,@08)                                    0755 03126000
         LA    @01,@AL00001                                        0755 03127000
         BALR  @14,@15                                             0755 03128000
*                                                          /*#Y30SSFR*/ 03129000
*                                                                  0756 03130000
*          /**********************************************************/ 03131000
*          /*                                                @Y30SSFR*/ 03132000
*          /*  INITIALIZE MNOENT TO 0 TO HANDLE THE CASE IN  @Y30SSFR*/ 03133000
*          /*  CATALOG MANAGEMENT RETURNS WITH A RETURN CODE @Y30SSFR*/ 03134000
*          /*  OF 40 AND A RETURNLN OF 4.  THIS MAY HAPPEN   @Y30SSFR*/ 03135000
*          /*  ON THE INITIAL CALL TO CMS DURING THE         @Y30SSFR*/ 03136000
*          /*  OF A VERY LARGE STRUCTURE.                    @Y30SSFR*/ 03137000
*          /*                                                @Y30SSFR*/ 03138000
*          /**********************************************************/ 03139000
*                                                                  0756 03140000
*          MNOENT = 0;                                     /*@Y30SSFR*/ 03141000
*                                                                  0756 03142000
@RT00753 SLR   @08,@08                                             0756 03143000
         ST    @08,MNOENT                                          0756 03144000
*          /**********************************************************/ 03145000
*          /*                                                @Y30SSFR*/ 03146000
*          /*  IF CATALOG HAS SET RETURNLN TO A VALUE        @Y30SSFR*/ 03147000
*          /*  GREATER THAN 4, THERE ARE NAMES IN THE WORK   @Y30SSFR*/ 03148000
*          /*  AREA TO BE PRINTED.  EXACTLY HOW MANY OF      @Y30SSFR*/ 03149000
*          /*  THESE ARE TO BE PRINTED IS A FUNCTION OF THE  @Y30SSFR*/ 03150000
*          /*  RETURN CODE.  IF THE VSAM CATALOG RETURN CODE @Y30SSFR*/ 03151000
*          /*  IS ANYTHING OTHER THAN 72 OR 76, ALL OF THE   @Y30SSFR*/ 03152000
*          /*  NAMES ARE TO BE PRINTED.  IF THE RETURN CODE  @Y30SSFR*/ 03153000
*          /*  IS 72 OR 76, THEN THE LAST ITEM IN THE WORK   @Y30SSFR*/ 03154000
*          /*  AREA IS IS THE THING TO BE ALLOCATED, AND IT  @Y30SSFR*/ 03155000
*          /*  AND ITS ASSOCIATIONS IN THE WORK AREA ARE     @Y30SSFR*/ 03156000
*          /*  NOT TO BE PRINTED.                            @Y30SSFR*/ 03157000
*          /*                                                @Y30SSFR*/ 03158000
*          /**********************************************************/ 03159000
*                                                                  0757 03160000
*          IF RETURNLN > 4                                         0757 03161000
*            THEN                                                  0757 03162000
*                                                                  0757 03163000
         L     @08,WAPTR                                           0757 03164000
         LH    @08,RETURNLN(,@08)                                  0757 03165000
         C     @08,@CF00042                                        0757 03166000
         BNH   @RF00757                                            0757 03167000
*              /******************************************************/ 03168000
*              /*                                            @Y30SSFR*/ 03169000
*              /*  IF THE VSAM CATALOG RETURN CODE IS 40,    @Y30SSFR*/ 03170000
*              /*  THE VALUE IN RETURNLN IS THE SUM OF THE   @Y30SSFR*/ 03171000
*              /*  AMOUNT OF SPACE USED FOR NAMES OF DELETED @Y30SSFR*/ 03172000
*              /*  OBJECTS AND THE AMOUNT NEEDED TO DELETE   @Y30SSFR*/ 03173000
*              /*  THE NEXT PART OF THE STRUCTURE.  HENCE,   @Y30SSFR*/ 03174000
*              /*  THE VALUE OF RETURNLN MUST BE ADJUSTED    @Y30SSFR*/ 03175000
*              /*  PRIOR TO USING IT AS A LIMIT ON THE       @Y30SSFR*/ 03176000
*              /*  ON THE NUMBER OF NAMES TO PRINT.          @Y30SSFR*/ 03177000
*              /*                                            @Y30SSFR*/ 03178000
*              /******************************************************/ 03179000
*                                                                  0758 03180000
*              IF CATLGRC = NEEDCORE                               0758 03181000
*                 THEN                                             0758 03182000
         CLC   CATLGRC(2),@CH00912                                 0758 03183000
         BNE   @RF00758                                            0758 03184000
*MPRTLP:            DO;                                     /*@Y30SSFR* 03185000
*                                                                  0759 03186000
MPRTLP   DS    0H                                                  0760 03187000
*                  /**************************************************/ 03188000
*                  /*                                        @Y30SSFR*/ 03189000
*                  /*  SET UP THE DARGLIST FOR THE ENTRY     @Y30SSFR*/ 03190000
*                  /*  DELETED MESSAGE.                      @Y30SSFR*/ 03191000
*                  /*                                        @Y30SSFR*/ 03192000
*                  /**************************************************/ 03193000
*                                                                  0760 03194000
*                  DARGSMOD = DELMSG;                      /*@Y30SSFR*/ 03195000
         L     @08,DDSTRU                                          0760 03196000
         MVC   DARGSMOD(3,@08),@CC00888                            0760 03197000
*                  DARGSENT = ENTRYMSG;                    /*@Y30SSFR*/ 03198000
*                                                                  0761 03199000
         MVI   DARGSENT(@08),X'01'                                 0761 03200000
*                  /**************************************************/ 03201000
*                  /*                                        @Y30SSFR*/ 03202000
*                  /*  CALCULATE THE MAXIMUM NUMBER OF ITEMS @Y30SSFR*/ 03203000
*                  /*  THAT CAN FIT INTO THE EXISTING WORK   @Y30SSFR*/ 03204000
*                  /*  AREA.  THEN LOOP UNTIL AN EMPTY       @Y30SSFR*/ 03205000
*                  /*  SLOT IS FOUND IN THE WORKAREA OR      @Y30SSFR*/ 03206000
*                  /*  UNTIL THE MAXIMUM NUMBER OF ITEMS     @Y30SSFR*/ 03207000
*                  /*  HAS BEEN PRINTED.                     @Y30SSFR*/ 03208000
*                  /*                                        @Y30SSFR*/ 03209000
*                  /**************************************************/ 03210000
*                                                                  0762 03211000
*                  LIMIT = (AREALN - 4) / LENGTH(ENTITEM); /*@Y30SSFR*/ 03212000
         L     @08,WAPTR                                           0762 03213000
         LH    @00,AREALN(,@08)                                    0762 03214000
         SL    @00,@CF00042                                        0762 03215000
         SRDA  @00,32                                              0762 03216000
         D     @00,@CF01066                                        0762 03217000
         ST    @01,LIMIT                                           0762 03218000
*                  IX = 1;                                 /*@Y30SSFR*/ 03219000
*                                                                  0763 03220000
         LA    IX,1                                                0763 03221000
*                  DO WHILE IX <= LIMIT &                  /*@Y30SSFR*/ 03222000
*                  ENTRYTYP(IX) ^= 0;                      /*@Y30SSFR*/ 03223000
         B     @DE00764                                            0764 03224000
@DL00764 DS    0H                                                  0765 03225000
*                    DARGDBP = ADDR(ENTLIST(IX));          /*@Y30SSFR*/ 03226000
         L     @08,DDSTRU                                          0765 03227000
         L     @03,WAPTR                                           0765 03228000
         LR    @15,IX                                              0765 03229000
         MH    @15,@CH01066                                        0765 03230000
         LA    @01,0(@15,@03)                                      0765 03231000
         AL    @01,@CF01103                                        0765 03232000
         ST    @01,DARGDBP(,@08)                                   0765 03233000
*                    IF ENTRYTYP (IX) = CTGTVOL            /*@Y30SSFR*/ 03234000
*                      THEN                                /*@Y30SSFR*/ 03235000
         ALR   @03,@15                                             0766 03236000
         AL    @03,@CF01103                                        0766 03237000
         CLI   ENTRYTYP-4(@03),C'V'                                0766 03238000
         BNE   @RF00766                                            0766 03239000
*                        DARGILP = SERLN +                 /*@Y30SSFR*/ 03240000
*                        LENGTH(ENTRYTYP(1));              /*@Y30SSFR*/ 03241000
         MVC   DARGILP(2,@08),@CH00472                             0767 03242000
*                      ELSE                                        0768 03243000
*                        DARGILP = LENGTH(ENTLIST(1));     /*@Y30SSFR*/ 03244000
*                                                                  0768 03245000
         B     @RC00766                                            0768 03246000
@RF00766 L     @08,DDSTRU                                          0768 03247000
         MVC   DARGILP(2,@08),@CH01066                             0768 03248000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU); /*@Y30SSFR*/ 03249000
*                                                                  0769 03250000
@RC00766 L     @08,@PC00001                                        0769 03251000
         ST    @08,@AL00001                                        0769 03252000
         LA    @03,@CF00115                                        0769 03253000
         ST    @03,@AL00001+4                                      0769 03254000
         LA    @03,DDSTRU                                          0769 03255000
         ST    @03,@AL00001+8                                      0769 03256000
         MVI   @AL00001+8,X'80'                                    0769 03257000
         L     @15,GDTPRT(,@08)                                    0769 03258000
         LA    @01,@AL00001                                        0769 03259000
         BALR  @14,@15                                             0769 03260000
*                    IX = IX + 1;                          /*@Y30SSFR*/ 03261000
         AL    IX,@CF00219                                         0770 03262000
*                  END;                                    /*@Y30SSFR*/ 03263000
*                                                                  0771 03264000
@DE00764 C     IX,LIMIT                                            0771 03265000
         BH    @DC00764                                            0771 03266000
         LR    @08,IX                                              0771 03267000
         MH    @08,@CH01066                                        0771 03268000
         L     @03,WAPTR                                           0771 03269000
         AL    @03,@CF01103                                        0771 03270000
         SLR   @15,@15                                             0771 03271000
         IC    @15,ENTRYTYP-4(@08,@03)                             0771 03272000
         C     @15,@CF00115                                        0771 03273000
         BNE   @DL00764                                            0771 03274000
@DC00764 DS    0H                                                  0772 03275000
*                  /**************************************************/ 03276000
*                  /*                                        @Y30SSFR*/ 03277000
*                  /*  IX IS, UPON EXITING THE LOOP, ONE MORE@Y30SSFR*/ 03278000
*                  /*  THAN THE ACTUAL NUMBER OF ITEMS IN    @Y30SSFR*/ 03279000
*                  /*  WORKAREA.  THUS THE VALUE THAT IS     @Y30SSFR*/ 03280000
*                  /*  PASSED TO MORESP AS THE NUMBER OF     @Y30SSFR*/ 03281000
*                  /*  ITEMS IN THE WORKAREA IS IX MINUS 1.  @Y30SSFR*/ 03282000
*                  /*                                        @Y30SSFR*/ 03283000
*                  /**************************************************/ 03284000
*                                                                  0772 03285000
*                  MNOENT = IX - 1;                        /*@Y30SSFR*/ 03286000
*                                                                  0772 03287000
         LR    @08,IX                                              0772 03288000
         BCTR  @08,0                                               0772 03289000
         ST    @08,MNOENT                                          0772 03290000
*                  END MPRTLP;                             /*@Y30SSFR*/ 03291000
*                                                                  0773 03292000
*                ELSE                                      /*@Y30SSFR*/ 03293000
*                                                                  0774 03294000
*                  /**************************************************/ 03295000
*                  /*                                        @Y30SSFR*/ 03296000
*                  /*  IF THE VSAM CATALOG RETURN CODE IS 72 @Y30SSFR*/ 03297000
*                  /*  OR 76, THE LAST ENTRY IN THE WORKAREA @Y30SSFR*/ 03298000
*                  /*  IS TO BE DYNAMICALLY ALLOCATED, AND   @Y30SSFR*/ 03299000
*                  /*  HAS NOT YET BEEN DELETED.  THAT       @Y30SSFR*/ 03300000
*                  /*  ENTRY AND EITHER THE PRECEDING ENTRY  @Y30SSFR*/ 03301000
*                  /*  OR THE TWO PRECEDING ENTRIES ARE NOT  @Y30SSFR*/ 03302000
*                  /*  NOT TO BE PRINTED.                    @Y30SSFR*/ 03303000
*                  /*                                        @Y30SSFR*/ 03304000
*                  /**************************************************/ 03305000
*                                                                  0774 03306000
*                  IF (CATLGRC = ALLORC1) |                /*@Y30SSFR*/ 03307000
*                       (CATLGRC = ALLORC3)                /*@Y30SSFR*/ 03308000
*                    THEN                                  /*#Y30SSFR*/ 03309000
         B     @RC00758                                            0774 03310000
@RF00758 LH    @08,CATLGRC                                         0774 03311000
         C     @08,@CF00914                                        0774 03312000
         BE    @RT00774                                            0774 03313000
         C     @08,@CF00916                                        0774 03314000
         BNE   @RF00774                                            0774 03315000
@RT00774 DS    0H                                                  0775 03316000
*A1PRTLP:              DO;                                 /*#Y30SSFR*/ 03317000
*                                                                  0775 03318000
A1PRTLP  DS    0H                                                  0776 03319000
*                      /**********************************************/ 03320000
*                      /*                                    #Y30SSFR*/ 03321000
*                      /*  CALCULATE THE MAXIMUM NUMBER OF   #Y30SSFR*/ 03322000
*                      /*  ENTRIES THAT CAN FIT INTO THE     #Y30SSFR*/ 03323000
*                      /*  WORK AREA.  THE NUMBER            @Y30SSFR*/ 03324000
*                      /*  TO BE PRINTED IS ONE LESS THAN    #Y30SSFR*/ 03325000
*                      /*  THE TOTAL NUMBER OF ITEMS IN      #Y30SSFR*/ 03326000
*                      /*  WORKAREA.                         @Y30SSFR*/ 03327000
*                      /*                                    @Y30SSFR*/ 03328000
*                      /**********************************************/ 03329000
*                                                                  0776 03330000
*                      LIMIT = ((RETURNLN - 4) /           /*@Y30SSFR*/ 03331000
*                      LENGTH(ENTITEM)) -1 ;               /*@Y30SSFR*/ 03332000
*                                                                  0776 03333000
         L     @08,WAPTR                                           0776 03334000
         LH    @00,RETURNLN(,@08)                                  0776 03335000
         SL    @00,@CF00042                                        0776 03336000
         SRDA  @00,32                                              0776 03337000
         D     @00,@CF01066                                        0776 03338000
         BCTR  @01,0                                               0776 03339000
         ST    @01,LIMIT                                           0776 03340000
*                      /**********************************************/ 03341000
*                      /*                                    @Y30SSFR*/ 03342000
*                      /*  LOOP, PRINTING THE NAMES OF THE   @Y30SSFR*/ 03343000
*                      /*  ENTRIES DELETED SO FAR.           @Y30SSFR*/ 03344000
*                      /*                                    @Y30SSFR*/ 03345000
*                      /**********************************************/ 03346000
*                                                                  0777 03347000
*                      DARGSMOD = DELMSG;                  /*@Y30SSFR*/ 03348000
         L     @08,DDSTRU                                          0777 03349000
         MVC   DARGSMOD(3,@08),@CC00888                            0777 03350000
*                      DARGSENT = ENTRYMSG;                /*@Y30SSFR*/ 03351000
         MVI   DARGSENT(@08),X'01'                                 0778 03352000
*                      IX = 1;                             /*@Y30SSFR*/ 03353000
*                                                                  0779 03354000
         LA    IX,1                                                0779 03355000
*                      DO WHILE IX <= LIMIT & ENTRYTYP(IX) /*@Y30SSFR*/ 03356000
*                      ^= 0;                               /*@Y30SSFR*/ 03357000
         B     @DE00780                                            0780 03358000
@DL00780 DS    0H                                                  0781 03359000
*                        DARGDBP = ADDR(ENTLIST(IX));      /*@Y30SSFR*/ 03360000
         L     @08,DDSTRU                                          0781 03361000
         L     @03,WAPTR                                           0781 03362000
         LR    @15,IX                                              0781 03363000
         MH    @15,@CH01066                                        0781 03364000
         LA    @01,0(@15,@03)                                      0781 03365000
         AL    @01,@CF01103                                        0781 03366000
         ST    @01,DARGDBP(,@08)                                   0781 03367000
*                        IF ENTRYTYP(IX) = CTGTVOL         /*@Y30SSFR*/ 03368000
*                          THEN                            /*@Y30SSFR*/ 03369000
         ALR   @03,@15                                             0782 03370000
         AL    @03,@CF01103                                        0782 03371000
         CLI   ENTRYTYP-4(@03),C'V'                                0782 03372000
         BNE   @RF00782                                            0782 03373000
*                            DARGILP = SERLN +             /*@Y30SSFR*/ 03374000
*                            LENGTH(ENTRYTYP(1));          /*@Y30SSFR*/ 03375000
         MVC   DARGILP(2,@08),@CH00472                             0783 03376000
*                          ELSE                            /*@Y30SSFR*/ 03377000
*                            DARGILP = LENGTH(ENTLIST(1)); /*@Y30SSFR*/ 03378000
*                                                                  0784 03379000
         B     @RC00782                                            0784 03380000
@RF00782 L     @08,DDSTRU                                          0784 03381000
         MVC   DARGILP(2,@08),@CH01066                             0784 03382000
*                        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*   0785 03383000
*                                                            @Y30SSFR*/ 03384000
*                                                                  0785 03385000
@RC00782 L     @08,@PC00001                                        0785 03386000
         ST    @08,@AL00001                                        0785 03387000
         LA    @03,@CF00115                                        0785 03388000
         ST    @03,@AL00001+4                                      0785 03389000
         LA    @03,DDSTRU                                          0785 03390000
         ST    @03,@AL00001+8                                      0785 03391000
         MVI   @AL00001+8,X'80'                                    0785 03392000
         L     @15,GDTPRT(,@08)                                    0785 03393000
         LA    @01,@AL00001                                        0785 03394000
         BALR  @14,@15                                             0785 03395000
*                        IX = IX + 1;                      /*@Y30SSFR*/ 03396000
         AL    IX,@CF00219                                         0786 03397000
*                      END;                                /*@Y30SSFR*/ 03398000
@DE00780 C     IX,LIMIT                                            0787 03399000
         BH    @DC00780                                            0787 03400000
         LR    @08,IX                                              0787 03401000
         MH    @08,@CH01066                                        0787 03402000
         L     @03,WAPTR                                           0787 03403000
         AL    @03,@CF01103                                        0787 03404000
         SLR   @15,@15                                             0787 03405000
         IC    @15,ENTRYTYP-4(@08,@03)                             0787 03406000
         C     @15,@CF00115                                        0787 03407000
         BNE   @DL00780                                            0787 03408000
@DC00780 DS    0H                                                  0788 03409000
*                      END A1PRTLP;                        /*@Y30SSFR*/ 03410000
*                                                                  0788 03411000
*                    ELSE                                  /*@Y30SSFR*/ 03412000
*                                                                  0789 03413000
*                      /**********************************************/ 03414000
*                      /*                                    @Y30SSFR*/ 03415000
*                      /*  FOR ALL OF THE REMAINING CASES,   @Y30SSFR*/ 03416000
*                      /*  THE NUMBER OF NAMES TO PRINT CAN  @Y30SSFR*/ 03417000
*                      /*  BE CALCULATED DIRECTLY FROM THE   @Y30SSFR*/ 03418000
*                      /*  VALUE OF RETURNLN.                @Y30SSFR*/ 03419000
*                      /*                                    @Y30SSFR*/ 03420000
*                      /**********************************************/ 03421000
*                                                                  0789 03422000
*OTPRTLP:              DO;                                 /*@Y30SSFR*/ 03423000
*                                                                  0789 03424000
         B     @RC00774                                            0789 03425000
@RF00774 DS    0H                                                  0789 03426000
OTPRTLP  DS    0H                                                  0790 03427000
*                      /**********************************************/ 03428000
*                      /*                                    @Y30SSFR*/ 03429000
*                      /*  IF THE VSAM CATALOG RETURN CODE   @Y30SSFR*/ 03430000
*                      /*  IS 160, ANY EMPTY DATA SPACES ON  @Y30SSFR*/ 03431000
*                      /*  THE VOLUME BEING DELETED HAVE     @Y30SSFR*/ 03432000
*                      /*  BEEN SCRATCHED, BUT THERE WERE    @Y30SSFR*/ 03433000
*                      /*  ALSO SOME NON-EMPTY DATA SPACES   @Y30SSFR*/ 03434000
*                      /*  ON THE VOLUME WHICH WERE NOT      @Y30SSFR*/ 03435000
*                      /*  DELETED.  VSAM HAS NOT GIVEN UP   @Y30SSFR*/ 03436000
*                      /*  VOLUME OWNERSHIP, AND AMS MUST    @Y30SSFR*/ 03437000
*                      /*  ISSUE AN INFORMATIONAL MESSAGE    @Y30SSFR*/ 03438000
*                      /*  TO THE USER.                      @Y30SSFR*/ 03439000
*                      /*                                    @Y30SSFR*/ 03440000
*                      /**********************************************/ 03441000
*                                                                  0790 03442000
*                      IF CATLGRC = VOLNODEL               /*@Y30SSFR*/ 03443000
*                        THEN                              /*@Y30SSFR*/ 03444000
         CLC   CATLGRC(2),@CH00920                                 0790 03445000
         BNE   @RF00790                                            0790 03446000
*                          DO;                             /*@Y30SSFR*/ 03447000
*                          /******************************************/ 03448000
*                          /*                                @Y30SSFR*/ 03449000
*                          /*  PRINT A MESSAGE INDICATING    @Y30SSFR*/ 03450000
*                          /*  THAT VSAM HAS NOT DELETED     @Y30SSFR*/ 03451000
*                          /*  THE VOLUME ENTRY RECORD FROM  @Y30SSFR*/ 03452000
*                          /*  THE CATALOG.                  @Y30SSFR*/ 03453000
*                          /*                                @Y30SSFR*/ 03454000
*                          /******************************************/ 03455000
*                                                                  0792 03456000
*                          DARGDBP = ADDR(SERNAME);        /*@Y30SSFR*/ 03457000
         L     @08,DDSTRU                                          0792 03458000
         LA    @15,SERNAME                                         0792 03459000
         ST    @15,DARGDBP(,@08)                                   0792 03460000
*                          DARGILP = SERLN;                /*@Y30SSFR*/ 03461000
         MVC   DARGILP(2,@08),@CH00156                             0793 03462000
*                          DARGSENT = DELMSG;              /*@Y30SSFR*/ 03463000
         L     @15,@CF00888                                        0794 03464000
         STC   @15,DARGSENT(,@08)                                  0794 03465000
*                          DARGSMOD = VOLMSG;              /*@Y30SSFR*/ 03466000
*                                                                  0795 03467000
         MVC   DARGSMOD(3,@08),@CF00286+1                          0795 03468000
*                          CALL AMSTP011(GDTTBL, PRTFILE,DDSTRU);/*     03469000
*                                                            @Y30SSFR*/ 03470000
*                                                                  0796 03471000
         L     @08,@PC00001                                        0796 03472000
         ST    @08,@AL00001                                        0796 03473000
         LA    @15,@CF00115                                        0796 03474000
         ST    @15,@AL00001+4                                      0796 03475000
         LA    @15,DDSTRU                                          0796 03476000
         ST    @15,@AL00001+8                                      0796 03477000
         MVI   @AL00001+8,X'80'                                    0796 03478000
         L     @15,GDTPRT(,@08)                                    0796 03479000
         LA    @01,@AL00001                                        0796 03480000
         BALR  @14,@15                                             0796 03481000
*                          END;                            /*@Y30SSFR*/ 03482000
*                                                                  0797 03483000
*                      /**********************************************/ 03484000
*                      /*                                    @Y30SSFR*/ 03485000
*                      /*  CALCULATE THE NUMBER OF NAMES TO  @Y30SSFR*/ 03486000
*                      /*  BE PRINTED, AND SET UP THE        @Y30SSFR*/ 03487000
*                      /*  MODULE AND MESSAGE ID'S IN THE    @Y30SSFR*/ 03488000
*                      /*  DARGLIST.                         @Y30SSFR*/ 03489000
*                      /*                                    @Y30SSFR*/ 03490000
*                      /**********************************************/ 03491000
*                                                                  0798 03492000
*                      ENTRYNO = (RETURNLN - 4)/           /*@Y30SSFR*/ 03493000
*                      LENGTH(ENTLIST);                    /*@Y30SSFR*/ 03494000
@RF00790 L     @08,WAPTR                                           0798 03495000
         LH    @00,RETURNLN(,@08)                                  0798 03496000
         SL    @00,@CF00042                                        0798 03497000
         SRDA  @00,32                                              0798 03498000
         D     @00,@CF01066                                        0798 03499000
         LR    ENTRYNO,@01                                         0798 03500000
*                      DARGSMOD = DELMSG;                  /*@Y30SSFR*/ 03501000
         L     @08,DDSTRU                                          0799 03502000
         MVC   DARGSMOD(3,@08),@CC00888                            0799 03503000
*                      DARGSENT = ENTRYMSG;                /*@Y30SSFR*/ 03504000
*                                                                  0800 03505000
         MVI   DARGSENT(@08),X'01'                                 0800 03506000
*                      /**********************************************/ 03507000
*                      /*                                    @Y30SSFR*/ 03508000
*                      /*  NOW LOOP PRINTING THE NAMES OF    @Y30SSFR*/ 03509000
*                      /*  THE OBJECTS DELETED FROM THE CMS  @Y30SSFR*/ 03510000
*                      /*  WORKAREA.                         @Y30SSFR*/ 03511000
*                      /*                                    @Y30SSFR*/ 03512000
*                      /**********************************************/ 03513000
*                                                                  0801 03514000
*                      DO I = 1 TO ENTRYNO;                /*@Y30SSFR*/ 03515000
         LA    I,1                                                 0801 03516000
         B     @DE00801                                            0801 03517000
@DL00801 DS    0H                                                  0802 03518000
*                        DARGDBP = ADDR(ENTLIST(I));       /*@Y30SSFR*/ 03519000
         L     @08,DDSTRU                                          0802 03520000
         L     @15,WAPTR                                           0802 03521000
         LR    @14,I                                               0802 03522000
         MH    @14,@CH01066                                        0802 03523000
         LA    @01,0(@14,@15)                                      0802 03524000
         AL    @01,@CF01103                                        0802 03525000
         ST    @01,DARGDBP(,@08)                                   0802 03526000
*                        IF ENTRYTYP(I) = CTGTVOL          /*@Y30SSFR*/ 03527000
*                          THEN                            /*@Y30SSFR*/ 03528000
         ALR   @15,@14                                             0803 03529000
         AL    @15,@CF01103                                        0803 03530000
         CLI   ENTRYTYP-4(@15),C'V'                                0803 03531000
         BNE   @RF00803                                            0803 03532000
*                            DARGILP = SERLN +             /*@Y30SSFR*/ 03533000
*                            LENGTH(ENTRYTYP(1));          /*@Y30SSFR*/ 03534000
         MVC   DARGILP(2,@08),@CH00472                             0804 03535000
*                          ELSE                            /*@Y30SSFR*/ 03536000
*                            DARGILP = LENGTH(ENTLIST(1)); /*@Y30SSFR*/ 03537000
         B     @RC00803                                            0805 03538000
@RF00803 L     @08,DDSTRU                                          0805 03539000
         MVC   DARGILP(2,@08),@CH01066                             0805 03540000
*                        IF ENTRYTYP(I) = BLANK            /*@OZ02293*/ 03541000
*                          THEN;                           /*@OZ02293*/ 03542000
@RC00803 LR    @08,I                                               0806 03543000
         MH    @08,@CH01066                                        0806 03544000
         L     @01,WAPTR                                           0806 03545000
         ALR   @01,@08                                             0806 03546000
         AL    @01,@CF01103                                        0806 03547000
         CLI   ENTRYTYP-4(@01),C' '                                0806 03548000
         BE    @RT00806                                            0806 03549000
*                          ELSE                            /*@OZ02293*/ 03550000
*                           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);  0808 03551000
*                                                                  0808 03552000
         L     @08,@PC00001                                        0808 03553000
         ST    @08,@AL00001                                        0808 03554000
         LA    @15,@CF00115                                        0808 03555000
         ST    @15,@AL00001+4                                      0808 03556000
         LA    @15,DDSTRU                                          0808 03557000
         ST    @15,@AL00001+8                                      0808 03558000
         MVI   @AL00001+8,X'80'                                    0808 03559000
         L     @15,GDTPRT(,@08)                                    0808 03560000
         LA    @01,@AL00001                                        0808 03561000
         BALR  @14,@15                                             0808 03562000
*                      END;                                /*@Y30SSFR*/ 03563000
*                                                                  0809 03564000
@RT00806 AL    I,@CF00219                                          0809 03565000
@DE00801 CR    I,ENTRYNO                                           0809 03566000
         BNH   @DL00801                                            0809 03567000
*                      END OTPRTLP;                        /*@Y30SSFR*/ 03568000
*                                                                  0810 03569000
*          /**********************************************************/ 03570000
*          /*                                                @Y30SSFR*/ 03571000
*          /*  DETERMINE THE COURSE OF FURTHER PROCESSING    @Y30SSFR*/ 03572000
*          /*  BY AGAIN EXAMINING THE VSAM CATALOG RETURN    @Y30SSFR*/ 03573000
*          /*  CODE.  CURRENTLY, RETURN CODES 40, 72, 76 AND @Y30SSFR*/ 03574000
*          /*  240 REQUIRE SPECIAL PROCESSING.  RETURN       @Y30SSFR*/ 03575000
*          /*  CODES 0 AND 160 INDICATE NORMAL TERMINATION   @Y30SSFR*/ 03576000
*          /*  WHILE ALL OTHER RETURN CODES INDICATE ERROR   @Y30SSFR*/ 03577000
*          /*  CONDITIONS.                                   @Y30SSFR*/ 03578000
*          /*                                                @Y30SSFR*/ 03579000
*          /**********************************************************/ 03580000
*                                                                  0811 03581000
*          IF CATLGRC = NEEDCORE                                   0811 03582000
*            THEN                                                  0811 03583000
*                                                                  0811 03584000
@RC00774 DS    0H                                                  0811 03585000
@RC00758 DS    0H                                                  0811 03586000
@RF00757 CLC   CATLGRC(2),@CH00912                                 0811 03587000
         BNE   @RF00811                                            0811 03588000
*              /******************************************************/ 03589000
*              /*                                            @Y30SSFR*/ 03590000
*              /*  THE VSAM CATALOG RETURN CODE IS 40.       @Y30SSFR*/ 03591000
*              /*  CALL MORESP TO EITHER CLEAR THE WORKAREA  @Y30SSFR*/ 03592000
*              /*  OR GET A NEW ONE.  IF MORESP IS SUCCESS-  @Y30SSFR*/ 03593000
*              /*  FUL, SET DEFINED TO ON TO INDICATE        @Y30SSFR*/ 03594000
*              /*  ANOTHER ITERATION OF THE LOOP CATALOG.    @Y30SSFR*/ 03595000
*              /*                                            @Y30SSFR*/ 03596000
*              /******************************************************/ 03597000
*                                                                  0812 03598000
*NCRC:         DO;                                         /*@Y30SSFR*/ 03599000
NCRC     DS    0H                                                  0813 03600000
*              CALL MORESP(MNOENT);                        /*@Y30SSFR*/ 03601000
         LA    @08,MNOENT                                          0813 03602000
         ST    @08,@AL00001                                        0813 03603000
         LA    @01,@AL00001                                        0813 03604000
         BAL   @14,MORESP                                          0813 03605000
*              RESPECIFY RTNREG RSTD;                              0814 03606000
*              TESTRC = RTNREG;                                    0815 03607000
         LR    TESTRC,RTNREG                                       0815 03608000
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/ 03609000
*              IF TESTRC ^= 0                              /*@Y30SSFR*/ 03610000
*                THEN                                      /*@Y30SSFR*/ 03611000
         LTR   TESTRC,TESTRC                                       0817 03612000
         BZ    @RF00817                                            0817 03613000
*                  DO;                                     /*@Y30SSFR*/ 03614000
*                  SETRC = LASTCC08;                       /*@Y30SSFR*/ 03615000
         LA    SETRC,8                                             0819 03616000
*                  RETURN CODE(SETRC);                     /*@Y30SSFR*/ 03617000
         LR    @15,SETRC                                           0820 03618000
         L     @14,@SA00006                                        0820 03619000
         LM    @00,@12,@SA00006+8                                  0820 03620000
         BR    @14                                                 0820 03621000
*                  END;                                    /*@Y30SSFR*/ 03622000
*              DEFINED = ON;                               /*@Y30SSFR*/ 03623000
@RF00817 OI    DEFINED,B'10000000'                                 0822 03624000
*              END NCRC;                                   /*@Y30SSFR*/ 03625000
*                                                                  0823 03626000
*            ELSE                                                  0824 03627000
*                                                                  0824 03628000
*              /******************************************************/ 03629000
*              /*                                            @Y30SSFR*/ 03630000
*              /*  TEST FOR A VSAM CATALOG RETURN CODE OF    @Y30SSFR*/ 03631000
*              /*  72 OR 76.                                 @Y30SSFR*/ 03632000
*              /*                                            @Y30SSFR*/ 03633000
*              /******************************************************/ 03634000
*                                                                  0824 03635000
*              IF (CATLGRC = ALLORC1 & (ADDR(SPACE) = NULLPTR)) |  0824 03636000
*                  (CATLGRC = ALLORC3)                     /*@OZ05919*/ 03637000
*                THEN                                              0824 03638000
*                                                                  0824 03639000
         B     @RC00811                                            0824 03640000
@RF00811 CLC   CATLGRC(2),@CH00914                                 0824 03641000
         BNE   @GL00070                                            0824 03642000
         L     @08,@PC00001+4                                      0824 03643000
         L     @08,FDTPTR+44(,@08)                                 0824 03644000
         LTR   @08,@08                                             0824 03645000
         BZ    @RT00824                                            0824 03646000
@GL00070 CLC   CATLGRC(2),@CH00916                                 0824 03647000
         BNE   @RF00824                                            0824 03648000
@RT00824 DS    0H                                                  0825 03649000
*                  /**************************************************/ 03650000
*                  /*                                        @Y30SSFR*/ 03651000
*                  /*  THE VSAM CATALOG RETURN CODE IS       @Y30SSFR*/ 03652000
*                  /*  EITHER 72 OR 76.                      @Y30SSFR*/ 03653000
*                  /*  THIS INDICATES THAT VSAM NEEDS SOME-  @Y30SSFR*/ 03654000
*                  /*  THING DYNAMICALLY ALLOCATED, AND HAS  @Y30SSFR*/ 03655000
*                  /*  PLACED THE NAME OF THE ITEM TO BE     @Y30SSFR*/ 03656000
*                  /*  ALLOCATED INTO THE CATALOG WORKAREA.  @Y30SSFR*/ 03657000
*                  /*  IF ALLOPROC IS SUCCESSFUL, THE        @Y30SSFR*/ 03658000
*                  /*  CATALOG WORKAREA IS CLEARED, AND      @Y30SSFR*/ 03659000
*                  /*  DEFINED IS SET TO ON TO INDICATE      @Y30SSFR*/ 03660000
*                  /*  ANOTHER ITERATION OF THE LOOP         @Y30SSFR*/ 03661000
*                  /*  CATALOG.                              @Y30SSFR*/ 03662000
*                  /*                                        @Y30SSFR*/ 03663000
*                  /**************************************************/ 03664000
*                                                                  0825 03665000
*A1RC:             DO;                                     /*@Y30SSFR*/ 03666000
A1RC     DS    0H                                                  0826 03667000
*                  ALLOINDX = (RETURNLN-4)/                /*@Y30SSFR*/ 03668000
*                  LENGTH(ENTITEM);                        /*@Y30SSFR*/ 03669000
*                                                                  0826 03670000
         LA    @08,45                                              0826 03671000
         L     @15,WAPTR                                           0826 03672000
         LH    @00,RETURNLN(,@15)                                  0826 03673000
         SL    @00,@CF00042                                        0826 03674000
         SRDA  @00,32                                              0826 03675000
         DR    @00,@08                                             0826 03676000
         LR    ALLOINDX,@01                                        0826 03677000
*                  /**************************************************/ 03678000
*                  /*                                        @Y30SSFR*/ 03679000
*                  /*  RESTORE THE CPL PRIOR TO REQUESTING   @Y30SSFR*/ 03680000
*                  /*  DYNAMIC ALLOCATION.                   @Y30SSFR*/ 03681000
*                  /*                                        @Y30SSFR*/ 03682000
*                  /**************************************************/ 03683000
*                                                                  0827 03684000
*                  CTGPL = RENEWCPL;                       /*@Y30SSFR*/ 03685000
*                                                                  0827 03686000
         L     @02,CTGPLPTR                                        0827 03687000
         MVC   CTGPL(28,@02),RENEWCPL                              0827 03688000
*                  /**************************************************/ 03689000
*                  /*                                        #Y30SSFR*/ 03690000
*                  /*  ALLOINDX IS THE INDEX OF THE LAST     #Y30SSFR*/ 03691000
*                  /*  ENTRY IN THE CMS WORKAREA.  TEST THE  #Y30SSFR*/ 03692000
*                  /*  TYPE OF THE ENTRY TO DETERMINE        #Y30SSFR*/ 03693000
*                  /*  WHETHER THE ALLOCATION IS TO BE BY    #Y30SSFR*/ 03694000
*                  /*  VOLUME OR DATA SET NAME.              #Y30SSFR*/ 03695000
*                  /*                                        #Y30SSFR*/ 03696000
*                  /**************************************************/ 03697000
*                                                                  0828 03698000
*                  IF ENTRYTYP(ALLOINDX) = CTGTVOL         /*#Y30SSFR*/ 03699000
*                    THEN                                  /*#Y30SSFR*/ 03700000
         LR    @01,@08                                             0828 03701000
         MR    @00,ALLOINDX                                        0828 03702000
         ST    @01,@TF00001                                        0828 03703000
         ALR   @01,@15                                             0828 03704000
         AL    @01,@CF01103                                        0828 03705000
         CLI   ENTRYTYP-4(@01),C'V'                                0828 03706000
         BNE   @RF00828                                            0828 03707000
*                      CALL ALLOPROC(NULLPARM,             /*#Y30SSFR*/ 03708000
*                      ADDR(ENTRYNM(ALLOINDX)));           /*#Y30SSFR*/ 03709000
         LA    @08,@CF00115                                        0829 03710000
         ST    @08,@AL00001                                        0829 03711000
         L     @08,@TF00001                                        0829 03712000
         AL    @15,@CF01104                                        0829 03713000
         LA    @08,ENTRYNM-5(@08,@15)                              0829 03714000
         ST    @08,@AFTEMPS+8                                      0829 03715000
         LA    @08,@AFTEMPS+8                                      0829 03716000
         ST    @08,@AL00001+4                                      0829 03717000
         LA    @01,@AL00001                                        0829 03718000
         BAL   @14,ALLOPROC                                        0829 03719000
*                    ELSE                                  /*#Y30SSFR*/ 03720000
*                      CALL ALLOPROC(                      /*#Y30SSFR*/ 03721000
*                      ADDR(ENTRYNM(ALLOINDX)),            /*#Y30SSFR*/ 03722000
*                      NULLPARM);                          /*#Y30SSFR*/ 03723000
*                                                                  0830 03724000
         B     @RC00828                                            0830 03725000
@RF00828 LR    @08,ALLOINDX                                        0830 03726000
         MH    @08,@CH01066                                        0830 03727000
         L     @02,WAPTR                                           0830 03728000
         AL    @02,@CF01104                                        0830 03729000
         LA    @08,ENTRYNM-5(@08,@02)                              0830 03730000
         ST    @08,@AFTEMPS+8                                      0830 03731000
         LA    @08,@AFTEMPS+8                                      0830 03732000
         ST    @08,@AL00001                                        0830 03733000
         LA    @08,@CF00115                                        0830 03734000
         ST    @08,@AL00001+4                                      0830 03735000
         LA    @01,@AL00001                                        0830 03736000
         BAL   @14,ALLOPROC                                        0830 03737000
*                  RESPECIFY RTNREG RSTD;                          0831 03738000
@RC00828 DS    0H                                                  0832 03739000
*                  TESTRC = RTNREG;                                0832 03740000
         LR    TESTRC,RTNREG                                       0832 03741000
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/ 03742000
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/ 03743000
*                    THEN                                  /*#Y30SSFR*/ 03744000
         LTR   TESTRC,TESTRC                                       0834 03745000
         BZ    @RF00834                                            0834 03746000
*                      DO;                                 /*#Y30SSFR*/ 03747000
*                      SETRC = LASTCC08;                   /*#Y30SSFR*/ 03748000
         LA    SETRC,8                                             0836 03749000
*                      RETURN CODE(SETRC);                 /*#Y30SSFR*/ 03750000
         LR    @15,SETRC                                           0837 03751000
         L     @14,@SA00006                                        0837 03752000
         LM    @00,@12,@SA00006+8                                  0837 03753000
         BR    @14                                                 0837 03754000
*                      END;                                /*#Y30SSFR*/ 03755000
*                                                                  0838 03756000
*                  /**************************************************/ 03757000
*                  /*                                        #Y30SSFR*/ 03758000
*                  /*  ALLOPROC HAS COMPLETED SUCCESSFULLY.  #Y30SSFR*/ 03759000
*                  /*  INSERT A POINTER TO THE DDNAME        @Y30SSFR*/ 03760000
*                  /*  RETURNED BY DYNAMIC ALLOCATION        @Y30SSFR*/ 03761000
*                  /*  IN THE CPL CTGDDNM FIELD.             @Y30SSFR*/ 03762000
*                  /*  CLEAR THE CATALOG WORKAREA OF THE     #Y30SSFR*/ 03763000
*                  /*  NAMES PLACED THERE BY THE PREVIOUS    #Y30SSFR*/ 03764000
*                  /*  CALL TO CATALOG.                      #Y30SSFR*/ 03765000
*                  /*                                        #Y30SSFR*/ 03766000
*                  /**************************************************/ 03767000
*                                                                  0839 03768000
*                  CTGDDNM = ADDR(ALLDDN);                 /*@Y30SSFR*/ 03769000
@RF00834 L     @08,ALLPTR                                          0839 03770000
         LA    @08,ALLDDN(,@08)                                    0839 03771000
         L     @02,CTGPLPTR                                        0839 03772000
         ST    @08,CTGDDNM(,@02)                                   0839 03773000
*                  DO IND1 = 1 TO ALLOINDX;                /*#Y30SSFR*/ 03774000
         LA    IND1,1                                              0840 03775000
         B     @DE00840                                            0840 03776000
@DL00840 DS    0H                                                  0841 03777000
*                    ENTLIST(IND1) = ''B;                  /*#Y30SSFR*/ 03778000
         LR    @08,IND1                                            0841 03779000
         MH    @08,@CH01066                                        0841 03780000
         L     @01,WAPTR                                           0841 03781000
         ALR   @01,@08                                             0841 03782000
         AL    @01,@CF01103                                        0841 03783000
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    0841 03784000
*                  END;                                    /*#Y30SSFR*/ 03785000
         AL    IND1,@CF00219                                       0842 03786000
@DE00840 CR    IND1,ALLOINDX                                       0842 03787000
         BNH   @DL00840                                            0842 03788000
*                  RETURNLN = 0;                           /*#Y30SSFR*/ 03789000
*                                                                  0843 03790000
         L     @08,WAPTR                                           0843 03791000
         SLR   @15,@15                                             0843 03792000
         STH   @15,RETURNLN(,@08)                                  0843 03793000
*                  /**************************************************/ 03794000
*                  /*                                        @Y30SSFR*/ 03795000
*                  /*  SET DEFINED TO BE ON TO INDICATE      @Y30SSFR*/ 03796000
*                  /*  ANOTHER ITERATION OF THE LOOP         @Y30SSFR*/ 03797000
*                  /*  CATALOG.                              @Y30SSFR*/ 03798000
*                  /*                                        @Y30SSFR*/ 03799000
*                  /**************************************************/ 03800000
*                                                                  0844 03801000
*                  DEFINED = ON;                           /*@Y30SSFR*/ 03802000
         OI    DEFINED,B'10000000'                                 0844 03803000
*                  END A1RC;                               /*@Y30SSFR*/ 03804000
*                                                                  0845 03805000
*                ELSE                                      /*@Y30SSFR*/ 03806000
*                                                                  0846 03807000
*                  /**************************************************/ 03808000
*                  /*                                        @Y30SSFR*/ 03809000
*                  /*  TEST FOR A VSAM CATALOG RETURN CODE   @Y30SSFR*/ 03810000
*                  /*  OF 240.                               @Y30SSFR*/ 03811000
*                  /*                                        @Y30SSFR*/ 03812000
*                  /**************************************************/ 03813000
*                                                                  0846 03814000
*                  IF CATLGRC = ALLORC2                    /*@Y30SSFR*/ 03815000
*                    THEN                                  /*@Y30SSFR*/ 03816000
*                                                                  0846 03817000
         B     @RC00824                                            0846 03818000
@RF00824 CLC   CATLGRC(2),@CH00922                                 0846 03819000
         BNE   @RF00846                                            0846 03820000
*                      /**********************************************/ 03821000
*                      /*                                    @Y30SSFR*/ 03822000
*                      /*  THE VSAM CATALOG RETURN CODE IS   @Y30SSFR*/ 03823000
*                      /*  240.  THIS INDICATES THAT THE     @Y30SSFR*/ 03824000
*                      /*  OBJECT TO BE DELETED WAS DEFINED  @Y30SSFR*/ 03825000
*                      /*  WITH THE ERASE ATTRIBUTE,  AND    @Y30SSFR*/ 03826000
*                      /*  MUST BE DYNAMICALLY ALLOCATED     @Y30SSFR*/ 03827000
*                      /*  FOR CATALOG.  THE OBJECT TO BE    @Y30SSFR*/ 03828000
*                      /*  ALLOCATED IS POINTED TO BY THE    @Y30SSFR*/ 03829000
*                      /*  CTGENT FIELD OF THE CTGPL.        @Y30SSFR*/ 03830000
*                      /*  TEST TO MAKE SURE THAT THE        @Y30SSFR*/ 03831000
*                      /*  CATALOG BEING DELETED FROM IS     @Y30SSFR*/ 03832000
*                      /*  AVAILABLE TO DYNAMIC ALLOCATION.  @Y30SSFR*/ 03833000
*                      /*                                    @Y30SSFR*/ 03834000
*                      /**********************************************/ 03835000
*                                                                  0847 03836000
*                      IF ADDR(CAT) ^= NULLPTR             /*@Y30SSFR*/ 03837000
*                        THEN                              /*@Y30SSFR*/ 03838000
         L     @08,@PC00001+4                                      0847 03839000
         L     @08,FDTPTR+8(,@08)                                  0847 03840000
         LTR   @08,@08                                             0847 03841000
         BZ    @RF00847                                            0847 03842000
*                          CALL RC240PRC;                  /*@Y30SSFR*/ 03843000
         BAL   @14,RC240PRC                                        0848 03844000
*                        ELSE                              /*#Y30SSFR*/ 03845000
*A2RC2:                    DO;                             /*#Y30SSFR*/ 03846000
*                                                                  0849 03847000
         B     @RC00847                                            0849 03848000
@RF00847 DS    0H                                                  0849 03849000
A2RC2    DS    0H                                                  0850 03850000
*                          /******************************************/ 03851000
*                          /*                                #Y30SSFR*/ 03852000
*                          /*  CALL ALLOPROC TO ALLOCATE THE #Y30SSFR*/ 03853000
*                          /*  OBJECT TO BE ERASED.          #Y30SSFR*/ 03854000
*                          /*                                #Y30SSFR*/ 03855000
*                          /******************************************/ 03856000
*                                                                  0850 03857000
*                          CALL ALLOPROC(ADDR(ENTVAL(ENT)),        0850 03858000
*                          NULLPARM);                      /*#Y30SSFR*/ 03859000
*                                                                  0850 03860000
         LR    @08,ENT                                             0850 03861000
         MH    @08,@CH01066                                        0850 03862000
         L     @01,GENWKPTR                                        0850 03863000
         AL    @01,@CF01104                                        0850 03864000
         LA    @08,ENTVAL-5(@08,@01)                               0850 03865000
         ST    @08,@AFTEMPS+8                                      0850 03866000
         LA    @08,@AFTEMPS+8                                      0850 03867000
         ST    @08,@AL00001                                        0850 03868000
         LA    @08,@CF00115                                        0850 03869000
         ST    @08,@AL00001+4                                      0850 03870000
         LA    @01,@AL00001                                        0850 03871000
         BAL   @14,ALLOPROC                                        0850 03872000
*                          RESPECIFY RTNREG RSTD;                  0851 03873000
*                          TESTRC = RTNREG;                        0852 03874000
         LR    TESTRC,RTNREG                                       0852 03875000
*                          RESPECIFY RTNREG UNRSTD;        /*#Y30SSFR*/ 03876000
*                          IF TESTRC ^= 0                  /*#Y30SSFR*/ 03877000
*                            THEN                          /*#Y30SSFR*/ 03878000
         LTR   TESTRC,TESTRC                                       0854 03879000
         BZ    @RF00854                                            0854 03880000
*                              DO;                         /*#Y30SSFR*/ 03881000
*                              SETRC = LASTCC08;           /*#Y30SSFR*/ 03882000
         LA    @08,8                                               0856 03883000
         LR    SETRC,@08                                           0856 03884000
*                              RETURN CODE(LASTCC08);      /*#Y30SSFR*/ 03885000
         LR    @15,@08                                             0857 03886000
         L     @14,@SA00006                                        0857 03887000
         LM    @00,@12,@SA00006+8                                  0857 03888000
         BR    @14                                                 0857 03889000
*                              END;                        /*#Y30SSFR*/ 03890000
*                                                                  0858 03891000
*                          /******************************************/ 03892000
*                          /*                                #Y30SSFR*/ 03893000
*                          /*  SET DEFINED TO BE ON TO       #Y30SSFR*/ 03894000
*                          /*  INDICATE ANOTHER ITERATION    #Y30SSFR*/ 03895000
*                          /*  OF THE LOOP CATALOG.  ALSO    #Y30SSFR*/ 03896000
*                          /*  SET CTGDDNM TO POINT TO       #Y30SSFR*/ 03897000
*                          /*  THE DDNAME RETURNED BY        #Y30SSFR*/ 03898000
*                          /*  DYNAMIC ALLOCATION.           #Y30SSFR*/ 03899000
*                          /*                                #Y30SSFR*/ 03900000
*                          /******************************************/ 03901000
*                                                                  0859 03902000
*                          DEFINED = ON;                   /*#Y30SSFR*/ 03903000
@RF00854 OI    DEFINED,B'10000000'                                 0859 03904000
*                          CTGDDNM = ADDR(ALLDDN);         /*#Y30SSFR*/ 03905000
         L     @08,ALLPTR                                          0860 03906000
         LA    @08,ALLDDN(,@08)                                    0860 03907000
         L     @01,CTGPLPTR                                        0860 03908000
         ST    @08,CTGDDNM(,@01)                                   0860 03909000
*                          END A2RC2;                      /*#Y30SSFR*/ 03910000
*                                                                  0861 03911000
*          /**********************************************************/ 03912000
*          /*                                                #Y30SSFR*/ 03913000
*          /*  SAVE THE CURRENT CPL IN RENEWCPL PRIOR TO     #Y30SSFR*/ 03914000
*          /*  CALLING CATALOG AGAIN.                        #Y30SSFR*/ 03915000
*          /*                                                #Y30SSFR*/ 03916000
*          /**********************************************************/ 03917000
*                                                                  0862 03918000
*          IF DEFINED = ON                                 /*#Y30SSFR*/ 03919000
*            THEN                                          /*#Y30SSFR*/ 03920000
@RC00847 DS    0H                                                  0862 03921000
@RF00846 DS    0H                                                  0862 03922000
@RC00824 DS    0H                                                  0862 03923000
@RC00811 TM    DEFINED,B'10000000'                                 0862 03924000
         BNO   @RF00862                                            0862 03925000
*              RENEWCPL = CTGPL;                           /*#Y30SSFR*/ 03926000
*                                                                  0863 03927000
         L     @08,CTGPLPTR                                        0863 03928000
         MVC   RENEWCPL(28),CTGPL(@08)                             0863 03929000
*        END CATALOG;                                      /*#Y30SSFR*/ 03930000
*                                                                  0864 03931000
@RF00862 DS    0H                                                  0864 03932000
@DE00743 TM    DEFINED,B'10000000'                                 0864 03933000
         BO    @DL00743                                            0864 03934000
*         /***********************************************************/ 03935000
*         /*                                                 @Z40RSSA*/ 03936000
*          /* IF THE CATALOG RETURN CODE IS 110, PRINT       @Z40RSSA*/ 03937000
*          /* THE REASON THE PROFILE COULD NOT               @Z40RSSA*/ 03938000
*          /* BE DELETED.                                    @Z40RSSA*/ 03939000
*          /*           REASON CODE 4 - NO PROFILE.          @Z40RSSA*/ 03940000
*          /*           REASON CODE 8 - PROFILE NOT DELETEABLE       */ 03941000
*          /*                                                @Z40RSSA*/ 03942000
*          /**********************************************************/ 03943000
*                                                                  0865 03944000
*          IF CATLGRC = PRNTDEL & ((CTGFBFLG=NFRET) |              0865 03945000
*           (CTGFBFLG=NDRET)) THEN                                 0865 03946000
         CLC   CATLGRC(2),@CH00918                                 0865 03947000
         BNE   @RF00865                                            0865 03948000
         L     @08,CTGPLPTR                                        0865 03949000
         CLC   CTGFBFLG(2,@08),@CH00042                            0865 03950000
         BE    @RT00865                                            0865 03951000
         CLC   CTGFBFLG(2,@08),@CH00179                            0865 03952000
         BNE   @RF00865                                            0865 03953000
@RT00865 DS    0H                                                  0866 03954000
*            DO;                                           /*@Z40RSSA*/ 03955000
*              DARGLIST = ''B;                             /*@Z40RSSA*/ 03956000
         L     @08,DDSTRU                                          0867 03957000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0867 03958000
*              DARGSMOD = DELMSG;                          /*@Z40RSSA*/ 03959000
         MVC   DARGSMOD(3,@08),@CC00888                            0868 03960000
*              IF CTGFBFLG = NFRET THEN                            0869 03961000
         L     @04,CTGPLPTR                                        0869 03962000
         CLC   CTGFBFLG(2,@04),@CH00042                            0869 03963000
         BNE   @RF00869                                            0869 03964000
*                DARGSENT = PFNTFND;                       /*@Z40RSSA*/ 03965000
         MVI   DARGSENT(@08),X'0D'                                 0870 03966000
*              ELSE                                                0871 03967000
*                DARGSENT = PFINUSE;                       /*@Z40RSSA*/ 03968000
         B     @RC00869                                            0871 03969000
@RF00869 L     @08,DDSTRU                                          0871 03970000
         MVI   DARGSENT(@08),X'0C'                                 0871 03971000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@Z40RSSA*/ 03972000
@RC00869 L     @08,@PC00001                                        0872 03973000
         ST    @08,@AL00001                                        0872 03974000
         LA    @15,@CF00115                                        0872 03975000
         ST    @15,@AL00001+4                                      0872 03976000
         LA    @15,DDSTRU                                          0872 03977000
         ST    @15,@AL00001+8                                      0872 03978000
         MVI   @AL00001+8,X'80'                                    0872 03979000
         L     @15,GDTPRT(,@08)                                    0872 03980000
         LA    @01,@AL00001                                        0872 03981000
         BALR  @14,@15                                             0872 03982000
*              SETRC = LASTCC04;                           /*@Z40RSSA*/ 03983000
         LA    SETRC,4                                             0873 03984000
*              RETURN CODE(SETRC);                         /*@Z40RSSA*/ 03985000
         LR    @15,SETRC                                           0874 03986000
         L     @14,@SA00006                                        0874 03987000
         LM    @00,@12,@SA00006+8                                  0874 03988000
         BR    @14                                                 0874 03989000
*            END;                                          /*@Z40RSSA*/ 03990000
*        /************************************************************/ 03991000
*        /*                                                  #Y30SSFR*/ 03992000
*        /*  IF THE VSAM CATALOG RETURN CODE IS 160, THE     #Y30SSFR*/ 03993000
*        /*  DELETION OF A DATA SPACE ON A VOLUME DID NOT    #Y30SSFR*/ 03994000
*        /*  CAUSE THE DELETION OF A VOLUME ENTRY RECORD     #Y30SSFR*/ 03995000
*        /*  FROM THE CATALOG, FOR THERE ARE OTHER, NON-     #Y30SSFR*/ 03996000
*        /*  EMPTY DATA SPACES ON THE VOLUME.                #Y30SSFR*/ 03997000
*        /*                                                  #Y30SSFR*/ 03998000
*        /************************************************************/ 03999000
*                                                                  0876 04000000
*        IF CATLGRC = VOLNODEL                             /*#Y30SSFR*/ 04001000
*          THEN                                            /*#Y30SSFR*/ 04002000
@RF00865 CLC   CATLGRC(2),@CH00920                                 0876 04003000
         BNE   @RF00876                                            0876 04004000
*            DO;                                           /*#Y30SSFR*/ 04005000
*                                                                  0877 04006000
*            /********************************************************/ 04007000
*            /*                                              #Y30SSFR*/ 04008000
*            /*  THE VSAM CATALOG RETURN CODE IS 160.        #Y30SSFR*/ 04009000
*            /*  PRINT A MESSAGE SAYING THE VOLUME ENTRY     #Y30SSFR*/ 04010000
*            /*  RECORD WAS NOT DELETED, BUT MAKE SETRC 0,   #Y30SSFR*/ 04011000
*            /*  FOR THIS IS NOT AN ERROR.                   #Y30SSFR*/ 04012000
*            /*                                              #Y30SSFR*/ 04013000
*            /********************************************************/ 04014000
*                                                                  0878 04015000
*            DARGSENT = VOLMSG;                            /*#Y30SSFR*/ 04016000
         L     @08,DDSTRU                                          0878 04017000
         MVI   DARGSENT(@08),X'05'                                 0878 04018000
*            DARGSMOD = DELMSG;                            /*#Y30SSFR*/ 04019000
         MVC   DARGSMOD(3,@08),@CC00888                            0879 04020000
*            DARGILP = SERLN;                              /*#Y30SSFR*/ 04021000
         MVC   DARGILP(2,@08),@CH00156                             0880 04022000
*            DARGDBP = ADDR(SERNAME);                      /*#Y30SSFR*/ 04023000
*                                                                  0881 04024000
         LA    @15,SERNAME                                         0881 04025000
         ST    @15,DARGDBP(,@08)                                   0881 04026000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*#Y30SSFR*/ 04027000
*                                                                  0882 04028000
         L     @08,@PC00001                                        0882 04029000
         ST    @08,@AL00001                                        0882 04030000
         LA    @15,@CF00115                                        0882 04031000
         ST    @15,@AL00001+4                                      0882 04032000
         LA    @15,DDSTRU                                          0882 04033000
         ST    @15,@AL00001+8                                      0882 04034000
         MVI   @AL00001+8,X'80'                                    0882 04035000
         L     @15,GDTPRT(,@08)                                    0882 04036000
         LA    @01,@AL00001                                        0882 04037000
         BALR  @14,@15                                             0882 04038000
*            SETRC = LASTCC00;                             /*#Y30SSFR*/ 04039000
         SLR   SETRC,SETRC                                         0883 04040000
*            END;                                          /*#Y30SSFR*/ 04041000
*                                                                  0884 04042000
*        /************************************************************/ 04043000
*        /*                                                  #Y30SSFR*/ 04044000
*        /*  IF THE VSAM CATALOG RETURN IS NEITHER 0 OR 160        0885 04045000
*        /*  THERE IS AN ERROR CONDITION.  PRINT THE               0885 04046000
*        /*  VSAM CATALOG RETURN CODE PROBLEM DETERMINATION  #Y30SSFR*/ 04047000
*        /*  MESSAGE PROVIDED THAT CATALOG HAS SET A MODULE  #Y30SSFR*/ 04048000
*        /*  ID IN THE CTGFDBK FIELD OF THE CPL.  OTHERWISE  #Y30SSFR*/ 04049000
*        /*  SIMPLY PRINT THE VSAM CATALOG RETURN CODE.      #Y30SSFR*/ 04050000
*        /*                                                  #Y30SSFR*/ 04051000
*        /************************************************************/ 04052000
*                                                                  0885 04053000
*        IF CATLGRC ^= 0 & CATLGRC ^= VOLNODEL             /*#Y30SSFR*/ 04054000
*          THEN                                            /*#Y30SSFR*/ 04055000
@RF00876 LH    @08,CATLGRC                                         0885 04056000
         LTR   @08,@08                                             0885 04057000
         BZ    @RF00885                                            0885 04058000
         C     @08,@CF00920                                        0885 04059000
         BE    @RF00885                                            0885 04060000
*            DO;                                           /*#Y30SSFR*/ 04061000
*                                                                  0886 04062000
*            /********************************************************/ 04063000
*            /*                                              #Y30SSFR*/ 04064000
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     #Y30SSFR*/ 04065000
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/ 04066000
*            /*                                              #Y30SSFR*/ 04067000
*            /********************************************************/ 04068000
*                                                                  0887 04069000
*            ERRORTAB = ''B;                               /*#Y30SSFR*/ 04070000
*                                                                  0887 04071000
         XC    ERRORTAB(32),ERRORTAB                               0887 04072000
*            /********************************************************/ 04073000
*            /*                                              #Y30SSFR*/ 04074000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    #Y30SSFR*/ 04075000
*            /*  THE ERROR CONVERSION TABLE.                 #Y30SSFR*/ 04076000
*            /*                                              #Y30SSFR*/ 04077000
*            /********************************************************/ 04078000
*                                                                  0888 04079000
*            ERCNVADR = ADDR(ERRORTAB);                    /*#Y30SSFR*/ 04080000
*                                                                  0888 04081000
         LA    @15,ERRORTAB                                        0888 04082000
         ST    @15,ERCNVADR                                        0888 04083000
*            /********************************************************/ 04084000
*            /*                                              #Y30SSFR*/ 04085000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  #Y30SSFR*/ 04086000
*            /*  IS A CATALOG ERROR.  SET ERCATDL TO BE ON   #Y30SSFR*/ 04087000
*            /*  TO INDICATE THAT THE ERROR OCCURRED ON A    #Y30SSFR*/ 04088000
*            /*  CATALOG DELETE OPERATION.                   #Y30SSFR*/ 04089000
*            /*                                              #Y30SSFR*/ 04090000
*            /********************************************************/ 04091000
*                                                                  0889 04092000
*            ERCATLG = ON;                                 /*#Y30SSFR*/ 04093000
         OI    ERCATLG(@15),B'10000000'                            0889 04094000
*            ERCATDL = ON;                                 /*#Y30SSFR*/ 04095000
*                                                                  0890 04096000
         OI    ERCATDL(@15),B'00100000'                            0890 04097000
*            /********************************************************/ 04098000
*            /*                                              #Y30SSFR*/ 04099000
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  #Y30SSFR*/ 04100000
*            /*  POINT TO THE CPL FOR THE DELETE OPERATION.  #Y30SSFR*/ 04101000
*            /*                                              #Y30SSFR*/ 04102000
*            /********************************************************/ 04103000
*                                                                  0891 04104000
*            ERCATRC = CATLGRC;                            /*#Y30SSFR*/ 04105000
         ST    @08,ERCATRC(,@15)                                   0891 04106000
*            ERCPLPT = CTGPLPTR;                           /*#Y30SSFR*/ 04107000
*                                                                  0892 04108000
         L     @08,CTGPLPTR                                        0892 04109000
         ST    @08,ERCPLPT(,@15)                                   0892 04110000
*            /********************************************************/ 04111000
*            /*                                              #Y30SSFR*/ 04112000
*            /*  SET A POINTER TO THE ENTRY NAME BEING       #Y30SSFR*/ 04113000
*            /*  DELETED IN THE ERROR CONVERSION TABLE.      #Y30SSFR*/ 04114000
*            /*                                              #Y30SSFR*/ 04115000
*            /********************************************************/ 04116000
*                                                                  0893 04117000
*            ERDSNM = CTGENT;                              /*#Y30SSFR*/ 04118000
*                                                                  0893 04119000
         L     @08,CTGENT(,@08)                                    0893 04120000
         ST    @08,ERDSNM(,@15)                                    0893 04121000
*            /********************************************************/ 04122000
*            /*                                              #Y30SSFR*/ 04123000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    #Y30SSFR*/ 04124000
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     #Y30SSFR*/ 04125000
*            /*                                              #Y30SSFR*/ 04126000
*            /********************************************************/ 04127000
*                                                                  0894 04128000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*#Y30SSFR*/ 04129000
*                                                                  0894 04130000
         L     @08,@PC00001                                        0894 04131000
         ST    @08,@AL00001                                        0894 04132000
         LA    @15,ERCNVADR                                        0894 04133000
         ST    @15,@AL00001+4                                      0894 04134000
         MVI   @AL00001+4,X'80'                                    0894 04135000
         L     @15,GDTERR(,@08)                                    0894 04136000
         LA    @01,@AL00001                                        0894 04137000
         BALR  @14,@15                                             0894 04138000
*            SETRC = LASTCC08;                             /*#Y30SSFR*/ 04139000
         LA    SETRC,8                                             0895 04140000
*            END;                                          /*#Y30SSFR*/ 04141000
*          ELSE                                                    0897 04142000
*                                                                  0897 04143000
*            /********************************************************/ 04144000
*            /*                                              #Y30SSFR*/ 04145000
*            /*  MAKE SETRC EQUAL TO 0 TO INDICATE THAT      #Y30SSFR*/ 04146000
*            /*  THE PRESENT ENTRY (ENTVAL(ENT)) HAS BEEN    #Y30SSFR*/ 04147000
*            /*  SUCCESSFULLY DELETED.                       #Y30SSFR*/ 04148000
*            /*                                              #Y30SSFR*/ 04149000
*            /********************************************************/ 04150000
*                                                                  0897 04151000
*            SETRC = LASTCC00;                             /*#Y30SSFR*/ 04152000
*                                                                  0897 04153000
*                                                                  0897 04154000
         B     @RC00885                                            0897 04155000
@RF00885 SLR   SETRC,SETRC                                         0897 04156000
*        RETURN CODE (SETRC);                                      0898 04157000
@RC00885 LR    @15,SETRC                                           0898 04158000
         L     @14,@SA00006                                        0898 04159000
         LM    @00,@12,@SA00006+8                                  0898 04160000
         BR    @14                                                 0898 04161000
*END CATCALL;                                                      0899 04162000
*        /************************************************************/ 04163000
*        /*                                                  #YL026UA*/ 04164000
*        /*  PROCEDURE NAME - MEMDLETE                       #YL026UA*/ 04165000
*        /*                                                  #YL026UA*/ 04166000
*        /*  FUNCTION - INVOKE THE USTOW MACRO TO DELETE THE #YL026UA*/ 04167000
*        /*  SPECIFIED MEMBER FROM THE DIRECTORY OF THE      #YL026UA*/ 04168000
*        /*  PDS AND ISSUE APPROPRIATE DELETION MESSAGES.    #YL026UA*/ 04169000
*        /*                                                  #YL026UA*/ 04170000
*        /*  INPUT - NONE                                    #YL026UA*/ 04171000
*        /*                                                  #YL026UA*/ 04172000
*        /*  OUTPUT - IF AN ERROR IS FOUND, THE RETURN CODE IS SET   */ 04173000
*        /*                                                  #YL026UA*/ 04174000
*        /************************************************************/ 04175000
*                                                                  0900 04176000
*MEMDLETE: PROCEDURE;                                      /*#YL026UA*/ 04177000
*                                                                  0900 04178000
MEMDLETE STM   @14,@12,@SA00007                                    0900 04179000
*        /************************************************************/ 04180000
*        /*                                                  @YL026UA*/ 04181000
*        /*  LOCAL DECLARATIONS                              @YL026UA*/ 04182000
*        /*                                                  @YL026UA*/ 04183000
*        /************************************************************/ 04184000
*                                                                  0901 04185000
*        DCL DLETEMEM CHAR(1) STATIC INIT('D'); /*USTOW DELETE CODE  */ 04186000
*        DCL PDSIOCS PTR(31);                /*PDS IOCS PTR  @YL026UA*/ 04187000
*        DCL PDSLIST BIT(LENGTH(OPNAGL)) BDY(WORD); /*STORAGE FOR    */ 04188000
*                                      /*THE PDS OPNAGL      @YL026UA*/ 04189000
*                                                                  0904 04190000
*        OLDERID2 = NEWERID2;                                      0904 04191000
         L     @08,@PC00001                                        0904 04192000
         L     @05,GDTTR2(,@08)                                    0904 04193000
         MVC   @TS00001(95),NEWERID2(@05)                          0904 04194000
         MVC   OLDERID2(95,@05),@TS00001                           0904 04195000
*        NEWID2 = 'DLMD';                                  /*@YL026UA*/ 04196000
         MVC   NEWID2(4,@05),@CC01036                              0905 04197000
*        SETRC = 0;                                        /*@YL026UA*/ 04198000
*                                                                  0906 04199000
         SLR   SETRC,SETRC                                         0906 04200000
*        /************************************************************/ 04201000
*        /*                                                  @YL026UA*/ 04202000
*        /*  IF QUALIFICATION FAILED FOR A MEMBER DELETION   @YL026UA*/ 04203000
*        /*  THEN ISSUE A MEMBER NOT DELETED MESSAGE         @YL026UA*/ 04204000
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/ 04205000
*        /*                                                  @YL026UA*/ 04206000
*        /************************************************************/ 04207000
*                                                                  0907 04208000
*        IF ENTRYRC = LASTCC08                                     0907 04209000
*          THEN                                                    0907 04210000
         C     ENTRYRC,@CF00179                                    0907 04211000
         BNE   @RF00907                                            0907 04212000
*            DO;                                           /*@YL026UA*/ 04213000
*              DARGSMOD = DELMSG;                          /*@YL026UA*/ 04214000
         L     @02,DDSTRU                                          0909 04215000
         MVC   DARGSMOD(3,@02),@CC00888                            0909 04216000
*              DARGSENT = NDMEMMSG;                        /*@YL026UA*/ 04217000
         MVI   DARGSENT(@02),X'0A'                                 0910 04218000
*              DARGDBP = ADDR(NTRYMEM(INDEX));             /*@YL026UA*/ 04219000
         LH    @15,INDEX                                           0911 04220000
         MH    @15,@CH01079                                        0911 04221000
         L     @14,@PC00001+4                                      0911 04222000
         L     @14,FDTPTR(,@14)                                    0911 04223000
         LA    @01,0(@15,@14)                                      0911 04224000
         AL    @01,@CF01116                                        0911 04225000
         ST    @01,DARGDBP(,@02)                                   0911 04226000
*              DARGILP = NTRYMLN(INDEX);                   /*@YL026UA*/ 04227000
*                                                                  0912 04228000
         AL    @14,@CF01101                                        0912 04229000
         SLR   @07,@07                                             0912 04230000
         IC    @07,NTRYMLN-13(@15,@14)                             0912 04231000
         STH   @07,DARGILP(,@02)                                   0912 04232000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UA*/ 04233000
         ST    @08,@AL00001                                        0913 04234000
         LA    @02,@CF00115                                        0913 04235000
         ST    @02,@AL00001+4                                      0913 04236000
         LA    @02,DDSTRU                                          0913 04237000
         ST    @02,@AL00001+8                                      0913 04238000
         MVI   @AL00001+8,X'80'                                    0913 04239000
         L     @15,GDTPRT(,@08)                                    0913 04240000
         LA    @01,@AL00001                                        0913 04241000
         BALR  @14,@15                                             0913 04242000
*              RETURN CODE (LASTCC08);                     /*@YL026UA*/ 04243000
         LA    @15,8                                               0914 04244000
         L     @14,@SA00007                                        0914 04245000
         LM    @00,@12,@SA00007+8                                  0914 04246000
         BR    @14                                                 0914 04247000
*            END;                                          /*@YL026UA*/ 04248000
*                                                                  0915 04249000
*        /************************************************************/ 04250000
*        /*                                                  @YL026UA*/ 04251000
*        /*  IF A MEMBER WAS SPECIFIED WITH A GENERIC NAME   @YL026UA*/ 04252000
*        /*  THEN ISSUE BOTH AN ERROR MESSAGE TO THAT        @YL026UA*/ 04253000
*        /*  AFFECT AND A MEMBER NOT DELETED MESSAGE         @YL026UA*/ 04254000
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/ 04255000
*        /*                                                  @YL026UA*/ 04256000
*        /************************************************************/ 04257000
*                                                                  0916 04258000
*        IF NTRYPOS(INDEX) ^= 0                                    0916 04259000
*          THEN                                                    0916 04260000
@RF00907 SLR   @08,@08                                             0916 04261000
         LH    @05,INDEX                                           0916 04262000
         MH    @05,@CH01079                                        0916 04263000
         L     @02,@PC00001+4                                      0916 04264000
         L     @02,FDTPTR(,@02)                                    0916 04265000
         AL    @02,@CF01102                                        0916 04266000
         SLR   @15,@15                                             0916 04267000
         IC    @15,NTRYPOS-11(@05,@02)                             0916 04268000
         CR    @08,@15                                             0916 04269000
         BE    @RF00916                                            0916 04270000
*            DO;                                           /*@YL026UA*/ 04271000
*              DARGSMOD = DELMSG;                          /*@YL026UA*/ 04272000
         L     @02,DDSTRU                                          0918 04273000
         MVC   DARGSMOD(3,@02),@CC00888                            0918 04274000
*              DARGSENT = GNMEMMSG;                        /*@YL026UA*/ 04275000
         MVI   DARGSENT(@02),X'09'                                 0919 04276000
*              DARGDBP = NULLPTR;                          /*@YL026UA*/ 04277000
         ST    @08,DARGDBP(,@02)                                   0920 04278000
*              DARGILP = 0;                                /*@YL026UA*/ 04279000
*                                                                  0921 04280000
         STH   @08,DARGILP(,@02)                                   0921 04281000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UA*/ 04282000
         L     @08,@PC00001                                        0922 04283000
         ST    @08,@AL00001                                        0922 04284000
         LA    @02,@CF00115                                        0922 04285000
         ST    @02,@AL00001+4                                      0922 04286000
         LA    @02,DDSTRU                                          0922 04287000
         ST    @02,@AL00001+8                                      0922 04288000
         MVI   @AL00001+8,X'80'                                    0922 04289000
         L     @15,GDTPRT(,@08)                                    0922 04290000
         LA    @01,@AL00001                                        0922 04291000
         BALR  @14,@15                                             0922 04292000
*              DARGSMOD = DELMSG;                          /*@YL026UA*/ 04293000
         L     @08,DDSTRU                                          0923 04294000
         MVC   DARGSMOD(3,@08),@CC00888                            0923 04295000
*              DARGSENT = NDMEMMSG;                        /*@YL026UA*/ 04296000
         MVI   DARGSENT(@08),X'0A'                                 0924 04297000
*              DARGDBP = ADDR(NTRYMEM(INDEX));             /*@YL026UA*/ 04298000
         LH    @02,INDEX                                           0925 04299000
         MH    @02,@CH01079                                        0925 04300000
         L     @15,@PC00001+4                                      0925 04301000
         L     @15,FDTPTR(,@15)                                    0925 04302000
         LA    @01,0(@02,@15)                                      0925 04303000
         AL    @01,@CF01116                                        0925 04304000
         ST    @01,DARGDBP(,@08)                                   0925 04305000
*              DARGILP = NTRYMLN(INDEX);                   /*@YL026UA*/ 04306000
*                                                                  0926 04307000
         AL    @15,@CF01101                                        0926 04308000
         SLR   @14,@14                                             0926 04309000
         IC    @14,NTRYMLN-13(@02,@15)                             0926 04310000
         STH   @14,DARGILP(,@08)                                   0926 04311000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UA*/ 04312000
         L     @08,@PC00001                                        0927 04313000
         ST    @08,@AL00001                                        0927 04314000
         LA    @02,@CF00115                                        0927 04315000
         ST    @02,@AL00001+4                                      0927 04316000
         LA    @02,DDSTRU                                          0927 04317000
         ST    @02,@AL00001+8                                      0927 04318000
         MVI   @AL00001+8,X'80'                                    0927 04319000
         L     @15,GDTPRT(,@08)                                    0927 04320000
         LA    @01,@AL00001                                        0927 04321000
         BALR  @14,@15                                             0927 04322000
*              RETURN CODE (LASTCC08);                     /*@YL026UA*/ 04323000
         LA    @15,8                                               0928 04324000
         L     @14,@SA00007                                        0928 04325000
         LM    @00,@12,@SA00007+8                                  0928 04326000
         BR    @14                                                 0928 04327000
*            END;                                          /*@YL026UA*/ 04328000
*                                                                  0929 04329000
*        /************************************************************/ 04330000
*        /*                                                  @YL026UA*/ 04331000
*        /*  OPEN THE PDS FOR UPDATE AND DYNAMICALLY ALLOCATE IT     */ 04332000
*        /*  VIA THE UOPEN MACRO IF IT WERE NOT ALREADY      @YL026UA*/ 04333000
*        /*  ALLOCATED VIA JCL                               @YL026UA*/ 04334000
*        /*                                                  @YL026UA*/ 04335000
*        /************************************************************/ 04336000
*                                                                  0930 04337000
*        OPNPTR = ADDR(PDSLIST);                           /*@YL026UA*/ 04338000
@RF00916 LA    OPNPTR,PDSLIST                                      0930 04339000
*        PDSLIST = ''B;                                    /*@YL026UA*/ 04340000
         XC    PDSLIST(48),PDSLIST                                 0931 04341000
*        OPNOPTOT = ON;                                    /*@YL026UA*/ 04342000
*        OPNOPTBK = ON;                                    /*@YL026UA*/ 04343000
         OI    OPNOPTOT(OPNPTR),B'01010000'                        0933 04344000
*        OPNDSOPO = ON;                                    /*@YL026UA*/ 04345000
         OI    OPNDSOPO(OPNPTR),B'00010000'                        0934 04346000
*        OPNIOC = ADDR(PDSIOCS);                           /*@YL026UA*/ 04347000
         LA    @08,PDSIOCS                                         0935 04348000
         ST    @08,OPNIOC(,OPNPTR)                                 0935 04349000
*        IF ADDR(INDD) ^= NULLPTR                                  0936 04350000
*          THEN                                                    0936 04351000
         L     @08,@PC00001+4                                      0936 04352000
         L     @08,FDTPTR+16(,@08)                                 0936 04353000
         LTR   @08,@08                                             0936 04354000
         BZ    @RF00936                                            0936 04355000
*            OPNDDN = ADDR(INDDVAL);                       /*@YL026UA*/ 04356000
         LA    @08,INDDVAL(,@08)                                   0937 04357000
         ST    @08,OPNDDN(,OPNPTR)                                 0937 04358000
*          ELSE                                                    0938 04359000
*            DO;                                           /*@YL026UA*/ 04360000
         B     @RC00936                                            0938 04361000
@RF00936 DS    0H                                                  0939 04362000
*              OPNDSN = ADDR(ENTRYVAL);                    /*@YL026UA*/ 04363000
         LA    @08,ENTRYVAL                                        0939 04364000
         ST    @08,OPNDSN(,OPNPTR)                                 0939 04365000
*              IF NTRYPLN(INDEX) ^= 0                              0940 04366000
*                THEN                                              0940 04367000
         LH    @08,INDEX                                           0940 04368000
         MH    @08,@CH01079                                        0940 04369000
         L     @05,@PC00001+4                                      0940 04370000
         L     @05,FDTPTR(,@05)                                    0940 04371000
         LA    @01,0(@08,@05)                                      0940 04372000
         AL    @01,@CF01099                                        0940 04373000
         SLR   @00,@00                                             0940 04374000
         IC    @00,NTRYPLN-2(,@01)                                 0940 04375000
         C     @00,@CF00115                                        0940 04376000
         BE    @RF00940                                            0940 04377000
*                  OPNPWA = ADDR(NTRYPAS(INDEX));          /*@YL026UA*/ 04378000
         AL    @05,@CF01100                                        0941 04379000
         LA    @08,NTRYPAS-3(@08,@05)                              0941 04380000
         ST    @08,OPNPWA(,OPNPTR)                                 0941 04381000
*            END;                                          /*@YL026UA*/ 04382000
@RF00940 DS    0H                                                  0943 04383000
*        CALL IDCIOOP0(GDTTBL,OPNAGL);                     /*@YL026UA*/ 04384000
@RC00936 L     @08,@PC00001                                        0943 04385000
         ST    @08,@AL00001                                        0943 04386000
         ST    OPNPTR,@AL00001+4                                   0943 04387000
         MVI   @AL00001+4,X'80'                                    0943 04388000
         L     @15,GDTOPN(,@08)                                    0943 04389000
         LA    @01,@AL00001                                        0943 04390000
         BALR  @14,@15                                             0943 04391000
*        RESPECIFY RTNREG RSTD;                                    0944 04392000
*        TESTRC = RTNREG;                                          0945 04393000
         LR    TESTRC,RTNREG                                       0945 04394000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UA*/ 04395000
*                                                                  0946 04396000
*        IOCSPTR = PDSIOCS;                                        0947 04397000
*                                                                  0947 04398000
         L     @08,PDSIOCS                                         0947 04399000
         ST    @08,IOCSPTR                                         0947 04400000
*        IF ENTRYVAL ^= IOCDSN -> DSNAME                   /*@OZ34461*/ 04401000
*          THEN                                            /*@OZ34461*/ 04402000
         L     @08,IOCDSN(,@08)                                    0948 04403000
         CLC   ENTRYVAL(44),DSNAME(@08)                            0948 04404000
         BE    @RF00948                                            0948 04405000
*            DO;                                           /*@OZ34461*/ 04406000
*                                                                  0949 04407000
*              CALL IDCIOCL0(GDTTBL,PDSIOCS);              /*@OZ34461*/ 04408000
*                                                                  0950 04409000
         L     @08,@PC00001                                        0950 04410000
         ST    @08,@AL00001                                        0950 04411000
         LA    @05,PDSIOCS                                         0950 04412000
         ST    @05,@AL00001+4                                      0950 04413000
         MVI   @AL00001+4,X'80'                                    0950 04414000
         L     @15,GDTCLS(,@08)                                    0950 04415000
         LA    @01,@AL00001                                        0950 04416000
         BALR  @14,@15                                             0950 04417000
*              TESTRC = 8;                                 /*@OZ34461*/ 04418000
         LA    TESTRC,8                                            0951 04419000
*              DARGSMOD = DELMSG;                          /*@OZ34461*/ 04420000
         L     @08,DDSTRU                                          0952 04421000
         MVC   DARGSMOD(3,@08),@CC00888                            0952 04422000
*              DARGSENT = DLMEMMSG;                        /*@OZ34461*/ 04423000
         MVI   DARGSENT(@08),X'0B'                                 0953 04424000
*              DARGDBP = IOCDSN;                           /*@OZ34461*/ 04425000
         L     @05,IOCSPTR                                         0954 04426000
         L     @05,IOCDSN(,@05)                                    0954 04427000
         ST    @05,DARGDBP(,@08)                                   0954 04428000
*              DARGILP = 44;                               /*@OZ34461*/ 04429000
*                                                                  0955 04430000
         MVC   DARGILP(2,@08),@CH00605                             0955 04431000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@OZ34461*/ 04432000
*                                                                  0956 04433000
         L     @08,@PC00001                                        0956 04434000
         ST    @08,@AL00001                                        0956 04435000
         LA    @05,@CF00115                                        0956 04436000
         ST    @05,@AL00001+4                                      0956 04437000
         LA    @05,DDSTRU                                          0956 04438000
         ST    @05,@AL00001+8                                      0956 04439000
         MVI   @AL00001+8,X'80'                                    0956 04440000
         L     @15,GDTPRT(,@08)                                    0956 04441000
         LA    @01,@AL00001                                        0956 04442000
         BALR  @14,@15                                             0956 04443000
*            END;                                                  0957 04444000
*                                                                  0957 04445000
*                                                                  0957 04446000
*        /************************************************************/ 04447000
*        /*                                                  @YL026UA*/ 04448000
*        /*  IF THE OPEN WAS SUCCESSFUL - DELETE THE MEMBER  @YL026UA*/ 04449000
*        /*  FROM ITS DIRECTORY VIA THE USTOW MACRO          @YL026UA*/ 04450000
*        /*                                                  @YL026UA*/ 04451000
*        /************************************************************/ 04452000
*                                                                  0958 04453000
*        IF TESTRC = 0                                             0958 04454000
*          THEN                                                    0958 04455000
@RF00948 LTR   TESTRC,TESTRC                                       0958 04456000
         BNZ   @RF00958                                            0958 04457000
*            DO;                                           /*@YL026UA*/ 04458000
*              PDSIOCS -> IOCMEM = ADDR(NTRYMEM(INDEX));   /*@YL026UA*/ 04459000
         LH    @08,INDEX                                           0960 04460000
         MH    @08,@CH01079                                        0960 04461000
         L     @05,@PC00001+4                                      0960 04462000
         L     @05,FDTPTR(,@05)                                    0960 04463000
         AL    @05,@CF01116                                        0960 04464000
         LA    @08,NTRYMEM-14(@08,@05)                             0960 04465000
         L     @05,PDSIOCS                                         0960 04466000
         ST    @08,IOCMEM(,@05)                                    0960 04467000
*              CALL IDCIOST0(GDTTBL,PDSIOCS,DLETEMEM);     /*@YL026UA*/ 04468000
         L     @08,@PC00001                                        0961 04469000
         ST    @08,@AL00001                                        0961 04470000
         LA    @05,PDSIOCS                                         0961 04471000
         ST    @05,@AL00001+4                                      0961 04472000
         LA    @05,DLETEMEM                                        0961 04473000
         ST    @05,@AL00001+8                                      0961 04474000
         MVI   @AL00001+8,X'80'                                    0961 04475000
         L     @15,GDTSTW(,@08)                                    0961 04476000
         LA    @01,@AL00001                                        0961 04477000
         BALR  @14,@15                                             0961 04478000
*              RESPECIFY RTNREG RSTD;                              0962 04479000
*              TESTRC = RTNREG;                                    0963 04480000
         LR    TESTRC,RTNREG                                       0963 04481000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UA*/ 04482000
*                                                                  0964 04483000
*        /************************************************************/ 04484000
*        /*                                                  @YL026UA*/ 04485000
*        /*  IF THE DELETE WAS SUCCESSFUL - ISSUE A MESSAGE  @YL026UA*/ 04486000
*        /*  INDICATING THE MEMBER WAS DELETED               @YL026UA*/ 04487000
*        /*                                                  @YL026UA*/ 04488000
*        /************************************************************/ 04489000
*                                                                  0965 04490000
*              IF TESTRC = 0                                       0965 04491000
*                THEN                                              0965 04492000
         LTR   TESTRC,TESTRC                                       0965 04493000
         BNZ   @RF00965                                            0965 04494000
*                  DO;                                     /*@YL026UA*/ 04495000
*                    DARGSMOD = DELMSG;                    /*@YL026UA*/ 04496000
         L     @08,DDSTRU                                          0967 04497000
         MVC   DARGSMOD(3,@08),@CC00888                            0967 04498000
*                    DARGSENT = DLMEMMSG;                  /*@YL026UA*/ 04499000
         MVI   DARGSENT(@08),X'0B'                                 0968 04500000
*                    DARGDBP = ADDR(NTRYMEM(INDEX));       /*@YL026UA*/ 04501000
         LH    @05,INDEX                                           0969 04502000
         MH    @05,@CH01079                                        0969 04503000
         L     @02,@PC00001+4                                      0969 04504000
         L     @02,FDTPTR(,@02)                                    0969 04505000
         LA    @01,0(@05,@02)                                      0969 04506000
         AL    @01,@CF01116                                        0969 04507000
         ST    @01,DARGDBP(,@08)                                   0969 04508000
*                    DARGILP = NTRYMLN(INDEX);             /*@YL026UA*/ 04509000
*                                                                  0970 04510000
         AL    @02,@CF01101                                        0970 04511000
         SLR   @15,@15                                             0970 04512000
         IC    @15,NTRYMLN-13(@05,@02)                             0970 04513000
         STH   @15,DARGILP(,@08)                                   0970 04514000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU); /*@YL026UA*/ 04515000
*                                                                  0971 04516000
         L     @08,@PC00001                                        0971 04517000
         ST    @08,@AL00001                                        0971 04518000
         LA    @05,@CF00115                                        0971 04519000
         ST    @05,@AL00001+4                                      0971 04520000
         LA    @05,DDSTRU                                          0971 04521000
         ST    @05,@AL00001+8                                      0971 04522000
         MVI   @AL00001+8,X'80'                                    0971 04523000
         L     @15,GDTPRT(,@08)                                    0971 04524000
         LA    @01,@AL00001                                        0971 04525000
         BALR  @14,@15                                             0971 04526000
*                  END;                                    /*@YL026UA*/ 04527000
*                ELSE                                              0973 04528000
*                  SETRC = LASTCC08;                       /*@YL026UA*/ 04529000
*                                                                  0973 04530000
         B     @RC00965                                            0973 04531000
@RF00965 LA    SETRC,8                                             0973 04532000
*        /************************************************************/ 04533000
*        /*                                                  @YL026UA*/ 04534000
*        /*  CLOSE THE DATA SET IF IT WAS SUCCESSFULLY OPENED@YL026UA*/ 04535000
*        /*                                                  @YL026UA*/ 04536000
*        /************************************************************/ 04537000
*                                                                  0974 04538000
*              CALL IDCIOCL0(GDTTBL,PDSIOCS);              /*@YL026UA*/ 04539000
@RC00965 L     @08,@PC00001                                        0974 04540000
         ST    @08,@AL00001                                        0974 04541000
         LA    @05,PDSIOCS                                         0974 04542000
         ST    @05,@AL00001+4                                      0974 04543000
         MVI   @AL00001+4,X'80'                                    0974 04544000
         L     @15,GDTCLS(,@08)                                    0974 04545000
         LA    @01,@AL00001                                        0974 04546000
         BALR  @14,@15                                             0974 04547000
*              RESPECIFY RTNREG RSTD;                              0975 04548000
*              TESTRC = RTNREG;                                    0976 04549000
         LR    TESTRC,RTNREG                                       0976 04550000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UA*/ 04551000
*              SETRC = MAX(SETRC,TESTRC);                  /*@YL026UA*/ 04552000
         CR    SETRC,TESTRC                                        0978 04553000
         BNL   *+6                                                      04554000
         LR    SETRC,TESTRC                                        0978 04555000
*            END;                                          /*@YL026UA*/ 04556000
*          ELSE                                                    0980 04557000
*            SETRC = LASTCC08;                             /*@YL026UA*/ 04558000
*                                                                  0980 04559000
         B     @RC00958                                            0980 04560000
@RF00958 LA    SETRC,8                                             0980 04561000
*        /************************************************************/ 04562000
*        /*                                                  @YL026UA*/ 04563000
*        /*  IF THE MEMBER WAS NOT SUCCESSFULLY DELETED      @YL026UA*/ 04564000
*        /*  ISSUE THE SECONDARY MEMBER NOT DELETED MESSAGE  @YL026UA*/ 04565000
*        /*  AND RETURN WITH A CODE OF 8                     @YL026UA*/ 04566000
*        /*                                                  @YL026UA*/ 04567000
*        /************************************************************/ 04568000
*                                                                  0981 04569000
*        IF SETRC = LASTCC08                                       0981 04570000
*          THEN                                                    0981 04571000
@RC00958 C     SETRC,@CF00179                                      0981 04572000
         BNE   @RF00981                                            0981 04573000
*            DO;                                           /*@YL026UA*/ 04574000
*              DARGSMOD = DELMSG;                          /*@YL026UA*/ 04575000
         L     @08,DDSTRU                                          0983 04576000
         MVC   DARGSMOD(3,@08),@CC00888                            0983 04577000
*              DARGSENT = NDMEMMSG;                        /*@YL026UA*/ 04578000
         MVI   DARGSENT(@08),X'0A'                                 0984 04579000
*              DARGDBP = ADDR(NTRYMEM(INDEX));             /*@YL026UA*/ 04580000
         LH    @05,INDEX                                           0985 04581000
         MH    @05,@CH01079                                        0985 04582000
         L     @02,@PC00001+4                                      0985 04583000
         L     @02,FDTPTR(,@02)                                    0985 04584000
         LA    @01,0(@05,@02)                                      0985 04585000
         AL    @01,@CF01116                                        0985 04586000
         ST    @01,DARGDBP(,@08)                                   0985 04587000
*              DARGILP = NTRYMLN(INDEX);                   /*@YL026UA*/ 04588000
*                                                                  0986 04589000
         AL    @02,@CF01101                                        0986 04590000
         SLR   @15,@15                                             0986 04591000
         IC    @15,NTRYMLN-13(@05,@02)                             0986 04592000
         STH   @15,DARGILP(,@08)                                   0986 04593000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UA*/ 04594000
*                                                                  0987 04595000
         L     @08,@PC00001                                        0987 04596000
         ST    @08,@AL00001                                        0987 04597000
         LA    @05,@CF00115                                        0987 04598000
         ST    @05,@AL00001+4                                      0987 04599000
         LA    @05,DDSTRU                                          0987 04600000
         ST    @05,@AL00001+8                                      0987 04601000
         MVI   @AL00001+8,X'80'                                    0987 04602000
         L     @15,GDTPRT(,@08)                                    0987 04603000
         LA    @01,@AL00001                                        0987 04604000
         BALR  @14,@15                                             0987 04605000
*            END;                                          /*@YL026UA*/ 04606000
*        RETURN CODE (SETRC);                              /*@YL026UA*/ 04607000
@RF00981 LR    @15,SETRC                                           0989 04608000
         L     @14,@SA00007                                        0989 04609000
         LM    @00,@12,@SA00007+8                                  0989 04610000
         BR    @14                                                 0989 04611000
*END MEMDLETE;                                             /*@YL026UA*/ 04612000
*        /************************************************************/ 04613000
*        /*                                                  @Y30SSFR*/ 04614000
*        /*  PROCEDURE NAME - MORESP                         @Y30SSFR*/ 04615000
*        /*                                                  @Y30SSFR*/ 04616000
*        /*  FUNCTION - HANDLE THE SITUATION IN WHICH VSAM   @Y30SSFR*/ 04617000
*        /*  MANAGEMENT HAS USED ALL OF ITS WORK AREA        @Y30SSFR*/ 04618000
*        /*  BY PRINTING THE NAMES OF THE                    @Y30SSFR*/ 04619000
*        /*  ITEMS ALREADY DELETED.  THEN EITHER THE         @Y30SSFR*/ 04620000
*        /*  WORK AREA IS CLEARED OR A NEW WORK AREA IS      @Y30SSFR*/ 04621000
*        /*  OBTAINED.  VSAM CATALOG IS THEN INVOKED         @Y30SSFR*/ 04622000
*        /*  AGAIN BY CATCALL.                               @Y30SSFR*/ 04623000
*        /*                                                  @Y30SSFR*/ 04624000
*        /*  INPUT - A CPL BUILT BY BUILDCPL, THE            @Y30SSFR*/ 04625000
*        /*  WORK AREA USED BY VSAM CATALOG,                 @Y30SSFR*/ 04626000
*        /*  AND THE NUMBER OF ENTRIES FOUND IN THE WORK     @Y30SSFR*/ 04627000
*        /*  AREA BY CATCALL.                                @Y30SSFR*/ 04628000
*        /*                                                  @Y30SSFR*/ 04629000
*        /*  OUTPUT - EITHER THE SAME CATALOG WORKAREA       @Y30SSFR*/ 04630000
*        /*  CLEARED OF THE NAMES PLACED THERE BY THE        @Y30SSFR*/ 04631000
*        /*  PREVIOUS CALL TO CATALOG OR A NEW WORKAREA      @Y30SSFR*/ 04632000
*        /*  POINTED TO BY AN UPDATED CTGWKA POINTER.        @Y30SSFR*/ 04633000
*        /*                                                  @Y30SSFR*/ 04634000
*        /************************************************************/ 04635000
*                                                                  0991 04636000
*MORESP:  PROCEDURE(MMNOENT);                              /*@Y30SSFR*/ 04637000
*                                                                  0991 04638000
MORESP   STM   @14,@03,@SA00008                                    0991 04639000
         STM   @05,@12,@SA00008+24                                 0991 04640000
         MVC   @PC00008(4),0(@01)                                  0991 04641000
*        /************************************************************/ 04642000
*        /*                                                  @Y30SSFR*/ 04643000
*        /*  ARGUMENT OF INVOCATION                          @Y30SSFR*/ 04644000
*        /*                                                  @Y30SSFR*/ 04645000
*        /************************************************************/ 04646000
*                                                                  0992 04647000
*        DCL MMNOENT FIXED(31);        /*NUMBER OF VALID     @Y30SSFR*/ 04648000
*                                      /*ENTRIES FOUND IN    @Y30SSFR*/ 04649000
*                                      /*THE WORK AREA BY    @Y30SSFR*/ 04650000
*                                      /*CATCALL             @Y30SSFR*/ 04651000
*                                                                  0993 04652000
*        /************************************************************/ 04653000
*        /*                                                  @Y30SSFR*/ 04654000
*        /*  LOCAL DECLARATIONS FOR MORESP                   @Y30SSFR*/ 04655000
*        /*                                                  @Y30SSFR*/ 04656000
*        /************************************************************/ 04657000
*                                                                  0993 04658000
*        DCL J FIXED(31);              /*LOOP CONTROL        @Y30SSFR*/ 04659000
*                                      /*FOR CLEARING        @Y30SSFR*/ 04660000
*                                      /*CATALOG WORK AREA   @Y30SSFR*/ 04661000
*        DCL SIZENEED FIXED(31);       /*SIZE OF WORKAREA    @Y30SSFR*/ 04662000
*                                      /*NEEDED              @Y30SSFR*/ 04663000
*        DCL CURSIZE FIXED(15);        /*SIZE OF CURRENT     @Y30SSFR*/ 04664000
*                                      /*WORK AREA           @Y30SSFR*/ 04665000
*        OLDERID2 = NEWERID2;                                      0996 04666000
         L     @08,@PC00001                                        0996 04667000
         L     @05,GDTTR2(,@08)                                    0996 04668000
         MVC   @TS00001(95),NEWERID2(@05)                          0996 04669000
         MVC   OLDERID2(95,@05),@TS00001                           0996 04670000
*        NEWID2 = 'DLMS';                                  /*@Y30SSFR*/ 04671000
*                                                                  0997 04672000
         MVC   NEWID2(4,@05),@CC01045                              0997 04673000
*        /************************************************************/ 04674000
*        /*                                                  @Y30SSFR*/ 04675000
*        /*  INTIALIZATIONS FOR THE PROCEDURE                @Y30SSFR*/ 04676000
*        /*                                                  @Y30SSFR*/ 04677000
*        /************************************************************/ 04678000
*                                                                  0998 04679000
*        CURSIZE = AREALN;                                 /*@Y30SSFR*/ 04680000
         L     @05,WAPTR                                           0998 04681000
         LH    CURSIZE,AREALN(,@05)                                0998 04682000
*        COREFLAG = OFF;                                   /*@Y30SSFR*/ 04683000
*                                                                  0999 04684000
         NI    COREFLAG,B'01111111'                                0999 04685000
*        /************************************************************/ 04686000
*        /*                                                  @Y30SSFR*/ 04687000
*        /*  RESTORE THE CPL.    SET CTGERASE TO OFF AND     @Y30SSFR*/ 04688000
*        /*  CTGOVRID TO ON TO PREVENT CMS FROM REERASING    @Y30SSFR*/ 04689000
*        /*  THE OBJECT ON SUBSEQUENT CALLS TO CATALOG.      @Y30SSFR*/ 04690000
*        /*                                                  @Y30SSFR*/ 04691000
*        /************************************************************/ 04692000
*                                                                  1000 04693000
*        CTGPL = RENEWCPL;                                 /*@Y30SSFR*/ 04694000
         L     @03,CTGPLPTR                                        1000 04695000
         MVC   CTGPL(28,@03),RENEWCPL                              1000 04696000
*        CTGERASE = OFF;                                   /*@Y30SSFR*/ 04697000
*        CTGOVRID = ON;                                    /*@Y30SSFR*/ 04698000
*                                                                  1002 04699000
         OI    CTGOVRID(@03),B'00000100'                           1002 04700000
         NI    CTGERASE(@03),B'10111111'                           1002 04701000
*        /************************************************************/ 04702000
*        /*                                                  @Y30SSFR*/ 04703000
*        /*  COMPUTE THE SIZE NEEDED AND COMPARE THAT        @Y30SSFR*/ 04704000
*        /*  TO THE CURRENT SIZE OF THE WORK AREA            @Y30SSFR*/ 04705000
*        /*                                                  @Y30SSFR*/ 04706000
*        /************************************************************/ 04707000
*                                                                  1003 04708000
*        SIZENEED = RETURNLN - (LENGTH(ENTITEM)            /*@Y30SSFR*/ 04709000
*                        * MMNOENT);                       /*@Y30SSFR*/ 04710000
*                                                                  1003 04711000
         L     @03,@PC00008                                        1003 04712000
         L     @03,MMNOENT(,@03)                                   1003 04713000
         MH    @03,@CH01066                                        1003 04714000
         LCR   @03,@03                                             1003 04715000
         AH    @03,RETURNLN(,@05)                                  1003 04716000
         ST    @03,SIZENEED                                        1003 04717000
*        IF SIZENEED > CURSIZE                             /*@Y30SSFR*/ 04718000
*          THEN                                            /*@Y30SSFR*/ 04719000
*                                                                  1004 04720000
         CR    @03,CURSIZE                                         1004 04721000
         BNH   @RF01004                                            1004 04722000
*            /********************************************************/ 04723000
*            /*                                              @Y30SSFR*/ 04724000
*            /*  IF THE CURRENT WORK AREA IS GOTTEN          @Y30SSFR*/ 04725000
*            /*  CORE, FREE IT.  THEN GET A WORK AREA OF     @Y30SSFR*/ 04726000
*            /*  APPROPRIATE SIZE AND CHANGE THE CPL TO      @Y30SSFR*/ 04727000
*            /*  POINT TO IT.                                @Y30SSFR*/ 04728000
*            /*                                              @Y30SSFR*/ 04729000
*            /********************************************************/ 04730000
*                                                                  1005 04731000
*            DO;                                           /*@Y30SSFR*/ 04732000
*            IF COREFLAG = ON                              /*@Y30SSFR*/ 04733000
*              THEN                                        /*@Y30SSFR*/ 04734000
         TM    COREFLAG,B'10000000'                                1006 04735000
         BNO   @RF01006                                            1006 04736000
*                CALL IDCSAFS0(GDTTBL,WAPTR);              /*@Y30SSFR*/ 04737000
         ST    @08,@AL00001                                        1007 04738000
         LA    @05,WAPTR                                           1007 04739000
         ST    @05,@AL00001+4                                      1007 04740000
         L     @15,GDTFSP(,@08)                                    1007 04741000
         LA    @01,@AL00001                                        1007 04742000
         BALR  @14,@15                                             1007 04743000
*            COREFLAG = ON;                                /*@Y30SSFR*/ 04744000
*                                                                  1008 04745000
@RF01006 OI    COREFLAG,B'10000000'                                1008 04746000
*            CALL IDCSAGP0(GDTTBL,SIZENEED,                /*@Y30SSFR*/ 04747000
*                     WAPTR,DLUGPFG1,SETZERO);             /*@Y30SSFR*/ 04748000
*                                                                  1009 04749000
         L     @08,@PC00001                                        1009 04750000
         ST    @08,@AL00001                                        1009 04751000
         LA    @05,SIZENEED                                        1009 04752000
         ST    @05,@AL00001+4                                      1009 04753000
         LA    @05,WAPTR                                           1009 04754000
         ST    @05,@AL00001+8                                      1009 04755000
         LA    @05,DLUGPFG1                                        1009 04756000
         ST    @05,@AL00001+12                                     1009 04757000
         LA    @05,SETZERO                                         1009 04758000
         ST    @05,@AL00001+16                                     1009 04759000
         MVI   @AL00001+16,X'80'                                   1009 04760000
         L     @15,GDTGPL(,@08)                                    1009 04761000
         LA    @01,@AL00001                                        1009 04762000
         BALR  @14,@15                                             1009 04763000
*            RESPECIFY RTNREG RSTD;                                1010 04764000
*            TESTRC = RTNREG;                                      1011 04765000
         LR    TESTRC,RTNREG                                       1011 04766000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 04767000
*                                                                  1012 04768000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 04769000
*              THEN                                        /*@Y30SSFR*/ 04770000
         SLR   @08,@08                                             1013 04771000
         CR    TESTRC,@08                                          1013 04772000
         BE    @RF01013                                            1013 04773000
*                DO;                                       /*@Y30SSFR*/ 04774000
*                DARGSMOD = UNIVMSG;                       /*@Y30SSFR*/ 04775000
         L     @05,DDSTRU                                          1015 04776000
         MVC   DARGSMOD(3,@05),@CC00892                            1015 04777000
*                DARGSENT = NOSTORAG;                      /*@Y30SSFR*/ 04778000
         MVI   DARGSENT(@05),X'0C'                                 1016 04779000
*                DARGDBP = NULLPTR;                        /*@Y30SSFR*/ 04780000
         ST    @08,DARGDBP(,@05)                                   1017 04781000
*                DARGILP = 0;                              /*@Y30SSFR*/ 04782000
*                                                                  1018 04783000
         STH   @08,DARGILP(,@05)                                   1018 04784000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Y30SSFR*/ 04785000
*                                                                  1019 04786000
         L     @08,@PC00001                                        1019 04787000
         ST    @08,@AL00001                                        1019 04788000
         LA    @05,@CF00115                                        1019 04789000
         ST    @05,@AL00001+4                                      1019 04790000
         LA    @05,DDSTRU                                          1019 04791000
         ST    @05,@AL00001+8                                      1019 04792000
         MVI   @AL00001+8,X'80'                                    1019 04793000
         L     @15,GDTPRT(,@08)                                    1019 04794000
         LA    @01,@AL00001                                        1019 04795000
         BALR  @14,@15                                             1019 04796000
*                SETRC = LASTCC08;                         /*@Y30SSFR*/ 04797000
         LA    SETRC,8                                             1020 04798000
*                RETURN CODE(SETRC);                       /*@Y30SSFR*/ 04799000
         LR    @15,SETRC                                           1021 04800000
         L     @14,@SA00008                                        1021 04801000
         LM    @00,@03,@SA00008+8                                  1021 04802000
         LM    @05,@12,@SA00008+24                                 1021 04803000
         BR    @14                                                 1021 04804000
*                END;                                      /*@Y30SSFR*/ 04805000
*                                                                  1022 04806000
*            /********************************************************/ 04807000
*            /*                                              @Y30SSFR*/ 04808000
*            /*  SET CTGWKA TO POINT TO THE NEWLY ACQUIRED   @Y30SSFR*/ 04809000
*            /*  WORKAREA.  RESET CURSIZE TO BE THE AMOUNT   @Y30SSFR*/ 04810000
*            /*  OF SPACE IN THE NEW WORKAREA, AND SET       @Y30SSFR*/ 04811000
*            /*  AREALN TO BE CURSIZE.                       @Y30SSFR*/ 04812000
*            /*                                              @Y30SSFR*/ 04813000
*            /********************************************************/ 04814000
*                                                                  1023 04815000
*            CTGWKA = WAPTR;                               /*@Y30SSFR*/ 04816000
@RF01013 L     @08,WAPTR                                           1023 04817000
         L     @05,CTGPLPTR                                        1023 04818000
         ST    @08,CTGWKA(,@05)                                    1023 04819000
*            CURSIZE = SIZENEED;                           /*@Y30SSFR*/ 04820000
         L     CURSIZE,SIZENEED                                    1024 04821000
*            AREALN = CURSIZE;                             /*@Y30SSFR*/ 04822000
*                                                                  1025 04823000
         STH   CURSIZE,AREALN(,@08)                                1025 04824000
*            END;                                          /*@Y30SSFR*/ 04825000
*                                                                  1026 04826000
*          ELSE                                                    1027 04827000
*                                                                  1027 04828000
*            /********************************************************/ 04829000
*            /*                                              @Y30SSFR*/ 04830000
*            /*  IF CURRENT WORK AREA IS LARGE ENOUGH        @Y30SSFR*/ 04831000
*            /*  FOR THE NEXT CALL TO CATALOG, CLEAR IT.     @Y30SSFR*/ 04832000
*            /*                                              @Y30SSFR*/ 04833000
*            /********************************************************/ 04834000
*                                                                  1027 04835000
*              DO;                                         /*@Y30SSFR*/ 04836000
         B     @RC01004                                            1027 04837000
@RF01004 DS    0H                                                  1028 04838000
*              RETURNLN = 0;                               /*@Y30SSFR*/ 04839000
*                                                                  1028 04840000
         L     @08,WAPTR                                           1028 04841000
         SLR   @05,@05                                             1028 04842000
         STH   @05,RETURNLN(,@08)                                  1028 04843000
*              DO J = 1 TO LIMIT;                          /*@Y30SSFR*/ 04844000
         LA    J,1                                                 1029 04845000
         B     @DE01029                                            1029 04846000
@DL01029 DS    0H                                                  1030 04847000
*                ENTLIST(J) = ''B;                         /*@Y30SSFR*/ 04848000
         LR    @08,J                                               1030 04849000
         MH    @08,@CH01066                                        1030 04850000
         L     @05,WAPTR                                           1030 04851000
         ALR   @05,@08                                             1030 04852000
         AL    @05,@CF01103                                        1030 04853000
         XC    ENTLIST-4(45,@05),ENTLIST-4(@05)                    1030 04854000
*              END;                                        /*@Y30SSFR*/ 04855000
*                                                                  1031 04856000
         AL    J,@CF00219                                          1031 04857000
@DE01029 C     J,LIMIT                                             1031 04858000
         BNH   @DL01029                                            1031 04859000
*              END;                                        /*@Y30SSFR*/ 04860000
*                                                                  1032 04861000
*        RETURN CODE(SETRC);                               /*@Y30SSFR*/ 04862000
@RC01004 LR    @15,SETRC                                           1033 04863000
         L     @14,@SA00008                                        1033 04864000
         LM    @00,@03,@SA00008+8                                  1033 04865000
         LM    @05,@12,@SA00008+24                                 1033 04866000
         BR    @14                                                 1033 04867000
*END MORESP;                                               /*@Y30SSFR*/ 04868000
*        /************************************************************/ 04869000
*        /*                                                  @Y30SSFR*/ 04870000
*        /*  PROCEDURE NAME - ALLOPROC                       @Y30SSFR*/ 04871000
*        /*                                                  @Y30SSFR*/ 04872000
*        /*  FUNCTION - ALLOPROC ISSUES ALL OF THE DYNAMIC   @Y30SSFR*/ 04873000
*        /*  ALLOCATION REQUESTS FOR IDCDL01, AND IN         @Y30SSFR*/ 04874000
*        /*  ADDITION, DYNAMICALLY UNALLOCATES ANYTHING      @Y30SSFR*/ 04875000
*        /*  THAT HAS BEEN DYNAMICALLY ALLOCATED PREVIOUSLY. @Y30SSFR*/ 04876000
*        /*  IN PARTICULAR, ALLOPROC BUILDS ALLAGLS FOR      @Y30SSFR*/ 04877000
*        /*  BOTH DYNAMIC ALLOCATION OF VOLUMES AND          @Y30SSFR*/ 04878000
*        /*  DYNAMIC ALLOCATION OF DATA SETS.                @Y30SSFR*/ 04879000
*        /*                                                  @Y30SSFR*/ 04880000
*        /*  INPUT - ALLOPROC ACCEPTS                        @Y30SSFR*/ 04881000
*        /*  A POINTER TO THE NAME OF A DATA SET TO BE       @Y30SSFR*/ 04882000
*        /*  ALLOCATED OR A POINTER TO THE VOLSER OF         @Y30SSFR*/ 04883000
*        /*  A VOLUME TO BE ALLOCATED.                       @Y30SSFR*/ 04884000
*        /*                                                  @Y30SSFR*/ 04885000
*        /*  OUTPUT - A DDNAME FOR THE THING TO BE           @Y30SSFR*/ 04886000
*        /*  ALLOCATED IN THE CTGDDNAM FIELD OF THE CPL,     @Y30SSFR*/ 04887000
*        /*  OR ANY MESSAGES REGARDING THE ALLOCATION        @Y30SSFR*/ 04888000
*        /*  REQUEST IF IT CANNOT BE FULFILLED.              @Y30SSFR*/ 04889000
*        /*                                                  @Y30SSFR*/ 04890000
*        /************************************************************/ 04891000
*                                                                  1035 04892000
*ALLOPROC: PROCEDURE(ALDSNPT,ALVLSPT);                     /*@Y30SSFR*/ 04893000
*                                                                  1035 04894000
ALLOPROC STM   @14,@03,@SA00009                                    1035 04895000
         STM   @05,@12,@SA00009+24                                 1035 04896000
         MVC   @PC00009(8),0(@01)                                  1035 04897000
*        /************************************************************/ 04898000
*        /*                                                  @Y30SSFR*/ 04899000
*        /*  ARGUMENTS OF INVOCATION                         @Y30SSFR*/ 04900000
*        /*                                                  @Y30SSFR*/ 04901000
*        /************************************************************/ 04902000
*                                                                  1036 04903000
*        DCL ALDSNPT PTR(31);          /*POINTER TO DSN OF   @Y30SSFR*/ 04904000
*                                      /*OBJECT TO BE ALLOC  @Y30SSFR*/ 04905000
*        DCL ALVLSPT PTR(31);          /*POINTER TO VOLSER   @Y30SSFR*/ 04906000
*                                      /*OF OBJECT TO BE     @Y30SSFR*/ 04907000
*                                      /*ALLOCATED           @Y30SSFR*/ 04908000
*        OLDERID2 = NEWERID2;                                      1038 04909000
         L     @08,@PC00001                                        1038 04910000
         L     @08,GDTTR2(,@08)                                    1038 04911000
         MVC   @TS00001(95),NEWERID2(@08)                          1038 04912000
         MVC   OLDERID2(95,@08),@TS00001                           1038 04913000
*        NEWID2 = 'DLAL';                                  /*@Y30SSFR*/ 04914000
*                                                                  1039 04915000
         MVC   NEWID2(4,@08),@CC01053                              1039 04916000
*        /************************************************************/ 04917000
*        /*                                                  @Y30SSFR*/ 04918000
*        /*  TEST TO SEE IF DEALLOC IS ON.  IF SO,           @Y30SSFR*/ 04919000
*        /*  UNALLOCATE THE OBJECT THAT IS CURRENTLY         @Y30SSFR*/ 04920000
*        /*  USING THE ALLAGL, SO THAT THE NEWLY REQUESTED   @Y30SSFR*/ 04921000
*        /*  OBJECT MAY BE ALLOCATED USING THE SAME ALLAGL.  @Y30SSFR*/ 04922000
*        /*                                                  @Y30SSFR*/ 04923000
*        /************************************************************/ 04924000
*                                                                  1040 04925000
*        IF DEALLOC = ON                                   /*@Y30SSFR*/ 04926000
*          THEN                                            /*@Y30SSFR*/ 04927000
         TM    DEALLOC,B'10000000'                                 1040 04928000
         BNO   @RF01040                                            1040 04929000
*            DO;                                           /*@Y30SSFR*/ 04930000
*                                                                  1041 04931000
*            /********************************************************/ 04932000
*            /*                                              @Y30SSFR*/ 04933000
*            /*  IF THE DATA SET TO BE DELETED IS A NONVSAM, @Y30SSFR*/ 04934000
*            /*  SET ALLOPTUN TO BE ON TO INDICATE THAT      @Y30SSFR*/ 04935000
*            /*  THE SYSTEM ADAPTOR IS TO OVERRIDE THE       @Y30SSFR*/ 04936000
*            /*  PERMANENT ALLOCATION DONE BY TSO.           @Y30SSFR*/ 04937000
*            /*                                              @Y30SSFR*/ 04938000
*            /********************************************************/ 04939000
*                                                                  1042 04940000
*            IF (ADDR(ALIEN) ^= NULLPTR) |                         1042 04941000
*               LOCTYPE = CTGTALIN                                 1042 04942000
*              THEN                                                1042 04943000
         L     @08,@PC00001+4                                      1042 04944000
         L     @08,FDTPTR+56(,@08)                                 1042 04945000
         LTR   @08,@08                                             1042 04946000
         BNZ   @RT01042                                            1042 04947000
         CLI   LOCTYPE,C'A'                                        1042 04948000
         BNE   @RF01042                                            1042 04949000
@RT01042 DS    0H                                                  1043 04950000
*                ALLOPTUN = ON;                            /*@Y30SSFR*/ 04951000
*                                                                  1043 04952000
         L     @08,ALLPTR                                          1043 04953000
         OI    ALLOPTUN(@08),B'00010000'                           1043 04954000
*            /********************************************************/ 04955000
*            /*                                              #Y30SSFR*/ 04956000
*            /*  RESET THE DEALLOC FLAG TO INDICATE THAT     #Y30SSFR*/ 04957000
*            /*  DYNAMIC UNALLOCATION IS BEING ATTEMPTED.    #Y30SSFR*/ 04958000
*            /*  THEN ISSUE THE UDEALLOC MACRO.              #Y30SSFR*/ 04959000
*            /*                                              #Y30SSFR*/ 04960000
*            /********************************************************/ 04961000
*                                                                  1044 04962000
*            DEALLOC = OFF;                                /*#Y30SSFR*/ 04963000
*                                                                  1044 04964000
@RF01042 NI    DEALLOC,B'01111111'                                 1044 04965000
*            CALL IDCSADL0(GDTTBL,ALLAGL);                 /*#Y30SSFR*/ 04966000
*                                                                  1045 04967000
         L     @08,@PC00001                                        1045 04968000
         ST    @08,@AL00001                                        1045 04969000
         L     @05,ALLPTR                                          1045 04970000
         ST    @05,@AL00001+4                                      1045 04971000
         MVI   @AL00001+4,X'80'                                    1045 04972000
         L     @15,GDTDLC(,@08)                                    1045 04973000
         LA    @01,@AL00001                                        1045 04974000
         BALR  @14,@15                                             1045 04975000
*            /********************************************************/ 04976000
*            /*                                              #Y30SSFR*/ 04977000
*            /*  TEST THE RETURN CODE FROM DYNAMIC           #Y30SSFR*/ 04978000
*            /*  ALLOCATION, AND SET THE ENTRYRC ON THE      #Y30SSFR*/ 04979000
*            /*  BASIS OF THEAT RETURN CODE.                 #Y30SSFR*/ 04980000
*            /*                                              #Y30SSFR*/ 04981000
*            /********************************************************/ 04982000
*                                                                  1046 04983000
*            RESPECIFY RTNREG RSTD;                                1046 04984000
*            TESTRC = RTNREG;                                      1047 04985000
         LR    TESTRC,RTNREG                                       1047 04986000
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/ 04987000
*            SETRC = MAX(TESTRC,SETRC);                    /*#Y30SSFR*/ 04988000
         CR    SETRC,TESTRC                                        1049 04989000
         BNL   *+6                                                      04990000
         LR    SETRC,TESTRC                                        1049 04991000
*            END;                                          /*#Y30SSFR*/ 04992000
*                                                                  1050 04993000
*        /************************************************************/ 04994000
*        /*                                                  #Y30SSFR*/ 04995000
*        /*  TEST TO DETERMINE IF A POINTER TO A DATA        #Y30SSFR*/ 04996000
*        /*  SET NAME HAS BEEN PASSED TO ALLOPROC.  IF       #Y30SSFR*/ 04997000
*        /*  SO, WE MUST DO A DYNAMIC ALLOCATION BY          #Y30SSFR*/ 04998000
*        /*  DATA SET NAME.                                  #Y30SSFR*/ 04999000
*        /*                                                  #Y30SSFR*/ 05000000
*        /************************************************************/ 05001000
*                                                                  1051 05002000
*        IF ALDSNPT ^= NULLPTR                             /*@Y30SSFR*/ 05003000
*          THEN                                            /*@Y30SSFR*/ 05004000
*                                                                  1051 05005000
@RF01040 SLR   @08,@08                                             1051 05006000
         L     @05,@PC00009                                        1051 05007000
         L     @05,ALDSNPT(,@05)                                   1051 05008000
         CR    @05,@08                                             1051 05009000
         BE    @RF01051                                            1051 05010000
*            /********************************************************/ 05011000
*            /*                                              @Y30SSFR*/ 05012000
*            /*  DYNAMICALLY ALLOCATE BY DATA SET NAME.      @Y30SSFR*/ 05013000
*            /*                                              @Y30SSFR*/ 05014000
*            /********************************************************/ 05015000
*                                                                  1052 05016000
*            DO;                                           /*@Y30SSFR*/ 05017000
*                                                                  1052 05018000
*            /********************************************************/ 05019000
*            /*                                              @Y30SSFR*/ 05020000
*            /*  SET THE ALLPTR TO POINT TO THE STORAGE      @Y30SSFR*/ 05021000
*            /*  FOR THE ALLAGL.  THEN CLEAR THIS PART       @Y30SSFR*/ 05022000
*            /*  OF STORAGE.                                 @Y30SSFR*/ 05023000
*            /*                                              @Y30SSFR*/ 05024000
*            /********************************************************/ 05025000
*                                                                  1053 05026000
*            ALLPTR = ADDR(ALLLIST);                       /*@Y30SSFR*/ 05027000
         LA    @15,ALLLIST                                         1053 05028000
         ST    @15,ALLPTR                                          1053 05029000
*            ALLAGL = ''B;                                 /*@Y30SSFR*/ 05030000
*                                                                  1054 05031000
         XC    ALLAGL(31,@15),ALLAGL(@15)                          1054 05032000
*            /********************************************************/ 05033000
*            /*                                              @Y30SSFR*/ 05034000
*            /*  SET POINTERS TO THE DSNAME AND PASSWORD     @Y30SSFR*/ 05035000
*            /*  IN THE ALLAGL.                              @Y30SSFR*/ 05036000
*            /*                                              @Y30SSFR*/ 05037000
*            /********************************************************/ 05038000
*                                                                  1055 05039000
*            ALLDSN = ALDSNPT;                             /*@Y30SSFR*/ 05040000
         ST    @05,ALLDSN(,@15)                                    1055 05041000
*            IF NTRYPLN(INDEX) ^= 0                        /*@Y30SSFR*/ 05042000
*              THEN                                        /*@Y30SSFR*/ 05043000
         LH    @05,INDEX                                           1056 05044000
         MH    @05,@CH01079                                        1056 05045000
         L     @14,@PC00001+4                                      1056 05046000
         L     @14,FDTPTR(,@14)                                    1056 05047000
         LA    @01,0(@05,@14)                                      1056 05048000
         AL    @01,@CF01099                                        1056 05049000
         SLR   @00,@00                                             1056 05050000
         IC    @00,NTRYPLN-2(,@01)                                 1056 05051000
         CR    @08,@00                                             1056 05052000
         BE    @RF01056                                            1056 05053000
*                ALLPWD = ADDR(NTRYPAS(INDEX));            /*@Y30SSFR*/ 05054000
*                                                                  1057 05055000
         AL    @14,@CF01100                                        1057 05056000
         LA    @08,NTRYPAS-3(@05,@14)                              1057 05057000
         ST    @08,ALLPWD(,@15)                                    1057 05058000
*            /********************************************************/ 05059000
*            /*                                              @Y30SSFR*/ 05060000
*            /*  SELECT ALLOCATION OPTIONS.                  @Y30SSFR*/ 05061000
*            /*  (1) ALLOCATION BY DATA SET NAME             @Y30SSFR*/ 05062000
*            /*  (2) DISP = KEEP                             @Y30SSFR*/ 05063000
*            /*  (3) STATUS = OLD                            @Y30SSFR*/ 05064000
*            /*                                              @Y30SSFR*/ 05065000
*            /********************************************************/ 05066000
*                                                                  1058 05067000
*            ALLOPTVL = OFF;                               /*@Y30SSFR*/ 05068000
@RF01056 DS    0H                                                  1059 05069000
*            ALLOPTDS = ON;                                /*@Y30SSFR*/ 05070000
         L     @08,ALLPTR                                          1059 05071000
         OI    ALLOPTDS(@08),B'01000000'                           1059 05072000
         NI    ALLOPTVL(@08),B'01111111'                           1059 05073000
*            ALLSTSOD = ON;                                /*@Y30SSFR*/ 05074000
         OI    ALLSTSOD(@08),B'00000001'                           1060 05075000
*            ALLDSPKP = ON;                                /*@Y30SSFR*/ 05076000
*                                                                  1061 05077000
         OI    ALLDSPKP(@08),B'00001000'                           1061 05078000
*            /********************************************************/ 05079000
*            /*                                              @Y30SSFR*/ 05080000
*            /*  ISSUE THE UALLOC, AND TEST THE              @Y30SSFR*/ 05081000
*            /*  RETURN CODE.                                @Y30SSFR*/ 05082000
*            /*                                              @Y30SSFR*/ 05083000
*            /********************************************************/ 05084000
*                                                                  1062 05085000
*            CALL IDCSAAL0(GDTTBL,ALLAGL);                 /*@Y30SSFR*/ 05086000
*                                                                  1062 05087000
         L     @05,@PC00001                                        1062 05088000
         ST    @05,@AL00001                                        1062 05089000
         ST    @08,@AL00001+4                                      1062 05090000
         MVI   @AL00001+4,X'80'                                    1062 05091000
         L     @15,GDTALC(,@05)                                    1062 05092000
         LA    @01,@AL00001                                        1062 05093000
         BALR  @14,@15                                             1062 05094000
*            RESPECIFY RTNREG RSTD;                                1063 05095000
*            TESTRC = RTNREG;                                      1064 05096000
         LR    TESTRC,RTNREG                                       1064 05097000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 05098000
*            IF TESTRC = 0                                 /*@Y30SSFR*/ 05099000
*              THEN                                        /*@Y30SSFR*/ 05100000
*                                                                  1066 05101000
         LTR   TESTRC,TESTRC                                       1066 05102000
         BNZ   @RF01066                                            1066 05103000
*                /****************************************************/ 05104000
*                /*                                          @Y30SSFR*/ 05105000
*                /*  THE OBJECT HAS BEEN ALLOCATED           @Y30SSFR*/ 05106000
*                /*  SUCCESSFULLY.  SET DEALLOC TO ON.       @Y30SSFR*/ 05107000
*                /*                                          @Y30SSFR*/ 05108000
*                /****************************************************/ 05109000
*                                                                  1067 05110000
*                DEALLOC = ON;                             /*@Y30SSFR*/ 05111000
*                                                                  1067 05112000
         OI    DEALLOC,B'10000000'                                 1067 05113000
*              ELSE                                        /*@Y30SSFR*/ 05114000
*                DO;                                       /*@Y30SSFR*/ 05115000
*                                                                  1068 05116000
         B     @RC01066                                            1068 05117000
@RF01066 DS    0H                                                  1069 05118000
*                /****************************************************/ 05119000
*                /*                                          @Y30SSFR*/ 05120000
*                /*  DYNAMIC ALLOCATION HAS FAILED.          @Y30SSFR*/ 05121000
*                /*  MAKE SETRC 8 TO INDICATE THAT THE       @Y30SSFR*/ 05122000
*                /*  OBJECT CANNOT BE DELETED.               @Y30SSFR*/ 05123000
*                /*  RETURN TO THE CALLING PROCESSOR.        @Y30SSFR*/ 05124000
*                /*                                          @Y30SSFR*/ 05125000
*                /****************************************************/ 05126000
*                                                                  1069 05127000
*                SETRC = MAX(SETRC,LASTCC08);              /*@Y30SSFR*/ 05128000
         LA    @08,8                                               1069 05129000
         CR    SETRC,@08                                           1069 05130000
         BNL   *+6                                                      05131000
         LR    SETRC,@08                                           1069 05132000
*                RETURN CODE(SETRC);                       /*@Y30SSFR*/ 05133000
         LR    @15,SETRC                                           1070 05134000
         L     @14,@SA00009                                        1070 05135000
         LM    @00,@03,@SA00009+8                                  1070 05136000
         LM    @05,@12,@SA00009+24                                 1070 05137000
         BR    @14                                                 1070 05138000
*                END;                                      /*@Y30SSFR*/ 05139000
*            END;                                          /*@Y30SSFR*/ 05140000
*                                                                  1072 05141000
*          ELSE                                            /*@Y30SSFR*/ 05142000
*                                                                  1073 05143000
*            /********************************************************/ 05144000
*            /*                                              @Y30SSFR*/ 05145000
*            /*  THE REQUEST IS FOR DYNAMIC ALLOCATION       @Y30SSFR*/ 05146000
*            /*  OF VOLUMES.                                 @Y30SSFR*/ 05147000
*            /*                                              @Y30SSFR*/ 05148000
*            /********************************************************/ 05149000
*                                                                  1073 05150000
*            DO;                                           /*@Y30SSFR*/ 05151000
*                                                                  1073 05152000
         B     @RC01051                                            1073 05153000
@RF01051 DS    0H                                                  1074 05154000
*            /********************************************************/ 05155000
*            /*                                              @Y30SSFR*/ 05156000
*            /*  SET THE ALLPTR TO POINT TO THE STORAGE      @Y30SSFR*/ 05157000
*            /*  FOR THE ALLAGL, AND CLEAR THAT PART OF      @Y30SSFR*/ 05158000
*            /*  CORE.                                       @Y30SSFR*/ 05159000
*            /*                                              @Y30SSFR*/ 05160000
*            /********************************************************/ 05161000
*                                                                  1074 05162000
*            ALLPTR = ADDR(ALLLIST);                       /*@Y30SSFR*/ 05163000
         LA    @08,ALLLIST                                         1074 05164000
         ST    @08,ALLPTR                                          1074 05165000
*            ALLAGL = ''B;                                 /*@Y30SSFR*/ 05166000
*                                                                  1075 05167000
         XC    ALLAGL(31,@08),ALLAGL(@08)                          1075 05168000
*            /********************************************************/ 05169000
*            /*                                              @Y30SSFR*/ 05170000
*            /*  SELECT OPTIONS--DYNAMIC ALLOCATION OF       @Y30SSFR*/ 05171000
*            /*  VOLUMES.                                    @Y30SSFR*/ 05172000
*            /*                                              @Y30SSFR*/ 05173000
*            /********************************************************/ 05174000
*                                                                  1076 05175000
*            ALLOPTVL = ON;                                /*@Y30SSFR*/ 05176000
*            ALLOPTDS = OFF;                               /*@Y30SSFR*/ 05177000
*                                                                  1077 05178000
         OI    ALLOPTVL(@08),B'10000000'                           1077 05179000
         NI    ALLOPTDS(@08),B'10111111'                           1077 05180000
*            /********************************************************/ 05181000
*            /*                                              @Y30SSFR*/ 05182000
*            /*  BUILD THE UNIT AND VOLUME LISTS THAT        @Y30SSFR*/ 05183000
*            /*  THE ALLAGL POINTS TO WHEN DYNAMICALLY       @Y30SSFR*/ 05184000
*            /*  ALLOCATING VOLUMES.                         @Y30SSFR*/ 05185000
*            /*  THIS IS DONE BY FIRST SETTING               @Y30SSFR*/ 05186000
*            /*  THE ADDRESSES OF THE LISTS IN THE           @Y30SSFR*/ 05187000
*            /*  ALLAGL.  THEN THE TWO LISTS ARE             @Y30SSFR*/ 05188000
*            /*  BUILT IN IDCDL01'S AUTOMATIC STORAGE.       @Y30SSFR*/ 05189000
*            /*                                              @Y30SSFR*/ 05190000
*            /********************************************************/ 05191000
*                                                                  1078 05192000
*            ALLULP = ADDR(ULP);                           /*@Y30SSFR*/ 05193000
         LA    @05,ULP                                             1078 05194000
         ST    @05,ALLULP(,@08)                                    1078 05195000
*            ALLVLP = ADDR(VLP);                           /*@Y30SSFR*/ 05196000
*                                                                  1079 05197000
         LA    @05,VLP                                             1079 05198000
         ST    @05,ALLVLP(,@08)                                    1079 05199000
*            /********************************************************/ 05200000
*            /*                                              @Y30SSFR*/ 05201000
*            /*  BUILD THE UNIT PARAMETER LIST.              @Y30SSFR*/ 05202000
*            /*  AMS USES THE GENERIC 'SYSALLDA'             @Y30SSFR*/ 05203000
*            /*  AS THE UNIT TYPE.                           @Y30SSFR*/ 05204000
*            /*                                              @Y30SSFR*/ 05205000
*            /********************************************************/ 05206000
*                                                                  1080 05207000
*            ULPNUM = 1;                                   /*@Y30SSFR*/ 05208000
         LA    @05,1                                               1080 05209000
         STH   @05,ULPNUM                                          1080 05210000
*            ULPLEN = 8;                                   /*@Y30SSFR*/ 05211000
         MVC   ULPLEN(2),@CH00179                                  1081 05212000
*            ULPVAL = 'SYSALLDA';                          /*@Y30SSFR*/ 05213000
*                                                                  1082 05214000
         MVC   ULPVAL(8),@CC01054                                  1082 05215000
*            /********************************************************/ 05216000
*            /*                                              @Y30SSFR*/ 05217000
*            /*  BUILD THE VOLUME PARAMETER LIST.            @Y30SSFR*/ 05218000
*            /*  THE VOLSER TO BE ALLOCATED IS THE           @Y30SSFR*/ 05219000
*            /*  ONE PASSED TO ALLOPROC AS A PARAMETER.      @Y30SSFR*/ 05220000
*            /*                                              @Y30SSFR*/ 05221000
*            /********************************************************/ 05222000
*                                                                  1083 05223000
*            VLPNUM = 1;                                   /*@Y30SSFR*/ 05224000
         STH   @05,VLPNUM                                          1083 05225000
*            VLPLEN = SERLN;                               /*@Y30SSFR*/ 05226000
         MVC   VLPLEN(2),@CH00156                                  1084 05227000
*            VLPVAL = ALVLSPT -> VOLSER;                   /*@Y30SSFR*/ 05228000
*                                                                  1085 05229000
         L     @05,@PC00009+4                                      1085 05230000
         L     @05,ALVLSPT(,@05)                                   1085 05231000
         MVC   VLPVAL(6),VOLSER(@05)                               1085 05232000
*            /********************************************************/ 05233000
*            /*                                              @Y30SSFR*/ 05234000
*            /*  ISSUE THE UALLOC MACRO AND TEST             @Y30SSFR*/ 05235000
*            /*  FOR A ZERO RETURN CODE.                     @Y30SSFR*/ 05236000
*            /*                                              @Y30SSFR*/ 05237000
*            /********************************************************/ 05238000
*                                                                  1086 05239000
*            CALL IDCSAAL0(GDTTBL,ALLAGL);                 /*@Y30SSFR*/ 05240000
*                                                                  1086 05241000
         L     @05,@PC00001                                        1086 05242000
         ST    @05,@AL00001                                        1086 05243000
         ST    @08,@AL00001+4                                      1086 05244000
         MVI   @AL00001+4,X'80'                                    1086 05245000
         L     @15,GDTALC(,@05)                                    1086 05246000
         LA    @01,@AL00001                                        1086 05247000
         BALR  @14,@15                                             1086 05248000
*            RESPECIFY RTNREG RSTD;                                1087 05249000
*            TESTRC = RTNREG;                                      1088 05250000
         LR    TESTRC,RTNREG                                       1088 05251000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 05252000
*            IF TESTRC = 0                                 /*@Y30SSFR*/ 05253000
*              THEN                                        /*@Y30SSFR*/ 05254000
*                                                                  1090 05255000
         LTR   TESTRC,TESTRC                                       1090 05256000
         BNZ   @RF01090                                            1090 05257000
*                /****************************************************/ 05258000
*                /*                                          @Y30SSFR*/ 05259000
*                /*  THE OBJECT HAS BEEN ALLOCATED           @Y30SSFR*/ 05260000
*                /*  SUCCESSFULLY.  TURN DEALLOC             @Y30SSFR*/ 05261000
*                /*  ON.                                     @Y30SSFR*/ 05262000
*                /*                                          @Y30SSFR*/ 05263000
*                /****************************************************/ 05264000
*                                                                  1091 05265000
*                DEALLOC = ON;                             /*@Y30SSFR*/ 05266000
*                                                                  1091 05267000
         OI    DEALLOC,B'10000000'                                 1091 05268000
*              ELSE                                        /*@Y30SSFR*/ 05269000
*                DO;                                       /*@Y30SSFR*/ 05270000
*                                                                  1092 05271000
         B     @RC01090                                            1092 05272000
@RF01090 DS    0H                                                  1093 05273000
*                /****************************************************/ 05274000
*                /*                                          @Y30SSFR*/ 05275000
*                /*  THE ALLOCATION REQUEST HAS              @Y30SSFR*/ 05276000
*                /*  FAILED.  MAKE SETRC 8 TO                @Y30SSFR*/ 05277000
*                /*  INDICATE THAT THE OBJECT CAN            @Y30SSFR*/ 05278000
*                /*  NOT BE DELETED.  RETURN TO              @Y30SSFR*/ 05279000
*                /*  THE CALLING PROCESSOR.                  @Y30SSFR*/ 05280000
*                /*                                          @Y30SSFR*/ 05281000
*                /****************************************************/ 05282000
*                                                                  1093 05283000
*                SETRC = MAX(SETRC,LASTCC08);              /*@Y30SSFR*/ 05284000
         LA    @08,8                                               1093 05285000
         CR    SETRC,@08                                           1093 05286000
         BNL   *+6                                                      05287000
         LR    SETRC,@08                                           1093 05288000
*                RETURN CODE(SETRC);                       /*@Y30SSFR*/ 05289000
         LR    @15,SETRC                                           1094 05290000
         L     @14,@SA00009                                        1094 05291000
         LM    @00,@03,@SA00009+8                                  1094 05292000
         LM    @05,@12,@SA00009+24                                 1094 05293000
         BR    @14                                                 1094 05294000
*                END;                                      /*@Y30SSFR*/ 05295000
*            END;                                          /*@Y30SSFR*/ 05296000
@RC01090 DS    0H                                                  1097 05297000
*        RETURN CODE(LASTCC00);                            /*@Y30SSFR*/ 05298000
@RC01051 SLR   @15,@15                                             1097 05299000
         L     @14,@SA00009                                        1097 05300000
         LM    @00,@03,@SA00009+8                                  1097 05301000
         LM    @05,@12,@SA00009+24                                 1097 05302000
         BR    @14                                                 1097 05303000
*END ALLOPROC;                                             /*@Y30SSFR*/ 05304000
*        /************************************************************/ 05305000
*        /*                                                  @Y30SSFR*/ 05306000
*        /*  PROCEDURE NAME - RC240PRC                       @Y30SSFR*/ 05307000
*        /*                                                  @Y30SSFR*/ 05308000
*        /*  FUNCTION - HANDLE ALL OF THE CHECKING           @Y30SSFR*/ 05309000
*        /*  ASSOCIATED WITH THE PRESENCE OF THE CATALOG     @Y30SSFR*/ 05310000
*        /*  PARAMETER WHEN DYNAMIC ALLOCATION IS REQUIRED.  @Y30SSFR*/ 05311000
*        /*  THIS PROCEDURE IS CALLED WHEN VSAM CATALOG      @Y30SSFR*/ 05312000
*        /*  MANAGEMENT RETURNS A RETURN CODE OF 240 TO      @Y30SSFR*/ 05313000
*        /*  AMS FOLLOWING A DELETE OPERATION.  IN THAT      @Y30SSFR*/ 05314000
*        /*  SITUATION THIS PROCEDURE IS INVOKED TO          @Y30SSFR*/ 05315000
*        /*  DETERMINE IF THE CATALOG SPECIFIED VIA THE      @Y30SSFR*/ 05316000
*        /*  CATALOG PARAMETER IS AVAILABLE TO DYNAMIC       @Y30SSFR*/ 05317000
*        /*  ALLOCATION.                                     @Y30SSFR*/ 05318000
*        /*                                                  @Y30SSFR*/ 05319000
*        /*  INPUT - NONE                                    @Y30SSFR*/ 05320000
*        /*                                                  @Y30SSFR*/ 05321000
*        /*  OUTPUT - IF SUCCESSFUL, A RESTORED DELETE CPL   @Y30SSFR*/ 05322000
*        /*  WITH A POINTER TO A DDNAME IN CTGDDNM.          @Y30SSFR*/ 05323000
*        /*  OTHERWISE, AN ERROR INDICATION.                 @Y30SSFR*/ 05324000
*        /*                                                  @Y30SSFR*/ 05325000
*        /************************************************************/ 05326000
*                                                                  1099 05327000
*RC240PRC: PROCEDURE;                                      /*@Y30SSFR*/ 05328000
*                                                                  1099 05329000
RC240PRC STM   @14,@03,@SA00010                                    1099 05330000
         STM   @05,@12,@SA00010+24                                 1099 05331000
*        /************************************************************/ 05332000
*        /*                                                  @Y30SSFR*/ 05333000
*        /*  DECLARATIONS LOCAL TO RC240PRC.                 @Y30SSFR*/ 05334000
*        /*                                                  @Y30SSFR*/ 05335000
*        /************************************************************/ 05336000
*                                                                  1100 05337000
*        DCL LOCCPL CHAR(LENGTH(CTGPL)+4) BDY(WORD);       /*@Y30SSFR*/ 05338000
*                                      /*STORAGE FOR LOCATE  @Y30SSFR*/ 05339000
*                                      /*CPL                 @Y30SSFR*/ 05340000
*        DCL SAVCPLPT PTR(31);         /*SAVE AREA FOR THE   @Y30SSFR*/ 05341000
*                                      /*PREVIOUS VALUE OF   @Y30SSFR*/ 05342000
*                                      /*CTGPLPTR            @Y30SSFR*/ 05343000
*        DCL CATAREA CHAR(44);         /*RETURN LOCATION     @Y30SSFR*/ 05344000
*                                      /*FOR THE CATALOG     @Y30SSFR*/ 05345000
*                                      /*NAME                @Y30SSFR*/ 05346000
*        DCL LOCFPL CHAR(LENGTH(CTGFL)+8) BDY(WORD);       /*@Y30SSFR*/ 05347000
*                                      /*STORAGE FOR A       @Y30SSFR*/ 05348000
*                                      /*A LOCATE FPL        @Y30SSFR*/ 05349000
*        DCL 1 LOCWKA BDY(WORD),       /*LOCATE WORK AREA    @Y30SSFR*/ 05350000
*          2 LOCLN FIXED(15),          /*LENGTH OF WORK AREA @Y30SSFR*/ 05351000
*          2 LOCRN FIXED(15),          /*LENGTH USED         @Y30SSFR*/ 05352000
*          2 LOCWORK CHAR(45);         /*DATA RETURNED       @Y30SSFR*/ 05353000
*        DCL ACBSAVE PTR(31);          /*STORAGE FOR FIRST   @Y30SSFR*/ 05354000
*                                      /*CATALOG ACB FOUND   @Y30SSFR*/ 05355000
*        OLDERID2 = NEWERID2;                                      1106 05356000
         L     @08,@PC00001                                        1106 05357000
         L     @08,GDTTR2(,@08)                                    1106 05358000
         MVC   @TS00001(95),NEWERID2(@08)                          1106 05359000
         MVC   OLDERID2(95,@08),@TS00001                           1106 05360000
*        NEWID2 = 'DLAC';                                  /*@Y30SSFR*/ 05361000
*                                                                  1107 05362000
         MVC   NEWID2(4,@08),@CC01068                              1107 05363000
*        /************************************************************/ 05364000
*        /*                                                  @Y30SSFR*/ 05365000
*        /*  INITIALIZE THE RETURN AREA                      @Y30SSFR*/ 05366000
*        /*  FOR THE CATALOG NAME TO 44                      @Y30SSFR*/ 05367000
*        /*  BLANKS.  INITIALIZE THE                         @Y30SSFR*/ 05368000
*        /*  STORAGE FOR THE CPL TO BINARY ZEROS.            @Y30SSFR*/ 05369000
*        /*                                                  @Y30SSFR*/ 05370000
*        /************************************************************/ 05371000
*                                                                  1108 05372000
*        CATAREA = BLANKS;                                 /*@Y30SSFR*/ 05373000
         MVC   CATAREA(44),BLANKS                                  1108 05374000
*        LOCCPL = ''B;                                     /*@Y30SSFR*/ 05375000
*                                                                  1109 05376000
         XC    LOCCPL(32),LOCCPL                                   1109 05377000
*        /************************************************************/ 05378000
*        /*                                                  @Y30SSFR*/ 05379000
*        /*  SAVE THE VALUE OF CTGPLPTR,                     @Y30SSFR*/ 05380000
*        /*  SO THAT THE CPL USED TO DO                      @Y30SSFR*/ 05381000
*        /*  DELETES CAN BE REFERENCED                       @Y30SSFR*/ 05382000
*        /*  LATER, AND SET CTGPLPTR TO                      @Y30SSFR*/ 05383000
*        /*  POINT TO THE CPL FOR THE                        @Y30SSFR*/ 05384000
*        /*  LOCATE.                                         @Y30SSFR*/ 05385000
*        /*                                                  @Y30SSFR*/ 05386000
*        /************************************************************/ 05387000
*                                                                  1110 05388000
*        SAVCPLPT = CTGPLPTR;                              /*@Y30SSFR*/ 05389000
         L     SAVCPLPT,CTGPLPTR                                   1110 05390000
*        CTGPLPTR = ADDR(LOCCPL);                          /*@Y30SSFR*/ 05391000
*                                                                  1111 05392000
         LA    @08,LOCCPL                                          1111 05393000
         ST    @08,CTGPLPTR                                        1111 05394000
*        /************************************************************/ 05395000
*        /*                                                  @Y30SSFR*/ 05396000
*        /*  THE OPTIONS SELECTED FOR THIS                   @Y30SSFR*/ 05397000
*        /*  CALL TO CATALOG ARE:                            @Y30SSFR*/ 05398000
*        /*  (1) CATALOG MANAGEMENT SERVICES                 @Y30SSFR*/ 05399000
*        /*  (2) LISTCATALOG                                 @Y30SSFR*/ 05400000
*        /*  (3) VSAM REQUEST                                @Y30SSFR*/ 05401000
*        /*                                                  @Y30SSFR*/ 05402000
*        /************************************************************/ 05403000
*                                                                  1112 05404000
*        CTGFUNC = CTGCMS;                                 /*@Y30SSFR*/ 05405000
         NI    CTGFUNC(@08),B'10011111'                            1112 05406000
         OI    CTGFUNC(@08),B'10000000'                            1112 05407000
*        CTGOPTNS = CTGLTCAT;                              /*@Y30SSFR*/ 05408000
         NI    CTGOPTNS(@08),B'00100111'                           1113 05409000
         OI    CTGOPTNS(@08),B'00100000'                           1113 05410000
*        CTGAM0 = ON;                                      /*@Y30SSFR*/ 05411000
*                                                                  1114 05412000
         OI    CTGAM0(@08),B'00000001'                             1114 05413000
*        /************************************************************/ 05414000
*        /*                                                  @Y30SSFR*/ 05415000
*        /*  INDICATE THAT AN ENTRY NAME                     @Y30SSFR*/ 05416000
*        /*  IS BEING PASSED BY SETTING                      @Y30SSFR*/ 05417000
*        /*  CTGNAME TO BE ON.  SET THE                      @Y30SSFR*/ 05418000
*        /*  THE ADDRESS OF THE ENTRY                        @Y30SSFR*/ 05419000
*        /*  NAME IN CTGENT.                                 @Y30SSFR*/ 05420000
*        /*                                                  @Y30SSFR*/ 05421000
*        /************************************************************/ 05422000
*                                                                  1115 05423000
*        CTGNAME = ON;                                     /*@Y30SSFR*/ 05424000
         OI    CTGNAME(@08),B'00000100'                            1115 05425000
*        CTGENT = ADDR(ENTVAL(ENT));                       /*@Y30SSFR*/ 05426000
*                                                                  1116 05427000
         LR    @07,ENT                                             1116 05428000
         MH    @07,@CH01066                                        1116 05429000
         L     @01,GENWKPTR                                        1116 05430000
         AL    @01,@CF01104                                        1116 05431000
         LA    @07,ENTVAL-5(@07,@01)                               1116 05432000
         ST    @07,CTGENT(,@08)                                    1116 05433000
*        /************************************************************/ 05434000
*        /*                                                  @Y30SSFR*/ 05435000
*        /*  SET CTGCNAME TO BE ON TO                        @Y30SSFR*/ 05436000
*        /*  INDICATE A CATALOG NAME IS                      @Y30SSFR*/ 05437000
*        /*  BEING PASSED.  SET CTGCAT TO                    @Y30SSFR*/ 05438000
*        /*  POINT TO THE BLANK FIELD.                       @Y30SSFR*/ 05439000
*        /*                                                  @Y30SSFR*/ 05440000
*        /************************************************************/ 05441000
*                                                                  1117 05442000
*        CTGCNAME = ON;                                    /*@Y30SSFR*/ 05443000
         OI    CTGCNAME(@08),B'00000010'                           1117 05444000
*        CTGCAT = ADDR(CATAREA);                           /*@Y30SSFR*/ 05445000
*                                                                  1118 05446000
         LA    @07,CATAREA                                         1118 05447000
         ST    @07,CTGCAT(,@08)                                    1118 05448000
*        /************************************************************/ 05449000
*        /*                                                  @Y30SSFR*/ 05450000
*        /*  SET CTGWKA TO POINT TO A                        @Y30SSFR*/ 05451000
*        /*  LOCATE WORK AREA.  CLEAR THE                    @Y30SSFR*/ 05452000
*        /*  WORK AREA, AND SET THE LENGTH                   @Y30SSFR*/ 05453000
*        /*  OF THE WORK AREA IN THE FIRST                   @Y30SSFR*/ 05454000
*        /*  TWO BYTES.                                      @Y30SSFR*/ 05455000
*        /*                                                  @Y30SSFR*/ 05456000
*        /************************************************************/ 05457000
*                                                                  1119 05458000
*        CTGWKA = ADDR(LOCWKA);                            /*@Y30SSFR*/ 05459000
         LA    @07,LOCWKA                                          1119 05460000
         ST    @07,CTGWKA(,@08)                                    1119 05461000
*        LOCWKA = ''B;                                     /*@Y30SSFR*/ 05462000
         XC    LOCWKA(49),LOCWKA                                   1120 05463000
*        LOCLN = LENGTH(LOCWKA);                           /*@Y30SSFR*/ 05464000
*                                                                  1121 05465000
         MVC   LOCLN(2),@CH01086                                   1121 05466000
*        /************************************************************/ 05467000
*        /*                                                  @Y30SSFR*/ 05468000
*        /*  PLACE PASSWORD INFORMATION IN THE CPL TO        @Y30SSFR*/ 05469000
*        /*  AVOID PROMPTING.  IF A PASSWORD WAS SPECIFIED   @Y30SSFR*/ 05470000
*        /*  VIA THE CATALOG PARAMETER, USE THAT.  OTHERWISE @Y30SSFR*/ 05471000
*        /*  USE THE PASSWORD GIVEN VIA THE ENTRYNAME IF     @Y30SSFR*/ 05472000
*        /*  ANY.                                            @Y30SSFR*/ 05473000
*        /*                                                  @Y30SSFR*/ 05474000
*        /************************************************************/ 05475000
*                                                                  1122 05476000
*        IF CATPLN ^= 0                                    /*@Y30SSFR*/ 05477000
*          THEN                                            /*@Y30SSFR*/ 05478000
         L     @07,@PC00001+4                                      1122 05479000
         L     @07,FDTPTR+8(,@07)                                  1122 05480000
         CLI   CATPLN(@07),0                                       1122 05481000
         BE    @RF01122                                            1122 05482000
*            CTGPSWD = ADDR(CATPAS);                       /*@Y30SSFR*/ 05483000
         LA    @07,CATPAS(,@07)                                    1123 05484000
         ST    @07,CTGPSWD(,@08)                                   1123 05485000
*          ELSE                                            /*@Y30SSFR*/ 05486000
*            IF NTRYPLN(INDEX) ^= 0                        /*@Y30SSFR*/ 05487000
*              THEN                                        /*@Y30SSFR*/ 05488000
         B     @RC01122                                            1124 05489000
@RF01122 LH    @08,INDEX                                           1124 05490000
         MH    @08,@CH01079                                        1124 05491000
         L     @07,@PC00001+4                                      1124 05492000
         L     @07,FDTPTR(,@07)                                    1124 05493000
         LA    @01,0(@08,@07)                                      1124 05494000
         AL    @01,@CF01099                                        1124 05495000
         SLR   @00,@00                                             1124 05496000
         IC    @00,NTRYPLN-2(,@01)                                 1124 05497000
         C     @00,@CF00115                                        1124 05498000
         BE    @RF01124                                            1124 05499000
*                CTGPSWD = ADDR(NTRYPAS(INDEX));           /*@Y30SSFR*/ 05500000
*                                                                  1125 05501000
*                                                                  1125 05502000
         AL    @07,@CF01100                                        1125 05503000
         LA    @08,NTRYPAS-3(@08,@07)                              1125 05504000
         L     @07,CTGPLPTR                                        1125 05505000
         ST    @08,CTGPSWD(,@07)                                   1125 05506000
*        /************************************************************/ 05507000
*        /*                                                  #Y30SSFR*/ 05508000
*        /*  SET CTGNOFLD TO BE 1 AND                        #Y30SSFR*/ 05509000
*        /*  BUILD ONE FPL FOR CATACB.                       #Y30SSFR*/ 05510000
*        /*                                                  #Y30SSFR*/ 05511000
*        /************************************************************/ 05512000
*                                                                  1126 05513000
*        CTGNOFLD = 1;                                     /*#Y30SSFR*/ 05514000
@RF01124 DS    0H                                                  1126 05515000
@RC01122 L     @08,CTGPLPTR                                        1126 05516000
         MVI   CTGNOFLD(@08),X'01'                                 1126 05517000
*        CTGFIELD(1) = ADDR(LOCFPL);                       /*#Y30SSFR*/ 05518000
         LA    @07,LOCFPL                                          1127 05519000
         ST    @07,CTGFIELD(,@08)                                  1127 05520000
*        LOCFPL = ''B;                                     /*#Y30SSFR*/ 05521000
         XC    LOCFPL(24),LOCFPL                                   1128 05522000
*        CTGFLPTR = ADDR(LOCFPL);                          /*#Y30SSFR*/ 05523000
         LA    CTGFLPTR,LOCFPL                                     1129 05524000
*        CTGFLDNO = 1;                                     /*@Y30SSFR*/ 05525000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1130 05526000
*        CTGFLDNM = ADDR(ACBADDR);                         /*@Y30SSFR*/ 05527000
*                                                                  1131 05528000
         LA    @08,ACBADDR                                         1131 05529000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             1131 05530000
*        /************************************************************/ 05531000
*        /*                                                  @Y30SSFR*/ 05532000
*        /*  ISSUE THE UCATLG AND TEST THE                   @Y30SSFR*/ 05533000
*        /*  RETURN CODE FROM VSAM CATALOG                   @Y30SSFR*/ 05534000
*        /*  COMPARE THE CATALOG NAME                        @Y30SSFR*/ 05535000
*        /*  GIVEN BY THE USER WITH THAT                     @Y30SSFR*/ 05536000
*        /*  RETURNED BY VSAM.                               @Y30SSFR*/ 05537000
*        /*                                                  @Y30SSFR*/ 05538000
*        /************************************************************/ 05539000
*                                                                  1132 05540000
*        CALL IDCSACA0(GDTTBL,CTGPLPTR);                   /*@Y30SSFR*/ 05541000
         L     @08,@PC00001                                        1132 05542000
         ST    @08,@AL00001                                        1132 05543000
         LA    @07,CTGPLPTR                                        1132 05544000
         ST    @07,@AL00001+4                                      1132 05545000
         L     @15,GDTCAT(,@08)                                    1132 05546000
         LA    @01,@AL00001                                        1132 05547000
         BALR  @14,@15                                             1132 05548000
*        RESPECIFY RTNREG RSTD;                                    1133 05549000
*        TESTRC = RTNREG;                                          1134 05550000
         LR    TESTRC,RTNREG                                       1134 05551000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/ 05552000
*        IF GDTDBG = NULLPTR                                       1136 05553000
*          THEN;                                                   1136 05554000
         L     @08,@PC00001                                        1136 05555000
         L     @08,GDTDBG(,@08)                                    1136 05556000
         LTR   @08,@08                                             1136 05557000
         BZ    @RT01136                                            1136 05558000
*          ELSE                                                    1138 05559000
*            CALL IDCDB010(GDTTBL,'DLLY');                         1138 05560000
         L     @08,@PC00001                                        1138 05561000
         ST    @08,@AL00001                                        1138 05562000
         LA    @07,@CC01069                                        1138 05563000
         ST    @07,@AL00001+4                                      1138 05564000
         MVI   @AL00001+4,X'80'                                    1138 05565000
         L     @15,GDTDBG(,@08)                                    1138 05566000
         LA    @01,@AL00001                                        1138 05567000
         BALR  @14,@15                                             1138 05568000
*                                                          /*@Y30SSFR*/ 05569000
*                                                                  1139 05570000
*        /************************************************************/ 05571000
*        /*                                                  @Y30SSFR*/ 05572000
*        /*  IF THE RETURN CODE FROM VSAM CATALOG IS         @Y30SSFR*/ 05573000
*        /*  NONZERO, THEN RESTORE CTGPLPTR TO POINT TO THE  @Y30SSFR*/ 05574000
*        /*  DELETE CPL AND RETURN.                          @Y30SSFR*/ 05575000
*        /*                                                  @Y30SSFR*/ 05576000
*        /************************************************************/ 05577000
*                                                                  1139 05578000
*        IF TESTRC ^= 0                                            1139 05579000
*          THEN                                                    1139 05580000
@RT01136 LTR   TESTRC,TESTRC                                       1139 05581000
         BZ    @RF01139                                            1139 05582000
*            DO;                                           /*@Y30SSFR*/ 05583000
*            CTGPLPTR = SAVCPLPT;                          /*@Y30SSFR*/ 05584000
         ST    SAVCPLPT,CTGPLPTR                                   1141 05585000
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/ 05586000
         LA    @15,12                                              1142 05587000
         L     @14,@SA00010                                        1142 05588000
         LM    @00,@03,@SA00010+8                                  1142 05589000
         LM    @05,@12,@SA00010+24                                 1142 05590000
         BR    @14                                                 1142 05591000
*            END;                                          /*@Y30SSFR*/ 05592000
*                                                                  1143 05593000
*          ELSE                                                    1144 05594000
*                                                                  1144 05595000
*            /********************************************************/ 05596000
*            /*                                              @Y30SSFR*/ 05597000
*            /*  COMPARE THE NAME PASSED BACK BY VSAM AS THE @Y30SSFR*/ 05598000
*            /*  TRUE NAME OF THE CATALOG IN WHICH THE DATA  @Y30SSFR*/ 05599000
*            /*  SET CAN BE FOUND BY DYNAMIC ALLOCATION WITH @Y30SSFR*/ 05600000
*            /*  THAT SUPPLIED BY THE USER.  IF THEY ARE NOT @Y30SSFR*/ 05601000
*            /*  EQUAL, CHECK TO DETERMINE IF THE NAME       @Y30SSFR*/ 05602000
*            /*  SPECIFIED BY THE USER IS AN ALIAS OF THE    @Y30SSFR*/ 05603000
*            /*  CATALOG IN WHICH VSAM FOUND THE DATA SET.   @Y30SSFR*/ 05604000
*            /*                                              @Y30SSFR*/ 05605000
*            /********************************************************/ 05606000
*                                                                  1144 05607000
*            IF CATAREA ^= CATVAL                                  1144 05608000
*              THEN                                                1144 05609000
@RF01139 L     @08,@PC00001+4                                      1144 05610000
         L     @08,FDTPTR+8(,@08)                                  1144 05611000
         CLC   CATAREA(44),CATVAL(@08)                             1144 05612000
         BE    @RF01144                                            1144 05613000
*ALIASNAM:       DO;                                       /*@Y30SSFR*/ 05614000
*                                                                  1145 05615000
ALIASNAM DS    0H                                                  1146 05616000
*                /****************************************************/ 05617000
*                /*                                          @Y30SSFR*/ 05618000
*                /*  SAVE THE ACB ADDRESS RETURNED BY THE    @Y30SSFR*/ 05619000
*                /*  FIRST LISTCATALOG.                      @Y30SSFR*/ 05620000
*                /*                                          @Y30SSFR*/ 05621000
*                /****************************************************/ 05622000
*                                                                  1146 05623000
*                ACBSAVE = CTGFLPTR -> CTGFLPT(1) -> LOCACBPT;     1146 05624000
*                                                                  1146 05625000
         L     @08,CTGFLPT(,CTGFLPTR)                              1146 05626000
         L     ACBSAVE,LOCACBPT(,@08)                              1146 05627000
*                /****************************************************/ 05628000
*                /*                                          @Y30SSFR*/ 05629000
*                /*  DO A DIRECTED SEARCH ON THIS            @Y30SSFR*/ 05630000
*                /*  LISTCATALOG, SEARCHING ONLY THE CATALOG @Y30SSFR*/ 05631000
*                /*  REFERRED TO BY THE CATALOG PARAMETER.   @Y30SSFR*/ 05632000
*                /*                                          @Y30SSFR*/ 05633000
*                /****************************************************/ 05634000
*                                                                  1147 05635000
*                CTGNUM = ON;                              /*@Y30SSFR*/ 05636000
         L     @08,CTGPLPTR                                        1147 05637000
         OI    CTGNUM(@08),B'00000010'                             1147 05638000
*                CTGCAT = ADDR(CATVAL);                    /*@Y30SSFR*/ 05639000
*                                                                  1148 05640000
         L     @15,@PC00001+4                                      1148 05641000
         L     @01,FDTPTR+8(,@15)                                  1148 05642000
         LA    @15,CATVAL(,@01)                                    1148 05643000
         ST    @15,CTGCAT(,@08)                                    1148 05644000
*                /****************************************************/ 05645000
*                /*                                          @Y30SSFR*/ 05646000
*                /*  CLEAR THE LENGTH AND DATA POINTER IN    @Y30SSFR*/ 05647000
*                /*  THE CATACB FPL.                         @Y30SSFR*/ 05648000
*                /*                                          @Y30SSFR*/ 05649000
*                /****************************************************/ 05650000
*                                                                  1149 05651000
*                CTGFLPT(1) = NULLPTR;                     /*@Y30SSFR*/ 05652000
         SLR   @08,@08                                             1149 05653000
         ST    @08,CTGFLPT(,CTGFLPTR)                              1149 05654000
*                CTGFLNG(1) = 0;                           /*@Y30SSFR*/ 05655000
*                                                                  1150 05656000
         ST    @08,CTGFLNG(,CTGFLPTR)                              1150 05657000
*                /****************************************************/ 05658000
*                /*                                          @Y30SSFR*/ 05659000
*                /*  ISSUE A UCATLG, AND SAVE THE RETURN     @Y30SSFR*/ 05660000
*                /*  CODE FROM CATALOG.                      @Y30SSFR*/ 05661000
*                /*                                          @Y30SSFR*/ 05662000
*                /****************************************************/ 05663000
*                                                                  1151 05664000
*                CALL IDCSACA0(GDTTBL,CTGPLPTR);           /*@Y30SSFR*/ 05665000
         L     @08,@PC00001                                        1151 05666000
         ST    @08,@AL00001                                        1151 05667000
         LA    @15,CTGPLPTR                                        1151 05668000
         ST    @15,@AL00001+4                                      1151 05669000
         L     @15,GDTCAT(,@08)                                    1151 05670000
         LA    @01,@AL00001                                        1151 05671000
         BALR  @14,@15                                             1151 05672000
*                RESPECIFY RTNREG RSTD;                            1152 05673000
*                TESTRC = RTNREG;                                  1153 05674000
         LR    TESTRC,RTNREG                                       1153 05675000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/ 05676000
*                IF GDTDBG = NULLPTR                               1155 05677000
*                  THEN;                                           1155 05678000
         L     @08,@PC00001                                        1155 05679000
         L     @08,GDTDBG(,@08)                                    1155 05680000
         LTR   @08,@08                                             1155 05681000
         BZ    @RT01155                                            1155 05682000
*                  ELSE                                            1157 05683000
*                    CALL IDCDB010(GDTTBL,'DLLZ');                 1157 05684000
         L     @08,@PC00001                                        1157 05685000
         ST    @08,@AL00001                                        1157 05686000
         LA    @15,@CC01072                                        1157 05687000
         ST    @15,@AL00001+4                                      1157 05688000
         MVI   @AL00001+4,X'80'                                    1157 05689000
         L     @15,GDTDBG(,@08)                                    1157 05690000
         LA    @01,@AL00001                                        1157 05691000
         BALR  @14,@15                                             1157 05692000
*                                                          /*@Y30SSFR*/ 05693000
*                IF TESTRC ^= 0                                    1158 05694000
*                  THEN                                            1158 05695000
@RT01155 LTR   TESTRC,TESTRC                                       1158 05696000
         BZ    @RF01158                                            1158 05697000
*                    DO;                                   /*@Y30SSFR*/ 05698000
*                                                                  1159 05699000
*                    /************************************************/ 05700000
*                    /*                                      @Y30SSFR*/ 05701000
*                    /*  THE CATALOG OPERATION HAS FAILED.   @Y30SSFR*/ 05702000
*                    /*  RESTORE CTGPLPTR TO POINT THE CPL   @Y30SSFR*/ 05703000
*                    /*  FOR THE DELETE OPERATION AND        @Y30SSFR*/ 05704000
*                    /*  RETURN.                             @Y30SSFR*/ 05705000
*                    /************************************************/ 05706000
*                                                                  1160 05707000
*                    CTGPLPTR = SAVCPLPT;                  /*@Y30SSFR*/ 05708000
         ST    SAVCPLPT,CTGPLPTR                                   1160 05709000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 05710000
         LA    @15,12                                              1161 05711000
         L     @14,@SA00010                                        1161 05712000
         LM    @00,@03,@SA00010+8                                  1161 05713000
         LM    @05,@12,@SA00010+24                                 1161 05714000
         BR    @14                                                 1161 05715000
*                    END;                                  /*@Y30SSFR*/ 05716000
*                  ELSE                                            1163 05717000
*                                                                  1163 05718000
*                    /************************************************/ 05719000
*                    /*                                      @Y30SSFR*/ 05720000
*                    /*  COMPARE THE ACB ADDRESSES RETURNED  @Y30SSFR*/ 05721000
*                    /*  BY THE TWO LISTCATALOGS.  IF THEY   @Y30SSFR*/ 05722000
*                    /*  ARE NOT EQUAL, RESTORE CTGPLPTR,    @Y30SSFR*/ 05723000
*                    /*  AND RETURN.                         @Y30SSFR*/ 05724000
*                    /*                                      @Y30SSFR*/ 05725000
*                    /************************************************/ 05726000
*                                                                  1163 05727000
*                    IF ACBSAVE ^= CTGFLPTR -> CTGFLPT(1) ->       1163 05728000
*                       LOCACBPT                                   1163 05729000
*                      THEN                                        1163 05730000
@RF01158 L     @08,CTGFLPT(,CTGFLPTR)                              1163 05731000
         C     ACBSAVE,LOCACBPT(,@08)                              1163 05732000
         BE    @RF01163                                            1163 05733000
*                        DO;                               /*@Y30SSFR*/ 05734000
*                                                                  1164 05735000
*                        /********************************************/ 05736000
*                        /*                                  @Y30SSFR*/ 05737000
*                        /*  THE CATALOG SPECIFIED BY THE    @Y30SSFR*/ 05738000
*                        /*  CATALOG PARAMETER IS NOT        @Y30SSFR*/ 05739000
*                        /*  ACCESSIBLE TO DYNAMIC           @Y30SSFR*/ 05740000
*                        /*  ALLOCATION.  RESTORE CTGPLPTR,  @Y30SSFR*/ 05741000
*                        /*  AND RETURN.                     @Y30SSFR*/ 05742000
*                        /*                                  @Y30SSFR*/ 05743000
*                        /********************************************/ 05744000
*                                                                  1165 05745000
*                        CTGPLPTR = SAVCPLPT;              /*@Y30SSFR*/ 05746000
         ST    SAVCPLPT,CTGPLPTR                                   1165 05747000
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/ 05748000
         LA    @15,12                                              1166 05749000
         L     @14,@SA00010                                        1166 05750000
         LM    @00,@03,@SA00010+8                                  1166 05751000
         LM    @05,@12,@SA00010+24                                 1166 05752000
         BR    @14                                                 1166 05753000
*                        END;                              /*@Y30SSFR*/ 05754000
*                  END ALIASNAM;                           /*@Y30SSFR*/ 05755000
*                                                                  1168 05756000
@RF01163 DS    0H                                                  1169 05757000
*        /************************************************************/ 05758000
*        /*                                                  @Y30SSFR*/ 05759000
*        /*  RESTORE CTGPLPTR TO THE                         @Y30SSFR*/ 05760000
*        /*  VALUE IT HAD PRIOR TO THE                       @Y30SSFR*/ 05761000
*        /*  LOCATE FOR CATALOG NAME.                        @Y30SSFR*/ 05762000
*        /*  RESTORE THE CPL PRIOR TO                        @Y30SSFR*/ 05763000
*        /*  REQUESTING DYNAMIC ALLOCATION.                  @Y30SSFR*/ 05764000
*        /*                                                  @Y30SSFR*/ 05765000
*        /************************************************************/ 05766000
*                                                                  1169 05767000
*        CTGPLPTR = SAVCPLPT;                              /*@Y30SSFR*/ 05768000
@RF01144 ST    SAVCPLPT,CTGPLPTR                                   1169 05769000
*        CTGPL = RENEWCPL;                                 /*@Y30SSFR*/ 05770000
*                                                                  1170 05771000
         L     @08,CTGPLPTR                                        1170 05772000
         MVC   CTGPL(28,@08),RENEWCPL                              1170 05773000
*        /************************************************************/ 05774000
*        /*                                                  @Y30SSFR*/ 05775000
*        /*  CATALOG HAS RETURNED AN                         @Y30SSFR*/ 05776000
*        /*  ACB ADDRESS.  PLACE A                           @Y30SSFR*/ 05777000
*        /*  POINTER TO THAT IN THE CPL.                     @Y30SSFR*/ 05778000
*        /*                                                  @Y30SSFR*/ 05779000
*        /************************************************************/ 05780000
*                                                                  1171 05781000
*        CTGCNAME = OFF;                                   /*@Y30SSFR*/ 05782000
         NI    CTGCNAME(@08),B'11111101'                           1171 05783000
*        CTGCAT = ADDR(CTGFLPTR -> CTGFLPT(1) -> LOCACBPT);/*@Y30SSFR*/ 05784000
*                                                                  1172 05785000
         L     @02,CTGFLPT(,CTGFLPTR)                              1172 05786000
         ST    @02,CTGCAT(,@08)                                    1172 05787000
*        /************************************************************/ 05788000
*        /*                                                  @Y30SSFR*/ 05789000
*        /*  CALL ALLOPROC TO ALLOCATE                       @Y30SSFR*/ 05790000
*        /*  THE OBJECT TO BE DELETED.                       @Y30SSFR*/ 05791000
*        /*                                                  @Y30SSFR*/ 05792000
*        /************************************************************/ 05793000
*                                                                  1173 05794000
*        CALL ALLOPROC(ADDR(ENTVAL(ENT)),NULLPARM);        /*@Y30SSFR*/ 05795000
*                                                                  1173 05796000
         LR    @08,ENT                                             1173 05797000
         MH    @08,@CH01066                                        1173 05798000
         L     @01,GENWKPTR                                        1173 05799000
         AL    @01,@CF01104                                        1173 05800000
         LA    @08,ENTVAL-5(@08,@01)                               1173 05801000
         ST    @08,@AFTEMPS+12                                     1173 05802000
         LA    @08,@AFTEMPS+12                                     1173 05803000
         ST    @08,@AL00001                                        1173 05804000
         LA    @08,@CF00115                                        1173 05805000
         ST    @08,@AL00001+4                                      1173 05806000
         LA    @01,@AL00001                                        1173 05807000
         BAL   @14,ALLOPROC                                        1173 05808000
*        RESPECIFY RTNREG RSTD;                                    1174 05809000
*        TESTRC = RTNREG;                                          1175 05810000
         LR    TESTRC,RTNREG                                       1175 05811000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/ 05812000
*        IF TESTRC ^= 0                                    /*@Y30SSFR*/ 05813000
*          THEN                                            /*@Y30SSFR*/ 05814000
         LTR   TESTRC,TESTRC                                       1177 05815000
         BZ    @RF01177                                            1177 05816000
*            DO;                                           /*@Y30SSFR*/ 05817000
*            SETRC = LASTCC08;                             /*@Y30SSFR*/ 05818000
         LA    @08,8                                               1179 05819000
         LR    SETRC,@08                                           1179 05820000
*            RETURN CODE(LASTCC08);                        /*@Y30SSFR*/ 05821000
         LR    @15,@08                                             1180 05822000
         L     @14,@SA00010                                        1180 05823000
         LM    @00,@03,@SA00010+8                                  1180 05824000
         LM    @05,@12,@SA00010+24                                 1180 05825000
         BR    @14                                                 1180 05826000
*            END;                                          /*@Y30SSFR*/ 05827000
*                                                                  1181 05828000
*        /************************************************************/ 05829000
*        /*                                                  @Y30SSFR*/ 05830000
*        /*  SET DEFINED TO BE ON TO                         @Y30SSFR*/ 05831000
*        /*  INDICATE ANOTHER ITERATION OF THE LOOP          @Y30SSFR*/ 05832000
*        /*  CATALOG.  ALSO SET A POINTER TO THE             @Y30SSFR*/ 05833000
*        /*  DDNAME RETURNED BY DYNAMIC ALLOCATION.          @Y30SSFR*/ 05834000
*        /*                                                  @Y30SSFR*/ 05835000
*        /************************************************************/ 05836000
*                                                                  1182 05837000
*        DEFINED = ON;                                     /*@Y30SSFR*/ 05838000
@RF01177 OI    DEFINED,B'10000000'                                 1182 05839000
*        CTGDDNM = ADDR(ALLDDN);                           /*@Y30SSFR*/ 05840000
*                                                                  1183 05841000
         L     @08,ALLPTR                                          1183 05842000
         LA    @08,ALLDDN(,@08)                                    1183 05843000
         L     @01,CTGPLPTR                                        1183 05844000
         ST    @08,CTGDDNM(,@01)                                   1183 05845000
*        /************************************************************/ 05846000
*        /*                                                  @Y30SSFR*/ 05847000
*        /*  RETURN TO THE CALLER WITH SUCCESS INDICATED.    @Y30SSFR*/ 05848000
*        /*                                                  @Y30SSFR*/ 05849000
*        /************************************************************/ 05850000
*                                                                  1184 05851000
*        RETURN CODE(0);                                   /*@Y30SSFR*/ 05852000
         SLR   @15,@15                                             1184 05853000
         L     @14,@SA00010                                        1184 05854000
         LM    @00,@03,@SA00010+8                                  1184 05855000
         LM    @05,@12,@SA00010+24                                 1184 05856000
         BR    @14                                                 1184 05857000
*END RC240PRC;                                             /*@Y30SSFR*/ 05858000
*END IDCDL01                                               /*@Y30SSFR*/ 05859000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 05860000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 05861000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 05862000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 05863000
*/*%INCLUDE SYSLIB  (IDCCSDL )                                        * 05864000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 05865000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 05866000
*;                                                                 1186 05867000
@DATA    DS    0H                                                       05868000
@CH00156 DC    H'6'                                                     05869000
@CH00472 DC    H'7'                                                     05870000
@CH00912 DC    H'40'                                                    05871000
@CH00605 DC    H'44'                                                    05872000
@CH01086 DC    H'49'                                                    05873000
@CH01079 DC    H'66'                                                    05874000
@CH01081 DC    H'94'                                                    05875000
@CH00918 DC    H'110'                                                   05876000
@CH00922 DC    H'240'                                                   05877000
@CH01085 DC    H'544'                                                   05878000
@DATD    DSECT                                                          05879000
         DS    0F                                                       05880000
@SA00001 DS    18F                                                      05881000
@PC00001 DS    3F                                                       05882000
@SA00007 DS    15F                                                      05883000
@SA00002 DS    14F                                                      05884000
@SA00003 DS    15F                                                      05885000
@PC00003 DS    2F                                                       05886000
@SA00004 DS    15F                                                      05887000
@PC00004 DS    1F                                                       05888000
@SA00005 DS    14F                                                      05889000
@PC00005 DS    2F                                                       05890000
@SA00006 DS    15F                                                      05891000
@SA00009 DS    14F                                                      05892000
@PC00009 DS    2F                                                       05893000
@SA00008 DS    14F                                                      05894000
@PC00008 DS    1F                                                       05895000
@SA00010 DS    14F                                                      05896000
@AL00001 DS    5A                                                       05897000
@TF00001 DS    F                                                        05898000
@AFTEMPS DS    4F                                                       05899000
IDCDL01  CSECT                                                          05900000
         DS    0F                                                       05901000
@CF00115 DC    F'0'                                                     05902000
@CF00219 DC    F'1'                                                     05903000
@CF00153 DC    F'2'                                                     05904000
@CH00153 EQU   @CF00153+2                                               05905000
@CF00042 DC    F'4'                                                     05906000
@CH00042 EQU   @CF00042+2                                               05907000
@CF00286 DC    F'5'                                                     05908000
@CF00179 DC    F'8'                                                     05909000
@CH00179 EQU   @CF00179+2                                               05910000
@CF00035 DC    F'12'                                                    05911000
@CH00035 EQU   @CF00035+2                                               05912000
@CF01066 DC    F'45'                                                    05913000
@CH01066 EQU   @CF01066+2                                               05914000
@CF00914 DC    F'72'                                                    05915000
@CH00914 EQU   @CF00914+2                                               05916000
@CF00916 DC    F'76'                                                    05917000
@CH00916 EQU   @CF00916+2                                               05918000
@CF00920 DC    F'160'                                                   05919000
@CH00920 EQU   @CF00920+2                                               05920000
@CF01099 DC    F'-64'                                                   05921000
@CF01100 DC    F'-63'                                                   05922000
@CF01102 DC    F'-55'                                                   05923000
@CF01098 DC    F'-54'                                                   05924000
@CF01101 DC    F'-53'                                                   05925000
@CF01116 DC    F'-52'                                                   05926000
@CF01096 DC    F'-44'                                                   05927000
@CF01097 DC    F'-43'                                                   05928000
@CF01103 DC    F'-41'                                                   05929000
@CF01104 DC    F'-40'                                                   05930000
@CF00888 DC    XL1'0'                                                   05931000
         DC    C'DL0'                                                   05932000
@DATD    DSECT                                                          05933000
         DS    0D                                                       05934000
LISTSCAN DS    A                                                        05935000
IOCSPTR  DS    A                                                        05936000
DDSTRU   DS    A                                                        05937000
FSADDR   DS    A                                                        05938000
ERCNVADR DS    A                                                        05939000
DMPINDEX DS    A                                                        05940000
CTGPLPTR DS    A                                                        05941000
LIMIT    DS    F                                                        05942000
ACBPTR   DS    A                                                        05943000
ALLPTR   DS    A                                                        05944000
GENWKPTR DS    A                                                        05945000
WAPTR    DS    A                                                        05946000
MNOENT   DS    F                                                        05947000
PDSIOCS  DS    A                                                        05948000
SIZENEED DS    F                                                        05949000
LISTPTR  DS    A                                                        05950000
INDEX    DS    H                                                        05951000
CATLGRC  DS    H                                                        05952000
LISTLN   DS    FL1                                                      05953000
@TS00001 DS    CL95                                                     05954000
RENEWCPL DS    CL28                                                     05955000
TYPEFLAG DS    BL1                                                      05956000
DCPLINIT DS    BL1                                                      05957000
LCPLINIT DS    BL1                                                      05958000
ACBFLAG  DS    BL1                                                      05959000
DEFINED  DS    BL1                                                      05960000
DEALLOC  DS    BL1                                                      05961000
NOTFOUND DS    BL1                                                      05962000
COREFLAG DS    BL1                                                      05963000
NODEL    DS    BL1                                                      05964000
LOCTYPE  DS    CL1                                                      05965000
         DS    CL2                                                      05966000
FPLTYPE  DS    CL24                                                     05967000
         ORG   FPLTYPE                                                  05968000
@NM00040 DS    CL16                                                     05969000
@NM00041 DS    CL8                                                      05970000
         ORG   FPLTYPE+24                                               05971000
FPLACB   DS    CL24                                                     05972000
         ORG   FPLACB                                                   05973000
@NM00042 DS    CL16                                                     05974000
@NM00043 DS    CL8                                                      05975000
         ORG   FPLACB+24                                                05976000
FPLCATTR DS    CL24                                                     05977000
         ORG   FPLCATTR                                                 05978000
@NM00044 DS    CL16                                                     05979000
@NM00045 DS    CL8                                                      05980000
         ORG   FPLCATTR+24                                              05981000
CPLSTOR  DS    CL40                                                     05982000
         ORG   CPLSTOR                                                  05983000
@NM00046 DS    CL28                                                     05984000
@NM00047 DS    CL12                                                     05985000
         ORG   CPLSTOR+40                                               05986000
ALLLIST  DS    CL31                                                     05987000
CIRLIST  DS    CL32                                                     05988000
CATNAME  DS    CL44                                                     05989000
         DS    CL1                                                      05990000
ENTRIES  DS    CL49                                                     05991000
         ORG   ENTRIES                                                  05992000
ENTRYLEN DS    FL2                                                      05993000
@NM00049 DS    CL2                                                      05994000
ATYPE    DS    CL1                                                      05995000
ENTRYVAL DS    CL44                                                     05996000
         ORG   ENTRIES+49                                               05997000
         DS    CL3                                                      05998000
ULP      DS    CL12                                                     05999000
         ORG   ULP                                                      06000000
ULPNUM   DS    FL2                                                      06001000
ULPLEN   DS    FL2                                                      06002000
ULPVAL   DS    CL8                                                      06003000
         ORG   ULP+12                                                   06004000
VLP      DS    CL10                                                     06005000
         ORG   VLP                                                      06006000
VLPNUM   DS    FL2                                                      06007000
VLPLEN   DS    FL2                                                      06008000
VLPVAL   DS    CL6                                                      06009000
         ORG   VLP+10                                                   06010000
         DS    CL2                                                      06011000
QUALLIST DS    CL12                                                     06012000
         ORG   QUALLIST                                                 06013000
QUALADDR DS    AL4                                                      06014000
QUALCAT  DS    AL4                                                      06015000
QUALPAS  DS    AL4                                                      06016000
         ORG   QUALLIST+12                                              06017000
PRINTTAB DS    CL20                                                     06018000
SERNAME  DS    CL44                                                     06019000
ERRORTAB DS    CL32                                                     06020000
WORKAREA DS    CL544                                                    06021000
         ORG   WORKAREA                                                 06022000
@NM00052 DS    FL2                                                      06023000
@NM00053 DS    FL2                                                      06024000
@NM00054 DS    CL45                                                     06025000
         ORG   @NM00054+0                                               06026000
@NM00055 DS    CL1                                                      06027000
@NM00056 DS    CL44                                                     06028000
         ORG   WORKAREA+544                                             06029000
LCPLSAVE DS    CL40                                                     06030000
DCPLSAVE DS    CL28                                                     06031000
PDSLIST  DS    BL48                                                     06032000
LOCCPL   DS    CL32                                                     06033000
CATAREA  DS    CL44                                                     06034000
LOCFPL   DS    CL24                                                     06035000
LOCWKA   DS    CL49                                                     06036000
         ORG   LOCWKA                                                   06037000
LOCLN    DS    FL2                                                      06038000
LOCRN    DS    FL2                                                      06039000
LOCWORK  DS    CL45                                                     06040000
         ORG   LOCWKA+49                                                06041000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06042000
@ENDDATD EQU   *                                                        06043000
IDCDL01  CSECT                                                          06044000
         DS    0F                                                       06045000
@SIZDATD DC    AL1(0)                                                   06046000
         DC    AL3(@ENDDATD-@DATD)                                      06047000
         DS    0D                                                       06048000
@CC01054 DC    C'SYSALLDA'                                              06049000
@CC00940 DC    C'DLBG'                                                  06050000
@CC00980 DC    C'DLLC'                                                  06051000
@CC00983 DC    C'DLLB'                                                  06052000
@CC00984 DC    C'DLLA'                                                  06053000
@CC00990 DC    C'DLPC'                                                  06054000
@CC01000 DC    C'DLBC'                                                  06055000
@CC01011 DC    C'DLCT'                                                  06056000
@CC01014 DC    C'DLDB'                                                  06057000
@CC01015 DC    C'DLDA'                                                  06058000
@CC01036 DC    C'DLMD'                                                  06059000
@CC01045 DC    C'DLMS'                                                  06060000
@CC01053 DC    C'DLAL'                                                  06061000
@CC01068 DC    C'DLAC'                                                  06062000
@CC01069 DC    C'DLLY'                                                  06063000
@CC01072 DC    C'DLLZ'                                                  06064000
@CC00888 DC    C'DL0'                                                   06065000
@CC00892 DC    C'UV0'                                                   06066000
ALL      DC    CL3'ALL'                                                 06067000
FORMAT   DC    CL4'FORM'                                                06068000
HSECOND  DC    CL4'HSEC'                                                06069000
CLOCK    DC    CL4'KLOK'                                                06070000
SETZERO  DC    CL4'ZERO'                                                06071000
SETBLANK DC    CL4'BLNK'                                                06072000
NOSET    DC    CL4'NSET'                                                06073000
OVERRIDE DC    CL4'OVRD'                                                06074000
ACQUIRE  DC    CL8'ACQUIRE '                                            06075000
RELINQ   DC    CL8'RELINQ  '                                            06076000
MOUNT    DC    CL8'MOUNT   '                                            06077000
DEMOUNT  DC    CL8'DEMOUNT '                                            06078000
DEFINE   DC    CL8'DEFINE  '                                            06079000
MOVE     DC    CL8'MOVE    '                                            06080000
TRACEQ   DC    CL8'TRACEQ  '                                            06081000
COPYTABL DC    CL8'COPYTABL'                                            06082000
COPYCRTG DC    CL8'COPYCRTG'                                            06083000
COPYVOL  DC    CL8'COPYVOL '                                            06084000
VVIC     DC    CL8'VVIC    '                                            06085000
TUNE     DC    CL8'TUNE    '                                            06086000
NAMES    DC    CL4'NAME'                                                06087000
UNIT     DC    CL4'UNIT'                                                06088000
SHR      DC    CL4'SHR '                                                06089000
EXCL     DC    CL4'EXCL'                                                06090000
NOWAIT   DC    CL4'NWAI'                                                06091000
WAIT     DC    CL4'WAIT'                                                06092000
MODID    DC    CL4'DL01'                                                06093000
DLGPID   DC    CL4'DL00'                                                06094000
DLUGPFG1 DC    CL4'DL01'                                                06095000
ENTTYPE  DC    CL8'ENTYPE  '                                            06096000
ACBADDR  DC    CL8'CATACB'                                              06097000
CLUSATTR DC    CL8'CATTR'                                               06098000
BLANKS   DS    CL44                                                     06099000
         ORG   BLANKS                                                   06100000
@NM00048 DC    44X'40'                                                  06101000
         ORG   BLANKS+44                                                06102000
FIXAREA  DS    CL300                                                    06103000
         ORG   FIXAREA                                                  06104000
@NM00050 DC    150X'00'                                                 06105000
@NM00051 DC    150X'00'                                                 06106000
         ORG   FIXAREA+300                                              06107000
DLETEMEM DC    CL1'D'                                                   06108000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06109000
@01      EQU   01                                                       06110000
@02      EQU   02                                                       06111000
@03      EQU   03                                                       06112000
@04      EQU   04                                                       06113000
@05      EQU   05                                                       06114000
@06      EQU   06                                                       06115000
@07      EQU   07                                                       06116000
@08      EQU   08                                                       06117000
@09      EQU   09                                                       06118000
@10      EQU   10                                                       06119000
@11      EQU   11                                                       06120000
@12      EQU   12                                                       06121000
@13      EQU   13                                                       06122000
@14      EQU   14                                                       06123000
@15      EQU   15                                                       06124000
ACBSAVE  EQU   @07                                                      06125000
SAVCPLPT EQU   @06                                                      06126000
CURSIZE  EQU   @02                                                      06127000
J        EQU   @02                                                      06128000
ALLOINDX EQU   @03                                                      06129000
IX       EQU   @02                                                      06130000
I        EQU   @02                                                      06131000
CATRC    EQU   @02                                                      06132000
GENCNT   EQU   @04                                                      06133000
ENT      EQU   @05                                                      06134000
CIRPTR   EQU   @02                                                      06135000
IND1     EQU   @02                                                      06136000
ENTRYNO  EQU   @03                                                      06137000
ENTRYRC  EQU   @03                                                      06138000
CTGFLPTR EQU   @03                                                      06139000
OPNPTR   EQU   @02                                                      06140000
TESTRC   EQU   @02                                                      06141000
SETRC    EQU   @04                                                      06142000
RTNREG   EQU   @15                                                      06143000
REG15    EQU   @15                                                      06144000
REG0     EQU   @00                                                      06145000
REG1     EQU   @01                                                      06146000
REG10    EQU   @10                                                      06147000
REG11    EQU   @11                                                      06148000
REG12    EQU   @12                                                      06149000
REG13    EQU   @13                                                      06150000
REG14    EQU   @14                                                      06151000
REG2     EQU   @02                                                      06152000
REG3     EQU   @03                                                      06153000
REG4     EQU   @04                                                      06154000
REG5     EQU   @05                                                      06155000
REG6     EQU   @06                                                      06156000
REG7     EQU   @07                                                      06157000
REG8     EQU   @08                                                      06158000
REG9     EQU   @09                                                      06159000
IDCSAEP0 EQU   0                                                        06160000
IDCSAFS0 EQU   0                                                        06161000
IDCSAGP0 EQU   0                                                        06162000
IDCSAFP0 EQU   0                                                        06163000
IDCSACA0 EQU   0                                                        06164000
IDCSACR0 EQU   0                                                        06165000
IDCSAAL0 EQU   0                                                        06166000
IDCSADL0 EQU   0                                                        06167000
IDCSAQL0 EQU   0                                                        06168000
TRACE1   EQU   0                                                        06169000
OLDERID1 EQU   TRACE1                                                   06170000
TRACE2   EQU   0                                                        06171000
OLDERID2 EQU   TRACE2                                                   06172000
NEWID2   EQU   TRACE2+95                                                06173000
NEWERID2 EQU   5                                                        06174000
CIRAGL   EQU   0                                                        06175000
CIRTYPE  EQU   CIRAGL                                                   06176000
CIRTYP1Q EQU   CIRTYPE                                                  06177000
CIRHLN   EQU   CIRAGL+4                                                 06178000
CIRTLN   EQU   CIRAGL+6                                                 06179000
CIRHDR   EQU   CIRAGL+8                                                 06180000
CIRTLR   EQU   CIRAGL+12                                                06181000
CIRWKP   EQU   CIRAGL+16                                                06182000
CIRCAT   EQU   CIRAGL+20                                                06183000
CIRPWD   EQU   CIRAGL+24                                                06184000
CIRPID   EQU   CIRAGL+28                                                06185000
ALLAGL   EQU   0                                                        06186000
ALLDSN   EQU   ALLAGL                                                   06187000
ALLDDN   EQU   ALLAGL+4                                                 06188000
ALLULP   EQU   ALLAGL+12                                                06189000
ALLVLP   EQU   ALLAGL+16                                                06190000
ALLPWD   EQU   ALLAGL+20                                                06191000
ALLSTS   EQU   ALLAGL+24                                                06192000
ALLSTSOD EQU   ALLSTS                                                   06193000
ALLDSP   EQU   ALLAGL+25                                                06194000
ALLDSPKP EQU   ALLDSP                                                   06195000
ALLDSPDE EQU   ALLDSP                                                   06196000
ALLORG   EQU   ALLAGL+26                                                06197000
ALLOPT   EQU   ALLAGL+28                                                06198000
ALLOPTVL EQU   ALLOPT                                                   06199000
ALLOPTDS EQU   ALLOPT                                                   06200000
ALLOPTUN EQU   ALLOPT                                                   06201000
UNITABL  EQU   0                                                        06202000
UNITADR  EQU   UNITABL+4                                                06203000
@NM00010 EQU   UNITADR                                                  06204000
UNITSTAT EQU   UNITABL+6                                                06205000
IDCIOOP0 EQU   0                                                        06206000
IDCIOCL0 EQU   0                                                        06207000
IDCIOST0 EQU   0                                                        06208000
IOCSTR   EQU   0                                                        06209000
IOCDSO   EQU   IOCSTR+16                                                06210000
IOCRFM   EQU   IOCSTR+17                                                06211000
IOCMAC   EQU   IOCSTR+18                                                06212000
IOCMAC2  EQU   IOCSTR+19                                                06213000
IOCCHP   EQU   IOCSTR+20                                                06214000
IOCMSG   EQU   IOCSTR+21                                                06215000
IOCDSN   EQU   IOCSTR+32                                                06216000
IOCCBP   EQU   IOCSTR+36                                                06217000
IOCRBA   EQU   IOCSTR+40                                                06218000
IOCTTR   EQU   IOCRBA                                                   06219000
IOCMEM   EQU   IOCSTR+44                                                06220000
IOCNWM   EQU   IOCSTR+48                                                06221000
IOCREL   EQU   IOCSTR+60                                                06222000
OPNAGL   EQU   0                                                        06223000
OPNOPT   EQU   OPNAGL                                                   06224000
OPNOPTOT EQU   OPNOPT                                                   06225000
OPNOPTBK EQU   OPNOPT                                                   06226000
OPNRFM   EQU   OPNAGL+1                                                 06227000
OPNTYP   EQU   OPNAGL+2                                                 06228000
OPNMOD   EQU   OPNAGL+3                                                 06229000
OPNIOC   EQU   OPNAGL+4                                                 06230000
OPNDDN   EQU   OPNAGL+8                                                 06231000
OPNPWA   EQU   OPNAGL+12                                                06232000
OPNDSN   EQU   OPNAGL+16                                                06233000
OPNDEV   EQU   OPNAGL+24                                                06234000
OPNDSO   EQU   OPNAGL+41                                                06235000
OPNDSOPO EQU   OPNDSO                                                   06236000
OPNOPT2  EQU   OPNAGL+42                                                06237000
IOINFOPT EQU   0                                                        06238000
UVOLLIST EQU   0                                                        06239000
UVOLENT  EQU   UVOLLIST+2                                               06240000
AMSTP011 EQU   0                                                        06241000
IDCTPER0 EQU   0                                                        06242000
DARGLIST EQU   0                                                        06243000
DARGDBP  EQU   DARGLIST                                                 06244000
DARGSTID EQU   DARGLIST+8                                               06245000
DARGSMOD EQU   DARGSTID                                                 06246000
DARGSENT EQU   DARGSTID+3                                               06247000
DARGILP  EQU   DARGLIST+12                                              06248000
DARGFLGS EQU   DARGLIST+19                                              06249000
DARGARY  EQU   DARGLIST+20                                              06250000
DARGINS  EQU   DARGARY                                                  06251000
DARGINL  EQU   DARGARY+2                                                06252000
FMTLIST  EQU   0                                                        06253000
FMTFLGS  EQU   FMTLIST                                                  06254000
FMTSPF   EQU   FMTLIST+2                                                06255000
FMTRFNO  EQU   FMTSPF                                                   06256000
FMTILEN  EQU   FMTRFNO                                                  06257000
FMTIOFF  EQU   FMTLIST+4                                                06258000
FMTTRBC  EQU   FMTIOFF                                                  06259000
FMTSTO   EQU   FMTTRBC                                                  06260000
FMTOCOL  EQU   FMTLIST+6                                                06261000
FMTCNVF  EQU   FMTLIST+10                                               06262000
ERCNVTAB EQU   0                                                        06263000
ERTYPE   EQU   ERCNVTAB                                                 06264000
ERCATLG  EQU   ERTYPE                                                   06265000
EROPER   EQU   ERCNVTAB+1                                               06266000
ERCATLC  EQU   EROPER                                                   06267000
ERCATDL  EQU   EROPER                                                   06268000
EROSOPER EQU   ERCNVTAB+2                                               06269000
ERDSNM   EQU   ERCNVTAB+12                                              06270000
ERCATRC  EQU   ERCNVTAB+16                                              06271000
ERCPLPT  EQU   ERCNVTAB+20                                              06272000
IDCDB010 EQU   0                                                        06273000
DMPITM   EQU   0                                                        06274000
DMPARY   EQU   0                                                        06275000
NTRY     EQU   0                                                        06276000
NTRYCNT  EQU   NTRY                                                     06277000
@NM00032 EQU   NTRY+2                                                   06278000
NTRYPLN  EQU   @NM00032                                                 06279000
NTRYPAS  EQU   @NM00032+1                                               06280000
NTRYPOS  EQU   @NM00032+9                                               06281000
NTRYFLG  EQU   @NM00032+10                                              06282000
NTRYFUQ  EQU   NTRYFLG                                                  06283000
NTRYMLN  EQU   @NM00032+11                                              06284000
NTRYMEM  EQU   @NM00032+12                                              06285000
NTRYLEN  EQU   @NM00032+20                                              06286000
NTRYVAL  EQU   @NM00032+21                                              06287000
CAT      EQU   0                                                        06288000
CATPLN   EQU   CAT                                                      06289000
CATPAS   EQU   CAT+1                                                    06290000
CATFLG   EQU   CAT+10                                                   06291000
CATLEN   EQU   CAT+20                                                   06292000
CATVAL   EQU   CAT+21                                                   06293000
CATDD    EQU   0                                                        06294000
INDD     EQU   0                                                        06295000
INDDVAL  EQU   INDD+1                                                   06296000
PURGE    EQU   0                                                        06297000
ERASE    EQU   0                                                        06298000
NOERA    EQU   0                                                        06299000
CLUST    EQU   0                                                        06300000
SPACE    EQU   0                                                        06301000
UCAT     EQU   0                                                        06302000
MCAT     EQU   0                                                        06303000
ALIEN    EQU   0                                                        06304000
SCR      EQU   0                                                        06305000
NSCR     EQU   0                                                        06306000
PGSPC    EQU   0                                                        06307000
GDG      EQU   0                                                        06308000
ALIAS    EQU   0                                                        06309000
AIX      EQU   0                                                        06310000
PATH     EQU   0                                                        06311000
FRC      EQU   0                                                        06312000
CTGPL    EQU   0                                                        06313000
CTGOPTN1 EQU   CTGPL                                                    06314000
CTGNAME  EQU   CTGOPTN1                                                 06315000
CTGCNAME EQU   CTGOPTN1                                                 06316000
CTGOPTN2 EQU   CTGPL+1                                                  06317000
CTGEXT   EQU   CTGOPTN2                                                 06318000
CTGNSVS  EQU   CTGEXT                                                   06319000
CTGERASE EQU   CTGOPTN2                                                 06320000
CTGSMF   EQU   CTGERASE                                                 06321000
CTGREL   EQU   CTGSMF                                                   06322000
CTGPURG  EQU   CTGOPTN2                                                 06323000
CTGVMNT  EQU   CTGPURG                                                  06324000
CTGRCATN EQU   CTGVMNT                                                  06325000
CTGOVRID EQU   CTGOPTN2                                                 06326000
CTGSCR   EQU   CTGOPTN2                                                 06327000
CTGOPTN3 EQU   CTGPL+2                                                  06328000
CTGFUNC  EQU   CTGOPTN3                                                 06329000
CTGNUM   EQU   CTGOPTN3                                                 06330000
CTGAM0   EQU   CTGOPTN3                                                 06331000
CTGOPTN4 EQU   CTGPL+3                                                  06332000
CTGENT   EQU   CTGPL+4                                                  06333000
CTGCAT   EQU   CTGPL+8                                                  06334000
CTGWKA   EQU   CTGPL+12                                                 06335000
CTGDSORG EQU   CTGPL+16                                                 06336000
CTGOPTNS EQU   CTGDSORG                                                 06337000
CTGTYPE  EQU   CTGPL+18                                                 06338000
CTGNOFLD EQU   CTGPL+19                                                 06339000
CTGDDNM  EQU   CTGPL+20                                                 06340000
CTGNEWNM EQU   CTGDDNM                                                  06341000
CTGFBFLG EQU   CTGNEWNM+2                                               06342000
CTGJSCB  EQU   CTGPL+24                                                 06343000
CTGPSWD  EQU   CTGJSCB                                                  06344000
CTGFIELD EQU   CTGPL+28                                                 06345000
CTGFL    EQU   0                                                        06346000
CTGFLDNO EQU   CTGFL                                                    06347000
CTGFLDRE EQU   CTGFL+3                                                  06348000
CTGFLDNM EQU   CTGFL+8                                                  06349000
CTGFLDAT EQU   CTGFL+16                                                 06350000
CTGFLNG  EQU   CTGFLDAT                                                 06351000
CTGFLPT  EQU   CTGFLDAT+4                                               06352000
LOCACBPT EQU   0                                                        06353000
LOCCATTR EQU   0                                                        06354000
GENLIST  EQU   0                                                        06355000
GENNUM   EQU   GENLIST                                                  06356000
GENENTRY EQU   GENLIST+4                                                06357000
ENTTYP   EQU   GENENTRY                                                 06358000
ENTVAL   EQU   GENENTRY+1                                               06359000
DSNAME   EQU   0                                                        06360000
VOLSER   EQU   0                                                        06361000
WORKSTR  EQU   0                                                        06362000
AREALN   EQU   WORKSTR                                                  06363000
RETURNLN EQU   WORKSTR+2                                                06364000
ENTLIST  EQU   WORKSTR+4                                                06365000
ENTITEM  EQU   ENTLIST                                                  06366000
ENTRYTYP EQU   ENTITEM                                                  06367000
ENTRYNM  EQU   ENTITEM+1                                                06368000
TYPEAREA EQU   0                                                        06369000
AMSTP041 EQU   0                                                        06370000
AMSTP042 EQU   0                                                        06371000
AMSTP043 EQU   0                                                        06372000
AMSTP044 EQU   0                                                        06373000
CATLG    EQU   0                                                        06374000
DMPTRM   EQU   0                                                        06375000
IDCIOCO0 EQU   0                                                        06376000
IDCIOGT0 EQU   0                                                        06377000
IDCIOIT0 EQU   0                                                        06378000
IDCIOPO0 EQU   0                                                        06379000
IDCIOPT0 EQU   0                                                        06380000
IDCIOSI0 EQU   0                                                        06381000
IDCIOTM0 EQU   0                                                        06382000
IDCIOVY0 EQU   0                                                        06383000
IDCIO050 EQU   0                                                        06384000
IDCSACL0 EQU   0                                                        06385000
IDCSADE0 EQU   0                                                        06386000
IDCSADQ0 EQU   0                                                        06387000
IDCSAGS0 EQU   0                                                        06388000
IDCSAID0 EQU   0                                                        06389000
IDCSALC0 EQU   0                                                        06390000
IDCSALD0 EQU   0                                                        06391000
IDCSALK0 EQU   0                                                        06392000
IDCSANQ0 EQU   0                                                        06393000
IDCSAPR0 EQU   0                                                        06394000
IDCSAPT0 EQU   0                                                        06395000
IDCSARC0 EQU   0                                                        06396000
IDCSARV0 EQU   0                                                        06397000
IDCSASC0 EQU   0                                                        06398000
IDCSASI0 EQU   0                                                        06399000
IDCSASN0 EQU   0                                                        06400000
IDCSASS0 EQU   0                                                        06401000
IDCSAST0 EQU   0                                                        06402000
IDCSATI0 EQU   0                                                        06403000
IDCSAUC0 EQU   0                                                        06404000
IDCSAWO0 EQU   0                                                        06405000
IDCSA060 EQU   0                                                        06406000
IDCST010 EQU   0                                                        06407000
LISTTEST EQU   0                                                        06408000
NEWERID1 EQU   5                                                        06409000
NOFRC    EQU   0                                                        06410000
NOPUR    EQU   0                                                        06411000
GDTTBL   EQU   0                                                        06412000
GDTTR1   EQU   GDTTBL+8                                                 06413000
GDTTR2   EQU   GDTTBL+12                                                06414000
GDTDBG   EQU   GDTTBL+40                                                06415000
GDTSTC   EQU   GDTTBL+44                                                06416000
GDTPRT   EQU   GDTTBL+48                                                06417000
GDTESS   EQU   GDTTBL+52                                                06418000
GDTESA   EQU   GDTTBL+56                                                06419000
GDTRST   EQU   GDTTBL+60                                                06420000
GDTRES   EQU   GDTTBL+64                                                06421000
GDTCAL   EQU   GDTTBL+68                                                06422000
GDTGSP   EQU   GDTTBL+72                                                06423000
GDTFSP   EQU   GDTTBL+76                                                06424000
GDTGPL   EQU   GDTTBL+80                                                06425000
GDTFPL   EQU   GDTTBL+84                                                06426000
GDTLOD   EQU   GDTTBL+88                                                06427000
GDTDEL   EQU   GDTTBL+92                                                06428000
GDTPRL   EQU   GDTTBL+96                                                06429000
GDTEPL   EQU   GDTTBL+100                                               06430000
GDTTIM   EQU   GDTTBL+104                                               06431000
GDTIIO   EQU   GDTTBL+108                                               06432000
GDTTIO   EQU   GDTTBL+112                                               06433000
GDTOPN   EQU   GDTTBL+124                                               06434000
GDTCLS   EQU   GDTTBL+128                                               06435000
GDTGET   EQU   GDTTBL+132                                               06436000
GDTPUT   EQU   GDTTBL+136                                               06437000
GDTPOS   EQU   GDTTBL+140                                               06438000
GDTCPY   EQU   GDTTBL+144                                               06439000
GDTCAT   EQU   GDTTBL+148                                               06440000
GDTSNP   EQU   GDTTBL+164                                               06441000
GDTVFY   EQU   GDTTBL+172                                               06442000
GDTECT   EQU   GDTTBL+188                                               06443000
GDTUID   EQU   GDTTBL+192                                               06444000
GDTPMT   EQU   GDTTBL+196                                               06445000
GDTCIR   EQU   GDTTBL+200                                               06446000
GDTLNK   EQU   GDTTBL+204                                               06447000
GDTALC   EQU   GDTTBL+208                                               06448000
GDTDLC   EQU   GDTTBL+212                                               06449000
GDTQAL   EQU   GDTTBL+216                                               06450000
GDTSTW   EQU   GDTTBL+220                                               06451000
GDTSSC   EQU   GDTTBL+224                                               06452000
GDTENQ   EQU   GDTTBL+228                                               06453000
GDTRSV   EQU   GDTTBL+232                                               06454000
GDTDEQ   EQU   GDTTBL+236                                               06455000
GDTSFO   EQU   GDTTBL+240                                               06456000
GDTWTO   EQU   GDTTBL+244                                               06457000
GDTSCR   EQU   GDTTBL+248                                               06458000
GDTUNT   EQU   GDTTBL+252                                               06459000
GDTRCT   EQU   GDTTBL+256                                               06460000
GDTIFO   EQU   GDTTBL+260                                               06461000
GDTEXP   EQU   GDTTBL+264                                               06462000
GDTSTA   EQU   GDTTBL+268                                               06463000
GDTERR   EQU   GDTTBL+272                                               06464000
GDTUNC   EQU   GDTTBL+276                                               06465000
GDTLOC   EQU   GDTTBL+280                                               06466000
FDTTBL   EQU   0                                                        06467000
FDTPTR   EQU   FDTTBL+8                                                 06468000
LASTCOND EQU   0                                                        06469000
ENTID    EQU   0                                                        06470000
LTYPE    EQU   0                                                        06471000
ETYPE    EQU   0                                                        06472000
ENTRYID  EQU   0                                                        06473000
TYPE     EQU   0                                                        06474000
MMNOENT  EQU   0                                                        06475000
ALDSNPT  EQU   0                                                        06476000
ALVLSPT  EQU   0                                                        06477000
@NM00037 EQU   CTGDDNM                                                  06478000
CTGPROB  EQU   @NM00037                                                 06479000
CTGREASN EQU   CTGPROB+2                                                06480000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06481000
CTGREAS2 EQU   CTGREASN+1                                               06482000
CTGREAS1 EQU   CTGREASN                                                 06483000
CTGMODID EQU   CTGPROB                                                  06484000
FDTVERB  EQU   FDTTBL                                                   06485000
GDTPSB   EQU   GDTTBL+184                                               06486000
GDTUPT   EQU   GDTTBL+180                                               06487000
GDTCMB   EQU   GDTTBL+176                                               06488000
GDTSPR   EQU   GDTTBL+168                                               06489000
@NM00001 EQU   GDTTBL+160                                               06490000
GDTABH   EQU   GDTTBL+156                                               06491000
GDTABT   EQU   GDTTBL+152                                               06492000
GDTTOH   EQU   GDTTBL+120                                               06493000
GDTRIP   EQU   GDTTBL+116                                               06494000
GDTIOH   EQU   GDTTBL+36                                                06495000
GDTSAH   EQU   GDTTBL+32                                                06496000
GDTTPH   EQU   GDTTBL+28                                                06497000
GDTRIH   EQU   GDTTBL+24                                                06498000
GDTSTH   EQU   GDTTBL+20                                                06499000
GDTDBH   EQU   GDTTBL+16                                                06500000
GDTPRM   EQU   GDTTBL+4                                                 06501000
GDTHDR   EQU   GDTTBL                                                   06502000
PAGESPC  EQU   LOCCATTR                                                 06503000
@NM00039 EQU   LOCCATTR                                                 06504000
CTGFLCHN EQU   CTGFL+12                                                 06505000
CTGFLDWA EQU   CTGFL+4                                                  06506000
CTGFLDTS EQU   CTGFLDRE                                                 06507000
@NM00038 EQU   CTGFLDRE                                                 06508000
CTGFLDGC EQU   CTGFL+2                                                  06509000
CTGFLDCD EQU   CTGFL+1                                                  06510000
@NM00036 EQU   CTGFBFLG                                                 06511000
CTGNGDSN EQU   CTGFBFLG                                                 06512000
CTGGDGB  EQU   CTGFBFLG                                                 06513000
CTGKEEP  EQU   CTGFBFLG                                                 06514000
CTGPAR   EQU   CTGFBFLG                                                 06515000
CTGFDBK  EQU   CTGNEWNM                                                 06516000
@NM00035 EQU   CTGDSORG                                                 06517000
CTGCVOL  EQU   CTGCAT                                                   06518000
CTGFVT   EQU   CTGENT                                                   06519000
@NM00034 EQU   CTGOPTN4                                                 06520000
CTGTIOT  EQU   CTGOPTN4                                                 06521000
CTGBYPMT EQU   CTGOPTN4                                                 06522000
CTGCOIN  EQU   CTGOPTN4                                                 06523000
CTGNPROF EQU   CTGOPTN4                                                 06524000
CTGDOCAT EQU   CTGOPTN4                                                 06525000
CTGLBASE EQU   CTGOPTN4                                                 06526000
CTGSRH   EQU   CTGOPTN3                                                 06527000
CTGGDGL  EQU   CTGOPTN3                                                 06528000
CTGSUPLT EQU   CTGOPTN3                                                 06529000
@NM00033 EQU   CTGOPTN2                                                 06530000
CTGDISC  EQU   CTGOPTN2                                                 06531000
CTGGTNXT EQU   CTGOPTN2                                                 06532000
CTGSWAP  EQU   CTGRCATN                                                 06533000
CTGGTALL EQU   CTGREL                                                   06534000
CTGGENLD EQU   CTGOPTN1                                                 06535000
CTGREAD  EQU   CTGOPTN1                                                 06536000
CTGUPD   EQU   CTGOPTN1                                                 06537000
CTGCI    EQU   CTGOPTN1                                                 06538000
CTGMAST  EQU   CTGOPTN1                                                 06539000
CTGBYPSS EQU   CTGOPTN1                                                 06540000
INDDLEN  EQU   INDD                                                     06541000
CATDDVAL EQU   CATDD+1                                                  06542000
CATDDLEN EQU   CATDD                                                    06543000
CATMEM   EQU   CAT+12                                                   06544000
CATMLN   EQU   CAT+11                                                   06545000
CATFUQ   EQU   CATFLG                                                   06546000
CATPOS   EQU   CAT+9                                                    06547000
@NM00031 EQU   DMPARY+15                                                06548000
DMPARYTP EQU   DMPARY+14                                                06549000
DMPARYEX EQU   DMPARY+12                                                06550000
DMPARYIC EQU   DMPARY+10                                                06551000
DMPARYSZ EQU   DMPARY+8                                                 06552000
DMPARYNM EQU   DMPARY                                                   06553000
@NM00030 EQU   DMPITM+15                                                06554000
DMPITMTP EQU   DMPITM+14                                                06555000
DMPITMLN EQU   DMPITM+12                                                06556000
DMPITMPT EQU   DMPITM+8                                                 06557000
DMPITMNM EQU   DMPITM                                                   06558000
@NM00029 EQU   ERCNVTAB+24                                              06559000
ERDARBPT EQU   ERCPLPT                                                  06560000
ERDYNRC  EQU   ERCATRC                                                  06561000
@NM00028 EQU   ERCNVTAB+4                                               06562000
@NM00027 EQU   ERCNVTAB+3                                               06563000
@NM00026 EQU   EROSOPER                                                 06564000
EROSUCDX EQU   EROSOPER                                                 06565000
EROSCATL EQU   EROSOPER                                                 06566000
@NM00025 EQU   EROPER                                                   06567000
ERCATAL  EQU   EROPER                                                   06568000
ERCATDE  EQU   EROPER                                                   06569000
@NM00024 EQU   ERTYPE                                                   06570000
ERDYNAL  EQU   ERTYPE                                                   06571000
EROSCAT  EQU   ERTYPE                                                   06572000
@NM00023 EQU   FMTCNVF+1                                                06573000
FMTAR    EQU   FMTCNVF+1                                                06574000
FMTBS    EQU   FMTCNVF+1                                                06575000
FMTSS    EQU   FMTCNVF+1                                                06576000
FMTAL    EQU   FMTCNVF+1                                                06577000
FMTZS    EQU   FMTCNVF+1                                                06578000
@NM00022 EQU   FMTCNVF                                                  06579000
FMTPU    EQU   FMTCNVF                                                  06580000
FMTBD    EQU   FMTCNVF                                                  06581000
FMTBHD   EQU   FMTCNVF                                                  06582000
FMTBHA   EQU   FMTCNVF                                                  06583000
FMTBH    EQU   FMTCNVF                                                  06584000
FMTOLEN  EQU   FMTLIST+8                                                06585000
FMTRIO   EQU   FMTOCOL                                                  06586000
FMTSPT   EQU   FMTSTO                                                   06587000
FMTSTL   EQU   FMTILEN                                                  06588000
@NM00021 EQU   FMTFLGS+1                                                06589000
FMTSMSG  EQU   FMTFLGS+1                                                06590000
FMTHDF   EQU   FMTFLGS                                                  06591000
FMTDFF   EQU   FMTFLGS                                                  06592000
FMTSTF   EQU   FMTFLGS                                                  06593000
FMTREPF  EQU   FMTFLGS                                                  06594000
FMTBDF   EQU   FMTFLGS                                                  06595000
FMTIDF   EQU   FMTFLGS                                                  06596000
FMTSCF   EQU   FMTFLGS                                                  06597000
FMTEOLF  EQU   FMTFLGS                                                  06598000
DARGDTM  EQU   DARGARY+4                                                06599000
DARGPCT  EQU   DARGINL                                                  06600000
DARGREP  EQU   DARGINS                                                  06601000
@NM00020 EQU   DARGFLGS                                                 06602000
DARGFULL EQU   DARGFLGS                                                 06603000
DARGIND  EQU   DARGLIST+18                                              06604000
DARGRETL EQU   DARGLIST+16                                              06605000
DARGCNT  EQU   DARGLIST+14                                              06606000
DARGRETP EQU   DARGLIST+4                                               06607000
UVOLVOL  EQU   UVOLENT+4                                                06608000
UVOLDEV  EQU   UVOLENT                                                  06609000
UVOLCNT  EQU   UVOLLIST                                                 06610000
@NM00019 EQU   IOINFOPT                                                 06611000
IOINFLUB EQU   IOINFOPT                                                 06612000
IOINFTMS EQU   IOINFOPT                                                 06613000
IOINFSUP EQU   IOINFOPT                                                 06614000
IOINFDSN EQU   IOINFOPT                                                 06615000
IOINFVOL EQU   IOINFOPT                                                 06616000
IOINFDVT EQU   IOINFOPT                                                 06617000
OPNVOL   EQU   OPNAGL+44                                                06618000
OPNSTRNO EQU   OPNAGL+43                                                06619000
@NM00018 EQU   OPNOPT2                                                  06620000
OPNOPTJM EQU   OPNOPT2                                                  06621000
OPNOPTNM EQU   OPNOPT2                                                  06622000
OPNOPTAS EQU   OPNOPT2                                                  06623000
@NM00017 EQU   OPNDSO                                                   06624000
OPNDSOIS EQU   OPNDSO                                                   06625000
OPNDSOPS EQU   OPNDSO                                                   06626000
OPNDSOAM EQU   OPNDSO                                                   06627000
OPNKYL   EQU   OPNAGL+40                                                06628000
OPNBLK   EQU   OPNAGL+36                                                06629000
OPNREC   EQU   OPNAGL+32                                                06630000
OPNDEVIX EQU   OPNDEV+4                                                 06631000
OPNDEVDT EQU   OPNDEV                                                   06632000
OPNCBP   EQU   OPNAGL+20                                                06633000
OPNMODRP EQU   OPNMOD                                                   06634000
OPNMODUB EQU   OPNMOD                                                   06635000
OPNMODRS EQU   OPNMOD                                                   06636000
OPNMODAX EQU   OPNMOD                                                   06637000
OPNMODRR EQU   OPNMOD                                                   06638000
OPNMODRC EQU   OPNMOD                                                   06639000
OPNMODAC EQU   OPNMOD                                                   06640000
OPNMODPD EQU   OPNMOD                                                   06641000
OPNTYPSY EQU   OPNTYP                                                   06642000
OPNTYPRV EQU   OPNTYP                                                   06643000
OPNTYPEX EQU   OPNTYP                                                   06644000
OPNTYPRA EQU   OPNTYP                                                   06645000
OPNTYPXM EQU   OPNTYP                                                   06646000
OPNTYPCI EQU   OPNTYP                                                   06647000
OPNTYPSO EQU   OPNTYP                                                   06648000
OPNTYPSI EQU   OPNTYP                                                   06649000
@NM00016 EQU   OPNRFM                                                   06650000
OPNRFMBK EQU   OPNRFM                                                   06651000
OPNRFMSF EQU   OPNRFM                                                   06652000
OPNRFMUN EQU   OPNRFM                                                   06653000
OPNRFMVR EQU   OPNRFM                                                   06654000
OPNRFMFX EQU   OPNRFM                                                   06655000
OPNOPTSK EQU   OPNOPT                                                   06656000
OPNOPTDR EQU   OPNOPT                                                   06657000
OPNOPTCR EQU   OPNOPT                                                   06658000
OPNOPTKS EQU   OPNOPT                                                   06659000
OPNOPTUP EQU   OPNOPT                                                   06660000
OPNOPTIN EQU   OPNOPT                                                   06661000
IOCEXT   EQU   IOCSTR+64                                                06662000
IOCTSML  EQU   IOCREL+2                                                 06663000
IOCTPML  EQU   IOCREL                                                   06664000
IOCWORK  EQU   IOCSTR+56                                                06665000
IOCRRN   EQU   IOCSTR+52                                                06666000
IOCPNM   EQU   IOCNWM+2                                                 06667000
IOCPTL   EQU   IOCNWM                                                   06668000
IOCKYA   EQU   IOCMEM                                                   06669000
IOCVRC   EQU   IOCTTR                                                   06670000
IOCHURBA EQU   IOCSTR+28                                                06671000
IOCVOLSR EQU   IOCSTR+22                                                06672000
@NM00015 EQU   IOCMSG                                                   06673000
IOCMSGSM EQU   IOCMSG                                                   06674000
IOCMSGAE EQU   IOCMSG                                                   06675000
IOCMSGCE EQU   IOCMSG                                                   06676000
IOCMSGOE EQU   IOCMSG                                                   06677000
IOCMSGOP EQU   IOCMSG                                                   06678000
IOCCHPKG EQU   IOCMSG                                                   06679000
IOCCHPKE EQU   IOCMSG                                                   06680000
IOCCHPNU EQU   IOCCHP                                                   06681000
IOCCHPUP EQU   IOCCHP                                                   06682000
IOCCHPBK EQU   IOCCHP                                                   06683000
IOCCHPCR EQU   IOCCHP                                                   06684000
IOCCHPKS EQU   IOCCHP                                                   06685000
IOCCHPSK EQU   IOCCHP                                                   06686000
IOCCHPDR EQU   IOCCHP                                                   06687000
IOCCHPSQ EQU   IOCCHP                                                   06688000
IOCMACNT EQU   IOCMAC2                                                  06689000
IOCMACER EQU   IOCMAC2                                                  06690000
IOCMACPA EQU   IOCMAC2                                                  06691000
IOCMACEN EQU   IOCMAC2                                                  06692000
IOCMACCP EQU   IOCMAC2                                                  06693000
IOCMACRR EQU   IOCMAC2                                                  06694000
IOCMACAS EQU   IOCMAC2                                                  06695000
IOCMACSK EQU   IOCMAC2                                                  06696000
@NM00014 EQU   IOCMAC                                                   06697000
IOCMACCC EQU   IOCMAC                                                   06698000
IOCMACDR EQU   IOCMAC                                                   06699000
IOCMACBK EQU   IOCMAC                                                   06700000
IOCMACCR EQU   IOCMAC                                                   06701000
IOCMACUP EQU   IOCMAC                                                   06702000
IOCMACOT EQU   IOCMAC                                                   06703000
IOCMACIN EQU   IOCMAC                                                   06704000
@NM00013 EQU   IOCRFM                                                   06705000
IOCRFMBK EQU   IOCRFM                                                   06706000
IOCRFMSF EQU   IOCRFM                                                   06707000
IOCRFMUN EQU   IOCRFM                                                   06708000
IOCRFMVR EQU   IOCRFM                                                   06709000
IOCRFMFX EQU   IOCRFM                                                   06710000
@NM00012 EQU   IOCDSO                                                   06711000
IOCDSOPO EQU   IOCDSO                                                   06712000
IOCDSOIS EQU   IOCDSO                                                   06713000
IOCDSOPS EQU   IOCDSO                                                   06714000
IOCDSOAM EQU   IOCDSO                                                   06715000
IOCRKP   EQU   IOCSTR+13                                                06716000
IOCKYL   EQU   IOCSTR+12                                                06717000
IOCTRN   EQU   IOCSTR+8                                                 06718000
IOCDLN   EQU   IOCSTR+4                                                 06719000
IOCDAD   EQU   IOCSTR                                                   06720000
UNITVTOC EQU   UNITABL+7                                                06721000
@NM00011 EQU   UNITSTAT                                                 06722000
UNITUSHR EQU   UNITSTAT                                                 06723000
UNITXSHR EQU   UNITSTAT                                                 06724000
UNITISHR EQU   UNITSTAT                                                 06725000
UNITUA   EQU   @NM00010+1                                               06726000
UNITCHA  EQU   @NM00010                                                 06727000
UNITUCB  EQU   UNITABL                                                  06728000
ALLUNCNT EQU   ALLAGL+30                                                06729000
ALLVLCNT EQU   ALLAGL+29                                                06730000
@NM00009 EQU   ALLOPT                                                   06731000
ALLOPTPV EQU   ALLOPT                                                   06732000
@NM00008 EQU   ALLORG+1                                                 06733000
ALLORGVS EQU   ALLORG+1                                                 06734000
@NM00007 EQU   ALLORG+1                                                 06735000
ALLORGGS EQU   ALLORG+1                                                 06736000
ALLORGUN EQU   ALLORG                                                   06737000
ALLORGPO EQU   ALLORG                                                   06738000
ALLORGMQ EQU   ALLORG                                                   06739000
ALLORGCQ EQU   ALLORG                                                   06740000
ALLORGCX EQU   ALLORG                                                   06741000
ALLORGDA EQU   ALLORG                                                   06742000
ALLORGPS EQU   ALLORG                                                   06743000
ALLORGIS EQU   ALLORG                                                   06744000
ALLDSPUN EQU   ALLDSP                                                   06745000
ALLDSPCG EQU   ALLDSP                                                   06746000
@NM00006 EQU   ALLDSP                                                   06747000
ALLSTSMD EQU   ALLSTS                                                   06748000
ALLSTSNW EQU   ALLSTS                                                   06749000
ALLSTSSR EQU   ALLSTS                                                   06750000
@NM00005 EQU   ALLSTS                                                   06751000
@NM00004 EQU   CIRAGL+1                                                 06752000
@NM00003 EQU   CIRTYPE                                                  06753000
CIRTYPAQ EQU   CIRTYPE                                                  06754000
NEWID1   EQU   TRACE1+95                                                06755000
CALLID   EQU   OLDERID1+90                                              06756000
@NM00002 EQU   OLDERID1                                                 06757000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06758000
@RC00340 EQU   @RC00314                                                 06759000
@RC00382 EQU   @RC00381                                                 06760000
@RC00376 EQU   @EL00002                                                 06761000
@RF00491 EQU   @RC00488                                                 06762000
@RF00498 EQU   @RC00475                                                 06763000
@RF00551 EQU   @RC00548                                                 06764000
@RF00672 EQU   @RC00669                                                 06765000
@RC01066 EQU   @RC01051                                                 06766000
@PB00010 EQU   @EL00001                                                 06767000
@PB00009 EQU   @PB00010                                                 06768000
@PB00008 EQU   @PB00009                                                 06769000
@PB00007 EQU   @PB00008                                                 06770000
@PB00006 EQU   @PB00007                                                 06771000
@PB00005 EQU   @PB00006                                                 06772000
@PB00004 EQU   @PB00005                                                 06773000
@PB00003 EQU   @PB00004                                                 06774000
@PB00002 EQU   @PB00003                                                 06775000
@ENDDATA EQU   *                                                        06776000
         END   IDCDL01,(C'PLS2150',0701,78251)                          06777000
