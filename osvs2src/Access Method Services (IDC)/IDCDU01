         TITLE '************ IDCDU01 - DUMPMSS FSR ************        *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCDU01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCDU01   78.010'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0395 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* ISSUE UDUMP DIAGNOSTIC REGION DUMP                    @Z40LB40*/ 00041000
*   /*                                                               */ 00042000
*   /*****************************************************************/ 00043000
*                                                                  0395 00044000
*   OLDERID2=NEWERID2;                                             0395 00045000
         L     @15,@PC00001                                        0395 00046000
         L     @14,GDTTR2(,@15)                                    0395 00047000
         MVC   @TS00001(95),NEWERID2(@14)                          0395 00048000
         MVC   OLDERID2(95,@14),@TS00001                           0395 00049000
*   NEWID2='DUAA';                  /*                       @Z40LB40*/ 00050000
         MVC   NEWID2(4,@14),@CC01451                              0396 00051000
*   IF GDTDBG=NULLPTR THEN                                         0397 00052000
         L     @15,GDTDBG(,@15)                                    0397 00053000
         LTR   @15,@15                                             0397 00054000
         BZ    @RT00397                                            0397 00055000
*     ;                                                            0398 00056000
*   ELSE                                                           0399 00057000
*     CALL IDCDB010(GDTTBL,'DUAA'); /*                       @Z40LB40*/ 00058000
*                                                                  0399 00059000
         L     @15,@PC00001                                        0399 00060000
         ST    @15,@AL00001                                        0399 00061000
         LA    @14,@CC01451                                        0399 00062000
         ST    @14,@AL00001+4                                      0399 00063000
         MVI   @AL00001+4,X'80'                                    0399 00064000
         L     @15,GDTDBG(,@15)                                    0399 00065000
         LA    @01,@AL00001                                        0399 00066000
         BALR  @14,@15                                             0399 00067000
*   /*****************************************************************/ 00068000
*   /*                                                               */ 00069000
*   /* DUMPMSS (LEVEL 1)                                     @Z40LB40*/ 00070000
*   /* THIS IS THE MAIN PROCEDURE FOR DUMPMSS FSR. IT        @Z40LB40*/ 00071000
*   /* OPENS AND CLOSES THE OUTPUT DATASET, OBTAINS AND      @Z40LB40*/ 00072000
*   /* FREES DYNAMIC WORK STORAGE,CALL FUNCTIONS PROCEDURES  @Z40LB40*/ 00073000
*   /* AND TERMINATES THE PROCESSING. IT CALLS DUMPMSC,      @Z40LB40*/ 00074000
*   /* DUMPSA AND DUMPTAB TO PRINT THE DUMPS OF THE          @Z40LB40*/ 00075000
*   /* VARIOUS BOXES. THE FOLLOWING CODE                     @Z40LB40*/ 00076000
*   /* INITIALIZES PARM LISTS AND VARIABLES.                 @Z40LB40*/ 00077000
*   /*                                                               */ 00078000
*   /*****************************************************************/ 00079000
*                                                                  0400 00080000
*   OPNPTR=ADDR(OPENLIST);          /*                       @Z40LB40*/ 00081000
@RT00397 LA    OPNPTR,OPENLIST                                     0400 00082000
*   DDSTRU=ADDR(PRINTAB);           /*                       @Z40LB40*/ 00083000
         LA    @03,PRINTAB                                         0401 00084000
         ST    @03,DDSTRU                                          0401 00085000
*   OPNAGL=''B;                     /*                       @Z40LB40*/ 00086000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0402 00087000
*   FLAGS=''B;                      /*                       @Z40LB40*/ 00088000
         MVI   FLAGS,X'00'                                         0403 00089000
*   PRPTR=''B;                      /*                       @Z40LB40*/ 00090000
         SLR   @03,@03                                             0404 00091000
         ST    @03,PRPTR                                           0404 00092000
*   QUERYPTR=ADDR(PARMLST);         /*                       @Z40LB40*/ 00093000
*                                                                  0405 00094000
         LA    @03,PARMLST                                         0405 00095000
         ST    @03,QUERYPTR                                        0405 00096000
*   /*****************************************************************/ 00097000
*   /*                                                               */ 00098000
*   /* TEST IF USER SPECIFIED A DDNAME OR DSNAME TO BE       @Z40LB40*/ 00099000
*   /* USED AS THE OUTPUT FILE. IF YES, ISSUE THE UOPEN      @Z40LB40*/ 00100000
*   /* MACRO. IF NO, USE SYSPRINT AS THE DEFAULT.            @Z40LB40*/ 00101000
*   /*                                                               */ 00102000
*   /*****************************************************************/ 00103000
*                                                                  0406 00104000
*   IF ADDR(OFILE)^=NULLPTR|ADDR(ODS)^=NULLPTR THEN                0406 00105000
         SLR   @03,@03                                             0406 00106000
         L     @15,@PC00001+4                                      0406 00107000
         C     @03,FDTPTR+48(,@15)                                 0406 00108000
         BNE   @RT00406                                            0406 00109000
         C     @03,FDTPTR+52(,@15)                                 0406 00110000
         BE    @RF00406                                            0406 00111000
@RT00406 DS    0H                                                  0407 00112000
*     DO;                           /*                       @Z40LB40*/ 00113000
*       IF ADDR(ODS)^=NULLPTR THEN  /* IS ODS SPECIFIED      @Z40LB40*/ 00114000
         L     @03,@PC00001+4                                      0408 00115000
         L     @03,FDTPTR+52(,@03)                                 0408 00116000
         LTR   @03,@03                                             0408 00117000
         BZ    @RF00408                                            0408 00118000
*         OPNDSN=ADDR(ODSVAL);      /* YES,SETUP FOR DSN     @Z40LB40*/ 00119000
         LA    @03,ODSVAL(,@03)                                    0409 00120000
         ST    @03,OPNDSN(,OPNPTR)                                 0409 00121000
*       ELSE                        /* OFILE SPECIFIED       @Z40LB40*/ 00122000
*         OPNDDN=ADDR(OFILEVAL);    /* SETUP DDNAME          @Z40LB40*/ 00123000
         B     @RC00408                                            0410 00124000
@RF00408 L     @03,@PC00001+4                                      0410 00125000
         L     @03,FDTPTR+48(,@03)                                 0410 00126000
         LA    @03,OFILEVAL(,@03)                                  0410 00127000
         ST    @03,OPNDDN(,OPNPTR)                                 0410 00128000
*       OPNOPTOT=ON;                /*                       @Z40LB40*/ 00129000
@RC00408 OI    OPNOPTOT(OPNPTR),B'01000000'                        0411 00130000
*       OPNMODAC=ON;                /*                       @Z40LB40*/ 00131000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0412 00132000
*       OPNIOC=ADDR(IOCSPTR);       /*                       @Z40LB40*/ 00133000
*                                                                  0413 00134000
         LA    @15,IOCSPTR                                         0413 00135000
         ST    @15,OPNIOC(,OPNPTR)                                 0413 00136000
*       /*************************************************************/ 00137000
*       /*                                                           */ 00138000
*       /* ISSUE UOPEN MACRO                                 @Z40LB40*/ 00139000
*       /*                                                           */ 00140000
*       /*************************************************************/ 00141000
*                                                                  0414 00142000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Z40LB40*/ 00143000
         L     @15,@PC00001                                        0414 00144000
         ST    @15,@AL00001                                        0414 00145000
         ST    OPNPTR,@AL00001+4                                   0414 00146000
         MVI   @AL00001+4,X'80'                                    0414 00147000
         L     @15,GDTOPN(,@15)                                    0414 00148000
         LA    @01,@AL00001                                        0414 00149000
         BALR  @14,@15                                             0414 00150000
*       RESPECIFY                                                  0415 00151000
*         RTNREG RSTD;                                             0415 00152000
*       TESTRC=RTNREG;                                             0416 00153000
         LR    TESTRC,RTNREG                                       0416 00154000
*       RESPECIFY                                                  0417 00155000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 00156000
*       IF TESTRC=LASTCC00 THEN     /* IS OPEN OK            @Z40LB40*/ 00157000
         LTR   TESTRC,TESTRC                                       0418 00158000
         BNZ   @RF00418                                            0418 00159000
*         PRPTR=IOCSPTR;            /* YES,SAVE ADDRESS      @Z40LB40*/ 00160000
         L     @15,IOCSPTR                                         0419 00161000
         ST    @15,PRPTR                                           0419 00162000
*       ELSE                        /* NO                    @Z40LB40*/ 00163000
*         LASTCOND=LASTCC12;        /* SET FINAL RET.CODE    @Z40LB40*/ 00164000
         B     @RC00418                                            0420 00165000
@RF00418 L     @15,@PC00001+8                                      0420 00166000
         MVC   LASTCOND(2,@15),@CH00606                            0420 00167000
*     END;                          /*                       @Z40LB40*/ 00168000
*                                                                  0421 00169000
@RC00418 DS    0H                                                  0422 00170000
*   /*****************************************************************/ 00171000
*   /*                                                               */ 00172000
*   /* IF EVERYTHING OK SO FAR GET 68872 BYTES               @ZD00043*/ 00173000
*   /* OF STORAGE TO BE USED TO HOLD COPIES OF MSC OR SA     @Z40LB40*/ 00174000
*   /* STORAGE OR MSC TABLES RECORDS                         @Z40LB40*/ 00175000
*   /*                                                               */ 00176000
*   /*****************************************************************/ 00177000
*                                                                  0422 00178000
*   IF LASTCOND=LASTCC00 THEN       /* IS EVERYTHING OK      @Z40LB40*/ 00179000
@RF00406 L     @15,@PC00001+8                                      0422 00180000
         LH    @15,LASTCOND(,@15)                                  0422 00181000
         LTR   @15,@15                                             0422 00182000
         BNZ   @RF00422                                            0422 00183000
*     DO;                           /* YES                   @Z40LB40*/ 00184000
*                                                                  0423 00185000
*       /*************************************************************/ 00186000
*       /*                                                           */ 00187000
*       /* ISSUE UGSPACE MACRO                               @Z40LB40*/ 00188000
*       /*                                                           */ 00189000
*       /*************************************************************/ 00190000
*                                                                  0424 00191000
*       CALL IDCSAGS0(GDTTBL,CORESIZE,MEMPTR);/*             @Z40LB40*/ 00192000
         L     @02,@PC00001                                        0424 00193000
         ST    @02,@AL00001                                        0424 00194000
         LA    @15,@CF01361                                        0424 00195000
         ST    @15,@AL00001+4                                      0424 00196000
         LA    @15,MEMPTR                                          0424 00197000
         ST    @15,@AL00001+8                                      0424 00198000
         MVI   @AL00001+8,X'80'                                    0424 00199000
         L     @15,GDTGSP(,@02)                                    0424 00200000
         LA    @01,@AL00001                                        0424 00201000
         BALR  @14,@15                                             0424 00202000
*       RESPECIFY                                                  0425 00203000
*         RTNREG RSTD;                                             0425 00204000
*       TESTRC=RTNREG;                                             0426 00205000
         LR    TESTRC,RTNREG                                       0426 00206000
*       RESPECIFY                                                  0427 00207000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 00208000
*       IF TESTRC=0 THEN            /* WAS STORAGE GOTTEN    @Z40LB40*/ 00209000
         LTR   TESTRC,TESTRC                                       0428 00210000
         BNZ   @RF00428                                            0428 00211000
*         GOTCORE=ON;               /* YES,INDICATE IT       @Z40LB40*/ 00212000
         OI    GOTCORE,B'10000000'                                 0429 00213000
*       ELSE                        /* NO,INDICATE IT        @Z40LB40*/ 00214000
*         DO;                       /*                       @Z40LB40*/ 00215000
         B     @RC00428                                            0430 00216000
@RF00428 DS    0H                                                  0431 00217000
*           LASTCOND=LASTCC12;      /* SET RET.CODE          @Z40LB40*/ 00218000
         L     @15,@PC00001+8                                      0431 00219000
         MVC   LASTCOND(2,@15),@CH00606                            0431 00220000
*           GETSFAIL=ON;            /* INDICATE FAIL         @Z40LB40*/ 00221000
         OI    GETSFAIL,B'01000000'                                0432 00222000
*         END;                      /*                       @Z40LB40*/ 00223000
*     END;                          /*                       @Z40LB40*/ 00224000
*                                                                  0434 00225000
@RC00428 DS    0H                                                  0435 00226000
*   /*****************************************************************/ 00227000
*   /*                                                               */ 00228000
*   /* IF RETURN CODE NOT SEVERE CHECK FOR WORK TO           @Z40LB40*/ 00229000
*   /* BE DONE.                                              @Z40LB40*/ 00230000
*   /*                                                               */ 00231000
*   /*****************************************************************/ 00232000
*                                                                  0435 00233000
*   IF LASTCOND<LASTCC12 THEN       /* IS EVERYTHING OK      @Z40LB40*/ 00234000
@RF00422 L     @15,@PC00001+8                                      0435 00235000
         LH    @15,LASTCOND(,@15)                                  0435 00236000
         C     @15,@CF00606                                        0435 00237000
         BNL   @RF00435                                            0435 00238000
*     DO;                           /* YES,GO AHEAD          @Z40LB40*/ 00239000
*                                                                  0436 00240000
*       /*************************************************************/ 00241000
*       /*                                                           */ 00242000
*       /* IF MSC SPECIFIED OR DEFAULTED TO                  @Z40LB40*/ 00243000
*       /* THEN DUMP MSC.                                    @Z40LB40*/ 00244000
*       /*                                                           */ 00245000
*       /*************************************************************/ 00246000
*                                                                  0437 00247000
*       IF ADDR(MSC)^=NULLPTR|(ADDR(MSC)=NULLPTR&STGADCNT=0&TBLCNT=0)   00248000
*         THEN                                                     0437 00249000
         SLR   @15,@15                                             0437 00250000
         L     @14,@PC00001+4                                      0437 00251000
         L     @07,FDTPTR(,@14)                                    0437 00252000
         CR    @07,@15                                             0437 00253000
         BNE   @RT00437                                            0437 00254000
         CR    @07,@15                                             0437 00255000
         BNE   @RF00437                                            0437 00256000
         LA    @07,FDTPTR+16(,@14)                                 0437 00257000
         C     @15,STGADCNT(,@07)                                  0437 00258000
         BNE   @RF00437                                            0437 00259000
         LA    @14,FDTPTR+36(,@14)                                 0437 00260000
         C     @15,TBLCNT(,@14)                                    0437 00261000
         BNE   @RF00437                                            0437 00262000
@RT00437 DS    0H                                                  0438 00263000
*         DO;                       /*                       @Z40LB40*/ 00264000
*                                                                  0438 00265000
*           /*********************************************************/ 00266000
*           /*                                                       */ 00267000
*           /* MSC SPECIFIED OR DEFAULTED TO                 @Z40LB40*/ 00268000
*           /* SO CALL DUMPMSC TO DUMP THE MSC.              @Z40LB40*/ 00269000
*           /*                                                       */ 00270000
*           /*********************************************************/ 00271000
*                                                                  0439 00272000
*           CALL DUMPMSC;           /*                       @Z40LB40*/ 00273000
         BAL   @14,DUMPMSC                                         0439 00274000
*           RESPECIFY                                              0440 00275000
*             RTNREG RSTD;                                         0440 00276000
*           TESTRC=RTNREG;                                         0441 00277000
         LR    TESTRC,RTNREG                                       0441 00278000
*           RESPECIFY                                              0442 00279000
*             RTNREG UNRSTD;        /*                       @Z40LB40*/ 00280000
*           IF TESTRC^=LASTCC00 THEN/* RET.CODE^=0           @Z40LB40*/ 00281000
         LTR   TESTRC,TESTRC                                       0443 00282000
         BZ    @RF00443                                            0443 00283000
*             LASTCOND=LASTCC08;    /* SET RET.CODE          @Z40LB40*/ 00284000
         L     @15,@PC00001+8                                      0444 00285000
         MVC   LASTCOND(2,@15),@CH00183                            0444 00286000
*         END;                      /*                       @Z40LB40*/ 00287000
@RF00443 DS    0H                                                  0446 00288000
*     END;                          /*                       @Z40LB40*/ 00289000
*                                                                  0446 00290000
@RF00437 DS    0H                                                  0447 00291000
*   /*****************************************************************/ 00292000
*   /*                                                               */ 00293000
*   /* IF RETURN CODE NOT SEVERE CHECK FOR NEXT WORK         @Z40LB40*/ 00294000
*   /* TO BE DONE.                                           @Z40LB40*/ 00295000
*   /*                                                               */ 00296000
*   /*****************************************************************/ 00297000
*                                                                  0447 00298000
*   IF LASTCOND<LASTCC12 THEN       /* IS EVERYTHING OK      @Z40LB40*/ 00299000
@RF00435 L     @15,@PC00001+8                                      0447 00300000
         LH    @15,LASTCOND(,@15)                                  0447 00301000
         C     @15,@CF00606                                        0447 00302000
         BNL   @RF00447                                            0447 00303000
*     DO;                           /* YES,GO AHEAD          @Z40LB40*/ 00304000
*                                                                  0448 00305000
*       /*************************************************************/ 00306000
*       /*                                                           */ 00307000
*       /* IF SA SPECIFIED THEN CALL DUMPSA FOR EACH         @Z40LB40*/ 00308000
*       /* STAGING ADAPTER SSID SPECIFIED.                   @Z40LB40*/ 00309000
*       /*                                                           */ 00310000
*       /*************************************************************/ 00311000
*                                                                  0449 00312000
*       IF STGADCNT^=0 THEN                                        0449 00313000
         L     @15,@PC00001+4                                      0449 00314000
         LA    @15,FDTPTR+16(,@15)                                 0449 00315000
         L     @15,STGADCNT(,@15)                                  0449 00316000
         LTR   @15,@15                                             0449 00317000
         BZ    @RF00449                                            0449 00318000
*         DO I1=1 TO STGADCNT;      /* LOOP FOR EACH SSID    @Z40LB40*/ 00319000
         LA    @15,1                                               0450 00320000
         B     @DE00450                                            0450 00321000
@DL00450 DS    0H                                                  0451 00322000
*           IF(SSIDPTR(I1)->SSIDVAL&SSIDMASK)^=0 THEN              0451 00323000
         SLA   @15,2                                               0451 00324000
         L     @14,@PC00001+4                                      0451 00325000
         L     @01,FDTPTR+20(,@14)                                 0451 00326000
         AL    @01,@CF01753                                        0451 00327000
         L     @15,SSIDPTR(@15,@01)                                0451 00328000
         L     @14,SSIDVAL(,@15)                                   0451 00329000
         N     @14,SSIDMASK                                        0451 00330000
         LTR   @14,@14                                             0451 00331000
         BZ    @RF00451                                            0451 00332000
*             DO;                   /*                       @Z40LB40*/ 00333000
*                                                                  0452 00334000
*               /*****************************************************/ 00335000
*               /*                                                   */ 00336000
*               /* SSID INVALID, ISSUE ERROR MESSAGE         @Z40LB40*/ 00337000
*               /* AND SET RETURN CODE.                      @Z40LB40*/ 00338000
*               /*                                                   */ 00339000
*               /*****************************************************/ 00340000
*                                                                  0453 00341000
*               PRINTAB=''B;        /* CLEAR ARG LIST        @Z40LB40*/ 00342000
         XC    PRINTAB(44),PRINTAB                                 0453 00343000
*               DARGSMOD=DUMSGMOD;  /* SET MOD ID            @Z40LB40*/ 00344000
         L     @14,DDSTRU                                          0454 00345000
         MVC   DARGSMOD(3,@14),@CC01334                            0454 00346000
*               DARGSENT=IDC21103;  /* SET TEXT ENTRY        @Z40LB40*/ 00347000
         MVI   DARGSENT(@14),X'04'                                 0455 00348000
*               DARGCNT=1;          /* SET 1 INSERT          @Z40LB40*/ 00349000
         LA    @07,1                                               0456 00350000
         STH   @07,DARGCNT(,@14)                                   0456 00351000
*               DARGINS(1)=1;       /* SET INSERT NO.        @Z40LB40*/ 00352000
         STH   @07,DARGINS(,@14)                                   0457 00353000
*               DARGINL(1)=2;       /* SET LENGTH            @Z40LB40*/ 00354000
         LA    @07,2                                               0458 00355000
         STH   @07,DARGINL(,@14)                                   0458 00356000
*               DARGDTM(1)=(SSIDPTR(I1))+2;/* SET ADDR.      @Z40LB40*/ 00357000
         ALR   @15,@07                                             0459 00358000
         ST    @15,DARGDTM(,@14)                                   0459 00359000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* PRINT MSG  0460 00360000
*                                                            @Z40LB40*/ 00361000
         L     @15,@PC00001                                        0460 00362000
         ST    @15,@AL00001                                        0460 00363000
         LA    @14,@CF00118                                        0460 00364000
         ST    @14,@AL00001+4                                      0460 00365000
         LA    @14,DDSTRU                                          0460 00366000
         ST    @14,@AL00001+8                                      0460 00367000
         MVI   @AL00001+8,X'80'                                    0460 00368000
         L     @15,GDTPRT(,@15)                                    0460 00369000
         LA    @01,@AL00001                                        0460 00370000
         BALR  @14,@15                                             0460 00371000
*               LASTCOND=LASTCC08;  /* SET RET.CODE          @Z40LB40*/ 00372000
         L     @15,@PC00001+8                                      0461 00373000
         MVC   LASTCOND(2,@15),@CH00183                            0461 00374000
*             END;                  /*                       @Z40LB40*/ 00375000
*           ELSE                                                   0463 00376000
*             DO;                   /*                       @Z40LB40*/ 00377000
*                                                                  0463 00378000
         B     @RC00451                                            0463 00379000
@RF00451 DS    0H                                                  0464 00380000
*               /*****************************************************/ 00381000
*               /*                                                   */ 00382000
*               /* SSID OK, GO DUMP IT                       @Z40LB40*/ 00383000
*               /*                                                   */ 00384000
*               /*****************************************************/ 00385000
*                                                                  0464 00386000
*               CALL DUMPSA(I1);    /* PASS INDEX AS PARM    @Z40LB40*/ 00387000
         LA    @15,I1                                              0464 00388000
         ST    @15,@AL00001                                        0464 00389000
         LA    @01,@AL00001                                        0464 00390000
         BAL   @14,DUMPSA                                          0464 00391000
*               RESPECIFY                                          0465 00392000
*                 RTNREG RSTD;                                     0465 00393000
*               TESTRC=RTNREG;                                     0466 00394000
         LR    TESTRC,RTNREG                                       0466 00395000
*               RESPECIFY                                          0467 00396000
*                 RTNREG UNRSTD;    /*                       @Z40LB40*/ 00397000
*               IF TESTRC^=LASTCC00 THEN/* RET.CODE^=0       @Z40LB40*/ 00398000
         LTR   TESTRC,TESTRC                                       0468 00399000
         BZ    @RF00468                                            0468 00400000
*                 LASTCOND=LASTCC08;/* SET RET.CODE          @Z40LB40*/ 00401000
         L     @15,@PC00001+8                                      0469 00402000
         MVC   LASTCOND(2,@15),@CH00183                            0469 00403000
*             END;                  /*                       @Z40LB40*/ 00404000
@RF00468 DS    0H                                                  0471 00405000
*         END;                      /*                       @Z40LB40*/ 00406000
@RC00451 LA    @15,1                                               0471 00407000
         AL    @15,I1                                              0471 00408000
@DE00450 ST    @15,I1                                              0471 00409000
         L     @14,@PC00001+4                                      0471 00410000
         LA    @14,FDTPTR+16(,@14)                                 0471 00411000
         C     @15,STGADCNT(,@14)                                  0471 00412000
         BNH   @DL00450                                            0471 00413000
*     END;                          /*                       @Z40LB40*/ 00414000
*                                                                  0472 00415000
@RF00449 DS    0H                                                  0473 00416000
*   /*****************************************************************/ 00417000
*   /*                                                               */ 00418000
*   /* IF RETURN CODE NOT SEVERE CHECK FOR NEXT WORK         @Z40LB40*/ 00419000
*   /* TO BE DONE.                                           @Z40LB40*/ 00420000
*   /*                                                               */ 00421000
*   /*****************************************************************/ 00422000
*                                                                  0473 00423000
*   IF LASTCOND<LASTCC12 THEN       /* IS EVERYTHING OK      @Z40LB40*/ 00424000
@RF00447 L     @15,@PC00001+8                                      0473 00425000
         LH    @15,LASTCOND(,@15)                                  0473 00426000
         C     @15,@CF00606                                        0473 00427000
         BNL   @RF00473                                            0473 00428000
*     DO;                           /* YES,GO AHEAD          @Z40LB40*/ 00429000
*                                                                  0474 00430000
*       /*************************************************************/ 00431000
*       /*                                                           */ 00432000
*       /* IF TABLES SPECIFIED THEN CALL DUMPTAB TO          @Z40LB40*/ 00433000
*       /* DUMP MSC TABLES.                                  @Z40LB40*/ 00434000
*       /*                                                           */ 00435000
*       /*************************************************************/ 00436000
*                                                                  0475 00437000
*       IF TBLCNT^=0 THEN                                          0475 00438000
         L     @15,@PC00001+4                                      0475 00439000
         LA    @15,FDTPTR+36(,@15)                                 0475 00440000
         L     @15,TBLCNT(,@15)                                    0475 00441000
         LTR   @15,@15                                             0475 00442000
         BZ    @RF00475                                            0475 00443000
*         DO;                       /*                       @Z40LB40*/ 00444000
*           CALL DUMPTAB;           /*                       @Z40LB40*/ 00445000
         BAL   @14,DUMPTAB                                         0477 00446000
*           RESPECIFY                                              0478 00447000
*             RTNREG RSTD;                                         0478 00448000
*           TESTRC=RTNREG;                                         0479 00449000
         LR    TESTRC,RTNREG                                       0479 00450000
*           RESPECIFY                                              0480 00451000
*             RTNREG UNRSTD;        /*                       @Z40LB40*/ 00452000
*           IF TESTRC^=LASTCC00 THEN/* RET.CODE^=0           @Z40LB40*/ 00453000
         LTR   TESTRC,TESTRC                                       0481 00454000
         BZ    @RF00481                                            0481 00455000
*             LASTCOND=LASTCC08;    /* SET RET.CODE          @Z40LB40*/ 00456000
         L     @15,@PC00001+8                                      0482 00457000
         MVC   LASTCOND(2,@15),@CH00183                            0482 00458000
*         END;                      /*                       @Z40LB40*/ 00459000
@RF00481 DS    0H                                                  0484 00460000
*     END;                          /*                       @Z40LB40*/ 00461000
*                                                                  0484 00462000
@RF00475 DS    0H                                                  0485 00463000
*   /*****************************************************************/ 00464000
*   /*                                                               */ 00465000
*   /* CHECK IF STORAGE WAS GOTTON. IF SO, FREE IT.          @Z40LB40*/ 00466000
*   /*                                                               */ 00467000
*   /*****************************************************************/ 00468000
*                                                                  0485 00469000
*   IF GOTCORE=ON THEN                                             0485 00470000
*                                                                  0485 00471000
@RF00473 TM    GOTCORE,B'10000000'                                 0485 00472000
         BNO   @RF00485                                            0485 00473000
*     /***************************************************************/ 00474000
*     /*                                                             */ 00475000
*     /* ISSUE UFSPACE MACRO                                 @Z40LB40*/ 00476000
*     /*                                                             */ 00477000
*     /***************************************************************/ 00478000
*                                                                  0486 00479000
*     CALL IDCSAFS0(GDTTBL,MEMPTR); /*                       @Z40LB40*/ 00480000
*                                                                  0486 00481000
         L     @15,@PC00001                                        0486 00482000
         ST    @15,@AL00001                                        0486 00483000
         LA    @14,MEMPTR                                          0486 00484000
         ST    @14,@AL00001+4                                      0486 00485000
         L     @15,GDTFSP(,@15)                                    0486 00486000
         LA    @01,@AL00001                                        0486 00487000
         BALR  @14,@15                                             0486 00488000
*   /*****************************************************************/ 00489000
*   /*                                                               */ 00490000
*   /* CHECK TO SEE IF ERROR MESSAGES MUST BE ISSUED OR JUST @Z40LB40*/ 00491000
*   /* THE NORMAL END MESSAGE. IF LASTCOND ^= 00 THEN        @Z40LB40*/ 00492000
*   /* IF GETSFAIL IS ON THEN ISSUE MESSAGE IDC3004I. ELSE   @Z40LB40*/ 00493000
*   /* ISSUE MESSAGE IDC3003I. IF LASTCOND = 0 THEN ISSUE    @Z40LB40*/ 00494000
*   /* MESSAGE IDC0001I.                                     @Z40LB40*/ 00495000
*   /*                                                               */ 00496000
*   /*****************************************************************/ 00497000
*                                                                  0487 00498000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 00499000
@RF00485 XC    PRINTAB(44),PRINTAB                                 0487 00500000
*   DARGSMOD=UVMSGMOD;              /* SET MOD ID            @Z40LB40*/ 00501000
         L     @15,DDSTRU                                          0488 00502000
         MVC   DARGSMOD(3,@15),@CC01336                            0488 00503000
*   DARGDBP=ADDR(LASTCOND);         /* ADDRESS OF INSERT     @Z40LB40*/ 00504000
         L     @14,@PC00001+8                                      0489 00505000
         ST    @14,DARGDBP(,@15)                                   0489 00506000
*   DARGILP=LENGTH(LASTCOND);       /* PTR TO INSERT         @Z40LB40*/ 00507000
         MVC   DARGILP(2,@15),@CH00157                             0490 00508000
*   IF LASTCOND^=LASTCC00 THEN      /* WAS THERE AN ERROR    @Z40LB40*/ 00509000
         LH    @14,LASTCOND(,@14)                                  0491 00510000
         LTR   @14,@14                                             0491 00511000
         BZ    @RF00491                                            0491 00512000
*     IF GETSFAIL=ON THEN           /* YES,WAS IT GETMAIN    @Z40LB40*/ 00513000
         TM    GETSFAIL,B'01000000'                                0492 00514000
         BNO   @RF00492                                            0492 00515000
*       DARGSENT=IDC3004;           /* YES,SET MSG           @Z40LB40*/ 00516000
         MVI   DARGSENT(@15),X'04'                                 0493 00517000
*     ELSE                          /* NOT,GETMAIN           @Z40LB40*/ 00518000
*       DARGSENT=IDC3003;           /*                       @Z40LB40*/ 00519000
         B     @RC00492                                            0494 00520000
@RF00492 L     @01,DDSTRU                                          0494 00521000
         MVI   DARGSENT(@01),X'03'                                 0494 00522000
*   ELSE                                                           0495 00523000
*     DARGSENT=IDC0001;             /* NO ERRORS,NORM MSG    @Z40LB40*/ 00524000
         B     @RC00491                                            0495 00525000
@RF00491 L     @01,DDSTRU                                          0495 00526000
         MVI   DARGSENT(@01),X'01'                                 0495 00527000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* PRINT LAST MSG   @Z40LB40*/ 00528000
*                                                                  0496 00529000
@RC00491 L     @15,@PC00001                                        0496 00530000
         ST    @15,@AL00001                                        0496 00531000
         LA    @14,@CF00118                                        0496 00532000
         ST    @14,@AL00001+4                                      0496 00533000
         LA    @14,DDSTRU                                          0496 00534000
         ST    @14,@AL00001+8                                      0496 00535000
         MVI   @AL00001+8,X'80'                                    0496 00536000
         L     @15,GDTPRT(,@15)                                    0496 00537000
         LA    @01,@AL00001                                        0496 00538000
         BALR  @14,@15                                             0496 00539000
*   /*****************************************************************/ 00540000
*   /*                                                               */ 00541000
*   /* CHECK FOR DATASET OPEN AND IF SO, CLOSE IT            @Z40LB40*/ 00542000
*   /*                                                               */ 00543000
*   /*****************************************************************/ 00544000
*                                                                  0497 00545000
*   IF PRPTR^=NULLPTR THEN                                         0497 00546000
*                                                                  0497 00547000
         L     @15,PRPTR                                           0497 00548000
         LTR   @15,@15                                             0497 00549000
         BZ    @RF00497                                            0497 00550000
*     /***************************************************************/ 00551000
*     /*                                                             */ 00552000
*     /* ISSUE UCLOSE MACRO                                  @Z40LB40*/ 00553000
*     /*                                                             */ 00554000
*     /***************************************************************/ 00555000
*                                                                  0498 00556000
*     CALL IDCIOCL0(GDTTBL,IOCSPTR);/*                       @Z40LB40*/ 00557000
*                                                                  0498 00558000
         L     @15,@PC00001                                        0498 00559000
         ST    @15,@AL00001                                        0498 00560000
         LA    @14,IOCSPTR                                         0498 00561000
         ST    @14,@AL00001+4                                      0498 00562000
         MVI   @AL00001+4,X'80'                                    0498 00563000
         L     @15,GDTCLS(,@15)                                    0498 00564000
         LA    @01,@AL00001                                        0498 00565000
         BALR  @14,@15                                             0498 00566000
*   /*****************************************************************/ 00567000
*   /*                                                               */ 00568000
*   /* ISSUE UDUMP DIAGNOSTIC REGION DUMP                    @Z40LB40*/ 00569000
*   /*                                                               */ 00570000
*   /*****************************************************************/ 00571000
*                                                                  0499 00572000
*   IF GDTDBG=NULLPTR THEN                                         0499 00573000
@RF00497 L     @15,@PC00001                                        0499 00574000
         L     @15,GDTDBG(,@15)                                    0499 00575000
         LTR   @15,@15                                             0499 00576000
         BZ    @RT00499                                            0499 00577000
*     ;                                                            0500 00578000
*   ELSE                                                           0501 00579000
*     CALL IDCDB010(GDTTBL,'DUAZ'); /*                       @Z40LB40*/ 00580000
*                                                                  0501 00581000
         L     @15,@PC00001                                        0501 00582000
         ST    @15,@AL00001                                        0501 00583000
         LA    @14,@CC01456                                        0501 00584000
         ST    @14,@AL00001+4                                      0501 00585000
         MVI   @AL00001+4,X'80'                                    0501 00586000
         L     @15,GDTDBG(,@15)                                    0501 00587000
         LA    @01,@AL00001                                        0501 00588000
         BALR  @14,@15                                             0501 00589000
*   /*****************************************************************/ 00590000
*   /*                                                               */ 00591000
*   /* ISSUE UEPIL MACRO TO TERMINATE                        @Z40LB40*/ 00592000
*   /*                                                               */ 00593000
*   /*****************************************************************/ 00594000
*                                                                  0502 00595000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0502 00596000
*                                                                  0502 00597000
@RT00499 L     @15,@PC00001                                        0502 00598000
         ST    @15,@AL00001                                        0502 00599000
         LA    @14,MODID                                           0502 00600000
         ST    @14,@AL00001+4                                      0502 00601000
         L     @14,@PC00001+8                                      0502 00602000
         ST    @14,@AL00001+8                                      0502 00603000
         MVI   @AL00001+8,X'80'                                    0502 00604000
         L     @15,GDTEPL(,@15)                                    0502 00605000
         LA    @01,@AL00001                                        0502 00606000
         BALR  @14,@15                                             0502 00607000
*   /*****************************************************************/ 00608000
*   /*                                                               */ 00609000
*   /*                                                       @Z40LB40*/ 00610000
*   /*                                                               */ 00611000
*   /*****************************************************************/ 00612000
*                                                                  0503 00613000
*                                                                  0503 00614000
*   /*****************************************************************/ 00615000
*   /*                                                               */ 00616000
*   /* PROCEDURE NAME - DUMPMSC (LEVEL 2)                    @Z40LB40*/ 00617000
*   /*                                                       @Z40LB40*/ 00618000
*   /* FUNCTION - THIS ROUTINE CALLS THE ROUTINES THAT       @Z40LB40*/ 00619000
*   /* PRODUCE FORMATTED AND/OR UNFORMATTED                  @Z40LB40*/ 00620000
*   /* DUMPS OF MSC MAIN AND EXTENDED STORAGE.               @Z40LB40*/ 00621000
*   /* GETDATA IS CALLED TO READ ALL OF MSC                  @Z40LB40*/ 00622000
*   /* MAIN OR EXT. STORAGE. ZEROBDY, JOBLISTS,              @Z40LB40*/ 00623000
*   /* IOBUFFS, STGSCH, UCBS, ERP, LOWSENSE,                 @Z40LB40*/ 00624000
*   /* MSCEC, BAR, TABUCB,                                   @ZD00050*/ 00625000
*   /* MNTEQUAL, CHRS, RECOVERY AND                          @ZD00050*/ 00626000
*   /* PRNTSECT ARE CALLED TO DO THE ACTUAL                  @Z40LB40*/ 00627000
*   /* PRINTING OF THE USER REQUESTED PORTIONS               @Z40LB40*/ 00628000
*   /* OF STORAGE.                                           @Z40LB40*/ 00629000
*   /*                                                       @Z40LB40*/ 00630000
*   /* INPUT - FUNCTION DESCRIPTION TABLE.                   @Z40LB40*/ 00631000
*   /*                                                       @Z40LB40*/ 00632000
*   /* OUTPUT - RETURN CODE                                  @Z40LB40*/ 00633000
*   /* 0 = EVERYTHING OK                                     @Z40LB40*/ 00634000
*   /* 4 = USER ENTERED DATA INCORRECTLY, BUT                @Z40LB40*/ 00635000
*   /* REMAINDER OF THE FUNCTIONS WERE                       @Z40LB40*/ 00636000
*   /* ATTEMPTED, OR GETDATA FAILED WHEN                     @Z40LB40*/ 00637000
*   /* READING MSC STORAGE.                                  @Z40LB40*/ 00638000
*   /*                                                               */ 00639000
*   /*****************************************************************/ 00640000
*                                                                  0503 00641000
*DUMPMSC:                                                          0503 00642000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 00643000
@EL00001 L     @13,4(,@13)                                         0503 00644000
@EF00001 L     @00,@SIZDATD                                        0503 00645000
         LR    @01,@08                                             0503 00646000
         FREEMAIN R,LV=(0),A=(1)                                        00647000
@ER00001 LM    @14,@12,12(@13)                                     0503 00648000
         BR    @14                                                 0503 00649000
DUMPMSC  DS    0H                                                  0504 00650000
*   RFY                                                            0504 00651000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 00652000
*   RETADDR1=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 00653000
         ST    REG14,RETADDR1                                      0505 00654000
*   RFY                                                            0506 00655000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 00656000
*   OLDERID2=NEWERID2;                                             0507 00657000
         L     @15,@PC00001                                        0507 00658000
         L     @15,GDTTR2(,@15)                                    0507 00659000
         MVC   @TS00001(95),NEWERID2(@15)                          0507 00660000
         MVC   OLDERID2(95,@15),@TS00001                           0507 00661000
*   NEWID2='DUBA';                  /*                       @Z40LB40*/ 00662000
         MVC   NEWID2(4,@15),@CC01460                              0508 00663000
*   MSCRC=LASTCC00;                 /* INIT RETURN CODE      @Z40LB40*/ 00664000
*                                                                  0509 00665000
         SLR   @15,@15                                             0509 00666000
         STH   @15,MSCRC                                           0509 00667000
*   /*****************************************************************/ 00668000
*   /*                                                               */ 00669000
*   /* ISSUE UESTA MACRO FOR PRINT HEADERS                   @Z40LB40*/ 00670000
*   /*                                                               */ 00671000
*   /*****************************************************************/ 00672000
*                                                                  0510 00673000
*   PCARG=''B;                      /* CLEAR ARG             @Z40LB40*/ 00674000
         XC    PCARG(33),PCARG                                     0510 00675000
*   STBUFFER=' ';                   /* BLANK RETURN AREA     @Z40LB40*/ 00676000
         MVI   STBUFFER+1,C' '                                     0511 00677000
         MVC   STBUFFER+2(119),STBUFFER+1                          0511 00678000
         MVI   STBUFFER,C' '                                       0511 00679000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 00680000
         XC    PRINTAB(44),PRINTAB                                 0512 00681000
*   DARGRETP=ADDR(STBUFFER);        /* ADDR OF RETURN AREA   @Z40LB40*/ 00682000
         L     @14,DDSTRU                                          0513 00683000
         LA    @07,STBUFFER                                        0513 00684000
         ST    @07,DARGRETP(,@14)                                  0513 00685000
*   DARGRETL=LENGTH(STBUFFER);      /* SIZE OF RETURN AREA   @Z40LB40*/ 00686000
         MVC   DARGRETL(2,@14),@CH01251                            0514 00687000
*   DARGSMOD=DUMSGMOD;              /* TEXT MOD ID           @Z40LB40*/ 00688000
         MVC   DARGSMOD(3,@14),@CC01334                            0515 00689000
*   IF ADDR(AMSC)=NULLPTR THEN      /* IF ALT NOT SPECIFIED  @ZA27590*/ 00690000
         L     @07,@PC00001+4                                      0516 00691000
         C     @15,FDTPTR+92(,@07)                                 0516 00692000
         BNE   @RF00516                                            0516 00693000
*     DARGSENT=TMSCD;               /* ENTRY ID              @ZA27590*/ 00694000
         MVI   DARGSENT(@14),X'0A'                                 0517 00695000
*   ELSE                            /* ELSE USE ALTERNATE    @ZA27590*/ 00696000
*     DARGSENT=TAMSCD;              /* ENTRY ID              @ZA27590*/ 00697000
         B     @RC00516                                            0518 00698000
@RF00516 L     @01,DDSTRU                                          0518 00699000
         MVI   DARGSENT(@01),X'1C'                                 0518 00700000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* READ IN SUBTITLE @Z40LB40*/ 00701000
@RC00516 L     @15,@PC00001                                        0519 00702000
         ST    @15,@AL00001                                        0519 00703000
         LA    @14,@CF00118                                        0519 00704000
         ST    @14,@AL00001+4                                      0519 00705000
         LA    @14,DDSTRU                                          0519 00706000
         ST    @14,@AL00001+8                                      0519 00707000
         MVI   @AL00001+8,X'80'                                    0519 00708000
         L     @15,GDTPRT(,@15)                                    0519 00709000
         LA    @01,@AL00001                                        0519 00710000
         BALR  @14,@15                                             0519 00711000
*   PCSTLC=1;                       /* ONE SUBTITLE          @Z40LB40*/ 00712000
         MVC   PCSTLC(2),@CH00223                                  0520 00713000
*   PCSTLP=ADDR(STBUFFER);          /* ADDR OF SUBTITLE      @Z40LB40*/ 00714000
         LA    @15,STBUFFER                                        0521 00715000
         ST    @15,PCSTLP                                          0521 00716000
*   CALL AMSTP042(GDTTBL,PRPTR,PCARG);/* SET SUBTITLE        @Z40LB40*/ 00717000
*                                                                  0522 00718000
         L     @15,@PC00001                                        0522 00719000
         ST    @15,@AL00001                                        0522 00720000
         LA    @14,PRPTR                                           0522 00721000
         ST    @14,@AL00001+4                                      0522 00722000
         LA    @14,PCARG                                           0522 00723000
         ST    @14,@AL00001+8                                      0522 00724000
         L     @15,GDTESA(,@15)                                    0522 00725000
         LA    @01,@AL00001                                        0522 00726000
         BALR  @14,@15                                             0522 00727000
*   /*****************************************************************/ 00728000
*   /*                                                               */ 00729000
*   /* IF FORMAT SPECIFIED OR DEFAULTED TO OR MAINSECTOR     @Z40LB40*/ 00730000
*   /* SPECIFIED THEN GETDATA MUST BE CALLED TO READ ALL     @Z40LB40*/ 00731000
*   /* OF MSC MAIN STORAGE.                                  @Z40LB40*/ 00732000
*   /*                                                               */ 00733000
*   /*****************************************************************/ 00734000
*                                                                  0523 00735000
*   IF(ADDR(MFMT)=NULLPTR&MSCTMCNT=0&MSCTECNT=0)|ADDR(MFMT)^=NULLPTR|   00736000
*       MSCTMCNT^=0 THEN                                           0523 00737000
         SLR   @15,@15                                             0523 00738000
         L     @14,@PC00001+4                                      0523 00739000
         C     @15,FDTPTR+4(,@14)                                  0523 00740000
         BNE   @GL00006                                            0523 00741000
         LA    @07,FDTPTR+8(,@14)                                  0523 00742000
         C     @15,MSCTMCNT(,@07)                                  0523 00743000
         BNE   @GL00006                                            0523 00744000
         LA    @14,FDTPTR+12(,@14)                                 0523 00745000
         C     @15,MSCTECNT(,@14)                                  0523 00746000
         BE    @RT00523                                            0523 00747000
@GL00006 SLR   @15,@15                                             0523 00748000
         L     @14,@PC00001+4                                      0523 00749000
         C     @15,FDTPTR+4(,@14)                                  0523 00750000
         BNE   @RT00523                                            0523 00751000
         LA    @14,FDTPTR+8(,@14)                                  0523 00752000
         C     @15,MSCTMCNT(,@14)                                  0523 00753000
         BE    @RF00523                                            0523 00754000
@RT00523 DS    0H                                                  0524 00755000
*     DO;                           /*                       @Z40LB40*/ 00756000
*       CALL GETDATA(MSCM);         /* PASS MSCM AS PARM     @Z40LB40*/ 00757000
         LA    @01,@AL00525                                        0525 00758000
         BAL   @14,GETDATA                                         0525 00759000
*       RESPECIFY                                                  0526 00760000
*         RTNREG RSTD;                                             0526 00761000
*       TESTRC=RTNREG;                                             0527 00762000
         LR    TESTRC,RTNREG                                       0527 00763000
*       RESPECIFY                                                  0528 00764000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 00765000
*       IF TESTRC^=LASTCC00 THEN    /* WAS ALL DATA READ     @Z40LB40*/ 00766000
         LTR   TESTRC,TESTRC                                       0529 00767000
         BZ    @RF00529                                            0529 00768000
*         DO;                       /*                       @Z40LB40*/ 00769000
*                                                                  0530 00770000
*           /*********************************************************/ 00771000
*           /*                                                       */ 00772000
*           /* NO ISSUE ERROR MESSAGE                        @Z40LB40*/ 00773000
*           /*                                                       */ 00774000
*           /*********************************************************/ 00775000
*                                                                  0531 00776000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB40*/ 00777000
         XC    PRINTAB(44),PRINTAB                                 0531 00778000
*           DARGSMOD=DUMSGMOD;      /* SET TEXT MOD ID       @Z40LB40*/ 00779000
         L     @15,DDSTRU                                          0532 00780000
         MVC   DARGSMOD(3,@15),@CC01334                            0532 00781000
*           DARGSENT=IDC21100;      /* SET TEXT ENTRY        @Z40LB40*/ 00782000
         MVI   DARGSENT(@15),X'01'                                 0533 00783000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* PRINT MSG      0534 00784000
*                                                            @Z40LB40*/ 00785000
         L     @15,@PC00001                                        0534 00786000
         ST    @15,@AL00001                                        0534 00787000
         LA    @14,@CF00118                                        0534 00788000
         ST    @14,@AL00001+4                                      0534 00789000
         LA    @14,DDSTRU                                          0534 00790000
         ST    @14,@AL00001+8                                      0534 00791000
         MVI   @AL00001+8,X'80'                                    0534 00792000
         L     @15,GDTPRT(,@15)                                    0534 00793000
         LA    @01,@AL00001                                        0534 00794000
         BALR  @14,@15                                             0534 00795000
*           MSCRC=LASTCC04;         /* SET RET.CODE          @Z40LB40*/ 00796000
         MVC   MSCRC(2),@CH00044                                   0535 00797000
*         END;                      /*                       @Z40LB40*/ 00798000
*       ELSE                                                       0537 00799000
*         GOTMSCM=ON;               /* YES,INDICATE IT       @Z40LB40*/ 00800000
         B     @RC00529                                            0537 00801000
@RF00529 OI    GOTMSCM,B'00100000'                                 0537 00802000
*       IF(GOTMSCM=ON&ADDR(MFMT)^=NULLPTR)|(GOTMSCM=ON&ADDR(MFMT)= 0538 00803000
*           NULLPTR&MSCTMCNT=0) THEN                               0538 00804000
@RC00529 TM    GOTMSCM,B'00100000'                                 0538 00805000
         BNO   @GL00009                                            0538 00806000
         L     @15,@PC00001+4                                      0538 00807000
         L     @15,FDTPTR+4(,@15)                                  0538 00808000
         LTR   @15,@15                                             0538 00809000
         BNZ   @RT00538                                            0538 00810000
@GL00009 TM    GOTMSCM,B'00100000'                                 0538 00811000
         BNO   @RF00538                                            0538 00812000
         SLR   @15,@15                                             0538 00813000
         L     @14,@PC00001+4                                      0538 00814000
         C     @15,FDTPTR+4(,@14)                                  0538 00815000
         BNE   @RF00538                                            0538 00816000
         LA    @14,FDTPTR+8(,@14)                                  0538 00817000
         C     @15,MSCTMCNT(,@14)                                  0538 00818000
         BNE   @RF00538                                            0538 00819000
@RT00538 DS    0H                                                  0539 00820000
*         DO;                       /*                       @Z40LB40*/ 00821000
*                                                                  0539 00822000
*           /*********************************************************/ 00823000
*           /*                                                       */ 00824000
*           /* FORMAT SPECIFIED OR DEFAULTED TO. CALL        @Z40LB40*/ 00825000
*           /* FUNCTIONS PROCEDURES TO PRODUCE THE           @Z40LB40*/ 00826000
*           /* VARIOUS PARTS OF THE FORMATTED DUMP           @Z40LB40*/ 00827000
*           /*                                                       */ 00828000
*           /*********************************************************/ 00829000
*                                                                  0540 00830000
*           CALL MSCEC;             /* PRINT EC LEVEL        @ZD00050*/ 00831000
         BAL   @14,MSCEC                                           0540 00832000
*           CALL BAR;               /* PRINT BAR REGISTER    @ZD00050*/ 00833000
         BAL   @14,BAR                                             0541 00834000
*           CALL TABUCB;            /* PRINT TABLES UCBS     @ZD00050*/ 00835000
         BAL   @14,TABUCB                                          0542 00836000
*           CALL RECOVERY;          /* PRINT RECOVERY        @ZD00050   00837000
*                                      SAVE AREAS            @ZD00050*/ 00838000
         BAL   @14,RECOVERY                                        0543 00839000
*           CALL JOBLISTS;          /* PRINT JOBLISTS        @Z40LB40*/ 00840000
         BAL   @14,JOBLISTS                                        0544 00841000
*           CALL IOBUFFS;           /* PRINT I/O BUFFERS     @Z40LB40*/ 00842000
         BAL   @14,IOBUFFS                                         0545 00843000
*           CALL ZEROBDY;           /* PRINT ZERO BOUNDARY   @Z40LB40   00844000
*                                      WORDS                 @Z40LB40*/ 00845000
         BAL   @14,ZEROBDY                                         0546 00846000
*           CALL UCBS;              /* PRINT UNIT CONTROL    @Z40LB40   00847000
*                                      BLOCKS                @Z40LB40*/ 00848000
         BAL   @14,UCBS                                            0547 00849000
*           CALL STGSCH;            /* PRINT STAGE SCHED.    @Z40LB40   00850000
*                                      INFORMATION           @Z40LB40*/ 00851000
         BAL   @14,STGSCH                                          0548 00852000
*           CALL ERP;               /* PRINT ERROR RECOV.    @Z40LB40   00853000
*                                      INFORMATION           @Z40LB40*/ 00854000
         BAL   @14,ERP                                             0549 00855000
*           CALL LOWSENSE;          /* PRINT LOW INTERFACE   @Z40LB40   00856000
*                                      SENSE DATA            @Z40LB40*/ 00857000
         BAL   @14,LOWSENSE                                        0550 00858000
*           CALL MNTEQUAL;          /* PRINT MOUNT           @Z40LB40   00859000
*                                      EQUALIZATION STATS    @Z40LB40*/ 00860000
         BAL   @14,MNTEQUAL                                        0551 00861000
*           CALL CHRS;              /* PRINT TABLE CHRS      @Z40LB40*/ 00862000
         BAL   @14,CHRS                                            0552 00863000
*         END;                      /*                       @Z40LB40*/ 00864000
*       IF GOTMSCM=ON&MSCTMCNT^=0 THEN                             0554 00865000
@RF00538 TM    GOTMSCM,B'00100000'                                 0554 00866000
         BNO   @RF00554                                            0554 00867000
         L     @15,@PC00001+4                                      0554 00868000
         LA    @15,FDTPTR+8(,@15)                                  0554 00869000
         L     @15,MSCTMCNT(,@15)                                  0554 00870000
         LTR   @15,@15                                             0554 00871000
         BZ    @RF00554                                            0554 00872000
*         DO I2=1 TO MSCTMCNT;      /*                       @Z40LB40*/ 00873000
*                                                                  0555 00874000
         LA    @15,1                                               0555 00875000
         B     @DE00555                                            0555 00876000
@DL00555 DS    0H                                                  0556 00877000
*           /*********************************************************/ 00878000
*           /*                                                       */ 00879000
*           /* MSC MAIN STORAGE READ OK AND MAINSECTOR ENTERED       */ 00880000
*           /*                                               @Z40LB40*/ 00881000
*           /* CALL PRNTSECT FOR EACH SECTOR SPECIFIED EITHER        */ 00882000
*           /*                                               @Z40LB40*/ 00883000
*           /* SINGLY OR AS PART OF A RANGE.                 @Z40LB40*/ 00884000
*           /*                                                       */ 00885000
*           /*********************************************************/ 00886000
*                                                                  0556 00887000
*           LOSECT=MMLOPTR(I2)->MMLOVAL;/* SAVE LOW VALUE    @Z40LB40*/ 00888000
         SLA   @15,2                                               0556 00889000
         L     @14,@PC00001+4                                      0556 00890000
         L     @01,FDTPTR+60(,@14)                                 0556 00891000
         AL    @01,@CF01753                                        0556 00892000
         L     @01,MMLOPTR(@15,@01)                                0556 00893000
         L     @07,MMLOVAL(,@01)                                   0556 00894000
         ST    @07,LOSECT                                          0556 00895000
*           IF MMHIPTR(I2)=NULLPTR THEN/* IF NOT RANGE       @Z40LB40*/ 00896000
         L     @01,FDTPTR+64(,@14)                                 0557 00897000
         AL    @01,@CF01753                                        0557 00898000
         L     @06,MMHIPTR(@15,@01)                                0557 00899000
         LTR   @06,@06                                             0557 00900000
         BNZ   @RF00557                                            0557 00901000
*             HISECT=LOSECT;        /* MAKE VALUES SAME      @Z40LB40*/ 00902000
         ST    @07,HISECT                                          0558 00903000
*           ELSE                                                   0559 00904000
*             HISECT=MMHIPTR(I2)->MMHIVAL;/* SAVE HIGH VALUE @Z40LB40*/ 00905000
         B     @RC00557                                            0559 00906000
@RF00557 L     @15,I2                                              0559 00907000
         SLA   @15,2                                               0559 00908000
         L     @14,@PC00001+4                                      0559 00909000
         L     @01,FDTPTR+64(,@14)                                 0559 00910000
         AL    @01,@CF01753                                        0559 00911000
         L     @01,MMHIPTR(@15,@01)                                0559 00912000
         L     @15,MMHIVAL(,@01)                                   0559 00913000
         ST    @15,HISECT                                          0559 00914000
*           IF LOSECT>HISECT THEN                                  0560 00915000
@RC00557 L     @15,LOSECT                                          0560 00916000
         C     @15,HISECT                                          0560 00917000
         BNH   @RF00560                                            0560 00918000
*             DO;                   /*                       @Z40LB40*/ 00919000
*                                                                  0561 00920000
*               /*****************************************************/ 00921000
*               /*                                                   */ 00922000
*               /* INVALID RANGE SPECIFIED. ISSUE ERROR      @Z40LB40*/ 00923000
*               /* MESSAGE AND SET RETURN CODE.              @Z40LB40*/ 00924000
*               /*                                                   */ 00925000
*               /*****************************************************/ 00926000
*                                                                  0562 00927000
*               PRINTAB=''B;        /*                       @Z40LB40*/ 00928000
         XC    PRINTAB(44),PRINTAB                                 0562 00929000
*               DARGSMOD=DUMSGMOD;  /*                       @Z40LB40*/ 00930000
         L     @15,DDSTRU                                          0563 00931000
         MVC   DARGSMOD(3,@15),@CC01334                            0563 00932000
*               DARGSENT=IDC21101;  /*                       @Z40LB40*/ 00933000
         MVI   DARGSENT(@15),X'02'                                 0564 00934000
*               DARGCNT=2;          /*                       @Z40LB40*/ 00935000
         LA    @14,2                                               0565 00936000
         STH   @14,DARGCNT(,@15)                                   0565 00937000
*               DARGINS(1)=1;       /*                       @Z40LB40*/ 00938000
         LA    @07,1                                               0566 00939000
         STH   @07,DARGINS(,@15)                                   0566 00940000
*               DARGINL(1)=1;       /*                       @Z40LB40*/ 00941000
         STH   @07,DARGINL(,@15)                                   0567 00942000
*               DARGDTM(1)=ADDR(LOSECT)+3;/*                 @Z40LB40*/ 00943000
         LA    @06,3                                               0568 00944000
         LA    @05,LOSECT                                          0568 00945000
         ALR   @05,@06                                             0568 00946000
         ST    @05,DARGDTM(,@15)                                   0568 00947000
*               DARGINS(2)=2;       /*                       @Z40LB40*/ 00948000
         STH   @14,DARGINS+8(,@15)                                 0569 00949000
*               DARGINL(2)=1;       /*                       @Z40LB40*/ 00950000
         STH   @07,DARGINL+8(,@15)                                 0570 00951000
*               DARGDTM(2)=ADDR(HISECT)+3;/*                 @Z40LB40*/ 00952000
         LA    @14,HISECT                                          0571 00953000
         ALR   @14,@06                                             0571 00954000
         ST    @14,DARGDTM+8(,@15)                                 0571 00955000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB40*/ 00956000
         L     @15,@PC00001                                        0572 00957000
         ST    @15,@AL00001                                        0572 00958000
         LA    @14,@CF00118                                        0572 00959000
         ST    @14,@AL00001+4                                      0572 00960000
         LA    @14,DDSTRU                                          0572 00961000
         ST    @14,@AL00001+8                                      0572 00962000
         MVI   @AL00001+8,X'80'                                    0572 00963000
         L     @15,GDTPRT(,@15)                                    0572 00964000
         LA    @01,@AL00001                                        0572 00965000
         BALR  @14,@15                                             0572 00966000
*               MSCRC=LASTCC04;     /* SET RET.CODE          @Z40LB40*/ 00967000
         MVC   MSCRC(2),@CH00044                                   0573 00968000
*             END;                  /*                       @Z40LB40*/ 00969000
*           ELSE                                                   0575 00970000
*             DO;                   /*                       @Z40LB40*/ 00971000
*                                                                  0575 00972000
         B     @RC00560                                            0575 00973000
@RF00560 DS    0H                                                  0576 00974000
*               /*****************************************************/ 00975000
*               /*                                                   */ 00976000
*               /* RANGE OK,SET PRINT HEADER AND CALL        @Z40LB40*/ 00977000
*               /* PRNTSECT TO PRINT SECTOR(S)               @Z40LB40*/ 00978000
*               /*                                                   */ 00979000
*               /*****************************************************/ 00980000
*                                                                  0576 00981000
*               HISECT=HISECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 00982000
         L     @15,HISECT                                          0576 00983000
         SLA   @15,8                                               0576 00984000
         ST    @15,HISECT                                          0576 00985000
*               LOSECT=LOSECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 00986000
         L     @15,LOSECT                                          0577 00987000
         SLA   @15,8                                               0577 00988000
         ST    @15,LOSECT                                          0577 00989000
*               DO J2=LOSECT TO HISECT BY SECTSIZE;/*        @Z40LB40*/ 00990000
*                                                                  0578 00991000
         ST    @15,J2                                              0578 00992000
         B     @DE00578                                            0578 00993000
@DL00578 DS    0H                                                  0579 00994000
*                 /***************************************************/ 00995000
*                 /*                                                 */ 00996000
*                 /* ISSUE UPRINT FOR MAIN SECTOR HEADER     @Z40LB40*/ 00997000
*                 /*                                                 */ 00998000
*                 /***************************************************/ 00999000
*                                                                  0579 01000000
*                 PRINTAB=''B;      /*                       @Z40LB40*/ 01001000
         XC    PRINTAB(44),PRINTAB                                 0579 01002000
*                 DARGSMOD=DUMSGMOD;/*                       @Z40LB40*/ 01003000
         L     @02,DDSTRU                                          0580 01004000
         MVC   DARGSMOD(3,@02),@CC01334                            0580 01005000
*                 DARGSENT=HMAINSCT;/*                       @Z40LB40*/ 01006000
         MVI   DARGSENT(@02),X'25'                                 0581 01007000
*                 CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HDR  0582 01008000
*                                                            @Z40LB40*/ 01009000
         L     @02,@PC00001                                        0582 01010000
         ST    @02,@AL00001                                        0582 01011000
         LA    @15,PRPTR                                           0582 01012000
         ST    @15,@AL00001+4                                      0582 01013000
         LA    @15,DDSTRU                                          0582 01014000
         ST    @15,@AL00001+8                                      0582 01015000
         MVI   @AL00001+8,X'80'                                    0582 01016000
         L     @15,GDTPRT(,@02)                                    0582 01017000
         LA    @01,@AL00001                                        0582 01018000
         BALR  @14,@15                                             0582 01019000
*                 SECTADDR=J2;      /* SET SECTOR ADDRESS    @Z40LB40*/ 01020000
         L     SECTADDR,J2                                         0583 01021000
*                 NUMBYTES=SECTSIZE;/* SET NO. OF BYTES      @Z40LB40*/ 01022000
         MVC   NUMBYTES(4),@CF01321                                0584 01023000
*                 CALL PRNTSECT;    /*                       @Z40LB40*/ 01024000
         BAL   @14,PRNTSECT                                        0585 01025000
*               END;                /*                       @Z40LB40*/ 01026000
         LA    @15,256                                             0586 01027000
         AL    @15,J2                                              0586 01028000
         ST    @15,J2                                              0586 01029000
@DE00578 C     @15,HISECT                                          0586 01030000
         BNH   @DL00578                                            0586 01031000
*             END;                  /*                       @Z40LB40*/ 01032000
*         END;                      /*                       @Z40LB40*/ 01033000
@RC00560 LA    @15,1                                               0588 01034000
         AL    @15,I2                                              0588 01035000
@DE00555 ST    @15,I2                                              0588 01036000
         L     @14,@PC00001+4                                      0588 01037000
         LA    @14,FDTPTR+8(,@14)                                  0588 01038000
         C     @15,MSCTMCNT(,@14)                                  0588 01039000
         BNH   @DL00555                                            0588 01040000
*     END;                          /*                       @Z40LB40*/ 01041000
*                                                                  0589 01042000
@RF00554 DS    0H                                                  0590 01043000
*   /*****************************************************************/ 01044000
*   /*                                                               */ 01045000
*   /* IF EXTENDEDSECTOR SPECIFIED THEN GETDATA MUST BE      @Z40LB40*/ 01046000
*   /* CALLED TO READ ALL OF MSC EXTENDED STORAGE            @Z40LB40*/ 01047000
*   /*                                                               */ 01048000
*   /*****************************************************************/ 01049000
*                                                                  0590 01050000
*   IF MSCTECNT^=0 THEN                                            0590 01051000
@RF00523 L     @15,@PC00001+4                                      0590 01052000
         LA    @15,FDTPTR+12(,@15)                                 0590 01053000
         L     @15,MSCTECNT(,@15)                                  0590 01054000
         LTR   @15,@15                                             0590 01055000
         BZ    @RF00590                                            0590 01056000
*     DO;                           /*                       @Z40LB40*/ 01057000
*       CALL GETDATA(MSCE);         /* PASS MSCE AS PARM     @Z40LB40*/ 01058000
         LA    @01,@AL00592                                        0592 01059000
         BAL   @14,GETDATA                                         0592 01060000
*       RESPECIFY                                                  0593 01061000
*         RTNREG RSTD;                                             0593 01062000
*       TESTRC=RTNREG;                                             0594 01063000
         LR    TESTRC,RTNREG                                       0594 01064000
*       RESPECIFY                                                  0595 01065000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 01066000
*       IF TESTRC^=LASTCC00 THEN    /* WAS ALL DATA READ     @Z40LB40*/ 01067000
         LTR   TESTRC,TESTRC                                       0596 01068000
         BZ    @RF00596                                            0596 01069000
*         DO;                       /*                       @Z40LB40*/ 01070000
*                                                                  0597 01071000
*           /*********************************************************/ 01072000
*           /*                                                       */ 01073000
*           /* NO,ISSUE ERROR MESSAGE                        @Z40LB40*/ 01074000
*           /*                                                       */ 01075000
*           /*********************************************************/ 01076000
*                                                                  0598 01077000
*           PRINTAB=''B;            /*                       @Z40LB40*/ 01078000
         XC    PRINTAB(44),PRINTAB                                 0598 01079000
*           DARGSMOD=DUMSGMOD;      /*                       @Z40LB40*/ 01080000
         L     @15,DDSTRU                                          0599 01081000
         MVC   DARGSMOD(3,@15),@CC01334                            0599 01082000
*           DARGSENT=IDC21102;      /*                       @Z40LB40*/ 01083000
         MVI   DARGSENT(@15),X'03'                                 0600 01084000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB40*/ 01085000
         L     @15,@PC00001                                        0601 01086000
         ST    @15,@AL00001                                        0601 01087000
         LA    @14,@CF00118                                        0601 01088000
         ST    @14,@AL00001+4                                      0601 01089000
         LA    @14,DDSTRU                                          0601 01090000
         ST    @14,@AL00001+8                                      0601 01091000
         MVI   @AL00001+8,X'80'                                    0601 01092000
         L     @15,GDTPRT(,@15)                                    0601 01093000
         LA    @01,@AL00001                                        0601 01094000
         BALR  @14,@15                                             0601 01095000
*           MSCRC=LASTCC04;         /* SET RET.CODE          @Z40LB40*/ 01096000
         MVC   MSCRC(2),@CH00044                                   0602 01097000
*         END;                      /*                       @Z40LB40*/ 01098000
*       ELSE                                                       0604 01099000
*         GOTMSCE=ON;               /* YES,INDICATE IT       @Z40LB40*/ 01100000
         B     @RC00596                                            0604 01101000
@RF00596 OI    GOTMSCE,B'00010000'                                 0604 01102000
*       IF GOTMSCE=ON THEN                                         0605 01103000
@RC00596 TM    GOTMSCE,B'00010000'                                 0605 01104000
         BNO   @RF00605                                            0605 01105000
*         DO I2=1 TO MSCTECNT;      /*                       @Z40LB40*/ 01106000
*                                                                  0606 01107000
         LA    @15,1                                               0606 01108000
         B     @DE00606                                            0606 01109000
@DL00606 DS    0H                                                  0607 01110000
*           /*********************************************************/ 01111000
*           /*                                                       */ 01112000
*           /* MSC EXTENDED STORAGE READ OK. CALL PRNTSECT   @Z40LB40*/ 01113000
*           /* FOR EACH SECTOR SPECIFIED EITHER SINGLY       @Z40LB40*/ 01114000
*           /* OR AS PART OF A RANGE.                        @Z40LB40*/ 01115000
*           /*                                                       */ 01116000
*           /*********************************************************/ 01117000
*                                                                  0607 01118000
*           LOSECT=MELOPTR(I2)->MELOVAL;/* SAVE LOW VALUE    @Z40LB40*/ 01119000
         SLA   @15,2                                               0607 01120000
         L     @14,@PC00001+4                                      0607 01121000
         L     @01,FDTPTR+68(,@14)                                 0607 01122000
         AL    @01,@CF01753                                        0607 01123000
         L     @01,MELOPTR(@15,@01)                                0607 01124000
         L     @07,MELOVAL(,@01)                                   0607 01125000
         ST    @07,LOSECT                                          0607 01126000
*           IF MEHIPTR(I2)=NULLPTR THEN/* IF NOT RANGE       @Z40LB40*/ 01127000
         L     @01,FDTPTR+72(,@14)                                 0608 01128000
         AL    @01,@CF01753                                        0608 01129000
         L     @06,MEHIPTR(@15,@01)                                0608 01130000
         LTR   @06,@06                                             0608 01131000
         BNZ   @RF00608                                            0608 01132000
*             HISECT=LOSECT;        /* MAKE VALUES SAME      @Z40LB40*/ 01133000
         ST    @07,HISECT                                          0609 01134000
*           ELSE                                                   0610 01135000
*             HISECT=MEHIPTR(I2)->MEHIVAL;/* SAVE HIGH VALUE @Z40LB40*/ 01136000
         B     @RC00608                                            0610 01137000
@RF00608 L     @15,I2                                              0610 01138000
         SLA   @15,2                                               0610 01139000
         L     @14,@PC00001+4                                      0610 01140000
         L     @01,FDTPTR+72(,@14)                                 0610 01141000
         AL    @01,@CF01753                                        0610 01142000
         L     @01,MEHIPTR(@15,@01)                                0610 01143000
         L     @15,MEHIVAL(,@01)                                   0610 01144000
         ST    @15,HISECT                                          0610 01145000
*           IF LOSECT>HISECT THEN                                  0611 01146000
@RC00608 L     @15,LOSECT                                          0611 01147000
         C     @15,HISECT                                          0611 01148000
         BNH   @RF00611                                            0611 01149000
*             DO;                   /*                       @Z40LB40*/ 01150000
*                                                                  0612 01151000
*               /*****************************************************/ 01152000
*               /*                                                   */ 01153000
*               /* INVALID RANGE SPECIFIED. ISSUE ERROR      @Z40LB40*/ 01154000
*               /* MESSAGE AND SET RETURN CODE.              @Z40LB40*/ 01155000
*               /*                                                   */ 01156000
*               /*****************************************************/ 01157000
*                                                                  0613 01158000
*               PRINTAB=''B;        /*                       @Z40LB40*/ 01159000
         XC    PRINTAB(44),PRINTAB                                 0613 01160000
*               DARGSMOD=DUMSGMOD;  /*                       @Z40LB40*/ 01161000
         L     @15,DDSTRU                                          0614 01162000
         MVC   DARGSMOD(3,@15),@CC01334                            0614 01163000
*               DARGSENT=IDC21101;  /*                       @Z40LB40*/ 01164000
         MVI   DARGSENT(@15),X'02'                                 0615 01165000
*               DARGCNT=2;          /*                       @Z40LB40*/ 01166000
         LA    @14,2                                               0616 01167000
         STH   @14,DARGCNT(,@15)                                   0616 01168000
*               DARGINS(1)=1;       /*                       @Z40LB40*/ 01169000
         LA    @07,1                                               0617 01170000
         STH   @07,DARGINS(,@15)                                   0617 01171000
*               DARGINL(1)=1;       /*                       @Z40LB40*/ 01172000
         STH   @07,DARGINL(,@15)                                   0618 01173000
*               DARGDTM(1)=ADDR(LOSECT)+3;/*                 @Z40LB40*/ 01174000
         LA    @06,3                                               0619 01175000
         LA    @05,LOSECT                                          0619 01176000
         ALR   @05,@06                                             0619 01177000
         ST    @05,DARGDTM(,@15)                                   0619 01178000
*               DARGINS(2)=2;       /*                       @Z40LB40*/ 01179000
         STH   @14,DARGINS+8(,@15)                                 0620 01180000
*               DARGINL(2)=1;       /*                       @Z40LB40*/ 01181000
         STH   @07,DARGINL+8(,@15)                                 0621 01182000
*               DARGDTM(2)=ADDR(HISECT)+3;/*                 @Z40LB40*/ 01183000
         LA    @14,HISECT                                          0622 01184000
         ALR   @14,@06                                             0622 01185000
         ST    @14,DARGDTM+8(,@15)                                 0622 01186000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB40*/ 01187000
         L     @15,@PC00001                                        0623 01188000
         ST    @15,@AL00001                                        0623 01189000
         LA    @14,@CF00118                                        0623 01190000
         ST    @14,@AL00001+4                                      0623 01191000
         LA    @14,DDSTRU                                          0623 01192000
         ST    @14,@AL00001+8                                      0623 01193000
         MVI   @AL00001+8,X'80'                                    0623 01194000
         L     @15,GDTPRT(,@15)                                    0623 01195000
         LA    @01,@AL00001                                        0623 01196000
         BALR  @14,@15                                             0623 01197000
*               MSCRC=LASTCC04;     /* SET RET.CODE          @Z40LB40*/ 01198000
         MVC   MSCRC(2),@CH00044                                   0624 01199000
*             END;                  /*                       @Z40LB40*/ 01200000
*           ELSE                                                   0626 01201000
*             DO;                   /*                       @Z40LB40*/ 01202000
*                                                                  0626 01203000
         B     @RC00611                                            0626 01204000
@RF00611 DS    0H                                                  0627 01205000
*               /*****************************************************/ 01206000
*               /*                                                   */ 01207000
*               /* RANGE OK, SET PRINT HEADER AND CALL       @Z40LB40*/ 01208000
*               /* PRNTSECT TO PRINT SECTOR(S)               @Z40LB40*/ 01209000
*               /*                                                   */ 01210000
*               /*****************************************************/ 01211000
*                                                                  0627 01212000
*               HISECT=HISECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 01213000
         L     @15,HISECT                                          0627 01214000
         SLA   @15,8                                               0627 01215000
         ST    @15,HISECT                                          0627 01216000
*               LOSECT=LOSECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 01217000
         L     @15,LOSECT                                          0628 01218000
         SLA   @15,8                                               0628 01219000
         ST    @15,LOSECT                                          0628 01220000
*               DO J2=LOSECT TO HISECT BY SECTSIZE;/*        @Z40LB40*/ 01221000
*                                                                  0629 01222000
         ST    @15,J2                                              0629 01223000
         B     @DE00629                                            0629 01224000
@DL00629 DS    0H                                                  0630 01225000
*                 /***************************************************/ 01226000
*                 /*                                                 */ 01227000
*                 /* ISSUE UPRINT FOR EXTENDED SECTOR HEADER @Z40LB40*/ 01228000
*                 /*                                                 */ 01229000
*                 /***************************************************/ 01230000
*                                                                  0630 01231000
*                 PRINTAB=''B;      /*                       @Z40LB40*/ 01232000
         XC    PRINTAB(44),PRINTAB                                 0630 01233000
*                 DARGSMOD=DUMSGMOD;/*                       @Z40LB40*/ 01234000
         L     @02,DDSTRU                                          0631 01235000
         MVC   DARGSMOD(3,@02),@CC01334                            0631 01236000
*                 DARGSENT=HEXTSCT; /*                       @Z40LB40*/ 01237000
         MVI   DARGSENT(@02),X'26'                                 0632 01238000
*                 CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HDR  0633 01239000
*                                                            @Z40LB40*/ 01240000
         L     @02,@PC00001                                        0633 01241000
         ST    @02,@AL00001                                        0633 01242000
         LA    @15,PRPTR                                           0633 01243000
         ST    @15,@AL00001+4                                      0633 01244000
         LA    @15,DDSTRU                                          0633 01245000
         ST    @15,@AL00001+8                                      0633 01246000
         MVI   @AL00001+8,X'80'                                    0633 01247000
         L     @15,GDTPRT(,@02)                                    0633 01248000
         LA    @01,@AL00001                                        0633 01249000
         BALR  @14,@15                                             0633 01250000
*                 SECTADDR=J2;      /* SET SECTOR ADDRESS    @Z40LB40*/ 01251000
         L     SECTADDR,J2                                         0634 01252000
*                 NUMBYTES=SECTSIZE;/* SET NO. OF BYTES      @Z40LB40*/ 01253000
         MVC   NUMBYTES(4),@CF01321                                0635 01254000
*                 CALL PRNTSECT;    /*                       @Z40LB40*/ 01255000
         BAL   @14,PRNTSECT                                        0636 01256000
*               END;                /*                       @Z40LB40*/ 01257000
         LA    @15,256                                             0637 01258000
         AL    @15,J2                                              0637 01259000
         ST    @15,J2                                              0637 01260000
@DE00629 C     @15,HISECT                                          0637 01261000
         BNH   @DL00629                                            0637 01262000
*             END;                  /*                       @Z40LB40*/ 01263000
*         END;                      /*                       @Z40LB40*/ 01264000
@RC00611 LA    @15,1                                               0639 01265000
         AL    @15,I2                                              0639 01266000
@DE00606 ST    @15,I2                                              0639 01267000
         L     @14,@PC00001+4                                      0639 01268000
         LA    @14,FDTPTR+12(,@14)                                 0639 01269000
         C     @15,MSCTECNT(,@14)                                  0639 01270000
         BNH   @DL00606                                            0639 01271000
*     END;                          /*                       @Z40LB40*/ 01272000
*                                                                  0640 01273000
@RF00605 DS    0H                                                  0641 01274000
*   /*****************************************************************/ 01275000
*   /*                                                               */ 01276000
*   /* RESET HEADLINES                                       @Z40LB40*/ 01277000
*   /*                                                               */ 01278000
*   /*****************************************************************/ 01279000
*                                                                  0641 01280000
*   CALL AMSTP044(GDTTBL,PRPTR);    /*                       @Z40LB40*/ 01281000
@RF00590 L     @15,@PC00001                                        0641 01282000
         ST    @15,@AL00001                                        0641 01283000
         LA    @14,PRPTR                                           0641 01284000
         ST    @14,@AL00001+4                                      0641 01285000
         MVI   @AL00001+4,X'80'                                    0641 01286000
         L     @15,GDTRES(,@15)                                    0641 01287000
         LA    @01,@AL00001                                        0641 01288000
         BALR  @14,@15                                             0641 01289000
*   RFY                                                            0642 01290000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 01291000
*   REG14=RETADDR1;                 /* SET RETURN POINT      @Z40LB40*/ 01292000
         L     REG14,RETADDR1                                      0643 01293000
*   RETURN CODE(MSCRC);             /* RETURN TO CALLER      @Z40LB40*/ 01294000
         LH    @15,MSCRC                                           0644 01295000
@EL00002 DS    0H                                                  0644 01296000
@EF00002 DS    0H                                                  0644 01297000
@ER00002 BR    @14                                                 0644 01298000
*   RFY                                                            0645 01299000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 01300000
*   END DUMPMSC;                    /*                       @Z40LB40*/ 01301000
*                                                                  0647 01302000
*   /*****************************************************************/ 01303000
*   /*                                                               */ 01304000
*   /* PROCEDURE NAME - DUMPSA (LEVEL 2)                     @Z40LB40*/ 01305000
*   /*                                                       @Z40LB40*/ 01306000
*   /* FUNCTION - THIS ROUTINE CALLS THE ROUTINES THAT       @Z40LB40*/ 01307000
*   /* PRODUCE FORMATTED AND/OR UNFORMATTED                  @Z40LB40*/ 01308000
*   /* DUMPS OF SA MAIN AND EXTENDED STORAGE.                @Z40LB40*/ 01309000
*   /* GETDATA IS CALLED TO READ ALL OF SA                   @Z40LB40*/ 01310000
*   /* MAIN OR EXT. STORAGE. VAD, VVIT,ZEROBDY,              @Z40LB40*/ 01311000
*   /* DCBS,SAMSGQUE,AUT,LTR,SASENSE,PST,SAEC,               @ZD00050*/ 01312000
*   /* LRU, SASTATUS AND PRNTSECT ARE CALLED                 @Z40LB40*/ 01313000
*   /* TO DO THE ACTUAL PRINTING OF THE USER                 @Z40LB40*/ 01314000
*   /* REQUESTED PORTIONS OF STORAGE.                        @Z40LB40*/ 01315000
*   /*                                                       @Z40LB40*/ 01316000
*   /* INPUT - FUNCTION DESCRIPTION TABLE AND INDEX VALUE    @Z40LB40*/ 01317000
*   /* OF WHICH SSID TO WORK WITH.                           @Z40LB40*/ 01318000
*   /*                                                       @Z40LB40*/ 01319000
*   /* OUTPUT - RETURN CODE                                  @Z40LB40*/ 01320000
*   /* 0 = EVERYTHING OK                                     @Z40LB40*/ 01321000
*   /* 4 = USER ENTERED DATA INCORRECTLY, BUT                @Z40LB40*/ 01322000
*   /* REMAINDER OF THE FUNCTIONS WERE                       @Z40LB40*/ 01323000
*   /* ATTEMPTED, OR GETDATA FAILED WHEN                     @Z40LB40*/ 01324000
*   /* READING MSC STORAGE.                                  @Z40LB40*/ 01325000
*   /*                                                               */ 01326000
*   /*****************************************************************/ 01327000
*                                                                  0647 01328000
*DUMPSA:                                                           0647 01329000
*   PROCEDURE(S1) OPTIONS(NOSAVE,NOSAVEAREA);/*              @Z40LB40*/ 01330000
DUMPSA   MVC   @PC00003(4),0(@01)                                  0647 01331000
*   DCL                                                            0648 01332000
*     S1 FIXED(31);                 /* SSID INDEX VALUE      @Z40LB40*/ 01333000
*   RFY                                                            0649 01334000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 01335000
*   RETADDR1=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 01336000
         ST    REG14,RETADDR1                                      0650 01337000
*   RFY                                                            0651 01338000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 01339000
*   OLDERID2=NEWERID2;                                             0652 01340000
         L     @15,@PC00001                                        0652 01341000
         L     @14,GDTTR2(,@15)                                    0652 01342000
         MVC   @TS00001(95),NEWERID2(@14)                          0652 01343000
         MVC   OLDERID2(95,@14),@TS00001                           0652 01344000
*   NEWID2='DUBB';                  /*                       @Z40LB40*/ 01345000
         MVC   NEWID2(4,@14),@CC01481                              0653 01346000
*   SARC=LASTCC00;                  /* INIT RETURN CODE      @Z40LB40*/ 01347000
         SLR   @14,@14                                             0654 01348000
         STH   @14,SARC                                            0654 01349000
*   GOTSAM=OFF;                     /* TURN OFF GOTSAM       @Z40LB40*/ 01350000
*   GOTSAE=OFF;                     /* TURN OFF GOTSAE       @Z40LB40*/ 01351000
*   EXERR=OFF;                      /* TURN OFF EXT. ERROR   @ZD00050*/ 01352000
*                                                                  0657 01353000
         NI    GOTSAM,B'11110010'                                  0657 01354000
*   /*****************************************************************/ 01355000
*   /*                                                               */ 01356000
*   /* ISSUE UESTA MACRO FOR PRINT HEADERS                   @Z40LB40*/ 01357000
*   /*                                                               */ 01358000
*   /*****************************************************************/ 01359000
*                                                                  0658 01360000
*   PCARG=''B;                      /*                       @Z40LB40*/ 01361000
         XC    PCARG(33),PCARG                                     0658 01362000
*   STBUFFER=' ';                   /* BLANK BUFFER          @Z40LB40*/ 01363000
         MVI   STBUFFER+1,C' '                                     0659 01364000
         MVC   STBUFFER+2(119),STBUFFER+1                          0659 01365000
         MVI   STBUFFER,C' '                                       0659 01366000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 01367000
         XC    PRINTAB(44),PRINTAB                                 0660 01368000
*   DARGRETP=ADDR(STBUFFER);        /* ADDR OF RETURN        @Z40LB40*/ 01369000
         L     @14,DDSTRU                                          0661 01370000
         LA    @07,STBUFFER                                        0661 01371000
         ST    @07,DARGRETP(,@14)                                  0661 01372000
*   DARGRETL=LENGTH(STBUFFER);      /* LENGTH OF RETURN      @Z40LB40*/ 01373000
         MVC   DARGRETL(2,@14),@CH01251                            0662 01374000
*   DARGSMOD=DUMSGMOD;              /* SET TEXT ID           @Z40LB40*/ 01375000
         MVC   DARGSMOD(3,@14),@CC01334                            0663 01376000
*   DARGSENT=TSAD;                  /* SET ENTRY NO.         @Z40LB40*/ 01377000
         MVI   DARGSENT(@14),X'0B'                                 0664 01378000
*   DARGCNT=1;                      /* SET 1 INSERT          @Z40LB40*/ 01379000
         LA    @07,1                                               0665 01380000
         STH   @07,DARGCNT(,@14)                                   0665 01381000
*   DARGINS(1)=1;                   /* SET INSERT NO.        @Z40LB40*/ 01382000
         STH   @07,DARGINS(,@14)                                   0666 01383000
*   DARGINL(1)=2;                   /* SET INSERT SIZE       @Z40LB40*/ 01384000
         LA    @07,2                                               0667 01385000
         STH   @07,DARGINL(,@14)                                   0667 01386000
*   DARGDTM(1)=(SSIDPTR(S1))+2;     /* SET INSERT ADDR       @Z40LB40*/ 01387000
         L     @06,@PC00003                                        0668 01388000
         L     @06,S1(,@06)                                        0668 01389000
         SLA   @06,2                                               0668 01390000
         L     @05,@PC00001+4                                      0668 01391000
         L     @01,FDTPTR+20(,@05)                                 0668 01392000
         AL    @01,@CF01753                                        0668 01393000
         AL    @07,SSIDPTR(@06,@01)                                0668 01394000
         ST    @07,DARGDTM(,@14)                                   0668 01395000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* READ IN SUBTITLE @Z40LB40*/ 01396000
         ST    @15,@AL00001                                        0669 01397000
         LA    @14,@CF00118                                        0669 01398000
         ST    @14,@AL00001+4                                      0669 01399000
         LA    @14,DDSTRU                                          0669 01400000
         ST    @14,@AL00001+8                                      0669 01401000
         MVI   @AL00001+8,X'80'                                    0669 01402000
         L     @15,GDTPRT(,@15)                                    0669 01403000
         LA    @01,@AL00001                                        0669 01404000
         BALR  @14,@15                                             0669 01405000
*   PCSTLC=1;                       /* ONE SUBTITLE          @Z40LB40*/ 01406000
         MVC   PCSTLC(2),@CH00223                                  0670 01407000
*   PCSTLP=ADDR(STBUFFER);          /* ADDR OF SUBTITLE      @Z40LB40*/ 01408000
         LA    @15,STBUFFER                                        0671 01409000
         ST    @15,PCSTLP                                          0671 01410000
*   CALL AMSTP042(GDTTBL,PRPTR,PCARG);/* SET SUBTITLE        @Z40LB40*/ 01411000
*                                                                  0672 01412000
         L     @15,@PC00001                                        0672 01413000
         ST    @15,@AL00001                                        0672 01414000
         LA    @14,PRPTR                                           0672 01415000
         ST    @14,@AL00001+4                                      0672 01416000
         LA    @14,PCARG                                           0672 01417000
         ST    @14,@AL00001+8                                      0672 01418000
         L     @15,GDTESA(,@15)                                    0672 01419000
         LA    @01,@AL00001                                        0672 01420000
         BALR  @14,@15                                             0672 01421000
*   /*****************************************************************/ 01422000
*   /*                                                               */ 01423000
*   /* IF FORMAT SPECIFIED OR DEFAULTED TO OR MAINSECTOR     @Z40LB40*/ 01424000
*   /* SPECIFIED THEN GETDATA MUST BE CALLED TO READ ALL     @Z40LB40*/ 01425000
*   /* OF SA MAIN STORAGE PLUS PST FROM EXTENDED STORAGE.    @ZD00043*/ 01426000
*   /*                                                               */ 01427000
*   /*****************************************************************/ 01428000
*                                                                  0673 01429000
*   IF SFMTPTR(S1)^=NULLPTR|SSCTMCNT(S1)^=0 THEN                   0673 01430000
         SLR   @15,@15                                             0673 01431000
         L     @14,@PC00003                                        0673 01432000
         L     @14,S1(,@14)                                        0673 01433000
         SLA   @14,2                                               0673 01434000
         L     @07,@PC00001+4                                      0673 01435000
         L     @01,FDTPTR+24(,@07)                                 0673 01436000
         AL    @01,@CF01753                                        0673 01437000
         C     @15,SFMTPTR(@14,@01)                                0673 01438000
         BNE   @RT00673                                            0673 01439000
         L     @01,FDTPTR+28(,@07)                                 0673 01440000
         AL    @01,@CF01753                                        0673 01441000
         C     @15,SSCTMCNT(@14,@01)                               0673 01442000
         BE    @RF00673                                            0673 01443000
@RT00673 DS    0H                                                  0674 01444000
*     DO;                           /*                       @Z40LB40*/ 01445000
*       CALL GETDATA(SAMA,SSIDPTR(S1)->SSIDVAL);/*           @Z40LB40*/ 01446000
         LA    @15,@CC01348                                        0675 01447000
         ST    @15,@AL00001                                        0675 01448000
         L     @15,@PC00003                                        0675 01449000
         L     @15,S1(,@15)                                        0675 01450000
         SLA   @15,2                                               0675 01451000
         L     @14,@PC00001+4                                      0675 01452000
         L     @01,FDTPTR+20(,@14)                                 0675 01453000
         AL    @01,@CF01753                                        0675 01454000
         L     @01,SSIDPTR(@15,@01)                                0675 01455000
         ST    @01,@AL00001+4                                      0675 01456000
         LA    @01,@AL00001                                        0675 01457000
         BAL   @14,GETDATA                                         0675 01458000
*       RESPECIFY                                                  0676 01459000
*         RTNREG RSTD;                                             0676 01460000
*       TESTRC=RTNREG;                                             0677 01461000
         LR    TESTRC,RTNREG                                       0677 01462000
*       RESPECIFY                                                  0678 01463000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 01464000
*       IF TESTRC^=LASTCC00 THEN    /* WAS ALL DATA READ     @Z40LB40*/ 01465000
         LTR   TESTRC,TESTRC                                       0679 01466000
         BZ    @RF00679                                            0679 01467000
*         DO;                       /*                       @Z40LB40*/ 01468000
*                                                                  0680 01469000
*           /*********************************************************/ 01470000
*           /*                                                       */ 01471000
*           /* ISSUE ERROR MESSAGE                           @Z40LB40*/ 01472000
*           /*                                                       */ 01473000
*           /*********************************************************/ 01474000
*                                                                  0681 01475000
*           PRINTAB=''B;            /*                       @Z40LB40*/ 01476000
         XC    PRINTAB(44),PRINTAB                                 0681 01477000
*           DARGSMOD=DUMSGMOD;      /*                       @Z40LB40*/ 01478000
         L     @15,DDSTRU                                          0682 01479000
         MVC   DARGSMOD(3,@15),@CC01334                            0682 01480000
*           DARGSENT=IDC21104;      /*                       @Z40LB40*/ 01481000
         MVI   DARGSENT(@15),X'05'                                 0683 01482000
*           DARGCNT=1;              /*                       @Z40LB40*/ 01483000
         LA    @14,1                                               0684 01484000
         STH   @14,DARGCNT(,@15)                                   0684 01485000
*           DARGINS(1)=1;           /*                       @Z40LB40*/ 01486000
         STH   @14,DARGINS(,@15)                                   0685 01487000
*           DARGINL(1)=2;           /*                       @Z40LB40*/ 01488000
         LA    @14,2                                               0686 01489000
         STH   @14,DARGINL(,@15)                                   0686 01490000
*           DARGDTM(1)=(SSIDPTR(S1))+2;/*                    @Z40LB40*/ 01491000
         L     @07,@PC00003                                        0687 01492000
         L     @07,S1(,@07)                                        0687 01493000
         SLA   @07,2                                               0687 01494000
         L     @06,@PC00001+4                                      0687 01495000
         L     @01,FDTPTR+20(,@06)                                 0687 01496000
         AL    @01,@CF01753                                        0687 01497000
         AL    @14,SSIDPTR(@07,@01)                                0687 01498000
         ST    @14,DARGDTM(,@15)                                   0687 01499000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB40*/ 01500000
         L     @15,@PC00001                                        0688 01501000
         ST    @15,@AL00001                                        0688 01502000
         LA    @14,@CF00118                                        0688 01503000
         ST    @14,@AL00001+4                                      0688 01504000
         LA    @14,DDSTRU                                          0688 01505000
         ST    @14,@AL00001+8                                      0688 01506000
         MVI   @AL00001+8,X'80'                                    0688 01507000
         L     @15,GDTPRT(,@15)                                    0688 01508000
         LA    @01,@AL00001                                        0688 01509000
         BALR  @14,@15                                             0688 01510000
*           SARC=LASTCC04;          /* SET RET.CODE          @Z40LB40*/ 01511000
         MVC   SARC(2),@CH00044                                    0689 01512000
*         END;                      /*                       @Z40LB40*/ 01513000
*       ELSE                                                       0691 01514000
*         GOTSAM=ON;                /* YES,INDICATE IT       @Z40LB40*/ 01515000
         B     @RC00679                                            0691 01516000
@RF00679 OI    GOTSAM,B'00001000'                                  0691 01517000
*       IF GOTSAM=ON&SFMTPTR(S1)^=NULLPTR THEN                     0692 01518000
@RC00679 TM    GOTSAM,B'00001000'                                  0692 01519000
         BNO   @RF00692                                            0692 01520000
         L     @15,@PC00003                                        0692 01521000
         L     @15,S1(,@15)                                        0692 01522000
         SLA   @15,2                                               0692 01523000
         L     @14,@PC00001+4                                      0692 01524000
         L     @01,FDTPTR+24(,@14)                                 0692 01525000
         AL    @01,@CF01753                                        0692 01526000
         L     @15,SFMTPTR(@15,@01)                                0692 01527000
         LTR   @15,@15                                             0692 01528000
         BZ    @RF00692                                            0692 01529000
*         DO;                       /*                       @Z40LB40*/ 01530000
*                                                                  0693 01531000
*           /*********************************************************/ 01532000
*           /*                                                       */ 01533000
*           /* FORMAT SPECIFIED OR DEFAULTED TO. CALL        @Z40LB40*/ 01534000
*           /* FUNCTIONS PROCEDURES TO PRODUCE THE           @Z40LB40*/ 01535000
*           /* VARIOUS PARTS OF THE FORMATTED DUMP           @Z40LB40*/ 01536000
*           /*                                                       */ 01537000
*           /*********************************************************/ 01538000
*                                                                  0694 01539000
*           CALL SAEC;              /* PRINT EC LEVEL        @ZD00050*/ 01540000
         BAL   @14,SAEC                                            0694 01541000
*           CALL VAD;               /* PRINT VAD             @Z40LB40*/ 01542000
         BAL   @14,VAD                                             0695 01543000
*           CALL VVIT;              /* PRINT VVIT            @Z40LB40*/ 01544000
         BAL   @14,VVIT                                            0696 01545000
*           CALL PST;               /* PRINT PAGE STATUS     @Z40LB40*/ 01546000
         BAL   @14,PST                                             0697 01547000
*           CALL LRU;               /* PRINT LRU VALUES      @Z40LB40*/ 01548000
         BAL   @14,LRU                                             0698 01549000
*           CALL ZEROBDY;           /* PRINT ZERO BDY WDS    @Z40LB40*/ 01550000
         BAL   @14,ZEROBDY                                         0699 01551000
*           CALL DCBS;              /* PRINT DCBS            @Z40LB40*/ 01552000
         BAL   @14,DCBS                                            0700 01553000
*           CALL SAMSGQUE;          /* PRINT SA MSG QUE      @Z40LB40*/ 01554000
         BAL   @14,SAMSGQUE                                        0701 01555000
*           CALL AUT;               /* PRINT AUT             @Z40LB40*/ 01556000
         BAL   @14,AUT                                             0702 01557000
*           CALL LTR;               /* PRINT LTR             @Z40LB40*/ 01558000
         BAL   @14,LTR                                             0703 01559000
*           CALL SASENSE;           /* PRINT SENSE DATA      @Z40LB40*/ 01560000
         BAL   @14,SASENSE                                         0704 01561000
*           CALL SASTATUS;          /* PRINT STATUS INFO     @Z40LB40*/ 01562000
         BAL   @14,SASTATUS                                        0705 01563000
*         END;                      /*                       @Z40LB40*/ 01564000
*       IF GOTSAM=ON&SSCTMCNT(S1)^=0 THEN                          0707 01565000
@RF00692 TM    GOTSAM,B'00001000'                                  0707 01566000
         BNO   @RF00707                                            0707 01567000
         L     @15,@PC00003                                        0707 01568000
         L     @15,S1(,@15)                                        0707 01569000
         SLA   @15,2                                               0707 01570000
         L     @14,@PC00001+4                                      0707 01571000
         L     @01,FDTPTR+28(,@14)                                 0707 01572000
         AL    @01,@CF01753                                        0707 01573000
         L     @15,SSCTMCNT(@15,@01)                               0707 01574000
         LTR   @15,@15                                             0707 01575000
         BZ    @RF00707                                            0707 01576000
*         DO I2=1 TO SSCTMCNT(S1);  /*                       @Z40LB40*/ 01577000
*                                                                  0708 01578000
         LA    @15,1                                               0708 01579000
         B     @DE00708                                            0708 01580000
@DL00708 DS    0H                                                  0709 01581000
*           /*********************************************************/ 01582000
*           /*                                                       */ 01583000
*           /* SA MAIN STORAGE READ OK AND MAINSECTOR ENTERED        */ 01584000
*           /*                                               @Z40LB40*/ 01585000
*           /* CALL PRNTSECT FOR EACH SECTOR SPECIFIED EITHER        */ 01586000
*           /*                                               @Z40LB40*/ 01587000
*           /* SINGLY OR AS PART OF A RANGE.                 @Z40LB40*/ 01588000
*           /*                                                       */ 01589000
*           /*********************************************************/ 01590000
*                                                                  0709 01591000
*           LOSECT=SMLOPTR(S1,I2)->SMLOVAL;/* SAVE LOW VALUE @Z40LB40*/ 01592000
         L     @14,@PC00003                                        0709 01593000
         L     @14,S1(,@14)                                        0709 01594000
         SLA   @14,4                                               0709 01595000
         ALR   @14,@15                                             0709 01596000
         SLA   @14,2                                               0709 01597000
         L     @15,@PC00001+4                                      0709 01598000
         L     @01,FDTPTR+76(,@15)                                 0709 01599000
         AL    @01,@CF01757                                        0709 01600000
         L     @01,SMLOPTR(@14,@01)                                0709 01601000
         L     @07,SMLOVAL(,@01)                                   0709 01602000
         ST    @07,LOSECT                                          0709 01603000
*           IF SMHIPTR(S1,I2)=NULLPTR THEN/* IF NOT RANGE    @Z40LB40*/ 01604000
         L     @01,FDTPTR+80(,@15)                                 0710 01605000
         AL    @01,@CF01757                                        0710 01606000
         L     @06,SMHIPTR(@14,@01)                                0710 01607000
         LTR   @06,@06                                             0710 01608000
         BNZ   @RF00710                                            0710 01609000
*             HISECT=LOSECT;        /* MAKE VALUES SAME      @Z40LB40*/ 01610000
         ST    @07,HISECT                                          0711 01611000
*           ELSE                                                   0712 01612000
*             HISECT=SMHIPTR(S1,I2)->SMHIVAL;/* SAVE HI VALUE@Z40LB40*/ 01613000
         B     @RC00710                                            0712 01614000
@RF00710 L     @15,@PC00003                                        0712 01615000
         L     @15,S1(,@15)                                        0712 01616000
         SLA   @15,4                                               0712 01617000
         AL    @15,I2                                              0712 01618000
         SLA   @15,2                                               0712 01619000
         L     @14,@PC00001+4                                      0712 01620000
         L     @01,FDTPTR+80(,@14)                                 0712 01621000
         AL    @01,@CF01757                                        0712 01622000
         L     @01,SMHIPTR(@15,@01)                                0712 01623000
         L     @15,SMHIVAL(,@01)                                   0712 01624000
         ST    @15,HISECT                                          0712 01625000
*           IF LOSECT>HISECT THEN                                  0713 01626000
@RC00710 L     @15,LOSECT                                          0713 01627000
         C     @15,HISECT                                          0713 01628000
         BNH   @RF00713                                            0713 01629000
*             DO;                   /*                       @Z40LB40*/ 01630000
*                                                                  0714 01631000
*               /*****************************************************/ 01632000
*               /*                                                   */ 01633000
*               /* INVALID RANGE SPECIFIED. ISSUE ERROR      @Z40LB40*/ 01634000
*               /* MESSAGE AND SET RETURN CODE.              @Z40LB40*/ 01635000
*               /*                                                   */ 01636000
*               /*****************************************************/ 01637000
*                                                                  0715 01638000
*               PRINTAB=''B;        /*                       @Z40LB40*/ 01639000
         XC    PRINTAB(44),PRINTAB                                 0715 01640000
*               DARGSMOD=DUMSGMOD;  /*                       @Z40LB40*/ 01641000
         L     @15,DDSTRU                                          0716 01642000
         MVC   DARGSMOD(3,@15),@CC01334                            0716 01643000
*               DARGSENT=IDC21101;  /*                       @Z40LB40*/ 01644000
         MVI   DARGSENT(@15),X'02'                                 0717 01645000
*               DARGCNT=2;          /*                       @Z40LB40*/ 01646000
         LA    @14,2                                               0718 01647000
         STH   @14,DARGCNT(,@15)                                   0718 01648000
*               DARGINS(1)=1;       /*                       @Z40LB40*/ 01649000
         LA    @07,1                                               0719 01650000
         STH   @07,DARGINS(,@15)                                   0719 01651000
*               DARGINL(1)=1;       /*                       @Z40LB40*/ 01652000
         STH   @07,DARGINL(,@15)                                   0720 01653000
*               DARGDTM(1)=ADDR(LOSECT)+3;/*                 @Z40LB40*/ 01654000
         LA    @06,3                                               0721 01655000
         LA    @05,LOSECT                                          0721 01656000
         ALR   @05,@06                                             0721 01657000
         ST    @05,DARGDTM(,@15)                                   0721 01658000
*               DARGINS(2)=2;       /*                       @Z40LB40*/ 01659000
         STH   @14,DARGINS+8(,@15)                                 0722 01660000
*               DARGINL(2)=1;       /*                       @Z40LB40*/ 01661000
         STH   @07,DARGINL+8(,@15)                                 0723 01662000
*               DARGDTM(2)=ADDR(HISECT)+3;/*                 @Z40LB40*/ 01663000
         LA    @14,HISECT                                          0724 01664000
         ALR   @14,@06                                             0724 01665000
         ST    @14,DARGDTM+8(,@15)                                 0724 01666000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB40*/ 01667000
         L     @15,@PC00001                                        0725 01668000
         ST    @15,@AL00001                                        0725 01669000
         LA    @14,@CF00118                                        0725 01670000
         ST    @14,@AL00001+4                                      0725 01671000
         LA    @14,DDSTRU                                          0725 01672000
         ST    @14,@AL00001+8                                      0725 01673000
         MVI   @AL00001+8,X'80'                                    0725 01674000
         L     @15,GDTPRT(,@15)                                    0725 01675000
         LA    @01,@AL00001                                        0725 01676000
         BALR  @14,@15                                             0725 01677000
*               SARC=LASTCC04;      /* SET RET.CODE          @Z40LB40*/ 01678000
         MVC   SARC(2),@CH00044                                    0726 01679000
*             END;                  /*                       @Z40LB40*/ 01680000
*           ELSE                                                   0728 01681000
*             DO;                   /*                       @Z40LB40*/ 01682000
*                                                                  0728 01683000
         B     @RC00713                                            0728 01684000
@RF00713 DS    0H                                                  0729 01685000
*               /*****************************************************/ 01686000
*               /*                                                   */ 01687000
*               /* RANGE OK,SET PRINT HEADER AND CALL        @Z40LB40*/ 01688000
*               /* PRNTSECT TO PRINT SECTOR(S)               @Z40LB40*/ 01689000
*               /*                                                   */ 01690000
*               /*****************************************************/ 01691000
*                                                                  0729 01692000
*               HISECT=HISECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 01693000
         L     @15,HISECT                                          0729 01694000
         SLA   @15,8                                               0729 01695000
         ST    @15,HISECT                                          0729 01696000
*               LOSECT=LOSECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 01697000
         L     @15,LOSECT                                          0730 01698000
         SLA   @15,8                                               0730 01699000
         ST    @15,LOSECT                                          0730 01700000
*               DO J2=LOSECT TO HISECT BY SECTSIZE;/*        @Z40LB40*/ 01701000
*                                                                  0731 01702000
         ST    @15,J2                                              0731 01703000
         B     @DE00731                                            0731 01704000
@DL00731 DS    0H                                                  0732 01705000
*                 /***************************************************/ 01706000
*                 /*                                                 */ 01707000
*                 /* ISSUE UPRINT FOR MAIN SECTOR HEADER     @Z40LB40*/ 01708000
*                 /*                                                 */ 01709000
*                 /***************************************************/ 01710000
*                                                                  0732 01711000
*                 PRINTAB=''B;      /*                       @Z40LB40*/ 01712000
         XC    PRINTAB(44),PRINTAB                                 0732 01713000
*                 DARGSMOD=DUMSGMOD;/*                       @Z40LB40*/ 01714000
         L     @02,DDSTRU                                          0733 01715000
         MVC   DARGSMOD(3,@02),@CC01334                            0733 01716000
*                 DARGSENT=HMAINSCT;/*                       @Z40LB40*/ 01717000
         MVI   DARGSENT(@02),X'25'                                 0734 01718000
*                 CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HDR  0735 01719000
*                                                            @Z40LB40*/ 01720000
         L     @02,@PC00001                                        0735 01721000
         ST    @02,@AL00001                                        0735 01722000
         LA    @15,PRPTR                                           0735 01723000
         ST    @15,@AL00001+4                                      0735 01724000
         LA    @15,DDSTRU                                          0735 01725000
         ST    @15,@AL00001+8                                      0735 01726000
         MVI   @AL00001+8,X'80'                                    0735 01727000
         L     @15,GDTPRT(,@02)                                    0735 01728000
         LA    @01,@AL00001                                        0735 01729000
         BALR  @14,@15                                             0735 01730000
*                 SECTADDR=J2;      /* SET SECTOR ADDRESS    @Z40LB40*/ 01731000
         L     SECTADDR,J2                                         0736 01732000
*                 NUMBYTES=SECTSIZE;/* SET NO. OF BYTES      @Z40LB40*/ 01733000
         MVC   NUMBYTES(4),@CF01321                                0737 01734000
*                 CALL PRNTSECT;    /*                       @Z40LB40*/ 01735000
         BAL   @14,PRNTSECT                                        0738 01736000
*               END;                /*                       @Z40LB40*/ 01737000
         LA    @15,256                                             0739 01738000
         AL    @15,J2                                              0739 01739000
         ST    @15,J2                                              0739 01740000
@DE00731 C     @15,HISECT                                          0739 01741000
         BNH   @DL00731                                            0739 01742000
*             END;                  /*                       @Z40LB40*/ 01743000
*         END;                      /*                       @Z40LB40*/ 01744000
@RC00713 LA    @15,1                                               0741 01745000
         AL    @15,I2                                              0741 01746000
@DE00708 ST    @15,I2                                              0741 01747000
         L     @14,@PC00003                                        0741 01748000
         L     @14,S1(,@14)                                        0741 01749000
         SLA   @14,2                                               0741 01750000
         L     @07,@PC00001+4                                      0741 01751000
         L     @01,FDTPTR+28(,@07)                                 0741 01752000
         AL    @01,@CF01753                                        0741 01753000
         C     @15,SSCTMCNT(@14,@01)                               0741 01754000
         BNH   @DL00708                                            0741 01755000
*     END;                          /*                       @Z40LB40*/ 01756000
*                                                                  0742 01757000
@RF00707 DS    0H                                                  0743 01758000
*   /*****************************************************************/ 01759000
*   /*                                                               */ 01760000
*   /* IF EXTENDEDSECTOR SPECIFIED THEN GETDATA MUST BE      @Z40LB40*/ 01761000
*   /* CALLED TO READ ALL OF VALID SA EXTENDED STORAGE       @ZD00050*/ 01762000
*   /*                                                               */ 01763000
*   /*****************************************************************/ 01764000
*                                                                  0743 01765000
*   IF SSCTECNT(S1)^=0 THEN                                        0743 01766000
@RF00673 L     @15,@PC00003                                        0743 01767000
         L     @15,S1(,@15)                                        0743 01768000
         SLA   @15,2                                               0743 01769000
         L     @14,@PC00001+4                                      0743 01770000
         L     @01,FDTPTR+32(,@14)                                 0743 01771000
         AL    @01,@CF01753                                        0743 01772000
         L     @07,SSCTECNT(@15,@01)                               0743 01773000
         LTR   @07,@07                                             0743 01774000
         BZ    @RF00743                                            0743 01775000
*     DO;                           /*                       @Z40LB40*/ 01776000
*       CALL GETDATA(SAEX,SSIDPTR(S1)->SSIDVAL);/*           @Z40LB40*/ 01777000
         LA    @07,@CC01350                                        0745 01778000
         ST    @07,@AL00001                                        0745 01779000
         L     @01,FDTPTR+20(,@14)                                 0745 01780000
         AL    @01,@CF01753                                        0745 01781000
         L     @01,SSIDPTR(@15,@01)                                0745 01782000
         ST    @01,@AL00001+4                                      0745 01783000
         LA    @01,@AL00001                                        0745 01784000
         BAL   @14,GETDATA                                         0745 01785000
*       RESPECIFY                                                  0746 01786000
*         RTNREG RSTD;                                             0746 01787000
*       TESTRC=RTNREG;                                             0747 01788000
         LR    TESTRC,RTNREG                                       0747 01789000
*       RESPECIFY                                                  0748 01790000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 01791000
*       IF TESTRC^=LASTCC00 THEN    /* WAS ALL DATA READ     @Z40LB40*/ 01792000
         LTR   TESTRC,TESTRC                                       0749 01793000
         BZ    @RF00749                                            0749 01794000
*         DO;                       /*                       @Z40LB40*/ 01795000
*                                                                  0750 01796000
*           /*********************************************************/ 01797000
*           /*                                                       */ 01798000
*           /* ISSUE ERROR MESSAGE                           @Z40LB40*/ 01799000
*           /*                                                       */ 01800000
*           /*********************************************************/ 01801000
*                                                                  0751 01802000
*           PRINTAB=''B;            /*                       @Z40LB40*/ 01803000
         XC    PRINTAB(44),PRINTAB                                 0751 01804000
*           DARGSMOD=DUMSGMOD;      /*                       @Z40LB40*/ 01805000
         L     @15,DDSTRU                                          0752 01806000
         MVC   DARGSMOD(3,@15),@CC01334                            0752 01807000
*           DARGSENT=IDC21105;      /*                       @Z40LB40*/ 01808000
         MVI   DARGSENT(@15),X'06'                                 0753 01809000
*           DARGCNT=1;              /*                       @Z40LB40*/ 01810000
         LA    @14,1                                               0754 01811000
         STH   @14,DARGCNT(,@15)                                   0754 01812000
*           DARGINS(1)=1;           /*                       @Z40LB40*/ 01813000
         STH   @14,DARGINS(,@15)                                   0755 01814000
*           DARGINL(1)=2;           /*                       @Z40LB40*/ 01815000
         LA    @14,2                                               0756 01816000
         STH   @14,DARGINL(,@15)                                   0756 01817000
*           DARGDTM(1)=(SSIDPTR(S1))+2;/*                    @Z40LB40*/ 01818000
         L     @07,@PC00003                                        0757 01819000
         L     @07,S1(,@07)                                        0757 01820000
         SLA   @07,2                                               0757 01821000
         L     @06,@PC00001+4                                      0757 01822000
         L     @01,FDTPTR+20(,@06)                                 0757 01823000
         AL    @01,@CF01753                                        0757 01824000
         AL    @14,SSIDPTR(@07,@01)                                0757 01825000
         ST    @14,DARGDTM(,@15)                                   0757 01826000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB40*/ 01827000
         L     @15,@PC00001                                        0758 01828000
         ST    @15,@AL00001                                        0758 01829000
         LA    @14,@CF00118                                        0758 01830000
         ST    @14,@AL00001+4                                      0758 01831000
         LA    @14,DDSTRU                                          0758 01832000
         ST    @14,@AL00001+8                                      0758 01833000
         MVI   @AL00001+8,X'80'                                    0758 01834000
         L     @15,GDTPRT(,@15)                                    0758 01835000
         LA    @01,@AL00001                                        0758 01836000
         BALR  @14,@15                                             0758 01837000
*           SARC=LASTCC04;          /* SET RET.CODE          @Z40LB40*/ 01838000
         MVC   SARC(2),@CH00044                                    0759 01839000
*         END;                      /*                       @Z40LB40*/ 01840000
*       ELSE                                                       0761 01841000
*         GOTSAE=ON;                /* YES,INDICATE IT       @Z40LB40*/ 01842000
         B     @RC00749                                            0761 01843000
@RF00749 OI    GOTSAE,B'00000100'                                  0761 01844000
*       IF GOTSAE=ON THEN                                          0762 01845000
@RC00749 TM    GOTSAE,B'00000100'                                  0762 01846000
         BNO   @RF00762                                            0762 01847000
*         DO I2=1 TO SSCTECNT(S1);  /*                       @Z40LB40*/ 01848000
*                                                                  0763 01849000
         LA    @15,1                                               0763 01850000
         B     @DE00763                                            0763 01851000
@DL00763 DS    0H                                                  0764 01852000
*           /*********************************************************/ 01853000
*           /*                                                       */ 01854000
*           /* SA EXTENDED STORAGE READ OK. CALL PRNTSECT    @Z40LB40*/ 01855000
*           /* FOR EACH VALID SECTOR SPECIFIED EITHER SINGLY @ZD00050*/ 01856000
*           /* OR AS PART OF A RANGE.                        @Z40LB40*/ 01857000
*           /*                                                       */ 01858000
*           /*********************************************************/ 01859000
*                                                                  0764 01860000
*           LOSECT=SELOPTR(S1,I2)->SELOVAL;/* SAVE LOW VALUE @Z40LB40*/ 01861000
         L     @14,@PC00003                                        0764 01862000
         L     @14,S1(,@14)                                        0764 01863000
         SLA   @14,4                                               0764 01864000
         ALR   @14,@15                                             0764 01865000
         SLA   @14,2                                               0764 01866000
         L     @15,@PC00001+4                                      0764 01867000
         L     @01,FDTPTR+84(,@15)                                 0764 01868000
         AL    @01,@CF01757                                        0764 01869000
         L     @01,SELOPTR(@14,@01)                                0764 01870000
         L     @07,SELOVAL(,@01)                                   0764 01871000
         ST    @07,LOSECT                                          0764 01872000
*           IF SEHIPTR(S1,I2)=NULLPTR THEN/* IF NOT RANGE    @Z40LB40*/ 01873000
         L     @01,FDTPTR+88(,@15)                                 0765 01874000
         AL    @01,@CF01757                                        0765 01875000
         L     @06,SEHIPTR(@14,@01)                                0765 01876000
         LTR   @06,@06                                             0765 01877000
         BNZ   @RF00765                                            0765 01878000
*             HISECT=LOSECT;        /* MAKE VALUES SAME      @Z40LB40*/ 01879000
         ST    @07,HISECT                                          0766 01880000
*           ELSE                                                   0767 01881000
*             HISECT=SEHIPTR(S1,I2)->SEHIVAL;/* SAVE HI VALUE@Z40LB40*/ 01882000
         B     @RC00765                                            0767 01883000
@RF00765 L     @15,@PC00003                                        0767 01884000
         L     @15,S1(,@15)                                        0767 01885000
         SLA   @15,4                                               0767 01886000
         AL    @15,I2                                              0767 01887000
         SLA   @15,2                                               0767 01888000
         L     @14,@PC00001+4                                      0767 01889000
         L     @01,FDTPTR+88(,@14)                                 0767 01890000
         AL    @01,@CF01757                                        0767 01891000
         L     @01,SEHIPTR(@15,@01)                                0767 01892000
         L     @15,SEHIVAL(,@01)                                   0767 01893000
         ST    @15,HISECT                                          0767 01894000
*           IF LOSECT>HISECT THEN                                  0768 01895000
@RC00765 L     @15,LOSECT                                          0768 01896000
         C     @15,HISECT                                          0768 01897000
         BNH   @RF00768                                            0768 01898000
*             DO;                   /*                       @Z40LB40*/ 01899000
*                                                                  0769 01900000
*               /*****************************************************/ 01901000
*               /*                                                   */ 01902000
*               /* INVALID RANGE SPECIFIED. ISSUE ERROR      @Z40LB40*/ 01903000
*               /* MESSAGE AND SET RETURN CODE.              @Z40LB40*/ 01904000
*               /*                                                   */ 01905000
*               /*****************************************************/ 01906000
*                                                                  0770 01907000
*               PRINTAB=''B;        /*                       @Z40LB40*/ 01908000
         XC    PRINTAB(44),PRINTAB                                 0770 01909000
*               DARGSMOD=DUMSGMOD;  /*                       @Z40LB40*/ 01910000
         L     @15,DDSTRU                                          0771 01911000
         MVC   DARGSMOD(3,@15),@CC01334                            0771 01912000
*               DARGSENT=IDC21101;  /*                       @Z40LB40*/ 01913000
         MVI   DARGSENT(@15),X'02'                                 0772 01914000
*               DARGCNT=2;          /*                       @Z40LB40*/ 01915000
         LA    @14,2                                               0773 01916000
         STH   @14,DARGCNT(,@15)                                   0773 01917000
*               DARGINS(1)=1;       /*                       @Z40LB40*/ 01918000
         LA    @07,1                                               0774 01919000
         STH   @07,DARGINS(,@15)                                   0774 01920000
*               DARGINL(1)=1;       /*                       @Z40LB40*/ 01921000
         STH   @07,DARGINL(,@15)                                   0775 01922000
*               DARGDTM(1)=ADDR(LOSECT)+3;/*                 @Z40LB40*/ 01923000
         LA    @06,3                                               0776 01924000
         LA    @05,LOSECT                                          0776 01925000
         ALR   @05,@06                                             0776 01926000
         ST    @05,DARGDTM(,@15)                                   0776 01927000
*               DARGINS(2)=2;       /*                       @Z40LB40*/ 01928000
         STH   @14,DARGINS+8(,@15)                                 0777 01929000
*               DARGINL(2)=1;       /*                       @Z40LB40*/ 01930000
         STH   @07,DARGINL+8(,@15)                                 0778 01931000
*               DARGDTM(2)=ADDR(HISECT)+3;/*                 @Z40LB40*/ 01932000
         LA    @14,HISECT                                          0779 01933000
         ALR   @14,@06                                             0779 01934000
         ST    @14,DARGDTM+8(,@15)                                 0779 01935000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB40*/ 01936000
         L     @15,@PC00001                                        0780 01937000
         ST    @15,@AL00001                                        0780 01938000
         LA    @14,@CF00118                                        0780 01939000
         ST    @14,@AL00001+4                                      0780 01940000
         LA    @14,DDSTRU                                          0780 01941000
         ST    @14,@AL00001+8                                      0780 01942000
         MVI   @AL00001+8,X'80'                                    0780 01943000
         L     @15,GDTPRT(,@15)                                    0780 01944000
         LA    @01,@AL00001                                        0780 01945000
         BALR  @14,@15                                             0780 01946000
*               SARC=LASTCC04;      /* SET RET.CODE          @Z40LB40*/ 01947000
         MVC   SARC(2),@CH00044                                    0781 01948000
*             END;                  /*                       @Z40LB40*/ 01949000
*           ELSE                                                   0783 01950000
*             DO;                   /*                       @Z40LB40*/ 01951000
*                                                                  0783 01952000
         B     @RC00768                                            0783 01953000
@RF00768 DS    0H                                                  0784 01954000
*               /*****************************************************/ 01955000
*               /*                                                   */ 01956000
*               /* RANGE OK, SET PRINT HEADER AND CALL       @Z40LB40*/ 01957000
*               /* PRNTSECT TO PRINT VALID SECTOR(S).        @ZD00050*/ 01958000
*               /* FOR INVALID SECTORS, SET ERROR FLAG AND   @ZD00050*/ 01959000
*               /* SKIP TO NEXT SECTOR.                      @ZD00050*/ 01960000
*               /*                                                   */ 01961000
*               /*****************************************************/ 01962000
*                                                                  0784 01963000
*               HISECT=HISECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 01964000
         L     @15,HISECT                                          0784 01965000
         SLA   @15,8                                               0784 01966000
         ST    @15,HISECT                                          0784 01967000
*               LOSECT=LOSECT*SECTSIZE;/* GEN.SECTOR ADDR.   @Z40LB40*/ 01968000
         L     @15,LOSECT                                          0785 01969000
         SLA   @15,8                                               0785 01970000
         ST    @15,LOSECT                                          0785 01971000
*               DO J2=LOSECT TO HISECT BY SECTSIZE;/*        @Z40LB40*/ 01972000
         ST    @15,J2                                              0786 01973000
         B     @DE00786                                            0786 01974000
@DL00786 DS    0H                                                  0787 01975000
*                 K2=(J2/4096)+1;   /* CHECK FOR VALID SECT  @ZD00050*/ 01976000
         LR    @00,@15                                             0787 01977000
         SRDA  @00,32                                              0787 01978000
         D     @00,@CF01493                                        0787 01979000
         AL    @01,@CF00223                                        0787 01980000
         LR    K2,@01                                              0787 01981000
*                 IF EXARRAY(K2)=VALID THEN                        0788 01982000
         LA    @03,EXARRAY-1(K2)                                   0788 01983000
         CLI   0(@03),C'1'                                         0788 01984000
         BNE   @RF00788                                            0788 01985000
*                   DO;             /*                       @ZD00050*/ 01986000
*                                                                  0789 01987000
*                     /***********************************************/ 01988000
*                     /*                                             */ 01989000
*                     /* ISSUE UPRINT FOR EXTENDED SECTOR HEAD       */ 01990000
*                     /*                                     @ZD00050*/ 01991000
*                     /*                                             */ 01992000
*                     /***********************************************/ 01993000
*                                                                  0790 01994000
*                     PRINTAB=''B;  /*                       @ZD00050*/ 01995000
         XC    PRINTAB(44),PRINTAB                                 0790 01996000
*                     DARGSMOD=DUMSGMOD;/*                   @ZD00050*/ 01997000
         L     @02,DDSTRU                                          0791 01998000
         MVC   DARGSMOD(3,@02),@CC01334                            0791 01999000
*                     DARGSENT=HEXTSCT;/*                    @ZD00050*/ 02000000
         MVI   DARGSENT(@02),X'26'                                 0792 02001000
*                     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HD    02002000
*                                                            @ZD00050*/ 02003000
         L     @02,@PC00001                                        0793 02004000
         ST    @02,@AL00001                                        0793 02005000
         LA    @15,PRPTR                                           0793 02006000
         ST    @15,@AL00001+4                                      0793 02007000
         LA    @15,DDSTRU                                          0793 02008000
         ST    @15,@AL00001+8                                      0793 02009000
         MVI   @AL00001+8,X'80'                                    0793 02010000
         L     @15,GDTPRT(,@02)                                    0793 02011000
         LA    @01,@AL00001                                        0793 02012000
         BALR  @14,@15                                             0793 02013000
*                     SECTADDR=J2;  /* SET SECTOR ADDRESS    @ZD00050*/ 02014000
         L     SECTADDR,J2                                         0794 02015000
*                     NUMBYTES=SECTSIZE;/* SET NO. OF BYTES  @ZD00050*/ 02016000
         MVC   NUMBYTES(4),@CF01321                                0795 02017000
*                     CALL PRNTSECT;/*                       @ZD00050*/ 02018000
         BAL   @14,PRNTSECT                                        0796 02019000
*                   END;            /*                       @ZD00050*/ 02020000
*                 ELSE                                             0798 02021000
*                   EXERR=ON;       /* SET INVALID SECTOR    @ZD00050*/ 02022000
         B     @RC00788                                            0798 02023000
@RF00788 OI    EXERR,B'00000001'                                   0798 02024000
*               END;                /*                       @Z40LB40*/ 02025000
@RC00788 LA    @15,256                                             0799 02026000
         AL    @15,J2                                              0799 02027000
         ST    @15,J2                                              0799 02028000
@DE00786 C     @15,HISECT                                          0799 02029000
         BNH   @DL00786                                            0799 02030000
*             END;                  /*                       @Z40LB40*/ 02031000
*         END;                      /*                       @Z40LB40*/ 02032000
@RC00768 LA    @15,1                                               0801 02033000
         AL    @15,I2                                              0801 02034000
@DE00763 ST    @15,I2                                              0801 02035000
         L     @14,@PC00003                                        0801 02036000
         L     @14,S1(,@14)                                        0801 02037000
         SLA   @14,2                                               0801 02038000
         L     @07,@PC00001+4                                      0801 02039000
         L     @01,FDTPTR+32(,@07)                                 0801 02040000
         AL    @01,@CF01753                                        0801 02041000
         C     @15,SSCTECNT(@14,@01)                               0801 02042000
         BNH   @DL00763                                            0801 02043000
*     END;                          /*                       @Z40LB40*/ 02044000
*                                                                  0802 02045000
@RF00762 DS    0H                                                  0803 02046000
*   /*****************************************************************/ 02047000
*   /*                                                               */ 02048000
*   /* CHECK FOR INVALID SECTOR SPECIFIED. IF SO, PRINT      @ZD00050*/ 02049000
*   /* ERROR MESSAGE AND SET RETURN CODE TO 4.               @ZD00050*/ 02050000
*   /*                                                               */ 02051000
*   /*****************************************************************/ 02052000
*                                                                  0803 02053000
*   IF EXERR=ON THEN                                               0803 02054000
@RF00743 TM    EXERR,B'00000001'                                   0803 02055000
         BNO   @RF00803                                            0803 02056000
*     DO;                           /*                       @ZD00050*/ 02057000
*       PRINTAB=''B;                /*                       @ZD00050*/ 02058000
         XC    PRINTAB(44),PRINTAB                                 0805 02059000
*       DARGSMOD=DUMSGMOD;          /*                       @ZD00050*/ 02060000
         L     @15,DDSTRU                                          0806 02061000
         MVC   DARGSMOD(3,@15),@CC01334                            0806 02062000
*       DARGSENT=IDC21109;          /*                       @ZD00050*/ 02063000
         MVI   DARGSENT(@15),X'12'                                 0807 02064000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @ZD00050*/ 02065000
         L     @15,@PC00001                                        0808 02066000
         ST    @15,@AL00001                                        0808 02067000
         LA    @14,@CF00118                                        0808 02068000
         ST    @14,@AL00001+4                                      0808 02069000
         LA    @14,DDSTRU                                          0808 02070000
         ST    @14,@AL00001+8                                      0808 02071000
         MVI   @AL00001+8,X'80'                                    0808 02072000
         L     @15,GDTPRT(,@15)                                    0808 02073000
         LA    @01,@AL00001                                        0808 02074000
         BALR  @14,@15                                             0808 02075000
*       SARC=LASTCC04;              /*                       @ZD00050*/ 02076000
         MVC   SARC(2),@CH00044                                    0809 02077000
*     END;                          /*                       @ZD00050*/ 02078000
*                                                                  0810 02079000
*   /*****************************************************************/ 02080000
*   /*                                                               */ 02081000
*   /* RESET HEADLINES                                       @Z40LB40*/ 02082000
*   /*                                                               */ 02083000
*   /*****************************************************************/ 02084000
*                                                                  0811 02085000
*   CALL AMSTP044(GDTTBL,PRPTR);    /*                       @Z40LB40*/ 02086000
@RF00803 L     @15,@PC00001                                        0811 02087000
         ST    @15,@AL00001                                        0811 02088000
         LA    @14,PRPTR                                           0811 02089000
         ST    @14,@AL00001+4                                      0811 02090000
         MVI   @AL00001+4,X'80'                                    0811 02091000
         L     @15,GDTRES(,@15)                                    0811 02092000
         LA    @01,@AL00001                                        0811 02093000
         BALR  @14,@15                                             0811 02094000
*   RFY                                                            0812 02095000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 02096000
*   REG14=RETADDR1;                 /* SET RETURN POINT      @Z40LB40*/ 02097000
         L     REG14,RETADDR1                                      0813 02098000
*   RETURN CODE(SARC);              /* RETURN TO CALLER      @Z40LB40*/ 02099000
         LH    @15,SARC                                            0814 02100000
@EL00003 DS    0H                                                  0814 02101000
@EF00003 DS    0H                                                  0814 02102000
@ER00003 BR    @14                                                 0814 02103000
*   RFY                                                            0815 02104000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 02105000
*   END DUMPSA;                     /*                       @Z40LB40*/ 02106000
*                                                                  0817 02107000
*   /*****************************************************************/ 02108000
*   /*                                                               */ 02109000
*   /* PROCEDURE NAME - DUMPTAB (LEVEL 2)                    @Z40LB40*/ 02110000
*   /*                                                       @Z40LB40*/ 02111000
*   /* FUNCTION - THIS ROUTINE READS AND PRODUCES AN         @Z40LB40*/ 02112000
*   /* UNFORMATTED DUMP OF MSC TABLES RECORD OR A RANGE      @Z40LB40*/ 02113000
*   /* OF TABLES RECORDS. THE RECORD(S) IS DEFINED BY        @Z40LB40*/ 02114000
*   /* THE CALLER IN THE FORM OF A CYLINDER, HEAD, AND       @Z40LB40*/ 02115000
*   /* RECORD ADDRESS. THE ADDRESS IS THE VIRTUAL CHR        @Z40LB40*/ 02116000
*   /* OF THE RECORD OF THE MSC TABLES.                      @Z40LB40*/ 02117000
*   /*                                                       @Z40LB40*/ 02118000
*   /* INPUT - FUNCTION DESCRIPTION TABLE WHICH CONTAINS     @Z40LB40*/ 02119000
*   /* THE RECORD ADDRESS(S).                                @Z40LB40*/ 02120000
*   /*                                                       @Z40LB40*/ 02121000
*   /* OUTPUT - RETURN CODE                                  @Z40LB40*/ 02122000
*   /* 0 = EVERYTHING OK                                     @Z40LB40*/ 02123000
*   /* 4 = USER ENTERED DATA INCORRECTLY BUT REMAINDER       @Z40LB40*/ 02124000
*   /* OF THE FUNCTION WAS ATTEMPTED, OR GETDATA             @Z40LB40*/ 02125000
*   /* FAILED WHEN READING MSC AN TABLES RECORD.             @Z40LB40*/ 02126000
*   /*                                                               */ 02127000
*   /*****************************************************************/ 02128000
*                                                                  0817 02129000
*DUMPTAB:                                                          0817 02130000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 02131000
DUMPTAB  DS    0H                                                  0818 02132000
*   RFY                                                            0818 02133000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 02134000
*   RETADDR1=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 02135000
         ST    REG14,RETADDR1                                      0819 02136000
*   RFY                                                            0820 02137000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 02138000
*   OLDERID2=NEWERID2;                                             0821 02139000
         L     @15,@PC00001                                        0821 02140000
         L     @14,GDTTR2(,@15)                                    0821 02141000
         MVC   @TS00001(95),NEWERID2(@14)                          0821 02142000
         MVC   OLDERID2(95,@14),@TS00001                           0821 02143000
*   NEWID2='DUBC';                  /*                       @Z40LB40*/ 02144000
         MVC   NEWID2(4,@14),@CC01497                              0822 02145000
*   TABRC=LASTCC00;                 /* INIT RETURN CODE      @Z40LB40*/ 02146000
*                                                                  0823 02147000
         SLR   @14,@14                                             0823 02148000
         STH   @14,TABRC                                           0823 02149000
*   /*****************************************************************/ 02150000
*   /*                                                               */ 02151000
*   /* ISSUE UESTA MACRO FOR PRINT HEADERS                   @Z40LB40*/ 02152000
*   /*                                                               */ 02153000
*   /*****************************************************************/ 02154000
*                                                                  0824 02155000
*   PCARG=''B;                      /* CLEAR ARG LIST        @Z40LB40*/ 02156000
         XC    PCARG(33),PCARG                                     0824 02157000
*   STBUFFER=' ';                   /* BLANK BUFFER          @Z40LB40*/ 02158000
         MVI   STBUFFER+1,C' '                                     0825 02159000
         MVC   STBUFFER+2(119),STBUFFER+1                          0825 02160000
         MVI   STBUFFER,C' '                                       0825 02161000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 02162000
         XC    PRINTAB(44),PRINTAB                                 0826 02163000
*   DARGRETP=ADDR(STBUFFER);        /* ADDR OF RETURN        @Z40LB40*/ 02164000
         L     @14,DDSTRU                                          0827 02165000
         LA    @07,STBUFFER                                        0827 02166000
         ST    @07,DARGRETP(,@14)                                  0827 02167000
*   DARGRETL=LENGTH(STBUFFER);      /* LENGTH OF RETURN      @Z40LB40*/ 02168000
         MVC   DARGRETL(2,@14),@CH01251                            0828 02169000
*   DARGSMOD=DUMSGMOD;              /* SET TEXT ID           @Z40LB40*/ 02170000
         MVC   DARGSMOD(3,@14),@CC01334                            0829 02171000
*   DARGSENT=TTABD;                 /* SET ENTRY NO.         @Z40LB40*/ 02172000
         MVI   DARGSENT(@14),X'0C'                                 0830 02173000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* READ IN SUBTITLE @Z40LB40*/ 02174000
         ST    @15,@AL00001                                        0831 02175000
         LA    @14,@CF00118                                        0831 02176000
         ST    @14,@AL00001+4                                      0831 02177000
         LA    @14,DDSTRU                                          0831 02178000
         ST    @14,@AL00001+8                                      0831 02179000
         MVI   @AL00001+8,X'80'                                    0831 02180000
         L     @15,GDTPRT(,@15)                                    0831 02181000
         LA    @01,@AL00001                                        0831 02182000
         BALR  @14,@15                                             0831 02183000
*   PCSTLC=1;                       /* ONE SUBTITLE          @Z40LB40*/ 02184000
         MVC   PCSTLC(2),@CH00223                                  0832 02185000
*   PCSTLP=ADDR(STBUFFER);          /* ADDR OF SUBTITLE      @Z40LB40*/ 02186000
         LA    @15,STBUFFER                                        0833 02187000
         ST    @15,PCSTLP                                          0833 02188000
*   CALL AMSTP042(GDTTBL,PRPTR,PCARG);/* SET SUBTITLE        @Z40LB40*/ 02189000
*                                                                  0834 02190000
         L     @15,@PC00001                                        0834 02191000
         ST    @15,@AL00001                                        0834 02192000
         LA    @14,PRPTR                                           0834 02193000
         ST    @14,@AL00001+4                                      0834 02194000
         LA    @14,PCARG                                           0834 02195000
         ST    @14,@AL00001+8                                      0834 02196000
         L     @15,GDTESA(,@15)                                    0834 02197000
         LA    @01,@AL00001                                        0834 02198000
         BALR  @14,@15                                             0834 02199000
*   /*****************************************************************/ 02200000
*   /*                                                               */ 02201000
*   /* LOOP THROUGH ALL CHRS ENTERED. IF A CHR IS INVALID    @Z40LB40*/ 02202000
*   /* IT WILL BE BYPASSED WITH AN ERROR MESSAGE AND         @Z40LB40*/ 02203000
*   /* THE NEXT ONE TRIED.                                   @Z40LB40*/ 02204000
*   /*                                                               */ 02205000
*   /*****************************************************************/ 02206000
*                                                                  0835 02207000
*   DO I2=1 TO TBLCNT;              /* LOOP THRU SUBLIST     @Z40LB40*/ 02208000
         LA    @15,1                                               0835 02209000
         B     @DE00835                                            0835 02210000
@DL00835 DS    0H                                                  0836 02211000
*     CHRERR=OFF;                   /* INIT ERROR SWITCH     @Z40LB40*/ 02212000
         NI    CHRERR,B'11111101'                                  0836 02213000
*     LOCHRHLD=LOCHRPTR(I2)->LOCHRVAL;/* SAVE START CHR      @Z40LB40*/ 02214000
         SLA   @15,2                                               0837 02215000
         L     @14,@PC00001+4                                      0837 02216000
         L     @01,FDTPTR+40(,@14)                                 0837 02217000
         AL    @01,@CF01753                                        0837 02218000
         L     @01,LOCHRPTR(@15,@01)                               0837 02219000
         L     @15,LOCHRVAL(,@01)                                  0837 02220000
         ST    @15,LOCHRHLD                                        0837 02221000
*     IF LOCC<MINCC|LOCC>MAXCC|LOHH>MAXHH|LORR<MINRR|LORR>MAXRR THEN    02222000
         CLI   LOCC,7                                              0838 02223000
         BL    @RT00838                                            0838 02224000
         CLI   LOCC,39                                             0838 02225000
         BH    @RT00838                                            0838 02226000
         CLI   LOHH,18                                             0838 02227000
         BH    @RT00838                                            0838 02228000
         CLI   LORR,1                                              0838 02229000
         BL    @RT00838                                            0838 02230000
         CLI   LORR,32                                             0838 02231000
         BNH   @RF00838                                            0838 02232000
@RT00838 DS    0H                                                  0839 02233000
*       DO;                         /*                       @Z40LB40*/ 02234000
*                                                                  0839 02235000
*         /***********************************************************/ 02236000
*         /*                                                         */ 02237000
*         /* INVALID LOW CHR VALUE. ISSUE ERROR MESSAGE AND  @Z40LB40*/ 02238000
*         /* SET RETURN CODE. SET SWITCH TO BYPASS CHRS.     @Z40LB40*/ 02239000
*         /*                                                         */ 02240000
*         /***********************************************************/ 02241000
*                                                                  0840 02242000
*         PRINTAB=''B;              /*                       @Z40LB40*/ 02243000
         XC    PRINTAB(44),PRINTAB                                 0840 02244000
*         DARGSMOD=DUMSGMOD;        /*                       @Z40LB40*/ 02245000
         L     @15,DDSTRU                                          0841 02246000
         MVC   DARGSMOD(3,@15),@CC01334                            0841 02247000
*         DARGSENT=IDC21106;        /*                       @Z40LB40*/ 02248000
         MVI   DARGSENT(@15),X'07'                                 0842 02249000
*         DARGCNT=1;                /*                       @Z40LB40*/ 02250000
         LA    @14,1                                               0843 02251000
         STH   @14,DARGCNT(,@15)                                   0843 02252000
*         DARGINS(1)=1;             /*                       @Z40LB40*/ 02253000
         STH   @14,DARGINS(,@15)                                   0844 02254000
*         DARGINL(1)=3;             /*                       @Z40LB40*/ 02255000
         MVC   DARGINL(2,@15),@CH00166                             0845 02256000
*         DARGDTM(1)=ADDR(LOCHRHLD)+1;/*                     @Z40LB40*/ 02257000
         LA    @07,LOCHRHLD                                        0846 02258000
         ALR   @07,@14                                             0846 02259000
         ST    @07,DARGDTM(,@15)                                   0846 02260000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB40*/ 02261000
         L     @15,@PC00001                                        0847 02262000
         ST    @15,@AL00001                                        0847 02263000
         LA    @14,@CF00118                                        0847 02264000
         ST    @14,@AL00001+4                                      0847 02265000
         LA    @14,DDSTRU                                          0847 02266000
         ST    @14,@AL00001+8                                      0847 02267000
         MVI   @AL00001+8,X'80'                                    0847 02268000
         L     @15,GDTPRT(,@15)                                    0847 02269000
         LA    @01,@AL00001                                        0847 02270000
         BALR  @14,@15                                             0847 02271000
*         TABRC=LASTCC04;           /* SET RETURN CODE       @Z40LB40*/ 02272000
         MVC   TABRC(2),@CH00044                                   0848 02273000
*         CHRERR=ON;                /* SET ERROR SWITCH      @Z40LB40*/ 02274000
         OI    CHRERR,B'00000010'                                  0849 02275000
*       END;                        /*                       @Z40LB40*/ 02276000
*     IF CHRERR=OFF THEN                                           0851 02277000
@RF00838 TM    CHRERR,B'00000010'                                  0851 02278000
         BNZ   @RF00851                                            0851 02279000
*       DO;                         /* NO ERROR, CONTINUE    @Z40LB40*/ 02280000
*         IF HICHRPTR(I2)=NULLPTR THEN/* IF NO END CHR       @Z40LB40*/ 02281000
         L     @15,I2                                              0853 02282000
         SLA   @15,2                                               0853 02283000
         L     @14,@PC00001+4                                      0853 02284000
         L     @01,FDTPTR+44(,@14)                                 0853 02285000
         AL    @01,@CF01753                                        0853 02286000
         L     @15,HICHRPTR(@15,@01)                               0853 02287000
         LTR   @15,@15                                             0853 02288000
         BNZ   @RF00853                                            0853 02289000
*           HICHRHLD=LOCHRHLD;      /* MAKE LO AND HI SAME   @Z40LB40*/ 02290000
         L     @15,LOCHRHLD                                        0854 02291000
         ST    @15,HICHRHLD                                        0854 02292000
*         ELSE                                                     0855 02293000
*           HICHRHLD=HICHRPTR(I2)->HICHRVAL;/* MAKE SAME     @Z40LB40*/ 02294000
         B     @RC00853                                            0855 02295000
@RF00853 L     @15,I2                                              0855 02296000
         SLA   @15,2                                               0855 02297000
         L     @14,@PC00001+4                                      0855 02298000
         L     @01,FDTPTR+44(,@14)                                 0855 02299000
         AL    @01,@CF01753                                        0855 02300000
         L     @01,HICHRPTR(@15,@01)                               0855 02301000
         L     @15,HICHRVAL(,@01)                                  0855 02302000
         ST    @15,HICHRHLD                                        0855 02303000
*         IF HICC<MINCC|HICC>MAXCC|HIHH>MAXHH|HIRR<MINRR|HIRR>MAXRR     02304000
*           THEN                                                   0856 02305000
@RC00853 CLI   HICC,7                                              0856 02306000
         BL    @RT00856                                            0856 02307000
         CLI   HICC,39                                             0856 02308000
         BH    @RT00856                                            0856 02309000
         CLI   HIHH,18                                             0856 02310000
         BH    @RT00856                                            0856 02311000
         CLI   HIRR,1                                              0856 02312000
         BL    @RT00856                                            0856 02313000
         CLI   HIRR,32                                             0856 02314000
         BNH   @RF00856                                            0856 02315000
@RT00856 DS    0H                                                  0857 02316000
*           DO;                     /*                       @Z40LB40*/ 02317000
*                                                                  0857 02318000
*             /*******************************************************/ 02319000
*             /*                                                     */ 02320000
*             /* INVALID HIGH CHR VALUE. ISSUE ERROR         @Z40LB40*/ 02321000
*             /* MESSAGE AND SET RETURN CODE. SET SWITCH     @Z40LB40*/ 02322000
*             /* TO BYPASS CHRS.                             @Z40LB40*/ 02323000
*             /*                                                     */ 02324000
*             /*******************************************************/ 02325000
*                                                                  0858 02326000
*             PRINTAB=''B;          /*                       @Z40LB40*/ 02327000
         XC    PRINTAB(44),PRINTAB                                 0858 02328000
*             DARGSMOD=DUMSGMOD;    /*                       @Z40LB40*/ 02329000
         L     @15,DDSTRU                                          0859 02330000
         MVC   DARGSMOD(3,@15),@CC01334                            0859 02331000
*             DARGSENT=IDC21106;    /*                       @Z40LB40*/ 02332000
         MVI   DARGSENT(@15),X'07'                                 0860 02333000
*             DARGCNT=1;            /*                       @Z40LB40*/ 02334000
         LA    @14,1                                               0861 02335000
         STH   @14,DARGCNT(,@15)                                   0861 02336000
*             DARGINS(1)=1;         /*                       @Z40LB40*/ 02337000
         STH   @14,DARGINS(,@15)                                   0862 02338000
*             DARGINL(1)=3;         /*                       @Z40LB40*/ 02339000
         MVC   DARGINL(2,@15),@CH00166                             0863 02340000
*             DARGDTM(1)=ADDR(HICHRHLD)+1;/*                 @Z40LB40*/ 02341000
         LA    @07,HICHRHLD                                        0864 02342000
         ALR   @07,@14                                             0864 02343000
         ST    @07,DARGDTM(,@15)                                   0864 02344000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB40*/ 02345000
         L     @15,@PC00001                                        0865 02346000
         ST    @15,@AL00001                                        0865 02347000
         LA    @14,@CF00118                                        0865 02348000
         ST    @14,@AL00001+4                                      0865 02349000
         LA    @14,DDSTRU                                          0865 02350000
         ST    @14,@AL00001+8                                      0865 02351000
         MVI   @AL00001+8,X'80'                                    0865 02352000
         L     @15,GDTPRT(,@15)                                    0865 02353000
         LA    @01,@AL00001                                        0865 02354000
         BALR  @14,@15                                             0865 02355000
*             TABRC=LASTCC04;       /* SET RETURN CODE       @Z40LB40*/ 02356000
         MVC   TABRC(2),@CH00044                                   0866 02357000
*             CHRERR=ON;            /* SET ERROR SWITCH      @Z40LB40*/ 02358000
         OI    CHRERR,B'00000010'                                  0867 02359000
*           END;                    /*                       @Z40LB40*/ 02360000
*       END;                        /*                       @Z40LB40*/ 02361000
@RF00856 DS    0H                                                  0870 02362000
*     IF CHRERR=OFF THEN                                           0870 02363000
@RF00851 TM    CHRERR,B'00000010'                                  0870 02364000
         BNZ   @RF00870                                            0870 02365000
*       DO;                         /* NO ERROR,CONTINUE     @Z40LB40*/ 02366000
*         IF LOCHRHLD>HICHRHLD THEN                                0872 02367000
         L     @15,LOCHRHLD                                        0872 02368000
         C     @15,HICHRHLD                                        0872 02369000
         BNH   @RF00872                                            0872 02370000
*           DO;                     /*                       @Z40LB40*/ 02371000
*                                                                  0873 02372000
*             /*******************************************************/ 02373000
*             /*                                                     */ 02374000
*             /* START OF RANGE HIGHER THAN END OF RANGE.    @Z40LB40*/ 02375000
*             /* ISSUE ERROR MESSAGE,SET RETURN CODE,SET     @Z40LB40*/ 02376000
*             /* SWITCH TO BYPASS CHRS.                      @Z40LB40*/ 02377000
*             /*                                                     */ 02378000
*             /*******************************************************/ 02379000
*                                                                  0874 02380000
*             PRINTAB=''B;          /*                       @Z40LB40*/ 02381000
         XC    PRINTAB(44),PRINTAB                                 0874 02382000
*             DARGSMOD=DUMSGMOD;    /*                       @Z40LB40*/ 02383000
         L     @15,DDSTRU                                          0875 02384000
         MVC   DARGSMOD(3,@15),@CC01334                            0875 02385000
*             DARGSENT=IDC21108;    /*                       @Z40LB40*/ 02386000
         MVI   DARGSENT(@15),X'09'                                 0876 02387000
*             DARGCNT=2;            /*                       @Z40LB40*/ 02388000
         LA    @14,2                                               0877 02389000
         STH   @14,DARGCNT(,@15)                                   0877 02390000
*             DARGINS(1)=1;         /*                       @Z40LB40*/ 02391000
         LA    @07,1                                               0878 02392000
         STH   @07,DARGINS(,@15)                                   0878 02393000
*             DARGINL(1)=3;         /*                       @Z40LB40*/ 02394000
         LA    @06,3                                               0879 02395000
         STH   @06,DARGINL(,@15)                                   0879 02396000
*             DARGDTM(1)=ADDR(LOCHRHLD)+1;/*                 @Z40LB40*/ 02397000
         LA    @05,LOCHRHLD                                        0880 02398000
         ALR   @05,@07                                             0880 02399000
         ST    @05,DARGDTM(,@15)                                   0880 02400000
*             DARGINS(2)=2;         /*                       @Z40LB40*/ 02401000
         STH   @14,DARGINS+8(,@15)                                 0881 02402000
*             DARGINL(2)=3;         /*                       @Z40LB40*/ 02403000
         STH   @06,DARGINL+8(,@15)                                 0882 02404000
*             DARGDTM(2)=ADDR(HICHRHLD)+1;/*                 @Z40LB40*/ 02405000
         LA    @14,HICHRHLD                                        0883 02406000
         ALR   @14,@07                                             0883 02407000
         ST    @14,DARGDTM+8(,@15)                                 0883 02408000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB40*/ 02409000
         L     @15,@PC00001                                        0884 02410000
         ST    @15,@AL00001                                        0884 02411000
         LA    @14,@CF00118                                        0884 02412000
         ST    @14,@AL00001+4                                      0884 02413000
         LA    @14,DDSTRU                                          0884 02414000
         ST    @14,@AL00001+8                                      0884 02415000
         MVI   @AL00001+8,X'80'                                    0884 02416000
         L     @15,GDTPRT(,@15)                                    0884 02417000
         LA    @01,@AL00001                                        0884 02418000
         BALR  @14,@15                                             0884 02419000
*             TABRC=LASTCC04;       /* SET RETURN CODE       @Z40LB40*/ 02420000
         MVC   TABRC(2),@CH00044                                   0885 02421000
*             CHRERR=ON;            /* SET ERROR SWITCH      @Z40LB40*/ 02422000
         OI    CHRERR,B'00000010'                                  0886 02423000
*           END;                    /*                       @Z40LB40*/ 02424000
*       END;                        /*                       @Z40LB40*/ 02425000
@RF00872 DS    0H                                                  0889 02426000
*     IF CHRERR=OFF THEN                                           0889 02427000
@RF00870 TM    CHRERR,B'00000010'                                  0889 02428000
         BNZ   @RF00889                                            0889 02429000
*       DO J2=LOCHRHLD TO HICHRHLD; /* NO ERROR, CONTINUE    @Z40LB40*/ 02430000
*                                                                  0890 02431000
         L     @15,LOCHRHLD                                        0890 02432000
         B     @DE00890                                            0890 02433000
@DL00890 DS    0H                                                  0891 02434000
*         /***********************************************************/ 02435000
*         /*                                                         */ 02436000
*         /* CHECK FOR CHR BEING INCREMENTED PAST 32 RECORDS @Z40LB40*/ 02437000
*         /* PER TRACK. IF SO, SET RECORD NUMBER TO 01.      @Z40LB40*/ 02438000
*         /* THEN ADD 1 TO TRACK NUMBER AND IF THIS          @Z40LB40*/ 02439000
*         /* EXCEEDS 19 TRACKS PER CYLINDER THEN RESET       @Z40LB40*/ 02440000
*         /* TRACK NUMBER TO 00 AND ADD 1 TO CYLINDER        @Z40LB40*/ 02441000
*         /* NUMBER.                                         @Z40LB40*/ 02442000
*         /*                                                         */ 02443000
*         /***********************************************************/ 02444000
*                                                                  0891 02445000
*         LOCHRHLD=J2;              /* SAVE CHR              @Z40LB40*/ 02446000
         ST    @15,LOCHRHLD                                        0891 02447000
*         IF LORR>MAXRR THEN        /* IS TRK EXCEEDED       @Z40LB40*/ 02448000
         CLI   LORR,32                                             0892 02449000
         BNH   @RF00892                                            0892 02450000
*           DO;                     /* YES                   @Z40LB40*/ 02451000
*             LORR=MINRR;           /* RESET RR              @Z40LB40*/ 02452000
         MVI   LORR,X'01'                                          0894 02453000
*             LOHH=LOHH+1;          /* INCREMENT HH          @Z40LB40*/ 02454000
         LA    @15,1                                               0895 02455000
         SLR   @14,@14                                             0895 02456000
         IC    @14,LOHH                                            0895 02457000
         ALR   @14,@15                                             0895 02458000
         STC   @14,LOHH                                            0895 02459000
*             IF LOHH>MAXHH THEN    /* IS HEAD EXCEEDED      @Z40LB40*/ 02460000
         CLI   LOHH,18                                             0896 02461000
         BNH   @RF00896                                            0896 02462000
*               DO;                 /* YES                   @Z40LB40*/ 02463000
*                 LOHH=MINHH;       /* RESET HH              @Z40LB40*/ 02464000
         MVI   LOHH,X'00'                                          0898 02465000
*                 LOCC=LOCC+1;      /* INCREMENT CC          @Z40LB40*/ 02466000
         SLR   @14,@14                                             0899 02467000
         IC    @14,LOCC                                            0899 02468000
         ALR   @15,@14                                             0899 02469000
         STC   @15,LOCC                                            0899 02470000
*               END;                /*                       @Z40LB40*/ 02471000
*           END;                    /*                       @Z40LB40*/ 02472000
@RF00896 DS    0H                                                  0902 02473000
*         J2=LOCHRHLD;              /* RESET J2              @Z40LB40*/ 02474000
*                                                                  0902 02475000
@RF00892 L     @15,LOCHRHLD                                        0902 02476000
         ST    @15,J2                                              0902 02477000
*         /***********************************************************/ 02478000
*         /*                                                         */ 02479000
*         /* READ AND PRINT EACH RECORD IN THE RANGE         @Z40LB40*/ 02480000
*         /*                                                         */ 02481000
*         /***********************************************************/ 02482000
*                                                                  0903 02483000
*         CALL GETDATA(TABL,J2);    /* READ RECORD           @Z40LB40*/ 02484000
         LA    @15,@CC01352                                        0903 02485000
         ST    @15,@AL00001                                        0903 02486000
         LA    @15,J2                                              0903 02487000
         ST    @15,@AL00001+4                                      0903 02488000
         LA    @01,@AL00001                                        0903 02489000
         BAL   @14,GETDATA                                         0903 02490000
*         RESPECIFY                                                0904 02491000
*           RTNREG RSTD;                                           0904 02492000
*         TESTRC=RTNREG;                                           0905 02493000
         LR    TESTRC,RTNREG                                       0905 02494000
*         RESPECIFY                                                0906 02495000
*           RTNREG UNRSTD;          /*                       @Z40LB40*/ 02496000
*         IF TESTRC^=LASTCC00 THEN  /* IS RET.CODE ZERO      @Z40LB40*/ 02497000
         LTR   TESTRC,TESTRC                                       0907 02498000
         BZ    @RF00907                                            0907 02499000
*           DO;                     /* NO,ERROR              @Z40LB40*/ 02500000
*                                                                  0908 02501000
*             /*******************************************************/ 02502000
*             /*                                                     */ 02503000
*             /* ERROR, ISSUE MESSAGE AND TERMINATE          @Z40LB40*/ 02504000
*             /*                                                     */ 02505000
*             /*******************************************************/ 02506000
*                                                                  0909 02507000
*             PRINTAB=''B;          /*                       @Z40LB40*/ 02508000
         XC    PRINTAB(44),PRINTAB                                 0909 02509000
*             DARGSMOD=DUMSGMOD;    /*                       @Z40LB40*/ 02510000
         L     @15,DDSTRU                                          0910 02511000
         MVC   DARGSMOD(3,@15),@CC01334                            0910 02512000
*             DARGSENT=IDC21107;    /*                       @Z40LB40*/ 02513000
         MVI   DARGSENT(@15),X'08'                                 0911 02514000
*             DARGCNT=1;            /*                       @Z40LB40*/ 02515000
         LA    @14,1                                               0912 02516000
         STH   @14,DARGCNT(,@15)                                   0912 02517000
*             DARGINS(1)=1;         /*                       @Z40LB40*/ 02518000
         STH   @14,DARGINS(,@15)                                   0913 02519000
*             DARGINL(1)=3;         /*                       @Z40LB40*/ 02520000
         MVC   DARGINL(2,@15),@CH00166                             0914 02521000
*             DARGDTM(1)=ADDR(LOCHRHLD)+1;/*                 @Z40LB40*/ 02522000
         LA    @07,LOCHRHLD                                        0915 02523000
         ALR   @07,@14                                             0915 02524000
         ST    @07,DARGDTM(,@15)                                   0915 02525000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB40*/ 02526000
         L     @15,@PC00001                                        0916 02527000
         ST    @15,@AL00001                                        0916 02528000
         LA    @14,@CF00118                                        0916 02529000
         ST    @14,@AL00001+4                                      0916 02530000
         LA    @14,DDSTRU                                          0916 02531000
         ST    @14,@AL00001+8                                      0916 02532000
         MVI   @AL00001+8,X'80'                                    0916 02533000
         L     @15,GDTPRT(,@15)                                    0916 02534000
         LA    @01,@AL00001                                        0916 02535000
         BALR  @14,@15                                             0916 02536000
*             TABRC=LASTCC04;       /* SET RETURN CODE       @Z40LB40*/ 02537000
         MVC   TABRC(2),@CH00044                                   0917 02538000
*             J2=HICHRHLD;          /* STOP DO LOOP          @Z40LB40*/ 02539000
         L     @15,HICHRHLD                                        0918 02540000
         ST    @15,J2                                              0918 02541000
*             I2=TBLCNT;            /* STOP DO LOOP          @Z40LB40*/ 02542000
         L     @15,@PC00001+4                                      0919 02543000
         LA    @15,FDTPTR+36(,@15)                                 0919 02544000
         L     @15,TBLCNT(,@15)                                    0919 02545000
         ST    @15,I2                                              0919 02546000
*           END;                    /*                       @Z40LB40*/ 02547000
*         ELSE                                                     0921 02548000
*           DO;                     /* READ, OK              @Z40LB40*/ 02549000
*                                                                  0921 02550000
         B     @RC00907                                            0921 02551000
@RF00907 DS    0H                                                  0922 02552000
*             /*******************************************************/ 02553000
*             /*                                                     */ 02554000
*             /* PRINT HEADER WITH PREFIX                    @Z40LB40*/ 02555000
*             /* AND PRINT RECORD.                           @Z40LB40*/ 02556000
*             /*                                                     */ 02557000
*             /*******************************************************/ 02558000
*                                                                  0922 02559000
*             PRINTAB=''B;          /*                       @Z40LB40*/ 02560000
         XC    PRINTAB(44),PRINTAB                                 0922 02561000
*             DARGSMOD=DUMSGMOD;    /*                       @Z40LB40*/ 02562000
         L     @02,DDSTRU                                          0923 02563000
         MVC   DARGSMOD(3,@02),@CC01334                            0923 02564000
*             DARGSENT=HREC;        /* SET HEADER            @Z40LB40*/ 02565000
         MVI   DARGSENT(@02),X'30'                                 0924 02566000
*             DARGCNT=3;            /*                       @Z40LB40*/ 02567000
         LA    @15,3                                               0925 02568000
         STH   @15,DARGCNT(,@02)                                   0925 02569000
*             DARGINS(1)=1;         /* INSERT 1              @Z40LB40*/ 02570000
         LA    @14,1                                               0926 02571000
         STH   @14,DARGINS(,@02)                                   0926 02572000
*             DARGINL(1)=3;         /* CHR LENGTH            @Z40LB40*/ 02573000
         STH   @15,DARGINL(,@02)                                   0927 02574000
*             DARGDTM(1)=ADDR(LOCHRHLD)+1;/*                 @Z40LB40*/ 02575000
         LA    @07,LOCHRHLD                                        0928 02576000
         ALR   @07,@14                                             0928 02577000
         ST    @07,DARGDTM(,@02)                                   0928 02578000
*             DARGINS(2)=2;         /* INSERT 2              @Z40LB40*/ 02579000
         MVC   DARGINS+8(2,@02),@CH00157                           0929 02580000
*             DARGINL(2)=LENGTH(PREFIX1);/*                  @Z40LB40*/ 02581000
         LA    @14,4                                               0930 02582000
         STH   @14,DARGINL+8(,@02)                                 0930 02583000
*             DARGDTM(2)=ADDR(PREFIX1);/*                    @Z40LB40*/ 02584000
         LA    @07,PREFIX1                                         0931 02585000
         ST    @07,DARGDTM+8(,@02)                                 0931 02586000
*             DARGINS(3)=3;         /* INSERT 3              @Z40LB40*/ 02587000
         STH   @15,DARGINS+16(,@02)                                0932 02588000
*             DARGINL(3)=LENGTH(PREFIX2);/*                  @Z40LB40*/ 02589000
         STH   @14,DARGINL+16(,@02)                                0933 02590000
*             DARGDTM(3)=ADDR(PREFIX2);/*                    @Z40LB40*/ 02591000
         LA    @15,PREFIX2                                         0934 02592000
         ST    @15,DARGDTM+16(,@02)                                0934 02593000
*             CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*          @Z40LB40*/ 02594000
         L     @02,@PC00001                                        0935 02595000
         ST    @02,@AL00001                                        0935 02596000
         LA    @15,PRPTR                                           0935 02597000
         ST    @15,@AL00001+4                                      0935 02598000
         LA    @15,DDSTRU                                          0935 02599000
         ST    @15,@AL00001+8                                      0935 02600000
         MVI   @AL00001+8,X'80'                                    0935 02601000
         L     @15,GDTPRT(,@02)                                    0935 02602000
         LA    @01,@AL00001                                        0935 02603000
         BALR  @14,@15                                             0935 02604000
*             SECTADDR='0000'X;     /* SET RECORD ADDRESS    @Z40LB40*/ 02605000
         SLR   SECTADDR,SECTADDR                                   0936 02606000
*             NUMBYTES=SECTSIZE;    /* SET NO. OF BYTES      @Z40LB40*/ 02607000
         MVC   NUMBYTES(4),@CF01321                                0937 02608000
*             CALL PRNTSECT;        /* GO PRINT RECORD       @Z40LB40*/ 02609000
         BAL   @14,PRNTSECT                                        0938 02610000
*           END;                    /*                       @Z40LB40*/ 02611000
*       END;                        /*                       @Z40LB40*/ 02612000
@RC00907 LA    @15,1                                               0940 02613000
         AL    @15,J2                                              0940 02614000
@DE00890 ST    @15,J2                                              0940 02615000
         C     @15,HICHRHLD                                        0940 02616000
         BNH   @DL00890                                            0940 02617000
*   END;                            /*                       @Z40LB40*/ 02618000
*                                                                  0941 02619000
@RF00889 LA    @15,1                                               0941 02620000
         AL    @15,I2                                              0941 02621000
@DE00835 ST    @15,I2                                              0941 02622000
         L     @14,@PC00001+4                                      0941 02623000
         LA    @14,FDTPTR+36(,@14)                                 0941 02624000
         C     @15,TBLCNT(,@14)                                    0941 02625000
         BNH   @DL00835                                            0941 02626000
*   /*****************************************************************/ 02627000
*   /*                                                               */ 02628000
*   /* RESET HEADLINES                                       @Z40LB40*/ 02629000
*   /*                                                               */ 02630000
*   /*****************************************************************/ 02631000
*                                                                  0942 02632000
*   CALL AMSTP044(GDTTBL,PRPTR);    /*                       @Z40LB40*/ 02633000
         L     @15,@PC00001                                        0942 02634000
         ST    @15,@AL00001                                        0942 02635000
         LA    @14,PRPTR                                           0942 02636000
         ST    @14,@AL00001+4                                      0942 02637000
         MVI   @AL00001+4,X'80'                                    0942 02638000
         L     @15,GDTRES(,@15)                                    0942 02639000
         LA    @01,@AL00001                                        0942 02640000
         BALR  @14,@15                                             0942 02641000
*   RFY                                                            0943 02642000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 02643000
*   REG14=RETADDR1;                 /* SET RETURN POINT      @Z40LB40*/ 02644000
         L     REG14,RETADDR1                                      0944 02645000
*   RETURN CODE(TABRC);             /* RETURN TO CALLER      @Z40LB40*/ 02646000
         LH    @15,TABRC                                           0945 02647000
@EL00004 DS    0H                                                  0945 02648000
@EF00004 DS    0H                                                  0945 02649000
@ER00004 BR    @14                                                 0945 02650000
*   RFY                                                            0946 02651000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 02652000
*   END DUMPTAB;                    /*                       @Z40LB40*/ 02653000
*                                                                  0948 02654000
*   /*****************************************************************/ 02655000
*   /*                                                               */ 02656000
*   /* PROCEDURE NAME - GETDATA (LEVEL 3)                    @Z40LB40*/ 02657000
*   /*                                                       @Z40LB40*/ 02658000
*   /* FUNCTION - THIS ROUTINE READS SECTORS OF MSC OR       @Z40LB40*/ 02659000
*   /* STAGING ADAPTERS OR RECORDS OF THE MSC TABLES.        @Z40LB40*/ 02660000
*   /* IT INTERFACES WITH THE MSC THROUGH THE USE OF         @Z40LB40*/ 02661000
*   /* THE ICBQUERY MACRO.                                   @Z40LB40*/ 02662000
*   /*                                                       @Z40LB40*/ 02663000
*   /* INPUT - 4 CHARACTER VALUE DEFINING THE TYPE OF        @Z40LB40*/ 02664000
*   /* WORK TO BE DONE. IN SOME CASES A SECONDARY VALUE      @Z40LB40*/ 02665000
*   /* IS ALSO INPUT.                                        @Z40LB40*/ 02666000
*   /*                                                       @Z40LB40*/ 02667000
*   /* PRIME VALUE - MSCM SECORDARY VALUE - NONE             @Z40LB40*/ 02668000
*   /* READ ALL OF MSC MAIN STORAGE.                         @Z40LB40*/ 02669000
*   /*                                                       @Z40LB40*/ 02670000
*   /* PRIME VALUE - MSCE SECORDARY VALUE - NONE             @Z40LB40*/ 02671000
*   /* READ ALL OF MSC EXTENDED STORAGE.                     @Z40LB40*/ 02672000
*   /*                                                       @Z40LB40*/ 02673000
*   /* PRIME VALUE - SAMA SECONDARY VALUE - SSID OF SA       @Z40LB40*/ 02674000
*   /* READ ALL OF SA(SSID) MAIN STORAGE PLUS PST FROM       @ZD00043*/ 02675000
*   /* EXTENDED STORAGE.                                     @ZD00043*/ 02676000
*   /*                                                       @Z40LB40*/ 02677000
*   /* PRIME VALUE - SAEX SECONDARY VALUE - SSID OF SA       @Z40LB40*/ 02678000
*   /* READ ALL OF VALID SA(SSID) EXTENDED STORAGE.          @ZD00050*/ 02679000
*   /*                                                       @Z40LB40*/ 02680000
*   /* PRIME VALUE - TABL SECONDARY VALUE - CHR OF RECORD    @Z40LB40*/ 02681000
*   /* READ THE SPECIFIED MSC TABLES RECORD.                 @Z40LB40*/ 02682000
*   /*                                                       @Z40LB40*/ 02683000
*   /* OUTPUT - THE REQUESTED DATA PLUS A RETURN CODE.       @Z40LB40*/ 02684000
*   /* 0 = EVERYTHING OK                                     @Z40LB40*/ 02685000
*   /* 4 = ERROR OCCURRED WHILE READING DATA. VALIDITY OF    @Z40LB40*/ 02686000
*   /* DATA CANNOT BE GUARANTEED.                            @Z40LB40*/ 02687000
*   /*                                                               */ 02688000
*   /*****************************************************************/ 02689000
*                                                                  0948 02690000
*GETDATA:                                                          0948 02691000
*   PROCEDURE(GETDTYPE,GETDSEC) OPTIONS(NOSAVE,NOSAVEAREA);/*      0948 02692000
*                                                            @Z40LB40*/ 02693000
GETDATA  MVC   @PC00005(8),0(@01)                                  0948 02694000
*   DCL                                                            0949 02695000
*     GETDTYPE CHAR(4);             /* READ OPTION           @Z40LB40*/ 02696000
*   DCL                                                            0950 02697000
*     1 GETDSEC FIXED(31),          /* SECONDARY VALUE       @Z40LB40*/ 02698000
*      2 * FIXED(8),                /* NOT USED - ZERO       @Z40LB40*/ 02699000
*      2 GETDCC FIXED(8),           /* CYLINDER              @Z40LB40*/ 02700000
*      2 GETDHH FIXED(8),           /* HEAD                  @Z40LB40*/ 02701000
*      2 GETDRR FIXED(8);           /* RECORD                @Z40LB40*/ 02702000
*   RFY                                                            0951 02703000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 02704000
*   RETADDR2=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 02705000
         ST    REG14,RETADDR2                                      0952 02706000
*   RFY                                                            0953 02707000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 02708000
*   OLDERID2=NEWERID2;                                             0954 02709000
         L     @07,@PC00001                                        0954 02710000
         L     @07,GDTTR2(,@07)                                    0954 02711000
         MVC   @TS00001(95),NEWERID2(@07)                          0954 02712000
         MVC   OLDERID2(95,@07),@TS00001                           0954 02713000
*   NEWID2='DUCA';                  /*                       @Z40LB40*/ 02714000
         MVC   NEWID2(4,@07),@CC01510                              0955 02715000
*   GETDRC=LASTCC00;                /* INIT RETURN CODE      @Z40LB40*/ 02716000
         SLR   GETDRC,GETDRC                                       0956 02717000
*   IF GETDTYPE=MSCM THEN                                          0957 02718000
*                                                                  0957 02719000
         L     @07,@PC00005                                        0957 02720000
         CLC   GETDTYPE(4,@07),@CC01344                            0957 02721000
         BNE   @RF00957                                            0957 02722000
*     /***************************************************************/ 02723000
*     /*                                                             */ 02724000
*     /* READ MSC MAIN STORAGE SECTORS 04-FF                 @Z40LB40*/ 02725000
*     /*                                                             */ 02726000
*     /***************************************************************/ 02727000
*                                                                  0958 02728000
*     DO I3='04'X TO'FF'X;          /* READ SECTORS 04-FF    @Z40LB40*/ 02729000
         LA    I3,4                                                0958 02730000
@DL00958 DS    0H                                                  0959 02731000
*       PARMLST=''B;                /* CLEAR ICBQUERY LIST   @Z40LB40*/ 02732000
         XC    PARMLST(44),PARMLST                                 0959 02733000
*       QUSECT=I3;                  /* SET WANTED SECTOR     @Z40LB40*/ 02734000
         L     @07,QUERYPTR                                        0960 02735000
         STC   I3,QUSECT(,@07)                                     0960 02736000
*       QUPTR=ADDR(RTAREA);         /* SET RETURN ADDR       @Z40LB40*/ 02737000
         LA    @05,RTAREA                                          0961 02738000
         ST    @05,QUPTR(,@07)                                     0961 02739000
*       IF ADDR(AMSC)^=NULLPTR THEN /* IF ALT THEN SET       @ZA27590*/ 02740000
         L     @05,@PC00001+4                                      0962 02741000
         L     @05,FDTPTR+92(,@05)                                 0962 02742000
         LTR   @05,@05                                             0962 02743000
         BZ    @RF00962                                            0962 02744000
*         QWALTMSC=ON;              /* BIT IN QUERY ORDER    @ZA27590*/ 02745000
         OI    QWALTMSC(@07),B'00000001'                           0963 02746000
*       CALL IDCSASS0(GDTTBL,RDMSC,QUERYPTR,REASON);/* READ MSC WCS     02747000
*                                                            @Z40LB40*/ 02748000
@RF00962 L     @07,@PC00001                                        0964 02749000
         ST    @07,@AL00001                                        0964 02750000
         LA    @05,RDMSC                                           0964 02751000
         ST    @05,@AL00001+4                                      0964 02752000
         LA    @05,QUERYPTR                                        0964 02753000
         ST    @05,@AL00001+8                                      0964 02754000
         LA    @05,REASON                                          0964 02755000
         ST    @05,@AL00001+12                                     0964 02756000
         MVI   @AL00001+12,X'80'                                   0964 02757000
         L     @15,GDTSSC(,@07)                                    0964 02758000
         LA    @01,@AL00001                                        0964 02759000
         BALR  @14,@15                                             0964 02760000
*       RESPECIFY                                                  0965 02761000
*         RTNREG RSTD;                                             0965 02762000
*       TESTRC=RTNREG;                                             0966 02763000
         LR    TESTRC,RTNREG                                       0966 02764000
*       RESPECIFY                                                  0967 02765000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 02766000
*       IF TESTRC=0 THEN                                           0968 02767000
         LTR   TESTRC,TESTRC                                       0968 02768000
         BNZ   @RF00968                                            0968 02769000
*         DO;                       /*                       @Z40LB40*/ 02770000
*           MSPTR=(I3*256)+MEMPTR;  /* CALC AREA ADDRESS     @Z40LB40*/ 02771000
         LR    MSPTR,I3                                            0970 02772000
         SLA   MSPTR,8                                             0970 02773000
         AL    MSPTR,MEMPTR                                        0970 02774000
*           MEMSECT=RTRECA;         /* SAVE SECTOR           @Z40LB40*/ 02775000
         MVC   MEMSECT(256,MSPTR),RTRECA                           0971 02776000
*         END;                      /*                       @Z40LB40*/ 02777000
*       ELSE                                                       0973 02778000
*         DO;                       /*                       @Z40LB40*/ 02779000
         B     @RC00968                                            0973 02780000
@RF00968 DS    0H                                                  0974 02781000
*           CALL SSCMSG(REASON);    /* ISSUE USSC MESSAGE    @Z40LB40*/ 02782000
         LA    @15,REASON                                          0974 02783000
         ST    @15,@AL00001                                        0974 02784000
         LA    @01,@AL00001                                        0974 02785000
         BAL   @14,SSCMSG                                          0974 02786000
*           GETDRC=LASTCC04;        /* SET RETURN CODE       @Z40LB40*/ 02787000
         LA    GETDRC,4                                            0975 02788000
*           I3='FF'X;               /* STOP DO LOOP          @Z40LB40*/ 02789000
         LA    I3,255                                              0976 02790000
*         END;                      /*                       @Z40LB40*/ 02791000
*     END;                          /*                       @Z40LB40*/ 02792000
@RC00968 AL    I3,@CF00223                                         0978 02793000
         C     I3,@CF00589                                         0978 02794000
         BNH   @DL00958                                            0978 02795000
*   IF GETDTYPE=MSCM&GETDRC=LASTCC00 THEN                          0979 02796000
*                                                                  0979 02797000
@RF00957 L     @07,@PC00005                                        0979 02798000
         CLC   GETDTYPE(4,@07),@CC01344                            0979 02799000
         BNE   @RF00979                                            0979 02800000
         LTR   GETDRC,GETDRC                                       0979 02801000
         BNZ   @RF00979                                            0979 02802000
*     /***************************************************************/ 02803000
*     /*                                                             */ 02804000
*     /* READ MSC MAIN STORAGE SECTORS 00-03                 @Z40LB40*/ 02805000
*     /*                                                             */ 02806000
*     /***************************************************************/ 02807000
*                                                                  0980 02808000
*     DO I3='00'X TO'03'X;          /* READ SECTORS 00-03    @Z40LB40*/ 02809000
         SLR   I3,I3                                               0980 02810000
@DL00980 DS    0H                                                  0981 02811000
*       PARMLST=''B;                /* CLEAR ICBQUERY LIST   @Z40LB40*/ 02812000
         XC    PARMLST(44),PARMLST                                 0981 02813000
*       QUSECT=I3;                  /* SET WANTED SECTOR     @Z40LB40*/ 02814000
         L     @07,QUERYPTR                                        0982 02815000
         STC   I3,QUSECT(,@07)                                     0982 02816000
*       QUPTR=ADDR(RTAREA);         /* SET RETURN ADDR       @Z40LB40*/ 02817000
         LA    @05,RTAREA                                          0983 02818000
         ST    @05,QUPTR(,@07)                                     0983 02819000
*       IF ADDR(AMSC)^=NULLPTR THEN /* IF ALT THEN SET       @ZA27590*/ 02820000
         L     @05,@PC00001+4                                      0984 02821000
         L     @05,FDTPTR+92(,@05)                                 0984 02822000
         LTR   @05,@05                                             0984 02823000
         BZ    @RF00984                                            0984 02824000
*         QWALTMSC=ON;              /* BIT IN QUERY ORDER    @ZA27590*/ 02825000
         OI    QWALTMSC(@07),B'00000001'                           0985 02826000
*       CALL IDCSASS0(GDTTBL,RDMSC,QUERYPTR,REASON);/* READ MSC WCS     02827000
*                                                            @Z40LB40*/ 02828000
@RF00984 L     @07,@PC00001                                        0986 02829000
         ST    @07,@AL00001                                        0986 02830000
         LA    @05,RDMSC                                           0986 02831000
         ST    @05,@AL00001+4                                      0986 02832000
         LA    @05,QUERYPTR                                        0986 02833000
         ST    @05,@AL00001+8                                      0986 02834000
         LA    @05,REASON                                          0986 02835000
         ST    @05,@AL00001+12                                     0986 02836000
         MVI   @AL00001+12,X'80'                                   0986 02837000
         L     @15,GDTSSC(,@07)                                    0986 02838000
         LA    @01,@AL00001                                        0986 02839000
         BALR  @14,@15                                             0986 02840000
*       RESPECIFY                                                  0987 02841000
*         RTNREG RSTD;                                             0987 02842000
*       TESTRC=RTNREG;                                             0988 02843000
         LR    TESTRC,RTNREG                                       0988 02844000
*       RESPECIFY                                                  0989 02845000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 02846000
*       IF TESTRC=0 THEN                                           0990 02847000
         LTR   TESTRC,TESTRC                                       0990 02848000
         BNZ   @RF00990                                            0990 02849000
*         DO;                       /*                       @Z40LB40*/ 02850000
*           MSPTR=(I3*256)+MEMPTR;  /* CALC AREA ADDRESS     @Z40LB40*/ 02851000
         LR    MSPTR,I3                                            0992 02852000
         SLA   MSPTR,8                                             0992 02853000
         AL    MSPTR,MEMPTR                                        0992 02854000
*           MEMSECT=RTRECA;         /* SAVE SECTOR           @Z40LB40*/ 02855000
         MVC   MEMSECT(256,MSPTR),RTRECA                           0993 02856000
*         END;                      /*                       @Z40LB40*/ 02857000
*       ELSE                                                       0995 02858000
*         DO;                       /*                       @Z40LB40*/ 02859000
         B     @RC00990                                            0995 02860000
@RF00990 DS    0H                                                  0996 02861000
*           CALL SSCMSG(REASON);    /* ISSUE USSC MESSAGE    @Z40LB40*/ 02862000
         LA    @15,REASON                                          0996 02863000
         ST    @15,@AL00001                                        0996 02864000
         LA    @01,@AL00001                                        0996 02865000
         BAL   @14,SSCMSG                                          0996 02866000
*           GETDRC=LASTCC04;        /* SET RETURN CODE       @Z40LB40*/ 02867000
         LA    GETDRC,4                                            0997 02868000
*           I3='03'X;               /* STOP DO LOOP          @Z40LB40*/ 02869000
         LA    I3,3                                                0998 02870000
*         END;                      /*                       @Z40LB40*/ 02871000
*     END;                          /*                       @Z40LB40*/ 02872000
@RC00990 AL    I3,@CF00223                                         1000 02873000
         C     I3,@CF01513                                         1000 02874000
         BNH   @DL00980                                            1000 02875000
*   IF GETDTYPE=MSCE THEN                                          1001 02876000
*                                                                  1001 02877000
@RF00979 L     @07,@PC00005                                        1001 02878000
         CLC   GETDTYPE(4,@07),@CC01346                            1001 02879000
         BNE   @RF01001                                            1001 02880000
*     /***************************************************************/ 02881000
*     /*                                                             */ 02882000
*     /* READ ALL OF MSC EXTENDED STORAGE                    @Z40LB40*/ 02883000
*     /*                                                             */ 02884000
*     /***************************************************************/ 02885000
*                                                                  1002 02886000
*     DO I3='C0'X TO'FF'X;          /* READ 64 SECTORS       @Z40LB40*/ 02887000
         LA    I3,192                                              1002 02888000
@DL01002 DS    0H                                                  1003 02889000
*       PARMLST=''B;                /* CLEAR ICBQUERY LIST   @Z40LB40*/ 02890000
         XC    PARMLST(44),PARMLST                                 1003 02891000
*       QUSECT=I3;                  /* SET WANTED SECTOR     @Z40LB40*/ 02892000
         L     @07,QUERYPTR                                        1004 02893000
         STC   I3,QUSECT(,@07)                                     1004 02894000
*       QWMEM=ON;                   /* SET EXTENDED STORE    @Z40LB40*/ 02895000
         OI    QWMEM(@07),B'10000000'                              1005 02896000
*       QUPTR=ADDR(RTAREA);         /* SET RETURN ADDR       @Z40LB40*/ 02897000
         LA    @05,RTAREA                                          1006 02898000
         ST    @05,QUPTR(,@07)                                     1006 02899000
*       IF ADDR(AMSC)^=NULLPTR THEN /* IF ALT THEN SET       @ZA27590*/ 02900000
         L     @05,@PC00001+4                                      1007 02901000
         L     @05,FDTPTR+92(,@05)                                 1007 02902000
         LTR   @05,@05                                             1007 02903000
         BZ    @RF01007                                            1007 02904000
*         QWALTMSC=ON;              /* BIT IN QUERY ORDER    @ZA27590*/ 02905000
         OI    QWALTMSC(@07),B'00000001'                           1008 02906000
*       CALL IDCSASS0(GDTTBL,RDMSC,QUERYPTR,REASON);/* READ MSC WCS     02907000
*                                                            @Z40LB40*/ 02908000
@RF01007 L     @07,@PC00001                                        1009 02909000
         ST    @07,@AL00001                                        1009 02910000
         LA    @05,RDMSC                                           1009 02911000
         ST    @05,@AL00001+4                                      1009 02912000
         LA    @05,QUERYPTR                                        1009 02913000
         ST    @05,@AL00001+8                                      1009 02914000
         LA    @05,REASON                                          1009 02915000
         ST    @05,@AL00001+12                                     1009 02916000
         MVI   @AL00001+12,X'80'                                   1009 02917000
         L     @15,GDTSSC(,@07)                                    1009 02918000
         LA    @01,@AL00001                                        1009 02919000
         BALR  @14,@15                                             1009 02920000
*       RESPECIFY                                                  1010 02921000
*         RTNREG RSTD;                                             1010 02922000
*       TESTRC=RTNREG;                                             1011 02923000
         LR    TESTRC,RTNREG                                       1011 02924000
*       RESPECIFY                                                  1012 02925000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 02926000
*       IF TESTRC=0 THEN                                           1013 02927000
         LTR   TESTRC,TESTRC                                       1013 02928000
         BNZ   @RF01013                                            1013 02929000
*         DO;                       /*                       @Z40LB40*/ 02930000
*           MSPTR=(I3*256)+MEMPTR;  /* CALC AREA ADDRESS     @Z40LB40*/ 02931000
         LR    MSPTR,I3                                            1015 02932000
         SLA   MSPTR,8                                             1015 02933000
         AL    MSPTR,MEMPTR                                        1015 02934000
*           MEMSECT=RTRECA;         /* SAVE SECTOR           @Z40LB40*/ 02935000
         MVC   MEMSECT(256,MSPTR),RTRECA                           1016 02936000
*         END;                      /*                       @Z40LB40*/ 02937000
*       ELSE                                                       1018 02938000
*         DO;                       /*                       @Z40LB40*/ 02939000
         B     @RC01013                                            1018 02940000
@RF01013 DS    0H                                                  1019 02941000
*           CALL SSCMSG(REASON);    /* ISSUE USSC MESSAGE    @Z40LB40*/ 02942000
         LA    @15,REASON                                          1019 02943000
         ST    @15,@AL00001                                        1019 02944000
         LA    @01,@AL00001                                        1019 02945000
         BAL   @14,SSCMSG                                          1019 02946000
*           GETDRC=LASTCC04;        /* SET RETURN CODE       @Z40LB40*/ 02947000
         LA    GETDRC,4                                            1020 02948000
*           I3='FF'X;               /* STOP DO LOOP          @Z40LB40*/ 02949000
         LA    I3,255                                              1021 02950000
*         END;                      /*                       @Z40LB40*/ 02951000
*     END;                          /*                       @Z40LB40*/ 02952000
@RC01013 AL    I3,@CF00223                                         1023 02953000
         C     I3,@CF00589                                         1023 02954000
         BNH   @DL01002                                            1023 02955000
*   IF GETDTYPE=SAMA THEN                                          1024 02956000
*                                                                  1024 02957000
@RF01001 L     @07,@PC00005                                        1024 02958000
         CLC   GETDTYPE(4,@07),@CC01348                            1024 02959000
         BNE   @RF01024                                            1024 02960000
*     /***************************************************************/ 02961000
*     /*                                                             */ 02962000
*     /* READ ALL OF STAGING ADAPTER MAIN STORAGE PLUS       @ZD00043*/ 02963000
*     /* PST FROM EXTENDED STORAGE.                          @ZD00043*/ 02964000
*     /* SSID OF STAGING ADAPTER IS AT GETDSEC.              @Z40LB40*/ 02965000
*     /*                                                             */ 02966000
*     /***************************************************************/ 02967000
*                                                                  1025 02968000
*     DO I3='00'X TO'FF'X;          /* READ 256 SECTORS      @Z40LB40*/ 02969000
         SLR   I3,I3                                               1025 02970000
@DL01025 DS    0H                                                  1026 02971000
*       PARMLST=''B;                /* CLEAR ICBQUERY LIST   @Z40LB40*/ 02972000
         XC    PARMLST(44),PARMLST                                 1026 02973000
*       QUSECT=I3;                  /* SET WANTED SECTOR     @Z40LB40*/ 02974000
         L     @07,QUERYPTR                                        1027 02975000
         STC   I3,QUSECT(,@07)                                     1027 02976000
*       QUPTR=ADDR(RTAREA);         /* SET RETURN ADDR       @Z40LB40*/ 02977000
         LA    @05,RTAREA                                          1028 02978000
         ST    @05,QUPTR(,@07)                                     1028 02979000
*       QWSSID=GETDSEC;             /* SET SSID VALUE        @Z40LB40*/ 02980000
         L     @05,@PC00005+4                                      1029 02981000
         L     @05,GETDSEC(,@05)                                   1029 02982000
         STH   @05,QWSSID(,@07)                                    1029 02983000
*       CALL IDCSASS0(GDTTBL,RDSTGAD,QUERYPTR,REASON);/* READ SA WCS    02984000
*                                                            @Z40LB40*/ 02985000
         L     @07,@PC00001                                        1030 02986000
         ST    @07,@AL00001                                        1030 02987000
         LA    @05,RDSTGAD                                         1030 02988000
         ST    @05,@AL00001+4                                      1030 02989000
         LA    @05,QUERYPTR                                        1030 02990000
         ST    @05,@AL00001+8                                      1030 02991000
         LA    @05,REASON                                          1030 02992000
         ST    @05,@AL00001+12                                     1030 02993000
         MVI   @AL00001+12,X'80'                                   1030 02994000
         L     @15,GDTSSC(,@07)                                    1030 02995000
         LA    @01,@AL00001                                        1030 02996000
         BALR  @14,@15                                             1030 02997000
*       RESPECIFY                                                  1031 02998000
*         RTNREG RSTD;                                             1031 02999000
*       TESTRC=RTNREG;                                             1032 03000000
         LR    TESTRC,RTNREG                                       1032 03001000
*       RESPECIFY                                                  1033 03002000
*         RTNREG UNRSTD;            /*                       @Z40LB40*/ 03003000
*       IF TESTRC=0 THEN                                           1034 03004000
         LTR   TESTRC,TESTRC                                       1034 03005000
         BNZ   @RF01034                                            1034 03006000
*         DO;                       /*                       @Z40LB40*/ 03007000
*           MSPTR=(I3*256)+MEMPTR;  /* CALC AREA ADDRESS     @Z40LB40*/ 03008000
         LR    MSPTR,I3                                            1036 03009000
         SLA   MSPTR,8                                             1036 03010000
         AL    MSPTR,MEMPTR                                        1036 03011000
*           MEMSECT=RTRECB;         /* SAVE SECTOR           @Z40LB40*/ 03012000
         MVC   MEMSECT(256,MSPTR),RTRECB                           1037 03013000
*         END;                      /*                       @Z40LB40*/ 03014000
*       ELSE                                                       1039 03015000
*         DO;                       /*                       @Z40LB40*/ 03016000
         B     @RC01034                                            1039 03017000
@RF01034 DS    0H                                                  1040 03018000
*           CALL SSCMSG(REASON);    /* ISSUE USSC MESSAGE    @Z40LB40*/ 03019000
         LA    @15,REASON                                          1040 03020000
         ST    @15,@AL00001                                        1040 03021000
         LA    @01,@AL00001                                        1040 03022000
         BAL   @14,SSCMSG                                          1040 03023000
*           GETDRC=LASTCC04;        /* SET RETURN CODE       @Z40LB40*/ 03024000
         LA    GETDRC,4                                            1041 03025000
*           I3='FF'X;               /* STOP DO LOOP          @Z40LB40*/ 03026000
         LA    I3,255                                              1042 03027000
*         END;                      /*                       @Z40LB40*/ 03028000
*     END;                          /*                       @Z40LB40*/ 03029000
@RC01034 AL    I3,@CF00223                                         1044 03030000
         C     I3,@CF00589                                         1044 03031000
         BNH   @DL01025                                            1044 03032000
*   IF GETDTYPE=SAMA&GETDRC=LASTCC00 THEN                          1045 03033000
*                                                                  1045 03034000
@RF01024 L     @07,@PC00005                                        1045 03035000
         CLC   GETDTYPE(4,@07),@CC01348                            1045 03036000
         BNE   @RF01045                                            1045 03037000
         LTR   GETDRC,GETDRC                                       1045 03038000
         BNZ   @RF01045                                            1045 03039000
*     /***************************************************************/ 03040000
*     /*                                                             */ 03041000
*     /* READ PST FROM EXTENDED STORAGE                      @ZD00043*/ 03042000
*     /*                                                             */ 03043000
*     /***************************************************************/ 03044000
*                                                                  1046 03045000
*     DO;                           /*                       @ZD00043*/ 03046000
*       MSPTR=MEMPTR+'10000'X;      /* SET AREA ADDRESS      @ZD00043*/ 03047000
         L     MSPTR,@CF01515                                      1047 03048000
         AL    MSPTR,MEMPTR                                        1047 03049000
*       DO I3='C0'X TO'CC'X;        /* READ 13 SECTORS       @ZD00043*/ 03050000
         LA    I3,192                                              1048 03051000
@DL01048 DS    0H                                                  1049 03052000
*         PARMLST=''B;              /* CLEAR ICBQUERY LIST   @ZD00043*/ 03053000
         XC    PARMLST(44),PARMLST                                 1049 03054000
*         QUSECT=I3;                /* SET WANTED SECTOR     @ZD00043*/ 03055000
         L     @07,QUERYPTR                                        1050 03056000
         STC   I3,QUSECT(,@07)                                     1050 03057000
*         QWMEM=ON;                 /* SET EXTENDED STORE    @ZD00043*/ 03058000
         OI    QWMEM(@07),B'10000000'                              1051 03059000
*         QUPTR=ADDR(RTAREA);       /* SET RETURN ADDR       @ZD00043*/ 03060000
         LA    @02,RTAREA                                          1052 03061000
         ST    @02,QUPTR(,@07)                                     1052 03062000
*         QWSSID=GETDSEC;           /* SET SSID VALUE        @ZD00043*/ 03063000
         L     @02,@PC00005+4                                      1053 03064000
         L     @02,GETDSEC(,@02)                                   1053 03065000
         STH   @02,QWSSID(,@07)                                    1053 03066000
*         CALL IDCSASS0(GDTTBL,RDSTGAD,QUERYPTR,REASON);/* READ EXT.    03067000
*                                                            @ZD00043*/ 03068000
         L     @07,@PC00001                                        1054 03069000
         ST    @07,@AL00001                                        1054 03070000
         LA    @02,RDSTGAD                                         1054 03071000
         ST    @02,@AL00001+4                                      1054 03072000
         LA    @02,QUERYPTR                                        1054 03073000
         ST    @02,@AL00001+8                                      1054 03074000
         LA    @02,REASON                                          1054 03075000
         ST    @02,@AL00001+12                                     1054 03076000
         MVI   @AL00001+12,X'80'                                   1054 03077000
         L     @15,GDTSSC(,@07)                                    1054 03078000
         LA    @01,@AL00001                                        1054 03079000
         BALR  @14,@15                                             1054 03080000
*         RESPECIFY                                                1055 03081000
*           RTNREG RSTD;                                           1055 03082000
*         TESTRC=RTNREG;                                           1056 03083000
         LR    TESTRC,RTNREG                                       1056 03084000
*         RESPECIFY                                                1057 03085000
*           RTNREG UNRSTD;          /*                       @ZD00043*/ 03086000
*         IF TESTRC=0 THEN                                         1058 03087000
         LTR   TESTRC,TESTRC                                       1058 03088000
         BNZ   @RF01058                                            1058 03089000
*           DO;                     /*                       @ZD00043*/ 03090000
*             MEMSECT=RTRECB;       /* SAVE SECTOR           @ZD00043*/ 03091000
         MVC   MEMSECT(256,MSPTR),RTRECB                           1060 03092000
*             MSPTR=MSPTR+256;      /* BUMP SAVE POINTER     @ZD00043*/ 03093000
         AL    MSPTR,@CF01321                                      1061 03094000
*           END;                    /*                       @ZD00043*/ 03095000
*         ELSE                                                     1063 03096000
*           DO;                     /*                       @ZD00043*/ 03097000
         B     @RC01058                                            1063 03098000
@RF01058 DS    0H                                                  1064 03099000
*             CALL SSCMSG(REASON);  /* ISSUE USSC MESSAGE    @ZD00043*/ 03100000
         LA    @04,REASON                                          1064 03101000
         ST    @04,@AL00001                                        1064 03102000
         LA    @01,@AL00001                                        1064 03103000
         BAL   @14,SSCMSG                                          1064 03104000
*             GETDRC=LASTCC04;      /* SET RETURN CODE       @ZD00043*/ 03105000
         LA    GETDRC,4                                            1065 03106000
*             I3='CC'X;             /* STOP DO LOOP          @ZD00043*/ 03107000
         LA    I3,204                                              1066 03108000
*           END;                    /*                       @ZD00043*/ 03109000
*       END;                        /*                       @ZD00043*/ 03110000
@RC01058 AL    I3,@CF00223                                         1068 03111000
         C     I3,@CF01516                                         1068 03112000
         BNH   @DL01048                                            1068 03113000
*     END;                          /*                       @ZD00043*/ 03114000
*   IF GETDTYPE=SAEX THEN                                          1070 03115000
*                                                                  1070 03116000
@RF01045 L     @07,@PC00005                                        1070 03117000
         CLC   GETDTYPE(4,@07),@CC01350                            1070 03118000
         BNE   @RF01070                                            1070 03119000
*     /***************************************************************/ 03120000
*     /*                                                             */ 03121000
*     /* SA EXTENDED STORAGE REQUESTED. FIRST, READ SECTOR   @ZD00050*/ 03122000
*     /* 00 FROM SA MAIN STORAGE TO GET THE BIT PATTERN      @ZD00050*/ 03123000
*     /* THAT SHOWS WHICH 1K WORD SEGMENTS OF EXTENDED       @ZD00050*/ 03124000
*     /* STORAGE ARE VALID. SECOND, READ ONLY THOSE SECTORS  @ZD00050*/ 03125000
*     /* THAT FALL IN THE VALID 1K WORD AREAS. LOCATION 00E4 @ZD00050*/ 03126000
*     /* OF SA MAIN INDICATES THE 1K VALID AREAS. THE FIRST  @ZD00050*/ 03127000
*     /* 16 BITS ARE BIT SWITCHES WITH A 1 INDICATING VALID  @ZD00050*/ 03128000
*     /* 1K WORD AREA AND 0 INDICATING INVALID 1K WORD AREA. @ZD00050*/ 03129000
*     /* BIT ZERO COVERS ADDRESSES F0-FF, BIT 1 COVERS E0-EF @ZD00050*/ 03130000
*     /* ETC... WITH BIT 14 COVERING 10-1F AND BIT 15        @ZD00050*/ 03131000
*     /* COVERING 00-0F.                                     @ZD00050*/ 03132000
*     /*                                                             */ 03133000
*     /***************************************************************/ 03134000
*                                                                  1071 03135000
*     DO;                           /*                       @ZD00050*/ 03136000
*                                                                  1071 03137000
*       /*************************************************************/ 03138000
*       /*                                                           */ 03139000
*       /* READ SECTOR 00 FROM MAIN TO GET BIT SWITCHES      @ZD00050*/ 03140000
*       /*                                                           */ 03141000
*       /*************************************************************/ 03142000
*                                                                  1072 03143000
*       PARMLST=''B;                /*                       @ZD00050*/ 03144000
         XC    PARMLST(44),PARMLST                                 1072 03145000
*       QUSECT='00'X;               /*                       @ZD00050*/ 03146000
         L     @07,QUERYPTR                                        1073 03147000
         MVI   QUSECT(@07),X'00'                                   1073 03148000
*       QUPTR=ADDR(RTAREA);         /*                       @ZD00050*/ 03149000
         LA    @02,RTAREA                                          1074 03150000
         ST    @02,QUPTR(,@07)                                     1074 03151000
*       QWSSID=GETDSEC;             /*                       @ZD00050*/ 03152000
         L     @02,@PC00005+4                                      1075 03153000
         L     @02,GETDSEC(,@02)                                   1075 03154000
         STH   @02,QWSSID(,@07)                                    1075 03155000
*       CALL IDCSASS0(GDTTBL,RDSTGAD,QUERYPTR,REASON);/*     @ZD00050*/ 03156000
         L     @07,@PC00001                                        1076 03157000
         ST    @07,@AL00001                                        1076 03158000
         LA    @02,RDSTGAD                                         1076 03159000
         ST    @02,@AL00001+4                                      1076 03160000
         LA    @02,QUERYPTR                                        1076 03161000
         ST    @02,@AL00001+8                                      1076 03162000
         LA    @02,REASON                                          1076 03163000
         ST    @02,@AL00001+12                                     1076 03164000
         MVI   @AL00001+12,X'80'                                   1076 03165000
         L     @15,GDTSSC(,@07)                                    1076 03166000
         LA    @01,@AL00001                                        1076 03167000
         BALR  @14,@15                                             1076 03168000
*       RESPECIFY                                                  1077 03169000
*         RTNREG RSTD;                                             1077 03170000
*       TESTRC=RTNREG;                                             1078 03171000
         LR    TESTRC,RTNREG                                       1078 03172000
*       RESPECIFY                                                  1079 03173000
*         RTNREG UNRSTD;            /*                       @ZD00050*/ 03174000
*       IF TESTRC=0 THEN                                           1080 03175000
         LTR   TESTRC,TESTRC                                       1080 03176000
         BNZ   @RF01080                                            1080 03177000
*         DO;                       /*                       @ZD00050*/ 03178000
*           MSPTR=MEMPTR;           /*                       @ZD00050*/ 03179000
         L     MSPTR,MEMPTR                                        1082 03180000
*           MEMSECT=RTRECB;         /*                       @ZD00050*/ 03181000
         MVC   MEMSECT(256,MSPTR),RTRECB                           1083 03182000
*         END;                      /*                       @ZD00050*/ 03183000
*       ELSE                                                       1085 03184000
*         DO;                       /*                       @ZD00050*/ 03185000
         B     @RC01080                                            1085 03186000
@RF01080 DS    0H                                                  1086 03187000
*           CALL SSCMSG(REASON);    /*                       @ZD00050*/ 03188000
         LA    @15,REASON                                          1086 03189000
         ST    @15,@AL00001                                        1086 03190000
         LA    @01,@AL00001                                        1086 03191000
         BAL   @14,SSCMSG                                          1086 03192000
*           GETDRC=LASTCC04;        /*                       @ZD00050*/ 03193000
         LA    GETDRC,4                                            1087 03194000
*         END;                      /*                       @ZD00050*/ 03195000
*       IF GETDRC=LASTCC00 THEN                                    1089 03196000
@RC01080 LTR   GETDRC,GETDRC                                       1089 03197000
         BNZ   @RF01089                                            1089 03198000
*         DO;                       /*                       @ZD00050*/ 03199000
*                                                                  1090 03200000
*           /*********************************************************/ 03201000
*           /*                                                       */ 03202000
*           /* SECTOR 00 READ OK, TRANSLATE BIT PATTERN INTO @ZD00050*/ 03203000
*           /* SWITCHES IN AN ARRAY FOR LATER REFERENCE.     @ZD00050*/ 03204000
*           /*                                                       */ 03205000
*           /*********************************************************/ 03206000
*                                                                  1091 03207000
*           BYTEMASK='00000001'B;   /* SET TRANSLATE MASK    @ZD00050*/ 03208000
         LA    BYTEMASK,1                                          1091 03209000
*           DO I3=1 TO 8;           /* ADDRS. 00-7F          @ZD00050*/ 03210000
         LA    I3,1                                                1092 03211000
@DL01092 DS    0H                                                  1093 03212000
*             IF((MEMPTR+'00E5'X)->MEMBYTE&BYTEMASK)=BYTEMASK THEN 1093 03213000
         LA    @07,229                                             1093 03214000
         AL    @07,MEMPTR                                          1093 03215000
         SLR   @05,@05                                             1093 03216000
         IC    @05,MEMBYTE(,@07)                                   1093 03217000
         NR    @05,BYTEMASK                                        1093 03218000
         CR    @05,BYTEMASK                                        1093 03219000
         BNE   @RF01093                                            1093 03220000
*               EXARRAY(I3)=VALID;  /*                       @ZD00050*/ 03221000
         LA    @07,EXARRAY-1(I3)                                   1094 03222000
         MVI   0(@07),C'1'                                         1094 03223000
*             ELSE                                                 1095 03224000
*               EXARRAY(I3)=INVALID;/*                       @ZD00050*/ 03225000
         B     @RC01093                                            1095 03226000
@RF01093 LA    @07,EXARRAY-1(I3)                                   1095 03227000
         MVI   0(@07),C'0'                                         1095 03228000
*             SLL(BYTEMASK,1);      /*                       @ZD00050*/ 03229000
@RC01093 SLL   BYTEMASK,1                                          1096 03230000
*           END;                    /*                       @ZD00050*/ 03231000
         AL    I3,@CF00223                                         1097 03232000
         C     I3,@CF00183                                         1097 03233000
         BNH   @DL01092                                            1097 03234000
*           BYTEMASK='00000001'B;   /*                       @ZD00050*/ 03235000
         LA    BYTEMASK,1                                          1098 03236000
*           DO I3=9 TO 16;          /* ADDRS. 80-FF          @ZD00050*/ 03237000
         LA    I3,9                                                1099 03238000
@DL01099 DS    0H                                                  1100 03239000
*             IF((MEMPTR+'00E4'X)->MEMBYTE&BYTEMASK)=BYTEMASK THEN 1100 03240000
         LA    @07,228                                             1100 03241000
         AL    @07,MEMPTR                                          1100 03242000
         SLR   @05,@05                                             1100 03243000
         IC    @05,MEMBYTE(,@07)                                   1100 03244000
         NR    @05,BYTEMASK                                        1100 03245000
         CR    @05,BYTEMASK                                        1100 03246000
         BNE   @RF01100                                            1100 03247000
*               EXARRAY(I3)=VALID;  /*                       @ZD00050*/ 03248000
         LA    @07,EXARRAY-1(I3)                                   1101 03249000
         MVI   0(@07),C'1'                                         1101 03250000
*             ELSE                                                 1102 03251000
*               EXARRAY(I3)=INVALID;/*                       @ZD00050*/ 03252000
         B     @RC01100                                            1102 03253000
@RF01100 LA    @07,EXARRAY-1(I3)                                   1102 03254000
         MVI   0(@07),C'0'                                         1102 03255000
*             SLL(BYTEMASK,1);      /*                       @ZD00050*/ 03256000
@RC01100 SLL   BYTEMASK,1                                          1103 03257000
*           END;                    /*                       @ZD00050*/ 03258000
         AL    I3,@CF00223                                         1104 03259000
         C     I3,@CF00510                                         1104 03260000
         BNH   @DL01099                                            1104 03261000
*         END;                      /*                       @ZD00050*/ 03262000
*       IF GETDRC=LASTCC00 THEN                                    1106 03263000
@RF01089 LTR   GETDRC,GETDRC                                       1106 03264000
         BNZ   @RF01106                                            1106 03265000
*         DO;                       /*                       @ZD00050*/ 03266000
*                                                                  1107 03267000
*           /*********************************************************/ 03268000
*           /*                                                       */ 03269000
*           /* EVERYTHING OK SO FAR. READ EACH VALID SA      @ZD00050*/ 03270000
*           /* EXTENDED SECTOR AS REFLECTED BY EXARRAY       @ZD00050*/ 03271000
*           /*                                                       */ 03272000
*           /*********************************************************/ 03273000
*                                                                  1108 03274000
*           DO I3='00'X TO'FF'X;    /*                       @ZD00050*/ 03275000
         SLR   I3,I3                                               1108 03276000
@DL01108 DS    0H                                                  1109 03277000
*             J3=(I3/16)+1;         /* CALC ARRAY ENTRY      @ZD00050*/ 03278000
         LR    @00,I3                                              1109 03279000
         SRDA  @00,32                                              1109 03280000
         D     @00,@CF00510                                        1109 03281000
         AL    @01,@CF00223                                        1109 03282000
         LR    J3,@01                                              1109 03283000
*             IF EXARRAY(J3)=VALID THEN                            1110 03284000
         LA    @05,EXARRAY-1(J3)                                   1110 03285000
         CLI   0(@05),C'1'                                         1110 03286000
         BNE   @RF01110                                            1110 03287000
*               DO;                 /*                       @ZD00050*/ 03288000
*                                                                  1111 03289000
*                 /***************************************************/ 03290000
*                 /*                                                 */ 03291000
*                 /* VALID ADDRESS, READ SECTOR              @ZD00050*/ 03292000
*                 /*                                                 */ 03293000
*                 /***************************************************/ 03294000
*                                                                  1112 03295000
*                 PARMLST=''B;      /*                       @ZD00050*/ 03296000
         XC    PARMLST(44),PARMLST                                 1112 03297000
*                 QUSECT=I3;        /*                       @ZD00050*/ 03298000
         L     @07,QUERYPTR                                        1113 03299000
         STC   I3,QUSECT(,@07)                                     1113 03300000
*                 QWMEM=ON;         /*                       @ZD00050*/ 03301000
         OI    QWMEM(@07),B'10000000'                              1114 03302000
*                 QUPTR=ADDR(RTAREA);/*                      @ZD00050*/ 03303000
         LA    @05,RTAREA                                          1115 03304000
         ST    @05,QUPTR(,@07)                                     1115 03305000
*                 QWSSID=GETDSEC;   /*                       @ZD00050*/ 03306000
         L     @05,@PC00005+4                                      1116 03307000
         L     @05,GETDSEC(,@05)                                   1116 03308000
         STH   @05,QWSSID(,@07)                                    1116 03309000
*                 CALL IDCSASS0(GDTTBL,RDSTGAD,QUERYPTR,REASON);/* 1117 03310000
*                                                            @ZD00050*/ 03311000
         L     @07,@PC00001                                        1117 03312000
         ST    @07,@AL00001                                        1117 03313000
         LA    @05,RDSTGAD                                         1117 03314000
         ST    @05,@AL00001+4                                      1117 03315000
         LA    @05,QUERYPTR                                        1117 03316000
         ST    @05,@AL00001+8                                      1117 03317000
         LA    @05,REASON                                          1117 03318000
         ST    @05,@AL00001+12                                     1117 03319000
         MVI   @AL00001+12,X'80'                                   1117 03320000
         L     @15,GDTSSC(,@07)                                    1117 03321000
         LA    @01,@AL00001                                        1117 03322000
         BALR  @14,@15                                             1117 03323000
*                 RESPECIFY                                        1118 03324000
*                   RTNREG RSTD;                                   1118 03325000
*                 TESTRC=RTNREG;                                   1119 03326000
         LR    TESTRC,RTNREG                                       1119 03327000
*                 RESPECIFY                                        1120 03328000
*                   RTNREG UNRSTD;  /*                       @ZD00050*/ 03329000
*                 IF TESTRC=0 THEN                                 1121 03330000
         LTR   TESTRC,TESTRC                                       1121 03331000
         BNZ   @RF01121                                            1121 03332000
*                   DO;             /*                       @ZD00050*/ 03333000
*                     MSPTR=(I3*256)+MEMPTR;/*               @ZD00050*/ 03334000
         LR    MSPTR,I3                                            1123 03335000
         SLA   MSPTR,8                                             1123 03336000
         AL    MSPTR,MEMPTR                                        1123 03337000
*                     MEMSECT=RTRECB;/*                      @ZD00050*/ 03338000
         MVC   MEMSECT(256,MSPTR),RTRECB                           1124 03339000
*                   END;            /*                       @ZD00050*/ 03340000
*                 ELSE                                             1126 03341000
*                   DO;             /*                       @ZD00050*/ 03342000
         B     @RC01121                                            1126 03343000
@RF01121 DS    0H                                                  1127 03344000
*                     CALL SSCMSG(REASON);/*                 @ZD00050*/ 03345000
         LA    @15,REASON                                          1127 03346000
         ST    @15,@AL00001                                        1127 03347000
         LA    @01,@AL00001                                        1127 03348000
         BAL   @14,SSCMSG                                          1127 03349000
*                     GETDRC=LASTCC04;/*                     @ZD00050*/ 03350000
         LA    GETDRC,4                                            1128 03351000
*                     I3='FF'X;     /* ERROR. KILL LOOP      @ZD00050*/ 03352000
         LA    I3,255                                              1129 03353000
*                   END;            /*                       @ZD00050*/ 03354000
*               END;                /*                       @ZD00050*/ 03355000
@RC01121 DS    0H                                                  1132 03356000
*           END;                    /*                       @ZD00050*/ 03357000
@RF01110 AL    I3,@CF00223                                         1132 03358000
         C     I3,@CF00589                                         1132 03359000
         BNH   @DL01108                                            1132 03360000
*         END;                      /*                       @ZD00050*/ 03361000
*     END;                          /*                       @ZD00050*/ 03362000
@RF01106 DS    0H                                                  1135 03363000
*   IF GETDTYPE=TABL THEN                                          1135 03364000
*                                                                  1135 03365000
@RF01070 L     @07,@PC00005                                        1135 03366000
         CLC   GETDTYPE(4,@07),@CC01352                            1135 03367000
         BNE   @RF01135                                            1135 03368000
*     /***************************************************************/ 03369000
*     /*                                                             */ 03370000
*     /* READ MSC TABLES RECORD. ADDRESS OF RECORD(CHR)      @Z40LB40*/ 03371000
*     /* IS AT GETDSEC.                                      @Z40LB40*/ 03372000
*     /*                                                             */ 03373000
*     /***************************************************************/ 03374000
*                                                                  1136 03375000
*     DO;                           /*                       @Z40LB40*/ 03376000
*                                                                  1136 03377000
*       /*************************************************************/ 03378000
*       /*                                                           */ 03379000
*       /* TEST FOR INVALID TRACKS ON CYLINDER 7.            @Z40LB40*/ 03380000
*       /* THE ONLY VALID TRACK IS TRACK 1.                  @Z40LB40*/ 03381000
*       /*                                                           */ 03382000
*       /*************************************************************/ 03383000
*                                                                  1137 03384000
*       IF GETDCC='07'X THEN        /* IS THIS CYL. 7        @Z40LB40*/ 03385000
         L     @07,@PC00005+4                                      1137 03386000
         CLI   GETDCC(@07),7                                       1137 03387000
         BNE   @RF01137                                            1137 03388000
*         IF GETDHH^='01'X THEN     /* YES,IS THIS TRK 1     @Z40LB40*/ 03389000
         CLI   GETDHH(@07),1                                       1138 03390000
         BE    @RF01138                                            1138 03391000
*           GETDRC=LASTCC04;        /* YES, SET RETURN CD    @Z40LB40*/ 03392000
*                                                                  1139 03393000
         LA    GETDRC,4                                            1139 03394000
*       /*************************************************************/ 03395000
*       /*                                                           */ 03396000
*       /* IF RETURN CODE NOT SET THIS MEANS                 @Z40LB40*/ 03397000
*       /* THAT A VALID CHR IS SPECIFIED                     @Z40LB40*/ 03398000
*       /*                                                           */ 03399000
*       /*************************************************************/ 03400000
*                                                                  1140 03401000
*       IF GETDRC=LASTCC00 THEN                                    1140 03402000
@RF01138 DS    0H                                                  1140 03403000
@RF01137 LTR   GETDRC,GETDRC                                       1140 03404000
         BNZ   @RF01140                                            1140 03405000
*         DO;                       /* READ TABLES REC       @Z40LB40*/ 03406000
*           PARMLST=''B;            /* CLEAR ICBQUERY LIST   @Z40LB40*/ 03407000
         XC    PARMLST(44),PARMLST                                 1142 03408000
*           QTID=NULLTAB;           /* SET TABLE ID          @Z40LB40*/ 03409000
         L     @07,QUERYPTR                                        1143 03410000
         MVI   QTID(@07),B'11110000'                               1143 03411000
*           QTFLAG=CHRREAD;         /* SET READ BY CHR       @Z40LB40*/ 03412000
         MVI   QTFLAG(@07),B'00010001'                             1144 03413000
*           QTDASCHR=GETDSEC;       /* SET CCHHRR            @Z40LB40*/ 03414000
         L     @02,@PC00005+4                                      1145 03415000
         L     @02,GETDSEC(,@02)                                   1145 03416000
         ST    @02,QTDASCHR(,@07)                                  1145 03417000
*           QUPTR=ADDR(RTAREA);     /* SET RETURN ADDR       @Z40LB40*/ 03418000
         LA    @02,RTAREA                                          1146 03419000
         ST    @02,QUPTR(,@07)                                     1146 03420000
*           CALL IDCSASS0(GDTTBL,RDMSCTBL,QUERYPTR,REASON);/* READ 1147 03421000
*                                      REC                   @Z40LB40*/ 03422000
         L     @07,@PC00001                                        1147 03423000
         ST    @07,@AL00001                                        1147 03424000
         LA    @02,RDMSCTBL                                        1147 03425000
         ST    @02,@AL00001+4                                      1147 03426000
         LA    @02,QUERYPTR                                        1147 03427000
         ST    @02,@AL00001+8                                      1147 03428000
         LA    @02,REASON                                          1147 03429000
         ST    @02,@AL00001+12                                     1147 03430000
         MVI   @AL00001+12,X'80'                                   1147 03431000
         L     @15,GDTSSC(,@07)                                    1147 03432000
         LA    @01,@AL00001                                        1147 03433000
         BALR  @14,@15                                             1147 03434000
*           RESPECIFY                                              1148 03435000
*             RTNREG RSTD;                                         1148 03436000
*           TESTRC=RTNREG;                                         1149 03437000
         LR    TESTRC,RTNREG                                       1149 03438000
*           RESPECIFY                                              1150 03439000
*             RTNREG UNRSTD;        /*                       @Z40LB40*/ 03440000
*           IF TESTRC=0 THEN                                       1151 03441000
         LTR   TESTRC,TESTRC                                       1151 03442000
         BNZ   @RF01151                                            1151 03443000
*             DO;                   /*                       @Z40LB40*/ 03444000
*               MSPTR=MEMPTR;       /* SET AREA ADDRESS      @Z40LB40*/ 03445000
         L     MSPTR,MEMPTR                                        1153 03446000
*               MEMSECT=RTRECB;     /* SAVE RECORD           @Z40LB40*/ 03447000
         MVC   MEMSECT(256,MSPTR),RTRECB                           1154 03448000
*               PREFIX=RTPREFIX;    /* SAVE REC PREFIX       @Z40LB40*/ 03449000
         MVC   PREFIX(8),RTPREFIX                                  1155 03450000
*             END;                  /*                       @Z40LB40*/ 03451000
*           ELSE                                                   1157 03452000
*             DO;                   /*                       @Z40LB40*/ 03453000
         B     @RC01151                                            1157 03454000
@RF01151 DS    0H                                                  1158 03455000
*               CALL SSCMSG(REASON);/* ISSUE USSC MESSAGE    @Z40LB40*/ 03456000
         LA    @15,REASON                                          1158 03457000
         ST    @15,@AL00001                                        1158 03458000
         LA    @01,@AL00001                                        1158 03459000
         BAL   @14,SSCMSG                                          1158 03460000
*               GETDRC=LASTCC04;    /* SET RETURN CODE       @Z40LB40*/ 03461000
         LA    GETDRC,4                                            1159 03462000
*             END;                  /*                       @Z40LB40*/ 03463000
*         END;                      /*                       @Z40LB40*/ 03464000
@RC01151 DS    0H                                                  1162 03465000
*     END;                          /*                       @Z40LB40*/ 03466000
@RF01140 DS    0H                                                  1163 03467000
*   IF GETDRC^=LASTCC00 THEN        /* TEST FOR ERRORS       @Z40LB40*/ 03468000
@RF01135 SLR   @07,@07                                             1163 03469000
         CR    GETDRC,@07                                          1163 03470000
         BE    @RF01163                                            1163 03471000
*     DO;                           /* ERRORS FOUND          @Z40LB40*/ 03472000
*       IF GDTDBG=NULLPTR THEN                                     1165 03473000
         L     @15,@PC00001                                        1165 03474000
         C     @07,GDTDBG(,@15)                                    1165 03475000
         BE    @RT01165                                            1165 03476000
*         ;                                                        1166 03477000
*       ELSE                                                       1167 03478000
*         DO;                                                      1167 03479000
*           DMPINDEX=ADDR(DUMPAREA);/* INIT DUMP LIST        @Z40LB40*/ 03480000
         LA    DMPINDEX,DUMPAREA                                   1168 03481000
*           DMPITMNM='PARMLST';                                    1169 03482000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1169 03483000
         MVC   DMPITMNM(7,DMPINDEX),@CC01523                       1169 03484000
*           DMPITMPT=ADDR(PARMLST);                                1170 03485000
         LA    @07,PARMLST                                         1170 03486000
         ST    @07,DMPITMPT(,DMPINDEX)                             1170 03487000
*           DMPITMLN=LENGTH(PARMLST);                              1171 03488000
         MVC   DMPITMLN(2,DMPINDEX),@CH00847                       1171 03489000
*           DMPITMTP='H';                                          1172 03490000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1172 03491000
*           DMPINDEX=DMPINDEX+DMPELEMT;/* DUMP PARM LIST     @Z40LB40*/ 03492000
         AL    DMPINDEX,@CF00510                                   1173 03493000
*           DMPTRM=DMPTRMVL;                                       1174 03494000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1174 03495000
*         END;                      /*                       @Z40LB40*/ 03496000
*       IF GDTDBG=NULLPTR THEN                                     1176 03497000
@RT01165 L     @07,@PC00001                                        1176 03498000
         L     @07,GDTDBG(,@07)                                    1176 03499000
         LTR   @07,@07                                             1176 03500000
         BZ    @RT01176                                            1176 03501000
*         ;                                                        1177 03502000
*       ELSE                                                       1178 03503000
*         CALL IDCDB010(GDTTBL,'DUCA',ADDR(DUMPAREA));/* DUMP LIST 1178 03504000
*                                                            @Z40LB40*/ 03505000
         L     @07,@PC00001                                        1178 03506000
         ST    @07,@AL00001                                        1178 03507000
         LA    @15,@CC01510                                        1178 03508000
         ST    @15,@AL00001+4                                      1178 03509000
         LA    @15,DUMPAREA                                        1178 03510000
         ST    @15,@AFTEMPS                                        1178 03511000
         LA    @15,@AFTEMPS                                        1178 03512000
         ST    @15,@AL00001+8                                      1178 03513000
         MVI   @AL00001+8,X'80'                                    1178 03514000
         L     @15,GDTDBG(,@07)                                    1178 03515000
         LA    @01,@AL00001                                        1178 03516000
         BALR  @14,@15                                             1178 03517000
*     END;                          /*                       @Z40LB40*/ 03518000
@RT01176 DS    0H                                                  1180 03519000
*   RFY                                                            1180 03520000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03521000
@RF01163 DS    0H                                                  1181 03522000
*   REG14=RETADDR2;                 /* SET RETURN POINT      @Z40LB40*/ 03523000
         L     REG14,RETADDR2                                      1181 03524000
*   RETURN CODE(GETDRC);            /* RETURN TO CALLER      @Z40LB40*/ 03525000
         LR    @15,GETDRC                                          1182 03526000
@EL00005 DS    0H                                                  1182 03527000
@EF00005 DS    0H                                                  1182 03528000
@ER00005 BR    @14                                                 1182 03529000
*   RFY                                                            1183 03530000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03531000
*   END GETDATA;                    /*                       @Z40LB40*/ 03532000
*                                                                  1185 03533000
*   /*****************************************************************/ 03534000
*   /*                                                               */ 03535000
*   /* PROCEDURE NAME - PRNTSECT (LEVEL 4)                   @Z40LB40*/ 03536000
*   /*                                                       @Z40LB40*/ 03537000
*   /* FUNCTION - THIS ROUTINE PRINTS THE INDICATED AREA     @Z40LB40*/ 03538000
*   /* OF THE 64K WORK AREA IN HEXADECIMAL.                  @Z40LB40*/ 03539000
*   /*                                                       @Z40LB40*/ 03540000
*   /* INPUT - SECTADDR WHICH IS THE OFFSET INTO THE 64K     @Z40LB40*/ 03541000
*   /* AREA OF THE FIRST BYTE TO BE PRINTED. NUMBYTES WHICH  @Z40LB40*/ 03542000
*   /* IS THE NUMBER OF BYTES TO PRINT.                      @Z40LB40*/ 03543000
*   /*                                                       @Z40LB40*/ 03544000
*   /* OUTPUT - ONE OR MORE PRINT LINES IN THE FOLLOWING     @Z40LB40*/ 03545000
*   /* FORMAT. 4 CHARACTER ADDRESS OFFSET FOLLOWED BY UP     @Z40LB40*/ 03546000
*   /* TO 8 WORDS OF DATA.                                   @Z40LB40*/ 03547000
*   /*                                                               */ 03548000
*   /*****************************************************************/ 03549000
*                                                                  1185 03550000
*PRNTSECT:                                                         1185 03551000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 03552000
PRNTSECT DS    0H                                                  1186 03553000
*   RFY                                                            1186 03554000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03555000
*   RETADDR4=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 03556000
         ST    REG14,RETADDR4                                      1187 03557000
*   RFY                                                            1188 03558000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03559000
*   OLDERID2=NEWERID2;                                             1189 03560000
         L     @07,@PC00001                                        1189 03561000
         L     @07,GDTTR2(,@07)                                    1189 03562000
         MVC   @TS00001(95),NEWERID2(@07)                          1189 03563000
         MVC   OLDERID2(95,@07),@TS00001                           1189 03564000
*   NEWID2='DUDA';                  /*                       @Z40LB40*/ 03565000
         MVC   NEWID2(4,@07),@CC01528                              1190 03566000
*   PROSET1=SECTADDR;               /* SAVE OFFSET           @Z40LB40*/ 03567000
         ST    SECTADDR,PROSET1                                    1191 03568000
*   PRSTART=MEMPTR+PROSET1;         /* CALC START ADDR.      @Z40LB40*/ 03569000
         L     @07,PROSET1                                         1192 03570000
         AL    @07,MEMPTR                                          1192 03571000
         LR    PRSTART,@07                                         1192 03572000
*   DO I4=1 TO NUMBYTES BY 32;      /* LOOP THRU P LINES     @Z40LB40*/ 03573000
         LA    @07,1                                               1193 03574000
         ST    @07,I4                                              1193 03575000
         B     @DE01193                                            1193 03576000
@DL01193 DS    0H                                                  1194 03577000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 03578000
         MVI   PRINTLN+1,C' '                                      1194 03579000
         MVC   PRINTLN+2(119),PRINTLN+1                            1194 03580000
         MVI   PRINTLN,C' '                                        1194 03581000
*     UNPK(PRWORK,PROSET);          /* UNPK OFFSET           @Z40LB40*/ 03582000
         UNPK  PRWORK(9),PROSET(5)                                 1195 03583000
*     TR(PRWORK(5:8),TABLE);        /* TRANSLATE TO EBCDIC   @Z40LB40*/ 03584000
         TR    PRWORK+4(4),TABLE                                   1196 03585000
*     PRINTLNB(1:4)=PRWORK(5:8);    /* OFFSET TO PRINT       @Z40LB40*/ 03586000
         MVC   PRINTLNB(4),PRWORK+4                                1197 03587000
*     PRLNPTR=8;                    /* SET LINE POINTER      @Z40LB40*/ 03588000
         LA    PRLNPTR,8                                           1198 03589000
*     IF(NUMBYTES-I4+1)<32 THEN                                    1199 03590000
         LCR   @07,@07                                             1199 03591000
         AL    @07,NUMBYTES                                        1199 03592000
         AL    @07,@CF00223                                        1199 03593000
         C     @07,@CF00225                                        1199 03594000
         BNL   @RF01199                                            1199 03595000
*       PRBYTES=NUMBYTES-I4+1;      /* EDIT LESS THAN 32     @Z40LB40*/ 03596000
         LR    PRBYTES,@07                                         1200 03597000
*     ELSE                                                         1201 03598000
*       PRBYTES=32;                 /* EDIT 32               @Z40LB40*/ 03599000
         B     @RC01199                                            1201 03600000
@RF01199 LA    PRBYTES,32                                          1201 03601000
*     K4=0;                         /* INIT GROUP COUNT      @Z40LB40*/ 03602000
@RC01199 SLR   @07,@07                                             1202 03603000
         ST    @07,K4                                              1202 03604000
*     DO J4=1 TO PRBYTES BY 4;      /* LOOP THRU WORDS       @Z40LB40*/ 03605000
         LA    J4,1                                                1203 03606000
         B     @DE01203                                            1203 03607000
@DL01203 DS    0H                                                  1204 03608000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 03609000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1204 03610000
*       TR(PRWORK(1:8),TABLE);      /* TRANSLATE TO EBCDIC   @Z40LB40*/ 03611000
         TR    PRWORK(8),TABLE                                     1205 03612000
*       IF(PRBYTES-J4)<3 THEN       /* TEST NOT FULLWORD     @Z40LB40*/ 03613000
         LR    @15,PRBYTES                                         1206 03614000
         SLR   @15,J4                                              1206 03615000
         C     @15,@CF00166                                        1206 03616000
         BNL   @RF01206                                            1206 03617000
*         DO;                       /* NOT FULLWORD          @Z40LB40*/ 03618000
*           IF(PRBYTES-J4)=2 THEN   /* TEST FOR 3 BYTES      @Z40LB40*/ 03619000
         C     @15,@CF00157                                        1208 03620000
         BNE   @RF01208                                            1208 03621000
*             PRINTLNB(PRLNPTR:PRLNPTR+5)=PRWORK;/* MOVE 3   @Z40LB40*/ 03622000
         LA    @01,PRINTLNB-1(PRLNPTR)                             1209 03623000
         MVC   0(6,@01),PRWORK                                     1209 03624000
*           ELSE                                                   1210 03625000
*             IF(PRBYTES-J4)=1 THEN /* TEST FOR 2 BYTES      @Z40LB40*/ 03626000
         B     @RC01208                                            1210 03627000
@RF01208 LR    @15,PRBYTES                                         1210 03628000
         SLR   @15,J4                                              1210 03629000
         C     @15,@CF00223                                        1210 03630000
         BNE   @RF01210                                            1210 03631000
*               PRINTLNB(PRLNPTR:PRLNPTR+3)=PRWORK;/* MOVE 2 @Z40LB40*/ 03632000
         LA    @01,PRINTLNB-1(PRLNPTR)                             1211 03633000
         MVC   0(4,@01),PRWORK                                     1211 03634000
*             ELSE                                                 1212 03635000
*               PRINTLNB(PRLNPTR:PRLNPTR+1)=PRWORK;/* MOVE 1 @Z40LB40*/ 03636000
         B     @RC01210                                            1212 03637000
@RF01210 LA    @01,PRINTLNB-1(PRLNPTR)                             1212 03638000
         MVC   0(2,@01),PRWORK                                     1212 03639000
*         END;                      /*                       @Z40LB40*/ 03640000
*       ELSE                        /* FULLWORD              @Z40LB40*/ 03641000
*         PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE 4 BYTES @Z40LB40*/ 03642000
         B     @RC01206                                            1214 03643000
@RF01206 LA    @01,PRINTLNB-1(PRLNPTR)                             1214 03644000
         MVC   0(8,@01),PRWORK                                     1214 03645000
*       PRSTART=PRSTART+4;          /* BUMP TO NEXT WORD     @Z40LB40*/ 03646000
@RC01206 LA    @15,4                                               1215 03647000
         ALR   PRSTART,@15                                         1215 03648000
*       K4=K4+1;                    /* BUMP GROUP COUNT      @Z40LB40*/ 03649000
         LA    @14,1                                               1216 03650000
         AL    @14,K4                                              1216 03651000
         ST    @14,K4                                              1216 03652000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 03653000
         AL    PRLNPTR,@CF01152                                    1217 03654000
*       IF K4=4 THEN                                               1218 03655000
         CR    @14,@15                                             1218 03656000
         BNE   @RF01218                                            1218 03657000
*         PRLNPTR=PRLNPTR+2;        /* ADD TWO SPACES        @Z40LB40   03658000
*                                      AFTER 4 WORDS         @Z40LB40*/ 03659000
         AL    PRLNPTR,@CF00157                                    1219 03660000
*     END;                          /*                       @Z40LB40*/ 03661000
@RF01218 AL    J4,@CF00044                                         1220 03662000
@DE01203 CR    J4,PRBYTES                                          1220 03663000
         BNH   @DL01203                                            1220 03664000
*     PROSET1=PROSET1+32;           /* BUMP OFFSET           @Z40LB40*/ 03665000
         LA    @07,32                                              1221 03666000
         AL    @07,PROSET1                                         1221 03667000
         ST    @07,PROSET1                                         1221 03668000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 03669000
         BAL   @14,DOUPRINT                                        1222 03670000
*   END;                            /*                       @Z40LB40*/ 03671000
         LA    @07,32                                              1223 03672000
         AL    @07,I4                                              1223 03673000
         ST    @07,I4                                              1223 03674000
@DE01193 C     @07,NUMBYTES                                        1223 03675000
         BNH   @DL01193                                            1223 03676000
*   RFY                                                            1224 03677000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03678000
*   REG14=RETADDR4;                 /* RESET RETURN POINT    @Z40LB40*/ 03679000
         L     REG14,RETADDR4                                      1225 03680000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 03681000
@EL00006 DS    0H                                                  1226 03682000
@EF00006 DS    0H                                                  1226 03683000
@ER00006 BR    @14                                                 1226 03684000
*   RFY                                                            1227 03685000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03686000
*   END PRNTSECT;                   /*                       @Z40LB40*/ 03687000
*                                                                  1229 03688000
*   /*****************************************************************/ 03689000
*   /*                                                               */ 03690000
*   /* PROCEDURE NAME - ZEROBDY (LEVEL 3)                    @Z40LB40*/ 03691000
*   /*                                                       @Z40LB40*/ 03692000
*   /* FUNCTION - THIS ROUTINE PRINTS ALL ZERO BOUNDARY      @Z40LB40*/ 03693000
*   /* WORDS. THEY ARE THE WORDS WHOSE ADDRESSES ARE XX00    @Z40LB40*/ 03694000
*   /* WHERE XX = 00 THROUGH 7F.                             @Z40LB40*/ 03695000
*   /* THE SAME WORDS ARE PRINTED FOR MSC AND STAGING        @Z40LB40*/ 03696000
*   /* ADAPTERS.                                             @Z40LB40*/ 03697000
*   /*                                                       @Z40LB40*/ 03698000
*   /* INPUT - NONE                                          @Z40LB40*/ 03699000
*   /*                                                       @Z40LB40*/ 03700000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE ABOVE DEFINED       @Z40LB40*/ 03701000
*   /* WORDS. THERE IS NO RETURN CODE.                       @Z40LB40*/ 03702000
*   /*                                                               */ 03703000
*   /*****************************************************************/ 03704000
*                                                                  1229 03705000
*ZEROBDY:                                                          1229 03706000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 03707000
ZEROBDY  DS    0H                                                  1230 03708000
*   RFY                                                            1230 03709000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03710000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 03711000
         LR    RETADDR3,REG14                                      1231 03712000
*   RFY                                                            1232 03713000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03714000
*   OLDERID2=NEWERID2;                                             1233 03715000
         L     @07,@PC00001                                        1233 03716000
         L     @05,GDTTR2(,@07)                                    1233 03717000
         MVC   @TS00001(95),NEWERID2(@05)                          1233 03718000
         MVC   OLDERID2(95,@05),@TS00001                           1233 03719000
*   NEWID2='DUCB';                  /*                       @Z40LB40*/ 03720000
         MVC   NEWID2(4,@05),@CC01535                              1234 03721000
*/*  ISSUE UPRINT FOR HEADLINES                              @Z40LB40*/ 03722000
*                                                                  1235 03723000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 03724000
         XC    PRINTAB(44),PRINTAB                                 1235 03725000
*   DARGSMOD=DUMSGMOD;              /* SET TEXT MOD          @Z40LB40*/ 03726000
         L     @05,DDSTRU                                          1236 03727000
         MVC   DARGSMOD(3,@05),@CC01334                            1236 03728000
*   DARGSENT=HZBDY;                 /* SET ENTRY NO.         @Z40LB40*/ 03729000
         MVI   DARGSENT(@05),X'0D'                                 1237 03730000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS      @Z40LB40*/ 03731000
         ST    @07,@AL00001                                        1238 03732000
         LA    @05,PRPTR                                           1238 03733000
         ST    @05,@AL00001+4                                      1238 03734000
         LA    @05,DDSTRU                                          1238 03735000
         ST    @05,@AL00001+8                                      1238 03736000
         MVI   @AL00001+8,X'80'                                    1238 03737000
         L     @15,GDTPRT(,@07)                                    1238 03738000
         LA    @01,@AL00001                                        1238 03739000
         BALR  @14,@15                                             1238 03740000
*   I3='0000'X;                     /* SET START ADDRESS     @Z40LB40*/ 03741000
         SLR   @07,@07                                             1239 03742000
         LR    I3,@07                                              1239 03743000
*   DO J3='0000'X TO'000F'X;        /* LOOP 16 TIMES         @Z40LB40*/ 03744000
         SLR   @05,@05                                             1240 03745000
         LR    J3,@05                                              1240 03746000
@DL01240 DS    0H                                                  1241 03747000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 03748000
         MVI   PRINTLN+1,C' '                                      1241 03749000
         MVC   PRINTLN+2(119),PRINTLN+1                            1241 03750000
         MVI   PRINTLN,C' '                                        1241 03751000
*     PROSET1=J3;                   /* SAVE LINE VALUE       @Z40LB40*/ 03752000
         ST    J3,PROSET1                                          1242 03753000
*     UNPK(PRWORK,PROSET);          /* UNPK LINE VALUE       @Z40LB40*/ 03754000
         UNPK  PRWORK(9),PROSET(5)                                 1243 03755000
*     TR(PRWORK(8:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 03756000
         TR    PRWORK+7(1),TABLE                                   1244 03757000
*     PRINTLNB(1:1)=PRWORK(8:8);    /* MOVE TO LINE          @Z40LB40*/ 03758000
         MVC   PRINTLNB(1),PRWORK+7                                1245 03759000
*     PRINTLNB(75:75)=PRWORK(8:8);  /* MOVE TO LINE          @Z40LB40*/ 03760000
         MVC   PRINTLNB+74(1),PRWORK+7                             1246 03761000
*     PRLNPTR=3;                    /* SET LINE POINTER      @Z40LB40*/ 03762000
         LA    PRLNPTR,3                                           1247 03763000
*     DO K3=I3 TO(I3+'7000'X) BY'1000'X;/* LOOP 8 TIMES      @Z40LB40*/ 03764000
         LR    @05,I3                                              1248 03765000
         ST    @05,K3                                              1248 03766000
         B     @DE01248                                            1248 03767000
@DL01248 DS    0H                                                  1249 03768000
*       PRSTART=K3+MEMPTR;          /* CALC WORD ADDRESS     @Z40LB40*/ 03769000
         L     @02,K3                                              1249 03770000
         LR    PRSTART,@02                                         1249 03771000
         AL    PRSTART,MEMPTR                                      1249 03772000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 03773000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1250 03774000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 03775000
         TR    PRWORK(8),TABLE                                     1251 03776000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 03777000
         LA    @05,PRINTLNB-1(PRLNPTR)                             1252 03778000
         MVC   0(8,@05),PRWORK                                     1252 03779000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 03780000
         AL    PRLNPTR,@CF01152                                    1253 03781000
*     END;                          /*                       @Z40LB40*/ 03782000
         AL    @02,@CF01539                                        1254 03783000
         LR    @05,@02                                             1254 03784000
         ST    @05,K3                                              1254 03785000
@DE01248 LR    @02,I3                                              1254 03786000
         AL    @02,@CF01538                                        1254 03787000
         CR    @05,@02                                             1254 03788000
         BNH   @DL01248                                            1254 03789000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 03790000
         BAL   @14,DOUPRINT                                        1255 03791000
*     I3=I3+'0100'X;                /* BUMP START ADDRESS    @Z40LB40*/ 03792000
         AL    I3,@CF01540                                         1256 03793000
*   END;                            /*                       @Z40LB40*/ 03794000
         AL    J3,@CF00223                                         1257 03795000
         C     J3,@CF01536                                         1257 03796000
         BNH   @DL01240                                            1257 03797000
*   RFY                                                            1258 03798000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03799000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 03800000
         LR    REG14,RETADDR3                                      1259 03801000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 03802000
@EL00007 DS    0H                                                  1260 03803000
@EF00007 DS    0H                                                  1260 03804000
@ER00007 BR    @14                                                 1260 03805000
*   RFY                                                            1261 03806000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03807000
*   END ZEROBDY;                    /*                       @Z40LB40*/ 03808000
*                                                                  1263 03809000
*   /*****************************************************************/ 03810000
*   /*                                                               */ 03811000
*   /* PROCEDURE NAME - JOBLISTS (LEVEL 3)                   @Z40LB40*/ 03812000
*   /*                                                       @Z40LB40*/ 03813000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC JOBLIST        @Z40LB40*/ 03814000
*   /* STATUS BLOCKS AND JOBLISTS.                           @Z40LB40*/ 03815000
*   /*                                                       @Z40LB40*/ 03816000
*   /* INPUT - NONE                                          @Z40LB40*/ 03817000
*   /*                                                       @Z40LB40*/ 03818000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE ABOVE DEFINED       @Z40LB40*/ 03819000
*   /* AREAS. SEE REFERENCES TO SECTADDR FOR                 @Z40LB40*/ 03820000
*   /* ACTUAL LOCATION OF EACH AREA PRINTED.                 @Z40LB40*/ 03821000
*   /*                                                               */ 03822000
*   /*****************************************************************/ 03823000
*                                                                  1263 03824000
*JOBLISTS:                                                         1263 03825000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 03826000
JOBLISTS DS    0H                                                  1264 03827000
*   RFY                                                            1264 03828000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03829000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 03830000
         LR    RETADDR3,REG14                                      1265 03831000
*   RFY                                                            1266 03832000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03833000
*   OLDERID2=NEWERID2;                                             1267 03834000
         L     @07,@PC00001                                        1267 03835000
         L     @02,GDTTR2(,@07)                                    1267 03836000
         MVC   @TS00001(95),NEWERID2(@02)                          1267 03837000
         MVC   OLDERID2(95,@02),@TS00001                           1267 03838000
*   NEWID2='DUCC';                  /*                       @Z40LB40*/ 03839000
*                                                                  1268 03840000
         MVC   NEWID2(4,@02),@CC01544                              1268 03841000
*   /*****************************************************************/ 03842000
*   /*                                                               */ 03843000
*   /* ISSUE UPRINT FOR JOBLIST STATUS BLOCKS HEADER         @Z40LB40*/ 03844000
*   /*                                                               */ 03845000
*   /*****************************************************************/ 03846000
*                                                                  1269 03847000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 03848000
         XC    PRINTAB(44),PRINTAB                                 1269 03849000
*   DARGSMOD=DUMSGMOD;              /* SET TEXT MOD          @Z40LB40*/ 03850000
         L     @02,DDSTRU                                          1270 03851000
         MVC   DARGSMOD(3,@02),@CC01334                            1270 03852000
*   DARGSENT=HJSB;                  /* SET ENTRY NO.         @Z40LB40*/ 03853000
         MVI   DARGSENT(@02),X'0E'                                 1271 03854000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS      @Z40LB40*/ 03855000
         ST    @07,@AL00001                                        1272 03856000
         LA    @02,PRPTR                                           1272 03857000
         ST    @02,@AL00001+4                                      1272 03858000
         LA    @02,DDSTRU                                          1272 03859000
         ST    @02,@AL00001+8                                      1272 03860000
         MVI   @AL00001+8,X'80'                                    1272 03861000
         L     @15,GDTPRT(,@07)                                    1272 03862000
         LA    @01,@AL00001                                        1272 03863000
         BALR  @14,@15                                             1272 03864000
*   SECTADDR='0300'X;               /* SET SECT ADDR         @Z40LB40*/ 03865000
         LA    SECTADDR,768                                        1273 03866000
*   NUMBYTES=4;                     /* PRINT 4 BYTES         @Z40LB40*/ 03867000
         MVC   NUMBYTES(4),@CF00044                                1274 03868000
*   CALL PRNTSECT;                  /* PRINT BLOCK PTR       @Z40LB40*/ 03869000
         BAL   @14,PRNTSECT                                        1275 03870000
*   SECTADDR='0310'X;               /* SET SECT ADDR         @Z40LB40*/ 03871000
         LA    SECTADDR,784                                        1276 03872000
*   NUMBYTES=32;                    /* PRINT 32 BYTES        @Z40LB40*/ 03873000
         MVC   NUMBYTES(4),@CF00225                                1277 03874000
*   CALL PRNTSECT;                  /* PRINT BLOCKS          @Z40LB40*/ 03875000
*                                                                  1278 03876000
         BAL   @14,PRNTSECT                                        1278 03877000
*   /*****************************************************************/ 03878000
*   /*                                                               */ 03879000
*   /* DUMP JOBLIST SECTORS 1200 THROUGH 1000                @ZD00050*/ 03880000
*   /* ISSUE UPRINT FOR JOBLIST HEADER                       @Z40LB40*/ 03881000
*   /*                                                               */ 03882000
*   /*****************************************************************/ 03883000
*                                                                  1279 03884000
*   DO I3='1200'X TO'1000'X BY-'0100'X;/*                    @ZD00050*/ 03885000
         L     I3,@CF01547                                         1279 03886000
@DL01279 DS    0H                                                  1280 03887000
*     PRINTAB=''B;                  /* CLEAR ARG LIST        @Z40LB40*/ 03888000
         XC    PRINTAB(44),PRINTAB                                 1280 03889000
*     DARGSMOD=DUMSGMOD;            /* SET TEXT MOD          @Z40LB40*/ 03890000
         L     @07,DDSTRU                                          1281 03891000
         MVC   DARGSMOD(3,@07),@CC01334                            1281 03892000
*     DARGSENT=HJL;                 /* SET ENTRY NO.         @Z40LB40*/ 03893000
         MVI   DARGSENT(@07),X'0F'                                 1282 03894000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS    @Z40LB40*/ 03895000
         L     @07,@PC00001                                        1283 03896000
         ST    @07,@AL00001                                        1283 03897000
         LA    @05,PRPTR                                           1283 03898000
         ST    @05,@AL00001+4                                      1283 03899000
         LA    @05,DDSTRU                                          1283 03900000
         ST    @05,@AL00001+8                                      1283 03901000
         MVI   @AL00001+8,X'80'                                    1283 03902000
         L     @15,GDTPRT(,@07)                                    1283 03903000
         LA    @01,@AL00001                                        1283 03904000
         BALR  @14,@15                                             1283 03905000
*     SECTADDR=I3;                  /* SET SECT ADDR         @Z40LB40*/ 03906000
         LR    SECTADDR,I3                                         1284 03907000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 03908000
         MVC   NUMBYTES(4),@CF01321                                1285 03909000
*     CALL PRNTSECT;                /* PRINT JOBLIST         @Z40LB40*/ 03910000
         BAL   @14,PRNTSECT                                        1286 03911000
*   END;                            /*                       @ZD00050*/ 03912000
*                                                                  1287 03913000
         AL    I3,@CF01743                                         1287 03914000
         C     I3,@CF01539                                         1287 03915000
         BNL   @DL01279                                            1287 03916000
*   /*****************************************************************/ 03917000
*   /*                                                               */ 03918000
*   /* DUMP JOBLIST SECTORS 7B00 THROUGH 7800                @Z40LB40*/ 03919000
*   /* ISSUE UPRINT FOR JOBLIST HEADER                       @Z40LB40*/ 03920000
*   /*                                                               */ 03921000
*   /*****************************************************************/ 03922000
*                                                                  1288 03923000
*   DO I3='7B00'X TO'7800'X BY-'0100'X;/*                    @ZD00050*/ 03924000
         L     I3,@CF01548                                         1288 03925000
@DL01288 DS    0H                                                  1289 03926000
*     PRINTAB=''B;                  /* CLEAR ARG LIST        @Z40LB40*/ 03927000
         XC    PRINTAB(44),PRINTAB                                 1289 03928000
*     DARGSMOD=DUMSGMOD;            /* SET TEXT MOD          @Z40LB40*/ 03929000
         L     @07,DDSTRU                                          1290 03930000
         MVC   DARGSMOD(3,@07),@CC01334                            1290 03931000
*     DARGSENT=HJL;                 /* SET ENTRY NO.         @Z40LB40*/ 03932000
         MVI   DARGSENT(@07),X'0F'                                 1291 03933000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS    @Z40LB40*/ 03934000
         L     @07,@PC00001                                        1292 03935000
         ST    @07,@AL00001                                        1292 03936000
         LA    @05,PRPTR                                           1292 03937000
         ST    @05,@AL00001+4                                      1292 03938000
         LA    @05,DDSTRU                                          1292 03939000
         ST    @05,@AL00001+8                                      1292 03940000
         MVI   @AL00001+8,X'80'                                    1292 03941000
         L     @15,GDTPRT(,@07)                                    1292 03942000
         LA    @01,@AL00001                                        1292 03943000
         BALR  @14,@15                                             1292 03944000
*     SECTADDR=I3;                  /* SET SECT ADDR         @Z40LB40*/ 03945000
         LR    SECTADDR,I3                                         1293 03946000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 03947000
         MVC   NUMBYTES(4),@CF01321                                1294 03948000
*     CALL PRNTSECT;                /* PRINT JOBLIST         @Z40LB40*/ 03949000
         BAL   @14,PRNTSECT                                        1295 03950000
*   END;                            /*                       @ZD00050*/ 03951000
*                                                                  1296 03952000
         AL    I3,@CF01743                                         1296 03953000
         C     I3,@CF01549                                         1296 03954000
         BNL   @DL01288                                            1296 03955000
*   /*****************************************************************/ 03956000
*   /*                                                               */ 03957000
*   /* DUMP JOBLIST SECTOR 3B00                              @Z40LB40*/ 03958000
*   /* ISSUE UPRINT FOR JOBLIST HEADER                       @Z40LB40*/ 03959000
*   /*                                                               */ 03960000
*   /*****************************************************************/ 03961000
*                                                                  1297 03962000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 03963000
         XC    PRINTAB(44),PRINTAB                                 1297 03964000
*   DARGSMOD=DUMSGMOD;              /* SET TEXT MOD          @Z40LB40*/ 03965000
         L     @07,DDSTRU                                          1298 03966000
         MVC   DARGSMOD(3,@07),@CC01334                            1298 03967000
*   DARGSENT=HJL;                   /* SET ENTRY NO.         @Z40LB40*/ 03968000
         MVI   DARGSENT(@07),X'0F'                                 1299 03969000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS      @Z40LB40*/ 03970000
         L     @07,@PC00001                                        1300 03971000
         ST    @07,@AL00001                                        1300 03972000
         LA    @02,PRPTR                                           1300 03973000
         ST    @02,@AL00001+4                                      1300 03974000
         LA    @02,DDSTRU                                          1300 03975000
         ST    @02,@AL00001+8                                      1300 03976000
         MVI   @AL00001+8,X'80'                                    1300 03977000
         L     @15,GDTPRT(,@07)                                    1300 03978000
         LA    @01,@AL00001                                        1300 03979000
         BALR  @14,@15                                             1300 03980000
*   SECTADDR='3B00'X;               /* SET SECT ADDR         @Z40LB40*/ 03981000
         L     SECTADDR,@CF01550                                   1301 03982000
*   NUMBYTES=SECTSIZE;              /* SET NO. OF BYTES      @Z40LB40*/ 03983000
         MVC   NUMBYTES(4),@CF01321                                1302 03984000
*   CALL PRNTSECT;                  /* PRINT JOBLIST         @Z40LB40*/ 03985000
         BAL   @14,PRNTSECT                                        1303 03986000
*   RFY                                                            1304 03987000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 03988000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 03989000
         LR    REG14,RETADDR3                                      1305 03990000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 03991000
@EL00008 DS    0H                                                  1306 03992000
@EF00008 DS    0H                                                  1306 03993000
@ER00008 BR    @14                                                 1306 03994000
*   RFY                                                            1307 03995000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 03996000
*   END JOBLISTS;                   /*                       @Z40LB40*/ 03997000
*                                                                  1309 03998000
*   /*****************************************************************/ 03999000
*   /*                                                               */ 04000000
*   /* PROCEDURE NAME - IOBUFFS (LEVEL 3)                    @Z40LB40*/ 04001000
*   /*                                                       @Z40LB40*/ 04002000
*   /* FUNCTION - THIS ROUTINE PRINTS MSC I/O BUFFER         @Z40LB40*/ 04003000
*   /* CONTROL WORDS AND THEIR ASSOCIATED I/O BUFFERS.       @Z40LB40*/ 04004000
*   /*                                                       @Z40LB40*/ 04005000
*   /* INPUT - NONE                                          @Z40LB40*/ 04006000
*   /*                                                       @Z40LB40*/ 04007000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE ABOVE DEFINED       @Z40LB40*/ 04008000
*   /* AREAS. SEE REFERENCE TO SECTADDR FOR ACTUAL           @Z40LB40*/ 04009000
*   /* LOCATION OF EACH AREA PRINTED.                        @Z40LB40*/ 04010000
*   /*                                                               */ 04011000
*   /*****************************************************************/ 04012000
*                                                                  1309 04013000
*IOBUFFS:                                                          1309 04014000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04015000
IOBUFFS  DS    0H                                                  1310 04016000
*   RFY                                                            1310 04017000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04018000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04019000
         LR    RETADDR3,REG14                                      1311 04020000
*   RFY                                                            1312 04021000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04022000
*   OLDERID2=NEWERID2;                                             1313 04023000
         L     @07,@PC00001                                        1313 04024000
         L     @02,GDTTR2(,@07)                                    1313 04025000
         MVC   @TS00001(95),NEWERID2(@02)                          1313 04026000
         MVC   OLDERID2(95,@02),@TS00001                           1313 04027000
*   NEWID2='DUCD';                  /*                       @Z40LB40*/ 04028000
*                                                                  1314 04029000
         MVC   NEWID2(4,@02),@CC01554                              1314 04030000
*   /*****************************************************************/ 04031000
*   /*                                                               */ 04032000
*   /* ISSUE UPRINT FOR I/O BUFFER CONTROL WORD HEADLINES    @Z40LB40*/ 04033000
*   /*                                                               */ 04034000
*   /*****************************************************************/ 04035000
*                                                                  1315 04036000
*   PRINTAB=''B;                    /* CLEAR ARG LIST        @Z40LB40*/ 04037000
         XC    PRINTAB(44),PRINTAB                                 1315 04038000
*   DARGSMOD=DUMSGMOD;              /* SET TEXT MOD          @Z40LB40*/ 04039000
         L     @02,DDSTRU                                          1316 04040000
         MVC   DARGSMOD(3,@02),@CC01334                            1316 04041000
*   DARGSENT=HIOBCW;                /* SET ENTRY NO.         @Z40LB40*/ 04042000
         MVI   DARGSENT(@02),X'10'                                 1317 04043000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS      @Z40LB40*/ 04044000
         ST    @07,@AL00001                                        1318 04045000
         LA    @02,PRPTR                                           1318 04046000
         ST    @02,@AL00001+4                                      1318 04047000
         LA    @02,DDSTRU                                          1318 04048000
         ST    @02,@AL00001+8                                      1318 04049000
         MVI   @AL00001+8,X'80'                                    1318 04050000
         L     @15,GDTPRT(,@07)                                    1318 04051000
         LA    @01,@AL00001                                        1318 04052000
         BALR  @14,@15                                             1318 04053000
*   PRINTLN=' ';                    /* BLANK PRINT LINE      @Z40LB40*/ 04054000
         MVI   PRINTLN+1,C' '                                      1319 04055000
         MVC   PRINTLN+2(119),PRINTLN+1                            1319 04056000
         MVI   PRINTLN,C' '                                        1319 04057000
*   PRLNPTR=1;                      /* SET LINE POINTER      @Z40LB40*/ 04058000
*                                                                  1320 04059000
         LA    PRLNPTR,1                                           1320 04060000
*   /*****************************************************************/ 04061000
*   /*                                                               */ 04062000
*   /* PRINT I/O BUFFER CONTROL WORDS LOCATED AT -           @Z40LB40*/ 04063000
*   /* 5800, 5900, 5A00, 5B00, 5C00 AND 5E00                 @Z40LB40*/ 04064000
*   /*                                                               */ 04065000
*   /*****************************************************************/ 04066000
*                                                                  1321 04067000
*   DO I3='5800'X TO'5C00'X BY'0100'X;/*                     @Z40LB40*/ 04068000
         L     I3,@CF01555                                         1321 04069000
@DL01321 DS    0H                                                  1322 04070000
*     PRSTART=I3+MEMPTR;            /* CALC WORD ADDRESS     @Z40LB40*/ 04071000
         LR    PRSTART,I3                                          1322 04072000
         AL    PRSTART,MEMPTR                                      1322 04073000
*     UNPK(PRWORK,PRAREA);          /* UNPK WORD             @Z40LB40*/ 04074000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1323 04075000
*     TR(PRWORK(1:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 04076000
         TR    PRWORK(8),TABLE                                     1324 04077000
*     PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE     @Z40LB40*/ 04078000
         LA    @07,PRINTLNB-1(PRLNPTR)                             1325 04079000
         MVC   0(8,@07),PRWORK                                     1325 04080000
*     PRLNPTR=PRLNPTR+9;            /* BUMP LINE POINTER     @Z40LB40*/ 04081000
         AL    PRLNPTR,@CF01152                                    1326 04082000
*   END;                            /*                       @Z40LB40*/ 04083000
         AL    I3,@CF01540                                         1327 04084000
         C     I3,@CF01556                                         1327 04085000
         BNH   @DL01321                                            1327 04086000
*   PRSTART='5E00'X+MEMPTR;         /* CALC WORD ADDRESS     @Z40LB40*/ 04087000
         L     PRSTART,@CF01557                                    1328 04088000
         AL    PRSTART,MEMPTR                                      1328 04089000
*   UNPK(PRWORK,PRAREA);            /* UNPK WORD             @Z40LB40*/ 04090000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1329 04091000
*   TR(PRWORK(1:8),TABLE);          /* TR TO EBCDIC          @Z40LB40*/ 04092000
         TR    PRWORK(8),TABLE                                     1330 04093000
*   PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE       @Z40LB40*/ 04094000
         LA    @07,PRINTLNB-1(PRLNPTR)                             1331 04095000
         MVC   0(8,@07),PRWORK                                     1331 04096000
*   CALL DOUPRINT;                  /* GO PRINT LINE         @Z40LB40*/ 04097000
*                                                                  1332 04098000
         BAL   @14,DOUPRINT                                        1332 04099000
*   /*****************************************************************/ 04100000
*   /*                                                               */ 04101000
*   /* PRINT I/O BUFFER SECTORS AND THEIR ASSOCIATED         @Z40LB40*/ 04102000
*   /* PREFIXES. THE PREFIXES ARE THE 8 BYTES IMMEDIATELY    @Z40LB40*/ 04103000
*   /* PRECEEDING EACH I/O BUFFER SECTOR. THE BUFFERS ARE    @Z40LB40*/ 04104000
*   /* LOCATED AT 3200, 3400, 3600, 3800, 3A00 AND 3C00.     @Z40LB40*/ 04105000
*   /*                                                               */ 04106000
*   /*****************************************************************/ 04107000
*                                                                  1333 04108000
*   DO I3='3200'X TO'3C00'X BY'0200'X;/*                     @Z40LB40*/ 04109000
*                                                                  1333 04110000
         L     I3,@CF01558                                         1333 04111000
@DL01333 DS    0H                                                  1334 04112000
*     /***************************************************************/ 04113000
*     /*                                                             */ 04114000
*     /* ISSUE UPRINT FOR I/O BUFFER HEADLINE                @Z40LB40*/ 04115000
*     /*                                                             */ 04116000
*     /***************************************************************/ 04117000
*                                                                  1334 04118000
*     PRINTAB=''B;                  /*                       @Z40LB40*/ 04119000
         XC    PRINTAB(44),PRINTAB                                 1334 04120000
*     DARGSMOD=DUMSGMOD;            /* SET TEXT MOD          @Z40LB40*/ 04121000
         L     @07,DDSTRU                                          1335 04122000
         MVC   DARGSMOD(3,@07),@CC01334                            1335 04123000
*     DARGSENT=HIOB;                /* SET ENTRY NO.         @Z40LB40*/ 04124000
         MVI   DARGSENT(@07),X'11'                                 1336 04125000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/* PRINT HEADERS    @Z40LB40*/ 04126000
         L     @07,@PC00001                                        1337 04127000
         ST    @07,@AL00001                                        1337 04128000
         LA    @05,PRPTR                                           1337 04129000
         ST    @05,@AL00001+4                                      1337 04130000
         LA    @05,DDSTRU                                          1337 04131000
         ST    @05,@AL00001+8                                      1337 04132000
         MVI   @AL00001+8,X'80'                                    1337 04133000
         L     @15,GDTPRT(,@07)                                    1337 04134000
         LA    @01,@AL00001                                        1337 04135000
         BALR  @14,@15                                             1337 04136000
*     SECTADDR=I3-8;                /* SET PREFIX ADDR.      @Z40LB40*/ 04137000
         LA    @07,8                                               1338 04138000
         LR    SECTADDR,I3                                         1338 04139000
         SLR   SECTADDR,@07                                        1338 04140000
*     NUMBYTES=8;                   /* PRINT 8 BYTES         @Z40LB40*/ 04141000
         ST    @07,NUMBYTES                                        1339 04142000
*     CALL PRNTSECT;                /* PRINT PREFIX          @Z40LB40*/ 04143000
         BAL   @14,PRNTSECT                                        1340 04144000
*     SECTADDR=I3;                  /* SET BUFFER ADDR.      @Z40LB40*/ 04145000
         LR    SECTADDR,I3                                         1341 04146000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 04147000
         MVC   NUMBYTES(4),@CF01321                                1342 04148000
*     CALL PRNTSECT;                /* PRINT BUFFER          @Z40LB40*/ 04149000
         BAL   @14,PRNTSECT                                        1343 04150000
*   END;                            /*                       @Z40LB40*/ 04151000
         AL    I3,@CF01560                                         1344 04152000
         C     I3,@CF01559                                         1344 04153000
         BNH   @DL01333                                            1344 04154000
*   RFY                                                            1345 04155000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04156000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04157000
         LR    REG14,RETADDR3                                      1346 04158000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04159000
@EL00009 DS    0H                                                  1347 04160000
@EF00009 DS    0H                                                  1347 04161000
@ER00009 BR    @14                                                 1347 04162000
*   RFY                                                            1348 04163000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04164000
*   END IOBUFFS;                    /*                       @Z40LB40*/ 04165000
*                                                                  1350 04166000
*   /*****************************************************************/ 04167000
*   /*                                                               */ 04168000
*   /* PROCEDURE NAME - STGSCH (LEVEL 3)                     @Z40LB40*/ 04169000
*   /*                                                       @Z40LB40*/ 04170000
*   /* FUNCTION - THIS ROUTINE PRINTS INFORMATION ABOUT      @Z40LB40*/ 04171000
*   /* THE MSC STAGE SCHEDULER. THE AREAS PRINTED AND THE    @Z40LB40*/ 04172000
*   /* LOCATIONS OF THE AREAS ARE -                          @Z40LB40*/ 04173000
*   /* QCB FIFO QUEUES - 6800 - 256 BYTES                    @ZD00050*/ 04174000
*   /* QUEUE CONTROL BLOCKS - 6A00 AND 6B00 - EACH 256 BYTES @Z40LB40*/ 04175000
*   /* LINK POINTERS - 6E00 - 256 BYTES                      @Z40LB40*/ 04176000
*   /* DEPENDENCY COUNTS - 6F00 - 256 BYTES                  @Z40LB40*/ 04177000
*   /* SCHEDULE QUEUE BLOCKS - B000 THROUGH BFFF             @Z40LB40*/ 04178000
*   /*                                                       @Z40LB40*/ 04179000
*   /* INPUT - NONE                                          @Z40LB40*/ 04180000
*   /*                                                       @Z40LB40*/ 04181000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE ABOVE DEFINED       @Z40LB40*/ 04182000
*   /* AREAS. SEE REFERENCES TO SECTADDR FOR ACTUAL          @Z40LB40*/ 04183000
*   /* LOCATION OF EACH AREA.                                @Z40LB40*/ 04184000
*   /*                                                               */ 04185000
*   /*****************************************************************/ 04186000
*                                                                  1350 04187000
*STGSCH:                                                           1350 04188000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04189000
STGSCH   DS    0H                                                  1351 04190000
*   RFY                                                            1351 04191000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04192000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04193000
         LR    RETADDR3,REG14                                      1352 04194000
*   RFY                                                            1353 04195000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04196000
*   OLDERID2=NEWERID2;                                             1354 04197000
         L     @07,@PC00001                                        1354 04198000
         L     @02,GDTTR2(,@07)                                    1354 04199000
         MVC   @TS00001(95),NEWERID2(@02)                          1354 04200000
         MVC   OLDERID2(95,@02),@TS00001                           1354 04201000
*   NEWID2='DUCE';                  /*                       @Z40LB40*/ 04202000
*                                                                  1355 04203000
         MVC   NEWID2(4,@02),@CC01564                              1355 04204000
*   /*****************************************************************/ 04205000
*   /*                                                               */ 04206000
*   /* ISSUE UPRINT FOR FIFO QUEUES HEADER AND PRINT         @ZD00050*/ 04207000
*   /* FIFO QUEUES.                                          @ZD00050*/ 04208000
*   /*                                                               */ 04209000
*   /*****************************************************************/ 04210000
*                                                                  1356 04211000
*   PRINTAB=''B;                    /*                       @ZD00050*/ 04212000
         XC    PRINTAB(44),PRINTAB                                 1356 04213000
*   DARGSMOD=DUMSGMOD;              /*                       @ZD00050*/ 04214000
         L     @02,DDSTRU                                          1357 04215000
         MVC   DARGSMOD(3,@02),@CC01334                            1357 04216000
*   DARGSENT=HFIFO;                 /*                       @ZD00050*/ 04217000
         MVI   DARGSENT(@02),X'19'                                 1358 04218000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @ZD00050*/ 04219000
         ST    @07,@AL00001                                        1359 04220000
         LA    @02,PRPTR                                           1359 04221000
         ST    @02,@AL00001+4                                      1359 04222000
         LA    @02,DDSTRU                                          1359 04223000
         ST    @02,@AL00001+8                                      1359 04224000
         MVI   @AL00001+8,X'80'                                    1359 04225000
         L     @15,GDTPRT(,@07)                                    1359 04226000
         LA    @01,@AL00001                                        1359 04227000
         BALR  @14,@15                                             1359 04228000
*   SECTADDR='6800'X;               /* SET SECTOR ADDR.      @ZD00050*/ 04229000
         L     SECTADDR,@CF01565                                   1360 04230000
*   NUMBYTES=SECTSIZE;              /* SET NO. OF BYTES      @ZD00050*/ 04231000
         MVC   NUMBYTES(4),@CF01321                                1361 04232000
*   CALL PRNTSECT;                  /* PRINT FIFO QUEUES     @ZD00050*/ 04233000
*                                                                  1362 04234000
         BAL   @14,PRNTSECT                                        1362 04235000
*   /*****************************************************************/ 04236000
*   /*                                                               */ 04237000
*   /* DUMP QUEUE CONTROL BLOCKS                             @Z40LB40*/ 04238000
*   /*                                                               */ 04239000
*   /*****************************************************************/ 04240000
*                                                                  1363 04241000
*   DO I3='6A00'X TO'6B00'X BY'0100'X;/*                     @Z40LB40*/ 04242000
*                                                                  1363 04243000
         L     I3,@CF01566                                         1363 04244000
@DL01363 DS    0H                                                  1364 04245000
*     /***************************************************************/ 04246000
*     /*                                                             */ 04247000
*     /* ISSUE UPRINT FOR QUEUE CONTROL BLOCK HEADER         @Z40LB40*/ 04248000
*     /*                                                             */ 04249000
*     /***************************************************************/ 04250000
*                                                                  1364 04251000
*     PRINTAB=''B;                  /*                       @Z40LB40*/ 04252000
         XC    PRINTAB(44),PRINTAB                                 1364 04253000
*     DARGSMOD=DUMSGMOD;            /*                       @Z40LB40*/ 04254000
         L     @07,DDSTRU                                          1365 04255000
         MVC   DARGSMOD(3,@07),@CC01334                            1365 04256000
*     DARGSENT=HQCB;                /*                       @Z40LB40*/ 04257000
         MVI   DARGSENT(@07),X'14'                                 1366 04258000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                  @Z40LB40*/ 04259000
         L     @07,@PC00001                                        1367 04260000
         ST    @07,@AL00001                                        1367 04261000
         LA    @05,PRPTR                                           1367 04262000
         ST    @05,@AL00001+4                                      1367 04263000
         LA    @05,DDSTRU                                          1367 04264000
         ST    @05,@AL00001+8                                      1367 04265000
         MVI   @AL00001+8,X'80'                                    1367 04266000
         L     @15,GDTPRT(,@07)                                    1367 04267000
         LA    @01,@AL00001                                        1367 04268000
         BALR  @14,@15                                             1367 04269000
*     SECTADDR=I3;                  /* SET SECTOR ADDR.      @Z40LB40*/ 04270000
         LR    SECTADDR,I3                                         1368 04271000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 04272000
         MVC   NUMBYTES(4),@CF01321                                1369 04273000
*     CALL PRNTSECT;                /* PRINT QCB             @Z40LB40*/ 04274000
         BAL   @14,PRNTSECT                                        1370 04275000
*   END;                            /*                       @Z40LB40*/ 04276000
*                                                                  1371 04277000
         AL    I3,@CF01540                                         1371 04278000
         C     I3,@CF01567                                         1371 04279000
         BNH   @DL01363                                            1371 04280000
*   /*****************************************************************/ 04281000
*   /*                                                               */ 04282000
*   /* ISSUE UPRINT FOR DEPENDENCY COUNTS HEADER             @ZA14731*/ 04283000
*   /*                                                               */ 04284000
*   /*****************************************************************/ 04285000
*                                                                  1372 04286000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 04287000
         XC    PRINTAB(44),PRINTAB                                 1372 04288000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 04289000
         L     @07,DDSTRU                                          1373 04290000
         MVC   DARGSMOD(3,@07),@CC01334                            1373 04291000
*   DARGSENT=HDC;                   /*                       @ZA14731*/ 04292000
         MVI   DARGSENT(@07),X'16'                                 1374 04293000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 04294000
         L     @07,@PC00001                                        1375 04295000
         ST    @07,@AL00001                                        1375 04296000
         LA    @02,PRPTR                                           1375 04297000
         ST    @02,@AL00001+4                                      1375 04298000
         LA    @02,DDSTRU                                          1375 04299000
         ST    @02,@AL00001+8                                      1375 04300000
         MVI   @AL00001+8,X'80'                                    1375 04301000
         L     @15,GDTPRT(,@07)                                    1375 04302000
         LA    @01,@AL00001                                        1375 04303000
         BALR  @14,@15                                             1375 04304000
*   SECTADDR='6E00'X;               /* SET SECTOR ADDR.      @Z40LB40*/ 04305000
         L     SECTADDR,@CF01568                                   1376 04306000
*   NUMBYTES=SECTSIZE;              /* SET NO. OF BYTES      @Z40LB40*/ 04307000
         MVC   NUMBYTES(4),@CF01321                                1377 04308000
*   CALL PRNTSECT;                  /* PRINT LINK PTRS       @Z40LB40*/ 04309000
*                                                                  1378 04310000
         BAL   @14,PRNTSECT                                        1378 04311000
*   /*****************************************************************/ 04312000
*   /*                                                               */ 04313000
*   /* ISSUE UPRINT FOR LINK POINTERS HEADER                 @ZA14731*/ 04314000
*   /*                                                               */ 04315000
*   /*****************************************************************/ 04316000
*                                                                  1379 04317000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 04318000
         XC    PRINTAB(44),PRINTAB                                 1379 04319000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 04320000
         L     @07,DDSTRU                                          1380 04321000
         MVC   DARGSMOD(3,@07),@CC01334                            1380 04322000
*   DARGSENT=HLP;                   /*                       @ZA14731*/ 04323000
         MVI   DARGSENT(@07),X'15'                                 1381 04324000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 04325000
         L     @07,@PC00001                                        1382 04326000
         ST    @07,@AL00001                                        1382 04327000
         LA    @02,PRPTR                                           1382 04328000
         ST    @02,@AL00001+4                                      1382 04329000
         LA    @02,DDSTRU                                          1382 04330000
         ST    @02,@AL00001+8                                      1382 04331000
         MVI   @AL00001+8,X'80'                                    1382 04332000
         L     @15,GDTPRT(,@07)                                    1382 04333000
         LA    @01,@AL00001                                        1382 04334000
         BALR  @14,@15                                             1382 04335000
*   SECTADDR='6F00'X;               /* SET SECTOR ADDR.      @Z40LB40*/ 04336000
         L     SECTADDR,@CF01569                                   1383 04337000
*   NUMBYTES=SECTSIZE;              /* SET NO. OF BYTES      @Z40LB40*/ 04338000
         MVC   NUMBYTES(4),@CF01321                                1384 04339000
*   CALL PRNTSECT;                  /* PRINT DEPEND.CNTS.    @Z40LB40*/ 04340000
*                                                                  1385 04341000
         BAL   @14,PRNTSECT                                        1385 04342000
*   /*****************************************************************/ 04343000
*   /*                                                               */ 04344000
*   /* PRINT SCHEDULE QUEUE BLOCKS.                          @ZD00038*/ 04345000
*   /*                                                               */ 04346000
*   /*****************************************************************/ 04347000
*                                                                  1386 04348000
*   DO I3='B000'X TO'BF00'X BY'0100'X;/*                     @Z40LB40*/ 04349000
*                                                                  1386 04350000
         L     I3,@CF01570                                         1386 04351000
@DL01386 DS    0H                                                  1387 04352000
*     /***************************************************************/ 04353000
*     /*                                                             */ 04354000
*     /* ISSUE UPRINT FOR SCHEDULE QUEUE BLOCK HEADER        @ZD00038*/ 04355000
*     /*                                                             */ 04356000
*     /***************************************************************/ 04357000
*                                                                  1387 04358000
*     PRINTAB=''B;                  /*                       @ZD00038*/ 04359000
         XC    PRINTAB(44),PRINTAB                                 1387 04360000
*     DARGSMOD=DUMSGMOD;            /*                       @ZD00038*/ 04361000
         L     @07,DDSTRU                                          1388 04362000
         MVC   DARGSMOD(3,@07),@CC01334                            1388 04363000
*     DARGSENT=HISQB;               /*                       @ZD00038*/ 04364000
         MVI   DARGSENT(@07),X'1B'                                 1389 04365000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                  @ZD00038*/ 04366000
         L     @07,@PC00001                                        1390 04367000
         ST    @07,@AL00001                                        1390 04368000
         LA    @05,PRPTR                                           1390 04369000
         ST    @05,@AL00001+4                                      1390 04370000
         LA    @05,DDSTRU                                          1390 04371000
         ST    @05,@AL00001+8                                      1390 04372000
         MVI   @AL00001+8,X'80'                                    1390 04373000
         L     @15,GDTPRT(,@07)                                    1390 04374000
         LA    @01,@AL00001                                        1390 04375000
         BALR  @14,@15                                             1390 04376000
*     SECTADDR=I3;                  /* SET SECTOR ADDR.      @ZD00038*/ 04377000
         LR    SECTADDR,I3                                         1391 04378000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @ZD00038*/ 04379000
         MVC   NUMBYTES(4),@CF01321                                1392 04380000
*     CALL PRNTSECT;                /* PRINT BLOCK           @ZD00038*/ 04381000
         BAL   @14,PRNTSECT                                        1393 04382000
*   END;                            /*                       @Z40LB40*/ 04383000
         AL    I3,@CF01540                                         1394 04384000
         C     I3,@CF01571                                         1394 04385000
         BNH   @DL01386                                            1394 04386000
*   RFY                                                            1395 04387000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04388000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04389000
         LR    REG14,RETADDR3                                      1396 04390000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04391000
@EL00010 DS    0H                                                  1397 04392000
@EF00010 DS    0H                                                  1397 04393000
@ER00010 BR    @14                                                 1397 04394000
*   RFY                                                            1398 04395000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04396000
*   END STGSCH;                     /*                       @Z40LB40*/ 04397000
*                                                                  1400 04398000
*   /*****************************************************************/ 04399000
*   /*                                                               */ 04400000
*   /* PROCEDURE NAME - UCBS (LEVEL 3)                       @Z40LB40*/ 04401000
*   /*                                                       @Z40LB40*/ 04402000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC UNIT CONTROL   @Z40LB40*/ 04403000
*   /* BLOCKS.                                               @Z40LB40*/ 04404000
*   /*                                                       @Z40LB40*/ 04405000
*   /* INPUT - NONE                                          @Z40LB40*/ 04406000
*   /*                                                       @Z40LB40*/ 04407000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE UCBS. SEE           @Z40LB40*/ 04408000
*   /* REFERENCES TO SECTADDR FOR ACTUAL LOCATION OF         @Z40LB40*/ 04409000
*   /* THE UCBS.                                             @Z40LB40*/ 04410000
*   /*                                                               */ 04411000
*   /*****************************************************************/ 04412000
*                                                                  1400 04413000
*UCBS:                                                             1400 04414000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04415000
UCBS     DS    0H                                                  1401 04416000
*   RFY                                                            1401 04417000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04418000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04419000
         LR    RETADDR3,REG14                                      1402 04420000
*   RFY                                                            1403 04421000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04422000
*   OLDERID2=NEWERID2;                                             1404 04423000
         L     @07,@PC00001                                        1404 04424000
         L     @07,GDTTR2(,@07)                                    1404 04425000
         MVC   @TS00001(95),NEWERID2(@07)                          1404 04426000
         MVC   OLDERID2(95,@07),@TS00001                           1404 04427000
*   NEWID2='DUCF';                  /*                       @Z40LB40*/ 04428000
*                                                                  1405 04429000
         MVC   NEWID2(4,@07),@CC01575                              1405 04430000
*   /*****************************************************************/ 04431000
*   /*                                                               */ 04432000
*   /* PRINT SECTORS 7C00 THRU 7F00 WHICH CONTAIN THE UCBS   @Z40LB40*/ 04433000
*   /*                                                               */ 04434000
*   /*****************************************************************/ 04435000
*                                                                  1406 04436000
*   DO I3='7C00'X TO'7F00'X BY'0100'X;/*                     @Z40LB40*/ 04437000
*                                                                  1406 04438000
         L     I3,@CF01576                                         1406 04439000
@DL01406 DS    0H                                                  1407 04440000
*     /***************************************************************/ 04441000
*     /*                                                             */ 04442000
*     /* ISSUE UPRINT FOR UNIT CONTROL BLOCK HEADER          @Z40LB40*/ 04443000
*     /*                                                             */ 04444000
*     /***************************************************************/ 04445000
*                                                                  1407 04446000
*     PRINTAB=''B;                  /*                       @Z40LB40*/ 04447000
         XC    PRINTAB(44),PRINTAB                                 1407 04448000
*     DARGSMOD=DUMSGMOD;            /*                       @Z40LB40*/ 04449000
         L     @07,DDSTRU                                          1408 04450000
         MVC   DARGSMOD(3,@07),@CC01334                            1408 04451000
*     DARGSENT=HUCB;                /*                       @Z40LB40*/ 04452000
         MVI   DARGSENT(@07),X'1E'                                 1409 04453000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                  @Z40LB40*/ 04454000
         L     @07,@PC00001                                        1410 04455000
         ST    @07,@AL00001                                        1410 04456000
         LA    @05,PRPTR                                           1410 04457000
         ST    @05,@AL00001+4                                      1410 04458000
         LA    @05,DDSTRU                                          1410 04459000
         ST    @05,@AL00001+8                                      1410 04460000
         MVI   @AL00001+8,X'80'                                    1410 04461000
         L     @15,GDTPRT(,@07)                                    1410 04462000
         LA    @01,@AL00001                                        1410 04463000
         BALR  @14,@15                                             1410 04464000
*     SECTADDR=I3;                  /* SET SECTOR ADDR.      @Z40LB40*/ 04465000
         LR    SECTADDR,I3                                         1411 04466000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 04467000
         MVC   NUMBYTES(4),@CF01321                                1412 04468000
*     CALL PRNTSECT;                /* PRINT UCB             @Z40LB40*/ 04469000
         BAL   @14,PRNTSECT                                        1413 04470000
*   END;                            /*                       @Z40LB40*/ 04471000
         AL    I3,@CF01540                                         1414 04472000
         C     I3,@CF01577                                         1414 04473000
         BNH   @DL01406                                            1414 04474000
*   RFY                                                            1415 04475000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04476000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04477000
         LR    REG14,RETADDR3                                      1416 04478000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04479000
@EL00011 DS    0H                                                  1417 04480000
@EF00011 DS    0H                                                  1417 04481000
@ER00011 BR    @14                                                 1417 04482000
*   RFY                                                            1418 04483000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04484000
*   END UCBS;                       /*                       @Z40LB40*/ 04485000
*                                                                  1420 04486000
*   /*****************************************************************/ 04487000
*   /*                                                               */ 04488000
*   /* PROCEDURE NAME - ERP (LEVEL 3)                        @Z40LB40*/ 04489000
*   /*                                                       @Z40LB40*/ 04490000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC ERROR          @Z40LB40*/ 04491000
*   /* RECOVERY INFORMATION SECTORS.                         @Z40LB40*/ 04492000
*   /*                                                       @Z40LB40*/ 04493000
*   /* INPUT - NONE                                          @Z40LB40*/ 04494000
*   /*                                                       @Z40LB40*/ 04495000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE ERP SECTORS.        @Z40LB40*/ 04496000
*   /* SEE REFERENCES TO SECTADDR FOR ACTUAL LOCATION OF     @Z40LB40*/ 04497000
*   /* THE ERP SECTORS.                                      @Z40LB40*/ 04498000
*   /*                                                               */ 04499000
*   /*****************************************************************/ 04500000
*                                                                  1420 04501000
*ERP:                                                              1420 04502000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04503000
ERP      DS    0H                                                  1421 04504000
*   RFY                                                            1421 04505000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04506000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04507000
         LR    RETADDR3,REG14                                      1422 04508000
*   RFY                                                            1423 04509000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04510000
*   OLDERID2=NEWERID2;                                             1424 04511000
         L     @07,@PC00001                                        1424 04512000
         L     @07,GDTTR2(,@07)                                    1424 04513000
         MVC   @TS00001(95),NEWERID2(@07)                          1424 04514000
         MVC   OLDERID2(95,@07),@TS00001                           1424 04515000
*   NEWID2='DUCG';                  /*                       @Z40LB40*/ 04516000
*                                                                  1425 04517000
         MVC   NEWID2(4,@07),@CC01581                              1425 04518000
*   /*****************************************************************/ 04519000
*   /*                                                               */ 04520000
*   /* PRINT SECTORS 0100 AND 0200 WHICH CONTAIN THE ERP     @Z40LB40*/ 04521000
*   /* INFORMATION                                           @Z40LB40*/ 04522000
*   /*                                                               */ 04523000
*   /*****************************************************************/ 04524000
*                                                                  1426 04525000
*   DO I3='0100'X TO'0200'X BY'0100'X;/*                     @Z40LB40*/ 04526000
*                                                                  1426 04527000
         LA    I3,256                                              1426 04528000
@DL01426 DS    0H                                                  1427 04529000
*     /***************************************************************/ 04530000
*     /*                                                             */ 04531000
*     /* ISSUE UPRINT FOR ERP INFORMATION HEADER             @Z40LB40*/ 04532000
*     /*                                                             */ 04533000
*     /***************************************************************/ 04534000
*                                                                  1427 04535000
*     PRINTAB=''B;                  /*                       @Z40LB40*/ 04536000
         XC    PRINTAB(44),PRINTAB                                 1427 04537000
*     DARGSMOD=DUMSGMOD;            /*                       @Z40LB40*/ 04538000
         L     @07,DDSTRU                                          1428 04539000
         MVC   DARGSMOD(3,@07),@CC01334                            1428 04540000
*     DARGSENT=HERI;                /*                       @Z40LB40*/ 04541000
         MVI   DARGSENT(@07),X'1F'                                 1429 04542000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                  @Z40LB40*/ 04543000
         L     @07,@PC00001                                        1430 04544000
         ST    @07,@AL00001                                        1430 04545000
         LA    @05,PRPTR                                           1430 04546000
         ST    @05,@AL00001+4                                      1430 04547000
         LA    @05,DDSTRU                                          1430 04548000
         ST    @05,@AL00001+8                                      1430 04549000
         MVI   @AL00001+8,X'80'                                    1430 04550000
         L     @15,GDTPRT(,@07)                                    1430 04551000
         LA    @01,@AL00001                                        1430 04552000
         BALR  @14,@15                                             1430 04553000
*     SECTADDR=I3;                  /* SET SECTOR ADDR.      @Z40LB40*/ 04554000
         LR    SECTADDR,I3                                         1431 04555000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 04556000
         MVC   NUMBYTES(4),@CF01321                                1432 04557000
*     CALL PRNTSECT;                /* PRINT ERP INFO        @Z40LB40*/ 04558000
         BAL   @14,PRNTSECT                                        1433 04559000
*   END;                            /*                       @Z40LB40*/ 04560000
         AL    I3,@CF01540                                         1434 04561000
         C     I3,@CF01560                                         1434 04562000
         BNH   @DL01426                                            1434 04563000
*   RFY                                                            1435 04564000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04565000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04566000
         LR    REG14,RETADDR3                                      1436 04567000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04568000
@EL00012 DS    0H                                                  1437 04569000
@EF00012 DS    0H                                                  1437 04570000
@ER00012 BR    @14                                                 1437 04571000
*   RFY                                                            1438 04572000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04573000
*   END ERP;                        /*                       @Z40LB40*/ 04574000
*                                                                  1440 04575000
*   /*****************************************************************/ 04576000
*   /*                                                               */ 04577000
*   /* PROCEDURE NAME - LOWSENSE (LEVEL 3)                   @Z40LB40*/ 04578000
*   /*                                                       @Z40LB40*/ 04579000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC LOWER          @Z40LB40*/ 04580000
*   /* INTERFACE SENSE DATA.                                 @Z40LB40*/ 04581000
*   /*                                                       @Z40LB40*/ 04582000
*   /* INPUT - NONE                                          @Z40LB40*/ 04583000
*   /*                                                       @Z40LB40*/ 04584000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE LOWER INTERFACE     @Z40LB40*/ 04585000
*   /* SENSE DATA. SEE REFERENCES TO SECTADDR FOR ACTUAL     @Z40LB40*/ 04586000
*   /* LOCATION OF THE DATA.                                 @Z40LB40*/ 04587000
*   /*                                                               */ 04588000
*   /*****************************************************************/ 04589000
*                                                                  1440 04590000
*LOWSENSE:                                                         1440 04591000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04592000
LOWSENSE DS    0H                                                  1441 04593000
*   RFY                                                            1441 04594000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04595000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04596000
         LR    RETADDR3,REG14                                      1442 04597000
*   RFY                                                            1443 04598000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04599000
*   OLDERID2=NEWERID2;                                             1444 04600000
         L     @07,@PC00001                                        1444 04601000
         L     @02,GDTTR2(,@07)                                    1444 04602000
         MVC   @TS00001(95),NEWERID2(@02)                          1444 04603000
         MVC   OLDERID2(95,@02),@TS00001                           1444 04604000
*   NEWID2='DUCH';                  /*                       @Z40LB40*/ 04605000
*                                                                  1445 04606000
         MVC   NEWID2(4,@02),@CC01585                              1445 04607000
*   /*****************************************************************/ 04608000
*   /*                                                               */ 04609000
*   /* PRINT 28 BYTES OF DATA STARTING AT 1D00 WHICH         @Z40LB40*/ 04610000
*   /* IS THE LOWER INTERFACE SENSE DATA.                    @Z40LB40*/ 04611000
*   /* ISSUE UPRINT FOR LOWER INTERFACE HEADER               @Z40LB40*/ 04612000
*   /*                                                               */ 04613000
*   /*****************************************************************/ 04614000
*                                                                  1446 04615000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 04616000
         XC    PRINTAB(44),PRINTAB                                 1446 04617000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 04618000
         L     @02,DDSTRU                                          1447 04619000
         MVC   DARGSMOD(3,@02),@CC01334                            1447 04620000
*   DARGSENT=HLISB;                 /*                       @Z40LB40*/ 04621000
         MVI   DARGSENT(@02),X'20'                                 1448 04622000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 04623000
         ST    @07,@AL00001                                        1449 04624000
         LA    @02,PRPTR                                           1449 04625000
         ST    @02,@AL00001+4                                      1449 04626000
         LA    @02,DDSTRU                                          1449 04627000
         ST    @02,@AL00001+8                                      1449 04628000
         MVI   @AL00001+8,X'80'                                    1449 04629000
         L     @15,GDTPRT(,@07)                                    1449 04630000
         LA    @01,@AL00001                                        1449 04631000
         BALR  @14,@15                                             1449 04632000
*   SECTADDR='1D00'X;               /* SET SECTOR ADDR.      @Z40LB40*/ 04633000
         L     SECTADDR,@CF01586                                   1450 04634000
*   NUMBYTES=28;                    /* PRINT 28 BYTES        @Z40LB40*/ 04635000
         MVC   NUMBYTES(4),@CF01415                                1451 04636000
*   CALL PRNTSECT;                  /* PRINT SENSE INFO      @Z40LB40*/ 04637000
         BAL   @14,PRNTSECT                                        1452 04638000
*   RFY                                                            1453 04639000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04640000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04641000
         LR    REG14,RETADDR3                                      1454 04642000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04643000
@EL00013 DS    0H                                                  1455 04644000
@EF00013 DS    0H                                                  1455 04645000
@ER00013 BR    @14                                                 1455 04646000
*   RFY                                                            1456 04647000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04648000
*   END LOWSENSE;                   /*                       @Z40LB40*/ 04649000
*                                                                  1458 04650000
*   /*****************************************************************/ 04651000
*   /*                                                               */ 04652000
*   /* PROCEDURE NAME - MNTEQUAL (LEVEL 3)                   @Z40LB40*/ 04653000
*   /*                                                       @Z40LB40*/ 04654000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC MOUNT          @Z40LB40*/ 04655000
*   /* EQUALIZATION STATISTICS SECTOR.                       @Z40LB40*/ 04656000
*   /*                                                       @Z40LB40*/ 04657000
*   /* INPUT - NONE                                          @Z40LB40*/ 04658000
*   /*                                                       @Z40LB40*/ 04659000
*   /* OUTPUT - HEXADECIMAL PRINT OF THE ABOVE DEFINED       @Z40LB40*/ 04660000
*   /* SECTOR. SEE REFERENCES TO SECTADDR FOR ACTUAL         @Z40LB40*/ 04661000
*   /* LOCATION OF THE SECTOR.                               @Z40LB40*/ 04662000
*   /*                                                               */ 04663000
*   /*****************************************************************/ 04664000
*                                                                  1458 04665000
*MNTEQUAL:                                                         1458 04666000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04667000
MNTEQUAL DS    0H                                                  1459 04668000
*   RFY                                                            1459 04669000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04670000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04671000
         LR    RETADDR3,REG14                                      1460 04672000
*   RFY                                                            1461 04673000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04674000
*   OLDERID2=NEWERID2;                                             1462 04675000
         L     @07,@PC00001                                        1462 04676000
         L     @02,GDTTR2(,@07)                                    1462 04677000
         MVC   @TS00001(95),NEWERID2(@02)                          1462 04678000
         MVC   OLDERID2(95,@02),@TS00001                           1462 04679000
*   NEWID2='DUCI';                  /*                       @Z40LB40*/ 04680000
*                                                                  1463 04681000
         MVC   NEWID2(4,@02),@CC01590                              1463 04682000
*   /*****************************************************************/ 04683000
*   /*                                                               */ 04684000
*   /* PRINT SECTOR C900 WHICH CONTAINS THE MOUNT            @Z40LB40*/ 04685000
*   /* EQUALIZATION STATISTICS.                              @Z40LB40*/ 04686000
*   /* ISSUE UPRINT FOR MOUNT EQUALIZATION HEADER            @Z40LB40*/ 04687000
*   /*                                                               */ 04688000
*   /*****************************************************************/ 04689000
*                                                                  1464 04690000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 04691000
         XC    PRINTAB(44),PRINTAB                                 1464 04692000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 04693000
         L     @02,DDSTRU                                          1465 04694000
         MVC   DARGSMOD(3,@02),@CC01334                            1465 04695000
*   DARGSENT=HMNTEQ;                /*                       @Z40LB40*/ 04696000
         MVI   DARGSENT(@02),X'21'                                 1466 04697000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 04698000
         ST    @07,@AL00001                                        1467 04699000
         LA    @02,PRPTR                                           1467 04700000
         ST    @02,@AL00001+4                                      1467 04701000
         LA    @02,DDSTRU                                          1467 04702000
         ST    @02,@AL00001+8                                      1467 04703000
         MVI   @AL00001+8,X'80'                                    1467 04704000
         L     @15,GDTPRT(,@07)                                    1467 04705000
         LA    @01,@AL00001                                        1467 04706000
         BALR  @14,@15                                             1467 04707000
*   SECTADDR='C900'X;               /* SET SECTOR ADDR.      @Z40LB40*/ 04708000
         L     SECTADDR,@CF01591                                   1468 04709000
*   NUMBYTES=SECTSIZE;              /* SET NO. OF BYTES      @Z40LB40*/ 04710000
         MVC   NUMBYTES(4),@CF01321                                1469 04711000
*   CALL PRNTSECT;                  /* PRINT SECTOR          @Z40LB40*/ 04712000
         BAL   @14,PRNTSECT                                        1470 04713000
*   RFY                                                            1471 04714000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04715000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04716000
         LR    REG14,RETADDR3                                      1472 04717000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04718000
@EL00014 DS    0H                                                  1473 04719000
@EF00014 DS    0H                                                  1473 04720000
@ER00014 BR    @14                                                 1473 04721000
*   RFY                                                            1474 04722000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04723000
*   END MNTEQUAL;                   /*                       @Z40LB40*/ 04724000
*                                                                  1476 04725000
*   /*****************************************************************/ 04726000
*   /*                                                               */ 04727000
*   /* PROCEDURE NAME - CHRS (LEVEL 3)                       @Z40LB40*/ 04728000
*   /*                                                       @Z40LB40*/ 04729000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC TABLES         @Z40LB40*/ 04730000
*   /* STARTING ADDRESSES IN THE FORM OF RECORD CHR.         @Z40LB40*/ 04731000
*   /*                                                       @Z40LB40*/ 04732000
*   /* INPUT - NONE                                          @Z40LB40*/ 04733000
*   /*                                                       @Z40LB40*/ 04734000
*   /* OUTPUT - A HEXADECIMAL PRINT OF EACH TABLE'S          @Z40LB40*/ 04735000
*   /* IDENTIFICATION NUMBER AND THE STARTING CHR            @Z40LB40*/ 04736000
*   /*                                                               */ 04737000
*   /*****************************************************************/ 04738000
*                                                                  1476 04739000
*CHRS:                                                             1476 04740000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04741000
CHRS     DS    0H                                                  1477 04742000
*   RFY                                                            1477 04743000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04744000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04745000
         LR    RETADDR3,REG14                                      1478 04746000
*   RFY                                                            1479 04747000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04748000
*   OLDERID2=NEWERID2;                                             1480 04749000
         L     @07,@PC00001                                        1480 04750000
         L     @15,GDTTR2(,@07)                                    1480 04751000
         MVC   @TS00001(95),NEWERID2(@15)                          1480 04752000
         MVC   OLDERID2(95,@15),@TS00001                           1480 04753000
*   NEWID2='DUCJ';                  /*                       @Z40LB40*/ 04754000
*                                                                  1481 04755000
         MVC   NEWID2(4,@15),@CC01595                              1481 04756000
*   /*****************************************************************/ 04757000
*   /*                                                               */ 04758000
*   /* ISSUE UPRINT FOR THE TWO TABLES HEADERS               @Z40LB40*/ 04759000
*   /*                                                               */ 04760000
*   /*****************************************************************/ 04761000
*                                                                  1482 04762000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 04763000
         XC    PRINTAB(44),PRINTAB                                 1482 04764000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 04765000
         L     @15,DDSTRU                                          1483 04766000
         MVC   DARGSMOD(3,@15),@CC01334                            1483 04767000
*   DARGSENT=HTABA;                 /*                       @Z40LB40*/ 04768000
         MVI   DARGSENT(@15),X'22'                                 1484 04769000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 04770000
         ST    @07,@AL00001                                        1485 04771000
         LA    @15,PRPTR                                           1485 04772000
         ST    @15,@AL00001+4                                      1485 04773000
         LA    @15,DDSTRU                                          1485 04774000
         ST    @15,@AL00001+8                                      1485 04775000
         MVI   @AL00001+8,X'80'                                    1485 04776000
         L     @15,GDTPRT(,@07)                                    1485 04777000
         LA    @01,@AL00001                                        1485 04778000
         BALR  @14,@15                                             1485 04779000
*   DO I3='5000'X TO'50E0'X BY'10'X;/*                       @Z40LB40*/ 04780000
         L     I3,@CF01596                                         1486 04781000
@DL01486 DS    0H                                                  1487 04782000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 04783000
         MVI   PRINTLN+1,C' '                                      1487 04784000
         MVC   PRINTLN+2(119),PRINTLN+1                            1487 04785000
         MVI   PRINTLN,C' '                                        1487 04786000
*     PROSET1=I3;                   /* SAVE I3 FOR ID        @Z40LB40*/ 04787000
         ST    I3,PROSET1                                          1488 04788000
*     UNPK(PRWORK,PROSET);          /* UNPK WORD             @Z40LB40*/ 04789000
         UNPK  PRWORK(9),PROSET(5)                                 1489 04790000
*     TR(PRWORK(7:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 04791000
         TR    PRWORK+6(2),TABLE                                   1490 04792000
*     PRINTLNB(1:2)=PRWORK(7:8);    /* ID TO LINE            @Z40LB40*/ 04793000
         MVC   PRINTLNB(2),PRWORK+6                                1491 04794000
*     PRSTART=I3+MEMPTR;            /* CALC WORD ADDR.       @Z40LB40*/ 04795000
         LR    PRSTART,I3                                          1492 04796000
         AL    PRSTART,MEMPTR                                      1492 04797000
*     UNPK(PRWORK,PRAREA);          /* UNPK WORD             @Z40LB40*/ 04798000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1493 04799000
*     TR(PRWORK(3:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 04800000
         TR    PRWORK+2(6),TABLE                                   1494 04801000
*     PRINTLNB(4:9)=PRWORK(3:8);    /* CCHHRR TO LINE        @Z40LB40*/ 04802000
         MVC   PRINTLNB+3(6),PRWORK+2                              1495 04803000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 04804000
         BAL   @14,DOUPRINT                                        1496 04805000
*   END;                            /*                       @Z40LB40*/ 04806000
         AL    I3,@CF01598                                         1497 04807000
         C     I3,@CF01597                                         1497 04808000
         BNH   @DL01486                                            1497 04809000
*   RFY                                                            1498 04810000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04811000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04812000
         LR    REG14,RETADDR3                                      1499 04813000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04814000
@EL00015 DS    0H                                                  1500 04815000
@EF00015 DS    0H                                                  1500 04816000
@ER00015 BR    @14                                                 1500 04817000
*   RFY                                                            1501 04818000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04819000
*   END CHRS;                       /*                       @Z40LB40*/ 04820000
*                                                                  1503 04821000
*   /*****************************************************************/ 04822000
*   /*                                                               */ 04823000
*   /* PROCEDURE NAME - RECOVERY (LEVEL 3)                   @Z40LB40*/ 04824000
*   /*                                                       @Z40LB40*/ 04825000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC RECOVERY       @Z40LB40*/ 04826000
*   /* SAVE AREA SECTORS.                                    @Z40LB40*/ 04827000
*   /* THE AREAS ARE USED WHEN THE MANUAL INTERVENTION       @Z40LB40*/ 04828000
*   /* PROCEDURE IS USED TO BRING THE MSC OUT OF A           @Z40LB40*/ 04829000
*   /* HANG CONDITION.                                       @Z40LB40*/ 04830000
*   /*                                                       @Z40LB40*/ 04831000
*   /* INPUT - NONE                                          @Z40LB40*/ 04832000
*   /*                                                       @Z40LB40*/ 04833000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE RECOVERY          @Z40LB40*/ 04834000
*   /* SAVE AREA SECTORS. SEE REFERENCES TO SECTADDR         @Z40LB40*/ 04835000
*   /* FOR ACTUAL LOCATION OF THE SECTORS.                   @Z40LB40*/ 04836000
*   /*                                                               */ 04837000
*   /*****************************************************************/ 04838000
*                                                                  1503 04839000
*RECOVERY:                                                         1503 04840000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04841000
RECOVERY DS    0H                                                  1504 04842000
*   RFY                                                            1504 04843000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04844000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04845000
         LR    RETADDR3,REG14                                      1505 04846000
*   RFY                                                            1506 04847000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04848000
*   OLDERID2=NEWERID2;                                             1507 04849000
         L     @07,@PC00001                                        1507 04850000
         L     @07,GDTTR2(,@07)                                    1507 04851000
         MVC   @TS00001(95),NEWERID2(@07)                          1507 04852000
         MVC   OLDERID2(95,@07),@TS00001                           1507 04853000
*   NEWID2='DUCL';                  /*                       @Z40LB40*/ 04854000
*                                                                  1508 04855000
         MVC   NEWID2(4,@07),@CC01602                              1508 04856000
*   /*****************************************************************/ 04857000
*   /*                                                               */ 04858000
*   /* PRINT SECTORS 0400 AND 0500 WHICH CONTAIN RECOVERY    @Z40LB40*/ 04859000
*   /* SAVE AREAS.                                           @Z40LB40*/ 04860000
*   /*                                                               */ 04861000
*   /*****************************************************************/ 04862000
*                                                                  1509 04863000
*   DO I3='0400'X TO'0500'X BY'0100'X;/*                     @Z40LB40*/ 04864000
*                                                                  1509 04865000
         LA    I3,1024                                             1509 04866000
@DL01509 DS    0H                                                  1510 04867000
*     /***************************************************************/ 04868000
*     /*                                                             */ 04869000
*     /* ISSUE UPRINT FOR RECOVERY SAVE AREA HEADER          @Z40LB40*/ 04870000
*     /*                                                             */ 04871000
*     /***************************************************************/ 04872000
*                                                                  1510 04873000
*     PRINTAB=''B;                  /*                       @Z40LB40*/ 04874000
         XC    PRINTAB(44),PRINTAB                                 1510 04875000
*     DARGSMOD=DUMSGMOD;            /*                       @Z40LB40*/ 04876000
         L     @07,DDSTRU                                          1511 04877000
         MVC   DARGSMOD(3,@07),@CC01334                            1511 04878000
*     DARGSENT=HRECOV;              /*                       @Z40LB40*/ 04879000
         MVI   DARGSENT(@07),X'24'                                 1512 04880000
*     CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                  @Z40LB40*/ 04881000
         L     @07,@PC00001                                        1513 04882000
         ST    @07,@AL00001                                        1513 04883000
         LA    @05,PRPTR                                           1513 04884000
         ST    @05,@AL00001+4                                      1513 04885000
         LA    @05,DDSTRU                                          1513 04886000
         ST    @05,@AL00001+8                                      1513 04887000
         MVI   @AL00001+8,X'80'                                    1513 04888000
         L     @15,GDTPRT(,@07)                                    1513 04889000
         LA    @01,@AL00001                                        1513 04890000
         BALR  @14,@15                                             1513 04891000
*     SECTADDR=I3;                  /* SET SECTOR ADDRESS    @Z40LB40*/ 04892000
         LR    SECTADDR,I3                                         1514 04893000
*     NUMBYTES=SECTSIZE;            /* SET NO. OF BYTES      @Z40LB40*/ 04894000
         MVC   NUMBYTES(4),@CF01321                                1515 04895000
*     CALL PRNTSECT;                /* PRINT SAVE AREA       @Z40LB40*/ 04896000
         BAL   @14,PRNTSECT                                        1516 04897000
*   END;                            /*                       @Z40LB40*/ 04898000
         AL    I3,@CF01540                                         1517 04899000
         C     I3,@CF01604                                         1517 04900000
         BNH   @DL01509                                            1517 04901000
*   RFY                                                            1518 04902000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04903000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 04904000
         LR    REG14,RETADDR3                                      1519 04905000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 04906000
@EL00016 DS    0H                                                  1520 04907000
@EF00016 DS    0H                                                  1520 04908000
@ER00016 BR    @14                                                 1520 04909000
*   RFY                                                            1521 04910000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04911000
*   END RECOVERY;                   /*                       @Z40LB40*/ 04912000
*                                                                  1523 04913000
*   /*****************************************************************/ 04914000
*   /*                                                               */ 04915000
*   /* PROCEDURE NAME - VAD (LEVEL 3)                        @Z40LB40*/ 04916000
*   /*                                                       @Z40LB40*/ 04917000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING ADAPTER    @Z40LB40*/ 04918000
*   /* VIRTUAL ADDRESS DIRECTORY (VAD).                      @Z40LB40*/ 04919000
*   /* THE FOLLOWING SHOWS HOW THE VAD IS STRUCTURED.        @Z40LB40*/ 04920000
*   /* THE FOUR CHARACTER VALUES SHOWN ARE THE ACTUAL        @Z40LB40*/ 04921000
*   /* SECTOR ADDRESSES OF EACH WORD IN THE STAGING          @Z40LB40*/ 04922000
*   /* ADAPTER.                                              @Z40LB40*/ 04923000
*   /* VUA -CHAN-A-- -CHAN-B-- -CHAN-C-- -CHAN-D--           @Z40LB40*/ 04924000
*   /* .00 5D00 5E00 5F00 6000 6100 6200 6300 6400           @Z40LB40*/ 04925000
*   /* .01 5D04 5E04 5F04 6004 6104 6204 6304 6404           @Z40LB40*/ 04926000
*   /* ...                                                   @Z40LB40*/ 04927000
*   /* .3F ---- ---- 5FFC 60FC 61FC 62FC 63FC 64FC           @Z40LB40*/ 04928000
*   /* NOTE-CHANNEL A HAS VALUES FOR VUA 00-0F ONLY.         @Z40LB40*/ 04929000
*   /*                                                       @Z40LB40*/ 04930000
*   /* INPUT - NONE                                          @Z40LB40*/ 04931000
*   /*                                                       @Z40LB40*/ 04932000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE VAD.              @Z40LB40*/ 04933000
*   /*                                                               */ 04934000
*   /*****************************************************************/ 04935000
*                                                                  1523 04936000
*VAD:                                                              1523 04937000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 04938000
VAD      DS    0H                                                  1524 04939000
*   RFY                                                            1524 04940000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 04941000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 04942000
         LR    RETADDR3,REG14                                      1525 04943000
*   RFY                                                            1526 04944000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 04945000
*   OLDERID2=NEWERID2;                                             1527 04946000
         L     @07,@PC00001                                        1527 04947000
         L     @04,GDTTR2(,@07)                                    1527 04948000
         MVC   @TS00001(95),NEWERID2(@04)                          1527 04949000
         MVC   OLDERID2(95,@04),@TS00001                           1527 04950000
*   NEWID2='DUCM';                  /*                       @Z40LB40*/ 04951000
*                                                                  1528 04952000
         MVC   NEWID2(4,@04),@CC01608                              1528 04953000
*   /*****************************************************************/ 04954000
*   /*                                                               */ 04955000
*   /* ISSUE UPRINT TO PRINT ALL OF THE VAD HEADERS          @Z40LB40*/ 04956000
*   /*                                                               */ 04957000
*   /*****************************************************************/ 04958000
*                                                                  1529 04959000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 04960000
         XC    PRINTAB(44),PRINTAB                                 1529 04961000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 04962000
         L     @04,DDSTRU                                          1530 04963000
         MVC   DARGSMOD(3,@04),@CC01334                            1530 04964000
*   DARGSENT=HVAD;                  /*                       @Z40LB40*/ 04965000
         MVI   DARGSENT(@04),X'27'                                 1531 04966000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 04967000
         ST    @07,@AL00001                                        1532 04968000
         LA    @04,PRPTR                                           1532 04969000
         ST    @04,@AL00001+4                                      1532 04970000
         LA    @04,DDSTRU                                          1532 04971000
         ST    @04,@AL00001+8                                      1532 04972000
         MVI   @AL00001+8,X'80'                                    1532 04973000
         L     @15,GDTPRT(,@07)                                    1532 04974000
         LA    @01,@AL00001                                        1532 04975000
         BALR  @14,@15                                             1532 04976000
*   PRSTART=MEMPTR+'5D00'X;         /* SET START ADDRESS     @Z40LB40*/ 04977000
         L     PRSTART,@CF01609                                    1533 04978000
         AL    PRSTART,MEMPTR                                      1533 04979000
*   DO I3='00'X TO'3F'X;            /* LOOP THRU VUAS        @Z40LB40*/ 04980000
         SLR   I3,I3                                               1534 04981000
@DL01534 DS    0H                                                  1535 04982000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 04983000
         MVI   PRINTLN+1,C' '                                      1535 04984000
         MVC   PRINTLN+2(119),PRINTLN+1                            1535 04985000
         MVI   PRINTLN,C' '                                        1535 04986000
*     IF(I3&DSMASK)=0 THEN          /* TEST FOR 16 LINES     @Z40LB40*/ 04987000
         LR    @07,I3                                              1536 04988000
         N     @07,DSMASK                                          1536 04989000
         LTR   @07,@07                                             1536 04990000
         BNZ   @RF01536                                            1536 04991000
*       PRINTLNA=DOUBLESP;          /* DOUBLE SPACE AFTER    @Z40LB40   04992000
*                                      EACH 16 LINES         @Z40LB40*/ 04993000
*                                                                  1537 04994000
         MVI   PRINTLNA,C'0'                                       1537 04995000
*     /***************************************************************/ 04996000
*     /*                                                             */ 04997000
*     /* EDIT I3 AS THE VUA VALUE                            @Z40LB40*/ 04998000
*     /*                                                             */ 04999000
*     /***************************************************************/ 05000000
*                                                                  1538 05001000
*     PROSET1=I3;                   /* SAVE I3 FOR VUA       @Z40LB40*/ 05002000
@RF01536 ST    I3,PROSET1                                          1538 05003000
*     UNPK(PRWORK,PROSET);          /* UNPK WORD             @Z40LB40*/ 05004000
         UNPK  PRWORK(9),PROSET(5)                                 1539 05005000
*     TR(PRWORK(7:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05006000
         TR    PRWORK+6(2),TABLE                                   1540 05007000
*     PRINTLNB(2:3)=PRWORK(7:8);    /* MOVE TO LINE          @Z40LB40*/ 05008000
         MVC   PRINTLNB+1(2),PRWORK+6                              1541 05009000
*     PRLNPTR=6;                    /* SET LINE POINTER      @Z40LB40*/ 05010000
*                                                                  1542 05011000
         LA    PRLNPTR,6                                           1542 05012000
*     /***************************************************************/ 05013000
*     /*                                                             */ 05014000
*     /* THE FOLLOWING CODE PRINTS 4                         @Z40LB40*/ 05015000
*     /* CHANNELS WORTH OF INFORMATION PER PRINTLINE         @Z40LB40*/ 05016000
*     /* WHICH REPRESENTS A VUA. NOTE THAT CHANNEL A         @Z40LB40*/ 05017000
*     /* DOES NOT HAVE VALUES FOR VUA ABOVE X'0F'.           @Z40LB40*/ 05018000
*     /*                                                             */ 05019000
*     /***************************************************************/ 05020000
*                                                                  1543 05021000
*     DO J3=1 TO 4;                 /* LOOP THRU 4 CHANS.    @Z40LB40*/ 05022000
         LA    J3,1                                                1543 05023000
@DL01543 DS    0H                                                  1544 05024000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 05025000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1544 05026000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 05027000
         TR    PRWORK(8),TABLE                                     1545 05028000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 05029000
         LA    @02,PRINTLNB-1(PRLNPTR)                             1546 05030000
         MVC   0(8,@02),PRWORK                                     1546 05031000
*       PRSTART=PRSTART+'0100'X;    /* BUMP POINTER          @Z40LB40*/ 05032000
         LA    @02,256                                             1547 05033000
         ALR   PRSTART,@02                                         1547 05034000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 05035000
         AL    PRLNPTR,@CF01152                                    1548 05036000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 05037000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1549 05038000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 05039000
         TR    PRWORK(8),TABLE                                     1550 05040000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 05041000
         LA    @01,PRINTLNB-1(PRLNPTR)                             1551 05042000
         MVC   0(8,@01),PRWORK                                     1551 05043000
*       PRSTART=PRSTART+'0100'X;    /* BUMP POINTER          @Z40LB40*/ 05044000
         ALR   PRSTART,@02                                         1552 05045000
*       PRLNPTR=PRLNPTR+10;         /* BUMP LINE POINTER     @Z40LB40*/ 05046000
         AL    PRLNPTR,@CF00480                                    1553 05047000
*     END;                          /*                       @Z40LB40*/ 05048000
         AL    J3,@CF00223                                         1554 05049000
         C     J3,@CF00044                                         1554 05050000
         BNH   @DL01543                                            1554 05051000
*     PRSTART=PRSTART-'0800'X+4;    /* RESET START ADDR.     @Z40LB40*/ 05052000
         AL    PRSTART,@CF01744                                    1555 05053000
*     IF I3>'0F'X THEN              /* IS VUA MORE THAN 0F   @Z40LB40*/ 05054000
         C     I3,@CF01612                                         1556 05055000
         BNH   @RF01556                                            1556 05056000
*       PRINTLNB(6:22)=' ';         /* YES,BLANK CHAN A      @Z40LB40*/ 05057000
         MVI   PRINTLNB+6,C' '                                     1557 05058000
         MVC   PRINTLNB+7(15),PRINTLNB+6                           1557 05059000
         MVI   PRINTLNB+5,C' '                                     1557 05060000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 05061000
@RF01556 BAL   @14,DOUPRINT                                        1558 05062000
*   END;                            /*                       @Z40LB40*/ 05063000
         AL    I3,@CF00223                                         1559 05064000
         C     I3,@CF01610                                         1559 05065000
         BNH   @DL01534                                            1559 05066000
*   RFY                                                            1560 05067000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05068000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 05069000
         LR    REG14,RETADDR3                                      1561 05070000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05071000
@EL00017 DS    0H                                                  1562 05072000
@EF00017 DS    0H                                                  1562 05073000
@ER00017 BR    @14                                                 1562 05074000
*   RFY                                                            1563 05075000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05076000
*   END VAD;                        /*                       @Z40LB40*/ 05077000
*                                                                  1565 05078000
*   /*****************************************************************/ 05079000
*   /*                                                               */ 05080000
*   /* PROCEDURE NAME - VVIT (LEVEL 3)                       @Z40LB40*/ 05081000
*   /*                                                       @Z40LB40*/ 05082000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING ADAPTER    @Z40LB40*/ 05083000
*   /* VIRTUAL VOLUME INFORMATION TABLE (VVIT).              @Z40LB40*/ 05084000
*   /* THE FOLLOWING SHOWS HOW THE VAD IS STRUCTURED.        @Z40LB40*/ 05085000
*   /* THE FOUR CHARACTER VALUES SHOWN ARE THE ACTUAL        @Z40LB40*/ 05086000
*   /* SECTOR ADDRESS OF EACH BYTE IN THE STAGING ADAPTER.   @Z40LB40*/ 05087000
*   /* VVA BYTE0 BYTE1                                       @Z40LB40*/ 05088000
*   /* .10 .6910 .6B10                                       @Z40LB40*/ 05089000
*   /* .11 .6911 .6B11                                       @Z40LB40*/ 05090000
*   /* ...                                                   @Z40LB40*/ 05091000
*   /* .FF .69FF .6BFF                                       @Z40LB40*/ 05092000
*   /* NOTE-THE VVAS RANGE FROM 10-1F THEN 40-FF             @Z40LB40*/ 05093000
*   /*                                                       @Z40LB40*/ 05094000
*   /* INPUT - NONE                                          @Z40LB40*/ 05095000
*   /*                                                       @Z40LB40*/ 05096000
*   /* OUTPUT - A BIT REPRESENTATION OF EACH BYTE IN THE     @Z40LB40*/ 05097000
*   /* VVIT. THE OUTPUT IS ORGANIZED IN THREE COLUMNS.       @Z40LB40*/ 05098000
*   /* THE FIRST COLUMN IS VVA 10-1F AND 40-7F. THE SECOND   @Z40LB40*/ 05099000
*   /* COLUMN IS VVA 80-BF AND THE THIRD COLUMN IS C0-FF.    @Z40LB40*/ 05100000
*   /*                                                               */ 05101000
*   /*****************************************************************/ 05102000
*                                                                  1565 05103000
*VVIT:                                                             1565 05104000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05105000
VVIT     DS    0H                                                  1566 05106000
*   RFY                                                            1566 05107000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05108000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05109000
         LR    RETADDR3,REG14                                      1567 05110000
*   RFY                                                            1568 05111000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05112000
*   OLDERID2=NEWERID2;                                             1569 05113000
         L     @05,@PC00001                                        1569 05114000
         L     @15,GDTTR2(,@05)                                    1569 05115000
         MVC   @TS00001(95),NEWERID2(@15)                          1569 05116000
         MVC   OLDERID2(95,@15),@TS00001                           1569 05117000
*   NEWID2='DUCN';                  /*                       @Z40LB40*/ 05118000
*                                                                  1570 05119000
         MVC   NEWID2(4,@15),@CC01616                              1570 05120000
*   /*****************************************************************/ 05121000
*   /*                                                               */ 05122000
*   /* ISSUE UPRINT FOR ALL THE VVIT HEADERS                 @Z40LB40*/ 05123000
*   /*                                                               */ 05124000
*   /*****************************************************************/ 05125000
*                                                                  1571 05126000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 05127000
         XC    PRINTAB(44),PRINTAB                                 1571 05128000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 05129000
         L     @15,DDSTRU                                          1572 05130000
         MVC   DARGSMOD(3,@15),@CC01334                            1572 05131000
*   DARGSENT=HVVIT;                 /*                       @Z40LB40*/ 05132000
         MVI   DARGSENT(@15),X'28'                                 1573 05133000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 05134000
         ST    @05,@AL00001                                        1574 05135000
         LA    @15,PRPTR                                           1574 05136000
         ST    @15,@AL00001+4                                      1574 05137000
         LA    @15,DDSTRU                                          1574 05138000
         ST    @15,@AL00001+8                                      1574 05139000
         MVI   @AL00001+8,X'80'                                    1574 05140000
         L     @15,GDTPRT(,@05)                                    1574 05141000
         LA    @01,@AL00001                                        1574 05142000
         BALR  @14,@15                                             1574 05143000
*   B0BASE='6900'X+MEMPTR;          /* SET BYTE 0 ADDR.      @Z40LB40*/ 05144000
         L     @05,MEMPTR                                          1575 05145000
         L     @15,@CF01617                                        1575 05146000
         ALR   @15,@05                                             1575 05147000
         ST    @15,B0BASE                                          1575 05148000
*   B1BASE='6B00'X+MEMPTR;          /* SET BYTE 1 ADDR.      @Z40LB40*/ 05149000
         AL    @05,@CF01567                                        1576 05150000
         ST    @05,B1BASE                                          1576 05151000
*   I3='10'X;                       /* COLUMN 1 COUNTER      @Z40LB40*/ 05152000
         LA    I3,16                                               1577 05153000
*   J3='80'X;                       /* COLUMN 2 COUNTER      @Z40LB40*/ 05154000
         LA    J3,128                                              1578 05155000
*   K3='C0'X;                       /* COLUMN 3 COUNTER      @Z40LB40*/ 05156000
         LA    @05,192                                             1579 05157000
         ST    @05,K3                                              1579 05158000
*   DO L3=0 TO 79;                  /* PRINT 80 LINES        @Z40LB40*/ 05159000
         SLR   @05,@05                                             1580 05160000
         ST    @05,L3                                              1580 05161000
@DL01580 DS    0H                                                  1581 05162000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 05163000
         MVI   PRINTLN+1,C' '                                      1581 05164000
         MVC   PRINTLN+2(119),PRINTLN+1                            1581 05165000
         MVI   PRINTLN,C' '                                        1581 05166000
*     IF(L3&DSMASK)=0 THEN          /* TEST FOR 16 LINES     @Z40LB40*/ 05167000
         N     @05,DSMASK                                          1582 05168000
         LTR   @05,@05                                             1582 05169000
         BNZ   @RF01582                                            1582 05170000
*       PRINTLNA=DOUBLESP;          /* DOUBLE SPACE AFTER    @Z40LB40   05171000
*                                      EACH 16 LINES         @Z40LB40*/ 05172000
         MVI   PRINTLNA,C'0'                                       1583 05173000
*     PROSET1=I3;                   /* SAVE I3 FOR VVA       @Z40LB40*/ 05174000
@RF01582 ST    I3,PROSET1                                          1584 05175000
*     UNPK(PRWORK,PROSET);          /* UNPK WORD             @Z40LB40*/ 05176000
         UNPK  PRWORK(9),PROSET(5)                                 1585 05177000
*     TR(PRWORK(7:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05178000
         TR    PRWORK+6(2),TABLE                                   1586 05179000
*     PRINTLNB(2:3)=PRWORK(7:8);    /* MOVE VVA TO LINE      @Z40LB40*/ 05180000
         MVC   PRINTLNB+1(2),PRWORK+6                              1587 05181000
*     WORKBYTE=(B0BASE+I3)->MEMBYTE;/* SAVE BYTE 0           @Z40LB40*/ 05182000
         LR    @15,I3                                              1588 05183000
         AL    @15,B0BASE                                          1588 05184000
         SLR   WORKBYTE,WORKBYTE                                   1588 05185000
         IC    WORKBYTE,MEMBYTE(,@15)                              1588 05186000
*     CALL EDITBIT;                 /* CONVERT TO BITS       @Z40LB40*/ 05187000
         BAL   @14,EDITBIT                                         1589 05188000
*     PRINTLNB(5:12)=BITOUT;        /* MOVE BITS TO LINE     @Z40LB40*/ 05189000
         MVC   PRINTLNB+4(8),BITOUT                                1590 05190000
*     WORKBYTE=(B1BASE+I3)->MEMBYTE;/* SAVE BYTE 1           @Z40LB40*/ 05191000
         LR    @15,I3                                              1591 05192000
         AL    @15,B1BASE                                          1591 05193000
         SLR   WORKBYTE,WORKBYTE                                   1591 05194000
         IC    WORKBYTE,MEMBYTE(,@15)                              1591 05195000
*     CALL EDITBIT;                 /* CONVERT TO BITS       @Z40LB40*/ 05196000
         BAL   @14,EDITBIT                                         1592 05197000
*     PRINTLNB(14:21)=BITOUT;       /* MOVE BITS TO LINE     @Z40LB40*/ 05198000
         MVC   PRINTLNB+13(8),BITOUT                               1593 05199000
*     I3=I3+'01'X;                  /* BUMP VVA VALUE        @Z40LB40*/ 05200000
         AL    I3,@CF01522                                         1594 05201000
*     IF I3='20'X THEN              /* SKIP FROM 1F TO       @Z40LB40*/ 05202000
         C     I3,@CF01621                                         1595 05203000
         BNE   @RF01595                                            1595 05204000
*       I3='40'X;                   /* 40 VVA                @Z40LB40*/ 05205000
         LA    I3,64                                               1596 05206000
*     IF J3<='BF'X THEN             /* LIMIT COLUMN 2        @Z40LB40*/ 05207000
@RF01595 C     J3,@CF01623                                         1597 05208000
         BH    @RF01597                                            1597 05209000
*       DO;                         /*                       @Z40LB40*/ 05210000
*         PROSET1=J3;               /* SAVE J3 FOR VVA       @Z40LB40*/ 05211000
         ST    J3,PROSET1                                          1599 05212000
*         UNPK(PRWORK,PROSET);      /* UNPK WORD             @Z40LB40*/ 05213000
         UNPK  PRWORK(9),PROSET(5)                                 1600 05214000
*         TR(PRWORK(7:8),TABLE);    /* TR TO EBCDIC          @Z40LB40*/ 05215000
         TR    PRWORK+6(2),TABLE                                   1601 05216000
*         PRINTLNB(24:25)=PRWORK(7:8);/* MOVE VVA TO LINE    @Z40LB40*/ 05217000
         MVC   PRINTLNB+23(2),PRWORK+6                             1602 05218000
*         WORKBYTE=(B0BASE+J3)->MEMBYTE;/* SAVE BYTE 0       @Z40LB40*/ 05219000
         LR    @15,J3                                              1603 05220000
         AL    @15,B0BASE                                          1603 05221000
         SLR   WORKBYTE,WORKBYTE                                   1603 05222000
         IC    WORKBYTE,MEMBYTE(,@15)                              1603 05223000
*         CALL EDITBIT;             /* CONVERT TO BITS       @Z40LB40*/ 05224000
         BAL   @14,EDITBIT                                         1604 05225000
*         PRINTLNB(27:34)=BITOUT;   /* MOVE BITS TO LINE     @Z40LB40*/ 05226000
         MVC   PRINTLNB+26(8),BITOUT                               1605 05227000
*         WORKBYTE=(B1BASE+J3)->MEMBYTE;/* SAVE BYTE 1       @Z40LB40*/ 05228000
         LR    @15,J3                                              1606 05229000
         AL    @15,B1BASE                                          1606 05230000
         SLR   WORKBYTE,WORKBYTE                                   1606 05231000
         IC    WORKBYTE,MEMBYTE(,@15)                              1606 05232000
*         CALL EDITBIT;             /* CONVERT TO BITS       @Z40LB40*/ 05233000
         BAL   @14,EDITBIT                                         1607 05234000
*         PRINTLNB(36:43)=BITOUT;   /* MOVE BITS TO LINE     @Z40LB40*/ 05235000
         MVC   PRINTLNB+35(8),BITOUT                               1608 05236000
*         J3=J3+'01'X;              /* BUMP VVA VALUE        @Z40LB40*/ 05237000
         AL    J3,@CF01522                                         1609 05238000
*       END;                        /*                       @Z40LB40*/ 05239000
*     IF K3<='FF'X THEN             /* LIMIT COLUMN 3        @Z40LB40*/ 05240000
@RF01597 L     @05,K3                                              1611 05241000
         C     @05,@CF00589                                        1611 05242000
         BH    @RF01611                                            1611 05243000
*       DO;                         /*                       @Z40LB40*/ 05244000
*         PROSET1=K3;               /* SAVE K3 FOR VVA       @Z40LB40*/ 05245000
         L     @15,K3                                              1613 05246000
         ST    @15,PROSET1                                         1613 05247000
*         UNPK(PRWORK,PROSET);      /* UNPK WORD             @Z40LB40*/ 05248000
         UNPK  PRWORK(9),PROSET(5)                                 1614 05249000
*         TR(PRWORK(7:8),TABLE);    /* TR TO EBCDIC          @Z40LB40*/ 05250000
         TR    PRWORK+6(2),TABLE                                   1615 05251000
*         PRINTLNB(46:47)=PRWORK(7:8);/* MOVE VVA TO LINE    @Z40LB40*/ 05252000
         MVC   PRINTLNB+45(2),PRWORK+6                             1616 05253000
*         WORKBYTE=(B0BASE+K3)->MEMBYTE;/* SAVE BYTE 0       @Z40LB40*/ 05254000
         AL    @15,B0BASE                                          1617 05255000
         SLR   WORKBYTE,WORKBYTE                                   1617 05256000
         IC    WORKBYTE,MEMBYTE(,@15)                              1617 05257000
*         CALL EDITBIT;             /* CONVERT TO BITS       @Z40LB40*/ 05258000
         BAL   @14,EDITBIT                                         1618 05259000
*         PRINTLNB(49:56)=BITOUT;   /* MOVE BITS TO LINE     @Z40LB40*/ 05260000
         MVC   PRINTLNB+48(8),BITOUT                               1619 05261000
*         WORKBYTE=(B1BASE+K3)->MEMBYTE;/* SAVE BYTE 1       @Z40LB40*/ 05262000
         L     @15,B1BASE                                          1620 05263000
         AL    @15,K3                                              1620 05264000
         SLR   WORKBYTE,WORKBYTE                                   1620 05265000
         IC    WORKBYTE,MEMBYTE(,@15)                              1620 05266000
*         CALL EDITBIT;             /* CONVERT TO BITS       @Z40LB40*/ 05267000
         BAL   @14,EDITBIT                                         1621 05268000
*         PRINTLNB(58:65)=BITOUT;   /* MOVE BITS TO LINE     @Z40LB40*/ 05269000
         MVC   PRINTLNB+57(8),BITOUT                               1622 05270000
*         K3=K3+'01'X;              /* BUMP VVA VALUE        @Z40LB40*/ 05271000
         LA    @05,1                                               1623 05272000
         AL    @05,K3                                              1623 05273000
         ST    @05,K3                                              1623 05274000
*       END;                        /*                       @Z40LB40*/ 05275000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 05276000
@RF01611 BAL   @14,DOUPRINT                                        1625 05277000
*   END;                            /*                       @Z40LB40*/ 05278000
         LA    @05,1                                               1626 05279000
         AL    @05,L3                                              1626 05280000
         ST    @05,L3                                              1626 05281000
         C     @05,@CF01619                                        1626 05282000
         BNH   @DL01580                                            1626 05283000
*   RFY                                                            1627 05284000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05285000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 05286000
         LR    REG14,RETADDR3                                      1628 05287000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05288000
@EL00018 DS    0H                                                  1629 05289000
@EF00018 DS    0H                                                  1629 05290000
@ER00018 BR    @14                                                 1629 05291000
*   RFY                                                            1630 05292000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05293000
*   END VVIT;                       /*                       @Z40LB40*/ 05294000
*                                                                  1632 05295000
*   /*****************************************************************/ 05296000
*   /*                                                               */ 05297000
*   /* PROCEDURE NAME - EDITBIT (LEVEL 4)                    @Z40LB40*/ 05298000
*   /*                                                       @Z40LB40*/ 05299000
*   /* FUNCTION - THIS ROUTINE CONVERTS A BYTE INTO          @Z40LB40*/ 05300000
*   /* PRINTABLE BITS .                                      @Z40LB40*/ 05301000
*   /*                                                       @Z40LB40*/ 05302000
*   /* INPUT - WORKBYTE WHICH CONTAINS THE BYTE TO BE        @Z40LB40*/ 05303000
*   /* CONVERTED.                                            @Z40LB40*/ 05304000
*   /*                                                       @Z40LB40*/ 05305000
*   /* OUTPUT - BITOUT WHICH IS AN 8 CHARACTER OUTPUT        @Z40LB40*/ 05306000
*   /* AREA. EACH OUTPUT BYTE WILL BE EITHER 0 OR 1.         @Z40LB40*/ 05307000
*   /*                                                               */ 05308000
*   /*****************************************************************/ 05309000
*                                                                  1632 05310000
*EDITBIT:                                                          1632 05311000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05312000
EDITBIT  DS    0H                                                  1633 05313000
*   RFY                                                            1633 05314000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05315000
*   RETADDR4=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05316000
         ST    REG14,RETADDR4                                      1634 05317000
*   RFY                                                            1635 05318000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05319000
*   OLDERID2=NEWERID2;                                             1636 05320000
         L     @02,@PC00001                                        1636 05321000
         L     @02,GDTTR2(,@02)                                    1636 05322000
         MVC   @TS00001(95),NEWERID2(@02)                          1636 05323000
         MVC   OLDERID2(95,@02),@TS00001                           1636 05324000
*   NEWID2='DUDB';                  /*                       @Z40LB40*/ 05325000
         MVC   NEWID2(4,@02),@CC01631                              1637 05326000
*   BYTEMASK='10000000'B;           /* INIT MASK             @Z40LB40*/ 05327000
         LA    BYTEMASK,128                                        1638 05328000
*   BITOUT='00000000';              /* INIT OUTPUT AREA      @Z40LB40*/ 05329000
         MVC   BITOUT(8),@CC01633                                  1639 05330000
*   DO I4=1 TO 8;                   /* LOOP THRU 8 BITS      @Z40LB40*/ 05331000
         LA    @02,1                                               1640 05332000
         ST    @02,I4                                              1640 05333000
@DL01640 DS    0H                                                  1641 05334000
*     IF(WORKBYTE&BYTEMASK)=BYTEMASK THEN/* TEST FOR 1       @Z40LB40*/ 05335000
         LR    @15,WORKBYTE                                        1641 05336000
         NR    @15,BYTEMASK                                        1641 05337000
         CR    @15,BYTEMASK                                        1641 05338000
         BNE   @RF01641                                            1641 05339000
*       BITOUT(I4:I4)='1';          /* SET OUTPUT TO 1       @Z40LB40*/ 05340000
         LA    @01,BITOUT-1(@02)                                   1642 05341000
         MVI   0(@01),C'1'                                         1642 05342000
*     SRL(BYTEMASK,1);              /* SHIFT TO NEXT BIT     @Z40LB40*/ 05343000
@RF01641 SRL   BYTEMASK,1                                          1643 05344000
*   END;                            /*                       @Z40LB40*/ 05345000
         LA    @02,1                                               1644 05346000
         AL    @02,I4                                              1644 05347000
         ST    @02,I4                                              1644 05348000
         C     @02,@CF00183                                        1644 05349000
         BNH   @DL01640                                            1644 05350000
*   RFY                                                            1645 05351000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05352000
*   REG14=RETADDR4;                 /* RESET RETURN POINT    @Z40LB40*/ 05353000
         L     REG14,RETADDR4                                      1646 05354000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05355000
@EL00019 DS    0H                                                  1647 05356000
@EF00019 DS    0H                                                  1647 05357000
@ER00019 BR    @14                                                 1647 05358000
*   RFY                                                            1648 05359000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05360000
*   END EDITBIT;                    /*                       @Z40LB40*/ 05361000
*                                                                  1650 05362000
*   /*****************************************************************/ 05363000
*   /*                                                               */ 05364000
*   /* PROCEDURE NAME - DCBS (LEVEL 3)                       @Z40LB40*/ 05365000
*   /*                                                       @Z40LB40*/ 05366000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING ADAPTER    @Z40LB40*/ 05367000
*   /* DEVICE CONTROL BLOCKS (DCB).                          @Z40LB40*/ 05368000
*   /* THE FOLLOWING SHOWS HOW EACH DCB IS STRUCTURED.       @Z40LB40*/ 05369000
*   /* THE FOUR CHARACTER VALUES SHOWN ARE THE ACTUAL        @Z40LB40*/ 05370000
*   /* SECTOR ADDRESSES OF EACH WORD IN THE STAGING          @Z40LB40*/ 05371000
*   /* ADAPTER.                                              @Z40LB40*/ 05372000
*   /* RUA CONTROLLERS 0 AND 1...CONTROLLERS 2 AND 3         @Z40LB40*/ 05373000
*   /* .00 0300 0304 0200 0204...0380 0384 0280 0284         @Z40LB40*/ 05374000
*   /* .01 0308 030C 0208 020C...0380 038C 0288 028C         @Z40LB40*/ 05375000
*   /* ...                                                   @Z40LB40*/ 05376000
*   /* .0F 0378 037C 0278 027C...03F8 03FC 02F8 02FC         @Z40LB40*/ 05377000
*   /*                                                       @Z40LB40*/ 05378000
*   /* INPUT - NONE                                          @Z40LB40*/ 05379000
*   /*                                                       @Z40LB40*/ 05380000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE DCBS. EACH LINE   @Z40LB40*/ 05381000
*   /* WILL CONTAIN ALL THE CONTROLLER WORDS FOR A RUA.      @Z40LB40*/ 05382000
*   /*                                                               */ 05383000
*   /*****************************************************************/ 05384000
*                                                                  1650 05385000
*DCBS:                                                             1650 05386000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05387000
DCBS     DS    0H                                                  1651 05388000
*   RFY                                                            1651 05389000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05390000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05391000
         LR    RETADDR3,REG14                                      1652 05392000
*   RFY                                                            1653 05393000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05394000
*   OLDERID2=NEWERID2;                                             1654 05395000
         L     @05,@PC00001                                        1654 05396000
         L     @15,GDTTR2(,@05)                                    1654 05397000
         MVC   @TS00001(95),NEWERID2(@15)                          1654 05398000
         MVC   OLDERID2(95,@15),@TS00001                           1654 05399000
*   NEWID2='DUCO';                  /*                       @Z40LB40*/ 05400000
*                                                                  1655 05401000
         MVC   NEWID2(4,@15),@CC01638                              1655 05402000
*   /*****************************************************************/ 05403000
*   /*                                                               */ 05404000
*   /* ISSUE UPRINT FOR DCB HEADERS                          @Z40LB40*/ 05405000
*   /*                                                               */ 05406000
*   /*****************************************************************/ 05407000
*                                                                  1656 05408000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 05409000
         XC    PRINTAB(44),PRINTAB                                 1656 05410000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 05411000
         L     @15,DDSTRU                                          1657 05412000
         MVC   DARGSMOD(3,@15),@CC01334                            1657 05413000
*   DARGSENT=HDCB;                  /*                       @Z40LB40*/ 05414000
         MVI   DARGSENT(@15),X'29'                                 1658 05415000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 05416000
         ST    @05,@AL00001                                        1659 05417000
         LA    @15,PRPTR                                           1659 05418000
         ST    @15,@AL00001+4                                      1659 05419000
         LA    @15,DDSTRU                                          1659 05420000
         ST    @15,@AL00001+8                                      1659 05421000
         MVI   @AL00001+8,X'80'                                    1659 05422000
         L     @15,GDTPRT(,@05)                                    1659 05423000
         LA    @01,@AL00001                                        1659 05424000
         BALR  @14,@15                                             1659 05425000
*   I3=MEMPTR+'0300'X;              /* SET ADDR START        @Z40LB40*/ 05426000
         L     @15,MEMPTR                                          1660 05427000
         LA    I3,768                                              1660 05428000
         ALR   I3,@15                                              1660 05429000
*   J3=MEMPTR+'0200'X;              /* SET ADDR START        @Z40LB40*/ 05430000
         AL    @15,@CF01560                                        1661 05431000
         LR    J3,@15                                              1661 05432000
*   DO K3='00'X TO'0F'X;            /* K3 IS THE RUA         @Z40LB40*/ 05433000
         SLR   @05,@05                                             1662 05434000
         ST    @05,K3                                              1662 05435000
@DL01662 DS    0H                                                  1663 05436000
*     PRINTLNB=' ';                 /* BLANK PRINT LINE      @Z40LB40*/ 05437000
         MVI   PRINTLNB+1,C' '                                     1663 05438000
         MVC   PRINTLNB+2(118),PRINTLNB+1                          1663 05439000
         MVI   PRINTLNB,C' '                                       1663 05440000
*     PROSET1=K3;                   /* SAVE RUA              @Z40LB40*/ 05441000
         ST    @05,PROSET1                                         1664 05442000
*     UNPK(PRWORK,PROSET);          /* UNPK RUA              @Z40LB40*/ 05443000
         UNPK  PRWORK(9),PROSET(5)                                 1665 05444000
*     TR(PRWORK(8:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05445000
         TR    PRWORK+7(1),TABLE                                   1666 05446000
*     PRINTLNB(2:2)=PRWORK(8:8);    /* MOVE TO LINE          @Z40LB40*/ 05447000
         MVC   PRINTLNB+1(1),PRWORK+7                              1667 05448000
*     PRLNPTR=5;                    /* INIT LINE POINTER     @Z40LB40*/ 05449000
*                                                                  1668 05450000
         LA    PRLNPTR,5                                           1668 05451000
*     /***************************************************************/ 05452000
*     /*                                                             */ 05453000
*     /* PRINT WORDS 0 & 1 OF CONTROLLERS 0 & 1              @ZD00050*/ 05454000
*     /*                                                             */ 05455000
*     /***************************************************************/ 05456000
*                                                                  1669 05457000
*     DO L3=1 TO 2;                 /* EDIT 2 WORDS          @Z40LB40*/ 05458000
         LA    @05,1                                               1669 05459000
         ST    @05,L3                                              1669 05460000
@DL01669 DS    0H                                                  1670 05461000
*       PRSTART=I3;                 /* SET WORD ADDR.        @Z40LB40*/ 05462000
         LR    PRSTART,I3                                          1670 05463000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 05464000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1671 05465000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 05466000
         TR    PRWORK(8),TABLE                                     1672 05467000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 05468000
         LA    @05,PRINTLNB-1(PRLNPTR)                             1673 05469000
         MVC   0(8,@05),PRWORK                                     1673 05470000
*       I3=I3+4;                    /* BUMP ADDRESS          @Z40LB40*/ 05471000
         AL    I3,@CF00044                                         1674 05472000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 05473000
         AL    PRLNPTR,@CF01152                                    1675 05474000
*     END;                          /*                       @Z40LB40*/ 05475000
*                                                                  1676 05476000
         L     @02,L3                                              1676 05477000
         AL    @02,@CF00223                                        1676 05478000
         LR    @05,@02                                             1676 05479000
         ST    @05,L3                                              1676 05480000
         C     @05,@CF00157                                        1676 05481000
         BNH   @DL01669                                            1676 05482000
*     /***************************************************************/ 05483000
*     /*                                                             */ 05484000
*     /* PRINT WORDS 2 & 3 OF CONTROLLERS 0 & 1              @ZD00050*/ 05485000
*     /*                                                             */ 05486000
*     /***************************************************************/ 05487000
*                                                                  1677 05488000
*     DO L3=1 TO 2;                 /* EDIT 2 WORDS          @Z40LB40*/ 05489000
         LA    @05,1                                               1677 05490000
         ST    @05,L3                                              1677 05491000
@DL01677 DS    0H                                                  1678 05492000
*       PRSTART=J3;                 /* SET WORD ADDR.        @Z40LB40*/ 05493000
         LR    PRSTART,J3                                          1678 05494000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 05495000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1679 05496000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 05497000
         TR    PRWORK(8),TABLE                                     1680 05498000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 05499000
         LA    @05,PRINTLNB-1(PRLNPTR)                             1681 05500000
         MVC   0(8,@05),PRWORK                                     1681 05501000
*       J3=J3+4;                    /* BUMP ADDRESS          @Z40LB40*/ 05502000
         AL    J3,@CF00044                                         1682 05503000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 05504000
         AL    PRLNPTR,@CF01152                                    1683 05505000
*     END;                          /*                       @Z40LB40*/ 05506000
         L     @02,L3                                              1684 05507000
         AL    @02,@CF00223                                        1684 05508000
         LR    @05,@02                                             1684 05509000
         ST    @05,L3                                              1684 05510000
         C     @05,@CF00157                                        1684 05511000
         BNH   @DL01677                                            1684 05512000
*     PRLNPTR=PRLNPTR+1;            /* ADD ONE SPACE MORE    @Z40LB40*/ 05513000
         LA    @05,1                                               1685 05514000
         ALR   PRLNPTR,@05                                         1685 05515000
*     I3=I3+'0078'X;                /* BUMP ADDR START       @ZD00050*/ 05516000
         LA    @02,120                                             1686 05517000
         ALR   I3,@02                                              1686 05518000
*     J3=J3+'0078'X;                /* BUMP ADDR START       @ZD00050*/ 05519000
*                                                                  1687 05520000
         ALR   J3,@02                                              1687 05521000
*     /***************************************************************/ 05522000
*     /*                                                             */ 05523000
*     /* PRINT WORDS 0 & 1 OF CONTROLLERS 2 & 3              @ZD00050*/ 05524000
*     /*                                                             */ 05525000
*     /***************************************************************/ 05526000
*                                                                  1688 05527000
*     DO L3=1 TO 2;                 /* EDIT 2 WORDS          @Z40LB40*/ 05528000
         ST    @05,L3                                              1688 05529000
@DL01688 DS    0H                                                  1689 05530000
*       PRSTART=I3;                 /* SET WORD ADDR.        @Z40LB40*/ 05531000
         LR    PRSTART,I3                                          1689 05532000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 05533000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1690 05534000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 05535000
         TR    PRWORK(8),TABLE                                     1691 05536000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 05537000
         LA    @05,PRINTLNB-1(PRLNPTR)                             1692 05538000
         MVC   0(8,@05),PRWORK                                     1692 05539000
*       I3=I3+4;                    /* BUMP ADDRESS          @Z40LB40*/ 05540000
         AL    I3,@CF00044                                         1693 05541000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 05542000
         AL    PRLNPTR,@CF01152                                    1694 05543000
*     END;                          /*                       @Z40LB40*/ 05544000
*                                                                  1695 05545000
         L     @02,L3                                              1695 05546000
         AL    @02,@CF00223                                        1695 05547000
         LR    @05,@02                                             1695 05548000
         ST    @05,L3                                              1695 05549000
         C     @05,@CF00157                                        1695 05550000
         BNH   @DL01688                                            1695 05551000
*     /***************************************************************/ 05552000
*     /*                                                             */ 05553000
*     /* PRINT WORDS 2 & 3 OF CONTROLLERS 2 & 3              @ZD00050*/ 05554000
*     /*                                                             */ 05555000
*     /***************************************************************/ 05556000
*                                                                  1696 05557000
*     DO L3=1 TO 2;                 /* EDIT 2 WORDS          @Z40LB40*/ 05558000
         LA    @05,1                                               1696 05559000
         ST    @05,L3                                              1696 05560000
@DL01696 DS    0H                                                  1697 05561000
*       PRSTART=J3;                 /* SET WORD ADDR.        @Z40LB40*/ 05562000
         LR    PRSTART,J3                                          1697 05563000
*       UNPK(PRWORK,PRAREA);        /* UNPK WORD             @Z40LB40*/ 05564000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1698 05565000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 05566000
         TR    PRWORK(8),TABLE                                     1699 05567000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* MOVE TO LINE   @Z40LB40*/ 05568000
         LA    @05,PRINTLNB-1(PRLNPTR)                             1700 05569000
         MVC   0(8,@05),PRWORK                                     1700 05570000
*       J3=J3+4;                    /* BUMP ADDRESS          @Z40LB40*/ 05571000
         AL    J3,@CF00044                                         1701 05572000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 05573000
         AL    PRLNPTR,@CF01152                                    1702 05574000
*     END;                          /*                       @Z40LB40*/ 05575000
         L     @02,L3                                              1703 05576000
         AL    @02,@CF00223                                        1703 05577000
         LR    @05,@02                                             1703 05578000
         ST    @05,L3                                              1703 05579000
         C     @05,@CF00157                                        1703 05580000
         BNH   @DL01696                                            1703 05581000
*     I3=I3-'0080'X;                /* RESET ADDR START      @ZD00050*/ 05582000
         LA    @05,128                                             1704 05583000
         SLR   I3,@05                                              1704 05584000
*     J3=J3-'0080'X;                /* RESET ADDR START      @ZD00050*/ 05585000
*                                                                  1705 05586000
         SLR   J3,@05                                              1705 05587000
*     /***************************************************************/ 05588000
*     /*                                                             */ 05589000
*     /* ISSUE UPRINT TO PRINT DATA LINE                     @Z40LB40*/ 05590000
*     /*                                                             */ 05591000
*     /***************************************************************/ 05592000
*                                                                  1706 05593000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 05594000
         BAL   @14,DOUPRINT                                        1706 05595000
*   END;                            /*                       @Z40LB40*/ 05596000
         LA    @05,1                                               1707 05597000
         AL    @05,K3                                              1707 05598000
         ST    @05,K3                                              1707 05599000
         C     @05,@CF01612                                        1707 05600000
         BNH   @DL01662                                            1707 05601000
*   RFY                                                            1708 05602000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05603000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 05604000
         LR    REG14,RETADDR3                                      1709 05605000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05606000
@EL00020 DS    0H                                                  1710 05607000
@EF00020 DS    0H                                                  1710 05608000
@ER00020 BR    @14                                                 1710 05609000
*   RFY                                                            1711 05610000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05611000
*   END DCBS;                       /*                       @Z40LB40*/ 05612000
*                                                                  1713 05613000
*   /*****************************************************************/ 05614000
*   /*                                                               */ 05615000
*   /* PROCEDURE NAME - SAMSGQUE (LEVEL 3)                   @Z40LB40*/ 05616000
*   /*                                                       @Z40LB40*/ 05617000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING ADAPTER    @Z40LB40*/ 05618000
*   /* TO MSC MESSAGE QUEUE.                                 @Z40LB40*/ 05619000
*   /*                                                       @Z40LB40*/ 05620000
*   /* INPUT - NONE                                          @Z40LB40*/ 05621000
*   /*                                                       @Z40LB40*/ 05622000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE QUEUE. SEE        @Z40LB40*/ 05623000
*   /* REFERENCES TO SECTADDR FOR ACTUAL LOCATION OF THE     @Z40LB40*/ 05624000
*   /* QUEUE.                                                @Z40LB40*/ 05625000
*   /*                                                               */ 05626000
*   /*****************************************************************/ 05627000
*                                                                  1713 05628000
*SAMSGQUE:                                                         1713 05629000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05630000
SAMSGQUE DS    0H                                                  1714 05631000
*   RFY                                                            1714 05632000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05633000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05634000
         LR    RETADDR3,REG14                                      1715 05635000
*   RFY                                                            1716 05636000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05637000
*   OLDERID2=NEWERID2;                                             1717 05638000
         L     @07,@PC00001                                        1717 05639000
         L     @02,GDTTR2(,@07)                                    1717 05640000
         MVC   @TS00001(95),NEWERID2(@02)                          1717 05641000
         MVC   OLDERID2(95,@02),@TS00001                           1717 05642000
*   NEWID2='DUCP';                  /*                       @Z40LB40*/ 05643000
*                                                                  1718 05644000
         MVC   NEWID2(4,@02),@CC01644                              1718 05645000
*   /*****************************************************************/ 05646000
*   /*                                                               */ 05647000
*   /* ISSUE UPRINT FOR MESSAGE QUEUE HEADER                 @Z40LB40*/ 05648000
*   /*                                                               */ 05649000
*   /*****************************************************************/ 05650000
*                                                                  1719 05651000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 05652000
         XC    PRINTAB(44),PRINTAB                                 1719 05653000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 05654000
         L     @02,DDSTRU                                          1720 05655000
         MVC   DARGSMOD(3,@02),@CC01334                            1720 05656000
*   DARGSENT=HSAMSG;                /*                       @Z40LB40*/ 05657000
         MVI   DARGSENT(@02),X'18'                                 1721 05658000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 05659000
         ST    @07,@AL00001                                        1722 05660000
         LA    @02,PRPTR                                           1722 05661000
         ST    @02,@AL00001+4                                      1722 05662000
         LA    @02,DDSTRU                                          1722 05663000
         ST    @02,@AL00001+8                                      1722 05664000
         MVI   @AL00001+8,X'80'                                    1722 05665000
         L     @15,GDTPRT(,@07)                                    1722 05666000
         LA    @01,@AL00001                                        1722 05667000
         BALR  @14,@15                                             1722 05668000
*   SECTADDR='4A00'X;               /* SET SECTOR ADDR.      @Z40LB40*/ 05669000
         L     SECTADDR,@CF01645                                   1723 05670000
*   NUMBYTES=20;                    /* PRINT 20 BYTES        @Z40LB40*/ 05671000
         MVC   NUMBYTES(4),@CF00280                                1724 05672000
*   CALL PRNTSECT;                  /* PRINT THE QUEUE       @Z40LB40*/ 05673000
         BAL   @14,PRNTSECT                                        1725 05674000
*   RFY                                                            1726 05675000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05676000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 05677000
         LR    REG14,RETADDR3                                      1727 05678000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05679000
@EL00021 DS    0H                                                  1728 05680000
@EF00021 DS    0H                                                  1728 05681000
@ER00021 BR    @14                                                 1728 05682000
*   RFY                                                            1729 05683000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05684000
*   END SAMSGQUE;                   /*                       @Z40LB40*/ 05685000
*                                                                  1731 05686000
*   /*****************************************************************/ 05687000
*   /*                                                               */ 05688000
*   /* PROCEDURE NAME - AUT (LEVEL 3)                        @Z40LB40*/ 05689000
*   /*                                                       @Z40LB40*/ 05690000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING            @Z40LB40*/ 05691000
*   /* ADAPTER ADDRESS USING TABLE (AUT). THE AUT IS         @Z40LB40*/ 05692000
*   /* 32 BYTES LONG, EACH BYTE REPRESENTS A RUA             @Z40LB40*/ 05693000
*   /* AND THE CONTENT OF THE BYTE DESCRIBES ITS             @Z40LB40*/ 05694000
*   /* ASSOCIATED CHANNEL AND VUA. THE FORMAT OF             @Z40LB40*/ 05695000
*   /* AN ENTRY IS CCVVVVVV WHERE CC IS THE CHANNEL          @Z40LB40*/ 05696000
*   /* INDICATOR AND VVVVVV IS THE VUA. THE VALUES           @Z40LB40*/ 05697000
*   /* FOR CC AND THE ASSOCIATED CHANNEL ARE:                @Z40LB40*/ 05698000
*   /* CC=00=CHANNEL D                                       @Z40LB40*/ 05699000
*   /* CC=01=CHANNEL C                                       @Z40LB40*/ 05700000
*   /* CC=10=CHANNEL B                                       @Z40LB40*/ 05701000
*   /* CC=11=CHANNEL A                                       @Z40LB40*/ 05702000
*   /*                                                       @Z40LB40*/ 05703000
*   /* INPUT - NONE                                          @Z40LB40*/ 05704000
*   /*                                                       @Z40LB40*/ 05705000
*   /* OUTPUT - A BIT AND HEXADECIMAL PRINT OF THE AUT.      @Z40LB40*/ 05706000
*   /* EACH LINE REPRESENTS ONE AUT ENTRY.                   @Z40LB40*/ 05707000
*   /*                                                               */ 05708000
*   /*****************************************************************/ 05709000
*                                                                  1731 05710000
*AUT:                                                              1731 05711000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05712000
AUT      DS    0H                                                  1732 05713000
*   RFY                                                            1732 05714000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05715000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05716000
         LR    RETADDR3,REG14                                      1733 05717000
*   RFY                                                            1734 05718000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05719000
*   OLDERID2=NEWERID2;                                             1735 05720000
         L     @05,@PC00001                                        1735 05721000
         L     @15,GDTTR2(,@05)                                    1735 05722000
         MVC   @TS00001(95),NEWERID2(@15)                          1735 05723000
         MVC   OLDERID2(95,@15),@TS00001                           1735 05724000
*   NEWID2='DUCQ';                  /*                       @Z40LB40*/ 05725000
*                                                                  1736 05726000
         MVC   NEWID2(4,@15),@CC01649                              1736 05727000
*   /*****************************************************************/ 05728000
*   /*                                                               */ 05729000
*   /* ISSUE UPRINT FOR AUT HEADERS                          @Z40LB40*/ 05730000
*   /*                                                               */ 05731000
*   /*****************************************************************/ 05732000
*                                                                  1737 05733000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 05734000
         XC    PRINTAB(44),PRINTAB                                 1737 05735000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 05736000
         L     @15,DDSTRU                                          1738 05737000
         MVC   DARGSMOD(3,@15),@CC01334                            1738 05738000
*   DARGSENT=HAUT;                  /*                       @Z40LB40*/ 05739000
         MVI   DARGSENT(@15),X'2A'                                 1739 05740000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 05741000
         ST    @05,@AL00001                                        1740 05742000
         LA    @15,PRPTR                                           1740 05743000
         ST    @15,@AL00001+4                                      1740 05744000
         LA    @15,DDSTRU                                          1740 05745000
         ST    @15,@AL00001+8                                      1740 05746000
         MVI   @AL00001+8,X'80'                                    1740 05747000
         L     @15,GDTPRT(,@05)                                    1740 05748000
         LA    @01,@AL00001                                        1740 05749000
         BALR  @14,@15                                             1740 05750000
*   I3='00'X;                       /* I3=RUA 00-0F          @Z40LB40*/ 05751000
         SLR   I3,I3                                               1741 05752000
*   J3='10'X;                       /* J3=RUA 10-1F          @Z40LB40*/ 05753000
         LA    J3,16                                               1742 05754000
*   DO K3='0690'X TO'069F'X;        /* PRINT 16 LINES        @Z40LB40*/ 05755000
         LA    @05,1680                                            1743 05756000
         ST    @05,K3                                              1743 05757000
@DL01743 DS    0H                                                  1744 05758000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 05759000
         MVI   PRINTLN+1,C' '                                      1744 05760000
         MVC   PRINTLN+2(119),PRINTLN+1                            1744 05761000
         MVI   PRINTLN,C' '                                        1744 05762000
*     PROSET1=I3;                   /* SAVE RUA              @Z40LB40*/ 05763000
         ST    I3,PROSET1                                          1745 05764000
*     UNPK(PRWORK,PROSET);          /* UNPK RUA              @Z40LB40*/ 05765000
         UNPK  PRWORK(9),PROSET(5)                                 1746 05766000
*     TR(PRWORK(7:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05767000
         TR    PRWORK+6(2),TABLE                                   1747 05768000
*     PRINTLNB(2:3)=PRWORK(7:8);    /* MOVE TO LINE          @Z40LB40*/ 05769000
         MVC   PRINTLNB+1(2),PRWORK+6                              1748 05770000
*     WORKBYTE=(K3+MEMPTR)->MEMBYTE;/* SAVE BYTE             @Z40LB40*/ 05771000
         L     @15,K3                                              1749 05772000
         AL    @15,MEMPTR                                          1749 05773000
         SLR   WORKBYTE,WORKBYTE                                   1749 05774000
         IC    WORKBYTE,MEMBYTE(,@15)                              1749 05775000
*     CALL EDITBIT;                 /* CONVERT TO BITS       @Z40LB40*/ 05776000
         BAL   @14,EDITBIT                                         1750 05777000
*     PRINTLNB(6:7)=BITOUT(1:2);    /* MOVE CHANNEL          @Z40LB40*/ 05778000
         MVC   PRINTLNB+5(2),BITOUT                                1751 05779000
*     PROSET2=WORKBYTE&OFFCHAN;     /* ZERO CHANNEL BITS     @Z40LB40*/ 05780000
         LA    @15,63                                              1752 05781000
         NR    @15,WORKBYTE                                        1752 05782000
         STC   @15,PROSET2                                         1752 05783000
*     UNPK(PRWORK,PROSET);          /* UNPK VUA              @Z40LB40*/ 05784000
         UNPK  PRWORK(9),PROSET(5)                                 1753 05785000
*     TR(PRWORK(1:2),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05786000
         TR    PRWORK(2),TABLE                                     1754 05787000
*     PRINTLNB(11:12)=PRWORK(1:2);  /* MOVE TO LINE          @Z40LB40*/ 05788000
         MVC   PRINTLNB+10(2),PRWORK                               1755 05789000
*     I3=I3+'01'X;                  /* INCREMENT RUA         @Z40LB40*/ 05790000
         AL    I3,@CF01522                                         1756 05791000
*     PROSET1=J3;                   /* SAVE RUA              @Z40LB40*/ 05792000
         ST    J3,PROSET1                                          1757 05793000
*     UNPK(PRWORK,PROSET);          /* UNPK RUA              @Z40LB40*/ 05794000
         UNPK  PRWORK(9),PROSET(5)                                 1758 05795000
*     TR(PRWORK(7:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05796000
         TR    PRWORK+6(2),TABLE                                   1759 05797000
*     PRINTLNB(17:18)=PRWORK(7:8);  /* MOVE TO LINE          @Z40LB40*/ 05798000
         MVC   PRINTLNB+16(2),PRWORK+6                             1760 05799000
*     WORKBYTE=(K3+'10'X+MEMPTR)->MEMBYTE;/* SAVE BYTE       @Z40LB40*/ 05800000
         LA    @15,16                                              1761 05801000
         AL    @15,K3                                              1761 05802000
         AL    @15,MEMPTR                                          1761 05803000
         SLR   WORKBYTE,WORKBYTE                                   1761 05804000
         IC    WORKBYTE,MEMBYTE(,@15)                              1761 05805000
*     CALL EDITBIT;                 /* CONVERT TO BITS       @Z40LB40*/ 05806000
         BAL   @14,EDITBIT                                         1762 05807000
*     PRINTLNB(21:22)=BITOUT(1:2);  /* MOVE CHANNEL          @Z40LB40*/ 05808000
         MVC   PRINTLNB+20(2),BITOUT                               1763 05809000
*     PROSET2=WORKBYTE&OFFCHAN;     /* ZERO CHANNEL BITS     @Z40LB40*/ 05810000
         LA    @15,63                                              1764 05811000
         NR    @15,WORKBYTE                                        1764 05812000
         STC   @15,PROSET2                                         1764 05813000
*     UNPK(PRWORK,PROSET);          /* UNPK VUA              @Z40LB40*/ 05814000
         UNPK  PRWORK(9),PROSET(5)                                 1765 05815000
*     TR(PRWORK(1:2),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05816000
         TR    PRWORK(2),TABLE                                     1766 05817000
*     PRINTLNB(26:27)=PRWORK(1:2);  /* MOVE TO LINE          @Z40LB40*/ 05818000
         MVC   PRINTLNB+25(2),PRWORK                               1767 05819000
*     J3=J3+'01'X;                  /* INCREMENT RUA         @Z40LB40*/ 05820000
         AL    J3,@CF01522                                         1768 05821000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 05822000
         BAL   @14,DOUPRINT                                        1769 05823000
*   END;                            /*                       @Z40LB40*/ 05824000
         LA    @05,1                                               1770 05825000
         AL    @05,K3                                              1770 05826000
         ST    @05,K3                                              1770 05827000
         C     @05,@CF01651                                        1770 05828000
         BNH   @DL01743                                            1770 05829000
*   RFY                                                            1771 05830000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05831000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 05832000
         LR    REG14,RETADDR3                                      1772 05833000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05834000
@EL00022 DS    0H                                                  1773 05835000
@EF00022 DS    0H                                                  1773 05836000
@ER00022 BR    @14                                                 1773 05837000
*   RFY                                                            1774 05838000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05839000
*   END AUT;                        /*                       @Z40LB40*/ 05840000
*                                                                  1776 05841000
*   /*****************************************************************/ 05842000
*   /*                                                               */ 05843000
*   /* PROCEDURE NAME - LTR (LEVEL 3)                        @Z40LB40*/ 05844000
*   /*                                                       @Z40LB40*/ 05845000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING            @Z40LB40*/ 05846000
*   /* ADAPTER LOGICAL TO REAL TRANSLATION TABLE(LTR).       @Z40LB40*/ 05847000
*   /* THE LTR IS 16 BYTES LONG, EACH BYTE REPRESENTS A      @Z40LB40*/ 05848000
*   /* LUA AND THE CONTENT OF THE BYTE DESCRIBES ITS         @Z40LB40*/ 05849000
*   /* ASSOCIATED CONTROLLER, FLAGS, RUA AND WHETHER THIS IS @Z40LB40*/ 05850000
*   /* LOW OR HIGH ORDER HALF OF A 3330-II PACK.             @Z40LB40*/ 05851000
*   /* THE FORMAT OF AN ENTRY IS IFFAADDD.                   @Z40LB40*/ 05852000
*   /* I=3330-II LOW OR HIGH INDICATOR.                      @Z40LB40*/ 05853000
*   /* FF=FLAGS                                              @Z40LB40*/ 05854000
*   /* AA=CONTROLLER                                         @Z40LB40*/ 05855000
*   /* DDD=RUA                                               @Z40LB40*/ 05856000
*   /*                                                       @Z40LB40*/ 05857000
*   /* INPUT - NONE                                          @Z40LB40*/ 05858000
*   /*                                                       @Z40LB40*/ 05859000
*   /* OUTPUT - A BIT AND HEXADECIMAL PRINT OF THE LTR.      @Z40LB40*/ 05860000
*   /* EACH LINE REPRESENTS ONE LTR ENTRY.                   @Z40LB40*/ 05861000
*   /*                                                               */ 05862000
*   /*****************************************************************/ 05863000
*                                                                  1776 05864000
*LTR:                                                              1776 05865000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05866000
LTR      DS    0H                                                  1777 05867000
*   RFY                                                            1777 05868000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05869000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05870000
         LR    RETADDR3,REG14                                      1778 05871000
*   RFY                                                            1779 05872000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05873000
*   OLDERID2=NEWERID2;                                             1780 05874000
         L     @07,@PC00001                                        1780 05875000
         L     @05,GDTTR2(,@07)                                    1780 05876000
         MVC   @TS00001(95),NEWERID2(@05)                          1780 05877000
         MVC   OLDERID2(95,@05),@TS00001                           1780 05878000
*   NEWID2='DUCR';                  /*                       @Z40LB40*/ 05879000
*                                                                  1781 05880000
         MVC   NEWID2(4,@05),@CC01655                              1781 05881000
*   /*****************************************************************/ 05882000
*   /*                                                               */ 05883000
*   /* ISSUE UPRINT FOR LTR HEADERS                          @Z40LB40*/ 05884000
*   /*                                                               */ 05885000
*   /*****************************************************************/ 05886000
*                                                                  1782 05887000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 05888000
         XC    PRINTAB(44),PRINTAB                                 1782 05889000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 05890000
         L     @05,DDSTRU                                          1783 05891000
         MVC   DARGSMOD(3,@05),@CC01334                            1783 05892000
*   DARGSENT=HLTR;                  /*                       @Z40LB40*/ 05893000
         MVI   DARGSENT(@05),X'2B'                                 1784 05894000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 05895000
         ST    @07,@AL00001                                        1785 05896000
         LA    @05,PRPTR                                           1785 05897000
         ST    @05,@AL00001+4                                      1785 05898000
         LA    @05,DDSTRU                                          1785 05899000
         ST    @05,@AL00001+8                                      1785 05900000
         MVI   @AL00001+8,X'80'                                    1785 05901000
         L     @15,GDTPRT(,@07)                                    1785 05902000
         LA    @01,@AL00001                                        1785 05903000
         BALR  @14,@15                                             1785 05904000
*   I3='00'X;                       /* I3=LUA 0-F            @Z40LB40*/ 05905000
         SLR   I3,I3                                               1786 05906000
*   DO K3='06B0'X TO'06BF'X;        /* PRINT 16 LINES        @Z40LB40*/ 05907000
         LA    @07,1712                                            1787 05908000
         ST    @07,K3                                              1787 05909000
@DL01787 DS    0H                                                  1788 05910000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 05911000
         MVI   PRINTLN+1,C' '                                      1788 05912000
         MVC   PRINTLN+2(119),PRINTLN+1                            1788 05913000
         MVI   PRINTLN,C' '                                        1788 05914000
*     PROSET1=I3;                   /* SAVE LUA              @Z40LB40*/ 05915000
         ST    I3,PROSET1                                          1789 05916000
*     UNPK(PRWORK,PROSET);          /* UNPK LUA              @Z40LB40*/ 05917000
         UNPK  PRWORK(9),PROSET(5)                                 1790 05918000
*     TR(PRWORK(8:8),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05919000
         TR    PRWORK+7(1),TABLE                                   1791 05920000
*     PRINTLNB(2:2)=PRWORK(8:8);    /* LUA TO LINE           @Z40LB40*/ 05921000
         MVC   PRINTLNB+1(1),PRWORK+7                              1792 05922000
*     WORKBYTE=(MEMPTR+K3)->MEMBYTE;/* SAVE BYTE             @Z40LB40*/ 05923000
         AL    @07,MEMPTR                                          1793 05924000
         SLR   WORKBYTE,WORKBYTE                                   1793 05925000
         IC    WORKBYTE,MEMBYTE(,@07)                              1793 05926000
*     CALL EDITBIT;                 /* CONVERT TO BITS       @Z40LB40*/ 05927000
         BAL   @14,EDITBIT                                         1794 05928000
*     PRINTLNB(8:8)=BITOUT(1:1);    /* 3330-II BIT TO LINE   @Z40LB40*/ 05929000
         MVC   PRINTLNB+7(1),BITOUT                                1795 05930000
*     PRINTLNB(15:16)=BITOUT(2:3);  /* FLAGS TO LINE         @Z40LB40*/ 05931000
         MVC   PRINTLNB+14(2),BITOUT+1                             1796 05932000
*     PRINTLNB(20:21)=BITOUT(4:5);  /* CONTR.TO LINE         @Z40LB40*/ 05933000
         MVC   PRINTLNB+19(2),BITOUT+3                             1797 05934000
*     PROSET2=WORKBYTE&RUAMASK;     /* OFF ALL BUT RUA       @Z40LB40*/ 05935000
         LA    @07,7                                               1798 05936000
         NR    @07,WORKBYTE                                        1798 05937000
         STC   @07,PROSET2                                         1798 05938000
*     UNPK(PRWORK,PROSET);          /* UNPK RUA              @Z40LB40*/ 05939000
         UNPK  PRWORK(9),PROSET(5)                                 1799 05940000
*     TR(PRWORK(2:2),TABLE);        /* TR TO EBCDIC          @Z40LB40*/ 05941000
         TR    PRWORK+1(1),TABLE                                   1800 05942000
*     PRINTLNB(25:25)=PRWORK(2:2);  /* RUA TO LINE           @Z40LB40*/ 05943000
         MVC   PRINTLNB+24(1),PRWORK+1                             1801 05944000
*     I3=I3+'01'X;                  /* INCREMENT LUA         @Z40LB40*/ 05945000
         AL    I3,@CF01522                                         1802 05946000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 05947000
         BAL   @14,DOUPRINT                                        1803 05948000
*   END;                            /*                       @Z40LB40*/ 05949000
         LA    @07,1                                               1804 05950000
         AL    @07,K3                                              1804 05951000
         ST    @07,K3                                              1804 05952000
         C     @07,@CF01657                                        1804 05953000
         BNH   @DL01787                                            1804 05954000
*   RFY                                                            1805 05955000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05956000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 05957000
         LR    REG14,RETADDR3                                      1806 05958000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 05959000
@EL00023 DS    0H                                                  1807 05960000
@EF00023 DS    0H                                                  1807 05961000
@ER00023 BR    @14                                                 1807 05962000
*   RFY                                                            1808 05963000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05964000
*   END LTR;                        /*                       @Z40LB40*/ 05965000
*                                                                  1810 05966000
*   /*****************************************************************/ 05967000
*   /*                                                               */ 05968000
*   /* PROCEDURE NAME - SASENSE (LEVEL 3)                    @Z40LB40*/ 05969000
*   /*                                                       @Z40LB40*/ 05970000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING            @Z40LB40*/ 05971000
*   /* ADAPTER SENSE DATA.                                   @Z40LB40*/ 05972000
*   /*                                                       @Z40LB40*/ 05973000
*   /* INPUT - NONE                                          @Z40LB40*/ 05974000
*   /*                                                       @Z40LB40*/ 05975000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE STAGING           @Z40LB40*/ 05976000
*   /* ADAPTER SENSE DATA. SEE REFERENCES TO SECTADDR        @Z40LB40*/ 05977000
*   /* FOR ACTUAL LOCATION OF THE SENSE DATA.                @Z40LB40*/ 05978000
*   /*                                                               */ 05979000
*   /*****************************************************************/ 05980000
*                                                                  1810 05981000
*SASENSE:                                                          1810 05982000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 05983000
SASENSE  DS    0H                                                  1811 05984000
*   RFY                                                            1811 05985000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 05986000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 05987000
         LR    RETADDR3,REG14                                      1812 05988000
*   RFY                                                            1813 05989000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 05990000
*   OLDERID2=NEWERID2;                                             1814 05991000
         L     @07,@PC00001                                        1814 05992000
         L     @02,GDTTR2(,@07)                                    1814 05993000
         MVC   @TS00001(95),NEWERID2(@02)                          1814 05994000
         MVC   OLDERID2(95,@02),@TS00001                           1814 05995000
*   NEWID2='DUCS';                  /*                       @Z40LB40*/ 05996000
*                                                                  1815 05997000
         MVC   NEWID2(4,@02),@CC01661                              1815 05998000
*   /*****************************************************************/ 05999000
*   /*                                                               */ 06000000
*   /* ISSUE UPRINT FOR SASENSE HEADER                       @Z40LB40*/ 06001000
*   /*                                                               */ 06002000
*   /*****************************************************************/ 06003000
*                                                                  1816 06004000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 06005000
         XC    PRINTAB(44),PRINTAB                                 1816 06006000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 06007000
         L     @02,DDSTRU                                          1817 06008000
         MVC   DARGSMOD(3,@02),@CC01334                            1817 06009000
*   DARGSENT=HSENSE;                /*                       @Z40LB40*/ 06010000
         MVI   DARGSENT(@02),X'2C'                                 1818 06011000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 06012000
         ST    @07,@AL00001                                        1819 06013000
         LA    @02,PRPTR                                           1819 06014000
         ST    @02,@AL00001+4                                      1819 06015000
         LA    @02,DDSTRU                                          1819 06016000
         ST    @02,@AL00001+8                                      1819 06017000
         MVI   @AL00001+8,X'80'                                    1819 06018000
         L     @15,GDTPRT(,@07)                                    1819 06019000
         LA    @01,@AL00001                                        1819 06020000
         BALR  @14,@15                                             1819 06021000
*   SECTADDR='7FC4'X;               /* SET SECTOR ADDRESS    @Z40LB40*/ 06022000
         L     SECTADDR,@CF01662                                   1820 06023000
*   NUMBYTES=60;                    /* PRINT 60 BYTES        @Z40LB40*/ 06024000
         MVC   NUMBYTES(4),@CF01663                                1821 06025000
*   CALL PRNTSECT;                  /* PRINT SENSE DATA      @Z40LB40*/ 06026000
         BAL   @14,PRNTSECT                                        1822 06027000
*   RFY                                                            1823 06028000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06029000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 06030000
         LR    REG14,RETADDR3                                      1824 06031000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 06032000
@EL00024 DS    0H                                                  1825 06033000
@EF00024 DS    0H                                                  1825 06034000
@ER00024 BR    @14                                                 1825 06035000
*   RFY                                                            1826 06036000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06037000
*   END SASENSE;                    /*                       @Z40LB40*/ 06038000
*                                                                  1828 06039000
*   /*****************************************************************/ 06040000
*   /*                                                               */ 06041000
*   /* PROCEDURE NAME - PST (LEVEL 3)                        @Z40LB40*/ 06042000
*   /*                                                       @Z40LB40*/ 06043000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING            @Z40LB40*/ 06044000
*   /* ADAPTER PAGE STATUS TABLES(PST) FOR STAGING           @Z40LB40*/ 06045000
*   /* DRIVE GROUPS 0 AND 1.                                 @Z40LB40*/ 06046000
*   /* THE PST IS LOCATED IN EXTENDED STORAGE.               @ZD00043*/ 06047000
*   /* THE FOLLOWING SHOWS HOW EACH PST IS STRUCTURED.       @Z40LB40*/ 06048000
*   /* THE FOUR CHARACTER VALUES SHOWN ARE THE ACTUAL        @Z40LB40*/ 06049000
*   /* SECTOR ADDRESSES OF EACH WORD IN THE PSTS.            @Z40LB40*/ 06050000
*   /* STAGING DRIVE GROUP 0                                 @Z40LB40*/ 06051000
*   /* PAGE LUA0 LUA1 LUA2 LUA3 LUA4 LUA5 LUA6 LUA7          @Z40LB40*/ 06052000
*   /* .00. C000 C0D0 C1A0 C270 C340 C410 C4E0 C5B0          @ZD00043*/ 06053000
*   /* .01. C004 C0D4 C1A4 C274 C344 C414 C4E4 C5B4          @ZD00043*/ 06054000
*   /* ....                                                  @Z40LB40*/ 06055000
*   /* .51. C0CC C19C C26C C33C C40C C4DC C5AC C67C          @ZD00043*/ 06056000
*   /* STAGING DRIVE GROUP 1                                 @Z40LB40*/ 06057000
*   /* PAGE LUA0 LUA1 LUA2 LUA3 LUA4 LUA5 LUA6 LUA7          @Z40LB40*/ 06058000
*   /* .00. C680 C750 C820 C8F0 C9C0 CA90 CB60 CC30          @ZD00043*/ 06059000
*   /* .01. C684 C754 C824 C8F4 C9C4 CA94 CB64 CC34          @ZD00043*/ 06060000
*   /* ....                                                  @Z40LB40*/ 06061000
*   /* .51. C74C C81C C8EC C9BC CA8C CB5C CC2C CCFC          @ZD00043*/ 06062000
*   /*                                                       @Z40LB40*/ 06063000
*   /* INPUT - NONE                                          @Z40LB40*/ 06064000
*   /*                                                       @Z40LB40*/ 06065000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE PST WORDS.        @Z40LB40*/ 06066000
*   /* EACH LINE WILL CONTAIN THE PST WORDS FOR EACH         @Z40LB40*/ 06067000
*   /* LUA FOR A SPECIFIC PAGE.                              @Z40LB40*/ 06068000
*   /*                                                               */ 06069000
*   /*****************************************************************/ 06070000
*                                                                  1828 06071000
*PST:                                                              1828 06072000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 06073000
PST      DS    0H                                                  1829 06074000
*   RFY                                                            1829 06075000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06076000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 06077000
         LR    RETADDR3,REG14                                      1830 06078000
*   RFY                                                            1831 06079000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06080000
*   OLDERID2=NEWERID2;                                             1832 06081000
         L     @07,@PC00001                                        1832 06082000
         L     @04,GDTTR2(,@07)                                    1832 06083000
         MVC   @TS00001(95),NEWERID2(@04)                          1832 06084000
         MVC   OLDERID2(95,@04),@TS00001                           1832 06085000
*   NEWID2='DUCT';                  /*                       @Z40LB40*/ 06086000
*                                                                  1833 06087000
         MVC   NEWID2(4,@04),@CC01667                              1833 06088000
*   /*****************************************************************/ 06089000
*   /*                                                               */ 06090000
*   /* ISSUE UPRINT FOR PST HEADERS FOR STAGING              @Z40LB40*/ 06091000
*   /* DRIVE GROUP 0                                         @Z40LB40*/ 06092000
*   /*                                                               */ 06093000
*   /*****************************************************************/ 06094000
*                                                                  1834 06095000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 06096000
         XC    PRINTAB(44),PRINTAB                                 1834 06097000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 06098000
         L     @04,DDSTRU                                          1835 06099000
         MVC   DARGSMOD(3,@04),@CC01334                            1835 06100000
*   DARGSENT=HPST;                  /*                       @Z40LB40*/ 06101000
         MVI   DARGSENT(@04),X'2E'                                 1836 06102000
*   DARGCNT=1;                      /*                       @Z40LB40*/ 06103000
         LA    @15,1                                               1837 06104000
         STH   @15,DARGCNT(,@04)                                   1837 06105000
*   DARGINS(1)=1;                   /*                       @Z40LB40*/ 06106000
         STH   @15,DARGINS(,@04)                                   1838 06107000
*   DARGINL(1)=LENGTH(SDG0);        /*                       @Z40LB40*/ 06108000
         STH   @15,DARGINL(,@04)                                   1839 06109000
*   DARGDTM(1)=ADDR(SDG0);          /*                       @Z40LB40*/ 06110000
         LA    @15,@CH00118+1                                      1840 06111000
         ST    @15,DARGDTM(,@04)                                   1840 06112000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 06113000
*                                                                  1841 06114000
         ST    @07,@AL00001                                        1841 06115000
         LA    @04,PRPTR                                           1841 06116000
         ST    @04,@AL00001+4                                      1841 06117000
         LA    @04,DDSTRU                                          1841 06118000
         ST    @04,@AL00001+8                                      1841 06119000
         MVI   @AL00001+8,X'80'                                    1841 06120000
         L     @15,GDTPRT(,@07)                                    1841 06121000
         LA    @01,@AL00001                                        1841 06122000
         BALR  @14,@15                                             1841 06123000
*   /*****************************************************************/ 06124000
*   /*                                                               */ 06125000
*   /* PRINT PST VALUES FOR STAGING DRIVE GROUP 0            @Z40LB40*/ 06126000
*   /*                                                               */ 06127000
*   /*****************************************************************/ 06128000
*                                                                  1842 06129000
*   PRSTART=MEMPTR+'10000'X;        /* SET START ADDR.       @ZD00043*/ 06130000
         L     PRSTART,@CF01515                                    1842 06131000
         AL    PRSTART,MEMPTR                                      1842 06132000
*   DO I3=0 TO 51;                  /* PRINT 52 LINES        @Z40LB40*/ 06133000
         SLR   I3,I3                                               1843 06134000
@DL01843 DS    0H                                                  1844 06135000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 06136000
         MVI   PRINTLN+1,C' '                                      1844 06137000
         MVC   PRINTLN+2(119),PRINTLN+1                            1844 06138000
         MVI   PRINTLN,C' '                                        1844 06139000
*     IF I3//10=0 THEN              /* TEST FOR TEN LINES    @Z40LB40*/ 06140000
         LR    @00,I3                                              1845 06141000
         SRDA  @00,32                                              1845 06142000
         D     @00,@CF00480                                        1845 06143000
         LTR   @00,@00                                             1845 06144000
         BNZ   @RF01845                                            1845 06145000
*       PRINTLNA=DOUBLESP;          /* DOUBLE SPACE AFTER    @Z40LB40   06146000
*                                      TEN LINES             @Z40LB40*/ 06147000
         MVI   PRINTLNA,C'0'                                       1846 06148000
*     CVD(I3,DOUBLEWD);             /* CONVERT PAGE NO.      @Z40LB40*/ 06149000
@RF01845 CVD   I3,DOUBLEWD                                         1847 06150000
*     DOUBLEWD(8:8)=DOUBLEWD(8:8)|'0F'X;/* FORCE F SIGN      @Z40LB40*/ 06151000
         OI    DOUBLEWD+7,X'0F'                                    1848 06152000
*     UNPK(PRINTLNB(2:3),DOUBLEWD(7:8));/* UNPK PAGE NO.     @Z40LB40*/ 06153000
         UNPK  PRINTLNB+1(2),DOUBLEWD+6(2)                         1849 06154000
*     PRLNPTR=6;                    /* INIT LINE POINTER     @Z40LB40*/ 06155000
         LA    PRLNPTR,6                                           1850 06156000
*     DO J3=1 TO 8;                 /* PRINT 8 WORDS         @Z40LB40*/ 06157000
         LA    J3,1                                                1851 06158000
@DL01851 DS    0H                                                  1852 06159000
*       UNPK(PRWORK,PRAREA);        /* UNPK LUA VALUE        @Z40LB40*/ 06160000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1852 06161000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 06162000
         TR    PRWORK(8),TABLE                                     1853 06163000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* VALUE TO LINE  @Z40LB40*/ 06164000
         LA    @02,PRINTLNB-1(PRLNPTR)                             1854 06165000
         MVC   0(8,@02),PRWORK                                     1854 06166000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 06167000
         AL    PRLNPTR,@CF01152                                    1855 06168000
*       PRSTART=PRSTART+'D0'X;      /* BUMP ADDRESS          @Z40LB40*/ 06169000
         AL    PRSTART,@CF01670                                    1856 06170000
*     END;                          /*                       @Z40LB40*/ 06171000
         AL    J3,@CF00223                                         1857 06172000
         C     J3,@CF00183                                         1857 06173000
         BNH   @DL01851                                            1857 06174000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 06175000
         BAL   @14,DOUPRINT                                        1858 06176000
*     PRSTART=PRSTART-'0680'X+4;    /* RESET START ADDRESS   @Z40LB40*/ 06177000
         AL    PRSTART,@CF01747                                    1859 06178000
*   END;                            /*                       @Z40LB40*/ 06179000
*                                                                  1860 06180000
         AL    I3,@CF00223                                         1860 06181000
         C     I3,@CF01668                                         1860 06182000
         BNH   @DL01843                                            1860 06183000
*   /*****************************************************************/ 06184000
*   /*                                                               */ 06185000
*   /* ISSUE UPRINT FOR PST HEADERS FOR STAGING              @Z40LB40*/ 06186000
*   /* DRIVE GROUP 1                                         @Z40LB40*/ 06187000
*   /*                                                               */ 06188000
*   /*****************************************************************/ 06189000
*                                                                  1861 06190000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 06191000
         XC    PRINTAB(44),PRINTAB                                 1861 06192000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 06193000
         L     @07,DDSTRU                                          1862 06194000
         MVC   DARGSMOD(3,@07),@CC01334                            1862 06195000
*   DARGSENT=HPST;                  /*                       @Z40LB40*/ 06196000
         MVI   DARGSENT(@07),X'2E'                                 1863 06197000
*   DARGCNT=1;                      /*                       @Z40LB40*/ 06198000
         LA    @04,1                                               1864 06199000
         STH   @04,DARGCNT(,@07)                                   1864 06200000
*   DARGINS(1)=1;                   /*                       @Z40LB40*/ 06201000
         STH   @04,DARGINS(,@07)                                   1865 06202000
*   DARGINL(1)=LENGTH(SDG1);        /*                       @Z40LB40*/ 06203000
         STH   @04,DARGINL(,@07)                                   1866 06204000
*   DARGDTM(1)=ADDR(SDG1);          /*                       @Z40LB40*/ 06205000
         LA    @04,@CH00223+1                                      1867 06206000
         ST    @04,DARGDTM(,@07)                                   1867 06207000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 06208000
*                                                                  1868 06209000
         L     @07,@PC00001                                        1868 06210000
         ST    @07,@AL00001                                        1868 06211000
         LA    @04,PRPTR                                           1868 06212000
         ST    @04,@AL00001+4                                      1868 06213000
         LA    @04,DDSTRU                                          1868 06214000
         ST    @04,@AL00001+8                                      1868 06215000
         MVI   @AL00001+8,X'80'                                    1868 06216000
         L     @15,GDTPRT(,@07)                                    1868 06217000
         LA    @01,@AL00001                                        1868 06218000
         BALR  @14,@15                                             1868 06219000
*   /*****************************************************************/ 06220000
*   /*                                                               */ 06221000
*   /* PRINT PST VALUES FOR STAGING DRIVE GROUP 1            @Z40LB40*/ 06222000
*   /*                                                               */ 06223000
*   /*****************************************************************/ 06224000
*                                                                  1869 06225000
*   PRSTART=MEMPTR+'10680'X;        /* SET START ADDR.       @ZD00043*/ 06226000
         L     PRSTART,@CF01672                                    1869 06227000
         AL    PRSTART,MEMPTR                                      1869 06228000
*   DO I3=0 TO 51;                  /* PRINT 52 LINES        @Z40LB40*/ 06229000
         SLR   I3,I3                                               1870 06230000
@DL01870 DS    0H                                                  1871 06231000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 06232000
         MVI   PRINTLN+1,C' '                                      1871 06233000
         MVC   PRINTLN+2(119),PRINTLN+1                            1871 06234000
         MVI   PRINTLN,C' '                                        1871 06235000
*     IF I3//10=0 THEN              /* TEST FOR TEN LINES    @Z40LB40*/ 06236000
         LR    @00,I3                                              1872 06237000
         SRDA  @00,32                                              1872 06238000
         D     @00,@CF00480                                        1872 06239000
         LTR   @00,@00                                             1872 06240000
         BNZ   @RF01872                                            1872 06241000
*       PRINTLNA=DOUBLESP;          /* DOUBLE SPACE AFTER    @Z40LB40   06242000
*                                      TEN LINES             @Z40LB40*/ 06243000
         MVI   PRINTLNA,C'0'                                       1873 06244000
*     CVD(I3,DOUBLEWD);             /* CONVERT PAGE NO.      @Z40LB40*/ 06245000
@RF01872 CVD   I3,DOUBLEWD                                         1874 06246000
*     DOUBLEWD(8:8)=DOUBLEWD(8:8)|'0F'X;/* FORCE F SIGN      @Z40LB40*/ 06247000
         OI    DOUBLEWD+7,X'0F'                                    1875 06248000
*     UNPK(PRINTLNB(2:3),DOUBLEWD(7:8));/* UNPK PAGE NO.     @Z40LB40*/ 06249000
         UNPK  PRINTLNB+1(2),DOUBLEWD+6(2)                         1876 06250000
*     PRLNPTR=6;                    /* INIT LINE POINTER     @Z40LB40*/ 06251000
         LA    PRLNPTR,6                                           1877 06252000
*     DO J3=1 TO 8;                 /* PRINT 8 WORDS         @Z40LB40*/ 06253000
         LA    J3,1                                                1878 06254000
@DL01878 DS    0H                                                  1879 06255000
*       UNPK(PRWORK,PRAREA);        /* UNPK LUA VALUE        @Z40LB40*/ 06256000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1879 06257000
*       TR(PRWORK(1:8),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 06258000
         TR    PRWORK(8),TABLE                                     1880 06259000
*       PRINTLNB(PRLNPTR:PRLNPTR+7)=PRWORK;/* VALUE TO LINE  @Z40LB40*/ 06260000
         LA    @02,PRINTLNB-1(PRLNPTR)                             1881 06261000
         MVC   0(8,@02),PRWORK                                     1881 06262000
*       PRLNPTR=PRLNPTR+9;          /* BUMP LINE POINTER     @Z40LB40*/ 06263000
         AL    PRLNPTR,@CF01152                                    1882 06264000
*       PRSTART=PRSTART+'D0'X;      /* BUMP ADDRESS          @Z40LB40*/ 06265000
         AL    PRSTART,@CF01670                                    1883 06266000
*     END;                          /*                       @Z40LB40*/ 06267000
         AL    J3,@CF00223                                         1884 06268000
         C     J3,@CF00183                                         1884 06269000
         BNH   @DL01878                                            1884 06270000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 06271000
         BAL   @14,DOUPRINT                                        1885 06272000
*     PRSTART=PRSTART-'0680'X+4;    /* RESET START ADDRESS   @Z40LB40*/ 06273000
         AL    PRSTART,@CF01747                                    1886 06274000
*   END;                            /*                       @Z40LB40*/ 06275000
         AL    I3,@CF00223                                         1887 06276000
         C     I3,@CF01668                                         1887 06277000
         BNH   @DL01870                                            1887 06278000
*   RFY                                                            1888 06279000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06280000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 06281000
         LR    REG14,RETADDR3                                      1889 06282000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 06283000
@EL00025 DS    0H                                                  1890 06284000
@EF00025 DS    0H                                                  1890 06285000
@ER00025 BR    @14                                                 1890 06286000
*   RFY                                                            1891 06287000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06288000
*   END PST;                        /*                       @Z40LB40*/ 06289000
*                                                                  1893 06290000
*   /*****************************************************************/ 06291000
*   /*                                                               */ 06292000
*   /* PROCEDURE NAME - LRU (LEVEL 3)                        @Z40LB40*/ 06293000
*   /*                                                       @Z40LB40*/ 06294000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING            @Z40LB40*/ 06295000
*   /* ADAPTER LEAST RECENTLY USED(LRU) CLOCK VALUES         @Z40LB40*/ 06296000
*   /* FOR STAGING DRIVE GROUPS 0 AND 1.                     @Z40LB40*/ 06297000
*   /* THE FOLLOWING SHOWS HOW EACH LRU AREA IS              @Z40LB40*/ 06298000
*   /* STRUCTURED. THE FOUR CHARACTER VALUES SHOWN           @Z40LB40*/ 06299000
*   /* ARE THE ACTUAL SECTOR ADDRESS OF EACH BYTE            @Z40LB40*/ 06300000
*   /* IN THE LRU AREAS.                                     @Z40LB40*/ 06301000
*   /* STAGING DRIVE GROUP 0                                 @Z40LB40*/ 06302000
*   /* PAGE LUA0 LUA1 LUA2 LUA3 LUA4 LUA5 LUA6 LUA7          @Z40LB40*/ 06303000
*   /* .00. 6500 6534 6568 659C 65D0 6604 6638 666C          @Z40LB40*/ 06304000
*   /* .01. 6501 6535 6569 659D 65D1 6605 6639 666D          @Z40LB40*/ 06305000
*   /* ....                                                  @Z40LB40*/ 06306000
*   /* .51. 6533 6567 659B 65CF 6603 6637 666B 669F          @Z40LB40*/ 06307000
*   /* STAGING DRIVE GROUP 1                                 @Z40LB40*/ 06308000
*   /* PAGE LUA0 LUA1 LUA2 LUA3 LUA4 LUA5 LUA6 LUA7          @Z40LB40*/ 06309000
*   /* .00. 66A0 66D4 6708 673C 6770 67A4 67D8 680C          @Z40LB40*/ 06310000
*   /* .01. 66A1 66D5 6709 673D 6771 67A5 67D9 680D          @Z40LB40*/ 06311000
*   /* ....                                                  @Z40LB40*/ 06312000
*   /* .51. 66D3 6707 673B 676F 67A3 67D7 680B 683F          @Z40LB40*/ 06313000
*   /*                                                       @Z40LB40*/ 06314000
*   /* INPUT - NONE                                          @Z40LB40*/ 06315000
*   /*                                                       @Z40LB40*/ 06316000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE LRU BYTES.        @Z40LB40*/ 06317000
*   /* EACH LINE WILL CONTAIN THE LRU BYTES FOR EACH         @Z40LB40*/ 06318000
*   /* LUA FOR A SPECIFIC PAGE.                              @Z40LB40*/ 06319000
*   /*                                                               */ 06320000
*   /*****************************************************************/ 06321000
*                                                                  1893 06322000
*LRU:                                                              1893 06323000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 06324000
LRU      DS    0H                                                  1894 06325000
*   RFY                                                            1894 06326000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06327000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 06328000
         LR    RETADDR3,REG14                                      1895 06329000
*   RFY                                                            1896 06330000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06331000
*   OLDERID2=NEWERID2;                                             1897 06332000
         L     @07,@PC00001                                        1897 06333000
         L     @04,GDTTR2(,@07)                                    1897 06334000
         MVC   @TS00001(95),NEWERID2(@04)                          1897 06335000
         MVC   OLDERID2(95,@04),@TS00001                           1897 06336000
*   NEWID2='DUCU';                  /*                       @Z40LB40*/ 06337000
*                                                                  1898 06338000
         MVC   NEWID2(4,@04),@CC01676                              1898 06339000
*   /*****************************************************************/ 06340000
*   /*                                                               */ 06341000
*   /* ISSUE UPRINT FOR LRU HEADERS FOR STAGING              @Z40LB40*/ 06342000
*   /* DRIVE GROUP 0                                         @Z40LB40*/ 06343000
*   /*                                                               */ 06344000
*   /*****************************************************************/ 06345000
*                                                                  1899 06346000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 06347000
         XC    PRINTAB(44),PRINTAB                                 1899 06348000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 06349000
         L     @04,DDSTRU                                          1900 06350000
         MVC   DARGSMOD(3,@04),@CC01334                            1900 06351000
*   DARGSENT=HLRU;                  /*                       @Z40LB40*/ 06352000
         MVI   DARGSENT(@04),X'2F'                                 1901 06353000
*   DARGCNT=1;                      /*                       @Z40LB40*/ 06354000
         LA    @15,1                                               1902 06355000
         STH   @15,DARGCNT(,@04)                                   1902 06356000
*   DARGINS(1)=1;                   /*                       @Z40LB40*/ 06357000
         STH   @15,DARGINS(,@04)                                   1903 06358000
*   DARGINL(1)=LENGTH(SDG0);        /*                       @Z40LB40*/ 06359000
         STH   @15,DARGINL(,@04)                                   1904 06360000
*   DARGDTM(1)=ADDR(SDG0);          /*                       @Z40LB40*/ 06361000
         LA    @15,@CH00118+1                                      1905 06362000
         ST    @15,DARGDTM(,@04)                                   1905 06363000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 06364000
*                                                                  1906 06365000
         ST    @07,@AL00001                                        1906 06366000
         LA    @04,PRPTR                                           1906 06367000
         ST    @04,@AL00001+4                                      1906 06368000
         LA    @04,DDSTRU                                          1906 06369000
         ST    @04,@AL00001+8                                      1906 06370000
         MVI   @AL00001+8,X'80'                                    1906 06371000
         L     @15,GDTPRT(,@07)                                    1906 06372000
         LA    @01,@AL00001                                        1906 06373000
         BALR  @14,@15                                             1906 06374000
*   /*****************************************************************/ 06375000
*   /*                                                               */ 06376000
*   /* PRINT LRU VALUES FOR STAGING DRIVE GROUP 0            @Z40LB40*/ 06377000
*   /*                                                               */ 06378000
*   /*****************************************************************/ 06379000
*                                                                  1907 06380000
*   PRSTART=MEMPTR+'6500'X;         /* SET START ADDR.       @Z40LB40*/ 06381000
         L     PRSTART,@CF01677                                    1907 06382000
         AL    PRSTART,MEMPTR                                      1907 06383000
*   DO I3=0 TO 51;                  /* PRINT 52 LINES        @Z40LB40*/ 06384000
         SLR   I3,I3                                               1908 06385000
@DL01908 DS    0H                                                  1909 06386000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 06387000
         MVI   PRINTLN+1,C' '                                      1909 06388000
         MVC   PRINTLN+2(119),PRINTLN+1                            1909 06389000
         MVI   PRINTLN,C' '                                        1909 06390000
*     IF I3//10=0 THEN              /* TEST FOR TEN LINES    @Z40LB40*/ 06391000
         LR    @00,I3                                              1910 06392000
         SRDA  @00,32                                              1910 06393000
         D     @00,@CF00480                                        1910 06394000
         LTR   @00,@00                                             1910 06395000
         BNZ   @RF01910                                            1910 06396000
*       PRINTLNA=DOUBLESP;          /* DOUBLE SPACE AFTER    @Z40LB40   06397000
*                                      TEN LINES             @Z40LB40*/ 06398000
         MVI   PRINTLNA,C'0'                                       1911 06399000
*     CVD(I3,DOUBLEWD);             /* CONVERT PAGE NO.      @Z40LB40*/ 06400000
@RF01910 CVD   I3,DOUBLEWD                                         1912 06401000
*     DOUBLEWD(8:8)=DOUBLEWD(8:8)|'0F'X;/* FORCE F SIGN      @Z40LB40*/ 06402000
         OI    DOUBLEWD+7,X'0F'                                    1913 06403000
*     UNPK(PRINTLNB(2:3),DOUBLEWD(7:8));/* UNPK PAGE NO.     @Z40LB40*/ 06404000
         UNPK  PRINTLNB+1(2),DOUBLEWD+6(2)                         1914 06405000
*     PRLNPTR=7;                    /* INIT LINE POINTER     @Z40LB40*/ 06406000
         LA    PRLNPTR,7                                           1915 06407000
*     DO J3=1 TO 8;                 /* PRINT 8 BYTES         @Z40LB40*/ 06408000
         LA    J3,1                                                1916 06409000
@DL01916 DS    0H                                                  1917 06410000
*       UNPK(PRWORK,PRAREA);        /* UNPK LUA VALUE        @Z40LB40*/ 06411000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1917 06412000
*       TR(PRWORK(1:2),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 06413000
         TR    PRWORK(2),TABLE                                     1918 06414000
*       PRINTLNB(PRLNPTR:PRLNPTR+1)=PRWORK;/* VALUE TO LINE  @Z40LB40*/ 06415000
         LA    @02,PRINTLNB-1(PRLNPTR)                             1919 06416000
         MVC   0(2,@02),PRWORK                                     1919 06417000
*       PRLNPTR=PRLNPTR+5;          /* BUMP LINE POINTER     @Z40LB40*/ 06418000
         AL    PRLNPTR,@CF00299                                    1920 06419000
*       PRSTART=PRSTART+'34'X;      /* BUMP ADDRESS          @Z40LB40*/ 06420000
         AL    PRSTART,@CF01678                                    1921 06421000
*     END;                          /*                       @Z40LB40*/ 06422000
         AL    J3,@CF00223                                         1922 06423000
         C     J3,@CF00183                                         1922 06424000
         BNH   @DL01916                                            1922 06425000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 06426000
         BAL   @14,DOUPRINT                                        1923 06427000
*     PRSTART=PRSTART-'01A0'X+1;    /* RESET START ADDRESS   @Z40LB40*/ 06428000
         AL    PRSTART,@CF01748                                    1924 06429000
*   END;                            /*                       @Z40LB40*/ 06430000
*                                                                  1925 06431000
         AL    I3,@CF00223                                         1925 06432000
         C     I3,@CF01668                                         1925 06433000
         BNH   @DL01908                                            1925 06434000
*   /*****************************************************************/ 06435000
*   /*                                                               */ 06436000
*   /* ISSUE UPRINT FOR LRU HEADERS FOR STAGING              @Z40LB40*/ 06437000
*   /* DRIVE GROUP 1                                         @Z40LB40*/ 06438000
*   /*                                                               */ 06439000
*   /*****************************************************************/ 06440000
*                                                                  1926 06441000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 06442000
         XC    PRINTAB(44),PRINTAB                                 1926 06443000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 06444000
         L     @07,DDSTRU                                          1927 06445000
         MVC   DARGSMOD(3,@07),@CC01334                            1927 06446000
*   DARGSENT=HLRU;                  /*                       @Z40LB40*/ 06447000
         MVI   DARGSENT(@07),X'2F'                                 1928 06448000
*   DARGCNT=1;                      /*                       @Z40LB40*/ 06449000
         LA    @04,1                                               1929 06450000
         STH   @04,DARGCNT(,@07)                                   1929 06451000
*   DARGINS(1)=1;                   /*                       @Z40LB40*/ 06452000
         STH   @04,DARGINS(,@07)                                   1930 06453000
*   DARGINL(1)=LENGTH(SDG1);        /*                       @Z40LB40*/ 06454000
         STH   @04,DARGINL(,@07)                                   1931 06455000
*   DARGDTM(1)=ADDR(SDG1);          /*                       @Z40LB40*/ 06456000
         LA    @04,@CH00223+1                                      1932 06457000
         ST    @04,DARGDTM(,@07)                                   1932 06458000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 06459000
*                                                                  1933 06460000
         L     @07,@PC00001                                        1933 06461000
         ST    @07,@AL00001                                        1933 06462000
         LA    @04,PRPTR                                           1933 06463000
         ST    @04,@AL00001+4                                      1933 06464000
         LA    @04,DDSTRU                                          1933 06465000
         ST    @04,@AL00001+8                                      1933 06466000
         MVI   @AL00001+8,X'80'                                    1933 06467000
         L     @15,GDTPRT(,@07)                                    1933 06468000
         LA    @01,@AL00001                                        1933 06469000
         BALR  @14,@15                                             1933 06470000
*   /*****************************************************************/ 06471000
*   /*                                                               */ 06472000
*   /* PRINT LRU VALUES FOR STAGING DRIVE GROUP 1            @Z40LB40*/ 06473000
*   /*                                                               */ 06474000
*   /*****************************************************************/ 06475000
*                                                                  1934 06476000
*   PRSTART=MEMPTR+'66A0'X;         /* SET START ADDR.       @Z40LB40*/ 06477000
         L     PRSTART,@CF01680                                    1934 06478000
         AL    PRSTART,MEMPTR                                      1934 06479000
*   DO I3=0 TO 51;                  /* PRINT 52 LINES        @Z40LB40*/ 06480000
         SLR   I3,I3                                               1935 06481000
@DL01935 DS    0H                                                  1936 06482000
*     PRINTLN=' ';                  /* BLANK PRINT LINE      @Z40LB40*/ 06483000
         MVI   PRINTLN+1,C' '                                      1936 06484000
         MVC   PRINTLN+2(119),PRINTLN+1                            1936 06485000
         MVI   PRINTLN,C' '                                        1936 06486000
*     IF I3//10=0 THEN              /* TEST FOR TEN LINES    @Z40LB40*/ 06487000
         LR    @00,I3                                              1937 06488000
         SRDA  @00,32                                              1937 06489000
         D     @00,@CF00480                                        1937 06490000
         LTR   @00,@00                                             1937 06491000
         BNZ   @RF01937                                            1937 06492000
*       PRINTLNA=DOUBLESP;          /* DOUBLE SPACE AFTER    @Z40LB40   06493000
*                                      TEN LINES             @Z40LB40*/ 06494000
         MVI   PRINTLNA,C'0'                                       1938 06495000
*     CVD(I3,DOUBLEWD);             /* CONVERT PAGE NO.      @Z40LB40*/ 06496000
@RF01937 CVD   I3,DOUBLEWD                                         1939 06497000
*     DOUBLEWD(8:8)=DOUBLEWD(8:8)|'0F'X;/* FORCE F SIGN      @Z40LB40*/ 06498000
         OI    DOUBLEWD+7,X'0F'                                    1940 06499000
*     UNPK(PRINTLNB(2:3),DOUBLEWD(7:8));/* UNPK PAGE NO.     @Z40LB40*/ 06500000
         UNPK  PRINTLNB+1(2),DOUBLEWD+6(2)                         1941 06501000
*     PRLNPTR=7;                    /* INIT LINE POINTER     @Z40LB40*/ 06502000
         LA    PRLNPTR,7                                           1942 06503000
*     DO J3=1 TO 8;                 /* PRINT 8 BYTES         @Z40LB40*/ 06504000
         LA    J3,1                                                1943 06505000
@DL01943 DS    0H                                                  1944 06506000
*       UNPK(PRWORK,PRAREA);        /* UNPK LUA VALUE        @Z40LB40*/ 06507000
         UNPK  PRWORK(9),PRAREA(5,PRSTART)                         1944 06508000
*       TR(PRWORK(1:2),TABLE);      /* TR TO EBCDIC          @Z40LB40*/ 06509000
         TR    PRWORK(2),TABLE                                     1945 06510000
*       PRINTLNB(PRLNPTR:PRLNPTR+1)=PRWORK;/* VALUE TO LINE  @Z40LB40*/ 06511000
         LA    @02,PRINTLNB-1(PRLNPTR)                             1946 06512000
         MVC   0(2,@02),PRWORK                                     1946 06513000
*       PRLNPTR=PRLNPTR+5;          /* BUMP LINE POINTER     @Z40LB40*/ 06514000
         AL    PRLNPTR,@CF00299                                    1947 06515000
*       PRSTART=PRSTART+'34'X;      /* BUMP ADDRESS          @Z40LB40*/ 06516000
         AL    PRSTART,@CF01678                                    1948 06517000
*     END;                          /*                       @Z40LB40*/ 06518000
         AL    J3,@CF00223                                         1949 06519000
         C     J3,@CF00183                                         1949 06520000
         BNH   @DL01943                                            1949 06521000
*     CALL DOUPRINT;                /* GO PRINT LINE         @Z40LB40*/ 06522000
         BAL   @14,DOUPRINT                                        1950 06523000
*     PRSTART=PRSTART-'01A0'X+1;    /* RESET START ADDRESS   @Z40LB40*/ 06524000
         AL    PRSTART,@CF01748                                    1951 06525000
*   END;                            /*                       @Z40LB40*/ 06526000
         AL    I3,@CF00223                                         1952 06527000
         C     I3,@CF01668                                         1952 06528000
         BNH   @DL01935                                            1952 06529000
*   RFY                                                            1953 06530000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06531000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 06532000
         LR    REG14,RETADDR3                                      1954 06533000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 06534000
@EL00026 DS    0H                                                  1955 06535000
@EF00026 DS    0H                                                  1955 06536000
@ER00026 BR    @14                                                 1955 06537000
*   RFY                                                            1956 06538000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06539000
*   END LRU;                        /*                       @Z40LB40*/ 06540000
*                                                                  1958 06541000
*   /*****************************************************************/ 06542000
*   /*                                                               */ 06543000
*   /* PROCEDURE NAME - SASTATUS (LEVEL 3)                   @Z40LB40*/ 06544000
*   /*                                                       @Z40LB40*/ 06545000
*   /* FUNCTION - THIS ROUTINE PRINTS THE STAGING            @Z40LB40*/ 06546000
*   /* ADAPTER GENERAL STATUS INFORMATION SECTOR.            @Z40LB40*/ 06547000
*   /*                                                       @Z40LB40*/ 06548000
*   /* INPUT - NONE                                          @Z40LB40*/ 06549000
*   /*                                                       @Z40LB40*/ 06550000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE STATUS            @Z40LB40*/ 06551000
*   /* INFORMATION SECTOR. SEE REFERENCES TO SECTADDR        @Z40LB40*/ 06552000
*   /* FOR ACTUAL LOCATION OF THE SECTOR.                    @Z40LB40*/ 06553000
*   /*                                                               */ 06554000
*   /*****************************************************************/ 06555000
*                                                                  1958 06556000
*SASTATUS:                                                         1958 06557000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 06558000
SASTATUS DS    0H                                                  1959 06559000
*   RFY                                                            1959 06560000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06561000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 06562000
         LR    RETADDR3,REG14                                      1960 06563000
*   RFY                                                            1961 06564000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06565000
*   OLDERID2=NEWERID2;                                             1962 06566000
         L     @07,@PC00001                                        1962 06567000
         L     @02,GDTTR2(,@07)                                    1962 06568000
         MVC   @TS00001(95),NEWERID2(@02)                          1962 06569000
         MVC   OLDERID2(95,@02),@TS00001                           1962 06570000
*   NEWID2='DUCV';                  /*                       @Z40LB40*/ 06571000
*                                                                  1963 06572000
         MVC   NEWID2(4,@02),@CC01684                              1963 06573000
*   /*****************************************************************/ 06574000
*   /*                                                               */ 06575000
*   /* ISSUE UPRINT FOR STATUS INFORMATION HEADER            @Z40LB40*/ 06576000
*   /*                                                               */ 06577000
*   /*****************************************************************/ 06578000
*                                                                  1964 06579000
*   PRINTAB=''B;                    /*                       @Z40LB40*/ 06580000
         XC    PRINTAB(44),PRINTAB                                 1964 06581000
*   DARGSMOD=DUMSGMOD;              /*                       @Z40LB40*/ 06582000
         L     @02,DDSTRU                                          1965 06583000
         MVC   DARGSMOD(3,@02),@CC01334                            1965 06584000
*   DARGSENT=HSTATUS;               /*                       @Z40LB40*/ 06585000
         MVI   DARGSENT(@02),X'2D'                                 1966 06586000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @Z40LB40*/ 06587000
         ST    @07,@AL00001                                        1967 06588000
         LA    @02,PRPTR                                           1967 06589000
         ST    @02,@AL00001+4                                      1967 06590000
         LA    @02,DDSTRU                                          1967 06591000
         ST    @02,@AL00001+8                                      1967 06592000
         MVI   @AL00001+8,X'80'                                    1967 06593000
         L     @15,GDTPRT(,@07)                                    1967 06594000
         LA    @01,@AL00001                                        1967 06595000
         BALR  @14,@15                                             1967 06596000
*   SECTADDR='0600'X;               /* SET SECTOR ADDRESS    @Z40LB40*/ 06597000
         LA    SECTADDR,1536                                       1968 06598000
*   NUMBYTES=SECTSIZE;              /* SET NO. OF BYTES      @Z40LB40*/ 06599000
         MVC   NUMBYTES(4),@CF01321                                1969 06600000
*   CALL PRNTSECT;                  /* PRINT STATUS INFO     @Z40LB40*/ 06601000
         BAL   @14,PRNTSECT                                        1970 06602000
*   RFY                                                            1971 06603000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06604000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @Z40LB40*/ 06605000
         LR    REG14,RETADDR3                                      1972 06606000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 06607000
@EL00027 DS    0H                                                  1973 06608000
@EF00027 DS    0H                                                  1973 06609000
@ER00027 BR    @14                                                 1973 06610000
*   RFY                                                            1974 06611000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06612000
*   END SASTATUS;                   /*                       @Z40LB40*/ 06613000
*                                                                  1976 06614000
*   /*****************************************************************/ 06615000
*   /*                                                               */ 06616000
*   /* PROCEDURE NAME - DOUPRINT (LEVEL 5)                   @Z40LB40*/ 06617000
*   /*                                                       @Z40LB40*/ 06618000
*   /* FUNCTION - THIS ROUTINE BUILDS A DARGLIST             @Z40LB40*/ 06619000
*   /* A FMTLIST AND ISSUES UPRINT FOR A PREVIOUSLY          @Z40LB40*/ 06620000
*   /* CONSTRUCTED PRINT LINE.                               @Z40LB40*/ 06621000
*   /*                                                       @Z40LB40*/ 06622000
*   /* INPUT - PRINT LINE LOCATED AT PRINTLN.                @Z40LB40*/ 06623000
*   /*                                                       @Z40LB40*/ 06624000
*   /* OUTPUT - THE PRINT LINE                               @Z40LB40*/ 06625000
*   /*                                                               */ 06626000
*   /*****************************************************************/ 06627000
*                                                                  1976 06628000
*DOUPRINT:                                                         1976 06629000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40LB40*/ 06630000
DOUPRINT DS    0H                                                  1977 06631000
*   RFY                                                            1977 06632000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06633000
*   RETADDR5=REG14;                 /* SAVE RETURN ADDR.     @Z40LB40*/ 06634000
         LR    RETADDR5,REG14                                      1978 06635000
*   RFY                                                            1979 06636000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06637000
*   OLDERID2=NEWERID2;                                             1980 06638000
         L     @02,@PC00001                                        1980 06639000
         L     @02,GDTTR2(,@02)                                    1980 06640000
         MVC   @TS00001(95),NEWERID2(@02)                          1980 06641000
         MVC   OLDERID2(95,@02),@TS00001                           1980 06642000
*   NEWID2='DUEA';                  /*                       @Z40LB40*/ 06643000
         MVC   NEWID2(4,@02),@CC01689                              1981 06644000
*   FSADDR=ADDR(FORMLIST);          /* INIT FMTLIST PTR      @Z40LB40*/ 06645000
         LA    @02,FORMLIST                                        1982 06646000
         ST    @02,FSADDR                                          1982 06647000
*   FORMLIST=''B;                   /* CLEAR FMTLIST         @Z40LB40*/ 06648000
         XC    FORMLIST(20),FORMLIST                               1983 06649000
*   FMTSCF=ON;                      /* INDICATE SPACING      @Z40LB40*/ 06650000
         OI    FMTSCF(@02),B'01000000'                             1984 06651000
*   IF PRINTLNA=DOUBLESP THEN       /* IS THIS 2 SPACES      @Z40LB40*/ 06652000
         CLI   PRINTLNA,C'0'                                       1985 06653000
         BNE   @RF01985                                            1985 06654000
*     FMTSPF=2;                     /* YES,SET TO 2 SPACES   @Z40LB40*/ 06655000
         MVC   FMTSPF(2,@02),@CH00157                              1986 06656000
*   ELSE                                                           1987 06657000
*     FMTSPF=1;                     /* NO,SET TO 1 SPACE     @Z40LB40*/ 06658000
         B     @RC01985                                            1987 06659000
@RF01985 L     @02,FSADDR                                          1987 06660000
         MVC   FMTSPF(2,@02),@CH00223                              1987 06661000
*   FMTSPT='R';                     /* RELATIVE SPACING      @Z40LB40*/ 06662000
@RC01985 L     @02,FSADDR                                          1988 06663000
         MVI   FMTSPT(@02),C'R'                                    1988 06664000
*   FSADDR=FSADDR+(ADDR(FMTOCOL)-ADDR(FMTFLGS));/*           @Z40LB40*/ 06665000
         AL    @02,@CF00160                                        1989 06666000
         ST    @02,FSADDR                                          1989 06667000
*   FMTEOLF=ON;                     /* LAST STRUCTURE        @Z40LB40*/ 06668000
*   FMTBDF=ON;                      /* BLOCK DATA            @Z40LB40*/ 06669000
         OI    FMTEOLF(@02),B'10010000'                            1991 06670000
*   FMTILEN=LENGTH(PRINTLNB);       /* INPUT LENGTH          @Z40LB40*/ 06671000
         LA    @15,120                                             1992 06672000
         STH   @15,FMTILEN(,@02)                                   1992 06673000
*   FMTOCOL=1;                      /* OUTPUT POSITION       @Z40LB40*/ 06674000
         MVC   FMTOCOL(2,@02),@CH00223                             1993 06675000
*   FMTOLEN=LENGTH(PRINTLNB);       /* OUTPUT LENGTH         @Z40LB40*/ 06676000
         STH   @15,FMTOLEN(,@02)                                   1994 06677000
*   FSADDR=ADDR(FORMLIST);          /* RESET FMLIST PTR      @Z40LB40*/ 06678000
         LA    @02,FORMLIST                                        1995 06679000
         ST    @02,FSADDR                                          1995 06680000
*   PRINTAB=''B;                    /* CLEAR DARGLIST        @Z40LB40*/ 06681000
         XC    PRINTAB(44),PRINTAB                                 1996 06682000
*   DARGDBP=ADDR(PRINTLNB);         /* BLOCK DATA PTR        @Z40LB40*/ 06683000
         L     @02,DDSTRU                                          1997 06684000
         LA    @14,PRINTLNB                                        1997 06685000
         ST    @14,DARGDBP(,@02)                                   1997 06686000
*   DARGILP=LENGTH(PRINTLNB);       /* LENGTH OF BLOCK       @Z40LB40*/ 06687000
*                                                                  1998 06688000
         STH   @15,DARGILP(,@02)                                   1998 06689000
*   /*****************************************************************/ 06690000
*   /*                                                               */ 06691000
*   /* ISSUE UPRINT WITH FMTLIST                             @Z40LB40*/ 06692000
*   /*                                                               */ 06693000
*   /*****************************************************************/ 06694000
*                                                                  1999 06695000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU,FSADDR);/* PRINT THE LINE    1999 06696000
*                                                            @Z40LB40*/ 06697000
         L     @02,@PC00001                                        1999 06698000
         ST    @02,@AL00001                                        1999 06699000
         LA    @15,PRPTR                                           1999 06700000
         ST    @15,@AL00001+4                                      1999 06701000
         LA    @15,DDSTRU                                          1999 06702000
         ST    @15,@AL00001+8                                      1999 06703000
         LA    @15,FSADDR                                          1999 06704000
         ST    @15,@AL00001+12                                     1999 06705000
         MVI   @AL00001+12,X'80'                                   1999 06706000
         L     @15,GDTPRT(,@02)                                    1999 06707000
         LA    @01,@AL00001                                        1999 06708000
         BALR  @14,@15                                             1999 06709000
*   RFY                                                            2000 06710000
*     REG14 RSTD;                   /* RESTRICT R14          @Z40LB40*/ 06711000
*   REG14=RETADDR5;                 /* RESET RETURN POINT    @Z40LB40*/ 06712000
         LR    REG14,RETADDR5                                      2001 06713000
*   RETURN;                         /* RETURN TO CALLER      @Z40LB40*/ 06714000
@EL00028 DS    0H                                                  2002 06715000
@EF00028 DS    0H                                                  2002 06716000
@ER00028 BR    @14                                                 2002 06717000
*   RFY                                                            2003 06718000
*     REG14 UNRSTD;                 /* FREE R14              @Z40LB40*/ 06719000
*   END DOUPRINT;                   /*                       @Z40LB40*/ 06720000
*                                                                  2005 06721000
*   /*****************************************************************/ 06722000
*   /*                                                               */ 06723000
*   /* PROCEDURE NAME - BAR (LEVEL 3)                        @ZD00050*/ 06724000
*   /*                                                       @ZD00050*/ 06725000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC BACKUP         @ZD00050*/ 06726000
*   /* ADDRESS REGISTER.                                     @ZD00050*/ 06727000
*   /*                                                       @ZD00050*/ 06728000
*   /* INPUT - NONE                                          @ZD00050*/ 06729000
*   /*                                                       @ZD00050*/ 06730000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE CONTENTS OF       @ZD00050*/ 06731000
*   /* THE REGISTER. SEE REFERENCES TO SECTADDR FOR ACTUAL   @ZD00050*/ 06732000
*   /* LOCATION OF THE DATA.                                 @ZD00050*/ 06733000
*   /*                                                               */ 06734000
*   /*****************************************************************/ 06735000
*                                                                  2005 06736000
*BAR:                                                              2005 06737000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZD00050*/ 06738000
BAR      DS    0H                                                  2006 06739000
*   RFY                                                            2006 06740000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06741000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @ZD00050*/ 06742000
         LR    RETADDR3,REG14                                      2007 06743000
*   RFY                                                            2008 06744000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06745000
*   OLDERID2=NEWERID2;                                             2009 06746000
         L     @07,@PC00001                                        2009 06747000
         L     @02,GDTTR2(,@07)                                    2009 06748000
         MVC   @TS00001(95),NEWERID2(@02)                          2009 06749000
         MVC   OLDERID2(95,@02),@TS00001                           2009 06750000
*   NEWID2='DUCW';                  /*                       @ZD00050*/ 06751000
*                                                                  2010 06752000
         MVC   NEWID2(4,@02),@CC01694                              2010 06753000
*   /*****************************************************************/ 06754000
*   /*                                                               */ 06755000
*   /* ISSUE UPRINT FOR BAR HEADER                           @ZD00050*/ 06756000
*   /*                                                               */ 06757000
*   /*****************************************************************/ 06758000
*                                                                  2011 06759000
*   PRINTAB=''B;                    /*                       @ZD00050*/ 06760000
         XC    PRINTAB(44),PRINTAB                                 2011 06761000
*   DARGSMOD=DUMSGMOD;              /*                       @ZD00050*/ 06762000
         L     @02,DDSTRU                                          2012 06763000
         MVC   DARGSMOD(3,@02),@CC01334                            2012 06764000
*   DARGSENT=HBAR;                  /*                       @ZD00050*/ 06765000
         MVI   DARGSENT(@02),X'13'                                 2013 06766000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @ZD00050*/ 06767000
         ST    @07,@AL00001                                        2014 06768000
         LA    @02,PRPTR                                           2014 06769000
         ST    @02,@AL00001+4                                      2014 06770000
         LA    @02,DDSTRU                                          2014 06771000
         ST    @02,@AL00001+8                                      2014 06772000
         MVI   @AL00001+8,X'80'                                    2014 06773000
         L     @15,GDTPRT(,@07)                                    2014 06774000
         LA    @01,@AL00001                                        2014 06775000
         BALR  @14,@15                                             2014 06776000
*   SECTADDR='04A8'X;               /* SET SECT ADDR.        @ZD00050*/ 06777000
         LA    SECTADDR,1192                                       2015 06778000
*   NUMBYTES=2;                     /* SET NO. OF BYTES      @ZD00050*/ 06779000
         MVC   NUMBYTES(4),@CF00157                                2016 06780000
*   CALL PRNTSECT;                  /* PRINT BAR             @ZD00050*/ 06781000
         BAL   @14,PRNTSECT                                        2017 06782000
*   RFY                                                            2018 06783000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06784000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @ZD00050*/ 06785000
         LR    REG14,RETADDR3                                      2019 06786000
*   RETURN;                         /* RETURN TO CALLER      @ZD00050*/ 06787000
@EL00029 DS    0H                                                  2020 06788000
@EF00029 DS    0H                                                  2020 06789000
@ER00029 BR    @14                                                 2020 06790000
*   RFY                                                            2021 06791000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06792000
*   END BAR;                        /*                       @ZD00050*/ 06793000
*                                                                  2023 06794000
*   /*****************************************************************/ 06795000
*   /*                                                               */ 06796000
*   /* PROCEDURE NAME - MSCEC (LEVEL 3)                      @ZD00050*/ 06797000
*   /*                                                       @ZD00050*/ 06798000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC ENGINEERING    @ZD00050*/ 06799000
*   /* CHANGE LEVEL.                                         @ZD00050*/ 06800000
*   /*                                                       @ZD00050*/ 06801000
*   /* INPUT - NONE                                          @ZD00050*/ 06802000
*   /*                                                       @ZD00050*/ 06803000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE MSC E.C.LEVEL.    @ZD00050*/ 06804000
*   /* SEE REFERENCES TO SECTADDR FOR ACTUAL LOCATION OF     @ZD00050*/ 06805000
*   /* THE DATA.                                             @ZD00050*/ 06806000
*   /*                                                               */ 06807000
*   /*****************************************************************/ 06808000
*                                                                  2023 06809000
*MSCEC:                                                            2023 06810000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZD00050*/ 06811000
MSCEC    DS    0H                                                  2024 06812000
*   RFY                                                            2024 06813000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06814000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @ZD00050*/ 06815000
         LR    RETADDR3,REG14                                      2025 06816000
*   RFY                                                            2026 06817000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06818000
*   OLDERID2=NEWERID2;                                             2027 06819000
         L     @07,@PC00001                                        2027 06820000
         L     @02,GDTTR2(,@07)                                    2027 06821000
         MVC   @TS00001(95),NEWERID2(@02)                          2027 06822000
         MVC   OLDERID2(95,@02),@TS00001                           2027 06823000
*   NEWID2='DUCX';                  /*                       @ZD00050*/ 06824000
*                                                                  2028 06825000
         MVC   NEWID2(4,@02),@CC01699                              2028 06826000
*   /*****************************************************************/ 06827000
*   /*                                                               */ 06828000
*   /* ISSUE UPRINT FOR E.C. LEVEL HEADER                    @ZD00050*/ 06829000
*   /*                                                               */ 06830000
*   /*****************************************************************/ 06831000
*                                                                  2029 06832000
*   PRINTAB=''B;                    /*                       @ZD00050*/ 06833000
         XC    PRINTAB(44),PRINTAB                                 2029 06834000
*   DARGSMOD=DUMSGMOD;              /*                       @ZD00050*/ 06835000
         L     @02,DDSTRU                                          2030 06836000
         MVC   DARGSMOD(3,@02),@CC01334                            2030 06837000
*   DARGSENT=HEC;                   /*                       @ZD00050*/ 06838000
         MVI   DARGSENT(@02),X'17'                                 2031 06839000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @ZD00050*/ 06840000
         ST    @07,@AL00001                                        2032 06841000
         LA    @02,PRPTR                                           2032 06842000
         ST    @02,@AL00001+4                                      2032 06843000
         LA    @02,DDSTRU                                          2032 06844000
         ST    @02,@AL00001+8                                      2032 06845000
         MVI   @AL00001+8,X'80'                                    2032 06846000
         L     @15,GDTPRT(,@07)                                    2032 06847000
         LA    @01,@AL00001                                        2032 06848000
         BALR  @14,@15                                             2032 06849000
*   SECTADDR='4CFC'X;               /* SET SECT ADDR.        @ZD00050*/ 06850000
         L     SECTADDR,@CF01700                                   2033 06851000
*   NUMBYTES=4;                     /* SET NO. OF BYTES      @ZD00050*/ 06852000
         MVC   NUMBYTES(4),@CF00044                                2034 06853000
*   CALL PRNTSECT;                  /* PRINT E.C.LEVEL       @ZD00050*/ 06854000
         BAL   @14,PRNTSECT                                        2035 06855000
*   RFY                                                            2036 06856000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06857000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @ZD00050*/ 06858000
         LR    REG14,RETADDR3                                      2037 06859000
*   RETURN;                         /* RETURN TO CALLER      @ZD00050*/ 06860000
@EL00030 DS    0H                                                  2038 06861000
@EF00030 DS    0H                                                  2038 06862000
@ER00030 BR    @14                                                 2038 06863000
*   RFY                                                            2039 06864000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06865000
*   END MSCEC;                      /*                       @ZD00050*/ 06866000
*                                                                  2041 06867000
*   /*****************************************************************/ 06868000
*   /*                                                               */ 06869000
*   /* PROCEDURE NAME - TABUCB (LEVEL 3)                     @ZD00050*/ 06870000
*   /*                                                       @ZD00050*/ 06871000
*   /* FUNCTION - THIS ROUTINE PRINTS THE MSC TABLES         @ZD00050*/ 06872000
*   /* PRIMARY, SECONDARY AND AUXILIARY UNIT CONTROL BLOCKS. @ZD00050*/ 06873000
*   /*                                                       @ZD00050*/ 06874000
*   /* INPUT - NONE                                          @ZD00050*/ 06875000
*   /*                                                       @ZD00050*/ 06876000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE UNIT CONTROL      @ZD00050*/ 06877000
*   /* BLOCKS. SEE REFERENCES TO SECTADDR FOR ACTUAL         @ZD00050*/ 06878000
*   /* LOCATION OF THE DATA.                                 @ZD00050*/ 06879000
*   /*                                                               */ 06880000
*   /*****************************************************************/ 06881000
*                                                                  2041 06882000
*TABUCB:                                                           2041 06883000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZD00050*/ 06884000
TABUCB   DS    0H                                                  2042 06885000
*   RFY                                                            2042 06886000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06887000
*   RETADDR3=REG14;                 /* SAVE RETURN POINT     @ZD00050*/ 06888000
         LR    RETADDR3,REG14                                      2043 06889000
*   RFY                                                            2044 06890000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06891000
*   OLDERID2=NEWERID2;                                             2045 06892000
         L     @07,@PC00001                                        2045 06893000
         L     @02,GDTTR2(,@07)                                    2045 06894000
         MVC   @TS00001(95),NEWERID2(@02)                          2045 06895000
         MVC   OLDERID2(95,@02),@TS00001                           2045 06896000
*   NEWID2='DUCY';                  /*                       @ZD00050*/ 06897000
*                                                                  2046 06898000
         MVC   NEWID2(4,@02),@CC01704                              2046 06899000
*   /*****************************************************************/ 06900000
*   /*                                                               */ 06901000
*   /* ISSUE UPRINT FOR TABLES UCB HEADER                    @ZD00050*/ 06902000
*   /*                                                               */ 06903000
*   /*****************************************************************/ 06904000
*                                                                  2047 06905000
*   PRINTAB=''B;                    /*                       @ZD00050*/ 06906000
         XC    PRINTAB(44),PRINTAB                                 2047 06907000
*   DARGSMOD=DUMSGMOD;              /*                       @ZD00050*/ 06908000
         L     @02,DDSTRU                                          2048 06909000
         MVC   DARGSMOD(3,@02),@CC01334                            2048 06910000
*   DARGSENT=HTUCB;                 /*                       @ZD00050*/ 06911000
         MVI   DARGSENT(@02),X'1A'                                 2049 06912000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @ZD00050*/ 06913000
*                                                                  2050 06914000
         ST    @07,@AL00001                                        2050 06915000
         LA    @02,PRPTR                                           2050 06916000
         ST    @02,@AL00001+4                                      2050 06917000
         LA    @02,DDSTRU                                          2050 06918000
         ST    @02,@AL00001+8                                      2050 06919000
         MVI   @AL00001+8,X'80'                                    2050 06920000
         L     @15,GDTPRT(,@07)                                    2050 06921000
         LA    @01,@AL00001                                        2050 06922000
         BALR  @14,@15                                             2050 06923000
*   /*****************************************************************/ 06924000
*   /*                                                               */ 06925000
*   /* PRINT PRIMARY TABLES UCB                              @ZD00050*/ 06926000
*   /*                                                               */ 06927000
*   /*****************************************************************/ 06928000
*                                                                  2051 06929000
*   SECTADDR='0340'X;               /* SET SECT ADDR         @ZD00050*/ 06930000
         LA    SECTADDR,832                                        2051 06931000
*   NUMBYTES=8;                     /* SET NO. OF BYTES      @ZD00050*/ 06932000
         MVC   NUMBYTES(4),@CF00183                                2052 06933000
*   CALL PRNTSECT;                  /* PRINT UCB             @ZD00050*/ 06934000
*                                                                  2053 06935000
         BAL   @14,PRNTSECT                                        2053 06936000
*   /*****************************************************************/ 06937000
*   /*                                                               */ 06938000
*   /* PRINT SECONDARY TABLES UCB                            @ZD00050*/ 06939000
*   /*                                                               */ 06940000
*   /*****************************************************************/ 06941000
*                                                                  2054 06942000
*   SECTADDR='0148'X;               /* SET SECT ADDR         @ZD00050*/ 06943000
         LA    SECTADDR,328                                        2054 06944000
*   NUMBYTES=8;                     /* SET NO. OF BYTES      @ZD00050*/ 06945000
         MVC   NUMBYTES(4),@CF00183                                2055 06946000
*   CALL PRNTSECT;                  /* PRINT UCB             @ZD00050*/ 06947000
*                                                                  2056 06948000
         BAL   @14,PRNTSECT                                        2056 06949000
*   /*****************************************************************/ 06950000
*   /*                                                               */ 06951000
*   /* PRINT AUXILIARY TABLES UCB                            @ZD00050*/ 06952000
*   /*                                                               */ 06953000
*   /*****************************************************************/ 06954000
*                                                                  2057 06955000
*   SECTADDR='0348'X;               /* SET SECT ADDR         @ZD00050*/ 06956000
         LA    SECTADDR,840                                        2057 06957000
*   NUMBYTES=8;                     /* SET NO. OF BYTES      @ZD00050*/ 06958000
         MVC   NUMBYTES(4),@CF00183                                2058 06959000
*   CALL PRNTSECT;                  /* PRINT UCB             @ZD00050*/ 06960000
         BAL   @14,PRNTSECT                                        2059 06961000
*   RFY                                                            2060 06962000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06963000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @ZD00050*/ 06964000
         LR    REG14,RETADDR3                                      2061 06965000
*   RETURN;                         /* RETURN TO CALLER      @ZD00050*/ 06966000
@EL00031 DS    0H                                                  2062 06967000
@EF00031 DS    0H                                                  2062 06968000
@ER00031 BR    @14                                                 2062 06969000
*   RFY                                                            2063 06970000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06971000
*   END TABUCB;                     /*                       @ZD00050*/ 06972000
*                                                                  2065 06973000
*   /*****************************************************************/ 06974000
*   /*                                                               */ 06975000
*   /* PROCEDURE NAME - SAEC (LEVEL 3)                       @ZD00050*/ 06976000
*   /*                                                       @ZD00050*/ 06977000
*   /* FUNCTION - THIS ROUTINE PRINTS THE SA ENGINEERING     @ZD00050*/ 06978000
*   /* CHANGE LEVEL.                                         @ZD00050*/ 06979000
*   /*                                                       @ZD00050*/ 06980000
*   /* INPUT - NONE                                          @ZD00050*/ 06981000
*   /*                                                       @ZD00050*/ 06982000
*   /* OUTPUT - A HEXADECIMAL PRINT OF THE SA E.C.LEVEL.     @ZD00050*/ 06983000
*   /* SEE REFERENCES TO SECTADDR FOR ACTUAL LOCATION OF     @ZD00050*/ 06984000
*   /* THE DATA.                                             @ZD00050*/ 06985000
*   /*                                                               */ 06986000
*   /*****************************************************************/ 06987000
*                                                                  2065 06988000
*SAEC:                                                             2065 06989000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZD00050*/ 06990000
SAEC     DS    0H                                                  2066 06991000
*   RFY                                                            2066 06992000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 06993000
*   RETADDR3=REG14;                 /* SAVE RETURN ADDR.     @ZD00050*/ 06994000
         LR    RETADDR3,REG14                                      2067 06995000
*   RFY                                                            2068 06996000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 06997000
*   OLDERID2=NEWERID2;                                             2069 06998000
         L     @07,@PC00001                                        2069 06999000
         L     @02,GDTTR2(,@07)                                    2069 07000000
         MVC   @TS00001(95),NEWERID2(@02)                          2069 07001000
         MVC   OLDERID2(95,@02),@TS00001                           2069 07002000
*   NEWID2='DUCZ';                  /*                       @ZD00050*/ 07003000
*                                                                  2070 07004000
         MVC   NEWID2(4,@02),@CC01711                              2070 07005000
*   /*****************************************************************/ 07006000
*   /*                                                               */ 07007000
*   /* ISSUE UPRINT FOR E.C. LEVEL HEADER                    @ZD00050*/ 07008000
*   /*                                                               */ 07009000
*   /*****************************************************************/ 07010000
*                                                                  2071 07011000
*   PRINTAB=''B;                    /*                       @ZD00050*/ 07012000
         XC    PRINTAB(44),PRINTAB                                 2071 07013000
*   DARGSMOD=DUMSGMOD;              /*                       @ZD00050*/ 07014000
         L     @02,DDSTRU                                          2072 07015000
         MVC   DARGSMOD(3,@02),@CC01334                            2072 07016000
*   DARGSENT=HEC;                   /*                       @ZD00050*/ 07017000
         MVI   DARGSENT(@02),X'17'                                 2073 07018000
*   CALL AMSTP011(GDTTBL,PRPTR,DDSTRU);/*                    @ZD00050*/ 07019000
         ST    @07,@AL00001                                        2074 07020000
         LA    @02,PRPTR                                           2074 07021000
         ST    @02,@AL00001+4                                      2074 07022000
         LA    @02,DDSTRU                                          2074 07023000
         ST    @02,@AL00001+8                                      2074 07024000
         MVI   @AL00001+8,X'80'                                    2074 07025000
         L     @15,GDTPRT(,@07)                                    2074 07026000
         LA    @01,@AL00001                                        2074 07027000
         BALR  @14,@15                                             2074 07028000
*   SECTADDR='00E0'X;               /* SET SECT ADDR.        @ZD00050*/ 07029000
         LA    SECTADDR,224                                        2075 07030000
*   NUMBYTES=4;                     /* SET NO. OF BYTES      @ZD00050*/ 07031000
         MVC   NUMBYTES(4),@CF00044                                2076 07032000
*   CALL PRNTSECT;                  /* PRINT E.C.LEVEL       @ZD00050*/ 07033000
         BAL   @14,PRNTSECT                                        2077 07034000
*   RFY                                                            2078 07035000
*     REG14 RSTD;                   /* RESTRICT R14          @ZD00050*/ 07036000
*   REG14=RETADDR3;                 /* RESET RETURN POINT    @ZD00050*/ 07037000
         LR    REG14,RETADDR3                                      2079 07038000
*   RETURN;                         /* RETURN TO CALLER      @ZD00050*/ 07039000
@EL00032 DS    0H                                                  2080 07040000
@EF00032 DS    0H                                                  2080 07041000
@ER00032 BR    @14                                                 2080 07042000
*   RFY                                                            2081 07043000
*     REG14 UNRSTD;                 /* FREE R14              @ZD00050*/ 07044000
*   END SAEC;                       /*                       @ZD00050*/ 07045000
*                                                                  2083 07046000
*/***********************************************************@Y30LB39*/ 07047000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07048000
*/*                                                          @Y30LB39*/ 07049000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07050000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07051000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07052000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07053000
*/*                                                          @Y30LB39*/ 07054000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07055000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07056000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07057000
*/*                                                          @Y30LB39*/ 07058000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07059000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07060000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07061000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07062000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07063000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07064000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07065000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07066000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07067000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07068000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07069000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07070000
*/*                                                          @Y30LB39*/ 07071000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07072000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07073000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07074000
*/*                                                          @Y30LB39*/ 07075000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07076000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07077000
*/*                                                          @Y30LB39*/ 07078000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07079000
*/*                                                          @Y30LB39*/ 07080000
*/***********************************************************@Y30LB39*/ 07081000
*                                                                  2083 07082000
*                                   /*                       @Y30LB39*/ 07083000
*SSCMSG:                                                           2083 07084000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07085000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07086000
*                                                            @Y30LB39*/ 07087000
SSCMSG   STM   @14,@12,@SA00033                                    2083 07088000
         MVC   @PC00033(8),0(@01)                                  2083 07089000
*                                   /*                       @Y30LB39*/ 07090000
*                                                                  2084 07091000
*   /*****************************************************************/ 07092000
*   /*                                                               */ 07093000
*   /*                                                       @Y30LB39*/ 07094000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07095000
*   /*                                                       @Y30LB39*/ 07096000
*   /*                                                               */ 07097000
*   /*****************************************************************/ 07098000
*                                                                  2084 07099000
*                                   /*                       @Y30LB39   07100000
*                                                            @Y30LB39*/ 07101000
*                                                                  2084 07102000
*   /*****************************************************************/ 07103000
*   /*                                                               */ 07104000
*   /*                                                       @Y30LB39*/ 07105000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07106000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07107000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07108000
*   /*                                                       @Y30LB39*/ 07109000
*   /*                                                               */ 07110000
*   /*****************************************************************/ 07111000
*                                                                  2084 07112000
*                                   /*                       @Y30LB39*/ 07113000
*   DCL                                                            2084 07114000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07115000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07116000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07117000
*   DCL                                                            2085 07118000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07119000
*                                                            @Y30LB39   07120000
*                                                            @Y30LB39*/ 07121000
*                                                                  2085 07122000
*   /*****************************************************************/ 07123000
*   /*                                                               */ 07124000
*   /*                                                       @Y30LB39*/ 07125000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07126000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07127000
*   /*                                                       @Y30LB39*/ 07128000
*   /*                                                               */ 07129000
*   /*****************************************************************/ 07130000
*                                                                  2086 07131000
*                                   /*                       @Y30LB39*/ 07132000
*   DCL                                                            2086 07133000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07134000
*   DCL                                                            2087 07135000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07136000
*                                                            @Y30LB39*/ 07137000
*                                                                  2087 07138000
*   /*****************************************************************/ 07139000
*   /*                                                               */ 07140000
*   /*                                                       @Y30LB39*/ 07141000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07142000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07143000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07144000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07145000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07146000
*   /*                                                       @Y30LB39*/ 07147000
*   /*                                                               */ 07148000
*   /*****************************************************************/ 07149000
*                                                                  2088 07150000
*                                   /*                       @Y30LB39*/ 07151000
*   DECLARE                                                        2088 07152000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07153000
*                                                            @Y30LB39*/ 07154000
*                                                                  2088 07155000
*   /*****************************************************************/ 07156000
*   /*                                                               */ 07157000
*   /*                                                       @Y30LB39*/ 07158000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07159000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07160000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07161000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07162000
*   /*                                                       @Y30LB39*/ 07163000
*   /*                                                               */ 07164000
*   /*****************************************************************/ 07165000
*                                                                  2089 07166000
*                                   /*                       @Y30LB39*/ 07167000
*   DECLARE                                                        2089 07168000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07169000
*                                                            @Y30LB39*/ 07170000
*                                                                  2089 07171000
*   /*****************************************************************/ 07172000
*   /*                                                               */ 07173000
*   /*                                                       @Y30LB39*/ 07174000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07175000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07176000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07177000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07178000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07179000
*   /*                                                       @Y30LB39*/ 07180000
*   /*                                                               */ 07181000
*   /*****************************************************************/ 07182000
*                                                                  2090 07183000
*                                   /*                       @Y30LB39*/ 07184000
*   DECLARE                                                        2090 07185000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07186000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07187000
*                                                            @Y30LB39*/ 07188000
*                                                                  2090 07189000
*   /*****************************************************************/ 07190000
*   /*                                                               */ 07191000
*   /*                                                       @Y30LB39*/ 07192000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07193000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07194000
*   /*                                                       @Y30LB39*/ 07195000
*   /*                                                               */ 07196000
*   /*****************************************************************/ 07197000
*                                                                  2091 07198000
*                                   /*                       @Y30LB39*/ 07199000
*   DECLARE                                                        2091 07200000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07201000
*                                                            @Y30LB39*/ 07202000
*                                                                  2091 07203000
*   /*****************************************************************/ 07204000
*   /*                                                               */ 07205000
*   /*                                                       @Y30LB39*/ 07206000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07207000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07208000
*   /*                                                       @Y30LB39*/ 07209000
*   /*                                                               */ 07210000
*   /*****************************************************************/ 07211000
*                                                                  2092 07212000
*                                   /*                       @Y30LB39*/ 07213000
*   DECLARE                                                        2092 07214000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07215000
*                                                            @Y30LB39*/ 07216000
*                                   /*                       @Y30LB39*/ 07217000
*                                                                  2093 07218000
*   /*****************************************************************/ 07219000
*   /*                                                               */ 07220000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07221000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07222000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07223000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07224000
*   /*                                                       @Y30LB39*/ 07225000
*   /*                                                               */ 07226000
*   /*****************************************************************/ 07227000
*                                                                  2093 07228000
*                                   /*                       @Y30LB39*/ 07229000
*   OLDERID2=NEWERID2;                                             2093 07230000
         L     @15,@PC00001                                        2093 07231000
         L     @14,GDTTR2(,@15)                                    2093 07232000
         MVC   @TS00001(95),NEWERID2(@14)                          2093 07233000
         MVC   OLDERID2(95,@14),@TS00001                           2093 07234000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07235000
*                                                            @Y30LB39*/ 07236000
*                                                                  2094 07237000
         MVC   NEWID2(4,@14),@CC01732                              2094 07238000
*   /*****************************************************************/ 07239000
*   /*                                                               */ 07240000
*   /*                                                       @Y30LB39*/ 07241000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 07242000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 07243000
*   /*                                                       @Y30LB39*/ 07244000
*   /*                                                               */ 07245000
*   /*****************************************************************/ 07246000
*                                                                  2095 07247000
*                                   /*                       @Y30LB39*/ 07248000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   07249000
*                                                            @Y30LB39*/ 07250000
*                                                                  2095 07251000
         LA    @14,SSDRGLT                                         2095 07252000
         ST    @14,SSDLPTR                                         2095 07253000
*   /*****************************************************************/ 07254000
*   /*                                                               */ 07255000
*   /*                                                       @Y30LB39*/ 07256000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 07257000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 07258000
*   /*                                                       @Y30LB39*/ 07259000
*   /*                                                               */ 07260000
*   /*****************************************************************/ 07261000
*                                                                  2096 07262000
*                                   /*                       @Y30LB39*/ 07263000
*   IF SSRCODE>0 THEN                                              2096 07264000
         L     @07,@PC00033                                        2096 07265000
         L     @07,SSRCODE(,@07)                                   2096 07266000
         LTR   @07,@07                                             2096 07267000
         BNP   @RF02096                                            2096 07268000
*     DO;                           /*                       @Y30LB39   07269000
*                                                            @Y30LB39*/ 07270000
*                                                                  2097 07271000
*       /*************************************************************/ 07272000
*       /*                                                           */ 07273000
*       /*                                                   @Y30LB39*/ 07274000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 07275000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 07276000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 07277000
*       /* CODES.                                            @Y30LB39*/ 07278000
*       /*                                                   @Y30LB39*/ 07279000
*       /*                                                           */ 07280000
*       /*************************************************************/ 07281000
*                                                                  2098 07282000
*                                   /*                       @Y30LB39*/ 07283000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07284000
         XC    SSDRGLT(20),SSDRGLT                                 2098 07285000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 07286000
         LA    @03,SSINXLST                                        2099 07287000
         ST    @03,DARGRETP(,@14)                                  2099 07288000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07289000
         MVC   DARGSMOD(3,@14),SSMODSS0                            2100 07290000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 07291000
         MVI   DARGSENT(@14),X'01'                                 2101 07292000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   07293000
*                                                            @Y30LB39*/ 07294000
*                                                                  2102 07295000
         MVC   DARGRETL(2,@14),@CH01281                            2102 07296000
*       /*************************************************************/ 07297000
*       /*                                                           */ 07298000
*       /*                                                   @Y30LB39*/ 07299000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 07300000
*       /* ARRAY.                                            @Y30LB39*/ 07301000
*       /*                                                   @Y30LB39*/ 07302000
*       /*                                                           */ 07303000
*       /*************************************************************/ 07304000
*                                                                  2103 07305000
*                                   /*                       @Y30LB39*/ 07306000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   07307000
*                                                            @Y30LB39*/ 07308000
*                                                                  2103 07309000
         ST    @15,@AL00001                                        2103 07310000
         LA    @03,@CF00118                                        2103 07311000
         ST    @03,@AL00001+4                                      2103 07312000
         LA    @03,SSDLPTR                                         2103 07313000
         ST    @03,@AL00001+8                                      2103 07314000
         MVI   @AL00001+8,X'80'                                    2103 07315000
         L     @15,GDTPRT(,@15)                                    2103 07316000
         LA    @01,@AL00001                                        2103 07317000
         BALR  @14,@15                                             2103 07318000
*       /*************************************************************/ 07319000
*       /*                                                           */ 07320000
*       /*                                                   @Y30LB39*/ 07321000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 07322000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 07323000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 07324000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 07325000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 07326000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 07327000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 07328000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 07329000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 07330000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 07331000
*       /* REASON CODE.                                      @Y30LB39*/ 07332000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 07333000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 07334000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 07335000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 07336000
*       /*                                                   @Y30LB39*/ 07337000
*       /*                                                           */ 07338000
*       /*************************************************************/ 07339000
*                                                                  2104 07340000
*                                   /*                       @Y30LB39*/ 07341000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 07342000
         LA    ENTRYNUM,1                                          2104 07343000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   2105 07344000
@DL02105 DS    0H                                                  2106 07345000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 07346000
         LA    ENTRYNUM,1(,ENTRYNUM)                               2106 07347000
*       END;                        /*                       @Y30LB39   07348000
*                                                            @Y30LB39*/ 07349000
*                                                                  2107 07350000
@DE02105 L     @03,@PC00033                                        2107 07351000
         LR    @15,ENTRYNUM                                        2107 07352000
         ALR   @15,@15                                             2107 07353000
         LH    @15,SSARRAY-2(@15)                                  2107 07354000
         CH    @15,SSRHALF(,@03)                                   2107 07355000
         BE    @DC02105                                            2107 07356000
         LTR   @15,@15                                             2107 07357000
         BNZ   @DL02105                                            2107 07358000
@DC02105 DS    0H                                                  2108 07359000
*       /*************************************************************/ 07360000
*       /*                                                           */ 07361000
*       /*                                                   @Y30LB39*/ 07362000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 07363000
*       /*                                                   @Y30LB39*/ 07364000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 07365000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 07366000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 07367000
*       /* CODE OR                                           @Y30LB39*/ 07368000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 07369000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 07370000
*       /*                                                   @Y30LB39*/ 07371000
*       /*                                                           */ 07372000
*       /*************************************************************/ 07373000
*                                                                  2108 07374000
*                                   /*                       @Y30LB39*/ 07375000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07376000
         XC    SSDRGLT(20),SSDRGLT                                 2108 07377000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07378000
         L     @03,SSDLPTR                                         2109 07379000
         MVC   DARGSMOD(3,@03),SSMODSS0                            2109 07380000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 07381000
         STC   ENTRYNUM,DARGSENT(,@03)                             2110 07382000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 07383000
         LR    @15,ENTRYNUM                                        2111 07384000
         ALR   @15,@15                                             2111 07385000
         LH    @15,SSARRAY-2(@15)                                  2111 07386000
         LTR   @15,@15                                             2111 07387000
         BNZ   @RF02111                                            2111 07388000
*         DO;                       /*                       @Y30LB39*/ 07389000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 07390000
         L     @02,@PC00033                                        2113 07391000
         ST    @02,DARGDBP(,@03)                                   2113 07392000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 07393000
         MVC   DARGILP(2,@03),@CH00044                             2114 07394000
*         END;                      /*                       @Y30LB39*/ 07395000
*     END;                          /*                       @Y30LB39*/ 07396000
*                                   /*                       @Y30LB39*/ 07397000
*                                                                  2117 07398000
*   /*****************************************************************/ 07399000
*   /*                                                               */ 07400000
*   /*                                                       @Y30LB39*/ 07401000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 07402000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 07403000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 07404000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 07405000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 07406000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 07407000
*   /* POST CODE.                                            @Y30LB39*/ 07408000
*   /*                                                       @Y30LB39*/ 07409000
*   /*                                                               */ 07410000
*   /*****************************************************************/ 07411000
*                                                                  2117 07412000
*                                   /*                       @Y30LB39*/ 07413000
*   ELSE                            /*                       @Y30LB39*/ 07414000
*     DO;                           /*                       @Y30LB39*/ 07415000
         B     @RC02096                                            2117 07416000
@RF02096 DS    0H                                                  2118 07417000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07418000
         XC    SSDRGLT(20),SSDRGLT                                 2118 07419000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 07420000
         L     @15,SSDLPTR                                         2119 07421000
         MVC   DARGSMOD(3,@15),SSMODCM0                            2119 07422000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 07423000
         IC    @14,SSMSGNUM                                        2120 07424000
         STC   @14,DARGSENT(,@15)                                  2120 07425000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 07426000
         L     @14,@PC00033+4                                      2121 07427000
         ST    @14,DARGDBP(,@15)                                   2121 07428000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 07429000
         MVC   DARGILP(2,@15),@CH00223                             2122 07430000
*     END;                          /*                       @Y30LB39   07431000
*                                                            @Y30LB39*/ 07432000
*                                                                  2123 07433000
*   /*****************************************************************/ 07434000
*   /*                                                               */ 07435000
*   /*                                                       @Y30LB39*/ 07436000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 07437000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 07438000
*   /*                                                       @Y30LB39*/ 07439000
*   /*                                                               */ 07440000
*   /*****************************************************************/ 07441000
*                                                                  2124 07442000
*                                   /*                       @Y30LB39*/ 07443000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   07444000
*                                                            @Y30LB39*/ 07445000
*                                                                  2124 07446000
@RC02096 L     @15,@PC00001                                        2124 07447000
         ST    @15,@AL00001                                        2124 07448000
         LA    @14,@CF00118                                        2124 07449000
         ST    @14,@AL00001+4                                      2124 07450000
         LA    @14,SSDLPTR                                         2124 07451000
         ST    @14,@AL00001+8                                      2124 07452000
         MVI   @AL00001+8,X'80'                                    2124 07453000
         L     @15,GDTPRT(,@15)                                    2124 07454000
         LA    @01,@AL00001                                        2124 07455000
         BALR  @14,@15                                             2124 07456000
*   /*****************************************************************/ 07457000
*   /*                                                               */ 07458000
*   /*                                                       @Y30LB39*/ 07459000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 07460000
*   /*                                                       @Y30LB39*/ 07461000
*   /*                                                               */ 07462000
*   /*****************************************************************/ 07463000
*                                                                  2125 07464000
*                                   /*                       @Y30LB39   07465000
*                                                            @Y30LB39*/ 07466000
*   RETURN CODE(0);                 /*                       @Y30LB39   07467000
*                                                            @Y30LB39*/ 07468000
         SLR   @15,@15                                             2125 07469000
         L     @14,@SA00033                                        2125 07470000
         LM    @00,@12,@SA00033+8                                  2125 07471000
         BR    @14                                                 2125 07472000
*   END SSCMSG;                     /*                       @Y30LB39*/ 07473000
*   END IDCDU01                     /*                       @Z40LB40*/ 07474000
*                                                                  2127 07475000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07476000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 07477000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 07478000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 07479000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 07480000
*/*%INCLUDE SYSLIB  (IDCCSDU )                                       */ 07481000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 07482000
*                                                                  2127 07483000
*       ;                                                          2127 07484000
@DATA    DS    0H                                                       07485000
@CH00847 DC    H'44'                                                    07486000
@CH01281 DC    H'120'                                                   07487000
@CH01251 DC    H'121'                                                   07488000
         DS    0F                                                       07489000
@AL00525 DC    A(@CC01344)             LIST WITH   1 ARGUMENT(S)        07490000
@AL00592 DC    A(@CC01346)             LIST WITH   1 ARGUMENT(S)        07491000
@DATD    DSECT                                                          07492000
         DS    0F                                                       07493000
@SA00001 DS    18F                                                      07494000
@PC00001 DS    3F                                                       07495000
@PC00003 DS    1F                                                       07496000
@PC00005 DS    2F                                                       07497000
@SA00033 DS    15F                                                      07498000
@PC00033 DS    2F                                                       07499000
@AL00001 DS    4A                                                       07500000
@AFTEMPS DS    1F                                                       07501000
IDCDU01  CSECT                                                          07502000
         DS    0F                                                       07503000
@CF00118 DC    F'0'                                                     07504000
@CH00118 EQU   @CF00118+2                                               07505000
@CF00223 DC    F'1'                                                     07506000
@CH00223 EQU   @CF00223+2                                               07507000
@CF00157 DC    F'2'                                                     07508000
@CH00157 EQU   @CF00157+2                                               07509000
@CF00166 DC    F'3'                                                     07510000
@CH00166 EQU   @CF00166+2                                               07511000
@CF00044 DC    F'4'                                                     07512000
@CH00044 EQU   @CF00044+2                                               07513000
@CF00299 DC    F'5'                                                     07514000
@CF00160 DC    F'6'                                                     07515000
@CF00183 DC    F'8'                                                     07516000
@CH00183 EQU   @CF00183+2                                               07517000
@CF01152 DC    F'9'                                                     07518000
@CF00480 DC    F'10'                                                    07519000
@CF00606 DC    F'12'                                                    07520000
@CH00606 EQU   @CF00606+2                                               07521000
@CF00510 DC    F'16'                                                    07522000
@CF00280 DC    F'20'                                                    07523000
@CF01415 DC    F'28'                                                    07524000
@CF00225 DC    F'32'                                                    07525000
@CF01668 DC    F'51'                                                    07526000
@CF01663 DC    F'60'                                                    07527000
@CF01619 DC    F'79'                                                    07528000
@CF01321 DC    F'256'                                                   07529000
@CF01493 DC    F'4096'                                                  07530000
@CF01361 DC    F'68872'                                                 07531000
@CF01744 DC    F'-2044'                                                 07532000
@CF01747 DC    F'-1660'                                                 07533000
@CF01748 DC    F'-415'                                                  07534000
@CF01743 DC    F'-256'                                                  07535000
@CF01757 DC    F'-68'                                                   07536000
@CF01753 DC    F'-4'                                                    07537000
@CF01515 DC    XL4'10000'                                               07538000
@CF01672 DC    XL4'10680'                                               07539000
@CF01536 DC    XL4'000F'                                                07540000
@CF01538 DC    XL4'7000'                                                07541000
@CF01539 DC    XL4'1000'                                                07542000
@CF01540 DC    XL4'0100'                                                07543000
@CF01547 DC    XL4'1200'                                                07544000
@CF01548 DC    XL4'7B00'                                                07545000
@CF01549 DC    XL4'7800'                                                07546000
@CF01550 DC    XL4'3B00'                                                07547000
@CF01555 DC    XL4'5800'                                                07548000
@CF01556 DC    XL4'5C00'                                                07549000
@CF01557 DC    XL4'5E00'                                                07550000
@CF01558 DC    XL4'3200'                                                07551000
@CF01559 DC    XL4'3C00'                                                07552000
@CF01560 DC    XL4'0200'                                                07553000
@CF01565 DC    XL4'6800'                                                07554000
@CF01566 DC    XL4'6A00'                                                07555000
@CF01567 DC    XL4'6B00'                                                07556000
@CF01568 DC    XL4'6E00'                                                07557000
@CF01569 DC    XL4'6F00'                                                07558000
@CF01570 DC    XL4'B000'                                                07559000
@CF01571 DC    XL4'BF00'                                                07560000
@CF01576 DC    XL4'7C00'                                                07561000
@CF01577 DC    XL4'7F00'                                                07562000
@CF01586 DC    XL4'1D00'                                                07563000
@CF01591 DC    XL4'C900'                                                07564000
@CF01596 DC    XL4'5000'                                                07565000
@CF01597 DC    XL4'50E0'                                                07566000
@CF01604 DC    XL4'0500'                                                07567000
@CF01609 DC    XL4'5D00'                                                07568000
@CF01617 DC    XL4'6900'                                                07569000
@CF01645 DC    XL4'4A00'                                                07570000
@CF01651 DC    XL4'069F'                                                07571000
@CF01657 DC    XL4'06BF'                                                07572000
@CF01662 DC    XL4'7FC4'                                                07573000
@CF01677 DC    XL4'6500'                                                07574000
@CF01680 DC    XL4'66A0'                                                07575000
@CF01700 DC    XL4'4CFC'                                                07576000
@CF00589 DC    XL4'FF'                                                  07577000
@CF01513 DC    XL4'03'                                                  07578000
@CF01516 DC    XL4'CC'                                                  07579000
@CF01522 DC    XL4'01'                                                  07580000
@CF01598 DC    XL4'10'                                                  07581000
@CF01610 DC    XL4'3F'                                                  07582000
@CF01612 DC    XL4'0F'                                                  07583000
@CF01621 DC    XL4'20'                                                  07584000
@CF01623 DC    XL4'BF'                                                  07585000
@CF01670 DC    XL4'D0'                                                  07586000
@CF01678 DC    XL4'34'                                                  07587000
@DATD    DSECT                                                          07588000
         DS    0D                                                       07589000
LISTSCAN DS    A                                                        07590000
IOCSPTR  DS    A                                                        07591000
DDSTRU   DS    A                                                        07592000
FSADDR   DS    A                                                        07593000
ERCNVADR DS    A                                                        07594000
CCMSGPTR DS    A                                                        07595000
CMMSGPTR DS    A                                                        07596000
CTMSGPTR DS    A                                                        07597000
ELEMENT  DS    F                                                        07598000
QUERYPTR DS    A                                                        07599000
RETADDR1 DS    A                                                        07600000
RETADDR2 DS    A                                                        07601000
RETADDR4 DS    A                                                        07602000
MEMPTR   DS    A                                                        07603000
NUMBYTES DS    F                                                        07604000
HISECT   DS    F                                                        07605000
LOSECT   DS    F                                                        07606000
I1       DS    F                                                        07607000
I2       DS    F                                                        07608000
J2       DS    F                                                        07609000
K3       DS    F                                                        07610000
L3       DS    F                                                        07611000
I4       DS    F                                                        07612000
K4       DS    F                                                        07613000
PRPTR    DS    A                                                        07614000
B0BASE   DS    A                                                        07615000
B1BASE   DS    A                                                        07616000
LOCHRHLD DS    FL4                                                      07617000
         ORG   LOCHRHLD                                                 07618000
@NM00096 DS    FL1                                                      07619000
LOCC     DS    FL1                                                      07620000
LOHH     DS    FL1                                                      07621000
LORR     DS    FL1                                                      07622000
         ORG   LOCHRHLD+4                                               07623000
HICHRHLD DS    FL4                                                      07624000
         ORG   HICHRHLD                                                 07625000
@NM00097 DS    FL1                                                      07626000
HICC     DS    FL1                                                      07627000
HIHH     DS    FL1                                                      07628000
HIRR     DS    FL1                                                      07629000
         ORG   HICHRHLD+4                                               07630000
REASON   DS    F                                                        07631000
SSDLPTR  DS    A                                                        07632000
LISTPTR  DS    A                                                        07633000
MSCRC    DS    H                                                        07634000
SARC     DS    H                                                        07635000
TABRC    DS    H                                                        07636000
SETRC    DS    H                                                        07637000
LISTLN   DS    FL1                                                      07638000
@TS00001 DS    CL95                                                     07639000
FORMLIST DS    CL20                                                     07640000
PCARG    DS    CL33                                                     07641000
         ORG   PCARG                                                    07642000
PCMTLP   DS    AL4                                                      07643000
PCSTLP   DS    AL4                                                      07644000
PCFLP    DS    AL4                                                      07645000
PCPCP    DS    AL4                                                      07646000
PCPNL    DS    FL2                                                      07647000
PCPTL    DS    FL2                                                      07648000
PCPDL    DS    FL2                                                      07649000
PCMTLC   DS    FL2                                                      07650000
PCSTLC   DS    FL2                                                      07651000
PCFLC    DS    FL2                                                      07652000
PCLW     DS    FL2                                                      07653000
PCPD     DS    FL2                                                      07654000
PCDSC    DS    AL1                                                      07655000
         ORG   PCARG+33                                                 07656000
         DS    CL3                                                      07657000
OPENLIST DS    CL384                                                    07658000
PRINTAB  DS    CL44                                                     07659000
PARMLST  DS    CL44                                                     07660000
PREFIX   DS    CL8                                                      07661000
         ORG   PREFIX                                                   07662000
PREFIX1  DS    FL4                                                      07663000
PREFIX2  DS    FL4                                                      07664000
         ORG   PREFIX+8                                                 07665000
STBUFFER DS    CL121                                                    07666000
PRINTLN  DS    CL121                                                    07667000
         ORG   PRINTLN                                                  07668000
PRINTLNA DS    CL1                                                      07669000
PRINTLNB DS    CL120                                                    07670000
         ORG   PRINTLN+121                                              07671000
         DS    CL2                                                      07672000
PROSET   DS    CL5                                                      07673000
         ORG   PROSET                                                   07674000
PROSET1  DS    FL4                                                      07675000
         ORG   PROSET1                                                  07676000
PROSET2  DS    FL1                                                      07677000
@NM00094 DS    FL3                                                      07678000
         ORG   PROSET+4                                                 07679000
@NM00095 DS    CL1                                                      07680000
         ORG   PROSET+5                                                 07681000
PRWORK   DS    CL9                                                      07682000
         DS    CL6                                                      07683000
DOUBLEWD DS    CL8                                                      07684000
BITOUT   DS    CL8                                                      07685000
FLAGS    DS    BL1                                                      07686000
         ORG   FLAGS                                                    07687000
GOTCORE  DS    BL1                                                      07688000
GETSFAIL EQU   FLAGS+0                                                  07689000
GOTMSCM  EQU   FLAGS+0                                                  07690000
GOTMSCE  EQU   FLAGS+0                                                  07691000
GOTSAM   EQU   FLAGS+0                                                  07692000
GOTSAE   EQU   FLAGS+0                                                  07693000
CHRERR   EQU   FLAGS+0                                                  07694000
EXERR    EQU   FLAGS+0                                                  07695000
         ORG   FLAGS+1                                                  07696000
         DS    CL3                                                      07697000
RTAREA   DS    CL512                                                    07698000
         ORG   RTAREA                                                   07699000
RTRECA   DS    CL256                                                    07700000
         ORG   RTRECA                                                   07701000
@NM00098 DS    CL248                                                    07702000
RTPREFIX DS    CL8                                                      07703000
         ORG   RTAREA+256                                               07704000
RTRECB   DS    CL256                                                    07705000
         ORG   RTAREA+512                                               07706000
DUMPAREA DS    CL17                                                     07707000
SSDRGLT  DS    CL20                                                     07708000
         DS    CL3                                                      07709000
SSINXLST DS    CL120                                                    07710000
         ORG   SSINXLST                                                 07711000
SSARRAY  DS    60H                                                      07712000
         ORG   SSINXLST+120                                             07713000
EXARRAY  DS    16CL1                                                    07714000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07715000
@ENDDATD EQU   *                                                        07716000
IDCDU01  CSECT                                                          07717000
         DS    0F                                                       07718000
@SIZDATD DC    AL1(0)                                                   07719000
         DC    AL3(@ENDDATD-@DATD)                                      07720000
         DS    0D                                                       07721000
SSIDMASK DC    XL4'0000000F'                                            07722000
DSMASK   DC    XL4'0000000F'                                            07723000
SSMSGNUM DC    AL1(56)                                                  07724000
@CC01633 DC    C'00000000'                                              07725000
@CC01523 DC    C'PARMLST'                                               07726000
@CC01344 DC    C'MSCM'                                                  07727000
@CC01346 DC    C'MSCE'                                                  07728000
@CC01348 DC    C'SAMA'                                                  07729000
@CC01350 DC    C'SAEX'                                                  07730000
@CC01352 DC    C'TABL'                                                  07731000
@CC01451 DC    C'DUAA'                                                  07732000
@CC01456 DC    C'DUAZ'                                                  07733000
@CC01460 DC    C'DUBA'                                                  07734000
@CC01481 DC    C'DUBB'                                                  07735000
@CC01497 DC    C'DUBC'                                                  07736000
@CC01510 DC    C'DUCA'                                                  07737000
@CC01528 DC    C'DUDA'                                                  07738000
@CC01535 DC    C'DUCB'                                                  07739000
@CC01544 DC    C'DUCC'                                                  07740000
@CC01554 DC    C'DUCD'                                                  07741000
@CC01564 DC    C'DUCE'                                                  07742000
@CC01575 DC    C'DUCF'                                                  07743000
@CC01581 DC    C'DUCG'                                                  07744000
@CC01585 DC    C'DUCH'                                                  07745000
@CC01590 DC    C'DUCI'                                                  07746000
@CC01595 DC    C'DUCJ'                                                  07747000
@CC01602 DC    C'DUCL'                                                  07748000
@CC01608 DC    C'DUCM'                                                  07749000
@CC01616 DC    C'DUCN'                                                  07750000
@CC01631 DC    C'DUDB'                                                  07751000
@CC01638 DC    C'DUCO'                                                  07752000
@CC01644 DC    C'DUCP'                                                  07753000
@CC01649 DC    C'DUCQ'                                                  07754000
@CC01655 DC    C'DUCR'                                                  07755000
@CC01661 DC    C'DUCS'                                                  07756000
@CC01667 DC    C'DUCT'                                                  07757000
@CC01676 DC    C'DUCU'                                                  07758000
@CC01684 DC    C'DUCV'                                                  07759000
@CC01689 DC    C'DUEA'                                                  07760000
@CC01694 DC    C'DUCW'                                                  07761000
@CC01699 DC    C'DUCX'                                                  07762000
@CC01704 DC    C'DUCY'                                                  07763000
@CC01711 DC    C'DUCZ'                                                  07764000
@CC01732 DC    C'SSAA'                                                  07765000
@CC01334 DC    C'DU0'                                                   07766000
@CC01336 DC    C'UV0'                                                   07767000
ALL      DC    CL3'ALL'                                                 07768000
FORMAT   DC    CL4'FORM'                                                07769000
HSECOND  DC    CL4'HSEC'                                                07770000
CLOCK    DC    CL4'KLOK'                                                07771000
SETZERO  DC    CL4'ZERO'                                                07772000
SETBLANK DC    CL4'BLNK'                                                07773000
NOSET    DC    CL4'NSET'                                                07774000
OVERRIDE DC    CL4'OVRD'                                                07775000
ACQUIRE  DC    CL8'ACQUIRE '                                            07776000
RELINQ   DC    CL8'RELINQ  '                                            07777000
MOUNT    DC    CL8'MOUNT   '                                            07778000
DEMOUNT  DC    CL8'DEMOUNT '                                            07779000
DEFINE   DC    CL8'DEFINE  '                                            07780000
MOVE     DC    CL8'MOVE    '                                            07781000
TRACEQ   DC    CL8'TRACEQ  '                                            07782000
COPYTABL DC    CL8'COPYTABL'                                            07783000
COPYCRTG DC    CL8'COPYCRTG'                                            07784000
COPYVOL  DC    CL8'COPYVOL '                                            07785000
VVIC     DC    CL8'VVIC    '                                            07786000
TUNE     DC    CL8'TUNE    '                                            07787000
NAMES    DC    CL4'NAME'                                                07788000
UNIT     DC    CL4'UNIT'                                                07789000
SHR      DC    CL4'SHR '                                                07790000
EXCL     DC    CL4'EXCL'                                                07791000
NOWAIT   DC    CL4'NWAI'                                                07792000
WAIT     DC    CL4'WAIT'                                                07793000
SECCHECK DC    CL8'SECCHECK'                                            07794000
SCRVTOC  DC    CL8'SCRVTOC '                                            07795000
GETVTOC  DC    CL8'GETVTOC '                                            07796000
PUTVTOC  DC    CL8'PUTVTOC '                                            07797000
RECATLG  DC    CL8'RECATLG '                                            07798000
INITVOL  DC    CL8'INITVOL '                                            07799000
CHECK    DC    CL8'CHECK   '                                            07800000
POSTUCB  DC    CL8'POSTUCB '                                            07801000
GET      DC    CL8'GET     '                                            07802000
PUT      DC    CL8'PUT     '                                            07803000
CLOSE    DC    CL8'CLOSE   '                                            07804000
OPEN     DC    CL8'OPEN    '                                            07805000
RVOPENR  DC    CL8'OPENR   '                                            07806000
RVRDCNT  DC    CL8'READCNT '                                            07807000
RVREADKD DC    CL8'READKD  '                                            07808000
RVSPACCR DC    CL8'SPACCR  '                                            07809000
RVFWRITE DC    CL8'FWRITE  '                                            07810000
RVWRITER DC    CL8'WRITEREC'                                            07811000
PUTLABEL DC    CL8'PUTLABEL'                                            07812000
GETLABEL DC    CL8'GETLABEL'                                            07813000
CANCEL   DC    CL8'CANCEL  '                                            07814000
SET      DC    CL8'SET     '                                            07815000
SELECTX  DC    CL8'SELECTX '                                            07816000
CHANGEX  DC    CL8'CHANGEX '                                            07817000
SELECTDD DC    CL8'SELECTDD'                                            07818000
SELECTDS DC    CL8'SELECTDS'                                            07819000
TBLREST  DC    CL8'TBLREST '                                            07820000
NULLIFYC DC    CL8'NULLIFYC'                                            07821000
RDMSC    DC    CL8'RDMSC   '                                            07822000
RDMSCTBL DC    CL8'RDMSCTBL'                                            07823000
RDCARTLB DC    CL8'RDCARTLB'                                            07824000
AUDITCEL DC    CL8'AUDITCEL'                                            07825000
RDSTGAD  DC    CL8'RDSTGAD '                                            07826000
MODIFYC  DC    CL8'MODIFYC '                                            07827000
MODID    DC    CL4'DU01'                                                07828000
TABLE    DS    CL256                                                    07829000
         ORG   TABLE                                                    07830000
@NM00099 DC    CL240' '                                                 07831000
@NM00100 DC    CL16'0123456789ABCDEF'                                   07832000
         ORG   TABLE+256                                                07833000
         DS    CL3                                                      07834000
FIXAREA  DS    CL500                                                    07835000
         ORG   FIXAREA                                                  07836000
@NM00101 DC    500X'00'                                                 07837000
         ORG   FIXAREA+500                                              07838000
SSMODSS0 DC    CL3'SS0'                                                 07839000
SSMODCM0 DC    CL3'CM0'                                                 07840000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07841000
@01      EQU   01                                                       07842000
@02      EQU   02                                                       07843000
@03      EQU   03                                                       07844000
@04      EQU   04                                                       07845000
@05      EQU   05                                                       07846000
@06      EQU   06                                                       07847000
@07      EQU   07                                                       07848000
@08      EQU   08                                                       07849000
@09      EQU   09                                                       07850000
@10      EQU   10                                                       07851000
@11      EQU   11                                                       07852000
@12      EQU   12                                                       07853000
@13      EQU   13                                                       07854000
@14      EQU   14                                                       07855000
@15      EQU   15                                                       07856000
ENTRYNUM EQU   @02                                                      07857000
MSPTR    EQU   @05                                                      07858000
BYTEMASK EQU   @03                                                      07859000
WORKBYTE EQU   @05                                                      07860000
PRBYTES  EQU   @02                                                      07861000
PRSTART  EQU   @05                                                      07862000
PRLNPTR  EQU   @03                                                      07863000
J4       EQU   @07                                                      07864000
J3       EQU   @07                                                      07865000
I3       EQU   @04                                                      07866000
K2       EQU   @02                                                      07867000
SECTADDR EQU   @03                                                      07868000
RETADDR5 EQU   @03                                                      07869000
RETADDR3 EQU   @06                                                      07870000
GETDRC   EQU   @06                                                      07871000
DMPINDEX EQU   @02                                                      07872000
OPNPTR   EQU   @02                                                      07873000
TESTRC   EQU   @03                                                      07874000
REG12    EQU   @12                                                      07875000
REG11    EQU   @11                                                      07876000
REG10    EQU   @10                                                      07877000
REG9     EQU   @09                                                      07878000
REG8     EQU   @08                                                      07879000
RTNREG   EQU   @15                                                      07880000
REG14    EQU   @14                                                      07881000
QUERR1   EQU   @01                                                      07882000
REG0     EQU   @00                                                      07883000
REG1     EQU   @01                                                      07884000
REG13    EQU   @13                                                      07885000
REG15    EQU   @15                                                      07886000
REG2     EQU   @02                                                      07887000
REG3     EQU   @03                                                      07888000
REG4     EQU   @04                                                      07889000
REG5     EQU   @05                                                      07890000
REG6     EQU   @06                                                      07891000
REG7     EQU   @07                                                      07892000
IDCSAEP0 EQU   0                                                        07893000
IDCSAGS0 EQU   0                                                        07894000
IDCSAFS0 EQU   0                                                        07895000
IDCSASS0 EQU   0                                                        07896000
TRACE1   EQU   0                                                        07897000
OLDERID1 EQU   TRACE1                                                   07898000
TRACE2   EQU   0                                                        07899000
OLDERID2 EQU   TRACE2                                                   07900000
NEWID2   EQU   TRACE2+95                                                07901000
NEWERID2 EQU   5                                                        07902000
CIRAGL   EQU   0                                                        07903000
CIRTYPE  EQU   CIRAGL                                                   07904000
ALLAGL   EQU   0                                                        07905000
ALLSTS   EQU   ALLAGL+24                                                07906000
ALLDSP   EQU   ALLAGL+25                                                07907000
ALLORG   EQU   ALLAGL+26                                                07908000
ALLOPT   EQU   ALLAGL+28                                                07909000
RACFAGL  EQU   0                                                        07910000
RACFFLG1 EQU   RACFAGL                                                  07911000
RACFFLG2 EQU   RACFAGL+1                                                07912000
RACFFLG3 EQU   RACFAGL+2                                                07913000
RACFFLG4 EQU   RACFAGL+3                                                07914000
UNITABL  EQU   0                                                        07915000
UNITADR  EQU   UNITABL+4                                                07916000
@NM00017 EQU   UNITADR                                                  07917000
UNITSTAT EQU   UNITABL+6                                                07918000
IDCIOOP0 EQU   0                                                        07919000
IDCIOCL0 EQU   0                                                        07920000
IOCSTR   EQU   0                                                        07921000
IOCDSO   EQU   IOCSTR+16                                                07922000
IOCRFM   EQU   IOCSTR+17                                                07923000
IOCMAC   EQU   IOCSTR+18                                                07924000
IOCMAC2  EQU   IOCSTR+19                                                07925000
IOCCHP   EQU   IOCSTR+20                                                07926000
IOCMSG   EQU   IOCSTR+21                                                07927000
IOCRBA   EQU   IOCSTR+40                                                07928000
IOCTTR   EQU   IOCRBA                                                   07929000
IOCMEM   EQU   IOCSTR+44                                                07930000
IOCNWM   EQU   IOCSTR+48                                                07931000
IOCREL   EQU   IOCSTR+60                                                07932000
OPNAGL   EQU   0                                                        07933000
OPNOPT   EQU   OPNAGL                                                   07934000
OPNOPTOT EQU   OPNOPT                                                   07935000
OPNRFM   EQU   OPNAGL+1                                                 07936000
OPNTYP   EQU   OPNAGL+2                                                 07937000
OPNMOD   EQU   OPNAGL+3                                                 07938000
OPNMODAC EQU   OPNMOD                                                   07939000
OPNIOC   EQU   OPNAGL+4                                                 07940000
OPNDDN   EQU   OPNAGL+8                                                 07941000
OPNDSN   EQU   OPNAGL+16                                                07942000
OPNDEV   EQU   OPNAGL+24                                                07943000
OPNDSO   EQU   OPNAGL+41                                                07944000
OPNOPT2  EQU   OPNAGL+42                                                07945000
IOINFOPT EQU   0                                                        07946000
UVOLLIST EQU   0                                                        07947000
UVOLENT  EQU   UVOLLIST+2                                               07948000
AMSTP011 EQU   0                                                        07949000
AMSTP042 EQU   0                                                        07950000
AMSTP044 EQU   0                                                        07951000
DARGLIST EQU   0                                                        07952000
DARGDBP  EQU   DARGLIST                                                 07953000
DARGRETP EQU   DARGLIST+4                                               07954000
DARGSTID EQU   DARGLIST+8                                               07955000
DARGSMOD EQU   DARGSTID                                                 07956000
DARGSENT EQU   DARGSTID+3                                               07957000
DARGILP  EQU   DARGLIST+12                                              07958000
DARGCNT  EQU   DARGLIST+14                                              07959000
DARGRETL EQU   DARGLIST+16                                              07960000
DARGARY  EQU   DARGLIST+20                                              07961000
DARGINS  EQU   DARGARY                                                  07962000
DARGINL  EQU   DARGARY+2                                                07963000
DARGDTM  EQU   DARGARY+4                                                07964000
FMTLIST  EQU   0                                                        07965000
FMTFLGS  EQU   FMTLIST                                                  07966000
FMTEOLF  EQU   FMTFLGS                                                  07967000
FMTSCF   EQU   FMTFLGS                                                  07968000
FMTBDF   EQU   FMTFLGS                                                  07969000
FMTSPF   EQU   FMTLIST+2                                                07970000
FMTRFNO  EQU   FMTSPF                                                   07971000
FMTILEN  EQU   FMTRFNO                                                  07972000
FMTIOFF  EQU   FMTLIST+4                                                07973000
FMTTRBC  EQU   FMTIOFF                                                  07974000
FMTSTO   EQU   FMTTRBC                                                  07975000
FMTSPT   EQU   FMTSTO                                                   07976000
FMTOCOL  EQU   FMTLIST+6                                                07977000
FMTOLEN  EQU   FMTLIST+8                                                07978000
FMTCNVF  EQU   FMTLIST+10                                               07979000
ERCNVTAB EQU   0                                                        07980000
ERTYPE   EQU   ERCNVTAB                                                 07981000
EROPER   EQU   ERCNVTAB+1                                               07982000
EROSOPER EQU   ERCNVTAB+2                                               07983000
ERCATRC  EQU   ERCNVTAB+16                                              07984000
ERCPLPT  EQU   ERCNVTAB+20                                              07985000
IDCDB010 EQU   0                                                        07986000
DMPITM   EQU   0                                                        07987000
DMPITMNM EQU   DMPITM                                                   07988000
DMPITMPT EQU   DMPITM+8                                                 07989000
DMPITMLN EQU   DMPITM+12                                                07990000
DMPITMTP EQU   DMPITM+14                                                07991000
DMPARY   EQU   0                                                        07992000
DMPTRM   EQU   0                                                        07993000
CCMSG    EQU   0                                                        07994000
CMMSG    EQU   0                                                        07995000
CMVOLFLG EQU   CMMSG+6                                                  07996000
CTMSG    EQU   0                                                        07997000
CTARRAY  EQU   CTMSG+4                                                  07998000
MDAGL    EQU   0                                                        07999000
MDFLAGS  EQU   MDAGL+30                                                 08000000
MDVTOC   EQU   MDAGL+32                                                 08001000
PUAGL    EQU   0                                                        08002000
CKAGL    EQU   0                                                        08003000
CKFLAGS  EQU   CKAGL+28                                                 08004000
EXCLAGL  EQU   0                                                        08005000
EXCLFLAG EQU   EXCLAGL+22                                               08006000
EXOARG   EQU   0                                                        08007000
EXOPT    EQU   EXOARG+32                                                08008000
EXFLG    EQU   EXOARG+33                                                08009000
EXGARG   EQU   0                                                        08010000
EXWRARG  EQU   0                                                        08011000
EXRWCHR  EQU   EXWRARG+26                                               08012000
EXSPACE  EQU   EXWRARG+36                                               08013000
EXPARG   EQU   0                                                        08014000
EXPDATA  EQU   EXPARG+12                                                08015000
EXPDATAB EQU   0                                                        08016000
EXPARRAY EQU   EXPDATAB+4                                               08017000
VS2AGL   EQU   0                                                        08018000
VSLABOPT EQU   VS2AGL+28                                                08019000
VS2MSG   EQU   VS2AGL+35                                                08020000
VS2RESOP EQU   VS2AGL+36                                                08021000
VS1AGL   EQU   0                                                        08022000
VSSECOPT EQU   VS1AGL+68                                                08023000
VSVTOPT  EQU   VS1AGL+69                                                08024000
VSCATOPT EQU   VS1AGL+70                                                08025000
VSRETURN EQU   VS1AGL+71                                                08026000
VSMSG    EQU   VS1AGL+72                                                08027000
VSRESOPT EQU   VS1AGL+73                                                08028000
RCTAGL   EQU   0                                                        08029000
RCTOPT   EQU   RCTAGL+8                                                 08030000
STAEPARM EQU   0                                                        08031000
STARCVY  EQU   STAEPARM+52                                              08032000
STARETRY EQU   STAEPARM+53                                              08033000
VOLLABEL EQU   0                                                        08034000
SV82LIST EQU   0                                                        08035000
@NM00073 EQU   SV82LIST+4                                               08036000
SV82DCBP EQU   @NM00073                                                 08037000
@NM00074 EQU   SV82LIST+12                                              08038000
SV82WRKP EQU   @NM00074                                                 08039000
SRTAGL   EQU   0                                                        08040000
LCTINFO  EQU   0                                                        08041000
LCTFLAGS EQU   LCTINFO+32                                               08042000
UCTAGL   EQU   0                                                        08043000
UCTFLAGS EQU   UCTAGL+68                                                08044000
SELAGL   EQU   0                                                        08045000
SELFLAGS EQU   SELAGL+22                                                08046000
DATESAGL EQU   0                                                        08047000
DATESOPT EQU   DATESAGL+20                                              08048000
VS3AGL   EQU   0                                                        08049000
VS3FLAGS EQU   VS3AGL+58                                                08050000
VSDVTOC  EQU   0                                                        08051000
VSDSTAT  EQU   0                                                        08052000
VSDSFLG1 EQU   VSDSTAT+16                                               08053000
VSDFLG2  EQU   VSDSTAT+17                                               08054000
VSDSCR   EQU   0                                                        08055000
VSDSCRFL EQU   VSDSCR+4                                                 08056000
VSDUSAGE EQU   0                                                        08057000
VSDDORG  EQU   VSDUSAGE+9                                               08058000
VSDALLOC EQU   VSDUSAGE+10                                              08059000
VSDUSEF  EQU   VSDUSAGE+11                                              08060000
VSDDSORG EQU   VSDUSAGE+16                                              08061000
VSDBLOCK EQU   0                                                        08062000
VSDSPACE EQU   VSDBLOCK+12                                              08063000
VSDARRAY EQU   VSDBLOCK+16                                              08064000
VSDVARY  EQU   VSDARRAY+48                                              08065000
MSC      EQU   0                                                        08066000
MFMT     EQU   0                                                        08067000
MSCTMCNT EQU   0                                                        08068000
MMLOPTR  EQU   0                                                        08069000
MMLO     EQU   0                                                        08070000
MMLOVAL  EQU   MMLO                                                     08071000
MMHIPTR  EQU   0                                                        08072000
MMHI     EQU   0                                                        08073000
MMHIVAL  EQU   MMHI                                                     08074000
MSCTECNT EQU   0                                                        08075000
MELOPTR  EQU   0                                                        08076000
MELO     EQU   0                                                        08077000
MELOVAL  EQU   MELO                                                     08078000
MEHIPTR  EQU   0                                                        08079000
MEHI     EQU   0                                                        08080000
MEHIVAL  EQU   MEHI                                                     08081000
STGADCNT EQU   0                                                        08082000
SSIDPTR  EQU   0                                                        08083000
SSID     EQU   0                                                        08084000
SSIDVAL  EQU   SSID                                                     08085000
SFMTPTR  EQU   0                                                        08086000
SSCTMCNT EQU   0                                                        08087000
SMLOPTR  EQU   0                                                        08088000
SMLO     EQU   0                                                        08089000
SMLOVAL  EQU   SMLO                                                     08090000
SMHIPTR  EQU   0                                                        08091000
SMHI     EQU   0                                                        08092000
SMHIVAL  EQU   SMHI                                                     08093000
SSCTECNT EQU   0                                                        08094000
SELOPTR  EQU   0                                                        08095000
SELO     EQU   0                                                        08096000
SELOVAL  EQU   SELO                                                     08097000
SEHIPTR  EQU   0                                                        08098000
SEHI     EQU   0                                                        08099000
SEHIVAL  EQU   SEHI                                                     08100000
TBLCNT   EQU   0                                                        08101000
LOCHRPTR EQU   0                                                        08102000
LOCHR    EQU   0                                                        08103000
LOCHRVAL EQU   LOCHR                                                    08104000
HICHRPTR EQU   0                                                        08105000
HICHR    EQU   0                                                        08106000
HICHRVAL EQU   HICHR                                                    08107000
OFILE    EQU   0                                                        08108000
OFILEVAL EQU   OFILE+1                                                  08109000
ODS      EQU   0                                                        08110000
ODSFLG   EQU   ODS+10                                                   08111000
ODSVAL   EQU   ODS+21                                                   08112000
AMSC     EQU   0                                                        08113000
QUERYLST EQU   0                                                        08114000
QUCODE   EQU   QUERYLST+6                                               08115000
QUSECT   EQU   QUERYLST+7                                               08116000
QUXADDR  EQU   QUSECT                                                   08117000
QUFLAG   EQU   QUXADDR                                                  08118000
QUPARM   EQU   QUERYLST+8                                               08119000
QUPTR    EQU   QUERYLST+40                                              08120000
PRAREA   EQU   0                                                        08121000
MEMBYTE  EQU   0                                                        08122000
MEMSECT  EQU   0                                                        08123000
AMSTP041 EQU   0                                                        08124000
AMSTP043 EQU   0                                                        08125000
IDCIOCO0 EQU   0                                                        08126000
IDCIOGT0 EQU   0                                                        08127000
IDCIOIT0 EQU   0                                                        08128000
IDCIOPO0 EQU   0                                                        08129000
IDCIOPT0 EQU   0                                                        08130000
IDCIOSI0 EQU   0                                                        08131000
IDCIOST0 EQU   0                                                        08132000
IDCIOTM0 EQU   0                                                        08133000
IDCIOVY0 EQU   0                                                        08134000
IDCIO050 EQU   0                                                        08135000
IDCSAAL0 EQU   0                                                        08136000
IDCSACA0 EQU   0                                                        08137000
IDCSACL0 EQU   0                                                        08138000
IDCSACR0 EQU   0                                                        08139000
IDCSADE0 EQU   0                                                        08140000
IDCSADL0 EQU   0                                                        08141000
IDCSADQ0 EQU   0                                                        08142000
IDCSAFP0 EQU   0                                                        08143000
IDCSAGP0 EQU   0                                                        08144000
IDCSAID0 EQU   0                                                        08145000
IDCSALC0 EQU   0                                                        08146000
IDCSALD0 EQU   0                                                        08147000
IDCSALK0 EQU   0                                                        08148000
IDCSANQ0 EQU   0                                                        08149000
IDCSAPR0 EQU   0                                                        08150000
IDCSAPT0 EQU   0                                                        08151000
IDCSAQL0 EQU   0                                                        08152000
IDCSARC0 EQU   0                                                        08153000
IDCSARK0 EQU   0                                                        08154000
IDCSARV0 EQU   0                                                        08155000
IDCSASC0 EQU   0                                                        08156000
IDCSASI0 EQU   0                                                        08157000
IDCSASN0 EQU   0                                                        08158000
IDCSAST0 EQU   0                                                        08159000
IDCSATI0 EQU   0                                                        08160000
IDCSAUC0 EQU   0                                                        08161000
IDCSAWO0 EQU   0                                                        08162000
IDCSA060 EQU   0                                                        08163000
IDCST010 EQU   0                                                        08164000
IDCTPER0 EQU   0                                                        08165000
LISTTEST EQU   0                                                        08166000
MSCTE    EQU   0                                                        08167000
MSCTM    EQU   0                                                        08168000
NEWERID1 EQU   5                                                        08169000
SFMT     EQU   0                                                        08170000
SSCTE    EQU   0                                                        08171000
SSCTEPTR EQU   0                                                        08172000
SSCTM    EQU   0                                                        08173000
SSCTMPTR EQU   0                                                        08174000
STGAD    EQU   0                                                        08175000
TBL      EQU   0                                                        08176000
GDTTBL   EQU   0                                                        08177000
GDTTR1   EQU   GDTTBL+8                                                 08178000
GDTTR2   EQU   GDTTBL+12                                                08179000
GDTDBG   EQU   GDTTBL+40                                                08180000
GDTSTC   EQU   GDTTBL+44                                                08181000
GDTPRT   EQU   GDTTBL+48                                                08182000
GDTESS   EQU   GDTTBL+52                                                08183000
GDTESA   EQU   GDTTBL+56                                                08184000
GDTRST   EQU   GDTTBL+60                                                08185000
GDTRES   EQU   GDTTBL+64                                                08186000
GDTCAL   EQU   GDTTBL+68                                                08187000
GDTGSP   EQU   GDTTBL+72                                                08188000
GDTFSP   EQU   GDTTBL+76                                                08189000
GDTGPL   EQU   GDTTBL+80                                                08190000
GDTFPL   EQU   GDTTBL+84                                                08191000
GDTLOD   EQU   GDTTBL+88                                                08192000
GDTDEL   EQU   GDTTBL+92                                                08193000
GDTPRL   EQU   GDTTBL+96                                                08194000
GDTEPL   EQU   GDTTBL+100                                               08195000
GDTTIM   EQU   GDTTBL+104                                               08196000
GDTIIO   EQU   GDTTBL+108                                               08197000
GDTTIO   EQU   GDTTBL+112                                               08198000
GDTOPN   EQU   GDTTBL+124                                               08199000
GDTCLS   EQU   GDTTBL+128                                               08200000
GDTGET   EQU   GDTTBL+132                                               08201000
GDTPUT   EQU   GDTTBL+136                                               08202000
GDTPOS   EQU   GDTTBL+140                                               08203000
GDTCPY   EQU   GDTTBL+144                                               08204000
GDTCAT   EQU   GDTTBL+148                                               08205000
GDTSNP   EQU   GDTTBL+164                                               08206000
GDTVFY   EQU   GDTTBL+172                                               08207000
GDTUID   EQU   GDTTBL+192                                               08208000
GDTPMT   EQU   GDTTBL+196                                               08209000
GDTCIR   EQU   GDTTBL+200                                               08210000
GDTLNK   EQU   GDTTBL+204                                               08211000
GDTALC   EQU   GDTTBL+208                                               08212000
GDTDLC   EQU   GDTTBL+212                                               08213000
GDTQAL   EQU   GDTTBL+216                                               08214000
GDTSTW   EQU   GDTTBL+220                                               08215000
GDTSSC   EQU   GDTTBL+224                                               08216000
GDTENQ   EQU   GDTTBL+228                                               08217000
GDTRSV   EQU   GDTTBL+232                                               08218000
GDTDEQ   EQU   GDTTBL+236                                               08219000
GDTSFO   EQU   GDTTBL+240                                               08220000
GDTWTO   EQU   GDTTBL+244                                               08221000
GDTSCR   EQU   GDTTBL+248                                               08222000
GDTUNT   EQU   GDTTBL+252                                               08223000
GDTRCT   EQU   GDTTBL+256                                               08224000
GDTIFO   EQU   GDTTBL+260                                               08225000
GDTEXP   EQU   GDTTBL+264                                               08226000
GDTSTA   EQU   GDTTBL+268                                               08227000
GDTERR   EQU   GDTTBL+272                                               08228000
GDTUNC   EQU   GDTTBL+276                                               08229000
GDTLOC   EQU   GDTTBL+280                                               08230000
GDTRCK   EQU   GDTTBL+284                                               08231000
FDTTBL   EQU   0                                                        08232000
FDTPTR   EQU   FDTTBL+8                                                 08233000
LASTCOND EQU   0                                                        08234000
S1       EQU   0                                                        08235000
GETDTYPE EQU   0                                                        08236000
GETDSEC  EQU   0                                                        08237000
GETDCC   EQU   GETDSEC+1                                                08238000
GETDHH   EQU   GETDSEC+2                                                08239000
SSRCODE  EQU   0                                                        08240000
SSRHALF  EQU   SSRCODE+2                                                08241000
SSECBCD  EQU   0                                                        08242000
QWPARM   EQU   QUPARM                                                   08243000
QWRES1   EQU   QWPARM                                                   08244000
QWSSID   EQU   QWRES1                                                   08245000
QWFLAG   EQU   QWPARM+2                                                 08246000
QWMEM    EQU   QWFLAG                                                   08247000
QWALTMSC EQU   QWFLAG                                                   08248000
QTPARM   EQU   QUPARM                                                   08249000
QTID     EQU   QTPARM                                                   08250000
QTFLAG   EQU   QTPARM+1                                                 08251000
QTDASCHR EQU   QTPARM+20                                                08252000
QLPARM   EQU   QUPARM                                                   08253000
QCPARM   EQU   QUPARM                                                   08254000
*                                      START UNREFERENCED COMPONENTS    08255000
QCMAD3Z1 EQU   QCPARM+28                                                08256000
QCMAD3Z0 EQU   QCPARM+24                                                08257000
QCMAD2Z1 EQU   QCPARM+20                                                08258000
QCMAD2Z0 EQU   QCPARM+16                                                08259000
QCMAD1Z1 EQU   QCPARM+12                                                08260000
QCMAD1Z0 EQU   QCPARM+8                                                 08261000
QCMAD0Z1 EQU   QCPARM+4                                                 08262000
QCMAD0Z0 EQU   QCPARM                                                   08263000
QLRES    EQU   QLPARM+2                                                 08264000
QLZYX    EQU   QLPARM                                                   08265000
QTRES    EQU   QTPARM+24                                                08266000
QTDATA   EQU   QTPARM+2                                                 08267000
QTTABID  EQU   QTID                                                     08268000
QWRES2   EQU   QWPARM+3                                                 08269000
@NM00093 EQU   QWFLAG                                                   08270000
@NM00103 EQU   SSRCODE                                                  08271000
GETDRR   EQU   GETDSEC+3                                                08272000
@NM00102 EQU   GETDSEC                                                  08273000
FDTVERB  EQU   FDTTBL                                                   08274000
GDTECT   EQU   GDTTBL+188                                               08275000
GDTPSB   EQU   GDTTBL+184                                               08276000
GDTUPT   EQU   GDTTBL+180                                               08277000
GDTCMB   EQU   GDTTBL+176                                               08278000
GDTSPR   EQU   GDTTBL+168                                               08279000
@NM00001 EQU   GDTTBL+160                                               08280000
GDTABH   EQU   GDTTBL+156                                               08281000
GDTABT   EQU   GDTTBL+152                                               08282000
GDTTOH   EQU   GDTTBL+120                                               08283000
GDTRIP   EQU   GDTTBL+116                                               08284000
GDTIOH   EQU   GDTTBL+36                                                08285000
GDTSAH   EQU   GDTTBL+32                                                08286000
GDTTPH   EQU   GDTTBL+28                                                08287000
GDTRIH   EQU   GDTTBL+24                                                08288000
GDTSTH   EQU   GDTTBL+20                                                08289000
GDTDBH   EQU   GDTTBL+16                                                08290000
GDTPRM   EQU   GDTTBL+4                                                 08291000
GDTHDR   EQU   GDTTBL                                                   08292000
QURES1   EQU   QUFLAG                                                   08293000
QULIB    EQU   QUCODE                                                   08294000
QURES    EQU   QUERYLST+5                                               08295000
QUORD    EQU   QUERYLST+4                                               08296000
QULEN    EQU   QUERYLST                                                 08297000
ODSLEN   EQU   ODS+20                                                   08298000
ODSMEM   EQU   ODS+12                                                   08299000
ODSMLN   EQU   ODS+11                                                   08300000
ODSFUQ   EQU   ODSFLG                                                   08301000
ODSPOS   EQU   ODS+9                                                    08302000
ODSPAS   EQU   ODS+1                                                    08303000
ODSPLN   EQU   ODS                                                      08304000
OFILELEN EQU   OFILE                                                    08305000
VSDDSN   EQU   VSDARRAY+4                                               08306000
VSDVOLCT EQU   VSDARRAY                                                 08307000
VSDFMT0  EQU   VSDBLOCK+8                                               08308000
VSDVTOCS EQU   VSDBLOCK+4                                               08309000
VSDELEM  EQU   VSDBLOCK                                                 08310000
VSDFREE  EQU   VSDUSAGE+24                                              08311000
VSDALLC  EQU   VSDUSAGE+19                                              08312000
VSDDSOR3 EQU   VSDDSORG+2                                               08313000
@NM00092 EQU   VSDDSORG                                                 08314000
VSDSCAL  EQU   VSDUSAGE+12                                              08315000
@NM00091 EQU   VSDUSEF                                                  08316000
VSDCALFR EQU   VSDUSEF                                                  08317000
@NM00090 EQU   VSDALLOC                                                 08318000
VSDABSTR EQU   VSDALLOC                                                 08319000
VSDABLK  EQU   VSDALLOC                                                 08320000
VSDATRK  EQU   VSDALLOC                                                 08321000
VSDACYL  EQU   VSDALLOC                                                 08322000
@NM00089 EQU   VSDDORG                                                  08323000
VSDOU    EQU   VSDDORG                                                  08324000
VSDOIS   EQU   VSDDORG                                                  08325000
VSDODA   EQU   VSDDORG                                                  08326000
VSDOUN   EQU   VSDDORG                                                  08327000
VSDOPS   EQU   VSDDORG                                                  08328000
VSDOPO   EQU   VSDDORG                                                  08329000
VSDEXTS  EQU   VSDUSAGE+8                                               08330000
VSDSECAL EQU   VSDUSAGE+4                                               08331000
VSDFTRK  EQU   VSDUSAGE+2                                               08332000
VSDTRKS  EQU   VSDUSAGE                                                 08333000
@NM00088 EQU   VSDSCR+5                                                 08334000
@NM00087 EQU   VSDSCRFL                                                 08335000
VSDVSAM  EQU   VSDSCRFL                                                 08336000
VSDCATLC EQU   VSDSCRFL                                                 08337000
VSDACBPT EQU   VSDSCR                                                   08338000
@NM00086 EQU   VSDSTAT+29                                               08339000
VSDPRTC  EQU   VSDSTAT+25                                               08340000
VSDCAT   EQU   VSDSTAT+22                                               08341000
VSDEXP   EQU   VSDSTAT+20                                               08342000
VSDCRE   EQU   VSDSTAT+18                                               08343000
@NM00085 EQU   VSDFLG2                                                  08344000
VSDRACF  EQU   VSDFLG2                                                  08345000
VSDERROR EQU   VSDFLG2                                                  08346000
VSDPROT  EQU   VSDFLG2                                                  08347000
VSDPWW   EQU   VSDFLG2                                                  08348000
VSDPWR   EQU   VSDFLG2                                                  08349000
@NM00084 EQU   VSDSFLG1                                                 08350000
VSDCVSAM EQU   VSDSFLG1                                                 08351000
VSDCATLG EQU   VSDSFLG1                                                 08352000
VSDVSAME EQU   VSDSFLG1                                                 08353000
VSDVSAMC EQU   VSDSFLG1                                                 08354000
VSDVTOCE EQU   VSDSFLG1                                                 08355000
VSDVTOCC EQU   VSDSFLG1                                                 08356000
VSDOWNER EQU   VSDSTAT+8                                                08357000
VSDEXPIR EQU   VSDSTAT+4                                                08358000
VSDCREAT EQU   VSDSTAT                                                  08359000
VSDFRCCL EQU   VSDVTOC+21                                               08360000
@NM00083 EQU   VSDVTOC+20                                               08361000
VSDFREXT EQU   VSDVTOC+16                                               08362000
@NM00082 EQU   VSDVTOC+15                                               08363000
VSDFRTRK EQU   VSDVTOC+11                                               08364000
@NM00081 EQU   VSDVTOC+10                                               08365000
VSDFRCYL EQU   VSDVTOC+6                                                08366000
@NM00080 EQU   VSDVTOC                                                  08367000
@NM00079 EQU   VS3FLAGS                                                 08368000
VS3SYSNM EQU   VS3FLAGS                                                 08369000
VS3UNCAT EQU   VS3FLAGS                                                 08370000
VS3SCR   EQU   VS3FLAGS                                                 08371000
VS3USAGE EQU   VS3FLAGS                                                 08372000
VS3STAT  EQU   VS3FLAGS                                                 08373000
VS3DD    EQU   VS3AGL+50                                                08374000
VS3VOL   EQU   VS3AGL+44                                                08375000
VS3POOL  EQU   VS3AGL+40                                                08376000
VS3DEV   EQU   VS3AGL+36                                                08377000
VS3UCBP  EQU   VS3AGL+32                                                08378000
VS3CREAT EQU   VS3AGL+28                                                08379000
VS3EXPIR EQU   VS3AGL+24                                                08380000
VS3AST   EQU   VS3AGL+22                                                08381000
VS3LEVLN EQU   VS3AGL+20                                                08382000
VS3LEVP  EQU   VS3AGL+16                                                08383000
VS3EXDSP EQU   VS3AGL+12                                                08384000
VS3LISTP EQU   VS3AGL+8                                                 08385000
VS3HEAD  EQU   VS3AGL                                                   08386000
@NM00078 EQU   DATESOPT                                                 08387000
DATDAYOP EQU   DATESOPT                                                 08388000
DATDTEOP EQU   DATESOPT                                                 08389000
DATSUB   EQU   DATESOPT                                                 08390000
DATADD   EQU   DATESOPT                                                 08391000
DATRETRN EQU   DATESAGL+16                                              08392000
DATDAYS  EQU   DATESAGL+12                                              08393000
DATDATE  EQU   DATESAGL+8                                               08394000
DATHEAD  EQU   DATESAGL                                                 08395000
@NM00077 EQU   SELFLAGS                                                 08396000
SELVOL   EQU   SELAGL+16                                                08397000
SELDDNP  EQU   SELAGL+12                                                08398000
SELUCBP  EQU   SELAGL+8                                                 08399000
SELHEAD  EQU   SELAGL                                                   08400000
@NM00076 EQU   UCTFLAGS                                                 08401000
UCTVSCAT EQU   UCTFLAGS                                                 08402000
UCTDD    EQU   UCTAGL+60                                                08403000
UCTVOLP  EQU   UCTAGL+56                                                08404000
UCTACBP  EQU   UCTAGL+52                                                08405000
UCTDSN   EQU   UCTAGL+8                                                 08406000
UCTHEAD  EQU   UCTAGL                                                   08407000
@NM00075 EQU   LCTFLAGS                                                 08408000
LCTVSCAT EQU   LCTFLAGS                                                 08409000
LCTOWNER EQU   LCTINFO+24                                               08410000
LCTEXPIR EQU   LCTINFO+20                                               08411000
LCTCREAT EQU   LCTINFO+16                                               08412000
LCTACBP  EQU   LCTINFO+12                                               08413000
LCTMULVC EQU   LCTINFO+8                                                08414000
LCTHEAD  EQU   LCTINFO                                                  08415000
SRTWORKP EQU   SRTAGL+28                                                08416000
SRTFLDLN EQU   SRTAGL+24                                                08417000
SRTPOSIT EQU   SRTAGL+20                                                08418000
SRTLEN   EQU   SRTAGL+16                                                08419000
SRTNUM   EQU   SRTAGL+12                                                08420000
SRTADDR  EQU   SRTAGL+8                                                 08421000
SRTHEAD  EQU   SRTAGL                                                   08422000
SV82DEBP EQU   SV82WRKP                                                 08423000
SV82TTRP EQU   SV82LIST+8                                               08424000
SV82VOLP EQU   SV82DCBP                                                 08425000
SV82UCBP EQU   SV82LIST+1                                               08426000
SV82CODE EQU   SV82LIST                                                 08427000
VOLRESV3 EQU   VOLLABEL+55                                              08428000
VOLOWNER EQU   VOLLABEL+45                                              08429000
VOLRESV1 EQU   VOLLABEL+20                                              08430000
VOLVTOC  EQU   VOLLABEL+15                                              08431000
VOLSECTY EQU   VOLLABEL+14                                              08432000
VOLSERNO EQU   VOLLABEL+8                                               08433000
VOLNO    EQU   VOLLABEL+7                                               08434000
VOLLABI  EQU   VOLLABEL+4                                               08435000
VOLKEY   EQU   VOLLABEL                                                 08436000
STAVTTR  EQU   STAEPARM+54                                              08437000
@NM00072 EQU   STARETRY                                                 08438000
STAVTOC  EQU   STARETRY                                                 08439000
STAOFF   EQU   STARETRY                                                 08440000
STAIO05  EQU   STARETRY                                                 08441000
@NM00071 EQU   STARCVY                                                  08442000
STACLEAR EQU   STARCVY                                                  08443000
STAVPOST EQU   STARCVY                                                  08444000
STAVENQ  EQU   STARCVY                                                  08445000
STAVDMNT EQU   STARCVY                                                  08446000
STAVMNT  EQU   STARCVY                                                  08447000
STATCB   EQU   STAEPARM+48                                              08448000
STARTADD EQU   STAEPARM+44                                              08449000
STAEXSAV EQU   STAEPARM+40                                              08450000
STARTSAV EQU   STAEPARM+36                                              08451000
STARTTR  EQU   STAEPARM+32                                              08452000
@NM00070 EQU   STAEPARM+30                                              08453000
STARVOL  EQU   STAEPARM+24                                              08454000
STARUCB  EQU   STAEPARM+20                                              08455000
@NM00069 EQU   STAEPARM+18                                              08456000
STAVVOL  EQU   STAEPARM+12                                              08457000
STAVUCB  EQU   STAEPARM+8                                               08458000
STAHEAD  EQU   STAEPARM                                                 08459000
RCTDSET  EQU   RCTAGL+32                                                08460000
RCTNVOL  EQU   RCTAGL+26                                                08461000
RCTOVOL  EQU   RCTAGL+20                                                08462000
RCTNDEV  EQU   RCTAGL+16                                                08463000
RCTODEV  EQU   RCTAGL+12                                                08464000
@NM00068 EQU   RCTAGL+10                                                08465000
@NM00067 EQU   RCTOPT                                                   08466000
RCTVOL   EQU   RCTOPT                                                   08467000
RCTDEV   EQU   RCTOPT                                                   08468000
RCTHEAD  EQU   RCTAGL                                                   08469000
@NM00066 EQU   VSRESOPT                                                 08470000
VSREAL   EQU   VSRESOPT                                                 08471000
VSRES    EQU   VSRESOPT                                                 08472000
@NM00065 EQU   VSMSG                                                    08473000
VSTOV    EQU   VSMSG                                                    08474000
VSFROMV  EQU   VSMSG                                                    08475000
@NM00064 EQU   VSRETURN                                                 08476000
VSUCAT   EQU   VSRETURN                                                 08477000
VSVSAM   EQU   VSRETURN                                                 08478000
@NM00063 EQU   VSCATOPT                                                 08479000
VSLIST   EQU   VSCATOPT                                                 08480000
VSSERIAL EQU   VSCATOPT                                                 08481000
VSDEVICE EQU   VSCATOPT                                                 08482000
@NM00062 EQU   VSVTOPT                                                  08483000
VSVSFLAG EQU   VSVTOPT                                                  08484000
VSALTTRK EQU   VSVTOPT                                                  08485000
VSTIME   EQU   VSVTOPT                                                  08486000
VSUCMAST EQU   VSSECOPT                                                 08487000
VSOPCAT  EQU   VSSECOPT                                                 08488000
VSUCTEST EQU   VSSECOPT                                                 08489000
VSWRITE  EQU   VSSECOPT                                                 08490000
VSREAD   EQU   VSSECOPT                                                 08491000
VSNONONV EQU   VSSECOPT                                                 08492000
VSMASTER EQU   VSSECOPT                                                 08493000
VSNOVSAM EQU   VSSECOPT                                                 08494000
VSODEVP  EQU   VS1AGL+64                                                08495000
VSOSERP  EQU   VS1AGL+60                                                08496000
VSDEVP   EQU   VS1AGL+56                                                08497000
VSSERP   EQU   VS1AGL+52                                                08498000
VSPFILEP EQU   VS1AGL+48                                                08499000
VSPSWDP  EQU   VS1AGL+44                                                08500000
VSCATDDP EQU   VS1AGL+40                                                08501000
VSACBP   EQU   VS1AGL+36                                                08502000
VSCATP   EQU   VS1AGL+32                                                08503000
VSNXTATP EQU   VS1AGL+28                                                08504000
VSNUMATP EQU   VS1AGL+24                                                08505000
VSIOP    EQU   VS1AGL+20                                                08506000
VSFILEP  EQU   VS1AGL+16                                                08507000
VSVOLP   EQU   VS1AGL+12                                                08508000
VSUCBP   EQU   VS1AGL+8                                                 08509000
VSHEAD   EQU   VS1AGL                                                   08510000
VSVTOCPT EQU   VS2AGL+48                                                08511000
@NM00061 EQU   VS2AGL+45                                                08512000
VSDDNAME EQU   VS2AGL+37                                                08513000
@NM00060 EQU   VS2RESOP                                                 08514000
VS2REAL  EQU   VS2RESOP                                                 08515000
VS2RES   EQU   VS2RESOP                                                 08516000
@NM00059 EQU   VS2MSG                                                   08517000
VS2TOV   EQU   VS2MSG                                                   08518000
VSVOLUME EQU   VS2AGL+29                                                08519000
@NM00058 EQU   VSLABOPT                                                 08520000
VSNOVTOC EQU   VSLABOPT                                                 08521000
VSVOLSER EQU   VSLABOPT                                                 08522000
VSOWNER  EQU   VSLABOPT                                                 08523000
VSIOBKPT EQU   VS2AGL+24                                                08524000
VSVOLPTR EQU   VS2AGL+20                                                08525000
VSOWNPTR EQU   VS2AGL+16                                                08526000
VSVTOCSZ EQU   VS2AGL+12                                                08527000
VSUCBPTR EQU   VS2AGL+8                                                 08528000
VS2HEAD  EQU   VS2AGL                                                   08529000
EXPDATAL EQU   EXPARRAY+6                                               08530000
@NM00057 EQU   EXPARRAY+5                                               08531000
EXPKEYLN EQU   EXPARRAY+4                                               08532000
EXPDATAP EQU   EXPARRAY                                                 08533000
EXPRECNO EQU   EXPDATAB                                                 08534000
EXPCCHHR EQU   EXPARG+16                                                08535000
EXPCTLBK EQU   EXPARG+8                                                 08536000
EXPHEAD  EQU   EXPARG                                                   08537000
EXRWFUN  EQU   EXWRARG+46                                               08538000
@NM00056 EQU   EXSPACE+8                                                08539000
@NM00055 EQU   EXSPACE+6                                                08540000
@NM00054 EQU   EXSPACE+4                                                08541000
@NM00053 EQU   EXSPACE+1                                                08542000
@NM00052 EQU   EXSPACE                                                  08543000
EXRWKDLN EQU   EXWRARG+32                                               08544000
@NM00051 EQU   EXWRARG+31                                               08545000
EXRECNUM EQU   EXRWCHR+4                                                08546000
EXHH     EQU   EXRWCHR+2                                                08547000
EXCC     EQU   EXRWCHR                                                  08548000
EXCCWCNT EQU   EXWRARG+24                                               08549000
EXLOCPTR EQU   EXWRARG+20                                               08550000
EXRWDARE EQU   EXWRARG+16                                               08551000
EXRWIOAR EQU   EXWRARG+12                                               08552000
EXRWCTBL EQU   EXWRARG+8                                                08553000
EXRWRES  EQU   EXWRARG                                                  08554000
EXGDATAL EQU   EXGARG+30                                                08555000
@NM00050 EQU   EXGARG+29                                                08556000
EXGKEYLN EQU   EXGARG+28                                                08557000
EXGDATAP EQU   EXGARG+24                                                08558000
EXGRECNO EQU   EXGARG+20                                                08559000
EXGCCHH2 EQU   EXGARG+16                                                08560000
EXGCCHH1 EQU   EXGARG+12                                                08561000
EXGCTLBK EQU   EXGARG+8                                                 08562000
EXGHEAD  EQU   EXGARG                                                   08563000
EXOVTH   EQU   EXFLG                                                    08564000
EXORVT   EQU   EXFLG                                                    08565000
EXORDS   EQU   EXFLG                                                    08566000
EXOSPK   EQU   EXFLG                                                    08567000
EXORVS   EQU   EXFLG                                                    08568000
@NM00049 EQU   EXFLG                                                    08569000
EXOREAD  EQU   EXFLG                                                    08570000
@NM00048 EQU   EXOPT                                                    08571000
EXOREP   EQU   EXOPT                                                    08572000
EXOVTOC  EQU   EXOPT                                                    08573000
EXONEW   EQU   EXOPT                                                    08574000
EXOPASS  EQU   EXOPT                                                    08575000
EXOLAB   EQU   EXOPT                                                    08576000
EXOTAB   EQU   EXOPT                                                    08577000
EXOCTLBK EQU   EXOARG+28                                                08578000
EXOEXT   EQU   EXOARG+24                                                08579000
EXOUCB   EQU   EXOARG+20                                                08580000
EXOVSN   EQU   EXOARG+16                                                08581000
EXODSN   EQU   EXOARG+12                                                08582000
EXODDN   EQU   EXOARG+8                                                 08583000
EXOHEAD  EQU   EXOARG                                                   08584000
@NM00047 EQU   EXCLFLAG                                                 08585000
EXCLMNT  EQU   EXCLFLAG                                                 08586000
EXCLVOL  EQU   EXCLAGL+16                                               08587000
EXCLDDP  EQU   EXCLAGL+12                                               08588000
EXCLUCBP EQU   EXCLAGL+8                                                08589000
EXCLHEAD EQU   EXCLAGL                                                  08590000
@NM00046 EQU   CKFLAGS                                                  08591000
CKDMTABL EQU   CKFLAGS                                                  08592000
CKRETTYP EQU   CKFLAGS                                                  08593000
CKTESTVT EQU   CKFLAGS                                                  08594000
CKLABELP EQU   CKAGL+24                                                 08595000
CKDATYPE EQU   CKAGL+20                                                 08596000
CKDDNAME EQU   CKAGL+12                                                 08597000
CKUCBPTR EQU   CKAGL+8                                                  08598000
CKHEAD   EQU   CKAGL                                                    08599000
PULABELP EQU   PUAGL+16                                                 08600000
PUTTRPTR EQU   PUAGL+12                                                 08601000
PUUCBPTR EQU   PUAGL+8                                                  08602000
PUHEAD   EQU   PUAGL                                                    08603000
MDR      EQU   MDVTOC+4                                                 08604000
MDHH     EQU   MDVTOC+2                                                 08605000
MDCC     EQU   MDVTOC                                                   08606000
@NM00045 EQU   MDAGL+31                                                 08607000
MDVTOCTR EQU   MDFLAGS                                                  08608000
MDFORCE  EQU   MDFLAGS                                                  08609000
MDDEQ    EQU   MDFLAGS                                                  08610000
MDENQ    EQU   MDFLAGS                                                  08611000
MDWAIT   EQU   MDFLAGS                                                  08612000
MDPOST   EQU   MDFLAGS                                                  08613000
MDCLEAR  EQU   MDFLAGS                                                  08614000
MDNEWVOL EQU   MDFLAGS                                                  08615000
MDLABEL  EQU   MDAGL+24                                                 08616000
MDPUAGL  EQU   MDAGL+20                                                 08617000
MDDDNAME EQU   MDAGL+12                                                 08618000
MDUCBPTR EQU   MDAGL+8                                                  08619000
MDHEAD   EQU   MDAGL                                                    08620000
CTTBLRR  EQU   CTARRAY+3                                                08621000
CTTBLHH  EQU   CTARRAY+2                                                08622000
CTTBLCC  EQU   CTARRAY+1                                                08623000
CTTBLID  EQU   CTARRAY                                                  08624000
CTREALH  EQU   CTMSG+3                                                  08625000
CTREALCC EQU   CTMSG+1                                                  08626000
@NM00044 EQU   CTMSG                                                    08627000
CMCSN2   EQU   CMMSG+28                                                 08628000
CMCSN1   EQU   CMMSG+16                                                 08629000
CMNUMCRT EQU   CMMSG+15                                                 08630000
@NM00043 EQU   CMMSG+14                                                 08631000
CMNEWVOL EQU   CMMSG+8                                                  08632000
@NM00042 EQU   CMMSG+7                                                  08633000
@NM00041 EQU   CMVOLFLG                                                 08634000
CMRONLY  EQU   CMVOLFLG                                                 08635000
CMBIND   EQU   CMVOLFLG                                                 08636000
CMSCRCRT EQU   CMVOLFLG                                                 08637000
CMEXCL   EQU   CMVOLFLG                                                 08638000
CMDERAS  EQU   CMVOLFLG                                                 08639000
CMSCRVOL EQU   CMVOLFLG                                                 08640000
CMCECART EQU   CMVOLFLG                                                 08641000
CMOLDVOL EQU   CMMSG                                                    08642000
CCOLDCSN EQU   CCMSG+24                                                 08643000
CCNEWCSN EQU   CCMSG+12                                                 08644000
@NM00040 EQU   CCMSG+10                                                 08645000
CCVOL    EQU   CCMSG+4                                                  08646000
@NM00039 EQU   CCMSG+2                                                  08647000
CCEJCODE EQU   CCMSG+1                                                  08648000
CCPSTCDE EQU   CCMSG                                                    08649000
@NM00038 EQU   DMPARY+15                                                08650000
DMPARYTP EQU   DMPARY+14                                                08651000
DMPARYEX EQU   DMPARY+12                                                08652000
DMPARYIC EQU   DMPARY+10                                                08653000
DMPARYSZ EQU   DMPARY+8                                                 08654000
DMPARYNM EQU   DMPARY                                                   08655000
@NM00037 EQU   DMPITM+15                                                08656000
@NM00036 EQU   ERCNVTAB+24                                              08657000
ERDARBPT EQU   ERCPLPT                                                  08658000
ERDYNRC  EQU   ERCATRC                                                  08659000
ERDSNM   EQU   ERCNVTAB+12                                              08660000
@NM00035 EQU   ERCNVTAB+4                                               08661000
@NM00034 EQU   ERCNVTAB+3                                               08662000
@NM00033 EQU   EROSOPER                                                 08663000
EROSUCDX EQU   EROSOPER                                                 08664000
EROSCATL EQU   EROSOPER                                                 08665000
@NM00032 EQU   EROPER                                                   08666000
ERCATAL  EQU   EROPER                                                   08667000
ERCATDL  EQU   EROPER                                                   08668000
ERCATDE  EQU   EROPER                                                   08669000
ERCATLC  EQU   EROPER                                                   08670000
@NM00031 EQU   ERTYPE                                                   08671000
ERDYNAL  EQU   ERTYPE                                                   08672000
EROSCAT  EQU   ERTYPE                                                   08673000
ERCATLG  EQU   ERTYPE                                                   08674000
@NM00030 EQU   FMTCNVF+1                                                08675000
FMTAR    EQU   FMTCNVF+1                                                08676000
FMTBS    EQU   FMTCNVF+1                                                08677000
FMTSS    EQU   FMTCNVF+1                                                08678000
FMTAL    EQU   FMTCNVF+1                                                08679000
FMTZS    EQU   FMTCNVF+1                                                08680000
@NM00029 EQU   FMTCNVF                                                  08681000
FMTPU    EQU   FMTCNVF                                                  08682000
FMTBD    EQU   FMTCNVF                                                  08683000
FMTBHD   EQU   FMTCNVF                                                  08684000
FMTBHA   EQU   FMTCNVF                                                  08685000
FMTBH    EQU   FMTCNVF                                                  08686000
FMTRIO   EQU   FMTOCOL                                                  08687000
FMTSTL   EQU   FMTILEN                                                  08688000
@NM00028 EQU   FMTFLGS+1                                                08689000
FMTSMSG  EQU   FMTFLGS+1                                                08690000
FMTHDF   EQU   FMTFLGS                                                  08691000
FMTDFF   EQU   FMTFLGS                                                  08692000
FMTSTF   EQU   FMTFLGS                                                  08693000
FMTREPF  EQU   FMTFLGS                                                  08694000
FMTIDF   EQU   FMTFLGS                                                  08695000
DARGPCT  EQU   DARGINL                                                  08696000
DARGREP  EQU   DARGINS                                                  08697000
@NM00027 EQU   DARGLIST+19                                              08698000
DARGIND  EQU   DARGLIST+18                                              08699000
UVOLVOL  EQU   UVOLENT+4                                                08700000
UVOLDEV  EQU   UVOLENT                                                  08701000
UVOLCNT  EQU   UVOLLIST                                                 08702000
@NM00026 EQU   IOINFOPT                                                 08703000
IOINFLUB EQU   IOINFOPT                                                 08704000
IOINFTMS EQU   IOINFOPT                                                 08705000
IOINFSUP EQU   IOINFOPT                                                 08706000
IOINFDSN EQU   IOINFOPT                                                 08707000
IOINFVOL EQU   IOINFOPT                                                 08708000
IOINFDVT EQU   IOINFOPT                                                 08709000
OPNVOL   EQU   OPNAGL+44                                                08710000
OPNSTRNO EQU   OPNAGL+43                                                08711000
@NM00025 EQU   OPNOPT2                                                  08712000
OPNOPTJM EQU   OPNOPT2                                                  08713000
OPNOPTNM EQU   OPNOPT2                                                  08714000
OPNOPTAS EQU   OPNOPT2                                                  08715000
@NM00024 EQU   OPNDSO                                                   08716000
OPNDSOPO EQU   OPNDSO                                                   08717000
OPNDSOIS EQU   OPNDSO                                                   08718000
OPNDSOPS EQU   OPNDSO                                                   08719000
OPNDSOAM EQU   OPNDSO                                                   08720000
OPNKYL   EQU   OPNAGL+40                                                08721000
OPNBLK   EQU   OPNAGL+36                                                08722000
OPNREC   EQU   OPNAGL+32                                                08723000
OPNDEVIX EQU   OPNDEV+4                                                 08724000
OPNDEVDT EQU   OPNDEV                                                   08725000
OPNCBP   EQU   OPNAGL+20                                                08726000
OPNPWA   EQU   OPNAGL+12                                                08727000
OPNMODRP EQU   OPNMOD                                                   08728000
OPNMODUB EQU   OPNMOD                                                   08729000
OPNMODRS EQU   OPNMOD                                                   08730000
OPNMODAX EQU   OPNMOD                                                   08731000
OPNMODRR EQU   OPNMOD                                                   08732000
OPNMODRC EQU   OPNMOD                                                   08733000
OPNMODPD EQU   OPNMOD                                                   08734000
OPNTYPSY EQU   OPNTYP                                                   08735000
OPNTYPRV EQU   OPNTYP                                                   08736000
OPNTYPEX EQU   OPNTYP                                                   08737000
OPNTYPRA EQU   OPNTYP                                                   08738000
OPNTYPXM EQU   OPNTYP                                                   08739000
OPNTYPCI EQU   OPNTYP                                                   08740000
OPNTYPSO EQU   OPNTYP                                                   08741000
OPNTYPSI EQU   OPNTYP                                                   08742000
@NM00023 EQU   OPNRFM                                                   08743000
OPNRFMBK EQU   OPNRFM                                                   08744000
OPNRFMSF EQU   OPNRFM                                                   08745000
OPNRFMUN EQU   OPNRFM                                                   08746000
OPNRFMVR EQU   OPNRFM                                                   08747000
OPNRFMFX EQU   OPNRFM                                                   08748000
OPNOPTSK EQU   OPNOPT                                                   08749000
OPNOPTDR EQU   OPNOPT                                                   08750000
OPNOPTCR EQU   OPNOPT                                                   08751000
OPNOPTKS EQU   OPNOPT                                                   08752000
OPNOPTBK EQU   OPNOPT                                                   08753000
OPNOPTUP EQU   OPNOPT                                                   08754000
OPNOPTIN EQU   OPNOPT                                                   08755000
IOCEXT   EQU   IOCSTR+64                                                08756000
IOCTSML  EQU   IOCREL+2                                                 08757000
IOCTPML  EQU   IOCREL                                                   08758000
IOCWORK  EQU   IOCSTR+56                                                08759000
IOCRRN   EQU   IOCSTR+52                                                08760000
IOCPNM   EQU   IOCNWM+2                                                 08761000
IOCPTL   EQU   IOCNWM                                                   08762000
IOCKYA   EQU   IOCMEM                                                   08763000
IOCVRC   EQU   IOCTTR                                                   08764000
IOCCBP   EQU   IOCSTR+36                                                08765000
IOCDSN   EQU   IOCSTR+32                                                08766000
IOCHURBA EQU   IOCSTR+28                                                08767000
IOCVOLSR EQU   IOCSTR+22                                                08768000
@NM00022 EQU   IOCMSG                                                   08769000
IOCMSGSM EQU   IOCMSG                                                   08770000
IOCMSGAE EQU   IOCMSG                                                   08771000
IOCMSGCE EQU   IOCMSG                                                   08772000
IOCMSGOE EQU   IOCMSG                                                   08773000
IOCMSGOP EQU   IOCMSG                                                   08774000
IOCCHPKG EQU   IOCMSG                                                   08775000
IOCCHPKE EQU   IOCMSG                                                   08776000
IOCCHPNU EQU   IOCCHP                                                   08777000
IOCCHPUP EQU   IOCCHP                                                   08778000
IOCCHPBK EQU   IOCCHP                                                   08779000
IOCCHPCR EQU   IOCCHP                                                   08780000
IOCCHPKS EQU   IOCCHP                                                   08781000
IOCCHPSK EQU   IOCCHP                                                   08782000
IOCCHPDR EQU   IOCCHP                                                   08783000
IOCCHPSQ EQU   IOCCHP                                                   08784000
IOCMACNT EQU   IOCMAC2                                                  08785000
IOCMACER EQU   IOCMAC2                                                  08786000
IOCMACPA EQU   IOCMAC2                                                  08787000
IOCMACEN EQU   IOCMAC2                                                  08788000
IOCMACCP EQU   IOCMAC2                                                  08789000
IOCMACRR EQU   IOCMAC2                                                  08790000
IOCMACAS EQU   IOCMAC2                                                  08791000
IOCMACSK EQU   IOCMAC2                                                  08792000
@NM00021 EQU   IOCMAC                                                   08793000
IOCMACCC EQU   IOCMAC                                                   08794000
IOCMACDR EQU   IOCMAC                                                   08795000
IOCMACBK EQU   IOCMAC                                                   08796000
IOCMACCR EQU   IOCMAC                                                   08797000
IOCMACUP EQU   IOCMAC                                                   08798000
IOCMACOT EQU   IOCMAC                                                   08799000
IOCMACIN EQU   IOCMAC                                                   08800000
@NM00020 EQU   IOCRFM                                                   08801000
IOCRFMBK EQU   IOCRFM                                                   08802000
IOCRFMSF EQU   IOCRFM                                                   08803000
IOCRFMUN EQU   IOCRFM                                                   08804000
IOCRFMVR EQU   IOCRFM                                                   08805000
IOCRFMFX EQU   IOCRFM                                                   08806000
@NM00019 EQU   IOCDSO                                                   08807000
IOCDSOPO EQU   IOCDSO                                                   08808000
IOCDSOIS EQU   IOCDSO                                                   08809000
IOCDSOPS EQU   IOCDSO                                                   08810000
IOCDSOAM EQU   IOCDSO                                                   08811000
IOCRKP   EQU   IOCSTR+13                                                08812000
IOCKYL   EQU   IOCSTR+12                                                08813000
IOCTRN   EQU   IOCSTR+8                                                 08814000
IOCDLN   EQU   IOCSTR+4                                                 08815000
IOCDAD   EQU   IOCSTR                                                   08816000
UNITVTOC EQU   UNITABL+7                                                08817000
@NM00018 EQU   UNITSTAT                                                 08818000
UNITUSHR EQU   UNITSTAT                                                 08819000
UNITXSHR EQU   UNITSTAT                                                 08820000
UNITISHR EQU   UNITSTAT                                                 08821000
UNITUA   EQU   @NM00017+1                                               08822000
UNITCHA  EQU   @NM00017                                                 08823000
UNITUCB  EQU   UNITABL                                                  08824000
RACFVOLS EQU   RACFAGL+16                                               08825000
RACFCLN  EQU   RACFAGL+12                                               08826000
RACFPROF EQU   RACFAGL+8                                                08827000
RACFENT  EQU   RACFAGL+4                                                08828000
@NM00016 EQU   RACFFLG4                                                 08829000
@NM00015 EQU   RACFFLG3                                                 08830000
RACFPRF  EQU   RACFFLG3                                                 08831000
@NM00014 EQU   RACFFLG3                                                 08832000
@NM00013 EQU   RACFFLG2                                                 08833000
RACFTRD  EQU   RACFFLG2                                                 08834000
RACFTUPD EQU   RACFFLG2                                                 08835000
RACFTCTL EQU   RACFFLG2                                                 08836000
@NM00012 EQU   RACFFLG2                                                 08837000
RACFTALT EQU   RACFFLG2                                                 08838000
RACFCSA  EQU   RACFFLG1                                                 08839000
RACFLOGN EQU   RACFFLG1                                                 08840000
RACFLOGF EQU   RACFFLG1                                                 08841000
@NM00011 EQU   RACFFLG1                                                 08842000
RACFDSTV EQU   RACFFLG1                                                 08843000
@NM00010 EQU   RACFFLG1                                                 08844000
ALLUNCNT EQU   ALLAGL+30                                                08845000
ALLVLCNT EQU   ALLAGL+29                                                08846000
@NM00009 EQU   ALLOPT                                                   08847000
ALLOPTUN EQU   ALLOPT                                                   08848000
ALLOPTPV EQU   ALLOPT                                                   08849000
ALLOPTDS EQU   ALLOPT                                                   08850000
ALLOPTVL EQU   ALLOPT                                                   08851000
@NM00008 EQU   ALLORG+1                                                 08852000
ALLORGVS EQU   ALLORG+1                                                 08853000
@NM00007 EQU   ALLORG+1                                                 08854000
ALLORGGS EQU   ALLORG+1                                                 08855000
ALLORGUN EQU   ALLORG                                                   08856000
ALLORGPO EQU   ALLORG                                                   08857000
ALLORGMQ EQU   ALLORG                                                   08858000
ALLORGCQ EQU   ALLORG                                                   08859000
ALLORGCX EQU   ALLORG                                                   08860000
ALLORGDA EQU   ALLORG                                                   08861000
ALLORGPS EQU   ALLORG                                                   08862000
ALLORGIS EQU   ALLORG                                                   08863000
ALLDSPUN EQU   ALLDSP                                                   08864000
ALLDSPCG EQU   ALLDSP                                                   08865000
ALLDSPDE EQU   ALLDSP                                                   08866000
ALLDSPKP EQU   ALLDSP                                                   08867000
@NM00006 EQU   ALLDSP                                                   08868000
ALLSTSOD EQU   ALLSTS                                                   08869000
ALLSTSMD EQU   ALLSTS                                                   08870000
ALLSTSNW EQU   ALLSTS                                                   08871000
ALLSTSSR EQU   ALLSTS                                                   08872000
@NM00005 EQU   ALLSTS                                                   08873000
ALLPWD   EQU   ALLAGL+20                                                08874000
ALLVLP   EQU   ALLAGL+16                                                08875000
ALLULP   EQU   ALLAGL+12                                                08876000
ALLDDN   EQU   ALLAGL+4                                                 08877000
ALLDSN   EQU   ALLAGL                                                   08878000
CIRPID   EQU   CIRAGL+28                                                08879000
CIRPWD   EQU   CIRAGL+24                                                08880000
CIRCAT   EQU   CIRAGL+20                                                08881000
CIRWKP   EQU   CIRAGL+16                                                08882000
CIRTLR   EQU   CIRAGL+12                                                08883000
CIRHDR   EQU   CIRAGL+8                                                 08884000
CIRTLN   EQU   CIRAGL+6                                                 08885000
CIRHLN   EQU   CIRAGL+4                                                 08886000
@NM00004 EQU   CIRAGL+1                                                 08887000
@NM00003 EQU   CIRTYPE                                                  08888000
CIRTYPAQ EQU   CIRTYPE                                                  08889000
CIRTYP1Q EQU   CIRTYPE                                                  08890000
NEWID1   EQU   TRACE1+95                                                08891000
CALLID   EQU   OLDERID1+90                                              08892000
@NM00002 EQU   OLDERID1                                                 08893000
*                                      END UNREFERENCED COMPONENTS      08894000
@RC00492 EQU   @RC00491                                                 08895000
@RC01210 EQU   @RC01206                                                 08896000
@RC01208 EQU   @RC01206                                                 08897000
@RF02111 EQU   @RC02096                                                 08898000
@PB00033 EQU   @EL00001                                                 08899000
@PB00032 EQU   @PB00033                                                 08900000
@PB00031 EQU   @PB00032                                                 08901000
@PB00030 EQU   @PB00031                                                 08902000
@PB00029 EQU   @PB00030                                                 08903000
@PB00028 EQU   @PB00029                                                 08904000
@PB00027 EQU   @PB00028                                                 08905000
@PB00026 EQU   @PB00027                                                 08906000
@PB00025 EQU   @PB00026                                                 08907000
@PB00024 EQU   @PB00025                                                 08908000
@PB00023 EQU   @PB00024                                                 08909000
@PB00022 EQU   @PB00023                                                 08910000
@PB00021 EQU   @PB00022                                                 08911000
@PB00020 EQU   @PB00021                                                 08912000
@PB00019 EQU   @PB00020                                                 08913000
@PB00018 EQU   @PB00019                                                 08914000
@PB00017 EQU   @PB00018                                                 08915000
@PB00016 EQU   @PB00017                                                 08916000
@PB00015 EQU   @PB00016                                                 08917000
@PB00014 EQU   @PB00015                                                 08918000
@PB00013 EQU   @PB00014                                                 08919000
@PB00012 EQU   @PB00013                                                 08920000
@PB00011 EQU   @PB00012                                                 08921000
@PB00010 EQU   @PB00011                                                 08922000
@PB00009 EQU   @PB00010                                                 08923000
@PB00008 EQU   @PB00009                                                 08924000
@PB00007 EQU   @PB00008                                                 08925000
@PB00006 EQU   @PB00007                                                 08926000
@PB00005 EQU   @PB00006                                                 08927000
@PB00004 EQU   @PB00005                                                 08928000
@PB00003 EQU   @PB00004                                                 08929000
@PB00002 EQU   @PB00003                                                 08930000
@ENDDATA EQU   *                                                        08931000
         END   IDCDU01,(C'PLS1901',0701,78010)                          08932000
