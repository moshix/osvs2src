         TITLE 'IDCEV01: EJECT VOLUME ROUTINE                          *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCEV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCEV01   74.298'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @10,0                                               0002 00021000
@PSTART  LA    @12,4095(,@10)                                      0002 00022000
         USING @PSTART,@10                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                                                  0216 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* THIS IS THE MAIN ROUTINE FOR EJECT VOLUME FSR. IT PERFORMS    */ 00037000
*   /* INITIALIZATION AND TERMINATION FUNCTIONS AND CALLS THE VARIOUS*/ 00038000
*   /* SUBFUNCTION ROUTINES. INITIALIZE PRINT ARGUMENT LIST AND SET  */ 00039000
*   /* TRACE POINTS                                          @Y30LB38*/ 00040000
*   /*                                                               */ 00041000
*   /*****************************************************************/ 00042000
*                                                                  0216 00043000
*   IF GDTDBG=NULLPTR THEN                                         0216 00044000
         L     @15,@PC00001                                        0216 00045000
         L     @15,GDTDBG(,@15)                                    0216 00046000
         LTR   @15,@15                                             0216 00047000
         BZ    @RT00216                                            0216 00048000
*     ;                                                            0217 00049000
*   ELSE                                                           0218 00050000
*     CALL IDCDB010(GDTTBL,'EVVE'); /*                       @Y30LB38*/ 00051000
         L     @15,@PC00001                                        0218 00052000
         ST    @15,@AL00001                                        0218 00053000
         LA    @14,@CC01074                                        0218 00054000
         ST    @14,@AL00001+4                                      0218 00055000
         MVI   @AL00001+4,X'80'                                    0218 00056000
         L     @15,GDTDBG(,@15)                                    0218 00057000
         LA    @01,@AL00001                                        0218 00058000
         BALR  @14,@15                                             0218 00059000
*   OLDERID2=NEWERID2;                                             0219 00060000
@RT00216 L     @09,@PC00001                                        0219 00061000
         L     @09,GDTTR2(,@09)                                    0219 00062000
         MVC   @TS00001(95),NEWERID2(@09)                          0219 00063000
         MVC   OLDERID2(95,@09),@TS00001                           0219 00064000
*   NEWID2='EVVE';                  /*                       @Y30LB38*/ 00065000
         MVC   NEWID2(4,@09),@CC01074                              0220 00066000
*   DDSTRU=ADDR(PRINTAB);           /*                       @Y30LB38*/ 00067000
         LA    @09,PRINTAB                                         0221 00068000
         ST    @09,DDSTRU                                          0221 00069000
*   PRINTAB=''B;                    /*                       @Y30LB38*/ 00070000
         XC    PRINTAB(20),PRINTAB                                 0222 00071000
*   FLAGS=''B;                      /*                       @Y30LB38*/ 00072000
         MVI   FLAGS,X'00'                                         0223 00073000
*   INVERR=OFF;                     /*                       @Y30LB38*/ 00074000
         NI    INVERR,B'01111111'                                  0224 00075000
*   RECFLAG=OFF;                    /*                       @Y30LB38*/ 00076000
         NI    RECFLAG,B'01111111'                                 0225 00077000
*   SETRC=LASTCC00;                 /*                       @Y30LB38*/ 00078000
*                                                                  0226 00079000
         SLR   @15,@15                                             0226 00080000
         LR    SETRC,@15                                           0226 00081000
*   /*****************************************************************/ 00082000
*   /*                                                               */ 00083000
*   /* WAS CARTRIDGE SERIAL NUMBER SPECIFIED? IF YES, CALL   @Y30LB38*/ 00084000
*   /* CKCSNLEN TO CHECK LENGTH OF SERIAL NUMBER AND         @Y30LB38*/ 00085000
*   /* INSERT BLANK IN                                       @Y30LB38*/ 00086000
*   /* FOURTH CHARACTER IF NECESSARY                         @Y30LB38*/ 00087000
*   /*                                                               */ 00088000
*   /*****************************************************************/ 00089000
*                                                                  0227 00090000
*   IF ADDR(CART)^=NULLPTR THEN                                    0227 00091000
         L     @09,@PC00001+4                                      0227 00092000
         L     @09,FDTPTR+16(,@09)                                 0227 00093000
         CR    @09,@15                                             0227 00094000
         BE    @RF00227                                            0227 00095000
*     DO;                           /*                       @Y30LB38*/ 00096000
*       CSNWORK=CARTVAL;            /*                       @Y30LB38*/ 00097000
         MVC   CSNWORK(12),CARTVAL(@09)                            0229 00098000
*       CALL CKCSNLEN(CSNWORK,CARTLEN);/*                    @Y30LB38*/ 00099000
         LA    @15,CSNWORK                                         0230 00100000
         ST    @15,@AL00001                                        0230 00101000
         ST    @09,@AL00001+4                                      0230 00102000
         LA    @01,@AL00001                                        0230 00103000
         BAL   @14,CKCSNLEN                                        0230 00104000
*       RESPECIFY                                                  0231 00105000
*         RTNREG RSTD;                                             0231 00106000
*       TESTRC=RTNREG;                                             0232 00107000
         LR    TESTRC,RTNREG                                       0232 00108000
*       RESPECIFY                                                  0233 00109000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00110000
*       IF TESTRC^=0 THEN                                          0234 00111000
         LTR   TESTRC,TESTRC                                       0234 00112000
         BZ    @RF00234                                            0234 00113000
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/ 00114000
         L     @09,@PC00001+8                                      0235 00115000
         MVC   LASTCOND(2,@09),@CH00536                            0235 00116000
*     END;                                                         0236 00117000
*   ELSE                                                           0237 00118000
*     ;                                                            0237 00119000
@RF00227 DS    0H                                                  0238 00120000
*                                                                  0238 00121000
*   /*****************************************************************/ 00122000
*   /*                                                               */ 00123000
*   /* TEST FOR NON-ZERO RETURN CODE FROM CKCSNLEN. IF       @Y30LB38*/ 00124000
*   /* ZERO, PROCEED. IF FOUR CSN WAS INVALID.               @Y30LB38*/ 00125000
*   /*                                                               */ 00126000
*   /*****************************************************************/ 00127000
*                                                                  0238 00128000
*   IF LASTCOND=0 THEN                                             0238 00129000
@RC00227 L     @09,@PC00001+8                                      0238 00130000
         LH    @09,LASTCOND(,@09)                                  0238 00131000
         LTR   @09,@09                                             0238 00132000
         BNZ   @RF00238                                            0238 00133000
*     DO;                                                          0239 00134000
*                                                                  0239 00135000
*       /*************************************************************/ 00136000
*       /*                                                           */ 00137000
*       /* CALL PARMPROC TO SET UP ARGUMENT LIST TO READ THE @Y30LB38*/ 00138000
*       /* INVENTORY RECORD FOR THE VOLUME TO BE EJECTED.    @Y30LB38*/ 00139000
*       /*                                                           */ 00140000
*       /*************************************************************/ 00141000
*                                                                  0240 00142000
*       CALL PARMPROC;              /*                       @Y30LB38*/ 00143000
*                                                                  0240 00144000
         BAL   @14,PARMPROC                                        0240 00145000
*       /*************************************************************/ 00146000
*       /*                                                           */ 00147000
*       /* ENQUEUE ON VOLUME SERIAL NUMBER TO ENSURE EXCLUSIVE       */ 00148000
*       /*                                                   @Y30LB38*/ 00149000
*       /* USE                                               @Y30LB38*/ 00150000
*       /* INITIALIZE Q-NAME ANE R-NAME PARAMETER LISTS      @Y30LB38*/ 00151000
*       /*                                                           */ 00152000
*       /*************************************************************/ 00153000
*                                                                  0241 00154000
*       RNAME=RNAMECON;             /*                       @Y30LB38*/ 00155000
         MVC   RNAME(23),RNAMECON                                  0241 00156000
*       VOLSN=VOLVAL;               /*                       @Y30LB38*/ 00157000
         L     @09,@PC00001+4                                      0242 00158000
         L     @09,FDTPTR(,@09)                                    0242 00159000
         MVC   VOLSN(6),VOLVAL(@09)                                0242 00160000
*       CALL IDCSANQ0(GDTTBL,EXCL,WAIT,QNAME,RNAME);/*       @Y30LB38*/ 00161000
*                                                                  0243 00162000
         MVC   @AL00001+4(12),@AL00243                             0243 00163000
         L     @09,@PC00001                                        0243 00164000
         ST    @09,@AL00001                                        0243 00165000
         LA    @06,RNAME                                           0243 00166000
         ST    @06,@AL00001+16                                     0243 00167000
         MVI   @AL00001+16,X'80'                                   0243 00168000
         L     @15,GDTENQ(,@09)                                    0243 00169000
         LA    @01,@AL00001                                        0243 00170000
         BALR  @14,@15                                             0243 00171000
*       /*************************************************************/ 00172000
*       /*                                                           */ 00173000
*       /* CALL MSICPROC TO ACCESS REQUIRED INFO FROM THE INVENTORY  */ 00174000
*       /*                                                   @Y30LB38*/ 00175000
*       /*                                                           */ 00176000
*       /*************************************************************/ 00177000
*                                                                  0244 00178000
*       CALL MSICPROC;              /*                       @Y30LB38*/ 00179000
         BAL   @14,MSICPROC                                        0244 00180000
*       RESPECIFY                                                  0245 00181000
*         RTNREG RSTD;                                             0245 00182000
*       TESTRC=RTNREG;                                             0246 00183000
         LR    TESTRC,RTNREG                                       0246 00184000
*       RESPECIFY                                                  0247 00185000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00186000
*                                                                  0248 00187000
*       /*************************************************************/ 00188000
*       /*                                                           */ 00189000
*       /* TEST FOR NON-ZERO RETURN CODE FROM MSICPROC. IF   @Y30LB38*/ 00190000
*       /* ZERO, PROCEED.                                    @Y30LB38*/ 00191000
*       /*                                                           */ 00192000
*       /*************************************************************/ 00193000
*                                                                  0248 00194000
*       IF TESTRC=0 THEN                                           0248 00195000
         LTR   TESTRC,TESTRC                                       0248 00196000
         BNZ   @RF00248                                            0248 00197000
*         DO;                                                      0249 00198000
*                                                                  0249 00199000
*           /*********************************************************/ 00200000
*           /*                                                       */ 00201000
*           /* CALL RECPROC TO SET THE RECORD OR NORECORD OPTION OR  */ 00202000
*           /*                                               @Y30LB38*/ 00203000
*           /* SET THE DEFAULT IF NOT SPECIFIED              @Y30LB38*/ 00204000
*           /*                                                       */ 00205000
*           /*********************************************************/ 00206000
*                                                                  0250 00207000
*           CALL RECPROC;                                          0250 00208000
*                                                                  0250 00209000
         BAL   @14,RECPROC                                         0250 00210000
*           /*********************************************************/ 00211000
*           /*                                                       */ 00212000
*           /* BUILD PARMAMETER LIST TO CALL VOLEXIT. VOLEXIT        */ 00213000
*           /*                                               @Y30LB38*/ 00214000
*           /* DELETES A VOLUME FROM THE INVENTORY.          @Y30LB38*/ 00215000
*           /*                                                       */ 00216000
*           /*********************************************************/ 00217000
*                                                                  0251 00218000
*           IF ADDR(LOC)=NULLPTR THEN                              0251 00219000
         L     @15,@PC00001+4                                      0251 00220000
         L     @15,FDTPTR+28(,@15)                                 0251 00221000
         LTR   @15,@15                                             0251 00222000
         BNZ   @RF00251                                            0251 00223000
*             LOCATION=' ';         /*                       @Y30LB38*/ 00224000
         MVI   LOCATION+1,C' '                                     0252 00225000
         MVC   LOCATION+2(28),LOCATION+1                           0252 00226000
         MVI   LOCATION,C' '                                       0252 00227000
*           ELSE                                                   0253 00228000
*             LOCATION=LOCVAL;      /*                       @Y30LB38*/ 00229000
         B     @RC00251                                            0253 00230000
@RF00251 L     @15,@PC00001+4                                      0253 00231000
         L     @01,FDTPTR+28(,@15)                                 0253 00232000
         MVC   LOCATION(30),LOCVAL(@01)                            0253 00233000
*           CALL VOLEXIT(CSNWORK,VOLVAL,INVERR,RECFLAG,LOCATION);  0254 00234000
@RC00251 LA    @15,CSNWORK                                         0254 00235000
         ST    @15,@AL00001                                        0254 00236000
         L     @15,@PC00001+4                                      0254 00237000
         L     @01,FDTPTR(,@15)                                    0254 00238000
         LA    @15,VOLVAL(,@01)                                    0254 00239000
         ST    @15,@AL00001+4                                      0254 00240000
         LA    @15,INVERR                                          0254 00241000
         ST    @15,@AL00001+8                                      0254 00242000
         LA    @15,RECFLAG                                         0254 00243000
         ST    @15,@AL00001+12                                     0254 00244000
         LA    @15,LOCATION                                        0254 00245000
         ST    @15,@AL00001+16                                     0254 00246000
         LA    @01,@AL00001                                        0254 00247000
         BAL   @14,VOLEXIT                                         0254 00248000
*           RESPECIFY                                              0255 00249000
*             RTNREG RSTD;                                         0255 00250000
*           TESTRC=RTNREG;                                         0256 00251000
         LR    TESTRC,RTNREG                                       0256 00252000
*           RESPECIFY                                              0257 00253000
*             RTNREG UNRSTD;        /*                       @Y30LB38*/ 00254000
*                                                                  0257 00255000
*           /*********************************************************/ 00256000
*           /*                                                       */ 00257000
*           /* TEST RETURN CODE FROM VOLEXIT. IF 0, CONTINUE. IF     */ 00258000
*           /*                                               @Y30LB38*/ 00259000
*           /* 8, ONE CARTIRDGE WAS EJECTED SO SET CONDITION TO      */ 00260000
*           /*                                               @Y30LB38*/ 00261000
*           /* 8. IF 4, NO CARTRIDGES WERE EJECTED SO SET CON-       */ 00262000
*           /*                                               @Y30LB38*/ 00263000
*           /* DITION CODE TO 12.                            @Y30LB38*/ 00264000
*           /*                                                       */ 00265000
*           /*********************************************************/ 00266000
*                                                                  0258 00267000
*           IF TESTRC^=0 THEN                                      0258 00268000
         LTR   TESTRC,TESTRC                                       0258 00269000
         BZ    @RF00258                                            0258 00270000
*             DO;                   /*                       @Y30LB38*/ 00271000
*               IF TESTRC=LASTCC08 THEN                            0260 00272000
         LA    @02,8                                               0260 00273000
         CR    TESTRC,@02                                          0260 00274000
         BNE   @RF00260                                            0260 00275000
*                 LASTCOND=LASTCC08;/*                       @Y30LB38*/ 00276000
         L     @03,@PC00001+8                                      0261 00277000
         STH   @02,LASTCOND(,@03)                                  0261 00278000
*               ELSE                                               0262 00279000
*                 LASTCOND=LASTCC12;/*                       @Y30LB38*/ 00280000
         B     @RC00260                                            0262 00281000
@RF00260 L     @15,@PC00001+8                                      0262 00282000
         MVC   LASTCOND(2,@15),@CH00536                            0262 00283000
*             END;                                                 0263 00284000
*                                                                  0263 00285000
*           /*********************************************************/ 00286000
*           /*                                                       */ 00287000
*           /* IF THE VOLUME WAS EJECTED BUT AN ERROR PREVENTED      */ 00288000
*           /*                                               @Y30LB38*/ 00289000
*           /* THE INVENTORY FROM BEING UPDATED, SET THE CONDI-      */ 00290000
*           /*                                               @Y30LB38*/ 00291000
*           /* TION CODE TO 4                                @Y30LB38*/ 00292000
*           /*                                                       */ 00293000
*           /*********************************************************/ 00294000
*                                                                  0264 00295000
*           ELSE                                                   0264 00296000
*             DO;                   /*                       @Y30LB38*/ 00297000
         B     @RC00258                                            0264 00298000
@RF00258 DS    0H                                                  0265 00299000
*               IF INVERR=ON THEN                                  0265 00300000
         TM    INVERR,B'10000000'                                  0265 00301000
         BNO   @RF00265                                            0265 00302000
*                 LASTCOND=LASTCC04;/*                       @Y30LB38*/ 00303000
         L     @15,@PC00001+8                                      0266 00304000
         MVC   LASTCOND(2,@15),@CH00041                            0266 00305000
*               ELSE                                               0267 00306000
*                 ;                 /*                       @Y30LB38*/ 00307000
@RF00265 DS    0H                                                  0268 00308000
*             END;                  /*                       @Y30LB38*/ 00309000
*         END;                                                     0269 00310000
*                                                                  0269 00311000
*       /*************************************************************/ 00312000
*       /*                                                           */ 00313000
*       /* MSICPROC FOUND AN ERROR READING THE INVENTORY FOR @Y30LB38*/ 00314000
*       /* THE RECORD, SO SET THE FINAL CONDITION CODE TO 12 @Y30LB38*/ 00315000
*       /*                                                           */ 00316000
*       /*************************************************************/ 00317000
*                                                                  0270 00318000
*       ELSE                        /*                       @Y30LB38*/ 00319000
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/ 00320000
*                                                                  0270 00321000
         B     @RC00248                                            0270 00322000
@RF00248 L     @15,@PC00001+8                                      0270 00323000
         MVC   LASTCOND(2,@15),@CH00536                            0270 00324000
*       /*************************************************************/ 00325000
*       /*                                                           */ 00326000
*       /* DEQUENE THE ENQUENE ON THE VOLUME SERIAL NUMBER   @Y30LB38*/ 00327000
*       /*                                                           */ 00328000
*       /*************************************************************/ 00329000
*                                                                  0271 00330000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAME);/*                 @Y30LB38*/ 00331000
@RC00248 L     @15,@PC00001                                        0271 00332000
         ST    @15,@AL00001                                        0271 00333000
         LA    @14,@CC01065                                        0271 00334000
         ST    @14,@AL00001+4                                      0271 00335000
         LA    @14,RNAME                                           0271 00336000
         ST    @14,@AL00001+8                                      0271 00337000
         MVI   @AL00001+8,X'80'                                    0271 00338000
         L     @15,GDTDEQ(,@15)                                    0271 00339000
         LA    @01,@AL00001                                        0271 00340000
         BALR  @14,@15                                             0271 00341000
*     END;                                                         0272 00342000
*   ELSE                                                           0273 00343000
*     ;                                                            0273 00344000
@RF00238 DS    0H                                                  0274 00345000
*                                                                  0274 00346000
*   /*****************************************************************/ 00347000
*   /*                                                               */ 00348000
*   /* BUILD PARAMETER LIST FOR UPRINT MACRO. IF THE         @Y30LB38*/ 00349000
*   /* CONDITION CODE IS => 12 THEN MESSAGE IDC0003I IS PRINTED.     */ 00350000
*   /* OTHERWISE, MESSAGE IDC0001I IS PRINTED                @Y30LB38*/ 00351000
*   /*                                                               */ 00352000
*   /*****************************************************************/ 00353000
*                                                                  0274 00354000
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB38*/ 00355000
         L     @15,DDSTRU                                          0274 00356000
         MVC   DARGSMOD(3,@15),@CC01057                            0274 00357000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB38*/ 00358000
         L     @14,@PC00001+8                                      0275 00359000
         ST    @14,DARGDBP(,@15)                                   0275 00360000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB38*/ 00361000
         MVC   DARGILP(2,@15),@CH00147                             0276 00362000
*   IF LASTCOND=>LASTCC12 THEN                                     0277 00363000
         LH    @14,LASTCOND(,@14)                                  0277 00364000
         C     @14,@CF00536                                        0277 00365000
         BL    @RF00277                                            0277 00366000
*     DARGSENT=MSG0003I;            /*                       @Y30LB38*/ 00367000
         MVI   DARGSENT(@15),X'01'                                 0278 00368000
*   ELSE                                                           0279 00369000
*     DARGSENT=MSG0001I;            /*                       @Y30LB38*/ 00370000
*                                                                  0279 00371000
         B     @RC00277                                            0279 00372000
@RF00277 L     @01,DDSTRU                                          0279 00373000
         MVI   DARGSENT(@01),X'01'                                 0279 00374000
*   /*****************************************************************/ 00375000
*   /*                                                               */ 00376000
*   /* OBTAIN A FULL REGION DUMP IF THE DUMP OPTION IS SET   @Y30LB38*/ 00377000
*   /* AND RETURN TO THE AMS EXECUTIVE                       @Y30LB38*/ 00378000
*   /*                                                               */ 00379000
*   /*****************************************************************/ 00380000
*                                                                  0280 00381000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                          0280 00382000
@RC00277 L     @15,@PC00001                                        0280 00383000
         ST    @15,@AL00001                                        0280 00384000
         LA    @14,@CF00111                                        0280 00385000
         ST    @14,@AL00001+4                                      0280 00386000
         LA    @14,DDSTRU                                          0280 00387000
         ST    @14,@AL00001+8                                      0280 00388000
         MVI   @AL00001+8,X'80'                                    0280 00389000
         L     @15,GDTPRT(,@15)                                    0280 00390000
         LA    @01,@AL00001                                        0280 00391000
         BALR  @14,@15                                             0280 00392000
*   IF GDTDBG=NULLPTR THEN                                         0281 00393000
         L     @15,@PC00001                                        0281 00394000
         L     @15,GDTDBG(,@15)                                    0281 00395000
         LTR   @15,@15                                             0281 00396000
         BZ    @RT00281                                            0281 00397000
*     ;                                                            0282 00398000
*   ELSE                                                           0283 00399000
*     CALL IDCDB010(GDTTBL,'EVRC'); /*                       @Y30LB38*/ 00400000
         L     @15,@PC00001                                        0283 00401000
         ST    @15,@AL00001                                        0283 00402000
         LA    @14,@CC01083                                        0283 00403000
         ST    @14,@AL00001+4                                      0283 00404000
         MVI   @AL00001+4,X'80'                                    0283 00405000
         L     @15,GDTDBG(,@15)                                    0283 00406000
         LA    @01,@AL00001                                        0283 00407000
         BALR  @14,@15                                             0283 00408000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0284 00409000
*                                                                  0284 00410000
@RT00281 L     @15,@PC00001                                        0284 00411000
         ST    @15,@AL00001                                        0284 00412000
         LA    @14,MODID                                           0284 00413000
         ST    @14,@AL00001+4                                      0284 00414000
         L     @14,@PC00001+8                                      0284 00415000
         ST    @14,@AL00001+8                                      0284 00416000
         MVI   @AL00001+8,X'80'                                    0284 00417000
         L     @15,GDTEPL(,@15)                                    0284 00418000
         LA    @01,@AL00001                                        0284 00419000
         BALR  @14,@15                                             0284 00420000
*   /*****************************************************************/ 00421000
*   /*                                                               */ 00422000
*   /*                                                       @Y30LB38*/ 00423000
*   /*                                                               */ 00424000
*   /*****************************************************************/ 00425000
*                                                                  0285 00426000
*                                                                  0285 00427000
*/********************************************************************/ 00428000
*/*                                                          @Y30LB38*/ 00429000
*/*     PROCEDURE NAME - PARMPROC                            @Y30LB38*/ 00430000
*/*                                                          @Y30LB38*/ 00431000
*/*     FUNCTION - CHECK THE INPUT PARAMETERS AND BUILD      @Y30LB38*/ 00432000
*/*                RVVILIST TO READ THE RECORD FROM THE      @Y30LB38*/ 00433000
*/*                MASS STORAGE VOLUME INVENTORY.            @Y30LB38*/ 00434000
*/*                                                          @Y30LB38*/ 00435000
*/*     INPUT - FUNCTION DEFINITION TABLE                    @Y30LB38*/ 00436000
*/*                                                          @Y30LB38*/ 00437000
*/*     OUTPUT - THE COMPLETED RVVILIST.                     @Y30LB38*/ 00438000
*/*                                                          @Y30LB38*/ 00439000
*/********************************************************************/ 00440000
*                                                                  0285 00441000
*PARMPROC:                                                         0285 00442000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 00443000
@EL00001 L     @13,4(,@13)                                         0285 00444000
@EF00001 L     @00,@SIZDATD                                        0285 00445000
         LR    @01,@11                                             0285 00446000
         FREEMAIN R,LV=(0),A=(1)                                        00447000
@ER00001 LM    @14,@12,12(@13)                                     0285 00448000
         BR    @14                                                 0285 00449000
PARMPROC DS    0H                                                  0286 00450000
*                                                                  0286 00451000
*   /*****************************************************************/ 00452000
*   /*                                                               */ 00453000
*   /* SAVE RETURN ADDR                                      @Y30LB38*/ 00454000
*   /*                                                               */ 00455000
*   /*****************************************************************/ 00456000
*                                                                  0286 00457000
*   RETADDR1=REG14;                 /*                       @Y30LB38*/ 00458000
         LR    RETADDR1,REG14                                      0286 00459000
*   OLDERID2=NEWERID2;                                             0287 00460000
         L     @09,@PC00001                                        0287 00461000
         L     @09,GDTTR2(,@09)                                    0287 00462000
         MVC   @TS00001(95),NEWERID2(@09)                          0287 00463000
         MVC   OLDERID2(95,@09),@TS00001                           0287 00464000
*   NEWID2='EVPC';                  /*                       @Y30LB38*/ 00465000
*                                                                  0288 00466000
         MVC   NEWID2(4,@09),@CC01087                              0288 00467000
*   /*****************************************************************/ 00468000
*   /*                                                               */ 00469000
*   /* INITILAIZE BUFFER AND RVVILIST                        @Y30LB38*/ 00470000
*   /*                                                               */ 00471000
*   /*****************************************************************/ 00472000
*                                                                  0289 00473000
*   VVIREC=''B;                     /*                       @Y30LB38*/ 00474000
         XC    VVIREC(224),VVIREC                                  0289 00475000
*   BASEVPTR=ADDR(VVIREC);          /*                       @Y30LB38*/ 00476000
         LA    @09,VVIREC                                          0290 00477000
         LR    BASEVPTR,@09                                        0290 00478000
*   BCDVPTR=ADDR(VVIREC);           /*                       @Y30LB38*/ 00479000
         LR    BCDVPTR,@09                                         0291 00480000
*   RVVIPTR=ADDR(VVILIST);          /*                       @Y30LB38*/ 00481000
         LA    @05,VVILIST                                         0292 00482000
         ST    @05,RVVIPTR                                         0292 00483000
*   RVVI=''B;                       /*                       @Y30LB38*/ 00484000
*                                                                  0293 00485000
         XC    RVVI(68,@05),RVVI(@05)                              0293 00486000
*   /*****************************************************************/ 00487000
*   /*                                                               */ 00488000
*   /* SET OP CODE AND LENGTH IN RVVI LIST                   @Y30LB38*/ 00489000
*   /*                                                               */ 00490000
*   /*****************************************************************/ 00491000
*                                                                  0294 00492000
*   RVVCODE=RVVOP;                  /*                       @Y30LB38*/ 00493000
         MVI   RVVCODE(@05),X'87'                                  0294 00494000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB38*/ 00495000
*                                                                  0295 00496000
         LH    @15,RVVLEN                                          0295 00497000
         ST    @15,RVVLNGTH(,@05)                                  0295 00498000
*   /*****************************************************************/ 00499000
*   /*                                                               */ 00500000
*   /* INITIALIZE THE REMAINING REQUIRED FIELDS              @Y30LB38*/ 00501000
*   /* IN THE RVVI LIST                                      @Y30LB38*/ 00502000
*   /*                                                               */ 00503000
*   /*****************************************************************/ 00504000
*                                                                  0296 00505000
*   RVVBUFLN=LENGTH(VVIREC);        /*                       @Y30LB38*/ 00506000
         MVC   RVVBUFLN(2,@05),@CH01239                            0296 00507000
*   RVVRDR=ON;                      /*                       @Y30LB38*/ 00508000
         OI    RVVRDR(@05),B'10000000'                             0297 00509000
*   RVVRTBUF=ADDR(VVIREC);          /*                       @Y30LB38*/ 00510000
         ST    @09,RVVRTBUF(,@05)                                  0298 00511000
*   RVVOLUME=VOLVAL;                /*                       @Y30LB38*/ 00512000
         L     @09,@PC00001+4                                      0299 00513000
         L     @01,FDTPTR(,@09)                                    0299 00514000
         MVC   RVVOLUME(6,@05),VOLVAL(@01)                         0299 00515000
*   RVVSVOL=ON;                     /*                       @Y30LB38*/ 00516000
*                                                                  0300 00517000
         OI    RVVSVOL(@05),B'00000001'                            0300 00518000
*   /*****************************************************************/ 00519000
*   /*                                                               */ 00520000
*   /* WAS THE COPYDATE SPECIFIED? IF YES SET VALUES         @Y30LB38*/ 00521000
*   /* IN THE RVVI LIST. IF NO, CHECK FOR CARTRIDGE SERIAL   @Y30LB38*/ 00522000
*   /* NUMBER SPECIFIED AND SET CSN IN THE RVVI LIST.        @Y30LB38*/ 00523000
*   /* IF NEITHER COPYDATE OR CSN WERE SPECIFIED, TURN ON    @Y30LB38*/ 00524000
*   /* FLAG TO READ BASE VOLUME RECORD.                      @Y30LB38*/ 00525000
*   /*                                                               */ 00526000
*   /*****************************************************************/ 00527000
*                                                                  0301 00528000
*   IF ADDR(CDATE)^=NULLPTR THEN                                   0301 00529000
         SLR   @15,@15                                             0301 00530000
         C     @15,FDTPTR+4(,@09)                                  0301 00531000
         BE    @RF00301                                            0301 00532000
*     DO;                           /*                       @Y30LB38*/ 00533000
*       RVVCPYRC=ON;                /*                       @Y30LB38*/ 00534000
         OI    RVVCPYRC(@05),B'00100000'                           0303 00535000
*       CVD(DATEVAL,RVVCDATE);      /*                       @Y30LB38*/ 00536000
         L     @01,FDTPTR+8(,@09)                                  0304 00537000
         L     @14,DATEVAL(,@01)                                   0304 00538000
         CVD   @14,@TS00001                                        0304 00539000
         MVC   RVVCDATE(4,@05),@TS00001+4                          0304 00540000
*       RVVSDTE=ON;                 /*                       @Y30LB38*/ 00541000
         OI    RVVSDTE(@05),B'00100000'                            0305 00542000
*       IF ADDR(SEQ)^=NULLPTR THEN                                 0306 00543000
         L     @09,FDTPTR+12(,@09)                                 0306 00544000
         CR    @09,@15                                             0306 00545000
         BE    @RF00306                                            0306 00546000
*         DO;                       /*                       @Y30LB38*/ 00547000
*           RVVRDSEQ=SEQVAL;        /*                       @Y30LB38*/ 00548000
         MVC   RVVRDSEQ(1,@05),SEQVAL+3(@09)                       0308 00549000
*           RVVSSEQ=ON;             /*                       @Y30LB38*/ 00550000
         OI    RVVSSEQ(@05),B'00010000'                            0309 00551000
*         END;                      /*                       @Y30LB38*/ 00552000
*     END;                          /*                       @Y30LB38*/ 00553000
*   ELSE                            /*                       @Y30LB38*/ 00554000
*     DO;                           /*                       @Y30LB38*/ 00555000
         B     @RC00301                                            0312 00556000
@RF00301 DS    0H                                                  0313 00557000
*       IF ADDR(CART)^=NULLPTR THEN                                0313 00558000
         L     @09,@PC00001+4                                      0313 00559000
         L     @09,FDTPTR+16(,@09)                                 0313 00560000
         LTR   @09,@09                                             0313 00561000
         BZ    @RF00313                                            0313 00562000
*         DO;                       /*                       @Y30LB38*/ 00563000
*           RVVRDCSN=CSNWORK;       /*                       @Y30LB38*/ 00564000
         L     @09,RVVIPTR                                         0315 00565000
         MVC   RVVRDCSN(12,@09),CSNWORK                            0315 00566000
*           RVVRUNKN=ON;            /*                       @Y30LB38*/ 00567000
         OI    RVVRUNKN(@09),B'00001000'                           0316 00568000
*           RVVSCSN=ON;             /*                       @Y30LB38*/ 00569000
         OI    RVVSCSN(@09),B'00001000'                            0317 00570000
*         END;                      /*                       @Y30LB38*/ 00571000
*       ELSE                                                       0319 00572000
*         RVVBVRCD=ON;              /*                       @Y30LB38*/ 00573000
         B     @RC00313                                            0319 00574000
@RF00313 L     @09,RVVIPTR                                         0319 00575000
         OI    RVVBVRCD(@09),B'10000000'                           0319 00576000
*     END;                          /*                       @Y30LB38*/ 00577000
*                                                                  0320 00578000
@RC00313 DS    0H                                                  0321 00579000
*   /*****************************************************************/ 00580000
*   /*                                                               */ 00581000
*   /* RESTORE RETURN ADDRESS AND RETURN TO THE CALLER       @Y30LB38*/ 00582000
*   /*                                                               */ 00583000
*   /*****************************************************************/ 00584000
*                                                                  0321 00585000
*   REG14=RETADDR1;                 /*                       @Y30LB38*/ 00586000
@RC00301 LR    REG14,RETADDR1                                      0321 00587000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 00588000
         SLR   @15,@15                                             0322 00589000
@EL00002 DS    0H                                                  0322 00590000
@EF00002 DS    0H                                                  0322 00591000
@ER00002 BR    @14                                                 0322 00592000
*   END PARMPROC;                   /*                       @Y30LB38*/ 00593000
*                                                                  0324 00594000
*/********************************************************************/ 00595000
*/*                                                          @Y30LB38*/ 00596000
*/*     PROCEDURE NAME - MSICPROC                            @Y30LB38*/ 00597000
*/*                                                          @Y30LB38*/ 00598000
*/*     FUNCTION - ISSUES USSC MACRO TO OBTAIN VOLUME RECORD @Y30LB38*/ 00599000
*/*                FROM THE INVENTORY, CHECKS THE RECORD FOR @Y30LB38*/ 00600000
*/*                SITUATIONS THAT PREVENT EJECTING THE      @Y30LB38*/ 00601000
*/*                VOLUME.  ALSO CHECKS THAT THERE ARE TWO   @Y30LB38*/ 00602000
*/*                DUPLICATE RECORDS FOR THE VOLUME IN THE   @Y30LB38*/ 00603000
*/*                INVENTORY, IF THE USER SPECIFIED ONLY     @Y30LB38*/ 00604000
*/*                THE VOLUME SERIAL NUMBER.                 @Y30LB38*/ 00605000
*/*                                                          @Y30LB38*/ 00606000
*/*     INPUT - FUNCTION DEFINITION TABLE, AND THE RVVILIST. @Y30LB38*/ 00607000
*/*                                                          @Y30LB38*/ 00608000
*/*     OUTPUT - THE FIRST CSN ASSOCIATED WITH THE VOLUME    @Y30LB38*/ 00609000
*/*              SPECIFIED AND A RETURN CODE OF 00 OR 04.    @Y30LB38*/ 00610000
*/*              THE 04 RETURN CODE IS FOR ONE OF THE        @Y30LB38*/ 00611000
*/*              FOLLOWING REASONS: 1) VOLUME RECORD COULD   @Y30LB38*/ 00612000
*/*              NOT BE ACCESSED, 2) A RECOVERY FLAG WAS ON, @Y30LB38*/ 00613000
*/*              3) A DUPLICATE RECORD WAS FOUND OR 4)       @Y30LB38*/ 00614000
*/*              THE VOLUME WAS ACTIVE.                      @Y30LB38*/ 00615000
*/*              ALSO, THE RRCDFAIL FLAG IS SET IF A RECORD  @Y30LB38*/ 00616000
*/*              COULD NOT BE FOUND BUT THE VOLUME CAN BE    @Y30LB38*/ 00617000
*/*              EJECTED.                                    @Y30LB38*/ 00618000
*/*                                                          @Y30LB38*/ 00619000
*/********************************************************************/ 00620000
*                                                                  0324 00621000
*MSICPROC:                                                         0324 00622000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 00623000
*                                                                  0324 00624000
MSICPROC DS    0H                                                  0325 00625000
*   /*****************************************************************/ 00626000
*   /*                                                               */ 00627000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 00628000
*   /*                                                               */ 00629000
*   /*****************************************************************/ 00630000
*                                                                  0325 00631000
*   DCL                                                            0325 00632000
*     CODE2 FIXED(15);              /* CONDITION CODE        @Y30LB38*/ 00633000
*                                                                  0326 00634000
*   /*****************************************************************/ 00635000
*   /*                                                               */ 00636000
*   /* SAVE THE RETURN REGISTER AND INITIALIZE THE CONDI-    @Y30LB38*/ 00637000
*   /* TION CODE AREA TO 0.                                  @Y30LB38*/ 00638000
*   /*                                                               */ 00639000
*   /*****************************************************************/ 00640000
*                                                                  0326 00641000
*   RETADDR1=REG14;                 /*                       @Y30LB38*/ 00642000
         LR    RETADDR1,REG14                                      0326 00643000
*   OLDERID2=NEWERID2;                                             0327 00644000
         L     @09,@PC00001                                        0327 00645000
         L     @15,GDTTR2(,@09)                                    0327 00646000
         MVC   @TS00001(95),NEWERID2(@15)                          0327 00647000
         MVC   OLDERID2(95,@15),@TS00001                           0327 00648000
*   NEWID2='EVVP';                  /*                       @Y30LB38*/ 00649000
         MVC   NEWID2(4,@15),@CC01093                              0328 00650000
*   CODE2='0'X;                     /*                       @Y30LB38*/ 00651000
*                                                                  0329 00652000
         SLR   CODE2,CODE2                                         0329 00653000
*   /*****************************************************************/ 00654000
*   /*                                                               */ 00655000
*   /* TAKE UDUMP OF PARMAMETER                              @Y30LB38*/ 00656000
*   /* LIST TO READ INVENTORY (VVILIST)                      @Y30LB38*/ 00657000
*   /*                                                               */ 00658000
*   /*****************************************************************/ 00659000
*                                                                  0330 00660000
*   IF GDTDBG=NULLPTR THEN                                         0330 00661000
         L     @09,GDTDBG(,@09)                                    0330 00662000
         LTR   @09,@09                                             0330 00663000
         BZ    @RT00330                                            0330 00664000
*     ;                                                            0331 00665000
*   ELSE                                                           0332 00666000
*     DO;                                                          0332 00667000
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Y30LB38*/ 00668000
         LA    DMPINDEX,DMPSTG                                     0333 00669000
*       DMPITMNM='VVILIST';                                        0334 00670000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0334 00671000
         MVC   DMPITMNM(7,DMPINDEX),@CC01095                       0334 00672000
*       DMPITMPT=ADDR(RVVIPTR);                                    0335 00673000
         LA    @09,RVVIPTR                                         0335 00674000
         ST    @09,DMPITMPT(,DMPINDEX)                             0335 00675000
*       DMPITMLN=LENGTH(VVILIST);                                  0336 00676000
         MVC   DMPITMLN(2,DMPINDEX),@CH01240                       0336 00677000
*       DMPITMTP='H';                                              0337 00678000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0337 00679000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0338 00680000
*                                                                  0338 00681000
         AL    DMPINDEX,@CF00465                                   0338 00682000
*       /*************************************************************/ 00683000
*       /*                                                           */ 00684000
*       /*                                                   @Y30LB38*/ 00685000
*       /*                                                           */ 00686000
*       /*************************************************************/ 00687000
*                                                                  0339 00688000
*       DMPTRM=DMPTRMVL;                                           0339 00689000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0339 00690000
*     END;                          /*                       @Y30LB38*/ 00691000
*   IF GDTDBG=NULLPTR THEN                                         0341 00692000
@RT00330 L     @09,@PC00001                                        0341 00693000
         L     @09,GDTDBG(,@09)                                    0341 00694000
         LTR   @09,@09                                             0341 00695000
         BZ    @RT00341                                            0341 00696000
*     ;                                                            0342 00697000
*   ELSE                                                           0343 00698000
*     CALL IDCDB010(GDTTBL,'EVBR',ADDR(DMPSTG));/*           @Y30LB38*/ 00699000
*                                                                  0343 00700000
         L     @09,@PC00001                                        0343 00701000
         ST    @09,@AL00001                                        0343 00702000
         LA    @15,@CC01097                                        0343 00703000
         ST    @15,@AL00001+4                                      0343 00704000
         LA    @15,DMPSTG                                          0343 00705000
         ST    @15,@AFTEMPS                                        0343 00706000
         LA    @15,@AFTEMPS                                        0343 00707000
         ST    @15,@AL00001+8                                      0343 00708000
         MVI   @AL00001+8,X'80'                                    0343 00709000
         L     @15,GDTDBG(,@09)                                    0343 00710000
         LA    @01,@AL00001                                        0343 00711000
         BALR  @14,@15                                             0343 00712000
*   /*****************************************************************/ 00713000
*   /*                                                               */ 00714000
*   /* ISSUE USSC MACRO TO OBTAIN VOLUME RECORD FROM         @Y30LB38*/ 00715000
*   /* INVENTORY                                             @Y30LB38*/ 00716000
*   /*                                                               */ 00717000
*   /*****************************************************************/ 00718000
*                                                                  0344 00719000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB38*/ 00720000
@RT00341 L     @09,@PC00001                                        0344 00721000
         ST    @09,@AL00001                                        0344 00722000
         LA    @02,VVIC                                            0344 00723000
         ST    @02,@AL00001+4                                      0344 00724000
         LA    @02,RVVIPTR                                         0344 00725000
         ST    @02,@AL00001+8                                      0344 00726000
         LA    @02,REASONCD                                        0344 00727000
         ST    @02,@AL00001+12                                     0344 00728000
         MVI   @AL00001+12,X'80'                                   0344 00729000
         L     @15,GDTSSC(,@09)                                    0344 00730000
         LA    @01,@AL00001                                        0344 00731000
         BALR  @14,@15                                             0344 00732000
*   RESPECIFY                                                      0345 00733000
*     RTNREG RSTD;                                                 0345 00734000
*   TESTRC=RTNREG;                                                 0346 00735000
         LR    TESTRC,RTNREG                                       0346 00736000
*   RESPECIFY                                                      0347 00737000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 00738000
*                                                                  0348 00739000
*   /*****************************************************************/ 00740000
*   /*                                                               */ 00741000
*   /* IF RETURN CODE FROM USSC IS NOT SUCCESSFUL,           @Y30LB38*/ 00742000
*   /* PROCESS AN ERROR READING THE INVENTORY                @Y30LB38*/ 00743000
*   /*                                                               */ 00744000
*   /*****************************************************************/ 00745000
*                                                                  0348 00746000
*   IF TESTRC^=0 THEN                                              0348 00747000
         LTR   TESTRC,TESTRC                                       0348 00748000
         BZ    @RF00348                                            0348 00749000
*     DO;                           /*                       @Y30LB38*/ 00750000
*                                                                  0349 00751000
*       /*************************************************************/ 00752000
*       /*                                                           */ 00753000
*       /* IF THE ERROR IS OTHER THAN RECORD NOT FOUND, CALL @Y30LB38*/ 00754000
*       /* SSCMSG ROUTINE TO ISSUE AN ERROR MESSAGE BASED ON @Y30LB38*/ 00755000
*       /* REASON CODE                                       @Y30LB38*/ 00756000
*       /*                                                           */ 00757000
*       /*************************************************************/ 00758000
*                                                                  0350 00759000
*       IF REASONCD^=NOREC THEN                                    0350 00760000
         CLC   REASONCD(4),NOREC                                   0350 00761000
         BE    @RF00350                                            0350 00762000
*         DO;                       /*                       @Y30LB38*/ 00763000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB38*/ 00764000
         LA    @15,REASONCD                                        0352 00765000
         ST    @15,@AL00001                                        0352 00766000
         LA    @01,@AL00001                                        0352 00767000
         BAL   @14,SSCMSG                                          0352 00768000
*           CODE2=LASTCC04;         /*                       @Y30LB38*/ 00769000
         LA    CODE2,4                                             0353 00770000
*         END;                      /*                       @Y30LB38*/ 00771000
*                                                                  0354 00772000
*       /*************************************************************/ 00773000
*       /*                                                           */ 00774000
*       /* IF THE RECORD COULD NOT BE FOUND IN THE INVENTORY,        */ 00775000
*       /*                                                   @Y30LB38*/ 00776000
*       /* SEE IF THE CARTRIDGE SERIAL NUMBER WAS SPECIFIED  @Y30LB38*/ 00777000
*       /* BY THE USER. IF IT WAS, DO NOT CONSIDER THIS AN   @Y30LB38*/ 00778000
*       /* ERROR SINCE THERE IS SUFFICIENT INFO TO EJECT THE @Y30LB38*/ 00779000
*       /* VOLUME. SET A FLAG TO INDICATE THERE IS NO RECORD.        */ 00780000
*       /*                                                   @Y30LB38*/ 00781000
*       /* IF CARTRIDGE SERIAL NO. IS NOT SPECIFIED, CONSIDER        */ 00782000
*       /*                                                   @Y30LB38*/ 00783000
*       /* IT AN ERROR AND CALL THE SSCMSG ROUTINE TO ISSUE  @Y30LB38*/ 00784000
*       /* AN ERROR MSG                                      @Y30LB38*/ 00785000
*       /*                                                           */ 00786000
*       /*************************************************************/ 00787000
*                                                                  0355 00788000
*       ELSE                                                       0355 00789000
*         DO;                       /*                       @Y30LB38*/ 00790000
         B     @RC00350                                            0355 00791000
@RF00350 DS    0H                                                  0356 00792000
*           IF ADDR(CART)^=NULLPTR THEN                            0356 00793000
         L     @04,@PC00001+4                                      0356 00794000
         L     @04,FDTPTR+16(,@04)                                 0356 00795000
         LTR   @04,@04                                             0356 00796000
         BZ    @RF00356                                            0356 00797000
*             RRCDFAIL=ON;          /*                       @Y30LB38*/ 00798000
         OI    RRCDFAIL,B'10000000'                                0357 00799000
*           ELSE                                                   0358 00800000
*             DO;                   /*                       @Y30LB38*/ 00801000
         B     @RC00356                                            0358 00802000
@RF00356 DS    0H                                                  0359 00803000
*               CALL SSCMSG(REASONCD);/*                     @Y30LB38*/ 00804000
         LA    @15,REASONCD                                        0359 00805000
         ST    @15,@AL00001                                        0359 00806000
         LA    @01,@AL00001                                        0359 00807000
         BAL   @14,SSCMSG                                          0359 00808000
*               CODE2=LASTCC04;     /*                       @Y30LB38*/ 00809000
         LA    CODE2,4                                             0360 00810000
*             END;                  /*                       @Y30LB38*/ 00811000
*         END;                      /*                       @Y30LB38*/ 00812000
*     END;                          /*                       @Y30LB38*/ 00813000
*                                                                  0364 00814000
*   /*****************************************************************/ 00815000
*   /*                                                               */ 00816000
*   /* IF USSC WAS SUCCESSFUL IN READING A RECORD, IN-       @Y30LB38*/ 00817000
*   /* SPECT THE RECORD                                      @Y30LB38*/ 00818000
*   /*                                                               */ 00819000
*   /*****************************************************************/ 00820000
*                                                                  0364 00821000
*   ELSE                                                           0364 00822000
*     DO;                           /*                       @Y30LB38*/ 00823000
*                                                                  0364 00824000
         B     @RC00348                                            0364 00825000
@RF00348 DS    0H                                                  0365 00826000
*       /*************************************************************/ 00827000
*       /*                                                           */ 00828000
*       /* TEST IF THIS IS A BASE VOLUME. IF YES, CALL DUPVCHK       */ 00829000
*       /*                                                   @Y30LB38*/ 00830000
*       /* ROUTINE TO CHECK FOR DUPLICATE VOLUME IF CARTRIDGE        */ 00831000
*       /*                                                   @Y30LB38*/ 00832000
*       /* NOT SPECIFIED. IF NO,TEST FOR VOLUME BEING A      @Y30LB38*/ 00833000
*       /* COPIED VOLUME.                                    @Y30LB38*/ 00834000
*       /*                                                           */ 00835000
*       /*************************************************************/ 00836000
*                                                                  0365 00837000
*       IF BCDBASE=ON THEN                                         0365 00838000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0365 00839000
         BNO   @RF00365                                            0365 00840000
*         DO;                       /*                       @Y30LB38*/ 00841000
*           IF ADDR(CART)=NULLPTR THEN                             0367 00842000
         L     @09,@PC00001+4                                      0367 00843000
         L     @09,FDTPTR+16(,@09)                                 0367 00844000
         LTR   @09,@09                                             0367 00845000
         BNZ   @RF00367                                            0367 00846000
*             DO;                   /*                       @Y30LB38*/ 00847000
*               CALL DUPVCHK;       /*                       @Y30LB38*/ 00848000
         BAL   @14,DUPVCHK                                         0369 00849000
*               RESPECIFY                                          0370 00850000
*                 RTNREG RSTD;                                     0370 00851000
*               TESTRC=RTNREG;                                     0371 00852000
         LR    TESTRC,RTNREG                                       0371 00853000
*               RESPECIFY                                          0372 00854000
*                 RTNREG UNRSTD;    /*                       @Y30LB38*/ 00855000
*               CODE2=TESTRC;       /*                       @Y30LB38*/ 00856000
         LR    CODE2,TESTRC                                        0373 00857000
*             END;                  /*                       @Y30LB38*/ 00858000
*                                                                  0374 00859000
*           /*********************************************************/ 00860000
*           /*                                                       */ 00861000
*           /* IF A DUPLICATE RECORD WAS NOT FOUND, CONTINUE WITH    */ 00862000
*           /*                                               @Y30LB38*/ 00863000
*           /* INSPECTION OF RECORD                          @Y30LB38*/ 00864000
*           /*                                                       */ 00865000
*           /*********************************************************/ 00866000
*                                                                  0375 00867000
*           IF TESTRC=0 THEN                                       0375 00868000
@RF00367 LTR   TESTRC,TESTRC                                       0375 00869000
         BNZ   @RF00375                                            0375 00870000
*             DO;                   /*                       @Y30LB38*/ 00871000
*                                                                  0376 00872000
*               /*****************************************************/ 00873000
*               /*                                                   */ 00874000
*               /* TEST THE RECOVERY FLAGS AND PRINT THE APPROPRIATE */ 00875000
*               /*                                           @Y30LB38*/ 00876000
*               /* MESSAGE WITH THE UPRINT MACRO. IF THE BASIVCRE    */ 00877000
*               /* FLAG IS ON INDICATING INCOMPLETE CREATE, MESSAGE  */ 00878000
*               /* IDC3097I IS WRITTEN. IF BASIVCPY IS ON INDICATING */ 00879000
*               /* INCOMPLETE COPY, MESSAGE IDC3096I IS WRITTEN. IF  */ 00880000
*               /* BASVSMIS IS ON INDICATING INCOMPLETE RENAME,      */ 00881000
*               /* MESSAGE IDC3095I IS WRITTEN               @Y30LB38*/ 00882000
*               /*                                                   */ 00883000
*               /*****************************************************/ 00884000
*                                                                  0377 00885000
*               IF BASIVCRE=ON|BASIVCPY=ON|BASVSMIS=ON THEN        0377 00886000
         TM    BASIVCRE(BASEVPTR),B'11100000'                      0377 00887000
         BZ    @RF00377                                            0377 00888000
*                 DO;               /*                       @Y30LB38*/ 00889000
*                   DARGSMOD=CMOVMSG;/*                      @Y30LB38*/ 00890000
         L     @05,DDSTRU                                          0379 00891000
         MVC   DARGSMOD(3,@05),@CC01061                            0379 00892000
*                   DARGDBP=ADDR(VOLVAL);/*                  @Y30LB38*/ 00893000
         L     @15,@PC00001+4                                      0380 00894000
         L     @01,FDTPTR(,@15)                                    0380 00895000
         LA    @15,VOLVAL(,@01)                                    0380 00896000
         ST    @15,DARGDBP(,@05)                                   0380 00897000
*                   DARGILP=LENGTH(VOLVAL);/*                @Y30LB38*/ 00898000
         MVC   DARGILP(2,@05),@CH00150                             0381 00899000
*                   IF BASIVCRE=ON THEN                            0382 00900000
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0382 00901000
         BNO   @RF00382                                            0382 00902000
*                     DARGSENT=MSG3097I;/*                   @Y30LB38*/ 00903000
         MVI   DARGSENT(@05),X'03'                                 0383 00904000
*                   IF BASIVCPY=ON THEN                            0384 00905000
@RF00382 TM    BASIVCPY(BASEVPTR),B'01000000'                      0384 00906000
         BNO   @RF00384                                            0384 00907000
*                     DARGSENT=MSG3096I;/*                   @Y30LB38*/ 00908000
         L     @05,DDSTRU                                          0385 00909000
         MVI   DARGSENT(@05),X'06'                                 0385 00910000
*                   IF BASVSMIS=ON THEN                            0386 00911000
@RF00384 TM    BASVSMIS(BASEVPTR),B'00100000'                      0386 00912000
         BNO   @RF00386                                            0386 00913000
*                     DARGSENT=MSG3095I;/*                   @Y30LB38*/ 00914000
         L     @01,DDSTRU                                          0387 00915000
         MVI   DARGSENT(@01),X'09'                                 0387 00916000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB38*/ 00917000
@RF00386 L     @04,@PC00001                                        0388 00918000
         ST    @04,@AL00001                                        0388 00919000
         LA    @15,@CF00111                                        0388 00920000
         ST    @15,@AL00001+4                                      0388 00921000
         LA    @15,DDSTRU                                          0388 00922000
         ST    @15,@AL00001+8                                      0388 00923000
         MVI   @AL00001+8,X'80'                                    0388 00924000
         L     @15,GDTPRT(,@04)                                    0388 00925000
         LA    @01,@AL00001                                        0388 00926000
         BALR  @14,@15                                             0388 00927000
*                   CODE2=LASTCC04; /*                       @Y30LB38*/ 00928000
         LA    CODE2,4                                             0389 00929000
*                 END;              /*                       @Y30LB38*/ 00930000
*                                                                  0390 00931000
*               /*****************************************************/ 00932000
*               /*                                                   */ 00933000
*               /* TEST IF THE VOLUME IS INACTIVE. IF NOT, USE       */ 00934000
*               /*                                           @Y30LB38*/ 00935000
*               /* UPRINT MACRO TO PRINT MESSAGE IDC3770I. IF IT IS, */ 00936000
*               /* RETURN WITH CSN.                          @Y30LB38*/ 00937000
*               /*                                                   */ 00938000
*               /*****************************************************/ 00939000
*                                                                  0391 00940000
*               ELSE                                               0391 00941000
*                 DO;               /*                       @Y30LB38*/ 00942000
         B     @RC00377                                            0391 00943000
@RF00377 DS    0H                                                  0392 00944000
*                   IF BASINAC=OFF THEN                            0392 00945000
         TM    BASINAC(BASEVPTR),B'00000100'                       0392 00946000
         BNZ   @RF00392                                            0392 00947000
*                     DO;           /*                       @Y30LB38*/ 00948000
*                       DARGSMOD=EVOVMSG;/*                  @Y30LB38*/ 00949000
         L     @04,DDSTRU                                          0394 00950000
         MVC   DARGSMOD(3,@04),@CC01059                            0394 00951000
*                       DARGDBP=ADDR(VOLVAL);/*              @Y30LB38*/ 00952000
         L     @15,@PC00001+4                                      0395 00953000
         L     @01,FDTPTR(,@15)                                    0395 00954000
         LA    @15,VOLVAL(,@01)                                    0395 00955000
         ST    @15,DARGDBP(,@04)                                   0395 00956000
*                       DARGILP=LENGTH(VOLVAL);/*            @Y30LB38*/ 00957000
         MVC   DARGILP(2,@04),@CH00150                             0396 00958000
*                       DARGSENT=MSG3770I;/*                 @Y30LB38*/ 00959000
         MVI   DARGSENT(@04),X'01'                                 0397 00960000
*                       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    0398 00961000
*                                                            @Y30LB38*/ 00962000
         L     @04,@PC00001                                        0398 00963000
         ST    @04,@AL00001                                        0398 00964000
         LA    @15,@CF00111                                        0398 00965000
         ST    @15,@AL00001+4                                      0398 00966000
         LA    @15,DDSTRU                                          0398 00967000
         ST    @15,@AL00001+8                                      0398 00968000
         MVI   @AL00001+8,X'80'                                    0398 00969000
         L     @15,GDTPRT(,@04)                                    0398 00970000
         LA    @01,@AL00001                                        0398 00971000
         BALR  @14,@15                                             0398 00972000
*                       CODE2=LASTCC04;/*                    @Y30LB38*/ 00973000
         LA    CODE2,4                                             0399 00974000
*                     END;          /*                       @Y30LB38*/ 00975000
*                                                                  0400 00976000
*                   /*************************************************/ 00977000
*                   /*                                               */ 00978000
*                   /* IF NO ERRORS HAVE BEEN FOUND, PUT THE         */ 00979000
*                   /* CARTRIDGE                             @Y30LB38*/ 00980000
*                   /* SERIAL NUMBER OF THE FIRST CARTRIDGE FROM THE */ 00981000
*                   /* RECORD INTO A WORK AREA TO RETURN TO THE      */ 00982000
*                   /* CALLER                                @Y30LB38*/ 00983000
*                   /*                                               */ 00984000
*                   /*************************************************/ 00985000
*                                                                  0401 00986000
*                   ELSE                                           0401 00987000
*                     CSNWORK=BASCSN1;/*                     @Y30LB38*/ 00988000
         B     @RC00392                                            0401 00989000
@RF00392 MVC   CSNWORK(12),BASCSN1(BASEVPTR)                       0401 00990000
*                 END;              /*                       @Y30LB38*/ 00991000
*             END;                  /*                       @Y30LB38*/ 00992000
*                                                                  0403 00993000
*           /*********************************************************/ 00994000
*           /*                                                       */ 00995000
*           /* IF A DUPLICATE RECORD WAS FOUND, SET CONDITION        */ 00996000
*           /*                                               @Y30LB38*/ 00997000
*           /* CODE TO 4                                     @Y30LB38*/ 00998000
*           /*                                                       */ 00999000
*           /*********************************************************/ 01000000
*                                                                  0404 01001000
*           ELSE                                                   0404 01002000
*             CODE2=LASTCC04;       /*                       @Y30LB38*/ 01003000
         B     @RC00375                                            0404 01004000
@RF00375 LA    CODE2,4                                             0404 01005000
*         END;                      /*                       @Y30LB38*/ 01006000
*                                                                  0406 01007000
*       /*************************************************************/ 01008000
*       /*                                                           */ 01009000
*       /* IF RECORD IS NOT A BASE VOLUME, TEST FOR IT BEING @Y30LB38*/ 01010000
*       /* A COPY RECORD                                     @Y30LB38*/ 01011000
*       /*                                                           */ 01012000
*       /*************************************************************/ 01013000
*                                                                  0406 01014000
*       ELSE                                                       0406 01015000
*         DO;                       /*                       @Y30LB38*/ 01016000
*                                                                  0406 01017000
         B     @RC00365                                            0406 01018000
@RF00365 DS    0H                                                  0407 01019000
*           /*********************************************************/ 01020000
*           /*                                                       */ 01021000
*           /* IF NOT A COPY RECORD, THEN NO INSPECTION NEEDS TO     */ 01022000
*           /*                                               @Y30LB38*/ 01023000
*           /* BE DONE. RETURN WITH CSN1                     @Y30LB38*/ 01024000
*           /*                                                       */ 01025000
*           /*********************************************************/ 01026000
*                                                                  0407 01027000
*           IF BCDCOPY=OFF THEN                                    0407 01028000
         TM    BCDCOPY(BCDVPTR),B'00010000'                        0407 01029000
         BNZ   @RF00407                                            0407 01030000
*             CSNWORK=BASCSN1;      /*                       @Y30LB38*/ 01031000
*                                                                  0408 01032000
         MVC   CSNWORK(12),BASCSN1(BASEVPTR)                       0408 01033000
*           /*********************************************************/ 01034000
*           /*                                                       */ 01035000
*           /* IF A COPY RECORD, INSPECT IT                  @Y30LB38*/ 01036000
*           /*                                                       */ 01037000
*           /*********************************************************/ 01038000
*                                                                  0409 01039000
*           ELSE                                                   0409 01040000
*             DO;                   /*                       @Y30LB38*/ 01041000
*                                                                  0409 01042000
         B     @RC00407                                            0409 01043000
@RF00407 DS    0H                                                  0410 01044000
*               /*****************************************************/ 01045000
*               /*                                                   */ 01046000
*               /* TEST IF THE COPY IS COMPLETE. IF YES, RETURN      */ 01047000
*               /*                                           @Y30LB38*/ 01048000
*               /* WITH THE CSN. IF NO, USE UPRINT MACRO TO PRINT    */ 01049000
*               /* MESSAGE IDC3096I.                         @Y30LB38*/ 01050000
*               /*                                                   */ 01051000
*               /*****************************************************/ 01052000
*                                                                  0410 01053000
*               IF BCDIVCPY=OFF THEN                               0410 01054000
         TM    BCDIVCPY(BCDVPTR),B'01000000'                       0410 01055000
         BNZ   @RF00410                                            0410 01056000
*                 CSNWORK=BASCSN1;  /*                       @Y30LB38*/ 01057000
         MVC   CSNWORK(12),BASCSN1(BASEVPTR)                       0411 01058000
*               ELSE                                               0412 01059000
*                 DO;               /*                       @Y30LB38*/ 01060000
         B     @RC00410                                            0412 01061000
@RF00410 DS    0H                                                  0413 01062000
*                   DARGSMOD=CMOVMSG;/*                      @Y30LB38*/ 01063000
         L     @04,DDSTRU                                          0413 01064000
         MVC   DARGSMOD(3,@04),@CC01061                            0413 01065000
*                   DARGDBP=ADDR(VOLVAL);/*                  @Y30LB38*/ 01066000
         L     @15,@PC00001+4                                      0414 01067000
         L     @01,FDTPTR(,@15)                                    0414 01068000
         LA    @15,VOLVAL(,@01)                                    0414 01069000
         ST    @15,DARGDBP(,@04)                                   0414 01070000
*                   DARGILP=LENGTH(VOLVAL);/*                @Y30LB38*/ 01071000
         MVC   DARGILP(2,@04),@CH00150                             0415 01072000
*                   DARGSENT=MSG3096I;/*                     @Y30LB38*/ 01073000
         MVI   DARGSENT(@04),X'06'                                 0416 01074000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB38*/ 01075000
         L     @04,@PC00001                                        0417 01076000
         ST    @04,@AL00001                                        0417 01077000
         LA    @15,@CF00111                                        0417 01078000
         ST    @15,@AL00001+4                                      0417 01079000
         LA    @15,DDSTRU                                          0417 01080000
         ST    @15,@AL00001+8                                      0417 01081000
         MVI   @AL00001+8,X'80'                                    0417 01082000
         L     @15,GDTPRT(,@04)                                    0417 01083000
         LA    @01,@AL00001                                        0417 01084000
         BALR  @14,@15                                             0417 01085000
*                   CODE2=LASTCC04; /*                       @Y30LB38*/ 01086000
         LA    CODE2,4                                             0418 01087000
*                 END;              /*                       @Y30LB38*/ 01088000
*             END;                  /*                       @Y30LB38*/ 01089000
@RC00410 DS    0H                                                  0421 01090000
*         END;                      /*                       @Y30LB38*/ 01091000
@RC00407 DS    0H                                                  0422 01092000
*     END;                          /*                       @Y30LB38*/ 01093000
*                                                                  0422 01094000
@RC00365 DS    0H                                                  0423 01095000
*   /*****************************************************************/ 01096000
*   /*                                                               */ 01097000
*   /* RESTORE THE RETURN ADDRESS AND RETURN TO THE          @Y30LB38*/ 01098000
*   /* CALLER                                                @Y30LB38*/ 01099000
*   /*                                                               */ 01100000
*   /*****************************************************************/ 01101000
*                                                                  0423 01102000
*   REG14=RETADDR1;                 /*                       @Y30LB38*/ 01103000
@RC00348 LR    REG14,RETADDR1                                      0423 01104000
*   RETURN CODE(CODE2);             /*                       @Y30LB38*/ 01105000
         LR    @15,CODE2                                           0424 01106000
@EL00003 DS    0H                                                  0424 01107000
@EF00003 DS    0H                                                  0424 01108000
@ER00003 BR    @14                                                 0424 01109000
*   END MSICPROC;                   /*                       @Y30LB38*/ 01110000
*                                                                  0426 01111000
*/********************************************************************/ 01112000
*/*                                                          @Y30LB38*/ 01113000
*/*     PROCEDURE NAME - DUPVCHK                             @Y30LB38*/ 01114000
*/*                                                          @Y30LB38*/ 01115000
*/*     FUNCTION - CHECK FOR DUPLICATE VOLUME RECORD IN      @Y30LB38*/ 01116000
*/*                THE INVENTORY.  IF A DUPLICATE VOLUME IS  @Y30LB38*/ 01117000
*/*                FOUND, ISSUE MESSAGE                      @Y30LB38*/ 01118000
*/*                                                          @Y30LB38*/ 01119000
*/*     INPUT - RVVI LIST                                    @Y30LB38*/ 01120000
*/*                                                          @Y30LB38*/ 01121000
*/*     OUTPUT - A RETURN CODE OF 00 OR 04. A RETURN         @Y30LB38*/ 01122000
*/*              CODE OF 04 MEANS THAT A DUPLICATE           @Y30LB38*/ 01123000
*/*              VOLUME WAS FOUND OR AN ERROR OCCURRED       @Y30LB38*/ 01124000
*/*              WHILE TRYING TO ACCESS THE RECORD           @Y30LB38*/ 01125000
*/*                                                          @Y30LB38*/ 01126000
*/********************************************************************/ 01127000
*                                                                  0426 01128000
*DUPVCHK:                                                          0426 01129000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 01130000
DUPVCHK  DS    0H                                                  0427 01131000
*                                                                  0427 01132000
*   /*****************************************************************/ 01133000
*   /*                                                               */ 01134000
*   /* SAVE THE RETURN ADDRESS                               @Y30LB38*/ 01135000
*   /*                                                               */ 01136000
*   /*****************************************************************/ 01137000
*                                                                  0427 01138000
*   RETADDR2=REG14;                 /*                       @Y30LB38*/ 01139000
         LR    RETADDR2,REG14                                      0427 01140000
*   OLDERID2=NEWERID2;                                             0428 01141000
         L     @09,@PC00001                                        0428 01142000
         L     @15,GDTTR2(,@09)                                    0428 01143000
         MVC   @TS00001(95),NEWERID2(@15)                          0428 01144000
         MVC   OLDERID2(95,@15),@TS00001                           0428 01145000
*   NEWID2='EVDC';                  /*                       @Y30LB38*/ 01146000
*                                                                  0429 01147000
         MVC   NEWID2(4,@15),@CC01103                              0429 01148000
*   /*****************************************************************/ 01149000
*   /*                                                               */ 01150000
*   /* TURN READ BASE VOLUME FLAG OFF AND TURN READ          @Y30LB38*/ 01151000
*   /* DUPLICATE VOLUME RECORD FLAG ON. ISSUE USSC MACRO     @Y30LB38*/ 01152000
*   /* TO READ DUPLICATE RECORD FROM MSIC.                   @Y30LB38*/ 01153000
*   /*                                                               */ 01154000
*   /*****************************************************************/ 01155000
*                                                                  0430 01156000
*   RVVBVRCD=OFF;                   /*                       @Y30LB38*/ 01157000
*   RVVDUPRC=ON;                    /*                       @Y30LB38*/ 01158000
*                                                                  0431 01159000
         L     @01,RVVIPTR                                         0431 01160000
         OI    RVVDUPRC(@01),B'00010000'                           0431 01161000
         NI    RVVBVRCD(@01),B'01111111'                           0431 01162000
*   /*****************************************************************/ 01163000
*   /*                                                               */ 01164000
*   /* TAKE UDUMP OF READ MSIC RECORD PARMAMETER             @Y30LB38*/ 01165000
*   /* LIST TO READ A RECORD (VVILIST)                       @Y30LB38*/ 01166000
*   /*                                                               */ 01167000
*   /*****************************************************************/ 01168000
*                                                                  0432 01169000
*   IF GDTDBG=NULLPTR THEN                                         0432 01170000
         L     @09,GDTDBG(,@09)                                    0432 01171000
         LTR   @09,@09                                             0432 01172000
         BZ    @RT00432                                            0432 01173000
*     ;                                                            0433 01174000
*   ELSE                                                           0434 01175000
*     DO;                                                          0434 01176000
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Y30LB38*/ 01177000
         LA    DMPINDEX,DMPSTG                                     0435 01178000
*       DMPITMNM='VVILIST';                                        0436 01179000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0436 01180000
         MVC   DMPITMNM(7,DMPINDEX),@CC01095                       0436 01181000
*       DMPITMPT=ADDR(RVVIPTR);                                    0437 01182000
         LA    @09,RVVIPTR                                         0437 01183000
         ST    @09,DMPITMPT(,DMPINDEX)                             0437 01184000
*       DMPITMLN=LENGTH(VVILIST);                                  0438 01185000
         MVC   DMPITMLN(2,DMPINDEX),@CH01240                       0438 01186000
*       DMPITMTP='H';                                              0439 01187000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0439 01188000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0440 01189000
*                                                                  0440 01190000
         AL    DMPINDEX,@CF00465                                   0440 01191000
*       /*************************************************************/ 01192000
*       /*                                                           */ 01193000
*       /*                                                   @Y30LB38*/ 01194000
*       /*                                                           */ 01195000
*       /*************************************************************/ 01196000
*                                                                  0441 01197000
*       DMPTRM=DMPTRMVL;                                           0441 01198000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0441 01199000
*     END;                          /*                       @Y30LB38*/ 01200000
*   IF GDTDBG=NULLPTR THEN                                         0443 01201000
@RT00432 L     @09,@PC00001                                        0443 01202000
         L     @09,GDTDBG(,@09)                                    0443 01203000
         LTR   @09,@09                                             0443 01204000
         BZ    @RT00443                                            0443 01205000
*     ;                                                            0444 01206000
*   ELSE                                                           0445 01207000
*     CALL IDCDB010(GDTTBL,'EVBV',ADDR(DMPSTG));/*           @Y30LB38*/ 01208000
*                                                                  0445 01209000
         L     @09,@PC00001                                        0445 01210000
         ST    @09,@AL00001                                        0445 01211000
         LA    @15,@CC01104                                        0445 01212000
         ST    @15,@AL00001+4                                      0445 01213000
         LA    @15,DMPSTG                                          0445 01214000
         ST    @15,@AFTEMPS+4                                      0445 01215000
         LA    @15,@AFTEMPS+4                                      0445 01216000
         ST    @15,@AL00001+8                                      0445 01217000
         MVI   @AL00001+8,X'80'                                    0445 01218000
         L     @15,GDTDBG(,@09)                                    0445 01219000
         LA    @01,@AL00001                                        0445 01220000
         BALR  @14,@15                                             0445 01221000
*   /*****************************************************************/ 01222000
*   /*                                                               */ 01223000
*   /* ISSUE USSC MACRO TO READ FOR A DUPLICATE RECORD.      @Y30LB38*/ 01224000
*   /*                                                               */ 01225000
*   /*****************************************************************/ 01226000
*                                                                  0446 01227000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB38*/ 01228000
@RT00443 L     @09,@PC00001                                        0446 01229000
         ST    @09,@AL00001                                        0446 01230000
         LA    @02,VVIC                                            0446 01231000
         ST    @02,@AL00001+4                                      0446 01232000
         LA    @02,RVVIPTR                                         0446 01233000
         ST    @02,@AL00001+8                                      0446 01234000
         LA    @02,REASONCD                                        0446 01235000
         ST    @02,@AL00001+12                                     0446 01236000
         MVI   @AL00001+12,X'80'                                   0446 01237000
         L     @15,GDTSSC(,@09)                                    0446 01238000
         LA    @01,@AL00001                                        0446 01239000
         BALR  @14,@15                                             0446 01240000
*   RESPECIFY                                                      0447 01241000
*     RTNREG RSTD;                                                 0447 01242000
*   TESTRC=RTNREG;                                                 0448 01243000
         LR    TESTRC,RTNREG                                       0448 01244000
*   RESPECIFY                                                      0449 01245000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 01246000
*                                                                  0449 01247000
*   /*****************************************************************/ 01248000
*   /*                                                               */ 01249000
*   /* A RETURN CODE OF 00 INDICATES THAT A DUPLICATE        @Y30LB38*/ 01250000
*   /* VOLUME WAS FOUND. IF SO, THE UPRINT MACRO IS ISSUED TO PRINT  */ 01251000
*   /* MESSAGE IDC3089I.                                     @Y30LB38*/ 01252000
*   /*                                                               */ 01253000
*   /*****************************************************************/ 01254000
*                                                                  0450 01255000
*   IF TESTRC=0 THEN                                               0450 01256000
         LTR   TESTRC,TESTRC                                       0450 01257000
         BNZ   @RF00450                                            0450 01258000
*     DO;                           /*                       @Y30LB38*/ 01259000
*       DARGSMOD=CMOVMSG;           /*                       @Y30LB38*/ 01260000
         L     @09,DDSTRU                                          0452 01261000
         MVC   DARGSMOD(3,@09),@CC01061                            0452 01262000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB38*/ 01263000
         L     @15,@PC00001+4                                      0453 01264000
         L     @01,FDTPTR(,@15)                                    0453 01265000
         LA    @15,VOLVAL(,@01)                                    0453 01266000
         ST    @15,DARGDBP(,@09)                                   0453 01267000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB38*/ 01268000
         MVC   DARGILP(2,@09),@CH00150                             0454 01269000
*       DARGSENT=MSG3089I;          /*                       @Y30LB38*/ 01270000
         MVI   DARGSENT(@09),X'11'                                 0455 01271000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/ 01272000
         L     @09,@PC00001                                        0456 01273000
         ST    @09,@AL00001                                        0456 01274000
         LA    @15,@CF00111                                        0456 01275000
         ST    @15,@AL00001+4                                      0456 01276000
         LA    @15,DDSTRU                                          0456 01277000
         ST    @15,@AL00001+8                                      0456 01278000
         MVI   @AL00001+8,X'80'                                    0456 01279000
         L     @15,GDTPRT(,@09)                                    0456 01280000
         LA    @01,@AL00001                                        0456 01281000
         BALR  @14,@15                                             0456 01282000
*       SETRC=LASTCC04;             /*                       @Y30LB38*/ 01283000
         LA    SETRC,4                                             0457 01284000
*     END;                          /*                       @Y30LB38*/ 01285000
*   ELSE                                                           0459 01286000
*     DO;                           /*                       @Y30LB38*/ 01287000
*                                                                  0459 01288000
         B     @RC00450                                            0459 01289000
@RF00450 DS    0H                                                  0460 01290000
*       /*************************************************************/ 01291000
*       /*                                                           */ 01292000
*       /* IF THE REASON CODE INDICATES AN ERROR OTHER THAN  @Y30LB38*/ 01293000
*       /* RECORD NOT FOUND, CALL SSCMSG TO PRINT THE REASON @Y30LB38*/ 01294000
*       /* AND SET THE RETURN CODE TO 04                     @Y30LB38*/ 01295000
*       /*                                                           */ 01296000
*       /*************************************************************/ 01297000
*                                                                  0460 01298000
*       IF REASONCD^=NOREC THEN                                    0460 01299000
         CLC   REASONCD(4),NOREC                                   0460 01300000
         BE    @RF00460                                            0460 01301000
*         DO;                       /*                       @Y30LB38*/ 01302000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB38*/ 01303000
         LA    @15,REASONCD                                        0462 01304000
         ST    @15,@AL00001                                        0462 01305000
         LA    @01,@AL00001                                        0462 01306000
         BAL   @14,SSCMSG                                          0462 01307000
*           SETRC=LASTCC04;         /*                       @Y30LB38*/ 01308000
         LA    SETRC,4                                             0463 01309000
*         END;                      /*                       @Y30LB38*/ 01310000
*     END;                          /*                       @Y30LB38*/ 01311000
*                                                                  0465 01312000
@RF00460 DS    0H                                                  0466 01313000
*   /*****************************************************************/ 01314000
*   /*                                                               */ 01315000
*   /* RESTORE THE RETURN ADDRESS AND RETURN TO THE CALLER   @Y30LB38*/ 01316000
*   /*                                                               */ 01317000
*   /*****************************************************************/ 01318000
*                                                                  0466 01319000
*   REG14=RETADDR2;                 /*                       @Y30LB38*/ 01320000
@RC00450 LR    REG14,RETADDR2                                      0466 01321000
*   RETURN CODE(SETRC);             /*                       @Y30LB38*/ 01322000
         LR    @15,SETRC                                           0467 01323000
@EL00004 DS    0H                                                  0467 01324000
@EF00004 DS    0H                                                  0467 01325000
@ER00004 BR    @14                                                 0467 01326000
*   END DUPVCHK;                    /*                       @Y30LB38*/ 01327000
*                                                                  0469 01328000
*/********************************************************************/ 01329000
*/*                                                          @Y30LB38*/ 01330000
*/*     PROCEDURE NAME - RECPROC                             @Y30LB38*/ 01331000
*/*                                                          @Y30LB38*/ 01332000
*/*     FUNCTION - DETERMINE WHETHER THE RECORD IN THE       @Y30LB38*/ 01333000
*/*     INVENTORY SHOULD BE RETAINED OR DELETED.             @Y30LB38*/ 01334000
*/*                                                          @Y30LB38*/ 01335000
*/*    INPUT - FUNCTION DEFINITION TABLE; INVENTORY RECORD   @Y30LB38*/ 01336000
*/*           OR FLAG INDICATING RECORD NOT FOUND            @Y30LB38*/ 01337000
*/*                                                          @Y30LB38*/ 01338000
*/*    OUTPUT - A FLAG SET TO 1 IF THE RECORD IS TO          @Y30LB38*/ 01339000
*/*    BE RETAINED.                                          @Y30LB38*/ 01340000
*/*                                                          @Y30LB38*/ 01341000
*/********************************************************************/ 01342000
*                                                                  0469 01343000
*RECPROC:                                                          0469 01344000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 01345000
RECPROC  DS    0H                                                  0470 01346000
*                                                                  0470 01347000
*   /*****************************************************************/ 01348000
*   /*                                                               */ 01349000
*   /* SAVE THE RETURN ADDRESS                               @Y30LB38*/ 01350000
*   /*                                                               */ 01351000
*   /*****************************************************************/ 01352000
*                                                                  0470 01353000
*   RETADDR1=REG14;                 /*                       @Y30LB38*/ 01354000
         LR    RETADDR1,REG14                                      0470 01355000
*   OLDERID2=NEWERID2;                                             0471 01356000
         L     @15,@PC00001                                        0471 01357000
         L     @15,GDTTR2(,@15)                                    0471 01358000
         MVC   @TS00001(95),NEWERID2(@15)                          0471 01359000
         MVC   OLDERID2(95,@15),@TS00001                           0471 01360000
*   NEWID2='EVRP';                  /*                       @Y30LB38*/ 01361000
*                                                                  0472 01362000
         MVC   NEWID2(4,@15),@CC01108                              0472 01363000
*   /*****************************************************************/ 01364000
*   /*                                                               */ 01365000
*   /* SET THE RETAIN RECORD FLAG ACCORDING TO THE FDT.      @Y30LB38*/ 01366000
*   /* IF RECORD WAS SPECIFIED ON THE COMMAND, SET THE       @Y30LB38*/ 01367000
*   /* FLAG ON. IF NORECORD WAS SPECIFIED ON THE COMMAND,    @Y30LB38*/ 01368000
*   /* SET THE FLAG OFF                                      @Y30LB38*/ 01369000
*   /*                                                               */ 01370000
*   /*****************************************************************/ 01371000
*                                                                  0473 01372000
*   IF ADDR(NREC)=NULLPTR THEN                                     0473 01373000
         SLR   @15,@15                                             0473 01374000
         L     @14,@PC00001+4                                      0473 01375000
         C     @15,FDTPTR+24(,@14)                                 0473 01376000
         BNE   @RF00473                                            0473 01377000
*     DO;                           /*                       @Y30LB38*/ 01378000
*       IF ADDR(REC)=NULLPTR THEN                                  0475 01379000
         C     @15,FDTPTR+20(,@14)                                 0475 01380000
         BNE   @RF00475                                            0475 01381000
*         DO;                       /*                       @Y30LB38*/ 01382000
*                                                                  0476 01383000
*           /*********************************************************/ 01384000
*           /*                                                       */ 01385000
*           /* IF THE USER DID NOT SPECIFY RECORD OR NO RECORD,      */ 01386000
*           /*                                               @Y30LB38*/ 01387000
*           /* SET THE FLAG ON TO RETAIN THE RECORD IF THE RECORD WAS*/ 01388000
*           /* FOUND AND THE VOLUME SET IS NOT A DUPLICATE   @Y30LB38*/ 01389000
*           /*                                                       */ 01390000
*           /*********************************************************/ 01391000
*                                                                  0477 01392000
*           IF RRCDFAIL=OFF THEN                                   0477 01393000
         TM    RRCDFAIL,B'10000000'                                0477 01394000
         BNZ   @RF00477                                            0477 01395000
*             DO;                   /*                       @Y30LB38*/ 01396000
*               IF BCDDUP=OFF THEN  /*                       @Y30LB38*/ 01397000
         TM    BCDDUP(BCDVPTR),B'00000100'                         0479 01398000
         BNZ   @RF00479                                            0479 01399000
*                 RECFLAG=ON;       /*                       @Y30LB38*/ 01400000
         OI    RECFLAG,B'10000000'                                 0480 01401000
*             END;                  /*                       @Y30LB38*/ 01402000
*         END;                      /*                       @Y30LB38*/ 01403000
*       ELSE                                                       0483 01404000
*         RECFLAG=ON;               /*                       @Y30LB38*/ 01405000
         B     @RC00475                                            0483 01406000
@RF00475 OI    RECFLAG,B'10000000'                                 0483 01407000
*     END;                          /*                       @Y30LB38*/ 01408000
*   ELSE                                                           0485 01409000
*     RECFLAG=OFF;                  /*                       @Y30LB38*/ 01410000
*                                                                  0485 01411000
         B     @RC00473                                            0485 01412000
@RF00473 NI    RECFLAG,B'01111111'                                 0485 01413000
*   /*****************************************************************/ 01414000
*   /*                                                               */ 01415000
*   /* RESTORE THE RETURN ADDRESS & RETURN TO THE CALLER     @Y30LB38*/ 01416000
*   /*                                                               */ 01417000
*   /*****************************************************************/ 01418000
*                                                                  0486 01419000
*   REG14=RETADDR1;                 /*                       @Y30LB38*/ 01420000
@RC00473 LR    REG14,RETADDR1                                      0486 01421000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 01422000
         SLR   @15,@15                                             0487 01423000
@EL00005 DS    0H                                                  0487 01424000
@EF00005 DS    0H                                                  0487 01425000
@ER00005 BR    @14                                                 0487 01426000
*   END RECPROC;                    /*                       @Y30LB38*/ 01427000
*                                                                  0489 01428000
*/****************************************************************** */ 01429000
*/*                                                          @Y30LB32*/ 01430000
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/ 01431000
*/*                                                          @Y30LB32*/ 01432000
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/ 01433000
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/ 01434000
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/ 01435000
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/ 01436000
*/*             CHARACTER                                    @Y30LB32*/ 01437000
*/*                                                          @Y30LB32*/ 01438000
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/ 01439000
*/*                                                          @Y30LB32*/ 01440000
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/ 01441000
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/ 01442000
*/*                                                          @Y30LB32*/ 01443000
*/********************************************************************/ 01444000
*                                                                  0489 01445000
*CKCSNLEN:                          /*                       @Y30LB32*/ 01446000
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/ 01447000
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/ 01448000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/ 01449000
*                                                                  0489 01450000
CKCSNLEN MVC   @PC00006(8),0(@01)                                  0489 01451000
*   /*****************************************************************/ 01452000
*   /*                                                               */ 01453000
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/ 01454000
*   /*                                                               */ 01455000
*   /*****************************************************************/ 01456000
*                                                                  0490 01457000
*   DCL                                                            0490 01458000
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/ 01459000
*   DCL                                                            0491 01460000
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/ 01461000
*   DCL                                                            0492 01462000
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/ 01463000
*   DCL                                                            0493 01464000
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/ 01465000
*   DCL                                                            0494 01466000
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/ 01467000
*   DCL                                                            0495 01468000
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/ 01469000
*   DCL                                                            0496 01470000
*     CKCOND FIXED(15);                                            0496 01471000
*                                                                  0496 01472000
*   /*****************************************************************/ 01473000
*   /*                                                               */ 01474000
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/ 01475000
*   /*                                                               */ 01476000
*   /*****************************************************************/ 01477000
*                                                                  0497 01478000
*   DCL                                                            0497 01479000
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32   01480000
*                                      CSN                   @Y30LB32*/ 01481000
*   DCL                                                            0498 01482000
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32   01483000
*                                      OF CSN AGAINST        @Y30LB32*/ 01484000
*   DCL                                                            0499 01485000
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/ 01486000
*   DCL                                                            0500 01487000
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/ 01488000
*                                                                  0501 01489000
*   /*****************************************************************/ 01490000
*   /*                                                               */ 01491000
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/ 01492000
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/ 01493000
*   /*                                                               */ 01494000
*   /*****************************************************************/ 01495000
*                                                                  0501 01496000
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/ 01497000
         LR    CKRETPTR,REG14                                      0501 01498000
*   OLDERID2=NEWERID2;                                             0502 01499000
         L     @09,@PC00001                                        0502 01500000
         L     @09,GDTTR2(,@09)                                    0502 01501000
         MVC   @TS00001(95),NEWERID2(@09)                          0502 01502000
         MVC   OLDERID2(95,@09),@TS00001                           0502 01503000
*   NEWID2='CKLN';                  /*                       @Y30LB32*/ 01504000
*                                                                  0503 01505000
         MVC   NEWID2(4,@09),@CC01126                              0503 01506000
*   /*****************************************************************/ 01507000
*   /*                                                               */ 01508000
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/ 01509000
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/ 01510000
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/ 01511000
*   /*                                                               */ 01512000
*   /*****************************************************************/ 01513000
*                                                                  0504 01514000
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/ 01515000
         L     CKSAVPTR,DDSTRU                                     0504 01516000
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/ 01517000
         LA    @09,CKPRTTAB                                        0505 01518000
         ST    @09,DDSTRU                                          0505 01519000
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/ 01520000
         XC    CKPRTTAB(20),CKPRTTAB                               0506 01521000
*   CKCOND=''B;                     /*                       @Y30LB32*/ 01522000
*                                                                  0507 01523000
         SLR   CKCOND,CKCOND                                       0507 01524000
*   /*****************************************************************/ 01525000
*   /*                                                               */ 01526000
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/ 01527000
*   /* OR MORE                                               @Y30LB32*/ 01528000
*   /*                                                               */ 01529000
*   /*****************************************************************/ 01530000
*                                                                  0508 01531000
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/ 01532000
*                                                                  0508 01533000
         L     @09,@PC00006+4                                      0508 01534000
         CLI   CKLENGTH(@09),11                                    0508 01535000
         BL    @RF00508                                            0508 01536000
*     /***************************************************************/ 01537000
*     /*                                                             */ 01538000
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/ 01539000
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/ 01540000
*     /* CHARACTER                                           @Y30LB32*/ 01541000
*     /*                                                             */ 01542000
*     /***************************************************************/ 01543000
*                                                                  0509 01544000
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/ 01545000
         CLI   CKLENGTH(@09),11                                    0509 01546000
         BNE   @RF00509                                            0509 01547000
*       DO;                         /*                       @Y30LB32*/ 01548000
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/ 01549000
         MVI   CKCSNADJ+3,C' '                                     0511 01550000
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/ 01551000
         L     @09,@PC00006                                        0512 01552000
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@09)                       0512 01553000
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/ 01554000
         MVC   CKCSNVAL+3(9,@09),CKCSNADJ+3                        0513 01555000
*       END;                        /*                       @Y30LB32*/ 01556000
*     ELSE                                                         0515 01557000
*       ;                           /*                       @Y30LB32*/ 01558000
*                                                                  0515 01559000
@RF00509 DS    0H                                                  0516 01560000
*   /*****************************************************************/ 01561000
*   /*                                                               */ 01562000
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/ 01563000
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/ 01564000
*   /*                                                               */ 01565000
*   /*****************************************************************/ 01566000
*                                                                  0516 01567000
*   ELSE                            /*                       @Y30LB32*/ 01568000
*     DO;                           /*                       @Y30LB32*/ 01569000
         B     @RC00508                                            0516 01570000
@RF00508 DS    0H                                                  0517 01571000
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/ 01572000
         L     @09,DDSTRU                                          0517 01573000
         MVC   DARGSMOD(3,@09),@CC01061                            0517 01574000
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/ 01575000
         MVI   DARGSENT(@09),X'01'                                 0518 01576000
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/ 01577000
         L     @02,@PC00006                                        0519 01578000
         ST    @02,DARGDBP(,@09)                                   0519 01579000
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/ 01580000
         MVC   DARGILP(2,@09),@CH00536                             0520 01581000
*       DARGRETP=''B;               /*                       @Y30LB32*/ 01582000
         SLR   @02,@02                                             0521 01583000
         ST    @02,DARGRETP(,@09)                                  0521 01584000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 01585000
         L     @09,@PC00001                                        0522 01586000
         ST    @09,@AL00001                                        0522 01587000
         LA    @02,@CF00111                                        0522 01588000
         ST    @02,@AL00001+4                                      0522 01589000
         LA    @02,DDSTRU                                          0522 01590000
         ST    @02,@AL00001+8                                      0522 01591000
         MVI   @AL00001+8,X'80'                                    0522 01592000
         L     @15,GDTPRT(,@09)                                    0522 01593000
         LA    @01,@AL00001                                        0522 01594000
         BALR  @14,@15                                             0522 01595000
*       CKCOND=4;                   /*                       @Y30LB32*/ 01596000
         LA    CKCOND,4                                            0523 01597000
*     END;                          /*                       @Y30LB32*/ 01598000
*                                                                  0524 01599000
*   /*****************************************************************/ 01600000
*   /*                                                               */ 01601000
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/ 01602000
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/ 01603000
*   /*                                                               */ 01604000
*   /*****************************************************************/ 01605000
*                                                                  0525 01606000
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/ 01607000
@RC00508 ST    CKSAVPTR,DDSTRU                                     0525 01608000
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/ 01609000
         LR    REG14,CKRETPTR                                      0526 01610000
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/ 01611000
         LR    @15,CKCOND                                          0527 01612000
@EL00006 DS    0H                                                  0527 01613000
@EF00006 DS    0H                                                  0527 01614000
@ER00006 BR    @14                                                 0527 01615000
*   END CKCSNLEN;                   /*                       @Y30LB32*/ 01616000
*                                                                  0529 01617000
*/********************************************************************/ 01618000
*/*                                                          @Y30LB38*/ 01619000
*/*     PROCEDURE NAME - VOLEXIT                             @Y30LB38*/ 01620000
*/*                                                          @Y30LB38*/ 01621000
*/*     FUNCTION - REMOVES A VOLUME FROM THE MSF.            @Y30LB38*/ 01622000
*/*                IF THE VOLUME IS EJECTED SUCCESSFULLY,    @Y30LB38*/ 01623000
*/*                ISSUES MESSAGE IDC0085I TO SYSPRINT AND   @Y30LB38*/ 01624000
*/*                MESSAGE IDC083E TO THE OPERATOR.  IF THE  @Y30LB38*/ 01625000
*/*                VOLUME IS NOT EJECTED SUCCESSFULLY, AN    @Y30LB38*/ 01626000
*/*                ERROR MESSAGE IS ISSUED VIA SSCMSG        @Y30LB38*/ 01627000
*/*                PROCEDURE AND MESSAGE IDC2084I IS ISSUED  @Y30LB38*/ 01628000
*/*                TO SYSPRINT.                              @Y30LB38*/ 01629000
*/*                                                          @Y30LB38*/ 01630000
*/*     INPUT - THE FOLLOWING POSITIONAL PARAMETERS ARE      @Y30LB38*/ 01631000
*/*             PASSED AS INPUT:                             @Y30LB38*/ 01632000
*/*             ARG1 = CSN OF FIRST VOLUME CARTRIDGE         @Y30LB38*/ 01633000
*/*             ARG2 = VOLUME SERIAL NUMBER                  @Y30LB38*/ 01634000
*/*             ARG3 = VVI ERROR FLAG                        @Y30LB38*/ 01635000
*/*             ARG4 = RETAIN RECORD FLAG                    @Y30LB38*/ 01636000
*/*             ARG5 = VOLUME STORAGE LOCATION               @Y30LB38*/ 01637000
*/*                                                          @Y30LB38*/ 01638000
*/*     OUTPUT - RETURN CODE IN REG15                        @Y30LB38*/ 01639000
*/*              REG15 = 00 CARTRIDGES EJECTED SUCCESSFULLY  @Y30LB38*/ 01640000
*/*              REG15 = 04 CARTRIDGES NOT EJECTED           @Y30LB38*/ 01641000
*/*                         SUCCESSFULLY                     @Y30LB38*/ 01642000
*/*              REG15 = 08 SECOND CARTRIDGE NOT EJECTED     @Y30LB38*/ 01643000
*/*                         SUCCESSFULLY                     @Y30LB38*/ 01644000
*/*                                                          @Y30LB38*/ 01645000
*/********************************************************************/ 01646000
*                                                                  0529 01647000
*VOLEXIT:                                                          0529 01648000
*   PROCEDURE(VECSN1,               /* CART SERIAL NUMBER    @Y30LB38*/ 01649000
*       VEVOLUME,                   /* VOL SERIAL NUMBER     @Y30LB38*/ 01650000
*       VEVVIERR,                   /* VVI ERROR FLAG        @Y30LB38*/ 01651000
*       VERECFLG,                   /* RETAIN RECORD FLAG    @Y30LB38*/ 01652000
*       VEVOLLOC)                   /* VOL STORAGE LOC       @Y30LB38*/ 01653000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB38*/ 01654000
VOLEXIT  MVC   @PC00007(20),0(@01)                                 0529 01655000
*                                                                  0530 01656000
*/********************************************************************/ 01657000
*/*          MACCOMP  Y30LB22          SC1DR/BL0019          @Y30LB22*/ 01658000
*/*          MACSTAT  Y30LB22          74/170/341040         @Y30LB22*/ 01659000
*/*                                                                  */ 01660000
*/*          NAME: IEZMCRTE                                  @Y30LB22*/ 01661000
*/*                                                                  */ 01662000
*/*          FUNCTION:                                       @Y30LB22*/ 01663000
*/*                  MAPS THE ICBMCRT REQUEST BLOCK          @Y30LB22*/ 01664000
*/*                  EXTENSION WHICH IS USED TO PASS         @Y30LB22*/ 01665000
*/*                  ADDITIONAL INFORMATION TO MASS          @Y30LB22*/ 01666000
*/*                  STORAGE VOLUME  CONTROL DURING          @Y30LB22*/ 01667000
*/*                  AN ICBMCRT REQUEST.                     @Y30LB22*/ 01668000
*/*                                                                  */ 01669000
*/*          STATUS:  CHANGE LEVEL = 0                       #Y30LB22*/ 01670000
*/*                                                          @Y30LB22*/ 01671000
*/********************************************************************/ 01672000
*                                                                  0530 01673000
*   /*****************************************************************/ 01674000
*   /*                                                               */ 01675000
*   /* CONSTANTS FOR IEZMCRTE                                @Y30LB22*/ 01676000
*   /*                                                               */ 01677000
*   /*****************************************************************/ 01678000
*                                                                  0530 01679000
*   DCL                                                            0530 01680000
*     MCRLEN FIXED(15) INIT(LENGTH(MCRTE));/* LENGTH         @Y30LB22   01681000
*                                      OF EXTENSION          @Y30LB22*/ 01682000
*                                                                  0530 01683000
*   /*****************************************************************/ 01684000
*   /*                                                               */ 01685000
*   /* MAPPING MACRO DECLARES                                @Y30LB22*/ 01686000
*   /*                                                               */ 01687000
*   /*****************************************************************/ 01688000
*                                                                  0531 01689000
*   DCL                                                            0531 01690000
*     1 MCRTE BASED(MCRTEPTR) BDY(WORD),                           0531 01691000
*      2 MCRLNGTH FIXED(31),        /* LENGTH OF EXTENSION   @Y30LB22*/ 01692000
*      2 MCRLOC CHAR(30),           /* LOCATION/DESTINATION OF VOL 0531 01693000
*                                      AFTER EJECTION        @Y30LB22*/ 01694000
*      2 MCRFLAGA BIT(8),           /* SPECIFICATION FLAGS   @Y30LB22*/ 01695000
*       3 MCRSPLOC BIT(1),          /* MCRLOC IS SPECIFIED   @Y30LB22*/ 01696000
*       3 * BIT(7),                 /* UNUSED                @Y30LB22*/ 01697000
*      2 MCRBLNK1 CHAR(1),          /* BLANK                 @Y30LB22*/ 01698000
*      2 MCRFLAGB BIT(32),          /* INDICATOR FLAGS       @Y30LB22*/ 01699000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 01700000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 01701000
*       3 MCRTYPE BIT(8),           /* MOVE CART. TYPE FLAG  @Y30LB22*/ 01702000
*        4 MCRREC BIT(1),           /* BIT 0=1, REC RETAIN   @Y30LB22   01703000
*                                      BIT 0=0, REC DELETE   @Y30LB22*/ 01704000
*        4 * BIT(7),                /* UNUSED                @Y30LB22*/ 01705000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 01706000
*      2 * CHAR(4);                 /* UNUSED                @Y30LB22*/ 01707000
*                                                                  0532 01708000
*   /*****************************************************************/ 01709000
*   /*                                                               */ 01710000
*   /* DECLARATIONS FOR VOLEXIT                              @Y30LB38*/ 01711000
*   /*                                                               */ 01712000
*   /*****************************************************************/ 01713000
*                                                                  0532 01714000
*   DCL                                                            0532 01715000
*     VEDDSTRU POINTER(31);         /* DARGLIST POINTER      @Y30LB38*/ 01716000
*   DCL                                                            0533 01717000
*     MCLSTPTR POINTER(31);         /* BASE PTR FOR MCLIST@Y30LB38   */ 01718000
*   DCL                                                            0534 01719000
*     MCRTEPTR POINTER(31);         /* PTR FOR MCLIST EXT    @Y30LB38*/ 01720000
*   DCL                                                            0535 01721000
*     VERETADR POINTER(31);         /* RETURN ADDR           @Y30LB38*/ 01722000
*   DCL                                                            0536 01723000
*     VEMSGPTR POINTER(31);         /* MESSAGE PTR AREA      @Y30LB38*/ 01724000
*   DCL                                                            0537 01725000
*     VEWTOPTR POINTER(31);         /* WTO MSG POINTER       @Y30LB38*/ 01726000
*   DCL                                                            0538 01727000
*     VECOND FIXED(15);             /* CONDITION CODE        @Y30LB38*/ 01728000
*   DCL                                                            0539 01729000
*     VEWTOLEN FIXED(15);           /* LENGTH OF WTO MSG     @Y30LB38*/ 01730000
*   DCL                                                            0540 01731000
*     VERESNCD FIXED(31);           /* RSN CODE FOR USSC     @Y30LB38*/ 01732000
*   DCL                                                            0541 01733000
*     VEECB CHAR(1);                /* ECB RETURN AREA       @Y30LB38*/ 01734000
*                                                                  0541 01735000
*   /*****************************************************************/ 01736000
*   /*                                                               */ 01737000
*   /* PARM LIST FOR UPRINT MACRO WITH MULTIPLE INSERTS      @Y30LB38*/ 01738000
*   /*                                                               */ 01739000
*   /*****************************************************************/ 01740000
*                                                                  0542 01741000
*   DCL                                                            0542 01742000
*     VELIST CHAR(LENGTH(DARGLIST)+(4*LENGTH(DARGARY)));/*   @Y30LB38*/ 01743000
*                                                                  0542 01744000
*   /*****************************************************************/ 01745000
*   /*                                                               */ 01746000
*   /* POSITIONAL PARMS FOR INPUT PARMAMETERS                @Y30LB38*/ 01747000
*   /*                                                               */ 01748000
*   /*****************************************************************/ 01749000
*                                                                  0543 01750000
*   DCL                                                            0543 01751000
*     VECSN1 CHAR(12);              /* CART SERIAL NUM       @Y30LB38*/ 01752000
*   DCL                                                            0544 01753000
*     VEVOLUME CHAR(6);             /* VOL SER NUMBER        @Y30LB38*/ 01754000
*   DCL                                                            0545 01755000
*     VEVVIERR BIT(1);              /* VVI ERROR FLAG        @Y30LB38*/ 01756000
*   DCL                                                            0546 01757000
*     VERECFLG BIT(1);              /* RETAIN REC FLAG       @Y30LB38*/ 01758000
*   DCL                                                            0547 01759000
*     VEVOLLOC CHAR(30);            /* VOL LOCATION          @Y30LB38*/ 01760000
*   DCL                                                            0548 01761000
*     VEWTOMSG CHAR(72);            /* UWTO MSG AREA         @Y30LB38*/ 01762000
*                                                                  0548 01763000
*   /*****************************************************************/ 01764000
*   /*                                                               */ 01765000
*   /* INVOKE LIST FORM OF MCLIST MACRO                      @Y30LB38*/ 01766000
*   /*                                                               */ 01767000
*   /*****************************************************************/ 01768000
*                                                                  0549 01769000
*   DCL                                                            0549 01770000
*     MCR1 REG(1) PTR;              /* ADDRESS OF REQUEST BLOCK    0549 01771000
*                                                            @Y30LB02*/ 01772000
*                                                                  0549 01773000
*   /*****************************************************************/ 01774000
*   /*                                                               */ 01775000
*   /* ********************************************************      */ 01776000
*   /*                                                       @Y30LB02*/ 01777000
*   /* MACMEAN MSSC MOVE CARTRIDGE MACRO                     @Y30LB02*/ 01778000
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/ 01779000
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/ 01780000
*   /* ********************************************************      */ 01781000
*   /*                                                       @Y30LB02*/ 01782000
*   /*                                                               */ 01783000
*   /*****************************************************************/ 01784000
*                                                                  0550 01785000
*   DCL                                                            0550 01786000
*     1 MCLIST BASED(MCLSTPTR),     /* MOVE CARTRIDGE REQUEST BLOCK     01787000
*                                                            @Y30LB02*/ 01788000
*      2 MCRTLEN FIXED(31),         /* LENGTH OF MOVE CARTRIDGE    0550 01789000
*                                      REQUEST BLK = 30 HEX  @Y30LB02*/ 01790000
*      2 MCRTOPCD FIXED(8),         /* MOVE CARTRIDGE OPCODE = 0E HEX   01791000
*                                                            @Y30LB02*/ 01792000
*      2 MCRTRES1 CHAR(1),          /* RESERVED AND ZERO     @Y30LB02*/ 01793000
*      2 MCRTFLG BIT(8),            /* ONE BYTE FLAGS AREA   @Y30LB02*/ 01794000
*       3 * BIT(2),                 /* RESERVED AND MUST BE ZERO   0550 01795000
*                                                            @Y30LB02*/ 01796000
*       3 MCRTTRAN BIT(1),          /* SOURCE WITH TRANSIENT CSN1  0550 01797000
*                                      SPECD                 @Y30LB02*/ 01798000
*       3 MCRTSCT BIT(1),           /* SOURCE WITH SCRATCH ATTRIBUTE    01799000
*                                                            @Y30LB02*/ 01800000
*       3 * BIT(4),                 /* RESERVED AND MUST BE ZERO   0550 01801000
*                                                            @Y30LB02*/ 01802000
*      2 MCRTLIB BIT(8),            /* BYTE-LIBID            @Y30LB02*/ 01803000
*       3 * BIT(6),                 /* RESERVED AND MUST BE ZERO   0550 01804000
*                                                            @Y30LB02*/ 01805000
*       3 MCRTLD BIT(2),            /* BINARY NUMBER ZERO TO THREE 0550 01806000
*                                                            @Y30LB02*/ 01807000
*      2 MCRTRES2 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/ 01808000
*      2 MCRTRES3 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/ 01809000
*      2 MCRTCSN CHAR(12),          /* CART SER NO           @Y30LB02*/ 01810000
*      2 MCRTRES4 CHAR(2),          /* RESERVED              @Y30LB02*/ 01811000
*      2 MCRTASID CHAR(2),          /* ASID AREA             @Y30LB02*/ 01812000
*      2 MCRTECB FIXED(31),         /* EVENT CONTROL BLOCK ADDRESS 0550 01813000
*                                                            @Y30LB02*/ 01814000
*      2 MCRTVEXT FIXED(31);        /* MSVC EXTENSION AREA   @Y30LB02*/ 01815000
*                                                                  0550 01816000
*   /*****************************************************************/ 01817000
*   /*                                                               */ 01818000
*   /*                                                       @Y30LB38*/ 01819000
*   /*                                                               */ 01820000
*   /*****************************************************************/ 01821000
*                                                                  0551 01822000
*                                                                  0551 01823000
*   /*****************************************************************/ 01824000
*   /*                                                               */ 01825000
*   /* DECLARE WORK AREA FOR MC LIST AND EXTENSION LIST      @Y30LB38*/ 01826000
*   /*                                                               */ 01827000
*   /*****************************************************************/ 01828000
*                                                                  0551 01829000
*   DCL                                                            0551 01830000
*     VEMCLIST CHAR(LENGTH(MCLIST));/*                       @Y30LB38*/ 01831000
*   DCL                                                            0552 01832000
*     VEEXLIST CHAR(LENGTH(MCRTE)); /*                       @Y30LB38*/ 01833000
*                                                                  0552 01834000
*   /*****************************************************************/ 01835000
*   /*                                                               */ 01836000
*   /* DECLARE WORK AREA FOR JOBNAME AND STEPNAME USED BY    @Y30LB38*/ 01837000
*   /* USYSINFO MACRO                                        @Y30LB38*/ 01838000
*   /*                                                               */ 01839000
*   /*****************************************************************/ 01840000
*                                                                  0553 01841000
*   DCL                                                            0553 01842000
*     1 VESYSIN CHAR(16),                                          0553 01843000
*      2 VEJOBNAM CHAR(8),                                         0553 01844000
*      2 VESTEPNM CHAR(8);          /*                       @Y30LB38*/ 01845000
*                                                                  0553 01846000
*   /*****************************************************************/ 01847000
*   /*                                                               */ 01848000
*   /* DECLARE ROUTING AND DESCRIPTOR CODE AREAS FOR UWTO    @Y30LB38*/ 01849000
*   /*                                                               */ 01850000
*   /*****************************************************************/ 01851000
*                                                                  0554 01852000
*   DCL                                                            0554 01853000
*     1 VEROUTCD BIT(16),                                          0554 01854000
*      2 VECD1 BIT(1),                                             0554 01855000
*      2 * BIT(15);                 /*                       @Y30LB38*/ 01856000
*   DCL                                                            0555 01857000
*     1 VEDESCCD BIT(16),                                          0555 01858000
*      2 * BIT(2),                                                 0555 01859000
*      2 VEDESC3 BIT(1),                                           0555 01860000
*      2 * BIT(12);                 /*                       @Y30LB38*/ 01861000
*                                                                  0555 01862000
*   /*****************************************************************/ 01863000
*   /*                                                               */ 01864000
*   /* DECLARE WORK AREA FOR UDUMP MACRO                     @Y30LB38*/ 01865000
*   /*                                                               */ 01866000
*   /*****************************************************************/ 01867000
*                                                                  0556 01868000
*   DCL                                                            0556 01869000
*     VEDMPSTG CHAR(17);            /*                       @Y30LB38*/ 01870000
*                                                                  0556 01871000
*   /*****************************************************************/ 01872000
*   /*                                                               */ 01873000
*   /* DECLARE STATIC MODULE ID FOR MESSAGES USED BY         @Y30LB38*/ 01874000
*   /* COMMON FSR'S                                          @Y30LB38*/ 01875000
*   /*                                                               */ 01876000
*   /*****************************************************************/ 01877000
*                                                                  0557 01878000
*   DCL                                                            0557 01879000
*     VECMOMSG CHAR(3) CONSTANT('CM0');/*                    @Y30LB38*/ 01880000
*   DCL                                                            0558 01881000
*     MSG0085I PTR(8) CONSTANT(21); /* MSG ENTRY NUMBER      @Y30LB38*/ 01882000
*   DCL                                                            0559 01883000
*     MSG2084I PTR(8) CONSTANT(22); /* MSG ENTRY NUMBER      @Y30LB38*/ 01884000
*   DCL                                                            0560 01885000
*     MSG083E PTR(8) CONSTANT(23);  /* MSG ENTRY NUMBER      @Y30LB38*/ 01886000
*                                                                  0560 01887000
*   /*****************************************************************/ 01888000
*   /*                                                               */ 01889000
*   /* VOLEXIT CONSTANTS                                     @Y30LB38*/ 01890000
*   /*                                                               */ 01891000
*   /*****************************************************************/ 01892000
*                                                                  0561 01893000
*   DCL                                                            0561 01894000
*     VEECBLEN FIXED(31) CONSTANT(4);/* LENGTH OF ECB        @Y30LB38*/ 01895000
*                                                                  0562 01896000
*   /*****************************************************************/ 01897000
*   /*                                                               */ 01898000
*   /* SAVE RETURN ADDRESS AND INITIALIZE PARAMETER LISTS    @Y30LB38*/ 01899000
*   /*                                                               */ 01900000
*   /*****************************************************************/ 01901000
*                                                                  0562 01902000
*   VERETADR=REG14;                 /*                       @Y30LB38*/ 01903000
         LR    VERETADR,REG14                                      0562 01904000
*   OLDERID2=NEWERID2;                                             0563 01905000
         L     @02,@PC00001                                        0563 01906000
         L     @02,GDTTR2(,@02)                                    0563 01907000
         MVC   @TS00001(95),NEWERID2(@02)                          0563 01908000
         MVC   OLDERID2(95,@02),@TS00001                           0563 01909000
*   NEWID2='VESR';                  /*                       @Y30LB38*/ 01910000
         MVC   NEWID2(4,@02),@CC01208                              0564 01911000
*   VELIST=''B;                     /*                       @Y30LB38*/ 01912000
         XC    VELIST(52),VELIST                                   0565 01913000
*   VEDDSTRU=ADDR(VELIST);          /*                       @Y30LB38*/ 01914000
         LA    @02,VELIST                                          0566 01915000
         ST    @02,VEDDSTRU                                        0566 01916000
*   MCLSTPTR=ADDR(VEMCLIST);        /*                       @Y30LB38*/ 01917000
         LA    @02,VEMCLIST                                        0567 01918000
         ST    @02,MCLSTPTR                                        0567 01919000
*   MCRTEPTR=ADDR(VEEXLIST);        /*                       @Y30LB38*/ 01920000
         LA    MCRTEPTR,VEEXLIST                                   0568 01921000
*   VEWTOPTR=ADDR(VEWTOMSG);        /*                       @Y30LB38*/ 01922000
         LA    @15,VEWTOMSG                                        0569 01923000
         ST    @15,VEWTOPTR                                        0569 01924000
*   MCLIST=''B;                     /*                       @Y30LB38*/ 01925000
         XC    MCLIST(48,@02),MCLIST(@02)                          0570 01926000
*   MCRTE=''B;                      /*                       @Y30LB38*/ 01927000
         XC    MCRTE(44,MCRTEPTR),MCRTE(MCRTEPTR)                  0571 01928000
*   VECOND='0'X;                    /*                       @Y30LB38*/ 01929000
*                                                                  0572 01930000
         SLR   VECOND,VECOND                                       0572 01931000
*   /*****************************************************************/ 01932000
*   /*                                                               */ 01933000
*   /* INITIALIZE MCLIST FOR USSC MACRO                      @Y30LB38*/ 01934000
*   /*                                                               */ 01935000
*   /*****************************************************************/ 01936000
*                                                                  0573 01937000
*   MCRLNGTH=MCRLEN;                /*                       @Y30LB38*/ 01938000
         LH    @15,MCRLEN                                          0573 01939000
         ST    @15,MCRLNGTH(,MCRTEPTR)                             0573 01940000
*   MCRTCSN=VECSN1;                 /*                       @Y30LB38*/ 01941000
         L     @15,@PC00007                                        0574 01942000
         MVC   MCRTCSN(12,@02),VECSN1(@15)                         0574 01943000
*   MCRTTRAN=ON;                    /*                       @Y30LB38*/ 01944000
         OI    MCRTTRAN(@02),B'00100000'                           0575 01945000
*   IF VERECFLG=ON THEN                                            0576 01946000
         L     @02,@PC00007+12                                     0576 01947000
         TM    VERECFLG(@02),B'10000000'                           0576 01948000
         BNO   @RF00576                                            0576 01949000
*     MCRREC=ON;                    /*                       @Y30LB38*/ 01950000
         OI    MCRREC(MCRTEPTR),B'10000000'                        0577 01951000
*   MCRLOC=VEVOLLOC;                /*                       @Y30LB38*/ 01952000
@RF00576 L     @02,@PC00007+16                                     0578 01953000
         MVC   MCRLOC(30,MCRTEPTR),VEVOLLOC(@02)                   0578 01954000
*   MCRTVEXT=MCRTEPTR;              /*                       @Y30LB38*/ 01955000
         L     @02,MCLSTPTR                                        0579 01956000
         ST    MCRTEPTR,MCRTVEXT(,@02)                             0579 01957000
*   MCRSPLOC=ON;                    /*                       @Y30LB38*/ 01958000
*                                                                  0580 01959000
         OI    MCRSPLOC(MCRTEPTR),B'10000000'                      0580 01960000
*   /*****************************************************************/ 01961000
*   /*                                                               */ 01962000
*   /* TAKE UDUMP OF MOVE VOLUME PARAMETER LIST (MCLIST)     @Y30LB38*/ 01963000
*   /*                                                               */ 01964000
*   /*****************************************************************/ 01965000
*                                                                  0581 01966000
*   IF GDTDBG=NULLPTR THEN                                         0581 01967000
         L     @15,@PC00001                                        0581 01968000
         L     @15,GDTDBG(,@15)                                    0581 01969000
         LTR   @15,@15                                             0581 01970000
         BZ    @RT00581                                            0581 01971000
*     ;                                                            0582 01972000
*   ELSE                                                           0583 01973000
*     DO;                                                          0583 01974000
*       DMPINDEX=ADDR(VEDMPSTG);    /*                       @Y30LB38*/ 01975000
         LA    DMPINDEX,VEDMPSTG                                   0584 01976000
*       DMPITMNM='MCLIST';                                         0585 01977000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0585 01978000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0585 01979000
         MVC   DMPITMNM(6,DMPINDEX),@CC01209                       0585 01980000
*       DMPITMPT=ADDR(MCLSTPTR);                                   0586 01981000
         LA    @03,MCLSTPTR                                        0586 01982000
         ST    @03,DMPITMPT(,DMPINDEX)                             0586 01983000
*       DMPITMLN=LENGTH(MCLIST);                                   0587 01984000
         MVC   DMPITMLN(2,DMPINDEX),@CH00976                       0587 01985000
*       DMPITMTP='H';                                              0588 01986000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0588 01987000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0589 01988000
*                                                                  0589 01989000
         AL    DMPINDEX,@CF00465                                   0589 01990000
*       /*************************************************************/ 01991000
*       /*                                                           */ 01992000
*       /*                                                   @Y30LB38*/ 01993000
*       /*                                                           */ 01994000
*       /*************************************************************/ 01995000
*                                                                  0590 01996000
*       DMPTRM=DMPTRMVL;                                           0590 01997000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0590 01998000
*     END;                          /*                       @Y30LB38*/ 01999000
*   IF GDTDBG=NULLPTR THEN                                         0592 02000000
@RT00581 L     @15,@PC00001                                        0592 02001000
         L     @15,GDTDBG(,@15)                                    0592 02002000
         LTR   @15,@15                                             0592 02003000
         BZ    @RT00592                                            0592 02004000
*     ;                                                            0593 02005000
*   ELSE                                                           0594 02006000
*     CALL IDCDB010(GDTTBL,'VEBM',ADDR(VEDMPSTG));/*         @Y30LB38*/ 02007000
*                                                                  0594 02008000
         L     @15,@PC00001                                        0594 02009000
         ST    @15,@AL00001                                        0594 02010000
         LA    @14,@CC01210                                        0594 02011000
         ST    @14,@AL00001+4                                      0594 02012000
         LA    @14,VEDMPSTG                                        0594 02013000
         ST    @14,@AFTEMPS+8                                      0594 02014000
         LA    @14,@AFTEMPS+8                                      0594 02015000
         ST    @14,@AL00001+8                                      0594 02016000
         MVI   @AL00001+8,X'80'                                    0594 02017000
         L     @15,GDTDBG(,@15)                                    0594 02018000
         LA    @01,@AL00001                                        0594 02019000
         BALR  @14,@15                                             0594 02020000
*   /*****************************************************************/ 02021000
*   /*                                                               */ 02022000
*   /* ISSUE USSC MACRO TO EJECT THE VOLUME                  @Y30LB38*/ 02023000
*   /*                                                               */ 02024000
*   /*****************************************************************/ 02025000
*                                                                  0595 02026000
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,VERESNCD,VEECB,VEMSGPTR);/* 0595 02027000
*                                                            @Y30LB38*/ 02028000
@RT00592 L     @02,@PC00001                                        0595 02029000
         ST    @02,@AL00001                                        0595 02030000
         LA    @15,MOVE                                            0595 02031000
         ST    @15,@AL00001+4                                      0595 02032000
         LA    @15,MCLSTPTR                                        0595 02033000
         ST    @15,@AL00001+8                                      0595 02034000
         LA    @15,VERESNCD                                        0595 02035000
         ST    @15,@AL00001+12                                     0595 02036000
         LA    @15,VEECB                                           0595 02037000
         ST    @15,@AL00001+16                                     0595 02038000
         LA    @15,VEMSGPTR                                        0595 02039000
         ST    @15,@AL00001+20                                     0595 02040000
         MVI   @AL00001+20,X'80'                                   0595 02041000
         L     @15,GDTSSC(,@02)                                    0595 02042000
         LA    @01,@AL00001                                        0595 02043000
         BALR  @14,@15                                             0595 02044000
*   RESPECIFY                                                      0596 02045000
*     RTNREG RSTD;                                                 0596 02046000
*   TESTRC=RTNREG;                                                 0597 02047000
         LR    TESTRC,RTNREG                                       0597 02048000
*   RESPECIFY                                                      0598 02049000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 02050000
*                                                                  0598 02051000
*   /*****************************************************************/ 02052000
*   /*                                                               */ 02053000
*   /* SET UP ADDRESSABILITY TO MESSAGE AREA FROM USSC       @Y30LB38*/ 02054000
*   /*                                                               */ 02055000
*   /*****************************************************************/ 02056000
*                                                                  0599 02057000
*   VEMSGPTR=VEMSGPTR+VEECBLEN;     /*                       @Y30LB38*/ 02058000
         LA    @02,4                                               0599 02059000
         AL    @02,VEMSGPTR                                        0599 02060000
         ST    @02,VEMSGPTR                                        0599 02061000
*                                                                  0600 02062000
*   /*****************************************************************/ 02063000
*   /*                                                               */ 02064000
*   /* IF CARTRIDGE WERE SUCCESSFULLY EJECTED; ISSUE THE     @Y30LB38*/ 02065000
*   /* APPROPRIATE MESSAGE                                   @Y30LB38*/ 02066000
*   /*                                                               */ 02067000
*   /*****************************************************************/ 02068000
*                                                                  0600 02069000
*   IF TESTRC=LASTCC00|TESTRC=LASTCC12 THEN                        0600 02070000
         LTR   TESTRC,TESTRC                                       0600 02071000
         BZ    @RT00600                                            0600 02072000
         C     TESTRC,@CF00536                                     0600 02073000
         BNE   @RF00600                                            0600 02074000
@RT00600 DS    0H                                                  0601 02075000
*     DO;                           /*                       @Y30LB38*/ 02076000
*                                                                  0601 02077000
*       /*************************************************************/ 02078000
*       /*                                                           */ 02079000
*       /* IF AN ERROR OCCURRES UPDATING INVENTORY, SET A    @Y30LB38*/ 02080000
*       /* FLAG ON FOR THE CALLER                            @Y30LB38*/ 02081000
*       /*                                                           */ 02082000
*       /*************************************************************/ 02083000
*                                                                  0602 02084000
*       IF TESTRC=LASTCC12 THEN                                    0602 02085000
         C     TESTRC,@CF00536                                     0602 02086000
         BNE   @RF00602                                            0602 02087000
*         VEVVIERR=ON;              /*                       @Y30LB38*/ 02088000
*                                                                  0603 02089000
         L     @15,@PC00007+8                                      0603 02090000
         OI    VEVVIERR(@15),B'10000000'                           0603 02091000
*       /*************************************************************/ 02092000
*       /*                                                           */ 02093000
*       /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME       */ 02094000
*       /*                                                   @Y30LB38*/ 02095000
*       /* TO BE USED IN MESSAGE IDC083E                     @Y30LB38*/ 02096000
*       /*                                                           */ 02097000
*       /*************************************************************/ 02098000
*                                                                  0604 02099000
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/*         @Y30LB38*/ 02100000
*                                                                  0604 02101000
@RF00602 L     @15,@PC00001                                        0604 02102000
         ST    @15,@AL00001                                        0604 02103000
         LA    @14,NAMES                                           0604 02104000
         ST    @14,@AL00001+4                                      0604 02105000
         LA    @14,VESYSIN                                         0604 02106000
         ST    @14,@AFTEMPS+8                                      0604 02107000
         LA    @14,@AFTEMPS+8                                      0604 02108000
         ST    @14,@AL00001+8                                      0604 02109000
         MVI   @AL00001+8,X'80'                                    0604 02110000
         L     @15,GDTSFO(,@15)                                    0604 02111000
         LA    @01,@AL00001                                        0604 02112000
         BALR  @14,@15                                             0604 02113000
*       /*************************************************************/ 02114000
*       /*                                                           */ 02115000
*       /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS        @Y30LB38*/ 02116000
*       /* FOR MESSAGE IDC083E                               @Y30LB38*/ 02117000
*       /*                                                           */ 02118000
*       /*************************************************************/ 02119000
*                                                                  0605 02120000
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/ 02121000
         L     @15,VEDDSTRU                                        0605 02122000
         MVC   DARGSMOD(3,@15),@CC01061                            0605 02123000
*       VEDDSTRU->DARGSENT=MSG083E; /*                       @Y30LB38*/ 02124000
         MVI   DARGSENT(@15),X'17'                                 0606 02125000
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/ 02126000
         L     @14,VEMSGPTR                                        0607 02127000
         LA    @09,CMCSN1(,@14)                                    0607 02128000
         ST    @09,DARGDBP(,@15)                                   0607 02129000
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/ 02130000
         LA    @09,12                                              0608 02131000
         STH   @09,DARGILP(,@15)                                   0608 02132000
*       VEDDSTRU->DARGRETP=VEWTOPTR;/*                       @Y30LB38*/ 02133000
         L     @08,VEWTOPTR                                        0609 02134000
         ST    @08,DARGRETP(,@15)                                  0609 02135000
*       VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*               @Y30LB38*/ 02136000
*                                                                  0610 02137000
         MVC   DARGRETL(2,@15),@CH01168                            0610 02138000
*       /*************************************************************/ 02139000
*       /*                                                           */ 02140000
*       /* IF BOTH CARTRIDGES WERE EJECTED, SET DARGLIST     @Y30LB38*/ 02141000
*       /* FOR FIVE INSERTS. IF NOT USE FOUR INSERTS.        @Y30LB38*/ 02142000
*       /* IF FIVE INSERTS ARE USED, THEY WILL BE CSN1, CSN2,        */ 02143000
*       /*                                                   @Y30LB38*/ 02144000
*       /* VOLUME SERIAL NUMBER, JOB NAME AND STEP NAME.     @Y30LB38*/ 02145000
*       /* IF FOUR INSERTS ARE USED CSN2 WILL BE OMMITTED.   @Y30LB38*/ 02146000
*       /*                                                           */ 02147000
*       /*************************************************************/ 02148000
*                                                                  0611 02149000
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/ 02150000
         CLI   CMNUMCRT(@14),X'F2'                                 0611 02151000
         BNE   @RF00611                                            0611 02152000
*         DO;                       /*                       @Y30LB38*/ 02153000
*           VEDDSTRU->DARGCNT='4'X; /*                       @Y30LB38*/ 02154000
         LA    @08,4                                               0613 02155000
         STH   @08,DARGCNT(,@15)                                   0613 02156000
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/ 02157000
         LA    @07,1                                               0614 02158000
         STH   @07,DARGINS(,@15)                                   0614 02159000
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/ 02160000
         STH   @09,DARGINL(,@15)                                   0615 02161000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/ 02162000
         LA    @14,CMCSN2(,@14)                                    0616 02163000
         ST    @14,DARGDTM(,@15)                                   0616 02164000
*           VEDDSTRU->DARGINS(2)='2'X;/*                     @Y30LB38*/ 02165000
         LA    @14,2                                               0617 02166000
         STH   @14,DARGINS+8(,@15)                                 0617 02167000
*           VEDDSTRU->DARGINL(2)=LENGTH(VEVOLUME);/*         @Y30LB38*/ 02168000
         MVC   DARGINL+8(2,@15),@CH00150                           0618 02169000
*           VEDDSTRU->DARGDTM(2)=ADDR(VEVOLUME);/*           @Y30LB38*/ 02170000
         L     @14,@PC00007+4                                      0619 02171000
         ST    @14,DARGDTM+8(,@15)                                 0619 02172000
*           VEDDSTRU->DARGINS(3)='3'X;/*                     @Y30LB38*/ 02173000
         LA    @14,3                                               0620 02174000
         STH   @14,DARGINS+16(,@15)                                0620 02175000
*           VEDDSTRU->DARGINL(3)=LENGTH(VEJOBNAM);/*         @Y30LB38*/ 02176000
         LA    @14,8                                               0621 02177000
         STH   @14,DARGINL+16(,@15)                                0621 02178000
*           VEDDSTRU->DARGDTM(3)=ADDR(VEJOBNAM);/*           @Y30LB38*/ 02179000
         LA    @09,VEJOBNAM                                        0622 02180000
         ST    @09,DARGDTM+16(,@15)                                0622 02181000
*           VEDDSTRU->DARGINS(4)='4'X;/*                     @Y30LB38*/ 02182000
         STH   @08,DARGINS+24(,@15)                                0623 02183000
*           VEDDSTRU->DARGINL(4)=LENGTH(VESTEPNM);/*         @Y30LB38*/ 02184000
         STH   @14,DARGINL+24(,@15)                                0624 02185000
*           VEDDSTRU->DARGDTM(4)=ADDR(VESTEPNM);/*           @Y30LB38*/ 02186000
         LA    @14,VESTEPNM                                        0625 02187000
         ST    @14,DARGDTM+24(,@15)                                0625 02188000
*         END;                      /*                       @Y30LB38*/ 02189000
*       ELSE                                                       0627 02190000
*         DO;                       /*                       @Y30LB38*/ 02191000
         B     @RC00611                                            0627 02192000
@RF00611 DS    0H                                                  0628 02193000
*           VEDDSTRU->DARGCNT='3'X; /*                       @Y30LB38*/ 02194000
         LA    @15,3                                               0628 02195000
         L     @14,VEDDSTRU                                        0628 02196000
         STH   @15,DARGCNT(,@14)                                   0628 02197000
*           VEDDSTRU->DARGINS(1)='2'X;/*                     @Y30LB38*/ 02198000
         LA    @09,2                                               0629 02199000
         STH   @09,DARGINS(,@14)                                   0629 02200000
*           VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*         @Y30LB38*/ 02201000
         MVC   DARGINL(2,@14),@CH00150                             0630 02202000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*           @Y30LB38*/ 02203000
         L     @09,@PC00007+4                                      0631 02204000
         ST    @09,DARGDTM(,@14)                                   0631 02205000
*           VEDDSTRU->DARGINS(2)='3'X;/*                     @Y30LB38*/ 02206000
         STH   @15,DARGINS+8(,@14)                                 0632 02207000
*           VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*         @Y30LB38*/ 02208000
         LA    @15,8                                               0633 02209000
         STH   @15,DARGINL+8(,@14)                                 0633 02210000
*           VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*           @Y30LB38*/ 02211000
         LA    @09,VEJOBNAM                                        0634 02212000
         ST    @09,DARGDTM+8(,@14)                                 0634 02213000
*           VEDDSTRU->DARGINS(3)='4'X;/*                     @Y30LB38*/ 02214000
         LA    @09,4                                               0635 02215000
         STH   @09,DARGINS+16(,@14)                                0635 02216000
*           VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*         @Y30LB38*/ 02217000
         STH   @15,DARGINL+16(,@14)                                0636 02218000
*           VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*           @Y30LB38*/ 02219000
         LA    @15,VESTEPNM                                        0637 02220000
         ST    @15,DARGDTM+16(,@14)                                0637 02221000
*         END;                      /*                       @Y30LB38*/ 02222000
*                                                                  0638 02223000
*       /*************************************************************/ 02224000
*       /*                                                           */ 02225000
*       /* ISSUE UPRINT MACRO TO RETRIEVE MESSAGE IDC0083I   @Y30LB38*/ 02226000
*       /*                                                           */ 02227000
*       /*************************************************************/ 02228000
*                                                                  0639 02229000
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/ 02230000
*                                                                  0639 02231000
@RC00611 L     @15,@PC00001                                        0639 02232000
         ST    @15,@AL00001                                        0639 02233000
         LA    @14,@CF00111                                        0639 02234000
         ST    @14,@AL00001+4                                      0639 02235000
         LA    @14,VEDDSTRU                                        0639 02236000
         ST    @14,@AL00001+8                                      0639 02237000
         MVI   @AL00001+8,X'80'                                    0639 02238000
         L     @15,GDTPRT(,@15)                                    0639 02239000
         LA    @01,@AL00001                                        0639 02240000
         BALR  @14,@15                                             0639 02241000
*       /*************************************************************/ 02242000
*       /*                                                           */ 02243000
*       /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR CODES       */ 02244000
*       /*                                                   @Y30LB38*/ 02245000
*       /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE IDC2083E*/ 02246000
*       /* TO THE SYSTEM OPERATOR.                           @Y30LB38*/ 02247000
*       /*                                                           */ 02248000
*       /*************************************************************/ 02249000
*                                                                  0640 02250000
*       VEWTOLEN=LENGTH(VEWTOMSG);  /*                       @Y30LB38*/ 02251000
         MVC   VEWTOLEN(2),@CH01168                                0640 02252000
*       VEROUTCD=''B;               /*                       @Y30LB38*/ 02253000
         XC    VEROUTCD(2),VEROUTCD                                0641 02254000
*       VECD1=ON;                   /*                       @Y30LB38*/ 02255000
         OI    VECD1,B'10000000'                                   0642 02256000
*       VEDESCCD=''B;               /*                       @Y30LB38*/ 02257000
         XC    VEDESCCD(2),VEDESCCD                                0643 02258000
*       VEDESC3=ON;                 /*                       @Y30LB38*/ 02259000
         OI    VEDESC3,B'00100000'                                 0644 02260000
*       CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,VEDESCCD);/*    02261000
*                                                            @Y30LB38*/ 02262000
         L     @15,@PC00001                                        0645 02263000
         ST    @15,@AL00001                                        0645 02264000
         LA    @14,VEWTOLEN                                        0645 02265000
         ST    @14,@AL00001+4                                      0645 02266000
         LA    @14,VEWTOPTR                                        0645 02267000
         ST    @14,@AL00001+8                                      0645 02268000
         LA    @14,VEROUTCD                                        0645 02269000
         ST    @14,@AL00001+12                                     0645 02270000
         LA    @14,VEDESCCD                                        0645 02271000
         ST    @14,@AL00001+16                                     0645 02272000
         MVI   @AL00001+16,X'80'                                   0645 02273000
         L     @15,GDTWTO(,@15)                                    0645 02274000
         LA    @01,@AL00001                                        0645 02275000
         BALR  @14,@15                                             0645 02276000
*                                                                  0646 02277000
*       /*************************************************************/ 02278000
*       /*                                                           */ 02279000
*       /* TEST IF BOTH SERIAL NUMBERS WERE SPECIFIED? IF    @Y30LB38*/ 02280000
*       /* YES, PUT BOTH CSN'S IN MESSAGE IDC0085I AND PRINT THE     */ 02281000
*       /* MESSAGE. IF NO, USE ONLY THE FIRST CSN.           @Y30LB38*/ 02282000
*       /*                                                           */ 02283000
*       /*************************************************************/ 02284000
*                                                                  0646 02285000
*       VELIST=''B;                 /*                       @Y30LB38*/ 02286000
         XC    VELIST(52),VELIST                                   0646 02287000
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/ 02288000
         L     @15,VEDDSTRU                                        0647 02289000
         MVC   DARGSMOD(3,@15),@CC01061                            0647 02290000
*       VEDDSTRU->DARGSENT=MSG0085I;/*                       @Y30LB38*/ 02291000
         MVI   DARGSENT(@15),X'15'                                 0648 02292000
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/ 02293000
         L     @14,VEMSGPTR                                        0649 02294000
         LA    @09,CMCSN1(,@14)                                    0649 02295000
         ST    @09,DARGDBP(,@15)                                   0649 02296000
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/ 02297000
         LA    @09,12                                              0650 02298000
         STH   @09,DARGILP(,@15)                                   0650 02299000
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/ 02300000
         CLI   CMNUMCRT(@14),X'F2'                                 0651 02301000
         BNE   @RF00651                                            0651 02302000
*         DO;                       /*                       @Y30LB38*/ 02303000
*           VEDDSTRU->DARGCNT='1'X; /*                       @Y30LB38*/ 02304000
         LA    @08,1                                               0653 02305000
         STH   @08,DARGCNT(,@15)                                   0653 02306000
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/ 02307000
         STH   @08,DARGINS(,@15)                                   0654 02308000
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/ 02309000
         STH   @09,DARGINL(,@15)                                   0655 02310000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/ 02311000
         LA    @14,CMCSN2(,@14)                                    0656 02312000
         ST    @14,DARGDTM(,@15)                                   0656 02313000
*         END;                      /*                       @Y30LB38*/ 02314000
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/ 02315000
*                                                                  0658 02316000
@RF00651 L     @15,@PC00001                                        0658 02317000
         ST    @15,@AL00001                                        0658 02318000
         LA    @14,@CF00111                                        0658 02319000
         ST    @14,@AL00001+4                                      0658 02320000
         LA    @14,VEDDSTRU                                        0658 02321000
         ST    @14,@AL00001+8                                      0658 02322000
         MVI   @AL00001+8,X'80'                                    0658 02323000
         L     @15,GDTPRT(,@15)                                    0658 02324000
         LA    @01,@AL00001                                        0658 02325000
         BALR  @14,@15                                             0658 02326000
*       /*************************************************************/ 02327000
*       /*                                                           */ 02328000
*       /* ISSUE UFSPACE MACRO TO FREE MESSAGE AREA SPACE    @Y30LB38*/ 02329000
*       /* FROM THE USSC MACRO                               @Y30LB38*/ 02330000
*       /*                                                           */ 02331000
*       /*************************************************************/ 02332000
*                                                                  0659 02333000
*       VEMSGPTR=VEMSGPTR-VEECBLEN; /*                       @Y30LB38*/ 02334000
         L     @15,VEMSGPTR                                        0659 02335000
         SL    @15,@CF00041                                        0659 02336000
         ST    @15,VEMSGPTR                                        0659 02337000
*       CALL IDCSAFS0(GDTTBL,VEMSGPTR);/*                    @Y30LB38*/ 02338000
         L     @15,@PC00001                                        0660 02339000
         ST    @15,@AL00001                                        0660 02340000
         LA    @14,VEMSGPTR                                        0660 02341000
         ST    @14,@AL00001+4                                      0660 02342000
         L     @15,GDTFSP(,@15)                                    0660 02343000
         LA    @01,@AL00001                                        0660 02344000
         BALR  @14,@15                                             0660 02345000
*     END;                          /*                       @Y30LB38*/ 02346000
*   ELSE                                                           0662 02347000
*     DO;                           /*                       @Y30LB38*/ 02348000
*                                                                  0662 02349000
         B     @RC00600                                            0662 02350000
@RF00600 DS    0H                                                  0663 02351000
*       /*************************************************************/ 02352000
*       /*                                                           */ 02353000
*       /* THE RETURN CODE FROM THE USSC MACRO WAS NOT 0 OR 12.      */ 02354000
*       /*                                                   @Y30LB38*/ 02355000
*       /* A RETURN CODE OF 8 IS CHECKED TO DETERMINE IF USSC COULD  */ 02356000
*       /* NOT GET STORAGE. IF YES, MESSAGE IDC2084I IS WRITTEN AND  */ 02357000
*       /* RETURN TO CALLER WITH CONDITION CODE 4.           @Y30LB38*/ 02358000
*       /*                                                           */ 02359000
*       /*************************************************************/ 02360000
*                                                                  0663 02361000
*       IF TESTRC=LASTCC08 THEN                                    0663 02362000
         C     TESTRC,@CF00173                                     0663 02363000
         BNE   @RF00663                                            0663 02364000
*         DO;                       /*                       @Y30LB38*/ 02365000
*           VELIST=''B;             /*                       @Y30LB38*/ 02366000
         XC    VELIST(52),VELIST                                   0665 02367000
*           VEDDSTRU->DARGSMOD=VECMOMSG;/*                   @Y30LB38*/ 02368000
         L     @15,VEDDSTRU                                        0666 02369000
         MVC   DARGSMOD(3,@15),@CC01061                            0666 02370000
*           VEDDSTRU->DARGSENT=MSG2084I;/*                   @Y30LB38*/ 02371000
         MVI   DARGSENT(@15),X'16'                                 0667 02372000
*           CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*        @Y30LB38*/ 02373000
         L     @15,@PC00001                                        0668 02374000
         ST    @15,@AL00001                                        0668 02375000
         LA    @14,@CF00111                                        0668 02376000
         ST    @14,@AL00001+4                                      0668 02377000
         LA    @14,VEDDSTRU                                        0668 02378000
         ST    @14,@AL00001+8                                      0668 02379000
         MVI   @AL00001+8,X'80'                                    0668 02380000
         L     @15,GDTPRT(,@15)                                    0668 02381000
         LA    @01,@AL00001                                        0668 02382000
         BALR  @14,@15                                             0668 02383000
*           VECOND=LASTCC04;        /*                       @Y30LB38*/ 02384000
         LA    VECOND,4                                            0669 02385000
*         END;                      /*                       @Y30LB38*/ 02386000
*       ELSE                                                       0671 02387000
*         DO;                       /*                       @Y30LB38*/ 02388000
*                                                                  0671 02389000
         B     @RC00663                                            0671 02390000
@RF00663 DS    0H                                                  0672 02391000
*           /*********************************************************/ 02392000
*           /*                                                       */ 02393000
*           /* IF THE RETURN CODE WAS NOT 8, TEST IF THE REASON      */ 02394000
*           /*                                               @Y30LB38*/ 02395000
*           /* CODE WAS '4C'X INDICATING THAT THE FIRST CARTRIDGE WAS*/ 02396000
*           /* EJECTED BUT THE SECOND WAS NOT. IF YES, ISSUE UPRINT  */ 02397000
*           /* AND UWTO MACROS TO WRITE MESSAGE IDC083E TO THE SYSTEM*/ 02398000
*           /* OPERATOR AND ISSUE UPRINT MACRO TO WRITE MESSAGE      */ 02399000
*           /* IDC0085I TO THE USER.                         @Y30LB38*/ 02400000
*           /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME   */ 02401000
*           /*                                               @Y30LB38*/ 02402000
*           /* TO BE USED IN MESSAGE IDC083E                 @Y30LB38*/ 02403000
*           /*                                                       */ 02404000
*           /*********************************************************/ 02405000
*                                                                  0672 02406000
*           IF VERESNCD='4C'X THEN                                 0672 02407000
         CLC   VERESNCD(4),@CF01216                                0672 02408000
         BNE   @RF00672                                            0672 02409000
*             DO;                   /*                       @Y30LB38*/ 02410000
*               CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/* @Y30LB38*/ 02411000
         L     @04,@PC00001                                        0674 02412000
         ST    @04,@AL00001                                        0674 02413000
         LA    @15,NAMES                                           0674 02414000
         ST    @15,@AL00001+4                                      0674 02415000
         LA    @15,VESYSIN                                         0674 02416000
         ST    @15,@AFTEMPS+8                                      0674 02417000
         LA    @15,@AFTEMPS+8                                      0674 02418000
         ST    @15,@AL00001+8                                      0674 02419000
         MVI   @AL00001+8,X'80'                                    0674 02420000
         L     @15,GDTSFO(,@04)                                    0674 02421000
         LA    @01,@AL00001                                        0674 02422000
         BALR  @14,@15                                             0674 02423000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 02424000
         L     @04,VEDDSTRU                                        0675 02425000
         MVC   DARGSMOD(3,@04),@CC01061                            0675 02426000
*               VEDDSTRU->DARGSENT=MSG083E;/*                @Y30LB38*/ 02427000
         MVI   DARGSENT(@04),X'17'                                 0676 02428000
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/ 02429000
         L     @15,@PC00007                                        0677 02430000
         ST    @15,DARGDBP(,@04)                                   0677 02431000
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/ 02432000
         MVC   DARGILP(2,@04),@CH00536                             0678 02433000
*               VEDDSTRU->DARGRETP=VEWTOPTR;/*               @Y30LB38*/ 02434000
         L     @15,VEWTOPTR                                        0679 02435000
         ST    @15,DARGRETP(,@04)                                  0679 02436000
*               VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*       @Y30LB38*/ 02437000
         MVC   DARGRETL(2,@04),@CH01168                            0680 02438000
*               VEDDSTRU->DARGCNT='3'X;/*                    @Y30LB38*/ 02439000
         LA    @15,3                                               0681 02440000
         STH   @15,DARGCNT(,@04)                                   0681 02441000
*               VEDDSTRU->DARGINS(1)='2'X;/*                 @Y30LB38*/ 02442000
         LA    @14,2                                               0682 02443000
         STH   @14,DARGINS(,@04)                                   0682 02444000
*               VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*     @Y30LB38*/ 02445000
         MVC   DARGINL(2,@04),@CH00150                             0683 02446000
*               VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*       @Y30LB38*/ 02447000
         L     @14,@PC00007+4                                      0684 02448000
         ST    @14,DARGDTM(,@04)                                   0684 02449000
*               VEDDSTRU->DARGINS(2)='3'X;/*                 @Y30LB38*/ 02450000
         STH   @15,DARGINS+8(,@04)                                 0685 02451000
*               VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*     @Y30LB38*/ 02452000
         LA    @15,8                                               0686 02453000
         STH   @15,DARGINL+8(,@04)                                 0686 02454000
*               VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*       @Y30LB38*/ 02455000
         LA    @14,VEJOBNAM                                        0687 02456000
         ST    @14,DARGDTM+8(,@04)                                 0687 02457000
*               VEDDSTRU->DARGINS(3)='4'X;/*                 @Y30LB38*/ 02458000
         LA    @14,4                                               0688 02459000
         STH   @14,DARGINS+16(,@04)                                0688 02460000
*               VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*     @Y30LB38*/ 02461000
         STH   @15,DARGINL+16(,@04)                                0689 02462000
*               VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*       @Y30LB38*/ 02463000
         LA    @15,VESTEPNM                                        0690 02464000
         ST    @15,DARGDTM+16(,@04)                                0690 02465000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 02466000
*                                                                  0691 02467000
         L     @04,@PC00001                                        0691 02468000
         ST    @04,@AL00001                                        0691 02469000
         LA    @15,@CF00111                                        0691 02470000
         ST    @15,@AL00001+4                                      0691 02471000
         LA    @15,VEDDSTRU                                        0691 02472000
         ST    @15,@AL00001+8                                      0691 02473000
         MVI   @AL00001+8,X'80'                                    0691 02474000
         L     @15,GDTPRT(,@04)                                    0691 02475000
         LA    @01,@AL00001                                        0691 02476000
         BALR  @14,@15                                             0691 02477000
*               /*****************************************************/ 02478000
*               /*                                                   */ 02479000
*               /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR     */ 02480000
*               /* CODES                                     @Y30LB38*/ 02481000
*               /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE */ 02482000
*               /* IDC083E TO THE SYSTEM OPERATOR.           @Y30LB38*/ 02483000
*               /*                                                   */ 02484000
*               /*****************************************************/ 02485000
*                                                                  0692 02486000
*               VEWTOLEN=LENGTH(VEWTOMSG);/*                 @Y30LB38*/ 02487000
         MVC   VEWTOLEN(2),@CH01168                                0692 02488000
*               VEROUTCD=''B;       /*                       @Y30LB38*/ 02489000
         XC    VEROUTCD(2),VEROUTCD                                0693 02490000
*               VECD1=ON;           /*                       @Y30LB38*/ 02491000
         OI    VECD1,B'10000000'                                   0694 02492000
*               VEDESCCD=''B;       /*                       @Y30LB38*/ 02493000
         XC    VEDESCCD(2),VEDESCCD                                0695 02494000
*               VEDESC3=ON;         /*                       @Y30LB38*/ 02495000
         OI    VEDESC3,B'00100000'                                 0696 02496000
*               CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,   0697 02497000
*                   VEDESCCD);      /*                       @Y30LB38*/ 02498000
*                                                                  0697 02499000
         L     @04,@PC00001                                        0697 02500000
         ST    @04,@AL00001                                        0697 02501000
         LA    @15,VEWTOLEN                                        0697 02502000
         ST    @15,@AL00001+4                                      0697 02503000
         LA    @15,VEWTOPTR                                        0697 02504000
         ST    @15,@AL00001+8                                      0697 02505000
         LA    @15,VEROUTCD                                        0697 02506000
         ST    @15,@AL00001+12                                     0697 02507000
         LA    @15,VEDESCCD                                        0697 02508000
         ST    @15,@AL00001+16                                     0697 02509000
         MVI   @AL00001+16,X'80'                                   0697 02510000
         L     @15,GDTWTO(,@04)                                    0697 02511000
         LA    @01,@AL00001                                        0697 02512000
         BALR  @14,@15                                             0697 02513000
*               /*****************************************************/ 02514000
*               /*                                                   */ 02515000
*               /* ISSUE UPRINT MACRO TO PRINT MESSAGE IDC0085I      */ 02516000
*               /*                                           @Y30LB38*/ 02517000
*               /*                                                   */ 02518000
*               /*****************************************************/ 02519000
*                                                                  0698 02520000
*               VELIST=''B;         /*                       @Y30LB38*/ 02521000
         XC    VELIST(52),VELIST                                   0698 02522000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 02523000
         L     @04,VEDDSTRU                                        0699 02524000
         MVC   DARGSMOD(3,@04),@CC01061                            0699 02525000
*               VEDDSTRU->DARGSENT=MSG0085I;/*               @Y30LB38*/ 02526000
         MVI   DARGSENT(@04),X'15'                                 0700 02527000
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/ 02528000
         L     @15,@PC00007                                        0701 02529000
         ST    @15,DARGDBP(,@04)                                   0701 02530000
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/ 02531000
         MVC   DARGILP(2,@04),@CH00536                             0702 02532000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 02533000
*                                                                  0703 02534000
         L     @04,@PC00001                                        0703 02535000
         ST    @04,@AL00001                                        0703 02536000
         LA    @15,@CF00111                                        0703 02537000
         ST    @15,@AL00001+4                                      0703 02538000
         LA    @15,VEDDSTRU                                        0703 02539000
         ST    @15,@AL00001+8                                      0703 02540000
         MVI   @AL00001+8,X'80'                                    0703 02541000
         L     @15,GDTPRT(,@04)                                    0703 02542000
         LA    @01,@AL00001                                        0703 02543000
         BALR  @14,@15                                             0703 02544000
*               /*****************************************************/ 02545000
*               /*                                                   */ 02546000
*               /* THE SSCMSG ROUTINE IS CALLED TO WRITE THE MSS     */ 02547000
*               /*                                           @Y30LB38*/ 02548000
*               /* MESSAGE EXPLAINING THE SECOND CARTRIDGE WAS NOT   */ 02549000
*               /* EJECTED.                                  @Y30LB38*/ 02550000
*               /*                                                   */ 02551000
*               /*****************************************************/ 02552000
*                                                                  0704 02553000
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/ 02554000
         LA    @04,VERESNCD                                        0704 02555000
         ST    @04,@AL00001                                        0704 02556000
         LA    @01,@AL00001                                        0704 02557000
         BAL   @14,SSCMSG                                          0704 02558000
*               VECOND=LASTCC08;    /*                       @Y30LB38*/ 02559000
         LA    VECOND,8                                            0705 02560000
*             END;                  /*                       @Y30LB38*/ 02561000
*           ELSE                                                   0707 02562000
*             DO;                   /*                       @Y30LB38*/ 02563000
*                                                                  0707 02564000
         B     @RC00672                                            0707 02565000
@RF00672 DS    0H                                                  0708 02566000
*               /*****************************************************/ 02567000
*               /*                                                   */ 02568000
*               /* RETURN CODE FROM USSC IS 4 INDICATING THAT        */ 02569000
*               /*                                           @Y30LB38*/ 02570000
*               /* THE CARTRIDGES WERE NOT EJECTED. THE SSCMSG       */ 02571000
*               /* ROUTINE IS CALLED TO WRITE THE MSS MESSAGE        */ 02572000
*               /* EXPLAINING THE ERROR. MESSAGE IDC2048I IS WRITTEN */ 02573000
*               /* TO THE USER WITH THE UPRINT MACRO.        @Y30LB38*/ 02574000
*               /*                                                   */ 02575000
*               /*****************************************************/ 02576000
*                                                                  0708 02577000
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/ 02578000
         LA    @04,VERESNCD                                        0708 02579000
         ST    @04,@AL00001                                        0708 02580000
         LA    @01,@AL00001                                        0708 02581000
         BAL   @14,SSCMSG                                          0708 02582000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 02583000
         L     @15,VEDDSTRU                                        0709 02584000
         MVC   DARGSMOD(3,@15),@CC01061                            0709 02585000
*               VEDDSTRU->DARGSENT=MSG2084I;/*               @Y30LB38*/ 02586000
         MVI   DARGSENT(@15),X'16'                                 0710 02587000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 02588000
         L     @15,@PC00001                                        0711 02589000
         ST    @15,@AL00001                                        0711 02590000
         LA    @14,@CF00111                                        0711 02591000
         ST    @14,@AL00001+4                                      0711 02592000
         LA    @14,VEDDSTRU                                        0711 02593000
         ST    @14,@AL00001+8                                      0711 02594000
         MVI   @AL00001+8,X'80'                                    0711 02595000
         L     @15,GDTPRT(,@15)                                    0711 02596000
         LA    @01,@AL00001                                        0711 02597000
         BALR  @14,@15                                             0711 02598000
*               VECOND=LASTCC04;    /*                       @Y30LB38*/ 02599000
         LA    VECOND,4                                            0712 02600000
*             END;                  /*                       @Y30LB38*/ 02601000
*         END;                      /*                       @Y30LB38*/ 02602000
@RC00672 DS    0H                                                  0715 02603000
*     END;                          /*                       @Y30LB38*/ 02604000
*                                                                  0715 02605000
@RC00663 DS    0H                                                  0716 02606000
*   /*****************************************************************/ 02607000
*   /*                                                               */ 02608000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 02609000
*   /*                                                               */ 02610000
*   /*****************************************************************/ 02611000
*                                                                  0716 02612000
*   REG14=VERETADR;                 /*                       @Y30LB38*/ 02613000
@RC00600 LR    REG14,VERETADR                                      0716 02614000
*   RETURN CODE(VECOND);            /*                       @Y30LB38*/ 02615000
         LR    @15,VECOND                                          0717 02616000
@EL00007 DS    0H                                                  0717 02617000
@EF00007 DS    0H                                                  0717 02618000
@ER00007 BR    @14                                                 0717 02619000
*   END VOLEXIT;                    /*                       @Y30LB38*/ 02620000
*                                                                  0719 02621000
*/***********************************************************@Y30LB39*/ 02622000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 02623000
*/*                                                          @Y30LB39*/ 02624000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 02625000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 02626000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 02627000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 02628000
*/*                                                          @Y30LB39*/ 02629000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 02630000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 02631000
*/*   IN SSECBCD.                                            @Y30LB39*/ 02632000
*/*                                                          @Y30LB39*/ 02633000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 02634000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 02635000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 02636000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 02637000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 02638000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 02639000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 02640000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 02641000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 02642000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 02643000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 02644000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 02645000
*/*                                                          @Y30LB39*/ 02646000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 02647000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 02648000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 02649000
*/*                                                          @Y30LB39*/ 02650000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 02651000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 02652000
*/*                                                          @Y30LB39*/ 02653000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 02654000
*/*                                                          @Y30LB39*/ 02655000
*/***********************************************************@Y30LB39*/ 02656000
*                                                                  0719 02657000
*                                   /*                       @Y30LB39*/ 02658000
*SSCMSG:                                                           0719 02659000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 02660000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   02661000
*                                                            @Y30LB39*/ 02662000
SSCMSG   STM   @14,@12,@SA00008                                    0719 02663000
         MVC   @PC00008(8),0(@01)                                  0719 02664000
*                                   /*                       @Y30LB39*/ 02665000
*                                                                  0720 02666000
*   /*****************************************************************/ 02667000
*   /*                                                               */ 02668000
*   /*                                                       @Y30LB39*/ 02669000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 02670000
*   /*                                                       @Y30LB39*/ 02671000
*   /*                                                               */ 02672000
*   /*****************************************************************/ 02673000
*                                                                  0720 02674000
*                                   /*                       @Y30LB39   02675000
*                                                            @Y30LB39*/ 02676000
*                                                                  0720 02677000
*   /*****************************************************************/ 02678000
*   /*                                                               */ 02679000
*   /*                                                       @Y30LB39*/ 02680000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 02681000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 02682000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 02683000
*   /*                                                       @Y30LB39*/ 02684000
*   /*                                                               */ 02685000
*   /*****************************************************************/ 02686000
*                                                                  0720 02687000
*                                   /*                       @Y30LB39*/ 02688000
*   DCL                                                            0720 02689000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 02690000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 02691000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 02692000
*   DCL                                                            0721 02693000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   02694000
*                                                            @Y30LB39   02695000
*                                                            @Y30LB39*/ 02696000
*                                                                  0721 02697000
*   /*****************************************************************/ 02698000
*   /*                                                               */ 02699000
*   /*                                                       @Y30LB39*/ 02700000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 02701000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 02702000
*   /*                                                       @Y30LB39*/ 02703000
*   /*                                                               */ 02704000
*   /*****************************************************************/ 02705000
*                                                                  0722 02706000
*                                   /*                       @Y30LB39*/ 02707000
*   DCL                                                            0722 02708000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 02709000
*   DCL                                                            0723 02710000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   02711000
*                                                            @Y30LB39*/ 02712000
*                                                                  0723 02713000
*   /*****************************************************************/ 02714000
*   /*                                                               */ 02715000
*   /*                                                       @Y30LB39*/ 02716000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 02717000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 02718000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 02719000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 02720000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 02721000
*   /*                                                       @Y30LB39*/ 02722000
*   /*                                                               */ 02723000
*   /*****************************************************************/ 02724000
*                                                                  0724 02725000
*                                   /*                       @Y30LB39*/ 02726000
*   DECLARE                                                        0724 02727000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   02728000
*                                                            @Y30LB39*/ 02729000
*                                                                  0724 02730000
*   /*****************************************************************/ 02731000
*   /*                                                               */ 02732000
*   /*                                                       @Y30LB39*/ 02733000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 02734000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 02735000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 02736000
*   /* IDCTSCM0.                                             @Y30LB39*/ 02737000
*   /*                                                       @Y30LB39*/ 02738000
*   /*                                                               */ 02739000
*   /*****************************************************************/ 02740000
*                                                                  0725 02741000
*                                   /*                       @Y30LB39*/ 02742000
*   DECLARE                                                        0725 02743000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   02744000
*                                                            @Y30LB39*/ 02745000
*                                                                  0725 02746000
*   /*****************************************************************/ 02747000
*   /*                                                               */ 02748000
*   /*                                                       @Y30LB39*/ 02749000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 02750000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 02751000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 02752000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 02753000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 02754000
*   /*                                                       @Y30LB39*/ 02755000
*   /*                                                               */ 02756000
*   /*****************************************************************/ 02757000
*                                                                  0726 02758000
*                                   /*                       @Y30LB39*/ 02759000
*   DECLARE                                                        0726 02760000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 02761000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   02762000
*                                                            @Y30LB39*/ 02763000
*                                                                  0726 02764000
*   /*****************************************************************/ 02765000
*   /*                                                               */ 02766000
*   /*                                                       @Y30LB39*/ 02767000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 02768000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 02769000
*   /*                                                       @Y30LB39*/ 02770000
*   /*                                                               */ 02771000
*   /*****************************************************************/ 02772000
*                                                                  0727 02773000
*                                   /*                       @Y30LB39*/ 02774000
*   DECLARE                                                        0727 02775000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   02776000
*                                                            @Y30LB39*/ 02777000
*                                                                  0727 02778000
*   /*****************************************************************/ 02779000
*   /*                                                               */ 02780000
*   /*                                                       @Y30LB39*/ 02781000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 02782000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 02783000
*   /*                                                       @Y30LB39*/ 02784000
*   /*                                                               */ 02785000
*   /*****************************************************************/ 02786000
*                                                                  0728 02787000
*                                   /*                       @Y30LB39*/ 02788000
*   DECLARE                                                        0728 02789000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   02790000
*                                                            @Y30LB39*/ 02791000
*                                   /*                       @Y30LB39*/ 02792000
*                                                                  0729 02793000
*   /*****************************************************************/ 02794000
*   /*                                                               */ 02795000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 02796000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 02797000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 02798000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 02799000
*   /*                                                       @Y30LB39*/ 02800000
*   /*                                                               */ 02801000
*   /*****************************************************************/ 02802000
*                                                                  0729 02803000
*                                   /*                       @Y30LB39*/ 02804000
*   OLDERID2=NEWERID2;                                             0729 02805000
         L     @15,@PC00001                                        0729 02806000
         L     @14,GDTTR2(,@15)                                    0729 02807000
         MVC   @TS00001(95),NEWERID2(@14)                          0729 02808000
         MVC   OLDERID2(95,@14),@TS00001                           0729 02809000
*   NEWID2='SSAA';                  /*                       @Y30LB39   02810000
*                                                            @Y30LB39*/ 02811000
*                                                                  0730 02812000
         MVC   NEWID2(4,@14),@CC01237                              0730 02813000
*   /*****************************************************************/ 02814000
*   /*                                                               */ 02815000
*   /*                                                       @Y30LB39*/ 02816000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 02817000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 02818000
*   /*                                                       @Y30LB39*/ 02819000
*   /*                                                               */ 02820000
*   /*****************************************************************/ 02821000
*                                                                  0731 02822000
*                                   /*                       @Y30LB39*/ 02823000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   02824000
*                                                            @Y30LB39*/ 02825000
*                                                                  0731 02826000
         LA    @14,SSDRGLT                                         0731 02827000
         ST    @14,SSDLPTR                                         0731 02828000
*   /*****************************************************************/ 02829000
*   /*                                                               */ 02830000
*   /*                                                       @Y30LB39*/ 02831000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 02832000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 02833000
*   /*                                                       @Y30LB39*/ 02834000
*   /*                                                               */ 02835000
*   /*****************************************************************/ 02836000
*                                                                  0732 02837000
*                                   /*                       @Y30LB39*/ 02838000
*   IF SSRCODE>0 THEN                                              0732 02839000
         L     @09,@PC00008                                        0732 02840000
         L     @09,SSRCODE(,@09)                                   0732 02841000
         LTR   @09,@09                                             0732 02842000
         BNP   @RF00732                                            0732 02843000
*     DO;                           /*                       @Y30LB39   02844000
*                                                            @Y30LB39*/ 02845000
*                                                                  0733 02846000
*       /*************************************************************/ 02847000
*       /*                                                           */ 02848000
*       /*                                                   @Y30LB39*/ 02849000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 02850000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 02851000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 02852000
*       /* CODES.                                            @Y30LB39*/ 02853000
*       /*                                                   @Y30LB39*/ 02854000
*       /*                                                           */ 02855000
*       /*************************************************************/ 02856000
*                                                                  0734 02857000
*                                   /*                       @Y30LB39*/ 02858000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02859000
         XC    SSDRGLT(20),SSDRGLT                                 0734 02860000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 02861000
         LA    @03,SSINXLST                                        0735 02862000
         ST    @03,DARGRETP(,@14)                                  0735 02863000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 02864000
         MVC   DARGSMOD(3,@14),SSMODSS0                            0736 02865000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 02866000
         MVI   DARGSENT(@14),X'01'                                 0737 02867000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   02868000
*                                                            @Y30LB39*/ 02869000
*                                                                  0738 02870000
         MVC   DARGRETL(2,@14),@CH01241                            0738 02871000
*       /*************************************************************/ 02872000
*       /*                                                           */ 02873000
*       /*                                                   @Y30LB39*/ 02874000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 02875000
*       /* ARRAY.                                            @Y30LB39*/ 02876000
*       /*                                                   @Y30LB39*/ 02877000
*       /*                                                           */ 02878000
*       /*************************************************************/ 02879000
*                                                                  0739 02880000
*                                   /*                       @Y30LB39*/ 02881000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   02882000
*                                                            @Y30LB39*/ 02883000
*                                                                  0739 02884000
         ST    @15,@AL00001                                        0739 02885000
         LA    @03,@CF00111                                        0739 02886000
         ST    @03,@AL00001+4                                      0739 02887000
         LA    @03,SSDLPTR                                         0739 02888000
         ST    @03,@AL00001+8                                      0739 02889000
         MVI   @AL00001+8,X'80'                                    0739 02890000
         L     @15,GDTPRT(,@15)                                    0739 02891000
         LA    @01,@AL00001                                        0739 02892000
         BALR  @14,@15                                             0739 02893000
*       /*************************************************************/ 02894000
*       /*                                                           */ 02895000
*       /*                                                   @Y30LB39*/ 02896000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 02897000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 02898000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 02899000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 02900000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 02901000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 02902000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 02903000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 02904000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 02905000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 02906000
*       /* REASON CODE.                                      @Y30LB39*/ 02907000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 02908000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 02909000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 02910000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 02911000
*       /*                                                   @Y30LB39*/ 02912000
*       /*                                                           */ 02913000
*       /*************************************************************/ 02914000
*                                                                  0740 02915000
*                                   /*                       @Y30LB39*/ 02916000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 02917000
         LA    ENTRYNUM,1                                          0740 02918000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   0741 02919000
@DL00741 DS    0H                                                  0742 02920000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 02921000
         AL    ENTRYNUM,@CF00213                                   0742 02922000
*       END;                        /*                       @Y30LB39   02923000
*                                                            @Y30LB39*/ 02924000
*                                                                  0743 02925000
@DE00741 L     @03,@PC00008                                        0743 02926000
         LR    @15,ENTRYNUM                                        0743 02927000
         ALR   @15,@15                                             0743 02928000
         LH    @15,SSARRAY-2(@15)                                  0743 02929000
         CH    @15,SSRHALF(,@03)                                   0743 02930000
         BE    @DC00741                                            0743 02931000
         SLR   @14,@14                                             0743 02932000
         CR    @15,@14                                             0743 02933000
         BNE   @DL00741                                            0743 02934000
@DC00741 DS    0H                                                  0744 02935000
*       /*************************************************************/ 02936000
*       /*                                                           */ 02937000
*       /*                                                   @Y30LB39*/ 02938000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 02939000
*       /*                                                   @Y30LB39*/ 02940000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 02941000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 02942000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 02943000
*       /* CODE OR                                           @Y30LB39*/ 02944000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 02945000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 02946000
*       /*                                                   @Y30LB39*/ 02947000
*       /*                                                           */ 02948000
*       /*************************************************************/ 02949000
*                                                                  0744 02950000
*                                   /*                       @Y30LB39*/ 02951000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02952000
         XC    SSDRGLT(20),SSDRGLT                                 0744 02953000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 02954000
         L     @09,SSDLPTR                                         0745 02955000
         MVC   DARGSMOD(3,@09),SSMODSS0                            0745 02956000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 02957000
         STC   ENTRYNUM,DARGSENT(,@09)                             0746 02958000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 02959000
         CR    @15,@14                                             0747 02960000
         BNE   @RF00747                                            0747 02961000
*         DO;                       /*                       @Y30LB39*/ 02962000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 02963000
         ST    @03,DARGDBP(,@09)                                   0749 02964000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 02965000
         MVC   DARGILP(2,@09),@CH00041                             0750 02966000
*         END;                      /*                       @Y30LB39*/ 02967000
*     END;                          /*                       @Y30LB39*/ 02968000
*                                   /*                       @Y30LB39*/ 02969000
*                                                                  0753 02970000
*   /*****************************************************************/ 02971000
*   /*                                                               */ 02972000
*   /*                                                       @Y30LB39*/ 02973000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 02974000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 02975000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 02976000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 02977000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 02978000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 02979000
*   /* POST CODE.                                            @Y30LB39*/ 02980000
*   /*                                                       @Y30LB39*/ 02981000
*   /*                                                               */ 02982000
*   /*****************************************************************/ 02983000
*                                                                  0753 02984000
*                                   /*                       @Y30LB39*/ 02985000
*   ELSE                            /*                       @Y30LB39*/ 02986000
*     DO;                           /*                       @Y30LB39*/ 02987000
         B     @RC00732                                            0753 02988000
@RF00732 DS    0H                                                  0754 02989000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02990000
         XC    SSDRGLT(20),SSDRGLT                                 0754 02991000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 02992000
         L     @15,SSDLPTR                                         0755 02993000
         MVC   DARGSMOD(3,@15),SSMODCM0                            0755 02994000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 02995000
         MVC   DARGSENT(1,@15),SSMSGNUM                            0756 02996000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 02997000
         L     @14,@PC00008+4                                      0757 02998000
         ST    @14,DARGDBP(,@15)                                   0757 02999000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 03000000
         MVC   DARGILP(2,@15),@CH00213                             0758 03001000
*     END;                          /*                       @Y30LB39   03002000
*                                                            @Y30LB39*/ 03003000
*                                                                  0759 03004000
*   /*****************************************************************/ 03005000
*   /*                                                               */ 03006000
*   /*                                                       @Y30LB39*/ 03007000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 03008000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 03009000
*   /*                                                       @Y30LB39*/ 03010000
*   /*                                                               */ 03011000
*   /*****************************************************************/ 03012000
*                                                                  0760 03013000
*                                   /*                       @Y30LB39*/ 03014000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   03015000
*                                                            @Y30LB39*/ 03016000
*                                                                  0760 03017000
@RC00732 L     @15,@PC00001                                        0760 03018000
         ST    @15,@AL00001                                        0760 03019000
         LA    @14,@CF00111                                        0760 03020000
         ST    @14,@AL00001+4                                      0760 03021000
         LA    @14,SSDLPTR                                         0760 03022000
         ST    @14,@AL00001+8                                      0760 03023000
         MVI   @AL00001+8,X'80'                                    0760 03024000
         L     @15,GDTPRT(,@15)                                    0760 03025000
         LA    @01,@AL00001                                        0760 03026000
         BALR  @14,@15                                             0760 03027000
*   /*****************************************************************/ 03028000
*   /*                                                               */ 03029000
*   /*                                                       @Y30LB39*/ 03030000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 03031000
*   /*                                                       @Y30LB39*/ 03032000
*   /*                                                               */ 03033000
*   /*****************************************************************/ 03034000
*                                                                  0761 03035000
*                                   /*                       @Y30LB39   03036000
*                                                            @Y30LB39*/ 03037000
*   RETURN CODE(0);                 /*                       @Y30LB39   03038000
*                                                            @Y30LB39*/ 03039000
         SLR   @15,@15                                             0761 03040000
         L     @14,@SA00008                                        0761 03041000
         LM    @00,@12,@SA00008+8                                  0761 03042000
         BR    @14                                                 0761 03043000
*   END SSCMSG;                     /*                       @Y30LB39*/ 03044000
*   END IDCEV01                     /*                       @Y30LB38*/ 03045000
*                                                                  0763 03046000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03047000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 03048000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 03049000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 03050000
*/*%INCLUDE SYSLIB  (IDCCSEV )                                       */ 03051000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 03052000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 03053000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 03054000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 03055000
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */ 03056000
*/*%INCLUDE SYSLIB  (IDCDF51 )                                       */ 03057000
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */ 03058000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 03059000
*                                                                  0763 03060000
*       ;                                                          0763 03061000
@DATA    DS    0H                                                       03062000
@CH00147 DC    H'2'                                                     03063000
@CH00150 DC    H'6'                                                     03064000
@CH00976 DC    H'48'                                                    03065000
@CH01240 DC    H'68'                                                    03066000
@CH01168 DC    H'72'                                                    03067000
@CH01241 DC    H'120'                                                   03068000
@CH01239 DC    H'224'                                                   03069000
         DS    0F                                                       03070000
@AL00243 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        03071000
         DC    A(WAIT)                                                  03072000
         DC    A(@CC01065)                                              03073000
@DATD    DSECT                                                          03074000
         DS    0F                                                       03075000
@SA00001 DS    18F                                                      03076000
@PC00001 DS    3F                                                       03077000
@PC00006 DS    2F                                                       03078000
@PC00007 DS    5F                                                       03079000
@SA00008 DS    15F                                                      03080000
@PC00008 DS    2F                                                       03081000
@AL00001 DS    6A                                                       03082000
@AFTEMPS DS    3F                                                       03083000
IDCEV01  CSECT                                                          03084000
         DS    0F                                                       03085000
@CF00111 DC    F'0'                                                     03086000
@CF00213 DC    F'1'                                                     03087000
@CH00213 EQU   @CF00213+2                                               03088000
@CF00041 DC    F'4'                                                     03089000
@CH00041 EQU   @CF00041+2                                               03090000
@CF00173 DC    F'8'                                                     03091000
@CF00536 DC    F'12'                                                    03092000
@CH00536 EQU   @CF00536+2                                               03093000
@CF00465 DC    F'16'                                                    03094000
@CF01216 DC    XL4'4C'                                                  03095000
@DATD    DSECT                                                          03096000
         DS    0D                                                       03097000
LISTSCAN DS    A                                                        03098000
IOCSPTR  DS    A                                                        03099000
OPNPTR   DS    A                                                        03100000
DDSTRU   DS    A                                                        03101000
FSADDR   DS    A                                                        03102000
CCMSGPTR DS    A                                                        03103000
CMMSGPTR DS    A                                                        03104000
CTMSGPTR DS    A                                                        03105000
RVVIPTR  DS    A                                                        03106000
REASONCD DS    F                                                        03107000
VEDDSTRU DS    A                                                        03108000
MCLSTPTR DS    A                                                        03109000
VEMSGPTR DS    A                                                        03110000
VEWTOPTR DS    A                                                        03111000
VERESNCD DS    F                                                        03112000
SSDLPTR  DS    A                                                        03113000
LISTPTR  DS    A                                                        03114000
VEWTOLEN DS    H                                                        03115000
LISTLN   DS    FL1                                                      03116000
         DS    0D                                                       03117000
@TS00001 DS    CL95                                                     03118000
         DS    CL1                                                      03119000
PRINTAB  DS    CL20                                                     03120000
CSNWORK  DS    CL12                                                     03121000
VVIREC   DS    CL224                                                    03122000
VVILIST  DS    CL68                                                     03123000
LOCATION DS    CL30                                                     03124000
RNAME    DS    CL23                                                     03125000
         ORG   RNAME                                                    03126000
@NM00070 DS    FL1                                                      03127000
VOLSN    DS    CL6                                                      03128000
@NM00071 DS    CL16                                                     03129000
         ORG   RNAME+23                                                 03130000
FLAGS    DS    BL1                                                      03131000
         ORG   FLAGS                                                    03132000
RRCDFAIL DS    BL1                                                      03133000
@NM00072 EQU   FLAGS+0                                                  03134000
         ORG   FLAGS+1                                                  03135000
RECINDIC DS    BL1                                                      03136000
         ORG   RECINDIC                                                 03137000
RECFLAG  DS    BL1                                                      03138000
@NM00073 EQU   RECINDIC+0                                               03139000
         ORG   RECINDIC+1                                               03140000
MSICERR  DS    BL1                                                      03141000
         ORG   MSICERR                                                  03142000
INVERR   DS    BL1                                                      03143000
@NM00074 EQU   MSICERR+0                                                03144000
         ORG   MSICERR+1                                                03145000
DMPSTG   DS    CL17                                                     03146000
CKCSNADJ DS    CL12                                                     03147000
         DS    CL3                                                      03148000
CKPRTTAB DS    CL20                                                     03149000
VEECB    DS    CL1                                                      03150000
VELIST   DS    CL52                                                     03151000
VEWTOMSG DS    CL72                                                     03152000
VEMCLIST DS    CL48                                                     03153000
VEEXLIST DS    CL44                                                     03154000
VESYSIN  DS    CL16                                                     03155000
         ORG   VESYSIN                                                  03156000
VEJOBNAM DS    CL8                                                      03157000
VESTEPNM DS    CL8                                                      03158000
         ORG   VESYSIN+16                                               03159000
VEROUTCD DS    BL2                                                      03160000
         ORG   VEROUTCD                                                 03161000
VECD1    DS    BL1                                                      03162000
@NM00088 EQU   VEROUTCD+0                                               03163000
         ORG   VEROUTCD+2                                               03164000
VEDESCCD DS    BL2                                                      03165000
         ORG   VEDESCCD                                                 03166000
@NM00089 DS    BL1                                                      03167000
VEDESC3  EQU   VEDESCCD+0                                               03168000
@NM00090 EQU   VEDESCCD+0                                               03169000
         ORG   VEDESCCD+2                                               03170000
VEDMPSTG DS    CL17                                                     03171000
SSDRGLT  DS    CL20                                                     03172000
         DS    CL2                                                      03173000
SSINXLST DS    CL120                                                    03174000
         ORG   SSINXLST                                                 03175000
SSARRAY  DS    60H                                                      03176000
         ORG   SSINXLST+120                                             03177000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03178000
@ENDDATD EQU   *                                                        03179000
IDCEV01  CSECT                                                          03180000
         DS    0F                                                       03181000
@SIZDATD DC    AL1(0)                                                   03182000
         DC    AL3(@ENDDATD-@DATD)                                      03183000
         DS    0D                                                       03184000
NOREC    DC    XL4'208'                                                 03185000
RVVLEN   DC    AL2(68)                                                  03186000
MCRLEN   DC    AL2(44)                                                  03187000
SSMSGNUM DC    AL1(56)                                                  03188000
@CC01065 DC    C'SYSZAMS '                                              03189000
@CC01095 DC    C'VVILIST'                                               03190000
@CC01209 DC    C'MCLIST'                                                03191000
@CC01074 DC    C'EVVE'                                                  03192000
@CC01083 DC    C'EVRC'                                                  03193000
@CC01087 DC    C'EVPC'                                                  03194000
@CC01093 DC    C'EVVP'                                                  03195000
@CC01097 DC    C'EVBR'                                                  03196000
@CC01103 DC    C'EVDC'                                                  03197000
@CC01104 DC    C'EVBV'                                                  03198000
@CC01108 DC    C'EVRP'                                                  03199000
@CC01126 DC    C'CKLN'                                                  03200000
@CC01208 DC    C'VESR'                                                  03201000
@CC01210 DC    C'VEBM'                                                  03202000
@CC01237 DC    C'SSAA'                                                  03203000
@CC01057 DC    C'UV0'                                                   03204000
@CC01059 DC    C'EV0'                                                   03205000
@CC01061 DC    C'CM0'                                                   03206000
ALL      DC    CL3'ALL'                                                 03207000
FORMAT   DC    CL4'FORM'                                                03208000
HSECOND  DC    CL4'HSEC'                                                03209000
CLOCK    DC    CL4'KLOK'                                                03210000
SETZERO  DC    CL4'ZERO'                                                03211000
SETBLANK DC    CL4'BLNK'                                                03212000
NOSET    DC    CL4'NSET'                                                03213000
OVERRIDE DC    CL4'OVRD'                                                03214000
ACQUIRE  DC    CL8'ACQUIRE '                                            03215000
RELINQ   DC    CL8'RELINQ  '                                            03216000
MOUNT    DC    CL8'MOUNT   '                                            03217000
DEMOUNT  DC    CL8'DEMOUNT '                                            03218000
DEFINE   DC    CL8'DEFINE  '                                            03219000
MOVE     DC    CL8'MOVE    '                                            03220000
TRACEQ   DC    CL8'TRACEQ  '                                            03221000
COPYTABL DC    CL8'COPYTABL'                                            03222000
COPYCRTG DC    CL8'COPYCRTG'                                            03223000
COPYVOL  DC    CL8'COPYVOL '                                            03224000
VVIC     DC    CL8'VVIC    '                                            03225000
TUNE     DC    CL8'TUNE    '                                            03226000
NAMES    DC    CL4'NAME'                                                03227000
UNIT     DC    CL4'UNIT'                                                03228000
SHR      DC    CL4'SHR '                                                03229000
EXCL     DC    CL4'EXCL'                                                03230000
NOWAIT   DC    CL4'NWAI'                                                03231000
WAIT     DC    CL4'WAIT'                                                03232000
SECCHECK DC    CL8'SECCHECK'                                            03233000
SCRVTOC  DC    CL8'SCRVTOC '                                            03234000
GETVTOC  DC    CL8'GETVTOC '                                            03235000
PUTVTOC  DC    CL8'PUTVTOC '                                            03236000
RECATLG  DC    CL8'RECATLG '                                            03237000
INITVOL  DC    CL8'INITVOL '                                            03238000
CHECK    DC    CL8'CHECK   '                                            03239000
POSTUCB  DC    CL8'POSTUCB '                                            03240000
GET      DC    CL8'GET     '                                            03241000
PUT      DC    CL8'PUT     '                                            03242000
CLOSE    DC    CL8'CLOSE   '                                            03243000
OPEN     DC    CL8'OPEN    '                                            03244000
PUTLABEL DC    CL8'PUTLABEL'                                            03245000
GETLABEL DC    CL8'GETLABEL'                                            03246000
CANCEL   DC    CL8'CANCEL  '                                            03247000
SET      DC    CL8'SET     '                                            03248000
FIXAREA  DS    CL250                                                    03249000
         ORG   FIXAREA                                                  03250000
@NM00069 DC    250X'00'                                                 03251000
         ORG   FIXAREA+250                                              03252000
RNAMECON DS    CL23                                                     03253000
         ORG   RNAMECON                                                 03254000
@NM00075 DC    AL1(22)                                                  03255000
@NM00076 DS    CL6                                                      03256000
@NM00077 DC    CL8'.VIRTUAL'                                            03257000
@NM00078 DC    CL8'.ENQUEUE'                                            03258000
         ORG   RNAMECON+23                                              03259000
MODID    DC    CL4'EV01'                                                03260000
SSMODSS0 DC    CL3'SS0'                                                 03261000
SSMODCM0 DC    CL3'CM0'                                                 03262000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03263000
@01      EQU   01                                                       03264000
@02      EQU   02                                                       03265000
@03      EQU   03                                                       03266000
@04      EQU   04                                                       03267000
@05      EQU   05                                                       03268000
@06      EQU   06                                                       03269000
@07      EQU   07                                                       03270000
@08      EQU   08                                                       03271000
@09      EQU   09                                                       03272000
@10      EQU   10                                                       03273000
@11      EQU   11                                                       03274000
@12      EQU   12                                                       03275000
@13      EQU   13                                                       03276000
@14      EQU   14                                                       03277000
@15      EQU   15                                                       03278000
ENTRYNUM EQU   @02                                                      03279000
VECOND   EQU   @04                                                      03280000
VERETADR EQU   @05                                                      03281000
MCRTEPTR EQU   @03                                                      03282000
CKCOND   EQU   @03                                                      03283000
CKSAVPTR EQU   @05                                                      03284000
CKRETPTR EQU   @04                                                      03285000
CODE2    EQU   @05                                                      03286000
RETADDR2 EQU   @05                                                      03287000
RETADDR1 EQU   @06                                                      03288000
BCDVPTR  EQU   @07                                                      03289000
BASEVPTR EQU   @04                                                      03290000
DMPINDEX EQU   @02                                                      03291000
TESTRC   EQU   @03                                                      03292000
SETRC    EQU   @08                                                      03293000
REG10    EQU   @10                                                      03294000
REG12    EQU   @12                                                      03295000
RTNREG   EQU   @15                                                      03296000
REG14    EQU   @14                                                      03297000
MCR1     EQU   @01                                                      03298000
REG0     EQU   @00                                                      03299000
REG1     EQU   @01                                                      03300000
REG11    EQU   @11                                                      03301000
REG13    EQU   @13                                                      03302000
REG15    EQU   @15                                                      03303000
REG2     EQU   @02                                                      03304000
REG3     EQU   @03                                                      03305000
REG4     EQU   @04                                                      03306000
REG5     EQU   @05                                                      03307000
REG6     EQU   @06                                                      03308000
REG7     EQU   @07                                                      03309000
REG8     EQU   @08                                                      03310000
REG9     EQU   @09                                                      03311000
IDCSAEP0 EQU   0                                                        03312000
IDCSAFS0 EQU   0                                                        03313000
IDCSASS0 EQU   0                                                        03314000
IDCSANQ0 EQU   0                                                        03315000
IDCSADQ0 EQU   0                                                        03316000
IDCSASI0 EQU   0                                                        03317000
IDCSAWO0 EQU   0                                                        03318000
TRACE1   EQU   0                                                        03319000
OLDERID1 EQU   TRACE1                                                   03320000
TRACE2   EQU   0                                                        03321000
OLDERID2 EQU   TRACE2                                                   03322000
NEWID2   EQU   TRACE2+95                                                03323000
NEWERID2 EQU   5                                                        03324000
CIRAGL   EQU   0                                                        03325000
CIRTYPE  EQU   CIRAGL                                                   03326000
ALLAGL   EQU   0                                                        03327000
ALLSTS   EQU   ALLAGL+24                                                03328000
ALLDSP   EQU   ALLAGL+25                                                03329000
ALLORG   EQU   ALLAGL+26                                                03330000
ALLOPT   EQU   ALLAGL+28                                                03331000
UNITABL  EQU   0                                                        03332000
UNITADR  EQU   UNITABL+4                                                03333000
@NM00010 EQU   UNITADR                                                  03334000
UNITSTAT EQU   UNITABL+6                                                03335000
IOCSTR   EQU   0                                                        03336000
IOCDSO   EQU   IOCSTR+16                                                03337000
IOCRFM   EQU   IOCSTR+17                                                03338000
IOCMAC   EQU   IOCSTR+18                                                03339000
IOCMAC2  EQU   IOCSTR+19                                                03340000
IOCCHP   EQU   IOCSTR+20                                                03341000
IOCMSG   EQU   IOCSTR+21                                                03342000
IOCRBA   EQU   IOCSTR+40                                                03343000
IOCTTR   EQU   IOCRBA                                                   03344000
IOCMEM   EQU   IOCSTR+44                                                03345000
IOCNWM   EQU   IOCSTR+48                                                03346000
OPNAGL   EQU   0                                                        03347000
OPNOPT   EQU   OPNAGL                                                   03348000
OPNRFM   EQU   OPNAGL+1                                                 03349000
OPNTYP   EQU   OPNAGL+2                                                 03350000
OPNMOD   EQU   OPNAGL+3                                                 03351000
OPNDEV   EQU   OPNAGL+24                                                03352000
OPNDSO   EQU   OPNAGL+41                                                03353000
OPNOPT2  EQU   OPNAGL+42                                                03354000
IOINFOPT EQU   0                                                        03355000
UVOLLIST EQU   0                                                        03356000
UVOLENT  EQU   UVOLLIST+2                                               03357000
AMSTP011 EQU   0                                                        03358000
DARGLIST EQU   0                                                        03359000
DARGDBP  EQU   DARGLIST                                                 03360000
DARGRETP EQU   DARGLIST+4                                               03361000
DARGSTID EQU   DARGLIST+8                                               03362000
DARGSMOD EQU   DARGSTID                                                 03363000
DARGSENT EQU   DARGSTID+3                                               03364000
DARGILP  EQU   DARGLIST+12                                              03365000
DARGCNT  EQU   DARGLIST+14                                              03366000
DARGRETL EQU   DARGLIST+16                                              03367000
DARGARY  EQU   DARGLIST+20                                              03368000
DARGINS  EQU   DARGARY                                                  03369000
DARGINL  EQU   DARGARY+2                                                03370000
DARGDTM  EQU   DARGARY+4                                                03371000
FMTLIST  EQU   0                                                        03372000
FMTFLGS  EQU   FMTLIST                                                  03373000
FMTSPF   EQU   FMTLIST+2                                                03374000
FMTRFNO  EQU   FMTSPF                                                   03375000
FMTILEN  EQU   FMTRFNO                                                  03376000
FMTIOFF  EQU   FMTLIST+4                                                03377000
FMTTRBC  EQU   FMTIOFF                                                  03378000
FMTSTO   EQU   FMTTRBC                                                  03379000
FMTOCOL  EQU   FMTLIST+6                                                03380000
FMTCNVF  EQU   FMTLIST+10                                               03381000
IDCDB010 EQU   0                                                        03382000
DMPITM   EQU   0                                                        03383000
DMPITMNM EQU   DMPITM                                                   03384000
DMPITMPT EQU   DMPITM+8                                                 03385000
DMPITMLN EQU   DMPITM+12                                                03386000
DMPITMTP EQU   DMPITM+14                                                03387000
DMPARY   EQU   0                                                        03388000
DMPTRM   EQU   0                                                        03389000
VOL      EQU   0                                                        03390000
VOLVAL   EQU   VOL+1                                                    03391000
CDATE    EQU   0                                                        03392000
DATE     EQU   0                                                        03393000
DATEVAL  EQU   DATE                                                     03394000
SEQ      EQU   0                                                        03395000
SEQVAL   EQU   SEQ                                                      03396000
CART     EQU   0                                                        03397000
CARTLEN  EQU   CART                                                     03398000
CARTVAL  EQU   CART+1                                                   03399000
REC      EQU   0                                                        03400000
NREC     EQU   0                                                        03401000
LOC      EQU   0                                                        03402000
LOCVAL   EQU   LOC+1                                                    03403000
CCMSG    EQU   0                                                        03404000
CMMSG    EQU   0                                                        03405000
CMVOLFLG EQU   CMMSG+6                                                  03406000
CMNUMCRT EQU   CMMSG+15                                                 03407000
CMCSN1   EQU   CMMSG+16                                                 03408000
CMCSN2   EQU   CMMSG+28                                                 03409000
CTMSG    EQU   0                                                        03410000
CTARRAY  EQU   CTMSG+4                                                  03411000
MDAGL    EQU   0                                                        03412000
MDFLAGS  EQU   MDAGL+30                                                 03413000
PUAGL    EQU   0                                                        03414000
CKAGL    EQU   0                                                        03415000
CKFLAGS  EQU   CKAGL+28                                                 03416000
EXOARG   EQU   0                                                        03417000
EXOPT    EQU   EXOARG+32                                                03418000
EXFLG    EQU   EXOARG+33                                                03419000
EXGARG   EQU   0                                                        03420000
EXPARG   EQU   0                                                        03421000
EXPDATA  EQU   EXPARG+12                                                03422000
EXPDATAB EQU   0                                                        03423000
EXPARRAY EQU   EXPDATAB+4                                               03424000
VS2AGL   EQU   0                                                        03425000
VSLABOPT EQU   VS2AGL+28                                                03426000
VS2MSG   EQU   VS2AGL+35                                                03427000
VS2RESOP EQU   VS2AGL+36                                                03428000
VS1AGL   EQU   0                                                        03429000
VSSECOPT EQU   VS1AGL+68                                                03430000
VSVTOPT  EQU   VS1AGL+69                                                03431000
VSCATOPT EQU   VS1AGL+70                                                03432000
VSRETURN EQU   VS1AGL+71                                                03433000
VSMSG    EQU   VS1AGL+72                                                03434000
VSRESOPT EQU   VS1AGL+73                                                03435000
RCTAGL   EQU   0                                                        03436000
RCTOPT   EQU   RCTAGL+8                                                 03437000
STAEPARM EQU   0                                                        03438000
STARCVY  EQU   STAEPARM+52                                              03439000
STARETRY EQU   STAEPARM+53                                              03440000
VOLLABEL EQU   0                                                        03441000
SV82LIST EQU   0                                                        03442000
@NM00056 EQU   SV82LIST+4                                               03443000
SV82DCBP EQU   @NM00056                                                 03444000
@NM00057 EQU   SV82LIST+12                                              03445000
SV82WRKP EQU   @NM00057                                                 03446000
BASEV    EQU   0                                                        03447000
BASNAME  EQU   BASEV                                                    03448000
BASID    EQU   BASNAME+11                                               03449000
BASFLAGA EQU   BASEV+14                                                 03450000
BASTYPE  EQU   BASFLAGA                                                 03451000
BASINAC  EQU   BASFLAGA+2                                               03452000
BASRCVYF EQU   BASEV+20                                                 03453000
BASSATIA EQU   BASRCVYF                                                 03454000
BASIVCRE EQU   BASSATIA                                                 03455000
BASIVCPY EQU   BASSATIA                                                 03456000
BASVSMIS EQU   BASSATIA                                                 03457000
BASMISCF EQU   BASRCVYF+2                                               03458000
BASCSN1  EQU   BASEV+24                                                 03459000
BASLIB1  EQU   BASEV+36                                                 03460000
BASLID1  EQU   BASLIB1                                                  03461000
BASLIB2  EQU   BASEV+49                                                 03462000
BASLID2  EQU   BASLIB2                                                  03463000
BASKLCPY EQU   BASEV+76                                                 03464000
BASCOPID EQU   BASKLCPY+11                                              03465000
BCDV     EQU   0                                                        03466000
BCDNAME  EQU   BCDV                                                     03467000
BCDPREFX EQU   BCDNAME                                                  03468000
BCDID    EQU   BCDNAME+11                                               03469000
BCDFLAGA EQU   BCDV+14                                                  03470000
BCDTYPE  EQU   BCDFLAGA                                                 03471000
BCDBASE  EQU   BCDTYPE                                                  03472000
BCDCOPY  EQU   BCDTYPE                                                  03473000
BCDDUP   EQU   BCDTYPE                                                  03474000
BCDFLAGB EQU   BCDFLAGA+2                                               03475000
BCDRCVYF EQU   BCDV+20                                                  03476000
BCDSATIA EQU   BCDRCVYF                                                 03477000
BCDIVCPY EQU   BCDSATIA                                                 03478000
BCDMISCF EQU   BCDRCVYF+2                                               03479000
BCDLIB1  EQU   BCDV+36                                                  03480000
BCDLID1  EQU   BCDLIB1                                                  03481000
BCDLIB2  EQU   BCDV+49                                                  03482000
BCDLID2  EQU   BCDLIB2                                                  03483000
RVVI     EQU   0                                                        03484000
RVVLNGTH EQU   RVVI                                                     03485000
RVVOPCOD EQU   RVVI+4                                                   03486000
RVVCODE  EQU   RVVOPCOD                                                 03487000
RVVOLUME EQU   RVVI+8                                                   03488000
RVVBUFLN EQU   RVVI+30                                                  03489000
RVVRTBUF EQU   RVVI+32                                                  03490000
RVVCDATE EQU   RVVI+38                                                  03491000
RVVRDSEQ EQU   RVVI+43                                                  03492000
RVVRDCSN EQU   RVVI+44                                                  03493000
RVVFLAGA EQU   RVVI+58                                                  03494000
RVVRMODE EQU   RVVFLAGA                                                 03495000
RVVRDR   EQU   RVVRMODE                                                 03496000
RVVCHAIN EQU   RVVFLAGA+1                                               03497000
RVVRDRCD EQU   RVVFLAGA+2                                               03498000
RVVBVRCD EQU   RVVRDRCD                                                 03499000
RVVCPYRC EQU   RVVRDRCD                                                 03500000
RVVDUPRC EQU   RVVRDRCD                                                 03501000
RVVRUNKN EQU   RVVRDRCD                                                 03502000
RVVRTEST EQU   RVVFLAGA+3                                               03503000
RVVCPYTP EQU   RVVFLAGA+4                                               03504000
RVVSPEC  EQU   RVVFLAGA+5                                               03505000
RVVSDTE  EQU   RVVSPEC                                                  03506000
RVVSSEQ  EQU   RVVSPEC                                                  03507000
RVVSCSN  EQU   RVVSPEC                                                  03508000
RVVSVOL  EQU   RVVSPEC                                                  03509000
MCRTE    EQU   0                                                        03510000
MCRLNGTH EQU   MCRTE                                                    03511000
MCRLOC   EQU   MCRTE+4                                                  03512000
MCRFLAGA EQU   MCRTE+34                                                 03513000
MCRSPLOC EQU   MCRFLAGA                                                 03514000
MCRFLAGB EQU   MCRTE+36                                                 03515000
MCRTYPE  EQU   MCRFLAGB+2                                               03516000
MCRREC   EQU   MCRTYPE                                                  03517000
MCLIST   EQU   0                                                        03518000
MCRTFLG  EQU   MCLIST+6                                                 03519000
MCRTTRAN EQU   MCRTFLG                                                  03520000
MCRTLIB  EQU   MCLIST+7                                                 03521000
MCRTCSN  EQU   MCLIST+24                                                03522000
MCRTVEXT EQU   MCLIST+44                                                03523000
AMSTP041 EQU   0                                                        03524000
AMSTP042 EQU   0                                                        03525000
AMSTP043 EQU   0                                                        03526000
AMSTP044 EQU   0                                                        03527000
IDCIOCL0 EQU   0                                                        03528000
IDCIOCO0 EQU   0                                                        03529000
IDCIOGT0 EQU   0                                                        03530000
IDCIOIT0 EQU   0                                                        03531000
IDCIOOP0 EQU   0                                                        03532000
IDCIOPO0 EQU   0                                                        03533000
IDCIOPT0 EQU   0                                                        03534000
IDCIOSI0 EQU   0                                                        03535000
IDCIOST0 EQU   0                                                        03536000
IDCIOTM0 EQU   0                                                        03537000
IDCIOVY0 EQU   0                                                        03538000
IDCIO050 EQU   0                                                        03539000
IDCSAAL0 EQU   0                                                        03540000
IDCSACA0 EQU   0                                                        03541000
IDCSACL0 EQU   0                                                        03542000
IDCSACR0 EQU   0                                                        03543000
IDCSADE0 EQU   0                                                        03544000
IDCSADL0 EQU   0                                                        03545000
IDCSAFP0 EQU   0                                                        03546000
IDCSAGP0 EQU   0                                                        03547000
IDCSAGS0 EQU   0                                                        03548000
IDCSAID0 EQU   0                                                        03549000
IDCSALD0 EQU   0                                                        03550000
IDCSALK0 EQU   0                                                        03551000
IDCSAPR0 EQU   0                                                        03552000
IDCSAPT0 EQU   0                                                        03553000
IDCSAQL0 EQU   0                                                        03554000
IDCSARC0 EQU   0                                                        03555000
IDCSARV0 EQU   0                                                        03556000
IDCSASC0 EQU   0                                                        03557000
IDCSASN0 EQU   0                                                        03558000
IDCSAST0 EQU   0                                                        03559000
IDCSATI0 EQU   0                                                        03560000
IDCSA060 EQU   0                                                        03561000
IDCST010 EQU   0                                                        03562000
LISTTEST EQU   0                                                        03563000
NEWERID1 EQU   5                                                        03564000
GDTTBL   EQU   0                                                        03565000
GDTTR1   EQU   GDTTBL+8                                                 03566000
GDTTR2   EQU   GDTTBL+12                                                03567000
GDTDBG   EQU   GDTTBL+40                                                03568000
GDTSTC   EQU   GDTTBL+44                                                03569000
GDTPRT   EQU   GDTTBL+48                                                03570000
GDTESS   EQU   GDTTBL+52                                                03571000
GDTESA   EQU   GDTTBL+56                                                03572000
GDTRST   EQU   GDTTBL+60                                                03573000
GDTRES   EQU   GDTTBL+64                                                03574000
GDTCAL   EQU   GDTTBL+68                                                03575000
GDTGSP   EQU   GDTTBL+72                                                03576000
GDTFSP   EQU   GDTTBL+76                                                03577000
GDTGPL   EQU   GDTTBL+80                                                03578000
GDTFPL   EQU   GDTTBL+84                                                03579000
GDTLOD   EQU   GDTTBL+88                                                03580000
GDTDEL   EQU   GDTTBL+92                                                03581000
GDTPRL   EQU   GDTTBL+96                                                03582000
GDTEPL   EQU   GDTTBL+100                                               03583000
GDTTIM   EQU   GDTTBL+104                                               03584000
GDTIIO   EQU   GDTTBL+108                                               03585000
GDTTIO   EQU   GDTTBL+112                                               03586000
GDTOPN   EQU   GDTTBL+124                                               03587000
GDTCLS   EQU   GDTTBL+128                                               03588000
GDTGET   EQU   GDTTBL+132                                               03589000
GDTPUT   EQU   GDTTBL+136                                               03590000
GDTPOS   EQU   GDTTBL+140                                               03591000
GDTCPY   EQU   GDTTBL+144                                               03592000
GDTCAT   EQU   GDTTBL+148                                               03593000
GDTSNP   EQU   GDTTBL+164                                               03594000
GDTVFY   EQU   GDTTBL+172                                               03595000
GDTUID   EQU   GDTTBL+192                                               03596000
GDTPMT   EQU   GDTTBL+196                                               03597000
GDTCIR   EQU   GDTTBL+200                                               03598000
GDTLNK   EQU   GDTTBL+204                                               03599000
GDTALC   EQU   GDTTBL+208                                               03600000
GDTDLC   EQU   GDTTBL+212                                               03601000
GDTQAL   EQU   GDTTBL+216                                               03602000
GDTSTW   EQU   GDTTBL+220                                               03603000
GDTSSC   EQU   GDTTBL+224                                               03604000
GDTENQ   EQU   GDTTBL+228                                               03605000
GDTRSV   EQU   GDTTBL+232                                               03606000
GDTDEQ   EQU   GDTTBL+236                                               03607000
GDTSFO   EQU   GDTTBL+240                                               03608000
GDTWTO   EQU   GDTTBL+244                                               03609000
GDTSCR   EQU   GDTTBL+248                                               03610000
GDTUNT   EQU   GDTTBL+252                                               03611000
GDTRCT   EQU   GDTTBL+256                                               03612000
GDTIFO   EQU   GDTTBL+260                                               03613000
GDTEXP   EQU   GDTTBL+264                                               03614000
GDTSTA   EQU   GDTTBL+268                                               03615000
FDTTBL   EQU   0                                                        03616000
FDTPTR   EQU   FDTTBL+8                                                 03617000
LASTCOND EQU   0                                                        03618000
CKCSNVAL EQU   0                                                        03619000
CKLENGTH EQU   0                                                        03620000
VECSN1   EQU   0                                                        03621000
VEVOLUME EQU   0                                                        03622000
VEVVIERR EQU   0                                                        03623000
VERECFLG EQU   0                                                        03624000
VEVOLLOC EQU   0                                                        03625000
SSRCODE  EQU   0                                                        03626000
SSRHALF  EQU   SSRCODE+2                                                03627000
SSECBCD  EQU   0                                                        03628000
*                                      START UNREFERENCED COMPONENTS    03629000
@NM00091 EQU   SSRCODE                                                  03630000
FDTVERB  EQU   FDTTBL                                                   03631000
GDTECT   EQU   GDTTBL+188                                               03632000
GDTPSB   EQU   GDTTBL+184                                               03633000
GDTUPT   EQU   GDTTBL+180                                               03634000
GDTCMB   EQU   GDTTBL+176                                               03635000
GDTSPR   EQU   GDTTBL+168                                               03636000
@NM00001 EQU   GDTTBL+160                                               03637000
GDTABH   EQU   GDTTBL+156                                               03638000
GDTABT   EQU   GDTTBL+152                                               03639000
GDTTOH   EQU   GDTTBL+120                                               03640000
GDTRIP   EQU   GDTTBL+116                                               03641000
GDTIOH   EQU   GDTTBL+36                                                03642000
GDTSAH   EQU   GDTTBL+32                                                03643000
GDTTPH   EQU   GDTTBL+28                                                03644000
GDTRIH   EQU   GDTTBL+24                                                03645000
GDTSTH   EQU   GDTTBL+20                                                03646000
GDTDBH   EQU   GDTTBL+16                                                03647000
GDTPRM   EQU   GDTTBL+4                                                 03648000
GDTHDR   EQU   GDTTBL                                                   03649000
MCRTECB  EQU   MCLIST+40                                                03650000
MCRTASID EQU   MCLIST+38                                                03651000
MCRTRES4 EQU   MCLIST+36                                                03652000
MCRTRES3 EQU   MCLIST+16                                                03653000
MCRTRES2 EQU   MCLIST+8                                                 03654000
MCRTLD   EQU   MCRTLIB                                                  03655000
@NM00087 EQU   MCRTLIB                                                  03656000
@NM00086 EQU   MCRTFLG                                                  03657000
MCRTSCT  EQU   MCRTFLG                                                  03658000
@NM00085 EQU   MCRTFLG                                                  03659000
MCRTRES1 EQU   MCLIST+5                                                 03660000
MCRTOPCD EQU   MCLIST+4                                                 03661000
MCRTLEN  EQU   MCLIST                                                   03662000
@NM00084 EQU   MCRTE+40                                                 03663000
@NM00083 EQU   MCRFLAGB+3                                               03664000
@NM00082 EQU   MCRTYPE                                                  03665000
@NM00081 EQU   MCRFLAGB+1                                               03666000
@NM00080 EQU   MCRFLAGB                                                 03667000
MCRBLNK1 EQU   MCRTE+35                                                 03668000
@NM00079 EQU   MCRFLAGA                                                 03669000
@NM00068 EQU   RVVI+64                                                  03670000
RVVSDUP  EQU   RVVSPEC                                                  03671000
RVVSCPY  EQU   RVVSPEC                                                  03672000
RVVSEXP  EQU   RVVSPEC                                                  03673000
RVVSGRP  EQU   RVVSPEC                                                  03674000
@NM00067 EQU   RVVCPYTP                                                 03675000
RVVLCOPY EQU   RVVCPYTP                                                 03676000
RVVOBKUP EQU   RVVCPYTP                                                 03677000
RVVLBKUP EQU   RVVCPYTP                                                 03678000
@NM00066 EQU   RVVRTEST                                                 03679000
RVVDVOL  EQU   RVVRTEST                                                 03680000
RVVACTV  EQU   RVVRTEST                                                 03681000
RVVINACT EQU   RVVRTEST                                                 03682000
RVVRSTD  EQU   RVVRTEST                                                 03683000
RVVGSVOL EQU   RVVRTEST                                                 03684000
RVVTHOLD EQU   RVVRTEST                                                 03685000
RVVEXPDT EQU   RVVRTEST                                                 03686000
@NM00065 EQU   RVVRDRCD                                                 03687000
RVVGRPRC EQU   RVVRDRCD                                                 03688000
@NM00064 EQU   RVVCHAIN                                                 03689000
RVVNGVOL EQU   RVVCHAIN                                                 03690000
RVVGPVOL EQU   RVVCHAIN                                                 03691000
@NM00063 EQU   RVVRMODE                                                 03692000
RVVRDCH  EQU   RVVRMODE                                                 03693000
RVVRDNR  EQU   RVVRMODE                                                 03694000
RVVDUPID EQU   RVVI+57                                                  03695000
RVVCPYID EQU   RVVI+56                                                  03696000
RVVBLNK1 EQU   RVVI+42                                                  03697000
RVVEXPIR EQU   RVVI+36                                                  03698000
@NM00062 EQU   RVVI+28                                                  03699000
RVVAREA  EQU   RVVI+24                                                  03700000
RVVARLN  EQU   RVVI+22                                                  03701000
RVVGROUP EQU   RVVI+14                                                  03702000
@NM00061 EQU   RVVOPCOD+1                                               03703000
BCD2BIT2 EQU   BCDLID2                                                  03704000
BCD2BIT1 EQU   BCDLID2                                                  03705000
BCDRES8  EQU   BCDLIB2                                                  03706000
BCDCSN2  EQU   BCDV+37                                                  03707000
BCD1BIT2 EQU   BCDLID1                                                  03708000
BCD1BIT1 EQU   BCDLID1                                                  03709000
BCDRE10  EQU   BCDLIB1                                                  03710000
BCDCSN1  EQU   BCDV+24                                                  03711000
BCDRES7A EQU   BCDMISCF                                                 03712000
BCDHOLD  EQU   BCDMISCF                                                 03713000
BCDRES7  EQU   BCDSATIA                                                 03714000
BCDVSMIS EQU   BCDSATIA                                                 03715000
BCDIVCRE EQU   BCDSATIA                                                 03716000
BCDCPUID EQU   BCDV+18                                                  03717000
BCDRES5  EQU   BCDFLAGB+1                                               03718000
BCDREASS EQU   BCDFLAGB+1                                               03719000
BCDRES4  EQU   BCDFLAGB                                                 03720000
BCDRES3  EQU   BCDTYPE                                                  03721000
BCDRES2  EQU   BCDTYPE                                                  03722000
BCDRES1  EQU   BCDTYPE                                                  03723000
BCDRES9  EQU   BCDV+13                                                  03724000
BCDINDEX EQU   BCDID+1                                                  03725000
BCDBLNK2 EQU   BCDID                                                    03726000
BCDSERNO EQU   BCDNAME+5                                                03727000
BCDBLNK1 EQU   BCDPREFX+1                                               03728000
BCDALPHA EQU   BCDPREFX                                                 03729000
@NM00060 EQU   BASEV+188                                                03730000
BASGROUP EQU   BASEV+180                                                03731000
BASRECOV EQU   BASEV+174                                                03732000
BASDEST  EQU   BASEV+144                                                03733000
BASOWNER EQU   BASEV+134                                                03734000
BASDESCR EQU   BASEV+104                                                03735000
BASDTREM EQU   BASEV+100                                                03736000
BASEXPDT EQU   BASEV+96                                                 03737000
BASDLMTD EQU   BASEV+92                                                 03738000
BASRES6  EQU   BASEV+89                                                 03739000
BASCOPNO EQU   BASCOPID+1                                               03740000
BASCOPBK EQU   BASCOPID                                                 03741000
BASCOPSN EQU   BASKLCPY+5                                               03742000
BASCOPV  EQU   BASKLCPY                                                 03743000
BASFREXT EQU   BASEV+72                                                 03744000
BASLEXT  EQU   BASEV+70                                                 03745000
BASFRESP EQU   BASEV+68                                                 03746000
@NM00059 EQU   BASEV+65                                                 03747000
BASBKLMT EQU   BASEV+64                                                 03748000
BASNBKUP EQU   BASEV+63                                                 03749000
BASNCOPY EQU   BASEV+62                                                 03750000
BASNEXTV EQU   BASEV+56                                                 03751000
BASPREV  EQU   BASEV+50                                                 03752000
BAS2BIT2 EQU   BASLID2                                                  03753000
BAS2BIT1 EQU   BASLID2                                                  03754000
BASRES5  EQU   BASLIB2                                                  03755000
BASCSN2  EQU   BASEV+37                                                 03756000
BAS1BIT2 EQU   BASLID1                                                  03757000
BAS1BIT1 EQU   BASLID1                                                  03758000
BASRES4  EQU   BASLIB1                                                  03759000
BASRES3  EQU   BASMISCF                                                 03760000
BASHOLD  EQU   BASMISCF                                                 03761000
BASRES8  EQU   BASSATIA                                                 03762000
BASCPUID EQU   BASEV+18                                                 03763000
@NM00058 EQU   BASFLAGA+3                                               03764000
BASLAST  EQU   BASFLAGA+3                                               03765000
BASFIRST EQU   BASFLAGA+3                                               03766000
BASREASS EQU   BASFLAGA+3                                               03767000
BASRONLY EQU   BASFLAGA+3                                               03768000
BASDAERA EQU   BASFLAGA+3                                               03769000
BASEXCL  EQU   BASFLAGA+2                                               03770000
BASBIND  EQU   BASFLAGA+2                                               03771000
BASRSTD  EQU   BASFLAGA+2                                               03772000
BASGENUS EQU   BASFLAGA+2                                               03773000
BASGRPV  EQU   BASFLAGA+2                                               03774000
BASNOCPY EQU   BASFLAGA+2                                               03775000
BASDLSF  EQU   BASFLAGA+2                                               03776000
BASRES2  EQU   BASTYPE                                                  03777000
BASBASVR EQU   BASTYPE                                                  03778000
BASRES1  EQU   BASTYPE                                                  03779000
BASRES7  EQU   BASEV+13                                                 03780000
BASZERO  EQU   BASID+1                                                  03781000
BASBLANK EQU   BASID                                                    03782000
BASSERNO EQU   BASNAME+5                                                03783000
BASEVKEY EQU   BASNAME                                                  03784000
SV82DEBP EQU   SV82WRKP                                                 03785000
SV82TTRP EQU   SV82LIST+8                                               03786000
SV82VOLP EQU   SV82DCBP                                                 03787000
SV82UCBP EQU   SV82LIST+1                                               03788000
SV82CODE EQU   SV82LIST                                                 03789000
VOLRESV3 EQU   VOLLABEL+55                                              03790000
VOLOWNER EQU   VOLLABEL+45                                              03791000
VOLRESV1 EQU   VOLLABEL+20                                              03792000
VOLVTOC  EQU   VOLLABEL+15                                              03793000
VOLSECTY EQU   VOLLABEL+14                                              03794000
VOLSERNO EQU   VOLLABEL+8                                               03795000
VOLNO    EQU   VOLLABEL+7                                               03796000
VOLLABI  EQU   VOLLABEL+4                                               03797000
VOLKEY   EQU   VOLLABEL                                                 03798000
@NM00055 EQU   STARETRY                                                 03799000
STAOFF   EQU   STARETRY                                                 03800000
STAIO05  EQU   STARETRY                                                 03801000
@NM00054 EQU   STARCVY                                                  03802000
STACLEAR EQU   STARCVY                                                  03803000
STAVPOST EQU   STARCVY                                                  03804000
STAVENQ  EQU   STARCVY                                                  03805000
STAVDMNT EQU   STARCVY                                                  03806000
STAVMNT  EQU   STARCVY                                                  03807000
STATCB   EQU   STAEPARM+48                                              03808000
STARTADD EQU   STAEPARM+44                                              03809000
STAEXSAV EQU   STAEPARM+40                                              03810000
STARTSAV EQU   STAEPARM+36                                              03811000
STARTTR  EQU   STAEPARM+32                                              03812000
@NM00053 EQU   STAEPARM+30                                              03813000
STARVOL  EQU   STAEPARM+24                                              03814000
STARUCB  EQU   STAEPARM+20                                              03815000
@NM00052 EQU   STAEPARM+18                                              03816000
STAVVOL  EQU   STAEPARM+12                                              03817000
STAVUCB  EQU   STAEPARM+8                                               03818000
STAHEAD  EQU   STAEPARM                                                 03819000
RCTDSET  EQU   RCTAGL+32                                                03820000
RCTNVOL  EQU   RCTAGL+26                                                03821000
RCTOVOL  EQU   RCTAGL+20                                                03822000
RCTNDEV  EQU   RCTAGL+16                                                03823000
RCTODEV  EQU   RCTAGL+12                                                03824000
@NM00051 EQU   RCTAGL+10                                                03825000
@NM00050 EQU   RCTOPT                                                   03826000
RCTVOL   EQU   RCTOPT                                                   03827000
RCTDEV   EQU   RCTOPT                                                   03828000
RCTHEAD  EQU   RCTAGL                                                   03829000
@NM00049 EQU   VSRESOPT                                                 03830000
VSREAL   EQU   VSRESOPT                                                 03831000
VSRES    EQU   VSRESOPT                                                 03832000
@NM00048 EQU   VSMSG                                                    03833000
VSTOV    EQU   VSMSG                                                    03834000
VSFROMV  EQU   VSMSG                                                    03835000
@NM00047 EQU   VSRETURN                                                 03836000
VSUCAT   EQU   VSRETURN                                                 03837000
VSVSAM   EQU   VSRETURN                                                 03838000
@NM00046 EQU   VSCATOPT                                                 03839000
VSLIST   EQU   VSCATOPT                                                 03840000
VSSERIAL EQU   VSCATOPT                                                 03841000
VSDEVICE EQU   VSCATOPT                                                 03842000
@NM00045 EQU   VSVTOPT                                                  03843000
VSVSFLAG EQU   VSVTOPT                                                  03844000
VSALTTRK EQU   VSVTOPT                                                  03845000
VSTIME   EQU   VSVTOPT                                                  03846000
@NM00044 EQU   VSSECOPT                                                 03847000
VSOPCAT  EQU   VSSECOPT                                                 03848000
VSUCTEST EQU   VSSECOPT                                                 03849000
VSWRITE  EQU   VSSECOPT                                                 03850000
VSREAD   EQU   VSSECOPT                                                 03851000
VSNONONV EQU   VSSECOPT                                                 03852000
VSMASTER EQU   VSSECOPT                                                 03853000
VSNOVSAM EQU   VSSECOPT                                                 03854000
VSODEVP  EQU   VS1AGL+64                                                03855000
VSOSERP  EQU   VS1AGL+60                                                03856000
VSDEVP   EQU   VS1AGL+56                                                03857000
VSSERP   EQU   VS1AGL+52                                                03858000
VSPFILEP EQU   VS1AGL+48                                                03859000
VSPSWDP  EQU   VS1AGL+44                                                03860000
VSCATDDP EQU   VS1AGL+40                                                03861000
VSACBP   EQU   VS1AGL+36                                                03862000
VSCATP   EQU   VS1AGL+32                                                03863000
VSNXTATP EQU   VS1AGL+28                                                03864000
VSNUMATP EQU   VS1AGL+24                                                03865000
VSIOP    EQU   VS1AGL+20                                                03866000
VSFILEP  EQU   VS1AGL+16                                                03867000
VSVOLP   EQU   VS1AGL+12                                                03868000
VSUCBP   EQU   VS1AGL+8                                                 03869000
VSHEAD   EQU   VS1AGL                                                   03870000
VSDDNAME EQU   VS2AGL+37                                                03871000
@NM00043 EQU   VS2RESOP                                                 03872000
VS2REAL  EQU   VS2RESOP                                                 03873000
VS2RES   EQU   VS2RESOP                                                 03874000
@NM00042 EQU   VS2MSG                                                   03875000
VS2TOV   EQU   VS2MSG                                                   03876000
VSVOLUME EQU   VS2AGL+29                                                03877000
@NM00041 EQU   VSLABOPT                                                 03878000
VSVOLSER EQU   VSLABOPT                                                 03879000
VSOWNER  EQU   VSLABOPT                                                 03880000
VSIOBKPT EQU   VS2AGL+24                                                03881000
VSVOLPTR EQU   VS2AGL+20                                                03882000
VSOWNPTR EQU   VS2AGL+16                                                03883000
VSVTOCSZ EQU   VS2AGL+12                                                03884000
VSUCBPTR EQU   VS2AGL+8                                                 03885000
VS2HEAD  EQU   VS2AGL                                                   03886000
EXPDATAL EQU   EXPARRAY+6                                               03887000
@NM00040 EQU   EXPARRAY+5                                               03888000
EXPKEYLN EQU   EXPARRAY+4                                               03889000
EXPDATAP EQU   EXPARRAY                                                 03890000
EXPRECNO EQU   EXPDATAB                                                 03891000
EXPCCHHR EQU   EXPARG+16                                                03892000
EXPCTLBK EQU   EXPARG+8                                                 03893000
EXPHEAD  EQU   EXPARG                                                   03894000
EXGDATAL EQU   EXGARG+30                                                03895000
@NM00039 EQU   EXGARG+29                                                03896000
EXGKEYLN EQU   EXGARG+28                                                03897000
EXGDATAP EQU   EXGARG+24                                                03898000
EXGRECNO EQU   EXGARG+20                                                03899000
EXGCCHH2 EQU   EXGARG+16                                                03900000
EXGCCHH1 EQU   EXGARG+12                                                03901000
EXGCTLBK EQU   EXGARG+8                                                 03902000
EXGHEAD  EQU   EXGARG                                                   03903000
@NM00038 EQU   EXFLG                                                    03904000
EXOREAD  EQU   EXFLG                                                    03905000
@NM00037 EQU   EXOPT                                                    03906000
EXONEW   EQU   EXOPT                                                    03907000
EXOPASS  EQU   EXOPT                                                    03908000
EXOLAB   EQU   EXOPT                                                    03909000
EXOTAB   EQU   EXOPT                                                    03910000
EXOCTLBK EQU   EXOARG+28                                                03911000
EXOEXT   EQU   EXOARG+24                                                03912000
EXOUCB   EQU   EXOARG+20                                                03913000
EXOVSN   EQU   EXOARG+16                                                03914000
EXODSN   EQU   EXOARG+12                                                03915000
EXODDN   EQU   EXOARG+8                                                 03916000
EXOHEAD  EQU   EXOARG                                                   03917000
@NM00036 EQU   CKFLAGS                                                  03918000
CKEXCL   EQU   CKFLAGS                                                  03919000
CKDYALOC EQU   CKFLAGS                                                  03920000
CKRETTYP EQU   CKFLAGS                                                  03921000
CKTESTVT EQU   CKFLAGS                                                  03922000
CKLABELP EQU   CKAGL+24                                                 03923000
CKDATYPE EQU   CKAGL+20                                                 03924000
CKDDNAME EQU   CKAGL+12                                                 03925000
CKUCBPTR EQU   CKAGL+8                                                  03926000
CKHEAD   EQU   CKAGL                                                    03927000
PULABELP EQU   PUAGL+16                                                 03928000
PUTTRPTR EQU   PUAGL+12                                                 03929000
PUUCBPTR EQU   PUAGL+8                                                  03930000
PUHEAD   EQU   PUAGL                                                    03931000
@NM00035 EQU   MDFLAGS                                                  03932000
MDENQ    EQU   MDFLAGS                                                  03933000
MDWAIT   EQU   MDFLAGS                                                  03934000
MDPOST   EQU   MDFLAGS                                                  03935000
MDCLEAR  EQU   MDFLAGS                                                  03936000
MDNEWVOL EQU   MDFLAGS                                                  03937000
MDLABEL  EQU   MDAGL+24                                                 03938000
MDPUAGL  EQU   MDAGL+20                                                 03939000
MDDDNAME EQU   MDAGL+12                                                 03940000
MDUCBPTR EQU   MDAGL+8                                                  03941000
MDHEAD   EQU   MDAGL                                                    03942000
CTTBLRR  EQU   CTARRAY+3                                                03943000
CTTBLHH  EQU   CTARRAY+2                                                03944000
CTTBLCC  EQU   CTARRAY+1                                                03945000
CTTBLID  EQU   CTARRAY                                                  03946000
CTREALH  EQU   CTMSG+3                                                  03947000
CTREALCC EQU   CTMSG+1                                                  03948000
@NM00034 EQU   CTMSG                                                    03949000
@NM00033 EQU   CMMSG+14                                                 03950000
CMNEWVOL EQU   CMMSG+8                                                  03951000
@NM00032 EQU   CMMSG+7                                                  03952000
@NM00031 EQU   CMVOLFLG                                                 03953000
CMRONLY  EQU   CMVOLFLG                                                 03954000
CMBIND   EQU   CMVOLFLG                                                 03955000
CMSCRCRT EQU   CMVOLFLG                                                 03956000
CMEXCL   EQU   CMVOLFLG                                                 03957000
CMDERAS  EQU   CMVOLFLG                                                 03958000
CMSCRVOL EQU   CMVOLFLG                                                 03959000
CMCECART EQU   CMVOLFLG                                                 03960000
CMOLDVOL EQU   CMMSG                                                    03961000
CCOLDCSN EQU   CCMSG+24                                                 03962000
CCNEWCSN EQU   CCMSG+12                                                 03963000
@NM00030 EQU   CCMSG+6                                                  03964000
CCVOL    EQU   CCMSG                                                    03965000
LOCLEN   EQU   LOC                                                      03966000
VOLLEN   EQU   VOL                                                      03967000
@NM00029 EQU   DMPARY+15                                                03968000
DMPARYTP EQU   DMPARY+14                                                03969000
DMPARYEX EQU   DMPARY+12                                                03970000
DMPARYIC EQU   DMPARY+10                                                03971000
DMPARYSZ EQU   DMPARY+8                                                 03972000
DMPARYNM EQU   DMPARY                                                   03973000
@NM00028 EQU   DMPITM+15                                                03974000
@NM00027 EQU   FMTCNVF+1                                                03975000
FMTBS    EQU   FMTCNVF+1                                                03976000
FMTSS    EQU   FMTCNVF+1                                                03977000
FMTAL    EQU   FMTCNVF+1                                                03978000
FMTZS    EQU   FMTCNVF+1                                                03979000
@NM00026 EQU   FMTCNVF                                                  03980000
FMTPU    EQU   FMTCNVF                                                  03981000
FMTBD    EQU   FMTCNVF                                                  03982000
FMTBHD   EQU   FMTCNVF                                                  03983000
FMTBHA   EQU   FMTCNVF                                                  03984000
FMTBH    EQU   FMTCNVF                                                  03985000
FMTOLEN  EQU   FMTLIST+8                                                03986000
FMTRIO   EQU   FMTOCOL                                                  03987000
FMTSPT   EQU   FMTSTO                                                   03988000
FMTSTL   EQU   FMTILEN                                                  03989000
@NM00025 EQU   FMTFLGS+1                                                03990000
FMTHDF   EQU   FMTFLGS                                                  03991000
FMTDFF   EQU   FMTFLGS                                                  03992000
FMTSTF   EQU   FMTFLGS                                                  03993000
FMTREPF  EQU   FMTFLGS                                                  03994000
FMTBDF   EQU   FMTFLGS                                                  03995000
FMTIDF   EQU   FMTFLGS                                                  03996000
FMTSCF   EQU   FMTFLGS                                                  03997000
FMTEOLF  EQU   FMTFLGS                                                  03998000
DARGPCT  EQU   DARGINL                                                  03999000
DARGREP  EQU   DARGINS                                                  04000000
@NM00024 EQU   DARGLIST+19                                              04001000
DARGIND  EQU   DARGLIST+18                                              04002000
UVOLVOL  EQU   UVOLENT+4                                                04003000
UVOLDEV  EQU   UVOLENT                                                  04004000
UVOLCNT  EQU   UVOLLIST                                                 04005000
@NM00023 EQU   IOINFOPT                                                 04006000
IOINFTMS EQU   IOINFOPT                                                 04007000
IOINFSUP EQU   IOINFOPT                                                 04008000
IOINFDSN EQU   IOINFOPT                                                 04009000
IOINFVOL EQU   IOINFOPT                                                 04010000
IOINFDVT EQU   IOINFOPT                                                 04011000
OPNVOL   EQU   OPNAGL+44                                                04012000
@NM00022 EQU   OPNAGL+43                                                04013000
@NM00021 EQU   OPNOPT2                                                  04014000
OPNOPTJM EQU   OPNOPT2                                                  04015000
OPNOPTNF EQU   OPNOPT2                                                  04016000
OPNOPTAS EQU   OPNOPT2                                                  04017000
@NM00020 EQU   OPNDSO                                                   04018000
OPNDSOPO EQU   OPNDSO                                                   04019000
OPNDSOIS EQU   OPNDSO                                                   04020000
OPNDSOPS EQU   OPNDSO                                                   04021000
OPNDSOAM EQU   OPNDSO                                                   04022000
OPNKYL   EQU   OPNAGL+40                                                04023000
OPNBLK   EQU   OPNAGL+36                                                04024000
OPNREC   EQU   OPNAGL+32                                                04025000
OPNDEVIX EQU   OPNDEV+4                                                 04026000
OPNDEVDT EQU   OPNDEV                                                   04027000
OPNCBP   EQU   OPNAGL+20                                                04028000
OPNDSN   EQU   OPNAGL+16                                                04029000
OPNPWA   EQU   OPNAGL+12                                                04030000
OPNDDN   EQU   OPNAGL+8                                                 04031000
OPNIOC   EQU   OPNAGL+4                                                 04032000
OPNMODRP EQU   OPNMOD                                                   04033000
OPNMODUB EQU   OPNMOD                                                   04034000
OPNMODRS EQU   OPNMOD                                                   04035000
OPNMODAX EQU   OPNMOD                                                   04036000
OPNMODRR EQU   OPNMOD                                                   04037000
OPNMODRC EQU   OPNMOD                                                   04038000
OPNMODAC EQU   OPNMOD                                                   04039000
OPNMODPD EQU   OPNMOD                                                   04040000
@NM00019 EQU   OPNTYP                                                   04041000
OPNTYPRV EQU   OPNTYP                                                   04042000
OPNTYPEX EQU   OPNTYP                                                   04043000
OPNTYPRA EQU   OPNTYP                                                   04044000
OPNTYPXM EQU   OPNTYP                                                   04045000
OPNTYPCI EQU   OPNTYP                                                   04046000
OPNTYPSO EQU   OPNTYP                                                   04047000
OPNTYPSI EQU   OPNTYP                                                   04048000
@NM00018 EQU   OPNRFM                                                   04049000
OPNRFMBK EQU   OPNRFM                                                   04050000
OPNRFMSF EQU   OPNRFM                                                   04051000
OPNRFMUN EQU   OPNRFM                                                   04052000
OPNRFMVR EQU   OPNRFM                                                   04053000
OPNRFMFX EQU   OPNRFM                                                   04054000
OPNOPTSK EQU   OPNOPT                                                   04055000
OPNOPTDR EQU   OPNOPT                                                   04056000
OPNOPTCR EQU   OPNOPT                                                   04057000
OPNOPTKS EQU   OPNOPT                                                   04058000
OPNOPTBK EQU   OPNOPT                                                   04059000
OPNOPTUP EQU   OPNOPT                                                   04060000
OPNOPTOT EQU   OPNOPT                                                   04061000
OPNOPTIN EQU   OPNOPT                                                   04062000
IOCEXT   EQU   IOCSTR+64                                                04063000
IOCREL   EQU   IOCSTR+60                                                04064000
IOCWORK  EQU   IOCSTR+56                                                04065000
IOCRRN   EQU   IOCSTR+52                                                04066000
IOCPNM   EQU   IOCNWM+2                                                 04067000
IOCPTL   EQU   IOCNWM                                                   04068000
IOCKYA   EQU   IOCMEM                                                   04069000
IOCVRC   EQU   IOCTTR                                                   04070000
IOCCBP   EQU   IOCSTR+36                                                04071000
IOCDSN   EQU   IOCSTR+32                                                04072000
IOCHURBA EQU   IOCSTR+28                                                04073000
IOCVOLSR EQU   IOCSTR+22                                                04074000
@NM00017 EQU   IOCMSG                                                   04075000
IOCMSGAE EQU   IOCMSG                                                   04076000
IOCMSGCE EQU   IOCMSG                                                   04077000
IOCMSGOE EQU   IOCMSG                                                   04078000
IOCMSGOP EQU   IOCMSG                                                   04079000
@NM00016 EQU   IOCMSG                                                   04080000
IOCCHPSY EQU   IOCCHP                                                   04081000
IOCCHPAS EQU   IOCCHP                                                   04082000
IOCCHPBK EQU   IOCCHP                                                   04083000
IOCCHPCR EQU   IOCCHP                                                   04084000
IOCCHPKS EQU   IOCCHP                                                   04085000
IOCCHPSK EQU   IOCCHP                                                   04086000
IOCCHPDR EQU   IOCCHP                                                   04087000
IOCCHPSQ EQU   IOCCHP                                                   04088000
@NM00015 EQU   IOCMAC2                                                  04089000
IOCMACPA EQU   IOCMAC2                                                  04090000
IOCMACNF EQU   IOCMAC2                                                  04091000
IOCMACCP EQU   IOCMAC2                                                  04092000
IOCMACRR EQU   IOCMAC2                                                  04093000
IOCMACAS EQU   IOCMAC2                                                  04094000
IOCMACSK EQU   IOCMAC2                                                  04095000
@NM00014 EQU   IOCMAC                                                   04096000
IOCMACCC EQU   IOCMAC                                                   04097000
IOCMACDR EQU   IOCMAC                                                   04098000
IOCMACBK EQU   IOCMAC                                                   04099000
IOCMACCR EQU   IOCMAC                                                   04100000
IOCMACUP EQU   IOCMAC                                                   04101000
IOCMACOT EQU   IOCMAC                                                   04102000
IOCMACIN EQU   IOCMAC                                                   04103000
@NM00013 EQU   IOCRFM                                                   04104000
IOCRFMBK EQU   IOCRFM                                                   04105000
IOCRFMSF EQU   IOCRFM                                                   04106000
IOCRFMUN EQU   IOCRFM                                                   04107000
IOCRFMVR EQU   IOCRFM                                                   04108000
IOCRFMFX EQU   IOCRFM                                                   04109000
@NM00012 EQU   IOCDSO                                                   04110000
IOCDSOPO EQU   IOCDSO                                                   04111000
IOCDSOIS EQU   IOCDSO                                                   04112000
IOCDSOPS EQU   IOCDSO                                                   04113000
IOCDSOAM EQU   IOCDSO                                                   04114000
IOCRKP   EQU   IOCSTR+13                                                04115000
IOCKYL   EQU   IOCSTR+12                                                04116000
IOCTRN   EQU   IOCSTR+8                                                 04117000
IOCDLN   EQU   IOCSTR+4                                                 04118000
IOCDAD   EQU   IOCSTR                                                   04119000
UNITVTOC EQU   UNITABL+7                                                04120000
@NM00011 EQU   UNITSTAT                                                 04121000
UNITXSHR EQU   UNITSTAT                                                 04122000
UNITISHR EQU   UNITSTAT                                                 04123000
UNITUA   EQU   @NM00010+1                                               04124000
UNITCHA  EQU   @NM00010                                                 04125000
UNITUCB  EQU   UNITABL                                                  04126000
ALLUNCNT EQU   ALLAGL+30                                                04127000
ALLVLCNT EQU   ALLAGL+29                                                04128000
@NM00009 EQU   ALLOPT                                                   04129000
ALLOPTPV EQU   ALLOPT                                                   04130000
ALLOPTDS EQU   ALLOPT                                                   04131000
ALLOPTVL EQU   ALLOPT                                                   04132000
@NM00008 EQU   ALLORG+1                                                 04133000
ALLORGVS EQU   ALLORG+1                                                 04134000
@NM00007 EQU   ALLORG+1                                                 04135000
ALLORGGS EQU   ALLORG+1                                                 04136000
ALLORGUN EQU   ALLORG                                                   04137000
ALLORGPO EQU   ALLORG                                                   04138000
ALLORGMQ EQU   ALLORG                                                   04139000
ALLORGCQ EQU   ALLORG                                                   04140000
ALLORGCX EQU   ALLORG                                                   04141000
ALLORGDA EQU   ALLORG                                                   04142000
ALLORGPS EQU   ALLORG                                                   04143000
ALLORGIS EQU   ALLORG                                                   04144000
ALLDSPUN EQU   ALLDSP                                                   04145000
ALLDSPCG EQU   ALLDSP                                                   04146000
ALLDSPDE EQU   ALLDSP                                                   04147000
ALLDSPKP EQU   ALLDSP                                                   04148000
@NM00006 EQU   ALLDSP                                                   04149000
ALLSTSOD EQU   ALLSTS                                                   04150000
ALLSTSMD EQU   ALLSTS                                                   04151000
ALLSTSNW EQU   ALLSTS                                                   04152000
ALLSTSSR EQU   ALLSTS                                                   04153000
@NM00005 EQU   ALLSTS                                                   04154000
ALLPWD   EQU   ALLAGL+20                                                04155000
ALLVLP   EQU   ALLAGL+16                                                04156000
ALLULP   EQU   ALLAGL+12                                                04157000
ALLDDN   EQU   ALLAGL+4                                                 04158000
ALLDSN   EQU   ALLAGL                                                   04159000
CIRPID   EQU   CIRAGL+28                                                04160000
CIRPWD   EQU   CIRAGL+24                                                04161000
CIRCAT   EQU   CIRAGL+20                                                04162000
CIRWKP   EQU   CIRAGL+16                                                04163000
CIRTLR   EQU   CIRAGL+12                                                04164000
CIRHDR   EQU   CIRAGL+8                                                 04165000
CIRTLN   EQU   CIRAGL+6                                                 04166000
CIRHLN   EQU   CIRAGL+4                                                 04167000
@NM00004 EQU   CIRAGL+1                                                 04168000
@NM00003 EQU   CIRTYPE                                                  04169000
CIRTYPAQ EQU   CIRTYPE                                                  04170000
CIRTYP1Q EQU   CIRTYPE                                                  04171000
NEWID1   EQU   TRACE1+95                                                04172000
CALLID   EQU   OLDERID1+90                                              04173000
@NM00002 EQU   OLDERID1                                                 04174000
*                                      END UNREFERENCED COMPONENTS      04175000
@RF00234 EQU   @RC00227                                                 04176000
@RC00258 EQU   @RC00248                                                 04177000
@RF00306 EQU   @RC00301                                                 04178000
@RC00350 EQU   @RC00348                                                 04179000
@RC00356 EQU   @RC00348                                                 04180000
@RC00375 EQU   @RC00365                                                 04181000
@RC00475 EQU   @RC00473                                                 04182000
@RF00747 EQU   @RC00732                                                 04183000
@PB00008 EQU   @EL00001                                                 04184000
@RC00260 EQU   @RC00258                                                 04185000
@RC00377 EQU   @RC00375                                                 04186000
@RC00392 EQU   @RC00375                                                 04187000
@RF00477 EQU   @RC00475                                                 04188000
@RF00479 EQU   @RC00475                                                 04189000
@PB00007 EQU   @PB00008                                                 04190000
@PB00006 EQU   @PB00007                                                 04191000
@PB00005 EQU   @PB00006                                                 04192000
@PB00004 EQU   @PB00005                                                 04193000
@PB00003 EQU   @PB00004                                                 04194000
@PB00002 EQU   @PB00003                                                 04195000
@ENDDATA EQU   *                                                        04196000
         END   IDCEV01,(C'PLS2119',0603,74298)                          04197000
