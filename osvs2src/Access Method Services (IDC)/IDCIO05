         TITLE '*********** IDCIO05:  EXCP I/O ADAPTOR SERVICE ROUTINE *00001000
                ********'                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCIO05  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCIO05   77.354'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @02,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@02)                                      0002 00023000
         LA    @08,4095(,@10)                                      0002 00024000
         LA    @11,4095(,@08)                                      0002 00025000
         USING @PSTART,@12                                         0002 00026000
         USING @PSTART+4095,@02                                    0002 00027000
         USING @PSTART+8190,@10                                    0002 00028000
         USING @PSTART+12285,@08                                   0002 00029000
         USING @PSTART+16380,@11                                   0002 00030000
         L     @00,@SIZDATD                                        0002 00031000
         GETMAIN  R,LV=(0)                                              00032000
         LR    @09,@01                                             0002 00033000
         USING @DATD,@09                                           0002 00034000
         ST    @13,@SA00001+4                                      0002 00035000
         LM    @00,@01,20(@13)                                     0002 00036000
         ST    @09,8(,@13)                                         0002 00037000
         LR    @13,@09                                             0002 00038000
         MVC   @PC00001(12),0(@01)                                 0002 00039000
*                                      LOCATION TABLE        @ZA11014*/ 00040000
*                                                                  0469 00041000
*   /*****************************************************************/ 00042000
*   /*                                                               */ 00043000
*   /* SET TRACE POINT 'IO05' IN TRACE TABLE                 @Y30LB35*/ 00044000
*   /*                                                               */ 00045000
*   /*****************************************************************/ 00046000
*                                                                  0470 00047000
*   OLDERID2=NEWERID2;                                             0470 00048000
         L     @03,@PC00001                                        0470 00049000
         L     @03,GDTTR2(,@03)                                    0470 00050000
         L     @15,@PC00001                                        0470 00051000
         L     @01,GDTTR2(,@15)                                    0470 00052000
         MVC   @TS00001(95),NEWERID2(@01)                          0470 00053000
         MVC   OLDERID2(95,@03),@TS00001                           0470 00054000
*   NEWID2='IO05';                  /*                       @Y30LB35*/ 00055000
*                                                                  0471 00056000
         L     @03,@PC00001                                        0471 00057000
         L     @03,GDTTR2(,@03)                                    0471 00058000
         MVC   NEWID2(4,@03),@CC03779                              0471 00059000
*   /*****************************************************************/ 00060000
*   /*                                                               */ 00061000
*   /* SET UP FULL REGION DUMP POINT 'IOIN'                  @Y30LB35*/ 00062000
*   /*                                                               */ 00063000
*   /*****************************************************************/ 00064000
*                                                                  0472 00065000
*   IF GDTDBG=NULLPTR THEN                                         0472 00066000
         L     @03,@PC00001                                        0472 00067000
         L     @03,GDTDBG(,@03)                                    0472 00068000
         LTR   @03,@03                                             0472 00069000
         BZ    @RT00472                                            0472 00070000
*     ;                                                            0473 00071000
*   ELSE                                                           0474 00072000
*     CALL IDCDB010(GDTTBL,'IOIN'); /*                       @Y30LB35   00073000
*                                                            @Y30LB35*/ 00074000
         L     @03,@PC00001                                        0474 00075000
         ST    @03,@AL00001                                        0474 00076000
         LA    @03,@CC04110                                        0474 00077000
         ST    @03,@AL00001+4                                      0474 00078000
         MVI   @AL00001+4,X'80'                                    0474 00079000
         L     @03,@PC00001                                        0474 00080000
         L     @15,GDTDBG(,@03)                                    0474 00081000
         LA    @01,@AL00001                                        0474 00082000
         BALR  @14,@15                                             0474 00083000
*   TESTRC=0;                       /*                       @Y30LB35   00084000
*                                                            @Y30LB35*/ 00085000
*                                                                  0475 00086000
@RT00472 SLR   @03,@03                                             0475 00087000
         STH   @03,TESTRC                                          0475 00088000
*   /*****************************************************************/ 00089000
*   /*                                                               */ 00090000
*   /* SET UP ADDRESSABILITY TO DARGLIST FOR MSGS            @Y30LB35*/ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0476 00094000
*   DDSTRU=ADDR(PRINTARG);          /*                       @Y30LB35*/ 00095000
         LA    @03,PRINTARG                                        0476 00096000
         ST    @03,DDSTRU                                          0476 00097000
*                                                                  0477 00098000
*   /*****************************************************************/ 00099000
*   /*                                                               */ 00100000
*   /* MOVE REQUEST NAME INTO CALLER'S PARMLIST              @Y30LB35*/ 00101000
*   /* THIS WILL AID TO DETERMINE IF LIST WAS                @Y30LB35*/ 00102000
*   /* PASSED IF A DUMP IS BEING READ.                       @Y30LB35*/ 00103000
*   /* IF THE FIRST 8 CHARACTERS                             @Y30LB35*/ 00104000
*   /* IN A DUMP CONTAINS THE REQUEST NAME                   @Y30LB35*/ 00105000
*   /* WHICH CAN BE "GET","PUT", "OPEN", OR "CLOSE"          @Y30LB35*/ 00106000
*   /* IT SHOULD INDICATE THAT THIS MOD WAS CALLED.          @Y30LB35*/ 00107000
*   /* THE CALL TO CLOSE IS DONE WITHOUT A PARMLST.          @Y30LB35*/ 00108000
*   /*                                                               */ 00109000
*   /*****************************************************************/ 00110000
*                                                                  0477 00111000
*   IF REQUEST^=CLOSE               /*                       @Y30LB35*/ 00112000
*     THEN                                                         0477 00113000
         L     @03,@PC00001+4                                      0477 00114000
         CLC   REQUEST(8,@03),CLOSE                                0477 00115000
         BE    @RF00477                                            0477 00116000
*     ARGHEAD=REQUEST;              /*                       @Y30LB35*/ 00117000
*                                                                  0478 00118000
         L     @03,@PC00001+8                                      0478 00119000
         L     @15,@PC00001+4                                      0478 00120000
         MVC   ARGHEAD(8,@03),REQUEST(@15)                         0478 00121000
*   /*****************************************************************/ 00122000
*   /*                                                               */ 00123000
*   /* HERE THE DETERMINATION IS MADE                        @Y30LB35*/ 00124000
*   /* AS TO WHICH SERVICE IS REQUESTED.                     @Y30LB35*/ 00125000
*   /* OPENPROC IS CALLED IF THE REQUEST IS "OPEN"           @Y30LB35*/ 00126000
*   /*                                                               */ 00127000
*   /*****************************************************************/ 00128000
*                                                                  0479 00129000
*   IF REQUEST=OPEN                 /*                       @Y30LB35*/ 00130000
*     THEN                                                         0479 00131000
@RF00477 L     @03,@PC00001+4                                      0479 00132000
         CLC   REQUEST(8,@03),OPEN                                 0479 00133000
         BNE   @RF00479                                            0479 00134000
*     CALL OPENPROC;                /*                       @Y30LB35   00135000
*                                                            @Y30LB35*/ 00136000
         BAL   @14,OPENPROC                                        0480 00137000
*   ELSE                            /*                       @Y30LB35*/ 00138000
*                                                                  0481 00139000
*     /***************************************************************/ 00140000
*     /*                                                             */ 00141000
*     /* PUTGET IS CALLED IF REQUEST IS "GET" OR "PUT"       @Y30LB35*/ 00142000
*     /*                                                             */ 00143000
*     /***************************************************************/ 00144000
*                                                                  0481 00145000
*     IF REQUEST=PUT|REQUEST=GET    /*                       @Y30LB35*/ 00146000
*       THEN                                                       0481 00147000
         B     @RC00479                                            0481 00148000
@RF00479 L     @03,@PC00001+4                                      0481 00149000
         CLC   REQUEST(8,@03),PUT                                  0481 00150000
         BE    @RT00481                                            0481 00151000
         L     @03,@PC00001+4                                      0481 00152000
         CLC   REQUEST(8,@03),GET                                  0481 00153000
         BNE   @RF00481                                            0481 00154000
@RT00481 DS    0H                                                  0482 00155000
*       CALL PUTGET;                /*                       @Y30LB35   00156000
*                                                            @Y30LB35*/ 00157000
         BAL   @14,PUTGET                                          0482 00158000
*     ELSE                          /*                       @Y30LB35*/ 00159000
*                                                                  0483 00160000
*       /*************************************************************/ 00161000
*       /*                                                           */ 00162000
*       /* CLOSE IS CALLED IF REQUEST IS "CLOSE"             @Y30LB35*/ 00163000
*       /*                                                           */ 00164000
*       /*************************************************************/ 00165000
*                                                                  0483 00166000
*       IF REQUEST=CLOSE            /*                       @Y30LB35*/ 00167000
*         THEN                                                     0483 00168000
         B     @RC00481                                            0483 00169000
@RF00481 L     @03,@PC00001+4                                      0483 00170000
         CLC   REQUEST(8,@03),CLOSE                                0483 00171000
         BNE   @RF00483                                            0483 00172000
*         CALL CLOSEPRC;            /*                       @Y30LB35   00173000
*                                                            @ZA11014*/ 00174000
         BAL   @14,CLOSEPRC                                        0484 00175000
*       ELSE                        /*                       @ZA11014*/ 00176000
*                                                                  0485 00177000
*         /***********************************************************/ 00178000
*         /*                                                         */ 00179000
*         /* OPENR IS CALLED IF REQUEST IS "OPENR"           @ZA11014*/ 00180000
*         /*                                                         */ 00181000
*         /***********************************************************/ 00182000
*                                                                  0485 00183000
*         IF REQUEST=RVOPENR        /*                       @ZA11014*/ 00184000
*           THEN                                                   0485 00185000
         B     @RC00483                                            0485 00186000
@RF00483 L     @03,@PC00001+4                                      0485 00187000
         CLC   REQUEST(8,@03),RVOPENR                              0485 00188000
         BNE   @RF00485                                            0485 00189000
*           CALL OPENR;             /*                       @ZA11014   00190000
*                                                            @ZA11014*/ 00191000
         BAL   @14,OPENR                                           0486 00192000
*         ELSE                      /*                       @ZA11014*/ 00193000
*                                                                  0487 00194000
*           /*********************************************************/ 00195000
*           /*                                                       */ 00196000
*           /* READKD IS CALLED IF REQUEST IS "READKD"       @ZA11014*/ 00197000
*           /*                                                       */ 00198000
*           /*********************************************************/ 00199000
*                                                                  0487 00200000
*           IF REQUEST=RVREADKD     /*                       @ZA11014*/ 00201000
*             THEN                                                 0487 00202000
         B     @RC00485                                            0487 00203000
@RF00485 L     @03,@PC00001+4                                      0487 00204000
         CLC   REQUEST(8,@03),RVREADKD                             0487 00205000
         BNE   @RF00487                                            0487 00206000
*             CALL READKD;          /*                       @ZA11014   00207000
*                                                            @ZA11014*/ 00208000
         BAL   @14,READKD                                          0488 00209000
*           ELSE                    /*                       @ZA11014*/ 00210000
*                                                                  0489 00211000
*             /*******************************************************/ 00212000
*             /*                                                     */ 00213000
*             /* READCNT IS CALLED IF REQUEST IS "READCNT"   @ZA11014*/ 00214000
*             /*                                                     */ 00215000
*             /*******************************************************/ 00216000
*                                                                  0489 00217000
*             IF REQUEST=RVRDCNT    /*                       @ZA11014*/ 00218000
*               THEN                                               0489 00219000
         B     @RC00487                                            0489 00220000
@RF00487 L     @03,@PC00001+4                                      0489 00221000
         CLC   REQUEST(8,@03),RVRDCNT                              0489 00222000
         BNE   @RF00489                                            0489 00223000
*               CALL READCNT;       /*                       @ZA11014   00224000
*                                                            @ZA11014*/ 00225000
         BAL   @14,READCNT                                         0490 00226000
*             ELSE                  /*                       @ZA11014*/ 00227000
*                                                                  0491 00228000
*               /*****************************************************/ 00229000
*               /*                                                   */ 00230000
*               /* SPACCR IS CALLED IF REQUEST IS "SPACCR"   @ZA11014*/ 00231000
*               /*                                                   */ 00232000
*               /*****************************************************/ 00233000
*                                                                  0491 00234000
*               IF REQUEST=RVSPACCR /*                       @ZA11014*/ 00235000
*                 THEN                                             0491 00236000
         B     @RC00489                                            0491 00237000
@RF00489 L     @03,@PC00001+4                                      0491 00238000
         CLC   REQUEST(8,@03),RVSPACCR                             0491 00239000
         BNE   @RF00491                                            0491 00240000
*                 CALL SPACCR;      /*                       @ZA11014   00241000
*                                                            @ZA11014*/ 00242000
         BAL   @14,SPACCR                                          0492 00243000
*               ELSE                /*                       @ZA11014*/ 00244000
*                                                                  0493 00245000
*                 /***************************************************/ 00246000
*                 /*                                                 */ 00247000
*                 /* FWRITE IS CALLED IF REQUEST IS "FWRITE" @ZA11014*/ 00248000
*                 /*                                                 */ 00249000
*                 /***************************************************/ 00250000
*                                                                  0493 00251000
*                 IF REQUEST=RVFWRITE/*                      @ZA11014*/ 00252000
*                   THEN                                           0493 00253000
         B     @RC00491                                            0493 00254000
@RF00491 L     @03,@PC00001+4                                      0493 00255000
         CLC   REQUEST(8,@03),RVFWRITE                             0493 00256000
         BNE   @RF00493                                            0493 00257000
*                   CALL FWRITE;    /*                       @ZA11014   00258000
*                                                            @ZA11014*/ 00259000
         BAL   @14,FWRITE                                          0494 00260000
*                 ELSE              /*                       @ZA11014*/ 00261000
*                                                                  0495 00262000
*                   /*************************************************/ 00263000
*                   /*                                               */ 00264000
*                   /* WRITEREC IS CALLED IF REQUEST IS "WRITEREC"   */ 00265000
*                   /*                                       @ZA11014*/ 00266000
*                   /*                                               */ 00267000
*                   /*************************************************/ 00268000
*                                                                  0495 00269000
*                   IF REQUEST=RVWRITER/*                    @ZA11014*/ 00270000
*                     THEN                                         0495 00271000
         B     @RC00493                                            0495 00272000
@RF00493 L     @03,@PC00001+4                                      0495 00273000
         CLC   REQUEST(8,@03),RVWRITER                             0495 00274000
         BNE   @RF00495                                            0495 00275000
*                     CALL WRITEREC;/*                       @ZA11014   00276000
*                                                            @ZA11014   00277000
*                                                            @Y30LB35*/ 00278000
         BAL   @14,WRITEREC                                        0496 00279000
*                   ELSE            /*                       @Y30LB35*/ 00280000
*                                                                  0497 00281000
*                     /***********************************************/ 00282000
*                     /*                                             */ 00283000
*                     /* UABORT 40 IS ISSUED IF REQUEST IS INVALID   */ 00284000
*                     /*                                     @Y30LB35*/ 00285000
*                     /*                                             */ 00286000
*                     /***********************************************/ 00287000
*                                                                  0497 00288000
*                     DO;                                          0497 00289000
         B     @RC00495                                            0497 00290000
@RF00495 DS    0H                                                  0498 00291000
*                       RESPECIFY                                  0498 00292000
*                        (REG13,                                   0498 00293000
*                         REG14,                                   0498 00294000
*                         REG15) RSTD;                             0498 00295000
*                       REG15=40;                                  0499 00296000
         LA    REG15,40                                            0499 00297000
*                       REG14=GDTABT;                              0500 00298000
         L     @03,@PC00001                                        0500 00299000
         L     REG14,GDTABT(,@03)                                  0500 00300000
*                       REG13=GDTABH;                              0501 00301000
         L     @03,@PC00001                                        0501 00302000
         L     REG13,GDTABH(,@03)                                  0501 00303000
*                       GEN(BR    REG14);                          0502 00304000
         BR    REG14                                                    00305000
*                       RESPECIFY                                  0503 00306000
*                        (REG13,                                   0503 00307000
*                         REG14,                                   0503 00308000
*                         REG15) UNRSTD;                           0503 00309000
*                     END;          /*                       @Y30LB35   00310000
*                                                            @Y30LB35*/ 00311000
*                                                                  0504 00312000
*   /*****************************************************************/ 00313000
*   /*                                                               */ 00314000
*   /* SET UP FULL REGION DUMP POINT 'IOEX'                  @Y30LB35*/ 00315000
*   /*                                                               */ 00316000
*   /*****************************************************************/ 00317000
*                                                                  0505 00318000
*   IF GDTDBG=NULLPTR THEN                                         0505 00319000
@RC00495 DS    0H                                                  0505 00320000
@RC00493 DS    0H                                                  0505 00321000
@RC00491 DS    0H                                                  0505 00322000
@RC00489 DS    0H                                                  0505 00323000
@RC00487 DS    0H                                                  0505 00324000
@RC00485 DS    0H                                                  0505 00325000
@RC00483 DS    0H                                                  0505 00326000
@RC00481 DS    0H                                                  0505 00327000
@RC00479 L     @03,@PC00001                                        0505 00328000
         L     @03,GDTDBG(,@03)                                    0505 00329000
         LTR   @03,@03                                             0505 00330000
         BZ    @RT00505                                            0505 00331000
*     ;                                                            0506 00332000
*   ELSE                                                           0507 00333000
*     CALL IDCDB010(GDTTBL,'IOEX'); /*                       @Y30LB35*/ 00334000
*                                                                  0507 00335000
         L     @03,@PC00001                                        0507 00336000
         ST    @03,@AL00001                                        0507 00337000
         LA    @03,@CC04120                                        0507 00338000
         ST    @03,@AL00001+4                                      0507 00339000
         MVI   @AL00001+4,X'80'                                    0507 00340000
         L     @03,@PC00001                                        0507 00341000
         L     @15,GDTDBG(,@03)                                    0507 00342000
         LA    @01,@AL00001                                        0507 00343000
         BALR  @14,@15                                             0507 00344000
*   /*****************************************************************/ 00345000
*   /*                                                               */ 00346000
*   /* CONTROL IS RETURNED TO CALLER WITH RETURN             @Y30LB35*/ 00347000
*   /* CODE IN REGISTER 15 OF 4 ERROR OR 0 SUCCESS           @Y30LB35*/ 00348000
*   /* A RETURN CODE INDICATING SPECIFIC RESULTS             @ZA11014*/ 00349000
*   /* WILL BE SET IF THE CALL WAS FOR A REPAIRV             @ZA11014*/ 00350000
*   /* FUNCTION                                              @ZA11014*/ 00351000
*   /*                                                               */ 00352000
*   /*****************************************************************/ 00353000
*                                                                  0508 00354000
*   CALL IDCSAEP0(GDTTBL,MODID,TESTRC);                            0508 00355000
*                                                                  0508 00356000
@RT00505 L     @03,@PC00001                                        0508 00357000
         ST    @03,@AL00001                                        0508 00358000
         LA    @03,MODID                                           0508 00359000
         ST    @03,@AL00001+4                                      0508 00360000
         LA    @03,TESTRC                                          0508 00361000
         ST    @03,@AL00001+8                                      0508 00362000
         MVI   @AL00001+8,X'80'                                    0508 00363000
         L     @03,@PC00001                                        0508 00364000
         L     @15,GDTEPL(,@03)                                    0508 00365000
         LA    @01,@AL00001                                        0508 00366000
         BALR  @14,@15                                             0508 00367000
*   /*****************************************************************/ 00368000
*   /*                                                               */ 00369000
*   /*                                                       @Y30LB35*/ 00370000
*   /*                                                               */ 00371000
*   /*****************************************************************/ 00372000
*                                                                  0509 00373000
*                                   /*                       @Y30LB35*/ 00374000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 00375000
         LH    @03,TESTRC                                          0509 00376000
         L     @13,4(,@13)                                         0509 00377000
         L     @00,@SIZDATD                                        0509 00378000
         LR    @01,@09                                             0509 00379000
         FREEMAIN R,LV=(0),A=(1)                                        00380000
         LR    @15,@03                                             0509 00381000
         L     @14,12(,@13)                                        0509 00382000
         LM    @00,@12,20(@13)                                     0509 00383000
         BR    @14                                                 0509 00384000
*                                                                  0510 00385000
*/********************************************************************/ 00386000
*/*                                                          @Y30LB35*/ 00387000
*/* PROCEDURE NAME - OPENPROC                                @Y30LB35*/ 00388000
*/*                                                          @Y30LB35*/ 00389000
*/* FUNCTION -  CALL SUBPROCEDURE BLDBLK TO SETUP IOXCTLBK   @Y30LB35*/ 00390000
*/*             DETERMINE WHICH TYPE OPEN HAS BEEN           @Y30LB35*/ 00391000
*/*             REQUESTED, AND CALL APPROPRIATE SUBPROCEDURE @Y30LB35*/ 00392000
*/*             OPNNEW, OPNTAB, OPNLAB, OPNVTOC, OR OPNPASS  @Z40LB35*/ 00393000
*/*             IF THE RETURN CODE IS FOUND TO BE RCOK(0)    @Y30LB35*/ 00394000
*/*             THEN THE IOXCTLBK IS CHAINED UP TO THE       @Y30LB35*/ 00395000
*/*             IODIOX OPEN CHAIN.  IF THE RETURN CODE FROM  @Y30LB35*/ 00396000
*/*             SUBPROCEDURE IS NOT ZERO, THE CONTROL BLOCK  @Y30LB35*/ 00397000
*/*             IS FREED AND THE RETURN CODE RCFAIL(4) IS    @Y30LB35*/ 00398000
*/*             RETURNED.                                    @Y30LB35*/ 00399000
*/*                                                          @Y30LB35*/ 00400000
*/*             THERE ARE NO MESSAGES ISSUED THIS PROC       @Y30LB35*/ 00401000
*/*                                                          @Y30LB35*/ 00402000
*/*                                                          @Y30LB35*/ 00403000
*/* INPUT -     EXOPT FROM EXOARG                            @Y30LB35*/ 00404000
*/*                                                          @Y30LB35*/ 00405000
*/* OUTPUT -    IOXTYPE IN IOXCTLBK                          @Y30LB35*/ 00406000
*/*             IODIOX  IN IODATA                            @Y30LB35*/ 00407000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 00408000
*/*                           4, ERROR FROM OPNLAB           @Y30LB35*/ 00409000
*/*                           4, ERROR FROM OPNNEW           @Y30LB35*/ 00410000
*/*                           4, ERROR FROM OPNPASS          @Y30LB35*/ 00411000
*/*                           4, ERROR FROM OPNTAB           @Y30LB35*/ 00412000
*/*                           4, ERROR FROM OPNVTOC          @Z40LB35*/ 00413000
*/*                                                          @Y30LB35*/ 00414000
*/********************************************************************/ 00415000
*                                                                  0510 00416000
*                                   /*                       @Y30LB35*/ 00417000
*OPENPROC:                                                         0510 00418000
*   PROC;                           /*                       @Y30LB35*/ 00419000
*                                                                  0510 00420000
OPENPROC STM   @14,@12,@SA00002                                    0510 00421000
*   /*****************************************************************/ 00422000
*   /*                                                               */ 00423000
*   /* SET UP TRACE POINT 'IOOE' IN TRACE TABLE              @Y30LB35*/ 00424000
*   /*                                                               */ 00425000
*   /*****************************************************************/ 00426000
*                                                                  0511 00427000
*   OLDERID2=NEWERID2;                                             0511 00428000
         L     @03,@PC00001                                        0511 00429000
         L     @03,GDTTR2(,@03)                                    0511 00430000
         L     @15,@PC00001                                        0511 00431000
         L     @01,GDTTR2(,@15)                                    0511 00432000
         MVC   @TS00001(95),NEWERID2(@01)                          0511 00433000
         MVC   OLDERID2(95,@03),@TS00001                           0511 00434000
*   NEWID2='IOOE';                  /*                       @Y30LB35*/ 00435000
*                                                                  0512 00436000
         L     @03,@PC00001                                        0512 00437000
         L     @03,GDTTR2(,@03)                                    0512 00438000
         MVC   NEWID2(4,@03),@CC04124                              0512 00439000
*   /*****************************************************************/ 00440000
*   /*                                                               */ 00441000
*   /* CALL BLDBLK TO GET CORE FOR AND INITIALIZE            @Y30LB35*/ 00442000
*   /* IOXCTLBK                                              @Y30LB35*/ 00443000
*   /*                                                               */ 00444000
*   /*****************************************************************/ 00445000
*                                                                  0513 00446000
*   CALL BLDBLK;                    /*                       @Y30LB35*/ 00447000
         BAL   @14,BLDBLK                                          0513 00448000
*   RESPECIFY                                                      0514 00449000
*     RTNREG RSTD;                                                 0514 00450000
*   TESTRC=RTNREG;                                                 0515 00451000
         STH   RTNREG,TESTRC                                       0515 00452000
*   RESPECIFY                                                      0516 00453000
*     RTNREG UNRSTD;                /*                       @Y30LB35*/ 00454000
*                                                                  0516 00455000
*   /*****************************************************************/ 00456000
*   /*                                                               */ 00457000
*   /* PROVIDING THE RETURN CODE FROM BLDBLK IS ZERO         @Y30LB35*/ 00458000
*   /* THE SUBPROCEDURE OPNNEW, OPNPASS, OPNTAB,             @Y30LB35*/ 00459000
*   /* OR OPNLAB IS CALLED.                                  @Y30LB35*/ 00460000
*   /*                                                               */ 00461000
*   /*****************************************************************/ 00462000
*                                                                  0517 00463000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 00464000
*     THEN                          /*                       @Y30LB35*/ 00465000
*                                                                  0517 00466000
         LH    @03,TESTRC                                          0517 00467000
         LTR   @03,@03                                             0517 00468000
         BNZ   @RF00517                                            0517 00469000
*     /***************************************************************/ 00470000
*     /*                                                             */ 00471000
*     /* THE SUBPROCEDURE NEWVOL IS CALLED IF CALLER         @Y30LB35*/ 00472000
*     /* HAS SET THE EXONEW.                                 @Y30LB35*/ 00473000
*     /* THE IOXTYPE IS SET WITH TYPE NEWVOL CODE.           @Y30LB35*/ 00474000
*     /*                                                             */ 00475000
*     /***************************************************************/ 00476000
*                                                                  0518 00477000
*     IF EXONEW=ON                  /*                       @Y30LB35*/ 00478000
*       THEN                        /*                       @Y30LB35*/ 00479000
         L     @03,@PC00001+8                                      0518 00480000
         TM    EXONEW(@03),B'00010000'                             0518 00481000
         BNO   @RF00518                                            0518 00482000
*       DO;                         /*                       @Y30LB35*/ 00483000
*         IOXTYPE=NEWVOL;           /*                       @Y30LB35*/ 00484000
         L     @03,IOCTLBKP                                        0520 00485000
         MVC   IOXTYPE(1,@03),NEWVOL                               0520 00486000
*         CALL OPNNEW;              /*                       @Y30LB35*/ 00487000
         BAL   @14,OPNNEW                                          0521 00488000
*         RESPECIFY                                                0522 00489000
*           RTNREG RSTD;                                           0522 00490000
*         TESTRC=RTNREG;                                           0523 00491000
         STH   RTNREG,TESTRC                                       0523 00492000
*         RESPECIFY                                                0524 00493000
*           RTNREG UNRSTD;          /*                       @Y30LB35*/ 00494000
*       END;                        /*                       @Y30LB35   00495000
*                                                            @Y30LB35*/ 00496000
*     ELSE                          /*                       @Y30LB35*/ 00497000
*                                                                  0526 00498000
*       /*************************************************************/ 00499000
*       /*                                                           */ 00500000
*       /* THE SUBPROCEDURE OPNTAB IS CALLED IF CALLER       @Y30LB35*/ 00501000
*       /* HAS SET THE EXOTAB.                               @Y30LB35*/ 00502000
*       /* THE IOXTYPE IS SET WITH TYPE TABLE CODE.          @Y30LB35*/ 00503000
*       /*                                                           */ 00504000
*       /*************************************************************/ 00505000
*                                                                  0526 00506000
*       IF EXOTAB=ON                /*                       @Y30LB35*/ 00507000
*         THEN                      /*                       @Y30LB35*/ 00508000
         B     @RC00518                                            0526 00509000
@RF00518 L     @03,@PC00001+8                                      0526 00510000
         TM    EXOTAB(@03),B'10000000'                             0526 00511000
         BNO   @RF00526                                            0526 00512000
*         DO;                       /*                       @Y30LB35*/ 00513000
*           IOXTYPE=TABLE;          /*                       @Y30LB35*/ 00514000
         L     @03,IOCTLBKP                                        0528 00515000
         MVC   IOXTYPE(1,@03),TABLE                                0528 00516000
*           CALL OPNTAB;            /*                       @Y30LB35*/ 00517000
         BAL   @14,OPNTAB                                          0529 00518000
*           RESPECIFY                                              0530 00519000
*             RTNREG RSTD;                                         0530 00520000
*           TESTRC=RTNREG;                                         0531 00521000
         STH   RTNREG,TESTRC                                       0531 00522000
*           RESPECIFY                                              0532 00523000
*             RTNREG UNRSTD;        /*                       @Y30LB35*/ 00524000
*         END;                      /*                       @Y30LB35*/ 00525000
*       ELSE                        /*                       @Y30LB35*/ 00526000
*                                                                  0534 00527000
*         /***********************************************************/ 00528000
*         /*                                                         */ 00529000
*         /* THE SUBPROCEDURE OPNLAB IS CALLED IF CALLER     @Y30LB35*/ 00530000
*         /* HAS SET THE EXOLAB.                             @Y30LB35*/ 00531000
*         /* THE IOXTYPE IS SET WITH TYPE LAB CODE.          @Y30LB35*/ 00532000
*         /*                                                         */ 00533000
*         /***********************************************************/ 00534000
*                                                                  0534 00535000
*         IF EXOLAB=ON              /*                       @Y30LB35*/ 00536000
*           THEN                    /*                       @Y30LB35*/ 00537000
         B     @RC00526                                            0534 00538000
@RF00526 L     @03,@PC00001+8                                      0534 00539000
         TM    EXOLAB(@03),B'01000000'                             0534 00540000
         BNO   @RF00534                                            0534 00541000
*           DO;                     /*                       @Y30LB35*/ 00542000
*             IOXTYPE=LAB;          /*                       @Y30LB35*/ 00543000
         L     @03,IOCTLBKP                                        0536 00544000
         MVC   IOXTYPE(1,@03),LAB                                  0536 00545000
*             CALL OPNLAB;          /*                       @Y30LB35*/ 00546000
         BAL   @14,OPNLAB                                          0537 00547000
*             RESPECIFY                                            0538 00548000
*               RTNREG RSTD;                                       0538 00549000
*             TESTRC=RTNREG;                                       0539 00550000
         STH   RTNREG,TESTRC                                       0539 00551000
*             RESPECIFY                                            0540 00552000
*               RTNREG UNRSTD;      /*                       @Y30LB35*/ 00553000
*           END;                    /*                       @Y30LB35   00554000
*                                                            @Y30LB35*/ 00555000
*         ELSE                      /*                       @Y30LB35*/ 00556000
*                                                                  0542 00557000
*           /*********************************************************/ 00558000
*           /*                                                       */ 00559000
*           /* THE SUBPROCEDURE OPNPASS IS CALLED IF CALLER  @Y30LB35*/ 00560000
*           /* HAS SET THE EXOPASS.                          @Y30LB35*/ 00561000
*           /* THE IOXTYPE IS SET WITH TYPE PASSWORD CODE.   @Y30LB35*/ 00562000
*           /*                                                       */ 00563000
*           /*********************************************************/ 00564000
*                                                                  0542 00565000
*           IF EXOPASS=ON           /*                       @Y30LB35*/ 00566000
*             THEN                  /*                       @Y30LB35*/ 00567000
         B     @RC00534                                            0542 00568000
@RF00534 L     @03,@PC00001+8                                      0542 00569000
         TM    EXOPASS(@03),B'00100000'                            0542 00570000
         BNO   @RF00542                                            0542 00571000
*             DO;                   /*                       @Y30LB35*/ 00572000
*               IOXTYPE=PASSWORD;   /*                       @Y30LB35*/ 00573000
         L     @03,IOCTLBKP                                        0544 00574000
         MVC   IOXTYPE(1,@03),PASSWORD                             0544 00575000
*               CALL OPNPASS;       /*                       @Y30LB35*/ 00576000
         BAL   @14,OPNPASS                                         0545 00577000
*               RESPECIFY                                          0546 00578000
*                 RTNREG RSTD;                                     0546 00579000
*               TESTRC=RTNREG;                                     0547 00580000
         STH   RTNREG,TESTRC                                       0547 00581000
*               RESPECIFY                                          0548 00582000
*                 RTNREG UNRSTD;    /*                       @Y30LB35*/ 00583000
*             END;                  /*                       @Y30LB35*/ 00584000
*           ELSE                    /*                       @Z40LB35*/ 00585000
*                                                                  0550 00586000
*             /*******************************************************/ 00587000
*             /*                                                     */ 00588000
*             /* THE SUBPROCEDURE OPNVTOC IS CALLED IF CALLER        */ 00589000
*             /*                                             @Z40LB35*/ 00590000
*             /* HAS SET THE EXOVTOC.                        @Z40LB35*/ 00591000
*             /* THE IOXTYPE IS SET WITH TYPE VTOC CODE.     @Z40LB35*/ 00592000
*             /*                                                     */ 00593000
*             /*******************************************************/ 00594000
*                                                                  0550 00595000
*             IF EXOVTOC=ON         /*                       @Z40LB35*/ 00596000
*               THEN                /*                       @Z40LB35*/ 00597000
         B     @RC00542                                            0550 00598000
@RF00542 L     @03,@PC00001+8                                      0550 00599000
         TM    EXOVTOC(@03),B'00001000'                            0550 00600000
         BNO   @RF00550                                            0550 00601000
*               DO;                 /*                       @Z40LB35*/ 00602000
*                 IOXTYPE=VTOC;     /*                       @Z40LB35*/ 00603000
         L     @03,IOCTLBKP                                        0552 00604000
         MVC   IOXTYPE(1,@03),VTOC                                 0552 00605000
*                 CALL OPNVTOC;     /*                       @Z40LB35*/ 00606000
         BAL   @14,OPNVTOC                                         0553 00607000
*                 RESPECIFY                                        0554 00608000
*                   RTNREG RSTD;                                   0554 00609000
*                 TESTRC=RTNREG;                                   0555 00610000
         STH   RTNREG,TESTRC                                       0555 00611000
*                 RESPECIFY                                        0556 00612000
*                   RTNREG UNRSTD;  /*                       @Z40LB35*/ 00613000
*               END;                /*                       @Z40LB35*/ 00614000
*             ELSE                  /*                       @Z40LB35*/ 00615000
*                                                                  0558 00616000
*               /*****************************************************/ 00617000
*               /*                                                   */ 00618000
*               /* ISSUE UABORT CODE 40 IF INVALID CODE      @Y30LB35*/ 00619000
*               /*                                                   */ 00620000
*               /*****************************************************/ 00621000
*                                                                  0558 00622000
*               DO;                                                0558 00623000
         B     @RC00550                                            0558 00624000
@RF00550 DS    0H                                                  0559 00625000
*                 RESPECIFY                                        0559 00626000
*                  (REG13,                                         0559 00627000
*                   REG14,                                         0559 00628000
*                   REG15) RSTD;                                   0559 00629000
*                 REG15=40;                                        0560 00630000
         LA    REG15,40                                            0560 00631000
*                 REG14=GDTABT;                                    0561 00632000
         L     @03,@PC00001                                        0561 00633000
         L     REG14,GDTABT(,@03)                                  0561 00634000
*                 REG13=GDTABH;                                    0562 00635000
         L     @03,@PC00001                                        0562 00636000
         L     REG13,GDTABH(,@03)                                  0562 00637000
*                 GEN(BR    REG14);                                0563 00638000
         BR    REG14                                                    00639000
*                 RESPECIFY                                        0564 00640000
*                  (REG13,                                         0564 00641000
*                   REG14,                                         0564 00642000
*                   REG15) UNRSTD;                                 0564 00643000
*               END;                /*                       @Z40LB35*/ 00644000
*                                                                  0566 00645000
*   /*****************************************************************/ 00646000
*   /*                                                               */ 00647000
*   /* HERE THE TEST IS MADE TO DETERMINE WHETHER            @Y30LB35*/ 00648000
*   /* THE OPEN WAS SUCCESSFUL OR NOT. IF NOT                @Y30LB35*/ 00649000
*   /* THE CONTROL BLOCK IS FREED UP AND THE                 @Y30LB35*/ 00650000
*   /* IOXCTLBK POINTER FIELD IS ZEROED IN THE               @Y30LB35*/ 00651000
*   /* CALLER'S CORE.                                        @Y30LB35*/ 00652000
*   /*                                                               */ 00653000
*   /*****************************************************************/ 00654000
*                                                                  0566 00655000
*   IF TESTRC^=0&USERIOBP^=NULLPTR  /*                       @Y30LB35*/ 00656000
*     THEN                          /*                       @Y30LB35*/ 00657000
@RC00550 DS    0H                                                  0566 00658000
@RC00542 DS    0H                                                  0566 00659000
@RC00534 DS    0H                                                  0566 00660000
@RC00526 DS    0H                                                  0566 00661000
@RC00518 DS    0H                                                  0566 00662000
@RF00517 LH    @03,TESTRC                                          0566 00663000
         LTR   @03,@03                                             0566 00664000
         BZ    @RF00566                                            0566 00665000
         L     @03,@PC00001+8                                      0566 00666000
         L     @03,EXOCTLBK(,@03)                                  0566 00667000
         L     @03,USERIOBP(,@03)                                  0566 00668000
         LTR   @03,@03                                             0566 00669000
         BZ    @RF00566                                            0566 00670000
*     DO;                           /*                       @Y30LB35*/ 00671000
*       CALL IDCSAFS0(GDTTBL,IOCTLBKP);/*                    @Y30LB35*/ 00672000
         L     @03,@PC00001                                        0568 00673000
         ST    @03,@AL00001                                        0568 00674000
         LA    @03,IOCTLBKP                                        0568 00675000
         ST    @03,@AL00001+4                                      0568 00676000
         L     @03,@PC00001                                        0568 00677000
         L     @15,GDTFSP(,@03)                                    0568 00678000
         LA    @01,@AL00001                                        0568 00679000
         BALR  @14,@15                                             0568 00680000
*       USERIOBP=NULLPTR;           /*                       @Y30LB35*/ 00681000
         L     @03,@PC00001+8                                      0569 00682000
         L     @03,EXOCTLBK(,@03)                                  0569 00683000
         SLR   @15,@15                                             0569 00684000
         ST    @15,USERIOBP(,@03)                                  0569 00685000
*     END;                          /*                       @Y30LB35*/ 00686000
*                                                                  0570 00687000
*   /*****************************************************************/ 00688000
*   /*                                                               */ 00689000
*   /* IF THE OPEN IS SUCCESSFUL, THEN IT IS                 @Y30LB35*/ 00690000
*   /* PUT IN THE FRONT OF IODIOX CHAIN AND                  @Y30LB35*/ 00691000
*   /* THE IOXOPN IS SET ON TO INDICATE THAT THE             @Y30LB35*/ 00692000
*   /* DCB HAS BEEN OPENED.                                  @Y30LB35*/ 00693000
*   /*                                                               */ 00694000
*   /*****************************************************************/ 00695000
*                                                                  0571 00696000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 00697000
*     THEN                          /*                       @Y30LB35*/ 00698000
@RF00566 LH    @03,TESTRC                                          0571 00699000
         LTR   @03,@03                                             0571 00700000
         BNZ   @RF00571                                            0571 00701000
*     DO;                           /*                       @Y30LB35*/ 00702000
*       IOXCHAIN=IODIOX;            /*                       @Y30LB35*/ 00703000
         L     @03,@PC00001                                        0573 00704000
         L     @03,GDTIOH(,@03)                                    0573 00705000
         L     @03,IODIOX(,@03)                                    0573 00706000
         L     @01,IOCTLBKP                                        0573 00707000
         ST    @03,IOXCHAIN(,@01)                                  0573 00708000
*       IODIOX=ADDR(IOXCTLBK);      /*                       @Y30LB35*/ 00709000
         L     @03,@PC00001                                        0574 00710000
         L     @03,GDTIOH(,@03)                                    0574 00711000
         L     @15,IOCTLBKP                                        0574 00712000
         ST    @15,IODIOX(,@03)                                    0574 00713000
*       IOXOPN=ON;                  /*                       @Y30LB35*/ 00714000
         L     @03,IOCTLBKP                                        0575 00715000
         OI    IOXOPN(@03),B'10000000'                             0575 00716000
*     END;                          /*                       @Y30LB35*/ 00717000
*                                                                  0576 00718000
*   /*****************************************************************/ 00719000
*   /*                                                               */ 00720000
*   /* CONTROL IS RETURNED TO IDCIO05 - THE                  @Y30LB35*/ 00721000
*   /* MAIN PROCEDURE. THE RETURN CODE IS PASSED             @Y30LB35*/ 00722000
*   /* WITH UNSUCCESSFUL CODE OF 4 OR SUCCESSFUL 0.          @Y30LB35*/ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0577 00726000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 00727000
@RF00571 LH    @15,TESTRC                                          0577 00728000
         L     @14,@SA00002                                        0577 00729000
         LM    @00,@12,@SA00002+8                                  0577 00730000
         BR    @14                                                 0577 00731000
*   END OPENPROC;                   /*                       @Y30LB35*/ 00732000
*                                                                  0579 00733000
*/********************************************************************/ 00734000
*/*                                                          @Y30LB35*/ 00735000
*/* PROCEDURE NAME - PUTGET                                  @Y30LB35*/ 00736000
*/*                                                          @Y30LB35*/ 00737000
*/* FUNCTION -  DETERMINE WHICH TYPE CCW STRING IS NEEDED    @Y30LB35*/ 00738000
*/*             AND CALL APPROPRIATE SUBPROCEDURE OF         @Y30LB35*/ 00739000
*/*             BLDCCWP1, BLDCCWP2, OR BLDCCWG.  CALL        @Y30LB35*/ 00740000
*/*             ISSUEXCP TO ISSUE EXCP AND RETURN TO IDCIO05 @Y30LB35*/ 00741000
*/*             WITH THE RETURN CODE.                        @Y30LB35*/ 00742000
*/*                                                          @Y30LB35*/ 00743000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 00744000
*/*                                                          @Y30LB35*/ 00745000
*/* INPUT -     EXGCTLBK FROM EXGAGL                         @Y30LB35*/ 00746000
*/*             EXPCTLBK FROM EXPAGL                         @Y30LB35*/ 00747000
*/*             IOXTYPE  FROM IOXCTLBK                       @Y30LB35*/ 00748000
*/*                                                          @Y30LB35*/ 00749000
*/* OUTPUT -    IOCTLBKP                                     @Y30LB35*/ 00750000
*/*             DCBPTR                                       @Y30LB35*/ 00751000
*/*             IOBSTPTR                                     @Y30LB35*/ 00752000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 00753000
*/*                           4, ERROR IN ISSUEXCP           @Y30LB35*/ 00754000
*/*                           4, ERROR IN BLDCCWP1           @Y30LB35*/ 00755000
*/*                           4, ERROR IN BLDCCWP2           @Y30LB35*/ 00756000
*/*                                                          @Y30LB35*/ 00757000
*/********************************************************************/ 00758000
*                                                                  0579 00759000
*                                   /*                       @Y30LB35*/ 00760000
*PUTGET:                                                           0579 00761000
*   PROC;                           /*                       @Y30LB35*/ 00762000
*                                                                  0579 00763000
PUTGET   STM   @14,@12,@SA00003                                    0579 00764000
*   /*****************************************************************/ 00765000
*   /*                                                               */ 00766000
*   /* SET UP TRACE POINT 'IOPG' IN TRACE TABLE              @Y30LB35*/ 00767000
*   /*                                                               */ 00768000
*   /*****************************************************************/ 00769000
*                                                                  0580 00770000
*   OLDERID2=NEWERID2;                                             0580 00771000
         L     @03,@PC00001                                        0580 00772000
         L     @03,GDTTR2(,@03)                                    0580 00773000
         L     @15,@PC00001                                        0580 00774000
         L     @01,GDTTR2(,@15)                                    0580 00775000
         MVC   @TS00001(95),NEWERID2(@01)                          0580 00776000
         MVC   OLDERID2(95,@03),@TS00001                           0580 00777000
*   NEWID2='IOPG';                  /*                       @Y30LB35*/ 00778000
*                                                                  0581 00779000
         L     @03,@PC00001                                        0581 00780000
         L     @03,GDTTR2(,@03)                                    0581 00781000
         MVC   NEWID2(4,@03),@CC04134                              0581 00782000
*   /*****************************************************************/ 00783000
*   /*                                                               */ 00784000
*   /* IF REQUESTING "GET" THE POINTER IS EXGCTLBK           @Y30LB35*/ 00785000
*   /*                                                               */ 00786000
*   /*****************************************************************/ 00787000
*                                                                  0582 00788000
*   IF REQUEST=GET                  /*                       @Y30LB35*/ 00789000
*     THEN                          /*                       @Y30LB35*/ 00790000
*                                                                  0582 00791000
         L     @03,@PC00001+4                                      0582 00792000
         CLC   REQUEST(8,@03),GET                                  0582 00793000
         BNE   @RF00582                                            0582 00794000
*     /***************************************************************/ 00795000
*     /*                                                             */ 00796000
*     /* SET UP ADDRESSABILITY TO IOXCTLBK                   @Y30LB35*/ 00797000
*     /*                                                             */ 00798000
*     /***************************************************************/ 00799000
*                                                                  0583 00800000
*     IOCTLBKP=EXGCTLBK;            /*                       @Y30LB35*/ 00801000
         L     @03,@PC00001+8                                      0583 00802000
         L     @03,EXGCTLBK(,@03)                                  0583 00803000
         ST    @03,IOCTLBKP                                        0583 00804000
*   ELSE                            /*                       @Y30LB35*/ 00805000
*                                                                  0584 00806000
*     /***************************************************************/ 00807000
*     /*                                                             */ 00808000
*     /* IF REQUESTING "PUT" THE POINTER IS EXPCTLBK         @Y30LB35*/ 00809000
*     /*                                                             */ 00810000
*     /***************************************************************/ 00811000
*                                                                  0584 00812000
*     IOCTLBKP=EXPCTLBK;            /*                       @Y30LB35*/ 00813000
*                                                                  0584 00814000
         B     @RC00582                                            0584 00815000
@RF00582 L     @03,@PC00001+8                                      0584 00816000
         L     @03,EXPCTLBK(,@03)                                  0584 00817000
         ST    @03,IOCTLBKP                                        0584 00818000
*   /*****************************************************************/ 00819000
*   /*                                                               */ 00820000
*   /* ADDRESSABILITY IS SET UP FOR THE DCB AND IOB          @Y30LB35*/ 00821000
*   /*                                                               */ 00822000
*   /*****************************************************************/ 00823000
*                                                                  0585 00824000
*   DCBPTR=ADDR(IOXDCB);            /*                       @Y30LB35*/ 00825000
@RC00582 L     @03,IOCTLBKP                                        0585 00826000
         LA    @03,IOXDCB(,@03)                                    0585 00827000
         ST    @03,DCBPTR                                          0585 00828000
*   IOBSTPTR=ADDR(IOXIOB);          /*                       @Y30LB35*/ 00829000
         L     @03,IOCTLBKP                                        0586 00830000
         LA    @03,IOXIOB(,@03)                                    0586 00831000
         ST    @03,IOBSTPTR                                        0586 00832000
*                                                                  0587 00833000
*   /*****************************************************************/ 00834000
*   /*                                                               */ 00835000
*   /* AT THIS POINT THE CCW STRING IS BUILT                 @Y30LB35*/ 00836000
*   /* BY CALLING ONE OF CCW BUILDING PROCEDURES             @Y30LB35*/ 00837000
*   /*                                                               */ 00838000
*   /*****************************************************************/ 00839000
*                                                                  0587 00840000
*   IF REQUEST=GET                  /*                       @Y30LB35*/ 00841000
*     THEN                          /*                       @Y30LB35*/ 00842000
         L     @03,@PC00001+4                                      0587 00843000
         CLC   REQUEST(8,@03),GET                                  0587 00844000
         BNE   @RF00587                                            0587 00845000
*     DO;                           /*                       @Y30LB35*/ 00846000
*                                                                  0588 00847000
*       /*************************************************************/ 00848000
*       /*                                                           */ 00849000
*       /* IF CALLER IS RETRIEVING RECORDS, THE              @Y30LB35*/ 00850000
*       /* BLDCCWG IS CALLED TO BUILD READ KEY DATA CCWS     @Y30LB35*/ 00851000
*       /*                                                           */ 00852000
*       /*************************************************************/ 00853000
*                                                                  0589 00854000
*       CALL BLDCCWG;               /*                       @Y30LB35*/ 00855000
         BAL   @14,BLDCCWG                                         0589 00856000
*       RESPECIFY                                                  0590 00857000
*         RTNREG RSTD;                                             0590 00858000
*       TESTRC=RTNREG;                                             0591 00859000
         STH   RTNREG,TESTRC                                       0591 00860000
*       RESPECIFY                                                  0592 00861000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 00862000
*     END;                          /*                       @Y30LB35*/ 00863000
*   ELSE                            /*                       @Y30LB35*/ 00864000
*     IF IOXTYPE=NEWVOL             /*                       @Y30LB35*/ 00865000
*       THEN                        /*                       @Y30LB35*/ 00866000
         B     @RC00587                                            0594 00867000
@RF00587 L     @03,IOCTLBKP                                        0594 00868000
         CLC   IOXTYPE(1,@03),NEWVOL                               0594 00869000
         BNE   @RF00594                                            0594 00870000
*       DO;                         /*                       @Y30LB35*/ 00871000
*                                                                  0595 00872000
*         /***********************************************************/ 00873000
*         /*                                                         */ 00874000
*         /* IF CALLER IS INITIALIZING A NEW VOLUME,         @Y30LB35*/ 00875000
*         /* BLDCCWP1 IS CALLED TO BUILD WRITE               @Y30LB35*/ 00876000
*         /* COUNT KEY DATA                                  @Y30LB35*/ 00877000
*         /*                                                         */ 00878000
*         /***********************************************************/ 00879000
*                                                                  0596 00880000
*         CALL BLDCCWP1;            /*                       @Y30LB35*/ 00881000
         BAL   @14,BLDCCWP1                                        0596 00882000
*         RESPECIFY                                                0597 00883000
*           RTNREG RSTD;                                           0597 00884000
*         TESTRC=RTNREG;                                           0598 00885000
         STH   RTNREG,TESTRC                                       0598 00886000
*         RESPECIFY                                                0599 00887000
*           RTNREG UNRSTD;          /*                       @Y30LB35*/ 00888000
*       END;                        /*                       @Y30LB35*/ 00889000
*     ELSE                          /*                       @Y30LB35*/ 00890000
*       DO;                         /*                       @Y30LB35*/ 00891000
*                                                                  0601 00892000
         B     @RC00594                                            0601 00893000
@RF00594 DS    0H                                                  0602 00894000
*         /***********************************************************/ 00895000
*         /*                                                         */ 00896000
*         /* IF CALLER IS UPDATING AN EXISTING RECORD,       @Y30LB35*/ 00897000
*         /* BLDCCWP2 IS CALLED TO BUILD WRITE KEY DATA      @Y30LB35*/ 00898000
*         /*                                                         */ 00899000
*         /***********************************************************/ 00900000
*                                                                  0602 00901000
*         CALL BLDCCWP2;            /*                       @Y30LB35*/ 00902000
         BAL   @14,BLDCCWP2                                        0602 00903000
*         RESPECIFY                                                0603 00904000
*           RTNREG RSTD;                                           0603 00905000
*         TESTRC=RTNREG;                                           0604 00906000
         STH   RTNREG,TESTRC                                       0604 00907000
*         RESPECIFY                                                0605 00908000
*           RTNREG UNRSTD;          /*                       @Y30LB35*/ 00909000
*       END;                        /*                       @Y30LB35*/ 00910000
*                                                                  0607 00911000
*   /*****************************************************************/ 00912000
*   /*                                                               */ 00913000
*   /* PROVIDING THE PREVIOUS PROCEDURES WERE                @Y30LB35*/ 00914000
*   /* SUCCESSFUL THE I/O CAN NOW BE PERFORMED.              @Y30LB35*/ 00915000
*   /*                                                               */ 00916000
*   /*****************************************************************/ 00917000
*                                                                  0607 00918000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 00919000
*     THEN                          /*                       @Y30LB35*/ 00920000
@RC00594 DS    0H                                                  0607 00921000
@RC00587 LH    @03,TESTRC                                          0607 00922000
         LTR   @03,@03                                             0607 00923000
         BNZ   @RF00607                                            0607 00924000
*     DO;                           /*                       @Y30LB35*/ 00925000
*                                                                  0608 00926000
*       /*************************************************************/ 00927000
*       /*                                                           */ 00928000
*       /* ISSUEXCP IS CALLED TO PERFORM THE I/O             @Y30LB35*/ 00929000
*       /*                                                           */ 00930000
*       /*************************************************************/ 00931000
*                                                                  0609 00932000
*       CALL ISSUEXCP;              /*                       @Y30LB35*/ 00933000
         BAL   @14,ISSUEXCP                                        0609 00934000
*       RESPECIFY                                                  0610 00935000
*         RTNREG RSTD;                                             0610 00936000
*       TESTRC=RTNREG;                                             0611 00937000
         STH   RTNREG,TESTRC                                       0611 00938000
*       RESPECIFY                                                  0612 00939000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 00940000
*     END;                          /*                       @Y30LB35*/ 00941000
*                                                                  0613 00942000
*   /*****************************************************************/ 00943000
*   /*                                                               */ 00944000
*   /* CONTROL IS RETURNED TO IDCIO05 WITH CODE              @Y30LB35*/ 00945000
*   /* ZERO SUCCESSFUL OR FOUR ERROR IN REG15                @Y30LB35*/ 00946000
*   /*                                                               */ 00947000
*   /*****************************************************************/ 00948000
*                                                                  0614 00949000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 00950000
@RF00607 LH    @15,TESTRC                                          0614 00951000
         L     @14,@SA00003                                        0614 00952000
         LM    @00,@12,@SA00003+8                                  0614 00953000
         BR    @14                                                 0614 00954000
*   END PUTGET;                     /*                       @Y30LB35*/ 00955000
*                                                                  0616 00956000
*/********************************************************************/ 00957000
*/*                                                          @Y30LB35*/ 00958000
*/* PROCEDURE NAME - CLOSEPRC                                @Y30LB35*/ 00959000
*/*                                                          @Y30LB35*/ 00960000
*/* FUNCTION -  DETEMINES WHICH TYPE CLOSE IS NEEDED AND     @Y30LB35*/ 00961000
*/*             CALLS CLOSENEW OR CLOSESTD.  THE             @Y30LB35*/ 00962000
*/*             IOXCTLBK IS UNCHAINED FROM THE IODIOX CHAIN  @Y30LB35*/ 00963000
*/*             AND THE CORE IS FREED.                       @Y30LB35*/ 00964000
*/*                                                          @Y30LB35*/ 00965000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 00966000
*/*                                                          @Y30LB35*/ 00967000
*/* INPUT -     IOCTLBKP FROM CALLER                         @Y30LB35*/ 00968000
*/*             IOXTYPE FROM THE IOXCTLBK                    @Y30LB35*/ 00969000
*/*             IODIOX FROM THE HISTORICAL DATA AREA         @Y30LB35*/ 00970000
*/*                                                          @Y30LB35*/ 00971000
*/* OUTPUT -    IOXCHAIN IN IOXCTLBK                         @Y30LB35*/ 00972000
*/*             IODIOX IN HISTORICAL DATA AREA               @Y30LB35*/ 00973000
*/*             IOCTLBKP                                     @Y30LB35*/ 00974000
*/*             DCBPTR                                       @Y30LB35*/ 00975000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 00976000
*/*                           4, ERROR IN CLOSENEW           @Y30LB35*/ 00977000
*/*                           4, ERROR IN CLOSESTD           @Y30LB35*/ 00978000
*/*                                                          @Y30LB35*/ 00979000
*/********************************************************************/ 00980000
*                                                                  0616 00981000
*                                   /*                       @Y30LB35*/ 00982000
*CLOSEPRC:                                                         0616 00983000
*   PROC;                           /*                       @Y30LB35*/ 00984000
*                                                                  0616 00985000
CLOSEPRC STM   @14,@12,@SA00004                                    0616 00986000
*   /*****************************************************************/ 00987000
*   /*                                                               */ 00988000
*   /* SET UP TRACE POINT 'IOCL' IN TRACE TABLE              @Y30LB35*/ 00989000
*   /*                                                               */ 00990000
*   /*****************************************************************/ 00991000
*                                                                  0617 00992000
*   OLDERID2=NEWERID2;                                             0617 00993000
         L     @03,@PC00001                                        0617 00994000
         L     @03,GDTTR2(,@03)                                    0617 00995000
         L     @15,@PC00001                                        0617 00996000
         L     @01,GDTTR2(,@15)                                    0617 00997000
         MVC   @TS00001(95),NEWERID2(@01)                          0617 00998000
         MVC   OLDERID2(95,@03),@TS00001                           0617 00999000
*   NEWID2='IOCL';                  /*                       @Y30LB35*/ 01000000
*                                                                  0618 01001000
         L     @03,@PC00001                                        0618 01002000
         L     @03,GDTTR2(,@03)                                    0618 01003000
         MVC   NEWID2(4,@03),@CC04142                              0618 01004000
*   /*****************************************************************/ 01005000
*   /*                                                               */ 01006000
*   /* THE ONLY PARM REQUIRED IS IOXCTLBK PTR                @Y30LB35*/ 01007000
*   /*                                                               */ 01008000
*   /*****************************************************************/ 01009000
*                                                                  0619 01010000
*   IF ARGLIST^=NULLPTR THEN        /*                       @Y30LB35*/ 01011000
*                                                                  0619 01012000
         L     @03,@PC00001+8                                      0619 01013000
         L     @03,ARGLIST(,@03)                                   0619 01014000
         LTR   @03,@03                                             0619 01015000
         BZ    @RF00619                                            0619 01016000
*     /***************************************************************/ 01017000
*     /*                                                             */ 01018000
*     /* SET UP ADDRESSABILITY TO THE CONTROL BLOCK          @Y30LB35*/ 01019000
*     /*                                                             */ 01020000
*     /***************************************************************/ 01021000
*                                                                  0620 01022000
*     IOCTLBKP=ARGLIST;             /*                       @Y30LB35*/ 01023000
         L     @03,@PC00001+8                                      0620 01024000
         L     @03,ARGLIST(,@03)                                   0620 01025000
         ST    @03,IOCTLBKP                                        0620 01026000
*   ELSE                            /*                       @Y30LB35*/ 01027000
*                                                                  0621 01028000
*     /***************************************************************/ 01029000
*     /*                                                             */ 01030000
*     /* IF CALLER FAILED TO PASS POINTER, ONLY THING        @Y30LB35*/ 01031000
*     /* LEFT TO DO IS ISSUE UABORT(40).                     @Y30LB35*/ 01032000
*     /*                                                             */ 01033000
*     /***************************************************************/ 01034000
*                                                                  0621 01035000
*     DO;                                                          0621 01036000
         B     @RC00619                                            0621 01037000
@RF00619 DS    0H                                                  0622 01038000
*       RESPECIFY                                                  0622 01039000
*        (REG13,                                                   0622 01040000
*         REG14,                                                   0622 01041000
*         REG15) RSTD;                                             0622 01042000
*       REG15=40;                                                  0623 01043000
         LA    REG15,40                                            0623 01044000
*       REG14=GDTABT;                                              0624 01045000
         L     @03,@PC00001                                        0624 01046000
         L     REG14,GDTABT(,@03)                                  0624 01047000
*       REG13=GDTABH;                                              0625 01048000
         L     @03,@PC00001                                        0625 01049000
         L     REG13,GDTABH(,@03)                                  0625 01050000
*       GEN(BR    REG14);                                          0626 01051000
         BR    REG14                                                    01052000
*       RESPECIFY                                                  0627 01053000
*        (REG13,                                                   0627 01054000
*         REG14,                                                   0627 01055000
*         REG15) UNRSTD;                                           0627 01056000
*     END;                          /*                       @Y30LB35*/ 01057000
*                                                                  0629 01058000
*   /*****************************************************************/ 01059000
*   /*                                                               */ 01060000
*   /* SET UP ADDRESSABILITY TO DCB                          @Y30LB35*/ 01061000
*   /*                                                               */ 01062000
*   /*****************************************************************/ 01063000
*                                                                  0629 01064000
*   DCBPTR=ADDR(IOXDCB);            /*                       @Y30LB35*/ 01065000
*                                                                  0629 01066000
@RC00619 L     @03,IOCTLBKP                                        0629 01067000
         LA    @03,IOXDCB(,@03)                                    0629 01068000
         ST    @03,DCBPTR                                          0629 01069000
*   /*****************************************************************/ 01070000
*   /*                                                               */ 01071000
*   /* HERE THE DETERMINATION WHICH TYPE CLOSE               @Y30LB35*/ 01072000
*   /* IS IN ORDER.                                          @Y30LB35*/ 01073000
*   /*                                                               */ 01074000
*   /*****************************************************************/ 01075000
*                                                                  0630 01076000
*   IF IOXTYPE=NEWVOL|IOXTYPE=VTOCHDR THEN/*                 @ZA11014*/ 01077000
         L     @03,IOCTLBKP                                        0630 01078000
         CLC   IOXTYPE(1,@03),NEWVOL                               0630 01079000
         BE    @RT00630                                            0630 01080000
         L     @03,IOCTLBKP                                        0630 01081000
         CLC   IOXTYPE(1,@03),VTOCHDR                              0630 01082000
         BNE   @RF00630                                            0630 01083000
@RT00630 DS    0H                                                  0631 01084000
*     DO;                           /*                       @Y30LB35*/ 01085000
*                                                                  0631 01086000
*       /*************************************************************/ 01087000
*       /*                                                           */ 01088000
*       /* IF THE CALLER WAS INITIALIZING A NEW              @Y30LB35*/ 01089000
*       /* VOLUME OR IF A REPAIRV VTOC HEADER REQUEST        @ZA11014*/ 01090000
*       /* THEN A PSEUDO OPEN WAS PERFORMED                  @ZA11014*/ 01091000
*       /* BY SVC82. SVC82 MUST BE CALLED FOR CLOSE.         @Y30LB35*/ 01092000
*       /* THE PROC CLOSENEW IS CALLED AND                   @Y30LB35*/ 01093000
*       /* WILL SET UP AND ISSUE SVC82.                      @Y30LB35*/ 01094000
*       /*                                                           */ 01095000
*       /*************************************************************/ 01096000
*                                                                  0632 01097000
*       CALL CLOSENEW;              /*                       @Y30LB35*/ 01098000
         BAL   @14,CLOSENEW                                        0632 01099000
*       RESPECIFY                                                  0633 01100000
*         RTNREG RSTD;                                             0633 01101000
*       TESTRC=RTNREG;                                             0634 01102000
         STH   RTNREG,TESTRC                                       0634 01103000
*       RESPECIFY                                                  0635 01104000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 01105000
*     END;                          /*                       @Y30LB35*/ 01106000
*   ELSE                            /*                       @Y30LB35*/ 01107000
*                                                                  0637 01108000
*     /***************************************************************/ 01109000
*     /*                                                             */ 01110000
*     /* ANY OF THE OTHER TYPES CAN BE CLOSE WITH            @Y30LB35*/ 01111000
*     /* THE STANDARD CLOSE.                                 @Y30LB35*/ 01112000
*     /*                                                             */ 01113000
*     /***************************************************************/ 01114000
*                                                                  0637 01115000
*     IF IOXTYPE=PASSWORD|IOXTYPE=LAB|IOXTYPE=TABLE|IOXTYPE=VTOC|  0637 01116000
*         IOXTYPE=REPDS             /*                       @ZA11014*/ 01117000
*       THEN                        /*                       @Y30LB35*/ 01118000
         B     @RC00630                                            0637 01119000
@RF00630 L     @03,IOCTLBKP                                        0637 01120000
         CLC   IOXTYPE(1,@03),PASSWORD                             0637 01121000
         BE    @RT00637                                            0637 01122000
         L     @03,IOCTLBKP                                        0637 01123000
         CLC   IOXTYPE(1,@03),LAB                                  0637 01124000
         BE    @RT00637                                            0637 01125000
         L     @03,IOCTLBKP                                        0637 01126000
         CLC   IOXTYPE(1,@03),TABLE                                0637 01127000
         BE    @RT00637                                            0637 01128000
         L     @03,IOCTLBKP                                        0637 01129000
         CLC   IOXTYPE(1,@03),VTOC                                 0637 01130000
         BE    @RT00637                                            0637 01131000
         L     @03,IOCTLBKP                                        0637 01132000
         CLC   IOXTYPE(1,@03),REPDS                                0637 01133000
         BNE   @RF00637                                            0637 01134000
@RT00637 DS    0H                                                  0638 01135000
*       DO;                         /*                       @Y30LB35*/ 01136000
*                                                                  0638 01137000
*         /***********************************************************/ 01138000
*         /*                                                         */ 01139000
*         /* THE PROC CLOSESTD SETS UP & PERFORMS THE CLOSE          */ 01140000
*         /*                                                         */ 01141000
*         /***********************************************************/ 01142000
*                                                                  0639 01143000
*         CALL CLOSESTD;            /*                       @Y30LB35*/ 01144000
         BAL   @14,CLOSESTD                                        0639 01145000
*         RESPECIFY                                                0640 01146000
*           RTNREG RSTD;                                           0640 01147000
*         TESTRC=RTNREG;                                           0641 01148000
         STH   RTNREG,TESTRC                                       0641 01149000
*         RESPECIFY                                                0642 01150000
*           RTNREG UNRSTD;          /*                       @Y30LB35*/ 01151000
*       END;                        /*                       @Y30LB35*/ 01152000
*     ELSE                          /*                       @Y30LB35*/ 01153000
*                                                                  0644 01154000
*       /*************************************************************/ 01155000
*       /*                                                           */ 01156000
*       /* IF REQUEST IS INVALID, THEN UABORT (40)           @Y30LB35*/ 01157000
*       /* WILL BE ISSUED                                    @Y30LB35*/ 01158000
*       /*                                                           */ 01159000
*       /*************************************************************/ 01160000
*                                                                  0644 01161000
*       DO;                                                        0644 01162000
         B     @RC00637                                            0644 01163000
@RF00637 DS    0H                                                  0645 01164000
*         RESPECIFY                                                0645 01165000
*          (REG13,                                                 0645 01166000
*           REG14,                                                 0645 01167000
*           REG15) RSTD;                                           0645 01168000
*         REG15=40;                                                0646 01169000
         LA    REG15,40                                            0646 01170000
*         REG14=GDTABT;                                            0647 01171000
         L     @03,@PC00001                                        0647 01172000
         L     REG14,GDTABT(,@03)                                  0647 01173000
*         REG13=GDTABH;                                            0648 01174000
         L     @03,@PC00001                                        0648 01175000
         L     REG13,GDTABH(,@03)                                  0648 01176000
*         GEN(BR    REG14);                                        0649 01177000
         BR    REG14                                                    01178000
*         RESPECIFY                                                0650 01179000
*          (REG13,                                                 0650 01180000
*           REG14,                                                 0650 01181000
*           REG15) UNRSTD;                                         0650 01182000
*       END;                        /*                       @Y30LB35*/ 01183000
*                                                                  0652 01184000
*   /*****************************************************************/ 01185000
*   /*                                                               */ 01186000
*   /* SET UP TO REMOVE THE IOXCTLBK FROM IODIOX             @Y30LB35*/ 01187000
*   /* OPEN CHAIN.                                           @Y30LB35*/ 01188000
*   /*                                                               */ 01189000
*   /*****************************************************************/ 01190000
*                                                                  0652 01191000
*   ADDCHAIN=ADDR(IODIOX);          /*                       @Y30LB35*/ 01192000
*                                                                  0652 01193000
@RC00637 DS    0H                                                  0652 01194000
@RC00630 L     @03,@PC00001                                        0652 01195000
         L     @03,GDTIOH(,@03)                                    0652 01196000
         LA    @03,IODIOX(,@03)                                    0652 01197000
         ST    @03,ADDCHAIN                                        0652 01198000
*   /*****************************************************************/ 01199000
*   /*                                                               */ 01200000
*   /* THE ADDRESS PASSED BY CALLER IS COMPARED IN           @Y30LB35*/ 01201000
*   /* CHAIN UNTIL IT IS FOUND.                              @Y30LB35*/ 01202000
*   /*                                                               */ 01203000
*   /*****************************************************************/ 01204000
*                                                                  0653 01205000
*   DO UNCHAIN=1 BY 1 WHILE CHAINPTR^=ADDR(IOXCTLBK);              0653 01206000
         LA    @03,1                                               0653 01207000
         ST    @03,UNCHAIN                                         0653 01208000
         B     @DE00653                                            0653 01209000
@DL00653 DS    0H                                                  0654 01210000
*     ADDCHAIN=CHAINPTR;            /*                       @Y30LB35*/ 01211000
         L     @03,ADDCHAIN                                        0654 01212000
         L     @03,CHAINPTR(,@03)                                  0654 01213000
         ST    @03,ADDCHAIN                                        0654 01214000
*   END;                            /*                       @Y30LB35*/ 01215000
*                                                                  0655 01216000
         LA    @03,1                                               0655 01217000
         AL    @03,UNCHAIN                                         0655 01218000
         ST    @03,UNCHAIN                                         0655 01219000
@DE00653 L     @03,ADDCHAIN                                        0655 01220000
         CLC   CHAINPTR(4,@03),IOCTLBKP                            0655 01221000
         BNE   @DL00653                                            0655 01222000
*   /*****************************************************************/ 01223000
*   /*                                                               */ 01224000
*   /* NOW THAT THE IOXCTLBK HAS BEEN LOCATED                @Y30LB35*/ 01225000
*   /* IT IS REMOVED.                                        @Y30LB35*/ 01226000
*   /*                                                               */ 01227000
*   /*****************************************************************/ 01228000
*                                                                  0656 01229000
*   CHAINPTR=IOXCHAIN;              /*                       @Y30LB35*/ 01230000
*                                                                  0656 01231000
         L     @03,IOCTLBKP                                        0656 01232000
         L     @03,IOXCHAIN(,@03)                                  0656 01233000
         L     @01,ADDCHAIN                                        0656 01234000
         ST    @03,CHAINPTR(,@01)                                  0656 01235000
*   /*****************************************************************/ 01236000
*   /*                                                               */ 01237000
*   /* THE IOXCLOSE FLAG IS SET ON TO INDICATE               @Y30LB35*/ 01238000
*   /* THAT THE DCB IS CLOSED IN CASE                        @Y30LB35*/ 01239000
*   /* THIS CONTROL BLOCK HAS BEEN LOCATED                   @Y30LB35*/ 01240000
*   /* IN A DUMP.                                            @Y30LB35*/ 01241000
*   /*                                                               */ 01242000
*   /*****************************************************************/ 01243000
*                                                                  0657 01244000
*   IOXCLOSE=ON;                    /*                       @Y30LB35*/ 01245000
*                                                                  0657 01246000
         L     @03,IOCTLBKP                                        0657 01247000
         OI    IOXCLOSE(@03),B'00100000'                           0657 01248000
*   /*****************************************************************/ 01249000
*   /*                                                               */ 01250000
*   /* NOW THE CONTROL BLOCK IS FREED.                       @Y30LB35*/ 01251000
*   /*                                                               */ 01252000
*   /*****************************************************************/ 01253000
*                                                                  0658 01254000
*   CALL IDCSAFS0(GDTTBL,IOCTLBKP); /*                       @Y30LB35*/ 01255000
*                                                                  0658 01256000
         L     @03,@PC00001                                        0658 01257000
         ST    @03,@AL00001                                        0658 01258000
         LA    @03,IOCTLBKP                                        0658 01259000
         ST    @03,@AL00001+4                                      0658 01260000
         L     @03,@PC00001                                        0658 01261000
         L     @15,GDTFSP(,@03)                                    0658 01262000
         LA    @01,@AL00001                                        0658 01263000
         BALR  @14,@15                                             0658 01264000
*   /*****************************************************************/ 01265000
*   /*                                                               */ 01266000
*   /* CONTROL IS RETURNED TO IDCIO05 WITH                   @Y30LB35*/ 01267000
*   /* THE CODE 4 FOR ERROR OR 0 SUCCESSFUL                  @Y30LB35*/ 01268000
*   /* IN REGISTER 15.                                       @Y30LB35*/ 01269000
*   /*                                                               */ 01270000
*   /*****************************************************************/ 01271000
*                                                                  0659 01272000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 01273000
         LH    @15,TESTRC                                          0659 01274000
         L     @14,@SA00004                                        0659 01275000
         LM    @00,@12,@SA00004+8                                  0659 01276000
         BR    @14                                                 0659 01277000
*   END CLOSEPRC;                   /*                       @Y30LB35*/ 01278000
*                                                                  0661 01279000
*/********************************************************************/ 01280000
*/*                                                          @Y30LB35*/ 01281000
*/* PROCEDURE NAME - OPNPASS                                 @Y30LB35*/ 01282000
*/*                                                          @Y30LB35*/ 01283000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO TEST     @Y30LB35*/ 01284000
*/*             PASSWORD PROTECTED DATA SETS TO DETERMINE IF @Y30LB35*/ 01285000
*/*             THE OPERATOR CAN SUPPLY THE PASSWORDS. THE   @Y30LB35*/ 01286000
*/*             STEPS USED TO DETERMINE THIS IS:             @Y30LB35*/ 01287000
*/*             ISSUES USTAE, SAVES REGISTERS FOR PASSWORD   @Y30LB35*/ 01288000
*/*             ABEND, ISSUE OPEN TYPE=J, AND ISSUES USTAE.  @Y30LB35*/ 01289000
*/*                                                          @Y30LB35*/ 01290000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 01291000
*/*                                                          @Y30LB35*/ 01292000
*/* INPUT -     EXODSN FROM EXOAGL                           @Y30LB35*/ 01293000
*/*             EXOVSN FROM EXOAGL                           @Y30LB35*/ 01294000
*/*             EXOREAD FROM EXOAGL                          @Y30LB35*/ 01295000
*/*             IOXDCB FROM IOXCTLBK                         @Y30LB35*/ 01296000
*/*             SAHSTA FROM HISTORICAL DATA AREA             @Y30LB35*/ 01297000
*/*             OPENLIST                                     @Y30LB35*/ 01298000
*/*                                                          @Y30LB35*/ 01299000
*/* OUTPUT -    JFCBDSNM IN IOXJFCB                          @Y30LB35*/ 01300000
*/*             JFCVSL IN IOXJFCB                            @Y30LB35*/ 01301000
*/*             JFCAVOLS(1) IN IOXJFCB                       @Y30LB35*/ 01302000
*/*             JFCNWRIT IN IOXJFCB                          @ZM01114*/ 01303000
*/*             STAIO05 IN STAEPARM                          @Y30LB35*/ 01304000
*/*             STARTSAV IN STAEPRAM                         @Y30LB35*/ 01305000
*/*             DCBOFLWR IN IOXDCB                           @Y30LB35*/ 01306000
*/*             PARMLIST                                     @Y30LB35*/ 01307000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 01308000
*/*                           4, ERROR BAD PASSWORD          @Y30LB35*/ 01309000
*/*                           4, ERROR CHECKOPN              @Y30LB35*/ 01310000
*/*                           4, ERROR IN USTAE              @Y30LB35*/ 01311000
*/*                                                          @Y30LB35*/ 01312000
*/********************************************************************/ 01313000
*                                                                  0661 01314000
*                                   /*                       @Y30LB35*/ 01315000
*OPNPASS:                                                          0661 01316000
*   PROC;                           /*                       @Y30LB35*/ 01317000
*                                                                  0661 01318000
OPNPASS  STM   @14,@12,@SA00005                                    0661 01319000
*   /*****************************************************************/ 01320000
*   /*                                                               */ 01321000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 01322000
*   /*                                                               */ 01323000
*   /*****************************************************************/ 01324000
*                                                                  0662 01325000
*   DCL                                                            0662 01326000
*     USERDSN CHAR(44) BASED(EXODSN);/*                      @Y30LB35   01327000
*                                      ADDRESSABILITY        @Y30LB35   01328000
*                                      TO CALLER'S DSN       @Y30LB35*/ 01329000
*                                   /*                       @ZA11014*/ 01330000
*                                                                  0663 01331000
*   /*****************************************************************/ 01332000
*   /*                                                               */ 01333000
*   /* SET UP TRACE POINT 'IOOP' IN TRACE TABLE              @Y30LB35*/ 01334000
*   /*                                                               */ 01335000
*   /*****************************************************************/ 01336000
*                                                                  0663 01337000
*   OLDERID2=NEWERID2;                                             0663 01338000
         L     @03,@PC00001                                        0663 01339000
         L     @03,GDTTR2(,@03)                                    0663 01340000
         L     @15,@PC00001                                        0663 01341000
         L     @01,GDTTR2(,@15)                                    0663 01342000
         MVC   @TS00001(95),NEWERID2(@01)                          0663 01343000
         MVC   OLDERID2(95,@03),@TS00001                           0663 01344000
*   NEWID2='IOOP';                  /*                       @Y30LB35*/ 01345000
*                                                                  0664 01346000
         L     @03,@PC00001                                        0664 01347000
         L     @03,GDTTR2(,@03)                                    0664 01348000
         MVC   NEWID2(4,@03),@CC04149                              0664 01349000
*   /*****************************************************************/ 01350000
*   /*                                                               */ 01351000
*   /* INHIBIT PERM JFCB UPDATE DURING OPENJ                 @ZM01114*/ 01352000
*   /*                                                               */ 01353000
*   /*****************************************************************/ 01354000
*                                                                  0665 01355000
*   JFCNWRIT=ON;                    /*                       @ZM01114*/ 01356000
*                                                                  0665 01357000
         L     @03,JFCBPTR                                         0665 01358000
         OI    JFCNWRIT(@03),B'00001000'                           0665 01359000
*   /*****************************************************************/ 01360000
*   /*                                                               */ 01361000
*   /* A TEST IS MADE TO SEE IF CALLER WANTS                 @Y30LB35*/ 01362000
*   /* TO UPDATE THE DSN IN THE JFCB.                        @Y30LB35*/ 01363000
*   /*                                                               */ 01364000
*   /*****************************************************************/ 01365000
*                                                                  0666 01366000
*   IF EXODSN^=NULLPTR              /*                       @Y30LB35*/ 01367000
*     THEN                          /*                       @Y30LB35*/ 01368000
         L     @03,@PC00001+8                                      0666 01369000
         L     @03,EXODSN(,@03)                                    0666 01370000
         LTR   @03,@03                                             0666 01371000
         BZ    @RF00666                                            0666 01372000
*     JFCBDSNM=USERDSN;             /*                       @Y30LB35*/ 01373000
*                                                                  0667 01374000
         L     @03,JFCBPTR                                         0667 01375000
         L     @15,@PC00001+8                                      0667 01376000
         L     @01,EXODSN(,@15)                                    0667 01377000
         MVC   JFCBDSNM(44,@03),USERDSN(@01)                       0667 01378000
*   /*****************************************************************/ 01379000
*   /*                                                               */ 01380000
*   /* A TEST IS MADE TO SEE IF CALLER WANTS                 @Y30LB35*/ 01381000
*   /* TO UPDATE THE VOL SER IN THE JFCB.                    @Y30LB35*/ 01382000
*   /*                                                               */ 01383000
*   /*****************************************************************/ 01384000
*                                                                  0668 01385000
*   IF EXOVSN^=NULLPTR              /*                       @Y30LB35*/ 01386000
*     THEN                          /*                       @Y30LB35*/ 01387000
@RF00666 L     @03,@PC00001+8                                      0668 01388000
         L     @03,EXOVSN(,@03)                                    0668 01389000
         LTR   @03,@03                                             0668 01390000
         BZ    @RF00668                                            0668 01391000
*     DO;                           /*                       @Y30LB35*/ 01392000
*                                                                  0669 01393000
*       /*************************************************************/ 01394000
*       /*                                                           */ 01395000
*       /* SET FLAG TO INDICATE THE VOL SER HAS BEEN         @Y30LB35*/ 01396000
*       /* HAS BEEN CHANGED AND MOVE IN NEW VOL SER.         @Y30LB35*/ 01397000
*       /*                                                           */ 01398000
*       /*************************************************************/ 01399000
*                                                                  0670 01400000
*       JFCVSL=ON;                  /*                       @Y30LB35*/ 01401000
         L     @03,JFCBPTR                                         0670 01402000
         OI    JFCVSL(@03),B'01000000'                             0670 01403000
*       JFCAVOLS(1)=VOLLAB;         /*                       @Y30LB35*/ 01404000
         L     @03,JFCBPTR                                         0671 01405000
         L     @15,@PC00001+8                                      0671 01406000
         L     @01,EXOVSN(,@15)                                    0671 01407000
         MVC   JFCAVOLS(6,@03),VOLLAB(@01)                         0671 01408000
*     END;                          /*                       @Y30LB35*/ 01409000
*                                                                  0672 01410000
*   /*****************************************************************/ 01411000
*   /*                                                               */ 01412000
*   /* HERE THE DETERMINATION IS MADE IF USTAE               @Y30LB35*/ 01413000
*   /* SHOULD BE INVOKED TO ESTABLISH A RECOVERY             @Y30LB35*/ 01414000
*   /* ENVIRONMENT OR NOT.                                   @Y30LB35*/ 01415000
*   /*                                                               */ 01416000
*   /*****************************************************************/ 01417000
*                                                                  0673 01418000
*   IF SAHSTA=NULLPTR               /*                       @Y30LB35*/ 01419000
*     THEN                          /*                       @Y30LB35*/ 01420000
@RF00668 L     @03,@PC00001                                        0673 01421000
         L     @03,GDTSAH(,@03)                                    0673 01422000
         L     @03,SAHSTA(,@03)                                    0673 01423000
         LTR   @03,@03                                             0673 01424000
         BNZ   @RF00673                                            0673 01425000
*     DO;                           /*                       @Y30LB35*/ 01426000
*                                                                  0674 01427000
*       /*************************************************************/ 01428000
*       /*                                                           */ 01429000
*       /* SET UP RECOVERY ENVIRONMENT.                      @Y30LB35*/ 01430000
*       /*                                                           */ 01431000
*       /*************************************************************/ 01432000
*                                                                  0675 01433000
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Y30LB35*/ 01434000
         L     @03,@PC00001                                        0675 01435000
         ST    @03,@AL00001                                        0675 01436000
         LA    @03,SET                                             0675 01437000
         ST    @03,@AL00001+4                                      0675 01438000
         MVI   @AL00001+4,X'80'                                    0675 01439000
         L     @03,@PC00001                                        0675 01440000
         L     @15,GDTSTA(,@03)                                    0675 01441000
         LA    @01,@AL00001                                        0675 01442000
         BALR  @14,@15                                             0675 01443000
*       RESPECIFY                                                  0676 01444000
*         RTNREG RSTD;                                             0676 01445000
*       TESTRC=RTNREG;                                             0677 01446000
         STH   RTNREG,TESTRC                                       0677 01447000
*       RESPECIFY                                                  0678 01448000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 01449000
*                                                                  0678 01450000
*       /*************************************************************/ 01451000
*       /*                                                           */ 01452000
*       /* SET CANSTAE ON TO MAKE SURE USTAE IS ISSUED       @Y30LB35*/ 01453000
*       /* ON EXIT.                                          @Y30LB35*/ 01454000
*       /*                                                           */ 01455000
*       /*************************************************************/ 01456000
*                                                                  0679 01457000
*       CANSTAE=ON;                 /*                       @Y30LB35*/ 01458000
         OI    CANSTAE,B'10000000'                                 0679 01459000
*     END;                          /*                       @Y30LB35*/ 01460000
*   ELSE                            /*                       @Y30LB35*/ 01461000
*                                                                  0681 01462000
*     /***************************************************************/ 01463000
*     /*                                                             */ 01464000
*     /* SET CANSTAE OFF TO PREVENT THE USTAE                @Y30LB35*/ 01465000
*     /* CANCELLATION                                        @Y30LB35*/ 01466000
*     /*                                                             */ 01467000
*     /***************************************************************/ 01468000
*                                                                  0681 01469000
*     CANSTAE=OFF;                  /*                       @Y30LB35*/ 01470000
         B     @RC00673                                            0681 01471000
@RF00673 NI    CANSTAE,B'01111111'                                 0681 01472000
*                                                                  0682 01473000
*   /*****************************************************************/ 01474000
*   /*                                                               */ 01475000
*   /* TEST TO DETERMINE IF USTAE WAS SUCCESSFUL             @Y30LB35*/ 01476000
*   /*                                                               */ 01477000
*   /*****************************************************************/ 01478000
*                                                                  0682 01479000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 01480000
*     THEN                          /*                       @Y30LB35*/ 01481000
@RC00673 LH    @03,TESTRC                                          0682 01482000
         LTR   @03,@03                                             0682 01483000
         BNZ   @RF00682                                            0682 01484000
*     DO;                           /*                       @Y30LB35*/ 01485000
*                                                                  0683 01486000
*       /*************************************************************/ 01487000
*       /*                                                           */ 01488000
*       /* THE NECESSARY SET UP IS DONE HERE TO RETRY        @Y30LB35*/ 01489000
*       /* IF THE OPERATOR CANNOT PROVIDE THE PROPER         @Y30LB35*/ 01490000
*       /* PASSWORD.                                         @Y30LB35*/ 01491000
*       /* THE REGISTERS ARE SAVED AND THE STAIO05 FLAG      @Y30LB35*/ 01492000
*       /* IS SET TO INDICATE TO IDCSA10 THAT A RETRY        @Y30LB35*/ 01493000
*       /* IS NEEDED.                                        @Y30LB35*/ 01494000
*       /*                                                           */ 01495000
*       /*************************************************************/ 01496000
*                                                                  0684 01497000
*       RESPECIFY                                                  0684 01498000
*        (REG1,                                                    0684 01499000
*         REG3) RSTD;               /*                       @Y30LB35*/ 01500000
*       REG3=ADDR(SAVEREGS);        /*                       @Y30LB35*/ 01501000
         LA    REG3,SAVEREGS                                       0685 01502000
*       GEN(STM  0,15,0(REG3));     /*                       @Y30LB35*/ 01503000
         STM  0,15,0(REG3)                                              01504000
*       STARTSAV=ADDR(SAVEREGS);    /*                       @Y30LB35*/ 01505000
         L     @15,@PC00001                                        0687 01506000
         L     @15,GDTSAH(,@15)                                    0687 01507000
         L     @15,SAHSTA(,@15)                                    0687 01508000
         LA    @00,SAVEREGS                                        0687 01509000
         ST    @00,STARTSAV(,@15)                                  0687 01510000
*       STAIO05=ON;                 /*                       @Y30LB35*/ 01511000
         L     @15,@PC00001                                        0688 01512000
         L     @15,GDTSAH(,@15)                                    0688 01513000
         L     @15,SAHSTA(,@15)                                    0688 01514000
         OI    STAIO05(@15),B'10000000'                            0688 01515000
*       STARTADD=ADDR(RETRY);       /*                       @Y30LB35*/ 01516000
*                                                                  0689 01517000
         L     @15,@PC00001                                        0689 01518000
         L     @15,GDTSAH(,@15)                                    0689 01519000
         L     @15,SAHSTA(,@15)                                    0689 01520000
         LA    @00,RETRY                                           0689 01521000
         ST    @00,STARTADD(,@15)                                  0689 01522000
*       /*************************************************************/ 01523000
*       /*                                                           */ 01524000
*       /* HERE THE INITIALIZATION FOR THE OPEN IS DONE.     @Y30LB35*/ 01525000
*       /*                                                           */ 01526000
*       /*************************************************************/ 01527000
*                                                                  0690 01528000
*       PARMLIST=''B;               /*                       @Y30LB35*/ 01529000
         XC    PARMLIST(20),PARMLIST                               0690 01530000
*       PARMLIST=OPENLIST;          /*                       @Y30LB35*/ 01531000
         MVI   PARMLIST+8,C' '                                     0691 01532000
         MVC   PARMLIST+9(11),PARMLIST+8                           0691 01533000
         MVC   PARMLIST(8),OPENLIST                                0691 01534000
*       REG3=ADDR(IOXDCB);          /*                       @Y30LB35*/ 01535000
         L     REG3,IOCTLBKP                                       0692 01536000
         LA    REG3,IOXDCB(,REG3)                                  0692 01537000
*       REG1=ADDR(PARMLIST);        /*                       @Y30LB35*/ 01538000
*                                                                  0693 01539000
         LA    REG1,PARMLIST                                       0693 01540000
*       /*************************************************************/ 01541000
*       /*                                                           */ 01542000
*       /* IF CALLER HAS SET EXOREAD THEN HE WANTS TO        @Y30LB35*/ 01543000
*       /* TEST FOR A READ PASSWORD.                         @Y30LB35*/ 01544000
*       /*                                                           */ 01545000
*       /*************************************************************/ 01546000
*                                                                  0694 01547000
*       IF EXOREAD=ON               /*                       @Y30LB35*/ 01548000
*         THEN                      /*                       @Y30LB35*/ 01549000
*                                                                  0694 01550000
         L     @15,@PC00001+8                                      0694 01551000
         TM    EXOREAD(@15),B'10000000'                            0694 01552000
         BNO   @RF00694                                            0694 01553000
*         /***********************************************************/ 01554000
*         /*                                                         */ 01555000
*         /* OPEN FOR INPUT(READ ONLY) IS ISSUED.            @Y30LB35*/ 01556000
*         /* IF A PASSWORD ABEND OCCURS (ABEND 913)          @Y30LB35*/ 01557000
*         /* DURING OPEN THE PROC, RETRY WILL                @Y30LB35*/ 01558000
*         /* BE ENTERED WHICH WILL ISSUE "RETURN TO          @Y30LB35*/ 01559000
*         /* AFTEROPN" WITH A FOUR CODE IN REG15.            @Y30LB35*/ 01560000
*         /*                                                         */ 01561000
*         /***********************************************************/ 01562000
*                                                                  0695 01563000
*LOPEN1:                                                           0695 01564000
*         GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);           0695 01565000
LOPEN1   OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J                       01566000
*       ELSE                        /*                       @Y30LB35*/ 01567000
*                                                                  0696 01568000
*         /***********************************************************/ 01569000
*         /*                                                         */ 01570000
*         /* OPEN FOR OUTPUT(WRITE) IS ISSUED                @Y30LB35*/ 01571000
*         /* TO TEST FOR WRITE PASSWORDS.                    @Y30LB35*/ 01572000
*         /* THE SAME PROCESS WILL OCCUR IF                  @Y30LB35*/ 01573000
*         /* A PASSWORD ABEND OCCURS.                        @Y30LB35*/ 01574000
*         /*                                                         */ 01575000
*         /***********************************************************/ 01576000
*                                                                  0696 01577000
*LOPEN2:                                                           0696 01578000
*         GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);          0696 01579000
         B     @RC00694                                            0696 01580000
@RF00694 DS    0H                                                  0696 01581000
LOPEN2   OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J                      01582000
*       RESPECIFY                                                  0697 01583000
*        (REG1,                                                    0697 01584000
*         REG3) UNRSTD;             /*                       @Y30LB35*/ 01585000
@RC00694 DS    0H                                                  0698 01586000
*       RESPECIFY                                                  0698 01587000
*        (RTNREG) RSTD;             /*                       @Y30LB35*/ 01588000
*       RTNREG=0;                   /*                       @Y30LB35*/ 01589000
         SLR   RTNREG,RTNREG                                       0699 01590000
*       RESPECIFY                                                  0700 01591000
*        (RTNREG) UNRSTD;           /*                       @Y30LB35*/ 01592000
*                                                                  0700 01593000
*       /*************************************************************/ 01594000
*       /*                                                           */ 01595000
*       /* THE LABEL AFTEROPN WILL BE RETURNED TO IF         @Y30LB35*/ 01596000
*       /* THE PROC RETRY IS ENTERED. THIS WILL ALLOW        @Y30LB35*/ 01597000
*       /* FOR AN ORDERLY EXIT CONSISTENT WITH STRUCTURED            */ 01598000
*       /* PROGRAMMING.                                      @Y30LB35*/ 01599000
*       /*                                                           */ 01600000
*       /*************************************************************/ 01601000
*                                                                  0701 01602000
*AFTEROPN:                          /*                       @Y30LB35*/ 01603000
*       RESPECIFY                                                  0701 01604000
*         RTNREG RSTD;                                             0701 01605000
AFTEROPN DS    0H                                                  0702 01606000
*       TESTRC=RTNREG;                                             0702 01607000
         STH   RTNREG,TESTRC                                       0702 01608000
*       RESPECIFY                                                  0703 01609000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 01610000
*     END;                          /*                       @Y30LB35*/ 01611000
*                                                                  0705 01612000
*   /*****************************************************************/ 01613000
*   /*                                                               */ 01614000
*   /* PROVIDING THE ABEND 913 DID NOT OCCUR                 @Y30LB35*/ 01615000
*   /* ADDITIONAL PROCESSING CAN TAKE PLACE.                 @Y30LB35*/ 01616000
*   /*                                                               */ 01617000
*   /*****************************************************************/ 01618000
*                                                                  0705 01619000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 01620000
*     THEN                          /*                       @Y30LB35*/ 01621000
@RF00682 LH    @03,TESTRC                                          0705 01622000
         LTR   @03,@03                                             0705 01623000
         BNZ   @RF00705                                            0705 01624000
*     DO;                           /*                       @Y30LB35*/ 01625000
*                                                                  0706 01626000
*       /*************************************************************/ 01627000
*       /*                                                           */ 01628000
*       /* BEFORE ANY FURTHER PROCESSING THE                 @Y30LB35*/ 01629000
*       /* DCBOFLWR WILL BE TURNED OFF TO PREVENT CLOSE      @Y30LB35*/ 01630000
*       /* FROM WRITING AND END-OF-FILE MARK.                @Y30LB35*/ 01631000
*       /*                                                           */ 01632000
*       /*************************************************************/ 01633000
*                                                                  0707 01634000
*       DCBOFLWR=OFF;               /*                       @Y30LB35*/ 01635000
*                                                                  0707 01636000
         L     @03,DCBPTR                                          0707 01637000
         NI    DCBOFLWR+40(@03),B'01111111'                        0707 01638000
*       /*************************************************************/ 01639000
*       /*                                                           */ 01640000
*       /* CHECKOPN WILL BE CALLED TO DETERMINE IF           @Y30LB35*/ 01641000
*       /* DCBOFLGS WAS SET INDICATING THAT THE OPEN         @Y30LB35*/ 01642000
*       /* WAS PERFORMED OR THAT OUR DCB ABEND EXIT          @Y30LB35*/ 01643000
*       /* WAS NOT ENTERED.                                  @Y30LB35*/ 01644000
*       /*                                                           */ 01645000
*       /*************************************************************/ 01646000
*                                                                  0708 01647000
*       CALL CHECKOPN;              /*                       @Y30LB35*/ 01648000
         BAL   @14,CHECKOPN                                        0708 01649000
*       RESPECIFY                                                  0709 01650000
*         RTNREG RSTD;                                             0709 01651000
*       TESTRC=RTNREG;                                             0710 01652000
         STH   RTNREG,TESTRC                                       0710 01653000
*       RESPECIFY                                                  0711 01654000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 01655000
*     END;                          /*                       @Y30LB35*/ 01656000
*                                                                  0713 01657000
*   /*****************************************************************/ 01658000
*   /*                                                               */ 01659000
*   /* PROVIDING THE RECOVERY ENVIRONMENT WAS                @Y30LB35*/ 01660000
*   /* ESTABLISHED, IT NOW CAN BE REMOVED.                   @Y30LB35*/ 01661000
*   /*                                                               */ 01662000
*   /*****************************************************************/ 01663000
*                                                                  0713 01664000
*   IF CANSTAE=ON                   /*                       @Y30LB35*/ 01665000
*     THEN                          /*                       @Y30LB35*/ 01666000
*                                                                  0713 01667000
@RF00705 TM    CANSTAE,B'10000000'                                 0713 01668000
         BNO   @RF00713                                            0713 01669000
*     /***************************************************************/ 01670000
*     /*                                                             */ 01671000
*     /* THE USTAE IS ISSUED TO CANCEL THE RECOVERY          @Y30LB35*/ 01672000
*     /*                                                             */ 01673000
*     /***************************************************************/ 01674000
*                                                                  0714 01675000
*     CALL IDCSAST0(GDTTBL,CANCEL); /*                       @Y30LB35*/ 01676000
         L     @03,@PC00001                                        0714 01677000
         ST    @03,@AL00001                                        0714 01678000
         LA    @03,CANCEL                                          0714 01679000
         ST    @03,@AL00001+4                                      0714 01680000
         MVI   @AL00001+4,X'80'                                    0714 01681000
         L     @03,@PC00001                                        0714 01682000
         L     @15,GDTSTA(,@03)                                    0714 01683000
         LA    @01,@AL00001                                        0714 01684000
         BALR  @14,@15                                             0714 01685000
*   ELSE                            /*                       @Y30LB35*/ 01686000
*     IF STAOFF=ON                  /*                       @Y30LB35*/ 01687000
*       THEN                        /*                       @Y30LB35*/ 01688000
*                                                                  0715 01689000
         B     @RC00713                                            0715 01690000
@RF00713 L     @03,@PC00001                                        0715 01691000
         L     @03,GDTSAH(,@03)                                    0715 01692000
         L     @03,SAHSTA(,@03)                                    0715 01693000
         TM    STAOFF(@03),B'01000000'                             0715 01694000
         BNO   @RF00715                                            0715 01695000
*       /*************************************************************/ 01696000
*       /*                                                           */ 01697000
*       /* THE USTAE IS ISSUED TO REESTABLISH RECOVERY       @Y30LB35*/ 01698000
*       /*                                                           */ 01699000
*       /*************************************************************/ 01700000
*                                                                  0716 01701000
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Y30LB35*/ 01702000
*                                                                  0716 01703000
         L     @03,@PC00001                                        0716 01704000
         ST    @03,@AL00001                                        0716 01705000
         LA    @03,SET                                             0716 01706000
         ST    @03,@AL00001+4                                      0716 01707000
         MVI   @AL00001+4,X'80'                                    0716 01708000
         L     @03,@PC00001                                        0716 01709000
         L     @15,GDTSTA(,@03)                                    0716 01710000
         LA    @01,@AL00001                                        0716 01711000
         BALR  @14,@15                                             0716 01712000
*   /*****************************************************************/ 01713000
*   /*                                                               */ 01714000
*   /* HERE THE CONTROL IS RETURNED TO OPENPROC              @Y30LB35*/ 01715000
*   /* WITH A CODE 4 OR 0 IN REGISTER 15.                    @Y30LB35*/ 01716000
*   /*                                                               */ 01717000
*   /*****************************************************************/ 01718000
*                                                                  0717 01719000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 01720000
@RF00715 DS    0H                                                  0717 01721000
@RC00713 LH    @15,TESTRC                                          0717 01722000
         L     @14,@SA00005                                        0717 01723000
         LM    @00,@12,@SA00005+8                                  0717 01724000
         BR    @14                                                 0717 01725000
*   END OPNPASS;                    /*                       @Y30LB35*/ 01726000
*                                                                  0719 01727000
*/********************************************************************/ 01728000
*/*                                                          @Z40LB35*/ 01729000
*/* PROCEDURE NAME - OPNVTOC                                 @Z40LB35*/ 01730000
*/*                                                          @Z40LB35*/ 01731000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO OPEN THE @Z40LB35*/ 01732000
*/*             VOLUME VTOC FOR PROCESSING OF THE DSCBS. THE @Z40LB35*/ 01733000
*/*             STEPS USED TO DETERMINE THIS IS:             @Z40LB35*/ 01734000
*/*             ISSUES USTAE, SAVES REGISTERS FOR OPEN       @Z40LB35*/ 01735000
*/*             ABEND, ISSUE OPEN TYPE=J, AND ISSUES USTAE.  @Z40LB35*/ 01736000
*/*                                                          @Z40LB35*/ 01737000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Z40LB35*/ 01738000
*/*                                                          @Z40LB35*/ 01739000
*/* INPUT -     EXOVSN FROM EXOAGL                           @Z40LB35*/ 01740000
*/*             EXOREAD FROM EXOAGL                          @Z40LB35*/ 01741000
*/*             IOXDCB FROM IOXCTLBK                         @Z40LB35*/ 01742000
*/*             SAHSTA FROM HISTORICAL DATA AREA             @Z40LB35*/ 01743000
*/*             OPENLIST                                     @Z40LB35*/ 01744000
*/*                                                          @Z40LB35*/ 01745000
*/* OUTPUT -    JFCBDSNM IN IOXJFCB                          @Z40LB35*/ 01746000
*/*             JFCVSL IN IOXJFCB                            @Z40LB35*/ 01747000
*/*             JFCAVOLS(1) IN IOXJFCB                       @Z40LB35*/ 01748000
*/*             JFCNWRIT IN IOXJFCB                          @ZM01114*/ 01749000
*/*             STAVTOC IN STAEPARM                          @Z40LB35*/ 01750000
*/*             STARTSAV IN STAEPRAM                         @Z40LB35*/ 01751000
*/*             DCBOFLWR IN IOXDCB                           @Z40LB35*/ 01752000
*/*             PARMLIST                                     @Z40LB35*/ 01753000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 01754000
*/*                           4, ERROR ABEND IN OPEN         @Z40LB35*/ 01755000
*/*                           4, ERROR CHECKOPN              @Z40LB35*/ 01756000
*/*                           4, ERROR IN USTAE              @Z40LB35*/ 01757000
*/*                                                          @Z40LB35*/ 01758000
*/********************************************************************/ 01759000
*                                                                  0719 01760000
*                                   /*                       @Z40LB35*/ 01761000
*OPNVTOC:                                                          0719 01762000
*   PROC;                           /*                       @Z40LB35*/ 01763000
*                                                                  0719 01764000
OPNVTOC  STM   @14,@12,@SA00006                                    0719 01765000
*   /*****************************************************************/ 01766000
*   /*                                                               */ 01767000
*   /* LOCAL DECLARES                                        @Z40LB35*/ 01768000
*   /*                                                               */ 01769000
*   /*****************************************************************/ 01770000
*                                                                  0720 01771000
*                                                                  0720 01772000
*   /*****************************************************************/ 01773000
*   /*                                                               */ 01774000
*   /* SET UP TRACE POINT 'IOOV' IN TRACE TABLE              @Z40LB35*/ 01775000
*   /*                                                               */ 01776000
*   /*****************************************************************/ 01777000
*                                                                  0720 01778000
*   OLDERID2=NEWERID2;                                             0720 01779000
         L     @03,@PC00001                                        0720 01780000
         L     @03,GDTTR2(,@03)                                    0720 01781000
         L     @15,@PC00001                                        0720 01782000
         L     @01,GDTTR2(,@15)                                    0720 01783000
         MVC   @TS00001(95),NEWERID2(@01)                          0720 01784000
         MVC   OLDERID2(95,@03),@TS00001                           0720 01785000
*   NEWID2='IOOV';                  /*                       @Z40LB35*/ 01786000
*                                                                  0721 01787000
         L     @03,@PC00001                                        0721 01788000
         L     @03,GDTTR2(,@03)                                    0721 01789000
         MVC   NEWID2(4,@03),@CC04162                              0721 01790000
*   /*****************************************************************/ 01791000
*   /*                                                               */ 01792000
*   /* INHIBIT PERM JFCB UPDATE DURING OPENJ                 @ZM01114*/ 01793000
*   /*                                                               */ 01794000
*   /*****************************************************************/ 01795000
*                                                                  0722 01796000
*   JFCNWRIT=ON;                    /*                       @ZM01114*/ 01797000
*                                                                  0722 01798000
         L     @03,JFCBPTR                                         0722 01799000
         OI    JFCNWRIT(@03),B'00001000'                           0722 01800000
*   /*****************************************************************/ 01801000
*   /*                                                               */ 01802000
*   /* SET THE VTOC DSN IN THE JFCB - X'04'S                 @Z40LB35*/ 01803000
*   /*                                                               */ 01804000
*   /*****************************************************************/ 01805000
*                                                                  0723 01806000
*   JFCBDSNM=VTOCDSN;               /*                       @Z40LB35*/ 01807000
*                                                                  0723 01808000
         L     @03,JFCBPTR                                         0723 01809000
         MVC   JFCBDSNM(44,@03),VTOCDSN                            0723 01810000
*   /*****************************************************************/ 01811000
*   /*                                                               */ 01812000
*   /* A TEST IS MADE TO SEE IF CALLER WANTS                 @Z40LB35*/ 01813000
*   /* TO UPDATE THE VOL SER IN THE JFCB.                    @Z40LB35*/ 01814000
*   /*                                                               */ 01815000
*   /*****************************************************************/ 01816000
*                                                                  0724 01817000
*   IF EXOVSN^=NULLPTR              /*                       @Z40LB35*/ 01818000
*     THEN                          /*                       @Z40LB35*/ 01819000
         L     @03,@PC00001+8                                      0724 01820000
         L     @03,EXOVSN(,@03)                                    0724 01821000
         LTR   @03,@03                                             0724 01822000
         BZ    @RF00724                                            0724 01823000
*     DO;                           /*                       @Z40LB35*/ 01824000
*                                                                  0725 01825000
*       /*************************************************************/ 01826000
*       /*                                                           */ 01827000
*       /* SET FLAG TO INDICATE THE VOL SER                  @Z40LB35*/ 01828000
*       /* HAS BEEN CHANGED AND MOVE IN NEW VOL SER.         @Z40LB35*/ 01829000
*       /*                                                           */ 01830000
*       /*************************************************************/ 01831000
*                                                                  0726 01832000
*       JFCVSL=ON;                  /*                       @Z40LB35*/ 01833000
         L     @03,JFCBPTR                                         0726 01834000
         OI    JFCVSL(@03),B'01000000'                             0726 01835000
*       JFCAVOLS(1)=VOLLAB;         /*                       @Z40LB35*/ 01836000
         L     @03,JFCBPTR                                         0727 01837000
         L     @15,@PC00001+8                                      0727 01838000
         L     @01,EXOVSN(,@15)                                    0727 01839000
         MVC   JFCAVOLS(6,@03),VOLLAB(@01)                         0727 01840000
*     END;                          /*                       @Z40LB35*/ 01841000
*                                                                  0728 01842000
*   /*****************************************************************/ 01843000
*   /*                                                               */ 01844000
*   /* HERE THE DETERMINATION IS MADE IF USTAE               @Z40LB35*/ 01845000
*   /* SHOULD BE INVOKED TO ESTABLISH A RECOVERY             @Z40LB35*/ 01846000
*   /* ENVIRONMENT OR NOT.                                   @Z40LB35*/ 01847000
*   /*                                                               */ 01848000
*   /*****************************************************************/ 01849000
*                                                                  0729 01850000
*   IF SAHSTA=NULLPTR               /*                       @Z40LB35*/ 01851000
*     THEN                          /*                       @Z40LB35*/ 01852000
@RF00724 L     @03,@PC00001                                        0729 01853000
         L     @03,GDTSAH(,@03)                                    0729 01854000
         L     @03,SAHSTA(,@03)                                    0729 01855000
         LTR   @03,@03                                             0729 01856000
         BNZ   @RF00729                                            0729 01857000
*     DO;                           /*                       @Z40LB35*/ 01858000
*                                                                  0730 01859000
*       /*************************************************************/ 01860000
*       /*                                                           */ 01861000
*       /* SET UP RECOVERY ENVIRONMENT.                      @Z40LB35*/ 01862000
*       /*                                                           */ 01863000
*       /*************************************************************/ 01864000
*                                                                  0731 01865000
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Z40LB35*/ 01866000
         L     @03,@PC00001                                        0731 01867000
         ST    @03,@AL00001                                        0731 01868000
         LA    @03,SET                                             0731 01869000
         ST    @03,@AL00001+4                                      0731 01870000
         MVI   @AL00001+4,X'80'                                    0731 01871000
         L     @03,@PC00001                                        0731 01872000
         L     @15,GDTSTA(,@03)                                    0731 01873000
         LA    @01,@AL00001                                        0731 01874000
         BALR  @14,@15                                             0731 01875000
*       RESPECIFY                                                  0732 01876000
*         RTNREG RSTD;                                             0732 01877000
*       TESTRC=RTNREG;                                             0733 01878000
         STH   RTNREG,TESTRC                                       0733 01879000
*       RESPECIFY                                                  0734 01880000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 01881000
*                                                                  0734 01882000
*       /*************************************************************/ 01883000
*       /*                                                           */ 01884000
*       /* SET CANSTAE ON TO MAKE SURE USTAE IS ISSUED       @Z40LB35*/ 01885000
*       /* ON EXIT.                                          @Z40LB35*/ 01886000
*       /*                                                           */ 01887000
*       /*************************************************************/ 01888000
*                                                                  0735 01889000
*       CANSTAE=ON;                 /*                       @Z40LB35*/ 01890000
         OI    CANSTAE,B'10000000'                                 0735 01891000
*     END;                          /*                       @Z40LB35*/ 01892000
*   ELSE                            /*                       @Z40LB35*/ 01893000
*                                                                  0737 01894000
*     /***************************************************************/ 01895000
*     /*                                                             */ 01896000
*     /* SET CANSTAE OFF TO PREVENT THE USTAE                @Z40LB35*/ 01897000
*     /* CANCELLATION                                        @Z40LB35*/ 01898000
*     /*                                                             */ 01899000
*     /***************************************************************/ 01900000
*                                                                  0737 01901000
*     CANSTAE=OFF;                  /*                       @Z40LB35*/ 01902000
         B     @RC00729                                            0737 01903000
@RF00729 NI    CANSTAE,B'01111111'                                 0737 01904000
*                                                                  0738 01905000
*   /*****************************************************************/ 01906000
*   /*                                                               */ 01907000
*   /* TEST TO DETERMINE IF USTAE WAS SUCCESSFUL             @Z40LB35*/ 01908000
*   /*                                                               */ 01909000
*   /*****************************************************************/ 01910000
*                                                                  0738 01911000
*   IF TESTRC=0                     /*                       @Z40LB35*/ 01912000
*     THEN                          /*                       @Z40LB35*/ 01913000
@RC00729 LH    @03,TESTRC                                          0738 01914000
         LTR   @03,@03                                             0738 01915000
         BNZ   @RF00738                                            0738 01916000
*     DO;                           /*                       @Z40LB35*/ 01917000
*                                                                  0739 01918000
*       /*************************************************************/ 01919000
*       /*                                                           */ 01920000
*       /* THE NECESSARY SET UP IS DONE HERE TO RETRY        @Z40LB35*/ 01921000
*       /* IF AN ABEND OCCURS DURING THE OPENING OF VTOC     @Z40LB35*/ 01922000
*       /* THE REGISTERS ARE SAVED AND THE STAVTOC FLAG      @Z40LB35*/ 01923000
*       /* IS SET TO INDICATE TO IDCSA10 THAT A RETRY        @Z40LB35*/ 01924000
*       /* IS NEEDED.                                        @Z40LB35*/ 01925000
*       /*                                                           */ 01926000
*       /*************************************************************/ 01927000
*                                                                  0740 01928000
*       RESPECIFY                                                  0740 01929000
*        (REG1,                                                    0740 01930000
*         REG3) RSTD;               /*                       @Z40LB35*/ 01931000
*       REG3=ADDR(SAVEREGS);        /*                       @Z40LB35*/ 01932000
         LA    REG3,SAVEREGS                                       0741 01933000
*       GEN(STM  0,15,0(REG3));     /*                       @Z40LB35*/ 01934000
         STM  0,15,0(REG3)                                              01935000
*       STARTSAV=ADDR(SAVEREGS);    /*                       @Z40LB35*/ 01936000
         L     @15,@PC00001                                        0743 01937000
         L     @15,GDTSAH(,@15)                                    0743 01938000
         L     @15,SAHSTA(,@15)                                    0743 01939000
         LA    @00,SAVEREGS                                        0743 01940000
         ST    @00,STARTSAV(,@15)                                  0743 01941000
*       STAVTOC=ON;                 /*                       @Z40LB35*/ 01942000
         L     @15,@PC00001                                        0744 01943000
         L     @15,GDTSAH(,@15)                                    0744 01944000
         L     @15,SAHSTA(,@15)                                    0744 01945000
         OI    STAVTOC(@15),B'00100000'                            0744 01946000
*       STARTADD=ADDR(RETRY);       /*                       @Z40LB35*/ 01947000
*                                                                  0745 01948000
         L     @15,@PC00001                                        0745 01949000
         L     @15,GDTSAH(,@15)                                    0745 01950000
         L     @15,SAHSTA(,@15)                                    0745 01951000
         LA    @00,RETRY                                           0745 01952000
         ST    @00,STARTADD(,@15)                                  0745 01953000
*       /*************************************************************/ 01954000
*       /*                                                           */ 01955000
*       /* HERE THE INITIALIZATION FOR THE OPEN IS DONE.     @Z40LB35*/ 01956000
*       /*                                                           */ 01957000
*       /*************************************************************/ 01958000
*                                                                  0746 01959000
*       PARMLIST=''B;               /*                       @Z40LB35*/ 01960000
         XC    PARMLIST(20),PARMLIST                               0746 01961000
*       PARMLIST=OPENLIST;          /*                       @Z40LB35*/ 01962000
         MVI   PARMLIST+8,C' '                                     0747 01963000
         MVC   PARMLIST+9(11),PARMLIST+8                           0747 01964000
         MVC   PARMLIST(8),OPENLIST                                0747 01965000
*       REG3=ADDR(IOXDCB);          /*                       @Z40LB35*/ 01966000
         L     REG3,IOCTLBKP                                       0748 01967000
         LA    REG3,IOXDCB(,REG3)                                  0748 01968000
*       REG1=ADDR(PARMLIST);        /*                       @Z40LB35*/ 01969000
*                                                                  0749 01970000
         LA    REG1,PARMLIST                                       0749 01971000
*       /*************************************************************/ 01972000
*       /*                                                           */ 01973000
*       /* IF CALLER HAS SET EXOREAD THEN HE WANTS TO        @Z40LB35*/ 01974000
*       /* OPEN FOR A READ ONLY.                             @Z40LB35*/ 01975000
*       /*                                                           */ 01976000
*       /*************************************************************/ 01977000
*                                                                  0750 01978000
*       IF EXOREAD=ON               /*                       @Z40LB35*/ 01979000
*         THEN                      /*                       @Z40LB35*/ 01980000
*                                                                  0750 01981000
         L     @15,@PC00001+8                                      0750 01982000
         TM    EXOREAD(@15),B'10000000'                            0750 01983000
         BNO   @RF00750                                            0750 01984000
*         /***********************************************************/ 01985000
*         /*                                                         */ 01986000
*         /* OPEN FOR INPUT(READ ONLY) IS ISSUED.            @Z40LB35*/ 01987000
*         /* IF AN ABEND OCCURS                              @Z40LB35*/ 01988000
*         /* DURING OPEN, THE PROC RETRY WILL                @Z40LB35*/ 01989000
*         /* BE ENTERED WHICH WILL ISSUE "RETURN TO          @Z40LB35*/ 01990000
*         /* AFTEROP2" WITH A FOUR CODE IN REG15.            @Z40LB35*/ 01991000
*         /*                                                         */ 01992000
*         /***********************************************************/ 01993000
*                                                                  0751 01994000
*LOPEN7:                                                           0751 01995000
*         GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);           0751 01996000
LOPEN7   OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J                       01997000
*       ELSE                        /*                       @Z40LB35*/ 01998000
*                                                                  0752 01999000
*         /***********************************************************/ 02000000
*         /*                                                         */ 02001000
*         /* OPEN FOR OUTPUT(WRITE) IS ISSUED.               @Z40LB35*/ 02002000
*         /*                                                         */ 02003000
*         /***********************************************************/ 02004000
*                                                                  0752 02005000
*LOPEN8:                                                           0752 02006000
*         GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);          0752 02007000
         B     @RC00750                                            0752 02008000
@RF00750 DS    0H                                                  0752 02009000
LOPEN8   OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J                      02010000
*       RESPECIFY                                                  0753 02011000
*        (REG1,                                                    0753 02012000
*         REG3) UNRSTD;             /*                       @Z40LB35*/ 02013000
@RC00750 DS    0H                                                  0754 02014000
*       RESPECIFY                                                  0754 02015000
*        (RTNREG) RSTD;             /*                       @Z40LB35*/ 02016000
*       RTNREG=0;                   /*                       @Z40LB35*/ 02017000
         SLR   RTNREG,RTNREG                                       0755 02018000
*       RESPECIFY                                                  0756 02019000
*        (RTNREG) UNRSTD;           /*                       @Z40LB35*/ 02020000
*                                                                  0756 02021000
*       /*************************************************************/ 02022000
*       /*                                                           */ 02023000
*       /* THE LABEL AFTEROP2 WILL BE RETURNED TO IF         @Z40LB35*/ 02024000
*       /* THE PROC RETRY IS ENTERED. THIS WILL ALLOW        @Z40LB35*/ 02025000
*       /* FOR AN ORDERLY EXIT CONSISTENT WITH STRUCTURED            */ 02026000
*       /* PROGRAMMING.                                      @Z40LB35*/ 02027000
*       /*                                                           */ 02028000
*       /*************************************************************/ 02029000
*                                                                  0757 02030000
*AFTEROP2:                          /*                       @Z40LB35*/ 02031000
*       RESPECIFY                                                  0757 02032000
*         RTNREG RSTD;                                             0757 02033000
AFTEROP2 DS    0H                                                  0758 02034000
*       TESTRC=RTNREG;                                             0758 02035000
         STH   RTNREG,TESTRC                                       0758 02036000
*       RESPECIFY                                                  0759 02037000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02038000
*     END;                          /*                       @Z40LB35*/ 02039000
*                                                                  0761 02040000
*   /*****************************************************************/ 02041000
*   /*                                                               */ 02042000
*   /* PROVIDING AN ABEND DID NOT OCCUR                      @Z40LB35*/ 02043000
*   /* ADDITIONAL PROCESSING CAN TAKE PLACE.                 @Z40LB35*/ 02044000
*   /*                                                               */ 02045000
*   /*****************************************************************/ 02046000
*                                                                  0761 02047000
*   IF TESTRC=0                     /*                       @Z40LB35*/ 02048000
*     THEN                          /*                       @Z40LB35*/ 02049000
@RF00738 LH    @03,TESTRC                                          0761 02050000
         LTR   @03,@03                                             0761 02051000
         BNZ   @RF00761                                            0761 02052000
*     DO;                           /*                       @Z40LB35*/ 02053000
*                                                                  0762 02054000
*       /*************************************************************/ 02055000
*       /*                                                           */ 02056000
*       /* CHECKOPN WILL BE CALLED TO DETERMINE IF           @Z40LB35*/ 02057000
*       /* DCBOFLGS WAS SET INDICATING THAT THE OPEN         @Z40LB35*/ 02058000
*       /* WAS PERFORMED OR THAT OUR DCB ABEND EXIT          @Z40LB35*/ 02059000
*       /* WAS NOT ENTERED.                                  @Z40LB35*/ 02060000
*       /*                                                           */ 02061000
*       /*************************************************************/ 02062000
*                                                                  0763 02063000
*       CALL CHECKOPN;              /*                       @Z40LB35*/ 02064000
         BAL   @14,CHECKOPN                                        0763 02065000
*       RESPECIFY                                                  0764 02066000
*         RTNREG RSTD;                                             0764 02067000
*       TESTRC=RTNREG;                                             0765 02068000
         STH   RTNREG,TESTRC                                       0765 02069000
*       RESPECIFY                                                  0766 02070000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02071000
*                                                                  0766 02072000
*       /*************************************************************/ 02073000
*       /*                                                           */ 02074000
*       /* BEFORE ANY FURTHER PROCESSING THE                 @Z40LB35*/ 02075000
*       /* DCBOFLWR WILL BE TURNED OFF TO PREVENT CLOSE      @Z40LB35*/ 02076000
*       /* FROM WRITING AND END-OF-FILE MARK.                @Z40LB35*/ 02077000
*       /*                                                           */ 02078000
*       /*************************************************************/ 02079000
*                                                                  0767 02080000
*       DCBOFLWR=OFF;               /*                       @Z40LB35*/ 02081000
         L     @03,DCBPTR                                          0767 02082000
         NI    DCBOFLWR+40(@03),B'01111111'                        0767 02083000
*       IF TESTRC=0 THEN            /*                       @Z40LB35*/ 02084000
         LH    @03,TESTRC                                          0768 02085000
         LTR   @03,@03                                             0768 02086000
         BNZ   @RF00768                                            0768 02087000
*         DO;                       /*                       @Z40LB35*/ 02088000
*                                                                  0769 02089000
*           /*********************************************************/ 02090000
*           /*                                                       */ 02091000
*           /* HERE THE STEPS ARE TAKEN TO RETURN THE        @Z40LB35*/ 02092000
*           /* DATA SET EXTENTS TO THE CALLER.               @Z40LB35*/ 02093000
*           /* ADDRESSABILITY IS SET UP TO THE DEB           @Z40LB35*/ 02094000
*           /* AND THE BEGINNING AND ENDING CCHH'S           @Z40LB35*/ 02095000
*           /* ARE RETURNED.                                 @Z40LB35*/ 02096000
*           /*                                                       */ 02097000
*           /*********************************************************/ 02098000
*                                                                  0770 02099000
*           DEBPTR=DCBDEBAD;        /*                       @Z40LB35*/ 02100000
         L     @03,DCBPTR                                          0770 02101000
         L     @03,DCBDEBAD+40(,@03)                               0770 02102000
         ST    @03,DEBPTR                                          0770 02103000
*           RTNEXTS=''B;            /*                       @Z40LB35*/ 02104000
         L     @03,@PC00001+8                                      0771 02105000
         L     @03,EXOEXT(,@03)                                    0771 02106000
         XC    RTNEXTS(10,@03),RTNEXTS(@03)                        0771 02107000
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              0772 02108000
         LA    @03,32                                              0772 02109000
         AL    @03,DEBPTR                                          0772 02110000
         ST    @03,DEBDAPTR                                        0772 02111000
*           BEGCC=DEBSTRCC;         /*                       @Z40LB35*/ 02112000
         L     @03,@PC00001+8                                      0773 02113000
         L     @03,EXOEXT(,@03)                                    0773 02114000
         L     @01,DEBDAPTR                                        0773 02115000
         MVC   BEGCC(2,@03),DEBSTRCC(@01)                          0773 02116000
*           BEGHH=DEBSTRHH;         /*                       @Z40LB35*/ 02117000
         L     @03,@PC00001+8                                      0774 02118000
         L     @03,EXOEXT(,@03)                                    0774 02119000
         L     @01,DEBDAPTR                                        0774 02120000
         MVC   BEGHH(2,@03),DEBSTRHH(@01)                          0774 02121000
*           ENDCC=DEBENDCC;         /*                       @Z40LB35*/ 02122000
         L     @03,@PC00001+8                                      0775 02123000
         L     @03,EXOEXT(,@03)                                    0775 02124000
         L     @01,DEBDAPTR                                        0775 02125000
         MVC   ENDCC(2,@03),DEBENDCC(@01)                          0775 02126000
*           ENDHH=DEBENDHH;         /*                       @Z40LB35*/ 02127000
         L     @03,@PC00001+8                                      0776 02128000
         L     @03,EXOEXT(,@03)                                    0776 02129000
         L     @01,DEBDAPTR                                        0776 02130000
         MVC   ENDHH(2,@03),DEBENDHH(@01)                          0776 02131000
*         END;                      /*                       @Z40LB35*/ 02132000
*     END;                          /*                       @Z40LB35*/ 02133000
@RF00768 DS    0H                                                  0779 02134000
*                                                                  0779 02135000
*   /*****************************************************************/ 02136000
*   /*                                                               */ 02137000
*   /* PROVIDING THE RECOVERY ENVIRONMENT WAS                @Z40LB35*/ 02138000
*   /* ESTABLISHED, IT NOW CAN BE REMOVED.                   @Z40LB35*/ 02139000
*   /*                                                               */ 02140000
*   /*****************************************************************/ 02141000
*                                                                  0779 02142000
*   IF CANSTAE=ON                   /*                       @Z40LB35*/ 02143000
*     THEN                          /*                       @Z40LB35*/ 02144000
*                                                                  0779 02145000
@RF00761 TM    CANSTAE,B'10000000'                                 0779 02146000
         BNO   @RF00779                                            0779 02147000
*     /***************************************************************/ 02148000
*     /*                                                             */ 02149000
*     /* THE USTAE IS ISSUED TO CANCEL THE RECOVERY          @Z40LB35*/ 02150000
*     /*                                                             */ 02151000
*     /***************************************************************/ 02152000
*                                                                  0780 02153000
*     CALL IDCSAST0(GDTTBL,CANCEL); /*                       @Z40LB35*/ 02154000
         L     @03,@PC00001                                        0780 02155000
         ST    @03,@AL00001                                        0780 02156000
         LA    @03,CANCEL                                          0780 02157000
         ST    @03,@AL00001+4                                      0780 02158000
         MVI   @AL00001+4,X'80'                                    0780 02159000
         L     @03,@PC00001                                        0780 02160000
         L     @15,GDTSTA(,@03)                                    0780 02161000
         LA    @01,@AL00001                                        0780 02162000
         BALR  @14,@15                                             0780 02163000
*   ELSE                            /*                       @Z40LB35*/ 02164000
*     IF STAOFF=ON                  /*                       @Z40LB35*/ 02165000
*       THEN                        /*                       @Z40LB35*/ 02166000
*                                                                  0781 02167000
         B     @RC00779                                            0781 02168000
@RF00779 L     @03,@PC00001                                        0781 02169000
         L     @03,GDTSAH(,@03)                                    0781 02170000
         L     @03,SAHSTA(,@03)                                    0781 02171000
         TM    STAOFF(@03),B'01000000'                             0781 02172000
         BNO   @RF00781                                            0781 02173000
*       /*************************************************************/ 02174000
*       /*                                                           */ 02175000
*       /* THE USTAE IS ISSUED TO REESTABLISH RECOVERY       @Z40LB35*/ 02176000
*       /*                                                           */ 02177000
*       /*************************************************************/ 02178000
*                                                                  0782 02179000
*       CALL IDCSAST0(GDTTBL,SET);  /*                       @Z40LB35*/ 02180000
*                                                                  0782 02181000
         L     @03,@PC00001                                        0782 02182000
         ST    @03,@AL00001                                        0782 02183000
         LA    @03,SET                                             0782 02184000
         ST    @03,@AL00001+4                                      0782 02185000
         MVI   @AL00001+4,X'80'                                    0782 02186000
         L     @03,@PC00001                                        0782 02187000
         L     @15,GDTSTA(,@03)                                    0782 02188000
         LA    @01,@AL00001                                        0782 02189000
         BALR  @14,@15                                             0782 02190000
*   /*****************************************************************/ 02191000
*   /*                                                               */ 02192000
*   /* HERE THE CONTROL IS RETURNED TO OPENPROC              @Z40LB35*/ 02193000
*   /* WITH A CODE 4 OR 0 IN REGISTER 15.                    @Z40LB35*/ 02194000
*   /*                                                               */ 02195000
*   /*****************************************************************/ 02196000
*                                                                  0783 02197000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 02198000
@RF00781 DS    0H                                                  0783 02199000
@RC00779 LH    @15,TESTRC                                          0783 02200000
         L     @14,@SA00006                                        0783 02201000
         LM    @00,@12,@SA00006+8                                  0783 02202000
         BR    @14                                                 0783 02203000
*   END OPNVTOC;                    /*                       @Z40LB35*/ 02204000
*                                                                  0785 02205000
*/********************************************************************/ 02206000
*/*                                                          #Y30LB35*/ 02207000
*/* PROCEDURE NAME - OPNTAB                                  #Y30LB35*/ 02208000
*/*                                                          #Y30LB35*/ 02209000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO OPEN THE #Y30LB35*/ 02210000
*/*             THE DATA SET CONTAINING THE MSS HARDWARE     #Y30LB35*/ 02211000
*/*             TABLES. THE STEPS USED TO DETERMINE THIS ARE:#Y30LB35*/ 02212000
*/*             ISSUES OPEN, CALLS CHECKOPN AND RETURNS      #Y30LB35*/ 02213000
*/*             DEB EXTENTS.                                 #Y30LB35*/ 02214000
*/*                                                          #Y30LB35*/ 02215000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    #Y30LB35*/ 02216000
*/*                                                          #Y30LB35*/ 02217000
*/* INPUT -     EXOREAD  IN EXOAGL                           #Y30LB35*/ 02218000
*/*             DCBDEBAD IN IOXDCB                           #Y30LB35*/ 02219000
*/*             DEBSTRCC IN DEBBASIC                         #Y30LB35*/ 02220000
*/*             DEBSTRHH IN DEBBASIC                         @Y30LB35*/ 02221000
*/*             DEBENDCC IN DEBBASIC                         @Y30LB35*/ 02222000
*/*             DEBENDHH IN DEBBASIC                         @Y30LB35*/ 02223000
*/*                                                          @Y30LB35*/ 02224000
*/* OUTPUT -    DCBOFLWR IN IOXDCB                           @Y30LB35*/ 02225000
*/*             BEGCC IN CALLER'S CORE                       @Y30LB35*/ 02226000
*/*             BEGHH IN CALLER'S CORE                       @Y30LB35*/ 02227000
*/*             ENDCC IN CALLER'S CORE                       @Y30LB35*/ 02228000
*/*             ENDHH IN CALLER'S CORE                       @Y30LB35*/ 02229000
*/*             PARMLIST                                     @Y30LB35*/ 02230000
*/*             DEBPTR                                       @Y30LB35*/ 02231000
*/*             DEBDAPTR                                     @Y30LB35*/ 02232000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 02233000
*/*                           4, ERROR IN CHECKOPN           @Y30LB35*/ 02234000
*/*                                                          @Y30LB35*/ 02235000
*/********************************************************************/ 02236000
*                                                                  0785 02237000
*                                   /*                       @Y30LB35*/ 02238000
*OPNTAB:                                                           0785 02239000
*   PROC;                           /*                       @Y30LB35*/ 02240000
*                                                                  0785 02241000
OPNTAB   STM   @14,@12,@SA00007                                    0785 02242000
*   /*****************************************************************/ 02243000
*   /*                                                               */ 02244000
*   /* SET UP TRACE POINT 'IOOT' IN TRACE TABLE              @Y30LB35*/ 02245000
*   /*                                                               */ 02246000
*   /*****************************************************************/ 02247000
*                                                                  0786 02248000
*   OLDERID2=NEWERID2;                                             0786 02249000
         L     @03,@PC00001                                        0786 02250000
         L     @03,GDTTR2(,@03)                                    0786 02251000
         L     @15,@PC00001                                        0786 02252000
         L     @01,GDTTR2(,@15)                                    0786 02253000
         MVC   @TS00001(95),NEWERID2(@01)                          0786 02254000
         MVC   OLDERID2(95,@03),@TS00001                           0786 02255000
*   NEWID2='IOOT';                  /*                       @Y30LB35*/ 02256000
*                                                                  0787 02257000
         L     @03,@PC00001                                        0787 02258000
         L     @03,GDTTR2(,@03)                                    0787 02259000
         MVC   NEWID2(4,@03),@CC04172                              0787 02260000
*   /*****************************************************************/ 02261000
*   /*                                                               */ 02262000
*   /* THE PARMLIST IS SET UP HERE FOR THE OPEN              @Y30LB35*/ 02263000
*   /*                                                               */ 02264000
*   /*****************************************************************/ 02265000
*                                                                  0788 02266000
*   RESPECIFY                                                      0788 02267000
*    (REG1,                                                        0788 02268000
*     REG3) RSTD;                   /*                       @Y30LB35*/ 02269000
*   REG1=ADDR(PARMLIST);            /*                       @Y30LB35*/ 02270000
         LA    REG1,PARMLIST                                       0789 02271000
*   REG3=ADDR(IOXDCB);              /*                       @Y30LB35*/ 02272000
         L     REG3,IOCTLBKP                                       0790 02273000
         LA    REG3,IOXDCB(,REG3)                                  0790 02274000
*   PARMLIST=''B;                   /*                       @Y30LB35*/ 02275000
         XC    PARMLIST(20),PARMLIST                               0791 02276000
*   PARMLIST=OPENLIST;              /*                       @Y30LB35*/ 02277000
         MVI   PARMLIST+8,C' '                                     0792 02278000
         MVC   PARMLIST+9(11),PARMLIST+8                           0792 02279000
         MVC   PARMLIST(8),OPENLIST                                0792 02280000
*                                                                  0793 02281000
*   /*****************************************************************/ 02282000
*   /*                                                               */ 02283000
*   /* IF THE EXOREAD BIT IS SET THE DSN WILL                @Y30LB35*/ 02284000
*   /* BE OPENED FOR INPUT(READ ONLY)                        @Y30LB35*/ 02285000
*   /*                                                               */ 02286000
*   /*****************************************************************/ 02287000
*                                                                  0793 02288000
*   IF EXOREAD=ON                   /*                       @Y30LB35*/ 02289000
*     THEN                          /*                       @Y30LB35*/ 02290000
         L     @15,@PC00001+8                                      0793 02291000
         TM    EXOREAD(@15),B'10000000'                            0793 02292000
         BNO   @RF00793                                            0793 02293000
*LOPEN3:                                                           0794 02294000
*     GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)));/*              @Y30LB35*/ 02295000
LOPEN3   OPEN ((REG3),INPUT),MF=(E,(REG1))                              02296000
*   ELSE                            /*                       @Y30LB35*/ 02297000
*                                                                  0795 02298000
*     /***************************************************************/ 02299000
*     /*                                                             */ 02300000
*     /* IF THE BIT IS NOT SET THEN IT WILL BE FOR           @Y30LB35*/ 02301000
*     /* OUTPUT.                                             @Y30LB35*/ 02302000
*     /*                                                             */ 02303000
*     /***************************************************************/ 02304000
*                                                                  0795 02305000
*LOPEN4:                                                           0795 02306000
*     GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)));/*             @Y30LB35*/ 02307000
*                                                                  0795 02308000
         B     @RC00793                                            0795 02309000
@RF00793 DS    0H                                                  0795 02310000
LOPEN4   OPEN ((REG3),OUTPUT),MF=(E,(REG1))                             02311000
*   /*****************************************************************/ 02312000
*   /*                                                               */ 02313000
*   /* CHECKOPN IS CALLED TO DETERMINE WHETHER               @Y30LB35*/ 02314000
*   /* THE OPEN WAS SUCCESSFUL AND THAT THE DCB              @Y30LB35*/ 02315000
*   /* ABEND EXIT WAS NOT TAKEN.                             @Y30LB35*/ 02316000
*   /*                                                               */ 02317000
*   /*****************************************************************/ 02318000
*                                                                  0796 02319000
*   CALL CHECKOPN;                  /*                       @Y30LB35*/ 02320000
@RC00793 BAL   @14,CHECKOPN                                        0796 02321000
*   RESPECIFY                                                      0797 02322000
*     RTNREG RSTD;                                                 0797 02323000
*   TESTRC=RTNREG;                                                 0798 02324000
         STH   RTNREG,TESTRC                                       0798 02325000
*   RESPECIFY                                                      0799 02326000
*     RTNREG UNRSTD;                /*                       @Y30LB35*/ 02327000
*                                                                  0800 02328000
*   /*****************************************************************/ 02329000
*   /*                                                               */ 02330000
*   /* IF THE OPEN WAS SUCCESSFUL, THE FINAL                 @Y30LB35*/ 02331000
*   /* SET UP IS PERFORMED.                                  @Y30LB35*/ 02332000
*   /*                                                               */ 02333000
*   /*****************************************************************/ 02334000
*                                                                  0800 02335000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 02336000
*     THEN                          /*                       @Y30LB35*/ 02337000
         LH    @00,TESTRC                                          0800 02338000
         LTR   @00,@00                                             0800 02339000
         BNZ   @RF00800                                            0800 02340000
*     DO;                           /*                       @Y30LB35*/ 02341000
*                                                                  0801 02342000
*       /*************************************************************/ 02343000
*       /*                                                           */ 02344000
*       /* THE DCBOFLWR BIT IS SET OFF TO ENSURE THAT        @Y30LB35*/ 02345000
*       /* CLOSE DOES NOT WRITE AN END-OF-FILE.              @Y30LB35*/ 02346000
*       /*                                                           */ 02347000
*       /*************************************************************/ 02348000
*                                                                  0802 02349000
*       DCBOFLWR=OFF;               /*                       @Y30LB35*/ 02350000
*                                                                  0802 02351000
         L     @15,DCBPTR                                          0802 02352000
         NI    DCBOFLWR+40(@15),B'01111111'                        0802 02353000
*       /*************************************************************/ 02354000
*       /*                                                           */ 02355000
*       /* HERE THE STEPS ARE TAKEN TO RETURN THE            @Y30LB35*/ 02356000
*       /* DATA SET EXTENTS TO THE CALLER.                   @Y30LB35*/ 02357000
*       /* ADDRESSABILITY IS SET UP TO THE DEB               @Y30LB35*/ 02358000
*       /* AND THE BEGINNING AND ENDING CCHH'S               @Y30LB35*/ 02359000
*       /* ARE RETURNED.                                     @Y30LB35*/ 02360000
*       /*                                                           */ 02361000
*       /*************************************************************/ 02362000
*                                                                  0803 02363000
*       DEBPTR=DCBDEBAD;            /*                       @Y30LB35*/ 02364000
         L     @15,DCBPTR                                          0803 02365000
         L     @00,DCBDEBAD+40(,@15)                               0803 02366000
         ST    @00,DEBPTR                                          0803 02367000
*       RTNEXTS=''B;                /*                       @Y30LB35*/ 02368000
         L     @15,@PC00001+8                                      0804 02369000
         L     @15,EXOEXT(,@15)                                    0804 02370000
         XC    RTNEXTS(10,@15),RTNEXTS(@15)                        0804 02371000
*       DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);                  0805 02372000
         LA    @00,32                                              0805 02373000
         AL    @00,DEBPTR                                          0805 02374000
         ST    @00,DEBDAPTR                                        0805 02375000
*       BEGCC=DEBSTRCC;             /*                       @Y30LB35*/ 02376000
         L     @15,@PC00001+8                                      0806 02377000
         L     @15,EXOEXT(,@15)                                    0806 02378000
         L     @14,DEBDAPTR                                        0806 02379000
         MVC   BEGCC(2,@15),DEBSTRCC(@14)                          0806 02380000
*       BEGHH=DEBSTRHH;             /*                       @Y30LB35*/ 02381000
         L     @15,@PC00001+8                                      0807 02382000
         L     @15,EXOEXT(,@15)                                    0807 02383000
         L     @14,DEBDAPTR                                        0807 02384000
         MVC   BEGHH(2,@15),DEBSTRHH(@14)                          0807 02385000
*       ENDCC=DEBENDCC;             /*                       @Y30LB35*/ 02386000
         L     @15,@PC00001+8                                      0808 02387000
         L     @15,EXOEXT(,@15)                                    0808 02388000
         L     @14,DEBDAPTR                                        0808 02389000
         MVC   ENDCC(2,@15),DEBENDCC(@14)                          0808 02390000
*       ENDHH=DEBENDHH;             /*                       @Y30LB35*/ 02391000
         L     @15,@PC00001+8                                      0809 02392000
         L     @15,EXOEXT(,@15)                                    0809 02393000
         L     @14,DEBDAPTR                                        0809 02394000
         MVC   ENDHH(2,@15),DEBENDHH(@14)                          0809 02395000
*     END;                          /*                       @Y30LB35*/ 02396000
*   RESPECIFY                                                      0811 02397000
*    (REG1,                                                        0811 02398000
*     REG3) UNRSTD;                 /*                       @Y30LB35*/ 02399000
*                                                                  0811 02400000
@RF00800 DS    0H                                                  0812 02401000
*   /*****************************************************************/ 02402000
*   /*                                                               */ 02403000
*   /* HERE CONTROL IS RETURNED TO OPENPROC                  @Y30LB35*/ 02404000
*   /* THE RETURN CODE IS RETURNED IN REGISTER 15            @Y30LB35*/ 02405000
*   /* - 4 CODE INDICATES ERROR AND 0 SUCCESSFUL.            @Y30LB35*/ 02406000
*   /*                                                               */ 02407000
*   /*****************************************************************/ 02408000
*                                                                  0812 02409000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 02410000
         LH    @15,TESTRC                                          0812 02411000
         L     @14,@SA00007                                        0812 02412000
         LM    @00,@12,@SA00007+8                                  0812 02413000
         BR    @14                                                 0812 02414000
*   END OPNTAB;                     /*                       @Y30LB35*/ 02415000
*                                                                  0814 02416000
*/********************************************************************/ 02417000
*/*                                                          @Y30LB35*/ 02418000
*/* PROCEDURE NAME - OPNLAB                                  @Y30LB35*/ 02419000
*/*                                                          @Y30LB35*/ 02420000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 02421000
*/*             OPEN THE VOLUME SUCH THAT I/O CAN BE         @Y30LB35*/ 02422000
*/*             PERFORMED TO THE VOLUME LABEL RECORD         @Y30LB35*/ 02423000
*/*             (CYL 0 TRK 0 REC 3).  THIS IS DONE BY        @Y30LB35*/ 02424000
*/*             THE FOLLOWING STEPS:                         @Y30LB35*/ 02425000
*/*             UPDATE JFCB, ISSUE OPEN TYPE=J, ISSUE        @Y30LB35*/ 02426000
*/*             MODESET(KEY ZERO), MODIFY DEB EXTENT, AND    @Y30LB35*/ 02427000
*/*             MODESET(PROBLEM PROGRAM KEY)                 @Y30LB35*/ 02428000
*/*                                                          @Y30LB35*/ 02429000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 02430000
*/*                                                          @Y30LB35*/ 02431000
*/* INPUT -     EXOVSN IN EXOAGL                             @Y30LB35*/ 02432000
*/*             IOXDCB IN IOXCTLBK                           @Y30LB35*/ 02433000
*/*             DCBDEBAD IN IOXDCB                           @Y30LB35*/ 02434000
*/*             DEBBASIC                                     @Y30LB35*/ 02435000
*/*                                                          @Y30LB35*/ 02436000
*/* OUTPUT -    JFCBDSNM IN IOXJFCB                          @Y30LB35*/ 02437000
*/*             JFCNWRIT IN IOXJFCB                          @Y30LB35*/ 02438000
*/*             JFCVSL IN IOXJFCB                            @Y30LB35*/ 02439000
*/*             JFCAVOLS(1) IN IOXJFCB                       @Y30LB35*/ 02440000
*/*             DCBOFLWR IN IOXDCB                           @Y30LB35*/ 02441000
*/*             DEBSTRCC IN DEBBASIC                         @Y30LB35*/ 02442000
*/*             DEBSTRHH IN DEBBASIC                         @Y30LB35*/ 02443000
*/*             DEBPTR                                       @Y30LB35*/ 02444000
*/*             DEBDAPTR                                     @Y30LB35*/ 02445000
*/*             MODEPARM                                     @Y30LB35*/ 02446000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 02447000
*/*                           4, ERROR IN CHECKOPN           @Y30LB35*/ 02448000
*/*                                                          @Y30LB35*/ 02449000
*/********************************************************************/ 02450000
*                                                                  0814 02451000
*                                   /*                       @Y30LB35*/ 02452000
*OPNLAB:                                                           0814 02453000
*   PROC;                           /*                       @Y30LB35*/ 02454000
*                                                                  0814 02455000
OPNLAB   STM   @14,@12,@SA00008                                    0814 02456000
*   /*****************************************************************/ 02457000
*   /*                                                               */ 02458000
*   /* THE NEXT TWO CONSTANTS ARE USED TO ALLOW              @Y30LB35*/ 02459000
*   /* ACCESS TO THE BEGINNING OF THE VOLUME.                @Y30LB35*/ 02460000
*   /*                                                               */ 02461000
*   /*****************************************************************/ 02462000
*                                                                  0815 02463000
*   DCL                                                            0815 02464000
*     CYLZERO CHAR(2) STATIC INIT('0000'X);/*                @Y30LB35   02465000
*                                      CYLINDER ZERO         @Y30LB35*/ 02466000
*   DCL                                                            0816 02467000
*     TRKZERO CHAR(2) STATIC INIT('0000'X);/*                @Y30LB35   02468000
*                                      TRACK ZERO            @Y30LB35*/ 02469000
*                                                                  0816 02470000
*   /*****************************************************************/ 02471000
*   /*                                                               */ 02472000
*   /* HERE IS THE MACRO LIST FORM OF                        @Y30LB35*/ 02473000
*   /* MODESET MF(L,MOD1) KEY(ZERO) MODE(SUP)                        */ 02474000
*   /*                                                               */ 02475000
*   /*****************************************************************/ 02476000
*                                                                  0817 02477000
*   DCL                                                            0817 02478000
*     1 MOD1 STATIC BDY(WORD),      /* DEFINE LIST                   */ 02479000
*      2 MOD101 BIT(8) INIT('00000000'B),/* OR MASK                  */ 02480000
*      2 MOD102 BIT(8) INIT('00000000'B),/* AND MASK                 */ 02481000
*      2 MOD103 BIT(8) INIT('00000000'B),/* RESERVED                 */ 02482000
*      2 MOD104 BIT(8) INIT('00111100'B);/*                  @Y30LB35*/ 02483000
*                                                                  0817 02484000
*   /*****************************************************************/ 02485000
*   /*                                                               */ 02486000
*   /* MODESET MF(L,MOD2) KEY(NZERO) MODE(PROB)                      */ 02487000
*   /*                                                               */ 02488000
*   /*****************************************************************/ 02489000
*                                                                  0818 02490000
*   DCL                                                            0818 02491000
*     1 MOD2 STATIC BDY(WORD),      /* DEFINE LIST                   */ 02492000
*      2 MOD201 BIT(8) INIT('00000000'B),/* OR MASK                  */ 02493000
*      2 MOD202 BIT(8) INIT('00000000'B),/* AND MASK                 */ 02494000
*      2 MOD203 BIT(8) INIT('00000000'B),/* RESERVED                 */ 02495000
*      2 MOD204 BIT(8) INIT('00100100'B);/*                  @Y30LB35*/ 02496000
*                                                                  0818 02497000
*   /*****************************************************************/ 02498000
*   /*                                                               */ 02499000
*   /* THIS DEFINES DYNAMIC STORAGE FOR MODESET              @Y30LB35*/ 02500000
*   /* PARMLISTS.                                            @Y30LB35*/ 02501000
*   /*                                                               */ 02502000
*   /*****************************************************************/ 02503000
*                                                                  0819 02504000
*   DCL                                                            0819 02505000
*     MODEPARM CHAR(LENGTH(MOD1)) BDY(WORD);/*               @Y30LB35*/ 02506000
*                                                                  0820 02507000
*   /*****************************************************************/ 02508000
*   /*                                                               */ 02509000
*   /* SET UP TRACE POINT 'IOOL' IN TRACE TABLE              @Y30LB35*/ 02510000
*   /*                                                               */ 02511000
*   /*****************************************************************/ 02512000
*                                                                  0820 02513000
*   OLDERID2=NEWERID2;                                             0820 02514000
         L     @03,@PC00001                                        0820 02515000
         L     @03,GDTTR2(,@03)                                    0820 02516000
         L     @15,@PC00001                                        0820 02517000
         L     @01,GDTTR2(,@15)                                    0820 02518000
         MVC   @TS00001(95),NEWERID2(@01)                          0820 02519000
         MVC   OLDERID2(95,@03),@TS00001                           0820 02520000
*   NEWID2='IOOL';                  /*                       @Y30LB35   02521000
*                                                            @Y30LB35*/ 02522000
*                                                                  0821 02523000
         L     @03,@PC00001                                        0821 02524000
         L     @03,GDTTR2(,@03)                                    0821 02525000
         MVC   NEWID2(4,@03),@CC04197                              0821 02526000
*   /*****************************************************************/ 02527000
*   /*                                                               */ 02528000
*   /* SET UP THE JFCB TO OPEN VTOC                          @Y30LB35*/ 02529000
*   /*                                                               */ 02530000
*   /*****************************************************************/ 02531000
*                                                                  0822 02532000
*   JFCBDSNM=VTOCDSN;               /*                       @Z40LB35*/ 02533000
         L     @03,JFCBPTR                                         0822 02534000
         MVC   JFCBDSNM(44,@03),VTOCDSN                            0822 02535000
*   JFCNWRIT=ON;                    /*                       @Y30LB35*/ 02536000
*                                                                  0823 02537000
         L     @03,JFCBPTR                                         0823 02538000
         OI    JFCNWRIT(@03),B'00001000'                           0823 02539000
*   /*****************************************************************/ 02540000
*   /*                                                               */ 02541000
*   /* IF CALLER HAS PROVIDED THE VOLSER                     @Y30LB35*/ 02542000
*   /* IT IS MOVED INTO THE JFCB.                            @Y30LB35*/ 02543000
*   /*                                                               */ 02544000
*   /*****************************************************************/ 02545000
*                                                                  0824 02546000
*   IF EXOVSN^=NULLPTR              /*                       @Y30LB35*/ 02547000
*     THEN                          /*                       @Y30LB35*/ 02548000
         L     @03,@PC00001+8                                      0824 02549000
         L     @03,EXOVSN(,@03)                                    0824 02550000
         LTR   @03,@03                                             0824 02551000
         BZ    @RF00824                                            0824 02552000
*     DO;                           /*                       @Y30LB35*/ 02553000
*       JFCVSL=ON;                  /*                       @Y30LB35*/ 02554000
         L     @03,JFCBPTR                                         0826 02555000
         OI    JFCVSL(@03),B'01000000'                             0826 02556000
*       JFCAVOLS(1)=VOLLAB;         /*                       @Y30LB35*/ 02557000
         L     @03,JFCBPTR                                         0827 02558000
         L     @15,@PC00001+8                                      0827 02559000
         L     @01,EXOVSN(,@15)                                    0827 02560000
         MVC   JFCAVOLS(6,@03),VOLLAB(@01)                         0827 02561000
*     END;                          /*                       @Y30LB35*/ 02562000
*                                                                  0828 02563000
*   /*****************************************************************/ 02564000
*   /*                                                               */ 02565000
*   /* THE PARMLISTS ARE INITIALIZED FOR THE OPEN            @Y30LB35*/ 02566000
*   /*                                                               */ 02567000
*   /*****************************************************************/ 02568000
*                                                                  0829 02569000
*   PARMLIST=''B;                   /*                       @Y30LB35*/ 02570000
@RF00824 XC    PARMLIST(20),PARMLIST                               0829 02571000
*   PARMLIST=OPENLIST;              /*                       @Y30LB35*/ 02572000
         MVI   PARMLIST+8,C' '                                     0830 02573000
         MVC   PARMLIST+9(11),PARMLIST+8                           0830 02574000
         MVC   PARMLIST(8),OPENLIST                                0830 02575000
*   RESPECIFY                                                      0831 02576000
*    (REG3,                                                        0831 02577000
*     REG1) RSTD;                   /*                       @Y30LB35*/ 02578000
*   REG3=ADDR(IOXDCB);              /*                       @Y30LB35*/ 02579000
         L     REG3,IOCTLBKP                                       0832 02580000
         LA    REG3,IOXDCB(,REG3)                                  0832 02581000
*   REG1=ADDR(PARMLIST);            /*                       @Y30LB35*/ 02582000
*                                                                  0833 02583000
         LA    REG1,PARMLIST                                       0833 02584000
*   /*****************************************************************/ 02585000
*   /*                                                               */ 02586000
*   /* IF THE CALLER HAS SET EXOREAD, THEN                   @Y30LB35*/ 02587000
*   /* THE DATA SET WILL BE OPENED FOR INPUT(READ)           @Y30LB35*/ 02588000
*   /* ONLY                                                  @Y30LB35*/ 02589000
*   /*                                                               */ 02590000
*   /*****************************************************************/ 02591000
*                                                                  0834 02592000
*   IF EXOREAD=ON                   /*                       @Y30LB35*/ 02593000
*     THEN                          /*                       @Y30LB35*/ 02594000
         L     @15,@PC00001+8                                      0834 02595000
         TM    EXOREAD(@15),B'10000000'                            0834 02596000
         BNO   @RF00834                                            0834 02597000
*LOPEN5:                                                           0835 02598000
*     GEN(OPEN  ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);              0835 02599000
*                                                                  0835 02600000
LOPEN5   OPEN  ((REG3),INPUT),MF=(E,(REG1)),TYPE=J                      02601000
*   /*****************************************************************/ 02602000
*   /*                                                               */ 02603000
*   /* IF THE EXOREAD IS NOT SET IT IS OPENED                @Y30LB35*/ 02604000
*   /* FOR OUTPUT.                                           @Y30LB35*/ 02605000
*   /*                                                               */ 02606000
*   /*****************************************************************/ 02607000
*                                                                  0836 02608000
*   ELSE                            /*                       @Y30LB35*/ 02609000
*LOPEN6:                                                           0836 02610000
*     GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);/*      @Y30LB35*/ 02611000
         B     @RC00834                                            0836 02612000
@RF00834 DS    0H                                                  0836 02613000
LOPEN6   OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J                      02614000
*                                                                  0837 02615000
*   /*****************************************************************/ 02616000
*   /*                                                               */ 02617000
*   /* HERE CHECKOPN IS CALLED TO DETERMINE                  @Y30LB35*/ 02618000
*   /* IF THE OPEN WAS SUCCESSFUL.                           @Y30LB35*/ 02619000
*   /*                                                               */ 02620000
*   /*****************************************************************/ 02621000
*                                                                  0837 02622000
*   CALL CHECKOPN;                  /*                       @Y30LB35*/ 02623000
@RC00834 BAL   @14,CHECKOPN                                        0837 02624000
*   RESPECIFY                                                      0838 02625000
*     RTNREG RSTD;                                                 0838 02626000
*   TESTRC=RTNREG;                                                 0839 02627000
         STH   RTNREG,TESTRC                                       0839 02628000
*   RESPECIFY                                                      0840 02629000
*     RTNREG UNRSTD;                /*                       @Y30LB35*/ 02630000
*                                                                  0840 02631000
*   /*****************************************************************/ 02632000
*   /*                                                               */ 02633000
*   /* IF THE OPEN WAS SUCCESSFUL THE FINAL                  @Y30LB35*/ 02634000
*   /* INITIALIZATION IS PERFORMED.                          @Y30LB35*/ 02635000
*   /*                                                               */ 02636000
*   /*****************************************************************/ 02637000
*                                                                  0841 02638000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 02639000
*     THEN                          /*                       @Y30LB35*/ 02640000
         LH    @00,TESTRC                                          0841 02641000
         LTR   @00,@00                                             0841 02642000
         BNZ   @RF00841                                            0841 02643000
*     DO;                           /*                       @Y30LB35*/ 02644000
*                                                                  0842 02645000
*       /*************************************************************/ 02646000
*       /*                                                           */ 02647000
*       /* THE DCBOFLWR IS SET OFF TO PREVENT CLOSE          @Y30LB35*/ 02648000
*       /* FROM WRITING AN END-OF-FILE MARK.                 @Y30LB35*/ 02649000
*       /*                                                           */ 02650000
*       /*************************************************************/ 02651000
*                                                                  0843 02652000
*       DCBOFLWR=OFF;               /*                       @Y30LB35*/ 02653000
*                                                                  0843 02654000
         L     @15,DCBPTR                                          0843 02655000
         NI    DCBOFLWR+40(@15),B'01111111'                        0843 02656000
*       /*************************************************************/ 02657000
*       /*                                                           */ 02658000
*       /* HERE PREPARATIONS ARE MADE TO ISSUE               @Y30LB35*/ 02659000
*       /* MODESET INTO SUPERVISOR KEY.                      @Y30LB35*/ 02660000
*       /*                                                           */ 02661000
*       /*************************************************************/ 02662000
*                                                                  0844 02663000
*       MODEPARM=''B;               /*                       @Y30LB35*/ 02664000
         XC    MODEPARM(4),MODEPARM                                0844 02665000
*       MODEPARM=MOD1;              /*                       @Y30LB35*/ 02666000
         L     @00,MOD1                                            0845 02667000
         ST    @00,MODEPARM                                        0845 02668000
*       RESPECIFY                                                  0846 02669000
*        (REG3,                                                    0846 02670000
*         REG1) RSTD;               /*                       @Y30LB35*/ 02671000
*       REG3=MODEPARM;              /*                       @Y30LB35*/ 02672000
*                                                                  0847 02673000
         L     REG3,MODEPARM                                       0847 02674000
*       /*************************************************************/ 02675000
*       /*                                                           */ 02676000
*       /* BEFORE THE MODESET IS ISSUED, THE DEB PTRS        @Y30LB35*/ 02677000
*       /* ARE SET UP.                                       @Y30LB35*/ 02678000
*       /*                                                           */ 02679000
*       /*************************************************************/ 02680000
*                                                                  0848 02681000
*       DEBPTR=DCBDEBAD;            /*                       @Y30LB35*/ 02682000
         L     @15,DCBPTR                                          0848 02683000
         L     @00,DCBDEBAD+40(,@15)                               0848 02684000
         ST    @00,DEBPTR                                          0848 02685000
*       DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);                  0849 02686000
*                                                                  0849 02687000
         LA    @00,32                                              0849 02688000
         AL    @00,DEBPTR                                          0849 02689000
         ST    @00,DEBDAPTR                                        0849 02690000
*       /*************************************************************/ 02691000
*       /*                                                           */ 02692000
*       /* THE MODESET WILL GET US INTO SUPERVISOR           @Y30LB35*/ 02693000
*       /* STATE KEY ZERO. THIS WILL ALLOW US TO             @Y30LB35*/ 02694000
*       /* MODIFY THE DEB WHICH IS IN PROTECTED CORE.        @Y30LB35*/ 02695000
*       /*                                                           */ 02696000
*       /*************************************************************/ 02697000
*                                                                  0850 02698000
*LMODE1:                                                           0850 02699000
*       DO;                         /* MODESET MF(E,REG3)            */ 02700000
LMODE1   DS    0H                                                  0851 02701000
*         RESPECIFY                                                0851 02702000
*           GPR01F RESTRICTED;                                     0851 02703000
*         GPR01F=REG3;              /* MODESET PARMLIST              */ 02704000
         LR    GPR01F,REG3                                         0852 02705000
*         SVC(107);                 /* ISSUE MODESET SVC             */ 02706000
         SVC   107                                                 0853 02707000
*         RESPECIFY                                                0854 02708000
*          (GPR01F) UNRESTRICTED;                                  0854 02709000
*       END;                        /* MODESET MF(E,REG3)    @Y30LB35*/ 02710000
*                                                                  0856 02711000
*       /*************************************************************/ 02712000
*       /*                                                           */ 02713000
*       /* NOW THAT WE ARE IN KEY ZERO THE DEB IS            @Y30LB35*/ 02714000
*       /* ALTERED BY SETTING THE BEGIN DEB EXTENT           @Y30LB35*/ 02715000
*       /* TO ALLOW ACCESS TO THE BEGINNING OF THE           @Y30LB35*/ 02716000
*       /* VOLUME WHERE THE VOLUME LABEL IS LOCATED.         @Y30LB35*/ 02717000
*       /*                                                           */ 02718000
*       /*************************************************************/ 02719000
*                                                                  0856 02720000
*       DEBSTRCC=CYLZERO;           /*                       @Y30LB35*/ 02721000
         L     @15,DEBDAPTR                                        0856 02722000
         MVC   DEBSTRCC(2,@15),CYLZERO                             0856 02723000
*       DEBSTRHH=TRKZERO;           /*                       @Y30LB35*/ 02724000
*                                                                  0857 02725000
         L     @15,DEBDAPTR                                        0857 02726000
         MVC   DEBSTRHH(2,@15),TRKZERO                             0857 02727000
*       /*************************************************************/ 02728000
*       /*                                                           */ 02729000
*       /* NOW THAT THE DEB HAS BEEN MODIFIED,               @Y30LB35*/ 02730000
*       /* THE MODESET PARMLIST IS INITIALIZE                @Y30LB35*/ 02731000
*       /* ONCE AGAIN TO RETURN US TO THE                    @Y30LB35*/ 02732000
*       /* PROBLEM PROGRAM KEY.                              @Y30LB35*/ 02733000
*       /*                                                           */ 02734000
*       /*************************************************************/ 02735000
*                                                                  0858 02736000
*       MODEPARM=''B;               /*                       @Y30LB35*/ 02737000
         XC    MODEPARM(4),MODEPARM                                0858 02738000
*       MODEPARM=MOD2;              /*                       @Y30LB35*/ 02739000
         L     @00,MOD2                                            0859 02740000
         ST    @00,MODEPARM                                        0859 02741000
*       REG3=MODEPARM;              /*                       @Y30LB35*/ 02742000
*                                                                  0860 02743000
         L     REG3,MODEPARM                                       0860 02744000
*       /*************************************************************/ 02745000
*       /*                                                           */ 02746000
*       /* HERE THE MODESET IS ISSUED-PROB PROGARM KEY       @Y30LB35*/ 02747000
*       /*                                                           */ 02748000
*       /*************************************************************/ 02749000
*                                                                  0861 02750000
*LMODE2:                                                           0861 02751000
*       DO;                         /* MODESET MF(E,REG3)            */ 02752000
LMODE2   DS    0H                                                  0862 02753000
*         RESPECIFY                                                0862 02754000
*           GPR01F RESTRICTED;                                     0862 02755000
*         GPR01F=REG3;              /* MODESET PARMLIST              */ 02756000
         LR    GPR01F,REG3                                         0863 02757000
*         SVC(107);                 /* ISSUE MODESET SVC             */ 02758000
         SVC   107                                                 0864 02759000
*         RESPECIFY                                                0865 02760000
*          (GPR01F) UNRESTRICTED;                                  0865 02761000
*       END;                        /* MODESET MF(E,REG3)    @Y30LB35*/ 02762000
*       RESPECIFY                                                  0867 02763000
*        (REG3,                                                    0867 02764000
*         REG1) UNRSTD;             /*                       @Y30LB35*/ 02765000
*     END;                          /*                       @Y30LB35*/ 02766000
*                                                                  0868 02767000
*   /*****************************************************************/ 02768000
*   /*                                                               */ 02769000
*   /* CONTROL IS RETURNED TO OPENPROC WITH                  @Y30LB35*/ 02770000
*   /* THE RETURN CODE IN REGISTER 15 WHICH                  @Y30LB35*/ 02771000
*   /* WILL BE 4 TO INDICATE ERROR OR 0 SUCCESSFUL.          @Y30LB35*/ 02772000
*   /*                                                               */ 02773000
*   /*****************************************************************/ 02774000
*                                                                  0869 02775000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 02776000
@RF00841 LH    @15,TESTRC                                          0869 02777000
         L     @14,@SA00008                                        0869 02778000
         LM    @00,@12,@SA00008+8                                  0869 02779000
         BR    @14                                                 0869 02780000
*   END OPNLAB;                     /*                       @Y30LB35*/ 02781000
*                                                                  0871 02782000
*/********************************************************************/ 02783000
*/*                                                          @Y30LB35*/ 02784000
*/* PROCEDURE NAME - OPNNEW                                  @Y30LB35*/ 02785000
*/*                                                          @Y30LB35*/ 02786000
*/* FUNCTION -  ISSUES SVC 82 (DASDR SVC)                    @Y30LB35*/ 02787000
*/*             TO PERFORM A PSEUDO OPEN                     @Y30LB35*/ 02788000
*/*                                                          @Y30LB35*/ 02789000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 02790000
*/*                                                          @Y30LB35*/ 02791000
*/* INPUT -     EXOUCB IN EXOAGL                             @Y30LB35*/ 02792000
*/*             IOXDCB                                       @Y30LB35*/ 02793000
*/*                                                          @Y30LB35*/ 02794000
*/* OUTPUT -    DCBOFLWR IN IOXDCB                           @Y30LB35*/ 02795000
*/*             SV82LIST                                     @Y30LB35*/ 02796000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 02797000
*/*                                                          @Y30LB35*/ 02798000
*/********************************************************************/ 02799000
*                                                                  0871 02800000
*OPNNEW:                                                           0871 02801000
*   PROC;                           /*                       @Y30LB35*/ 02802000
*                                                                  0871 02803000
OPNNEW   STM   @14,@12,12(@13)                                     0871 02804000
*   /*****************************************************************/ 02805000
*   /*                                                               */ 02806000
*   /* SET UP TRACE POINT 'IOON' IN TRACE TABLE              @Y30LB35*/ 02807000
*   /*                                                               */ 02808000
*   /*****************************************************************/ 02809000
*                                                                  0872 02810000
*   OLDERID2=NEWERID2;                                             0872 02811000
         L     @03,@PC00001                                        0872 02812000
         L     @03,GDTTR2(,@03)                                    0872 02813000
         L     @15,@PC00001                                        0872 02814000
         L     @01,GDTTR2(,@15)                                    0872 02815000
         MVC   @TS00001(95),NEWERID2(@01)                          0872 02816000
         MVC   OLDERID2(95,@03),@TS00001                           0872 02817000
*   NEWID2='IOON';                  /*                       @Y30LB35*/ 02818000
*                                                                  0873 02819000
         L     @03,@PC00001                                        0873 02820000
         L     @03,GDTTR2(,@03)                                    0873 02821000
         MVC   NEWID2(4,@03),@CC04211                              0873 02822000
*   /*****************************************************************/ 02823000
*   /*                                                               */ 02824000
*   /* HERE THE SVC 82 INPUT PARMLIST IS                     @Y30LB35*/ 02825000
*   /* INITIALIZED.                                          @Y30LB35*/ 02826000
*   /*                                                               */ 02827000
*   /*****************************************************************/ 02828000
*                                                                  0874 02829000
*   SV82LIST=''B;                   /*                       @Y30LB35*/ 02830000
         LA    @03,SVC82ARG                                        0874 02831000
         XC    SV82LIST(16,@03),SV82LIST(@03)                      0874 02832000
*   SV82CODE=SVC82OPN;              /*                       @Y30LB35*/ 02833000
         LA    @03,SVC82ARG                                        0875 02834000
         MVC   SV82CODE(1,@03),SVC82OPN                            0875 02835000
*   SV82UCBP=EXOUCB;                /*                       @Y30LB35*/ 02836000
         LA    @03,SVC82ARG                                        0876 02837000
         L     @15,@PC00001+8                                      0876 02838000
         MVC   SV82UCBP(3,@03),EXOUCB+1(@15)                       0876 02839000
*   SV82DCBP=ADDR(IOXDCB);          /*                       @Y30LB35*/ 02840000
*                                                                  0877 02841000
         LA    @03,SVC82ARG                                        0877 02842000
         L     @01,IOCTLBKP                                        0877 02843000
         LA    @15,IOXDCB(,@01)                                    0877 02844000
         ST    @15,SV82DCBP(,@03)                                  0877 02845000
*   /*****************************************************************/ 02846000
*   /*                                                               */ 02847000
*   /* THE DCBOFLWR FLAG IS SET OFF JUST IN CASE             @Y30LB35*/ 02848000
*   /* THE DCB IS CLOSED BY TERMINATION MANAGEMENT           @Y30LB35*/ 02849000
*   /* FOR SOME REASON LIKE TIME OUT ABEND.                  @Y30LB35*/ 02850000
*   /* THIS WILL KEEP THE CLOSE SVC FROM TRYING              @Y30LB35*/ 02851000
*   /* TO WRITE AN END-OF-FILE MARK.                         @Y30LB35*/ 02852000
*   /*                                                               */ 02853000
*   /*****************************************************************/ 02854000
*                                                                  0878 02855000
*   DCBOFLWR=OFF;                   /*                       @Y30LB35*/ 02856000
         L     @03,DCBPTR                                          0878 02857000
         NI    DCBOFLWR+40(@03),B'01111111'                        0878 02858000
*   RESPECIFY                                                      0879 02859000
*     REG1 RESTRICTED;              /*                       @Y30LB35*/ 02860000
*   REG1=ADDR(SV82LIST);            /*                       @Y30LB35*/ 02861000
         LA    REG1,SVC82ARG                                       0880 02862000
*                                                                  0881 02863000
*   /*****************************************************************/ 02864000
*   /*                                                               */ 02865000
*   /* NOW THE SVC 82 (DASDR) IS ISSUED TO                   @Y30LB35*/ 02866000
*   /* PERFORM A PSEUDO OPEN WHICH BUILDS                    @Y30LB35*/ 02867000
*   /* THE DEB, CHAINS IT TO THE TCB DEB CHAIN,              @Y30LB35*/ 02868000
*   /* AND INSERTS THE DEB INTO THE SYSTEM                   @Y30LB35*/ 02869000
*   /* DEB TABLE.                                            @Y30LB35*/ 02870000
*   /*                                                               */ 02871000
*   /*****************************************************************/ 02872000
*                                                                  0881 02873000
*L82SVC1:                           /*                       @Y30LB35*/ 02874000
*   SVC(82);                        /*                       @Y30LB35*/ 02875000
L82SVC1  SVC   82                                                  0881 02876000
*   RESPECIFY                                                      0882 02877000
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/ 02878000
*   TESTRC=0;                       /*                       @Y30LB35*/ 02879000
*                                                                  0883 02880000
         SLR   @03,@03                                             0883 02881000
         STH   @03,TESTRC                                          0883 02882000
*   /*****************************************************************/ 02883000
*   /*                                                               */ 02884000
*   /* CONTROL IS RETURNED TO OPENPROC                       @Y30LB35*/ 02885000
*   /* WITH A RETURN CODE ZERO AS CURRENTLY                  @Y30LB35*/ 02886000
*   /* THERE A NO POSSIBLE ERRORS WHICH WILL                 @Y30LB35*/ 02887000
*   /* NOT ABEND THE TASK.                                   @Y30LB35*/ 02888000
*   /*                                                               */ 02889000
*   /*****************************************************************/ 02890000
*                                                                  0884 02891000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 02892000
         LH    @15,TESTRC                                          0884 02893000
         L     @14,12(,@13)                                        0884 02894000
         LM    @00,@12,20(@13)                                     0884 02895000
         BR    @14                                                 0884 02896000
*   END OPNNEW;                     /*                       @Y30LB35*/ 02897000
*                                                                  0886 02898000
*/********************************************************************/ 02899000
*/*                                                          @Y30LB35*/ 02900000
*/* PROCEDURE NAME - BLDBLK                                  @Y30LB35*/ 02901000
*/*                                                          @Y30LB35*/ 02902000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 02903000
*/*             INITIALIZE CONTROL BLOCKS TO PERFORM I/O     @Y30LB35*/ 02904000
*/*             PROCESSING.  THIS IS DONE BY THE FOLLOWING   @Y30LB35*/ 02905000
*/*             STEPS:                                       @Y30LB35*/ 02906000
*/*             ISSUES UGSPACE, INITIALIZES THE IOXCTLBK     @Y30LB35*/ 02907000
*/*             INITIALIZES THE IOXIOB, AND CALL READJFCB.   @Y30LB35*/ 02908000
*/*                                                          @Y30LB35*/ 02909000
*/*             THE ERROR MESSAGE IDC2371I IS ISSUED IF      @Y30LB35*/ 02910000
*/*             THE UGSPACE IS UNSUCCESSFUL.                 @Y30LB35*/ 02911000
*/*                                                          @Y30LB35*/ 02912000
*/* INPUT -     EXOLAB IN EXOAGL                             @Y30LB35*/ 02913000
*/*             EXOTAB IN EXOAGL                             @Y30LB35*/ 02914000
*/*             EXOPASS IN EXOAGL                            @Y30LB35*/ 02915000
*/*             EXONEW IN EXOAGL                             @Y30LB35*/ 02916000
*/*             USERDDN IN CALLER'S CORE                     @Y30LB35*/ 02917000
*/*             IOXCTLBK                                     @Y30LB35*/ 02918000
*/*             BLKSIZE                                      @Y30LB35*/ 02919000
*/*                                                          @Y30LB35*/ 02920000
*/* OUTPUT -    DCBDDNAM IN IOXDCB                           @Y30LB35*/ 02921000
*/*             DCBEXLSA IN IOXDCB                           @Y30LB35*/ 02922000
*/*             IOBCMDCH IN IOXIOB                           @Y30LB35*/ 02923000
*/*             IOBECBPT IN IOXIOB                           @Y30LB35*/ 02924000
*/*             IOBSTART IN IOXIOB                           @Y30LB35*/ 02925000
*/*             IOBDCBPT IN IOXIOB                           @Y30LB35*/ 02926000
*/*             USERIOBP IN CALLER'S CORE                    @Y30LB35*/ 02927000
*/*             BLKSIZE                                      @Y30LB35*/ 02928000
*/*             IOXCTLBK                                     @Y30LB35*/ 02929000
*/*             IOBSTPTR                                     @Y30LB35*/ 02930000
*/*             DCBPTR                                       @Y30LB35*/ 02931000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 02932000
*/*                           4, ERROR IN UGSPACE            @Y30LB35*/ 02933000
*/*                           4, ERROR IN READJFCB           @Y30LB35*/ 02934000
*/*                                                          @Y30LB35*/ 02935000
*/********************************************************************/ 02936000
*                                                                  0886 02937000
*                                   /*                       @Y30LB35*/ 02938000
*BLDBLK:                                                           0886 02939000
*   PROC;                           /*                       @Y30LB35*/ 02940000
*                                                                  0886 02941000
BLDBLK   STM   @14,@12,@SA00010                                    0886 02942000
*   /*****************************************************************/ 02943000
*   /*                                                               */ 02944000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 02945000
*   /*                                                               */ 02946000
*   /*****************************************************************/ 02947000
*                                                                  0887 02948000
*   DCL                                                            0887 02949000
*     BLKSIZE FIXED(31);            /*                       @Y30LB35   02950000
*                                      VARIABLE TO CALCULATE @Y30LB35   02951000
*                                      THE IOXCTLBK SIZE.    @Y30LB35*/ 02952000
*   DCL                                                            0888 02953000
*     NEWCCWLN FIXED(15) INIT(1448) STATIC;/*                @Z40LB35   02954000
*                                      IF NEW VOLUME,        @Y30LB35   02955000
*                                      THIS WILL BE          @Y30LB35   02956000
*                                      SIZE OF THE CCWS      @Y30LB35*/ 02957000
*   DCL                                                            0889 02958000
*     LABCCWLN FIXED(15) INIT(80) STATIC;/*                  @Z40LB35   02959000
*                                      IF VOLUME LABEL,      @Y30LB35   02960000
*                                      THIS WILL BE          @Y30LB35   02961000
*                                      SIZE OF THE CCWS      @Y30LB35*/ 02962000
*   DCL                                                            0890 02963000
*     TABCCWLN FIXED(15) INIT(400) STATIC;/*                 @Z40LB35   02964000
*                                      IF TABLES,            @Y30LB35   02965000
*                                      THIS WILL BE          @Y30LB35   02966000
*                                      SIZE OF THE CCWS      @Y30LB35*/ 02967000
*   DCL                                                            0891 02968000
*     VTOCCWLN FIXED(15) INIT(400) STATIC;/*                 @Z40LB35   02969000
*                                      IF VTOC,              @Z40LB35   02970000
*                                      THIS WILL BE          @Z40LB35   02971000
*                                      SIZE OF THE CCWS      @Z40LB35*/ 02972000
*   DCL                                                            0892 02973000
*     RPRWCCLN FIXED(15) INIT(4000) STATIC;/*                @0Z11014   02974000
*                                      IF REPAIRV, THIS WILL @0Z11014   02975000
*                                      BE SIZE OF THE CCWS   @ZA11014*/ 02976000
*   DCL                                                            0893 02977000
*     DCBEXCP GEND CHAR(LENGTH(IHADCB));/*                   @Y30LB35*/ 02978000
*   DCL                                                            0894 02979000
*     DCBEXCP1 GEND CHAR(LENGTH(IHADCB)/*                    @ZA11014*/ 02980000
*         +LENGTH(IHADCS28)         /*                       @ZA11014*/ 02981000
*         +LENGTH(IHADCS44));       /*                       @ZA11014   02982000
*                                      BE SIZE OF THE CCWS   @ZA11014   02983000
*                                      ASSEM TO PLS          @Y30LB35   02984000
*                                      ADDRESSABILITY OF DCB @Y30LB35*/ 02985000
*                                                                  0894 02986000
*   /*****************************************************************/ 02987000
*   /*                                                               */ 02988000
*   /* THE FOLLOWING CONSTANTS WILL BE PLACED IN             @Y30LB35*/ 02989000
*   /* FRONT OF THE VARIOUS CONTROL BLOCKS TO                @Y30LB35*/ 02990000
*   /* AID IN LOCATING THEM IN A DUMP.                       @Y30LB35*/ 02991000
*   /*                                                               */ 02992000
*   /*****************************************************************/ 02993000
*                                                                  0895 02994000
*   DCL                                                            0895 02995000
*     IDIOX CHAR(8) CONSTANT('IOXCTLBK');/*                  @Y30LB35   02996000
*                                      ID FOR IOXCTLBK       @Y30LB35*/ 02997000
*   DCL                                                            0896 02998000
*     IDIOXDCB CHAR(4) CONSTANT('DCB ');/*                   @Y30LB35   02999000
*                                      ID FOR DCB            @Y30LB35*/ 03000000
*   DCL                                                            0897 03001000
*     IDIOXECB CHAR(4) CONSTANT('ECB ');/*                   @Y30LB35   03002000
*                                      ID FOR ECB            @Y30LB35*/ 03003000
*   DCL                                                            0898 03004000
*     IDIOXIOB CHAR(4) CONSTANT('IOB ');/*                   @Y30LB35   03005000
*                                      ID FOR IOB            @Y30LB35*/ 03006000
*   DCL                                                            0899 03007000
*     IDIOXEX CHAR(4) CONSTANT('XLST');/*                    @Y30LB35   03008000
*                                      ID FOR DCB EXT. LIST  @Y30LB35*/ 03009000
*   DCL                                                            0900 03010000
*     IDJFCB CHAR(4) CONSTANT('JFCB');/*                     @Y30LB35   03011000
*                                      ID FOR JFCB           @Y30LB35*/ 03012000
*   DCL                                                            0901 03013000
*     IDIOXCCW CHAR(4) CONSTANT('CCW ');/*                   @Y30LB35   03014000
*                                      ID FOR CCWS           @Y30LB35*/ 03015000
*                                                                  0902 03016000
*   /*****************************************************************/ 03017000
*   /*                                                               */ 03018000
*   /* SET UP TRACE POINT 'IOBB' IN TRACE TABLE              @Y30LB35*/ 03019000
*   /*                                                               */ 03020000
*   /*****************************************************************/ 03021000
*                                                                  0902 03022000
*   OLDERID2=NEWERID2;                                             0902 03023000
         L     @03,@PC00001                                        0902 03024000
         L     @03,GDTTR2(,@03)                                    0902 03025000
         L     @15,@PC00001                                        0902 03026000
         L     @01,GDTTR2(,@15)                                    0902 03027000
         MVC   @TS00001(95),NEWERID2(@01)                          0902 03028000
         MVC   OLDERID2(95,@03),@TS00001                           0902 03029000
*   NEWID2='IOBB';                  /*                       @Y30LB35*/ 03030000
*                                                                  0903 03031000
         L     @03,@PC00001                                        0903 03032000
         L     @03,GDTTR2(,@03)                                    0903 03033000
         MVC   NEWID2(4,@03),@CC04243                              0903 03034000
*   /*****************************************************************/ 03035000
*   /*                                                               */ 03036000
*   /* IF THE CALLER WILL BE INITIALIZING                    @Y30LB35*/ 03037000
*   /* A NEW VOLUME, IOXCTLBK SIZE WILL BE AS                @Y30LB35*/ 03038000
*   /* FOLLOWS.                                              @Y30LB35*/ 03039000
*   /*                                                               */ 03040000
*   /*****************************************************************/ 03041000
*                                                                  0904 03042000
*   IF EXONEW=ON                    /*                       @Y30LB35*/ 03043000
*     THEN                          /*                       @Y30LB35*/ 03044000
*                                                                  0904 03045000
         L     @03,@PC00001+8                                      0904 03046000
         TM    EXONEW(@03),B'00010000'                             0904 03047000
         BNO   @RF00904                                            0904 03048000
*     /***************************************************************/ 03049000
*     /*                                                             */ 03050000
*     /* BLOCKSIZE WILL BE THE BASIC STRUCTURE               @Y30LB35*/ 03051000
*     /* PLUS THE CCWS FOR WRITING COUNT KEY DATA            @Y30LB35*/ 03052000
*     /*                                                             */ 03053000
*     /***************************************************************/ 03054000
*                                                                  0905 03055000
*     BLKSIZE=LENGTH(IOCTLBK)+NEWCCWLN;/*                    @Y30LB35*/ 03056000
         LA    @03,384                                             0905 03057000
         AH    @03,NEWCCWLN                                        0905 03058000
         ST    @03,BLKSIZE                                         0905 03059000
*   ELSE                            /*                       @ZA11014*/ 03060000
*                                                                  0906 03061000
*     /***************************************************************/ 03062000
*     /*                                                             */ 03063000
*     /* IF THE CALLER WILL ONLY OPEN                        @ZA11014*/ 03064000
*     /* FOR REPAIRV PROCESSING, THE STORAGE                 @ZA11014*/ 03065000
*     /* OBTAINED FOR THE CCWS WILL BE LARGE                 @ZA11014*/ 03066000
*     /* ENOUGH FOR THE READ CCWS, THE WRITE CCWS, AND       @ZA11014*/ 03067000
*     /* THE VERIFY READ CCWS                                @ZA11014*/ 03068000
*     /*                                                             */ 03069000
*     /***************************************************************/ 03070000
*                                                                  0906 03071000
*     IF EXOREP=ON                  /*                       @ZA11014*/ 03072000
*       THEN                        /*                       @ZA11014*/ 03073000
*                                                                  0906 03074000
         B     @RC00904                                            0906 03075000
@RF00904 L     @03,@PC00001+8                                      0906 03076000
         TM    EXOREP(@03),B'00000100'                             0906 03077000
         BNO   @RF00906                                            0906 03078000
*       /*************************************************************/ 03079000
*       /*                                                           */ 03080000
*       /* BLOCKSIZE WILL ONLY BE THE BASIC STRUCTURE        @ZA11014*/ 03081000
*       /* PLUS THE CCWS FOR READING AND WRITING             @ZA11014*/ 03082000
*       /*                                                           */ 03083000
*       /*************************************************************/ 03084000
*                                                                  0907 03085000
*       BLKSIZE=LENGTH(IOCTLBK)+RPRWCCLN;/*                  @ZA11014*/ 03086000
         LA    @03,384                                             0907 03087000
         AH    @03,RPRWCCLN                                        0907 03088000
         ST    @03,BLKSIZE                                         0907 03089000
*     ELSE                          /*                       @Y30LB35*/ 03090000
*                                                                  0908 03091000
*       /*************************************************************/ 03092000
*       /*                                                           */ 03093000
*       /* IF THE CALLER WILL BE PROCESSING THE VOLUME       @Y30LB35*/ 03094000
*       /* LABEL, THE IOXCTLBK SIZE WILL BE AS FOLLOWS.      @Y30LB35*/ 03095000
*       /*                                                           */ 03096000
*       /*************************************************************/ 03097000
*                                                                  0908 03098000
*       IF EXOLAB=ON                /*                       @Y30LB35*/ 03099000
*         THEN                      /*                       @Y30LB35*/ 03100000
*                                                                  0908 03101000
         B     @RC00906                                            0908 03102000
@RF00906 L     @03,@PC00001+8                                      0908 03103000
         TM    EXOLAB(@03),B'01000000'                             0908 03104000
         BNO   @RF00908                                            0908 03105000
*         /***********************************************************/ 03106000
*         /*                                                         */ 03107000
*         /* BLOCKSIZE WILL BE THE BASIC STRUCTURE           @Y30LB35*/ 03108000
*         /* PLUS THE CCWS FOR WRITING KEY AND DATA          @Y30LB35*/ 03109000
*         /*                                                         */ 03110000
*         /***********************************************************/ 03111000
*                                                                  0909 03112000
*         BLKSIZE=LENGTH(IOCTLBK)+LABCCWLN;/*                @Y30LB35*/ 03113000
         LA    @03,384                                             0909 03114000
         AH    @03,LABCCWLN                                        0909 03115000
         ST    @03,BLKSIZE                                         0909 03116000
*       ELSE                        /*                       @Y30LB35*/ 03117000
*                                                                  0910 03118000
*         /***********************************************************/ 03119000
*         /*                                                         */ 03120000
*         /* IF THE CALLER WILL BE PROCESSING THE MSS        @Y30LB35*/ 03121000
*         /* TABLES, THE IOXCTLBK SIZE WILL BE AS FOLLOWS.   @Y30LB35*/ 03122000
*         /*                                                         */ 03123000
*         /***********************************************************/ 03124000
*                                                                  0910 03125000
*         IF EXOTAB=ON              /*                       @Y30LB35*/ 03126000
*           THEN                    /*                       @Y30LB35*/ 03127000
*                                                                  0910 03128000
         B     @RC00908                                            0910 03129000
@RF00908 L     @03,@PC00001+8                                      0910 03130000
         TM    EXOTAB(@03),B'10000000'                             0910 03131000
         BNO   @RF00910                                            0910 03132000
*           /*********************************************************/ 03133000
*           /*                                                       */ 03134000
*           /* BLOCKSIZE WILL BE THE BASIC STRUCTURE         @Y30LB35*/ 03135000
*           /* PLUS THE CCWS FOR READING KEY AND DATA        @Y30LB35*/ 03136000
*           /*                                                       */ 03137000
*           /*********************************************************/ 03138000
*                                                                  0911 03139000
*           BLKSIZE=LENGTH(IOCTLBK)+TABCCWLN;/*              @Y30LB35*/ 03140000
         LA    @03,384                                             0911 03141000
         AH    @03,TABCCWLN                                        0911 03142000
         ST    @03,BLKSIZE                                         0911 03143000
*         ELSE                      /*                       @Z40LB35*/ 03144000
*                                                                  0912 03145000
*           /*********************************************************/ 03146000
*           /*                                                       */ 03147000
*           /* IF THE CALLER WILL BE PROCESSING THE VTOC,    @Z40LB35*/ 03148000
*           /* THE IOXCTLBK SIZE WILL BE AS FOLLOWS.         @Z40LB35*/ 03149000
*           /*                                                       */ 03150000
*           /*********************************************************/ 03151000
*                                                                  0912 03152000
*           IF EXOVTOC=ON           /*                       @Z40LB35*/ 03153000
*             THEN                  /*                       @Z40LB35*/ 03154000
*                                                                  0912 03155000
         B     @RC00910                                            0912 03156000
@RF00910 L     @03,@PC00001+8                                      0912 03157000
         TM    EXOVTOC(@03),B'00001000'                            0912 03158000
         BNO   @RF00912                                            0912 03159000
*             /*******************************************************/ 03160000
*             /*                                                     */ 03161000
*             /* BLOCKSIZE WILL BE THE BASIC STRUCTURE       @Z40LB35*/ 03162000
*             /* PLUS THE CCWS FOR READING KEY AND DATA      @Z40LB35*/ 03163000
*             /*                                                     */ 03164000
*             /*******************************************************/ 03165000
*                                                                  0913 03166000
*             BLKSIZE=LENGTH(IOCTLBK)+VTOCCWLN;/*            @Z40LB35*/ 03167000
         LA    @03,384                                             0913 03168000
         AH    @03,VTOCCWLN                                        0913 03169000
         ST    @03,BLKSIZE                                         0913 03170000
*           ELSE                    /*                       @Z40LB35*/ 03171000
*                                                                  0914 03172000
*             /*******************************************************/ 03173000
*             /*                                                     */ 03174000
*             /* IF THE CALLER WILL ONLY OPEN THE            @Y30LB35*/ 03175000
*             /* DATA SET TO DETERMINE IF THE OPERATOR       @Y30LB35*/ 03176000
*             /* CAN SUPPLY THE CORRECT PASSWORD, THEN       @Y30LB35*/ 03177000
*             /* THERE WILL NOT BE ANY STORAGE OBTAINED      @Y30LB35*/ 03178000
*             /* FOR THE CCW STRING.                         @Y30LB35*/ 03179000
*             /*                                                     */ 03180000
*             /*******************************************************/ 03181000
*                                                                  0914 03182000
*             IF EXOPASS=ON         /*                       @Z40LB35*/ 03183000
*               THEN                /*                       @Z40LB35*/ 03184000
*                                                                  0914 03185000
         B     @RC00912                                            0914 03186000
@RF00912 L     @03,@PC00001+8                                      0914 03187000
         TM    EXOPASS(@03),B'00100000'                            0914 03188000
         BNO   @RF00914                                            0914 03189000
*               /*****************************************************/ 03190000
*               /*                                                   */ 03191000
*               /* BLOCKSIZE WILL ONLY BE THE SIZE OF THE    @Y30LB35*/ 03192000
*               /* IOXCTLBK BASIC STRUCTURE.                 @Y30LB35*/ 03193000
*               /*                                                   */ 03194000
*               /*****************************************************/ 03195000
*                                                                  0915 03196000
*               BLKSIZE=LENGTH(IOCTLBK)+8;/*                 @ZA16127*/ 03197000
         MVC   BLKSIZE(4),@CF04409                                 0915 03198000
*             ELSE                  /*                       @Z40LB35*/ 03199000
*                                                                  0916 03200000
*               /*****************************************************/ 03201000
*               /*                                                   */ 03202000
*               /* IF THE TESTS ARE NEGITIVE AS TO WHICH     @Y30LB35*/ 03203000
*               /* TYPE I/O PROCESSING IS DESIRED, THEN THERE        */ 03204000
*               /*                                           @Y30LB35*/ 03205000
*               /* IS A BAD PARM LIST AND UABORT(40) IS ISSUED.      */ 03206000
*               /*                                           @Y30LB35*/ 03207000
*               /*                                                   */ 03208000
*               /*****************************************************/ 03209000
*                                                                  0916 03210000
*               DO;                                                0916 03211000
         B     @RC00914                                            0916 03212000
@RF00914 DS    0H                                                  0917 03213000
*                 RESPECIFY                                        0917 03214000
*                  (REG13,                                         0917 03215000
*                   REG14,                                         0917 03216000
*                   REG15) RSTD;                                   0917 03217000
*                 REG15=40;                                        0918 03218000
         LA    REG15,40                                            0918 03219000
*                 REG14=GDTABT;                                    0919 03220000
         L     @03,@PC00001                                        0919 03221000
         L     REG14,GDTABT(,@03)                                  0919 03222000
*                 REG13=GDTABH;                                    0920 03223000
         L     @03,@PC00001                                        0920 03224000
         L     REG13,GDTABH(,@03)                                  0920 03225000
*                 GEN(BR    REG14);                                0921 03226000
         BR    REG14                                                    03227000
*                 RESPECIFY                                        0922 03228000
*                  (REG13,                                         0922 03229000
*                   REG14,                                         0922 03230000
*                   REG15) UNRSTD;                                 0922 03231000
*               END;                /*                       @Z40LB35*/ 03232000
*                                                                  0923 03233000
*   /*****************************************************************/ 03234000
*   /*                                                               */ 03235000
*   /* THE CORE IS GETTEN FOR THE IOXCTLBK.                  @Y30LB35*/ 03236000
*   /*                                                               */ 03237000
*   /*****************************************************************/ 03238000
*                                                                  0924 03239000
*   CALL IDCSAGS0(GDTTBL,BLKSIZE,IOCTLBKP,SETZERO);/*        @Y30LB35*/ 03240000
@RC00914 DS    0H                                                  0924 03241000
@RC00912 DS    0H                                                  0924 03242000
@RC00910 DS    0H                                                  0924 03243000
@RC00908 DS    0H                                                  0924 03244000
@RC00906 DS    0H                                                  0924 03245000
@RC00904 L     @03,@PC00001                                        0924 03246000
         ST    @03,@AL00001                                        0924 03247000
         LA    @03,BLKSIZE                                         0924 03248000
         ST    @03,@AL00001+4                                      0924 03249000
         LA    @03,IOCTLBKP                                        0924 03250000
         ST    @03,@AL00001+8                                      0924 03251000
         LA    @03,SETZERO                                         0924 03252000
         ST    @03,@AL00001+12                                     0924 03253000
         MVI   @AL00001+12,X'80'                                   0924 03254000
         L     @03,@PC00001                                        0924 03255000
         L     @15,GDTGSP(,@03)                                    0924 03256000
         LA    @01,@AL00001                                        0924 03257000
         BALR  @14,@15                                             0924 03258000
*   RESPECIFY                                                      0925 03259000
*     RTNREG RSTD;                                                 0925 03260000
*   TESTRC=RTNREG;                                                 0926 03261000
         STH   RTNREG,TESTRC                                       0926 03262000
*   RESPECIFY                                                      0927 03263000
*     RTNREG UNRSTD;                /*                       @Y30LB35*/ 03264000
*                                                                  0928 03265000
*   /*****************************************************************/ 03266000
*   /*                                                               */ 03267000
*   /* PROVIDING THE UGSPACE WAS SUCCESSFUL, THE             @Y30LB35*/ 03268000
*   /* IOXCTLBK IS INITIALIZED HERE.                         @Y30LB35*/ 03269000
*   /*                                                               */ 03270000
*   /*****************************************************************/ 03271000
*                                                                  0928 03272000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 03273000
*     THEN                          /*                       @Y30LB35*/ 03274000
         LH    @03,TESTRC                                          0928 03275000
         LTR   @03,@03                                             0928 03276000
         BNZ   @RF00928                                            0928 03277000
*     DO;                           /*                       @Y30LB35*/ 03278000
*                                                                  0929 03279000
*       /*************************************************************/ 03280000
*       /*                                                           */ 03281000
*       /* HERE THE CONTROL BLOCK CHARACTER                  @Y30LB35*/ 03282000
*       /* IDENTIFICATIONS ARE MOVED INTO IOXCTLBK           @Y30LB35*/ 03283000
*       /* SO THAT THEY WILL IMMEDIATLY PRECEDE EACH         @Y30LB35*/ 03284000
*       /* CONTROL BLOCK. THIS IS BEING DONE SO THAT         @Y30LB35*/ 03285000
*       /* WHEN A DUMP IS BEING READ EACH CONTROL BLOCK      @Y30LB35*/ 03286000
*       /* CAN BE FOUND.                                     @Y30LB35*/ 03287000
*       /*                                                           */ 03288000
*       /*************************************************************/ 03289000
*                                                                  0930 03290000
*       IOXID=IDIOX;                /*                       @Y30LB35*/ 03291000
         L     @03,IOCTLBKP                                        0930 03292000
         MVC   IOXID(8,@03),@CC04230                               0930 03293000
*       IOXDCBID=IDIOXDCB;          /*                       @Y30LB35*/ 03294000
         L     @03,IOCTLBKP                                        0931 03295000
         MVC   IOXDCBID(4,@03),@CC04232                            0931 03296000
*       IOXECBID=IDIOXECB;          /*                       @Y30LB35*/ 03297000
         L     @03,IOCTLBKP                                        0932 03298000
         MVC   IOXECBID(4,@03),@CC04234                            0932 03299000
*       IOXIOBID=IDIOXIOB;          /*                       @Y30LB35*/ 03300000
         L     @03,IOCTLBKP                                        0933 03301000
         MVC   IOXIOBID(4,@03),@CC04236                            0933 03302000
*       IOXEXID=IDIOXEX;            /*                       @Y30LB35*/ 03303000
         L     @03,IOCTLBKP                                        0934 03304000
         MVC   IOXEXID(4,@03),@CC04238                             0934 03305000
*       IOXJFCBI=IDJFCB;            /*                       @Y30LB35*/ 03306000
         L     @03,IOCTLBKP                                        0935 03307000
         MVC   IOXJFCBI(4,@03),@CC04240                            0935 03308000
*       IOXCCWID=IDIOXCCW;          /*                       @Y30LB35*/ 03309000
*                                                                  0936 03310000
         L     @03,IOCTLBKP                                        0936 03311000
         MVC   IOXCCWID(4,@03),@CC04242                            0936 03312000
*       /*************************************************************/ 03313000
*       /*                                                           */ 03314000
*       /* THE MODEL DCB IS MOVED INTO IT PLACE IN THE       @Y30LB35*/ 03315000
*       /* IOXCTLBK                                          @Y30LB35*/ 03316000
*       /* FOR REPAIRV PROCESSING A DCB WITH THE             @ZA11014*/ 03317000
*       /* ABNORMAL END APPENDAGE ADDITION IS MOVED IN       @ZA11014*/ 03318000
*       /*                                                           */ 03319000
*       /*************************************************************/ 03320000
*                                                                  0937 03321000
*       IF EXOREP=ON                /*                       @ZA11014*/ 03322000
*         THEN                      /*                       @ZA11014*/ 03323000
         L     @03,@PC00001+8                                      0937 03324000
         TM    EXOREP(@03),B'00000100'                             0937 03325000
         BNO   @RF00937                                            0937 03326000
*         IOXDCB=DCBEXCP1;          /*                       @ZA11014*/ 03327000
         L     @03,IOCTLBKP                                        0938 03328000
         MVC   IOXDCB(72,@03),DCBEXCP1                             0938 03329000
*       ELSE                        /*                       @ZA11014*/ 03330000
*         IOXDCB=DCBEXCP;           /*                       @ZA11014*/ 03331000
*                                                                  0939 03332000
         B     @RC00937                                            0939 03333000
@RF00937 L     @03,IOCTLBKP                                        0939 03334000
         MVI   IOXDCB+52(@03),C' '                                 0939 03335000
         MVC   IOXDCB+53(19,@03),IOXDCB+52(@03)                    0939 03336000
         MVC   IOXDCB(52,@03),DCBEXCP                              0939 03337000
*       /*************************************************************/ 03338000
*       /*                                                           */ 03339000
*       /* THE DCB EXTENT LIST USED IN OPEN AND CLOSE        @Y30LB35*/ 03340000
*       /* IS MOVED INTO THE IOXCTLBK.                       @Y30LB35*/ 03341000
*       /*                                                           */ 03342000
*       /*************************************************************/ 03343000
*                                                                  0940 03344000
*       IOXEXLST=EXLIST;            /*                       @Y30LB35*/ 03345000
@RC00937 L     @03,IOCTLBKP                                        0940 03346000
         MVC   IOXEXLST(8,@03),EXLIST                              0940 03347000
*                                                                  0941 03348000
*       /*************************************************************/ 03349000
*       /*                                                           */ 03350000
*       /* HERE THE UCB ADDRESS IS MOVED INTO THE            @Y30LB35*/ 03351000
*       /* IOXCTLBK                                          @Y30LB35*/ 03352000
*       /*                                                           */ 03353000
*       /*************************************************************/ 03354000
*                                                                  0941 03355000
*       IOXUCBP=EXOUCB;             /*                       @Y30LB35*/ 03356000
*                                                                  0941 03357000
         L     @03,@PC00001+8                                      0941 03358000
         L     @03,EXOUCB(,@03)                                    0941 03359000
         L     @01,IOCTLBKP                                        0941 03360000
         ST    @03,IOXUCBP(,@01)                                   0941 03361000
*       /*************************************************************/ 03362000
*       /*                                                           */ 03363000
*       /* THE POINTER IS STORED INTO CALLER'S CORE          @Y30LB35*/ 03364000
*       /* TO BE PASSED BACK ON SUBSEQUENT CALLS.            @Y30LB35*/ 03365000
*       /*                                                           */ 03366000
*       /*************************************************************/ 03367000
*                                                                  0942 03368000
*       USERIOBP=IOCTLBKP;          /*                       @Y30LB35*/ 03369000
*                                                                  0942 03370000
         L     @03,@PC00001+8                                      0942 03371000
         L     @03,EXOCTLBK(,@03)                                  0942 03372000
         L     @15,IOCTLBKP                                        0942 03373000
         ST    @15,USERIOBP(,@03)                                  0942 03374000
*       /*************************************************************/ 03375000
*       /*                                                           */ 03376000
*       /* ADDRESSABILITY IS SET UP FOR DCB AND DCB          @Y30LB35*/ 03377000
*       /* EXTENT LIST                                       @Y30LB35*/ 03378000
*       /*                                                           */ 03379000
*       /*************************************************************/ 03380000
*                                                                  0943 03381000
*       DCBPTR=ADDR(IOXDCB);        /*                       @Y30LB35*/ 03382000
         L     @03,IOCTLBKP                                        0943 03383000
         LA    @03,IOXDCB(,@03)                                    0943 03384000
         ST    @03,DCBPTR                                          0943 03385000
*       DCBEXLSA=ADDR(IOXEXLST);    /*                       @Y30LB35*/ 03386000
         L     @03,IOCTLBKP                                        0944 03387000
         LA    @03,IOXEXLST(,@03)                                  0944 03388000
         L     @01,DCBPTR                                          0944 03389000
         STCM  @03,7,DCBEXLSA+28(@01)                              0944 03390000
*                                                                  0945 03391000
*       /*************************************************************/ 03392000
*       /*                                                           */ 03393000
*       /* IF CALLER HAS PASSED THE DDNAME, IT IS            @Y30LB35*/ 03394000
*       /* MOVED INTO THE DCB AND IOXCTLBK.                  @Y30LB35*/ 03395000
*       /*                                                           */ 03396000
*       /*************************************************************/ 03397000
*                                                                  0945 03398000
*       IF EXODDN^=NULLPTR THEN     /*                       @Y30LB35*/ 03399000
         L     @03,@PC00001+8                                      0945 03400000
         L     @03,EXODDN(,@03)                                    0945 03401000
         LTR   @03,@03                                             0945 03402000
         BZ    @RF00945                                            0945 03403000
*         DO;                       /*                       @Y30LB35*/ 03404000
*           DCBDDNAM=USERDDN;       /*                       @Y30LB35*/ 03405000
         L     @03,DCBPTR                                          0947 03406000
         L     @15,@PC00001+8                                      0947 03407000
         L     @01,EXODDN(,@15)                                    0947 03408000
         MVC   DCBDDNAM+40(8,@03),USERDDN(@01)                     0947 03409000
*           IOXDDN=USERDDN;         /*                       @Y30LB35*/ 03410000
         L     @03,IOCTLBKP                                        0948 03411000
         L     @15,@PC00001+8                                      0948 03412000
         L     @01,EXODDN(,@15)                                    0948 03413000
         MVC   IOXDDN(8,@03),USERDDN(@01)                          0948 03414000
*         END;                      /*                       @Y30LB35*/ 03415000
*       ELSE                        /*                       @Y30LB35*/ 03416000
*                                                                  0950 03417000
*         /***********************************************************/ 03418000
*         /*                                                         */ 03419000
*         /* THE DDNAME IS REQUIRED; THEREFORE,              @Y30LB35*/ 03420000
*         /* THE UABORT(40) IS ISSUED IF                     @Y30LB35*/ 03421000
*         /* CALLER FORGOT TO PASS IT.                       @Y30LB35*/ 03422000
*         /*                                                         */ 03423000
*         /***********************************************************/ 03424000
*                                                                  0950 03425000
*         DO;                                                      0950 03426000
         B     @RC00945                                            0950 03427000
@RF00945 DS    0H                                                  0951 03428000
*           RESPECIFY                                              0951 03429000
*            (REG13,                                               0951 03430000
*             REG14,                                               0951 03431000
*             REG15) RSTD;                                         0951 03432000
*           REG15=40;                                              0952 03433000
         LA    REG15,40                                            0952 03434000
*           REG14=GDTABT;                                          0953 03435000
         L     @03,@PC00001                                        0953 03436000
         L     REG14,GDTABT(,@03)                                  0953 03437000
*           REG13=GDTABH;                                          0954 03438000
         L     @03,@PC00001                                        0954 03439000
         L     REG13,GDTABH(,@03)                                  0954 03440000
*           GEN(BR    REG14);                                      0955 03441000
         BR    REG14                                                    03442000
*           RESPECIFY                                              0956 03443000
*            (REG13,                                               0956 03444000
*             REG14,                                               0956 03445000
*             REG15) UNRSTD;                                       0956 03446000
*         END;                      /*                       @Y30LB35*/ 03447000
*     END;                          /*                       @Y30LB35*/ 03448000
*                                                                  0958 03449000
*   /*****************************************************************/ 03450000
*   /*                                                               */ 03451000
*   /* IF THE RETURN CODE FROM UGSPACE IS                    @Y30LB35*/ 03452000
*   /* NOT ZERO THEN THE MESSAGE "IDC2371I                   @Y30LB35*/ 03453000
*   /* UNABLE TO OBTAIN CORE FOR I/O PROCESSING"             @Y30LB35*/ 03454000
*   /* IS SENT TO THE SYSPRINT LISTING.                      @Y30LB35*/ 03455000
*   /*                                                               */ 03456000
*   /*****************************************************************/ 03457000
*                                                                  0959 03458000
*   ELSE                            /*                       @Y30LB35*/ 03459000
*     DO;                           /*                       @Y30LB35*/ 03460000
*                                                                  0959 03461000
         B     @RC00928                                            0959 03462000
@RF00928 DS    0H                                                  0960 03463000
*       /*************************************************************/ 03464000
*       /*                                                           */ 03465000
*       /* INITIALIZE THE DARGLIST TO SEND TO UPRINT.        @Y30LB35*/ 03466000
*       /*                                                           */ 03467000
*       /*************************************************************/ 03468000
*                                                                  0960 03469000
*       DARGLIST=''B;               /*                       @Y30LB35*/ 03470000
         L     @03,DDSTRU                                          0960 03471000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      0960 03472000
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/ 03473000
         L     @03,DDSTRU                                          0961 03474000
         MVC   DARGSMOD(3,@03),@CC03785                            0961 03475000
*       DARGSENT=MSG2371I;          /*                       @Y30LB35*/ 03476000
*                                                                  0962 03477000
         L     @03,DDSTRU                                          0962 03478000
         MVI   DARGSENT(@03),X'02'                                 0962 03479000
*       /*************************************************************/ 03480000
*       /*                                                           */ 03481000
*       /* CALL UPRINT TO ISSUED ERROR MESSAGE.              @Y30LB35*/ 03482000
*       /*                                                           */ 03483000
*       /*************************************************************/ 03484000
*                                                                  0963 03485000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/ 03486000
         L     @03,@PC00001                                        0963 03487000
         ST    @03,@AL00001                                        0963 03488000
         LA    @03,@CF00119                                        0963 03489000
         ST    @03,@AL00001+4                                      0963 03490000
         LA    @03,DDSTRU                                          0963 03491000
         ST    @03,@AL00001+8                                      0963 03492000
         MVI   @AL00001+8,X'80'                                    0963 03493000
         L     @03,@PC00001                                        0963 03494000
         L     @15,GDTPRT(,@03)                                    0963 03495000
         LA    @01,@AL00001                                        0963 03496000
         BALR  @14,@15                                             0963 03497000
*     END;                          /*                       @Y30LB35*/ 03498000
*                                                                  0965 03499000
*   /*****************************************************************/ 03500000
*   /*                                                               */ 03501000
*   /* HERE A TEST WILL BE MADE TO DETERMINE                 @Y30LB35*/ 03502000
*   /* IF THE IOB CAN BE INITIALIZED.                        @Y30LB35*/ 03503000
*   /* THE IOB IS NOT REQUIRED FOR PASSWORD                  @Y30LB35*/ 03504000
*   /* PROCESSING AND IS NOT INITIALIZED.                    @Y30LB35*/ 03505000
*   /*                                                               */ 03506000
*   /*****************************************************************/ 03507000
*                                                                  0965 03508000
*   IF TESTRC=0&EXOPASS^=ON         /*                       @Y30LB35*/ 03509000
*     THEN                          /*                       @Y30LB35*/ 03510000
@RC00928 LH    @03,TESTRC                                          0965 03511000
         LTR   @03,@03                                             0965 03512000
         BNZ   @RF00965                                            0965 03513000
         L     @03,@PC00001+8                                      0965 03514000
         TM    EXOPASS(@03),B'00100000'                            0965 03515000
         BO    @RF00965                                            0965 03516000
*     DO;                           /*                       @Y30LB35*/ 03517000
*                                                                  0966 03518000
*       /*************************************************************/ 03519000
*       /*                                                           */ 03520000
*       /* INITIALIZATION OF THE IOB                         @Y30LB35*/ 03521000
*       /*                                                           */ 03522000
*       /*************************************************************/ 03523000
*                                                                  0967 03524000
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @Y30LB35*/ 03525000
*                                                                  0967 03526000
         L     @03,IOCTLBKP                                        0967 03527000
         LA    @03,IOXIOB(,@03)                                    0967 03528000
         ST    @03,IOBSTPTR                                        0967 03529000
*       /*************************************************************/ 03530000
*       /*                                                           */ 03531000
*       /* SET CCW COMMAND CHAINING BIT ON                   @Y30LB35*/ 03532000
*       /*                                                           */ 03533000
*       /*************************************************************/ 03534000
*                                                                  0968 03535000
*       IOBCMDCH=ON;                /*                       @Y30LB35*/ 03536000
*                                                                  0968 03537000
         L     @03,IOBSTPTR                                        0968 03538000
         OI    IOBCMDCH(@03),B'01000000'                           0968 03539000
*       /*************************************************************/ 03540000
*       /*                                                           */ 03541000
*       /* ADDRESSABILITY TO ECB, CCWS STRING, AND DCB       @Y30LB35*/ 03542000
*       /* IS SET UP.                                        @Y30LB35*/ 03543000
*       /*                                                           */ 03544000
*       /*************************************************************/ 03545000
*                                                                  0969 03546000
*       IOBECBPT=ADDR(IOXECB);      /*                       @Y30LB35*/ 03547000
         L     @03,IOCTLBKP                                        0969 03548000
         LA    @03,IOXECB(,@03)                                    0969 03549000
         L     @01,IOBSTPTR                                        0969 03550000
         ST    @03,IOBECBPT(,@01)                                  0969 03551000
*       IOBSTART=ADDR(IOXCCWS);     /*                       @Y30LB35*/ 03552000
         L     @03,IOCTLBKP                                        0970 03553000
         LA    @03,IOXCCWS(,@03)                                   0970 03554000
         L     @01,IOBSTPTR                                        0970 03555000
         ST    @03,IOBSTART(,@01)                                  0970 03556000
*       IOBDCBPT=ADDR(IOXDCB);      /*                       @Y30LB35*/ 03557000
         L     @03,IOCTLBKP                                        0971 03558000
         LA    @03,IOXDCB(,@03)                                    0971 03559000
         L     @01,IOBSTPTR                                        0971 03560000
         ST    @03,IOBDCBPT(,@01)                                  0971 03561000
*     END;                          /*                       @Y30LB35*/ 03562000
*                                                                  0973 03563000
*   /*****************************************************************/ 03564000
*   /*                                                               */ 03565000
*   /* IF THE PROCESS TO HERE WAS SUCCESSFUL,                @Y30LB35*/ 03566000
*   /* READJFCB PROC IS CALLED TO OBTAIN THE JFCB.           @Y30LB35*/ 03567000
*   /*                                                               */ 03568000
*   /*****************************************************************/ 03569000
*                                                                  0973 03570000
*   IF TESTRC=0                     /*                       @Y30LB35*/ 03571000
*     THEN                          /*                       @Y30LB35*/ 03572000
@RF00965 LH    @03,TESTRC                                          0973 03573000
         LTR   @03,@03                                             0973 03574000
         BNZ   @RF00973                                            0973 03575000
*     DO;                           /*                       @Y30LB35*/ 03576000
*       CALL READJFCB;              /*                       @Y30LB35*/ 03577000
         BAL   @14,READJFCB                                        0975 03578000
*       RESPECIFY                                                  0976 03579000
*         RTNREG RSTD;                                             0976 03580000
*       TESTRC=RTNREG;                                             0977 03581000
         STH   RTNREG,TESTRC                                       0977 03582000
*       RESPECIFY                                                  0978 03583000
*         RTNREG UNRSTD;            /*                       @Y30LB35*/ 03584000
*     END;                          /*                       @Y30LB35*/ 03585000
*                                                                  0979 03586000
*   /*****************************************************************/ 03587000
*   /*                                                               */ 03588000
*   /* CONTROL IS RETURNED TO OPENPROC WITH                  @Y30LB35*/ 03589000
*   /* A RETURN CODE OF 0 SUCCESSFUL OR 4 ERROR.             @Y30LB35*/ 03590000
*   /*                                                               */ 03591000
*   /*****************************************************************/ 03592000
*                                                                  0980 03593000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 03594000
@RF00973 LH    @15,TESTRC                                          0980 03595000
         L     @14,@SA00010                                        0980 03596000
         LM    @00,@12,@SA00010+8                                  0980 03597000
         BR    @14                                                 0980 03598000
*   END BLDBLK;                     /*                       @Y30LB35*/ 03599000
*                                                                  0982 03600000
*/********************************************************************/ 03601000
*/*                                                          @Y30LB35*/ 03602000
*/* PROCEDURE NAME - BLDCCWP1                                @Y30LB35*/ 03603000
*/*                                                          @Y30LB35*/ 03604000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 03605000
*/*             BUILD CCW'S TO WRITE "COUNT KEY DATA"        @Y30LB35*/ 03606000
*/*                                                          @Y30LB35*/ 03607000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 03608000
*/*                                                          @Y30LB35*/ 03609000
*/* INPUT -     USERCCHH IN CALLER'S CORE                    @Y30LB35*/ 03610000
*/*             EXPCCHHR IN EXPAGL                           @Y30LB35*/ 03611000
*/*             EXPDAYLN(X) IN EXPDATAB                      @Y30LB35*/ 03612000
*/*             EXPKEYLN(X) IN EXPDATAB                      @Y30LB35*/ 03613000
*/*             EXPDATAL(X) IN EXPDATAB                      @Y30LB35*/ 03614000
*/*             EXPRECNO IN EXPDATAB                         @Y30LB35*/ 03615000
*/*             CCWSIDEQ                                     @Y30LB35*/ 03616000
*/*             CCWTIC                                       @Y30LB35*/ 03617000
*/*             CCWWCKD                                      @Y30LB35*/ 03618000
*/*             CCWDATA                                      @Y30LB35*/ 03619000
*/*                                                          @Y30LB35*/ 03620000
*/* OUTPUT -    IOXCCW(X) IN IOXCTLBK                        @Y30LB35*/ 03621000
*/*             CNTCCHHR IN IOXCTLBK                         @Y30LB35*/ 03622000
*/*             CNTRECNO IN IOXCTLBK                         @Y30LB35*/ 03623000
*/*             CNTKEYLN IN IOXCTLBK                         @Y30LB35*/ 03624000
*/*             CNTDATLN IN IOXCTLBK                         @Y30LB35*/ 03625000
*/*             WRITECNT IN IOXCTLBK                         @Y30LB35*/ 03626000
*/*             READCNTA IN IOXCTLBK                         @ZA11014*/ 03627000
*/*             IOBSEEK  IN IOXIOB                           @Y30LB35*/ 03628000
*/*             CCWCMDCH IN IOXCCW                           @Y30LB35*/ 03629000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 03630000
*/*                                                          @Y30LB35*/ 03631000
*/********************************************************************/ 03632000
*                                                                  0982 03633000
*                                   /*                       @Y30LB35*/ 03634000
*BLDCCWP1:                                                         0982 03635000
*   PROC;                           /*                       @Y30LB35*/ 03636000
*                                                                  0982 03637000
BLDCCWP1 STM   @14,@12,12(@13)                                     0982 03638000
*   /*****************************************************************/ 03639000
*   /*                                                               */ 03640000
*   /* SET UP TRACE POINT 'IOP1' IN TRACE TABLE              @Y30LB35*/ 03641000
*   /*                                                               */ 03642000
*   /*****************************************************************/ 03643000
*                                                                  0983 03644000
*   OLDERID2=NEWERID2;                                             0983 03645000
         L     @03,@PC00001                                        0983 03646000
         L     @03,GDTTR2(,@03)                                    0983 03647000
         L     @15,@PC00001                                        0983 03648000
         L     @01,GDTTR2(,@15)                                    0983 03649000
         MVC   @TS00001(95),NEWERID2(@01)                          0983 03650000
         MVC   OLDERID2(95,@03),@TS00001                           0983 03651000
*   NEWID2='IOP1';                  /*                       @Y30LB35*/ 03652000
*                                                                  0984 03653000
         L     @03,@PC00001                                        0984 03654000
         L     @03,GDTTR2(,@03)                                    0984 03655000
         MVC   NEWID2(4,@03),@CC04248                              0984 03656000
*   /*****************************************************************/ 03657000
*   /*                                                               */ 03658000
*   /* HERE STARTS THE INITIALIZATION OF THE CCWS            @Y30LB35*/ 03659000
*   /* THE FIRST THING DONE IS THE MODEL CCW                 @Y30LB35*/ 03660000
*   /* SEARCH I.D. EQUAL IS MOVE INTO CCWS                   @Y30LB35*/ 03661000
*   /*                                                               */ 03662000
*   /*****************************************************************/ 03663000
*                                                                  0985 03664000
*   IOXCCW(1)=CCWSIDEQ;             /*                       @Y30LB35*/ 03665000
*                                                                  0985 03666000
         L     @03,IOCTLBKP                                        0985 03667000
         MVC   IOXCCW(8,@03),CCWSIDEQ                              0985 03668000
*   /*****************************************************************/ 03669000
*   /*                                                               */ 03670000
*   /* INITIALIZE CCW ARRAY COUNTER TO THE 1ST CCW           @Y30LB35*/ 03671000
*   /*                                                               */ 03672000
*   /*****************************************************************/ 03673000
*                                                                  0986 03674000
*   CCWCNT=1;                       /*                       @Y30LB35*/ 03675000
*                                                                  0986 03676000
         MVC   CCWCNT(2),@CH00222                                  0986 03677000
*   /*****************************************************************/ 03678000
*   /*                                                               */ 03679000
*   /* THE NEXT FIVE INSTRUCTIONS INITIALIZES THE            @Y30LB35*/ 03680000
*   /* SEARCH AND IOBSEEK CCHHR VALUE.                       @Y30LB35*/ 03681000
*   /*                                                               */ 03682000
*   /*****************************************************************/ 03683000
*                                                                  0987 03684000
*   USERCHRP=EXPCCHHR;              /*                       @Y30LB35*/ 03685000
         L     @03,@PC00001+8                                      0987 03686000
         L     @03,EXPCCHHR(,@03)                                  0987 03687000
         ST    @03,USERCHRP                                        0987 03688000
*   TEMPCCHH=''B;                   /*                       @Y30LB35*/ 03689000
         XC    TEMPCCHH(8),TEMPCCHH                                0988 03690000
*   TEMPCHR=USERCCHH;               /*                       @Y30LB35*/ 03691000
         L     @03,USERCHRP                                        0989 03692000
         MVC   TEMPCHR(5),USERCCHH(@03)                            0989 03693000
*   IOBSEEK=TEMPCCHH;               /*                       @Y30LB35*/ 03694000
         L     @03,IOBSTPTR                                        0990 03695000
         MVC   IOBSEEK(8,@03),TEMPCCHH                             0990 03696000
*   CCWADDR=ADDR(IOBCC);            /*                       @Y30LB35*/ 03697000
*                                                                  0991 03698000
         LH    @03,CCWCNT                                          0991 03699000
         SLA   @03,3                                               0991 03700000
         L     @01,IOCTLBKP                                        0991 03701000
         LA    @03,IOXCCW-8(@03,@01)                               0991 03702000
         L     @01,IOBSTPTR                                        0991 03703000
         LA    @15,IOBCC(,@01)                                     0991 03704000
         STCM  @15,7,CCWADDR(@03)                                  0991 03705000
*   /*****************************************************************/ 03706000
*   /*                                                               */ 03707000
*   /* HERE THE SECOND CCW IS INITIALIZED WITH               @Y30LB35*/ 03708000
*   /* THE TRANSFER IN CHANNEL (TIC) CCW.                    @Y30LB35*/ 03709000
*   /* THIS WILL ALLOW THE CHANNEL TO LOOP                   @Y30LB35*/ 03710000
*   /* UNTIL IT FINDS THE CCHHR IN THE SEARCH.               @Y30LB35*/ 03711000
*   /*                                                               */ 03712000
*   /*****************************************************************/ 03713000
*                                                                  0992 03714000
*   IOXCCW(2)=CCWTIC;               /*                       @Y30LB35*/ 03715000
         L     @03,IOCTLBKP                                        0992 03716000
         MVC   IOXCCW+8(8,@03),CCWTIC                              0992 03717000
*   CCWCNT=2;                       /*                       @Y30LB35*/ 03718000
         MVC   CCWCNT(2),@CH00036                                  0993 03719000
*   CCWADDR=ADDR(IOXCCW(1));        /*                       @Y30LB35*/ 03720000
*                                                                  0994 03721000
         LH    @03,CCWCNT                                          0994 03722000
         SLA   @03,3                                               0994 03723000
         L     @01,IOCTLBKP                                        0994 03724000
         LA    @03,IOXCCW-8(@03,@01)                               0994 03725000
         L     @01,IOCTLBKP                                        0994 03726000
         LA    @15,IOXCCW(,@01)                                    0994 03727000
         STCM  @15,7,CCWADDR(@03)                                  0994 03728000
*   /*****************************************************************/ 03729000
*   /*                                                               */ 03730000
*   /* THE CCW READ AND CCW WRITE COUNTER ARE                @Y30LB35*/ 03731000
*   /* INITIALIZED TO ZERO.                                  @Y30LB35*/ 03732000
*   /*                                                               */ 03733000
*   /*****************************************************************/ 03734000
*                                                                  0995 03735000
*   WRITECNT=ZERO;                  /*                       @Y30LB35*/ 03736000
         LH    @03,ZERO                                            0995 03737000
         STH   @03,WRITECNT                                        0995 03738000
*   READCNTA=ZERO;                  /*                       @ZA11014*/ 03739000
*                                                                  0996 03740000
         LH    @03,ZERO                                            0996 03741000
         STH   @03,READCNTA                                        0996 03742000
*   /*****************************************************************/ 03743000
*   /*                                                               */ 03744000
*   /* THE LASTCCW IS CALCULATED AND USED TO                 @Y30LB35*/ 03745000
*   /* CONTROL THE LOOP USED TO BUILD THE                    @Y30LB35*/ 03746000
*   /* WRITE COUNT KEY AND DATA CCWS FOR                     @Y30LB35*/ 03747000
*   /* ALL THE NEW RECORDS BEING WRITTEN.                    @Y30LB35*/ 03748000
*   /* ALSO DONE IS THE INITIALIZATION OF                    @Y30LB35*/ 03749000
*   /* COUNTER VARIABLE USED THE REFERENCE                   @Y30LB35*/ 03750000
*   /* EXPARRAY.                                             @Y30LB35*/ 03751000
*   /*                                                               */ 03752000
*   /*****************************************************************/ 03753000
*                                                                  0997 03754000
*   LASTCCW=(EXPRECNO*TWOCCWS)+TWOCCWS;/*                    @Y30LB35*/ 03755000
         L     @03,@PC00001+8                                      0997 03756000
         L     @03,EXPDATA(,@03)                                   0997 03757000
         L     @03,EXPRECNO(,@03)                                  0997 03758000
         MH    @03,TWOCCWS                                         0997 03759000
         AH    @03,TWOCCWS                                         0997 03760000
         STH   @03,LASTCCW                                         0997 03761000
*   ARRINDEX=1;                     /*                       @Y30LB35*/ 03762000
         MVC   ARRINDEX(2),@CH00222                                0998 03763000
*                                                                  0999 03764000
*   /*****************************************************************/ 03765000
*   /*                                                               */ 03766000
*   /* HERE LOOPING WILL BE PERFORMED WHILE                  @Y30LB35*/ 03767000
*   /* THE WRITE COUNT KEY AND DATA CCWS ARE BUILT.          @Y30LB35*/ 03768000
*   /*                                                               */ 03769000
*   /*****************************************************************/ 03770000
*                                                                  0999 03771000
*   DO CCWCNT=THREECCW BY TWOCCWS WHILE CCWCNT<=LASTCCW;           0999 03772000
*                                                                  0999 03773000
         LH    @03,THREECCW                                        0999 03774000
         STH   @03,CCWCNT                                          0999 03775000
         B     @DE00999                                            0999 03776000
@DL00999 DS    0H                                                  1000 03777000
*     /***************************************************************/ 03778000
*     /*                                                             */ 03779000
*     /* MOVE IN MODEL WRITE COUNT KEY AND DATA CCW          @Y30LB35*/ 03780000
*     /*                                                             */ 03781000
*     /***************************************************************/ 03782000
*                                                                  1000 03783000
*     IOXCCW(CCWCNT)=CCWWCKD;       /*                       @Y30LB35*/ 03784000
*                                                                  1000 03785000
         LH    @03,CCWCNT                                          1000 03786000
         SLA   @03,3                                               1000 03787000
         L     @01,IOCTLBKP                                        1000 03788000
         ALR   @01,@03                                             1000 03789000
         MVC   IOXCCW-8(8,@01),CCWWCKD                             1000 03790000
*     /***************************************************************/ 03791000
*     /*                                                             */ 03792000
*     /* INCREMENT CCW WRITE COUNT BY 1.                     @Y30LB35*/ 03793000
*     /*                                                             */ 03794000
*     /***************************************************************/ 03795000
*                                                                  1001 03796000
*     WRITECNT=WRITECNT+1;          /*                       @Y30LB35*/ 03797000
*                                                                  1001 03798000
         LH    @03,WRITECNT                                        1001 03799000
         LA    @03,1(,@03)                                         1001 03800000
         STH   @03,WRITECNT                                        1001 03801000
*     /***************************************************************/ 03802000
*     /*                                                             */ 03803000
*     /* FILL IN THE ADDR & LENGTH OF COUNT INTO             @Y30LB35*/ 03804000
*     /* THE CCW.                                            @Y30LB35*/ 03805000
*     /*                                                             */ 03806000
*     /***************************************************************/ 03807000
*                                                                  1002 03808000
*     CCWADDR=ADDR(COUNT);          /*                       @Y30LB35*/ 03809000
         LH    @03,CCWCNT                                          1002 03810000
         SLA   @03,3                                               1002 03811000
         L     @01,IOCTLBKP                                        1002 03812000
         LA    @03,IOXCCW-8(@03,@01)                               1002 03813000
         LH    @15,ARRINDEX                                        1002 03814000
         SLA   @15,3                                               1002 03815000
         L     @01,IOCTLBKP                                        1002 03816000
         LA    @15,IOXCOUNT-8(@15,@01)                             1002 03817000
         STCM  @15,7,CCWADDR(@03)                                  1002 03818000
*     CCWDATLN=LENGTH(COUNT);       /*                       @Y30LB35*/ 03819000
*                                                                  1003 03820000
         LH    @03,CCWCNT                                          1003 03821000
         SLA   @03,3                                               1003 03822000
         L     @01,IOCTLBKP                                        1003 03823000
         LA    @03,IOXCCW-8(@03,@01)                               1003 03824000
         MVC   CCWDATLN(2,@03),@CH00038                            1003 03825000
*     /***************************************************************/ 03826000
*     /*                                                             */ 03827000
*     /* INITIALIZE THE COUNT FIELD.                         @Y30LB35*/ 03828000
*     /*                                                             */ 03829000
*     /***************************************************************/ 03830000
*                                                                  1004 03831000
*     COUNT=CCWDATA;                /*                       @Y30LB35*/ 03832000
         LH    @03,ARRINDEX                                        1004 03833000
         SLA   @03,3                                               1004 03834000
         L     @01,IOCTLBKP                                        1004 03835000
         LA    @03,IOXCOUNT-8(@03,@01)                             1004 03836000
         MVC   COUNT(8,@03),CCWDATA                                1004 03837000
*     CNTCCHHR=TEMPCHR;             /*                       @Y30LB35*/ 03838000
         LH    @03,ARRINDEX                                        1005 03839000
         SLA   @03,3                                               1005 03840000
         L     @01,IOCTLBKP                                        1005 03841000
         LA    @03,IOXCOUNT-8(@03,@01)                             1005 03842000
         MVC   CNTCCHHR(5,@03),TEMPCHR                             1005 03843000
*     CNTRECNO=ARRINDEX;            /*                       @Y30LB35*/ 03844000
         LH    @03,ARRINDEX                                        1006 03845000
         SLA   @03,3                                               1006 03846000
         L     @01,IOCTLBKP                                        1006 03847000
         LA    @03,IOXCOUNT-8(@03,@01)                             1006 03848000
         LH    @15,ARRINDEX                                        1006 03849000
         STC   @15,CNTRECNO(,@03)                                  1006 03850000
*     CNTKEYLN=EXPKEYLN(ARRINDEX);  /*                       @Y30LB35*/ 03851000
         LH    @03,ARRINDEX                                        1007 03852000
         SLA   @03,3                                               1007 03853000
         L     @01,IOCTLBKP                                        1007 03854000
         LA    @03,IOXCOUNT-8(@03,@01)                             1007 03855000
         LH    @15,ARRINDEX                                        1007 03856000
         SLA   @15,3                                               1007 03857000
         L     @14,@PC00001+8                                      1007 03858000
         L     @01,EXPDATA(,@14)                                   1007 03859000
         SLR   @14,@14                                             1007 03860000
         IC    @14,EXPKEYLN-8(@15,@01)                             1007 03861000
         STC   @14,CNTKEYLN(,@03)                                  1007 03862000
*     CNTDATLN=EXPDATAL(ARRINDEX);  /*                       @Y30LB35*/ 03863000
*                                                                  1008 03864000
         LH    @03,ARRINDEX                                        1008 03865000
         SLA   @03,3                                               1008 03866000
         L     @01,IOCTLBKP                                        1008 03867000
         LA    @03,IOXCOUNT-8(@03,@01)                             1008 03868000
         LH    @15,ARRINDEX                                        1008 03869000
         SLA   @15,3                                               1008 03870000
         L     @14,@PC00001+8                                      1008 03871000
         L     @01,EXPDATA(,@14)                                   1008 03872000
         LH    @15,EXPDATAL-8(@15,@01)                             1008 03873000
         STH   @15,CNTDATLN(,@03)                                  1008 03874000
*     /***************************************************************/ 03875000
*     /*                                                             */ 03876000
*     /* INCREMENT TO USER NEXT EXPARRAY ITEM.               @Y30LB35*/ 03877000
*     /*                                                             */ 03878000
*     /***************************************************************/ 03879000
*                                                                  1009 03880000
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/ 03881000
         LH    @03,ARRINDEX                                        1009 03882000
         LA    @03,1(,@03)                                         1009 03883000
         STH   @03,ARRINDEX                                        1009 03884000
*   END;                            /*                       @Y30LB35*/ 03885000
         LH    @03,CCWCNT                                          1010 03886000
         AH    @03,TWOCCWS                                         1010 03887000
         STH   @03,CCWCNT                                          1010 03888000
@DE00999 LH    @03,CCWCNT                                          1010 03889000
         CH    @03,LASTCCW                                         1010 03890000
         BNH   @DL00999                                            1010 03891000
*                                                                  1011 03892000
*   /*****************************************************************/ 03893000
*   /*                                                               */ 03894000
*   /* REINITIALIZE THE ARRINDEX VALUE TO THE                @Y30LB35*/ 03895000
*   /* FIRST EXPARRAY ITEM.                                  @Y30LB35*/ 03896000
*   /*                                                               */ 03897000
*   /*****************************************************************/ 03898000
*                                                                  1011 03899000
*   ARRINDEX=1;                     /*                       @Y30LB35*/ 03900000
*                                                                  1011 03901000
         MVC   ARRINDEX(2),@CH00222                                1011 03902000
*   /*****************************************************************/ 03903000
*   /*                                                               */ 03904000
*   /* HERE WE GO BACK AND SET UP                            @Y30LB35*/ 03905000
*   /* THE DATA CCW FOR EVERY WRITE CCW                      @Y30LB35*/ 03906000
*   /* THAT WAS INITIALIZED IN THE PRIOR LOOP.               @Y30LB35*/ 03907000
*   /*                                                               */ 03908000
*   /*****************************************************************/ 03909000
*                                                                  1012 03910000
*   DO CCWCNT=FOURCCWS BY TWOCCWS WHILE CCWCNT<=LASTCCW;           1012 03911000
*                                                                  1012 03912000
         LH    @03,FOURCCWS                                        1012 03913000
         STH   @03,CCWCNT                                          1012 03914000
         B     @DE01012                                            1012 03915000
@DL01012 DS    0H                                                  1013 03916000
*     /***************************************************************/ 03917000
*     /*                                                             */ 03918000
*     /* MOVE IN THE MODEL DATA CCW                          @Y30LB35*/ 03919000
*     /*                                                             */ 03920000
*     /***************************************************************/ 03921000
*                                                                  1013 03922000
*     IOXCCW(CCWCNT)=CCWDATA;       /*                       @Y30LB35*/ 03923000
*                                                                  1013 03924000
         LH    @03,CCWCNT                                          1013 03925000
         SLA   @03,3                                               1013 03926000
         L     @01,IOCTLBKP                                        1013 03927000
         ALR   @01,@03                                             1013 03928000
         MVC   IOXCCW-8(8,@01),CCWDATA                             1013 03929000
*     /***************************************************************/ 03930000
*     /*                                                             */ 03931000
*     /* INITIALIZE THE DATA CCW                             @Y30LB35*/ 03932000
*     /*                                                             */ 03933000
*     /***************************************************************/ 03934000
*                                                                  1014 03935000
*     CCWADDR=EXPDATAP(ARRINDEX);   /*                       @Y30LB35*/ 03936000
         LH    @03,CCWCNT                                          1014 03937000
         SLA   @03,3                                               1014 03938000
         L     @01,IOCTLBKP                                        1014 03939000
         LA    @03,IOXCCW-8(@03,@01)                               1014 03940000
         LH    @15,ARRINDEX                                        1014 03941000
         SLA   @15,3                                               1014 03942000
         L     @14,@PC00001+8                                      1014 03943000
         L     @01,EXPDATA(,@14)                                   1014 03944000
         AL    @01,@CF04420                                        1014 03945000
         L     @15,EXPDATAP-4(@15,@01)                             1014 03946000
         STCM  @15,7,CCWADDR(@03)                                  1014 03947000
*     CCWDATLN=EXPKEYLN(ARRINDEX)+EXPDATAL(ARRINDEX);              1015 03948000
*                                                                  1015 03949000
         LH    @03,CCWCNT                                          1015 03950000
         SLA   @03,3                                               1015 03951000
         L     @01,IOCTLBKP                                        1015 03952000
         LA    @03,IOXCCW-8(@03,@01)                               1015 03953000
         LH    @15,ARRINDEX                                        1015 03954000
         SLA   @15,3                                               1015 03955000
         L     @14,@PC00001+8                                      1015 03956000
         L     @01,EXPDATA(,@14)                                   1015 03957000
         LH    @14,ARRINDEX                                        1015 03958000
         SLA   @14,3                                               1015 03959000
         L     @07,@PC00001+8                                      1015 03960000
         L     @07,EXPDATA(,@07)                                   1015 03961000
         SLR   @00,@00                                             1015 03962000
         IC    @00,EXPKEYLN-8(@15,@01)                             1015 03963000
         AH    @00,EXPDATAL-8(@14,@07)                             1015 03964000
         STH   @00,CCWDATLN(,@03)                                  1015 03965000
*     /***************************************************************/ 03966000
*     /*                                                             */ 03967000
*     /* INCREMENT THE EXPARRAY ITEM BY 1                    @Y30LB35*/ 03968000
*     /*                                                             */ 03969000
*     /***************************************************************/ 03970000
*                                                                  1016 03971000
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/ 03972000
         LH    @03,ARRINDEX                                        1016 03973000
         LA    @03,1(,@03)                                         1016 03974000
         STH   @03,ARRINDEX                                        1016 03975000
*   END;                            /*                       @Y30LB35*/ 03976000
         LH    @03,CCWCNT                                          1017 03977000
         AH    @03,TWOCCWS                                         1017 03978000
         STH   @03,CCWCNT                                          1017 03979000
@DE01012 LH    @03,CCWCNT                                          1017 03980000
         CH    @03,LASTCCW                                         1017 03981000
         BNH   @DL01012                                            1017 03982000
*                                                                  1018 03983000
*   /*****************************************************************/ 03984000
*   /*                                                               */ 03985000
*   /* NOW THAT WE HAVE INITIALIZED OUR CCW                  @Y30LB35*/ 03986000
*   /* STRING WITH ALL THE WRITE CCWS AND                    @Y30LB35*/ 03987000
*   /* THEIR ASSOCIATED COUNT FIELDS, WE                     @Y30LB35*/ 03988000
*   /* SEARCH BACK TO THE BEGINNING OF THE                   @Y30LB35*/ 03989000
*   /* TRACK TO CHECK ALL THE RECORDS BY                     @Y30LB35*/ 03990000
*   /* READING THE SAME RECORDS THAT WE                      @Y30LB35*/ 03991000
*   /* WROTE OUT ON OUR FIRST PASS AROUND                    @Y30LB35*/ 03992000
*   /* THE TRACK.                                            @Y30LB35*/ 03993000
*   /* WE FIRST SET UP THE SEARCH AND TIC                    @Y30LB35*/ 03994000
*   /* CCWS.                                                 @Y30LB35*/ 03995000
*   /*                                                               */ 03996000
*   /*****************************************************************/ 03997000
*                                                                  1018 03998000
*   IOXCCW((EXPRECNO*TWOCCWS)+THREECCW)=IOXCCW(1);                 1018 03999000
         L     @03,@PC00001+8                                      1018 04000000
         L     @03,EXPDATA(,@03)                                   1018 04001000
         L     @03,EXPRECNO(,@03)                                  1018 04002000
         MH    @03,TWOCCWS                                         1018 04003000
         AH    @03,THREECCW                                        1018 04004000
         SLA   @03,3                                               1018 04005000
         L     @01,IOCTLBKP                                        1018 04006000
         ALR   @01,@03                                             1018 04007000
         L     @03,IOCTLBKP                                        1018 04008000
         MVC   @TS00001(8),IOXCCW(@03)                             1018 04009000
         MVC   IOXCCW-8(8,@01),@TS00001                            1018 04010000
*   IOXCCW((EXPRECNO*TWOCCWS)+FOURCCWS)=IOXCCW(2);                 1019 04011000
*                                                                  1019 04012000
         L     @03,@PC00001+8                                      1019 04013000
         L     @03,EXPDATA(,@03)                                   1019 04014000
         L     @03,EXPRECNO(,@03)                                  1019 04015000
         MH    @03,TWOCCWS                                         1019 04016000
         AH    @03,FOURCCWS                                        1019 04017000
         SLA   @03,3                                               1019 04018000
         L     @01,IOCTLBKP                                        1019 04019000
         ALR   @01,@03                                             1019 04020000
         L     @03,IOCTLBKP                                        1019 04021000
         MVC   IOXCCW-8(8,@01),IOXCCW+8(@03)                       1019 04022000
*   /*****************************************************************/ 04023000
*   /*                                                               */ 04024000
*   /* INITIALIZE THE CCW COUNTER TO THE CCW                 @Y30LB35*/ 04025000
*   /* TRANSFER IN CHANNEL (TIC)                             @Y30LB35*/ 04026000
*   /* THIS WILL ALLOW THE INITIALIZATION                    @Y30LB35*/ 04027000
*   /* TIC ADDRESS.                                          @Y30LB35*/ 04028000
*   /*                                                               */ 04029000
*   /*****************************************************************/ 04030000
*                                                                  1020 04031000
*   CCWCNT=(EXPRECNO*TWOCCWS)+FOURCCWS;/*                    @Y30LB35*/ 04032000
*                                                                  1020 04033000
         L     @03,@PC00001+8                                      1020 04034000
         L     @03,EXPDATA(,@03)                                   1020 04035000
         L     @03,EXPRECNO(,@03)                                  1020 04036000
         MH    @03,TWOCCWS                                         1020 04037000
         AH    @03,FOURCCWS                                        1020 04038000
         STH   @03,CCWCNT                                          1020 04039000
*   /*****************************************************************/ 04040000
*   /*                                                               */ 04041000
*   /* INITIALIZE THE TIC ADDRESS.                           @Y30LB35*/ 04042000
*   /*                                                               */ 04043000
*   /*****************************************************************/ 04044000
*                                                                  1021 04045000
*   CCWADDR=ADDR(IOXCCW((EXPRECNO*TWOCCWS)+THREECCW));             1021 04046000
*                                                                  1021 04047000
         LH    @03,CCWCNT                                          1021 04048000
         SLA   @03,3                                               1021 04049000
         L     @01,IOCTLBKP                                        1021 04050000
         LA    @03,IOXCCW-8(@03,@01)                               1021 04051000
         L     @15,@PC00001+8                                      1021 04052000
         L     @01,EXPDATA(,@15)                                   1021 04053000
         L     @15,EXPRECNO(,@01)                                  1021 04054000
         MH    @15,TWOCCWS                                         1021 04055000
         AH    @15,THREECCW                                        1021 04056000
         SLA   @15,3                                               1021 04057000
         L     @01,IOCTLBKP                                        1021 04058000
         LA    @15,IOXCCW-8(@15,@01)                               1021 04059000
         STCM  @15,7,CCWADDR(@03)                                  1021 04060000
*   /*****************************************************************/ 04061000
*   /*                                                               */ 04062000
*   /* SET UP THE LASTCCW FOR THE BUILD                      @Y30LB35*/ 04063000
*   /* CCW READ LOOP.                                        @Y30LB35*/ 04064000
*   /*                                                               */ 04065000
*   /*****************************************************************/ 04066000
*                                                                  1022 04067000
*   LASTCCW=(EXPRECNO*THREECCW)+FOURCCWS;/*                  @Y30LB35*/ 04068000
*                                                                  1022 04069000
         L     @03,@PC00001+8                                      1022 04070000
         L     @03,EXPDATA(,@03)                                   1022 04071000
         L     @03,EXPRECNO(,@03)                                  1022 04072000
         MH    @03,THREECCW                                        1022 04073000
         AH    @03,FOURCCWS                                        1022 04074000
         STH   @03,LASTCCW                                         1022 04075000
*   /*****************************************************************/ 04076000
*   /*                                                               */ 04077000
*   /* SET THE EXPARRAY ARRINDEX TO 1                        @Y30LB35*/ 04078000
*   /*                                                               */ 04079000
*   /*****************************************************************/ 04080000
*                                                                  1023 04081000
*   ARRINDEX=1;                     /*                       @Y30LB35*/ 04082000
*                                                                  1023 04083000
         MVC   ARRINDEX(2),@CH00222                                1023 04084000
*   /*****************************************************************/ 04085000
*   /*                                                               */ 04086000
*   /* HERE THE LOOPING IS DONE TO BUILD THE                 @Y30LB35*/ 04087000
*   /* READ COUNT KEY AND DATA CCWS.                         @Y30LB35*/ 04088000
*   /* IT SHOULD BE NOTED THE THE DATA                       @Y30LB35*/ 04089000
*   /* TRANSFER IS SET TO SUPPRESS THE                       @Y30LB35*/ 04090000
*   /* DATA FROM BEING READ BACK INTO CORE                   @Y30LB35*/ 04091000
*   /* AS THE READS ARE BEING DONE TO                        @Y30LB35*/ 04092000
*   /* TEST TO SEE IF THE NEW RECORDS ARE                    @Y30LB35*/ 04093000
*   /* THERE AND ARE READABLE.                               @Y30LB35*/ 04094000
*   /*                                                               */ 04095000
*   /*****************************************************************/ 04096000
*                                                                  1024 04097000
*   DO CCWCNT=((EXPRECNO*TWOCCWS)+FIVECCWS) BY 1 WHILE CCWCNT<=LASTCCW; 04098000
         L     @03,@PC00001+8                                      1024 04099000
         L     @03,EXPDATA(,@03)                                   1024 04100000
         L     @03,EXPRECNO(,@03)                                  1024 04101000
         MH    @03,TWOCCWS                                         1024 04102000
         AH    @03,FIVECCWS                                        1024 04103000
         STH   @03,CCWCNT                                          1024 04104000
         B     @DE01024                                            1024 04105000
@DL01024 DS    0H                                                  1025 04106000
*                                   /*                       @Y30LB35*/ 04107000
*                                                                  1025 04108000
*     /***************************************************************/ 04109000
*     /*                                                             */ 04110000
*     /* MOVE THE MODEL READ COUNT KEY AND DATA              @Y30LB35*/ 04111000
*     /* CCW INTO THE CCW STRING.                            @Y30LB35*/ 04112000
*     /*                                                             */ 04113000
*     /***************************************************************/ 04114000
*                                                                  1025 04115000
*     IOXCCW(CCWCNT)=CCWRCKD;       /*                       @Y30LB35*/ 04116000
*                                                                  1025 04117000
         LH    @03,CCWCNT                                          1025 04118000
         SLA   @03,3                                               1025 04119000
         L     @01,IOCTLBKP                                        1025 04120000
         ALR   @01,@03                                             1025 04121000
         MVC   IOXCCW-8(8,@01),CCWRCKD                             1025 04122000
*     /***************************************************************/ 04123000
*     /*                                                             */ 04124000
*     /* TURN ON THE SUPPRESS DATA TRANSFET BIT              @Y30LB35*/ 04125000
*     /*                                                             */ 04126000
*     /***************************************************************/ 04127000
*                                                                  1026 04128000
*     CCWSUPP=ON;                   /*                       @Y30LB35*/ 04129000
         LH    @03,CCWCNT                                          1026 04130000
         SLA   @03,3                                               1026 04131000
         L     @01,IOCTLBKP                                        1026 04132000
         LA    @03,IOXCCW-8(@03,@01)                               1026 04133000
         OI    CCWSUPP(@03),B'00010000'                            1026 04134000
*                                                                  1027 04135000
*     /***************************************************************/ 04136000
*     /*                                                             */ 04137000
*     /* ZERO OUT THE DATA ADDRESS                           @Y30LB35*/ 04138000
*     /*                                                             */ 04139000
*     /***************************************************************/ 04140000
*                                                                  1027 04141000
*     CCWADDR=''B;                  /*                       @Y30LB35*/ 04142000
*                                                                  1027 04143000
         LH    @03,CCWCNT                                          1027 04144000
         SLA   @03,3                                               1027 04145000
         L     @01,IOCTLBKP                                        1027 04146000
         LA    @03,IOXCCW-8(@03,@01)                               1027 04147000
         SLR   @15,@15                                             1027 04148000
         STCM  @15,7,CCWADDR(@03)                                  1027 04149000
*     /***************************************************************/ 04150000
*     /*                                                             */ 04151000
*     /* INITIALIZE THE DATA LENGTH                          @Y30LB35*/ 04152000
*     /*                                                             */ 04153000
*     /***************************************************************/ 04154000
*                                                                  1028 04155000
*     CCWDATLN=LENGTH(COUNT)+EXPDATAL(ARRINDEX)+EXPKEYLN(ARRINDEX);/*   04156000
*                                                            @Y30LB35*/ 04157000
*                                                                  1028 04158000
         LH    @03,CCWCNT                                          1028 04159000
         SLA   @03,3                                               1028 04160000
         L     @01,IOCTLBKP                                        1028 04161000
         LA    @03,IOXCCW-8(@03,@01)                               1028 04162000
         LH    @15,ARRINDEX                                        1028 04163000
         SLA   @15,3                                               1028 04164000
         L     @14,@PC00001+8                                      1028 04165000
         L     @01,EXPDATA(,@14)                                   1028 04166000
         LA    @14,8                                               1028 04167000
         AH    @14,EXPDATAL-8(@15,@01)                             1028 04168000
         LH    @15,ARRINDEX                                        1028 04169000
         SLA   @15,3                                               1028 04170000
         L     @07,@PC00001+8                                      1028 04171000
         L     @01,EXPDATA(,@07)                                   1028 04172000
         SLR   @00,@00                                             1028 04173000
         IC    @00,EXPKEYLN-8(@15,@01)                             1028 04174000
         ALR   @14,@00                                             1028 04175000
         STH   @14,CCWDATLN(,@03)                                  1028 04176000
*     /***************************************************************/ 04177000
*     /*                                                             */ 04178000
*     /* INCREMENT THE EXPARRAY ARRINDEX                     @Y30LB35*/ 04179000
*     /*                                                             */ 04180000
*     /***************************************************************/ 04181000
*                                                                  1029 04182000
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/ 04183000
         LH    @03,ARRINDEX                                        1029 04184000
         LA    @03,1(,@03)                                         1029 04185000
         STH   @03,ARRINDEX                                        1029 04186000
*   END;                            /*                       @Y30LB35*/ 04187000
*                                                                  1030 04188000
         LA    @03,1                                               1030 04189000
         AH    @03,CCWCNT                                          1030 04190000
         STH   @03,CCWCNT                                          1030 04191000
@DE01024 LH    @03,CCWCNT                                          1030 04192000
         CH    @03,LASTCCW                                         1030 04193000
         BNH   @DL01024                                            1030 04194000
*   /*****************************************************************/ 04195000
*   /*                                                               */ 04196000
*   /* BACK UP TO THE LAST CCW                               @Y30LB35*/ 04197000
*   /*                                                               */ 04198000
*   /*****************************************************************/ 04199000
*                                                                  1031 04200000
*   CCWCNT=CCWCNT-1;                /*                       @Y30LB35*/ 04201000
*                                                                  1031 04202000
         LH    @03,CCWCNT                                          1031 04203000
         BCTR  @03,0                                               1031 04204000
         STH   @03,CCWCNT                                          1031 04205000
*   /*****************************************************************/ 04206000
*   /*                                                               */ 04207000
*   /* TURN OFF THE COMMAND CHAINING BIT                     @Y30LB35*/ 04208000
*   /* TO INDICATE THAT THIS IS THE END                      @Y30LB35*/ 04209000
*   /* OF THE CCW STRING.                                    @Y30LB35*/ 04210000
*   /*                                                               */ 04211000
*   /*****************************************************************/ 04212000
*                                                                  1032 04213000
*   CCWCMDCH=OFF;                   /*                       @Y30LB35*/ 04214000
*                                                                  1032 04215000
         LH    @03,CCWCNT                                          1032 04216000
         SLA   @03,3                                               1032 04217000
         L     @01,IOCTLBKP                                        1032 04218000
         LA    @03,IOXCCW-8(@03,@01)                               1032 04219000
         NI    CCWCMDCH(@03),B'10111111'                           1032 04220000
*   /*****************************************************************/ 04221000
*   /*                                                               */ 04222000
*   /* CONTROL IS RETURNED TO PUTGET                         @Y30LB35*/ 04223000
*   /* WITH A ZERO RETURN CODE IN REGISTER 15                @Y30LB35*/ 04224000
*   /*                                                               */ 04225000
*   /*****************************************************************/ 04226000
*                                                                  1033 04227000
*   RETURN CODE(0);                 /*                       @Y30LB35*/ 04228000
         SLR   @15,@15                                             1033 04229000
         L     @14,12(,@13)                                        1033 04230000
         LM    @00,@12,20(@13)                                     1033 04231000
         BR    @14                                                 1033 04232000
*   END BLDCCWP1;                   /*                       @Y30LB35*/ 04233000
*                                                                  1035 04234000
*/********************************************************************/ 04235000
*/*                                                          @Y30LB35*/ 04236000
*/* PROCEDURE NAME - BLDCCWP2                                @Y30LB35*/ 04237000
*/*                                                          @Y30LB35*/ 04238000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 04239000
*/*             BUILD CCW'S TO WRITE "KEY" DATA              @Y30LB35*/ 04240000
*/*                                                          @Y30LB35*/ 04241000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 04242000
*/*                                                          @Y30LB35*/ 04243000
*/* INPUT -     USERCCHH IN CALLER'S CORE                    @Y30LB35*/ 04244000
*/*             EXPCCHHR IN EXPAGL                           @Y30LB35*/ 04245000
*/*             EXPDAYLN(X) IN EXPDATAB                      @Y30LB35*/ 04246000
*/*             EXPKEYLN(X) IN EXPDATAB                      @Y30LB35*/ 04247000
*/*             EXPDATAL(X) IN EXPDATAB                      @Y30LB35*/ 04248000
*/*             EXPRECNO IN EXPDATAB                         @Y30LB35*/ 04249000
*/*             CCWSIDEQ                                     @Y30LB35*/ 04250000
*/*             CCWTIC                                       @Y30LB35*/ 04251000
*/*             CCWWKD                                       @Y30LB35*/ 04252000
*/*             CCWDATA                                      @Y30LB35*/ 04253000
*/*                                                          @Y30LB35*/ 04254000
*/* OUTPUT -    IOXCCW(X) IN IOXCTLBK                        @Y30LB35*/ 04255000
*/*             WRITECNT IN IOXCTLBK                         @Y30LB35*/ 04256000
*/*             READCNTA IN IOXCTLBK                         @ZA11014*/ 04257000
*/*             IOBSEEK  IN IOXIOB                           @Y30LB35*/ 04258000
*/*             CCWCMDCH IN IOXCCW                           @Y30LB35*/ 04259000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 04260000
*/*                                                          @Y30LB35*/ 04261000
*/********************************************************************/ 04262000
*                                                                  1035 04263000
*                                   /*                       @Y30LB35*/ 04264000
*BLDCCWP2:                                                         1035 04265000
*   PROC;                           /*                       @Y30LB35*/ 04266000
*                                                                  1035 04267000
BLDCCWP2 STM   @14,@12,12(@13)                                     1035 04268000
*   /*****************************************************************/ 04269000
*   /*                                                               */ 04270000
*   /* SET UP TRACE POINT 'IOP2' IN TRACE TABLE              @Y30LB35*/ 04271000
*   /*                                                               */ 04272000
*   /*****************************************************************/ 04273000
*                                                                  1036 04274000
*   OLDERID2=NEWERID2;                                             1036 04275000
         L     @03,@PC00001                                        1036 04276000
         L     @03,GDTTR2(,@03)                                    1036 04277000
         L     @15,@PC00001                                        1036 04278000
         L     @01,GDTTR2(,@15)                                    1036 04279000
         MVC   @TS00001(95),NEWERID2(@01)                          1036 04280000
         MVC   OLDERID2(95,@03),@TS00001                           1036 04281000
*   NEWID2='IOP2';                  /*                       @Y30LB35*/ 04282000
*                                                                  1037 04283000
         L     @03,@PC00001                                        1037 04284000
         L     @03,GDTTR2(,@03)                                    1037 04285000
         MVC   NEWID2(4,@03),@CC04252                              1037 04286000
*   /*****************************************************************/ 04287000
*   /*                                                               */ 04288000
*   /* HERE STARTS THE INITIALIZATION OF THE CCWS            @Y30LB35*/ 04289000
*   /* THE FIRST THING DONE IS THE MODEL CCW                 @Y30LB35*/ 04290000
*   /* SEARCH I.D. EQUAL IS MOVED INTO CCW STRING            @Y30LB35*/ 04291000
*   /*                                                               */ 04292000
*   /*****************************************************************/ 04293000
*                                                                  1038 04294000
*   IOXCCW(1)=CCWSIDEQ;             /*                       @Y30LB35*/ 04295000
*                                                                  1038 04296000
         L     @03,IOCTLBKP                                        1038 04297000
         MVC   IOXCCW(8,@03),CCWSIDEQ                              1038 04298000
*   /*****************************************************************/ 04299000
*   /*                                                               */ 04300000
*   /* INITIALIZE CCW ARRAY COUNTER TO THE 1ST CCW           @Y30LB35*/ 04301000
*   /*                                                               */ 04302000
*   /*****************************************************************/ 04303000
*                                                                  1039 04304000
*   CCWCNT=1;                       /*                       @Y30LB35*/ 04305000
*                                                                  1039 04306000
         MVC   CCWCNT(2),@CH00222                                  1039 04307000
*   /*****************************************************************/ 04308000
*   /*                                                               */ 04309000
*   /* THE NEXT FIVE INSTRUCTIONS INITIALIZES THE            @Y30LB35*/ 04310000
*   /* SEARCH AND IOBSEEK CCHHR VALUE.                       @Y30LB35*/ 04311000
*   /*                                                               */ 04312000
*   /*****************************************************************/ 04313000
*                                                                  1040 04314000
*   USERCHRP=EXPCCHHR;              /*                       @Y30LB35*/ 04315000
         L     @03,@PC00001+8                                      1040 04316000
         L     @03,EXPCCHHR(,@03)                                  1040 04317000
         ST    @03,USERCHRP                                        1040 04318000
*   TEMPCCHH=''B;                   /*                       @Y30LB35*/ 04319000
         XC    TEMPCCHH(8),TEMPCCHH                                1041 04320000
*   TEMPCHR=USERCCHH;               /*                       @Y30LB35*/ 04321000
         L     @03,USERCHRP                                        1042 04322000
         MVC   TEMPCHR(5),USERCCHH(@03)                            1042 04323000
*   IOBSEEK=TEMPCCHH;               /*                       @Y30LB35*/ 04324000
         L     @03,IOBSTPTR                                        1043 04325000
         MVC   IOBSEEK(8,@03),TEMPCCHH                             1043 04326000
*   CCWADDR=ADDR(IOBCC);            /*                       @Y30LB35*/ 04327000
*                                                                  1044 04328000
         LH    @03,CCWCNT                                          1044 04329000
         SLA   @03,3                                               1044 04330000
         L     @01,IOCTLBKP                                        1044 04331000
         LA    @03,IOXCCW-8(@03,@01)                               1044 04332000
         L     @01,IOBSTPTR                                        1044 04333000
         LA    @15,IOBCC(,@01)                                     1044 04334000
         STCM  @15,7,CCWADDR(@03)                                  1044 04335000
*   /*****************************************************************/ 04336000
*   /*                                                               */ 04337000
*   /* HERE THE SECOND CCW IS INITIALIZED WITH               @Y30LB35*/ 04338000
*   /* THE TRANSFER IN CHANNEL(TIC) CCW.                     @Y30LB35*/ 04339000
*   /* THIS WILL ALLOW THE CHANNEL TO LOOP                   @Y30LB35*/ 04340000
*   /* UNTIL IT FINDS THE CCHHR IN THE SEARCH.               @Y30LB35*/ 04341000
*   /*                                                               */ 04342000
*   /*****************************************************************/ 04343000
*                                                                  1045 04344000
*   IOXCCW(2)=CCWTIC;               /*                       @Y30LB35*/ 04345000
         L     @03,IOCTLBKP                                        1045 04346000
         MVC   IOXCCW+8(8,@03),CCWTIC                              1045 04347000
*   CCWCNT=TWOCCWS;                 /*                       @Y30LB35*/ 04348000
         LH    @03,TWOCCWS                                         1046 04349000
         STH   @03,CCWCNT                                          1046 04350000
*   CCWADDR=ADDR(IOXCCW(1));        /*                       @Y30LB35*/ 04351000
*                                                                  1047 04352000
         LH    @03,CCWCNT                                          1047 04353000
         SLA   @03,3                                               1047 04354000
         L     @01,IOCTLBKP                                        1047 04355000
         LA    @03,IOXCCW-8(@03,@01)                               1047 04356000
         L     @01,IOCTLBKP                                        1047 04357000
         LA    @15,IOXCCW(,@01)                                    1047 04358000
         STCM  @15,7,CCWADDR(@03)                                  1047 04359000
*   /*****************************************************************/ 04360000
*   /*                                                               */ 04361000
*   /* THE CCW READ AND CCW WRITE COUNTER ARE                @Y30LB35*/ 04362000
*   /* INITIALIZED TO ZERO.                                  @Y30LB35*/ 04363000
*   /*                                                               */ 04364000
*   /*****************************************************************/ 04365000
*                                                                  1048 04366000
*   WRITECNT=ZERO;                  /*                       @Y30LB35*/ 04367000
         LH    @03,ZERO                                            1048 04368000
         STH   @03,WRITECNT                                        1048 04369000
*   READCNTA=ZERO;                  /*                       @ZA11014*/ 04370000
*                                                                  1049 04371000
         LH    @03,ZERO                                            1049 04372000
         STH   @03,READCNTA                                        1049 04373000
*   /*****************************************************************/ 04374000
*   /*                                                               */ 04375000
*   /* THE LASTCCW IS CALCULATED AND USED TO                 @Y30LB35*/ 04376000
*   /* CONTROL THE LOOP USED TO BUILD THE                    @Y30LB35*/ 04377000
*   /* WRITE KEY AND DATA CCWS FOR                           @Y30LB35*/ 04378000
*   /* ALL THE NEW RECORDS BEING WRITTEN.                    @Y30LB35*/ 04379000
*   /* ALSO DONE IS THE INITIALIZATION OF                    @Y30LB35*/ 04380000
*   /* ARRINDEX VARIABLE USED THE REFERENCE                  @Y30LB35*/ 04381000
*   /* EXPARRAY.                                             @Y30LB35*/ 04382000
*   /*                                                               */ 04383000
*   /*****************************************************************/ 04384000
*                                                                  1050 04385000
*   LASTCCW=EXPRECNO+TWOCCWS;       /*                       @Y30LB35*/ 04386000
         L     @03,@PC00001+8                                      1050 04387000
         L     @03,EXPDATA(,@03)                                   1050 04388000
         LH    @15,TWOCCWS                                         1050 04389000
         AL    @15,EXPRECNO(,@03)                                  1050 04390000
         STH   @15,LASTCCW                                         1050 04391000
*   ARRINDEX=1;                     /*                       @Y30LB35*/ 04392000
*                                                                  1051 04393000
         MVC   ARRINDEX(2),@CH00222                                1051 04394000
*   /*****************************************************************/ 04395000
*   /*                                                               */ 04396000
*   /* HERE LOOPING WILL BE PERFORMED WHILE                  @Y30LB35*/ 04397000
*   /* THE WRITE KEY DATA CCWS FOR                           @Y30LB35*/ 04398000
*   /* UPDATING RECORDS ARE BUILT.                           @Y30LB35*/ 04399000
*   /*                                                               */ 04400000
*   /*****************************************************************/ 04401000
*                                                                  1052 04402000
*   DO CCWCNT=THREECCW BY 1 WHILE CCWCNT<=LASTCCW;/*         @Y30LB35*/ 04403000
*                                                                  1052 04404000
         LH    @03,THREECCW                                        1052 04405000
         STH   @03,CCWCNT                                          1052 04406000
         B     @DE01052                                            1052 04407000
@DL01052 DS    0H                                                  1053 04408000
*     /***************************************************************/ 04409000
*     /*                                                             */ 04410000
*     /* MOVE IN MODEL WRITE KEY AND DATA CCW                @Y30LB35*/ 04411000
*     /*                                                             */ 04412000
*     /***************************************************************/ 04413000
*                                                                  1053 04414000
*     IOXCCW(CCWCNT)=CCWWKD;        /*                       @Y30LB35*/ 04415000
*                                                                  1053 04416000
         LH    @03,CCWCNT                                          1053 04417000
         SLA   @03,3                                               1053 04418000
         L     @01,IOCTLBKP                                        1053 04419000
         ALR   @01,@03                                             1053 04420000
         MVC   IOXCCW-8(8,@01),CCWWKD                              1053 04421000
*     /***************************************************************/ 04422000
*     /*                                                             */ 04423000
*     /* INCREMENT CCW WRITE COUNTER BY 1.                   @Y30LB35*/ 04424000
*     /*                                                             */ 04425000
*     /***************************************************************/ 04426000
*                                                                  1054 04427000
*     WRITECNT=WRITECNT+1;          /*                       @Y30LB35*/ 04428000
*                                                                  1054 04429000
         LH    @03,WRITECNT                                        1054 04430000
         LA    @03,1(,@03)                                         1054 04431000
         STH   @03,WRITECNT                                        1054 04432000
*     /***************************************************************/ 04433000
*     /*                                                             */ 04434000
*     /* FILL IN THE DYNAMIC INFORMATION INTO THE            @Y30LB35*/ 04435000
*     /* CCW.                                                @Y30LB35*/ 04436000
*     /*                                                             */ 04437000
*     /***************************************************************/ 04438000
*                                                                  1055 04439000
*     CCWADDR=EXPDATAP(ARRINDEX);   /*                       @Y30LB35*/ 04440000
         LH    @03,CCWCNT                                          1055 04441000
         SLA   @03,3                                               1055 04442000
         L     @01,IOCTLBKP                                        1055 04443000
         LA    @03,IOXCCW-8(@03,@01)                               1055 04444000
         LH    @15,ARRINDEX                                        1055 04445000
         SLA   @15,3                                               1055 04446000
         L     @14,@PC00001+8                                      1055 04447000
         L     @01,EXPDATA(,@14)                                   1055 04448000
         AL    @01,@CF04420                                        1055 04449000
         L     @15,EXPDATAP-4(@15,@01)                             1055 04450000
         STCM  @15,7,CCWADDR(@03)                                  1055 04451000
*     CCWDATLN=EXPKEYLN(ARRINDEX)+EXPDATAL(ARRINDEX);              1056 04452000
*                                                                  1056 04453000
         LH    @03,CCWCNT                                          1056 04454000
         SLA   @03,3                                               1056 04455000
         L     @01,IOCTLBKP                                        1056 04456000
         LA    @03,IOXCCW-8(@03,@01)                               1056 04457000
         LH    @15,ARRINDEX                                        1056 04458000
         SLA   @15,3                                               1056 04459000
         L     @14,@PC00001+8                                      1056 04460000
         L     @01,EXPDATA(,@14)                                   1056 04461000
         LH    @14,ARRINDEX                                        1056 04462000
         SLA   @14,3                                               1056 04463000
         L     @07,@PC00001+8                                      1056 04464000
         L     @07,EXPDATA(,@07)                                   1056 04465000
         SLR   @00,@00                                             1056 04466000
         IC    @00,EXPKEYLN-8(@15,@01)                             1056 04467000
         AH    @00,EXPDATAL-8(@14,@07)                             1056 04468000
         STH   @00,CCWDATLN(,@03)                                  1056 04469000
*     /***************************************************************/ 04470000
*     /*                                                             */ 04471000
*     /* INCREMENT THE EXPARRAY ITEM BY 1                    @Y30LB35*/ 04472000
*     /*                                                             */ 04473000
*     /***************************************************************/ 04474000
*                                                                  1057 04475000
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/ 04476000
         LH    @03,ARRINDEX                                        1057 04477000
         LA    @03,1(,@03)                                         1057 04478000
         STH   @03,ARRINDEX                                        1057 04479000
*   END;                            /*                       @Y30LB35*/ 04480000
         LA    @03,1                                               1058 04481000
         AH    @03,CCWCNT                                          1058 04482000
         STH   @03,CCWCNT                                          1058 04483000
@DE01052 LH    @03,CCWCNT                                          1058 04484000
         CH    @03,LASTCCW                                         1058 04485000
         BNH   @DL01052                                            1058 04486000
*                                                                  1059 04487000
*   /*****************************************************************/ 04488000
*   /*                                                               */ 04489000
*   /* NOW THAT WE HAVE INITIALIZED OUR CCW                  @Y30LB35*/ 04490000
*   /* STRING WITH ALL THE WRITE CCWS,                       @Y30LB35*/ 04491000
*   /* WE SEARCH BACK TO THE BEGINNING OF THE                @Y30LB35*/ 04492000
*   /* TRACK TO CHECK ALL THE RECORDS BY                     @Y30LB35*/ 04493000
*   /* READING THE SAME RECORDS THAT WE HAVE                 @Y30LB35*/ 04494000
*   /* WRITTEN OUT ON OUR FIRST PASS AROUND                  @Y30LB35*/ 04495000
*   /* THE TRACK.                                            @Y30LB35*/ 04496000
*   /* WE FIRST SET UP THE SEARCH AND TIC                    @Y30LB35*/ 04497000
*   /* CCWS.                                                 @Y30LB35*/ 04498000
*   /*                                                               */ 04499000
*   /*****************************************************************/ 04500000
*                                                                  1059 04501000
*   IOXCCW(EXPRECNO+THREECCW)=IOXCCW(1);/*                   @Y30LB35*/ 04502000
         L     @03,@PC00001+8                                      1059 04503000
         L     @03,EXPDATA(,@03)                                   1059 04504000
         LH    @15,THREECCW                                        1059 04505000
         AL    @15,EXPRECNO(,@03)                                  1059 04506000
         SLA   @15,3                                               1059 04507000
         L     @03,IOCTLBKP                                        1059 04508000
         ALR   @03,@15                                             1059 04509000
         L     @01,IOCTLBKP                                        1059 04510000
         MVC   @TS00001(8),IOXCCW(@01)                             1059 04511000
         MVC   IOXCCW-8(8,@03),@TS00001                            1059 04512000
*   IOXCCW(EXPRECNO+FOURCCWS)=IOXCCW(2);/*                   @Y30LB35*/ 04513000
*                                                                  1060 04514000
         L     @03,@PC00001+8                                      1060 04515000
         L     @03,EXPDATA(,@03)                                   1060 04516000
         LH    @15,FOURCCWS                                        1060 04517000
         AL    @15,EXPRECNO(,@03)                                  1060 04518000
         SLA   @15,3                                               1060 04519000
         L     @03,IOCTLBKP                                        1060 04520000
         ALR   @03,@15                                             1060 04521000
         L     @01,IOCTLBKP                                        1060 04522000
         MVC   IOXCCW-8(8,@03),IOXCCW+8(@01)                       1060 04523000
*   /*****************************************************************/ 04524000
*   /*                                                               */ 04525000
*   /* INITIALIZE THE CCW COUNTER TO THE CCW                 @Y30LB35*/ 04526000
*   /* TRANSFER IN CHANNEL (TIC)                             @Y30LB35*/ 04527000
*   /* THIS WILL ALLOW THE INITIALIZATION                    @Y30LB35*/ 04528000
*   /* TIC ADDRESS.                                          @Y30LB35*/ 04529000
*   /*                                                               */ 04530000
*   /*****************************************************************/ 04531000
*                                                                  1061 04532000
*   CCWCNT=EXPRECNO+FOURCCWS;       /*                       @Y30LB35*/ 04533000
*                                                                  1061 04534000
         L     @03,@PC00001+8                                      1061 04535000
         L     @03,EXPDATA(,@03)                                   1061 04536000
         LH    @15,FOURCCWS                                        1061 04537000
         AL    @15,EXPRECNO(,@03)                                  1061 04538000
         STH   @15,CCWCNT                                          1061 04539000
*   /*****************************************************************/ 04540000
*   /*                                                               */ 04541000
*   /* INITIALIZE THE TIC ADDRESS.                           @Y30LB35*/ 04542000
*   /*                                                               */ 04543000
*   /*****************************************************************/ 04544000
*                                                                  1062 04545000
*   CCWADDR=ADDR(IOXCCW((EXPRECNO)+THREECCW));/*             @Y30LB35*/ 04546000
*                                                                  1062 04547000
         LH    @03,CCWCNT                                          1062 04548000
         SLA   @03,3                                               1062 04549000
         L     @01,IOCTLBKP                                        1062 04550000
         LA    @03,IOXCCW-8(@03,@01)                               1062 04551000
         L     @15,@PC00001+8                                      1062 04552000
         L     @01,EXPDATA(,@15)                                   1062 04553000
         LH    @15,THREECCW                                        1062 04554000
         AL    @15,EXPRECNO(,@01)                                  1062 04555000
         SLA   @15,3                                               1062 04556000
         L     @01,IOCTLBKP                                        1062 04557000
         LA    @15,IOXCCW-8(@15,@01)                               1062 04558000
         STCM  @15,7,CCWADDR(@03)                                  1062 04559000
*   /*****************************************************************/ 04560000
*   /*                                                               */ 04561000
*   /* SET UP THE LASTCCW FOR THE BUILD                      @Y30LB35*/ 04562000
*   /* CCW READ LOOP.                                        @Y30LB35*/ 04563000
*   /*                                                               */ 04564000
*   /*****************************************************************/ 04565000
*                                                                  1063 04566000
*   LASTCCW=(EXPRECNO*TWOCCWS)+FOURCCWS;/*                   @Y30LB35*/ 04567000
*                                                                  1063 04568000
         L     @03,@PC00001+8                                      1063 04569000
         L     @03,EXPDATA(,@03)                                   1063 04570000
         L     @03,EXPRECNO(,@03)                                  1063 04571000
         MH    @03,TWOCCWS                                         1063 04572000
         AH    @03,FOURCCWS                                        1063 04573000
         STH   @03,LASTCCW                                         1063 04574000
*   /*****************************************************************/ 04575000
*   /*                                                               */ 04576000
*   /* REINITIALIZE THE COUNTER VALUE TO THE                 @Y30LB35*/ 04577000
*   /* FIRST EXPARRAY ITEM.                                  @Y30LB35*/ 04578000
*   /*                                                               */ 04579000
*   /*****************************************************************/ 04580000
*                                                                  1064 04581000
*   ARRINDEX=1;                     /*                       @Y30LB35*/ 04582000
         MVC   ARRINDEX(2),@CH00222                                1064 04583000
*                                                                  1065 04584000
*   /*****************************************************************/ 04585000
*   /*                                                               */ 04586000
*   /* HERE THE LOOPING IS DONE TO BUILD THE                 @Y30LB35*/ 04587000
*   /* READ KEY AND DATA CCWS.                               @Y30LB35*/ 04588000
*   /* IT SHOULD BE NOTED THAT THE DATA                      @Y30LB35*/ 04589000
*   /* TRANSFER IS SUPPRESSED. THIS READ                     @Y30LB35*/ 04590000
*   /* IS BEING DONE TO TEST TO SEE IF                       @Y30LB35*/ 04591000
*   /* THE NEW RECORDS ARE THERE AND READABLE.               @Y30LB35*/ 04592000
*   /*                                                               */ 04593000
*   /*****************************************************************/ 04594000
*                                                                  1065 04595000
*   DO CCWCNT=(EXPRECNO+FIVECCWS) BY 1/*                     @Y30LB35*/ 04596000
*         WHILE CCWCNT<=LASTCCW;    /*                       @Y30LB35*/ 04597000
*                                                                  1065 04598000
         L     @03,@PC00001+8                                      1065 04599000
         L     @03,EXPDATA(,@03)                                   1065 04600000
         LH    @15,FIVECCWS                                        1065 04601000
         AL    @15,EXPRECNO(,@03)                                  1065 04602000
         STH   @15,CCWCNT                                          1065 04603000
         B     @DE01065                                            1065 04604000
@DL01065 DS    0H                                                  1066 04605000
*     /***************************************************************/ 04606000
*     /*                                                             */ 04607000
*     /* MOVE THE MODEL READ KEY AND DATA                    @Y30LB35*/ 04608000
*     /* CCW INTO THE CCW STRING.                            @Y30LB35*/ 04609000
*     /*                                                             */ 04610000
*     /***************************************************************/ 04611000
*                                                                  1066 04612000
*     IOXCCW(CCWCNT)=CCWRKD;        /*                       @Y30LB35*/ 04613000
*                                                                  1066 04614000
         LH    @03,CCWCNT                                          1066 04615000
         SLA   @03,3                                               1066 04616000
         L     @01,IOCTLBKP                                        1066 04617000
         ALR   @01,@03                                             1066 04618000
         MVC   IOXCCW-8(8,@01),CCWRKD                              1066 04619000
*     /***************************************************************/ 04620000
*     /*                                                             */ 04621000
*     /* TURN ON THE SUPPRESS DATA TRANSFER BIT              @Y30LB35*/ 04622000
*     /*                                                             */ 04623000
*     /***************************************************************/ 04624000
*                                                                  1067 04625000
*     CCWSUPP=ON;                   /*                       @Y30LB35*/ 04626000
*                                                                  1067 04627000
         LH    @03,CCWCNT                                          1067 04628000
         SLA   @03,3                                               1067 04629000
         L     @01,IOCTLBKP                                        1067 04630000
         LA    @03,IOXCCW-8(@03,@01)                               1067 04631000
         OI    CCWSUPP(@03),B'00010000'                            1067 04632000
*     /***************************************************************/ 04633000
*     /*                                                             */ 04634000
*     /* INITIALIZE DATA ADDRESS TO ZERO                     @Y30LB35*/ 04635000
*     /*                                                             */ 04636000
*     /***************************************************************/ 04637000
*                                                                  1068 04638000
*     CCWADDR=''B;                  /*                       @Y30LB35*/ 04639000
*                                                                  1068 04640000
         LH    @03,CCWCNT                                          1068 04641000
         SLA   @03,3                                               1068 04642000
         L     @01,IOCTLBKP                                        1068 04643000
         LA    @03,IOXCCW-8(@03,@01)                               1068 04644000
         SLR   @15,@15                                             1068 04645000
         STCM  @15,7,CCWADDR(@03)                                  1068 04646000
*     /***************************************************************/ 04647000
*     /*                                                             */ 04648000
*     /* SET DATA LENGTH                                     @Y30LB35*/ 04649000
*     /*                                                             */ 04650000
*     /***************************************************************/ 04651000
*                                                                  1069 04652000
*     CCWDATLN=EXPDATAL(ARRINDEX)+EXPKEYLN(ARRINDEX);              1069 04653000
*                                                                  1069 04654000
         LH    @03,CCWCNT                                          1069 04655000
         SLA   @03,3                                               1069 04656000
         L     @01,IOCTLBKP                                        1069 04657000
         LA    @03,IOXCCW-8(@03,@01)                               1069 04658000
         LH    @15,ARRINDEX                                        1069 04659000
         SLA   @15,3                                               1069 04660000
         L     @14,@PC00001+8                                      1069 04661000
         L     @01,EXPDATA(,@14)                                   1069 04662000
         LH    @14,ARRINDEX                                        1069 04663000
         SLA   @14,3                                               1069 04664000
         L     @07,@PC00001+8                                      1069 04665000
         L     @07,EXPDATA(,@07)                                   1069 04666000
         SLR   @06,@06                                             1069 04667000
         IC    @06,EXPKEYLN-8(@14,@07)                             1069 04668000
         AH    @06,EXPDATAL-8(@15,@01)                             1069 04669000
         STH   @06,CCWDATLN(,@03)                                  1069 04670000
*     /***************************************************************/ 04671000
*     /*                                                             */ 04672000
*     /* INCREMENT THE EXPARRAY COUNTER                      @Y30LB35*/ 04673000
*     /*                                                             */ 04674000
*     /***************************************************************/ 04675000
*                                                                  1070 04676000
*     ARRINDEX=ARRINDEX+1;          /*                       @Y30LB35*/ 04677000
         LH    @03,ARRINDEX                                        1070 04678000
         LA    @03,1(,@03)                                         1070 04679000
         STH   @03,ARRINDEX                                        1070 04680000
*   END;                            /*                       @Y30LB35*/ 04681000
         LA    @15,1                                               1071 04682000
         AH    @15,CCWCNT                                          1071 04683000
         STH   @15,CCWCNT                                          1071 04684000
@DE01065 LH    @03,CCWCNT                                          1071 04685000
         CH    @03,LASTCCW                                         1071 04686000
         BNH   @DL01065                                            1071 04687000
*                                                                  1072 04688000
*   /*****************************************************************/ 04689000
*   /*                                                               */ 04690000
*   /* BACK UP THE LAST CCW                                  @Y30LB35*/ 04691000
*   /*                                                               */ 04692000
*   /*****************************************************************/ 04693000
*                                                                  1072 04694000
*   CCWCNT=CCWCNT-1;                /*                       @Y30LB35*/ 04695000
*                                                                  1072 04696000
         LH    @03,CCWCNT                                          1072 04697000
         BCTR  @03,0                                               1072 04698000
         STH   @03,CCWCNT                                          1072 04699000
*   /*****************************************************************/ 04700000
*   /*                                                               */ 04701000
*   /* TURN OFF THE COMMAND CHAING BIT                       @Y30LB35*/ 04702000
*   /* TO INDICATE THAT THIS IS THE END                      @Y30LB35*/ 04703000
*   /* OF THE CCW STRING.                                    @Y30LB35*/ 04704000
*   /*                                                               */ 04705000
*   /*****************************************************************/ 04706000
*                                                                  1073 04707000
*   CCWCMDCH=OFF;                   /*                       @Y30LB35*/ 04708000
*                                                                  1073 04709000
         LH    @03,CCWCNT                                          1073 04710000
         SLA   @03,3                                               1073 04711000
         L     @01,IOCTLBKP                                        1073 04712000
         LA    @03,IOXCCW-8(@03,@01)                               1073 04713000
         NI    CCWCMDCH(@03),B'10111111'                           1073 04714000
*   /*****************************************************************/ 04715000
*   /*                                                               */ 04716000
*   /* CONTROL IS RETURNED TO PUTGET                         @Y30LB35*/ 04717000
*   /* WITH A ZERO RETURN CODE IN REGISTER 15                @Y30LB35*/ 04718000
*   /*                                                               */ 04719000
*   /*****************************************************************/ 04720000
*                                                                  1074 04721000
*   RETURN CODE(0);                 /*                       @Y30LB35*/ 04722000
         SLR   @15,@15                                             1074 04723000
         L     @14,12(,@13)                                        1074 04724000
         LM    @00,@12,20(@13)                                     1074 04725000
         BR    @14                                                 1074 04726000
*   END BLDCCWP2;                   /*                       @Y30LB35*/ 04727000
*                                                                  1076 04728000
*/********************************************************************/ 04729000
*/*                                                          @Y30LB35*/ 04730000
*/* PROCEDURE NAME - BLDCCWG                                 @Y30LB35*/ 04731000
*/*                                                          @Y30LB35*/ 04732000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 04733000
*/*             BUILD CCW'S TO READ "KEY DATA"               @Y30LB35*/ 04734000
*/*                                                          @Y30LB35*/ 04735000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 04736000
*/*                                                          @Y30LB35*/ 04737000
*/* INPUT -     USERCCHH IN CALLER'S CORE                    @Y30LB35*/ 04738000
*/*             EXGCCHH1 IN EXGAGL                           @Y30LB35*/ 04739000
*/*             EXGCCHH2 IN EXGAGL                           @Y30LB35*/ 04740000
*/*             EXGDAYLN IN EXGDATAB                         @Y30LB35*/ 04741000
*/*             EXGKEYLN IN EXGDATAB                         @Y30LB35*/ 04742000
*/*             EXGDATAL IN EXGDATAB                         @Y30LB35*/ 04743000
*/*             EXGRECNO IN EXGDATAB                         @Y30LB35*/ 04744000
*/*             CCWSIDEQ                                     @Y30LB35*/ 04745000
*/*             CCWTIC                                       @Y30LB35*/ 04746000
*/*             CCWWKD                                       @Y30LB35*/ 04747000
*/*             CCWDATA                                      @Y30LB35*/ 04748000
*/*                                                          @Y30LB35*/ 04749000
*/* OUTPUT -    IOXCCW(X) IOXCTLBK                           @Y30LB35*/ 04750000
*/*             WRITECNT IN IOXCTLBK                         @Y30LB35*/ 04751000
*/*             READCNTA IN IOXCTLBK                         @ZA11014*/ 04752000
*/*             IOBSEEK  IN IOXIOB                           @Y30LB35*/ 04753000
*/*             CCWCMDCH IN IOXCCW                           @Y30LB35*/ 04754000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 04755000
*/*                                                          @Y30LB35*/ 04756000
*/********************************************************************/ 04757000
*                                                                  1076 04758000
*                                   /*                       @Y30LB35*/ 04759000
*BLDCCWG:                                                          1076 04760000
*   PROC;                           /*                       @Y30LB35*/ 04761000
*                                                                  1076 04762000
BLDCCWG  STM   @14,@12,12(@13)                                     1076 04763000
*   /*****************************************************************/ 04764000
*   /*                                                               */ 04765000
*   /* SET UP TRACE POINT 'IOG1' IN TRACE TABLE              @Y30LB35*/ 04766000
*   /*                                                               */ 04767000
*   /*****************************************************************/ 04768000
*                                                                  1077 04769000
*   OLDERID2=NEWERID2;                                             1077 04770000
         L     @03,@PC00001                                        1077 04771000
         L     @03,GDTTR2(,@03)                                    1077 04772000
         L     @15,@PC00001                                        1077 04773000
         L     @01,GDTTR2(,@15)                                    1077 04774000
         MVC   @TS00001(95),NEWERID2(@01)                          1077 04775000
         MVC   OLDERID2(95,@03),@TS00001                           1077 04776000
*   NEWID2='IOG1';                  /*                       @Y30LB35*/ 04777000
*                                                                  1078 04778000
         L     @03,@PC00001                                        1078 04779000
         L     @03,GDTTR2(,@03)                                    1078 04780000
         MVC   NEWID2(4,@03),@CC04256                              1078 04781000
*   /*****************************************************************/ 04782000
*   /*                                                               */ 04783000
*   /* HERE STARTS THE INITIALIZATION OF THE CCWS            @Y30LB35*/ 04784000
*   /* THE FIRST THING DONE IS THE MODEL CCW                 @Y30LB35*/ 04785000
*   /* SEARCH I.D. EQUAL IS MOVE INTO CCWS                   @Y30LB35*/ 04786000
*   /*                                                               */ 04787000
*   /*****************************************************************/ 04788000
*                                                                  1079 04789000
*   IOXCCW(1)=CCWSIDEQ;             /*                       @Y30LB35*/ 04790000
*                                                                  1079 04791000
         L     @03,IOCTLBKP                                        1079 04792000
         MVC   IOXCCW(8,@03),CCWSIDEQ                              1079 04793000
*   /*****************************************************************/ 04794000
*   /*                                                               */ 04795000
*   /* INITIALIZE CCW ARRAY COUNTER TO THE 1ST CCW           @Y30LB35*/ 04796000
*   /*                                                               */ 04797000
*   /*****************************************************************/ 04798000
*                                                                  1080 04799000
*   CCWCNT=1;                       /*                       @Y30LB35*/ 04800000
*                                                                  1080 04801000
         MVC   CCWCNT(2),@CH00222                                  1080 04802000
*   /*****************************************************************/ 04803000
*   /*                                                               */ 04804000
*   /* THE NEXT SIX INSTRUCTIONS INITIALIZES THE             @Y30LB35*/ 04805000
*   /* SEARCH AND IOBSEEK CCHHR VALUE.                       @Y30LB35*/ 04806000
*   /* FIRST A DETERMINATION IS MADE IF                      @Y30LB35*/ 04807000
*   /* THE CALLER HAS PASSED THE SEEK CCHHR                  @Y30LB35*/ 04808000
*   /*                                                               */ 04809000
*   /*****************************************************************/ 04810000
*                                                                  1081 04811000
*   IF EXGCCHH1^=NULLPTR            /*                       @Y30LB35*/ 04812000
*     THEN                          /*                       @Y30LB35*/ 04813000
         L     @03,@PC00001+8                                      1081 04814000
         L     @03,EXGCCHH1(,@03)                                  1081 04815000
         LTR   @03,@03                                             1081 04816000
         BZ    @RF01081                                            1081 04817000
*     USERCHRP=EXGCCHH1;            /*                       @Y30LB35*/ 04818000
*                                                                  1082 04819000
         L     @03,@PC00001+8                                      1082 04820000
         L     @03,EXGCCHH1(,@03)                                  1082 04821000
         ST    @03,USERCHRP                                        1082 04822000
*   /*****************************************************************/ 04823000
*   /*                                                               */ 04824000
*   /* IF THE SEEK CCHHR WAS NOT PASSED,                     @Y30LB35*/ 04825000
*   /* THE CCHHR OF THE SEARCH IS USED.                      @Y30LB35*/ 04826000
*   /*                                                               */ 04827000
*   /*****************************************************************/ 04828000
*                                                                  1083 04829000
*   ELSE                            /*                       @Y30LB35*/ 04830000
*     USERCHRP=EXGCCHH2;            /*                       @Y30LB35*/ 04831000
         B     @RC01081                                            1083 04832000
@RF01081 L     @03,@PC00001+8                                      1083 04833000
         L     @03,EXGCCHH2(,@03)                                  1083 04834000
         ST    @03,USERCHRP                                        1083 04835000
*   TEMPCCHH=''B;                   /*                       @Y30LB35*/ 04836000
@RC01081 XC    TEMPCCHH(8),TEMPCCHH                                1084 04837000
*   TEMPCHR=USERCCHH;               /*                       @Y30LB35*/ 04838000
         L     @03,USERCHRP                                        1085 04839000
         MVC   TEMPCHR(5),USERCCHH(@03)                            1085 04840000
*   IOBSEEK=TEMPCCHH;               /*                       @Y30LB35*/ 04841000
         L     @03,IOBSTPTR                                        1086 04842000
         MVC   IOBSEEK(8,@03),TEMPCCHH                             1086 04843000
*   CCWADDR=EXGCCHH2;               /*                       @Y30LB35*/ 04844000
*                                                                  1087 04845000
         LH    @03,CCWCNT                                          1087 04846000
         SLA   @03,3                                               1087 04847000
         L     @01,IOCTLBKP                                        1087 04848000
         LA    @03,IOXCCW-8(@03,@01)                               1087 04849000
         L     @15,@PC00001+8                                      1087 04850000
         MVC   CCWADDR(3,@03),EXGCCHH2+1(@15)                      1087 04851000
*   /*****************************************************************/ 04852000
*   /*                                                               */ 04853000
*   /* HERE THE SECOND CCW IS INITIALIZED WITH               @Y30LB35*/ 04854000
*   /* THE TRANSFER IN CHANNEL(TIC) CCW.                     @Y30LB35*/ 04855000
*   /* THIS WILL ALLOW THE CHANNEL TO LOOP                   @Y30LB35*/ 04856000
*   /* UNTIL IT FINDS THE CCHHR IN THE SEARCH.               @Y30LB35*/ 04857000
*   /*                                                               */ 04858000
*   /*****************************************************************/ 04859000
*                                                                  1088 04860000
*   IOXCCW(2)=CCWTIC;               /*                       @Y30LB35*/ 04861000
         L     @03,IOCTLBKP                                        1088 04862000
         MVC   IOXCCW+8(8,@03),CCWTIC                              1088 04863000
*   CCWCNT=TWOCCWS;                 /*                       @Y30LB35*/ 04864000
         LH    @03,TWOCCWS                                         1089 04865000
         STH   @03,CCWCNT                                          1089 04866000
*   CCWADDR=ADDR(IOXCCW(1));        /*                       @Y30LB35*/ 04867000
*                                                                  1090 04868000
         LH    @03,CCWCNT                                          1090 04869000
         SLA   @03,3                                               1090 04870000
         L     @01,IOCTLBKP                                        1090 04871000
         LA    @03,IOXCCW-8(@03,@01)                               1090 04872000
         L     @01,IOCTLBKP                                        1090 04873000
         LA    @15,IOXCCW(,@01)                                    1090 04874000
         STCM  @15,7,CCWADDR(@03)                                  1090 04875000
*   /*****************************************************************/ 04876000
*   /*                                                               */ 04877000
*   /* THE CCW READ AND CCW WRITE COUNTERS ARE               @Y30LB35*/ 04878000
*   /* INITIALIZED TO ZERO.                                  @Y30LB35*/ 04879000
*   /*                                                               */ 04880000
*   /*****************************************************************/ 04881000
*                                                                  1091 04882000
*   WRITECNT=ZERO;                  /*                       @Y30LB35*/ 04883000
         LH    @03,ZERO                                            1091 04884000
         STH   @03,WRITECNT                                        1091 04885000
*   READCNTA=ZERO;                  /*                       @ZA11014*/ 04886000
         LH    @03,ZERO                                            1092 04887000
         STH   @03,READCNTA                                        1092 04888000
*                                                                  1093 04889000
*   /*****************************************************************/ 04890000
*   /*                                                               */ 04891000
*   /* THE LASTCCW IS CALCULATED AND USED TO                 @Y30LB35*/ 04892000
*   /* CONTROL THE LOOP USED TO BUILD THE                    @Y30LB35*/ 04893000
*   /* READ KEY AND DATA CCWS FOR                            @Y30LB35*/ 04894000
*   /* ALL THE RECORDS BEING READ.                           @Y30LB35*/ 04895000
*   /* ALSO DONE IS THE INITIALIZATION OF                    @Y30LB35*/ 04896000
*   /* OFFSET VARIABLE USED TO ADDRESS THE                   @Y30LB35*/ 04897000
*   /* DATA RECORDS.                                         @Y30LB35*/ 04898000
*   /*                                                               */ 04899000
*   /*****************************************************************/ 04900000
*                                                                  1093 04901000
*   LASTCCW=EXGRECNO+TWOCCWS;       /*                       @Y30LB35*/ 04902000
         L     @03,@PC00001+8                                      1093 04903000
         LH    @15,TWOCCWS                                         1093 04904000
         AL    @15,EXGRECNO(,@03)                                  1093 04905000
         STH   @15,LASTCCW                                         1093 04906000
*   OFFSET=ZERO;                    /*                       @Y30LB35*/ 04907000
*                                                                  1094 04908000
         LH    @03,ZERO                                            1094 04909000
         STH   @03,OFFSET                                          1094 04910000
*   /*****************************************************************/ 04911000
*   /*                                                               */ 04912000
*   /* HERE LOOPING WILL BE PERFORMED WHILE                  @Y30LB35*/ 04913000
*   /* THE READ KEY AND DATA CCWS ARE BUILT.                 @Y30LB35*/ 04914000
*   /*                                                               */ 04915000
*   /*****************************************************************/ 04916000
*                                                                  1095 04917000
*   DO CCWCNT=THREECCW TO LASTCCW;  /*                       @Y30LB35*/ 04918000
*                                                                  1095 04919000
         LH    @03,THREECCW                                        1095 04920000
         B     @DE01095                                            1095 04921000
@DL01095 DS    0H                                                  1096 04922000
*     /***************************************************************/ 04923000
*     /*                                                             */ 04924000
*     /* MOVE IN MODEL READ KEY DATA CCW                     @Y30LB35*/ 04925000
*     /*                                                             */ 04926000
*     /***************************************************************/ 04927000
*                                                                  1096 04928000
*     IOXCCW(CCWCNT)=CCWRKD;        /*                       @Y30LB35*/ 04929000
*                                                                  1096 04930000
         LH    @03,CCWCNT                                          1096 04931000
         SLA   @03,3                                               1096 04932000
         L     @01,IOCTLBKP                                        1096 04933000
         ALR   @01,@03                                             1096 04934000
         MVC   IOXCCW-8(8,@01),CCWRKD                              1096 04935000
*     /***************************************************************/ 04936000
*     /*                                                             */ 04937000
*     /* INCREMENT THE READ COUNTER                          @Y30LB35*/ 04938000
*     /*                                                             */ 04939000
*     /***************************************************************/ 04940000
*                                                                  1097 04941000
*     READCNTA=READCNTA+1;          /*                       @ZA11014*/ 04942000
*                                                                  1097 04943000
         LH    @03,READCNTA                                        1097 04944000
         LA    @03,1(,@03)                                         1097 04945000
         STH   @03,READCNTA                                        1097 04946000
*     /***************************************************************/ 04947000
*     /*                                                             */ 04948000
*     /* FILL IN THE DATA ADDRESS AND DATA LENGTH            @Y30LB35*/ 04949000
*     /*                                                             */ 04950000
*     /***************************************************************/ 04951000
*                                                                  1098 04952000
*     CCWADDR=EXGDATAP+OFFSET;      /*                       @Y30LB35*/ 04953000
         LH    @03,CCWCNT                                          1098 04954000
         SLA   @03,3                                               1098 04955000
         L     @01,IOCTLBKP                                        1098 04956000
         LA    @03,IOXCCW-8(@03,@01)                               1098 04957000
         L     @15,@PC00001+8                                      1098 04958000
         LH    @14,OFFSET                                          1098 04959000
         AL    @14,EXGDATAP(,@15)                                  1098 04960000
         STCM  @14,7,CCWADDR(@03)                                  1098 04961000
*     CCWDATLN=EXGKEYLN+EXGDATAL;   /*                       @Y30LB35*/ 04962000
*                                                                  1099 04963000
         LH    @03,CCWCNT                                          1099 04964000
         SLA   @03,3                                               1099 04965000
         L     @01,IOCTLBKP                                        1099 04966000
         LA    @03,IOXCCW-8(@03,@01)                               1099 04967000
         L     @15,@PC00001+8                                      1099 04968000
         L     @14,@PC00001+8                                      1099 04969000
         SLR   @07,@07                                             1099 04970000
         IC    @07,EXGKEYLN(,@15)                                  1099 04971000
         AH    @07,EXGDATAL(,@14)                                  1099 04972000
         STH   @07,CCWDATLN(,@03)                                  1099 04973000
*     /***************************************************************/ 04974000
*     /*                                                             */ 04975000
*     /* ADVANCE THE DATA ADDRESS OFFSET FOR NEXT CCW        @Y30LB35*/ 04976000
*     /*                                                             */ 04977000
*     /***************************************************************/ 04978000
*                                                                  1100 04979000
*     OFFSET=OFFSET+EXGKEYLN+EXGDATAL;/*                     @Y30LB35*/ 04980000
         L     @03,@PC00001+8                                      1100 04981000
         SLR   @15,@15                                             1100 04982000
         IC    @15,EXGKEYLN(,@03)                                  1100 04983000
         AH    @15,OFFSET                                          1100 04984000
         L     @03,@PC00001+8                                      1100 04985000
         AH    @15,EXGDATAL(,@03)                                  1100 04986000
         STH   @15,OFFSET                                          1100 04987000
*   END;                            /*                       @Y30LB35*/ 04988000
*                                                                  1101 04989000
         LA    @03,1                                               1101 04990000
         AH    @03,CCWCNT                                          1101 04991000
@DE01095 STH   @03,CCWCNT                                          1101 04992000
         CH    @03,LASTCCW                                         1101 04993000
         BNH   @DL01095                                            1101 04994000
*   /*****************************************************************/ 04995000
*   /*                                                               */ 04996000
*   /* BACK UP TO THE LAST CCW                               @Y30LB35*/ 04997000
*   /*                                                               */ 04998000
*   /*****************************************************************/ 04999000
*                                                                  1102 05000000
*   CCWCNT=CCWCNT-1;                /*                       @Y30LB35*/ 05001000
*                                                                  1102 05002000
         LH    @03,CCWCNT                                          1102 05003000
         BCTR  @03,0                                               1102 05004000
         STH   @03,CCWCNT                                          1102 05005000
*   /*****************************************************************/ 05006000
*   /*                                                               */ 05007000
*   /* TURN OFF THE COMMAND CHAINING BIT TO                  @Y30LB35*/ 05008000
*   /* INDICATE THAT THIS IS END OF CCWS                     @Y30LB35*/ 05009000
*   /*                                                               */ 05010000
*   /*****************************************************************/ 05011000
*                                                                  1103 05012000
*   CCWCMDCH=OFF;                   /*                       @Y30LB35*/ 05013000
*                                                                  1103 05014000
         LH    @03,CCWCNT                                          1103 05015000
         SLA   @03,3                                               1103 05016000
         L     @01,IOCTLBKP                                        1103 05017000
         LA    @03,IOXCCW-8(@03,@01)                               1103 05018000
         NI    CCWCMDCH(@03),B'10111111'                           1103 05019000
*   /*****************************************************************/ 05020000
*   /*                                                               */ 05021000
*   /* CONTROL IS RETURNED TO PUTGET                         @Y30LB35*/ 05022000
*   /* WITH A ZERO RETURN CODE IN REGISTER 15                @Y30LB35*/ 05023000
*   /*                                                               */ 05024000
*   /*****************************************************************/ 05025000
*                                                                  1104 05026000
*   TESTRC=0;                       /*                       @Y30LB35*/ 05027000
         SLR   @03,@03                                             1104 05028000
         STH   @03,TESTRC                                          1104 05029000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 05030000
         LH    @15,TESTRC                                          1105 05031000
         L     @14,12(,@13)                                        1105 05032000
         LM    @00,@12,20(@13)                                     1105 05033000
         BR    @14                                                 1105 05034000
*   END BLDCCWG;                    /*                       @Y30LB35*/ 05035000
*                                                                  1107 05036000
*/********************************************************************/ 05037000
*/*                                                          @Y30LB35*/ 05038000
*/* PROCEDURE NAME - ISSUEXCP                                @Y30LB35*/ 05039000
*/*                                                          @Y30LB35*/ 05040000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 05041000
*/*             ISSUE THE I/O.  THIS IS DONE BY THE          @Y30LB35*/ 05042000
*/*             FOLLOWING STEPS:                             @Y30LB35*/ 05043000
*/*             ISSUES EXCP MACRO, ISSUES WAIT MACRO,        @Y30LB35*/ 05044000
*/*             TESTS FOR I/O ERRORS AND CALLS SYNAD         @Y30LB35*/ 05045000
*/*                                                          @Y30LB35*/ 05046000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 05047000
*/*                                                          @Y30LB35*/ 05048000
*/* INPUT -     IOXIOB IN IOXCTLBK                           @Y30LB35*/ 05049000
*/*             IOXECB IN IOXCTLBK                           @Y30LB35*/ 05050000
*/*             READCNTA                                     @ZA11014*/ 05051000
*/*             WRITECNT                                     @Y30LB35*/ 05052000
*/*                                                          @Y30LB35*/ 05053000
*/* OUTPUT -    IOXREADS IN IOXCTLBK                         @Y30LB35*/ 05054000
*/*             IOXWRITE IN IOXCTLBK                         @Y30LB35*/ 05055000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 05056000
*/*                           4, IF I/O ERROR                @Y30LB35*/ 05057000
*/*                                                          @Y30LB35*/ 05058000
*/********************************************************************/ 05059000
*                                                                  1107 05060000
*                                   /*                       @Y30LB35*/ 05061000
*ISSUEXCP:                                                         1107 05062000
*   PROC;                           /*                       @Y30LB35*/ 05063000
*                                                                  1107 05064000
ISSUEXCP STM   @14,@12,@SA00014                                    1107 05065000
*   /*****************************************************************/ 05066000
*   /*                                                               */ 05067000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 05068000
*   /*                                                               */ 05069000
*   /*****************************************************************/ 05070000
*                                                                  1108 05071000
*   DCL                                                            1108 05072000
*     SUCCESS CHAR(1) STATIC INIT('7F'X);/*                  @Y30LB35*/ 05073000
*                                                                  1109 05074000
*   /*****************************************************************/ 05075000
*   /*                                                               */ 05076000
*   /* SET UP TRACE POINT 'IOXC' IN TRACE TABLE              @Y30LB35*/ 05077000
*   /*                                                               */ 05078000
*   /*****************************************************************/ 05079000
*                                                                  1109 05080000
*   OLDERID2=NEWERID2;                                             1109 05081000
         L     @03,@PC00001                                        1109 05082000
         L     @03,GDTTR2(,@03)                                    1109 05083000
         L     @15,@PC00001                                        1109 05084000
         L     @01,GDTTR2(,@15)                                    1109 05085000
         MVC   @TS00001(95),NEWERID2(@01)                          1109 05086000
         MVC   OLDERID2(95,@03),@TS00001                           1109 05087000
*   NEWID2='IOXC';                  /*                       @Y30LB35*/ 05088000
*                                                                  1110 05089000
         L     @03,@PC00001                                        1110 05090000
         L     @03,GDTTR2(,@03)                                    1110 05091000
         MVC   NEWID2(4,@03),@CC04262                              1110 05092000
*   /*****************************************************************/ 05093000
*   /*                                                               */ 05094000
*   /* INITIALIZE THE ECB FOR IOS TO POST                    @Y30LB35*/ 05095000
*   /* AFTER THE I/O HAS COMPLETED.                          @Y30LB35*/ 05096000
*   /*                                                               */ 05097000
*   /*****************************************************************/ 05098000
*                                                                  1111 05099000
*   ECBPTR=ADDR(IOXECB);            /*                       @Y30LB35*/ 05100000
         L     @03,IOCTLBKP                                        1111 05101000
         LA    @03,IOXECB(,@03)                                    1111 05102000
         ST    @03,ECBPTR                                          1111 05103000
*   ECB=''B;                        /*                       @Y30LB35*/ 05104000
         L     @03,ECBPTR                                          1112 05105000
         XC    ECB(4,@03),ECB(@03)                                 1112 05106000
*   TESTRC=0;                       /*                       @ZA28050*/ 05107000
*                                                                  1113 05108000
         SLR   @03,@03                                             1113 05109000
         STH   @03,TESTRC                                          1113 05110000
*   /*****************************************************************/ 05111000
*   /*                                                               */ 05112000
*   /* SET UP ADDRESSABILITY TO THE IOB                      @Y30LB35*/ 05113000
*   /*                                                               */ 05114000
*   /*****************************************************************/ 05115000
*                                                                  1114 05116000
*   RESPECIFY                                                      1114 05117000
*     REG1 RESTRICTED;              /*                       @Y30LB35*/ 05118000
*   REG1=ADDR(IOXIOB);              /*                       @Y30LB35*/ 05119000
*                                                                  1115 05120000
         L     REG1,IOCTLBKP                                       1115 05121000
         LA    REG1,IOXIOB(,REG1)                                  1115 05122000
*   /*****************************************************************/ 05123000
*   /*                                                               */ 05124000
*   /* ISSUE THE EXCP TO PERFORM THE I/O                     @Y30LB35*/ 05125000
*   /*                                                               */ 05126000
*   /*****************************************************************/ 05127000
*                                                                  1116 05128000
*LEXCP1:                                                           1116 05129000
*   GEN(EXCP   (REG1));             /*                       @Y30LB35*/ 05130000
LEXCP1   EXCP   (REG1)                                                  05131000
*   RESPECIFY                                                      1117 05132000
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/ 05133000
*                                                                  1118 05134000
*   /*****************************************************************/ 05135000
*   /*                                                               */ 05136000
*   /* HERE A TEST IS MADE TO DETERMINE WHETHER              @Y30LB35*/ 05137000
*   /* THE I/O HAS COMPLETED IF NOT THE                      @Y30LB35*/ 05138000
*   /* WAIT MACRO SHOULD BE ISSUED.                          @Y30LB35*/ 05139000
*   /*                                                               */ 05140000
*   /*****************************************************************/ 05141000
*                                                                  1118 05142000
*   IF ECBPOSTB^=ON                 /*                       @Y30LB35*/ 05143000
*     THEN                          /*                       @Y30LB35*/ 05144000
*                                                                  1118 05145000
         L     @03,ECBPTR                                          1118 05146000
         TM    ECBPOSTB(@03),B'01000000'                           1118 05147000
         BO    @RF01118                                            1118 05148000
*     /***************************************************************/ 05149000
*     /*                                                             */ 05150000
*     /* ISSUE THE WAIT MACRO FOR THE I/O TO                 @Y30LB35*/ 05151000
*     /* COMPLETE.                                           @Y30LB35*/ 05152000
*     /*                                                             */ 05153000
*     /***************************************************************/ 05154000
*                                                                  1119 05155000
*LWAIT1:                                                           1119 05156000
*     DO;                           /* WAIT ECB(ECB)                 */ 05157000
LWAIT1   DS    0H                                                  1120 05158000
*       RESPECIFY                                                  1120 05159000
*        (GPR00P,                                                  1120 05160000
*         GPR01P) RESTRICTED;                                      1120 05161000
*       GPR00P=1;                   /* LOAD WAIT COUNT               */ 05162000
         LA    GPR00P,1                                            1121 05163000
*       GPR01P=ADDR(ECB);           /* ADDRESS OF ECB                */ 05164000
         L     GPR01P,ECBPTR                                       1122 05165000
*       SVC(1);                     /* WAIT SVC                      */ 05166000
         SVC   1                                                   1123 05167000
*       RESPECIFY                                                  1124 05168000
*        (GPR00P,                                                  1124 05169000
*         GPR01P) UNRESTRICTED;                                    1124 05170000
*     END;                          /* WAIT ECB(ECB)         @Y30LB35*/ 05171000
*                                                                  1125 05172000
*   /*****************************************************************/ 05173000
*   /*                                                               */ 05174000
*   /* TEST FOR A SUCCESSFUL I/O OPERATION                   @Y30LB35*/ 05175000
*   /*                                                               */ 05176000
*   /*****************************************************************/ 05177000
*                                                                  1126 05178000
*   IF ECBCC^=SUCCESS               /*                       @Y30LB35*/ 05179000
*     THEN                          /*                       @Y30LB35*/ 05180000
@RF01118 L     @03,ECBPTR                                          1126 05181000
         CLC   ECBCC(1,@03),SUCCESS                                1126 05182000
         BE    @RF01126                                            1126 05183000
*     DO;                           /*                       @Y30LB35*/ 05184000
*                                                                  1127 05185000
*       /*************************************************************/ 05186000
*       /*                                                           */ 05187000
*       /* UNSUCCESSFUL COMPLETION - CHECK TO SEE IF         @ZA11014*/ 05188000
*       /* IT WAS A REPAIRV CALL                             @ZA11014*/ 05189000
*       /*                                                           */ 05190000
*       /*************************************************************/ 05191000
*                                                                  1128 05192000
*       IF REQUEST^=OPEN            /*                       @ZA11014*/ 05193000
*           &REQUEST^=PUT           /*                       @ZA11014*/ 05194000
*           &REQUEST^=GET           /*                       @ZA11014*/ 05195000
*           &REQUEST^=CLOSE         /*                       @ZA11014*/ 05196000
*                                                                  1128 05197000
*       /*************************************************************/ 05198000
*       /*                                                           */ 05199000
*       /* A REPAIRV REQUEST-CHECK OTHER POSSIBLE            @ZA11014*/ 05200000
*       /* POST CODES                                        @ZA11014*/ 05201000
*       /*                                                           */ 05202000
*       /*************************************************************/ 05203000
*                                                                  1128 05204000
*         THEN                      /*                       @ZA11014*/ 05205000
         L     @03,@PC00001+4                                      1128 05206000
         CLC   REQUEST(8,@03),OPEN                                 1128 05207000
         BE    @RF01128                                            1128 05208000
         L     @03,@PC00001+4                                      1128 05209000
         CLC   REQUEST(8,@03),PUT                                  1128 05210000
         BE    @RF01128                                            1128 05211000
         L     @03,@PC00001+4                                      1128 05212000
         CLC   REQUEST(8,@03),GET                                  1128 05213000
         BE    @RF01128                                            1128 05214000
         L     @03,@PC00001+4                                      1128 05215000
         CLC   REQUEST(8,@03),CLOSE                                1128 05216000
         BE    @RF01128                                            1128 05217000
*         DO;                       /*                       @ZA28050*/ 05218000
*                                                                  1129 05219000
*           /*********************************************************/ 05220000
*           /*                                                       */ 05221000
*           /* CHECK IF END OF FILE RECORD READ              @ZA11014*/ 05222000
*           /*                                                       */ 05223000
*           /*********************************************************/ 05224000
*                                                                  1130 05225000
*           IF ECBCC=PCEOFIND       /*                       @ZA11014*/ 05226000
*                                                                  1130 05227000
*           /*********************************************************/ 05228000
*           /*                                                       */ 05229000
*           /* SET RETURN CODE TO END OF FILE READ           @ZA11014*/ 05230000
*           /*                                                       */ 05231000
*           /*********************************************************/ 05232000
*                                                                  1130 05233000
*             THEN                  /*                       @ZA11014*/ 05234000
         L     @03,ECBPTR                                          1130 05235000
         CLC   ECBCC(1,@03),PCEOFIND                               1130 05236000
         BNE   @RF01130                                            1130 05237000
*             TESTRC=RCABEOFR;      /*                       @ZA11014   05238000
*                                                            @ZA11014*/ 05239000
         LH    @03,RCABEOFR                                        1131 05240000
         STH   @03,TESTRC                                          1131 05241000
*           ELSE                    /*                       @ZA11014*/ 05242000
*                                                                  1132 05243000
*             /*******************************************************/ 05244000
*             /*                                                     */ 05245000
*             /* CHECK IF DESTAGE ERROR                      @ZA11014*/ 05246000
*             /*                                                     */ 05247000
*             /*******************************************************/ 05248000
*                                                                  1132 05249000
*             IF ECBCC=PCDSTERR     /*                       @ZA11014*/ 05250000
*                                                                  1132 05251000
*             /*******************************************************/ 05252000
*             /*                                                     */ 05253000
*             /* THEN SET DESTAGE ERROR RETURN CODE          @ZA11014*/ 05254000
*             /*                                                     */ 05255000
*             /*******************************************************/ 05256000
*                                                                  1132 05257000
*               THEN                /*                       @ZA11014*/ 05258000
         B     @RC01130                                            1132 05259000
@RF01130 L     @03,ECBPTR                                          1132 05260000
         CLC   ECBCC(1,@03),PCDSTERR                               1132 05261000
         BNE   @RF01132                                            1132 05262000
*               TESTRC=RCABDS;      /*                       @ZA11014   05263000
*                                                            @ZA11014*/ 05264000
         LH    @03,RCABDS                                          1133 05265000
         STH   @03,TESTRC                                          1133 05266000
*             ELSE                  /*                       @ZA11014*/ 05267000
*                                                                  1134 05268000
*               /*****************************************************/ 05269000
*               /*                                                   */ 05270000
*               /* CHECK IF STAGE ERROR                      @ZA11014*/ 05271000
*               /*                                                   */ 05272000
*               /*****************************************************/ 05273000
*                                                                  1134 05274000
*               IF ECBCC=PCSTGERR   /*                       @ZA11014*/ 05275000
*                                                                  1134 05276000
*               /*****************************************************/ 05277000
*               /*                                                   */ 05278000
*               /* THEN SET STAGE ERROR RETURN CODE          @ZA11014*/ 05279000
*               /*                                                   */ 05280000
*               /*****************************************************/ 05281000
*                                                                  1134 05282000
*                 THEN              /*                       @ZA11014*/ 05283000
         B     @RC01132                                            1134 05284000
@RF01132 L     @03,ECBPTR                                          1134 05285000
         CLC   ECBCC(1,@03),PCSTGERR                               1134 05286000
         BNE   @RF01134                                            1134 05287000
*                 TESTRC=RCABST;    /*                       @ZA11014   05288000
*                                                            @ZA11014*/ 05289000
         LH    @03,RCABST                                          1135 05290000
         STH   @03,TESTRC                                          1135 05291000
*               ELSE                /*                       @ZA11014*/ 05292000
*                                                                  1136 05293000
*                 /***************************************************/ 05294000
*                 /*                                                 */ 05295000
*                 /* CHECK IF OVERFLOW RECORD READ           @ZA11014*/ 05296000
*                 /*                                                 */ 05297000
*                 /***************************************************/ 05298000
*                                                                  1136 05299000
*                 IF ECBCC=PCOVFOK  /*                       @ZA11014*/ 05300000
*                                                                  1136 05301000
*                 /***************************************************/ 05302000
*                 /*                                                 */ 05303000
*                 /* THEN SET OVERFLOW REC-DATA OK           @ZA11014*/ 05304000
*                 /*                                                 */ 05305000
*                 /***************************************************/ 05306000
*                                                                  1136 05307000
*                   THEN            /*                       @ZA11014*/ 05308000
         B     @RC01134                                            1136 05309000
@RF01134 L     @03,ECBPTR                                          1136 05310000
         CLC   ECBCC(1,@03),PCOVFOK                                1136 05311000
         BNE   @RF01136                                            1136 05312000
*                   TESTRC=RCABOV;  /*                       @ZA11014   05313000
*                                                            @ZA11014*/ 05314000
         LH    @03,RCABOV                                          1137 05315000
         STH   @03,TESTRC                                          1137 05316000
*                 ELSE              /*                       @ZA11014*/ 05317000
*                                                                  1138 05318000
*                   /*************************************************/ 05319000
*                   /*                                               */ 05320000
*                   /* CHECK IF RECORD NOT FOUND             @ZA11014*/ 05321000
*                   /*                                               */ 05322000
*                   /*************************************************/ 05323000
*                                                                  1138 05324000
*                   IF ECBCC=PCNRF  /*                       @ZA11014*/ 05325000
*                                                                  1138 05326000
*                   /*************************************************/ 05327000
*                   /*                                               */ 05328000
*                   /* THEN SET NO RECORD FOUND RETURN CODE  @ZA11014*/ 05329000
*                   /*                                               */ 05330000
*                   /*************************************************/ 05331000
*                                                                  1138 05332000
*                     THEN          /*                       @ZA11014*/ 05333000
         B     @RC01136                                            1138 05334000
@RF01136 L     @03,ECBPTR                                          1138 05335000
         CLC   ECBCC(1,@03),PCNRF                                  1138 05336000
         BNE   @RF01138                                            1138 05337000
*                     TESTRC=RCABNRF;/*                      @ZA11014   05338000
*                                                            @ZA11014*/ 05339000
         LH    @03,RCABNRF                                         1139 05340000
         STH   @03,TESTRC                                          1139 05341000
*                   ELSE            /*                       @ZA11014*/ 05342000
*                                                                  1140 05343000
*                     /***********************************************/ 05344000
*                     /*                                             */ 05345000
*                     /* CHECK IF SYNC BYTE MISSING          @ZA11014*/ 05346000
*                     /*                                             */ 05347000
*                     /***********************************************/ 05348000
*                                                                  1140 05349000
*                     IF ECBCC=PCSYNCER/*                    @ZA11014*/ 05350000
*                                                                  1140 05351000
*                     /***********************************************/ 05352000
*                     /*                                             */ 05353000
*                     /* THEN SET SYNC BYTE MISSING RETURN CODE      */ 05354000
*                     /*                                     @ZA11014*/ 05355000
*                     /*                                             */ 05356000
*                     /***********************************************/ 05357000
*                                                                  1140 05358000
*                       THEN        /*                       @ZA11014*/ 05359000
         B     @RC01138                                            1140 05360000
@RF01138 L     @03,ECBPTR                                          1140 05361000
         CLC   ECBCC(1,@03),PCSYNCER                               1140 05362000
         BNE   @RF01140                                            1140 05363000
*                       TESTRC=RCABSYNC;/*                   @ZA11014   05364000
*                                                            @ZA11014*/ 05365000
         LH    @03,RCABSYNC                                        1141 05366000
         STH   @03,TESTRC                                          1141 05367000
*                     ELSE          /*                       @ZA11014*/ 05368000
*                                                                  1142 05369000
*                       /*********************************************/ 05370000
*                       /*                                           */ 05371000
*                       /* CHECK IF PERMANENT DATA CHECK     @ZA11014*/ 05372000
*                       /*                                           */ 05373000
*                       /*********************************************/ 05374000
*                                                                  1142 05375000
*                       IF ECBCC=PCDATCHK/*                  @ZA11014*/ 05376000
*                                                                  1142 05377000
*                       /*********************************************/ 05378000
*                       /*                                           */ 05379000
*                       /* THEN SET DATA CHECK RETURN CODE   @ZA11014*/ 05380000
*                       /*                                           */ 05381000
*                       /*********************************************/ 05382000
*                                                                  1142 05383000
*                         THEN      /*                       @ZA11014*/ 05384000
         B     @RC01140                                            1142 05385000
@RF01140 L     @03,ECBPTR                                          1142 05386000
         CLC   ECBCC(1,@03),PCDATCHK                               1142 05387000
         BNE   @RF01142                                            1142 05388000
*                         TESTRC=RCABDTCK;/*                 @ZA11014   05389000
*                                                            @ZA11014*/ 05390000
         LH    @03,RCABDTCK                                        1143 05391000
         STH   @03,TESTRC                                          1143 05392000
*         END;                      /*                       @ZA28050   05393000
*                                                            @ZA11014*/ 05394000
*                                                                  1144 05395000
@RF01142 DS    0H                                                  1144 05396000
@RC01140 DS    0H                                                  1144 05397000
@RC01138 DS    0H                                                  1144 05398000
@RC01136 DS    0H                                                  1144 05399000
@RC01134 DS    0H                                                  1144 05400000
@RC01132 DS    0H                                                  1144 05401000
@RC01130 DS    0H                                                  1145 05402000
*       /*************************************************************/ 05403000
*       /*                                                           */ 05404000
*       /* NOT A REPAIRV REQUEST-OR NOT A REPAIRV            @ZA11014*/ 05405000
*       /* POST CODE                                         @ZA11014*/ 05406000
*       /* IF I/O WAS UNSUCCESSFUL, THE                      @Y30LB35*/ 05407000
*       /* SYNAD PROC IS CALLED TO HANDLE                    @Y30LB35*/ 05408000
*       /* THE ERROR.                                        @Y30LB35*/ 05409000
*       /*                                                           */ 05410000
*       /*************************************************************/ 05411000
*                                                                  1145 05412000
*       IF TESTRC=0 THEN            /*                       @ZA28050*/ 05413000
@RF01128 LH    @03,TESTRC                                          1145 05414000
         LTR   @03,@03                                             1145 05415000
         BNZ   @RF01145                                            1145 05416000
*         DO;                       /*                       @ZA28050*/ 05417000
*           CALL SYNAD;             /*                       @Y30LB35*/ 05418000
         BAL   @14,SYNAD                                           1147 05419000
*           TESTRC=4;               /*                       @Y30LB35*/ 05420000
         MVC   TESTRC(2),@CH00045                                  1148 05421000
*         END;                      /*                       @ZA28050*/ 05422000
*     END;                          /* I/O UNSUCCESSFUL      @ZA11014*/ 05423000
*                                                                  1151 05424000
*   /*****************************************************************/ 05425000
*   /*                                                               */ 05426000
*   /* IF THE I/O WAS SUCCESSFUL, THE SUCCESSFUL             @Y30LB35*/ 05427000
*   /* READS AND WRITES ARE ADDED TO PREVIOUS ONES.          @Y30LB35*/ 05428000
*   /*                                                               */ 05429000
*   /*****************************************************************/ 05430000
*                                                                  1151 05431000
*   ELSE                            /*                       @Y30LB35*/ 05432000
*     DO;                           /*                       @Y30LB35*/ 05433000
*                                                                  1151 05434000
         B     @RC01126                                            1151 05435000
@RF01126 DS    0H                                                  1152 05436000
*       /*************************************************************/ 05437000
*       /*                                                           */ 05438000
*       /* INCREMENT THE READ AND WRITE COUNTERS             @Y30LB35*/ 05439000
*       /*                                                           */ 05440000
*       /*************************************************************/ 05441000
*                                                                  1152 05442000
*       IOXREADS=IOXREADS+READCNTA; /*                       @ZA11014*/ 05443000
         LH    @03,READCNTA                                        1152 05444000
         L     @01,IOCTLBKP                                        1152 05445000
         AL    @03,IOXREADS(,@01)                                  1152 05446000
         L     @01,IOCTLBKP                                        1152 05447000
         ST    @03,IOXREADS(,@01)                                  1152 05448000
*       IOXWRITE=IOXWRITE+WRITECNT; /*                       @Y30LB35*/ 05449000
         LH    @03,WRITECNT                                        1153 05450000
         L     @01,IOCTLBKP                                        1153 05451000
         AL    @03,IOXWRITE(,@01)                                  1153 05452000
         L     @01,IOCTLBKP                                        1153 05453000
         ST    @03,IOXWRITE(,@01)                                  1153 05454000
*     END;                          /*                       @Y30LB35*/ 05455000
*                                                                  1154 05456000
*   /*****************************************************************/ 05457000
*   /*                                                               */ 05458000
*   /* CONTROL IS RETURNED WITH                              @ZA11014*/ 05459000
*   /* A RETURN CODE 0 IF SUCCESSFUL OR 4 IF ERRORS          @Y30LB35*/ 05460000
*   /* FOR NON-REPAIRV REQUESTS                              @ZA11014*/ 05461000
*   /* FOR REPAIRV REQUESTS THE RETURN CODE COULD            @ZA11014*/ 05462000
*   /* INDICATE THE POST CODE FROM THE ABE APPENDAGE@ZA11014         */ 05463000
*   /*                                                               */ 05464000
*   /*****************************************************************/ 05465000
*                                                                  1155 05466000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 05467000
@RC01126 LH    @15,TESTRC                                          1155 05468000
         L     @14,@SA00014                                        1155 05469000
         LM    @00,@12,@SA00014+8                                  1155 05470000
         BR    @14                                                 1155 05471000
*   END ISSUEXCP;                   /*                       @Y30LB35*/ 05472000
*                                                                  1157 05473000
*/********************************************************************/ 05474000
*/*                                                          @Y30LB35*/ 05475000
*/* PROCEDURE NAME - CLOSESTD                                @Y30LB35*/ 05476000
*/*                                                          @Y30LB35*/ 05477000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 05478000
*/*             CLEAN UP AND CLOSE THE DCB BEING PROCESSED.  @Y30LB35*/ 05479000
*/*             THIS IS DONE BY THE FOLLOWING STEPS:         @Y30LB35*/ 05480000
*/*             ISSUES CLOSE MACRO AND ISSUES UPRINT         @Y30LB35*/ 05481000
*/*             IF IOXABEND BIT IS SET.                      @Y30LB35*/ 05482000
*/*                                                          @Y30LB35*/ 05483000
*/*             MSG IDC2374I IS ISSUED IF CLOSE EXIT TAKEN   @Y30LB35*/ 05484000
*/*                                                          @Y30LB35*/ 05485000
*/* INPUT -     IOXTYPE IN IOXCTLBK                          @Y30LB35*/ 05486000
*/*             IOXABEND IN IOXCTLBK                         @Y30LB35*/ 05487000
*/*             CLOSELST                                     @Y30LB35*/ 05488000
*/*                                                          @Y30LB35*/ 05489000
*/* OUTPUT -    DARGSMOD IN DARGLIST                         @Y30LB35*/ 05490000
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/ 05491000
*/*             DARGDBP IN DARGLIST                          @Y30LB35*/ 05492000
*/*             DARGILP IN DARGLIST                          @Y30LB35*/ 05493000
*/*             JFCBPTR                                      @Y30LB35*/ 05494000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 05495000
*/*                           4, ERROR IN CLOSE              @Y30LB35*/ 05496000
*/*                                                          @Y30LB35*/ 05497000
*/********************************************************************/ 05498000
*                                                                  1157 05499000
*                                   /*                       @Y30LB35*/ 05500000
*CLOSESTD:                                                         1157 05501000
*   PROC;                           /*                       @Y30LB35*/ 05502000
CLOSESTD STM   @14,@12,@SA00015                                    1157 05503000
*   RESPECIFY                                                      1158 05504000
*    (REG1,                                                        1158 05505000
*     REG3) RSTD;                   /*                       @Y30LB35*/ 05506000
*                                                                  1158 05507000
*   /*****************************************************************/ 05508000
*   /*                                                               */ 05509000
*   /* SET UP TRACE POINT 'IOCS' IN TRACE TABLE              @Y30LB35*/ 05510000
*   /*                                                               */ 05511000
*   /*****************************************************************/ 05512000
*                                                                  1159 05513000
*   OLDERID2=NEWERID2;                                             1159 05514000
         L     @15,@PC00001                                        1159 05515000
         L     @15,GDTTR2(,@15)                                    1159 05516000
         L     @14,@PC00001                                        1159 05517000
         L     @14,GDTTR2(,@14)                                    1159 05518000
         MVC   @TS00001(95),NEWERID2(@14)                          1159 05519000
         MVC   OLDERID2(95,@15),@TS00001                           1159 05520000
*   NEWID2='IOCS';                  /*                       @Y30LB35*/ 05521000
*                                                                  1160 05522000
         L     @15,@PC00001                                        1160 05523000
         L     @15,GDTTR2(,@15)                                    1160 05524000
         MVC   NEWID2(4,@15),@CC04271                              1160 05525000
*   /*****************************************************************/ 05526000
*   /*                                                               */ 05527000
*   /* THE CLOSE PARMS ARE INITIALIZED                       @Y30LB35*/ 05528000
*   /*                                                               */ 05529000
*   /*****************************************************************/ 05530000
*                                                                  1161 05531000
*   REG1=ADDR(PARMLIST);            /*                       @Y30LB35*/ 05532000
         LA    REG1,PARMLIST                                       1161 05533000
*   PARMLIST=''B;                   /*                       @Y30LB35*/ 05534000
         XC    PARMLIST(20),PARMLIST                               1162 05535000
*   PARMLIST=CLOSELST;              /*                       @Y30LB35*/ 05536000
         MVI   PARMLIST+8,C' '                                     1163 05537000
         MVC   PARMLIST+9(11),PARMLIST+8                           1163 05538000
         MVC   PARMLIST(8),CLOSELST                                1163 05539000
*   REG3=ADDR(IOXDCB);              /*                       @Y30LB35*/ 05540000
         L     REG3,IOCTLBKP                                       1164 05541000
         LA    REG3,IOXDCB(,REG3)                                  1164 05542000
*                                                                  1165 05543000
*   /*****************************************************************/ 05544000
*   /*                                                               */ 05545000
*   /* CLOSE IS ISSUED CLOSING THE DCB                       @Y30LB35*/ 05546000
*   /*                                                               */ 05547000
*   /*****************************************************************/ 05548000
*                                                                  1165 05549000
*LCLOSE1:                                                          1165 05550000
*   GEN(CLOSE ((REG3)),MF=(E,(REG1)));/*                     @Y30LB35*/ 05551000
LCLOSE1  CLOSE ((REG3)),MF=(E,(REG1))                                   05552000
*   RESPECIFY                                                      1166 05553000
*    (REG1,                                                        1166 05554000
*     REG3) UNRSTD;                 /*                       @Y30LB35*/ 05555000
*                                                                  1166 05556000
*   /*****************************************************************/ 05557000
*   /*                                                               */ 05558000
*   /* A TEST IS MADE TO DETERMINE IF CLOSE                  @Y30LB35*/ 05559000
*   /* WAS SUCCESSFUL OR THE CLOSE ABEND EXIT                @Y30LB35*/ 05560000
*   /* WAS ENTERED.                                          @Y30LB35*/ 05561000
*   /*                                                               */ 05562000
*   /*****************************************************************/ 05563000
*                                                                  1167 05564000
*   IF IOXABEND=ON                  /*                       @Y30LB35*/ 05565000
*     THEN                          /*                       @Y30LB35*/ 05566000
         L     @03,IOCTLBKP                                        1167 05567000
         TM    IOXABEND(@03),B'01000000'                           1167 05568000
         BNO   @RF01167                                            1167 05569000
*     DO;                           /*                       @Y30LB35*/ 05570000
*                                                                  1168 05571000
*       /*************************************************************/ 05572000
*       /*                                                           */ 05573000
*       /* INITIALIZE THE DARGLIST                           @Y30LB35*/ 05574000
*       /*                                                           */ 05575000
*       /*************************************************************/ 05576000
*                                                                  1169 05577000
*       DARGLIST=''B;               /*                       @Y30LB35*/ 05578000
         L     @03,DDSTRU                                          1169 05579000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1169 05580000
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/ 05581000
         L     @03,DDSTRU                                          1170 05582000
         MVC   DARGSMOD(3,@03),@CC03785                            1170 05583000
*       DARGSENT=MSG2374I;          /*                       @Y30LB35*/ 05584000
         L     @03,DDSTRU                                          1171 05585000
         MVI   DARGSENT(@03),X'07'                                 1171 05586000
*                                                                  1172 05587000
*       /*************************************************************/ 05588000
*       /*                                                           */ 05589000
*       /* DETERMINE WHETHER THE DSN NAME                    @Y30LB35*/ 05590000
*       /* SHOULD BE USED AS THE INSERT                      @Y30LB35*/ 05591000
*       /* OR THE NAME "VTOC"                                @Y30LB35*/ 05592000
*       /*                                                           */ 05593000
*       /*************************************************************/ 05594000
*                                                                  1172 05595000
*       IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/* @Y30LB35*/ 05596000
         L     @03,IOCTLBKP                                        1172 05597000
         CLC   IOXTYPE(1,@03),LAB                                  1172 05598000
         BE    @RF01172                                            1172 05599000
         L     @03,IOCTLBKP                                        1172 05600000
         CLC   IOXTYPE(1,@03),NEWVOL                               1172 05601000
         BE    @RF01172                                            1172 05602000
         L     @03,IOCTLBKP                                        1172 05603000
         CLC   IOXTYPE(1,@03),VTOC                                 1172 05604000
         BE    @RF01172                                            1172 05605000
*         DO;                       /*                       @Y30LB35*/ 05606000
*                                                                  1173 05607000
*           /*********************************************************/ 05608000
*           /*                                                       */ 05609000
*           /* INITIALIZE THE DSN INSERT PTRS                @Y30LB35*/ 05610000
*           /*                                                       */ 05611000
*           /*********************************************************/ 05612000
*                                                                  1174 05613000
*           JFCBPTR=ADDR(IOXJFCB);  /*                       @Y30LB35*/ 05614000
         L     @03,IOCTLBKP                                        1174 05615000
         LA    @03,IOXJFCB(,@03)                                   1174 05616000
         ST    @03,JFCBPTR                                         1174 05617000
*           DARGDBP=ADDR(JFCBDSNM); /*                       @Y30LB35*/ 05618000
         L     @03,JFCBPTR                                         1175 05619000
         L     @01,DDSTRU                                          1175 05620000
         ST    @03,DARGDBP(,@01)                                   1175 05621000
*           DARGILP=LENGTH(JFCBDSNM);/*                      @Y30LB35*/ 05622000
         L     @03,DDSTRU                                          1176 05623000
         MVC   DARGILP(2,@03),@CH00849                             1176 05624000
*         END;                      /*                       @Y30LB35*/ 05625000
*       ELSE                        /*                       @Y30LB35*/ 05626000
*         DO;                       /*                       @Y30LB35*/ 05627000
*                                                                  1178 05628000
         B     @RC01172                                            1178 05629000
@RF01172 DS    0H                                                  1179 05630000
*           /*********************************************************/ 05631000
*           /*                                                       */ 05632000
*           /* INITIALIZE THE "VTOC" INSERT PTRS             @Y30LB35*/ 05633000
*           /*                                                       */ 05634000
*           /*********************************************************/ 05635000
*                                                                  1179 05636000
*           DARGDBP=ADDR(VTOCINST); /*                       @Y30LB35*/ 05637000
         LA    @03,VTOCINST                                        1179 05638000
         L     @01,DDSTRU                                          1179 05639000
         ST    @03,DARGDBP(,@01)                                   1179 05640000
*           DARGILP=LENGTH(VTOCINST);/*                      @Y30LB35*/ 05641000
         L     @03,DDSTRU                                          1180 05642000
         MVC   DARGILP(2,@03),@CH00045                             1180 05643000
*         END;                      /*                       @Y30LB35*/ 05644000
*                                                                  1181 05645000
*       /*************************************************************/ 05646000
*       /*                                                           */ 05647000
*       /* ISSUE UPRINT TO SEND MESSAGE TO SYSPRINT          @Y30LB35*/ 05648000
*       /*                                                           */ 05649000
*       /*************************************************************/ 05650000
*                                                                  1182 05651000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/ 05652000
*                                                                  1182 05653000
@RC01172 L     @03,@PC00001                                        1182 05654000
         ST    @03,@AL00001                                        1182 05655000
         LA    @03,@CF00119                                        1182 05656000
         ST    @03,@AL00001+4                                      1182 05657000
         LA    @03,DDSTRU                                          1182 05658000
         ST    @03,@AL00001+8                                      1182 05659000
         MVI   @AL00001+8,X'80'                                    1182 05660000
         L     @03,@PC00001                                        1182 05661000
         L     @15,GDTPRT(,@03)                                    1182 05662000
         LA    @01,@AL00001                                        1182 05663000
         BALR  @14,@15                                             1182 05664000
*       /*************************************************************/ 05665000
*       /*                                                           */ 05666000
*       /* SET UP ERROR CODE RCFAIL(4)                       @Y30LB35*/ 05667000
*       /*                                                           */ 05668000
*       /*************************************************************/ 05669000
*                                                                  1183 05670000
*       TESTRC=4;                   /*                       @Y30LB35*/ 05671000
         MVC   TESTRC(2),@CH00045                                  1183 05672000
*     END;                          /*                       @Y30LB35*/ 05673000
*                                                                  1184 05674000
*   /*****************************************************************/ 05675000
*   /*                                                               */ 05676000
*   /* CONTROL IS RETURNED TO CLOSEPRC WITH RETURN           @Y30LB35*/ 05677000
*   /* CODE IN REG 15 OF 0 SUCCESSFUL OR 4 ERROR.            @Y30LB35*/ 05678000
*   /*                                                               */ 05679000
*   /*****************************************************************/ 05680000
*                                                                  1185 05681000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 05682000
@RF01167 LH    @15,TESTRC                                          1185 05683000
         L     @14,@SA00015                                        1185 05684000
         LM    @00,@12,@SA00015+8                                  1185 05685000
         BR    @14                                                 1185 05686000
*   END CLOSESTD;                   /*                       @Y30LB35*/ 05687000
*                                                                  1187 05688000
*/********************************************************************/ 05689000
*/*                                                          @Y30LB35*/ 05690000
*/* PROCEDURE NAME - CLOSENEW                                @Y30LB35*/ 05691000
*/*                                                          @Y30LB35*/ 05692000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 05693000
*/*             CLEAN UP AND CLOSE THE DCB BEING PROCESSED.  @Y30LB35*/ 05694000
*/*             THE DIFFERENCE BETWEEN THIS ROUTINE AND      @Y30LB35*/ 05695000
*/*             CLOSESTD IS THAT A PSEUDO OPEN WAS PERFORMED @Y30LB35*/ 05696000
*/*             BY SVC 82 INITIALLY.                         @Y30LB35*/ 05697000
*/*             THIS IS DONE BY ISSUING SVC 82 (DASDR SVC)   @Y30LB35*/ 05698000
*/*                                                          @Y30LB35*/ 05699000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 05700000
*/*                                                          @Y30LB35*/ 05701000
*/* INPUT -     IOXUCBP IN IOXCTLBK                          @Y30LB35*/ 05702000
*/*             DCBDEBAD IN IOXDCB                           @Y30LB35*/ 05703000
*/*             SVC82CLS                                     @Y30LB35*/ 05704000
*/*                                                          @Y30LB35*/ 05705000
*/* OUTPUT -    SV82CODE IN SV82LIST                         @Y30LB35*/ 05706000
*/*             SV82UCBP IN SV82LIST                         @Y30LB35*/ 05707000
*/*             SV82DEBP IN SV82LIST                         @Y30LB35*/ 05708000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 05709000
*/*                                                          @Y30LB35*/ 05710000
*/********************************************************************/ 05711000
*                                                                  1187 05712000
*                                   /*                       @Y30LB35*/ 05713000
*CLOSENEW:                                                         1187 05714000
*   PROC;                           /*                       @Y30LB35*/ 05715000
*                                                                  1187 05716000
CLOSENEW STM   @14,@12,12(@13)                                     1187 05717000
*   /*****************************************************************/ 05718000
*   /*                                                               */ 05719000
*   /* SET UP TRACE POINT 'IOON' IN TRACE TABLE              @Y30LB35*/ 05720000
*   /*                                                               */ 05721000
*   /*****************************************************************/ 05722000
*                                                                  1188 05723000
*   OLDERID2=NEWERID2;                                             1188 05724000
         L     @03,@PC00001                                        1188 05725000
         L     @03,GDTTR2(,@03)                                    1188 05726000
         L     @15,@PC00001                                        1188 05727000
         L     @01,GDTTR2(,@15)                                    1188 05728000
         MVC   @TS00001(95),NEWERID2(@01)                          1188 05729000
         MVC   OLDERID2(95,@03),@TS00001                           1188 05730000
*   NEWID2='IOON';                  /*                       @Y30LB35*/ 05731000
*                                                                  1189 05732000
         L     @03,@PC00001                                        1189 05733000
         L     @03,GDTTR2(,@03)                                    1189 05734000
         MVC   NEWID2(4,@03),@CC04211                              1189 05735000
*   /*****************************************************************/ 05736000
*   /*                                                               */ 05737000
*   /* INITIALIZE SVC 82 ARGUMENT LIST FOR                   @Y30LB35*/ 05738000
*   /* PSEUDO CLOSE                                          @Y30LB35*/ 05739000
*   /*                                                               */ 05740000
*   /*****************************************************************/ 05741000
*                                                                  1190 05742000
*   SV82LIST=''B;                   /*                       @Y30LB35*/ 05743000
         LA    @03,SVC82ARG                                        1190 05744000
         XC    SV82LIST(16,@03),SV82LIST(@03)                      1190 05745000
*   SV82CODE=SVC82CLS;              /*                       @Y30LB35*/ 05746000
         LA    @03,SVC82ARG                                        1191 05747000
         MVC   SV82CODE(1,@03),SVC82CLS                            1191 05748000
*   SV82UCBP=IOXUCBP;               /*                       @Y30LB35*/ 05749000
         LA    @03,SVC82ARG                                        1192 05750000
         L     @01,IOCTLBKP                                        1192 05751000
         MVC   SV82UCBP(3,@03),IOXUCBP+1(@01)                      1192 05752000
*   SV82DEBP=DCBDEBAD;              /*                       @Y30LB35*/ 05753000
         LA    @03,SVC82ARG                                        1193 05754000
         L     @01,DCBPTR                                          1193 05755000
         L     @15,DCBDEBAD+40(,@01)                               1193 05756000
         ST    @15,SV82DEBP(,@03)                                  1193 05757000
*   RESPECIFY                                                      1194 05758000
*     REG1 RESTRICTED;              /*                       @Y30LB35*/ 05759000
*   REG1=ADDR(SV82LIST);            /*                       @Y30LB35*/ 05760000
         LA    REG1,SVC82ARG                                       1195 05761000
*                                                                  1196 05762000
*   /*****************************************************************/ 05763000
*   /*                                                               */ 05764000
*   /* ISSUE SVC 82 TO CLOSE DCB                             @Y30LB35*/ 05765000
*   /*                                                               */ 05766000
*   /*****************************************************************/ 05767000
*                                                                  1196 05768000
*L82SVC2:                           /*                       @Y30LB35*/ 05769000
*   SVC(82);                        /*                       @Y30LB35*/ 05770000
L82SVC2  SVC   82                                                  1196 05771000
*   RESPECIFY                                                      1197 05772000
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/ 05773000
*                                                                  1197 05774000
*   /*****************************************************************/ 05775000
*   /*                                                               */ 05776000
*   /* CONTROL IS RETURNED TO CLOSEPRC WITH                  @Y30LB35*/ 05777000
*   /* RETURN CODE IN REGISTER 15 0.                         @Y30LB35*/ 05778000
*   /*                                                               */ 05779000
*   /*****************************************************************/ 05780000
*                                                                  1198 05781000
*   RETURN CODE(0);                 /*                       @Y30LB35*/ 05782000
         SLR   @15,@15                                             1198 05783000
         L     @14,12(,@13)                                        1198 05784000
         LM    @00,@12,20(@13)                                     1198 05785000
         BR    @14                                                 1198 05786000
*   END CLOSENEW;                   /*                       @Y30LB35*/ 05787000
*                                                                  1200 05788000
*/********************************************************************/ 05789000
*/*                                                          @Y30LB35*/ 05790000
*/* PROCEDURE NAME - CHECKOPN                                @Y30LB35*/ 05791000
*/*                                                          @Y30LB35*/ 05792000
*/* FUNCTION -  TESTS TO SEE IF OPEN ABEND EXIT              @Y30LB35*/ 05793000
*/*             WAS NOT ENTERED OR DCBOFLAGS INDICATES DCB   @Y30LB35*/ 05794000
*/*             NOT OPENED AND ISSUES UPRINT MACRO.          @Y30LB35*/ 05795000
*/*                                                          @Y30LB35*/ 05796000
*/*             MSG IDC3300I IS ISSUED IF OPEN FAILED        @Y30LB35*/ 05797000
*/*             MSG IDC2372I IS ISSUED IF OPEN ABEND TAKEN   @Y30LB35*/ 05798000
*/*                                                          @Y30LB35*/ 05799000
*/* INPUT -     IOXABEND IN IOXCTLBK                         @Y30LB35*/ 05800000
*/*             DCBOFOPN IN IOXDCB                           @Y30LB35*/ 05801000
*/*             IOXTYPE IN IOXCTLBK                          @Y30LB35*/ 05802000
*/*                                                          @Y30LB35*/ 05803000
*/* OUTPUT -    DARGSMOD IN DARGLIST                         @Y30LB35*/ 05804000
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/ 05805000
*/*             DARGDBP IN DARGLIST                          @Y30LB35*/ 05806000
*/*             DARGILP IN DARGLIST                          @Y30LB35*/ 05807000
*/*             USERIOBP IN CALLER'S CORE                    @Y30LB35*/ 05808000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 05809000
*/*                           4, ERROR DCB NOT OPENED        @Y30LB35*/ 05810000
*/*                                                          @Y30LB35*/ 05811000
*/********************************************************************/ 05812000
*                                                                  1200 05813000
*                                   /*                       @Y30LB35*/ 05814000
*CHECKOPN:                                                         1200 05815000
*   PROC;                           /*                       @Y30LB35*/ 05816000
*                                                                  1200 05817000
CHECKOPN STM   @14,@12,@SA00017                                    1200 05818000
*   /*****************************************************************/ 05819000
*   /*                                                               */ 05820000
*   /* SET UP TRACE POINT 'IOCK' IN TRACE TABLE              @Y30LB35*/ 05821000
*   /*                                                               */ 05822000
*   /*****************************************************************/ 05823000
*                                                                  1201 05824000
*   OLDERID2=NEWERID2;                                             1201 05825000
         L     @03,@PC00001                                        1201 05826000
         L     @03,GDTTR2(,@03)                                    1201 05827000
         L     @15,@PC00001                                        1201 05828000
         L     @01,GDTTR2(,@15)                                    1201 05829000
         MVC   @TS00001(95),NEWERID2(@01)                          1201 05830000
         MVC   OLDERID2(95,@03),@TS00001                           1201 05831000
*   NEWID2='IOCK';                  /*                       @Y30LB35*/ 05832000
*                                                                  1202 05833000
         L     @03,@PC00001                                        1202 05834000
         L     @03,GDTTR2(,@03)                                    1202 05835000
         MVC   NEWID2(4,@03),@CC04282                              1202 05836000
*   /*****************************************************************/ 05837000
*   /*                                                               */ 05838000
*   /* TEST TO SEE IF OPEN ABEND EXIT WAS ENTERED            @Y30LB35*/ 05839000
*   /*                                                               */ 05840000
*   /*****************************************************************/ 05841000
*                                                                  1203 05842000
*   IF IOXABEND=ON                  /*                       @Y30LB35*/ 05843000
*     THEN                          /*                       @Y30LB35*/ 05844000
         L     @03,IOCTLBKP                                        1203 05845000
         TM    IOXABEND(@03),B'01000000'                           1203 05846000
         BNO   @RF01203                                            1203 05847000
*     DO;                           /*                       @Y30LB35*/ 05848000
*                                                                  1204 05849000
*       /*************************************************************/ 05850000
*       /*                                                           */ 05851000
*       /* INITIALIZE DARGLIST TO ISSUE                      @Y30LB35*/ 05852000
*       /* "IDC2372I OPEN ABEND EXIT (DSN/VTOC)"             @Y30LB35*/ 05853000
*       /*                                                           */ 05854000
*       /*************************************************************/ 05855000
*                                                                  1205 05856000
*       DARGLIST=''B;               /*                       @Y30LB35*/ 05857000
         L     @03,DDSTRU                                          1205 05858000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1205 05859000
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/ 05860000
         L     @03,DDSTRU                                          1206 05861000
         MVC   DARGSMOD(3,@03),@CC03785                            1206 05862000
*       DARGSENT=MSG2372I;          /*                       @Y30LB35*/ 05863000
*                                                                  1207 05864000
         L     @03,DDSTRU                                          1207 05865000
         MVI   DARGSENT(@03),X'03'                                 1207 05866000
*       /*************************************************************/ 05867000
*       /*                                                           */ 05868000
*       /* TEST TO SEE IF INSERT "VTOC" SHOULD BE USED       @Y30LB35*/ 05869000
*       /*                                                           */ 05870000
*       /*************************************************************/ 05871000
*                                                                  1208 05872000
*       IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/* @Y30LB35*/ 05873000
*                                                                  1208 05874000
         L     @03,IOCTLBKP                                        1208 05875000
         CLC   IOXTYPE(1,@03),LAB                                  1208 05876000
         BE    @RF01208                                            1208 05877000
         L     @03,IOCTLBKP                                        1208 05878000
         CLC   IOXTYPE(1,@03),NEWVOL                               1208 05879000
         BE    @RF01208                                            1208 05880000
         L     @03,IOCTLBKP                                        1208 05881000
         CLC   IOXTYPE(1,@03),VTOC                                 1208 05882000
         BE    @RF01208                                            1208 05883000
*         /***********************************************************/ 05884000
*         /*                                                         */ 05885000
*         /* THE DSN SHOULD BE USED AND IS INITIALIZED       @Y30LB35*/ 05886000
*         /*                                                         */ 05887000
*         /***********************************************************/ 05888000
*                                                                  1209 05889000
*         DO;                       /*                       @Y30LB35*/ 05890000
*           DARGDBP=ADDR(JFCBDSNM); /*                       @Y30LB35*/ 05891000
         L     @03,JFCBPTR                                         1210 05892000
         L     @01,DDSTRU                                          1210 05893000
         ST    @03,DARGDBP(,@01)                                   1210 05894000
*           DARGILP=LENGTH(JFCBDSNM);/*                      @Y30LB35*/ 05895000
         L     @03,DDSTRU                                          1211 05896000
         MVC   DARGILP(2,@03),@CH00849                             1211 05897000
*         END;                      /*                       @Y30LB35*/ 05898000
*                                                                  1212 05899000
*       /*************************************************************/ 05900000
*       /*                                                           */ 05901000
*       /* IF NOT THE "VTOC" IS INITIALIZED INSTEAD          @Y30LB35*/ 05902000
*       /*                                                           */ 05903000
*       /*************************************************************/ 05904000
*                                                                  1213 05905000
*       ELSE                        /*                       @Y30LB35*/ 05906000
*         DO;                       /*                       @Y30LB35*/ 05907000
         B     @RC01208                                            1213 05908000
@RF01208 DS    0H                                                  1214 05909000
*           DARGDBP=ADDR(VTOCINST); /*                       @Y30LB35*/ 05910000
         LA    @03,VTOCINST                                        1214 05911000
         L     @01,DDSTRU                                          1214 05912000
         ST    @03,DARGDBP(,@01)                                   1214 05913000
*           DARGILP=LENGTH(VTOCINST);/*                      @Y30LB35*/ 05914000
         L     @03,DDSTRU                                          1215 05915000
         MVC   DARGILP(2,@03),@CH00045                             1215 05916000
*         END;                      /*                       @Y30LB35*/ 05917000
*                                                                  1216 05918000
*       /*************************************************************/ 05919000
*       /*                                                           */ 05920000
*       /* CALL UPRINT TO ISSUE THE ERROR MESSAGE            @Y30LB35*/ 05921000
*       /*                                                           */ 05922000
*       /*************************************************************/ 05923000
*                                                                  1217 05924000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/ 05925000
*                                                                  1217 05926000
@RC01208 L     @03,@PC00001                                        1217 05927000
         ST    @03,@AL00001                                        1217 05928000
         LA    @03,@CF00119                                        1217 05929000
         ST    @03,@AL00001+4                                      1217 05930000
         LA    @03,DDSTRU                                          1217 05931000
         ST    @03,@AL00001+8                                      1217 05932000
         MVI   @AL00001+8,X'80'                                    1217 05933000
         L     @03,@PC00001                                        1217 05934000
         L     @15,GDTPRT(,@03)                                    1217 05935000
         LA    @01,@AL00001                                        1217 05936000
         BALR  @14,@15                                             1217 05937000
*       /*************************************************************/ 05938000
*       /*                                                           */ 05939000
*       /* SET THE ERROR CODE TO RCFAIL(4)                   @Y30LB35*/ 05940000
*       /*                                                           */ 05941000
*       /*************************************************************/ 05942000
*                                                                  1218 05943000
*       TESTRC=4;                   /*                       @Y30LB35*/ 05944000
         MVC   TESTRC(2),@CH00045                                  1218 05945000
*     END;                          /*                       @Y30LB35*/ 05946000
*                                                                  1220 05947000
*   /*****************************************************************/ 05948000
*   /*                                                               */ 05949000
*   /* TEST TO SEE IF THE DCBOFLAG X'10' IS SET              @Y30LB35*/ 05950000
*   /* INDICATING THE DATA SET WAS OPENED OR NOT.            @Y30LB35*/ 05951000
*   /*                                                               */ 05952000
*   /*****************************************************************/ 05953000
*                                                                  1220 05954000
*   IF IOXABEND^=ON&DCBOFOPN^=ON    /*                       @Y30LB35*/ 05955000
*     THEN                          /*                       @Y30LB35*/ 05956000
*                                                                  1220 05957000
@RF01203 L     @03,IOCTLBKP                                        1220 05958000
         TM    IOXABEND(@03),B'01000000'                           1220 05959000
         BO    @RF01220                                            1220 05960000
         L     @03,DCBPTR                                          1220 05961000
         TM    DCBOFOPN+40(@03),B'00010000'                        1220 05962000
         BO    @RF01220                                            1220 05963000
*     /***************************************************************/ 05964000
*     /*                                                             */ 05965000
*     /* IF THE DCBOFLAG IN DCBOFLAGS IS NOT                 @Y30LB35*/ 05966000
*     /* SET PREPARE THE DARGLIST TO ISSUE                   @Y30LB35*/ 05967000
*     /* "IDC3300I UNABLE TO OPEN (DSN/VTOC)"                @Y30LB35*/ 05968000
*     /*                                                             */ 05969000
*     /***************************************************************/ 05970000
*                                                                  1221 05971000
*     DO;                           /*                       @Y30LB35*/ 05972000
*       DARGLIST=''B;               /*                       @Y30LB35*/ 05973000
         L     @03,DDSTRU                                          1222 05974000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1222 05975000
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/ 05976000
         L     @03,DDSTRU                                          1223 05977000
         MVC   DARGSMOD(3,@03),@CC03785                            1223 05978000
*       DARGSENT=MSG3300I;          /*                       @Y30LB35*/ 05979000
*                                                                  1224 05980000
         L     @03,DDSTRU                                          1224 05981000
         MVI   DARGSENT(@03),X'04'                                 1224 05982000
*       /*************************************************************/ 05983000
*       /*                                                           */ 05984000
*       /* TEST WHICH INSERT IS IN ORDER                     @Y30LB35*/ 05985000
*       /*                                                           */ 05986000
*       /*************************************************************/ 05987000
*                                                                  1225 05988000
*       IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/* @Y30LB35*/ 05989000
*                                                                  1225 05990000
         L     @03,IOCTLBKP                                        1225 05991000
         CLC   IOXTYPE(1,@03),LAB                                  1225 05992000
         BE    @RF01225                                            1225 05993000
         L     @03,IOCTLBKP                                        1225 05994000
         CLC   IOXTYPE(1,@03),NEWVOL                               1225 05995000
         BE    @RF01225                                            1225 05996000
         L     @03,IOCTLBKP                                        1225 05997000
         CLC   IOXTYPE(1,@03),VTOC                                 1225 05998000
         BE    @RF01225                                            1225 05999000
*         /***********************************************************/ 06000000
*         /*                                                         */ 06001000
*         /* IF USER IS WORKING ON DATASET PREPARE           @Y30LB35*/ 06002000
*         /* THE DSN INSERT.                                 @Y30LB35*/ 06003000
*         /*                                                         */ 06004000
*         /***********************************************************/ 06005000
*                                                                  1226 06006000
*         DO;                       /*                       @Y30LB35*/ 06007000
*           DARGDBP=ADDR(JFCBDSNM); /*                       @Y30LB35*/ 06008000
         L     @03,JFCBPTR                                         1227 06009000
         L     @01,DDSTRU                                          1227 06010000
         ST    @03,DARGDBP(,@01)                                   1227 06011000
*           DARGILP=LENGTH(JFCBDSNM);/*                      @Y30LB35*/ 06012000
         L     @03,DDSTRU                                          1228 06013000
         MVC   DARGILP(2,@03),@CH00849                             1228 06014000
*         END;                      /*                       @Y30LB35*/ 06015000
*                                                                  1230 06016000
*       /*************************************************************/ 06017000
*       /*                                                           */ 06018000
*       /* IF USER IS WORKING ON VTOC PREPARE                @Y30LB35*/ 06019000
*       /* "VTOC" INSERT.                                    @Y30LB35*/ 06020000
*       /*                                                           */ 06021000
*       /*************************************************************/ 06022000
*                                                                  1230 06023000
*       ELSE                        /*                       @Y30LB35*/ 06024000
*         DO;                       /*                       @Y30LB35*/ 06025000
         B     @RC01225                                            1230 06026000
@RF01225 DS    0H                                                  1231 06027000
*           DARGDBP=ADDR(VTOCINST); /*                       @Y30LB35*/ 06028000
         LA    @03,VTOCINST                                        1231 06029000
         L     @01,DDSTRU                                          1231 06030000
         ST    @03,DARGDBP(,@01)                                   1231 06031000
*           DARGILP=LENGTH(VTOCINST);/*                      @Y30LB35*/ 06032000
         L     @03,DDSTRU                                          1232 06033000
         MVC   DARGILP(2,@03),@CH00045                             1232 06034000
*         END;                      /*                       @Y30LB35*/ 06035000
*                                                                  1233 06036000
*       /*************************************************************/ 06037000
*       /*                                                           */ 06038000
*       /* ISSUE UPRINT TO SEND ERROR MESSAGE                @Y30LB35*/ 06039000
*       /* TO THE SYSPRINT                                   @Y30LB35*/ 06040000
*       /*                                                           */ 06041000
*       /*************************************************************/ 06042000
*                                                                  1234 06043000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/ 06044000
*                                                                  1234 06045000
@RC01225 L     @03,@PC00001                                        1234 06046000
         ST    @03,@AL00001                                        1234 06047000
         LA    @03,@CF00119                                        1234 06048000
         ST    @03,@AL00001+4                                      1234 06049000
         LA    @03,DDSTRU                                          1234 06050000
         ST    @03,@AL00001+8                                      1234 06051000
         MVI   @AL00001+8,X'80'                                    1234 06052000
         L     @03,@PC00001                                        1234 06053000
         L     @15,GDTPRT(,@03)                                    1234 06054000
         LA    @01,@AL00001                                        1234 06055000
         BALR  @14,@15                                             1234 06056000
*       /*************************************************************/ 06057000
*       /*                                                           */ 06058000
*       /* SET THE ERROR CODE RCFAIL(4)                      @Y30LB35*/ 06059000
*       /*                                                           */ 06060000
*       /*************************************************************/ 06061000
*                                                                  1235 06062000
*       TESTRC=4;                   /*                       @Y30LB35*/ 06063000
         MVC   TESTRC(2),@CH00045                                  1235 06064000
*     END;                          /*                       @Y30LB35*/ 06065000
*                                                                  1236 06066000
*   /*****************************************************************/ 06067000
*   /*                                                               */ 06068000
*   /* CONTROL IS RETURNED TO CALLING PROC                   @Y30LB35*/ 06069000
*   /* WITH A RETURN CODE 0 OR 4 IN REGISTER 15              @Y30LB35*/ 06070000
*   /*                                                               */ 06071000
*   /*****************************************************************/ 06072000
*                                                                  1237 06073000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 06074000
@RF01220 LH    @15,TESTRC                                          1237 06075000
         L     @14,@SA00017                                        1237 06076000
         LM    @00,@12,@SA00017+8                                  1237 06077000
         BR    @14                                                 1237 06078000
*   END CHECKOPN;                   /*                       @Y30LB35*/ 06079000
*                                                                  1239 06080000
*/********************************************************************/ 06081000
*/*                                                          @Y30LB35*/ 06082000
*/* PROCEDURE NAME - RETRY                                   @Y30LB35*/ 06083000
*/*                                                          @Y30LB35*/ 06084000
*/* FUNCTION -  RETRY FROM A RACF OR PASSWORD ABEND          @G24LB31*/ 06085000
*/*             FROM THE SYSTEM                              @G24LB31*/ 06086000
*/*             OR VTOC OPEN ABEND ISSUE UPRINT, AND RETURN  @Z40LB35*/ 06087000
*/*             TO THE INSTRUCTION AFTER THE OPEN MACRO.     @Z40LB35*/ 06088000
*/*                                                          @Y30LB35*/ 06089000
*/*             MESSAGE IDC2373I IS ISSUED FOR BAD PASSWORD  @G24LB31*/ 06090000
*/*             MSG IDC2917I IS ISSUED FOR NO RACF PROFILE   @G24LB31*/ 06091000
*/*             MSG IDC2918I IS ISSUED FOR BAD RACF CHECK    @G24LB31*/ 06092000
*/*                                                          @Y30LB35*/ 06093000
*/* INPUT -     STAEWORK FROM SYSTEM                         @Y30LB35*/ 06094000
*/*             SAHSTA FROM HISTORIAL DATA AREA              @Y30LB35*/ 06095000
*/*             IOXJFCB IN IOXCTLBK                          @Y30LB35*/ 06096000
*/*             STAEPARM                                     @Y30LB35*/ 06097000
*/*             STARTSAV                                     @Y30LB35*/ 06098000
*/*                                                          @Y30LB35*/ 06099000
*/* OUTPUT -    DARGSMOD IN DARGLIST                         @Y30LB35*/ 06100000
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/ 06101000
*/*             DARGILP  IN DARGLIST                         @Y30LB35*/ 06102000
*/*             DARGDBP  IN DARGLIST                         @Y30LB35*/ 06103000
*/*             REGISTERS 0 THRU 14                          @Y30LB35*/ 06104000
*/*             JFCBPTR                                      @Y30LB35*/ 06105000
*/*             REGISTER 15 = 4, PASSWORD ABEND              @Y30LB35*/ 06106000
*/*                                                          @Y30LB35*/ 06107000
*/********************************************************************/ 06108000
*                                                                  1239 06109000
*RETRY:                                                            1239 06110000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB35*/ 06111000
*                                                                  1239 06112000
RETRY    DS    0H                                                  1240 06113000
*   /*****************************************************************/ 06114000
*   /*                                                               */ 06115000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 06116000
*   /*                                                               */ 06117000
*   /*****************************************************************/ 06118000
*                                                                  1240 06119000
*   DCL                                                            1240 06120000
*     SDWAPTR REGISTER(4) RSTD;     /*                       @Y30LB35   06121000
*                                      POINTER TO SDWA       @Y30LB35*/ 06122000
*                                                                  1241 06123000
*   /*****************************************************************/ 06124000
*   /*                                                               */ 06125000
*   /* RESTRICT REGISTERS AND SET UP                         @Y30LB35*/ 06126000
*   /* ADDRESSABILITY TO STAEPARM.                           @Y30LB35*/ 06127000
*   /*                                                               */ 06128000
*   /*****************************************************************/ 06129000
*                                                                  1241 06130000
*   RESPECIFY                                                      1241 06131000
*     STAEPARM BASED(SDWAPARM);     /*                       @Y30LB35*/ 06132000
*   RESPECIFY                                                      1242 06133000
*    (REG3,                                                        1242 06134000
*     REG1,                                                        1242 06135000
*     REG0) RSTD;                   /*                       @Y30LB35*/ 06136000
*                                                                  1242 06137000
*   /*****************************************************************/ 06138000
*   /*                                                               */ 06139000
*   /* ADDRESSABILITY TO SDWA                                @Y30LB35*/ 06140000
*   /*                                                               */ 06141000
*   /*****************************************************************/ 06142000
*                                                                  1243 06143000
*   SDWAPTR=REG1;                   /*                       @Y30LB35*/ 06144000
*                                                                  1243 06145000
         LR    SDWAPTR,REG1                                        1243 06146000
*   /*****************************************************************/ 06147000
*   /*                                                               */ 06148000
*   /* PICK UP SAVE AREA ADDRESS AND RESTORE                 @Y30LB35*/ 06149000
*   /* REGISTERS TO THE CONTENTS BEFORE THE                  @Y30LB35*/ 06150000
*   /* USTAE WAS ISSUED IN THE OPNPASS PROC.                 @Y30LB35*/ 06151000
*   /*                                                               */ 06152000
*   /*****************************************************************/ 06153000
*                                                                  1244 06154000
*   REG3=STARTSAV;                  /*                       @Y30LB35*/ 06155000
         L     @05,SDWAPARM(,SDWAPTR)                              1244 06156000
         L     REG3,STARTSAV(,@05)                                 1244 06157000
*   GEN(LM  REG5,REG15,20(REG3));   /*                       @Y30LB35*/ 06158000
         LM  REG5,REG15,20(REG3)                                        06159000
*   GEN(L   REG2,8(REG3));          /*                       @Y30LB35*/ 06160000
*                                                                  1246 06161000
         L   REG2,8(REG3)                                               06162000
*   /*****************************************************************/ 06163000
*   /*                                                               */ 06164000
*   /* NOW THAT THE REGISTERS HAVE BEEN RESTORED             @Y30LB35*/ 06165000
*   /* THE ADDRESSABILITY TO STAEPARM CAN BE                 @Y30LB35*/ 06166000
*   /* REESTABLISHED.                                        @Y30LB35*/ 06167000
*   /*                                                               */ 06168000
*   /*****************************************************************/ 06169000
*                                                                  1247 06170000
*   RESPECIFY                                                      1247 06171000
*     STAEPARM BASED(SAHSTA);       /*                       @Y30LB35*/ 06172000
*                                                                  1247 06173000
*   /*****************************************************************/ 06174000
*   /*                                                               */ 06175000
*   /* SET UP TRACE POINT 'IORT' IN TRACE TABLE              @Y30LB35*/ 06176000
*   /* THIS WOULD ORDINARILY BE THE FIRST                    @Y30LB35*/ 06177000
*   /* INSTRUCTION IN THE PROCEDURE, HOWEVER,                @Y30LB35*/ 06178000
*   /* THE ADDRESS OF SDWA MUST BE MOVED FROM                @Y30LB35*/ 06179000
*   /* REGISTER 1 BEFORE PLS USES REG1.                      @Y30LB35*/ 06180000
*   /*                                                               */ 06181000
*   /*****************************************************************/ 06182000
*                                                                  1248 06183000
*   OLDERID2=NEWERID2;                                             1248 06184000
         L     @05,@PC00001                                        1248 06185000
         L     @05,GDTTR2(,@05)                                    1248 06186000
         L     @15,@PC00001                                        1248 06187000
         L     @15,GDTTR2(,@15)                                    1248 06188000
         MVC   @TS00001(95),NEWERID2(@15)                          1248 06189000
         MVC   OLDERID2(95,@05),@TS00001                           1248 06190000
*   NEWID2='IORT';                  /*                       @Y30LB35*/ 06191000
*                                                                  1249 06192000
         L     @05,@PC00001                                        1249 06193000
         L     @05,GDTTR2(,@05)                                    1249 06194000
         MVC   NEWID2(4,@05),@CC04288                              1249 06195000
*   /*****************************************************************/ 06196000
*   /*                                                               */ 06197000
*   /* HERE A TEST IS MADE TO DETERMINE IF VTOC              @Z40LB35*/ 06198000
*   /* ABEND OR A RACF/PASSWORD ABEND HAS OCCURRED           @Z40LB35*/ 06199000
*   /*                                                               */ 06200000
*   /*****************************************************************/ 06201000
*                                                                  1250 06202000
*   IF STAIO05=ON THEN                                             1250 06203000
         L     @05,@PC00001                                        1250 06204000
         L     @05,GDTSAH(,@05)                                    1250 06205000
         L     @05,SAHSTA(,@05)                                    1250 06206000
         TM    STAIO05(@05),B'10000000'                            1250 06207000
         BNO   @RF01250                                            1250 06208000
*     DO;                           /*                       @Z40LB35*/ 06209000
*                                                                  1251 06210000
*       /*************************************************************/ 06211000
*       /*                                                           */ 06212000
*       /* TURN OFF RETRY BIT                                @Z40LB35*/ 06213000
*       /*                                                           */ 06214000
*       /*************************************************************/ 06215000
*                                                                  1252 06216000
*       STAIO05=OFF;                /*                       @Z40LB35*/ 06217000
*                                                                  1252 06218000
         L     @05,@PC00001                                        1252 06219000
         L     @05,GDTSAH(,@05)                                    1252 06220000
         L     @05,SAHSTA(,@05)                                    1252 06221000
         NI    STAIO05(@05),B'01111111'                            1252 06222000
*       /*************************************************************/ 06223000
*       /*                                                           */ 06224000
*       /* ZERO THE DARGLIST TO SETUP MSG FOR PRINTING       @G24LB31*/ 06225000
*       /*                                                           */ 06226000
*       /*************************************************************/ 06227000
*                                                                  1253 06228000
*       DARGLIST=''B;               /*                       @Z40LB35*/ 06229000
*                                                                  1253 06230000
         L     @05,DDSTRU                                          1253 06231000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1253 06232000
*       /*************************************************************/ 06233000
*       /*                                                           */ 06234000
*       /* REESTABLISH ADDRESSABILITY TO THE JFCB            @Y30LB35*/ 06235000
*       /* AND CONTINUE TO SET DARGLIST                      @Y30LB35*/ 06236000
*       /*                                                           */ 06237000
*       /*************************************************************/ 06238000
*                                                                  1254 06239000
*       JFCBPTR=ADDR(IOXJFCB);      /*                       @Z40LB35*/ 06240000
         L     @05,IOCTLBKP                                        1254 06241000
         LA    @05,IOXJFCB(,@05)                                   1254 06242000
         ST    @05,JFCBPTR                                         1254 06243000
*       DARGDBP=ADDR(JFCBDSNM);     /*                       @Z40LB35*/ 06244000
         L     @05,JFCBPTR                                         1255 06245000
         L     @15,DDSTRU                                          1255 06246000
         ST    @05,DARGDBP(,@15)                                   1255 06247000
*       DARGILP=LENGTH(JFCBDSNM);   /*                       @Z40LB35*/ 06248000
*                                                                  1256 06249000
         L     @05,DDSTRU                                          1256 06250000
         MVC   DARGILP(2,@05),@CH00849                             1256 06251000
*       /*************************************************************/ 06252000
*       /*                                                           */ 06253000
*       /* CHECK ABEND RET.CODE AND SETUP APPRO MSG.         @G24LB31*/ 06254000
*       /* NOTE THAT A VSAM DATASPACE OPENED WITH A DCB      @G24LB31*/ 06255000
*       /* AS NON-VSAM WILL ABEND WITH 913-0C NOT -56/60     @G24LB31*/ 06256000
*       /* IF A RACF AUTHORIZATION CHECK FAILS FOR IT.       @G24LB31*/ 06257000
*       /*                                                           */ 06258000
*       /*************************************************************/ 06259000
*                                                                  1257 06260000
*       IF SDWAGR15=RCPSWD12 THEN   /*                       @G24LB31*/ 06261000
         CLC   SDWAGR15(4,SDWAPTR),RCPSWD12                        1257 06262000
         BNE   @RF01257                                            1257 06263000
*         DO;                       /*                       @G24LB31*/ 06264000
*           DARGSMOD=IO05MSGS;      /*                       @Z40LB35*/ 06265000
         L     @05,DDSTRU                                          1259 06266000
         MVC   DARGSMOD(3,@05),@CC03785                            1259 06267000
*           DARGSENT=MSG2376I;      /* INVALID RACF/PSWD     @G24LB31*/ 06268000
         L     @05,DDSTRU                                          1260 06269000
         MVI   DARGSENT(@05),X'0A'                                 1260 06270000
*         END;                      /*                       @G24LB31*/ 06271000
*       ELSE                        /*                       @G24LB31*/ 06272000
*         IF SDWAGR15=RCRACF56 THEN /*                       @G24LB31*/ 06273000
         B     @RC01257                                            1262 06274000
@RF01257 CLC   SDWAGR15(4,SDWAPTR),RCRACF56                        1262 06275000
         BNE   @RF01262                                            1262 06276000
*           DO;                     /*                       @G24LB31*/ 06277000
*             DARGSMOD=SA0MSGS;     /*                       @G24LB31*/ 06278000
         L     @05,DDSTRU                                          1264 06279000
         MVC   DARGSMOD(3,@05),@CC03787                            1264 06280000
*             DARGSENT=MSG2918I;    /* NOT RACF AUTH         @G24LB31*/ 06281000
         L     @05,DDSTRU                                          1265 06282000
         MVI   DARGSENT(@05),X'0A'                                 1265 06283000
*           END;                    /*                       @G24LB31*/ 06284000
*         ELSE                      /*                       @G24LB31*/ 06285000
*           IF SDWAGR15=RCRACF60 THEN/*                      @G24LB31*/ 06286000
         B     @RC01262                                            1267 06287000
@RF01262 CLC   SDWAGR15(4,SDWAPTR),RCRACF60                        1267 06288000
         BNE   @RF01267                                            1267 06289000
*             DO;                   /*                       @G24LB31*/ 06290000
*               DARGSMOD=SA0MSGS;   /*                       @G24LB31*/ 06291000
         L     @05,DDSTRU                                          1269 06292000
         MVC   DARGSMOD(3,@05),@CC03787                            1269 06293000
*               DARGSENT=MSG2917I;  /* NO RACF PROFILE       @G24LB31*/ 06294000
         L     @05,DDSTRU                                          1270 06295000
         MVI   DARGSENT(@05),X'09'                                 1270 06296000
*             END;                  /*                       @G24LB31*/ 06297000
*     END;                          /*                       @Z40LB35*/ 06298000
*   ELSE                                                           1273 06299000
*                                                                  1273 06300000
*     /***************************************************************/ 06301000
*     /*                                                             */ 06302000
*     /* IF VTOC ABEND, PREPARE ABEND ENTERED MESSAGE        @Z40LB35*/ 06303000
*     /*                                                             */ 06304000
*     /***************************************************************/ 06305000
*                                                                  1273 06306000
*     DO;                           /*                       @Z40LB35*/ 06307000
*                                                                  1273 06308000
         B     @RC01250                                            1273 06309000
@RF01250 DS    0H                                                  1274 06310000
*       /*************************************************************/ 06311000
*       /*                                                           */ 06312000
*       /* INITIALIZE DARGLIST TO ISSUE                      @Z40LB35*/ 06313000
*       /* "IDC2372I OPEN ABEND EXIT (VTOC)"                 @Z40LB35*/ 06314000
*       /*                                                           */ 06315000
*       /*************************************************************/ 06316000
*                                                                  1274 06317000
*       DARGLIST=''B;               /*                       @Z40LB35*/ 06318000
         L     @05,DDSTRU                                          1274 06319000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1274 06320000
*       DARGSMOD=IO05MSGS;          /*                       @Z40LB35*/ 06321000
         L     @05,DDSTRU                                          1275 06322000
         MVC   DARGSMOD(3,@05),@CC03785                            1275 06323000
*       DARGSENT=MSG2372I;          /*                       @Z40LB35*/ 06324000
         L     @05,DDSTRU                                          1276 06325000
         MVI   DARGSENT(@05),X'03'                                 1276 06326000
*       DARGDBP=ADDR(VTOCINST);     /*                       @Z40LB35*/ 06327000
         LA    @05,VTOCINST                                        1277 06328000
         L     @15,DDSTRU                                          1277 06329000
         ST    @05,DARGDBP(,@15)                                   1277 06330000
*       DARGILP=LENGTH(VTOCINST);   /*                       @Z40LB35*/ 06331000
         L     @05,DDSTRU                                          1278 06332000
         MVC   DARGILP(2,@05),@CH00045                             1278 06333000
*     END;                          /*                       @Z40LB35*/ 06334000
*                                                                  1279 06335000
*   /*****************************************************************/ 06336000
*   /*                                                               */ 06337000
*   /* HERE THE MESSAGE IS SENT TO USERS LISTING             @Z40LB35*/ 06338000
*   /*                                                               */ 06339000
*   /*****************************************************************/ 06340000
*                                                                  1280 06341000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  #Y30LB35*/ 06342000
*                                                                  1280 06343000
@RC01250 L     @05,@PC00001                                        1280 06344000
         ST    @05,@AL00001                                        1280 06345000
         LA    @05,@CF00119                                        1280 06346000
         ST    @05,@AL00001+4                                      1280 06347000
         LA    @05,DDSTRU                                          1280 06348000
         ST    @05,@AL00001+8                                      1280 06349000
         MVI   @AL00001+8,X'80'                                    1280 06350000
         L     @05,@PC00001                                        1280 06351000
         L     @15,GDTPRT(,@05)                                    1280 06352000
         LA    @01,@AL00001                                        1280 06353000
         BALR  @14,@15                                             1280 06354000
*   /*****************************************************************/ 06355000
*   /*                                                               */ 06356000
*   /* THE SDWA IS FREED UP AS IT IS NO LONGER               @G24LB31*/ 06357000
*   /* NEEDED.                                               @G24LB31*/ 06358000
*   /*                                                               */ 06359000
*   /*****************************************************************/ 06360000
*                                                                  1281 06361000
*   REG0=LENGTH(SDWA);              /*                       @G24LB31*/ 06362000
         LA    REG0,512                                            1281 06363000
*   REG1=ADDR(SDWA);                /*                       @G24LB31*/ 06364000
         LR    REG1,SDWAPTR                                        1282 06365000
*LFREM1:                                                           1283 06366000
*   GEN(FREEMAIN  R,LV=(0),A=(1));  /*                       @G24LB31*/ 06367000
LFREM1   FREEMAIN  R,LV=(0),A=(1)                                       06368000
*   RESPECIFY                                                      1284 06369000
*    (REG1,                                                        1284 06370000
*     REG0) UNRSTD;                 /*                       @G24LB31*/ 06371000
*                                                                  1284 06372000
*   /*****************************************************************/ 06373000
*   /*                                                               */ 06374000
*   /* HERE THE REGISTERS ARE RESTORED AND                   #Y30LB35*/ 06375000
*   /* CONTROL IS RETURNED TO THE INSTRUCTION                @Y30LB35*/ 06376000
*   /* AFTER THE OPEN SVC                                    @Y30LB35*/ 06377000
*   /* THE RETURN CODE IS SET TO RCFAIL(4)                   @Y30LB35*/ 06378000
*   /*                                                               */ 06379000
*   /*****************************************************************/ 06380000
*                                                                  1285 06381000
*   REG3=ADDR(SAVEREGS);            /*                       @Y30LB35*/ 06382000
         LA    REG3,SAVEREGS                                       1285 06383000
*   GEN(LM  REG0,REG15,0(REG3));    /*                       @Y30LB35*/ 06384000
*                                                                  1286 06385000
         LM  REG0,REG15,0(REG3)                                         06386000
*   /*****************************************************************/ 06387000
*   /*                                                               */ 06388000
*   /* HERE THE DETERMINATION IS MADE WHERE TO               @Z40LB35*/ 06389000
*   /* RETURN - TO OPNVTOC OR OPNPASS                        @Z40LB35*/ 06390000
*   /*                                                               */ 06391000
*   /*****************************************************************/ 06392000
*                                                                  1287 06393000
*   IF STAVTOC=ON THEN              /*                       @Z40LB35*/ 06394000
         L     @05,@PC00001                                        1287 06395000
         L     @05,GDTSAH(,@05)                                    1287 06396000
         L     @05,SAHSTA(,@05)                                    1287 06397000
         TM    STAVTOC(@05),B'00100000'                            1287 06398000
         BNO   @RF01287                                            1287 06399000
*     DO;                           /*                       @Z40LB35*/ 06400000
*                                                                  1288 06401000
*       /*************************************************************/ 06402000
*       /*                                                           */ 06403000
*       /* TURN OFF RETRY BIT                                @Z40LB35*/ 06404000
*       /*                                                           */ 06405000
*       /*************************************************************/ 06406000
*                                                                  1289 06407000
*       STAVTOC=OFF;                /*                       @Z40LB35*/ 06408000
*                                                                  1289 06409000
         L     @05,@PC00001                                        1289 06410000
         L     @05,GDTSAH(,@05)                                    1289 06411000
         L     @05,SAHSTA(,@05)                                    1289 06412000
         NI    STAVTOC(@05),B'11011111'                            1289 06413000
*       /*************************************************************/ 06414000
*       /*                                                           */ 06415000
*       /* RETURN TO THE INSTRUCTION AFTER OPEN              @Z40LB35*/ 06416000
*       /*                                                           */ 06417000
*       /*************************************************************/ 06418000
*                                                                  1290 06419000
*       RETURN TO AFTEROP2 CODE(4); /*                       @Z40LB35*/ 06420000
         LA    @14,AFTEROP2                                        1290 06421000
         LA    @15,4                                               1290 06422000
@EL00018 DS    0H                                                  1290 06423000
@EF00018 DS    0H                                                  1290 06424000
@ER00018 BR    @14                                                 1290 06425000
*     END;                          /*                       @Z40LB35*/ 06426000
*   ELSE                            /*                       @Z40LB35*/ 06427000
*     RETURN TO AFTEROPN CODE(4);   /*                       @Z40LB35*/ 06428000
@RF01287 LA    @14,AFTEROPN                                        1292 06429000
         LA    @15,4                                               1292 06430000
         BR    @14                                                 1292 06431000
*   RESPECIFY                                                      1293 06432000
*    (REG3) UNRSTD;                 /*                       @Y30LB35*/ 06433000
*   END RETRY;                      /*                       @Y30LB35*/ 06434000
*                                                                  1295 06435000
*/********************************************************************/ 06436000
*/*                                                          @Y30LB35*/ 06437000
*/* PROCEDURE NAME - SYNAD                                   @Y30LB35*/ 06438000
*/*                                                          @Y30LB35*/ 06439000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 06440000
*/*             HANDLE SYNAD ERRORS BY ISSUING MESSAGES.     @Y30LB35*/ 06441000
*/*             THIS IS DONE BY THE FOLLOWING STEPS:         @Y30LB35*/ 06442000
*/*             ISSUES SYNADAF MACRO, ISSUES UPRINT,         @Y30LB35*/ 06443000
*/*             ISSUES SYNADRLS, AND ISSUES UPRINT.          @Y30LB35*/ 06444000
*/*                                                          @Y30LB35*/ 06445000
*/*             THE MESSAGES IDC3313I & IDC2375I ARE ISSUED. @Y30LB35*/ 06446000
*/*                                                          @Y30LB35*/ 06447000
*/* INPUT -     IOXIOB IN IOXCTLBK                           @Y30LB35*/ 06448000
*/*             IOXDDN IN IOXCTLBK                           @Y30LB35*/ 06449000
*/*             IOXTYPE FORM IOXCTLBK                        @Y30LB35*/ 06450000
*/*             IOXJFCB FROM IOXCTLBK                        @Y30LB35*/ 06451000
*/*             SYNADMSG FROM SYNADAF MACRO                  @Y30LB35*/ 06452000
*/*                                                          @Y30LB35*/ 06453000
*/* OUTPUT -    SYNDNAME IN SYNADMSG                         @Y30LB35*/ 06454000
*/*             DARGSMOD IN DARGLIST                         @Y30LB35*/ 06455000
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/ 06456000
*/*             DARGDBP  IN DARGLIST                         @Y30LB35*/ 06457000
*/*             DARGILP  IN DARGLIST                         @Y30LB35*/ 06458000
*/*             IOXSYNAD IN IOXCTLBK                         @Y30LB35*/ 06459000
*/*             DCBTIOT  IN IOXDCB                           @Y30LB35*/ 06460000
*/*             JFCBPTR                                      @Y30LB35*/ 06461000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 06462000
*/*                                                          @Y30LB35*/ 06463000
*/********************************************************************/ 06464000
*                                                                  1295 06465000
*                                   /*                       @Y30LB35*/ 06466000
*SYNAD:                                                            1295 06467000
*   PROC;                           /*                       @Y30LB35*/ 06468000
*                                                                  1295 06469000
SYNAD    STM   @14,@12,@SA00019                                    1295 06470000
*   /*****************************************************************/ 06471000
*   /*                                                               */ 06472000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 06473000
*   /*                                                               */ 06474000
*   /*****************************************************************/ 06475000
*                                                                  1296 06476000
*   DCL                                                            1296 06477000
*     SYNMSGAD PTR(31) BDY(WORD);   /*                       @Y30LB35*/ 06478000
*   DCL                                                            1297 06479000
*     1 ERRORMSG BASED(SYNMSGAD),   /*                       @Y30LB35*/ 06480000
*      2 * CHAR(68),                /*                       @Y30LB35*/ 06481000
*      2 SYNADMSG,                  /*                       @Y30LB35*/ 06482000
*       3 * CHAR(7),                /*                       @Y30LB35*/ 06483000
*       3 SYNDNAME CHAR(8),         /*                       @Y30LB35*/ 06484000
*       3 * CHAR(45);               /*                       @Y30LB35*/ 06485000
*                                                                  1298 06486000
*   /*****************************************************************/ 06487000
*   /*                                                               */ 06488000
*   /* SET UP TRACE POINT 'IOSN' IN TRACE TABLE              @Y30LB35*/ 06489000
*   /*                                                               */ 06490000
*   /*****************************************************************/ 06491000
*                                                                  1298 06492000
*   OLDERID2=NEWERID2;                                             1298 06493000
         L     @03,@PC00001                                        1298 06494000
         L     @03,GDTTR2(,@03)                                    1298 06495000
         L     @15,@PC00001                                        1298 06496000
         L     @01,GDTTR2(,@15)                                    1298 06497000
         MVC   @TS00001(95),NEWERID2(@01)                          1298 06498000
         MVC   OLDERID2(95,@03),@TS00001                           1298 06499000
*   NEWID2='IOSN';                  /*                       @Y30LB35*/ 06500000
*                                                                  1299 06501000
         L     @03,@PC00001                                        1299 06502000
         L     @03,GDTTR2(,@03)                                    1299 06503000
         MVC   NEWID2(4,@03),@CC04303                              1299 06504000
*   /*****************************************************************/ 06505000
*   /*                                                               */ 06506000
*   /* SET UP FULL REGION DUMP POINT 'IOSY'                  @Y30LB35*/ 06507000
*   /*                                                               */ 06508000
*   /*****************************************************************/ 06509000
*                                                                  1300 06510000
*   IF GDTDBG=NULLPTR THEN                                         1300 06511000
         L     @03,@PC00001                                        1300 06512000
         L     @03,GDTDBG(,@03)                                    1300 06513000
         LTR   @03,@03                                             1300 06514000
         BZ    @RT01300                                            1300 06515000
*     ;                                                            1301 06516000
*   ELSE                                                           1302 06517000
*     CALL IDCDB010(GDTTBL,'IOSY'); /*                       @Y30LB35*/ 06518000
*                                                                  1302 06519000
         L     @03,@PC00001                                        1302 06520000
         ST    @03,@AL00001                                        1302 06521000
         LA    @03,@CC04304                                        1302 06522000
         ST    @03,@AL00001+4                                      1302 06523000
         MVI   @AL00001+4,X'80'                                    1302 06524000
         L     @03,@PC00001                                        1302 06525000
         L     @15,GDTDBG(,@03)                                    1302 06526000
         LA    @01,@AL00001                                        1302 06527000
         BALR  @14,@15                                             1302 06528000
*   /*****************************************************************/ 06529000
*   /*                                                               */ 06530000
*   /* SET THE IOXSYNAD BIT TO INDICATE SYNAD TAKEN          @Y30LB35*/ 06531000
*   /*                                                               */ 06532000
*   /*****************************************************************/ 06533000
*                                                                  1303 06534000
*   IOXSYNAD=ON;                    /*                       @Y30LB35*/ 06535000
@RT01300 L     @03,IOCTLBKP                                        1303 06536000
         OI    IOXSYNAD(@03),B'00010000'                           1303 06537000
*   RESPECIFY                                                      1304 06538000
*    (REG1) RSTD;                   /*                       @Y30LB35*/ 06539000
*                                                                  1304 06540000
*   /*****************************************************************/ 06541000
*   /*                                                               */ 06542000
*   /* INITIALIZE THE ADDRESS TO THE FAILING                 @Y30LB35*/ 06543000
*   /* IOB AND ISSUE SYNADAF TO BUILD THE                    @Y30LB35*/ 06544000
*   /* SYNAD ERROR MESSAGE.                                  @Y30LB35*/ 06545000
*   /*                                                               */ 06546000
*   /*****************************************************************/ 06547000
*                                                                  1305 06548000
*   REG1=ADDR(IOXIOB);              /*                       @Y30LB35*/ 06549000
         L     REG1,IOCTLBKP                                       1305 06550000
         LA    REG1,IOXIOB(,REG1)                                  1305 06551000
*LSYNF1:                                                           1306 06552000
*   GEN(SYNADAF ACSMETH=EXCP);      /*                       @Y30LB35*/ 06553000
*                                                                  1306 06554000
LSYNF1   SYNADAF ACSMETH=EXCP                                           06555000
*   /*****************************************************************/ 06556000
*   /*                                                               */ 06557000
*   /* SAVE THE ADDRESS OF THE SYNAD MESSAGE                 @Y30LB35*/ 06558000
*   /* BUFFER.                                               @Y30LB35*/ 06559000
*   /*                                                               */ 06560000
*   /*****************************************************************/ 06561000
*                                                                  1307 06562000
*   SYNMSGAD=REG1;                  /*                       @Y30LB35*/ 06563000
*                                                                  1307 06564000
         ST    REG1,SYNMSGAD                                       1307 06565000
*   /*****************************************************************/ 06566000
*   /*                                                               */ 06567000
*   /* FILL IN THE DDNAME FIELD INTO THE                     @Y30LB35*/ 06568000
*   /* MESSAGE.                                              @Y30LB35*/ 06569000
*   /*                                                               */ 06570000
*   /*****************************************************************/ 06571000
*                                                                  1308 06572000
*   SYNDNAME=IOXDDN;                /*                       @Y30LB35*/ 06573000
*                                                                  1308 06574000
         L     @03,SYNMSGAD                                        1308 06575000
         L     @15,IOCTLBKP                                        1308 06576000
         MVC   SYNDNAME(8,@03),IOXDDN(@15)                         1308 06577000
*   /*****************************************************************/ 06578000
*   /*                                                               */ 06579000
*   /* INITIALIZE THE DARGLIST TO ISSUE                      @Y30LB35*/ 06580000
*   /* "IDC3313I (SYNAD MESSAGE)"                            @Y30LB35*/ 06581000
*   /*                                                               */ 06582000
*   /*****************************************************************/ 06583000
*                                                                  1309 06584000
*   DARGLIST=''B;                   /*                       @Y30LB35*/ 06585000
         L     @03,DDSTRU                                          1309 06586000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1309 06587000
*   DARGSMOD=IO05MSGS;              /*                       @Y30LB35*/ 06588000
         L     @03,DDSTRU                                          1310 06589000
         MVC   DARGSMOD(3,@03),@CC03785                            1310 06590000
*   DARGSENT=MSG3313I;              /*                       @Y30LB35*/ 06591000
         L     @03,DDSTRU                                          1311 06592000
         MVI   DARGSENT(@03),X'05'                                 1311 06593000
*   DARGDBP=ADDR(SYNADMSG);         /*                       @Y30LB35*/ 06594000
         L     @03,SYNMSGAD                                        1312 06595000
         LA    @03,SYNADMSG(,@03)                                  1312 06596000
         L     @15,DDSTRU                                          1312 06597000
         ST    @03,DARGDBP(,@15)                                   1312 06598000
*   DARGILP=LENGTH(SYNADMSG);       /*                       @Y30LB35*/ 06599000
         L     @03,DDSTRU                                          1313 06600000
         MVC   DARGILP(2,@03),@CH01813                             1313 06601000
*   RESPECIFY                                                      1314 06602000
*    (REG1) UNRSTD;                 /*                       @Y30LB35*/ 06603000
*                                                                  1314 06604000
*   /*****************************************************************/ 06605000
*   /*                                                               */ 06606000
*   /* ISSUE UPRINT TO SEND THE ERROR MESSAGE                @Y30LB35*/ 06607000
*   /* TO SYSPRINT                                           @Y30LB35*/ 06608000
*   /*                                                               */ 06609000
*   /*****************************************************************/ 06610000
*                                                                  1315 06611000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB35*/ 06612000
         L     @03,@PC00001                                        1315 06613000
         ST    @03,@AL00001                                        1315 06614000
         LA    @03,@CF00119                                        1315 06615000
         ST    @03,@AL00001+4                                      1315 06616000
         LA    @03,DDSTRU                                          1315 06617000
         ST    @03,@AL00001+8                                      1315 06618000
         MVI   @AL00001+8,X'80'                                    1315 06619000
         L     @03,@PC00001                                        1315 06620000
         L     @15,GDTPRT(,@03)                                    1315 06621000
         LA    @01,@AL00001                                        1315 06622000
         BALR  @14,@15                                             1315 06623000
*   RESPECIFY                                                      1316 06624000
*    (REG1) RSTD;                   /*                       @Y30LB35*/ 06625000
*                                                                  1316 06626000
*   /*****************************************************************/ 06627000
*   /*                                                               */ 06628000
*   /* INITIALIZE THE ADDRESS INTO REGISTER 1                @Y30LB35*/ 06629000
*   /* FOR SYNADRLS TO FREE THE SYNAD BUFFER.                @Y30LB35*/ 06630000
*   /*                                                               */ 06631000
*   /*****************************************************************/ 06632000
*                                                                  1317 06633000
*   REG1=SYNMSGAD;                  /*                       @Y30LB35*/ 06634000
         L     REG1,SYNMSGAD                                       1317 06635000
*LSYNR1:                                                           1318 06636000
*   GEN(SYNADRLS);                  /*                       @Y30LB35*/ 06637000
*                                                                  1318 06638000
LSYNR1   SYNADRLS                                                       06639000
*   /*****************************************************************/ 06640000
*   /*                                                               */ 06641000
*   /* SET THE IOXSYNAD BIT TO INDICATE THAT A SYNAD         @Y30LB35*/ 06642000
*   /* WAS TAKEN FOR THIS DCB.                               @Y30LB35*/ 06643000
*   /*                                                               */ 06644000
*   /*****************************************************************/ 06645000
*                                                                  1319 06646000
*   IOXSYNAD=ON;                    /*                       @Y30LB35*/ 06647000
*                                                                  1319 06648000
         L     @03,IOCTLBKP                                        1319 06649000
         OI    IOXSYNAD(@03),B'00010000'                           1319 06650000
*   /*****************************************************************/ 06651000
*   /*                                                               */ 06652000
*   /* REINITIALIZE THE DARGLIST TO ISSUE                    @Y30LB35*/ 06653000
*   /* THE SECOND LEVEL MESSAGE                              @Y30LB35*/ 06654000
*   /* "IDC2375I I/O ERROR (DSN/VTOC)"                       @Y30LB35*/ 06655000
*   /*                                                               */ 06656000
*   /*****************************************************************/ 06657000
*                                                                  1320 06658000
*   DARGLIST=''B;                   /*                       @Y30LB35*/ 06659000
         L     @03,DDSTRU                                          1320 06660000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1320 06661000
*   DARGSMOD=IO05MSGS;              /*                       @Y30LB35*/ 06662000
*                                                                  1321 06663000
         L     @03,DDSTRU                                          1321 06664000
         MVC   DARGSMOD(3,@03),@CC03785                            1321 06665000
*   /*****************************************************************/ 06666000
*   /*                                                               */ 06667000
*   /* DETERMINE WHICH INSERT IS NEEDED                      @Y30LB35*/ 06668000
*   /*                                                               */ 06669000
*   /*****************************************************************/ 06670000
*                                                                  1322 06671000
*   IF IOXTYPE^=LAB&IOXTYPE^=NEWVOL&IOXTYPE^=VTOC THEN/*     @Y30LB35*/ 06672000
         L     @03,IOCTLBKP                                        1322 06673000
         CLC   IOXTYPE(1,@03),LAB                                  1322 06674000
         BE    @RF01322                                            1322 06675000
         L     @03,IOCTLBKP                                        1322 06676000
         CLC   IOXTYPE(1,@03),NEWVOL                               1322 06677000
         BE    @RF01322                                            1322 06678000
         L     @03,IOCTLBKP                                        1322 06679000
         CLC   IOXTYPE(1,@03),VTOC                                 1322 06680000
         BE    @RF01322                                            1322 06681000
*     DO;                           /*                       @Y30LB35*/ 06682000
*                                                                  1323 06683000
*       /*************************************************************/ 06684000
*       /*                                                           */ 06685000
*       /* IF I/O WAS ON A DATA SET PREPARE                  @Y30LB35*/ 06686000
*       /* MESSAGE "IDC2375I ** I/O ERROR - (DSN)"           @Y30LB35*/ 06687000
*       /*                                                           */ 06688000
*       /*************************************************************/ 06689000
*                                                                  1324 06690000
*       DARGSENT=MSG2375A;          /*                       @Y30LB35*/ 06691000
         L     @03,DDSTRU                                          1324 06692000
         MVI   DARGSENT(@03),X'08'                                 1324 06693000
*       JFCBPTR=ADDR(IOXJFCB);      /*                       @Y30LB35*/ 06694000
         L     @03,IOCTLBKP                                        1325 06695000
         LA    @03,IOXJFCB(,@03)                                   1325 06696000
         ST    @03,JFCBPTR                                         1325 06697000
*       DARGDBP=ADDR(JFCBDSNM);     /*                       @Y30LB35*/ 06698000
         L     @03,JFCBPTR                                         1326 06699000
         L     @15,DDSTRU                                          1326 06700000
         ST    @03,DARGDBP(,@15)                                   1326 06701000
*       DARGILP=LENGTH(JFCBDSNM);   /*                       @Y30LB35*/ 06702000
         L     @03,DDSTRU                                          1327 06703000
         MVC   DARGILP(2,@03),@CH00849                             1327 06704000
*     END;                          /*                       @Y30LB35*/ 06705000
*                                                                  1328 06706000
*   /*****************************************************************/ 06707000
*   /*                                                               */ 06708000
*   /* IF I/O ERROR WAS ON THE VTOC THEN                     @Y30LB35*/ 06709000
*   /*                                                               */ 06710000
*   /*****************************************************************/ 06711000
*                                                                  1329 06712000
*   ELSE                            /*                       @Z40LB35*/ 06713000
*     IF IOXTYPE=VTOC|IOXTYPE=VTOCHDR THEN/*                 @ZA11014*/ 06714000
         B     @RC01322                                            1329 06715000
@RF01322 L     @03,IOCTLBKP                                        1329 06716000
         CLC   IOXTYPE(1,@03),VTOC                                 1329 06717000
         BE    @RT01329                                            1329 06718000
         L     @03,IOCTLBKP                                        1329 06719000
         CLC   IOXTYPE(1,@03),VTOCHDR                              1329 06720000
         BNE   @RF01329                                            1329 06721000
@RT01329 DS    0H                                                  1330 06722000
*       DO;                         /*                       @Z40LB35*/ 06723000
*                                                                  1330 06724000
*         /***********************************************************/ 06725000
*         /*                                                         */ 06726000
*         /* IF I/O WAS ON A DATA SET PREPARE                @Z40LB35*/ 06727000
*         /* MESSAGE "IDC2375I ** I/O ERROR - VTOC"          @Z40LB35*/ 06728000
*         /*                                                         */ 06729000
*         /***********************************************************/ 06730000
*                                                                  1331 06731000
*         DARGSENT=MSG2375A;        /*                       @Z40LB35*/ 06732000
         L     @03,DDSTRU                                          1331 06733000
         MVI   DARGSENT(@03),X'08'                                 1331 06734000
*         DARGDBP=ADDR('VTOC');     /*                       @Z40LB35*/ 06735000
         LA    @03,@CC03929                                        1332 06736000
         L     @15,DDSTRU                                          1332 06737000
         ST    @03,DARGDBP(,@15)                                   1332 06738000
*         DARGILP=LENGTH('VTOc');   /*                       @Z40LB35*/ 06739000
         L     @03,DDSTRU                                          1333 06740000
         MVC   DARGILP(2,@03),@CH00045                             1333 06741000
*       END;                        /*                       @Z40LB35*/ 06742000
*                                                                  1334 06743000
*   /*****************************************************************/ 06744000
*   /*                                                               */ 06745000
*   /* PREPARE "IDC2375I ** I/O ERROR PROCESSING             @Y30LB35*/ 06746000
*   /* VOLUME LABEL"                                         @Y30LB35*/ 06747000
*   /*                                                               */ 06748000
*   /*****************************************************************/ 06749000
*                                                                  1335 06750000
*     ELSE                          /*                       @Z40LB35*/ 06751000
*       DARGSENT=MSG2375B;          /*                       @Z40LB35*/ 06752000
         B     @RC01329                                            1335 06753000
@RF01329 L     @03,DDSTRU                                          1335 06754000
         MVI   DARGSENT(@03),X'09'                                 1335 06755000
*   RESPECIFY                                                      1336 06756000
*    (REG1) UNRSTD;                 /*                       @Y30LB35*/ 06757000
*                                                                  1336 06758000
@RC01329 DS    0H                                                  1336 06759000
@RC01322 DS    0H                                                  1337 06760000
*   /*****************************************************************/ 06761000
*   /*                                                               */ 06762000
*   /* ISSUE UPRINT TO SEND THE ERROR                        @Y30LB35*/ 06763000
*   /* MESSAGE TO SYSPRINT                                   @Y30LB35*/ 06764000
*   /*                                                               */ 06765000
*   /*****************************************************************/ 06766000
*                                                                  1337 06767000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB35*/ 06768000
*                                                                  1337 06769000
         L     @03,@PC00001                                        1337 06770000
         ST    @03,@AL00001                                        1337 06771000
         LA    @03,@CF00119                                        1337 06772000
         ST    @03,@AL00001+4                                      1337 06773000
         LA    @03,DDSTRU                                          1337 06774000
         ST    @03,@AL00001+8                                      1337 06775000
         MVI   @AL00001+8,X'80'                                    1337 06776000
         L     @03,@PC00001                                        1337 06777000
         L     @15,GDTPRT(,@03)                                    1337 06778000
         LA    @01,@AL00001                                        1337 06779000
         BALR  @14,@15                                             1337 06780000
*   /*****************************************************************/ 06781000
*   /*                                                               */ 06782000
*   /* SET THE RETURN CODE IN REG15 TO ZERO AND              @Y30LB35*/ 06783000
*   /* RETURN TO ISSUEXCP.                                   @Y30LB35*/ 06784000
*   /*                                                               */ 06785000
*   /*****************************************************************/ 06786000
*                                                                  1338 06787000
*   TESTRC=0;                       /*                       @Y30LB35*/ 06788000
         SLR   @03,@03                                             1338 06789000
         STH   @03,TESTRC                                          1338 06790000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 06791000
         LH    @15,TESTRC                                          1339 06792000
         L     @14,@SA00019                                        1339 06793000
         LM    @00,@12,@SA00019+8                                  1339 06794000
         BR    @14                                                 1339 06795000
*   END SYNAD;                      /*                       @Y30LB35*/ 06796000
*                                                                  1341 06797000
*/********************************************************************/ 06798000
*/*                                                          @Y30LB35*/ 06799000
*/* PROCEDURE NAME - OCABEND                                 @Y30LB35*/ 06800000
*/*                                                          @Y30LB35*/ 06801000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 06802000
*/*             TAKE CONTROL WHEN THE SVC'S OPEN OR          @Y30LB35*/ 06803000
*/*             CLOSE ENCOUNTERS AN ABEND SITUATION.         @Y30LB35*/ 06804000
*/*             THE FOLLOWING STEPS ARE PERFORMED:           @Y30LB35*/ 06805000
*/*             SET IOXABEND FLAG IN IOXCTLBK                @Y30LB35*/ 06806000
*/*             SAVE ABEND CODE IN IOXACODE OF IOXCTLBK      @Y30LB35*/ 06807000
*/*             SAVE RETURN CODE IN IOXRCODE OF IOXCTLBK     @Y30LB35*/ 06808000
*/*             SET OCOPTION IN OPNCLOSE                     @Y30LB35*/ 06809000
*/*                                                          @Y30LB35*/ 06810000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @Y30LB35*/ 06811000
*/*                                                          @Y30LB35*/ 06812000
*/* INPUT -     OPNCLOSE FORM SYSTEM                         @Y30LB35*/ 06813000
*/*             OCABCODE FROM OPNCLOSE                       @Y30LB35*/ 06814000
*/*             OCREASON FROM OPNCLOSE                       @Y30LB35*/ 06815000
*/*             OCOPTION FROM OPNCLOSE                       @Y30LB35*/ 06816000
*/*                                                          @Y30LB35*/ 06817000
*/* OUTPUT -    IOXABEND IN IOXCTLBK                         @Y30LB35*/ 06818000
*/*             IOXACODE IN IOXCTLBK                         @Y30LB35*/ 06819000
*/*             IOXRCODE IN IOXCTLBK                         @Y30LB35*/ 06820000
*/*             OCOPTION IN OPNCLOSE                         @Y30LB35*/ 06821000
*/*                                                          @Y30LB35*/ 06822000
*/********************************************************************/ 06823000
*                                                                  1341 06824000
*OCABEND:                                                          1341 06825000
*   PROC;                           /*                       @Y30LB35*/ 06826000
*                                                                  1341 06827000
OCABEND  STM   @14,@12,@SA00020                                    1341 06828000
*   /*****************************************************************/ 06829000
*   /*                                                               */ 06830000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 06831000
*   /*                                                               */ 06832000
*   /*****************************************************************/ 06833000
*                                                                  1342 06834000
*   DCL                                                            1342 06835000
*     OCPARM PTR(31) BDY(WORD);     /*                       @Y30LB35   06836000
*                                      OPEN CLOSE PARM PTR   @Y30LB35*/ 06837000
*   DCL                                                            1343 06838000
*     IGNORE FIXED(8) STATIC INIT('04'X);/*                  @Y30LB35   06839000
*                                      CODE TO TELL SVC      @Y30LB35   06840000
*                                      IGNORE AND CONTINUE   @Y30LB35*/ 06841000
*                                                                  1343 06842000
*   /*****************************************************************/ 06843000
*   /*                                                               */ 06844000
*   /* THIS IS THE OVERLAY STRUCTURE FOR THE                 @Y30LB35*/ 06845000
*   /* PARMS PASSED BY SVC TO THIS PROCEDURE.                @Y30LB35*/ 06846000
*   /*                                                               */ 06847000
*   /*****************************************************************/ 06848000
*                                                                  1344 06849000
*   DCL                                                            1344 06850000
*     1 OPNCLOSE BASED(OCPARM) BDY(WORD),/*                  @Y30LB35*/ 06851000
*      2 OCABCODE FIXED(15),        /*                       @Y30LB35   06852000
*                                      ABEND CODE            @Y30LB35*/ 06853000
*      2 OCREASON FIXED(8),         /*                       @Y30LB35   06854000
*                                      REASON CODE           @Y30LB35*/ 06855000
*      2 OCOPTION FIXED(8);         /*                       @Y30LB35   06856000
*                                      MY OPTION             @Y30LB35*/ 06857000
*                                                                  1345 06858000
*   /*****************************************************************/ 06859000
*   /*                                                               */ 06860000
*   /* SAVE PARMLIST POINTER                                 @Y30LB35*/ 06861000
*   /*                                                               */ 06862000
*   /*****************************************************************/ 06863000
*                                                                  1345 06864000
*   OCPARM=REG1;                    /*                       @Y30LB35*/ 06865000
*                                                                  1345 06866000
         ST    REG1,OCPARM                                         1345 06867000
*   /*****************************************************************/ 06868000
*   /*                                                               */ 06869000
*   /* SET UP TRACE POINT 'IOOC' IN TRACE TABLE              @Y30LB35*/ 06870000
*   /*                                                               */ 06871000
*   /*****************************************************************/ 06872000
*                                                                  1346 06873000
*   OLDERID2=NEWERID2;                                             1346 06874000
         L     @03,@PC00001                                        1346 06875000
         L     @03,GDTTR2(,@03)                                    1346 06876000
         L     @15,@PC00001                                        1346 06877000
         L     @01,GDTTR2(,@15)                                    1346 06878000
         MVC   @TS00001(95),NEWERID2(@01)                          1346 06879000
         MVC   OLDERID2(95,@03),@TS00001                           1346 06880000
*   NEWID2='IOOC';                  /*                       @Y30LB35*/ 06881000
*                                                                  1347 06882000
         L     @03,@PC00001                                        1347 06883000
         L     @03,GDTTR2(,@03)                                    1347 06884000
         MVC   NEWID2(4,@03),@CC04319                              1347 06885000
*   /*****************************************************************/ 06886000
*   /*                                                               */ 06887000
*   /* SET UP FULL REGION DUMP POINT 'IOAB'                  @Y30LB35*/ 06888000
*   /*                                                               */ 06889000
*   /*****************************************************************/ 06890000
*                                                                  1348 06891000
*   IF GDTDBG=NULLPTR THEN                                         1348 06892000
         L     @03,@PC00001                                        1348 06893000
         L     @03,GDTDBG(,@03)                                    1348 06894000
         LTR   @03,@03                                             1348 06895000
         BZ    @RT01348                                            1348 06896000
*     ;                                                            1349 06897000
*   ELSE                                                           1350 06898000
*     CALL IDCDB010(GDTTBL,'IOAB'); /*                       @Y30LB35*/ 06899000
         L     @03,@PC00001                                        1350 06900000
         ST    @03,@AL00001                                        1350 06901000
         LA    @03,@CC04320                                        1350 06902000
         ST    @03,@AL00001+4                                      1350 06903000
         MVI   @AL00001+4,X'80'                                    1350 06904000
         L     @03,@PC00001                                        1350 06905000
         L     @15,GDTDBG(,@03)                                    1350 06906000
         LA    @01,@AL00001                                        1350 06907000
         BALR  @14,@15                                             1350 06908000
*   RESPECIFY                                                      1351 06909000
*    (REG1,                                                        1351 06910000
*     REG14) RSTD;                  /*                       @Y30LB35*/ 06911000
*                                                                  1351 06912000
@RT01348 DS    0H                                                  1352 06913000
*   /*****************************************************************/ 06914000
*   /*                                                               */ 06915000
*   /* SET IOXABEND FLAG TO INDICATE THAT                    @Y30LB35*/ 06916000
*   /* THIS ROUTINE WAS GIVEN CONTROL AFTER                  @Y30LB35*/ 06917000
*   /* THE SVC RETURNS TO PROCESSING.                        @Y30LB35*/ 06918000
*   /*                                                               */ 06919000
*   /*****************************************************************/ 06920000
*                                                                  1352 06921000
*   IOXABEND=ON;                    /*                       @Y30LB35*/ 06922000
*                                                                  1352 06923000
         L     @15,IOCTLBKP                                        1352 06924000
         OI    IOXABEND(@15),B'01000000'                           1352 06925000
*   /*****************************************************************/ 06926000
*   /*                                                               */ 06927000
*   /* SAVE ABEND CODE AND RETURN CODE                       @Y30LB35*/ 06928000
*   /* FOR PROBLEM DETERMINATION IF DUMP TAKEN               @Y30LB35*/ 06929000
*   /*                                                               */ 06930000
*   /*****************************************************************/ 06931000
*                                                                  1353 06932000
*   IOXACODE=OCABCODE;              /*                       @Y30LB35*/ 06933000
         L     @15,OCPARM                                          1353 06934000
         LH    @15,OCABCODE(,@15)                                  1353 06935000
         L     @03,IOCTLBKP                                        1353 06936000
         STH   @15,IOXACODE(,@03)                                  1353 06937000
*   IOXRCODE=OCREASON;              /*                       @Y30LB35*/ 06938000
*                                                                  1354 06939000
         L     @15,OCPARM                                          1354 06940000
         SLR   @03,@03                                             1354 06941000
         IC    @03,OCREASON(,@15)                                  1354 06942000
         L     @15,IOCTLBKP                                        1354 06943000
         STH   @03,IOXRCODE(,@15)                                  1354 06944000
*   /*****************************************************************/ 06945000
*   /*                                                               */ 06946000
*   /* SET OPTION CODE TO IGNORE PROBLEM                     @Y30LB35*/ 06947000
*   /*                                                               */ 06948000
*   /*****************************************************************/ 06949000
*                                                                  1355 06950000
*   OCOPTION=IGNORE;                /*                       @Y30LB35*/ 06951000
         IC    @15,IGNORE                                          1355 06952000
         L     @03,OCPARM                                          1355 06953000
         STC   @15,OCOPTION(,@03)                                  1355 06954000
*   RESPECIFY                                                      1356 06955000
*    (REG1,                                                        1356 06956000
*     REG14) UNRSTD;                /*                       @Y30LB35*/ 06957000
*   END OCABEND;                    /*                       @Y30LB35*/ 06958000
@EL00020 DS    0H                                                  1357 06959000
@EF00020 DS    0H                                                  1357 06960000
@ER00020 LM    @14,@12,@SA00020                                    1357 06961000
         BR    @14                                                 1357 06962000
*                                                                  1358 06963000
*/********************************************************************/ 06964000
*/*                                                          @Y30LB35*/ 06965000
*/* PROCEDURE NAME - READJFCB                                @Y30LB35*/ 06966000
*/*                                                          @Y30LB35*/ 06967000
*/* FUNCTION -  THIS ROUTINE PRIMARY FUNCTION IS TO          @Y30LB35*/ 06968000
*/*             OBTAIN THE JFCB TO BE USED IN MESSAGES AND   @Y30LB35*/ 06969000
*/*             OPEN TYPE=J.  THE FOLLOWING STEPS ARE USED:  @Y30LB35*/ 06970000
*/*             ISSUES RDJFCB AND ISSUES UPRINT IF NECESSARY @Y30LB35*/ 06971000
*/*                                                          @Y30LB35*/ 06972000
*/*             MESSAGE IDC2370I IS ISSUED IF RDJFCB ERROR   @Y30LB35*/ 06973000
*/*                                                          @Y30LB35*/ 06974000
*/* INPUT -     IOXEXLST FROM IOXCTLBK                       @Y30LB35*/ 06975000
*/*             IOXJFCB FROM IOXCTLBK                        @Y30LB35*/ 06976000
*/*             IOXDCB FROM IOXCTLBK                         @Y30LB35*/ 06977000
*/*             USERDDN FROM CALLER'S CORE                   @Y30LB35*/ 06978000
*/*                                                          @Y30LB35*/ 06979000
*/* OUTPUT -    DCBEXLSA IN IOXDCB                           @Y30LB35*/ 06980000
*/*             IOXJFCBP IN IOXCTLBK                         @Y30LB35*/ 06981000
*/*             DARGSMOD IN DARGLIST                         @Y30LB35*/ 06982000
*/*             DARGSENT IN DARGLIST                         @Y30LB35*/ 06983000
*/*             DARGDBP  IN DARGLIST                         @Y30LB35*/ 06984000
*/*             DARGILP  IN DARGLIST                         @Y30LB35*/ 06985000
*/*             DARGCNT  IN DARGLIST                         @Y30LB35*/ 06986000
*/*             DARGINS(1) IN DARGARY                        @Y30LB35*/ 06987000
*/*             DARGINL(1) IN DARGARY                        @Y30LB35*/ 06988000
*/*             DARGDTM(1) IN DARGARY                        @Y30LB35*/ 06989000
*/*             RDJFCBPM                                     @Y30LB35*/ 06990000
*/*             JFCBPTR                                      @Y30LB35*/ 06991000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Y30LB35*/ 06992000
*/*                           4, ERROR IN RDJFCB             @Y30LB35*/ 06993000
*/*                                                          @Y30LB35*/ 06994000
*/********************************************************************/ 06995000
*                                                                  1358 06996000
*                                   /*                       @Y30LB35*/ 06997000
*READJFCB:                                                         1358 06998000
*   PROC;                           /*                       @Y30LB35*/ 06999000
*                                                                  1358 07000000
READJFCB STM   @14,@12,@SA00021                                    1358 07001000
*   /*****************************************************************/ 07002000
*   /*                                                               */ 07003000
*   /* LOCAL DECLARES                                        @Y30LB35*/ 07004000
*   /*                                                               */ 07005000
*   /*****************************************************************/ 07006000
*                                                                  1359 07007000
*   DCL                                                            1359 07008000
*     JFCBLST CHAR(4) GEND;         /*                       @Y30LB35   07009000
*                                      ASSEM TO PLS          @Y30LB35*/ 07010000
*                                                                  1359 07011000
*   /*****************************************************************/ 07012000
*   /*                                                               */ 07013000
*   /* THE FOLLOWING IS THE PARMLIST                         @Y30LB35*/ 07014000
*   /* PASSED TO RDJFCB.                                     @Y30LB35*/ 07015000
*   /*                                                               */ 07016000
*   /*****************************************************************/ 07017000
*                                                                  1360 07018000
*   DCL                                                            1360 07019000
*     1 RDJFCBPM BDY(WORD),         /*                       @Y30LB35*/ 07020000
*      2 RDJFCBCD CHAR(1),          /*                       @Y30LB35   07021000
*                                      RDJFCB CODE           @Y30LB35*/ 07022000
*      2 RDJFCBAD PTR(24);          /*                       @Y30LB35   07023000
*                                      ADDR OF RTN AREA      @Y30LB35*/ 07024000
*                                                                  1360 07025000
*   /*****************************************************************/ 07026000
*   /*                                                               */ 07027000
*   /* THE FOLLOWING IS THE ASSEM RDJFCB LIST FORM           @Y30LB35*/ 07028000
*   /*                                                               */ 07029000
*   /*****************************************************************/ 07030000
*                                                                  1361 07031000
*   GENERATE DATA;                                                 1361 07032000
*                                                                  1362 07033000
*   /*****************************************************************/ 07034000
*   /*                                                               */ 07035000
*   /* SET UP TRACE POINT 'IORJ' IN TRACE TABLE              @Y30LB35*/ 07036000
*   /*                                                               */ 07037000
*   /*****************************************************************/ 07038000
*                                                                  1362 07039000
*   OLDERID2=NEWERID2;                                             1362 07040000
         L     @03,@PC00001                                        1362 07041000
         L     @03,GDTTR2(,@03)                                    1362 07042000
         L     @15,@PC00001                                        1362 07043000
         L     @01,GDTTR2(,@15)                                    1362 07044000
         MVC   @TS00001(95),NEWERID2(@01)                          1362 07045000
         MVC   OLDERID2(95,@03),@TS00001                           1362 07046000
*   NEWID2='IORJ';                  /*                       @Y30LB35*/ 07047000
*                                                                  1363 07048000
         L     @03,@PC00001                                        1363 07049000
         L     @03,GDTTR2(,@03)                                    1363 07050000
         MVC   NEWID2(4,@03),@CC04328                              1363 07051000
*   /*****************************************************************/ 07052000
*   /*                                                               */ 07053000
*   /* SET UP DCBEXLSA WITH OPEN EXTENT LIST                 @Y30LB35*/ 07054000
*   /*                                                               */ 07055000
*   /*****************************************************************/ 07056000
*                                                                  1364 07057000
*   DCBEXLSA=ADDR(IOXEXLST);        /*                       @Y30LB35*/ 07058000
*                                                                  1364 07059000
         L     @03,IOCTLBKP                                        1364 07060000
         LA    @03,IOXEXLST(,@03)                                  1364 07061000
         L     @01,DCBPTR                                          1364 07062000
         STCM  @03,7,DCBEXLSA+28(@01)                              1364 07063000
*   /*****************************************************************/ 07064000
*   /*                                                               */ 07065000
*   /* INITIALIZE ADDRESSABILITY TO JFCB                     @Y30LB35*/ 07066000
*   /*                                                               */ 07067000
*   /*****************************************************************/ 07068000
*                                                                  1365 07069000
*   IOXJFCBP=ADDR(IOXJFCB);         /*                       @Y30LB35*/ 07070000
         L     @03,IOCTLBKP                                        1365 07071000
         LA    @03,IOXJFCB(,@03)                                   1365 07072000
         L     @01,IOCTLBKP                                        1365 07073000
         STCM  @03,7,IOXJFCBP(@01)                                 1365 07074000
*   JFCBPTR=ADDR(IOXJFCB);          /*                       @Y30LB35*/ 07075000
         L     @03,IOCTLBKP                                        1366 07076000
         LA    @03,IOXJFCB(,@03)                                   1366 07077000
         ST    @03,JFCBPTR                                         1366 07078000
*   RESPECIFY                                                      1367 07079000
*     REG1 RESTRICTED;              /*                       @Y30LB35*/ 07080000
*                                                                  1367 07081000
*   /*****************************************************************/ 07082000
*   /*                                                               */ 07083000
*   /* MOVE LIST FORM RDJFCB TO DYNAMIC AREA                 @Y30LB35*/ 07084000
*   /*                                                               */ 07085000
*   /*****************************************************************/ 07086000
*                                                                  1368 07087000
*   RDJFCBPM=JFCBLST;               /*                       @Y30LB35*/ 07088000
*                                                                  1368 07089000
         MVC   RDJFCBPM(4),JFCBLST                                 1368 07090000
*   /*****************************************************************/ 07091000
*   /*                                                               */ 07092000
*   /* MOVE DCB ADDRESS INTO LIST                            @Y30LB35*/ 07093000
*   /*                                                               */ 07094000
*   /*****************************************************************/ 07095000
*                                                                  1369 07096000
*   RDJFCBAD=ADDR(IOXDCB);          /*                       @Y30LB35*/ 07097000
*                                                                  1369 07098000
         L     @03,IOCTLBKP                                        1369 07099000
         LA    @03,IOXDCB(,@03)                                    1369 07100000
         STCM  @03,7,RDJFCBAD                                      1369 07101000
*   /*****************************************************************/ 07102000
*   /*                                                               */ 07103000
*   /* ISSUE EXECUTE FORM OF RDJFCB TO RETRIEVE JFCB         @Y30LB35*/ 07104000
*   /*                                                               */ 07105000
*   /*****************************************************************/ 07106000
*                                                                  1370 07107000
*LRDJF1:                                                           1370 07108000
*   GEN(RDJFCB  MF=(E,RDJFCBPM));   /*                       @Y30LB35*/ 07109000
LRDJF1   RDJFCB  MF=(E,RDJFCBPM)                                        07110000
*   RESPECIFY                                                      1371 07111000
*     REG1 UNRESTRICTED;            /*                       @Y30LB35*/ 07112000
*   RESPECIFY                                                      1372 07113000
*     RTNREG RSTD;                                                 1372 07114000
*   TESTRC=RTNREG;                                                 1373 07115000
         STH   RTNREG,TESTRC                                       1373 07116000
*   RESPECIFY                                                      1374 07117000
*     RTNREG UNRSTD;                /*                       @Y30LB35*/ 07118000
*                                                                  1374 07119000
*   /*****************************************************************/ 07120000
*   /*                                                               */ 07121000
*   /* TEST TO SEE IF RDJFCB WAS SUCCESSFUL                  @Y30LB35*/ 07122000
*   /*                                                               */ 07123000
*   /*****************************************************************/ 07124000
*                                                                  1375 07125000
*   IF TESTRC^=0                    /*                       @Y30LB35*/ 07126000
*     THEN                          /*                       @Y30LB35*/ 07127000
*                                                                  1375 07128000
         LH    @03,TESTRC                                          1375 07129000
         LTR   @03,@03                                             1375 07130000
         BZ    @RF01375                                            1375 07131000
*     /***************************************************************/ 07132000
*     /*                                                             */ 07133000
*     /* IF NOT SUCCESSFUL PREPARE TO ISSUE                  @Y30LB35*/ 07134000
*     /* "IDC2375I UNABLE TO READ JFCB                       @Y30LB35*/ 07135000
*     /* FOR DD ENTRY (DDNAME) RDJFCB CODE (XX)"             @Y30LB35*/ 07136000
*     /*                                                             */ 07137000
*     /***************************************************************/ 07138000
*                                                                  1376 07139000
*     DO;                           /*                       @Y30LB35*/ 07140000
*                                                                  1376 07141000
*       /*************************************************************/ 07142000
*       /*                                                           */ 07143000
*       /* INITIALIZE THE DARGLIST                           @Y30LB35*/ 07144000
*       /*                                                           */ 07145000
*       /*************************************************************/ 07146000
*                                                                  1377 07147000
*       DARGLIST=''B;               /*                       @Y30LB35*/ 07148000
         L     @03,DDSTRU                                          1377 07149000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1377 07150000
*       DARGSMOD=IO05MSGS;          /*                       @Y30LB35*/ 07151000
         L     @03,DDSTRU                                          1378 07152000
         MVC   DARGSMOD(3,@03),@CC03785                            1378 07153000
*       DARGSENT=MSG2370I;          /*                       @Y30LB35*/ 07154000
         L     @03,DDSTRU                                          1379 07155000
         MVI   DARGSENT(@03),X'01'                                 1379 07156000
*       DARGDBP=ADDR(USERDDN);      /*                       @Y30LB35*/ 07157000
         L     @03,@PC00001+8                                      1380 07158000
         L     @03,EXODDN(,@03)                                    1380 07159000
         L     @01,DDSTRU                                          1380 07160000
         ST    @03,DARGDBP(,@01)                                   1380 07161000
*       DARGILP=LENGTH(USERDDN);    /*                       @Y30LB35*/ 07162000
         L     @03,DDSTRU                                          1381 07163000
         MVC   DARGILP(2,@03),@CH00038                             1381 07164000
*       DARGCNT=1;                  /*                       @Y30LB35*/ 07165000
         L     @03,DDSTRU                                          1382 07166000
         MVC   DARGCNT(2,@03),@CH00222                             1382 07167000
*       DARGINS(1)=1;               /*                       @Y30LB35*/ 07168000
         L     @03,DDSTRU                                          1383 07169000
         MVC   DARGINS(2,@03),@CH00222                             1383 07170000
*       DARGINL(1)=LENGTH(TESTRC);  /*                       @Y30LB35*/ 07171000
         L     @03,DDSTRU                                          1384 07172000
         MVC   DARGINL(2,@03),@CH00036                             1384 07173000
*       DARGDTM(1)=ADDR(TESTRC);    /*                       @Y30LB35*/ 07174000
*                                                                  1385 07175000
         LA    @03,TESTRC                                          1385 07176000
         L     @01,DDSTRU                                          1385 07177000
         ST    @03,DARGDTM(,@01)                                   1385 07178000
*       /*************************************************************/ 07179000
*       /*                                                           */ 07180000
*       /* ISSUE UPRINT TO ISSUE ERROR                       @Y30LB35*/ 07181000
*       /* MESSAGE TO SYSPRINT                               @Y30LB35*/ 07182000
*       /*                                                           */ 07183000
*       /*************************************************************/ 07184000
*                                                                  1386 07185000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB35*/ 07186000
*                                                                  1386 07187000
         L     @03,@PC00001                                        1386 07188000
         ST    @03,@AL00001                                        1386 07189000
         LA    @03,@CF00119                                        1386 07190000
         ST    @03,@AL00001+4                                      1386 07191000
         LA    @03,DDSTRU                                          1386 07192000
         ST    @03,@AL00001+8                                      1386 07193000
         MVI   @AL00001+8,X'80'                                    1386 07194000
         L     @03,@PC00001                                        1386 07195000
         L     @15,GDTPRT(,@03)                                    1386 07196000
         LA    @01,@AL00001                                        1386 07197000
         BALR  @14,@15                                             1386 07198000
*       /*************************************************************/ 07199000
*       /*                                                           */ 07200000
*       /* SET ERROR CODE RCFAIL(4)                          @Y30LB35*/ 07201000
*       /*                                                           */ 07202000
*       /*************************************************************/ 07203000
*                                                                  1387 07204000
*       TESTRC=4;                   /*                       @Y30LB35*/ 07205000
         MVC   TESTRC(2),@CH00045                                  1387 07206000
*     END;                          /*                       @Y30LB35*/ 07207000
*                                                                  1388 07208000
*   /*****************************************************************/ 07209000
*   /*                                                               */ 07210000
*   /* RETURN TO BLDBLK WITH THE RETURN                      @Y30LB35*/ 07211000
*   /* CODE IN REGISTER 15 OF 0 SUCCESSFUL                   @Y30LB35*/ 07212000
*   /* OR 4 ERROR.                                           @Y30LB35*/ 07213000
*   /*                                                               */ 07214000
*   /*****************************************************************/ 07215000
*                                                                  1389 07216000
*   RETURN CODE(TESTRC);            /*                       @Y30LB35*/ 07217000
@RF01375 LH    @15,TESTRC                                          1389 07218000
         L     @14,@SA00021                                        1389 07219000
         LM    @00,@12,@SA00021+8                                  1389 07220000
         BR    @14                                                 1389 07221000
*   END READJFCB;                   /*                       @Y30LB35*/ 07222000
*                                                                  1391 07223000
*/***********************************************************@ZA11014*/ 07224000
*/*                                                          @ZA11014*/ 07225000
*/*  PROCEDURE NAME - OPENR                                  @ZA11014*/ 07226000
*/*                                                          @ZA11014*/ 07227000
*/*  FUNCTION - CALL SUBPROCEDURE BLDBLK TO SETUP IOXCTLBK   @ZA11014*/ 07228000
*/*             AND READ THE JFCB                            @ZA11014*/ 07229000
*/*             IF A VTOC HEAD REQUEST, CALL SUBPORCEDURE    @ZA11014*/ 07230000
*/*              OPNVTH TO DO A PSEUDO OPEN ON THE VTOC HEADE@ZA11014*/ 07231000
*/*             OTHERWISE ISSUE AN OPEN TYPE=J FOR THE       @ZA11014*/ 07232000
*/*              REQUESTED DATA SET OR VTOC                  @ZA11014*/ 07233000
*/*             CALL CHECKOPN TO SEE IF OPEN WAS SUCCESSFUL  @ZA11014*/ 07234000
*/*             ISSUES A MODESET TO GET INTO KEY ZERO        @ZA11014*/ 07235000
*/*             MODIFIES DEB FILE MASK AND EXTENTS IF NEEDED @ZA11014*/ 07236000
*/*             ISSUES MODESET BACK TO PROBLEM PROG KEY      @ZA11014*/ 07237000
*/*             RETURN                                       @ZA11014*/ 07238000
*/*                                                          @ZA11014*/ 07239000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 07240000
*/*                                                          @ZA11014*/ 07241000
*/*                                                          @ZA11014*/ 07242000
*/*                                                          @ZA11014*/ 07243000
*/*  INPUT - EXOREP FROM EXOARG                              @ZA11014*/ 07244000
*/*          EXOSPK FROM EXOARG                              @ZA11014*/ 07245000
*/*          EXORDS FROM EXOARG                              @ZA11014*/ 07246000
*/*          EXORVT FROM EXOARG                              @ZA11014*/ 07247000
*/*          EXOVTH FROM EXOARG                              @ZA11014*/ 07248000
*/*          EXOREAD FROM EXOARG                             @ZA11014*/ 07249000
*/*          EXODDN FROM EXOARG                              @ZA11014*/ 07250000
*/*          EXODSN FROM EXOARG                              @ZA11014*/ 07251000
*/*          EXOUCB FROM EXOARG                              @ZA11014*/ 07252000
*/*          EXOEXT FROM EXOARG                              @ZA11014*/ 07253000
*/*                                                          @ZA11014*/ 07254000
*/*  OUTPUT - EXOCTLBK IN EXOARG                             @ZA11014*/ 07255000
*/*           EXOEXT   IN EXOARG                             @ZA11014*/ 07256000
*/*           JFCBDSNM IN IOXJFCB                            @ZA11014*/ 07257000
*/*           JFCNWRIT IN IOXJFCB                            @ZA11014*/ 07258000
*/*           DCBOFLWR IN IOXDCB                             @ZA11014*/ 07259000
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/ 07260000
*/*                                                          @ZA11014*/ 07261000
*/*                                                          @ZA11014*/ 07262000
*/*                                                          @ZA11014*/ 07263000
*/***********************************************************@ZA11014*/ 07264000
*                                                                  1391 07265000
*                                   /*                       @ZA11014*/ 07266000
*OPENR:                                                            1391 07267000
*   PROC;                           /*                       @ZA11014   07268000
*                                                            @ZA11014*/ 07269000
*                                                                  1391 07270000
OPENR    STM   @14,@12,@SA00022                                    1391 07271000
*   /*****************************************************************/ 07272000
*   /*                                                               */ 07273000
*   /* SET TRACE ID                                          @ZA11014*/ 07274000
*   /*                                                               */ 07275000
*   /*****************************************************************/ 07276000
*                                                                  1392 07277000
*   OLDERID2=NEWERID2;                                             1392 07278000
         L     @03,@PC00001                                        1392 07279000
         L     @03,GDTTR2(,@03)                                    1392 07280000
         L     @15,@PC00001                                        1392 07281000
         L     @01,GDTTR2(,@15)                                    1392 07282000
         MVC   @TS00001(95),NEWERID2(@01)                          1392 07283000
         MVC   OLDERID2(95,@03),@TS00001                           1392 07284000
*   NEWID2='IOOR';                  /*                       @ZA11014   07285000
*                                                            @ZA11014*/ 07286000
*                                                                  1393 07287000
         L     @03,@PC00001                                        1393 07288000
         L     @03,GDTTR2(,@03)                                    1393 07289000
         MVC   NEWID2(4,@03),@CC04334                              1393 07290000
*   /*****************************************************************/ 07291000
*   /*                                                               */ 07292000
*   /* CALL BLDBLK TO BUILD THE IOX CONTROL BLOCK            @ZA11014*/ 07293000
*   /* AND READ THE JFCB                                     @ZA11014*/ 07294000
*   /*                                                               */ 07295000
*   /*****************************************************************/ 07296000
*                                                                  1394 07297000
*   CALL BLDBLK;                    /*                       @ZA11014*/ 07298000
         BAL   @14,BLDBLK                                          1394 07299000
*   RESPECIFY                                                      1395 07300000
*     RTNREG RSTD;                                                 1395 07301000
*   TESTRC=RTNREG;                                                 1396 07302000
         STH   RTNREG,TESTRC                                       1396 07303000
*   RESPECIFY                                                      1397 07304000
*     RTNREG UNRSTD;                /*                       @ZA11014   07305000
*                                                            @ZA11014*/ 07306000
*   IF TESTRC=0                     /*                       @ZA11014*/ 07307000
*     THEN                          /*                       @ZA11014*/ 07308000
*                                                                  1398 07309000
         LH    @03,TESTRC                                          1398 07310000
         LTR   @03,@03                                             1398 07311000
         BNZ   @RF01398                                            1398 07312000
*     /***************************************************************/ 07313000
*     /*                                                             */ 07314000
*     /* RETURN FROM BLDBLK OK-CONTINUE                      @ZA11014*/ 07315000
*     /*                                                             */ 07316000
*     /***************************************************************/ 07317000
*                                                                  1399 07318000
*     DO;                           /*                       @ZA11014*/ 07319000
*       IF EXOVTH=ON|EXORVS=ON      /*                       @ZA11014*/ 07320000
*         THEN                      /*                       @ZA11014*/ 07321000
*                                                                  1400 07322000
         L     @03,@PC00001+8                                      1400 07323000
         TM    EXOVTH(@03),B'00010001'                             1400 07324000
         BZ    @RF01400                                            1400 07325000
*         /***********************************************************/ 07326000
*         /*                                                         */ 07327000
*         /* PROCESSING VTOC HEADER                          @ZA11014*/ 07328000
*         /* SET VTOC AS INPUT TYPE AND CALL OPNVTH          @ZA11014*/ 07329000
*         /*                                                         */ 07330000
*         /***********************************************************/ 07331000
*                                                                  1401 07332000
*         DO;                       /*                       @ZA11014*/ 07333000
*           IOXTYPE=VTOCHDR;        /*                       @ZA11014*/ 07334000
         L     @03,IOCTLBKP                                        1402 07335000
         MVC   IOXTYPE(1,@03),VTOCHDR                              1402 07336000
*           CALL OPNVTH;            /*                       @ZA11014*/ 07337000
         BAL   @14,OPNVTH                                          1403 07338000
*           RESPECIFY                                              1404 07339000
*             RTNREG RSTD;                                         1404 07340000
*           TESTRC=RTNREG;                                         1405 07341000
         STH   RTNREG,TESTRC                                       1405 07342000
*           RESPECIFY                                              1406 07343000
*             RTNREG UNRSTD;        /*                       @ZA11014*/ 07344000
*         END;                      /*                       @ZA11014   07345000
*                                                            @ZA11014*/ 07346000
*       ELSE                        /*                       @ZA11014*/ 07347000
*                                                                  1408 07348000
*         /***********************************************************/ 07349000
*         /*                                                         */ 07350000
*         /* NOT VTOC HEADER-VTOC, DS OR STAGING PACK        @ZA11014*/ 07351000
*         /*                                                         */ 07352000
*         /***********************************************************/ 07353000
*                                                                  1408 07354000
*         DO;                       /*                       @ZA11014*/ 07355000
*                                                                  1408 07356000
         B     @RC01400                                            1408 07357000
@RF01400 DS    0H                                                  1409 07358000
*           /*********************************************************/ 07359000
*           /*                                                       */ 07360000
*           /* SET UP THE JFCB FOR THE OPEN                  @ZA11014*/ 07361000
*           /*                                                       */ 07362000
*           /*********************************************************/ 07363000
*                                                                  1409 07364000
*           JFCNWRIT=ON;            /*                       @ZA11014   07365000
*                                                            @ZA11014*/ 07366000
         L     @03,JFCBPTR                                         1409 07367000
         OI    JFCNWRIT(@03),B'00001000'                           1409 07368000
*           IF EXORVT=ON|EXOSPK=ON  /*                       @ZA11014*/ 07369000
*             THEN                  /*                       @ZA11014*/ 07370000
*                                                                  1410 07371000
         L     @03,@PC00001+8                                      1410 07372000
         TM    EXORVT(@03),B'00001010'                             1410 07373000
         BZ    @RF01410                                            1410 07374000
*             /*******************************************************/ 07375000
*             /*                                                     */ 07376000
*             /* WORKING ON VTOC                             @ZA11014*/ 07377000
*             /* SET INPUT TYPE AND JFCB TO VTOC             @ZA11014*/ 07378000
*             /*                                                     */ 07379000
*             /*******************************************************/ 07380000
*                                                                  1411 07381000
*             DO;                   /*                       @ZA11014*/ 07382000
*               IOXTYPE=VTOC;       /*                       @ZA11014*/ 07383000
         L     @03,IOCTLBKP                                        1412 07384000
         MVC   IOXTYPE(1,@03),VTOC                                 1412 07385000
*               JFCBDSNM=VTOCDSN;   /*                       @ZA11014*/ 07386000
         L     @03,JFCBPTR                                         1413 07387000
         MVC   JFCBDSNM(44,@03),VTOCDSN                            1413 07388000
*             END;                  /*                       @ZA11014   07389000
*                                                            @ZA11014*/ 07390000
*           ELSE                    /*                       @ZA11014*/ 07391000
*                                                                  1415 07392000
*             /*******************************************************/ 07393000
*             /*                                                     */ 07394000
*             /* DATA SET REQUEST                            @ZA11014*/ 07395000
*             /*                                                     */ 07396000
*             /*******************************************************/ 07397000
*                                                                  1415 07398000
*             DO;                   /*                       @ZA11014*/ 07399000
         B     @RC01410                                            1415 07400000
@RF01410 DS    0H                                                  1416 07401000
*               IOXTYPE=REPDS;      /*                       @ZA11014*/ 07402000
         L     @03,IOCTLBKP                                        1416 07403000
         MVC   IOXTYPE(1,@03),REPDS                                1416 07404000
*               JFCBDSNM=USERDSN;   /*                       @ZA11014*/ 07405000
         L     @03,JFCBPTR                                         1417 07406000
         L     @15,@PC00001+8                                      1417 07407000
         L     @01,EXODSN(,@15)                                    1417 07408000
         MVC   JFCBDSNM(44,@03),USERDSN(@01)                       1417 07409000
*             END;                  /*                       @ZA11014   07410000
*                                                            @ZA11014   07411000
*                                                            @ZA11014*/ 07412000
*                                                                  1418 07413000
*           /*********************************************************/ 07414000
*           /*                                                       */ 07415000
*           /* SET UP FOR OPEN                               @ZA11014*/ 07416000
*           /*                                                       */ 07417000
*           /*********************************************************/ 07418000
*                                                                  1419 07419000
*           RESPECIFY                                              1419 07420000
*            (REG1,                                                1419 07421000
*             REG3) RSTD;           /*                       @ZA11014*/ 07422000
@RC01410 DS    0H                                                  1420 07423000
*           PARMLIST=''B;           /*                       @ZA11014*/ 07424000
         XC    PARMLIST(20),PARMLIST                               1420 07425000
*           PARMLIST=OPENLIST;      /*                       @ZA11014*/ 07426000
         MVI   PARMLIST+8,C' '                                     1421 07427000
         MVC   PARMLIST+9(11),PARMLIST+8                           1421 07428000
         MVC   PARMLIST(8),OPENLIST                                1421 07429000
*           REG3=ADDR(IOXDCB);      /*                       @ZA11014*/ 07430000
         L     REG3,IOCTLBKP                                       1422 07431000
         LA    REG3,IOXDCB(,REG3)                                  1422 07432000
*           REG1=ADDR(PARMLIST);    /*                       @ZA11014   07433000
*                                                            @ZA11014*/ 07434000
         LA    REG1,PARMLIST                                       1423 07435000
*           IF EXOREAD=ON           /*                       @ZA11014*/ 07436000
*             THEN                  /*                       @ZA11014*/ 07437000
*                                                                  1424 07438000
         L     @15,@PC00001+8                                      1424 07439000
         TM    EXOREAD(@15),B'10000000'                            1424 07440000
         BNO   @RF01424                                            1424 07441000
*             /*******************************************************/ 07442000
*             /*                                                     */ 07443000
*             /* OPEN FOR READ ONLY                          @ZA11014*/ 07444000
*             /*                                                     */ 07445000
*             /*******************************************************/ 07446000
*                                                                  1425 07447000
*LRVOPN1:                                                          1425 07448000
*             GEN(OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J);/*     1425 07449000
*                                                            @ZA11014*/ 07450000
LRVOPN1  OPEN ((REG3),INPUT),MF=(E,(REG1)),TYPE=J                       07451000
*           ELSE                    /*                       @ZA11014*/ 07452000
*                                                                  1426 07453000
*             /*******************************************************/ 07454000
*             /*                                                     */ 07455000
*             /* OPEN FOR OUTPUT                             @ZA11014*/ 07456000
*             /*                                                     */ 07457000
*             /*******************************************************/ 07458000
*                                                                  1426 07459000
*LRVOPN2:                                                          1426 07460000
*             GEN(OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J);/*    1426 07461000
*                                                            @ZA11014*/ 07462000
         B     @RC01424                                            1426 07463000
@RF01424 DS    0H                                                  1426 07464000
LRVOPN2  OPEN ((REG3),OUTPUT),MF=(E,(REG1)),TYPE=J                      07465000
*           RESPECIFY                                              1427 07466000
*            (REG1,                                                1427 07467000
*             REG3) UNRSTD;         /*                       @ZA11014   07468000
*                                                            @ZA11014*/ 07469000
*                                                                  1427 07470000
@RC01424 DS    0H                                                  1428 07471000
*           /*********************************************************/ 07472000
*           /*                                                       */ 07473000
*           /* CHECK TO SEE IF OPEN WENT OK                  @ZA11014*/ 07474000
*           /*                                                       */ 07475000
*           /*********************************************************/ 07476000
*                                                                  1428 07477000
*           CALL CHECKOPN;          /*                       @ZA11014*/ 07478000
         BAL   @14,CHECKOPN                                        1428 07479000
*           RESPECIFY                                              1429 07480000
*             RTNREG RSTD;                                         1429 07481000
*           TESTRC=RTNREG;                                         1430 07482000
         STH   RTNREG,TESTRC                                       1430 07483000
*           RESPECIFY                                              1431 07484000
*             RTNREG UNRSTD;        /*                       @ZA11014   07485000
*                                                            @ZA11014*/ 07486000
*                                                                  1432 07487000
*           /*********************************************************/ 07488000
*           /*                                                       */ 07489000
*           /* CONTINUE PROCESSING IF OPEN WAS OK            @ZA11014*/ 07490000
*           /*                                                       */ 07491000
*           /*********************************************************/ 07492000
*                                                                  1432 07493000
*           IF TESTRC=0             /*                       @ZA11014*/ 07494000
*             THEN                  /*                       @ZA11014*/ 07495000
         LH    @03,TESTRC                                          1432 07496000
         LTR   @03,@03                                             1432 07497000
         BNZ   @RF01432                                            1432 07498000
*             DO;                   /*                       @ZA11014   07499000
*                                                            @ZA11014*/ 07500000
*                                                                  1433 07501000
*               /*****************************************************/ 07502000
*               /*                                                   */ 07503000
*               /* SET UP ADDRESSABILITY TO CONTROL BLOCKS   @ZA11014*/ 07504000
*               /*                                                   */ 07505000
*               /*****************************************************/ 07506000
*                                                                  1434 07507000
*               DCBPTR=ADDR(IOXDCB);/*                       @ZA11014*/ 07508000
         L     @03,IOCTLBKP                                        1434 07509000
         LA    @03,IOXDCB(,@03)                                    1434 07510000
         ST    @03,DCBPTR                                          1434 07511000
*               DEBPTR=DCBDEBAD;    /*                       @ZA11014*/ 07512000
         L     @03,DCBPTR                                          1435 07513000
         L     @03,DCBDEBAD+40(,@03)                               1435 07514000
         ST    @03,DEBPTR                                          1435 07515000
*               DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);/*  @ZA11014*/ 07516000
         LA    @03,32                                              1436 07517000
         AL    @03,DEBPTR                                          1436 07518000
         ST    @03,DEBDAPTR                                        1436 07519000
*               IOBSTPTR=ADDR(IOXIOB);/*                     @ZA11014   07520000
*                                                            @ZA11014*/ 07521000
*                                                                  1437 07522000
         L     @03,IOCTLBKP                                        1437 07523000
         LA    @03,IOXIOB(,@03)                                    1437 07524000
         ST    @03,IOBSTPTR                                        1437 07525000
*               /*****************************************************/ 07526000
*               /*                                                   */ 07527000
*               /* INITIALIZE IOB SEEK AREA                  @ZA11014*/ 07528000
*               /*                                                   */ 07529000
*               /*****************************************************/ 07530000
*                                                                  1438 07531000
*               IOBSEEK=''B;        /*                       @ZA11014   07532000
*                                                            @ZA11014*/ 07533000
*                                                                  1438 07534000
         L     @03,IOBSTPTR                                        1438 07535000
         XC    IOBSEEK(8,@03),IOBSEEK(@03)                         1438 07536000
*               /*****************************************************/ 07537000
*               /*                                                   */ 07538000
*               /* PREVENT CLOSE FROM WRITING EOF            @ZA11014*/ 07539000
*               /*                                                   */ 07540000
*               /*****************************************************/ 07541000
*                                                                  1439 07542000
*               DCBOFLWR=OFF;       /*                       @ZA11014   07543000
*                                                            @ZA11014   07544000
*                                                            @ZA11014*/ 07545000
*                                                                  1439 07546000
         L     @03,DCBPTR                                          1439 07547000
         NI    DCBOFLWR+40(@03),B'01111111'                        1439 07548000
*               /*****************************************************/ 07549000
*               /*                                                   */ 07550000
*               /* SET IOB EXTENT VALUE TO ZERO              @ZA11014*/ 07551000
*               /*                                                   */ 07552000
*               /*****************************************************/ 07553000
*                                                                  1440 07554000
*               IOBM=ZERO;          /*                       @ZA11014   07555000
*                                                            @ZA11014   07556000
*                                                            @ZA11014*/ 07557000
*                                                                  1440 07558000
         LH    @03,ZERO                                            1440 07559000
         L     @01,IOBSTPTR                                        1440 07560000
         STC   @03,IOBM(,@01)                                      1440 07561000
*               /*****************************************************/ 07562000
*               /*                                                   */ 07563000
*               /* SET UP AND ISSUE MODESET TO GET INTO KEY ZERO     */ 07564000
*               /*                                           @ZA11014*/ 07565000
*               /*                                                   */ 07566000
*               /*****************************************************/ 07567000
*                                                                  1441 07568000
*               MODEPARM=''B;       /*                       @ZA11014*/ 07569000
         XC    MODEPARM(4),MODEPARM                                1441 07570000
*               MODEPARM=MOD1;      /*                       @ZA11014*/ 07571000
         L     @03,MOD1                                            1442 07572000
         ST    @03,MODEPARM                                        1442 07573000
*               RESPECIFY                                          1443 07574000
*                (REG1,                                            1443 07575000
*                 REG3) RSTD;       /*                       @ZA11014*/ 07576000
*               REG3=MODEPARM;      /*                       @ZA11014*/ 07577000
         L     REG3,MODEPARM                                       1444 07578000
*LRVMODE1:                                                         1445 07579000
*               DO;                 /* MODESET MF(E,REG3)            */ 07580000
LRVMODE1 DS    0H                                                  1446 07581000
*                 RESPECIFY                                        1446 07582000
*                   GPR01F RESTRICTED;                             1446 07583000
*                 GPR01F=REG3;      /* MODESET PARMLIST              */ 07584000
         LR    GPR01F,REG3                                         1447 07585000
*                 SVC(107);         /* ISSUE MODESET SVC             */ 07586000
         SVC   107                                                 1448 07587000
*                 RESPECIFY                                        1449 07588000
*                  (GPR01F) UNRESTRICTED;                          1449 07589000
*               END;                /* MODESET MF(E,REG3)    @ZA11014   07590000
*                                                            @ZA11014*/ 07591000
*                                                                  1450 07592000
*               /*****************************************************/ 07593000
*               /*                                                   */ 07594000
*               /* SET FILE MASK TO INHIBIT HEAD SWITCHING   @ZA11014*/ 07595000
*               /* WE ARE ALWAYS IN THE FIRST EXTENT         @ZA11014*/ 07596000
*               /*                                                   */ 07597000
*               /*****************************************************/ 07598000
*                                                                  1451 07599000
*               DEBDVMOD=DEBDVMOD|INHDFLMK;/*                @ZA11014   07600000
*                                                            @ZA11014*/ 07601000
*                                                                  1451 07602000
         L     @15,DEBDAPTR                                        1451 07603000
         OC    DEBDVMOD(1,@15),INHDFLMK                            1451 07604000
*               /*****************************************************/ 07605000
*               /*                                                   */ 07606000
*               /* IF A DATA SET REQUEST, SET DEB EXTENT     @ZA11014*/ 07607000
*               /* EQUAL TO THE EXTENT ENTRY SENT BY CALLER  @ZA11014*/ 07608000
*               /* IT MAPS INTO THE XTNT TABLE ENTRY BUILD   @ZA11014*/ 07609000
*               /* BY REPAIRV                                @ZA11014*/ 07610000
*               /*                                                   */ 07611000
*               /*****************************************************/ 07612000
*                                                                  1452 07613000
*               IF EXORDS=ON        /*                       @ZA11014*/ 07614000
*                 THEN              /*                       @ZA11014*/ 07615000
         L     @15,@PC00001+8                                      1452 07616000
         TM    EXORDS(@15),B'00000100'                             1452 07617000
         BNO   @RF01452                                            1452 07618000
*                 DO;               /*                       @ZA11014*/ 07619000
*                   DEBSTRCC=VSMBCC;/*                       @ZA11014*/ 07620000
         L     @15,@PC00001+8                                      1454 07621000
         L     @15,EXOEXT(,@15)                                    1454 07622000
         LH    @00,VSMBCC(,@15)                                    1454 07623000
         L     @15,DEBDAPTR                                        1454 07624000
         STH   @00,DEBSTRCC(,@15)                                  1454 07625000
*                   DEBSTRHH=VSMBHH;/*                       @ZA11014*/ 07626000
         L     @15,@PC00001+8                                      1455 07627000
         L     @15,EXOEXT(,@15)                                    1455 07628000
         LH    @00,VSMBHH(,@15)                                    1455 07629000
         L     @15,DEBDAPTR                                        1455 07630000
         STH   @00,DEBSTRHH(,@15)                                  1455 07631000
*                   DEBENDCC=VSMECC;/*                       @ZA11014*/ 07632000
         L     @15,@PC00001+8                                      1456 07633000
         L     @15,EXOEXT(,@15)                                    1456 07634000
         LH    @00,VSMECC(,@15)                                    1456 07635000
         L     @15,DEBDAPTR                                        1456 07636000
         STH   @00,DEBENDCC(,@15)                                  1456 07637000
*                   DEBENDHH=VSMEHH;/*                       @ZA11014*/ 07638000
         L     @15,@PC00001+8                                      1457 07639000
         L     @15,EXOEXT(,@15)                                    1457 07640000
         LH    @00,VSMEHH(,@15)                                    1457 07641000
         L     @15,DEBDAPTR                                        1457 07642000
         STH   @00,DEBENDHH(,@15)                                  1457 07643000
*                   DEBNMTRK=VSMEHH-VSMBHH+1;/*              @ZA11014*/ 07644000
         L     @15,@PC00001+8                                      1458 07645000
         L     @15,EXOEXT(,@15)                                    1458 07646000
         L     @14,@PC00001+8                                      1458 07647000
         L     @14,EXOEXT(,@14)                                    1458 07648000
         LH    @00,VSMEHH(,@15)                                    1458 07649000
         SH    @00,VSMBHH(,@14)                                    1458 07650000
         AL    @00,@CF00222                                        1458 07651000
         L     @15,DEBDAPTR                                        1458 07652000
         STH   @00,DEBNMTRK(,@15)                                  1458 07653000
*                 END;              /*                       @ZA11014   07654000
*                                                            @ZA11014*/ 07655000
*                                                                  1459 07656000
*               /*****************************************************/ 07657000
*               /*                                                   */ 07658000
*               /* RESTRICT ACCESS TO ONE CYLINDER IF STAGING        */ 07659000
*               /*                                           @ZA11014*/ 07660000
*               /* PACK REQUEST - ALWAYS FIRST EXTENT        @ZA11014*/ 07661000
*               /*                                                   */ 07662000
*               /*****************************************************/ 07663000
*                                                                  1460 07664000
*               IF EXOSPK=ON        /*                       @ZA11014*/ 07665000
*                 THEN              /*                       @ZA11014*/ 07666000
*                                                                  1460 07667000
@RF01452 L     @15,@PC00001+8                                      1460 07668000
         TM    EXOSPK(@15),B'00001000'                             1460 07669000
         BNO   @RF01460                                            1460 07670000
*                 /***************************************************/ 07671000
*                 /*                                                 */ 07672000
*                 /* SET CYLINDER ADDRESS FROM INPUT IN      @ZA11014*/ 07673000
*                 /* EXOEXT-TRACKS RUN FROM ZERO TO MAX      @ZA11014*/ 07674000
*                 /* SPECIFIED IN EXOEXT                     @ZA11014*/ 07675000
*                 /*                                                 */ 07676000
*                 /***************************************************/ 07677000
*                                                                  1461 07678000
*                 DO;               /*                       @ZA11014*/ 07679000
*                   DEBSTRCC=BEGCC; /*                       @ZA11014*/ 07680000
         L     @15,DEBDAPTR                                        1462 07681000
         L     @14,@PC00001+8                                      1462 07682000
         L     @14,EXOEXT(,@14)                                    1462 07683000
         MVC   DEBSTRCC(2,@15),BEGCC(@14)                          1462 07684000
*                   DEBSTRHH=ZERO;  /*                       @ZA11014*/ 07685000
         LH    @00,ZERO                                            1463 07686000
         L     @15,DEBDAPTR                                        1463 07687000
         STH   @00,DEBSTRHH(,@15)                                  1463 07688000
*                   DEBENDCC=BEGCC; /*                       @ZA11014*/ 07689000
         L     @15,DEBDAPTR                                        1464 07690000
         L     @14,@PC00001+8                                      1464 07691000
         L     @14,EXOEXT(,@14)                                    1464 07692000
         MVC   DEBENDCC(2,@15),BEGCC(@14)                          1464 07693000
*                   DEBENDHH=BEGHH; /*                       @ZA11014*/ 07694000
         L     @15,DEBDAPTR                                        1465 07695000
         L     @14,@PC00001+8                                      1465 07696000
         L     @14,EXOEXT(,@14)                                    1465 07697000
         MVC   DEBENDHH(2,@15),BEGHH(@14)                          1465 07698000
*                   DEBNMTRK=DEBENDHH-DEBSTRHH+1;/*          @ZA11014*/ 07699000
         L     @15,DEBDAPTR                                        1466 07700000
         LH    @00,DEBENDHH(,@15)                                  1466 07701000
         N     @00,@CF04424                                        1466 07702000
         L     @15,DEBDAPTR                                        1466 07703000
         LH    @15,DEBSTRHH(,@15)                                  1466 07704000
         N     @15,@CF04424                                        1466 07705000
         SLR   @00,@15                                             1466 07706000
         AL    @00,@CF00222                                        1466 07707000
         L     @15,DEBDAPTR                                        1466 07708000
         STH   @00,DEBNMTRK(,@15)                                  1466 07709000
*                 END;              /*                       @ZA11014   07710000
*                                                            @ZA11014*/ 07711000
*                                                                  1467 07712000
*               /*****************************************************/ 07713000
*               /*                                                   */ 07714000
*               /* RETURN TO PROBLEM PROG KEY                @ZA11014*/ 07715000
*               /*                                                   */ 07716000
*               /*****************************************************/ 07717000
*                                                                  1468 07718000
*               MODEPARM=''B;       /*                       @ZA11014*/ 07719000
@RF01460 XC    MODEPARM(4),MODEPARM                                1468 07720000
*               MODEPARM=MOD2;      /*                       @ZA11014*/ 07721000
         L     @00,MOD2                                            1469 07722000
         ST    @00,MODEPARM                                        1469 07723000
*               REG3=MODEPARM;      /*                       @ZA11014*/ 07724000
         L     REG3,MODEPARM                                       1470 07725000
*LRVMODE2:                                                         1471 07726000
*               DO;                 /* MODESET MF(E,REG3)            */ 07727000
LRVMODE2 DS    0H                                                  1472 07728000
*                 RESPECIFY                                        1472 07729000
*                   GPR01F RESTRICTED;                             1472 07730000
*                 GPR01F=REG3;      /* MODESET PARMLIST              */ 07731000
         LR    GPR01F,REG3                                         1473 07732000
*                 SVC(107);         /* ISSUE MODESET SVC             */ 07733000
         SVC   107                                                 1474 07734000
*                 RESPECIFY                                        1475 07735000
*                  (GPR01F) UNRESTRICTED;                          1475 07736000
*               END;                /* MODESET MF(E,REG3)    @ZA11014*/ 07737000
*               RESPECIFY                                          1477 07738000
*                (REG1,                                            1477 07739000
*                 REG3) UNRSTD;     /*                       @ZA11014*/ 07740000
*               RESPECIFY                                          1478 07741000
*                (REG1) UNRSTD;     /*                       @ZA11014*/ 07742000
*                                                                  1478 07743000
*               /*****************************************************/ 07744000
*               /*                                                   */ 07745000
*               /* SET RETURN CODE TO OK                     @ZA11014*/ 07746000
*               /*                                                   */ 07747000
*               /*****************************************************/ 07748000
*                                                                  1479 07749000
*               TESTRC=0;           /*                       @ZA11014   07750000
*                                                            @ZA11014*/ 07751000
         SLR   @03,@03                                             1479 07752000
         STH   @03,TESTRC                                          1479 07753000
*             END;                  /* RC OK CHECKOPN        @ZA11014*/ 07754000
*         END;                      /* NOT VTOC HDR REQ      @ZA11014*/ 07755000
@RF01432 DS    0H                                                  1482 07756000
*     END;                          /* RC OK TO BLDBLK       @ZA11014*/ 07757000
*                                                                  1482 07758000
@RC01400 DS    0H                                                  1483 07759000
*   /*****************************************************************/ 07760000
*   /*                                                               */ 07761000
*   /* HERE THE TEST IS MADE TO DETERMINE WHETHER            @ZA11014*/ 07762000
*   /* THE OPEN WAS SUCCESSFUL OR NOT. IF NOT                @ZA11014*/ 07763000
*   /* THE CONTROL BLOCK IS FREED UP AND THE                 @ZA11014*/ 07764000
*   /* IOXCTLBK POINTER FIELD IS ZEROED IN THE               @ZA11014*/ 07765000
*   /* CALLER'S CORE.                                        @ZA11014*/ 07766000
*   /*                                                               */ 07767000
*   /*****************************************************************/ 07768000
*                                                                  1483 07769000
*   IF TESTRC^=0&USERIOBP^=NULLPTR  /*                       @ZA11014*/ 07770000
*     THEN                          /*                       @ZA11014*/ 07771000
@RF01398 LH    @03,TESTRC                                          1483 07772000
         LTR   @03,@03                                             1483 07773000
         BZ    @RF01483                                            1483 07774000
         L     @03,@PC00001+8                                      1483 07775000
         L     @03,EXOCTLBK(,@03)                                  1483 07776000
         L     @03,USERIOBP(,@03)                                  1483 07777000
         LTR   @03,@03                                             1483 07778000
         BZ    @RF01483                                            1483 07779000
*     DO;                           /*                       @ZA11014*/ 07780000
*       CALL IDCSAFS0(GDTTBL,IOCTLBKP);/*                    @ZA11014*/ 07781000
         L     @03,@PC00001                                        1485 07782000
         ST    @03,@AL00001                                        1485 07783000
         LA    @03,IOCTLBKP                                        1485 07784000
         ST    @03,@AL00001+4                                      1485 07785000
         L     @03,@PC00001                                        1485 07786000
         L     @15,GDTFSP(,@03)                                    1485 07787000
         LA    @01,@AL00001                                        1485 07788000
         BALR  @14,@15                                             1485 07789000
*       USERIOBP=NULLPTR;           /*                       @ZA11014*/ 07790000
         L     @03,@PC00001+8                                      1486 07791000
         L     @03,EXOCTLBK(,@03)                                  1486 07792000
         SLR   @15,@15                                             1486 07793000
         ST    @15,USERIOBP(,@03)                                  1486 07794000
*     END;                          /*                       @ZA11014*/ 07795000
*                                                                  1487 07796000
*   /*****************************************************************/ 07797000
*   /*                                                               */ 07798000
*   /* IF THE OPEN IS SUCCESSFUL, THEN IT IS                 @ZA11014*/ 07799000
*   /* PUT IN THE FRONT OF IODIOX CHAIN AND                  @ZA11014*/ 07800000
*   /* THE IOXOPN IS SET ON TO INDICATE THAT THE             @ZA11014*/ 07801000
*   /* DCB HAS BEEN OPENED.                                  @ZA11014*/ 07802000
*   /*                                                               */ 07803000
*   /*****************************************************************/ 07804000
*                                                                  1488 07805000
*   IF TESTRC=0                     /*                       @ZA11014*/ 07806000
*     THEN                          /*                       @ZA11014*/ 07807000
@RF01483 LH    @03,TESTRC                                          1488 07808000
         LTR   @03,@03                                             1488 07809000
         BNZ   @RF01488                                            1488 07810000
*     DO;                           /*                       @ZA11014*/ 07811000
*       IOXCHAIN=IODIOX;            /*                       @ZA11014*/ 07812000
         L     @03,@PC00001                                        1490 07813000
         L     @03,GDTIOH(,@03)                                    1490 07814000
         L     @03,IODIOX(,@03)                                    1490 07815000
         L     @01,IOCTLBKP                                        1490 07816000
         ST    @03,IOXCHAIN(,@01)                                  1490 07817000
*       IODIOX=ADDR(IOXCTLBK);      /*                       @ZA11014*/ 07818000
         L     @03,@PC00001                                        1491 07819000
         L     @03,GDTIOH(,@03)                                    1491 07820000
         L     @15,IOCTLBKP                                        1491 07821000
         ST    @15,IODIOX(,@03)                                    1491 07822000
*       IOXOPN=ON;                  /*                       @ZA11014*/ 07823000
         L     @03,IOCTLBKP                                        1492 07824000
         OI    IOXOPN(@03),B'10000000'                             1492 07825000
*     END;                          /*                       @ZA11014*/ 07826000
*                                                                  1493 07827000
*   /*****************************************************************/ 07828000
*   /*                                                               */ 07829000
*   /* CONTROL IS RETURNED TO IDCIO05 - THE                  @ZA11014*/ 07830000
*   /* MAIN PROCEDURE. THE RETURN CODE PASSED                @ZA11014*/ 07831000
*   /* IS THE RETURN CODE FROM THE OPEN                      @ZA11014*/ 07832000
*   /*                                                               */ 07833000
*   /*****************************************************************/ 07834000
*                                                                  1494 07835000
*                                   /*                       @ZA11014*/ 07836000
*   RETURN CODE(TESTRC);            /*                       @ZA11014   07837000
*                                                            @ZA11014*/ 07838000
@RF01488 LH    @15,TESTRC                                          1494 07839000
         L     @14,@SA00022                                        1494 07840000
         LM    @00,@12,@SA00022+8                                  1494 07841000
         BR    @14                                                 1494 07842000
*   END OPENR;                      /*                       @ZA11014   07843000
*                                                            @ZA11014   07844000
*                                                            @ZA11014   07845000
*                                                            @ZA11014   07846000
*                                                            @ZA11014   07847000
*                                                            @ZA11014   07848000
*                                                            @ZA11014   07849000
*                                                            @ZA11014   07850000
*                                                            @ZA11014   07851000
*                                                            @ZA11014   07852000
*                                                            @ZA11014   07853000
*                                                            @ZA11014   07854000
*                                                            @ZA11014   07855000
*                                                            @ZA11014   07856000
*                                                            @ZA11014   07857000
*                                                            @ZA11014   07858000
*                                                            @ZA11014   07859000
*                                                            @ZA11014   07860000
*                                                            @ZA11014   07861000
*                                                            @ZA11014   07862000
*                                                            @ZA11014   07863000
*                                                            @ZA11014   07864000
*                                                            @ZA11014   07865000
*                                                            @ZA11014   07866000
*                                                            @ZA11014*/ 07867000
*                                                                  1496 07868000
*/***********************************************************@ZA11014*/ 07869000
*/*                                                          @ZA11014*/ 07870000
*/*  PROCEDURE NAME - READCNT                                @ZA11014*/ 07871000
*/*                                                          @ZA11014*/ 07872000
*/*  FUNCTION - IF FIRST TIME CALLS SUBPROCEDURE SETCCW      @ZA11014*/ 07873000
*/*              TO BUILD A CCW LIST TO READ THE COUNT FIELDS@ZA11014*/ 07874000
*/*              FOR THE RECORDS ON THE REQUESTED TRACK,     @ZA11014*/ 07875000
*/*              AND INITIALIZES COUNTERS                    @ZA11014*/ 07876000
*/*             CALLS SUBPROCEDURE ISSUEXCP TO DO I/O        @ZA11014*/ 07877000
*/*             CALCULATES THE NUMBER OF RECORDS READ        @ZA11014*/ 07878000
*/*             DETERMINES IF ANY REOCRD NUMBERS ARE MISSING @ZA11014*/ 07879000
*/*             SETS THE COUNT RETURN CODES IN THE LOCATION  @ZA11014*/ 07880000
*/*              TABLE ENTRIES FOR THE COUNTS READ THIS CALL @ZA11014*/ 07881000
*/*             RETURNS                                      @ZA11014*/ 07882000
*/*                                                          @ZA11014*/ 07883000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 07884000
*/*                                                          @ZA11014*/ 07885000
*/*                                                          @ZA11014*/ 07886000
*/*                                                          @ZA11014*/ 07887000
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/ 07888000
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/ 07889000
*/*          EXCC     FROM EXWRARG                           @ZA11014*/ 07890000
*/*          EXHH     FROM EXWRARG                           @ZA11014*/ 07891000
*/*          EXSPACE  FROM EXWRARG                           @ZA11014*/ 07892000
*/*                                                          @ZA11014*/ 07893000
*/*  OUTPUT - EXCCWCNT IN EXWRARG                            @ZA11014*/ 07894000
*/*           EXSPACE IN EXWRARG                             @ZA11014*/ 07895000
*/*           COUNT FIELD IN RBUFF OF RIOAREA                @ZA11014*/ 07896000
*/*           COUNT FIELD RETURN CODES IN LOCATION TABLE     @ZA11014*/ 07897000
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/ 07898000
*/*                                                          @ZA11014*/ 07899000
*/*                                                          @ZA11014*/ 07900000
*/*                                                          @ZA11014*/ 07901000
*/***********************************************************@ZA11014*/ 07902000
*                                                                  1496 07903000
*                                   /*                       @ZA11014*/ 07904000
*READCNT:                                                          1496 07905000
*   PROC;                           /*                       @ZA11014*/ 07906000
*                                                                  1496 07907000
READCNT  STM   @14,@12,@SA00023                                    1496 07908000
*   /*****************************************************************/ 07909000
*   /*                                                               */ 07910000
*   /* SET UP TRACE POINT 'IOCT' IN TRACE TABLE              @ZA11014*/ 07911000
*   /*                                                               */ 07912000
*   /*****************************************************************/ 07913000
*                                                                  1497 07914000
*   OLDERID2=NEWERID2;                                             1497 07915000
         L     @03,@PC00001                                        1497 07916000
         L     @03,GDTTR2(,@03)                                    1497 07917000
         L     @15,@PC00001                                        1497 07918000
         L     @01,GDTTR2(,@15)                                    1497 07919000
         MVC   @TS00001(95),NEWERID2(@01)                          1497 07920000
         MVC   OLDERID2(95,@03),@TS00001                           1497 07921000
*   NEWID2='IOCT';                  /*                       @ZA11014   07922000
*                                                            @ZA11014*/ 07923000
*                                                                  1498 07924000
         L     @03,@PC00001                                        1498 07925000
         L     @03,GDTTR2(,@03)                                    1498 07926000
         MVC   NEWID2(4,@03),@CC04347                              1498 07927000
*   /*****************************************************************/ 07928000
*   /*                                                               */ 07929000
*   /* SET UP ADDRESSABILITY TO IOXCTLBK AND RIOAREA         @ZA11014*/ 07930000
*   /*                                                               */ 07931000
*   /*****************************************************************/ 07932000
*                                                                  1499 07933000
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/ 07934000
         L     @03,@PC00001+8                                      1499 07935000
         L     @03,EXRWCTBL(,@03)                                  1499 07936000
         ST    @03,IOCTLBKP                                        1499 07937000
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014   07938000
*                                                            @ZA11014*/ 07939000
*                                                                  1500 07940000
         L     @03,@PC00001+8                                      1500 07941000
         L     @03,EXRWIOAR(,@03)                                  1500 07942000
         ST    @03,RRIOARPT                                        1500 07943000
*   /*****************************************************************/ 07944000
*   /*                                                               */ 07945000
*   /* DETERMINE IF THIS IS THE FST TIME                     @ZA11014*/ 07946000
*   /*                                                               */ 07947000
*   /*****************************************************************/ 07948000
*                                                                  1501 07949000
*   IF RFIRST=FSTIME                /*                       @ZA11014*/ 07950000
*     THEN                          /*                       @ZA11014   07951000
*                                                            @ZA11014*/ 07952000
*                                                                  1501 07953000
         L     @03,RRIOARPT                                        1501 07954000
         CLC   RFIRST(1,@03),FSTIME                                1501 07955000
         BNE   @RF01501                                            1501 07956000
*     /***************************************************************/ 07957000
*     /*                                                             */ 07958000
*     /* IF THIS IS FIRST TIME, SET UP CCW CHAIN             @ZA11014*/ 07959000
*     /*                                                             */ 07960000
*     /***************************************************************/ 07961000
*                                                                  1502 07962000
*     DO;                           /*                       @ZA11014*/ 07963000
*       RFIRST=NTFSTIME;            /*                       @ZA11014*/ 07964000
         IC    @03,NTFSTIME                                        1503 07965000
         L     @01,RRIOARPT                                        1503 07966000
         STC   @03,RFIRST(,@01)                                    1503 07967000
*       CALL SETCCW;                /*                       @ZA11014*/ 07968000
         BAL   @14,SETCCW                                          1504 07969000
*       RESPECIFY                                                  1505 07970000
*         RTNREG RSTD;                                             1505 07971000
*       TESTRC=RTNREG;                                             1506 07972000
         STH   RTNREG,TESTRC                                       1506 07973000
*       RESPECIFY                                                  1507 07974000
*         RTNREG UNRSTD;            /*                       @ZA11014   07975000
*                                                            @ZA11014*/ 07976000
*                                                                  1507 07977000
*       /*************************************************************/ 07978000
*       /*                                                           */ 07979000
*       /* INITIALIZE LOCATION TABLE ENTRIES TO ZERO         @ZA11014*/ 07980000
*       /*                                                           */ 07981000
*       /*************************************************************/ 07982000
*                                                                  1508 07983000
*       DO RCTR=1 TO LOCENT;        /*                       @ZA11014*/ 07984000
         LA    @03,1                                               1508 07985000
         B     @DE01508                                            1508 07986000
@DL01508 DS    0H                                                  1509 07987000
*         LOCTAB(RCTR)=LOCTAB(RCTR)&&LOCTAB(RCTR);/*         @ZA11014*/ 07988000
         LH    @03,RCTR                                            1509 07989000
         MH    @03,@CH00279                                        1509 07990000
         L     @15,@PC00001+8                                      1509 07991000
         L     @01,EXLOCPTR(,@15)                                  1509 07992000
         ALR   @01,@03                                             1509 07993000
         AL    @01,@CF04425                                        1509 07994000
         XC    LOCTAB(20,@01),LOCTAB(@01)                          1509 07995000
*       END;                        /*                       @ZA11014   07996000
*                                                            @ZA11014*/ 07997000
*                                                                  1510 07998000
         LA    @03,1                                               1510 07999000
         AH    @03,RCTR                                            1510 08000000
@DE01508 STH   @03,RCTR                                            1510 08001000
         CH    @03,LOCENT                                          1510 08002000
         BNH   @DL01508                                            1510 08003000
*       /*************************************************************/ 08004000
*       /*                                                           */ 08005000
*       /* SET LOCATION TABLE ADDR OF RECORD ZERO            @ZA20252*/ 08006000
*       /* TO THE BEGINNING OF THE BUFFER                    @ZA20252*/ 08007000
*       /*                                                           */ 08008000
*       /*************************************************************/ 08009000
*                                                                  1511 08010000
*                                   /*                       @ZA20252*/ 08011000
*       LOCADDR(1)=ADDR(RBUFF);     /*                       @ZA20252   08012000
*                                                            @ZA20252*/ 08013000
*                                                                  1511 08014000
         L     @03,@PC00001+8                                      1511 08015000
         L     @03,EXLOCPTR(,@03)                                  1511 08016000
         L     @01,RRIOARPT                                        1511 08017000
         LA    @15,RBUFF(,@01)                                     1511 08018000
         ST    @15,LOCADDR(,@03)                                   1511 08019000
*       /*************************************************************/ 08020000
*       /*                                                           */ 08021000
*       /* INITIALIZE LAST RECORD NUM                        @ZA11014*/ 08022000
*       /*                                                           */ 08023000
*       /*************************************************************/ 08024000
*                                                                  1512 08025000
*       LSTRECNM=1;                 /*                       @ZA11014   08026000
*                                                            @ZA11014*/ 08027000
*                                                                  1512 08028000
         L     @03,@PC00001+8                                      1512 08029000
         MVC   LSTRECNM(2,@03),@CH00222                            1512 08030000
*       /*************************************************************/ 08031000
*       /*                                                           */ 08032000
*       /* INITIALIZE TOTAL OF COUNT FIELDS PROCCESSED       @ZA11014*/ 08033000
*       /*                                                           */ 08034000
*       /*************************************************************/ 08035000
*                                                                  1513 08036000
*       RECCNTSV=1;                 /*                       @ZA11014   08037000
*                                                            @ZA11014*/ 08038000
*                                                                  1513 08039000
         L     @03,@PC00001+8                                      1513 08040000
         MVC   RECCNTSV(2,@03),@CH00222                            1513 08041000
*       /*************************************************************/ 08042000
*       /*                                                           */ 08043000
*       /* INITIALIZE DCB AND IOB POINTERS                   @ZA11014*/ 08044000
*       /*                                                           */ 08045000
*       /*************************************************************/ 08046000
*                                                                  1514 08047000
*       DCBPTR=ADDR(IOXDCB);        /*                       @ZA11014*/ 08048000
         L     @03,IOCTLBKP                                        1514 08049000
         LA    @03,IOXDCB(,@03)                                    1514 08050000
         ST    @03,DCBPTR                                          1514 08051000
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @ZA11014   08052000
*                                                            @ZA11014*/ 08053000
*                                                                  1515 08054000
         L     @03,IOCTLBKP                                        1515 08055000
         LA    @03,IOXIOB(,@03)                                    1515 08056000
         ST    @03,IOBSTPTR                                        1515 08057000
*       /*************************************************************/ 08058000
*       /*                                                           */ 08059000
*       /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE     @ZA11014*/ 08060000
*       /* IOBSEEK CCHHR VALUE                               @ZA11014*/ 08061000
*       /*                                                           */ 08062000
*       /*************************************************************/ 08063000
*                                                                  1516 08064000
*       IOBCC=EXCC;                 /*                       @ZA11014*/ 08065000
         L     @03,@PC00001+8                                      1516 08066000
         L     @01,IOBSTPTR                                        1516 08067000
         MVC   IOBCC(2,@01),EXCC(@03)                              1516 08068000
*       IOBHH=EXHH;                 /*                       @ZA11014*/ 08069000
         L     @03,@PC00001+8                                      1517 08070000
         L     @01,IOBSTPTR                                        1517 08071000
         MVC   IOBHH(2,@01),EXHH(@03)                              1517 08072000
*       IOBR=EXRECNUM;              /*                       @ZA11014   08073000
*                                                            @ZA11014*/ 08074000
*                                                                  1518 08075000
         L     @03,@PC00001+8                                      1518 08076000
         IC    @15,EXRECNUM(,@03)                                  1518 08077000
         L     @03,IOBSTPTR                                        1518 08078000
         STC   @15,IOBR(,@03)                                      1518 08079000
*       /*************************************************************/ 08080000
*       /*                                                           */ 08081000
*       /* INIT THE START ADDR OF THE CCW CHAIN IN IOB       @ZA11014*/ 08082000
*       /*                                                           */ 08083000
*       /*************************************************************/ 08084000
*                                                                  1519 08085000
*       IOBSTART=ADDR(IOXCCWS);     /*                       @ZA11014   08086000
*                                                            @ZA11014   08087000
*                                                            @ZA11014*/ 08088000
         L     @03,IOCTLBKP                                        1519 08089000
         LA    @03,IOXCCWS(,@03)                                   1519 08090000
         L     @01,IOBSTPTR                                        1519 08091000
         ST    @03,IOBSTART(,@01)                                  1519 08092000
*     END;                          /*                       @ZA11014   08093000
*                                                            @ZA11014*/ 08094000
*   ELSE                                                           1521 08095000
*     ;                             /* NOT FIRST TIME        @ZA11014   08096000
*                                                            @ZA11014   08097000
*                                                            @ZA11014*/ 08098000
*                                                                  1521 08099000
@RF01501 DS    0H                                                  1522 08100000
*   /*****************************************************************/ 08101000
*   /*                                                               */ 08102000
*   /* ISSUE EXCP TO PERFORM THE I/O                         @ZA11014*/ 08103000
*   /*                                                               */ 08104000
*   /*****************************************************************/ 08105000
*                                                                  1522 08106000
*   CALL ISSUEXCP;                  /*                       @ZA11014*/ 08107000
         BAL   @14,ISSUEXCP                                        1522 08108000
*   RESPECIFY                                                      1523 08109000
*     RTNREG RSTD;                                                 1523 08110000
*   TESTRC=RTNREG;                                                 1524 08111000
         STH   RTNREG,TESTRC                                       1524 08112000
*   RESPECIFY                                                      1525 08113000
*     RTNREG UNRSTD;                /*                       @ZA11014*/ 08114000
*                                                                  1525 08115000
*   /*****************************************************************/ 08116000
*   /*                                                               */ 08117000
*   /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS         */ 08118000
*   /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW ADDITIONAL   */ 08119000
*   /* I/O. SO WE CLEAR THEM HERE.                           @ZA17169*/ 08120000
*   /*                                                               */ 08121000
*   /*****************************************************************/ 08122000
*                                                                  1526 08123000
*   IF TESTRC^=0 THEN               /*                       @ZA17169*/ 08124000
         LH    @03,TESTRC                                          1526 08125000
         LTR   @03,@03                                             1526 08126000
         BZ    @RF01526                                            1526 08127000
*     DCBIFEC='00'B;                /*                       @ZA17169   08128000
*                                                            @ZA11014*/ 08129000
         L     @03,DCBPTR                                          1527 08130000
         NI    DCBIFEC+40(@03),B'00111111'                         1527 08131000
*                                                                  1528 08132000
*   /*****************************************************************/ 08133000
*   /*                                                               */ 08134000
*   /* **************************************************@ZA11014    */ 08135000
*   /*                                                       @ZA11014*/ 08136000
*   /* THIS CODE CALCULATES THE NUM OF CCW'S EXEC            @ZA11014*/ 08137000
*   /* AND SETS THE READ COUNT RETURN CODES IN THE           @ZA11014*/ 08138000
*   /* LOCATION TABLE                                        @ZA11014*/ 08139000
*   /*                                                       @ZA11014*/ 08140000
*   /* IT ALSO DETERMINES IF ANY RECORD NUMS ARE MISSING@ZA11014 AND */ 08141000
*   /* IF SO, IT WILL SET THE COUNT RETURN CODE TO@ZA11014 'RECORD   */ 08142000
*   /* NOT FOUND' AND THE DATA ADDRESS TO ALL@ZA11014 ONES           */ 08143000
*   /* ('FFFFFFFF')                                          @ZA11014*/ 08144000
*   /*                                                       @ZA11014*/ 08145000
*   /*                                                       @ZA11014*/ 08146000
*   /*                                                       @ZA11014*/ 08147000
*   /*                                                       @ZA11014*/ 08148000
*   /* **************************************************@ZA11014    */ 08149000
*   /*                                                               */ 08150000
*   /*****************************************************************/ 08151000
*                                                                  1528 08152000
*                                   /*                       @ZA11014*/ 08153000
*                                                                  1528 08154000
*   /*****************************************************************/ 08155000
*   /*                                                               */ 08156000
*   /* SET TRACE ID TO 'IOC1'                                @ZA11014*/ 08157000
*   /*                                                               */ 08158000
*   /*****************************************************************/ 08159000
*                                                                  1528 08160000
*   OLDERID2=NEWERID2;                                             1528 08161000
@RF01526 L     @03,@PC00001                                        1528 08162000
         L     @03,GDTTR2(,@03)                                    1528 08163000
         L     @15,@PC00001                                        1528 08164000
         L     @01,GDTTR2(,@15)                                    1528 08165000
         MVC   @TS00001(95),NEWERID2(@01)                          1528 08166000
         MVC   OLDERID2(95,@03),@TS00001                           1528 08167000
*   NEWID2='IOC1';                  /*                       @ZA11014   08168000
*                                                            @ZA11014*/ 08169000
*                                                                  1529 08170000
         L     @03,@PC00001                                        1529 08171000
         L     @03,GDTTR2(,@03)                                    1529 08172000
         MVC   NEWID2(4,@03),@CC04350                              1529 08173000
*   /*****************************************************************/ 08174000
*   /*                                                               */ 08175000
*   /* CALC NUMB OF CCWS IN STRING THAT HAVE BEEN EXEC'D     @ZA11014*/ 08176000
*   /* SAVE ADDR OF NEXT CCW TO EXECUTE                      @ZA11014*/ 08177000
*   /*                                                               */ 08178000
*   /*****************************************************************/ 08179000
*                                                                  1530 08180000
*   SVCCWPTR=IOBCMDA;               /*                       @ZA11014   08181000
*                                                            @ZA11014   08182000
*                                                            @ZA11014   08183000
*                                                            @ZA11014   08184000
*                                                            @ZA11014   08185000
*                                                            @ZA11014*/ 08186000
         L     @03,@PC00001+8                                      1530 08187000
         L     @01,IOBSTPTR                                        1530 08188000
         MVC   SVCCWPTR(3,@03),IOBCMDA(@01)                        1530 08189000
*   CNTCCWS=(IOBCMDA-ADDR(IOXCCWS))/CCWSIZE;/*               @ZA11014   08190000
*                                                            @ZA11014*/ 08191000
*                                                                  1531 08192000
         L     @03,IOCTLBKP                                        1531 08193000
         LA    @03,IOXCCWS(,@03)                                   1531 08194000
         LR    @00,@03                                             1531 08195000
         LCR   @00,@00                                             1531 08196000
         L     @03,IOBSTPTR                                        1531 08197000
         L     @03,IOBCMDA-1(,@03)                                 1531 08198000
         LA    @03,0(,@03)                                         1531 08199000
         ALR   @00,@03                                             1531 08200000
         SRDA  @00,32                                              1531 08201000
         LH    @03,CCWSIZE                                         1531 08202000
         DR    @00,@03                                             1531 08203000
         STH   @01,CNTCCWS                                         1531 08204000
*   /*****************************************************************/ 08205000
*   /*                                                               */ 08206000
*   /* CHECK IF AT LEAST ONE COUNT FIELDS READ               @ZA11014*/ 08207000
*   /*                                                               */ 08208000
*   /*****************************************************************/ 08209000
*                                                                  1532 08210000
*   IF CNTCCWS>NONRDCT              /*                       @ZA11014*/ 08211000
*     THEN                          /*                       @ZA11014*/ 08212000
         LH    @03,CNTCCWS                                         1532 08213000
         CH    @03,NONRDCT                                         1532 08214000
         BNH   @RF01532                                            1532 08215000
*     DO;                           /*                       @ZA11014   08216000
*                                                            @ZA11014*/ 08217000
*                                                                  1533 08218000
*       /*************************************************************/ 08219000
*       /*                                                           */ 08220000
*       /* AT LEAST ONE COUNT FIELD HAS BEEN READ            @ZA11014*/ 08221000
*       /* CALC INDEX INTO CCW LIST                          @ZA11014*/ 08222000
*       /*                                                           */ 08223000
*       /*************************************************************/ 08224000
*                                                                  1534 08225000
*       CCWCNT=NONRDCT+RECCNTSV;    /*                       @ZA11014   08226000
*                                                            @ZA11014*/ 08227000
*                                                                  1534 08228000
         L     @03,@PC00001+8                                      1534 08229000
         LH    @15,NONRDCT                                         1534 08230000
         AH    @15,RECCNTSV(,@03)                                  1534 08231000
         STH   @15,CCWCNT                                          1534 08232000
*       /*************************************************************/ 08233000
*       /*                                                           */ 08234000
*       /* RESET THE COUNT OF CCWS TO EXAMINE THIS PASS      @ZA11014*/ 08235000
*       /* RECCNT WILL ALWAYS BE ONE LESS THAN THE LAST      @ZA11014*/ 08236000
*       /* CCW EXECUTED, SINCE THAT RECORD'S COUNT FIELD@ZA11014     */ 08237000
*       /* CANNOT BE EXAMINED THIS TIME                      @ZA11014*/ 08238000
*       /*                                                           */ 08239000
*       /*************************************************************/ 08240000
*                                                                  1535 08241000
*       RECCNT=CNTCCWS-NONRDCT-RECCNTSV;/*                   @ZA11014   08242000
*                                                            @ZA11014*/ 08243000
*                                                                  1535 08244000
         L     @03,@PC00001+8                                      1535 08245000
         LH    @15,CNTCCWS                                         1535 08246000
         SH    @15,NONRDCT                                         1535 08247000
         L     @14,@PC00001+8                                      1535 08248000
         SH    @15,RECCNTSV(,@14)                                  1535 08249000
         STH   @15,RECCNT(,@03)                                    1535 08250000
*       /*************************************************************/ 08251000
*       /*                                                           */ 08252000
*       /* EXAMINE THE COUNT FIELDS ALREADY READ             @ZA11014*/ 08253000
*       /* TO DETERMINE IF ANY RECORD NUMBERS ARE MISSIN@ZA11014     */ 08254000
*       /*                                                           */ 08255000
*       /*************************************************************/ 08256000
*                                                                  1536 08257000
*                                   /*                       @ZA11014*/ 08258000
*                                                                  1536 08259000
*       /*************************************************************/ 08260000
*       /*                                                           */ 08261000
*       /* INITIALIZE LOOP CONTROL                           @ZA11014*/ 08262000
*       /*                                                           */ 08263000
*       /*************************************************************/ 08264000
*                                                                  1536 08265000
*       RCTR=1;                     /*                       @ZA11014   08266000
*                                                            @ZA11014*/ 08267000
*                                                                  1536 08268000
         MVC   RCTR(2),@CH00222                                    1536 08269000
*       /*************************************************************/ 08270000
*       /*                                                           */ 08271000
*       /* LOOP FOR THE NUMBER OF COUNT FIELDS READ          @ZA11014*/ 08272000
*       /* THE OTHER CHECKS ENSURE THAT THE LOOP             @ZA11014*/ 08273000
*       /* DOES NOT BECOME INFINITE                          @ZA11014*/ 08274000
*       /*                                                           */ 08275000
*       /*************************************************************/ 08276000
*                                                                  1537 08277000
*                                   /*                       @ZA11014*/ 08278000
*       DO WHILE RCTR^>RECCNT&RECCNT^=ZERO/*                 @ZA11014*/ 08279000
*             &LSTRECNM^=MAXRECS;   /*                       @ZA11014   08280000
*                                                            @ZA11014*/ 08281000
*                                                                  1537 08282000
         B     @DE01537                                            1537 08283000
@DL01537 DS    0H                                                  1538 08284000
*         /***********************************************************/ 08285000
*         /*                                                         */ 08286000
*         /* CHECK TO SEE IF COUNT FIELD IN BUFFER           @ZA11014*/ 08287000
*         /* IS LAST RECORD NUMBER, OR IF THE CCW            @ZA11014*/ 08288000
*         /* IS A SPACE COUNT                                @ZA11014*/ 08289000
*         /*                                                         */ 08290000
*         /***********************************************************/ 08291000
*                                                                  1538 08292000
*         IF LSTRECNM=CCWADDR->RBREC|CCWOP=SPCNTOP/*         @ZA11014*/ 08293000
*           THEN                    /*                       @ZA11014*/ 08294000
*                                                                  1538 08295000
         L     @03,@PC00001+8                                      1538 08296000
         LH    @15,CCWCNT                                          1538 08297000
         SLA   @15,3                                               1538 08298000
         L     @01,IOCTLBKP                                        1538 08299000
         LA    @15,IOXCCW-8(@15,@01)                               1538 08300000
         L     @01,CCWADDR-1(,@15)                                 1538 08301000
         LH    @03,LSTRECNM(,@03)                                  1538 08302000
         SLR   @00,@00                                             1538 08303000
         IC    @00,RBREC(,@01)                                     1538 08304000
         CR    @03,@00                                             1538 08305000
         BE    @RT01538                                            1538 08306000
         LH    @03,CCWCNT                                          1538 08307000
         SLA   @03,3                                               1538 08308000
         L     @01,IOCTLBKP                                        1538 08309000
         LA    @03,IOXCCW-8(@03,@01)                               1538 08310000
         CLC   CCWOP(1,@03),SPCNTOP                                1538 08311000
         BNE   @RF01538                                            1538 08312000
@RT01538 DS    0H                                                  1539 08313000
*           /*********************************************************/ 08314000
*           /*                                                       */ 08315000
*           /* COUNT FIELD IN BUFFER IS FOR THIS REC NU@ZA11014      */ 08316000
*           /*                                                       */ 08317000
*           /*********************************************************/ 08318000
*                                                                  1539 08319000
*           DO;                     /*                       @ZA11014   08320000
*                                                            @ZA11014*/ 08321000
*                                                                  1539 08322000
*             /*******************************************************/ 08323000
*             /*                                                     */ 08324000
*             /* INCREMENT POINTER TO CCW CHAIN AND          @ZA11014*/ 08325000
*             /* INCREMENT NEXT RECORD NUMBER                @ZA11014*/ 08326000
*             /*                                                     */ 08327000
*             /*******************************************************/ 08328000
*                                                                  1540 08329000
*                                   /*                       @ZA11014*/ 08330000
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014*/ 08331000
         LH    @03,CCWCNT                                          1540 08332000
         LA    @03,1(,@03)                                         1540 08333000
         STH   @03,CCWCNT                                          1540 08334000
*             LSTRECNM=LSTRECNM+1;  /*                       @ZA11014   08335000
*                                                            @ZA11014*/ 08336000
*                                                                  1541 08337000
         L     @03,@PC00001+8                                      1541 08338000
         L     @15,@PC00001+8                                      1541 08339000
         LA    @14,1                                               1541 08340000
         AH    @14,LSTRECNM(,@15)                                  1541 08341000
         STH   @14,LSTRECNM(,@03)                                  1541 08342000
*             /*******************************************************/ 08343000
*             /*                                                     */ 08344000
*             /* INCREMENT DO WHILE CONTROL                  @ZA11014*/ 08345000
*             /*                                                     */ 08346000
*             /*******************************************************/ 08347000
*                                                                  1542 08348000
*             RCTR=RCTR+1;          /*                       @ZA11014*/ 08349000
         LH    @03,RCTR                                            1542 08350000
         LA    @03,1(,@03)                                         1542 08351000
         STH   @03,RCTR                                            1542 08352000
*           END;                    /*                       @ZA11014   08353000
*                                                            @ZA11014*/ 08354000
*         ELSE                      /*                       @ZA11014   08355000
*                                                            @ZA11014*/ 08356000
*                                                                  1544 08357000
*           /*********************************************************/ 08358000
*           /*                                                       */ 08359000
*           /* RECORD NUMBERS DO NOT MATCH-REC NOT FND       @ZA11014*/ 08360000
*           /*                                                       */ 08361000
*           /*********************************************************/ 08362000
*                                                                  1544 08363000
*           DO;                     /*                       @ZA11014   08364000
*                                                            @ZA11014*/ 08365000
*                                                                  1544 08366000
         B     @RC01538                                            1544 08367000
@RF01538 DS    0H                                                  1545 08368000
*             /*******************************************************/ 08369000
*             /*                                                     */ 08370000
*             /* SET LOCTAB COUNT RET CODE TO REC NOT FND@ZA11014 SET*/ 08371000
*             /* LOCTAB ADDRESS TO 'FFFFFFFF'                @ZA11014*/ 08372000
*             /*                                                     */ 08373000
*             /*******************************************************/ 08374000
*                                                                  1545 08375000
*             LOCRCNT(LSTRECNM+1)=RCABNRF;/*                 @ZA11014*/ 08376000
         L     @03,@PC00001+8                                      1545 08377000
         LH    @03,LSTRECNM(,@03)                                  1545 08378000
         MH    @03,@CH00279                                        1545 08379000
         L     @15,@PC00001+8                                      1545 08380000
         L     @01,EXLOCPTR(,@15)                                  1545 08381000
         LH    @00,RCABNRF                                         1545 08382000
         STH   @00,LOCRCNT(@03,@01)                                1545 08383000
*             LOCADDR(LSTRECNM+1)=NTFNDPTR;/*                @ZA11014   08384000
*                                                            @ZA11014*/ 08385000
*                                                                  1546 08386000
         L     @03,@PC00001+8                                      1546 08387000
         LH    @03,LSTRECNM(,@03)                                  1546 08388000
         MH    @03,@CH00279                                        1546 08389000
         L     @15,@PC00001+8                                      1546 08390000
         L     @01,EXLOCPTR(,@15)                                  1546 08391000
         ICM   @00,15,NTFNDPTR                                     1546 08392000
         ST    @00,LOCADDR(@03,@01)                                1546 08393000
*             /*******************************************************/ 08394000
*             /*                                                     */ 08395000
*             /* INCREMENT NEXT RECORD NUMBER                @ZA11014*/ 08396000
*             /* DO NOT INCREMENT CCW PTR OR LOOP CONTRO@ZA11014     */ 08397000
*             /*                                                     */ 08398000
*             /*******************************************************/ 08399000
*                                                                  1547 08400000
*             LSTRECNM=LSTRECNM+1;  /*                       @ZA11014*/ 08401000
         L     @03,@PC00001+8                                      1547 08402000
         L     @15,@PC00001+8                                      1547 08403000
         LA    @14,1                                               1547 08404000
         AH    @14,LSTRECNM(,@15)                                  1547 08405000
         STH   @14,LSTRECNM(,@03)                                  1547 08406000
*           END;                    /*                       @ZA11014   08407000
*                                                            @ZA11014*/ 08408000
*       END;                        /* END DO WHILE@ZA11014  @ZA11014*/ 08409000
*                                                                  1549 08410000
@RC01538 DS    0H                                                  1549 08411000
@DE01537 L     @03,@PC00001+8                                      1549 08412000
         LH    @15,RCTR                                            1549 08413000
         CH    @15,RECCNT(,@03)                                    1549 08414000
         BH    @DC01537                                            1549 08415000
         L     @03,@PC00001+8                                      1549 08416000
         CLC   RECCNT(2,@03),ZERO                                  1549 08417000
         BE    @DC01537                                            1549 08418000
         L     @03,@PC00001+8                                      1549 08419000
         CLC   LSTRECNM(2,@03),MAXRECS                             1549 08420000
         BNE   @DL01537                                            1549 08421000
@DC01537 DS    0H                                                  1550 08422000
*       /*************************************************************/ 08423000
*       /*                                                           */ 08424000
*       /* CHECK WHY EXITED FROM DO WHILE                    @ZA11014*/ 08425000
*       /*                                                           */ 08426000
*       /*************************************************************/ 08427000
*                                                                  1550 08428000
*       IF LSTRECNM=>MAXRECS        /*                       @ZA11014   08429000
*                                                            @ZA11014*/ 08430000
*         THEN                      /*                       @ZA11014*/ 08431000
*                                                                  1550 08432000
         L     @03,@PC00001+8                                      1550 08433000
         LH    @03,LSTRECNM(,@03)                                  1550 08434000
         CH    @03,MAXRECS                                         1550 08435000
         BL    @RF01550                                            1550 08436000
*         /***********************************************************/ 08437000
*         /*                                                         */ 08438000
*         /* CNT FIELD READ IS GARBAGE-UNEXP RESULT@ZA11014          */ 08439000
*         /*                                                         */ 08440000
*         /***********************************************************/ 08441000
*                                                                  1551 08442000
*         TESTRC=RCSRUEX;           /*                       @ZA11014   08443000
*                                                            @ZA11014*/ 08444000
         LH    @03,RCSRUEX                                         1551 08445000
         STH   @03,TESTRC                                          1551 08446000
*       ELSE                        /*                       @ZA11014*/ 08447000
*         DO;                       /*                       @ZA11014*/ 08448000
*                                                                  1552 08449000
         B     @RC01550                                            1552 08450000
@RF01550 DS    0H                                                  1553 08451000
*           /*********************************************************/ 08452000
*           /*                                                       */ 08453000
*           /* ALL COUNTS HAVE BEEN EXAMINED EXCEPT          @ZA11014*/ 08454000
*           /* THE LAST ONE FOR THE LAST CCW EXECUTED@ZA11014 SET THE*/ 08455000
*           /* CURRENT RETURN CODE INTO LOCTA@ZA11014 ENTRY FOR      */ 08456000
*           /* LATEST RECORD NUMBER                          @ZA11014*/ 08457000
*           /*                                                       */ 08458000
*           /*********************************************************/ 08459000
*                                                                  1553 08460000
*           LOCRCNT(LSTRECNM+1)=TESTRC;/*                    @ZA11014   08461000
*                                                            @ZA11014*/ 08462000
*                                                                  1553 08463000
         L     @03,@PC00001+8                                      1553 08464000
         LH    @03,LSTRECNM(,@03)                                  1553 08465000
         MH    @03,@CH00279                                        1553 08466000
         L     @15,@PC00001+8                                      1553 08467000
         L     @01,EXLOCPTR(,@15)                                  1553 08468000
         LH    @00,TESTRC                                          1553 08469000
         STH   @00,LOCRCNT(@03,@01)                                1553 08470000
*           /*********************************************************/ 08471000
*           /*                                                       */ 08472000
*           /* UPDATE NUM OF CNT FIELDS EXAMINED             @ZA11014*/ 08473000
*           /*                                                       */ 08474000
*           /*********************************************************/ 08475000
*                                                                  1554 08476000
*           RECCNTSV=RECCNTSV+RECCNT;/*                      @ZA11014   08477000
*                                                            @ZA11014*/ 08478000
*                                                                  1554 08479000
         L     @03,@PC00001+8                                      1554 08480000
         L     @15,@PC00001+8                                      1554 08481000
         L     @14,@PC00001+8                                      1554 08482000
         LH    @15,RECCNTSV(,@15)                                  1554 08483000
         AH    @15,RECCNT(,@14)                                    1554 08484000
         STH   @15,RECCNTSV(,@03)                                  1554 08485000
*           /*********************************************************/ 08486000
*           /*                                                       */ 08487000
*           /* SET NUM OF LAST REC READ BACK TO CALLE@ZA11014        */ 08488000
*           /*                                                       */ 08489000
*           /*********************************************************/ 08490000
*                                                                  1555 08491000
*           EXCCWCNT=LSTRECNM;      /*                       @ZA11014*/ 08492000
         L     @03,@PC00001+8                                      1555 08493000
         L     @15,@PC00001+8                                      1555 08494000
         LH    @15,LSTRECNM(,@15)                                  1555 08495000
         STH   @15,EXCCWCNT(,@03)                                  1555 08496000
*         END;                      /*                       @ZA11014   08497000
*                                                            @ZA11014*/ 08498000
*                                                                  1556 08499000
*       /*************************************************************/ 08500000
*       /*                                                           */ 08501000
*       /* END OF DO FOR ONE COUNT FIELD                     @ZA11014*/ 08502000
*       /*                                                           */ 08503000
*       /*************************************************************/ 08504000
*                                                                  1557 08505000
*     END;                          /*                       @ZA11014*/ 08506000
*                                                                  1557 08507000
*   /*****************************************************************/ 08508000
*   /*                                                               */ 08509000
*   /* RETURNED FROM UEXCP BEFORE FIRST READ COUNT           @ZA11014*/ 08510000
*   /* CHECK TO SEE IF PROCESSING RECORD 0                   @ZA11014*/ 08511000
*   /*                                                               */ 08512000
*   /*****************************************************************/ 08513000
*                                                                  1558 08514000
*   ELSE                            /*                       @ZA11014   08515000
*                                                            @ZA11014*/ 08516000
*                                                                  1558 08517000
*     /***************************************************************/ 08518000
*     /*                                                             */ 08519000
*     /* CHECK IF NOT R0                                     @ZA11014*/ 08520000
*     /*                                                             */ 08521000
*     /***************************************************************/ 08522000
*                                                                  1558 08523000
*     IF CNTCCWS^=R0CHNLOC          /*                       @ZA11014   08524000
*                                                            @ZA11014*/ 08525000
*                                                                  1558 08526000
*     /***************************************************************/ 08527000
*     /*                                                             */ 08528000
*     /* BEFORE FIRST READ COUNT, BUT NOT R0 READ            @ZA11014*/ 08529000
*     /*                                                             */ 08530000
*     /***************************************************************/ 08531000
*                                                                  1558 08532000
*       THEN                        /*                       @ZA11014*/ 08533000
*                                                                  1558 08534000
         B     @RC01532                                            1558 08535000
@RF01532 CLC   CNTCCWS(2),R0CHNLOC                                 1558 08536000
         BE    @RF01558                                            1558 08537000
*       /*************************************************************/ 08538000
*       /*                                                           */ 08539000
*       /* SET RETURN CODE TO UNEXPECTED RESULTS             @ZA11014*/ 08540000
*       /*                                                           */ 08541000
*       /*************************************************************/ 08542000
*                                                                  1559 08543000
*       TESTRC=RCSRUEX;             /*                       @ZA11014   08544000
*                                                            @ZA11014*/ 08545000
         LH    @03,RCSRUEX                                         1559 08546000
         STH   @03,TESTRC                                          1559 08547000
*     ELSE                          /*                       @ZA11014*/ 08548000
*                                                                  1560 08549000
*       /*************************************************************/ 08550000
*       /*                                                           */ 08551000
*       /* LAST CCW READ WAS READ R0                         @ZA11014*/ 08552000
*       /* RETURN WITH NUM LAST REC READ AS R0               @ZA11014*/ 08553000
*       /*                                                           */ 08554000
*       /*************************************************************/ 08555000
*                                                                  1560 08556000
*       EXCCWCNT=ZERO;              /*                       @ZA11014   08557000
*                                                            @ZA11014*/ 08558000
*                                                                  1560 08559000
         B     @RC01558                                            1560 08560000
@RF01558 L     @03,@PC00001+8                                      1560 08561000
         LH    @15,ZERO                                            1560 08562000
         STH   @15,EXCCWCNT(,@03)                                  1560 08563000
*   /*****************************************************************/ 08564000
*   /*                                                               */ 08565000
*   /* RETURN WITH RETURN CODE FROM ISSUEXCP                 @ZA11014*/ 08566000
*   /*                                                               */ 08567000
*   /*****************************************************************/ 08568000
*                                                                  1561 08569000
*   RETURN CODE(TESTRC);            /*                       @ZA11014   08570000
*                                                            @ZA11014*/ 08571000
@RC01558 DS    0H                                                  1561 08572000
@RC01532 LH    @15,TESTRC                                          1561 08573000
         L     @14,@SA00023                                        1561 08574000
         LM    @00,@12,@SA00023+8                                  1561 08575000
         BR    @14                                                 1561 08576000
*   END READCNT;                    /*                       @ZA11014   08577000
*                                                            @ZA11014*/ 08578000
*                                                                  1563 08579000
*/***********************************************************@ZA11014*/ 08580000
*/*                                                          @ZA11014*/ 08581000
*/*  PROCEDURE NAME - READKD                                 @ZA11014*/ 08582000
*/*                                                          @ZA11014*/ 08583000
*/*  FUNCTION - IF FIRST TIME CALLS SUBPROCEDURE SETKDCCW    @ZA11014*/ 08584000
*/*              TO BUILD A CCW LIST TO READ THE COUNT       @ZA11014*/ 08585000
*/*              KEY AND DATA FIELDS                         @ZA11014*/ 08586000
*/*              FOR THE RECORDS ON THE REQUESTED TRACK,     @ZA11014*/ 08587000
*/*              AND INITIALIZES COUNTERS                    @ZA11014*/ 08588000
*/*             IF NOT THE FIRST TIME, CALLS SUBPROCEDURE    @ZA11014*/ 08589000
*/*              ADJCCW TO BYPASS THOSE RECORDS ALREADY READ @ZA11014*/ 08590000
*/*             CALLS SUBPROCEDURE ISSUEXCP TO DO I/O        @ZA11014*/ 08591000
*/*             CALCULATES THE NUMBER OF RECORDS READ        @ZA11014*/ 08592000
*/*             SETS THE KEY/DATA RET CODES IN THE LOCATION  @ZA11014*/ 08593000
*/*              TABLE ENTRIES FOR THE RECORDS READ THIS CALL@ZA11014*/ 08594000
*/*             RETURNS                                      @ZA11014*/ 08595000
*/*                                                          @ZA11014*/ 08596000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 08597000
*/*                                                          @ZA11014*/ 08598000
*/*                                                          @ZA11014*/ 08599000
*/*                                                          @ZA11014*/ 08600000
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/ 08601000
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/ 08602000
*/*          EXCC     FROM EXWRARG                           @ZA11014*/ 08603000
*/*          EXHH     FROM EXWRARG                           @ZA11014*/ 08604000
*/*          EXLOCPTR FROM EXWRARG                           @ZA11014*/ 08605000
*/*          EXSPACE  FROM EXWRARG                           @ZA11014*/ 08606000
*/*                                                          @ZA11014*/ 08607000
*/*  OUTPUT - EXCCWCNT IN EXWRARG                            @ZA11014*/ 08608000
*/*           RECORDS IN RBUFF OF RIOAREA                    @ZA11014*/ 08609000
*/*           EXSPACE IN EXWRARG                             @ZA11014*/ 08610000
*/*           KEY/DATA    RETURN CODES IN LOCATION TABLE     @ZA11014*/ 08611000
*/*           RETURN CODE OF LAST RECORD READ IN REG 15      @ZA11014*/ 08612000
*/*                                                          @ZA11014*/ 08613000
*/*                                                          @ZA11014*/ 08614000
*/*                                                          @ZA11014*/ 08615000
*/***********************************************************@ZA11014*/ 08616000
*                                                                  1563 08617000
*READKD:                                                           1563 08618000
*   PROC;                           /*                       @ZA11014   08619000
*                                                            @ZA11014   08620000
*                                                            @ZA11014*/ 08621000
*                                                                  1563 08622000
READKD   STM   @14,@12,@SA00024                                    1563 08623000
*   /*****************************************************************/ 08624000
*   /*                                                               */ 08625000
*   /* SET UP TRACE POINT 'IOCT' IN TRACE TABLE              @ZA11014*/ 08626000
*   /*                                                               */ 08627000
*   /*****************************************************************/ 08628000
*                                                                  1564 08629000
*   OLDERID2=NEWERID2;                                             1564 08630000
         L     @03,@PC00001                                        1564 08631000
         L     @03,GDTTR2(,@03)                                    1564 08632000
         L     @15,@PC00001                                        1564 08633000
         L     @01,GDTTR2(,@15)                                    1564 08634000
         MVC   @TS00001(95),NEWERID2(@01)                          1564 08635000
         MVC   OLDERID2(95,@03),@TS00001                           1564 08636000
*   NEWID2='IOKD';                  /*                       @ZA11014   08637000
*                                                            @ZA11014*/ 08638000
*                                                                  1565 08639000
         L     @03,@PC00001                                        1565 08640000
         L     @03,GDTTR2(,@03)                                    1565 08641000
         MVC   NEWID2(4,@03),@CC04354                              1565 08642000
*   /*****************************************************************/ 08643000
*   /*                                                               */ 08644000
*   /* SET UP ADDRESSABILITY TO IOXCTLBK AND RIOAREA         @ZA11014*/ 08645000
*   /*                                                               */ 08646000
*   /*****************************************************************/ 08647000
*                                                                  1566 08648000
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/ 08649000
         L     @03,@PC00001+8                                      1566 08650000
         L     @03,EXRWCTBL(,@03)                                  1566 08651000
         ST    @03,IOCTLBKP                                        1566 08652000
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014   08653000
*                                                            @ZA11014*/ 08654000
*                                                                  1567 08655000
         L     @03,@PC00001+8                                      1567 08656000
         L     @03,EXRWIOAR(,@03)                                  1567 08657000
         ST    @03,RRIOARPT                                        1567 08658000
*   /*****************************************************************/ 08659000
*   /*                                                               */ 08660000
*   /* DETERMINE IF THIS IS THE FST TIME                     @ZA11014*/ 08661000
*   /*                                                               */ 08662000
*   /*****************************************************************/ 08663000
*                                                                  1568 08664000
*   IF RFIRST=FSTIME                /*                       @ZA11014*/ 08665000
*     THEN                          /*                       @ZA11014   08666000
*                                                            @ZA11014*/ 08667000
*                                                                  1568 08668000
         L     @03,RRIOARPT                                        1568 08669000
         CLC   RFIRST(1,@03),FSTIME                                1568 08670000
         BNE   @RF01568                                            1568 08671000
*     /***************************************************************/ 08672000
*     /*                                                             */ 08673000
*     /* IF THIS IS FIRST TIME, SET UP CCW CHAIN             @ZA11014*/ 08674000
*     /*                                                             */ 08675000
*     /***************************************************************/ 08676000
*                                                                  1569 08677000
*     DO;                           /*                       @ZA11014*/ 08678000
*       RFIRST=NTFSTIME;            /*                       @ZA11014*/ 08679000
         IC    @03,NTFSTIME                                        1570 08680000
         L     @01,RRIOARPT                                        1570 08681000
         STC   @03,RFIRST(,@01)                                    1570 08682000
*       CALL SETKDCCW;              /*                       @ZA11014*/ 08683000
         BAL   @14,SETKDCCW                                        1571 08684000
*       RESPECIFY                                                  1572 08685000
*         RTNREG RSTD;                                             1572 08686000
*       TESTRC=RTNREG;                                             1573 08687000
         STH   RTNREG,TESTRC                                       1573 08688000
*       RESPECIFY                                                  1574 08689000
*         RTNREG UNRSTD;            /*                       @ZA11014   08690000
*                                                            @ZA11014*/ 08691000
*                                                                  1574 08692000
*       /*************************************************************/ 08693000
*       /*                                                           */ 08694000
*       /* INITIALIZE LAST RECORD NUM PROCESSED              @ZA11014*/ 08695000
*       /*                                                           */ 08696000
*       /*************************************************************/ 08697000
*                                                                  1575 08698000
*       LSTRECNM=1;                 /*                       @ZA11014   08699000
*                                                            @ZA11014*/ 08700000
*                                                                  1575 08701000
         L     @03,@PC00001+8                                      1575 08702000
         MVC   LSTRECNM(2,@03),@CH00222                            1575 08703000
*       /*************************************************************/ 08704000
*       /*                                                           */ 08705000
*       /* INITIALIZE TOTAL OF CCWS PROCESSED                @ZA11014*/ 08706000
*       /*                                                           */ 08707000
*       /*************************************************************/ 08708000
*                                                                  1576 08709000
*       RECCNTSV=1;                 /*                       @ZA11014*/ 08710000
*                                                                  1576 08711000
         L     @03,@PC00001+8                                      1576 08712000
         MVC   RECCNTSV(2,@03),@CH00222                            1576 08713000
*       /*************************************************************/ 08714000
*       /*                                                           */ 08715000
*       /* INITIALIZE DCB AND IOB POINTERS                   @ZA11014*/ 08716000
*       /*                                                           */ 08717000
*       /*************************************************************/ 08718000
*                                                                  1577 08719000
*       DCBPTR=ADDR(IOXDCB);        /*                       @ZA11014*/ 08720000
         L     @03,IOCTLBKP                                        1577 08721000
         LA    @03,IOXDCB(,@03)                                    1577 08722000
         ST    @03,DCBPTR                                          1577 08723000
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @ZA11014   08724000
*                                                            @ZA11014*/ 08725000
*                                                                  1578 08726000
         L     @03,IOCTLBKP                                        1578 08727000
         LA    @03,IOXIOB(,@03)                                    1578 08728000
         ST    @03,IOBSTPTR                                        1578 08729000
*       /*************************************************************/ 08730000
*       /*                                                           */ 08731000
*       /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE     @ZA11014*/ 08732000
*       /* IOBSEEK CCHHR VALUE                               @ZA11014*/ 08733000
*       /*                                                           */ 08734000
*       /*************************************************************/ 08735000
*                                                                  1579 08736000
*       IOBCC=EXCC;                 /*                       @ZA11014*/ 08737000
         L     @03,@PC00001+8                                      1579 08738000
         L     @01,IOBSTPTR                                        1579 08739000
         MVC   IOBCC(2,@01),EXCC(@03)                              1579 08740000
*       IOBHH=EXHH;                 /*                       @ZA11014*/ 08741000
         L     @03,@PC00001+8                                      1580 08742000
         L     @01,IOBSTPTR                                        1580 08743000
         MVC   IOBHH(2,@01),EXHH(@03)                              1580 08744000
*       IOBR=EXRECNUM;              /*                       @ZA11014   08745000
*                                                            @ZA11014*/ 08746000
*                                                                  1581 08747000
         L     @03,@PC00001+8                                      1581 08748000
         IC    @15,EXRECNUM(,@03)                                  1581 08749000
         L     @03,IOBSTPTR                                        1581 08750000
         STC   @15,IOBR(,@03)                                      1581 08751000
*       /*************************************************************/ 08752000
*       /*                                                           */ 08753000
*       /* INIT THE START ADDR OF THE CCW CHAIN IN IOB       @ZA11014*/ 08754000
*       /*                                                           */ 08755000
*       /*************************************************************/ 08756000
*                                                                  1582 08757000
*       IOBSTART=ADDR(IOXCCWS);     /*                       @ZA11014   08758000
*                                                            @ZA11014*/ 08759000
         L     @03,IOCTLBKP                                        1582 08760000
         LA    @03,IOXCCWS(,@03)                                   1582 08761000
         L     @01,IOBSTPTR                                        1582 08762000
         ST    @03,IOBSTART(,@01)                                  1582 08763000
*     END;                          /*                       @ZA11014   08764000
*                                                            @ZA11014*/ 08765000
*   ELSE                            /*                       @ZA11014*/ 08766000
*                                                                  1584 08767000
*     /***************************************************************/ 08768000
*     /*                                                             */ 08769000
*     /* NOT FIRST TIME-DONT REEXECUTE CCWS ALREADY RD@ZA11014       */ 08770000
*     /*                                                             */ 08771000
*     /***************************************************************/ 08772000
*                                                                  1584 08773000
*     DO;                           /*                       @ZA11014*/ 08774000
         B     @RC01568                                            1584 08775000
@RF01568 DS    0H                                                  1585 08776000
*       CALL ADJCCW;                /*                       @ZA11014*/ 08777000
         BAL   @14,ADJCCW                                          1585 08778000
*       RESPECIFY                                                  1586 08779000
*         RTNREG RSTD;                                             1586 08780000
*       TESTRC=RTNREG;                                             1587 08781000
         STH   RTNREG,TESTRC                                       1587 08782000
*       RESPECIFY                                                  1588 08783000
*         RTNREG UNRSTD;            /*                       @ZA11014*/ 08784000
*     END;                          /*                       @ZA11014*/ 08785000
*                                                                  1590 08786000
*   /*****************************************************************/ 08787000
*   /*                                                               */ 08788000
*   /* SEE IF UNEXPECTED RESULTS FROM CCW BUILDING           @ZA11014*/ 08789000
*   /*                                                               */ 08790000
*   /*****************************************************************/ 08791000
*                                                                  1590 08792000
*   IF TESTRC^=RCSRUEX              /*                       @ZA11014*/ 08793000
*     THEN                          /*                       @ZA11014*/ 08794000
*                                                                  1590 08795000
@RC01568 CLC   TESTRC(2),RCSRUEX                                   1590 08796000
         BE    @RF01590                                            1590 08797000
*     /***************************************************************/ 08798000
*     /*                                                             */ 08799000
*     /* OK TO CONTINUE                                      @ZA11014*/ 08800000
*     /*                                                             */ 08801000
*     /***************************************************************/ 08802000
*                                                                  1591 08803000
*     DO;                           /*                       @ZA11014   08804000
*                                                            @ZA11014*/ 08805000
*                                                                  1591 08806000
*       /*************************************************************/ 08807000
*       /*                                                           */ 08808000
*       /* ISSUE EXCP TO PERFORM THE I/O                     @ZA11014*/ 08809000
*       /*                                                           */ 08810000
*       /*************************************************************/ 08811000
*                                                                  1592 08812000
*       CALL ISSUEXCP;              /*                       @ZA11014*/ 08813000
         BAL   @14,ISSUEXCP                                        1592 08814000
*       RESPECIFY                                                  1593 08815000
*         RTNREG RSTD;                                             1593 08816000
*       TESTRC=RTNREG;                                             1594 08817000
         STH   RTNREG,TESTRC                                       1594 08818000
*       RESPECIFY                                                  1595 08819000
*         RTNREG UNRSTD;            /*                       @ZA11014*/ 08820000
*                                                                  1595 08821000
*       /*************************************************************/ 08822000
*       /*                                                           */ 08823000
*       /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS     */ 08824000
*       /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW          */ 08825000
*       /* ADDITIONAL I/O. SO WE CLEAR THEM HERE.            @ZA17169*/ 08826000
*       /*                                                           */ 08827000
*       /*************************************************************/ 08828000
*                                                                  1596 08829000
*       IF TESTRC^=0 THEN           /*                       @ZA17169*/ 08830000
         LH    @03,TESTRC                                          1596 08831000
         LTR   @03,@03                                             1596 08832000
         BZ    @RF01596                                            1596 08833000
*         DCBIFEC='00'B;            /*                       @ZA17169*/ 08834000
*                                                                  1597 08835000
         L     @03,DCBPTR                                          1597 08836000
         NI    DCBIFEC+40(@03),B'00111111'                         1597 08837000
*       /*************************************************************/ 08838000
*       /*                                                           */ 08839000
*       /* **********************************************@ZA11014    */ 08840000
*       /*                                                   @ZA11014*/ 08841000
*       /* THIS CODE CALCULATES THE NUM OF CCW'S EXEC        @ZA11014*/ 08842000
*       /* AND SETS THE READ KEY/DATA RET CODES IN THE       @ZA11014*/ 08843000
*       /* LOCATION TABLE                                    @ZA11014*/ 08844000
*       /*                                                   @ZA11014*/ 08845000
*       /*                                                   @ZA11014*/ 08846000
*       /*                                                   @ZA11014*/ 08847000
*       /*                                                   @ZA11014*/ 08848000
*       /*                                                   @ZA11014*/ 08849000
*       /* **********************************************@ZA11014    */ 08850000
*       /*                                                           */ 08851000
*       /*************************************************************/ 08852000
*                                                                  1598 08853000
*                                   /*                       @ZA11014*/ 08854000
*                                                                  1598 08855000
*       /*************************************************************/ 08856000
*       /*                                                           */ 08857000
*       /* SET TRACE ID TO 'IOK2'                            @ZA11014*/ 08858000
*       /*                                                           */ 08859000
*       /*************************************************************/ 08860000
*                                                                  1598 08861000
*       OLDERID2=NEWERID2;                                         1598 08862000
@RF01596 L     @03,@PC00001                                        1598 08863000
         L     @03,GDTTR2(,@03)                                    1598 08864000
         L     @15,@PC00001                                        1598 08865000
         L     @01,GDTTR2(,@15)                                    1598 08866000
         MVC   @TS00001(95),NEWERID2(@01)                          1598 08867000
         MVC   OLDERID2(95,@03),@TS00001                           1598 08868000
*       NEWID2='IOK2';              /*                       @ZA11014   08869000
*                                                            @ZA11014*/ 08870000
*                                                                  1599 08871000
         L     @03,@PC00001                                        1599 08872000
         L     @03,GDTTR2(,@03)                                    1599 08873000
         MVC   NEWID2(4,@03),@CC04357                              1599 08874000
*       /*************************************************************/ 08875000
*       /*                                                           */ 08876000
*       /* CALC NUMB OF CCWS THAT HAVE BEEN EXEC'D           @ZA11014*/ 08877000
*       /* SAVE ADDR OF NEXT CCW TO EXECUTE                  @ZA11014*/ 08878000
*       /*                                                           */ 08879000
*       /*************************************************************/ 08880000
*                                                                  1600 08881000
*       SVCCWPTR=IOBCMDA;           /*                       @ZA11014*/ 08882000
         L     @03,@PC00001+8                                      1600 08883000
         L     @01,IOBSTPTR                                        1600 08884000
         MVC   SVCCWPTR(3,@03),IOBCMDA(@01)                        1600 08885000
*       CNTCCWS=(IOBCMDA-ADDR(IOXCCWS))/CCWSIZE;/*           @ZA11014   08886000
*                                                            @ZA11014*/ 08887000
*                                                                  1601 08888000
         L     @03,IOCTLBKP                                        1601 08889000
         LA    @03,IOXCCWS(,@03)                                   1601 08890000
         LR    @00,@03                                             1601 08891000
         LCR   @00,@00                                             1601 08892000
         L     @03,IOBSTPTR                                        1601 08893000
         L     @03,IOBCMDA-1(,@03)                                 1601 08894000
         LA    @03,0(,@03)                                         1601 08895000
         ALR   @00,@03                                             1601 08896000
         SRDA  @00,32                                              1601 08897000
         LH    @03,CCWSIZE                                         1601 08898000
         DR    @00,@03                                             1601 08899000
         STH   @01,CNTCCWS                                         1601 08900000
*       /*************************************************************/ 08901000
*       /*                                                           */ 08902000
*       /* CHECK TO SEE IF THIS PASS WE READ AT LEAST AS     @ZA11014*/ 08903000
*       /* MANY CCWS AS WE DID LAST PASS                     @ZA11014*/ 08904000
*       /*                                                           */ 08905000
*       /*************************************************************/ 08906000
*                                                                  1602 08907000
*       IF CNTCCWS<RECCNTSV         /*                       @ZA11014*/ 08908000
*         THEN                      /*                       @ZA11014*/ 08909000
*                                                                  1602 08910000
         L     @03,@PC00001+8                                      1602 08911000
         LH    @15,CNTCCWS                                         1602 08912000
         CH    @15,RECCNTSV(,@03)                                  1602 08913000
         BNL   @RF01602                                            1602 08914000
*         /***********************************************************/ 08915000
*         /*                                                         */ 08916000
*         /* FEWER CCWS EXECUTED THIS TIME -                 @ZA11014*/ 08917000
*         /* SET UNCORRECTABE I/O ERROR IN ALL LOCTAB        @ZA11014*/ 08918000
*         /* ENTRIES BEYOND THE LAST ONE READ LAST PAS@ZA11014 AND   */ 08919000
*         /* THEN RETURN WITH KD RETURN CODE OF TH@ZA11014 REQUESTED */ 08920000
*         /* RECORD                                          @ZA11014*/ 08921000
*         /*                                                         */ 08922000
*         /***********************************************************/ 08923000
*                                                                  1603 08924000
*         DO;                       /*                       @ZA11014*/ 08925000
*           DO RCTR=(EXCCWCNT+1) TO LOCENT;/*                @ZA11014*/ 08926000
         L     @03,@PC00001+8                                      1604 08927000
         LA    @15,1                                               1604 08928000
         AH    @15,EXCCWCNT(,@03)                                  1604 08929000
         B     @DE01604                                            1604 08930000
@DL01604 DS    0H                                                  1605 08931000
*             LOCADDR(RCTR)=NTFNDPTR;/*                      @ZA11014*/ 08932000
         LH    @03,RCTR                                            1605 08933000
         MH    @03,@CH00279                                        1605 08934000
         L     @15,@PC00001+8                                      1605 08935000
         L     @01,EXLOCPTR(,@15)                                  1605 08936000
         ICM   @00,15,NTFNDPTR                                     1605 08937000
         AL    @01,@CF04425                                        1605 08938000
         ST    @00,LOCADDR(@03,@01)                                1605 08939000
*             LOCRCKD(RCTR)=RCSRUNCO;/*                      @ZA11014*/ 08940000
         LH    @03,RCTR                                            1606 08941000
         MH    @03,@CH00279                                        1606 08942000
         L     @15,@PC00001+8                                      1606 08943000
         L     @01,EXLOCPTR(,@15)                                  1606 08944000
         LH    @00,RCSRUNCO                                        1606 08945000
         AL    @01,@CF04427                                        1606 08946000
         STH   @00,LOCRCKD-6(@03,@01)                              1606 08947000
*           END;                    /*                       @ZA11014   08948000
*                                                            @ZA11014*/ 08949000
         LA    @15,1                                               1607 08950000
         AH    @15,RCTR                                            1607 08951000
@DE01604 STH   @15,RCTR                                            1607 08952000
         CH    @15,LOCENT                                          1607 08953000
         BNH   @DL01604                                            1607 08954000
*           TESTRC=LOCRCKD(EXRECNUM+1);/*                    @ZA11014*/ 08955000
         L     @03,@PC00001+8                                      1608 08956000
         SLR   @15,@15                                             1608 08957000
         IC    @15,EXRECNUM(,@03)                                  1608 08958000
         MH    @15,@CH00279                                        1608 08959000
         L     @03,@PC00001+8                                      1608 08960000
         L     @03,EXLOCPTR(,@03)                                  1608 08961000
         LH    @03,LOCRCKD(@15,@03)                                1608 08962000
         STH   @03,TESTRC                                          1608 08963000
*         END;                      /*                       @ZA11014   08964000
*                                                            @ZA11014*/ 08965000
*       ELSE                        /*                       @ZA11014*/ 08966000
*         DO;                       /*                       @ZA11014   08967000
*                                                            @ZA11014   08968000
*                                                            @ZA11014*/ 08969000
*                                                                  1610 08970000
         B     @RC01602                                            1610 08971000
@RF01602 DS    0H                                                  1611 08972000
*           /*********************************************************/ 08973000
*           /*                                                       */ 08974000
*           /* ENSURE AT LEAST RECORD ONE HAS BEEN READ      @ZA11014*/ 08975000
*           /*                                                       */ 08976000
*           /*********************************************************/ 08977000
*                                                                  1611 08978000
*           IF CNTCCWS>NONRDCT      /*                       @ZA11014*/ 08979000
*             THEN                  /*                       @ZA11014*/ 08980000
         LH    @03,CNTCCWS                                         1611 08981000
         CH    @03,NONRDCT                                         1611 08982000
         BNH   @RF01611                                            1611 08983000
*             DO;                   /*                       @ZA11014   08984000
*                                                            @ZA11014*/ 08985000
*                                                                  1612 08986000
*               /*****************************************************/ 08987000
*               /*                                                   */ 08988000
*               /* AT LEAST RECORD 1 HAS BEEN READ           @ZA11014*/ 08989000
*               /* CALC INDEX INTO CCW LIST                  @ZA11014*/ 08990000
*               /*                                                   */ 08991000
*               /*****************************************************/ 08992000
*                                                                  1613 08993000
*               CCWCNT=NONRDCT+RECCNTSV;/*                   @ZA11014   08994000
*                                                            @ZA11014*/ 08995000
*                                                                  1613 08996000
         L     @03,@PC00001+8                                      1613 08997000
         LH    @15,NONRDCT                                         1613 08998000
         AH    @15,RECCNTSV(,@03)                                  1613 08999000
         STH   @15,CCWCNT                                          1613 09000000
*               /*****************************************************/ 09001000
*               /*                                                   */ 09002000
*               /* CALCULATE NUM OF CCWS IN LOOP THIS PASS   @ZA11014*/ 09003000
*               /* RECCNT WILL ALWAYS BE ONE LESS THAN LAST  @ZA11014*/ 09004000
*               /* CCW EXECUTED SINCE THAT CCW               @ZA11014*/ 09005000
*               /* WILL BE EXAMINED WHEN OUT OF LOOP         @ZA11014*/ 09006000
*               /*                                                   */ 09007000
*               /*****************************************************/ 09008000
*                                                                  1614 09009000
*               RECCNT=CNTCCWS-NONRDCT-RECCNTSV;/*           @ZA11014   09010000
*                                                            @ZA11014*/ 09011000
*                                                                  1614 09012000
         L     @03,@PC00001+8                                      1614 09013000
         LH    @15,CNTCCWS                                         1614 09014000
         SH    @15,NONRDCT                                         1614 09015000
         L     @14,@PC00001+8                                      1614 09016000
         SH    @15,RECCNTSV(,@14)                                  1614 09017000
         STH   @15,RECCNT(,@03)                                    1614 09018000
*               /*****************************************************/ 09019000
*               /*                                                   */ 09020000
*               /* EXAMINE THE RECORDS ALREADY READ AND SET  @ZA11014*/ 09021000
*               /* THE KEY/DATA RETURN CODES TO OK           @ZA11014*/ 09022000
*               /* SPACE COUNT CCWS WILL BE BYPASSED         @ZA11014*/ 09023000
*               /*                                                   */ 09024000
*               /*****************************************************/ 09025000
*                                                                  1615 09026000
*                                   /*                       @ZA11014*/ 09027000
*                                                                  1615 09028000
*               /*****************************************************/ 09029000
*               /*                                                   */ 09030000
*               /* INITIALIZE LOOP CONTROL                   @ZA11014*/ 09031000
*               /*                                                   */ 09032000
*               /*****************************************************/ 09033000
*                                                                  1615 09034000
*               RCTR=1;             /*                       @ZA11014   09035000
*                                                            @ZA11014*/ 09036000
*                                                                  1615 09037000
         MVC   RCTR(2),@CH00222                                    1615 09038000
*               /*****************************************************/ 09039000
*               /*                                                   */ 09040000
*               /* LOOP FOR THE NUMBER OF CCWS EXECUTED      @ZA11014*/ 09041000
*               /* THE OTHER CHECKS ENSURE THAT THE LOOP     @ZA11014*/ 09042000
*               /* DOES NOT BECOME INFINITE                  @ZA11014*/ 09043000
*               /*                                                   */ 09044000
*               /*****************************************************/ 09045000
*                                                                  1616 09046000
*                                   /*                       @ZA11014*/ 09047000
*               DO WHILE RCTR^>RECCNT&RECCNT^=ZERO/*         @ZA11014*/ 09048000
*                     &LSTRECNM^=MAXRECS;/*                  @ZA11014   09049000
*                                                            @ZA11014*/ 09050000
*                                                                  1616 09051000
         B     @DE01616                                            1616 09052000
@DL01616 DS    0H                                                  1617 09053000
*                 /***************************************************/ 09054000
*                 /*                                                 */ 09055000
*                 /* CHECK TO SEE IF RECORD FOR THIS RECORD  @ZA11014*/ 09056000
*                 /* NUMBER EXISTS                           @ZA11014*/ 09057000
*                 /*                                                 */ 09058000
*                 /***************************************************/ 09059000
*                                                                  1617 09060000
*                 IF LOCADDR(LSTRECNM+1)^=NTFNDPTR/*         @ZA11014*/ 09061000
*                   THEN            /*                       @ZA11014*/ 09062000
         L     @03,@PC00001+8                                      1617 09063000
         LH    @03,LSTRECNM(,@03)                                  1617 09064000
         MH    @03,@CH00279                                        1617 09065000
         L     @15,@PC00001+8                                      1617 09066000
         L     @01,EXLOCPTR(,@15)                                  1617 09067000
         L     @03,LOCADDR(@03,@01)                                1617 09068000
         ICM   @15,15,NTFNDPTR                                     1617 09069000
         CLR   @03,@15                                             1617 09070000
         BE    @RF01617                                            1617 09071000
*                   DO;             /*                       @ZA11014*/ 09072000
*                                                                  1618 09073000
*                     /***********************************************/ 09074000
*                     /*                                             */ 09075000
*                     /* THIS ENTRY FOR PROPER RECORD NUMBER @ZA11014*/ 09076000
*                     /* LOOP FOR THE NUMBER OF CCWS EXECUTED@0Z11014*/ 09077000
*                     /* THIS TIME TO DETERMINE HOW MANY RECS@0Z11014*/ 09078000
*                     /* WERE ACTUALLY READ - COUNT CCWS DONT@0Z11014*/ 09079000
*                     /* COUNT                               @0Z11014*/ 09080000
*                     /*                                             */ 09081000
*                     /***********************************************/ 09082000
*                                                                  1619 09083000
*                     IF CCWOP^=SPCNTOP&CCWOP^=RDCNTOP/*     @0Z11014*/ 09084000
*                       THEN        /*                       @ZA11014*/ 09085000
*                                                                  1619 09086000
         LH    @03,CCWCNT                                          1619 09087000
         SLA   @03,3                                               1619 09088000
         L     @01,IOCTLBKP                                        1619 09089000
         LA    @03,IOXCCW-8(@03,@01)                               1619 09090000
         CLC   CCWOP(1,@03),SPCNTOP                                1619 09091000
         BE    @RF01619                                            1619 09092000
         LH    @03,CCWCNT                                          1619 09093000
         SLA   @03,3                                               1619 09094000
         L     @01,IOCTLBKP                                        1619 09095000
         LA    @03,IOXCCW-8(@03,@01)                               1619 09096000
         CLC   CCWOP(1,@03),RDCNTOP                                1619 09097000
         BE    @RF01619                                            1619 09098000
*                       /*********************************************/ 09099000
*                       /*                                           */ 09100000
*                       /* NOT A COUNT CCW                   @0Z11014*/ 09101000
*                       /* INCREMENT TO NEXT RECORD NUM      @ZA11014*/ 09102000
*                       /*                                           */ 09103000
*                       /*********************************************/ 09104000
*                                                                  1620 09105000
*                       DO;         /*                       @ZA11014*/ 09106000
*                         LSTRECNM=LSTRECNM+1;/*             @ZA11014*/ 09107000
         L     @03,@PC00001+8                                      1621 09108000
         L     @15,@PC00001+8                                      1621 09109000
         LA    @14,1                                               1621 09110000
         AH    @14,LSTRECNM(,@15)                                  1621 09111000
         STH   @14,LSTRECNM(,@03)                                  1621 09112000
*                       END;        /*                       @ZA11014*/ 09113000
*                     ELSE                                         1623 09114000
*                       ;           /*                       @ZA11014   09115000
*                                                            @ZA11014*/ 09116000
*                                                                  1623 09117000
@RF01619 DS    0H                                                  1624 09118000
*                     /***********************************************/ 09119000
*                     /*                                             */ 09120000
*                     /* INCREMENT POINTER IN CCW CHAIN      @ZA11014*/ 09121000
*                     /*                                             */ 09122000
*                     /***********************************************/ 09123000
*                                                                  1624 09124000
*                     CCWCNT=CCWCNT+1;/*                     @ZA11014   09125000
*                                                            @ZA11014*/ 09126000
*                                                                  1624 09127000
         LH    @03,CCWCNT                                          1624 09128000
         LA    @03,1(,@03)                                         1624 09129000
         STH   @03,CCWCNT                                          1624 09130000
*                     /***********************************************/ 09131000
*                     /*                                             */ 09132000
*                     /* INCREMENT DO WHILE CONTROL          @ZA11014*/ 09133000
*                     /*                                             */ 09134000
*                     /***********************************************/ 09135000
*                                                                  1625 09136000
*                     RCTR=RCTR+1;  /*                       @ZA11014*/ 09137000
         LH    @03,RCTR                                            1625 09138000
         LA    @03,1(,@03)                                         1625 09139000
         STH   @03,RCTR                                            1625 09140000
*                   END;            /*                       @ZA11014   09141000
*                                                            @ZA11014*/ 09142000
*                 ELSE              /*                       @ZA11014*/ 09143000
*                                                                  1627 09144000
*                   /*************************************************/ 09145000
*                   /*                                               */ 09146000
*                   /* RECORD NUMBER DOESNT EXIST            @ZA11014*/ 09147000
*                   /*                                               */ 09148000
*                   /*************************************************/ 09149000
*                                                                  1627 09150000
*                   DO;             /*                       @ZA11014*/ 09151000
*                                                                  1627 09152000
         B     @RC01617                                            1627 09153000
@RF01617 DS    0H                                                  1628 09154000
*                     /***********************************************/ 09155000
*                     /*                                             */ 09156000
*                     /* INCREMENT NEXT RECORD NUMBER        @ZA11014*/ 09157000
*                     /*                                             */ 09158000
*                     /***********************************************/ 09159000
*                                                                  1628 09160000
*                     LSTRECNM=LSTRECNM+1;/*                 @ZA11014*/ 09161000
         L     @03,@PC00001+8                                      1628 09162000
         L     @15,@PC00001+8                                      1628 09163000
         LA    @14,1                                               1628 09164000
         AH    @14,LSTRECNM(,@15)                                  1628 09165000
         STH   @14,LSTRECNM(,@03)                                  1628 09166000
*                   END;            /*                       @ZA11014   09167000
*                                                            @ZA11014*/ 09168000
*               END;                /* END DO WHILE@ZA11014  @ZA11014*/ 09169000
*                                                                  1630 09170000
@RC01617 DS    0H                                                  1630 09171000
@DE01616 L     @03,@PC00001+8                                      1630 09172000
         LH    @15,RCTR                                            1630 09173000
         CH    @15,RECCNT(,@03)                                    1630 09174000
         BH    @DC01616                                            1630 09175000
         L     @03,@PC00001+8                                      1630 09176000
         CLC   RECCNT(2,@03),ZERO                                  1630 09177000
         BE    @DC01616                                            1630 09178000
         L     @03,@PC00001+8                                      1630 09179000
         CLC   LSTRECNM(2,@03),MAXRECS                             1630 09180000
         BNE   @DL01616                                            1630 09181000
@DC01616 DS    0H                                                  1631 09182000
*               /*****************************************************/ 09183000
*               /*                                                   */ 09184000
*               /* CHECK WHY EXITED FROM DO WHILE            @ZA11014*/ 09185000
*               /*                                                   */ 09186000
*               /*****************************************************/ 09187000
*                                                                  1631 09188000
*               IF LSTRECNM=>MAXRECS|CCWOP=SPCNTOP/*         @ZA11014*/ 09189000
*                   |CCWOP=RDCNTOP  /*                       @0Z11014*/ 09190000
*                 THEN              /*                       @ZA11014*/ 09191000
*                                                                  1631 09192000
         L     @03,@PC00001+8                                      1631 09193000
         LH    @03,LSTRECNM(,@03)                                  1631 09194000
         CH    @03,MAXRECS                                         1631 09195000
         BNL   @RT01631                                            1631 09196000
         LH    @03,CCWCNT                                          1631 09197000
         SLA   @03,3                                               1631 09198000
         L     @01,IOCTLBKP                                        1631 09199000
         LA    @03,IOXCCW-8(@03,@01)                               1631 09200000
         CLC   CCWOP(1,@03),SPCNTOP                                1631 09201000
         BE    @RT01631                                            1631 09202000
         LH    @03,CCWCNT                                          1631 09203000
         SLA   @03,3                                               1631 09204000
         L     @01,IOCTLBKP                                        1631 09205000
         LA    @03,IOXCCW-8(@03,@01)                               1631 09206000
         CLC   CCWOP(1,@03),RDCNTOP                                1631 09207000
         BNE   @RF01631                                            1631 09208000
@RT01631 DS    0H                                                  1632 09209000
*                 /***************************************************/ 09210000
*                 /*                                                 */ 09211000
*                 /* LAST RECORD GREATER THAN MAXIMUM        @ZA11014*/ 09212000
*                 /* ON TRACK- OR STOPPED ON COUNT           @0Z11014*/ 09213000
*                 /* READ WHICH IS A NO-NO                   @0Z11014*/ 09214000
*                 /* A PROBLEM EXISTS--UNEXPECTED RESUL@ZA11014      */ 09215000
*                 /*                                                 */ 09216000
*                 /***************************************************/ 09217000
*                                                                  1632 09218000
*                 TESTRC=RCSRUEX;   /*                       @ZA11014*/ 09219000
         LH    @03,RCSRUEX                                         1632 09220000
         STH   @03,TESTRC                                          1632 09221000
*               ELSE                /*                       @ZA11014*/ 09222000
*                 DO;               /*                       @ZA11014*/ 09223000
*                                                                  1633 09224000
         B     @RC01631                                            1633 09225000
@RF01631 DS    0H                                                  1634 09226000
*                   /*************************************************/ 09227000
*                   /*                                               */ 09228000
*                   /* ALL THE KEY/DATA RET CDS HAVE BEEN@ZA11014 SET*/ 09229000
*                   /* EXCEPT FOR LAST CCW EXEC'ED           @ZA11014*/ 09230000
*                   /* UNLESS LAST CCW WAS FOR EOF.          @ZA25908*/ 09231000
*                   /* SET THE CURRENT RET CODE IN LOCTAB@ZA11014    */ 09232000
*                   /* ENTRY FOR LATEST RECORD NUMBER        @ZA11014*/ 09233000
*                   /*                                               */ 09234000
*                   /*************************************************/ 09235000
*                                                                  1634 09236000
*                   IF LOCRCKD(LSTRECNM+1)=RCNOERR THEN/*    @ZA25908*/ 09237000
         L     @03,@PC00001+8                                      1634 09238000
         LH    @03,LSTRECNM(,@03)                                  1634 09239000
         MH    @03,@CH00279                                        1634 09240000
         L     @15,@PC00001+8                                      1634 09241000
         L     @01,EXLOCPTR(,@15)                                  1634 09242000
         LH    @03,LOCRCKD(@03,@01)                                1634 09243000
         CH    @03,RCNOERR                                         1634 09244000
         BNE   @RF01634                                            1634 09245000
*                     LOCRCKD(LSTRECNM+1)=TESTRC;/*          @ZA25908   09246000
*                                                            @ZA11014*/ 09247000
*                                                                  1635 09248000
         L     @03,@PC00001+8                                      1635 09249000
         LH    @03,LSTRECNM(,@03)                                  1635 09250000
         MH    @03,@CH00279                                        1635 09251000
         L     @15,@PC00001+8                                      1635 09252000
         L     @01,EXLOCPTR(,@15)                                  1635 09253000
         LH    @00,TESTRC                                          1635 09254000
         STH   @00,LOCRCKD(@03,@01)                                1635 09255000
*                   /*************************************************/ 09256000
*                   /*                                               */ 09257000
*                   /* UPDATE NUM OF CCWS PROCESSED SO FA@ZA11014    */ 09258000
*                   /*                                               */ 09259000
*                   /*************************************************/ 09260000
*                                                                  1636 09261000
*                   RECCNTSV=RECCNTSV+RECCNT;/*              @0Z11014   09262000
*                                                            @ZA11014*/ 09263000
*                                                                  1636 09264000
@RF01634 L     @03,@PC00001+8                                      1636 09265000
         L     @15,@PC00001+8                                      1636 09266000
         L     @14,@PC00001+8                                      1636 09267000
         LH    @15,RECCNTSV(,@15)                                  1636 09268000
         AH    @15,RECCNT(,@14)                                    1636 09269000
         STH   @15,RECCNTSV(,@03)                                  1636 09270000
*                   /*************************************************/ 09271000
*                   /*                                               */ 09272000
*                   /* SET LAST REC NUM READ IN RDARG        @ZA11014*/ 09273000
*                   /* IF LAST CCW EXECUTED WAS A READ       @ZA11014*/ 09274000
*                   /* KEY/DATA IT IS POSSIBLE THAT THE      @ZA11014*/ 09275000
*                   /* DATA WAS NOT TRANSFERRED-THUS         @ZA11014*/ 09276000
*                   /* ENSURE THAT WE GET CALLED AGAIN       @ZA11014*/ 09277000
*                   /*                                               */ 09278000
*                   /*************************************************/ 09279000
*                                                                  1637 09280000
*                   IF CCWOP=RDKDOP /*                       @ZA11014*/ 09281000
*                     THEN          /*                       @ZA11014*/ 09282000
         LH    @03,CCWCNT                                          1637 09283000
         SLA   @03,3                                               1637 09284000
         L     @01,IOCTLBKP                                        1637 09285000
         LA    @03,IOXCCW-8(@03,@01)                               1637 09286000
         CLC   CCWOP(1,@03),RDKDOP                                 1637 09287000
         BNE   @RF01637                                            1637 09288000
*                     EXCCWCNT=LSTRECNM-1;/*                 @ZA11014*/ 09289000
         L     @03,@PC00001+8                                      1638 09290000
         L     @15,@PC00001+8                                      1638 09291000
         LH    @15,LSTRECNM(,@15)                                  1638 09292000
         BCTR  @15,0                                               1638 09293000
         STH   @15,EXCCWCNT(,@03)                                  1638 09294000
*                   ELSE            /*                       @ZA11014*/ 09295000
*                     EXCCWCNT=LSTRECNM;/*                   @ZA11014   09296000
*                                                            @ZA11014*/ 09297000
         B     @RC01637                                            1639 09298000
@RF01637 L     @03,@PC00001+8                                      1639 09299000
         L     @15,@PC00001+8                                      1639 09300000
         LH    @15,LSTRECNM(,@15)                                  1639 09301000
         STH   @15,EXCCWCNT(,@03)                                  1639 09302000
*                 END;              /*                       @ZA11014*/ 09303000
*                                                                  1640 09304000
*               /*****************************************************/ 09305000
*               /*                                                   */ 09306000
*               /* END OF AT LEAST RECORD ONE HAS BEEN READ  @ZA11014*/ 09307000
*               /*                                                   */ 09308000
*               /*****************************************************/ 09309000
*                                                                  1641 09310000
*             END;                  /*                       @ZA11014   09311000
*                                                            @ZA11014   09312000
*                                                            @ZA11014*/ 09313000
*                                                                  1641 09314000
*           /*********************************************************/ 09315000
*           /*                                                       */ 09316000
*           /* RETURNED FROM UEXCP BEFORE RECORD ONE READ    @ZA11014*/ 09317000
*           /* UNEXPECTED RESULTS                            @ZA11014*/ 09318000
*           /*                                                       */ 09319000
*           /*********************************************************/ 09320000
*                                                                  1642 09321000
*           ELSE                    /*                       @ZA11014*/ 09322000
*                                                                  1642 09323000
*             /*******************************************************/ 09324000
*             /*                                                     */ 09325000
*             /* SET TESTRC                                  @ZA11014*/ 09326000
*             /*                                                     */ 09327000
*             /*******************************************************/ 09328000
*                                                                  1642 09329000
*             TESTRC=RCSRUEX;       /*                       @ZA11014   09330000
*                                                            @ZA11014*/ 09331000
*                                                                  1642 09332000
         B     @RC01611                                            1642 09333000
@RF01611 LH    @03,RCSRUEX                                         1642 09334000
         STH   @03,TESTRC                                          1642 09335000
*           /*********************************************************/ 09336000
*           /*                                                       */ 09337000
*           /* GOT AT LEAST AS FAR AS LAST TIME ELSE         @ZA11014*/ 09338000
*           /*                                                       */ 09339000
*           /*********************************************************/ 09340000
*                                                                  1643 09341000
*         END;                      /*                       @ZA11014   09342000
*                                                            @ZA11014*/ 09343000
*                                                                  1643 09344000
@RC01611 DS    0H                                                  1644 09345000
*       /*************************************************************/ 09346000
*       /*                                                           */ 09347000
*       /* END OF OK TO CONTINUE                             @ZA11014*/ 09348000
*       /*                                                           */ 09349000
*       /*************************************************************/ 09350000
*                                                                  1644 09351000
*     END;                          /*                       @ZA11014   09352000
*                                                            @ZA11014   09353000
*                                                            @ZA11014   09354000
*                                                            @ZA11014*/ 09355000
*                                                                  1644 09356000
@RC01602 DS    0H                                                  1645 09357000
*   /*****************************************************************/ 09358000
*   /*                                                               */ 09359000
*   /* RETURN WITH RETURN CODE FROM ISSUEXCP                 @ZA11014*/ 09360000
*   /*                                                               */ 09361000
*   /*****************************************************************/ 09362000
*                                                                  1645 09363000
*   RETURN CODE(TESTRC);            /*                       @ZA11014   09364000
*                                                            @ZA11014*/ 09365000
@RF01590 LH    @15,TESTRC                                          1645 09366000
         L     @14,@SA00024                                        1645 09367000
         LM    @00,@12,@SA00024+8                                  1645 09368000
         BR    @14                                                 1645 09369000
*   END READKD;                     /*                       @ZA11014   09370000
*                                                            @ZA11014   09371000
*                                                            @ZA11014*/ 09372000
*                                                                  1647 09373000
*/***********************************************************@ZA11014*/ 09374000
*/*                                                          @ZA11014*/ 09375000
*/*  PROCEDURE NAME - SETCCW                                 @ZA11014*/ 09376000
*/*                                                          @ZA11014*/ 09377000
*/*  FUNCTION - BUILTS THE FOLLOWING CCW LIST TO READ IN ALL @ZA11014*/ 09378000
*/*              THE COUNT FIELDS ON A TRACK                 @ZA11014*/ 09379000
*/*                                                          @ZA11014*/ 09380000
*/*                 SET SECTOR ZERO                          @ZA11014*/ 09381000
*/*                 READ R0                                  @ZA11014*/ 09382000
*/*                 TIC *+8                                  @ZA11014*/ 09383000
*/*                 READ COUNT                               @ZA11014*/ 09384000
*/*                     ^                                    @ZA11014*/ 09385000
*/*                     ^                                    @ZA11014*/ 09386000
*/*                 READ COUNT                               @ZA11014*/ 09387000
*/*                                                          @ZA11014*/ 09388000
*/*              IT BUILDS A CCW LIST OF 122 READ COUNTS TO  @ZA20248*/ 09389000
*/*              ENSURE ALL POSSIBLE RECORDS WILL BE READ    @ZA11014*/ 09390000
*/*             RETURNS                                      @ZA11014*/ 09391000
*/*                                                          @ZA11014*/ 09392000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 09393000
*/*                                                          @ZA11014*/ 09394000
*/*                                                          @ZA11014*/ 09395000
*/*                                                          @ZA11014*/ 09396000
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/ 09397000
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/ 09398000
*/*                                                          @ZA11014*/ 09399000
*/*  OUTPUT - CCW LIST IN IOXCCWS                            @ZA11014*/ 09400000
*/*           RETURN CODE OF ZERO IN REGISTER 15             @ZA11014*/ 09401000
*/*                                                          @ZA11014*/ 09402000
*/*                                                          @ZA11014*/ 09403000
*/*                                                          @ZA11014*/ 09404000
*/***********************************************************@ZA11014*/ 09405000
*                                                                  1647 09406000
*                                   /*                       @ZA11014*/ 09407000
*SETCCW:                                                           1647 09408000
*   PROC;                           /*                       @ZA11014   09409000
*                                                            @ZA11014*/ 09410000
*                                                                  1647 09411000
SETCCW   STM   @14,@12,12(@13)                                     1647 09412000
*   /*****************************************************************/ 09413000
*   /*                                                               */ 09414000
*   /* SET TRACE ID                                          @ZA11014*/ 09415000
*   /*                                                               */ 09416000
*   /*****************************************************************/ 09417000
*                                                                  1648 09418000
*   OLDERID2=NEWERID2;                                             1648 09419000
         L     @03,@PC00001                                        1648 09420000
         L     @03,GDTTR2(,@03)                                    1648 09421000
         L     @15,@PC00001                                        1648 09422000
         L     @01,GDTTR2(,@15)                                    1648 09423000
         MVC   @TS00001(95),NEWERID2(@01)                          1648 09424000
         MVC   OLDERID2(95,@03),@TS00001                           1648 09425000
*   NEWID2='IOCW';                  /*                       @ZA11014   09426000
*                                                            @ZA11014*/ 09427000
*                                                                  1649 09428000
         L     @03,@PC00001                                        1649 09429000
         L     @03,GDTTR2(,@03)                                    1649 09430000
         MVC   NEWID2(4,@03),@CC04361                              1649 09431000
*   /*****************************************************************/ 09432000
*   /*                                                               */ 09433000
*   /* INIT INDEX INTO CCW LIST TO START AT BEG OF CHN       @ZA11014*/ 09434000
*   /*                                                               */ 09435000
*   /*****************************************************************/ 09436000
*                                                                  1650 09437000
*   CCWCNT=1;                       /*                       @ZA11014   09438000
*                                                            @ZA11014*/ 09439000
*                                                                  1650 09440000
         MVC   CCWCNT(2),@CH00222                                  1650 09441000
*   /*****************************************************************/ 09442000
*   /*                                                               */ 09443000
*   /* SET FIRST CCW TO 'SET SECTOR ZERO'                    @ZA11014*/ 09444000
*   /*                                                               */ 09445000
*   /*****************************************************************/ 09446000
*                                                                  1651 09447000
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/ 09448000
         LH    @03,CCWCNT                                          1651 09449000
         SLA   @03,3                                               1651 09450000
         L     @01,IOCTLBKP                                        1651 09451000
         LA    @03,IOXCCW-8(@03,@01)                               1651 09452000
         MVC   CCW(8,@03),CCWRSSEC                                 1651 09453000
*   CCWADDR=ADDR(ZERO);             /*                       @ZA11014   09454000
*                                                            @ZA11014*/ 09455000
*                                                                  1652 09456000
         LH    @03,CCWCNT                                          1652 09457000
         SLA   @03,3                                               1652 09458000
         L     @01,IOCTLBKP                                        1652 09459000
         LA    @03,IOXCCW-8(@03,@01)                               1652 09460000
         LA    @15,ZERO                                            1652 09461000
         STCM  @15,7,CCWADDR(@03)                                  1652 09462000
*   /*****************************************************************/ 09463000
*   /*                                                               */ 09464000
*   /* INIT ADDR OF WHERE TO READ COUNTS INTO                @ZA11014*/ 09465000
*   /*                                                               */ 09466000
*   /*****************************************************************/ 09467000
*                                                                  1653 09468000
*   RCNTPTR=ADDR(RBUFF);            /*                       @ZA11014   09469000
*                                                            @ZA11014*/ 09470000
*                                                                  1653 09471000
         L     @03,RRIOARPT                                        1653 09472000
         LA    @03,RBUFF(,@03)                                     1653 09473000
         STCM  @03,7,RCNTPTR                                       1653 09474000
*   /*****************************************************************/ 09475000
*   /*                                                               */ 09476000
*   /* INCREMENT CCW INDEX POINTER                           @ZA11014*/ 09477000
*   /*                                                               */ 09478000
*   /*****************************************************************/ 09479000
*                                                                  1654 09480000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   09481000
*                                                            @ZA11014*/ 09482000
*                                                                  1654 09483000
         LH    @03,CCWCNT                                          1654 09484000
         LA    @03,1(,@03)                                         1654 09485000
         STH   @03,CCWCNT                                          1654 09486000
*   /*****************************************************************/ 09487000
*   /*                                                               */ 09488000
*   /* SET READ R0 CCW                                       @ZA11014*/ 09489000
*   /*                                                               */ 09490000
*   /*****************************************************************/ 09491000
*                                                                  1655 09492000
*   CCW=CCWRRR0;                    /*                       @ZA11014   09493000
*                                                            @ZA11014*/ 09494000
*                                                                  1655 09495000
         LH    @03,CCWCNT                                          1655 09496000
         SLA   @03,3                                               1655 09497000
         L     @01,IOCTLBKP                                        1655 09498000
         LA    @03,IOXCCW-8(@03,@01)                               1655 09499000
         MVC   CCW(8,@03),CCWRRR0                                  1655 09500000
*   /*****************************************************************/ 09501000
*   /*                                                               */ 09502000
*   /* READ INTO BUFFER                                      @ZA11014*/ 09503000
*   /*                                                               */ 09504000
*   /*****************************************************************/ 09505000
*                                                                  1656 09506000
*   CCWADDR=RCNTPTR;                /*                       @ZA11014   09507000
*                                                            @ZA11014*/ 09508000
*                                                                  1656 09509000
         LH    @03,CCWCNT                                          1656 09510000
         SLA   @03,3                                               1656 09511000
         L     @01,IOCTLBKP                                        1656 09512000
         LA    @03,IOXCCW-8(@03,@01)                               1656 09513000
         MVC   CCWADDR(3,@03),RCNTPTR                              1656 09514000
*   /*****************************************************************/ 09515000
*   /*                                                               */ 09516000
*   /* INCREMENT PAST R0 COUNT AND DATA IN BUFFER            @ZA11014*/ 09517000
*   /*                                                               */ 09518000
*   /*****************************************************************/ 09519000
*                                                                  1657 09520000
*   RCNTPTR=RCNTPTR+LENR0;          /*                       @ZA11014   09521000
*                                                            @ZA11014*/ 09522000
*                                                                  1657 09523000
         L     @03,RCNTPTR-1                                       1657 09524000
         LA    @03,0(,@03)                                         1657 09525000
         AH    @03,LENR0                                           1657 09526000
         STCM  @03,7,RCNTPTR                                       1657 09527000
*   /*****************************************************************/ 09528000
*   /*                                                               */ 09529000
*   /* INCREMENT CCW INDEX POINTER                           @ZA11014*/ 09530000
*   /*                                                               */ 09531000
*   /*****************************************************************/ 09532000
*                                                                  1658 09533000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   09534000
*                                                            @ZA11014*/ 09535000
*                                                                  1658 09536000
         LH    @03,CCWCNT                                          1658 09537000
         LA    @03,1(,@03)                                         1658 09538000
         STH   @03,CCWCNT                                          1658 09539000
*   /*****************************************************************/ 09540000
*   /*                                                               */ 09541000
*   /* SET UP TO TIC TO *+8 IN CASE HAVE TO OVERLAY LATE@ZA11014     */ 09542000
*   /*                                                               */ 09543000
*   /*****************************************************************/ 09544000
*                                                                  1659 09545000
*   CCW=CCWTIC;                     /*                       @ZA11014*/ 09546000
         LH    @03,CCWCNT                                          1659 09547000
         SLA   @03,3                                               1659 09548000
         L     @01,IOCTLBKP                                        1659 09549000
         LA    @03,IOXCCW-8(@03,@01)                               1659 09550000
         MVC   CCW(8,@03),CCWTIC                                   1659 09551000
*   CCWADDR=ADDR(IOXCCW(CCWCNT+1)); /*                       @ZA11014   09552000
*                                                            @ZA11014*/ 09553000
*                                                                  1660 09554000
         LH    @03,CCWCNT                                          1660 09555000
         SLA   @03,3                                               1660 09556000
         L     @01,IOCTLBKP                                        1660 09557000
         LA    @03,IOXCCW-8(@03,@01)                               1660 09558000
         LH    @15,CCWCNT                                          1660 09559000
         SLA   @15,3                                               1660 09560000
         L     @01,IOCTLBKP                                        1660 09561000
         LA    @15,IOXCCW(@15,@01)                                 1660 09562000
         STCM  @15,7,CCWADDR(@03)                                  1660 09563000
*   /*****************************************************************/ 09564000
*   /*                                                               */ 09565000
*   /* INCREMENT CCW INDEX POINTER                           @ZA11014*/ 09566000
*   /*                                                               */ 09567000
*   /*****************************************************************/ 09568000
*                                                                  1661 09569000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   09570000
*                                                            @ZA11014*/ 09571000
*                                                                  1661 09572000
         LH    @03,CCWCNT                                          1661 09573000
         LA    @03,1(,@03)                                         1661 09574000
         STH   @03,CCWCNT                                          1661 09575000
*   /*****************************************************************/ 09576000
*   /*                                                               */ 09577000
*   /* SET REST OF CCWS TO READ COUNT CCWS                   @ZA11014*/ 09578000
*   /*                                                               */ 09579000
*   /*****************************************************************/ 09580000
*                                                                  1662 09581000
*   DO CCWCNT=CCWCNT TO(MAXRECS+NONRDCT);/*                  @ZA11014   09582000
*                                                            @ZA11014*/ 09583000
*                                                                  1662 09584000
         LH    @03,CCWCNT                                          1662 09585000
         B     @DE01662                                            1662 09586000
@DL01662 DS    0H                                                  1663 09587000
*     /***************************************************************/ 09588000
*     /*                                                             */ 09589000
*     /* SET CCW TO READ COUNT - INTO BUFFER                 @ZA11014*/ 09590000
*     /*                                                             */ 09591000
*     /***************************************************************/ 09592000
*                                                                  1663 09593000
*     CCW=CCWRRCNT;                 /*                       @ZA11014*/ 09594000
         LH    @03,CCWCNT                                          1663 09595000
         SLA   @03,3                                               1663 09596000
         L     @01,IOCTLBKP                                        1663 09597000
         LA    @03,IOXCCW-8(@03,@01)                               1663 09598000
         MVC   CCW(8,@03),CCWRRCNT                                 1663 09599000
*     CCWADDR=RCNTPTR;              /*                       @ZA11014   09600000
*                                                            @ZA11014*/ 09601000
*                                                                  1664 09602000
         LH    @03,CCWCNT                                          1664 09603000
         SLA   @03,3                                               1664 09604000
         L     @01,IOCTLBKP                                        1664 09605000
         LA    @03,IOXCCW-8(@03,@01)                               1664 09606000
         MVC   CCWADDR(3,@03),RCNTPTR                              1664 09607000
*     /***************************************************************/ 09608000
*     /*                                                             */ 09609000
*     /* INCREMENT POINTER IN BUFFER                         @ZA11014*/ 09610000
*     /*                                                             */ 09611000
*     /***************************************************************/ 09612000
*                                                                  1665 09613000
*     RCNTPTR=RCNTPTR+LENCNT;       /*                       @ZA11014*/ 09614000
         L     @03,RCNTPTR-1                                       1665 09615000
         LA    @03,0(,@03)                                         1665 09616000
         AH    @03,LENCNT                                          1665 09617000
         STCM  @03,7,RCNTPTR                                       1665 09618000
*   END;                            /*                       @ZA11014   09619000
*                                                            @ZA11014*/ 09620000
*                                                                  1666 09621000
         LA    @03,1                                               1666 09622000
         AH    @03,CCWCNT                                          1666 09623000
         STH   @03,CCWCNT                                          1666 09624000
@DE01662 LH    @15,MAXRECS                                         1666 09625000
         AH    @15,NONRDCT                                         1666 09626000
         CR    @03,@15                                             1666 09627000
         BNH   @DL01662                                            1666 09628000
*   /*****************************************************************/ 09629000
*   /*                                                               */ 09630000
*   /* SET INDEX TO LAST READ COUNT                          @ZA11014*/ 09631000
*   /*                                                               */ 09632000
*   /*****************************************************************/ 09633000
*                                                                  1667 09634000
*   CCWCNT=CCWCNT-1;                /*                       @ZA11014   09635000
*                                                            @ZA11014*/ 09636000
*                                                                  1667 09637000
         LH    @03,CCWCNT                                          1667 09638000
         BCTR  @03,0                                               1667 09639000
         STH   @03,CCWCNT                                          1667 09640000
*   /*****************************************************************/ 09641000
*   /*                                                               */ 09642000
*   /* TURN OFF COMMAND CHAINING BIT                         @ZA11014*/ 09643000
*   /*                                                               */ 09644000
*   /*****************************************************************/ 09645000
*                                                                  1668 09646000
*   CCWCMDCH=OFF;                   /*                       @ZA11014   09647000
*                                                            @ZA11014*/ 09648000
*                                                                  1668 09649000
         LH    @03,CCWCNT                                          1668 09650000
         SLA   @03,3                                               1668 09651000
         L     @01,IOCTLBKP                                        1668 09652000
         LA    @03,IOXCCW-8(@03,@01)                               1668 09653000
         NI    CCWCMDCH(@03),B'10111111'                           1668 09654000
*   /*****************************************************************/ 09655000
*   /*                                                               */ 09656000
*   /* SET RETURN CODE OK                                    @ZA11014*/ 09657000
*   /*                                                               */ 09658000
*   /*****************************************************************/ 09659000
*                                                                  1669 09660000
*   TESTRC=0;                       /*                       @ZA11014*/ 09661000
         SLR   @03,@03                                             1669 09662000
         STH   @03,TESTRC                                          1669 09663000
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/ 09664000
         LH    @15,TESTRC                                          1670 09665000
         L     @14,12(,@13)                                        1670 09666000
         LM    @00,@12,20(@13)                                     1670 09667000
         BR    @14                                                 1670 09668000
*   END SETCCW;                     /*                       @ZA11014*/ 09669000
*                                                                  1672 09670000
*/***********************************************************@ZA11014*/ 09671000
*/*                                                          @ZA11014*/ 09672000
*/*  PROCEDURE NAME - SPACCR                                 @ZA11014*/ 09673000
*/*                                                          @ZA11014*/ 09674000
*/*  FUNCTION - TO BYPASS A CCW IN THE READ COUNT CHAIN      @ZA11014*/ 09675000
*/*              WHOSE COUNT FIELD IS BAD                    @ZA11014*/ 09676000
*/*             FOR A RECORD ZERO REQUEST THE READ RECORD    @ZA11014*/ 09677000
*/*              ZERO CCW WILL BE REPLACED WITH A SEARCH     @ZA11014*/ 09678000
*/*              ID EQUAL ON RECORD ZERO                     @ZA11014*/ 09679000
*/*             FOR A NON-RECORD ZERO REQUEST, THE READ COUNT@ZA11014*/ 09680000
*/*              CCW WILL BE REPLACED BY A SPACE COUNT CCW   @ZA11014*/ 09681000
*/*             RETURNS                                      @ZA11014*/ 09682000
*/*                                                          @ZA11014*/ 09683000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 09684000
*/*                                                          @ZA11014*/ 09685000
*/*                                                          @ZA11014*/ 09686000
*/*                                                          @ZA11014*/ 09687000
*/*  INPUT - CCW LIST IN IOXCCWS                             @ZA11014*/ 09688000
*/*          EXCCWCNT FROM EXWRARG                           @ZA11014*/ 09689000
*/*          EXRWKDLN FROM EXWRARG                           @ZA11014*/ 09690000
*/*                                                          @ZA11014*/ 09691000
*/*  OUTPUT - MODIFIED CCW CHAIN                             @ZA11014*/ 09692000
*/*           RETURN CODE OF ZERO IN REGISTER 15             @ZA11014*/ 09693000
*/*                                                          @ZA11014*/ 09694000
*/*                                                          @ZA11014*/ 09695000
*/*                                                          @ZA11014*/ 09696000
*/***********************************************************@ZA11014*/ 09697000
*                                                                  1672 09698000
*                                   /*                       @ZA11014*/ 09699000
*SPACCR:                                                           1672 09700000
*   PROC;                           /*                       @ZA11014   09701000
*                                                            @ZA11014*/ 09702000
*                                                                  1672 09703000
SPACCR   STM   @14,@12,12(@13)                                     1672 09704000
*   /*****************************************************************/ 09705000
*   /*                                                               */ 09706000
*   /* SET TRACE ID                                          @ZA11014*/ 09707000
*   /*                                                               */ 09708000
*   /*****************************************************************/ 09709000
*                                                                  1673 09710000
*   OLDERID2=NEWERID2;                                             1673 09711000
         L     @03,@PC00001                                        1673 09712000
         L     @03,GDTTR2(,@03)                                    1673 09713000
         L     @15,@PC00001                                        1673 09714000
         L     @01,GDTTR2(,@15)                                    1673 09715000
         MVC   @TS00001(95),NEWERID2(@01)                          1673 09716000
         MVC   OLDERID2(95,@03),@TS00001                           1673 09717000
*   NEWID2='IOSP';                  /*                       @ZA11014   09718000
*                                                            @ZA11014*/ 09719000
*                                                                  1674 09720000
         L     @03,@PC00001                                        1674 09721000
         L     @03,GDTTR2(,@03)                                    1674 09722000
         MVC   NEWID2(4,@03),@CC04365                              1674 09723000
*   /*****************************************************************/ 09724000
*   /*                                                               */ 09725000
*   /* SET UP IOX CONTROL BLOCK POINTER AND RIOAREA PTR      @ZA11014*/ 09726000
*   /*                                                               */ 09727000
*   /*****************************************************************/ 09728000
*                                                                  1675 09729000
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/ 09730000
         L     @03,@PC00001+8                                      1675 09731000
         L     @03,EXRWCTBL(,@03)                                  1675 09732000
         ST    @03,IOCTLBKP                                        1675 09733000
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014   09734000
*                                                            @ZA11014*/ 09735000
*                                                                  1676 09736000
         L     @03,@PC00001+8                                      1676 09737000
         L     @03,EXRWIOAR(,@03)                                  1676 09738000
         ST    @03,RRIOARPT                                        1676 09739000
*   /*****************************************************************/ 09740000
*   /*                                                               */ 09741000
*   /* ESTABLISH ADDRESSABILITY TO R0 COUNT FIELD            @ZA11014*/ 09742000
*   /*                                                               */ 09743000
*   /*****************************************************************/ 09744000
*                                                                  1677 09745000
*   RESPECIFY                                                      1677 09746000
*     RBUF BASED(ADDR(RBUFF));      /*                       @ZA11014   09747000
*                                                            @ZA11014*/ 09748000
*                                                                  1677 09749000
*   /*****************************************************************/ 09750000
*   /*                                                               */ 09751000
*   /* CHECK TO SEE IF REQUEST IS FOR RECORD ZERO            @ZA11014*/ 09752000
*   /*                                                               */ 09753000
*   /*****************************************************************/ 09754000
*                                                                  1678 09755000
*   IF EXCCWCNT=ZERO                /*                       @ZA11014*/ 09756000
*     THEN                          /*                       @ZA11014*/ 09757000
*                                                                  1678 09758000
         L     @03,@PC00001+8                                      1678 09759000
         CLC   EXCCWCNT(2,@03),ZERO                                1678 09760000
         BNE   @RF01678                                            1678 09761000
*     /***************************************************************/ 09762000
*     /*                                                             */ 09763000
*     /* R0 REQUEST-OVERLAY READ CCW WITH SEARCH ID EQ       @ZA11014*/ 09764000
*     /*                                                             */ 09765000
*     /***************************************************************/ 09766000
*                                                                  1679 09767000
*     DO;                           /*                       @ZA11014   09768000
*                                                            @ZA11014*/ 09769000
*                                                                  1679 09770000
*       /*************************************************************/ 09771000
*       /*                                                           */ 09772000
*       /* SET CCW INDEX TO READ R0 CCW                      @ZA11014*/ 09773000
*       /*                                                           */ 09774000
*       /*************************************************************/ 09775000
*                                                                  1680 09776000
*       CCWCNT=R0CHNLOC;            /*                       @ZA11014   09777000
*                                                            @ZA11014*/ 09778000
*                                                                  1680 09779000
         LH    @03,R0CHNLOC                                        1680 09780000
         STH   @03,CCWCNT                                          1680 09781000
*       /*************************************************************/ 09782000
*       /*                                                           */ 09783000
*       /* OVERLAY READ CCW WITH SEARCH ID EQ                @ZA11014*/ 09784000
*       /*                                                           */ 09785000
*       /*************************************************************/ 09786000
*                                                                  1681 09787000
*       CCW=CCWSIDEQ;               /*                       @ZA11014   09788000
*                                                            @ZA11014*/ 09789000
*                                                                  1681 09790000
         LH    @03,CCWCNT                                          1681 09791000
         SLA   @03,3                                               1681 09792000
         L     @01,IOCTLBKP                                        1681 09793000
         LA    @03,IOXCCW-8(@03,@01)                               1681 09794000
         MVC   CCW(8,@03),CCWSIDEQ                                 1681 09795000
*       /*************************************************************/ 09796000
*       /*                                                           */ 09797000
*       /* SET SEARCH ADDR TO R0 COUNT FIELD                 @ZA11014*/ 09798000
*       /*                                                           */ 09799000
*       /*************************************************************/ 09800000
*                                                                  1682 09801000
*       CCWADDR=ADDR(RBCCHHR);      /*                       @ZA11014   09802000
*                                                            @ZA11014*/ 09803000
*                                                                  1682 09804000
         LH    @03,CCWCNT                                          1682 09805000
         SLA   @03,3                                               1682 09806000
         L     @01,IOCTLBKP                                        1682 09807000
         LA    @03,IOXCCW-8(@03,@01)                               1682 09808000
         LA    @15,282                                             1682 09809000
         AL    @15,RRIOARPT                                        1682 09810000
         STCM  @15,7,CCWADDR(@03)                                  1682 09811000
*       /*************************************************************/ 09812000
*       /*                                                           */ 09813000
*       /* INCREMENT TO TIC CCW                              @ZA11014*/ 09814000
*       /*                                                           */ 09815000
*       /*************************************************************/ 09816000
*                                                                  1683 09817000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   09818000
*                                                            @ZA11014*/ 09819000
*                                                                  1683 09820000
         LH    @03,CCWCNT                                          1683 09821000
         LA    @03,1(,@03)                                         1683 09822000
         STH   @03,CCWCNT                                          1683 09823000
*       /*************************************************************/ 09824000
*       /*                                                           */ 09825000
*       /* ENSURE TIC-SET TO TIC TO SID ON R0                @ZA11014*/ 09826000
*       /*                                                           */ 09827000
*       /*************************************************************/ 09828000
*                                                                  1684 09829000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 09830000
         LH    @03,CCWCNT                                          1684 09831000
         SLA   @03,3                                               1684 09832000
         L     @01,IOCTLBKP                                        1684 09833000
         LA    @03,IOXCCW-8(@03,@01)                               1684 09834000
         MVC   CCW(8,@03),CCWTIC                                   1684 09835000
*       CCWADDR=ADDR(IOXCCW(R0CHNLOC));/*                    @ZA11014*/ 09836000
         LH    @03,CCWCNT                                          1685 09837000
         SLA   @03,3                                               1685 09838000
         L     @01,IOCTLBKP                                        1685 09839000
         LA    @03,IOXCCW-8(@03,@01)                               1685 09840000
         LH    @15,R0CHNLOC                                        1685 09841000
         SLA   @15,3                                               1685 09842000
         L     @01,IOCTLBKP                                        1685 09843000
         LA    @15,IOXCCW-8(@15,@01)                               1685 09844000
         STCM  @15,7,CCWADDR(@03)                                  1685 09845000
*     END;                          /*                       @ZA11014   09846000
*                                                            @ZA11014*/ 09847000
*                                                                  1686 09848000
*   /*****************************************************************/ 09849000
*   /*                                                               */ 09850000
*   /* NON-R0 REQUEST                                        @ZA11014*/ 09851000
*   /*                                                               */ 09852000
*   /*****************************************************************/ 09853000
*                                                                  1687 09854000
*   ELSE                            /*                       @ZA11014*/ 09855000
*                                                                  1687 09856000
*     /***************************************************************/ 09857000
*     /*                                                             */ 09858000
*     /* CALC WHICH CCW IN CHAIN TO BYPASS                   @ZA11014*/ 09859000
*     /*                                                             */ 09860000
*     /***************************************************************/ 09861000
*                                                                  1687 09862000
*     DO;                           /*                       @ZA11014   09863000
*                                                            @ZA11014*/ 09864000
*                                                                  1687 09865000
         B     @RC01678                                            1687 09866000
@RF01678 DS    0H                                                  1688 09867000
*       /*************************************************************/ 09868000
*       /*                                                           */ 09869000
*       /* INITIALIZE INDEX INTO CCW CHAIN TO REQ REC NUM@ZA11014    */ 09870000
*       /*                                                           */ 09871000
*       /*************************************************************/ 09872000
*                                                                  1688 09873000
*       CCWNDX=EXCCWCNT;            /*                       @ZA11014   09874000
*                                                            @ZA11014*/ 09875000
*                                                                  1688 09876000
         L     @03,@PC00001+8                                      1688 09877000
         LH    @03,EXCCWCNT(,@03)                                  1688 09878000
         STH   @03,CCWNDX                                          1688 09879000
*       /*************************************************************/ 09880000
*       /*                                                           */ 09881000
*       /* CHECK ALL LOCTAB ENTRIES SO FAR TO SEE            @ZA11014*/ 09882000
*       /* IF ANY RECORD NUMBERS ARE MISSING                 @ZA11014*/ 09883000
*       /* IF SO, ADJUST INDEX INTO CCWLIST                  @ZA11014*/ 09884000
*       /*                                                           */ 09885000
*       /*************************************************************/ 09886000
*                                                                  1689 09887000
*       DO RCTR=2 TO EXCCWCNT;      /*                       @ZA11014*/ 09888000
         LA    @03,2                                               1689 09889000
         B     @DE01689                                            1689 09890000
@DL01689 DS    0H                                                  1690 09891000
*         IF LOCADDR(RCTR)=NTFNDPTR /*                       @ZA11014*/ 09892000
*           THEN                    /*                       @ZA11014*/ 09893000
*                                                                  1690 09894000
         LH    @03,RCTR                                            1690 09895000
         MH    @03,@CH00279                                        1690 09896000
         L     @15,@PC00001+8                                      1690 09897000
         L     @01,EXLOCPTR(,@15)                                  1690 09898000
         AL    @01,@CF04425                                        1690 09899000
         L     @03,LOCADDR(@03,@01)                                1690 09900000
         ICM   @15,15,NTFNDPTR                                     1690 09901000
         CLR   @03,@15                                             1690 09902000
         BNE   @RF01690                                            1690 09903000
*           /*********************************************************/ 09904000
*           /*                                                       */ 09905000
*           /* THIS RECORD FOUND-NOT IN CHAIN                @ZA11014*/ 09906000
*           /*                                                       */ 09907000
*           /*********************************************************/ 09908000
*                                                                  1691 09909000
*           CCWNDX=CCWNDX-1;        /*                       @ZA11014*/ 09910000
         LH    @03,CCWNDX                                          1691 09911000
         BCTR  @03,0                                               1691 09912000
         STH   @03,CCWNDX                                          1691 09913000
*         ELSE                                                     1692 09914000
*           ;                       /*                       @ZA11014*/ 09915000
@RF01690 DS    0H                                                  1693 09916000
*       END;                        /*                       @ZA11014   09917000
*                                                            @ZA11014*/ 09918000
*                                                                  1693 09919000
         LA    @03,1                                               1693 09920000
         AH    @03,RCTR                                            1693 09921000
@DE01689 STH   @03,RCTR                                            1693 09922000
         L     @15,@PC00001+8                                      1693 09923000
         CH    @03,EXCCWCNT(,@15)                                  1693 09924000
         BNH   @DL01689                                            1693 09925000
*       /*************************************************************/ 09926000
*       /*                                                           */ 09927000
*       /* SET CCW INDEX TO PROPER ENTRY                     @ZA11014*/ 09928000
*       /*                                                           */ 09929000
*       /*************************************************************/ 09930000
*                                                                  1694 09931000
*       CCWCNT=CCWNDX+NONRDCT;      /*                       @ZA11014   09932000
*                                                            @ZA11014*/ 09933000
*                                                                  1694 09934000
         LH    @03,CCWNDX                                          1694 09935000
         AH    @03,NONRDCT                                         1694 09936000
         STH   @03,CCWCNT                                          1694 09937000
*       /*************************************************************/ 09938000
*       /*                                                           */ 09939000
*       /* DETERMINE WHICH LEN ENTRY TO USE AND REPLACE      @ZA11014*/ 09940000
*       /* CCW IN STRING WITH SPACE COUNT FOR THAT LENGTH    @ZA11014*/ 09941000
*       /*                                                           */ 09942000
*       /*************************************************************/ 09943000
*                                                                  1695 09944000
*       IF EXRWKDLN=NULLPTR         /*                       @ZA11014*/ 09945000
*         THEN                      /*                       @ZA11014*/ 09946000
*                                                                  1695 09947000
         L     @03,@PC00001+8                                      1695 09948000
         L     @03,EXRWKDLN(,@03)                                  1695 09949000
         LTR   @03,@03                                             1695 09950000
         BNZ   @RF01695                                            1695 09951000
*         /***********************************************************/ 09952000
*         /*                                                         */ 09953000
*         /* LEN NOT SUPPLIED-LEN IN COUNT FIELD GOOD        @ZA11014*/ 09954000
*         /* SAVE IT IN LOCTAB AND REPLACE CCW               @ZA11014*/ 09955000
*         /*                                                         */ 09956000
*         /***********************************************************/ 09957000
*                                                                  1696 09958000
*         DO;                       /*                       @ZA11014*/ 09959000
*           LOCKLEN(EXCCWCNT+1)=CCWADDR->RBKL;/*             @ZA11014*/ 09960000
         L     @03,@PC00001+8                                      1697 09961000
         LH    @03,EXCCWCNT(,@03)                                  1697 09962000
         MH    @03,@CH00279                                        1697 09963000
         L     @15,@PC00001+8                                      1697 09964000
         L     @01,EXLOCPTR(,@15)                                  1697 09965000
         LH    @15,CCWCNT                                          1697 09966000
         SLA   @15,3                                               1697 09967000
         L     @14,IOCTLBKP                                        1697 09968000
         LA    @15,IOXCCW-8(@15,@14)                               1697 09969000
         L     @15,CCWADDR-1(,@15)                                 1697 09970000
         SLR   @14,@14                                             1697 09971000
         IC    @14,RBKL(,@15)                                      1697 09972000
         STC   @14,LOCKLEN(@03,@01)                                1697 09973000
*           LOCDLEN(EXCCWCNT+1)=CCWADDR->RBDL;/*             @ZA11014   09974000
*                                                            @ZA11014*/ 09975000
*                                                                  1698 09976000
         L     @03,@PC00001+8                                      1698 09977000
         LH    @03,EXCCWCNT(,@03)                                  1698 09978000
         MH    @03,@CH00279                                        1698 09979000
         L     @15,@PC00001+8                                      1698 09980000
         L     @01,EXLOCPTR(,@15)                                  1698 09981000
         LH    @15,CCWCNT                                          1698 09982000
         SLA   @15,3                                               1698 09983000
         L     @14,IOCTLBKP                                        1698 09984000
         LA    @15,IOXCCW-8(@15,@14)                               1698 09985000
         L     @15,CCWADDR-1(,@15)                                 1698 09986000
         LH    @00,RBDL(,@15)                                      1698 09987000
         STH   @00,LOCDLEN(@03,@01)                                1698 09988000
*           /*********************************************************/ 09989000
*           /*                                                       */ 09990000
*           /* SET SPACE COUNT CCW                           @ZA11014*/ 09991000
*           /*                                                       */ 09992000
*           /*********************************************************/ 09993000
*                                                                  1699 09994000
*           CCW=CCWRSPCT;           /*                       @ZA11014   09995000
*                                                            @ZA11014*/ 09996000
*                                                                  1699 09997000
         LH    @03,CCWCNT                                          1699 09998000
         SLA   @03,3                                               1699 09999000
         L     @01,IOCTLBKP                                        1699 10000000
         LA    @03,IOXCCW-8(@03,@01)                               1699 10001000
         MVC   CCW(8,@03),CCWRSPCT                                 1699 10002000
*           /*********************************************************/ 10003000
*           /*                                                       */ 10004000
*           /* SET LEN POINTER                               @ZA11014*/ 10005000
*           /*                                                       */ 10006000
*           /*********************************************************/ 10007000
*                                                                  1700 10008000
*           CCWADDR=ADDR(LOCKLEN(EXCCWCNT+1));/*             @ZA11014*/ 10009000
         LH    @03,CCWCNT                                          1700 10010000
         SLA   @03,3                                               1700 10011000
         L     @01,IOCTLBKP                                        1700 10012000
         LA    @03,IOXCCW-8(@03,@01)                               1700 10013000
         L     @15,@PC00001+8                                      1700 10014000
         LH    @15,EXCCWCNT(,@15)                                  1700 10015000
         MH    @15,@CH00279                                        1700 10016000
         L     @14,@PC00001+8                                      1700 10017000
         L     @01,EXLOCPTR(,@14)                                  1700 10018000
         LA    @15,LOCKLEN(@15,@01)                                1700 10019000
         STCM  @15,7,CCWADDR(@03)                                  1700 10020000
*         END;                      /*                       @ZA11014   10021000
*                                                            @ZA11014*/ 10022000
*       ELSE                        /*                       @ZA11014*/ 10023000
*                                                                  1702 10024000
*         /***********************************************************/ 10025000
*         /*                                                         */ 10026000
*         /* LEN POINTER SUPPLIED                            @ZA11014*/ 10027000
*         /*                                                         */ 10028000
*         /***********************************************************/ 10029000
*                                                                  1702 10030000
*         DO;                       /*                       @ZA11014   10031000
*                                                            @ZA11014*/ 10032000
*                                                                  1702 10033000
         B     @RC01695                                            1702 10034000
@RF01695 DS    0H                                                  1703 10035000
*           /*********************************************************/ 10036000
*           /*                                                       */ 10037000
*           /* SET SPACE COUNT CCW                           @ZA11014*/ 10038000
*           /*                                                       */ 10039000
*           /*********************************************************/ 10040000
*                                                                  1703 10041000
*           CCW=CCWRSPCT;           /*                       @ZA11014   10042000
*                                                            @ZA11014*/ 10043000
*                                                                  1703 10044000
         LH    @03,CCWCNT                                          1703 10045000
         SLA   @03,3                                               1703 10046000
         L     @01,IOCTLBKP                                        1703 10047000
         LA    @03,IOXCCW-8(@03,@01)                               1703 10048000
         MVC   CCW(8,@03),CCWRSPCT                                 1703 10049000
*           /*********************************************************/ 10050000
*           /*                                                       */ 10051000
*           /* SET LEN                                       @ZA11014*/ 10052000
*           /*                                                       */ 10053000
*           /*********************************************************/ 10054000
*                                                                  1704 10055000
*           CCWADDR=EXRWKDLN;       /*                       @ZA11014*/ 10056000
         LH    @03,CCWCNT                                          1704 10057000
         SLA   @03,3                                               1704 10058000
         L     @01,IOCTLBKP                                        1704 10059000
         LA    @03,IOXCCW-8(@03,@01)                               1704 10060000
         L     @15,@PC00001+8                                      1704 10061000
         MVC   CCWADDR(3,@03),EXRWKDLN+1(@15)                      1704 10062000
*         END;                      /*                       @ZA11014*/ 10063000
*     END;                          /* NON-R0 REQUEST        @ZA11014   10064000
*                                                            @ZA11014*/ 10065000
*                                                                  1706 10066000
@RC01695 DS    0H                                                  1707 10067000
*   /*****************************************************************/ 10068000
*   /*                                                               */ 10069000
*   /* RETURN WITH RETURN CODE OK                            @ZA11014*/ 10070000
*   /*                                                               */ 10071000
*   /*****************************************************************/ 10072000
*                                                                  1707 10073000
*   TESTRC=0;                       /*                       @ZA11014*/ 10074000
@RC01678 SLR   @03,@03                                             1707 10075000
         STH   @03,TESTRC                                          1707 10076000
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/ 10077000
         LH    @15,TESTRC                                          1708 10078000
         L     @14,12(,@13)                                        1708 10079000
         LM    @00,@12,20(@13)                                     1708 10080000
         BR    @14                                                 1708 10081000
*   END SPACCR;                     /*                       @ZA11014*/ 10082000
*                                                                  1710 10083000
*/***********************************************************@ZA11014*/ 10084000
*/*                                                          @ZA11014*/ 10085000
*/*  PROCEDURE NAME - SETKDCCW                               @ZA11014*/ 10086000
*/*                                                          @ZA11014*/ 10087000
*/*  FUNCTION - BUILDS THE FOLLOWING CCW STRING TO READ THE  @ZA11014*/ 10088000
*/*              COUNT, KEY AND DATA (OR JUST KEY AND DATA   @ZA11014*/ 10089000
*/*              IF THE COUNT FIELD WAS BAD) OF A SPECIFIED  @ZA11014*/ 10090000
*/*              NUMBER OF RECORDS ON A TRACK                @ZA11014*/ 10091000
*/*                                                          @ZA11014*/ 10092000
*/*                SET SECTOR 0                              @ZA11014*/ 10093000
*/*                SEARCH ID EQUAL (R0)                      @ZA11014*/ 10094000
*/*                TIC *-8                                   @ZA11014*/ 10095000
*/*                READ CKD  OR  SPACE COUNT                 @ZA11014*/ 10096000
*/*                              READ KEY/DATA               @ZA11014*/ 10097000
*/*                          ^                               @ZA11014*/ 10098000
*/*                          ^                               @ZA11014*/ 10099000
*/*                READ CKD  OR  SPACE COUNT                 @ZA11014*/ 10100000
*/*                              READ KEY/DATA               @ZA11014*/ 10101000
*/*                                                          @ZA11014*/ 10102000
*/*                                                          @ZA11014*/ 10103000
*/*              IT WILL FILL IN THE LOCATION TABLE ENTRIES  @ZA11014*/ 10104000
*/*               FOR EACH RECORD WITH THE ADDRESS OF WHERE  @ZA11014*/ 10105000
*/*               THE RECORD WILL BE READ (COUNT FIELD LOC)  @ZA11014*/ 10106000
*/*                                                          @ZA11014*/ 10107000
*/*              RETURNS                                     @ZA11014*/ 10108000
*/*                                                          @ZA11014*/ 10109000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 10110000
*/*                                                          @ZA11014*/ 10111000
*/*                                                          @ZA11014*/ 10112000
*/*                                                          @ZA11014*/ 10113000
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/ 10114000
*/*          EXWRIOAR FROM EXWRARG                           @ZA11014*/ 10115000
*/*          EXLOCTAB FROM EXWRARG                           @ZA11014*/ 10116000
*/*                                                          @ZA11014*/ 10117000
*/*  OUTPUT - CCW LIST IN IOXCCWS                            @ZA11014*/ 10118000
*/*           UPDATED LOCATION TABLE ADDRESS ENTRIES         @ZA11014*/ 10119000
*/*           RETURN CODE OF ZERO IN REGISTER 15             @ZA11014*/ 10120000
*/*                                                          @ZA11014*/ 10121000
*/*                                                          @ZA11014*/ 10122000
*/*                                                          @ZA11014*/ 10123000
*/***********************************************************@ZA11014*/ 10124000
*                                                                  1710 10125000
*                                   /*                       @ZA11014*/ 10126000
*SETKDCCW:                                                         1710 10127000
*   PROC;                           /*                       @ZA11014   10128000
*                                                            @ZA11014*/ 10129000
*                                                                  1710 10130000
SETKDCCW STM   @14,@12,12(@13)                                     1710 10131000
*   /*****************************************************************/ 10132000
*   /*                                                               */ 10133000
*   /* SET TRACE ID                                          @ZA11014*/ 10134000
*   /*                                                               */ 10135000
*   /*****************************************************************/ 10136000
*                                                                  1711 10137000
*   OLDERID2=NEWERID2;                                             1711 10138000
         L     @03,@PC00001                                        1711 10139000
         L     @03,GDTTR2(,@03)                                    1711 10140000
         L     @15,@PC00001                                        1711 10141000
         L     @01,GDTTR2(,@15)                                    1711 10142000
         MVC   @TS00001(95),NEWERID2(@01)                          1711 10143000
         MVC   OLDERID2(95,@03),@TS00001                           1711 10144000
*   NEWID2='IOKS';                  /*                       @ZA11014   10145000
*                                                            @ZA11014*/ 10146000
*                                                                  1712 10147000
         L     @03,@PC00001                                        1712 10148000
         L     @03,GDTTR2(,@03)                                    1712 10149000
         MVC   NEWID2(4,@03),@CC04371                              1712 10150000
*   /*****************************************************************/ 10151000
*   /*                                                               */ 10152000
*   /* SET UP POINTERS TO IOXCTLBK AND RIOAREA               @ZA11014*/ 10153000
*   /*                                                               */ 10154000
*   /*****************************************************************/ 10155000
*                                                                  1713 10156000
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/ 10157000
         L     @03,@PC00001+8                                      1713 10158000
         L     @03,EXRWCTBL(,@03)                                  1713 10159000
         ST    @03,IOCTLBKP                                        1713 10160000
*   RRIOARPT=EXRWIOAR;              /*                       @ZA11014   10161000
*                                                            @ZA11014*/ 10162000
*                                                                  1714 10163000
         L     @03,@PC00001+8                                      1714 10164000
         L     @03,EXRWIOAR(,@03)                                  1714 10165000
         ST    @03,RRIOARPT                                        1714 10166000
*   /*****************************************************************/ 10167000
*   /*                                                               */ 10168000
*   /* THE CCW STRING WILL INITIALLY BE BUILT IN             @ZA11014*/ 10169000
*   /* THE CCW BUFFER AREA FOLLOWING THE READ COUNT          @ZA11014*/ 10170000
*   /* CCW CHAIN BECAUSE READ COUNT CCW INFORMATION IS       @ZA11014*/ 10171000
*   /* NEEDED IN BUILDING THE CCWS                           @ZA11014*/ 10172000
*   /*                                                       @ZA11014*/ 10173000
*   /* THE CHAIN WILL THEN BE MOVED TO THE BEGINNING         @ZA11014*/ 10174000
*   /* OF THE CCW BUFFER                                     @ZA11014*/ 10175000
*   /*                                                               */ 10176000
*   /*****************************************************************/ 10177000
*                                                                  1715 10178000
*                                   /*                       @ZA11014*/ 10179000
*                                                                  1715 10180000
*   /*****************************************************************/ 10181000
*   /*                                                               */ 10182000
*   /* INITIALIZE CCW INDEX POINTER TO                       @ZA11014*/ 10183000
*   /* BEGIN BEYOND LAST READ COUNT CCW                      @ZA11014*/ 10184000
*   /*                                                               */ 10185000
*   /*****************************************************************/ 10186000
*                                                                  1715 10187000
*   CCWCNT=MAXRECS+NONRDCT+1;       /*                       @ZA11014   10188000
*                                                            @ZA11014*/ 10189000
*                                                                  1715 10190000
         LH    @03,MAXRECS                                         1715 10191000
         AH    @03,NONRDCT                                         1715 10192000
         LA    @03,1(,@03)                                         1715 10193000
         STH   @03,CCWCNT                                          1715 10194000
*   /*****************************************************************/ 10195000
*   /*                                                               */ 10196000
*   /* INITIALIZE POINTER TO COUNT RECORDS IN BUFFER         @ZA11014*/ 10197000
*   /* SET UP ADDRESSABILITY TO IT                           @ZA11014*/ 10198000
*   /*                                                               */ 10199000
*   /*****************************************************************/ 10200000
*                                                                  1716 10201000
*   RCNTPTR=ADDR(RBUFF);            /*                       @ZA11014*/ 10202000
         L     @03,RRIOARPT                                        1716 10203000
         LA    @03,RBUFF(,@03)                                     1716 10204000
         STCM  @03,7,RCNTPTR                                       1716 10205000
*   RFY                                                            1717 10206000
*     RBUF BASED(RCNTPTR);          /*                       @ZA11014   10207000
*                                                            @ZA11014*/ 10208000
*                                                                  1717 10209000
*   /*****************************************************************/ 10210000
*   /*                                                               */ 10211000
*   /* SET LOCATION TABLE ADDR OF RECORD ZERO                @ZA11014*/ 10212000
*   /* TO THE BEGINNING OF THE BUFFER                        @ZA11014*/ 10213000
*   /*                                                               */ 10214000
*   /*****************************************************************/ 10215000
*                                                                  1718 10216000
*   LOCADDR(1)=RCNTPTR;             /*                       @ZA11014   10217000
*                                                            @ZA11014*/ 10218000
*                                                                  1718 10219000
         L     @03,@PC00001+8                                      1718 10220000
         L     @03,EXLOCPTR(,@03)                                  1718 10221000
         L     @15,RCNTPTR-1                                       1718 10222000
         LA    @15,0(,@15)                                         1718 10223000
         ST    @15,LOCADDR(,@03)                                   1718 10224000
*   /*****************************************************************/ 10225000
*   /*                                                               */ 10226000
*   /* INITIALIZE ADDR OF WHERE TO READ DATA INTO            @ZA11014*/ 10227000
*   /* RECORD ZERO HAS ALREADY BEEN READ-BYPASS IT           @ZA11014*/ 10228000
*   /*                                                               */ 10229000
*   /*****************************************************************/ 10230000
*                                                                  1719 10231000
*   RDKDADDR=ADDR(RBUFF)+LENR0;     /*                       @ZA11014   10232000
*                                                            @ZA11014*/ 10233000
*                                                                  1719 10234000
         L     @03,RRIOARPT                                        1719 10235000
         LA    @03,RBUFF(,@03)                                     1719 10236000
         AH    @03,LENR0                                           1719 10237000
         STCM  @03,7,RDKDADDR                                      1719 10238000
*   /*****************************************************************/ 10239000
*   /*                                                               */ 10240000
*   /* SET INDEX TO RECORD ONE READ COUNT FIELD              @ZA11014*/ 10241000
*   /*                                                               */ 10242000
*   /*****************************************************************/ 10243000
*                                                                  1720 10244000
*   RDOPCNT=NONRDCT+1;              /*                       @ZA11014   10245000
*                                                            @ZA11014*/ 10246000
*                                                                  1720 10247000
         LH    @03,NONRDCT                                         1720 10248000
         LA    @03,1(,@03)                                         1720 10249000
         STH   @03,RDOPCNT                                         1720 10250000
*   /*****************************************************************/ 10251000
*   /*                                                               */ 10252000
*   /* SET FIRST CCW IN CHAIN TO SET SECTOR ZERO             @ZA11014*/ 10253000
*   /*                                                               */ 10254000
*   /*****************************************************************/ 10255000
*                                                                  1721 10256000
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/ 10257000
         LH    @03,CCWCNT                                          1721 10258000
         SLA   @03,3                                               1721 10259000
         L     @01,IOCTLBKP                                        1721 10260000
         LA    @03,IOXCCW-8(@03,@01)                               1721 10261000
         MVC   CCW(8,@03),CCWRSSEC                                 1721 10262000
*   CCWADDR=ADDR(ZERO);             /*                       @ZA11014   10263000
*                                                            @ZA11014*/ 10264000
*                                                                  1722 10265000
         LH    @03,CCWCNT                                          1722 10266000
         SLA   @03,3                                               1722 10267000
         L     @01,IOCTLBKP                                        1722 10268000
         LA    @03,IOXCCW-8(@03,@01)                               1722 10269000
         LA    @15,ZERO                                            1722 10270000
         STCM  @15,7,CCWADDR(@03)                                  1722 10271000
*   /*****************************************************************/ 10272000
*   /*                                                               */ 10273000
*   /* INCREMENT POINTER IN CCW CHAIN                        @ZA11014*/ 10274000
*   /*                                                               */ 10275000
*   /*****************************************************************/ 10276000
*                                                                  1723 10277000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   10278000
*                                                            @ZA11014*/ 10279000
*                                                                  1723 10280000
         LH    @03,CCWCNT                                          1723 10281000
         LA    @03,1(,@03)                                         1723 10282000
         STH   @03,CCWCNT                                          1723 10283000
*   /*****************************************************************/ 10284000
*   /*                                                               */ 10285000
*   /* SET NEXT CCW TO SEARCH ID EQUAL FOR RECORD ZERO       @ZA11014*/ 10286000
*   /*                                                               */ 10287000
*   /*****************************************************************/ 10288000
*                                                                  1724 10289000
*   CCW=CCWSIDEQ;                   /*                       @ZA11014*/ 10290000
         LH    @03,CCWCNT                                          1724 10291000
         SLA   @03,3                                               1724 10292000
         L     @01,IOCTLBKP                                        1724 10293000
         LA    @03,IOXCCW-8(@03,@01)                               1724 10294000
         MVC   CCW(8,@03),CCWSIDEQ                                 1724 10295000
*   CCWADDR=ADDR(RBCCHHR);          /*                       @ZA11014   10296000
*                                                            @ZA11014   10297000
*                                                            @ZA11014*/ 10298000
*                                                                  1725 10299000
         LH    @03,CCWCNT                                          1725 10300000
         SLA   @03,3                                               1725 10301000
         L     @01,IOCTLBKP                                        1725 10302000
         LA    @03,IOXCCW-8(@03,@01)                               1725 10303000
         MVC   CCWADDR(3,@03),RCNTPTR                              1725 10304000
*   /*****************************************************************/ 10305000
*   /*                                                               */ 10306000
*   /* INCREMENT POINTER IN CCW CHAIN                        @ZA11014*/ 10307000
*   /*                                                               */ 10308000
*   /*****************************************************************/ 10309000
*                                                                  1726 10310000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   10311000
*                                                            @ZA11014   10312000
*                                                            @ZA11014*/ 10313000
*                                                                  1726 10314000
         LH    @03,CCWCNT                                          1726 10315000
         LA    @03,1(,@03)                                         1726 10316000
         STH   @03,CCWCNT                                          1726 10317000
*   /*****************************************************************/ 10318000
*   /*                                                               */ 10319000
*   /* SET TIC TO ADDR IN BUFFER WHERE SID EQ FOR R0         @ZA11014*/ 10320000
*   /* WILL EVENTUALLY BE                                    @ZA11014*/ 10321000
*   /*                                                               */ 10322000
*   /*****************************************************************/ 10323000
*                                                                  1727 10324000
*   CCW=CCWTIC;                     /*                       @ZA11014*/ 10325000
         LH    @03,CCWCNT                                          1727 10326000
         SLA   @03,3                                               1727 10327000
         L     @01,IOCTLBKP                                        1727 10328000
         LA    @03,IOXCCW-8(@03,@01)                               1727 10329000
         MVC   CCW(8,@03),CCWTIC                                   1727 10330000
*   CCWADDR=ADDR(IOXCCW(R0CHNLOC)); /*                       @ZA11014   10331000
*                                                            @ZA11014*/ 10332000
*                                                                  1728 10333000
         LH    @03,CCWCNT                                          1728 10334000
         SLA   @03,3                                               1728 10335000
         L     @01,IOCTLBKP                                        1728 10336000
         LA    @03,IOXCCW-8(@03,@01)                               1728 10337000
         LH    @15,R0CHNLOC                                        1728 10338000
         SLA   @15,3                                               1728 10339000
         L     @01,IOCTLBKP                                        1728 10340000
         LA    @15,IOXCCW-8(@15,@01)                               1728 10341000
         STCM  @15,7,CCWADDR(@03)                                  1728 10342000
*   /*****************************************************************/ 10343000
*   /*                                                               */ 10344000
*   /* INCREMENT POINTER IN CCW CHAIN                        @ZA11014*/ 10345000
*   /*                                                               */ 10346000
*   /*****************************************************************/ 10347000
*                                                                  1729 10348000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   10349000
*                                                            @ZA11014*/ 10350000
*                                                                  1729 10351000
         LH    @03,CCWCNT                                          1729 10352000
         LA    @03,1(,@03)                                         1729 10353000
         STH   @03,CCWCNT                                          1729 10354000
*   /*****************************************************************/ 10355000
*   /*                                                               */ 10356000
*   /* INCREMENT POINTER TO COUNTS PAST R0                   @ZA11014*/ 10357000
*   /*                                                               */ 10358000
*   /*****************************************************************/ 10359000
*                                                                  1730 10360000
*   RCNTPTR=RCNTPTR+LENR0;          /*                       @ZA11014   10361000
*                                                            @ZA11014*/ 10362000
         L     @03,RCNTPTR-1                                       1730 10363000
         LA    @03,0(,@03)                                         1730 10364000
         AH    @03,LENR0                                           1730 10365000
         STCM  @03,7,RCNTPTR                                       1730 10366000
*                                                                  1731 10367000
*   /*****************************************************************/ 10368000
*   /*                                                               */ 10369000
*   /* BUILD THE REMAINDER OF THE CCW CHAIN AS EITHER        @ZA11014*/ 10370000
*   /* READ COUNT, KEY DATA COMMANDS                         @ZA11014*/ 10371000
*   /* OR SPACE COUNT CCWS FOLLOWED BY READ KEY/DATA         @ZA11014*/ 10372000
*   /* COMMANDS DEPENDING UPON WHETHER THE ORIGINAL          @ZA11014*/ 10373000
*   /* COUNT FIELD FOR A PARTICULAR RECORD WAS BYPASSED      @ZA11014*/ 10374000
*   /*                                                               */ 10375000
*   /*****************************************************************/ 10376000
*                                                                  1731 10377000
*                                   /*                       @ZA11014*/ 10378000
*   DO RCTR=1 TO RNUMREC;           /*                       @ZA11014   10379000
*                                                            @ZA11014*/ 10380000
*                                                                  1731 10381000
         LA    @03,1                                               1731 10382000
         B     @DE01731                                            1731 10383000
@DL01731 DS    0H                                                  1732 10384000
*     /***************************************************************/ 10385000
*     /*                                                             */ 10386000
*     /* CHECK IF RECORD NUMBER MISSING                      @ZA11014*/ 10387000
*     /*                                                             */ 10388000
*     /***************************************************************/ 10389000
*                                                                  1732 10390000
*     IF LOCADDR(RCTR+1)^=NTFNDPTR  /*                       @ZA11014*/ 10391000
*       THEN                        /*                       @ZA11014*/ 10392000
*                                                                  1732 10393000
         LH    @03,RCTR                                            1732 10394000
         MH    @03,@CH00279                                        1732 10395000
         L     @15,@PC00001+8                                      1732 10396000
         L     @01,EXLOCPTR(,@15)                                  1732 10397000
         L     @03,LOCADDR(@03,@01)                                1732 10398000
         ICM   @15,15,NTFNDPTR                                     1732 10399000
         CLR   @03,@15                                             1732 10400000
         BE    @RF01732                                            1732 10401000
*       /*************************************************************/ 10402000
*       /*                                                           */ 10403000
*       /* THIS RECORD NUMBER IS ON THE TRACK                @ZA11014*/ 10404000
*       /*                                                           */ 10405000
*       /*************************************************************/ 10406000
*                                                                  1733 10407000
*       DO;                         /*                       @ZA11014   10408000
*                                                            @ZA11014*/ 10409000
*                                                                  1733 10410000
*         /***********************************************************/ 10411000
*         /*                                                         */ 10412000
*         /* SET TRACE ID                                    @ZA11014*/ 10413000
*         /*                                                         */ 10414000
*         /***********************************************************/ 10415000
*                                                                  1734 10416000
*         OLDERID2=NEWERID2;                                       1734 10417000
         L     @03,@PC00001                                        1734 10418000
         L     @03,GDTTR2(,@03)                                    1734 10419000
         L     @15,@PC00001                                        1734 10420000
         L     @01,GDTTR2(,@15)                                    1734 10421000
         MVC   @TS00001(95),NEWERID2(@01)                          1734 10422000
         MVC   OLDERID2(95,@03),@TS00001                           1734 10423000
*         NEWID2='IOK3';            /*                       @ZA11014   10424000
*                                                            @ZA11014*/ 10425000
*                                                                  1735 10426000
         L     @03,@PC00001                                        1735 10427000
         L     @03,GDTTR2(,@03)                                    1735 10428000
         MVC   NEWID2(4,@03),@CC04373                              1735 10429000
*         /***********************************************************/ 10430000
*         /*                                                         */ 10431000
*         /* CHECK IF OP CODE OF COUNT CHAIN A SPACE CNT     @ZA11014*/ 10432000
*         /*                                                         */ 10433000
*         /***********************************************************/ 10434000
*                                                                  1736 10435000
*         IF ADDR(IOXCCW(RDOPCNT))->CCWOP^=SPCNTOP/*         @ZA11014*/ 10436000
*           THEN                    /*                       @ZA11014*/ 10437000
*                                                                  1736 10438000
         LH    @03,RDOPCNT                                         1736 10439000
         SLA   @03,3                                               1736 10440000
         L     @01,IOCTLBKP                                        1736 10441000
         LA    @03,IOXCCW-8(@03,@01)                               1736 10442000
         CLC   CCWOP(1,@03),SPCNTOP                                1736 10443000
         BE    @RF01736                                            1736 10444000
*           /*********************************************************/ 10445000
*           /*                                                       */ 10446000
*           /* OP CODE MUST BE READ COUNT                    @ZA11014*/ 10447000
*           /*                                                       */ 10448000
*           /*********************************************************/ 10449000
*                                                                  1737 10450000
*           DO;                     /*                       @ZA11014   10451000
*                                                            @ZA11014*/ 10452000
*                                                                  1737 10453000
*             /*******************************************************/ 10454000
*             /*                                                     */ 10455000
*             /* SET CCW TO READ COUNT                       @0Z11014*/ 10456000
*             /* DATA TRANSFER OK/COMMAND CHAINING ON        @ZA11014*/ 10457000
*             /*                                                     */ 10458000
*             /*******************************************************/ 10459000
*                                                                  1738 10460000
*             CCW=CCWRRCNT;         /*                       @0Z11014*/ 10461000
         LH    @03,CCWCNT                                          1738 10462000
         SLA   @03,3                                               1738 10463000
         L     @01,IOCTLBKP                                        1738 10464000
         LA    @03,IOXCCW-8(@03,@01)                               1738 10465000
         MVC   CCW(8,@03),CCWRRCNT                                 1738 10466000
*             CCWSUPP=OFF;          /*                       @ZA11014*/ 10467000
*             CCWCMDCH=ON;          /*                       @ZA11014   10468000
*                                                            @ZA11014*/ 10469000
*                                                                  1740 10470000
         LH    @03,CCWCNT                                          1740 10471000
         SLA   @03,3                                               1740 10472000
         L     @01,IOCTLBKP                                        1740 10473000
         LA    @03,IOXCCW-8(@03,@01)                               1740 10474000
         OI    CCWCMDCH(@03),B'01000000'                           1740 10475000
         NI    CCWSUPP(@03),B'11101111'                            1740 10476000
*             /*******************************************************/ 10477000
*             /*                                                     */ 10478000
*             /* SET CCW ADDR TO BEGINNING OF COUNT          @0Z11014*/ 10479000
*             /* SET ADDR IN LOCATION TABLE                  @ZA11014*/ 10480000
*             /*                                                     */ 10481000
*             /*******************************************************/ 10482000
*                                                                  1741 10483000
*             CCWADDR=RDKDADDR;     /*                       @ZA11014*/ 10484000
         LH    @03,CCWCNT                                          1741 10485000
         SLA   @03,3                                               1741 10486000
         L     @01,IOCTLBKP                                        1741 10487000
         LA    @03,IOXCCW-8(@03,@01)                               1741 10488000
         MVC   CCWADDR(3,@03),RDKDADDR                             1741 10489000
*             LOCADDR(RCTR+1)=RDKDADDR;/*                    @ZA11014   10490000
*                                                            @ZA11014*/ 10491000
*                                                                  1742 10492000
         LH    @03,RCTR                                            1742 10493000
         MH    @03,@CH00279                                        1742 10494000
         L     @15,@PC00001+8                                      1742 10495000
         L     @01,EXLOCPTR(,@15)                                  1742 10496000
         L     @00,RDKDADDR-1                                      1742 10497000
         ICM   @00,8,@CB03783                                      1742 10498000
         ST    @00,LOCADDR(@03,@01)                                1742 10499000
*             /*******************************************************/ 10500000
*             /*                                                     */ 10501000
*             /* INCREMENT TO NEXT CCW                       @0Z11014*/ 10502000
*             /*                                                     */ 10503000
*             /*******************************************************/ 10504000
*                                                                  1743 10505000
*             CCWCNT=CCWCNT+1;      /*                       @0Z11014   10506000
*                                                            @0Z11014*/ 10507000
*                                                                  1743 10508000
         LH    @03,CCWCNT                                          1743 10509000
         LA    @03,1(,@03)                                         1743 10510000
         STH   @03,CCWCNT                                          1743 10511000
*             /*******************************************************/ 10512000
*             /*                                                     */ 10513000
*             /* SET CCW TO READ KEY AND DATA                @0Z11014*/ 10514000
*             /* DATA TRANSFER OK/COMMAND CHAINING ON        @0Z11014*/ 10515000
*             /*                                                     */ 10516000
*             /*******************************************************/ 10517000
*                                                                  1744 10518000
*             CCW=CCWRRKD;          /*                       @0Z11014*/ 10519000
         LH    @03,CCWCNT                                          1744 10520000
         SLA   @03,3                                               1744 10521000
         L     @01,IOCTLBKP                                        1744 10522000
         LA    @03,IOXCCW-8(@03,@01)                               1744 10523000
         MVC   CCW(8,@03),CCWRRKD                                  1744 10524000
*             CCWSUPP=OFF;          /*                       @0Z11014*/ 10525000
*             CCWCMDCH=ON;          /*                       @0Z11014   10526000
*                                                            @0Z11014*/ 10527000
*                                                                  1746 10528000
         LH    @03,CCWCNT                                          1746 10529000
         SLA   @03,3                                               1746 10530000
         L     @01,IOCTLBKP                                        1746 10531000
         LA    @03,IOXCCW-8(@03,@01)                               1746 10532000
         OI    CCWCMDCH(@03),B'01000000'                           1746 10533000
         NI    CCWSUPP(@03),B'11101111'                            1746 10534000
*             /*******************************************************/ 10535000
*             /*                                                     */ 10536000
*             /* CCWADDR IS ADDRESS OF KEY/DATA FIELDS       @0Z11014*/ 10537000
*             /*                                                     */ 10538000
*             /*******************************************************/ 10539000
*                                                                  1747 10540000
*             CCWADDR=RDKDADDR+LENCNT;/*                     @0Z11014   10541000
*                                                            @0Z11014*/ 10542000
*                                                                  1747 10543000
         LH    @03,CCWCNT                                          1747 10544000
         SLA   @03,3                                               1747 10545000
         L     @01,IOCTLBKP                                        1747 10546000
         LA    @03,IOXCCW-8(@03,@01)                               1747 10547000
         L     @15,RDKDADDR-1                                      1747 10548000
         LA    @15,0(,@15)                                         1747 10549000
         AH    @15,LENCNT                                          1747 10550000
         STCM  @15,7,CCWADDR(@03)                                  1747 10551000
*             /*******************************************************/ 10552000
*             /*                                                     */ 10553000
*             /* CALCULATE DATA LEN FROM PREVIOUSLY READ     @ZA11014*/ 10554000
*             /* COUNT FIELD                                 @ZA11014*/ 10555000
*             /*                                                     */ 10556000
*             /*******************************************************/ 10557000
*                                                                  1748 10558000
*             CCWDATLN=RBKL+RBDL;   /*                       @0Z11014   10559000
*                                                            @ZA11014*/ 10560000
*                                                                  1748 10561000
         LH    @03,CCWCNT                                          1748 10562000
         SLA   @03,3                                               1748 10563000
         L     @01,IOCTLBKP                                        1748 10564000
         LA    @03,IOXCCW-8(@03,@01)                               1748 10565000
         L     @01,RCNTPTR-1                                       1748 10566000
         L     @15,RCNTPTR-1                                       1748 10567000
         SLR   @00,@00                                             1748 10568000
         IC    @00,RBKL(,@01)                                      1748 10569000
         AH    @00,RBDL(,@15)                                      1748 10570000
         STH   @00,CCWDATLN(,@03)                                  1748 10571000
*             /*******************************************************/ 10572000
*             /*                                                     */ 10573000
*             /* INCREMENT INDEX INTO READ COUNT CCW CHAI@ZA11014    */ 10574000
*             /*                                                     */ 10575000
*             /*******************************************************/ 10576000
*                                                                  1749 10577000
*             RDOPCNT=RDOPCNT+1;    /*                       @ZA11014   10578000
*                                                            @ZA11014*/ 10579000
*                                                                  1749 10580000
         LH    @03,RDOPCNT                                         1749 10581000
         LA    @03,1(,@03)                                         1749 10582000
         STH   @03,RDOPCNT                                         1749 10583000
*             /*******************************************************/ 10584000
*             /*                                                     */ 10585000
*             /* INCREMENT POINTER TO COUNT FIELDS IN BUF@ZA11014    */ 10586000
*             /*                                                     */ 10587000
*             /*******************************************************/ 10588000
*                                                                  1750 10589000
*             RCNTPTR=RCNTPTR+LENCNT;/*                      @ZA11014   10590000
*                                                            @ZA11014*/ 10591000
*                                                                  1750 10592000
         L     @03,RCNTPTR-1                                       1750 10593000
         LA    @03,0(,@03)                                         1750 10594000
         AH    @03,LENCNT                                          1750 10595000
         STCM  @03,7,RCNTPTR                                       1750 10596000
*             /*******************************************************/ 10597000
*             /*                                                     */ 10598000
*             /* CALC NEXT AVAIL LOC IN BUFFER FOR READIN@ZA11014    */ 10599000
*             /*                                                     */ 10600000
*             /*******************************************************/ 10601000
*                                                                  1751 10602000
*             RDKDADDR=RDKDADDR+CCWDATLN+LENCNT;/*           @0Z11014   10603000
*                                                            @ZA11014*/ 10604000
*                                                                  1751 10605000
         LH    @03,CCWCNT                                          1751 10606000
         SLA   @03,3                                               1751 10607000
         L     @01,IOCTLBKP                                        1751 10608000
         LA    @03,IOXCCW-8(@03,@01)                               1751 10609000
         L     @15,RDKDADDR-1                                      1751 10610000
         LA    @15,0(,@15)                                         1751 10611000
         AH    @15,CCWDATLN(,@03)                                  1751 10612000
         AH    @15,LENCNT                                          1751 10613000
         STCM  @15,7,RDKDADDR                                      1751 10614000
*             /*******************************************************/ 10615000
*             /*                                                     */ 10616000
*             /* CHECK IF THIS RECORD IS AN END OF FILE      @ZA11014*/ 10617000
*             /* RECORD-IF IT IS CHANGE THE READ K/D         @ZA11014*/ 10618000
*             /* TO A TIC TO BYPASS READING THE ZERO         @ZA11014*/ 10619000
*             /* LENGTH RECORD                               @ZA11014*/ 10620000
*             /* SET THE RETURN CODE IN THE LOCATION         @ZA11014*/ 10621000
*             /* TABLE FOR THIS RECORD TO EOF                @ZA11014*/ 10622000
*             /*                                                     */ 10623000
*             /*******************************************************/ 10624000
*                                                                  1752 10625000
*             IF CCWDATLN=0         /*                       @ZA11014*/ 10626000
*               THEN                /*                       @ZA11014*/ 10627000
         LH    @03,CCWCNT                                          1752 10628000
         SLA   @03,3                                               1752 10629000
         L     @01,IOCTLBKP                                        1752 10630000
         LA    @03,IOXCCW-8(@03,@01)                               1752 10631000
         LH    @03,CCWDATLN(,@03)                                  1752 10632000
         LTR   @03,@03                                             1752 10633000
         BNZ   @RF01752                                            1752 10634000
*               DO;                 /*                       @ZA11014*/ 10635000
*                 CCW=CCWTIC;       /*                       @ZA11014*/ 10636000
         LH    @03,CCWCNT                                          1754 10637000
         SLA   @03,3                                               1754 10638000
         L     @01,IOCTLBKP                                        1754 10639000
         LA    @03,IOXCCW-8(@03,@01)                               1754 10640000
         MVC   CCW(8,@03),CCWTIC                                   1754 10641000
*                 CCWADDR=ADDR(IOXCCW(CCWCNT+1));/*          @ZA11014*/ 10642000
         LH    @03,CCWCNT                                          1755 10643000
         SLA   @03,3                                               1755 10644000
         L     @01,IOCTLBKP                                        1755 10645000
         LA    @03,IOXCCW-8(@03,@01)                               1755 10646000
         LH    @15,CCWCNT                                          1755 10647000
         SLA   @15,3                                               1755 10648000
         L     @01,IOCTLBKP                                        1755 10649000
         LA    @15,IOXCCW(@15,@01)                                 1755 10650000
         STCM  @15,7,CCWADDR(@03)                                  1755 10651000
*                 LOCRCKD(RCTR+1)=RCABEOFR;/*                @ZA11014   10652000
*                                                            @ZA11014*/ 10653000
*                                                                  1756 10654000
         LH    @03,RCTR                                            1756 10655000
         MH    @03,@CH00279                                        1756 10656000
         L     @15,@PC00001+8                                      1756 10657000
         L     @01,EXLOCPTR(,@15)                                  1756 10658000
         LH    @00,RCABEOFR                                        1756 10659000
         STH   @00,LOCRCKD(@03,@01)                                1756 10660000
*                 /***************************************************/ 10661000
*                 /*                                                 */ 10662000
*                 /* INCREMENT READ IN BUFFER POINTER        @ZA11014*/ 10663000
*                 /* TO LEAVE ROOM FOR THE EOF MESSAGE       @ZA11014*/ 10664000
*                 /*                                                 */ 10665000
*                 /***************************************************/ 10666000
*                                                                  1757 10667000
*                 RDKDADDR=RDKDADDR+9;/*                     @ZA11014   10668000
*                                                            @ZA11014*/ 10669000
         L     @03,RDKDADDR-1                                      1757 10670000
         LA    @03,9(,@03)                                         1757 10671000
         STCM  @03,7,RDKDADDR                                      1757 10672000
*               END;                /*                       @ZA11014   10673000
*                                                            @ZA11014   10674000
*                                                            @ZA11014*/ 10675000
*                                                                  1758 10676000
*             /*******************************************************/ 10677000
*             /*                                                     */ 10678000
*             /* INCREMENT PTR TO READ CKD CCW CHAIN         @ZA11014*/ 10679000
*             /*                                                     */ 10680000
*             /*******************************************************/ 10681000
*                                                                  1759 10682000
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014*/ 10683000
@RF01752 LH    @03,CCWCNT                                          1759 10684000
         LA    @03,1(,@03)                                         1759 10685000
         STH   @03,CCWCNT                                          1759 10686000
*           END;                    /*                       @ZA11014   10687000
*                                                            @ZA11014*/ 10688000
*                                                                  1760 10689000
*         /***********************************************************/ 10690000
*         /*                                                         */ 10691000
*         /* SPACE COUNT CCW IN COUNT BUFFER                 @ZA11014*/ 10692000
*         /*                                                         */ 10693000
*         /***********************************************************/ 10694000
*                                                                  1761 10695000
*         ELSE                      /*                       @ZA11014*/ 10696000
*                                                                  1761 10697000
*           /*********************************************************/ 10698000
*           /*                                                       */ 10699000
*           /* COPY SPACE COUNT AND DO READ KEY/DATA         @ZA11014*/ 10700000
*           /*                                                       */ 10701000
*           /*********************************************************/ 10702000
*                                                                  1761 10703000
*           DO;                     /*                       @ZA11014   10704000
*                                                            @ZA11014*/ 10705000
*                                                                  1761 10706000
         B     @RC01736                                            1761 10707000
@RF01736 DS    0H                                                  1762 10708000
*             /*******************************************************/ 10709000
*             /*                                                     */ 10710000
*             /* SET TRACE ID                                @ZA11014*/ 10711000
*             /*                                                     */ 10712000
*             /*******************************************************/ 10713000
*                                                                  1762 10714000
*             OLDERID2=NEWERID2;                                   1762 10715000
         L     @03,@PC00001                                        1762 10716000
         L     @03,GDTTR2(,@03)                                    1762 10717000
         L     @15,@PC00001                                        1762 10718000
         L     @01,GDTTR2(,@15)                                    1762 10719000
         MVC   @TS00001(95),NEWERID2(@01)                          1762 10720000
         MVC   OLDERID2(95,@03),@TS00001                           1762 10721000
*             NEWID2='IOK4';        /*                       @ZA11014   10722000
*                                                            @ZA11014*/ 10723000
*                                                                  1763 10724000
         L     @03,@PC00001                                        1763 10725000
         L     @03,GDTTR2(,@03)                                    1763 10726000
         MVC   NEWID2(4,@03),@CC04374                              1763 10727000
*             /*******************************************************/ 10728000
*             /*                                                     */ 10729000
*             /* MOVE SPACE COUNT CCW TO NEW CHAIN           @ZA11014*/ 10730000
*             /*                                                     */ 10731000
*             /*******************************************************/ 10732000
*                                                                  1764 10733000
*             CCW=ADDR(IOXCCW(RDOPCNT))->CCW;/*              @ZA11014   10734000
*                                                            @ZA11014*/ 10735000
*                                                                  1764 10736000
         LH    @03,CCWCNT                                          1764 10737000
         SLA   @03,3                                               1764 10738000
         L     @01,IOCTLBKP                                        1764 10739000
         LA    @03,IOXCCW-8(@03,@01)                               1764 10740000
         LH    @15,RDOPCNT                                         1764 10741000
         SLA   @15,3                                               1764 10742000
         L     @01,IOCTLBKP                                        1764 10743000
         LA    @15,IOXCCW-8(@15,@01)                               1764 10744000
         MVC   CCW(8,@03),CCW(@15)                                 1764 10745000
*             /*******************************************************/ 10746000
*             /*                                                     */ 10747000
*             /* SAVE BAD COUNT FIELD TO MOVE IN BUFFER      @ZA11014*/ 10748000
*             /*                                                     */ 10749000
*             /*******************************************************/ 10750000
*                                                                  1765 10751000
*             LOCCNTFD(RCTR+1)=RBUFCNT;/*                    @ZA11014   10752000
*                                                            @ZA11014*/ 10753000
*                                                                  1765 10754000
         LH    @03,RCTR                                            1765 10755000
         MH    @03,@CH00279                                        1765 10756000
         L     @15,@PC00001+8                                      1765 10757000
         L     @01,EXLOCPTR(,@15)                                  1765 10758000
         ALR   @01,@03                                             1765 10759000
         L     @03,RCNTPTR-1                                       1765 10760000
         MVC   LOCCNTFD(8,@01),RBUFCNT(@03)                        1765 10761000
*             /*******************************************************/ 10762000
*             /*                                                     */ 10763000
*             /* SET ADDR IN LOCTAB TO BEG OF COUNT FLD      @ZA11014*/ 10764000
*             /*                                                     */ 10765000
*             /*******************************************************/ 10766000
*                                                                  1766 10767000
*             LOCADDR(RCTR+1)=RDKDADDR;/*                    @ZA11014   10768000
*                                                            @ZA11014*/ 10769000
*                                                                  1766 10770000
         LH    @03,RCTR                                            1766 10771000
         MH    @03,@CH00279                                        1766 10772000
         L     @15,@PC00001+8                                      1766 10773000
         L     @01,EXLOCPTR(,@15)                                  1766 10774000
         L     @00,RDKDADDR-1                                      1766 10775000
         ICM   @00,8,@CB03783                                      1766 10776000
         ST    @00,LOCADDR(@03,@01)                                1766 10777000
*             /*******************************************************/ 10778000
*             /*                                                     */ 10779000
*             /* SET ADDR FOR KEY/DATA READ                  @ZA11014*/ 10780000
*             /*                                                     */ 10781000
*             /*******************************************************/ 10782000
*                                                                  1767 10783000
*             RDKDADDR=RDKDADDR+LENCNT;/*                    @ZA11014   10784000
*                                                            @ZA11014*/ 10785000
*                                                                  1767 10786000
         L     @03,RDKDADDR-1                                      1767 10787000
         LA    @03,0(,@03)                                         1767 10788000
         AH    @03,LENCNT                                          1767 10789000
         STCM  @03,7,RDKDADDR                                      1767 10790000
*             /*******************************************************/ 10791000
*             /*                                                     */ 10792000
*             /* INCREMENT POINTER IN CCW CHAIN              @ZA11014*/ 10793000
*             /*                                                     */ 10794000
*             /*******************************************************/ 10795000
*                                                                  1768 10796000
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014   10797000
*                                                            @ZA11014*/ 10798000
*                                                                  1768 10799000
         LH    @03,CCWCNT                                          1768 10800000
         LA    @03,1(,@03)                                         1768 10801000
         STH   @03,CCWCNT                                          1768 10802000
*             /*******************************************************/ 10803000
*             /*                                                     */ 10804000
*             /* SET CCW TO READ KEY/DATA                    @ZA11014*/ 10805000
*             /* TRANSFER DATA/COMMAND CHAIN ON              @ZA11014*/ 10806000
*             /*                                                     */ 10807000
*             /*******************************************************/ 10808000
*                                                                  1769 10809000
*             CCW=CCWRRKD;          /*                       @ZA11014*/ 10810000
         LH    @03,CCWCNT                                          1769 10811000
         SLA   @03,3                                               1769 10812000
         L     @01,IOCTLBKP                                        1769 10813000
         LA    @03,IOXCCW-8(@03,@01)                               1769 10814000
         MVC   CCW(8,@03),CCWRRKD                                  1769 10815000
*             CCWSUPP=OFF;          /*                       @ZA11014*/ 10816000
*             CCWCMDCH=ON;          /*                       @ZA11014   10817000
*                                                            @ZA11014*/ 10818000
*                                                                  1771 10819000
         LH    @03,CCWCNT                                          1771 10820000
         SLA   @03,3                                               1771 10821000
         L     @01,IOCTLBKP                                        1771 10822000
         LA    @03,IOXCCW-8(@03,@01)                               1771 10823000
         OI    CCWCMDCH(@03),B'01000000'                           1771 10824000
         NI    CCWSUPP(@03),B'11101111'                            1771 10825000
*             /*******************************************************/ 10826000
*             /*                                                     */ 10827000
*             /* SET CCW ADDR TO READ INTO BUFFER            @ZA11014*/ 10828000
*             /*                                                     */ 10829000
*             /*******************************************************/ 10830000
*                                                                  1772 10831000
*             CCWADDR=RDKDADDR;     /*                       @ZA11014   10832000
*                                                            @ZA11014*/ 10833000
*                                                                  1772 10834000
         LH    @03,CCWCNT                                          1772 10835000
         SLA   @03,3                                               1772 10836000
         L     @01,IOCTLBKP                                        1772 10837000
         LA    @03,IOXCCW-8(@03,@01)                               1772 10838000
         MVC   CCWADDR(3,@03),RDKDADDR                             1772 10839000
*             /*******************************************************/ 10840000
*             /*                                                     */ 10841000
*             /* CALC LEN TO READ FROM LEN POINTER           @ZA11014*/ 10842000
*             /* IN SPACE COUNT CCW                          @ZA11014*/ 10843000
*             /*                                                     */ 10844000
*             /*******************************************************/ 10845000
*                                                                  1773 10846000
*             CCWDATLN=ADDR(IOXCCW(CCWCNT-1))/*              @ZA11014*/ 10847000
*                 ->CCWADDR->FLDKEYLN+/*                     @ZA11014*/ 10848000
*                 ADDR(IOXCCW(CCWCNT-1))/*                   @ZA11014*/ 10849000
*                 ->CCWADDR->FLDDATLN;/*                     @ZA11014   10850000
*                                                            @ZA11014*/ 10851000
*                                                                  1773 10852000
         LH    @03,CCWCNT                                          1773 10853000
         SLA   @03,3                                               1773 10854000
         L     @01,IOCTLBKP                                        1773 10855000
         LA    @03,IOXCCW-8(@03,@01)                               1773 10856000
         LH    @15,CCWCNT                                          1773 10857000
         SLA   @15,3                                               1773 10858000
         L     @01,IOCTLBKP                                        1773 10859000
         LA    @15,IOXCCW-16(@15,@01)                              1773 10860000
         L     @01,CCWADDR-1(,@15)                                 1773 10861000
         LH    @15,CCWCNT                                          1773 10862000
         SLA   @15,3                                               1773 10863000
         L     @14,IOCTLBKP                                        1773 10864000
         LA    @15,IOXCCW-16(@15,@14)                              1773 10865000
         L     @15,CCWADDR-1(,@15)                                 1773 10866000
         SLR   @00,@00                                             1773 10867000
         IC    @00,FLDKEYLN(,@01)                                  1773 10868000
         SLR   @14,@14                                             1773 10869000
         ICM   @14,3,FLDDATLN(@15)                                 1773 10870000
         ALR   @00,@14                                             1773 10871000
         STH   @00,CCWDATLN(,@03)                                  1773 10872000
*             /*******************************************************/ 10873000
*             /*                                                     */ 10874000
*             /* INCREMENT INDEX INTO READ COUNT CCW CHAI@ZA11014    */ 10875000
*             /*                                                     */ 10876000
*             /*******************************************************/ 10877000
*                                                                  1774 10878000
*             RDOPCNT=RDOPCNT+1;    /*                       @ZA11014   10879000
*                                                            @ZA11014*/ 10880000
*                                                                  1774 10881000
         LH    @03,RDOPCNT                                         1774 10882000
         LA    @03,1(,@03)                                         1774 10883000
         STH   @03,RDOPCNT                                         1774 10884000
*             /*******************************************************/ 10885000
*             /*                                                     */ 10886000
*             /* INCREMENT POINTER TO COUNT FIELDS IN BUF@ZA11014    */ 10887000
*             /*                                                     */ 10888000
*             /*******************************************************/ 10889000
*                                                                  1775 10890000
*             RCNTPTR=RCNTPTR+LENCNT;/*                      @ZA11014   10891000
*                                                            @ZA11014*/ 10892000
*                                                                  1775 10893000
         L     @03,RCNTPTR-1                                       1775 10894000
         LA    @03,0(,@03)                                         1775 10895000
         AH    @03,LENCNT                                          1775 10896000
         STCM  @03,7,RCNTPTR                                       1775 10897000
*             /*******************************************************/ 10898000
*             /*                                                     */ 10899000
*             /* CALC NEXT AVAIL LOC IN BUFFER FOR READ      @ZA11014*/ 10900000
*             /*                                                     */ 10901000
*             /*******************************************************/ 10902000
*                                                                  1776 10903000
*             RDKDADDR=RDKDADDR+CCWDATLN;/*                  @ZA11014   10904000
*                                                            @ZA11014*/ 10905000
*                                                                  1776 10906000
         LH    @03,CCWCNT                                          1776 10907000
         SLA   @03,3                                               1776 10908000
         L     @01,IOCTLBKP                                        1776 10909000
         LA    @03,IOXCCW-8(@03,@01)                               1776 10910000
         L     @15,RDKDADDR-1                                      1776 10911000
         LA    @15,0(,@15)                                         1776 10912000
         AH    @15,CCWDATLN(,@03)                                  1776 10913000
         STCM  @15,7,RDKDADDR                                      1776 10914000
*             /*******************************************************/ 10915000
*             /*                                                     */ 10916000
*             /* CHECK IF THIS RECORD IS AN END OF FILE      @ZA11014*/ 10917000
*             /* RECORD-IF IT IS CHANGE THE READ K/D         @ZA11014*/ 10918000
*             /* TO A TIC TO BYPASS READING THE ZERO         @ZA11014*/ 10919000
*             /* LENGTH RECORD                               @ZA11014*/ 10920000
*             /* SET THE RETURN CODE IN THE LOCATION         @ZA11014*/ 10921000
*             /* TABLE FOR THIS RECORD TO EOF                @ZA11014*/ 10922000
*             /*                                                     */ 10923000
*             /*******************************************************/ 10924000
*                                                                  1777 10925000
*             IF CCWDATLN=0         /*                       @ZA11014*/ 10926000
*               THEN                /*                       @ZA11014*/ 10927000
         LH    @03,CCWCNT                                          1777 10928000
         SLA   @03,3                                               1777 10929000
         L     @01,IOCTLBKP                                        1777 10930000
         LA    @03,IOXCCW-8(@03,@01)                               1777 10931000
         LH    @03,CCWDATLN(,@03)                                  1777 10932000
         LTR   @03,@03                                             1777 10933000
         BNZ   @RF01777                                            1777 10934000
*               DO;                 /*                       @ZA11014*/ 10935000
*                 CCW=CCWTIC;       /*                       @ZA11014*/ 10936000
         LH    @03,CCWCNT                                          1779 10937000
         SLA   @03,3                                               1779 10938000
         L     @01,IOCTLBKP                                        1779 10939000
         LA    @03,IOXCCW-8(@03,@01)                               1779 10940000
         MVC   CCW(8,@03),CCWTIC                                   1779 10941000
*                 CCWADDR=ADDR(IOXCCW(CCWCNT+1));/*          @ZA11014*/ 10942000
         LH    @03,CCWCNT                                          1780 10943000
         SLA   @03,3                                               1780 10944000
         L     @01,IOCTLBKP                                        1780 10945000
         LA    @03,IOXCCW-8(@03,@01)                               1780 10946000
         LH    @15,CCWCNT                                          1780 10947000
         SLA   @15,3                                               1780 10948000
         L     @01,IOCTLBKP                                        1780 10949000
         LA    @15,IOXCCW(@15,@01)                                 1780 10950000
         STCM  @15,7,CCWADDR(@03)                                  1780 10951000
*                 LOCRCKD(RCTR+1)=RCABEOFR;/*                @ZA11014   10952000
*                                                            @ZA11014*/ 10953000
*                                                                  1781 10954000
         LH    @03,RCTR                                            1781 10955000
         MH    @03,@CH00279                                        1781 10956000
         L     @15,@PC00001+8                                      1781 10957000
         L     @01,EXLOCPTR(,@15)                                  1781 10958000
         LH    @00,RCABEOFR                                        1781 10959000
         STH   @00,LOCRCKD(@03,@01)                                1781 10960000
*                 /***************************************************/ 10961000
*                 /*                                                 */ 10962000
*                 /* INCREMENT READ IN BUFFER POINTER        @ZA11014*/ 10963000
*                 /* TO LEAVE ROOM FOR THE EOF MESSAGE       @ZA11014*/ 10964000
*                 /*                                                 */ 10965000
*                 /***************************************************/ 10966000
*                                                                  1782 10967000
*                 RDKDADDR=RDKDADDR+9;/*                     @ZA11014   10968000
*                                                            @ZA11014*/ 10969000
         L     @03,RDKDADDR-1                                      1782 10970000
         LA    @03,9(,@03)                                         1782 10971000
         STCM  @03,7,RDKDADDR                                      1782 10972000
*               END;                /*                       @ZA11014   10973000
*                                                            @ZA11014*/ 10974000
*                                                                  1783 10975000
*             /*******************************************************/ 10976000
*             /*                                                     */ 10977000
*             /* INCREMENT PTR TO READ CKD CCW CHAIN         @ZA11014*/ 10978000
*             /*                                                     */ 10979000
*             /*******************************************************/ 10980000
*                                                                  1784 10981000
*             CCWCNT=CCWCNT+1;      /*                       @ZA11014   10982000
*                                                            @ZA11014*/ 10983000
@RF01777 LH    @03,CCWCNT                                          1784 10984000
         LA    @03,1(,@03)                                         1784 10985000
         STH   @03,CCWCNT                                          1784 10986000
*           END;                    /*                       @ZA11014*/ 10987000
*       END;                        /* THIS REC ON TRACK     @ZA11014   10988000
*                                                            @ZA11014*/ 10989000
*                                                                  1786 10990000
*     /***************************************************************/ 10991000
*     /*                                                             */ 10992000
*     /* ELSE THIS RECORD NUM NOT ON TRACK-IGNORE            @ZA11014*/ 10993000
*     /*                                                             */ 10994000
*     /***************************************************************/ 10995000
*                                                                  1787 10996000
*     ELSE                                                         1787 10997000
*       ;                           /*                       @ZA11014*/ 10998000
@RF01732 DS    0H                                                  1788 10999000
*   END;                            /* END ITERATIVE DO      @ZA11014   11000000
*                                                            @ZA11014*/ 11001000
*                                                                  1788 11002000
@RC01732 LA    @03,1                                               1788 11003000
         AH    @03,RCTR                                            1788 11004000
@DE01731 STH   @03,RCTR                                            1788 11005000
         L     @01,RRIOARPT                                        1788 11006000
         CH    @03,RNUMREC(,@01)                                   1788 11007000
         BNH   @DL01731                                            1788 11008000
*   /*****************************************************************/ 11009000
*   /*                                                               */ 11010000
*   /* CCW CHAIN IS BUILT - MOVE IT TO BEGINNING             @ZA11014*/ 11011000
*   /* OF CCW BUFFER                                         @ZA11014*/ 11012000
*   /*                                                               */ 11013000
*   /*****************************************************************/ 11014000
*                                                                  1789 11015000
*                                   /*                       @ZA11014*/ 11016000
*                                                                  1789 11017000
*   /*****************************************************************/ 11018000
*   /*                                                               */ 11019000
*   /* GET LAST CCW BUILT                                    @ZA11014*/ 11020000
*   /*                                                               */ 11021000
*   /*****************************************************************/ 11022000
*                                                                  1789 11023000
*   LASTCCW=CCWCNT-1;               /*                       @ZA11014   11024000
*                                                            @ZA11014*/ 11025000
*                                                                  1789 11026000
         LH    @03,CCWCNT                                          1789 11027000
         BCTR  @03,0                                               1789 11028000
         STH   @03,LASTCCW                                         1789 11029000
*   /*****************************************************************/ 11030000
*   /*                                                               */ 11031000
*   /* CHECK TO SEE IF LAST CCW IS A TIC--IF IT IS           @ZA11014*/ 11032000
*   /* CHANGE IT TO A NOP TO PREVENT THE CCW STRING          @ZA11014*/ 11033000
*   /* FROM RUNNING OFF THE END OF THE EARTH                 @ZA11014*/ 11034000
*   /*                                                               */ 11035000
*   /*****************************************************************/ 11036000
*                                                                  1790 11037000
*   IF ADDR(IOXCCW(LASTCCW))->CCWOP=TICOP/*                  @ZA11014*/ 11038000
*     THEN                          /*                       @ZA11014*/ 11039000
         LH    @03,LASTCCW                                         1790 11040000
         SLA   @03,3                                               1790 11041000
         L     @01,IOCTLBKP                                        1790 11042000
         LA    @03,IOXCCW-8(@03,@01)                               1790 11043000
         CLC   CCWOP(1,@03),TICOP                                  1790 11044000
         BNE   @RF01790                                            1790 11045000
*     ADDR(IOXCCW(LASTCCW))->CCW=CCWRNOP;/*                  @ZA11014   11046000
*                                                            @ZA11014*/ 11047000
*                                                                  1791 11048000
         LH    @03,LASTCCW                                         1791 11049000
         SLA   @03,3                                               1791 11050000
         L     @01,IOCTLBKP                                        1791 11051000
         LA    @03,IOXCCW-8(@03,@01)                               1791 11052000
         MVC   CCW(8,@03),CCWRNOP                                  1791 11053000
*   /*****************************************************************/ 11054000
*   /*                                                               */ 11055000
*   /* TURN OFF COMMAND CHAINING IN LAST CCW                 @ZA11014*/ 11056000
*   /*                                                               */ 11057000
*   /*****************************************************************/ 11058000
*                                                                  1792 11059000
*   ADDR(IOXCCW(LASTCCW))->CCWCMDCH=OFF;/*                   @ZA11014   11060000
*                                                            @ZA11014   11061000
*                                                            @ZA11014*/ 11062000
*                                                                  1792 11063000
@RF01790 LH    @03,LASTCCW                                         1792 11064000
         SLA   @03,3                                               1792 11065000
         L     @01,IOCTLBKP                                        1792 11066000
         LA    @03,IOXCCW-8(@03,@01)                               1792 11067000
         NI    CCWCMDCH(@03),B'10111111'                           1792 11068000
*   /*****************************************************************/ 11069000
*   /*                                                               */ 11070000
*   /* INITIALIZE WHERE NEW STRING IS TO START INDEX         @ZA11014*/ 11071000
*   /*                                                               */ 11072000
*   /*****************************************************************/ 11073000
*                                                                  1793 11074000
*   CCWCNT=1;                       /*                       @ZA11014   11075000
*                                                            @ZA11014*/ 11076000
*                                                                  1793 11077000
         MVC   CCWCNT(2),@CH00222                                  1793 11078000
*   /*****************************************************************/ 11079000
*   /*                                                               */ 11080000
*   /* MOVE ALL THE NEW CCWS JUST BUILT                      @ZA11014*/ 11081000
*   /*                                                               */ 11082000
*   /*****************************************************************/ 11083000
*                                                                  1794 11084000
*   DO RCTR=(MAXRECS+NONRDCT+1) TO LASTCCW;/*                @ZA11014*/ 11085000
         LH    @03,MAXRECS                                         1794 11086000
         AH    @03,NONRDCT                                         1794 11087000
         AL    @03,@CF00222                                        1794 11088000
         B     @DE01794                                            1794 11089000
@DL01794 DS    0H                                                  1795 11090000
*     CCW=ADDR(IOXCCW(RCTR))->CCW;  /*                       @ZA11014*/ 11091000
         LH    @03,CCWCNT                                          1795 11092000
         SLA   @03,3                                               1795 11093000
         L     @01,IOCTLBKP                                        1795 11094000
         LA    @03,IOXCCW-8(@03,@01)                               1795 11095000
         LH    @15,RCTR                                            1795 11096000
         SLA   @15,3                                               1795 11097000
         L     @01,IOCTLBKP                                        1795 11098000
         LA    @15,IOXCCW-8(@15,@01)                               1795 11099000
         MVC   CCW(8,@03),CCW(@15)                                 1795 11100000
*     CCWCNT=CCWCNT+1;              /*                       @ZA11014*/ 11101000
         LH    @03,CCWCNT                                          1796 11102000
         LA    @03,1(,@03)                                         1796 11103000
         STH   @03,CCWCNT                                          1796 11104000
*   END;                            /*                       @ZA11014   11105000
*                                                            @ZA11014*/ 11106000
*                                                                  1797 11107000
         LA    @03,1                                               1797 11108000
         AH    @03,RCTR                                            1797 11109000
@DE01794 STH   @03,RCTR                                            1797 11110000
         CH    @03,LASTCCW                                         1797 11111000
         BNH   @DL01794                                            1797 11112000
*   /*****************************************************************/ 11113000
*   /*                                                               */ 11114000
*   /* SEARCH LOCTAB TO SEE IF ANY COUNT FIELDS SAVED        @ZA11014*/ 11115000
*   /* IF SO-MOVE INTO READ IN BUFFER LOCATION               @ZA11014*/ 11116000
*   /*                                                               */ 11117000
*   /*****************************************************************/ 11118000
*                                                                  1798 11119000
*   DO RCTR=2 TO(RNUMREC+1);        /*                       @ZA11014*/ 11120000
         LA    @03,2                                               1798 11121000
         B     @DE01798                                            1798 11122000
@DL01798 DS    0H                                                  1799 11123000
*     IF LOCCNTFD(RCTR)^=ZEROS      /*                       @ZA11014*/ 11124000
*       THEN                        /*                       @ZA11014*/ 11125000
*                                                                  1799 11126000
         LH    @03,RCTR                                            1799 11127000
         MH    @03,@CH00279                                        1799 11128000
         L     @15,@PC00001+8                                      1799 11129000
         L     @01,EXLOCPTR(,@15)                                  1799 11130000
         ALR   @01,@03                                             1799 11131000
         AL    @01,@CF04428                                        1799 11132000
         CLC   LOCCNTFD-8(8,@01),ZEROS                             1799 11133000
         BE    @RF01799                                            1799 11134000
*       /*************************************************************/ 11135000
*       /*                                                           */ 11136000
*       /* COUNT FIELD SAVED-MOVE IT INTO BUFFER             @ZA11014*/ 11137000
*       /*                                                           */ 11138000
*       /*************************************************************/ 11139000
*                                                                  1800 11140000
*       LOCADDR(RCTR)->RBUFCNT=LOCCNTFD(RCTR);/*             @ZA11014   11141000
*                                                            @ZA11014*/ 11142000
*                                                                  1800 11143000
         LH    @03,RCTR                                            1800 11144000
         MH    @03,@CH00279                                        1800 11145000
         L     @15,@PC00001+8                                      1800 11146000
         L     @01,EXLOCPTR(,@15)                                  1800 11147000
         AL    @01,@CF04425                                        1800 11148000
         L     @03,LOCADDR(@03,@01)                                1800 11149000
         LH    @15,RCTR                                            1800 11150000
         MH    @15,@CH00279                                        1800 11151000
         L     @14,@PC00001+8                                      1800 11152000
         L     @01,EXLOCPTR(,@14)                                  1800 11153000
         ALR   @01,@15                                             1800 11154000
         AL    @01,@CF04428                                        1800 11155000
         MVC   RBUFCNT(8,@03),LOCCNTFD-8(@01)                      1800 11156000
*     /***************************************************************/ 11157000
*     /*                                                             */ 11158000
*     /* ELSE INCREMENT TO NEXT ENTRY                        @ZA11014*/ 11159000
*     /*                                                             */ 11160000
*     /***************************************************************/ 11161000
*                                                                  1801 11162000
*     ELSE                                                         1801 11163000
*       ;                           /*                       @ZA11014*/ 11164000
@RF01799 DS    0H                                                  1802 11165000
*   END;                            /*                       @ZA11014   11166000
*                                                            @ZA11014*/ 11167000
*                                                                  1802 11168000
         LA    @03,1                                               1802 11169000
         AH    @03,RCTR                                            1802 11170000
@DE01798 STH   @03,RCTR                                            1802 11171000
         LA    @15,1                                               1802 11172000
         L     @14,RRIOARPT                                        1802 11173000
         AH    @15,RNUMREC(,@14)                                   1802 11174000
         CR    @03,@15                                             1802 11175000
         BNH   @DL01798                                            1802 11176000
*   /*****************************************************************/ 11177000
*   /*                                                               */ 11178000
*   /* SET RETURN CODE TO OK                                 @ZA11014*/ 11179000
*   /*                                                               */ 11180000
*   /*****************************************************************/ 11181000
*                                                                  1803 11182000
*   TESTRC=0;                       /*                       @ZA11014*/ 11183000
         SLR   @03,@03                                             1803 11184000
         STH   @03,TESTRC                                          1803 11185000
*   RETURN CODE(TESTRC);            /*                       @ZA11014   11186000
*                                                            @ZA11014*/ 11187000
         LH    @15,TESTRC                                          1804 11188000
         L     @14,12(,@13)                                        1804 11189000
         LM    @00,@12,20(@13)                                     1804 11190000
         BR    @14                                                 1804 11191000
*   END SETKDCCW;                   /*                       @ZA11014*/ 11192000
*                                   /*                       @ZA11014*/ 11193000
*/***********************************************************@ZA11014*/ 11194000
*/*                                                          @ZA11014*/ 11195000
*/*  FUNCTION - ADJCCW                                       @ZA11014*/ 11196000
*/*                                                          @ZA11014*/ 11197000
*/*  PROCEDURE - MODIFY THE EXISTING CCW STRING              @ZA11014*/ 11198000
*/*              BUILT BY SETKDCCW SO  READING CAN CONTINUE  @ZA11014*/ 11199000
*/*              BEYOND A BAD KEY OR DATA FIELD              @ZA11014*/ 11200000
*/*                                                          @ZA11014*/ 11201000
*/*              THE CCW FOR THE KEY OR DATA IN ERROR WILL BE@ZA11014*/ 11202000
*/*               CHANGED TO A TIC IF THE CCW WAS A READ     @ZA11014*/ 11203000
*/*               KEY/DATA CCW, OR TO A READ COUNT IF THE    @ZA11014*/ 11204000
*/*               CCW WAS A READ COUNT/KEY/DATA CCW          @ZA11014*/ 11205000
*/*                                                          @ZA11014*/ 11206000
*/*              ALL READ CCWS PREVIOUSLY EXECUTED WILL HAVE @ZA11014*/ 11207000
*/*              DATA TRANSFER SURPRESSED                    @ZA11014*/ 11208000
*/*                                                          @ZA11014*/ 11209000
*/*  INPUT - SVCCWPTR CONTAINS THE SAVED ADDR OF THE         @ZA11014*/ 11210000
*/*                   VALUE IN THE CSW AFTER THE LAST        @ZA11014*/ 11211000
*/*                   CALL TO READKD                         @ZA11014*/ 11212000
*/*          IOCTLBKP                                        @ZA11014*/ 11213000
*/*          CCWLIST IN IOXCCWS                              @ZA11014*/ 11214000
*/*                                                          @ZA11014*/ 11215000
*/*  OUTPUT - MODIFIED CCW LIST IN IOXCCWS                   @ZA11014*/ 11216000
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/ 11217000
*/*                                                          @ZA11014*/ 11218000
*/*                                                          @ZA11014*/ 11219000
*/*                                                          @ZA11014*/ 11220000
*/*                                                          @ZA11014*/ 11221000
*/*                                                          @ZA11014*/ 11222000
*/***********************************************************@ZA11014*/ 11223000
*                                                                  1806 11224000
*                                   /*                       @ZA11014*/ 11225000
*ADJCCW:                                                           1806 11226000
*   PROC;                           /*                       @ZA11014   11227000
*                                                            @ZA11014*/ 11228000
*                                                                  1806 11229000
ADJCCW   STM   @14,@12,12(@13)                                     1806 11230000
*   /*****************************************************************/ 11231000
*   /*                                                               */ 11232000
*   /* SET TRACE ID                                          @ZA11014*/ 11233000
*   /*                                                               */ 11234000
*   /*****************************************************************/ 11235000
*                                                                  1807 11236000
*   OLDERID2=NEWERID2;                                             1807 11237000
         L     @03,@PC00001                                        1807 11238000
         L     @03,GDTTR2(,@03)                                    1807 11239000
         L     @15,@PC00001                                        1807 11240000
         L     @01,GDTTR2(,@15)                                    1807 11241000
         MVC   @TS00001(95),NEWERID2(@01)                          1807 11242000
         MVC   OLDERID2(95,@03),@TS00001                           1807 11243000
*   NEWID2='IOAJ';                  /*                       @ZA11014   11244000
*                                                            @ZA11014*/ 11245000
*                                                                  1808 11246000
         L     @03,@PC00001                                        1808 11247000
         L     @03,GDTTR2(,@03)                                    1808 11248000
         MVC   NEWID2(4,@03),@CC04378                              1808 11249000
*   /*****************************************************************/ 11250000
*   /*                                                               */ 11251000
*   /* CALC NUM OF CCWS EXECUTED                             @ZA11014*/ 11252000
*   /*                                                               */ 11253000
*   /*****************************************************************/ 11254000
*                                                                  1809 11255000
*   CNTCCWS=(SVCCWPTR-ADDR(IOXCCWS))/CCWSIZE;/*              @ZA11014   11256000
*                                                            @ZA11014*/ 11257000
*                                                                  1809 11258000
         L     @03,@PC00001+8                                      1809 11259000
         L     @01,IOCTLBKP                                        1809 11260000
         LA    @15,IOXCCWS(,@01)                                   1809 11261000
         LR    @00,@15                                             1809 11262000
         LCR   @00,@00                                             1809 11263000
         L     @03,SVCCWPTR-1(,@03)                                1809 11264000
         LA    @03,0(,@03)                                         1809 11265000
         ALR   @00,@03                                             1809 11266000
         SRDA  @00,32                                              1809 11267000
         LH    @03,CCWSIZE                                         1809 11268000
         DR    @00,@03                                             1809 11269000
         STH   @01,CNTCCWS                                         1809 11270000
*   /*****************************************************************/ 11271000
*   /*                                                               */ 11272000
*   /* SET INDEX OF FAILING CCW                              @ZA11014*/ 11273000
*   /*                                                               */ 11274000
*   /*****************************************************************/ 11275000
*                                                                  1810 11276000
*   CCWCNT=CNTCCWS;                 /*                       @ZA11014   11277000
*                                                            @ZA11014*/ 11278000
*                                                                  1810 11279000
         LH    @03,CNTCCWS                                         1810 11280000
         STH   @03,CCWCNT                                          1810 11281000
*   /*****************************************************************/ 11282000
*   /*                                                               */ 11283000
*   /* ENSURE CCW IS A READ FOR KEY/DATA OR DATA             @0Z11014*/ 11284000
*   /*                                                               */ 11285000
*   /*****************************************************************/ 11286000
*                                                                  1811 11287000
*   IF CCWOP^=RDKDOP&CCWOP^=RDDTOP  /*                       @0Z11014*/ 11288000
*     THEN                          /*                       @ZA11014*/ 11289000
*                                                                  1811 11290000
         LH    @03,CCWCNT                                          1811 11291000
         SLA   @03,3                                               1811 11292000
         L     @01,IOCTLBKP                                        1811 11293000
         LA    @03,IOXCCW-8(@03,@01)                               1811 11294000
         CLC   CCWOP(1,@03),RDKDOP                                 1811 11295000
         BE    @RF01811                                            1811 11296000
         LH    @03,CCWCNT                                          1811 11297000
         SLA   @03,3                                               1811 11298000
         L     @01,IOCTLBKP                                        1811 11299000
         LA    @03,IOXCCW-8(@03,@01)                               1811 11300000
         CLC   CCWOP(1,@03),RDDTOP                                 1811 11301000
         BE    @RF01811                                            1811 11302000
*     /***************************************************************/ 11303000
*     /*                                                             */ 11304000
*     /* UNEXPECTED RESULTS                                  @ZA11014*/ 11305000
*     /*                                                             */ 11306000
*     /***************************************************************/ 11307000
*                                                                  1812 11308000
*     TESTRC=RCSRUEX;               /*                       @ZA11014   11309000
*                                                            @ZA11014*/ 11310000
         LH    @03,RCSRUEX                                         1812 11311000
         STH   @03,TESTRC                                          1812 11312000
*   ELSE                            /*                       @ZA11014*/ 11313000
*                                                                  1813 11314000
*     /***************************************************************/ 11315000
*     /*                                                             */ 11316000
*     /* OP CODE WHAT WAS EXPECTED-CONTINUE                  @ZA11014*/ 11317000
*     /*                                                             */ 11318000
*     /***************************************************************/ 11319000
*                                                                  1813 11320000
*     DO;                           /*                       @ZA11014   11321000
*                                                            @0Z11014*/ 11322000
         B     @RC01811                                            1813 11323000
@RF01811 DS    0H                                                  1814 11324000
*       RESPECIFY                                                  1814 11325000
*         RBUF BASED(CCWADDR-8);    /*                       @0Z11014*/ 11326000
*       IF CCWOP=RDDTOP             /*                       @0Z11014*/ 11327000
*         THEN                      /*                       @ZA11014*/ 11328000
*                                                                  1815 11329000
         LH    @03,CCWCNT                                          1815 11330000
         SLA   @03,3                                               1815 11331000
         L     @01,IOCTLBKP                                        1815 11332000
         LA    @03,IOXCCW-8(@03,@01)                               1815 11333000
         CLC   CCWOP(1,@03),RDDTOP                                 1815 11334000
         BNE   @RF01815                                            1815 11335000
*         /***********************************************************/ 11336000
*         /*                                                         */ 11337000
*         /* READ DATA CCW-DATA BYTES WERE TRANSFERED        @0Z11014*/ 11338000
*         /* OVERLAY CCW WITH A TIC TO *+8                   @0Z11014*/ 11339000
*         /*                                                         */ 11340000
*         /***********************************************************/ 11341000
*                                                                  1816 11342000
*         DO;                       /*                       @ZA11014*/ 11343000
*           CCW=CCWTIC;             /*                       @ZA11014*/ 11344000
         LH    @03,CCWCNT                                          1817 11345000
         SLA   @03,3                                               1817 11346000
         L     @01,IOCTLBKP                                        1817 11347000
         LA    @03,IOXCCW-8(@03,@01)                               1817 11348000
         MVC   CCW(8,@03),CCWTIC                                   1817 11349000
*           CCWADDR=ADDR(IOXCCW(CCWCNT+1));/*                @ZA11014*/ 11350000
         LH    @03,CCWCNT                                          1818 11351000
         SLA   @03,3                                               1818 11352000
         L     @01,IOCTLBKP                                        1818 11353000
         LA    @03,IOXCCW-8(@03,@01)                               1818 11354000
         LH    @15,CCWCNT                                          1818 11355000
         SLA   @15,3                                               1818 11356000
         L     @01,IOCTLBKP                                        1818 11357000
         LA    @15,IOXCCW(@15,@01)                                 1818 11358000
         STCM  @15,7,CCWADDR(@03)                                  1818 11359000
*         END;                      /*                       @ZA11014   11360000
*                                                            @ZA11014*/ 11361000
*       ELSE                        /*                       @ZA11014*/ 11362000
*                                                                  1820 11363000
*         /***********************************************************/ 11364000
*         /*                                                         */ 11365000
*         /* READ KEY/DATA CCW-OVERLAY WITH READ DATA        @0Z11014*/ 11366000
*         /* CCW TO ENSURE DATA BYTES GET TRANSFERED         @0Z11014*/ 11367000
*         /*                                                         */ 11368000
*         /***********************************************************/ 11369000
*                                                                  1820 11370000
*         DO;                       /*                       @ZA11014*/ 11371000
         B     @RC01815                                            1820 11372000
@RF01815 DS    0H                                                  1821 11373000
*           CCWOP=RDDTOP;           /*                       @0Z11014*/ 11374000
         LH    @03,CCWCNT                                          1821 11375000
         SLA   @03,3                                               1821 11376000
         L     @01,IOCTLBKP                                        1821 11377000
         LA    @03,IOXCCW-8(@03,@01)                               1821 11378000
         IC    @15,RDDTOP                                          1821 11379000
         STC   @15,CCWOP(,@03)                                     1821 11380000
*           CCWDATLN=CCWDATLN-RBKL; /*                       @0Z11014*/ 11381000
         LH    @03,CCWCNT                                          1822 11382000
         SLA   @03,3                                               1822 11383000
         L     @01,IOCTLBKP                                        1822 11384000
         LA    @03,IOXCCW-8(@03,@01)                               1822 11385000
         LH    @15,CCWCNT                                          1822 11386000
         SLA   @15,3                                               1822 11387000
         L     @01,IOCTLBKP                                        1822 11388000
         LA    @15,IOXCCW-8(@15,@01)                               1822 11389000
         LH    @14,CCWCNT                                          1822 11390000
         SLA   @14,3                                               1822 11391000
         L     @01,IOCTLBKP                                        1822 11392000
         LA    @14,IOXCCW-8(@14,@01)                               1822 11393000
         L     @01,CCWADDR-1(,@14)                                 1822 11394000
         LH    @00,CCWDATLN(,@15)                                  1822 11395000
         AL    @01,@CF04429                                        1822 11396000
         SLR   @15,@15                                             1822 11397000
         IC    @15,RBKL-5(,@01)                                    1822 11398000
         SLR   @00,@15                                             1822 11399000
         STH   @00,CCWDATLN(,@03)                                  1822 11400000
*           CCWADDR=CCWADDR+RBKL;   /*                       @0Z11014*/ 11401000
         LH    @03,CCWCNT                                          1823 11402000
         SLA   @03,3                                               1823 11403000
         L     @01,IOCTLBKP                                        1823 11404000
         LA    @03,IOXCCW-8(@03,@01)                               1823 11405000
         LH    @15,CCWCNT                                          1823 11406000
         SLA   @15,3                                               1823 11407000
         L     @01,IOCTLBKP                                        1823 11408000
         LA    @15,IOXCCW-8(@15,@01)                               1823 11409000
         LH    @14,CCWCNT                                          1823 11410000
         SLA   @14,3                                               1823 11411000
         L     @01,IOCTLBKP                                        1823 11412000
         LA    @14,IOXCCW-8(@14,@01)                               1823 11413000
         L     @01,CCWADDR-1(,@14)                                 1823 11414000
         L     @00,CCWADDR-1(,@15)                                 1823 11415000
         ICM   @00,8,@CB03783                                      1823 11416000
         AL    @01,@CF04429                                        1823 11417000
         SLR   @15,@15                                             1823 11418000
         IC    @15,RBKL-5(,@01)                                    1823 11419000
         ALR   @00,@15                                             1823 11420000
         STCM  @00,7,CCWADDR(@03)                                  1823 11421000
*           CCWSUPP=OFF;            /*                       @0Z11014*/ 11422000
         LH    @03,CCWCNT                                          1824 11423000
         SLA   @03,3                                               1824 11424000
         L     @01,IOCTLBKP                                        1824 11425000
         LA    @03,IOXCCW-8(@03,@01)                               1824 11426000
         NI    CCWSUPP(@03),B'11101111'                            1824 11427000
*         END;                      /*                       @ZA11014   11428000
*                                                            @ZA11014*/ 11429000
*                                                                  1825 11430000
*       /*************************************************************/ 11431000
*       /*                                                           */ 11432000
*       /* BAD CCW HAS BEEN BYPASSED                         @ZA11014*/ 11433000
*       /* TURN SUPP DATA ON IN ALL READ CCWS PRIOR TO       @ZA11014*/ 11434000
*       /* LAST ONE AS LONG AS LAST ONE IS NOT BEFORE        @ZA11014*/ 11435000
*       /* SECOND RECORD                                     @ZA11014*/ 11436000
*       /*                                                           */ 11437000
*       /*************************************************************/ 11438000
*                                                                  1826 11439000
*       IF CNTCCWS>=NONRDCT+1       /*                       @ZA11014*/ 11440000
*         THEN                      /*                       @ZA11014*/ 11441000
@RC01815 LA    @03,1                                               1826 11442000
         AH    @03,NONRDCT                                         1826 11443000
         CH    @03,CNTCCWS                                         1826 11444000
         BH    @RF01826                                            1826 11445000
*         DO CCWCNT=(NONRDCT+1) TO(CNTCCWS-1);/*             @ZA11014*/ 11446000
         LA    @03,1                                               1827 11447000
         AH    @03,NONRDCT                                         1827 11448000
         B     @DE01827                                            1827 11449000
@DL01827 DS    0H                                                  1828 11450000
*           IF CCWOP=RDCKDOP|CCWOP=RDKDOP/*                  @ZA11014*/ 11451000
*               |CCWOP=RDCNTOP      /*                       @0Z11014*/ 11452000
*             THEN                  /*                       @ZA11014*/ 11453000
         LH    @03,CCWCNT                                          1828 11454000
         SLA   @03,3                                               1828 11455000
         L     @01,IOCTLBKP                                        1828 11456000
         LA    @03,IOXCCW-8(@03,@01)                               1828 11457000
         CLC   CCWOP(1,@03),RDCKDOP                                1828 11458000
         BE    @RT01828                                            1828 11459000
         LH    @03,CCWCNT                                          1828 11460000
         SLA   @03,3                                               1828 11461000
         L     @01,IOCTLBKP                                        1828 11462000
         LA    @03,IOXCCW-8(@03,@01)                               1828 11463000
         CLC   CCWOP(1,@03),RDKDOP                                 1828 11464000
         BE    @RT01828                                            1828 11465000
         LH    @03,CCWCNT                                          1828 11466000
         SLA   @03,3                                               1828 11467000
         L     @01,IOCTLBKP                                        1828 11468000
         LA    @03,IOXCCW-8(@03,@01)                               1828 11469000
         CLC   CCWOP(1,@03),RDCNTOP                                1828 11470000
         BNE   @RF01828                                            1828 11471000
@RT01828 DS    0H                                                  1829 11472000
*             CCWSUPP=ON;           /*                       @ZA11014*/ 11473000
         LH    @03,CCWCNT                                          1829 11474000
         SLA   @03,3                                               1829 11475000
         L     @01,IOCTLBKP                                        1829 11476000
         LA    @03,IOXCCW-8(@03,@01)                               1829 11477000
         OI    CCWSUPP(@03),B'00010000'                            1829 11478000
*           ELSE                                                   1830 11479000
*             ;                     /*                       @ZA11014*/ 11480000
@RF01828 DS    0H                                                  1831 11481000
*         END;                      /*                       @ZA11014*/ 11482000
         LA    @03,1                                               1831 11483000
         AH    @03,CCWCNT                                          1831 11484000
@DE01827 STH   @03,CCWCNT                                          1831 11485000
         LH    @15,CNTCCWS                                         1831 11486000
         BCTR  @15,0                                               1831 11487000
         CR    @03,@15                                             1831 11488000
         BNH   @DL01827                                            1831 11489000
*       ELSE                                                       1832 11490000
*         ;                         /*                       @ZA11014*/ 11491000
@RF01826 DS    0H                                                  1833 11492000
*       TESTRC=0;                   /*                       @ZA11014*/ 11493000
         SLR   @03,@03                                             1833 11494000
         STH   @03,TESTRC                                          1833 11495000
*     END;                          /*                       @ZA11014   11496000
*                                                            @ZA11014*/ 11497000
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/ 11498000
@RC01811 LH    @15,TESTRC                                          1835 11499000
         L     @14,12(,@13)                                        1835 11500000
         LM    @00,@12,20(@13)                                     1835 11501000
         BR    @14                                                 1835 11502000
*   END ADJCCW;                     /*                       @ZA11014   11503000
*                                                            @ZA11014*/ 11504000
*                                                                  1837 11505000
*/***********************************************************@ZA11014*/ 11506000
*/*                                                          @ZA11014*/ 11507000
*/*  PROCEDURE NAME - WRITEREC                               @ZA11014*/ 11508000
*/*                                                          @ZA11014*/ 11509000
*/*  FUNCTION - BUILDS THE FOLLOWING CCW LIST TO UPDATE IN   @ZA11014*/ 11510000
*/*              PLACE A RECORD ON A TRACK                   @ZA11014*/ 11511000
*/*                                                          @ZA11014*/ 11512000
*/*                 SET SECTOR ZERO                          @ZA11014*/ 11513000
*/*                 SEARCH ID EQUAL                          @ZA11014*/ 11514000
*/*                 TIC *-8                                  @ZA11014*/ 11515000
*/*                 WRITE KEY/DATA OR WRITE SPECIAL          @ZA11014*/ 11516000
*/*                 SET SECTOR 0                             @ZA11014*/ 11517000
*/*                 SEARCH ID EQUAL                          @ZA11014*/ 11518000
*/*                 TIC *-8                                  @ZA11014*/ 11519000
*/*                 READ KEY/DATA OR COUNT/KEY/DATA          @ZA11014*/ 11520000
*/*             CALLS ISSUEXCP TO EXECUTE CCW CHAIN          @ZA11014*/ 11521000
*/*             RETURNS                                      @ZA11014*/ 11522000
*/*                                                          @ZA11014*/ 11523000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 11524000
*/*                                                          @ZA11014*/ 11525000
*/*                                                          @ZA11014*/ 11526000
*/*                                                          @ZA11014*/ 11527000
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/ 11528000
*/*          EXRWIOAR FROM EXWRARG                           @ZA11014*/ 11529000
*/*          EXCC     FROM EXWRARG                           @ZA11014*/ 11530000
*/*          EXHH     FROM EXWRARG                           @ZA11014*/ 11531000
*/*          EXRECNUM FROM EXWRARG                           @ZA11014*/ 11532000
*/*          EXRWFUN  FROM EXWRARG                           @ZA11014*/ 11533000
*/*                                                          @ZA11014*/ 11534000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @ZA11014*/ 11535000
*/*                                                          @ZA11014*/ 11536000
*/*                                                          @ZA11014*/ 11537000
*/*                                                          @ZA11014*/ 11538000
*/***********************************************************@ZA11014*/ 11539000
*                                                                  1837 11540000
*                                   /*                       @ZA11014*/ 11541000
*WRITEREC:                                                         1837 11542000
*   PROC;                           /*                       @ZA11014   11543000
*                                                            @ZA11014*/ 11544000
*                                                                  1837 11545000
WRITEREC STM   @14,@12,@SA00029                                    1837 11546000
*   /*****************************************************************/ 11547000
*   /*                                                               */ 11548000
*   /* SET TRACE ID                                          @ZA11014*/ 11549000
*   /*                                                               */ 11550000
*   /*****************************************************************/ 11551000
*                                                                  1838 11552000
*   OLDERID2=NEWERID2;                                             1838 11553000
         L     @03,@PC00001                                        1838 11554000
         L     @03,GDTTR2(,@03)                                    1838 11555000
         L     @15,@PC00001                                        1838 11556000
         L     @01,GDTTR2(,@15)                                    1838 11557000
         MVC   @TS00001(95),NEWERID2(@01)                          1838 11558000
         MVC   OLDERID2(95,@03),@TS00001                           1838 11559000
*   NEWID2='IOWR';                  /*                       @ZA11014   11560000
*                                                            @ZA11014*/ 11561000
*                                                                  1839 11562000
         L     @03,@PC00001                                        1839 11563000
         L     @03,GDTTR2(,@03)                                    1839 11564000
         MVC   NEWID2(4,@03),@CC04384                              1839 11565000
*   /*****************************************************************/ 11566000
*   /*                                                               */ 11567000
*   /* TEST TO SEE IF VALID ENTRY                            @ZA11014*/ 11568000
*   /*                                                               */ 11569000
*   /*****************************************************************/ 11570000
*                                                                  1840 11571000
*   IF EXRWFUN^=RVWS&EXRWFUN^=RVWKD /*                       @ZA11014*/ 11572000
*     THEN                          /*                       @ZA11014*/ 11573000
*                                                                  1840 11574000
         L     @03,@PC00001+8                                      1840 11575000
         CLC   EXRWFUN(1,@03),RVWS                                 1840 11576000
         BE    @RF01840                                            1840 11577000
         L     @03,@PC00001+8                                      1840 11578000
         CLC   EXRWFUN(1,@03),RVWKD                                1840 11579000
         BE    @RF01840                                            1840 11580000
*     /***************************************************************/ 11581000
*     /*                                                             */ 11582000
*     /* INVALID WRITE REQUEST                               @ZA11014*/ 11583000
*     /*                                                             */ 11584000
*     /***************************************************************/ 11585000
*                                                                  1841 11586000
*     TESTRC=RCINVWR;               /*                       @ZA11014   11587000
*                                                            @ZA11014   11588000
*                                                            @ZA11014*/ 11589000
         LH    @03,RCINVWR                                         1841 11590000
         STH   @03,TESTRC                                          1841 11591000
*   ELSE                            /*                       @ZA11014*/ 11592000
*                                                                  1842 11593000
*     /***************************************************************/ 11594000
*     /*                                                             */ 11595000
*     /* REQUEST OK-CONTINUE                                 @ZA11014*/ 11596000
*     /*                                                             */ 11597000
*     /***************************************************************/ 11598000
*                                                                  1842 11599000
*     DO;                           /*                       @ZA11014   11600000
*                                                            @ZA11014   11601000
*                                                            @ZA11014   11602000
*                                                            @ZA11014*/ 11603000
*                                                                  1842 11604000
         B     @RC01840                                            1842 11605000
@RF01840 DS    0H                                                  1843 11606000
*       /*************************************************************/ 11607000
*       /*                                                           */ 11608000
*       /* SET UP ADDRABILITY TO IOXCTLBK AND WIOAREA        @ZA11014*/ 11609000
*       /*                                                           */ 11610000
*       /*************************************************************/ 11611000
*                                                                  1843 11612000
*       IOCTLBKP=EXRWCTBL;          /*                       @ZA11014*/ 11613000
         L     @03,@PC00001+8                                      1843 11614000
         L     @03,EXRWCTBL(,@03)                                  1843 11615000
         ST    @03,IOCTLBKP                                        1843 11616000
*       RWIOARPT=EXRWIOAR;          /*                       @ZA11014*/ 11617000
         L     @03,@PC00001+8                                      1844 11618000
         L     @03,EXRWIOAR(,@03)                                  1844 11619000
         ST    @03,RWIOARPT                                        1844 11620000
*       RESPECIFY                                                  1845 11621000
*         WBUF BASED(ADDR(WBUFF));  /*                       @ZA11014   11622000
*                                                            @ZA11014*/ 11623000
*                                                                  1845 11624000
*       /*************************************************************/ 11625000
*       /*                                                           */ 11626000
*       /* INITIALIZE DCB AND IOB POINTERS                   @ZA11014*/ 11627000
*       /*                                                           */ 11628000
*       /*************************************************************/ 11629000
*                                                                  1846 11630000
*       DCBPTR=ADDR(IOXDCB);        /*                       @ZA11014*/ 11631000
         L     @03,IOCTLBKP                                        1846 11632000
         LA    @03,IOXDCB(,@03)                                    1846 11633000
         ST    @03,DCBPTR                                          1846 11634000
*       IOBSTPTR=ADDR(IOXIOB);      /*                       @ZA11014   11635000
*                                                            @ZA11014*/ 11636000
*                                                                  1847 11637000
         L     @03,IOCTLBKP                                        1847 11638000
         LA    @03,IOXIOB(,@03)                                    1847 11639000
         ST    @03,IOBSTPTR                                        1847 11640000
*       /*************************************************************/ 11641000
*       /*                                                           */ 11642000
*       /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE     @ZA11014*/ 11643000
*       /* IOBSEEK CCHHR VALUE                               @ZA11014*/ 11644000
*       /*                                                           */ 11645000
*       /*************************************************************/ 11646000
*                                                                  1848 11647000
*       IOBCC=EXCC;                 /*                       @ZA11014*/ 11648000
         L     @03,@PC00001+8                                      1848 11649000
         L     @01,IOBSTPTR                                        1848 11650000
         MVC   IOBCC(2,@01),EXCC(@03)                              1848 11651000
*       IOBHH=EXHH;                 /*                       @ZA11014*/ 11652000
         L     @03,@PC00001+8                                      1849 11653000
         L     @01,IOBSTPTR                                        1849 11654000
         MVC   IOBHH(2,@01),EXHH(@03)                              1849 11655000
*       IOBR=EXRECNUM;              /*                       @ZA11014   11656000
*                                                            @ZA11014*/ 11657000
*                                                                  1850 11658000
         L     @03,@PC00001+8                                      1850 11659000
         IC    @15,EXRECNUM(,@03)                                  1850 11660000
         L     @03,IOBSTPTR                                        1850 11661000
         STC   @15,IOBR(,@03)                                      1850 11662000
*       /*************************************************************/ 11663000
*       /*                                                           */ 11664000
*       /* CALC START OF CCW CHAIN-AFTER LAST RD CNT         @ZA11014*/ 11665000
*       /*                                                           */ 11666000
*       /*************************************************************/ 11667000
*                                                                  1851 11668000
*       CCWCNT=NONRDCT+MAXRECS+1;   /*                       @ZA11014   11669000
*                                                            @ZA11014*/ 11670000
*                                                                  1851 11671000
         LH    @03,NONRDCT                                         1851 11672000
         AH    @03,MAXRECS                                         1851 11673000
         LA    @03,1(,@03)                                         1851 11674000
         STH   @03,CCWCNT                                          1851 11675000
*       /*************************************************************/ 11676000
*       /*                                                           */ 11677000
*       /* INITIALIZE THE START ADDR OF THE CCW CHN IN IO@ZA11014    */ 11678000
*       /*                                                           */ 11679000
*       /*************************************************************/ 11680000
*                                                                  1852 11681000
*       IOBSTART=ADDR(IOXCCW(CCWCNT));/*                     @ZA11014   11682000
*                                                            @ZA11014*/ 11683000
*                                                                  1852 11684000
         LH    @03,CCWCNT                                          1852 11685000
         SLA   @03,3                                               1852 11686000
         L     @01,IOCTLBKP                                        1852 11687000
         LA    @03,IOXCCW-8(@03,@01)                               1852 11688000
         L     @01,IOBSTPTR                                        1852 11689000
         ST    @03,IOBSTART(,@01)                                  1852 11690000
*       /*************************************************************/ 11691000
*       /*                                                           */ 11692000
*       /* SET FIRST CCW TO SET SECTOR ZERO - WANT TO        @ZA11014*/ 11693000
*       /* START FROM BEGINNING OF TRACK SO THAT             @ZA11014*/ 11694000
*       /* ERRORS CAN BE FIXED SEQUENTIALLY ONE AT A TIM@ZA11014     */ 11695000
*       /*                                                           */ 11696000
*       /*************************************************************/ 11697000
*                                                                  1853 11698000
*       CCW=CCWRSSEC;               /*                       @ZA11014*/ 11699000
         LH    @03,CCWCNT                                          1853 11700000
         SLA   @03,3                                               1853 11701000
         L     @01,IOCTLBKP                                        1853 11702000
         LA    @03,IOXCCW-8(@03,@01)                               1853 11703000
         MVC   CCW(8,@03),CCWRSSEC                                 1853 11704000
*       CCWADDR=ADDR(ZERO);         /*                       @ZA11014   11705000
*                                                            @ZA11014*/ 11706000
*                                                                  1854 11707000
         LH    @03,CCWCNT                                          1854 11708000
         SLA   @03,3                                               1854 11709000
         L     @01,IOCTLBKP                                        1854 11710000
         LA    @03,IOXCCW-8(@03,@01)                               1854 11711000
         LA    @15,ZERO                                            1854 11712000
         STCM  @15,7,CCWADDR(@03)                                  1854 11713000
*       /*************************************************************/ 11714000
*       /*                                                           */ 11715000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 11716000
*       /*                                                           */ 11717000
*       /*************************************************************/ 11718000
*                                                                  1855 11719000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   11720000
*                                                            @ZA11014*/ 11721000
*                                                                  1855 11722000
         LH    @03,CCWCNT                                          1855 11723000
         LA    @03,1(,@03)                                         1855 11724000
         STH   @03,CCWCNT                                          1855 11725000
*       /*************************************************************/ 11726000
*       /*                                                           */ 11727000
*       /* SET NEXT CCW TO SEARCH ID EQUAL-THEN DETERMINE@ZA11014    */ 11728000
*       /* WHAT RECORD NUMBER TO SEARCH ON                   @ZA11014*/ 11729000
*       /*                                                           */ 11730000
*       /*************************************************************/ 11731000
*                                                                  1856 11732000
*       CCW=CCWSIDEQ;               /*                       @ZA11014   11733000
*                                                            @ZA11014*/ 11734000
*                                                                  1856 11735000
         LH    @03,CCWCNT                                          1856 11736000
         SLA   @03,3                                               1856 11737000
         L     @01,IOCTLBKP                                        1856 11738000
         LA    @03,IOXCCW-8(@03,@01)                               1856 11739000
         MVC   CCW(8,@03),CCWSIDEQ                                 1856 11740000
*       /*************************************************************/ 11741000
*       /*                                                           */ 11742000
*       /* CHECK IF WRITE KEY/DATA                           @ZA11014*/ 11743000
*       /*                                                           */ 11744000
*       /*************************************************************/ 11745000
*                                                                  1857 11746000
*       IF EXRWFUN=RVWKD            /*                       @ZA11014*/ 11747000
*         THEN                      /*                       @ZA11014*/ 11748000
*                                                                  1857 11749000
         L     @03,@PC00001+8                                      1857 11750000
         CLC   EXRWFUN(1,@03),RVWKD                                1857 11751000
         BNE   @RF01857                                            1857 11752000
*         /***********************************************************/ 11753000
*         /*                                                         */ 11754000
*         /* WRITE KEY/DATA-SEARCH THIS RECORD NUMBER        @ZA11014*/ 11755000
*         /*                                                         */ 11756000
*         /***********************************************************/ 11757000
*                                                                  1858 11758000
*         SRCHR=EXRECNUM;           /*                       @ZA11014   11759000
*                                                            @ZA11014*/ 11760000
         L     @03,@PC00001+8                                      1858 11761000
         IC    @15,EXRECNUM(,@03)                                  1858 11762000
         STC   @15,SRCHR                                           1858 11763000
*       ELSE                        /*                       @ZA11014*/ 11764000
*                                                                  1859 11765000
*         /***********************************************************/ 11766000
*         /*                                                         */ 11767000
*         /* WRITE SPECIAL-DETERMINE SEARCH REC NUM          @ZA11014*/ 11768000
*         /*                                                         */ 11769000
*         /***********************************************************/ 11770000
*                                                                  1859 11771000
*         DO;                       /*                       @ZA11014*/ 11772000
*                                                                  1859 11773000
         B     @RC01857                                            1859 11774000
@RF01857 DS    0H                                                  1860 11775000
*           /*********************************************************/ 11776000
*           /*                                                       */ 11777000
*           /* SEARCH REC IS FIRST PREVIOUS AVAILABLE        @ZA11014*/ 11778000
*           /* CHECK LOCTAB BEGINNING IN ENTRY BEFORE        @ZA11014*/ 11779000
*           /* REQUESTED REC--LOCTAB STARTS AT R0            @ZA11014*/ 11780000
*           /*                                                       */ 11781000
*           /*********************************************************/ 11782000
*                                                                  1860 11783000
*           RCTR=EXRECNUM;          /*                       @ZA11014*/ 11784000
         L     @03,@PC00001+8                                      1860 11785000
         SLR   @15,@15                                             1860 11786000
         IC    @15,EXRECNUM(,@03)                                  1860 11787000
         STH   @15,RCTR                                            1860 11788000
*           DO WHILE RCTR^=1&LOCADDR(RCTR)=NTFNDPTR;/*       @ZA11014*/ 11789000
         B     @DE01861                                            1861 11790000
@DL01861 DS    0H                                                  1862 11791000
*             RCTR=RCTR-1;          /*                       @ZA11014*/ 11792000
         LH    @03,RCTR                                            1862 11793000
         BCTR  @03,0                                               1862 11794000
         STH   @03,RCTR                                            1862 11795000
*           END;                    /*                       @ZA11014   11796000
*                                                            @ZA11014*/ 11797000
*                                                                  1863 11798000
@DE01861 CLC   RCTR(2),@CH00222                                    1863 11799000
         BE    @DC01861                                            1863 11800000
         LH    @03,RCTR                                            1863 11801000
         MH    @03,@CH00279                                        1863 11802000
         L     @15,@PC00001+8                                      1863 11803000
         L     @01,EXLOCPTR(,@15)                                  1863 11804000
         AL    @01,@CF04425                                        1863 11805000
         L     @03,LOCADDR(@03,@01)                                1863 11806000
         ICM   @15,15,NTFNDPTR                                     1863 11807000
         CLR   @03,@15                                             1863 11808000
         BE    @DL01861                                            1863 11809000
@DC01861 DS    0H                                                  1864 11810000
*           /*********************************************************/ 11811000
*           /*                                                       */ 11812000
*           /* SET SEARCH REC NUM                            @ZA11014*/ 11813000
*           /*                                                       */ 11814000
*           /*********************************************************/ 11815000
*                                                                  1864 11816000
*           SRCHR=RCTR-1;           /*                       @ZA11014*/ 11817000
         LH    @03,RCTR                                            1864 11818000
         BCTR  @03,0                                               1864 11819000
         STC   @03,SRCHR                                           1864 11820000
*         END;                      /*                       @ZA11014   11821000
*                                                            @ZA11014*/ 11822000
*                                                                  1865 11823000
*       /*************************************************************/ 11824000
*       /*                                                           */ 11825000
*       /* SET CYLINDER AND HEAD IN SEARCH ARG               @ZA11014*/ 11826000
*       /*                                                           */ 11827000
*       /*************************************************************/ 11828000
*                                                                  1866 11829000
*       SRCHCC=EXCC;                /*                       @ZA11014*/ 11830000
@RC01857 L     @03,@PC00001+8                                      1866 11831000
         LH    @03,EXCC(,@03)                                      1866 11832000
         N     @03,@CF04424                                        1866 11833000
         STH   @03,SRCHCC                                          1866 11834000
*       SRCHHH=EXHH;                /*                       @ZA11014   11835000
*                                                            @ZA11014*/ 11836000
*                                                                  1867 11837000
         L     @03,@PC00001+8                                      1867 11838000
         LH    @03,EXHH(,@03)                                      1867 11839000
         N     @03,@CF04424                                        1867 11840000
         STH   @03,SRCHHH                                          1867 11841000
*       /*************************************************************/ 11842000
*       /*                                                           */ 11843000
*       /* SET SEARCH ADDR INTO CCW                          @ZA11014*/ 11844000
*       /*                                                           */ 11845000
*       /*************************************************************/ 11846000
*                                                                  1868 11847000
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014   11848000
*                                                            @ZA11014*/ 11849000
*                                                                  1868 11850000
         LH    @03,CCWCNT                                          1868 11851000
         SLA   @03,3                                               1868 11852000
         L     @01,IOCTLBKP                                        1868 11853000
         LA    @03,IOXCCW-8(@03,@01)                               1868 11854000
         LA    @15,SRCHCHR                                         1868 11855000
         STCM  @15,7,CCWADDR(@03)                                  1868 11856000
*       /*************************************************************/ 11857000
*       /*                                                           */ 11858000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 11859000
*       /*                                                           */ 11860000
*       /*************************************************************/ 11861000
*                                                                  1869 11862000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   11863000
*                                                            @ZA11014*/ 11864000
*                                                                  1869 11865000
         LH    @03,CCWCNT                                          1869 11866000
         LA    @03,1(,@03)                                         1869 11867000
         STH   @03,CCWCNT                                          1869 11868000
*       /*************************************************************/ 11869000
*       /*                                                           */ 11870000
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/ 11871000
*       /*                                                           */ 11872000
*       /*************************************************************/ 11873000
*                                                                  1870 11874000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 11875000
         LH    @03,CCWCNT                                          1870 11876000
         SLA   @03,3                                               1870 11877000
         L     @01,IOCTLBKP                                        1870 11878000
         LA    @03,IOXCCW-8(@03,@01)                               1870 11879000
         MVC   CCW(8,@03),CCWTIC                                   1870 11880000
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014   11881000
*                                                            @ZA11014*/ 11882000
*                                                                  1871 11883000
         LH    @03,CCWCNT                                          1871 11884000
         SLA   @03,3                                               1871 11885000
         L     @01,IOCTLBKP                                        1871 11886000
         LA    @03,IOXCCW-8(@03,@01)                               1871 11887000
         LH    @15,CCWCNT                                          1871 11888000
         SLA   @15,3                                               1871 11889000
         L     @01,IOCTLBKP                                        1871 11890000
         LA    @15,IOXCCW-16(@15,@01)                              1871 11891000
         STCM  @15,7,CCWADDR(@03)                                  1871 11892000
*       /*************************************************************/ 11893000
*       /*                                                           */ 11894000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 11895000
*       /*                                                           */ 11896000
*       /*************************************************************/ 11897000
*                                                                  1872 11898000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   11899000
*                                                            @ZA11014*/ 11900000
*                                                                  1872 11901000
         LH    @03,CCWCNT                                          1872 11902000
         LA    @03,1(,@03)                                         1872 11903000
         STH   @03,CCWCNT                                          1872 11904000
*       /*************************************************************/ 11905000
*       /*                                                           */ 11906000
*       /* READY FOR WRITE CCW-SAVE ITS INDEX                @ZA11014*/ 11907000
*       /*                                                           */ 11908000
*       /*************************************************************/ 11909000
*                                                                  1873 11910000
*       RVCNT=CCWCNT;               /*                       @ZA11014   11911000
*                                                            @ZA11014*/ 11912000
*                                                                  1873 11913000
         LH    @03,CCWCNT                                          1873 11914000
         STH   @03,RVCNT                                           1873 11915000
*       /*************************************************************/ 11916000
*       /*                                                           */ 11917000
*       /* DETERMINE IF WANT TO WR K/D OR WR SPEC            @ZA11014*/ 11918000
*       /*                                                           */ 11919000
*       /*************************************************************/ 11920000
*                                                                  1874 11921000
*       IF EXRWFUN=RVWKD            /*                       @ZA11014*/ 11922000
*         THEN                      /*                       @ZA11014*/ 11923000
*                                                                  1874 11924000
         L     @03,@PC00001+8                                      1874 11925000
         CLC   EXRWFUN(1,@03),RVWKD                                1874 11926000
         BNE   @RF01874                                            1874 11927000
*         /***********************************************************/ 11928000
*         /*                                                         */ 11929000
*         /* WRITE KEY DATA FUNC-SET UP CCW                  @ZA11014*/ 11930000
*         /*                                                         */ 11931000
*         /***********************************************************/ 11932000
*                                                                  1875 11933000
*         DO;                       /*                       @ZA11014*/ 11934000
*           CCW=CCWRWKD;            /*                       @ZA11014*/ 11935000
         LH    @03,CCWCNT                                          1876 11936000
         SLA   @03,3                                               1876 11937000
         L     @01,IOCTLBKP                                        1876 11938000
         LA    @03,IOXCCW-8(@03,@01)                               1876 11939000
         MVC   CCW(8,@03),CCWRWKD                                  1876 11940000
*           CCWADDR=ADDR(WKEYDAT);  /*                       @ZA11014*/ 11941000
         LH    @03,CCWCNT                                          1877 11942000
         SLA   @03,3                                               1877 11943000
         L     @01,IOCTLBKP                                        1877 11944000
         LA    @03,IOXCCW-8(@03,@01)                               1877 11945000
         L     @01,RWIOARPT                                        1877 11946000
         LA    @15,WKEYDAT+4(,@01)                                 1877 11947000
         STCM  @15,7,CCWADDR(@03)                                  1877 11948000
*           CCWDATLN=WBKL+WBDL;     /*                       @ZA11014*/ 11949000
         LH    @03,CCWCNT                                          1878 11950000
         SLA   @03,3                                               1878 11951000
         L     @01,IOCTLBKP                                        1878 11952000
         LA    @03,IOXCCW-8(@03,@01)                               1878 11953000
         L     @01,RWIOARPT                                        1878 11954000
         SLR   @00,@00                                             1878 11955000
         IC    @00,WBKL+4(,@01)                                    1878 11956000
         L     @01,RWIOARPT                                        1878 11957000
         AH    @00,WBDL+4(,@01)                                    1878 11958000
         STH   @00,CCWDATLN(,@03)                                  1878 11959000
*         END;                      /*                       @ZA11014   11960000
*                                                            @ZA11014*/ 11961000
*       ELSE                        /*                       @ZA11014*/ 11962000
*                                                                  1880 11963000
*         /***********************************************************/ 11964000
*         /*                                                         */ 11965000
*         /* WRITE SPECIAL FUNC-SET UP CCW                   @ZA11014*/ 11966000
*         /*                                                         */ 11967000
*         /***********************************************************/ 11968000
*                                                                  1880 11969000
*         DO;                       /*                       @ZA11014*/ 11970000
         B     @RC01874                                            1880 11971000
@RF01874 DS    0H                                                  1881 11972000
*           CCW=CCWRWSP;            /*                       @ZA11014*/ 11973000
         LH    @03,CCWCNT                                          1881 11974000
         SLA   @03,3                                               1881 11975000
         L     @01,IOCTLBKP                                        1881 11976000
         LA    @03,IOXCCW-8(@03,@01)                               1881 11977000
         MVC   CCW(8,@03),CCWRWSP                                  1881 11978000
*           CCWADDR=ADDR(WBUFF);    /*                       @ZA11014*/ 11979000
         LH    @03,CCWCNT                                          1882 11980000
         SLA   @03,3                                               1882 11981000
         L     @01,IOCTLBKP                                        1882 11982000
         LA    @03,IOXCCW-8(@03,@01)                               1882 11983000
         L     @01,RWIOARPT                                        1882 11984000
         LA    @15,WBUFF(,@01)                                     1882 11985000
         STCM  @15,7,CCWADDR(@03)                                  1882 11986000
*           CCWDATLN=WBKL+WBDL+LENCNT;/*                     @ZA11014*/ 11987000
         LH    @03,CCWCNT                                          1883 11988000
         SLA   @03,3                                               1883 11989000
         L     @01,IOCTLBKP                                        1883 11990000
         LA    @03,IOXCCW-8(@03,@01)                               1883 11991000
         L     @01,RWIOARPT                                        1883 11992000
         SLR   @00,@00                                             1883 11993000
         IC    @00,WBKL+4(,@01)                                    1883 11994000
         L     @01,RWIOARPT                                        1883 11995000
         AH    @00,WBDL+4(,@01)                                    1883 11996000
         AH    @00,LENCNT                                          1883 11997000
         STH   @00,CCWDATLN(,@03)                                  1883 11998000
*         END;                      /*                       @ZA11014   11999000
*                                                            @ZA11014*/ 12000000
*                                                                  1884 12001000
*       /*************************************************************/ 12002000
*       /*                                                           */ 12003000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12004000
*       /*                                                           */ 12005000
*       /*************************************************************/ 12006000
*                                                                  1885 12007000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12008000
*                                                            @ZA11014*/ 12009000
*                                                                  1885 12010000
@RC01874 LH    @03,CCWCNT                                          1885 12011000
         LA    @03,1(,@03)                                         1885 12012000
         STH   @03,CCWCNT                                          1885 12013000
*       /*************************************************************/ 12014000
*       /*                                                           */ 12015000
*       /* SET UP TO VERIFY WRITE BY READING BACK            @ZA11014*/ 12016000
*       /* MUST DO ANOTHER SET SECTOR ZERO IN CASE           @ZA11014*/ 12017000
*       /* OTHER ERROR RECORDS ON TRACK                      @ZA11014*/ 12018000
*       /*                                                           */ 12019000
*       /*************************************************************/ 12020000
*                                                                  1886 12021000
*       CCW=CCWRSSEC;               /*                       @ZA11014*/ 12022000
         LH    @03,CCWCNT                                          1886 12023000
         SLA   @03,3                                               1886 12024000
         L     @01,IOCTLBKP                                        1886 12025000
         LA    @03,IOXCCW-8(@03,@01)                               1886 12026000
         MVC   CCW(8,@03),CCWRSSEC                                 1886 12027000
*       CCWADDR=ADDR(ZEROS);        /*                       @ZA11014   12028000
*                                                            @ZA11014*/ 12029000
*                                                                  1887 12030000
         LH    @03,CCWCNT                                          1887 12031000
         SLA   @03,3                                               1887 12032000
         L     @01,IOCTLBKP                                        1887 12033000
         LA    @03,IOXCCW-8(@03,@01)                               1887 12034000
         LA    @15,ZEROS                                           1887 12035000
         STCM  @15,7,CCWADDR(@03)                                  1887 12036000
*       /*************************************************************/ 12037000
*       /*                                                           */ 12038000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12039000
*       /*                                                           */ 12040000
*       /*************************************************************/ 12041000
*                                                                  1888 12042000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12043000
*                                                            @ZA11014*/ 12044000
*                                                                  1888 12045000
         LH    @03,CCWCNT                                          1888 12046000
         LA    @03,1(,@03)                                         1888 12047000
         STH   @03,CCWCNT                                          1888 12048000
*       /*************************************************************/ 12049000
*       /*                                                           */ 12050000
*       /* SEARCH ID EQUAL SAME AS WRITE                     @ZA11014*/ 12051000
*       /*                                                           */ 12052000
*       /*************************************************************/ 12053000
*                                                                  1889 12054000
*       CCW=CCWSIDEQ;               /*                       @ZA11014*/ 12055000
         LH    @03,CCWCNT                                          1889 12056000
         SLA   @03,3                                               1889 12057000
         L     @01,IOCTLBKP                                        1889 12058000
         LA    @03,IOXCCW-8(@03,@01)                               1889 12059000
         MVC   CCW(8,@03),CCWSIDEQ                                 1889 12060000
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014   12061000
*                                                            @ZA11014*/ 12062000
*                                                                  1890 12063000
         LH    @03,CCWCNT                                          1890 12064000
         SLA   @03,3                                               1890 12065000
         L     @01,IOCTLBKP                                        1890 12066000
         LA    @03,IOXCCW-8(@03,@01)                               1890 12067000
         LA    @15,SRCHCHR                                         1890 12068000
         STCM  @15,7,CCWADDR(@03)                                  1890 12069000
*       /*************************************************************/ 12070000
*       /*                                                           */ 12071000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12072000
*       /*                                                           */ 12073000
*       /*************************************************************/ 12074000
*                                                                  1891 12075000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12076000
*                                                            @ZA11014*/ 12077000
*                                                                  1891 12078000
         LH    @03,CCWCNT                                          1891 12079000
         LA    @03,1(,@03)                                         1891 12080000
         STH   @03,CCWCNT                                          1891 12081000
*       /*************************************************************/ 12082000
*       /*                                                           */ 12083000
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/ 12084000
*       /*                                                           */ 12085000
*       /*************************************************************/ 12086000
*                                                                  1892 12087000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 12088000
         LH    @03,CCWCNT                                          1892 12089000
         SLA   @03,3                                               1892 12090000
         L     @01,IOCTLBKP                                        1892 12091000
         LA    @03,IOXCCW-8(@03,@01)                               1892 12092000
         MVC   CCW(8,@03),CCWTIC                                   1892 12093000
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014   12094000
*                                                            @ZA11014*/ 12095000
*                                                                  1893 12096000
         LH    @03,CCWCNT                                          1893 12097000
         SLA   @03,3                                               1893 12098000
         L     @01,IOCTLBKP                                        1893 12099000
         LA    @03,IOXCCW-8(@03,@01)                               1893 12100000
         LH    @15,CCWCNT                                          1893 12101000
         SLA   @15,3                                               1893 12102000
         L     @01,IOCTLBKP                                        1893 12103000
         LA    @15,IOXCCW-16(@15,@01)                              1893 12104000
         STCM  @15,7,CCWADDR(@03)                                  1893 12105000
*       /*************************************************************/ 12106000
*       /*                                                           */ 12107000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12108000
*       /*                                                           */ 12109000
*       /*************************************************************/ 12110000
*                                                                  1894 12111000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12112000
*                                                            @ZA11014*/ 12113000
*                                                                  1894 12114000
         LH    @03,CCWCNT                                          1894 12115000
         LA    @03,1(,@03)                                         1894 12116000
         STH   @03,CCWCNT                                          1894 12117000
*       /*************************************************************/ 12118000
*       /*                                                           */ 12119000
*       /* DETERMINE WHAT KIND OF READ TO DO                 @ZA11014*/ 12120000
*       /*                                                           */ 12121000
*       /*************************************************************/ 12122000
*                                                                  1895 12123000
*       IF EXRWFUN=RVWKD            /*                       @ZA11014*/ 12124000
*         THEN                      /*                       @ZA11014*/ 12125000
*                                                                  1895 12126000
         L     @03,@PC00001+8                                      1895 12127000
         CLC   EXRWFUN(1,@03),RVWKD                                1895 12128000
         BNE   @RF01895                                            1895 12129000
*         /***********************************************************/ 12130000
*         /*                                                         */ 12131000
*         /* WRITE KEY/DATA-READ BACK KEY/DATA               @ZA11014*/ 12132000
*         /*                                                         */ 12133000
*         /***********************************************************/ 12134000
*                                                                  1896 12135000
*         CCW=CCWRRKD;              /*                       @ZA11014   12136000
*                                                            @ZA11014*/ 12137000
         LH    @03,CCWCNT                                          1896 12138000
         SLA   @03,3                                               1896 12139000
         L     @01,IOCTLBKP                                        1896 12140000
         LA    @03,IOXCCW-8(@03,@01)                               1896 12141000
         MVC   CCW(8,@03),CCWRRKD                                  1896 12142000
*       ELSE                        /*                       @ZA11014*/ 12143000
*                                                                  1897 12144000
*         /***********************************************************/ 12145000
*         /*                                                         */ 12146000
*         /* WRITE SPECIAL-READ BACK COUNT/KEY/DATA          @ZA11014*/ 12147000
*         /*                                                         */ 12148000
*         /***********************************************************/ 12149000
*                                                                  1897 12150000
*         CCW=CCWRRCKD;             /*                       @ZA11014   12151000
*                                                            @ZA11014*/ 12152000
*                                                                  1897 12153000
         B     @RC01895                                            1897 12154000
@RF01895 LH    @03,CCWCNT                                          1897 12155000
         SLA   @03,3                                               1897 12156000
         L     @01,IOCTLBKP                                        1897 12157000
         LA    @03,IOXCCW-8(@03,@01)                               1897 12158000
         MVC   CCW(8,@03),CCWRRCKD                                 1897 12159000
*       /*************************************************************/ 12160000
*       /*                                                           */ 12161000
*       /* SET ADDR SAME AS WRITE,SUPP DATA XFER=NO CHAIN@ZA11014    */ 12162000
*       /*                                                           */ 12163000
*       /*************************************************************/ 12164000
*                                                                  1898 12165000
*       CCWADDR=ADDR(IOXCCW(RVCNT))->CCWADDR;/*              @ZA11014*/ 12166000
@RC01895 LH    @03,CCWCNT                                          1898 12167000
         SLA   @03,3                                               1898 12168000
         L     @01,IOCTLBKP                                        1898 12169000
         LA    @03,IOXCCW-8(@03,@01)                               1898 12170000
         LH    @15,RVCNT                                           1898 12171000
         SLA   @15,3                                               1898 12172000
         L     @01,IOCTLBKP                                        1898 12173000
         LA    @15,IOXCCW-8(@15,@01)                               1898 12174000
         MVC   CCWADDR(3,@03),CCWADDR(@15)                         1898 12175000
*       CCWDATLN=ADDR(IOXCCW(RVCNT))->CCWDATLN;/*            @ZA11014*/ 12176000
         LH    @03,CCWCNT                                          1899 12177000
         SLA   @03,3                                               1899 12178000
         L     @01,IOCTLBKP                                        1899 12179000
         LA    @03,IOXCCW-8(@03,@01)                               1899 12180000
         LH    @15,RVCNT                                           1899 12181000
         SLA   @15,3                                               1899 12182000
         L     @01,IOCTLBKP                                        1899 12183000
         LA    @15,IOXCCW-8(@15,@01)                               1899 12184000
         LH    @15,CCWDATLN(,@15)                                  1899 12185000
         STH   @15,CCWDATLN(,@03)                                  1899 12186000
*       CCWSUPP=ON;                 /*                       @ZA11014*/ 12187000
*       CCWCMDCH=OFF;               /*                       @ZA11014   12188000
*                                                            @ZA11014*/ 12189000
*                                                                  1901 12190000
         LH    @03,CCWCNT                                          1901 12191000
         SLA   @03,3                                               1901 12192000
         L     @01,IOCTLBKP                                        1901 12193000
         LA    @03,IOXCCW-8(@03,@01)                               1901 12194000
         OI    CCWSUPP(@03),B'00010000'                            1901 12195000
         NI    CCWCMDCH(@03),B'10111111'                           1901 12196000
*       /*************************************************************/ 12197000
*       /*                                                           */ 12198000
*       /* CCW CHAIN ALL BUILT-SET TRACE ID BEFORE EXCP      @ZA11014*/ 12199000
*       /*                                                           */ 12200000
*       /*************************************************************/ 12201000
*                                                                  1902 12202000
*       OLDERID2=NEWERID2;                                         1902 12203000
         L     @03,@PC00001                                        1902 12204000
         L     @03,GDTTR2(,@03)                                    1902 12205000
         L     @15,@PC00001                                        1902 12206000
         L     @01,GDTTR2(,@15)                                    1902 12207000
         MVC   @TS00001(95),NEWERID2(@01)                          1902 12208000
         MVC   OLDERID2(95,@03),@TS00001                           1902 12209000
*       NEWID2='IOWB';              /*                       @ZA11014   12210000
*                                                            @ZA11014*/ 12211000
*                                                                  1903 12212000
         L     @03,@PC00001                                        1903 12213000
         L     @03,GDTTR2(,@03)                                    1903 12214000
         MVC   NEWID2(4,@03),@CC04387                              1903 12215000
*       /*************************************************************/ 12216000
*       /*                                                           */ 12217000
*       /* CALL ISSUEXCP TO DO I/O                           @ZA11014*/ 12218000
*       /*                                                           */ 12219000
*       /*************************************************************/ 12220000
*                                                                  1904 12221000
*       CALL ISSUEXCP;              /*                       @ZA11014*/ 12222000
         BAL   @14,ISSUEXCP                                        1904 12223000
*       RESPECIFY                                                  1905 12224000
*         RTNREG RSTD;                                             1905 12225000
*       TESTRC=RTNREG;                                             1906 12226000
         STH   RTNREG,TESTRC                                       1906 12227000
*       RESPECIFY                                                  1907 12228000
*         RTNREG UNRSTD;            /*                       @ZA11014*/ 12229000
*                                                                  1907 12230000
*       /*************************************************************/ 12231000
*       /*                                                           */ 12232000
*       /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS     */ 12233000
*       /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW          */ 12234000
*       /* ADDITIONAL I/O. SO WE CLEAR THEM HERE.            @ZA17169*/ 12235000
*       /*                                                           */ 12236000
*       /*************************************************************/ 12237000
*                                                                  1908 12238000
*       IF TESTRC^=0 THEN           /*                       @ZA17169*/ 12239000
         LH    @03,TESTRC                                          1908 12240000
         LTR   @03,@03                                             1908 12241000
         BZ    @RF01908                                            1908 12242000
*         DCBIFEC='00'B;            /*                       @ZA17169   12243000
*                                                            @ZA11014*/ 12244000
*                                                                  1909 12245000
         L     @03,DCBPTR                                          1909 12246000
         NI    DCBIFEC+40(@03),B'00111111'                         1909 12247000
*       /*************************************************************/ 12248000
*       /*                                                           */ 12249000
*       /* IF GOOD DATA OVERFLOW CONDITION ON READ BACK      @ZA11014*/ 12250000
*       /* VERIFY FOR A WRITE SPECIAL-THAN ALL OK            @ZA11014*/ 12251000
*       /*                                                           */ 12252000
*       /*************************************************************/ 12253000
*                                                                  1910 12254000
*       IF EXRWFUN=RVWS&TESTRC=RCABOV/*                      @ZA11014*/ 12255000
*         THEN                      /*                       @ZA11014*/ 12256000
*                                                                  1910 12257000
@RF01908 L     @03,@PC00001+8                                      1910 12258000
         CLC   EXRWFUN(1,@03),RVWS                                 1910 12259000
         BNE   @RF01910                                            1910 12260000
         CLC   TESTRC(2),RCABOV                                    1910 12261000
         BNE   @RF01910                                            1910 12262000
*         /***********************************************************/ 12263000
*         /*                                                         */ 12264000
*         /* SET RETURN CODE TO OK                           @ZA11014*/ 12265000
*         /*                                                         */ 12266000
*         /***********************************************************/ 12267000
*                                                                  1911 12268000
*         TESTRC=0;                 /*                       @ZA11014   12269000
*                                                            @ZA11014*/ 12270000
         SLR   @03,@03                                             1911 12271000
         STH   @03,TESTRC                                          1911 12272000
*       ELSE                                                       1912 12273000
*         ;                         /*                       @ZA11014   12274000
*                                                            @ZA11014*/ 12275000
*                                                                  1912 12276000
@RF01910 DS    0H                                                  1913 12277000
*       /*************************************************************/ 12278000
*       /*                                                           */ 12279000
*       /* END OF OK TO CONTINUE ELSE                        @ZA11014*/ 12280000
*       /*                                                           */ 12281000
*       /*************************************************************/ 12282000
*                                                                  1913 12283000
*     END;                          /*                       @ZA11014   12284000
*                                                            @ZA11014*/ 12285000
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/ 12286000
@RC01840 LH    @15,TESTRC                                          1914 12287000
         L     @14,@SA00029                                        1914 12288000
         LM    @00,@12,@SA00029+8                                  1914 12289000
         BR    @14                                                 1914 12290000
*   END WRITEREC;                   /*                       @ZA11014   12291000
*                                                            @ZA11014*/ 12292000
*                                                                  1916 12293000
*/***********************************************************@ZA11014*/ 12294000
*/*                                                          @ZA11014*/ 12295000
*/*  PROCEDURE NAME - FWRITE                                 @ZA11014*/ 12296000
*/*                                                          @ZA11014*/ 12297000
*/*  FUNCTION - BUILDS THE FOLLOWING CCW LIST TO WRITE A     @ZA11014*/ 12298000
*/*              SPECIFIED NUMBER OF RECORDS ON A TRACK      @ZA11014*/ 12299000
*/*              BEGINNING AT A SPECIFIED RECORD NUMBER      @ZA11014*/ 12300000
*/*                                                          @ZA11014*/ 12301000
*/*              FOR NON-R0 BEGINNING RECORD -               @ZA11014*/ 12302000
*/*                 SET SECTOR ZERO                          @ZA11014*/ 12303000
*/*                 SEARCH ID EQUAL                          @ZA11014*/ 12304000
*/*                 TIC *-8                                  @ZA11014*/ 12305000
*/*                 WRITE COUNT/KEY/DATA                     @ZA11014*/ 12306000
*/*                     ^                                    @ZA11014*/ 12307000
*/*                 WRITE COUNT/KEY/DATA                     @ZA11014*/ 12308000
*/*                 SET SECTOR 0                             @ZA11014*/ 12309000
*/*                 SEARCH ID EQUAL                          @ZA11014*/ 12310000
*/*                 TIC *-8                                  @ZA11014*/ 12311000
*/*                 READ COUNT/KEY/DATA                      @ZA11014*/ 12312000
*/*                     ^                                    @ZA11014*/ 12313000
*/*                 READ COUNT/KEY/DATA                      @ZA11014*/ 12314000
*/*         NOTE - FOR R0 BEGINNING RECORD -                 @ZA11014*/ 12315000
*/*                 SET SECTOR 0                             @ZA11014*/ 12316000
*/*                 SEARCH ID EQ(R0)                         @ZA11014*/ 12317000
*/*                 TIC *-8                                  @ZA11014*/ 12318000
*/*                 WRITE KEY/DATA(R0)                       @ZA11014*/ 12319000
*/*                 SET SECTOR 0                             @ZA11014*/ 12320000
*/*                 SEARCH ID EQ                             @ZA11014*/ 12321000
*/*                 TIC *-8                                  @ZA11014*/ 12322000
*/*                 WRITE C/K/D                              @ZA11014*/ 12323000
*/*                    .                                     @ZA11014*/ 12324000
*/*                    .                                     @ZA11014*/ 12325000
*/*                    .                                     @ZA11014*/ 12326000
*/*                 WRITE C/K/D                              @ZA11014*/ 12327000
*/*                 SET SECTOR 0                             @ZA11014*/ 12328000
*/*                 READ 0                                   @ZA11014*/ 12329000
*/*                 READ C/K/D                               @ZA11014*/ 12330000
*/*                    .                                     @ZA11014*/ 12331000
*/*                    .                                     @ZA11014*/ 12332000
*/*                    .                                     @ZA11014*/ 12333000
*/*                 READ C/K/D                               @ZA11014*/ 12334000
*/*                FOR READ BACK VALIDATION IF REQUIRED,     @ZA11014*/ 12335000
*/*                THE LAST RECORD WRITTEN WILL BE A WRITE   @ZA11014*/ 12336000
*/*                SPECIAL COUNT/KEY/DATA                    @ZA11014*/ 12337000
*/*             CALLS ISSUEXCP TO EXECUTE CCW CHAIN          @ZA11014*/ 12338000
*/*             RETURNS                                      @ZA11014*/ 12339000
*/*                                                          @ZA11014*/ 12340000
*/*             THERE ARE NO MESSAGES ISSUED BY THIS PROC    @ZA11014*/ 12341000
*/*                                                          @ZA11014*/ 12342000
*/*                                                          @ZA11014*/ 12343000
*/*                                                          @ZA11014*/ 12344000
*/*  INPUT - EXWRCTBL FROM EXWRARG                           @ZA11014*/ 12345000
*/*          EXRWIOAR FROM EXWRARG                           @ZA11014*/ 12346000
*/*          EXCC     FROM EXWRARG                           @ZA11014*/ 12347000
*/*          EXHH     FROM EXWRARG                           @ZA11014*/ 12348000
*/*          EXRECNUM FROM EXWRARG                           @ZA11014*/ 12349000
*/*          EXRWFUN  FROM EXWRARG                           @ZA11014*/ 12350000
*/*          WNUMREC  FROM WIOAREA                           @ZA11014*/ 12351000
*/*          DATA IN WBUFF OF WIOAREA                        @ZA11014*/ 12352000
*/*                                                          @ZA11014*/ 12353000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @ZA11014*/ 12354000
*/*                                                          @ZA11014*/ 12355000
*/*                                                          @ZA11014*/ 12356000
*/*                                                          @ZA11014*/ 12357000
*/***********************************************************@ZA11014*/ 12358000
*                                                                  1916 12359000
*                                   /*                       @ZA11014*/ 12360000
*FWRITE:                                                           1916 12361000
*   PROC;                           /*                       @ZA11014   12362000
*                                                            @ZA11014*/ 12363000
*                                                                  1916 12364000
FWRITE   STM   @14,@12,@SA00030                                    1916 12365000
*   /*****************************************************************/ 12366000
*   /*                                                               */ 12367000
*   /* SET TRACE ID                                          @ZA11014*/ 12368000
*   /*                                                               */ 12369000
*   /*****************************************************************/ 12370000
*                                                                  1917 12371000
*   OLDERID2=NEWERID2;                                             1917 12372000
         L     @03,@PC00001                                        1917 12373000
         L     @03,GDTTR2(,@03)                                    1917 12374000
         L     @15,@PC00001                                        1917 12375000
         L     @01,GDTTR2(,@15)                                    1917 12376000
         MVC   @TS00001(95),NEWERID2(@01)                          1917 12377000
         MVC   OLDERID2(95,@03),@TS00001                           1917 12378000
*   NEWID2='IOFW';                  /*                       @ZA11014   12379000
*                                                            @ZA11014*/ 12380000
*                                                                  1918 12381000
         L     @03,@PC00001                                        1918 12382000
         L     @03,GDTTR2(,@03)                                    1918 12383000
         MVC   NEWID2(4,@03),@CC04391                              1918 12384000
*   /*****************************************************************/ 12385000
*   /*                                                               */ 12386000
*   /* SET UP ADDRABILITY TO IOXCTLBK AND WIOAREA            @ZA11014*/ 12387000
*   /*                                                               */ 12388000
*   /*****************************************************************/ 12389000
*                                                                  1919 12390000
*   IOCTLBKP=EXRWCTBL;              /*                       @ZA11014*/ 12391000
         L     @03,@PC00001+8                                      1919 12392000
         L     @03,EXRWCTBL(,@03)                                  1919 12393000
         ST    @03,IOCTLBKP                                        1919 12394000
*   RWIOARPT=EXRWIOAR;              /*                       @ZA11014*/ 12395000
         L     @03,@PC00001+8                                      1920 12396000
         L     @03,EXRWIOAR(,@03)                                  1920 12397000
         ST    @03,RWIOARPT                                        1920 12398000
*   RESPECIFY                                                      1921 12399000
*     WBUF BASED(WRADDR);           /*                       @ZA11014   12400000
*                                                            @ZA11014*/ 12401000
*                                                                  1921 12402000
*   /*****************************************************************/ 12403000
*   /*                                                               */ 12404000
*   /* INITIALIZE DCB AND IOB POINTERS                       @ZA11014*/ 12405000
*   /*                                                               */ 12406000
*   /*****************************************************************/ 12407000
*                                                                  1922 12408000
*   DCBPTR=ADDR(IOXDCB);            /*                       @ZA11014*/ 12409000
         L     @03,IOCTLBKP                                        1922 12410000
         LA    @03,IOXDCB(,@03)                                    1922 12411000
         ST    @03,DCBPTR                                          1922 12412000
*   IOBSTPTR=ADDR(IOXIOB);          /*                       @ZA11014   12413000
*                                                            @ZA11014*/ 12414000
*                                                                  1923 12415000
         L     @03,IOCTLBKP                                        1923 12416000
         LA    @03,IOXIOB(,@03)                                    1923 12417000
         ST    @03,IOBSTPTR                                        1923 12418000
*   /*****************************************************************/ 12419000
*   /*                                                               */ 12420000
*   /* THE NEXT GROUP OF INSTRUCTIONS INITIALIZE THE         @ZA11014*/ 12421000
*   /* IOBSEEK CCHHR VALUE                                   @ZA11014*/ 12422000
*   /*                                                               */ 12423000
*   /*****************************************************************/ 12424000
*                                                                  1924 12425000
*   IOBCC=EXCC;                     /*                       @ZA11014*/ 12426000
         L     @03,@PC00001+8                                      1924 12427000
         L     @01,IOBSTPTR                                        1924 12428000
         MVC   IOBCC(2,@01),EXCC(@03)                              1924 12429000
*   IOBHH=EXHH;                     /*                       @ZA11014*/ 12430000
         L     @03,@PC00001+8                                      1925 12431000
         L     @01,IOBSTPTR                                        1925 12432000
         MVC   IOBHH(2,@01),EXHH(@03)                              1925 12433000
*   IOBR=EXRECNUM;                  /*                       @ZA11014   12434000
*                                                            @ZA11014*/ 12435000
*                                                                  1926 12436000
         L     @03,@PC00001+8                                      1926 12437000
         IC    @15,EXRECNUM(,@03)                                  1926 12438000
         L     @03,IOBSTPTR                                        1926 12439000
         STC   @15,IOBR(,@03)                                      1926 12440000
*   /*****************************************************************/ 12441000
*   /*                                                               */ 12442000
*   /* CALC START OF CCW CHAIN-AFTER LAST RD CNT             @ZA11014*/ 12443000
*   /*                                                               */ 12444000
*   /*****************************************************************/ 12445000
*                                                                  1927 12446000
*   CCWCNT=NONRDCT+MAXRECS+1;       /*                       @ZA11014   12447000
*                                                            @ZA11014*/ 12448000
*                                                                  1927 12449000
         LH    @03,NONRDCT                                         1927 12450000
         AH    @03,MAXRECS                                         1927 12451000
         LA    @03,1(,@03)                                         1927 12452000
         STH   @03,CCWCNT                                          1927 12453000
*   /*****************************************************************/ 12454000
*   /*                                                               */ 12455000
*   /* INITIALIZE THE START ADDR OF THE CCW CHN IN IOB       @ZA11014*/ 12456000
*   /*                                                               */ 12457000
*   /*****************************************************************/ 12458000
*                                                                  1928 12459000
*   IOBSTART=ADDR(IOXCCW(CCWCNT));  /*                       @ZA11014   12460000
*                                                            @ZA11014*/ 12461000
*                                                                  1928 12462000
         LH    @03,CCWCNT                                          1928 12463000
         SLA   @03,3                                               1928 12464000
         L     @01,IOCTLBKP                                        1928 12465000
         LA    @03,IOXCCW-8(@03,@01)                               1928 12466000
         L     @01,IOBSTPTR                                        1928 12467000
         ST    @03,IOBSTART(,@01)                                  1928 12468000
*   /*****************************************************************/ 12469000
*   /*                                                               */ 12470000
*   /* SET FIRST CCW TO SET SECTOR ZERO - WANT TO            @ZA11014*/ 12471000
*   /* START FROM BEGINNING OF TRACK SO THAT                 @ZA11014*/ 12472000
*   /* ERRORS CAN BE FIXED SEQUENTIALLY ONE AT A TIME        @ZA11014*/ 12473000
*   /*                                                               */ 12474000
*   /*****************************************************************/ 12475000
*                                                                  1929 12476000
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/ 12477000
         LH    @03,CCWCNT                                          1929 12478000
         SLA   @03,3                                               1929 12479000
         L     @01,IOCTLBKP                                        1929 12480000
         LA    @03,IOXCCW-8(@03,@01)                               1929 12481000
         MVC   CCW(8,@03),CCWRSSEC                                 1929 12482000
*   CCWADDR=ADDR(ZERO);             /*                       @ZA11014   12483000
*                                                            @ZA11014*/ 12484000
*                                                                  1930 12485000
         LH    @03,CCWCNT                                          1930 12486000
         SLA   @03,3                                               1930 12487000
         L     @01,IOCTLBKP                                        1930 12488000
         LA    @03,IOXCCW-8(@03,@01)                               1930 12489000
         LA    @15,ZERO                                            1930 12490000
         STCM  @15,7,CCWADDR(@03)                                  1930 12491000
*   /*****************************************************************/ 12492000
*   /*                                                               */ 12493000
*   /* INCREMENT CCW CHAIN INDEX                             @ZA11014*/ 12494000
*   /*                                                               */ 12495000
*   /*****************************************************************/ 12496000
*                                                                  1931 12497000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   12498000
*                                                            @ZA11014*/ 12499000
*                                                                  1931 12500000
         LH    @03,CCWCNT                                          1931 12501000
         LA    @03,1(,@03)                                         1931 12502000
         STH   @03,CCWCNT                                          1931 12503000
*   /*****************************************************************/ 12504000
*   /*                                                               */ 12505000
*   /* SET NEXT CCW TO SEARCH ID EQUAL-THEN DETERMINE        @ZA11014*/ 12506000
*   /*                                                               */ 12507000
*   /*****************************************************************/ 12508000
*                                                                  1932 12509000
*   CCW=CCWSIDEQ;                   /*                       @ZA11014   12510000
*                                                            @ZA11014*/ 12511000
*                                                                  1932 12512000
         LH    @03,CCWCNT                                          1932 12513000
         SLA   @03,3                                               1932 12514000
         L     @01,IOCTLBKP                                        1932 12515000
         LA    @03,IOXCCW-8(@03,@01)                               1932 12516000
         MVC   CCW(8,@03),CCWSIDEQ                                 1932 12517000
*   /*****************************************************************/ 12518000
*   /*                                                               */ 12519000
*   /* SET SEARCH CYLINDER AND HEAD ADDRS                    @ZA11014*/ 12520000
*   /*                                                               */ 12521000
*   /*****************************************************************/ 12522000
*                                                                  1933 12523000
*   SRCHCC=EXCC;                    /*                       @ZA11014*/ 12524000
         L     @03,@PC00001+8                                      1933 12525000
         LH    @03,EXCC(,@03)                                      1933 12526000
         N     @03,@CF04424                                        1933 12527000
         STH   @03,SRCHCC                                          1933 12528000
*   SRCHHH=EXHH;                    /*                       @ZA11014   12529000
*                                                            @ZA11014*/ 12530000
*                                                                  1934 12531000
         L     @03,@PC00001+8                                      1934 12532000
         LH    @03,EXHH(,@03)                                      1934 12533000
         N     @03,@CF04424                                        1934 12534000
         STH   @03,SRCHHH                                          1934 12535000
*   /*****************************************************************/ 12536000
*   /*                                                               */ 12537000
*   /* INIT ADDR OF WHERE TO WRITE FROM                      @ZA11014*/ 12538000
*   /*                                                               */ 12539000
*   /*****************************************************************/ 12540000
*                                                                  1935 12541000
*   WRADDR=ADDR(WBUFF);             /*                       @ZA11014   12542000
*                                                            @ZA11014*/ 12543000
*                                                                  1935 12544000
         L     @03,RWIOARPT                                        1935 12545000
         LA    @03,WBUFF(,@03)                                     1935 12546000
         ST    @03,WRADDR                                          1935 12547000
*   /*****************************************************************/ 12548000
*   /*                                                               */ 12549000
*   /* CHECK TO SEE IF TO BEGIN AT RECORD ZERO               @ZA11014*/ 12550000
*   /*                                                               */ 12551000
*   /*****************************************************************/ 12552000
*                                                                  1936 12553000
*   IF EXRECNUM^=ZERO               /*                       @ZA11014*/ 12554000
*     THEN                          /*                       @ZA11014*/ 12555000
*                                                                  1936 12556000
         L     @03,@PC00001+8                                      1936 12557000
         SLR   @15,@15                                             1936 12558000
         IC    @15,EXRECNUM(,@03)                                  1936 12559000
         CH    @15,ZERO                                            1936 12560000
         BE    @RF01936                                            1936 12561000
*     /***************************************************************/ 12562000
*     /*                                                             */ 12563000
*     /* REQUEST IS TO BEGIN AFTER R0-                       @ZA11014*/ 12564000
*     /* FIRST DETERMINE SEARCH RECORD NUMBER                @ZA11014*/ 12565000
*     /*                                                             */ 12566000
*     /***************************************************************/ 12567000
*                                                                  1937 12568000
*     DO;                           /*                       @ZA11014*/ 12569000
*                                                                  1937 12570000
*       /*************************************************************/ 12571000
*       /*                                                           */ 12572000
*       /* SEARCH REC IS FIRST PREVIOUS AVAILABLE            @ZA11014*/ 12573000
*       /* CHECK LOCTAB BEGINNING IN ENTRY BEFORE            @ZA11014*/ 12574000
*       /* REQUESTED REC (LOCTAB STARTS AT R0)               @ZA11014*/ 12575000
*       /*                                                           */ 12576000
*       /*************************************************************/ 12577000
*                                                                  1938 12578000
*       RCTR=EXRECNUM;              /*                       @ZA11014*/ 12579000
         L     @03,@PC00001+8                                      1938 12580000
         SLR   @15,@15                                             1938 12581000
         IC    @15,EXRECNUM(,@03)                                  1938 12582000
         STH   @15,RCTR                                            1938 12583000
*       DO WHILE RCTR^=1&LOCADDR(RCTR)=NTFNDPTR;/*           @ZA11014*/ 12584000
         B     @DE01939                                            1939 12585000
@DL01939 DS    0H                                                  1940 12586000
*         RCTR=RCTR-1;              /*                       @ZA11014*/ 12587000
         LH    @03,RCTR                                            1940 12588000
         BCTR  @03,0                                               1940 12589000
         STH   @03,RCTR                                            1940 12590000
*       END;                        /*                       @ZA11014   12591000
*                                                            @ZA11014*/ 12592000
*                                                                  1941 12593000
@DE01939 CLC   RCTR(2),@CH00222                                    1941 12594000
         BE    @DC01939                                            1941 12595000
         LH    @03,RCTR                                            1941 12596000
         MH    @03,@CH00279                                        1941 12597000
         L     @15,@PC00001+8                                      1941 12598000
         L     @01,EXLOCPTR(,@15)                                  1941 12599000
         AL    @01,@CF04425                                        1941 12600000
         L     @03,LOCADDR(@03,@01)                                1941 12601000
         ICM   @15,15,NTFNDPTR                                     1941 12602000
         CLR   @03,@15                                             1941 12603000
         BE    @DL01939                                            1941 12604000
@DC01939 DS    0H                                                  1942 12605000
*       /*************************************************************/ 12606000
*       /*                                                           */ 12607000
*       /* SET SEARCH REC NUM                                @ZA11014*/ 12608000
*       /*                                                           */ 12609000
*       /*************************************************************/ 12610000
*                                                                  1942 12611000
*       SRCHR=RCTR-1;               /*                       @ZA11014   12612000
*                                                            @ZA11014*/ 12613000
*                                                                  1942 12614000
         LH    @03,RCTR                                            1942 12615000
         BCTR  @03,0                                               1942 12616000
         STC   @03,SRCHR                                           1942 12617000
*       /*************************************************************/ 12618000
*       /*                                                           */ 12619000
*       /* SET SEARCH ADDR                                   @ZA11014*/ 12620000
*       /*                                                           */ 12621000
*       /*************************************************************/ 12622000
*                                                                  1943 12623000
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014   12624000
*                                                            @ZA11014*/ 12625000
*                                                                  1943 12626000
         LH    @03,CCWCNT                                          1943 12627000
         SLA   @03,3                                               1943 12628000
         L     @01,IOCTLBKP                                        1943 12629000
         LA    @03,IOXCCW-8(@03,@01)                               1943 12630000
         LA    @15,SRCHCHR                                         1943 12631000
         STCM  @15,7,CCWADDR(@03)                                  1943 12632000
*       /*************************************************************/ 12633000
*       /*                                                           */ 12634000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12635000
*       /*                                                           */ 12636000
*       /*************************************************************/ 12637000
*                                                                  1944 12638000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12639000
*                                                            @ZA11014*/ 12640000
*                                                                  1944 12641000
         LH    @03,CCWCNT                                          1944 12642000
         LA    @03,1(,@03)                                         1944 12643000
         STH   @03,CCWCNT                                          1944 12644000
*       /*************************************************************/ 12645000
*       /*                                                           */ 12646000
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/ 12647000
*       /*                                                           */ 12648000
*       /*************************************************************/ 12649000
*                                                                  1945 12650000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 12651000
         LH    @03,CCWCNT                                          1945 12652000
         SLA   @03,3                                               1945 12653000
         L     @01,IOCTLBKP                                        1945 12654000
         LA    @03,IOXCCW-8(@03,@01)                               1945 12655000
         MVC   CCW(8,@03),CCWTIC                                   1945 12656000
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014   12657000
*                                                            @ZA11014*/ 12658000
*                                                                  1946 12659000
         LH    @03,CCWCNT                                          1946 12660000
         SLA   @03,3                                               1946 12661000
         L     @01,IOCTLBKP                                        1946 12662000
         LA    @03,IOXCCW-8(@03,@01)                               1946 12663000
         LH    @15,CCWCNT                                          1946 12664000
         SLA   @15,3                                               1946 12665000
         L     @01,IOCTLBKP                                        1946 12666000
         LA    @15,IOXCCW-16(@15,@01)                              1946 12667000
         STCM  @15,7,CCWADDR(@03)                                  1946 12668000
*       /*************************************************************/ 12669000
*       /*                                                           */ 12670000
*       /* CALC LAST WRITE CCW TO BUILD                      @ZA11014*/ 12671000
*       /*                                                           */ 12672000
*       /*************************************************************/ 12673000
*                                                                  1947 12674000
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014   12675000
*                                                            @ZA11014*/ 12676000
*                                                                  1947 12677000
         LH    @03,CCWCNT                                          1947 12678000
         L     @01,RWIOARPT                                        1947 12679000
         AL    @03,WNUMREC(,@01)                                   1947 12680000
         STH   @03,LASTCCW                                         1947 12681000
*       /*************************************************************/ 12682000
*       /*                                                           */ 12683000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12684000
*       /*                                                           */ 12685000
*       /*************************************************************/ 12686000
*                                                                  1948 12687000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12688000
*                                                            @ZA11014*/ 12689000
*                                                                  1948 12690000
         LH    @03,CCWCNT                                          1948 12691000
         LA    @03,1(,@03)                                         1948 12692000
         STH   @03,CCWCNT                                          1948 12693000
*       /*************************************************************/ 12694000
*       /*                                                           */ 12695000
*       /* END OF NON-R0 REQUEST                             @ZA11014*/ 12696000
*       /*                                                           */ 12697000
*       /*************************************************************/ 12698000
*                                                                  1949 12699000
*     END;                          /*                       @ZA11014   12700000
*                                                            @ZA11014*/ 12701000
*   ELSE                            /*                       @ZA11014*/ 12702000
*                                                                  1950 12703000
*     /***************************************************************/ 12704000
*     /*                                                             */ 12705000
*     /* REQUEST FOR R0                                      @ZA11014*/ 12706000
*     /*                                                             */ 12707000
*     /***************************************************************/ 12708000
*                                                                  1950 12709000
*     DO;                           /*                       @ZA11014*/ 12710000
*                                                                  1950 12711000
         B     @RC01936                                            1950 12712000
@RF01936 DS    0H                                                  1951 12713000
*       /*************************************************************/ 12714000
*       /*                                                           */ 12715000
*       /* SET SEARCH RECORD NUM TO R0                       @ZA11014*/ 12716000
*       /*                                                           */ 12717000
*       /*************************************************************/ 12718000
*                                                                  1951 12719000
*       SRCHR=EXRECNUM;             /*                       @ZA11014   12720000
*                                                            @ZA11014*/ 12721000
*                                                                  1951 12722000
         L     @03,@PC00001+8                                      1951 12723000
         IC    @15,EXRECNUM(,@03)                                  1951 12724000
         STC   @15,SRCHR                                           1951 12725000
*       /*************************************************************/ 12726000
*       /*                                                           */ 12727000
*       /* SET SEARCH ADDR                                   @ZA11014*/ 12728000
*       /*                                                           */ 12729000
*       /*************************************************************/ 12730000
*                                                                  1952 12731000
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014   12732000
*                                                            @ZA11014*/ 12733000
*                                                                  1952 12734000
         LH    @03,CCWCNT                                          1952 12735000
         SLA   @03,3                                               1952 12736000
         L     @01,IOCTLBKP                                        1952 12737000
         LA    @03,IOXCCW-8(@03,@01)                               1952 12738000
         LA    @15,SRCHCHR                                         1952 12739000
         STCM  @15,7,CCWADDR(@03)                                  1952 12740000
*       /*************************************************************/ 12741000
*       /*                                                           */ 12742000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12743000
*       /*                                                           */ 12744000
*       /*************************************************************/ 12745000
*                                                                  1953 12746000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12747000
*                                                            @ZA11014*/ 12748000
*                                                                  1953 12749000
         LH    @03,CCWCNT                                          1953 12750000
         LA    @03,1(,@03)                                         1953 12751000
         STH   @03,CCWCNT                                          1953 12752000
*       /*************************************************************/ 12753000
*       /*                                                           */ 12754000
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/ 12755000
*       /*                                                           */ 12756000
*       /*************************************************************/ 12757000
*                                                                  1954 12758000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 12759000
         LH    @03,CCWCNT                                          1954 12760000
         SLA   @03,3                                               1954 12761000
         L     @01,IOCTLBKP                                        1954 12762000
         LA    @03,IOXCCW-8(@03,@01)                               1954 12763000
         MVC   CCW(8,@03),CCWTIC                                   1954 12764000
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014   12765000
*                                                            @ZA11014*/ 12766000
*                                                                  1955 12767000
         LH    @03,CCWCNT                                          1955 12768000
         SLA   @03,3                                               1955 12769000
         L     @01,IOCTLBKP                                        1955 12770000
         LA    @03,IOXCCW-8(@03,@01)                               1955 12771000
         LH    @15,CCWCNT                                          1955 12772000
         SLA   @15,3                                               1955 12773000
         L     @01,IOCTLBKP                                        1955 12774000
         LA    @15,IOXCCW-16(@15,@01)                              1955 12775000
         STCM  @15,7,CCWADDR(@03)                                  1955 12776000
*       /*************************************************************/ 12777000
*       /*                                                           */ 12778000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12779000
*       /*                                                           */ 12780000
*       /*************************************************************/ 12781000
*                                                                  1956 12782000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12783000
*                                                            @ZA11014*/ 12784000
*                                                                  1956 12785000
         LH    @03,CCWCNT                                          1956 12786000
         LA    @03,1(,@03)                                         1956 12787000
         STH   @03,CCWCNT                                          1956 12788000
*       /*************************************************************/ 12789000
*       /*                                                           */ 12790000
*       /* SET FIRST WRITE CCW TO WRITE KEY/DATA ONLY        @ZA11014*/ 12791000
*       /* DONT WANT TO WRITE R0 COUNT FIELD                 @ZA11014*/ 12792000
*       /*                                                           */ 12793000
*       /*************************************************************/ 12794000
*                                                                  1957 12795000
*       CCW=CCWRWKD;                /*                       @ZA11014*/ 12796000
         LH    @03,CCWCNT                                          1957 12797000
         SLA   @03,3                                               1957 12798000
         L     @01,IOCTLBKP                                        1957 12799000
         LA    @03,IOXCCW-8(@03,@01)                               1957 12800000
         MVC   CCW(8,@03),CCWRWKD                                  1957 12801000
*       CCWADDR=WRADDR;             /*                       @ZA11014*/ 12802000
         LH    @03,CCWCNT                                          1958 12803000
         SLA   @03,3                                               1958 12804000
         L     @01,IOCTLBKP                                        1958 12805000
         LA    @03,IOXCCW-8(@03,@01)                               1958 12806000
         MVC   CCWADDR(3,@03),WRADDR+1                             1958 12807000
*       CCWDATLN=LENR0D;            /*                       @ZA11014*/ 12808000
         LH    @03,CCWCNT                                          1959 12809000
         SLA   @03,3                                               1959 12810000
         L     @01,IOCTLBKP                                        1959 12811000
         LA    @03,IOXCCW-8(@03,@01)                               1959 12812000
         LH    @15,LENR0D                                          1959 12813000
         STH   @15,CCWDATLN(,@03)                                  1959 12814000
*       WRADDR=WRADDR+LENR0;        /*                       @ZA11014   12815000
*                                                            @ZA11014*/ 12816000
*                                                                  1960 12817000
         LH    @03,LENR0                                           1960 12818000
         AL    @03,WRADDR                                          1960 12819000
         ST    @03,WRADDR                                          1960 12820000
*       /*************************************************************/ 12821000
*       /*                                                           */ 12822000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12823000
*       /*                                                           */ 12824000
*       /*************************************************************/ 12825000
*                                                                  1961 12826000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014*/ 12827000
*                                                                  1961 12828000
         LH    @03,CCWCNT                                          1961 12829000
         LA    @03,1(,@03)                                         1961 12830000
         STH   @03,CCWCNT                                          1961 12831000
*       /*************************************************************/ 12832000
*       /*                                                           */ 12833000
*       /* SET ANOTHER SET SECTION, SID AND TIC              @ZA11014*/ 12834000
*       /* BECAUSE A WRITE COUNT/KEY DATA CANNOT FOLLOW      @ZA11014*/ 12835000
*       /* A WRITE DATA IN THE CCW STRING                    @ZA11014*/ 12836000
*       /*                                                           */ 12837000
*       /*************************************************************/ 12838000
*                                                                  1962 12839000
*       CCW=CCWRSSEC;               /*                       @ZA11014*/ 12840000
         LH    @03,CCWCNT                                          1962 12841000
         SLA   @03,3                                               1962 12842000
         L     @01,IOCTLBKP                                        1962 12843000
         LA    @03,IOXCCW-8(@03,@01)                               1962 12844000
         MVC   CCW(8,@03),CCWRSSEC                                 1962 12845000
*       CCWADDR=ADDR(ZERO);         /*                       @ZA11014   12846000
*                                                            @ZA11014*/ 12847000
*                                                                  1963 12848000
         LH    @03,CCWCNT                                          1963 12849000
         SLA   @03,3                                               1963 12850000
         L     @01,IOCTLBKP                                        1963 12851000
         LA    @03,IOXCCW-8(@03,@01)                               1963 12852000
         LA    @15,ZERO                                            1963 12853000
         STCM  @15,7,CCWADDR(@03)                                  1963 12854000
*       /*************************************************************/ 12855000
*       /*                                                           */ 12856000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12857000
*       /*                                                           */ 12858000
*       /*************************************************************/ 12859000
*                                                                  1964 12860000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12861000
*                                                            @ZA11014*/ 12862000
*                                                                  1964 12863000
         LH    @03,CCWCNT                                          1964 12864000
         LA    @03,1(,@03)                                         1964 12865000
         STH   @03,CCWCNT                                          1964 12866000
*       /*************************************************************/ 12867000
*       /*                                                           */ 12868000
*       /* SET SEARCH ID EQUAL ON R0                         @ZA11014*/ 12869000
*       /*                                                           */ 12870000
*       /*************************************************************/ 12871000
*                                                                  1965 12872000
*       CCW=CCWSIDEQ;               /*                       @ZA11014*/ 12873000
         LH    @03,CCWCNT                                          1965 12874000
         SLA   @03,3                                               1965 12875000
         L     @01,IOCTLBKP                                        1965 12876000
         LA    @03,IOXCCW-8(@03,@01)                               1965 12877000
         MVC   CCW(8,@03),CCWSIDEQ                                 1965 12878000
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014   12879000
*                                                            @ZA11014*/ 12880000
*                                                                  1966 12881000
         LH    @03,CCWCNT                                          1966 12882000
         SLA   @03,3                                               1966 12883000
         L     @01,IOCTLBKP                                        1966 12884000
         LA    @03,IOXCCW-8(@03,@01)                               1966 12885000
         LA    @15,SRCHCHR                                         1966 12886000
         STCM  @15,7,CCWADDR(@03)                                  1966 12887000
*       /*************************************************************/ 12888000
*       /*                                                           */ 12889000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12890000
*       /*                                                           */ 12891000
*       /*************************************************************/ 12892000
*                                                                  1967 12893000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12894000
*                                                            @ZA11014*/ 12895000
*                                                                  1967 12896000
         LH    @03,CCWCNT                                          1967 12897000
         LA    @03,1(,@03)                                         1967 12898000
         STH   @03,CCWCNT                                          1967 12899000
*       /*************************************************************/ 12900000
*       /*                                                           */ 12901000
*       /* TIC BACK TO SID                                   @ZA11014*/ 12902000
*       /*                                                           */ 12903000
*       /*************************************************************/ 12904000
*                                                                  1968 12905000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 12906000
         LH    @03,CCWCNT                                          1968 12907000
         SLA   @03,3                                               1968 12908000
         L     @01,IOCTLBKP                                        1968 12909000
         LA    @03,IOXCCW-8(@03,@01)                               1968 12910000
         MVC   CCW(8,@03),CCWTIC                                   1968 12911000
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014   12912000
*                                                            @ZA11014*/ 12913000
*                                                                  1969 12914000
         LH    @03,CCWCNT                                          1969 12915000
         SLA   @03,3                                               1969 12916000
         L     @01,IOCTLBKP                                        1969 12917000
         LA    @03,IOXCCW-8(@03,@01)                               1969 12918000
         LH    @15,CCWCNT                                          1969 12919000
         SLA   @15,3                                               1969 12920000
         L     @01,IOCTLBKP                                        1969 12921000
         LA    @15,IOXCCW-16(@15,@01)                              1969 12922000
         STCM  @15,7,CCWADDR(@03)                                  1969 12923000
*       /*************************************************************/ 12924000
*       /*                                                           */ 12925000
*       /* CALC LAST WRITE CCW TO BUILD                      @ZA11014*/ 12926000
*       /*                                                           */ 12927000
*       /*************************************************************/ 12928000
*                                                                  1970 12929000
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014   12930000
*                                                            @ZA11014*/ 12931000
*                                                                  1970 12932000
         LH    @03,CCWCNT                                          1970 12933000
         L     @01,RWIOARPT                                        1970 12934000
         AL    @03,WNUMREC(,@01)                                   1970 12935000
         STH   @03,LASTCCW                                         1970 12936000
*       /*************************************************************/ 12937000
*       /*                                                           */ 12938000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 12939000
*       /*                                                           */ 12940000
*       /*************************************************************/ 12941000
*                                                                  1971 12942000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   12943000
*                                                            @ZA11014*/ 12944000
*                                                                  1971 12945000
         LH    @03,CCWCNT                                          1971 12946000
         LA    @03,1(,@03)                                         1971 12947000
         STH   @03,CCWCNT                                          1971 12948000
*       /*************************************************************/ 12949000
*       /*                                                           */ 12950000
*       /* END R0-REQUEST                                    @ZA11014*/ 12951000
*       /*                                                           */ 12952000
*       /*************************************************************/ 12953000
*                                                                  1972 12954000
*     END;                          /*                       @ZA11014   12955000
*                                                            @ZA11014   12956000
*                                                            @ZA11014*/ 12957000
*                                                                  1972 12958000
*   /*****************************************************************/ 12959000
*   /*                                                               */ 12960000
*   /* SET UP TO WRITE COUNT/KEY/DATA FOR ALL BUT LAST RE@ZA11014    */ 12961000
*   /*                                                               */ 12962000
*   /*****************************************************************/ 12963000
*                                                                  1973 12964000
*   DO CCWCNT=CCWCNT TO(LASTCCW-1); /*                       @ZA11014*/ 12965000
@RC01936 LH    @03,CCWCNT                                          1973 12966000
         B     @DE01973                                            1973 12967000
@DL01973 DS    0H                                                  1974 12968000
*     CCW=CCWRWCKD;                 /*                       @ZA11014*/ 12969000
         LH    @03,CCWCNT                                          1974 12970000
         SLA   @03,3                                               1974 12971000
         L     @01,IOCTLBKP                                        1974 12972000
         LA    @03,IOXCCW-8(@03,@01)                               1974 12973000
         MVC   CCW(8,@03),CCWRWCKD                                 1974 12974000
*     CCWADDR=WRADDR;               /*                       @ZA11014*/ 12975000
         LH    @03,CCWCNT                                          1975 12976000
         SLA   @03,3                                               1975 12977000
         L     @01,IOCTLBKP                                        1975 12978000
         LA    @03,IOXCCW-8(@03,@01)                               1975 12979000
         MVC   CCWADDR(3,@03),WRADDR+1                             1975 12980000
*     CCWDATLN=WBKL+WBDL+LENCNT;    /*                       @ZA11014   12981000
*                                                            @ZA11014*/ 12982000
*                                                                  1976 12983000
         LH    @03,CCWCNT                                          1976 12984000
         SLA   @03,3                                               1976 12985000
         L     @01,IOCTLBKP                                        1976 12986000
         LA    @03,IOXCCW-8(@03,@01)                               1976 12987000
         L     @01,WRADDR                                          1976 12988000
         SLR   @00,@00                                             1976 12989000
         IC    @00,WBKL(,@01)                                      1976 12990000
         L     @01,WRADDR                                          1976 12991000
         AH    @00,WBDL(,@01)                                      1976 12992000
         AH    @00,LENCNT                                          1976 12993000
         STH   @00,CCWDATLN(,@03)                                  1976 12994000
*     /***************************************************************/ 12995000
*     /*                                                             */ 12996000
*     /* INCREMENT TO NEXT LOC IN BUFFER                     @ZA11014*/ 12997000
*     /*                                                             */ 12998000
*     /***************************************************************/ 12999000
*                                                                  1977 13000000
*     WRADDR=WRADDR+CCWDATLN;       /*                       @ZA11014*/ 13001000
         LH    @03,CCWCNT                                          1977 13002000
         SLA   @03,3                                               1977 13003000
         L     @01,IOCTLBKP                                        1977 13004000
         LA    @03,IOXCCW-8(@03,@01)                               1977 13005000
         LH    @03,CCWDATLN(,@03)                                  1977 13006000
         AL    @03,WRADDR                                          1977 13007000
         ST    @03,WRADDR                                          1977 13008000
*   END;                            /*                       @ZA11014   13009000
*                                                            @ZA11014*/ 13010000
*                                                                  1978 13011000
         LA    @03,1                                               1978 13012000
         AH    @03,CCWCNT                                          1978 13013000
         STH   @03,CCWCNT                                          1978 13014000
@DE01973 LH    @15,LASTCCW                                         1978 13015000
         BCTR  @15,0                                               1978 13016000
         CR    @03,@15                                             1978 13017000
         BNH   @DL01973                                            1978 13018000
*   /*****************************************************************/ 13019000
*   /*                                                               */ 13020000
*   /* CCWCNT IS NOW POINTING TO LAST CCW TO BUILD           @ZA11014*/ 13021000
*   /* CHECK TO SEE IF IT SHOULD BE A WR C/K/D OR WR SPEC@ZA11014    */ 13022000
*   /*                                                               */ 13023000
*   /*****************************************************************/ 13024000
*                                                                  1979 13025000
*   IF EXRWFUN=RVWS                 /*                       @ZA11014*/ 13026000
*     THEN                          /*                       @ZA11014*/ 13027000
*                                                                  1979 13028000
         L     @03,@PC00001+8                                      1979 13029000
         CLC   EXRWFUN(1,@03),RVWS                                 1979 13030000
         BNE   @RF01979                                            1979 13031000
*     /***************************************************************/ 13032000
*     /*                                                             */ 13033000
*     /* WRITE SPECIAL ON LAST WRITE                         @ZA11014*/ 13034000
*     /*                                                             */ 13035000
*     /***************************************************************/ 13036000
*                                                                  1980 13037000
*     CCW=CCWRWSP;                  /*                       @ZA11014   13038000
*                                                            @ZA11014*/ 13039000
         LH    @03,CCWCNT                                          1980 13040000
         SLA   @03,3                                               1980 13041000
         L     @01,IOCTLBKP                                        1980 13042000
         LA    @03,IOXCCW-8(@03,@01)                               1980 13043000
         MVC   CCW(8,@03),CCWRWSP                                  1980 13044000
*   ELSE                            /*                       @ZA11014*/ 13045000
*                                                                  1981 13046000
*     /***************************************************************/ 13047000
*     /*                                                             */ 13048000
*     /* WRITE COUNT/KEY/DATA ON LAST WRITE                  @ZA11014*/ 13049000
*     /*                                                             */ 13050000
*     /***************************************************************/ 13051000
*                                                                  1981 13052000
*     CCW=CCWRWCKD;                 /*                       @ZA11014   13053000
*                                                            @ZA11014*/ 13054000
*                                                                  1981 13055000
         B     @RC01979                                            1981 13056000
@RF01979 LH    @03,CCWCNT                                          1981 13057000
         SLA   @03,3                                               1981 13058000
         L     @01,IOCTLBKP                                        1981 13059000
         LA    @03,IOXCCW-8(@03,@01)                               1981 13060000
         MVC   CCW(8,@03),CCWRWCKD                                 1981 13061000
*   /*****************************************************************/ 13062000
*   /*                                                               */ 13063000
*   /* SET REST OF INFO IN CCW                               @ZA11014*/ 13064000
*   /*                                                               */ 13065000
*   /*****************************************************************/ 13066000
*                                                                  1982 13067000
*   CCWADDR=WRADDR;                 /*                       @ZA11014*/ 13068000
@RC01979 LH    @03,CCWCNT                                          1982 13069000
         SLA   @03,3                                               1982 13070000
         L     @01,IOCTLBKP                                        1982 13071000
         LA    @03,IOXCCW-8(@03,@01)                               1982 13072000
         MVC   CCWADDR(3,@03),WRADDR+1                             1982 13073000
*   CCWDATLN=WBKL+WBDL+LENCNT;      /*                       @ZA11014   13074000
*                                                            @ZA11014*/ 13075000
*                                                                  1983 13076000
         LH    @03,CCWCNT                                          1983 13077000
         SLA   @03,3                                               1983 13078000
         L     @01,IOCTLBKP                                        1983 13079000
         LA    @03,IOXCCW-8(@03,@01)                               1983 13080000
         L     @01,WRADDR                                          1983 13081000
         SLR   @00,@00                                             1983 13082000
         IC    @00,WBKL(,@01)                                      1983 13083000
         L     @01,WRADDR                                          1983 13084000
         AH    @00,WBDL(,@01)                                      1983 13085000
         AH    @00,LENCNT                                          1983 13086000
         STH   @00,CCWDATLN(,@03)                                  1983 13087000
*   /*****************************************************************/ 13088000
*   /*                                                               */ 13089000
*   /* INCREMENT CCW CHAIN INDEX                             @ZA11014*/ 13090000
*   /*                                                               */ 13091000
*   /*****************************************************************/ 13092000
*                                                                  1984 13093000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   13094000
*                                                            @ZA11014*/ 13095000
*                                                                  1984 13096000
         LH    @03,CCWCNT                                          1984 13097000
         LA    @03,1(,@03)                                         1984 13098000
         STH   @03,CCWCNT                                          1984 13099000
*   /*****************************************************************/ 13100000
*   /*                                                               */ 13101000
*   /* BUILD CCW LIST TO READ BACK WHAT WAS WRITTEN          @ZA11014*/ 13102000
*   /*                                                               */ 13103000
*   /*****************************************************************/ 13104000
*                                                                  1985 13105000
*                                   /*                       @ZA11014*/ 13106000
*                                                                  1985 13107000
*   /*****************************************************************/ 13108000
*   /*                                                               */ 13109000
*   /* RESET DATA POINTER TO BEGINNING OF BUFFER             @ZA11014*/ 13110000
*   /*                                                               */ 13111000
*   /*****************************************************************/ 13112000
*                                                                  1985 13113000
*   WRADDR=ADDR(WBUFF);             /*                       @ZA11014   13114000
*                                                            @ZA11014*/ 13115000
         L     @03,RWIOARPT                                        1985 13116000
         LA    @03,WBUFF(,@03)                                     1985 13117000
         ST    @03,WRADDR                                          1985 13118000
*   CCW=CCWRSSEC;                   /*                       @ZA11014*/ 13119000
         LH    @03,CCWCNT                                          1986 13120000
         SLA   @03,3                                               1986 13121000
         L     @01,IOCTLBKP                                        1986 13122000
         LA    @03,IOXCCW-8(@03,@01)                               1986 13123000
         MVC   CCW(8,@03),CCWRSSEC                                 1986 13124000
*   CCWADDR=ADDR(ZEROS);            /*                       @ZA11014   13125000
*                                                            @ZA11014*/ 13126000
*                                                                  1987 13127000
         LH    @03,CCWCNT                                          1987 13128000
         SLA   @03,3                                               1987 13129000
         L     @01,IOCTLBKP                                        1987 13130000
         LA    @03,IOXCCW-8(@03,@01)                               1987 13131000
         LA    @15,ZEROS                                           1987 13132000
         STCM  @15,7,CCWADDR(@03)                                  1987 13133000
*   /*****************************************************************/ 13134000
*   /*                                                               */ 13135000
*   /* INCREMENT CCW CHAIN INDEX                             @ZA11014*/ 13136000
*   /*                                                               */ 13137000
*   /*****************************************************************/ 13138000
*                                                                  1988 13139000
*   CCWCNT=CCWCNT+1;                /*                       @ZA11014   13140000
*                                                            @ZA11014*/ 13141000
*                                                                  1988 13142000
         LH    @03,CCWCNT                                          1988 13143000
         LA    @03,1(,@03)                                         1988 13144000
         STH   @03,CCWCNT                                          1988 13145000
*   /*****************************************************************/ 13146000
*   /*                                                               */ 13147000
*   /* CHECK IF PROCESSING RECORD ZERO                       @ZA11014*/ 13148000
*   /*                                                               */ 13149000
*   /*****************************************************************/ 13150000
*                                                                  1989 13151000
*   IF EXRECNUM^=ZERO               /*                       @ZA11014*/ 13152000
*     THEN                          /*                       @ZA11014*/ 13153000
*                                                                  1989 13154000
         L     @03,@PC00001+8                                      1989 13155000
         SLR   @15,@15                                             1989 13156000
         IC    @15,EXRECNUM(,@03)                                  1989 13157000
         CH    @15,ZERO                                            1989 13158000
         BE    @RF01989                                            1989 13159000
*     /***************************************************************/ 13160000
*     /*                                                             */ 13161000
*     /* NOT R0-SEARCH ID AS IN WRITE                        @ZA11014*/ 13162000
*     /*                                                             */ 13163000
*     /***************************************************************/ 13164000
*                                                                  1990 13165000
*     DO;                           /*                       @ZA11014*/ 13166000
*       CCW=CCWSIDEQ;               /*                       @ZA11014*/ 13167000
         LH    @03,CCWCNT                                          1991 13168000
         SLA   @03,3                                               1991 13169000
         L     @01,IOCTLBKP                                        1991 13170000
         LA    @03,IOXCCW-8(@03,@01)                               1991 13171000
         MVC   CCW(8,@03),CCWSIDEQ                                 1991 13172000
*       CCWADDR=ADDR(SRCHCHR);      /*                       @ZA11014   13173000
*                                                            @ZA11014*/ 13174000
*                                                                  1992 13175000
         LH    @03,CCWCNT                                          1992 13176000
         SLA   @03,3                                               1992 13177000
         L     @01,IOCTLBKP                                        1992 13178000
         LA    @03,IOXCCW-8(@03,@01)                               1992 13179000
         LA    @15,SRCHCHR                                         1992 13180000
         STCM  @15,7,CCWADDR(@03)                                  1992 13181000
*       /*************************************************************/ 13182000
*       /*                                                           */ 13183000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 13184000
*       /*                                                           */ 13185000
*       /*************************************************************/ 13186000
*                                                                  1993 13187000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   13188000
*                                                            @ZA11014*/ 13189000
*                                                                  1993 13190000
         LH    @03,CCWCNT                                          1993 13191000
         LA    @03,1(,@03)                                         1993 13192000
         STH   @03,CCWCNT                                          1993 13193000
*       /*************************************************************/ 13194000
*       /*                                                           */ 13195000
*       /* SET NEXT CCW TO TIC TO SEARCH                     @ZA11014*/ 13196000
*       /*                                                           */ 13197000
*       /*************************************************************/ 13198000
*                                                                  1994 13199000
*       CCW=CCWTIC;                 /*                       @ZA11014*/ 13200000
         LH    @03,CCWCNT                                          1994 13201000
         SLA   @03,3                                               1994 13202000
         L     @01,IOCTLBKP                                        1994 13203000
         LA    @03,IOXCCW-8(@03,@01)                               1994 13204000
         MVC   CCW(8,@03),CCWTIC                                   1994 13205000
*       CCWADDR=ADDR(IOXCCW(CCWCNT-1));/*                    @ZA11014   13206000
*                                                            @ZA11014*/ 13207000
*                                                                  1995 13208000
         LH    @03,CCWCNT                                          1995 13209000
         SLA   @03,3                                               1995 13210000
         L     @01,IOCTLBKP                                        1995 13211000
         LA    @03,IOXCCW-8(@03,@01)                               1995 13212000
         LH    @15,CCWCNT                                          1995 13213000
         SLA   @15,3                                               1995 13214000
         L     @01,IOCTLBKP                                        1995 13215000
         LA    @15,IOXCCW-16(@15,@01)                              1995 13216000
         STCM  @15,7,CCWADDR(@03)                                  1995 13217000
*       /*************************************************************/ 13218000
*       /*                                                           */ 13219000
*       /* CALC LAST CCW TO BUILD                            @ZA11014*/ 13220000
*       /*                                                           */ 13221000
*       /*************************************************************/ 13222000
*                                                                  1996 13223000
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014   13224000
*                                                            @ZA11014*/ 13225000
*                                                                  1996 13226000
         LH    @03,CCWCNT                                          1996 13227000
         L     @01,RWIOARPT                                        1996 13228000
         AL    @03,WNUMREC(,@01)                                   1996 13229000
         STH   @03,LASTCCW                                         1996 13230000
*       /*************************************************************/ 13231000
*       /*                                                           */ 13232000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 13233000
*       /*                                                           */ 13234000
*       /*************************************************************/ 13235000
*                                                                  1997 13236000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   13237000
*                                                            @ZA11014*/ 13238000
*                                                                  1997 13239000
         LH    @03,CCWCNT                                          1997 13240000
         LA    @03,1(,@03)                                         1997 13241000
         STH   @03,CCWCNT                                          1997 13242000
*       /*************************************************************/ 13243000
*       /*                                                           */ 13244000
*       /* END NOT-R0                                        @ZA11014*/ 13245000
*       /*                                                           */ 13246000
*       /*************************************************************/ 13247000
*                                                                  1998 13248000
*     END;                          /*                       @ZA11014   13249000
*                                                            @ZA11014*/ 13250000
*   ELSE                            /*                       @ZA11014*/ 13251000
*                                                                  1999 13252000
*     /***************************************************************/ 13253000
*     /*                                                             */ 13254000
*     /* R0 REQUEST-READ R0 INSTEAD OF SEARCHING             @ZA11014*/ 13255000
*     /*                                                             */ 13256000
*     /***************************************************************/ 13257000
*                                                                  1999 13258000
*     DO;                           /*                       @ZA11014   13259000
*                                                            @ZA11014*/ 13260000
*                                                                  1999 13261000
         B     @RC01989                                            1999 13262000
@RF01989 DS    0H                                                  2000 13263000
*       /*************************************************************/ 13264000
*       /*                                                           */ 13265000
*       /* CALC LAST CCW TO BUILD                            @ZA11014*/ 13266000
*       /*                                                           */ 13267000
*       /*************************************************************/ 13268000
*                                                                  2000 13269000
*       LASTCCW=CCWCNT+WNUMREC;     /*                       @ZA11014   13270000
*                                                            @ZA11014*/ 13271000
*                                                                  2000 13272000
         LH    @03,CCWCNT                                          2000 13273000
         L     @01,RWIOARPT                                        2000 13274000
         AL    @03,WNUMREC(,@01)                                   2000 13275000
         STH   @03,LASTCCW                                         2000 13276000
*       /*************************************************************/ 13277000
*       /*                                                           */ 13278000
*       /* SET CCW TO READ R0                                @ZA11014*/ 13279000
*       /*                                                           */ 13280000
*       /*************************************************************/ 13281000
*                                                                  2001 13282000
*       CCW=CCWRRR0;                /*                       @ZA11014*/ 13283000
         LH    @03,CCWCNT                                          2001 13284000
         SLA   @03,3                                               2001 13285000
         L     @01,IOCTLBKP                                        2001 13286000
         LA    @03,IOXCCW-8(@03,@01)                               2001 13287000
         MVC   CCW(8,@03),CCWRRR0                                  2001 13288000
*       CCWADDR=WRADDR;             /*                       @ZA11014   13289000
*                                                            @ZA11014*/ 13290000
*                                                                  2002 13291000
         LH    @03,CCWCNT                                          2002 13292000
         SLA   @03,3                                               2002 13293000
         L     @01,IOCTLBKP                                        2002 13294000
         LA    @03,IOXCCW-8(@03,@01)                               2002 13295000
         MVC   CCWADDR(3,@03),WRADDR+1                             2002 13296000
*       /*************************************************************/ 13297000
*       /*                                                           */ 13298000
*       /* INCREMENT BUFFER POINTER                          @ZA11014*/ 13299000
*       /*                                                           */ 13300000
*       /*************************************************************/ 13301000
*                                                                  2003 13302000
*       WRADDR=WRADDR+LENR0;        /*                       @ZA11014   13303000
*                                                            @ZA11014*/ 13304000
*                                                                  2003 13305000
         LH    @03,LENR0                                           2003 13306000
         AL    @03,WRADDR                                          2003 13307000
         ST    @03,WRADDR                                          2003 13308000
*       /*************************************************************/ 13309000
*       /*                                                           */ 13310000
*       /* INCREMENT CCW CHAIN INDEX                         @ZA11014*/ 13311000
*       /*                                                           */ 13312000
*       /*************************************************************/ 13313000
*                                                                  2004 13314000
*       CCWCNT=CCWCNT+1;            /*                       @ZA11014   13315000
*                                                            @ZA11014*/ 13316000
*                                                                  2004 13317000
         LH    @03,CCWCNT                                          2004 13318000
         LA    @03,1(,@03)                                         2004 13319000
         STH   @03,CCWCNT                                          2004 13320000
*       /*************************************************************/ 13321000
*       /*                                                           */ 13322000
*       /* END R0 REQUEST                                    @ZA11014*/ 13323000
*       /*                                                           */ 13324000
*       /*************************************************************/ 13325000
*                                                                  2005 13326000
*     END;                          /*                       @ZA11014   13327000
*                                                            @ZA11014*/ 13328000
*                                                                  2005 13329000
*   /*****************************************************************/ 13330000
*   /*                                                               */ 13331000
*   /* BUILD READ BACK CCWS                                  @ZA11014*/ 13332000
*   /*                                                               */ 13333000
*   /*****************************************************************/ 13334000
*                                                                  2006 13335000
*   DO CCWCNT=CCWCNT TO LASTCCW;    /*                       @ZA11014*/ 13336000
@RC01989 LH    @03,CCWCNT                                          2006 13337000
         B     @DE02006                                            2006 13338000
@DL02006 DS    0H                                                  2007 13339000
*     CCW=CCWRRCKD;                 /*                       @ZA11014*/ 13340000
         LH    @03,CCWCNT                                          2007 13341000
         SLA   @03,3                                               2007 13342000
         L     @01,IOCTLBKP                                        2007 13343000
         LA    @03,IOXCCW-8(@03,@01)                               2007 13344000
         MVC   CCW(8,@03),CCWRRCKD                                 2007 13345000
*     CCWADDR=WRADDR;               /*                       @ZA11014*/ 13346000
         LH    @03,CCWCNT                                          2008 13347000
         SLA   @03,3                                               2008 13348000
         L     @01,IOCTLBKP                                        2008 13349000
         LA    @03,IOXCCW-8(@03,@01)                               2008 13350000
         MVC   CCWADDR(3,@03),WRADDR+1                             2008 13351000
*     CCWDATLN=WBKL+WBDL+LENCNT;    /*                       @ZA11014*/ 13352000
         LH    @03,CCWCNT                                          2009 13353000
         SLA   @03,3                                               2009 13354000
         L     @01,IOCTLBKP                                        2009 13355000
         LA    @03,IOXCCW-8(@03,@01)                               2009 13356000
         L     @01,WRADDR                                          2009 13357000
         SLR   @00,@00                                             2009 13358000
         IC    @00,WBKL(,@01)                                      2009 13359000
         L     @01,WRADDR                                          2009 13360000
         AH    @00,WBDL(,@01)                                      2009 13361000
         AH    @00,LENCNT                                          2009 13362000
         STH   @00,CCWDATLN(,@03)                                  2009 13363000
*     CCWCMDCH=ON;                  /*                       @ZA11014*/ 13364000
*     CCWSUPP=OFF;                  /*                       @ZA11014   13365000
*                                                            @ZA11014*/ 13366000
*                                                                  2011 13367000
         LH    @03,CCWCNT                                          2011 13368000
         SLA   @03,3                                               2011 13369000
         L     @01,IOCTLBKP                                        2011 13370000
         LA    @03,IOXCCW-8(@03,@01)                               2011 13371000
         OI    CCWCMDCH(@03),B'01000000'                           2011 13372000
         NI    CCWSUPP(@03),B'11101111'                            2011 13373000
*     /***************************************************************/ 13374000
*     /*                                                             */ 13375000
*     /* INCREMENT TO NEXT LOC IN BUFFER                     @ZA11014*/ 13376000
*     /*                                                             */ 13377000
*     /***************************************************************/ 13378000
*                                                                  2012 13379000
*     WRADDR=WRADDR+CCWDATLN;       /*                       @ZA11014*/ 13380000
         LH    @03,CCWCNT                                          2012 13381000
         SLA   @03,3                                               2012 13382000
         L     @01,IOCTLBKP                                        2012 13383000
         LA    @03,IOXCCW-8(@03,@01)                               2012 13384000
         LH    @03,CCWDATLN(,@03)                                  2012 13385000
         AL    @03,WRADDR                                          2012 13386000
         ST    @03,WRADDR                                          2012 13387000
*   END;                            /*                       @ZA11014   13388000
*                                                            @ZA11014*/ 13389000
*                                                                  2013 13390000
         LA    @03,1                                               2013 13391000
         AH    @03,CCWCNT                                          2013 13392000
         STH   @03,CCWCNT                                          2013 13393000
@DE02006 CH    @03,LASTCCW                                         2013 13394000
         BNH   @DL02006                                            2013 13395000
*   /*****************************************************************/ 13396000
*   /*                                                               */ 13397000
*   /* FINISHED BUILDING-TURN CHAINING OFF IN LAST CCW       @ZA11014*/ 13398000
*   /*                                                               */ 13399000
*   /*****************************************************************/ 13400000
*                                                                  2014 13401000
*   CCWCNT=CCWCNT-1;                /*                       @ZA11014*/ 13402000
         LH    @03,CCWCNT                                          2014 13403000
         BCTR  @03,0                                               2014 13404000
         STH   @03,CCWCNT                                          2014 13405000
*   CCWCMDCH=OFF;                   /*                       @ZA11014   13406000
*                                                            @ZA11014*/ 13407000
*                                                                  2015 13408000
         LH    @03,CCWCNT                                          2015 13409000
         SLA   @03,3                                               2015 13410000
         L     @01,IOCTLBKP                                        2015 13411000
         LA    @03,IOXCCW-8(@03,@01)                               2015 13412000
         NI    CCWCMDCH(@03),B'10111111'                           2015 13413000
*   /*****************************************************************/ 13414000
*   /*                                                               */ 13415000
*   /* SET TRACE ID BEFORE CALLING UEXCP                     @ZA11014*/ 13416000
*   /*                                                               */ 13417000
*   /*****************************************************************/ 13418000
*                                                                  2016 13419000
*   OLDERID2=NEWERID2;                                             2016 13420000
         L     @03,@PC00001                                        2016 13421000
         L     @03,GDTTR2(,@03)                                    2016 13422000
         L     @15,@PC00001                                        2016 13423000
         L     @01,GDTTR2(,@15)                                    2016 13424000
         MVC   @TS00001(95),NEWERID2(@01)                          2016 13425000
         MVC   OLDERID2(95,@03),@TS00001                           2016 13426000
*   NEWID2='IOFB';                  /*                       @ZA11014   13427000
*                                                            @ZA11014*/ 13428000
*                                                                  2017 13429000
         L     @03,@PC00001                                        2017 13430000
         L     @03,GDTTR2(,@03)                                    2017 13431000
         MVC   NEWID2(4,@03),@CC04393                              2017 13432000
*   /*****************************************************************/ 13433000
*   /*                                                               */ 13434000
*   /* CALL ISSUEXCP TO DO I/O                               @ZA11014*/ 13435000
*   /*                                                               */ 13436000
*   /*****************************************************************/ 13437000
*                                                                  2018 13438000
*   CALL ISSUEXCP;                  /*                       @ZA11014*/ 13439000
         BAL   @14,ISSUEXCP                                        2018 13440000
*   RESPECIFY                                                      2019 13441000
*     RTNREG RSTD;                                                 2019 13442000
*   TESTRC=RTNREG;                                                 2020 13443000
         STH   RTNREG,TESTRC                                       2020 13444000
*   RESPECIFY                                                      2021 13445000
*     RTNREG UNRSTD;                /*                       @ZA11014*/ 13446000
*                                                                  2021 13447000
*   /*****************************************************************/ 13448000
*   /*                                                               */ 13449000
*   /* IF EXCP FAILED AND AN EQUIPMENT CHECK OCCURRED, IT IS         */ 13450000
*   /* NECESSARY TO ZERO THE DCBIFLGS IN ORDER TO ALLOW ADDITIONAL   */ 13451000
*   /* I/O. SO WE CLEAR THEM HERE.                           @ZA17169*/ 13452000
*   /*                                                               */ 13453000
*   /*****************************************************************/ 13454000
*                                                                  2022 13455000
*   IF TESTRC^=0 THEN               /*                       @ZA17169*/ 13456000
         LH    @03,TESTRC                                          2022 13457000
         LTR   @03,@03                                             2022 13458000
         BZ    @RF02022                                            2022 13459000
*     DCBIFEC='00'B;                /*                       @ZA17169   13460000
*                                                            @ZA11014*/ 13461000
*                                                                  2023 13462000
         L     @03,DCBPTR                                          2023 13463000
         NI    DCBIFEC+40(@03),B'00111111'                         2023 13464000
*   /*****************************************************************/ 13465000
*   /*                                                               */ 13466000
*   /* IF GOOD DATA OVERFLOW CONDITION ON READ BACK          @ZA11014*/ 13467000
*   /* VERIFY FOR A WRITE SPECIAL-THAN ALL OK                @ZA11014*/ 13468000
*   /*                                                               */ 13469000
*   /*****************************************************************/ 13470000
*                                                                  2024 13471000
*   IF EXRWFUN=RVWS&TESTRC=RCABOV   /*                       @ZA11014*/ 13472000
*     THEN                          /*                       @ZA11014*/ 13473000
*                                                                  2024 13474000
@RF02022 L     @03,@PC00001+8                                      2024 13475000
         CLC   EXRWFUN(1,@03),RVWS                                 2024 13476000
         BNE   @RF02024                                            2024 13477000
         CLC   TESTRC(2),RCABOV                                    2024 13478000
         BNE   @RF02024                                            2024 13479000
*     /***************************************************************/ 13480000
*     /*                                                             */ 13481000
*     /* SET RETURN CODE TO OK                               @ZA11014*/ 13482000
*     /*                                                             */ 13483000
*     /***************************************************************/ 13484000
*                                                                  2025 13485000
*     TESTRC=0;                     /*                       @ZA11014   13486000
*                                                            @ZA11014*/ 13487000
         SLR   @03,@03                                             2025 13488000
         STH   @03,TESTRC                                          2025 13489000
*   ELSE                                                           2026 13490000
*     ;                             /*                       @ZA11014   13491000
*                                                            @ZA11014*/ 13492000
@RF02024 DS    0H                                                  2027 13493000
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/ 13494000
         LH    @15,TESTRC                                          2027 13495000
         L     @14,@SA00030                                        2027 13496000
         LM    @00,@12,@SA00030+8                                  2027 13497000
         BR    @14                                                 2027 13498000
*   END FWRITE;                     /*                       @ZA11014*/ 13499000
*                                   /*                       @ZA11014*/ 13500000
*/***********************************************************@ZA11014*/ 13501000
*/*                                                          @ZA11014*/ 13502000
*/*  PROCEDURE NAME - OPNVTH                                 @ZA11014*/ 13503000
*/*                                                          @ZA11014*/ 13504000
*/*  FUNCTION - OPNVTH WILL DO A PSEUDO OPEN (SVC 82)        @ZA11014*/ 13505000
*/*              TO ENABLE REPAIRV PROCESSING ON A BAD       @ZA11014*/ 13506000
*/*              FORMAT 4 DSCB                               @ZA11014*/ 13507000
*/*          IT WILL LOAD THE ABNORMAL END APPENDAGE         @ZA11014*/ 13508000
*/*           FOR REPAIRV (IGG019A3) AND PLACE ITS           @ZA11014*/ 13509000
*/*           ADDRESS IN THE DEB                             @ZA11014*/ 13510000
*/*          THE FILE MASK WILL BE SET TO INHIBIT HEAD       @ZA11014*/ 13511000
*/*           SWITCHING                                      @ZA11014*/ 13512000
*/*          THE DEB EXTENT WILL BE MODIFIED TO RESTRICT     @ZA11014*/ 13513000
*/*           ACCESS ONLY TO THE TRACK THAT CONTAINS         @ZA11014*/ 13514000
*/*           THE FORMAT 4 DSCB                              @ZA11014*/ 13515000
*/*                                                          @ZA11014*/ 13516000
*/*  INPUT - EXOREP FROM EXOARG                              @ZA11014*/ 13517000
*/*          EXOVTH FROM EXOARG                              @ZA11014*/ 13518000
*/*          EXOREAD FROM EXOARG                             @ZA11014*/ 13519000
*/*          EXOUCB FROM EXOARG                              @ZA11014*/ 13520000
*/*          EXOEXT FROM EXOARG                              @ZA11014*/ 13521000
*/*                                                          @ZA11014*/ 13522000
*/*  OUTPUT - EXOCTLBK IN EXOARG                             @ZA11014*/ 13523000
*/*           EXOEXT   IN EXOARG                             @ZA11014*/ 13524000
*/*           JFCBDSNM IN IOXJFCB                            @ZA11014*/ 13525000
*/*           JFCNWRIT IN IOXJFCB                            @ZA11014*/ 13526000
*/*           DCBOFLWR IN IOXDCB                             @ZA11014*/ 13527000
*/*           RETURN CODE IN REGISTER 15                     @ZA11014*/ 13528000
*/*                                                          @ZA11014*/ 13529000
*/*                                                          @ZA11014*/ 13530000
*/***********************************************************@ZA11014*/ 13531000
*                                                                  2029 13532000
*OPNVTH:                                                           2029 13533000
*   PROC;                           /*                       @ZA11014   13534000
*                                                            @ZA11014*/ 13535000
*                                                                  2029 13536000
OPNVTH   STM   @14,@12,@SA00031                                    2029 13537000
*   /*****************************************************************/ 13538000
*   /*                                                               */ 13539000
*   /* SET TRACE ID                                          @ZA11014*/ 13540000
*   /*                                                               */ 13541000
*   /*****************************************************************/ 13542000
*                                                                  2030 13543000
*   OLDERID2=NEWERID2;                                             2030 13544000
         L     @03,@PC00001                                        2030 13545000
         L     @03,GDTTR2(,@03)                                    2030 13546000
         L     @15,@PC00001                                        2030 13547000
         L     @01,GDTTR2(,@15)                                    2030 13548000
         MVC   @TS00001(95),NEWERID2(@01)                          2030 13549000
         MVC   OLDERID2(95,@03),@TS00001                           2030 13550000
*   NEWID2='IOVH';                  /*                       @ZA11014   13551000
*                                                            @ZA11014*/ 13552000
*                                                                  2031 13553000
         L     @03,@PC00001                                        2031 13554000
         L     @03,GDTTR2(,@03)                                    2031 13555000
         MVC   NEWID2(4,@03),@CC04397                              2031 13556000
*   /*****************************************************************/ 13557000
*   /*                                                               */ 13558000
*   /* INITIALIZE SVC82 PARAMETER LIST                       @ZA11014*/ 13559000
*   /*                                                               */ 13560000
*   /*****************************************************************/ 13561000
*                                                                  2032 13562000
*   SV82LIST=''B;                   /*                       @ZA11014*/ 13563000
         LA    @03,SVC82ARG                                        2032 13564000
         XC    SV82LIST(16,@03),SV82LIST(@03)                      2032 13565000
*   SV82CODE=SVC82OPN;              /*                       @ZA11014*/ 13566000
         LA    @03,SVC82ARG                                        2033 13567000
         MVC   SV82CODE(1,@03),SVC82OPN                            2033 13568000
*   SV82UCBP=EXOUCB;                /*                       @ZA11014*/ 13569000
         LA    @03,SVC82ARG                                        2034 13570000
         L     @15,@PC00001+8                                      2034 13571000
         MVC   SV82UCBP(3,@03),EXOUCB+1(@15)                       2034 13572000
*   SV82DCBP=ADDR(IOXDCB);          /*                       @ZA11014*/ 13573000
*                                                                  2035 13574000
         LA    @03,SVC82ARG                                        2035 13575000
         L     @01,IOCTLBKP                                        2035 13576000
         LA    @15,IOXDCB(,@01)                                    2035 13577000
         ST    @15,SV82DCBP(,@03)                                  2035 13578000
*   /*****************************************************************/ 13579000
*   /*                                                               */ 13580000
*   /* THE DCBOFLWR FLAG IS SET OFF JUST IN CASE             @ZA11014*/ 13581000
*   /* THE DCB IS CLOSED BY TERMINATION MANAGEMENT           @ZA11014*/ 13582000
*   /* FOR SOME REASON LIKE TIME OUT ABEND.                  @ZA11014*/ 13583000
*   /* THIS WILL KEEP THE CLOSE SVC FROM TRYING              @ZA11014*/ 13584000
*   /* TO WRITE AN END-OF-FILE MARK.                         @ZA11014*/ 13585000
*   /*                                                               */ 13586000
*   /*****************************************************************/ 13587000
*                                                                  2036 13588000
*   DCBOFLWR=OFF;                   /*                       @ZA11014*/ 13589000
         L     @03,DCBPTR                                          2036 13590000
         NI    DCBOFLWR+40(@03),B'01111111'                        2036 13591000
*   RESPECIFY                                                      2037 13592000
*     REG1 RESTRICTED;              /*                       @ZA11014*/ 13593000
*   REG1=ADDR(SV82LIST);            /*                       @ZA11014*/ 13594000
         LA    REG1,SVC82ARG                                       2038 13595000
*                                                                  2039 13596000
*   /*****************************************************************/ 13597000
*   /*                                                               */ 13598000
*   /* NOW THE SVC 82 (DASDR) IS ISSUED TO                   @ZA11014*/ 13599000
*   /* PERFORM A PSEUDO OPEN WHICH BUILDS                    @ZA11014*/ 13600000
*   /* THE DEB, CHAINS IT TO THE TCB DEB CHAIN,              @ZA11014*/ 13601000
*   /* AND INSERTS THE DEB INTO THE SYSTEM                   @ZA11014*/ 13602000
*   /* DEB TABLE.                                            @ZA11014*/ 13603000
*   /*                                                               */ 13604000
*   /*****************************************************************/ 13605000
*                                                                  2039 13606000
*LRV82SVC:                                                         2039 13607000
*   SVC(82);                        /*                       @ZA11014*/ 13608000
*                                                                  2039 13609000
LRV82SVC SVC   82                                                  2039 13610000
*   /*****************************************************************/ 13611000
*   /*                                                               */ 13612000
*   /* CONTROL IS RETURNED                                   @ZA11014*/ 13613000
*   /* WITH A RETURN CODE ZERO AS CURRENTLY                  @ZA11014*/ 13614000
*   /* THERE A NO POSSIBLE ERRORS WHICH WILL                 @ZA11014*/ 13615000
*   /* NOT ABEND THE TASK.                                   @ZA11014*/ 13616000
*   /*                                                               */ 13617000
*   /*****************************************************************/ 13618000
*                                                                  2040 13619000
*                                   /*                       @ZA11014*/ 13620000
*                                                                  2040 13621000
*   /*****************************************************************/ 13622000
*   /*                                                               */ 13623000
*   /* HERE THE LOAD IS DONE FOR THE ABNORM END APPENDAGER@ZA11014   */ 13624000
*   /* REGISTER 1 IS ALREADY RESTRICTED                      @ZA11014*/ 13625000
*   /*                                                               */ 13626000
*   /*****************************************************************/ 13627000
*                                                                  2040 13628000
*   RESPECIFY                                                      2040 13629000
*    (REG0,                                                        2040 13630000
*     REG4) RESTRICTED;             /*                       @ZA11014   13631000
*                                                            @ZA11014*/ 13632000
*LRVLOAD:                                                          2041 13633000
*   GEN(LOAD EP=IGG019A4);          /*                       @ZA11014   13634000
*                                                            @ZA11014*/ 13635000
*                                                                  2041 13636000
LRVLOAD  LOAD EP=IGG019A4                                               13637000
*   /*****************************************************************/ 13638000
*   /*                                                               */ 13639000
*   /* REGISTER 0 HAS ENTRY POINT ADDRESS                    @ZA11014*/ 13640000
*   /* REGISTER 1 HAS MODULE SIZE                            @ZA11014*/ 13641000
*   /*                                                               */ 13642000
*   /*****************************************************************/ 13643000
*                                                                  2042 13644000
*                                   /*                       @ZA11014*/ 13645000
*   RESPECIFY                                                      2042 13646000
*     REG4 UNRSTD;                  /*                       @ZA11014   13647000
*                                                            @ZA11014   13648000
*                                                            @ZA11014*/ 13649000
*                                                                  2042 13650000
*   /*****************************************************************/ 13651000
*   /*                                                               */ 13652000
*   /* SET UP ADDRESSABILITY TO CONTROL BLOCKS               @ZA11014*/ 13653000
*   /*                                                               */ 13654000
*   /*****************************************************************/ 13655000
*                                                                  2043 13656000
*   DCBPTR=ADDR(IOXDCB);            /*                       @ZA11014*/ 13657000
         L     @03,IOCTLBKP                                        2043 13658000
         LA    @03,IOXDCB(,@03)                                    2043 13659000
         ST    @03,DCBPTR                                          2043 13660000
*   DEBPTR=DCBDEBAD;                /*                       @ZA11014*/ 13661000
         L     @03,DCBPTR                                          2044 13662000
         L     @03,DCBDEBAD+40(,@03)                               2044 13663000
         ST    @03,DEBPTR                                          2044 13664000
*   DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);/*              @ZA11014*/ 13665000
         LA    @03,32                                              2045 13666000
         AL    @03,DEBPTR                                          2045 13667000
         ST    @03,DEBDAPTR                                        2045 13668000
*   IOBSTPTR=ADDR(IOXIOB);          /*                       @ZA11014   13669000
*                                                            @ZA11014*/ 13670000
*                                                                  2046 13671000
         L     @03,IOCTLBKP                                        2046 13672000
         LA    @03,IOXIOB(,@03)                                    2046 13673000
         ST    @03,IOBSTPTR                                        2046 13674000
*   /*****************************************************************/ 13675000
*   /*                                                               */ 13676000
*   /* INITIALIZE IOB SEEK TEMP AREA                         @ZA11014*/ 13677000
*   /*                                                               */ 13678000
*   /*****************************************************************/ 13679000
*                                                                  2047 13680000
*   IOBSEEK=''B;                    /*                       @ZA11014   13681000
*                                                            @ZA11014   13682000
*                                                            @ZA11014*/ 13683000
*                                                                  2047 13684000
         L     @03,IOBSTPTR                                        2047 13685000
         XC    IOBSEEK(8,@03),IOBSEEK(@03)                         2047 13686000
*   /*****************************************************************/ 13687000
*   /*                                                               */ 13688000
*   /* ISSUE MODESET TO GET INTO KEY ZERO                    @ZA11014*/ 13689000
*   /* SO THAT DEB CAN BE MODIFIED                           @ZA11014*/ 13690000
*   /*                                                               */ 13691000
*   /*****************************************************************/ 13692000
*                                                                  2048 13693000
*                                   /*                       @ZA11014*/ 13694000
*                                                                  2048 13695000
*   /*****************************************************************/ 13696000
*   /*                                                               */ 13697000
*   /* SAVE MODULE SIZE BEFORE ISSUING MODESET               @ZA11014*/ 13698000
*   /*                                                               */ 13699000
*   /*****************************************************************/ 13700000
*                                                                  2048 13701000
*   MODSIZE=REG1;                   /*                       @ZA11014   13702000
*                                                            @ZA11014*/ 13703000
*                                                                  2048 13704000
         ST    REG1,MODSIZE                                        2048 13705000
*   /*****************************************************************/ 13706000
*   /*                                                               */ 13707000
*   /* ISSUE MODESET                                         @ZA11014*/ 13708000
*   /*                                                               */ 13709000
*   /*****************************************************************/ 13710000
*                                                                  2049 13711000
*   MODEPARM=''B;                   /*                       @ZA11014*/ 13712000
         XC    MODEPARM(4),MODEPARM                                2049 13713000
*   MODEPARM=MOD1;                  /*                       @ZA11014*/ 13714000
         L     @03,MOD1                                            2050 13715000
         ST    @03,MODEPARM                                        2050 13716000
*   RESPECIFY                                                      2051 13717000
*    (REG1,                                                        2051 13718000
*     REG3) RSTD;                   /*                       @ZA11014*/ 13719000
*   REG3=MODEPARM;                  /*                       @ZA11014*/ 13720000
         L     REG3,MODEPARM                                       2052 13721000
*LRVMODE3:                                                         2053 13722000
*   DO;                             /* MODESET MF(E,REG3)            */ 13723000
LRVMODE3 DS    0H                                                  2054 13724000
*     RESPECIFY                                                    2054 13725000
*       GPR01F RESTRICTED;                                         2054 13726000
*     GPR01F=REG3;                  /* MODESET PARMLIST              */ 13727000
         LR    GPR01F,REG3                                         2055 13728000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 13729000
         SVC   107                                                 2056 13730000
*     RESPECIFY                                                    2057 13731000
*      (GPR01F) UNRESTRICTED;                                      2057 13732000
*   END;                            /* MODESET MF(E,REG3)    @ZA11014*/ 13733000
*                                                                  2058 13734000
*   /*****************************************************************/ 13735000
*   /*                                                               */ 13736000
*   /* DEBAPPAD IS CURRENTLY POINTING TO LOW CORE AS         @ZA11014*/ 13737000
*   /* A RESULT OF THE SVC 82 - MOVE THAT INFO               @ZA11014*/ 13738000
*   /* INTO THE CURRENT DEB AND RESET DEBAPPAD               @ZA11014*/ 13739000
*   /*                                                               */ 13740000
*   /*****************************************************************/ 13741000
*                                                                  2059 13742000
*   SAVEAVT=DEBAPPAD;               /*                       @ZA11014*/ 13743000
         L     @15,DEBPTR                                          2059 13744000
         L     @15,DEBAPPAD(,@15)                                  2059 13745000
         ST    @15,SAVEAVT                                         2059 13746000
*   DEBAPPAD=DEBPTR-(LENGTH(DEBAVT)+/*                       @ZA11014*/ 13747000
*       LENGTH(DEBPREFX));          /*                       @ZA11014*/ 13748000
         L     @15,DEBPTR                                          2060 13749000
         SL    @15,@CF03001                                        2060 13750000
         L     @14,DEBPTR                                          2060 13751000
         ST    @15,DEBAPPAD(,@14)                                  2060 13752000
*   DEBAVT=SAVEAVT->DEBAVT;         /*                       @ZA11014   13753000
*                                                            @ZA11014*/ 13754000
*                                                                  2061 13755000
         L     @15,DEBPTR                                          2061 13756000
         L     @15,DEBAPPAD(,@15)                                  2061 13757000
         L     @14,SAVEAVT                                         2061 13758000
         MVC   DEBAVT(20,@15),DEBAVT(@14)                          2061 13759000
*   /*****************************************************************/ 13760000
*   /*                                                               */ 13761000
*   /* SET ADDRESS OF AB END APPEN INTO DEB                  @ZA11014*/ 13762000
*   /*                                                               */ 13763000
*   /*****************************************************************/ 13764000
*                                                                  2062 13765000
*   DEBXCEAD=REG0;                  /*                       @ZA11014*/ 13766000
*                                                                  2062 13767000
         L     @15,DEBPTR                                          2062 13768000
         L     @15,DEBAPPAD(,@15)                                  2062 13769000
         STCM  REG0,7,DEBXCEAD(@15)                                2062 13770000
*   /*****************************************************************/ 13771000
*   /*                                                               */ 13772000
*   /* CALCULATE SIZE OF MODULE IN 2K BYTES - ENSURING       @ZA11014*/ 13773000
*   /* POSSIBLILITY OF MODULE CROSSING 2K BOUNDARY           @ZA11014*/ 13774000
*   /*                                                               */ 13775000
*   /*****************************************************************/ 13776000
*                                                                  2063 13777000
*   SLL(REG0,21);                   /*                       @ZA11014*/ 13778000
         SLL   REG0,21                                             2063 13779000
*   SRL(REG0,21);                   /*                       @ZA11014*/ 13780000
         SRL   REG0,21                                             2064 13781000
*   REG0=MODSIZE+REG0-1;            /*                       @ZA11014*/ 13782000
         LR    @15,REG0                                            2065 13783000
         AL    @15,MODSIZE                                         2065 13784000
         BCTR  @15,0                                               2065 13785000
         LR    REG0,@15                                            2065 13786000
*   SRL(REG0,11);                   /*                       @ZA11014*/ 13787000
         SRL   REG0,11                                             2066 13788000
*   REG0=REG0+1;                    /*                       @ZA11014*/ 13789000
         AL    REG0,@CF00222                                       2067 13790000
*   DEBXCEAB=REG0;                  /*                       @ZA11014   13791000
*                                                            @ZA11014*/ 13792000
         L     @15,DEBPTR                                          2068 13793000
         L     @15,DEBAPPAD(,@15)                                  2068 13794000
         STC   REG0,DEBXCEAB(,@15)                                 2068 13795000
*   RESPECIFY                                                      2069 13796000
*     REG0 UNRSTD;                  /*                       @ZA11014*/ 13797000
*                                                                  2069 13798000
*   /*****************************************************************/ 13799000
*   /*                                                               */ 13800000
*   /* IF VTOC HEADER REQUEST THEN CALC CCHHR OF VTOC HDR    @ZA11014*/ 13801000
*   /*                                                               */ 13802000
*   /*****************************************************************/ 13803000
*                                                                  2070 13804000
*   IF EXOVTH=ON                    /*                       @ZA11014*/ 13805000
*     THEN                          /*                       @ZA11014*/ 13806000
         L     @15,@PC00001+8                                      2070 13807000
         TM    EXOVTH(@15),B'00000001'                             2070 13808000
         BNO   @RF02070                                            2070 13809000
*     DO;                           /*                       @ZA11014   13810000
*                                                            @ZA11014*/ 13811000
*                                                                  2071 13812000
*       /*************************************************************/ 13813000
*       /*                                                           */ 13814000
*       /* CALC CCHHR OF VTOC HEADER FROM THE TTR IN THE     @ZA11014*/ 13815000
*       /* UCB                                               @ZA11014*/ 13816000
*       /*                                                           */ 13817000
*       /*************************************************************/ 13818000
*                                                                  2072 13819000
*       UCBPTR=EXOUCB;              /*                       @ZA11014*/ 13820000
         L     @15,@PC00001+8                                      2072 13821000
         L     @00,EXOUCB(,@15)                                    2072 13822000
         ST    @00,UCBPTR                                          2072 13823000
*       BEGHHLOC=BEGHH;             /*                       @ZA11014*/ 13824000
         L     @15,@PC00001+8                                      2073 13825000
         L     @15,EXOEXT(,@15)                                    2073 13826000
         MVC   BEGHHLOC(2),BEGHH(@15)                              2073 13827000
*       VTOCCYL=VTOCTT/HEADNUM;     /*                       @ZA11014*/ 13828000
         L     @15,UCBPTR                                          2074 13829000
         LH    @04,VTOCTT+24(,@15)                                 2074 13830000
         SRDA  @04,32                                              2074 13831000
         LH    @00,HEADNUM                                         2074 13832000
         DR    @04,@00                                             2074 13833000
         STH   @05,VTOCCYL                                         2074 13834000
*       VTOCHEAD=VTOCTT//HEADNUM;   /*                       @ZA11014   13835000
*                                                            @ZA11014*/ 13836000
*                                                                  2075 13837000
         L     @15,UCBPTR                                          2075 13838000
         LH    @04,VTOCTT+24(,@15)                                 2075 13839000
         SRDA  @04,32                                              2075 13840000
         LH    @00,HEADNUM                                         2075 13841000
         DR    @04,@00                                             2075 13842000
         STH   @04,VTOCHEAD                                        2075 13843000
*       /*************************************************************/ 13844000
*       /*                                                           */ 13845000
*       /* RESTRICT ADDRESSABILITY IN DEB TO THIS TRACK      @ZA11014*/ 13846000
*       /*                                                           */ 13847000
*       /*************************************************************/ 13848000
*                                                                  2076 13849000
*       DEBSTRCC=VTOCCYL;           /*                       @ZA11014*/ 13850000
         LH    @00,VTOCCYL                                         2076 13851000
         N     @00,@CF04424                                        2076 13852000
         L     @15,DEBDAPTR                                        2076 13853000
         STH   @00,DEBSTRCC(,@15)                                  2076 13854000
*       DEBSTRHH=VTOCHEAD;          /*                       @ZA11014*/ 13855000
         LH    @00,VTOCHEAD                                        2077 13856000
         N     @00,@CF04424                                        2077 13857000
         L     @15,DEBDAPTR                                        2077 13858000
         STH   @00,DEBSTRHH(,@15)                                  2077 13859000
*       DEBENDCC=VTOCCYL;           /*                       @ZA11014*/ 13860000
         LH    @00,VTOCCYL                                         2078 13861000
         N     @00,@CF04424                                        2078 13862000
         L     @15,DEBDAPTR                                        2078 13863000
         STH   @00,DEBENDCC(,@15)                                  2078 13864000
*       DEBENDHH=VTOCHEAD;          /*                       @ZA11014*/ 13865000
         LH    @00,VTOCHEAD                                        2079 13866000
         N     @00,@CF04424                                        2079 13867000
         L     @15,DEBDAPTR                                        2079 13868000
         STH   @00,DEBENDHH(,@15)                                  2079 13869000
*       DEBNMTRK=1;                 /*                       @ZA11014   13870000
*                                                            @ZA11014*/ 13871000
*                                                                  2080 13872000
         L     @15,DEBDAPTR                                        2080 13873000
         MVC   DEBNMTRK(2,@15),@CH00222                            2080 13874000
*       /*************************************************************/ 13875000
*       /*                                                           */ 13876000
*       /* SET THE CCHHR OF VTOC HEADER INTO THE             @ZA11014*/ 13877000
*       /* USERS CALLING AREA                                @ZA11014*/ 13878000
*       /*                                                           */ 13879000
*       /*************************************************************/ 13880000
*                                                                  2081 13881000
*       BEGCC=VTOCCYL;              /*                       @ZA11014*/ 13882000
         L     @15,@PC00001+8                                      2081 13883000
         L     @15,EXOEXT(,@15)                                    2081 13884000
         MVC   BEGCC(2,@15),VTOCCYL                                2081 13885000
*       BEGHH=VTOCHEAD;             /*                       @ZA11014*/ 13886000
         L     @15,@PC00001+8                                      2082 13887000
         L     @15,EXOEXT(,@15)                                    2082 13888000
         MVC   BEGHH(2,@15),VTOCHEAD                               2082 13889000
*       BEGR=ZERO;                  /*                       @0Z11014*/ 13890000
         L     @15,@PC00001+8                                      2083 13891000
         L     @15,EXOEXT(,@15)                                    2083 13892000
         LH    @00,ZERO                                            2083 13893000
         STC   @00,BEGR(,@15)                                      2083 13894000
*     END;                          /*                       @ZA11014   13895000
*                                                            @ZA11014*/ 13896000
*                                                                  2084 13897000
*   /*****************************************************************/ 13898000
*   /*                                                               */ 13899000
*   /* OTHERWISE VSAM DATA SET REQUEST                       @ZA11014*/ 13900000
*   /* SET DEB EXTENTS EQUAL TO THE EXTENT ENTRY SENT        @ZA11014*/ 13901000
*   /* BY CALLED                                             @ZA11014*/ 13902000
*   /*                                                               */ 13903000
*   /*****************************************************************/ 13904000
*                                                                  2085 13905000
*   ELSE                            /*                       @ZA11014*/ 13906000
*     DO;                           /*                       @ZA11014*/ 13907000
         B     @RC02070                                            2085 13908000
@RF02070 DS    0H                                                  2086 13909000
*       DEBSTRCC=VSMBCC;            /*                       @ZA11014*/ 13910000
         L     @15,@PC00001+8                                      2086 13911000
         L     @15,EXOEXT(,@15)                                    2086 13912000
         LH    @00,VSMBCC(,@15)                                    2086 13913000
         L     @15,DEBDAPTR                                        2086 13914000
         STH   @00,DEBSTRCC(,@15)                                  2086 13915000
*       DEBSTRHH=VSMBHH;            /*                       @ZA11014*/ 13916000
         L     @15,@PC00001+8                                      2087 13917000
         L     @15,EXOEXT(,@15)                                    2087 13918000
         LH    @00,VSMBHH(,@15)                                    2087 13919000
         L     @15,DEBDAPTR                                        2087 13920000
         STH   @00,DEBSTRHH(,@15)                                  2087 13921000
*       DEBENDCC=VSMECC;            /*                       @ZA11014*/ 13922000
         L     @15,@PC00001+8                                      2088 13923000
         L     @15,EXOEXT(,@15)                                    2088 13924000
         LH    @00,VSMECC(,@15)                                    2088 13925000
         L     @15,DEBDAPTR                                        2088 13926000
         STH   @00,DEBENDCC(,@15)                                  2088 13927000
*       DEBENDHH=VSMEHH;            /*                       @ZA11014*/ 13928000
         L     @15,@PC00001+8                                      2089 13929000
         L     @15,EXOEXT(,@15)                                    2089 13930000
         LH    @00,VSMEHH(,@15)                                    2089 13931000
         L     @15,DEBDAPTR                                        2089 13932000
         STH   @00,DEBENDHH(,@15)                                  2089 13933000
*       DEBNMTRK=VSMEHH-VSMBHH+1;   /*                       @ZA11014*/ 13934000
         L     @15,@PC00001+8                                      2090 13935000
         L     @15,EXOEXT(,@15)                                    2090 13936000
         L     @14,@PC00001+8                                      2090 13937000
         L     @14,EXOEXT(,@14)                                    2090 13938000
         LH    @00,VSMEHH(,@15)                                    2090 13939000
         SH    @00,VSMBHH(,@14)                                    2090 13940000
         AL    @00,@CF00222                                        2090 13941000
         L     @15,DEBDAPTR                                        2090 13942000
         STH   @00,DEBNMTRK(,@15)                                  2090 13943000
*     END;                          /*                       @ZA11014   13944000
*                                                            @ZA11014*/ 13945000
*                                                                  2091 13946000
*   /*****************************************************************/ 13947000
*   /*                                                               */ 13948000
*   /* RESET FILE MASK TO INHIBIT HEAD SWITCHING             @ZA11014*/ 13949000
*   /*                                                               */ 13950000
*   /*****************************************************************/ 13951000
*                                                                  2092 13952000
*   DEBDVMOD=DEBDVMOD|INHDFLMK;     /*                       @ZA11014   13953000
*                                                            @ZA11014*/ 13954000
*                                                                  2092 13955000
@RC02070 L     @15,DEBDAPTR                                        2092 13956000
         OC    DEBDVMOD(1,@15),INHDFLMK                            2092 13957000
*   /*****************************************************************/ 13958000
*   /*                                                               */ 13959000
*   /* ISSUE MODESET TO RETURN TO PROB PROG KEY              @ZA11014*/ 13960000
*   /*                                                               */ 13961000
*   /*****************************************************************/ 13962000
*                                                                  2093 13963000
*   MODEPARM=''B;                   /*                       @ZA11014*/ 13964000
         XC    MODEPARM(4),MODEPARM                                2093 13965000
*   MODEPARM=MOD2;                  /*                       @ZA11014*/ 13966000
         L     @00,MOD2                                            2094 13967000
         ST    @00,MODEPARM                                        2094 13968000
*   REG3=MODEPARM;                  /*                       @ZA11014*/ 13969000
         L     REG3,MODEPARM                                       2095 13970000
*LRVMODE4:                                                         2096 13971000
*   DO;                             /* MODESET MF(E,REG3)            */ 13972000
LRVMODE4 DS    0H                                                  2097 13973000
*     RESPECIFY                                                    2097 13974000
*       GPR01F RESTRICTED;                                         2097 13975000
*     GPR01F=REG3;                  /* MODESET PARMLIST              */ 13976000
         LR    GPR01F,REG3                                         2098 13977000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 13978000
         SVC   107                                                 2099 13979000
*     RESPECIFY                                                    2100 13980000
*      (GPR01F) UNRESTRICTED;                                      2100 13981000
*   END;                            /* MODESET MF(E,REG3)    @ZA11014*/ 13982000
*   RESPECIFY                                                      2102 13983000
*    (REG1,                                                        2102 13984000
*     REG3) UNRSTD;                 /*                       @ZA11014   13985000
*                                                            @ZA11014   13986000
*                                                            @ZA11014*/ 13987000
*                                                                  2102 13988000
*   /*****************************************************************/ 13989000
*   /*                                                               */ 13990000
*   /* RETURN RC=OK /*@ZA11014                                       */ 13991000
*   /*                                                               */ 13992000
*   /*****************************************************************/ 13993000
*                                                                  2103 13994000
*   TESTRC=0;                       /*                       @ZA11014*/ 13995000
         SLR   @03,@03                                             2103 13996000
         STH   @03,TESTRC                                          2103 13997000
*   RETURN CODE(TESTRC);            /*                       @ZA11014*/ 13998000
         LH    @15,TESTRC                                          2104 13999000
         L     @14,@SA00031                                        2104 14000000
         LM    @00,@12,@SA00031+8                                  2104 14001000
         BR    @14                                                 2104 14002000
*   END OPNVTH;                     /*                       @ZA11014*/ 14003000
*   END IDCIO05                     /*                       @Z40LB35*/ 14004000
*                                                                  2106 14005000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 14006000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 14007000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 14008000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 14009000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 14010000
*/*%INCLUDE SYSLIB  (AMSDF05 )                                       */ 14011000
*/*%INCLUDE SYSLIB  (AMSDF09 )                                       */ 14012000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 14013000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 14014000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 14015000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 14016000
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */ 14017000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 14018000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */ 14019000
*/*%INCLUDE SYSLIB  (IHAECB  )                                       */ 14020000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 14021000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 14022000
*/*%INCLUDE SYSLIB  (IDCDF66 )                                       */ 14023000
*                                                                  2106 14024000
*       ;                                                          2106 14025000
@DATA    DS    0H                                                       14026000
@CH00036 DC    H'2'                                                     14027000
@CH00045 DC    H'4'                                                     14028000
@CH00038 DC    H'8'                                                     14029000
@CH00279 DC    H'20'                                                    14030000
@CH00849 DC    H'44'                                                    14031000
@CH01813 DC    H'60'                                                    14032000
@DATD    DSECT                                                          14033000
         DS    0F                                                       14034000
@SA00001 DS    18F                                                      14035000
@PC00001 DS    3F                                                       14036000
@SA00020 DS    15F                                                      14037000
@SA00002 DS    15F                                                      14038000
@SA00003 DS    15F                                                      14039000
@SA00004 DS    15F                                                      14040000
@SA00022 DS    15F                                                      14041000
@SA00024 DS    15F                                                      14042000
@SA00023 DS    15F                                                      14043000
@SA00030 DS    15F                                                      14044000
@SA00029 DS    15F                                                      14045000
@SA00010 DS    15F                                                      14046000
@SA00007 DS    15F                                                      14047000
@SA00008 DS    15F                                                      14048000
@SA00005 DS    15F                                                      14049000
@SA00006 DS    15F                                                      14050000
@SA00014 DS    15F                                                      14051000
@SA00015 DS    15F                                                      14052000
@SA00017 DS    15F                                                      14053000
@SA00021 DS    15F                                                      14054000
@SA00019 DS    15F                                                      14055000
@SA00031 DS    15F                                                      14056000
@AL00001 DS    4A                                                       14057000
IDCIO05  CSECT                                                          14058000
         DS    0F                                                       14059000
@CF00119 DC    F'0'                                                     14060000
@CF00222 DC    F'1'                                                     14061000
@CH00222 EQU   @CF00222+2                                               14062000
@CF03001 DC    F'36'                                                    14063000
@CF04409 DC    F'392'                                                   14064000
@CF04425 DC    F'-20'                                                   14065000
@CF04427 DC    F'-14'                                                   14066000
@CF04428 DC    F'-12'                                                   14067000
@CF04420 DC    F'-4'                                                    14068000
@CF04429 DC    F'-3'                                                    14069000
@CF04424 DC    XL4'0000FFFF'                                            14070000
@DATD    DSECT                                                          14071000
         DS    0D                                                       14072000
LISTSCAN DS    A                                                        14073000
IOCSPTR  DS    A                                                        14074000
OPNPTR   DS    A                                                        14075000
DDSTRU   DS    A                                                        14076000
FSADDR   DS    A                                                        14077000
ERCNVADR DS    A                                                        14078000
DMPINDEX DS    A                                                        14079000
CCMSGPTR DS    A                                                        14080000
CMMSGPTR DS    A                                                        14081000
CTMSGPTR DS    A                                                        14082000
ELEMENT  DS    F                                                        14083000
UCBPTR   DS    A                                                        14084000
DCBPTR   DS    A                                                        14085000
JFCBPTR  DS    A                                                        14086000
JFCBXPTR DS    A                                                        14087000
DEBPTR   DS    A                                                        14088000
DEBDAPTR DS    A                                                        14089000
DEBEXPTR DS    A                                                        14090000
DEBSBPTR DS    A                                                        14091000
IOBPRPTR DS    A                                                        14092000
IOBSTPTR DS    A                                                        14093000
ECBPTR   DS    A                                                        14094000
IOCTLBKP DS    A                                                        14095000
USERCHRP DS    A                                                        14096000
ADDCHAIN DS    A                                                        14097000
SAVEAVT  DS    A                                                        14098000
UNCHAIN  DS    F                                                        14099000
MODSIZE  DS    F                                                        14100000
RWIOARPT DS    A                                                        14101000
RRIOARPT DS    A                                                        14102000
WRADDR   DS    A                                                        14103000
BLKSIZE  DS    F                                                        14104000
SYNMSGAD DS    A                                                        14105000
OCPARM   DS    A                                                        14106000
LISTPTR  DS    A                                                        14107000
RDADDR   DS    A                                                        14108000
TESTRC   DS    H                                                        14109000
WRITECNT DS    H                                                        14110000
READCNTA DS    H                                                        14111000
ARRINDEX DS    H                                                        14112000
CCWCNT   DS    H                                                        14113000
OFFSET   DS    H                                                        14114000
LASTCCW  DS    H                                                        14115000
CCWNDX   DS    H                                                        14116000
RDOPCNT  DS    H                                                        14117000
CNTCCWS  DS    H                                                        14118000
RCTR     DS    H                                                        14119000
RVCNT    DS    H                                                        14120000
VTOCCYL  DS    H                                                        14121000
VTOCHEAD DS    H                                                        14122000
SETRC    DS    H                                                        14123000
         DS    CL3                                                      14124000
RCNTPTR  DS    AL3                                                      14125000
         DS    CL1                                                      14126000
RDKDADDR DS    AL3                                                      14127000
LISTLN   DS    FL1                                                      14128000
@TS00001 DS    CL95                                                     14129000
PRINTARG DS    CL28                                                     14130000
BEGHHLOC DS    CL2                                                      14131000
         DS    CL2                                                      14132000
TEMPCCHH DS    CL8                                                      14133000
         ORG   TEMPCCHH                                                 14134000
@NM00201 DS    CL3                                                      14135000
TEMPCHR  DS    CL5                                                      14136000
         ORG   TEMPCCHH+8                                               14137000
SRCHCHR  DS    CL5                                                      14138000
         ORG   SRCHCHR                                                  14139000
SRCHCC   DS    FL2                                                      14140000
SRCHHH   DS    FL2                                                      14141000
SRCHR    DS    FL1                                                      14142000
         ORG   SRCHCHR+5                                                14143000
         DS    CL3                                                      14144000
SAVEREGS DS    CL64                                                     14145000
PARMLIST DS    CL20                                                     14146000
SVC82ARG DS    CL16                                                     14147000
CANSTAE  DS    BL1                                                      14148000
         DS    CL3                                                      14149000
MODEPARM DS    CL4                                                      14150000
RDJFCBPM DS    CL4                                                      14151000
         ORG   RDJFCBPM                                                 14152000
RDJFCBCD DS    CL1                                                      14153000
RDJFCBAD DS    AL3                                                      14154000
         ORG   RDJFCBPM+4                                               14155000
IDCIO05  CSECT                                                          14156000
         DS    0F                                                       14157000
@SIZDATD DC    AL1(0)                                                   14158000
         DC    AL3(@ENDDATD-@DATD)                                      14159000
         DS    0D                                                       14160000
RCRACF56 DC    XL4'00000038'                                            14161000
RCRACF60 DC    XL4'0000003C'                                            14162000
RCPSWD12 DC    XL4'0000000C'                                            14163000
ZERO     DC    H'0'                                                     14164000
TWOCCWS  DC    H'2'                                                     14165000
THREECCW DC    H'3'                                                     14166000
FOURCCWS DC    H'4'                                                     14167000
FIVECCWS DC    H'5'                                                     14168000
MAXRECS  DC    H'122'                                                   14169000
LENR0    DC    H'16'                                                    14170000
LENR0D   DC    H'8'                                                     14171000
LENCNT   DC    H'8'                                                     14172000
TWOK     DC    H'2048'                                                  14173000
CCWSIZE  DC    H'8'                                                     14174000
R0CHNLOC DC    H'2'                                                     14175000
NONRDCT  DC    H'3'                                                     14176000
RCSRUEX  DC    H'31'                                                    14177000
RCINVWR  DC    H'23'                                                    14178000
RCSRUNCO DC    H'22'                                                    14179000
RCNOERR  DC    H'0'                                                     14180000
RCABDS   DC    H'8'                                                     14181000
RCABST   DC    H'12'                                                    14182000
RCABOV   DC    H'16'                                                    14183000
RCABNRF  DC    H'20'                                                    14184000
RCABSYNC DC    H'24'                                                    14185000
RCABDTCK DC    H'28'                                                    14186000
RCABEOFR DC    H'32'                                                    14187000
LOCENT   DC    AL2(125)                                                 14188000
NEWCCWLN DC    H'1448'                                                  14189000
LABCCWLN DC    H'80'                                                    14190000
TABCCWLN DC    H'400'                                                   14191000
VTOCCWLN DC    H'400'                                                   14192000
RPRWCCLN DC    H'4000'                                                  14193000
RVWS     DC    AL1(2)                                                   14194000
RVWKD    DC    AL1(3)                                                   14195000
SPCNTOP  DC    XL1'0F'                                                  14196000
TICOP    DC    XL1'08'                                                  14197000
NOPOP    DC    XL1'03'                                                  14198000
RDCNTOP  DC    XL1'92'                                                  14199000
RDKDOP   DC    XL1'8E'                                                  14200000
RDCKDOP  DC    XL1'9E'                                                  14201000
RDDTOP   DC    XL1'86'                                                  14202000
NTFSTIME DC    XL1'00'                                                  14203000
FSTIME   DC    XL1'FF'                                                  14204000
PCDSTERR DC    XL1'61'                                                  14205000
PCSTGERR DC    XL1'62'                                                  14206000
PCOVFOK  DC    XL1'63'                                                  14207000
PCNRF    DC    XL1'64'                                                  14208000
PCSYNCER DC    XL1'65'                                                  14209000
PCDATCHK DC    XL1'66'                                                  14210000
PCEOFIND DC    XL1'67'                                                  14211000
UNSUCCES DC    XL1'41'                                                  14212000
IGNORE   DC    XL1'04'                                                  14213000
@CC04230 DC    C'IOXCTLBK'                                              14214000
@CC03779 DC    C'IO05'                                                  14215000
@CC03929 DC    C'VTOC'                                                  14216000
@CC04110 DC    C'IOIN'                                                  14217000
@CC04120 DC    C'IOEX'                                                  14218000
@CC04124 DC    C'IOOE'                                                  14219000
@CC04134 DC    C'IOPG'                                                  14220000
@CC04142 DC    C'IOCL'                                                  14221000
@CC04149 DC    C'IOOP'                                                  14222000
@CC04162 DC    C'IOOV'                                                  14223000
@CC04172 DC    C'IOOT'                                                  14224000
@CC04197 DC    C'IOOL'                                                  14225000
@CC04211 DC    C'IOON'                                                  14226000
@CC04232 DC    C'DCB '                                                  14227000
@CC04234 DC    C'ECB '                                                  14228000
@CC04236 DC    C'IOB '                                                  14229000
@CC04238 DC    C'XLST'                                                  14230000
@CC04240 DC    C'JFCB'                                                  14231000
@CC04242 DC    C'CCW '                                                  14232000
@CC04243 DC    C'IOBB'                                                  14233000
@CC04248 DC    C'IOP1'                                                  14234000
@CC04252 DC    C'IOP2'                                                  14235000
@CC04256 DC    C'IOG1'                                                  14236000
@CC04262 EQU   @CC04230                                                 14237000
@CC04271 DC    C'IOCS'                                                  14238000
@CC04282 DC    C'IOCK'                                                  14239000
@CC04288 DC    C'IORT'                                                  14240000
@CC04303 DC    C'IOSN'                                                  14241000
@CC04304 DC    C'IOSY'                                                  14242000
@CC04319 DC    C'IOOC'                                                  14243000
@CC04320 DC    C'IOAB'                                                  14244000
@CC04328 DC    C'IORJ'                                                  14245000
@CC04334 DC    C'IOOR'                                                  14246000
@CC04347 DC    C'IOCT'                                                  14247000
@CC04350 DC    C'IOC1'                                                  14248000
@CC04354 DC    C'IOKD'                                                  14249000
@CC04357 DC    C'IOK2'                                                  14250000
@CC04361 DC    C'IOCW'                                                  14251000
@CC04365 DC    C'IOSP'                                                  14252000
@CC04371 DC    C'IOKS'                                                  14253000
@CC04373 DC    C'IOK3'                                                  14254000
@CC04374 DC    C'IOK4'                                                  14255000
@CC04378 DC    C'IOAJ'                                                  14256000
@CC04384 DC    C'IOWR'                                                  14257000
@CC04387 DC    C'IOWB'                                                  14258000
@CC04391 DC    C'IOFW'                                                  14259000
@CC04393 DC    C'IOFB'                                                  14260000
@CC04397 DC    C'IOVH'                                                  14261000
@CC03785 DC    C'IO5'                                                   14262000
@CC03787 DC    C'SA0'                                                   14263000
@CB03783 DC    X'00'                                                    14264000
ALL      DC    CL3'ALL'                                                 14265000
FORMAT   DC    CL4'FORM'                                                14266000
HSECOND  DC    CL4'HSEC'                                                14267000
CLOCK    DC    CL4'KLOK'                                                14268000
SETZERO  DC    CL4'ZERO'                                                14269000
SETBLANK DC    CL4'BLNK'                                                14270000
NOSET    DC    CL4'NSET'                                                14271000
OVERRIDE DC    CL4'OVRD'                                                14272000
ACQUIRE  DC    CL8'ACQUIRE '                                            14273000
RELINQ   DC    CL8'RELINQ  '                                            14274000
MOUNT    DC    CL8'MOUNT   '                                            14275000
DEMOUNT  DC    CL8'DEMOUNT '                                            14276000
DEFINE   DC    CL8'DEFINE  '                                            14277000
MOVE     DC    CL8'MOVE    '                                            14278000
TRACEQ   DC    CL8'TRACEQ  '                                            14279000
COPYTABL DC    CL8'COPYTABL'                                            14280000
COPYCRTG DC    CL8'COPYCRTG'                                            14281000
COPYVOL  DC    CL8'COPYVOL '                                            14282000
VVIC     DC    CL8'VVIC    '                                            14283000
TUNE     DC    CL8'TUNE    '                                            14284000
NAMES    DC    CL4'NAME'                                                14285000
UNIT     DC    CL4'UNIT'                                                14286000
SHR      DC    CL4'SHR '                                                14287000
EXCL     DC    CL4'EXCL'                                                14288000
NOWAIT   DC    CL4'NWAI'                                                14289000
WAIT     DC    CL4'WAIT'                                                14290000
SECCHECK DC    CL8'SECCHECK'                                            14291000
SCRVTOC  DC    CL8'SCRVTOC '                                            14292000
GETVTOC  DC    CL8'GETVTOC '                                            14293000
PUTVTOC  DC    CL8'PUTVTOC '                                            14294000
RECATLG  DC    CL8'RECATLG '                                            14295000
INITVOL  DC    CL8'INITVOL '                                            14296000
CHECK    DC    CL8'CHECK   '                                            14297000
POSTUCB  DC    CL8'POSTUCB '                                            14298000
GET      DC    CL8'GET     '                                            14299000
PUT      DC    CL8'PUT     '                                            14300000
CLOSE    DC    CL8'CLOSE   '                                            14301000
OPEN     DC    CL8'OPEN    '                                            14302000
RVOPENR  DC    CL8'OPENR   '                                            14303000
RVRDCNT  DC    CL8'READCNT '                                            14304000
RVREADKD DC    CL8'READKD  '                                            14305000
RVSPACCR DC    CL8'SPACCR  '                                            14306000
RVFWRITE DC    CL8'FWRITE  '                                            14307000
RVWRITER DC    CL8'WRITEREC'                                            14308000
PUTLABEL DC    CL8'PUTLABEL'                                            14309000
GETLABEL DC    CL8'GETLABEL'                                            14310000
CANCEL   DC    CL8'CANCEL  '                                            14311000
SET      DC    CL8'SET     '                                            14312000
SELECTX  DC    CL8'SELECTX '                                            14313000
CHANGEX  DC    CL8'CHANGEX '                                            14314000
SELECTDD DC    CL8'SELECTDD'                                            14315000
SELECTDS DC    CL8'SELECTDS'                                            14316000
TBLREST  DC    CL8'TBLREST '                                            14317000
NULLIFYC DC    CL8'NULLIFYC'                                            14318000
RDMSC    DC    CL8'RDMSC   '                                            14319000
RDMSCTBL DC    CL8'RDMSCTBL'                                            14320000
RDCARTLB DC    CL8'RDCARTLB'                                            14321000
AUDITCEL DC    CL8'AUDITCEL'                                            14322000
RDSTGAD  DC    CL8'RDSTGAD '                                            14323000
MODIFYC  DC    CL8'MODIFYC '                                            14324000
MODID    DC    CL4'IO05'                                                14325000
FIXAREA  DS    CL350                                                    14326000
         ORG   FIXAREA                                                  14327000
@NM00192 DC    350X'00'                                                 14328000
         ORG   FIXAREA+350                                              14329000
CCWSIDEQ DC    X'3100000040000005'                                      14330000
CCWTIC   DC    X'0800000000000000'                                      14331000
CCWWCKD  DC    X'1D00000080000008'                                      14332000
CCWWKD   DC    X'0D00000060000000'                                      14333000
CCWRCKD  DC    X'1E00000060000000'                                      14334000
CCWRKD   DC    X'0E00000060000000'                                      14335000
CCWDATA  DC    X'0000000060000000'                                      14336000
CCWRWSP  DC    X'0100000040000000'                                      14337000
CCWRWKD  DC    X'0D00000040000000'                                      14338000
CCWRRKD  DC    X'8E00000010000000'                                      14339000
CCWRRD   DC    X'8600000040000000'                                      14340000
CCWRWCKD DC    X'1D00000040000000'                                      14341000
CCWRRCKD DC    X'9E00000010000000'                                      14342000
CCWRRR0  DC    X'1600000060000010'                                      14343000
CCWRSSEC DC    X'2300000040000001'                                      14344000
CCWRRCNT DC    X'9200000040000008'                                      14345000
CCWRSPCT DC    X'0F00000040000003'                                      14346000
CCWRNOP  DC    X'0300000020000001'                                      14347000
SVC82OPN DC    X'20'                                                    14348000
SVC82CLS DC    X'21'                                                    14349000
LAB      DC    X'10'                                                    14350000
TABLE    DC    X'20'                                                    14351000
PASSWORD DC    X'30'                                                    14352000
NEWVOL   DC    X'40'                                                    14353000
VTOC     DC    X'50'                                                    14354000
VTOCHDR  DC    X'90'                                                    14355000
REPDS    DC    X'80'                                                    14356000
ZEROS    DS    CL8                                                      14357000
         ORG   ZEROS                                                    14358000
@NM00197 DC    8X'00'                                                   14359000
         ORG   ZEROS+8                                                  14360000
VTOCDSN  DS    CL44                                                     14361000
         ORG   VTOCDSN                                                  14362000
@NM00198 DC    44X'04'                                                  14363000
         ORG   VTOCDSN+44                                               14364000
VTOCINST DC    CL4'VTOC'                                                14365000
         DS    CL3                                                      14366000
EXLIST   DS    CL8                                                      14367000
         ORG   EXLIST                                                   14368000
LISTJFCB DC    X'07'                                                    14369000
AREAJFCB DS    AL3                                                      14370000
EXTDCB   DC    X'91'                                                    14371000
ADDRDCBE DC    AL3(OCABEND)                                             14372000
         ORG   EXLIST+8                                                 14373000
NTFNDPTR DC    X'FFFFFFFF'                                              14374000
ABEID    DC    CL2'A3'                                                  14375000
INHDFLMK DC    X'18'                                                    14376000
CYLZERO  DC    X'0000'                                                  14377000
TRKZERO  DC    X'0000'                                                  14378000
         DS    CL1                                                      14379000
MOD1     DS    CL4                                                      14380000
         ORG   MOD1                                                     14381000
MOD101   DC    B'00000000'                                              14382000
MOD102   DC    B'00000000'                                              14383000
MOD103   DC    B'00000000'                                              14384000
MOD104   DC    B'00111100'                                              14385000
         ORG   MOD1+4                                                   14386000
MOD2     DS    CL4                                                      14387000
         ORG   MOD2                                                     14388000
MOD201   DC    B'00000000'                                              14389000
MOD202   DC    B'00000000'                                              14390000
MOD203   DC    B'00000000'                                              14391000
MOD204   DC    B'00100100'                                              14392000
         ORG   MOD2+4                                                   14393000
SUCCESS  DC    X'7F'                                                    14394000
@DATD    DSECT                                                          14395000
*                                                          /*@Y30LB35*/ 14396000
IDCIO05  CSECT                                                 @Y30LB35 14397000
         ENTRY IDCIOS5                                         @Y30LB35 14398000
IDCIOS5  DC    A(@SIZDATD)                                     @Y30LB35 14399000
@DATD    DSECT                                                          14400000
*                                                          /*@Y30LB35*/ 14401000
IDCIO05  CSECT                                                 @Y30LB35 14402000
DCBEXCP  DCB DSORG=PS,MACRF=(E),EXLST=EXLIST                   @ZA11014 14403000
OPENLIST OPEN  (0),MF=L                                        @Y30LB35 14404000
DCBEXCP1 DCB DSORG=PS,MACRF=(E),EXLST=EXLIST,XENDA=A4          @ZA11014 14405000
CLOSELST CLOSE (0),MF=L                                        @Y30LB35 14406000
@DATD    DSECT                                                          14407000
*                                                          /*@Y30LB35*/ 14408000
IDCIO05  CSECT                                                 @Y30LB35 14409000
JFCBLST RDJFCB (0),MF=L                                        @Y30LB35 14410000
@DATD    DSECT                                                          14411000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                14412000
@ENDDATD EQU   *                                                        14413000
IDCIO05  CSECT                                                          14414000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       14415000
@01      EQU   01                                                       14416000
@02      EQU   02                                                       14417000
@03      EQU   03                                                       14418000
@04      EQU   04                                                       14419000
@05      EQU   05                                                       14420000
@06      EQU   06                                                       14421000
@07      EQU   07                                                       14422000
@08      EQU   08                                                       14423000
@09      EQU   09                                                       14424000
@10      EQU   10                                                       14425000
@11      EQU   11                                                       14426000
@12      EQU   12                                                       14427000
@13      EQU   13                                                       14428000
@14      EQU   14                                                       14429000
@15      EQU   15                                                       14430000
RTNREG   EQU   @15                                                      14431000
REG0     EQU   @00                                                      14432000
REG1     EQU   @01                                                      14433000
REG3     EQU   @03                                                      14434000
REG4     EQU   @04                                                      14435000
REG13    EQU   @13                                                      14436000
REG14    EQU   @14                                                      14437000
REG15    EQU   @15                                                      14438000
SDWAPTR  EQU   @04                                                      14439000
GPR00P   EQU   @00                                                      14440000
GPR01P   EQU   @01                                                      14441000
GPR01F   EQU   @01                                                      14442000
REG10    EQU   @10                                                      14443000
REG11    EQU   @11                                                      14444000
REG12    EQU   @12                                                      14445000
REG2     EQU   @02                                                      14446000
REG5     EQU   @05                                                      14447000
REG6     EQU   @06                                                      14448000
REG7     EQU   @07                                                      14449000
REG8     EQU   @08                                                      14450000
REG9     EQU   @09                                                      14451000
CVTPTR   EQU   16                                                       14452000
IDCSAEP0 EQU   0                                                        14453000
IDCSAGS0 EQU   0                                                        14454000
IDCSAFS0 EQU   0                                                        14455000
IDCSAST0 EQU   0                                                        14456000
TRACE1   EQU   0                                                        14457000
OLDERID1 EQU   TRACE1                                                   14458000
TRACE2   EQU   0                                                        14459000
OLDERID2 EQU   TRACE2                                                   14460000
NEWID2   EQU   TRACE2+95                                                14461000
NEWERID2 EQU   5                                                        14462000
CIRAGL   EQU   0                                                        14463000
CIRTYPE  EQU   CIRAGL                                                   14464000
ALLAGL   EQU   0                                                        14465000
ALLSTS   EQU   ALLAGL+24                                                14466000
ALLDSP   EQU   ALLAGL+25                                                14467000
ALLORG   EQU   ALLAGL+26                                                14468000
ALLOPT   EQU   ALLAGL+28                                                14469000
RACFAGL  EQU   0                                                        14470000
RACFFLG1 EQU   RACFAGL                                                  14471000
RACFFLG2 EQU   RACFAGL+1                                                14472000
RACFFLG3 EQU   RACFAGL+2                                                14473000
RACFFLG4 EQU   RACFAGL+3                                                14474000
UNITABL  EQU   0                                                        14475000
UNITADR  EQU   UNITABL+4                                                14476000
@NM00017 EQU   UNITADR                                                  14477000
UNITSTAT EQU   UNITABL+6                                                14478000
IOCSTR   EQU   0                                                        14479000
IOCDSO   EQU   IOCSTR+16                                                14480000
IOCRFM   EQU   IOCSTR+17                                                14481000
IOCMAC   EQU   IOCSTR+18                                                14482000
IOCMAC2  EQU   IOCSTR+19                                                14483000
IOCCHP   EQU   IOCSTR+20                                                14484000
IOCMSG   EQU   IOCSTR+21                                                14485000
IOCRBA   EQU   IOCSTR+40                                                14486000
IOCTTR   EQU   IOCRBA                                                   14487000
IOCMEM   EQU   IOCSTR+44                                                14488000
IOCNWM   EQU   IOCSTR+48                                                14489000
IOCREL   EQU   IOCSTR+60                                                14490000
IOCEXT   EQU   IOCSTR+64                                                14491000
OPNAGL   EQU   0                                                        14492000
OPNOPT   EQU   OPNAGL                                                   14493000
OPNRFM   EQU   OPNAGL+1                                                 14494000
OPNTYP   EQU   OPNAGL+2                                                 14495000
OPNMOD   EQU   OPNAGL+3                                                 14496000
OPNDEV   EQU   OPNAGL+24                                                14497000
OPNDSO   EQU   OPNAGL+41                                                14498000
OPNOPT2  EQU   OPNAGL+42                                                14499000
IOINFOPT EQU   0                                                        14500000
UVOLLIST EQU   0                                                        14501000
UVOLENT  EQU   UVOLLIST+2                                               14502000
AMSTP011 EQU   0                                                        14503000
DARGLIST EQU   0                                                        14504000
DARGDBP  EQU   DARGLIST                                                 14505000
DARGSTID EQU   DARGLIST+8                                               14506000
DARGSMOD EQU   DARGSTID                                                 14507000
DARGSENT EQU   DARGSTID+3                                               14508000
DARGILP  EQU   DARGLIST+12                                              14509000
DARGCNT  EQU   DARGLIST+14                                              14510000
DARGARY  EQU   DARGLIST+20                                              14511000
DARGINS  EQU   DARGARY                                                  14512000
DARGINL  EQU   DARGARY+2                                                14513000
DARGDTM  EQU   DARGARY+4                                                14514000
FMTLIST  EQU   0                                                        14515000
FMTFLGS  EQU   FMTLIST                                                  14516000
FMTSPF   EQU   FMTLIST+2                                                14517000
FMTRFNO  EQU   FMTSPF                                                   14518000
FMTILEN  EQU   FMTRFNO                                                  14519000
FMTIOFF  EQU   FMTLIST+4                                                14520000
FMTTRBC  EQU   FMTIOFF                                                  14521000
FMTSTO   EQU   FMTTRBC                                                  14522000
FMTOCOL  EQU   FMTLIST+6                                                14523000
FMTCNVF  EQU   FMTLIST+10                                               14524000
ERCNVTAB EQU   0                                                        14525000
ERTYPE   EQU   ERCNVTAB                                                 14526000
EROPER   EQU   ERCNVTAB+1                                               14527000
EROSOPER EQU   ERCNVTAB+2                                               14528000
ERCATRC  EQU   ERCNVTAB+16                                              14529000
ERCPLPT  EQU   ERCNVTAB+20                                              14530000
IDCDB010 EQU   0                                                        14531000
DMPITM   EQU   0                                                        14532000
DMPARY   EQU   0                                                        14533000
CCMSG    EQU   0                                                        14534000
CMMSG    EQU   0                                                        14535000
CMVOLFLG EQU   CMMSG+6                                                  14536000
CTMSG    EQU   0                                                        14537000
CTARRAY  EQU   CTMSG+4                                                  14538000
MDAGL    EQU   0                                                        14539000
MDFLAGS  EQU   MDAGL+30                                                 14540000
MDVTOC   EQU   MDAGL+32                                                 14541000
PUAGL    EQU   0                                                        14542000
CKAGL    EQU   0                                                        14543000
CKFLAGS  EQU   CKAGL+28                                                 14544000
EXCLAGL  EQU   0                                                        14545000
EXCLFLAG EQU   EXCLAGL+22                                               14546000
EXOARG   EQU   0                                                        14547000
EXODDN   EQU   EXOARG+8                                                 14548000
EXODSN   EQU   EXOARG+12                                                14549000
EXOVSN   EQU   EXOARG+16                                                14550000
EXOUCB   EQU   EXOARG+20                                                14551000
EXOEXT   EQU   EXOARG+24                                                14552000
EXOCTLBK EQU   EXOARG+28                                                14553000
EXOPT    EQU   EXOARG+32                                                14554000
EXOTAB   EQU   EXOPT                                                    14555000
EXOLAB   EQU   EXOPT                                                    14556000
EXOPASS  EQU   EXOPT                                                    14557000
EXONEW   EQU   EXOPT                                                    14558000
EXOVTOC  EQU   EXOPT                                                    14559000
EXOREP   EQU   EXOPT                                                    14560000
EXFLG    EQU   EXOARG+33                                                14561000
EXOREAD  EQU   EXFLG                                                    14562000
EXORVS   EQU   EXFLG                                                    14563000
EXOSPK   EQU   EXFLG                                                    14564000
EXORDS   EQU   EXFLG                                                    14565000
EXORVT   EQU   EXFLG                                                    14566000
EXOVTH   EQU   EXFLG                                                    14567000
EXGARG   EQU   0                                                        14568000
EXGCTLBK EQU   EXGARG+8                                                 14569000
EXGCCHH1 EQU   EXGARG+12                                                14570000
EXGCCHH2 EQU   EXGARG+16                                                14571000
EXGRECNO EQU   EXGARG+20                                                14572000
EXGDATAP EQU   EXGARG+24                                                14573000
EXGKEYLN EQU   EXGARG+28                                                14574000
EXGDATAL EQU   EXGARG+30                                                14575000
EXWRARG  EQU   0                                                        14576000
EXRWCTBL EQU   EXWRARG+8                                                14577000
EXRWIOAR EQU   EXWRARG+12                                               14578000
EXLOCPTR EQU   EXWRARG+20                                               14579000
EXCCWCNT EQU   EXWRARG+24                                               14580000
EXRWCHR  EQU   EXWRARG+26                                               14581000
EXCC     EQU   EXRWCHR                                                  14582000
EXHH     EQU   EXRWCHR+2                                                14583000
EXRECNUM EQU   EXRWCHR+4                                                14584000
EXRWKDLN EQU   EXWRARG+32                                               14585000
EXSPACE  EQU   EXWRARG+36                                               14586000
EXRWFUN  EQU   EXWRARG+46                                               14587000
EXPARG   EQU   0                                                        14588000
EXPCTLBK EQU   EXPARG+8                                                 14589000
EXPDATA  EQU   EXPARG+12                                                14590000
EXPCCHHR EQU   EXPARG+16                                                14591000
EXPDATAB EQU   0                                                        14592000
EXPRECNO EQU   EXPDATAB                                                 14593000
EXPARRAY EQU   EXPDATAB+4                                               14594000
EXPDATAP EQU   EXPARRAY                                                 14595000
EXPKEYLN EQU   EXPARRAY+4                                               14596000
EXPDATAL EQU   EXPARRAY+6                                               14597000
VS2AGL   EQU   0                                                        14598000
VSLABOPT EQU   VS2AGL+28                                                14599000
VS2MSG   EQU   VS2AGL+35                                                14600000
VS2RESOP EQU   VS2AGL+36                                                14601000
VS1AGL   EQU   0                                                        14602000
VSSECOPT EQU   VS1AGL+68                                                14603000
VSVTOPT  EQU   VS1AGL+69                                                14604000
VSCATOPT EQU   VS1AGL+70                                                14605000
VSRETURN EQU   VS1AGL+71                                                14606000
VSMSG    EQU   VS1AGL+72                                                14607000
VSRESOPT EQU   VS1AGL+73                                                14608000
RCTAGL   EQU   0                                                        14609000
RCTOPT   EQU   RCTAGL+8                                                 14610000
STAEPARM EQU   0                                                        14611000
STARTSAV EQU   STAEPARM+36                                              14612000
STARTADD EQU   STAEPARM+44                                              14613000
STARCVY  EQU   STAEPARM+52                                              14614000
STARETRY EQU   STAEPARM+53                                              14615000
STAIO05  EQU   STARETRY                                                 14616000
STAOFF   EQU   STARETRY                                                 14617000
STAVTOC  EQU   STARETRY                                                 14618000
VOLLABEL EQU   0                                                        14619000
SV82LIST EQU   0                                                        14620000
SV82CODE EQU   SV82LIST                                                 14621000
SV82UCBP EQU   SV82LIST+1                                               14622000
@NM00073 EQU   SV82LIST+4                                               14623000
SV82DCBP EQU   @NM00073                                                 14624000
@NM00074 EQU   SV82LIST+12                                              14625000
SV82WRKP EQU   @NM00074                                                 14626000
SV82DEBP EQU   SV82WRKP                                                 14627000
SRTAGL   EQU   0                                                        14628000
LCTINFO  EQU   0                                                        14629000
LCTFLAGS EQU   LCTINFO+32                                               14630000
UCTAGL   EQU   0                                                        14631000
UCTFLAGS EQU   UCTAGL+68                                                14632000
SELAGL   EQU   0                                                        14633000
SELFLAGS EQU   SELAGL+22                                                14634000
DATESAGL EQU   0                                                        14635000
DATESOPT EQU   DATESAGL+20                                              14636000
VS3AGL   EQU   0                                                        14637000
VS3FLAGS EQU   VS3AGL+58                                                14638000
VSDVTOC  EQU   0                                                        14639000
VSDSTAT  EQU   0                                                        14640000
VSDSFLG1 EQU   VSDSTAT+16                                               14641000
VSDFLG2  EQU   VSDSTAT+17                                               14642000
VSDSCR   EQU   0                                                        14643000
VSDSCRFL EQU   VSDSCR+4                                                 14644000
VSDUSAGE EQU   0                                                        14645000
VSDDORG  EQU   VSDUSAGE+9                                               14646000
VSDALLOC EQU   VSDUSAGE+10                                              14647000
VSDUSEF  EQU   VSDUSAGE+11                                              14648000
VSDDSORG EQU   VSDUSAGE+16                                              14649000
VSDBLOCK EQU   0                                                        14650000
VSDSPACE EQU   VSDBLOCK+12                                              14651000
VSDARRAY EQU   VSDBLOCK+16                                              14652000
VSDVARY  EQU   VSDARRAY+48                                              14653000
IODATA   EQU   0                                                        14654000
IODSID   EQU   IODATA+16                                                14655000
IODIOX   EQU   IODATA+52                                                14656000
IOCSEX   EQU   0                                                        14657000
IOCRPL   EQU   IOCSEX+4                                                 14658000
IOCXAD   EQU   IOCSEX+16                                                14659000
IOCXPM   EQU   IOCSEX+20                                                14660000
IOCFLG   EQU   IOCSEX+32                                                14661000
IOCDEV   EQU   IOCSEX+33                                                14662000
IOCINF   EQU   IOCSEX+34                                                14663000
IOCMOD   EQU   IOCSEX+35                                                14664000
IOCRCV   EQU   IOCSEX+44                                                14665000
SAHIST   EQU   0                                                        14666000
AUTOPTR  EQU   SAHIST+8                                                 14667000
SAHSTA   EQU   SAHIST+12                                                14668000
AUTOTBL  EQU   0                                                        14669000
AUTOARAY EQU   AUTOTBL                                                  14670000
UCB      EQU   0                                                        14671000
UCBOB    EQU   0                                                        14672000
UCBJBNR  EQU   UCBOB                                                    14673000
UCBFL5   EQU   UCBOB+1                                                  14674000
UCBAF    EQU   UCBFL5                                                   14675000
UCBSTAT  EQU   UCBOB+3                                                  14676000
UCBCHAN  EQU   UCBOB+4                                                  14677000
UCBSFLS  EQU   UCBOB+6                                                  14678000
UCBFLA   EQU   UCBSFLS                                                  14679000
UCBFL1   EQU   UCBFLA                                                   14680000
UCBBSY   EQU   UCBFL1                                                   14681000
UCBNRY   EQU   UCBFL1                                                   14682000
UCBPST   EQU   UCBFL1                                                   14683000
UCBCUB   EQU   UCBFL1                                                   14684000
UCBFLB   EQU   UCBSFLS+1                                                14685000
UCBCHM   EQU   UCBOB+8                                                  14686000
UCBCHM1  EQU   UCBCHM                                                   14687000
UCBPTH0  EQU   UCBCHM1                                                  14688000
UCBPTH1  EQU   UCBCHM1                                                  14689000
UCBWGT   EQU   UCBOB+12                                                 14690000
UCBTYP   EQU   UCBOB+16                                                 14691000
UCBTBYT1 EQU   UCBTYP                                                   14692000
UCB1FEA5 EQU   UCBTBYT1                                                 14693000
UCB1FEA6 EQU   UCBTBYT1                                                 14694000
UCBTBYT2 EQU   UCBTYP+1                                                 14695000
UCB2OPT2 EQU   UCBTBYT2                                                 14696000
UCBDUDN1 EQU   UCB2OPT2                                                 14697000
UCB2OPT3 EQU   UCBTBYT2                                                 14698000
UCBDUDN2 EQU   UCB2OPT3                                                 14699000
UCB2OPT4 EQU   UCBTBYT2                                                 14700000
UCBRWTAU EQU   UCB2OPT4                                                 14701000
UCB2OPT6 EQU   UCBTBYT2                                                 14702000
UCB2OPT7 EQU   UCBTBYT2                                                 14703000
UCBTBYT3 EQU   UCBTYP+2                                                 14704000
UCBDVCLS EQU   UCBTBYT3                                                 14705000
UCBTBYT4 EQU   UCBTYP+3                                                 14706000
UCBEXTPT EQU   UCBOB+20                                                 14707000
UCBFLC   EQU   UCBEXTPT                                                 14708000
UCBDEV   EQU   UCBOB+24                                                 14709000
UCBCMEXT EQU   0                                                        14710000
UCBATI   EQU   UCBCMEXT+3                                               14711000
@NM00104 EQU   UCBATI                                                   14712000
UCBFLP1  EQU   UCBCMEXT+5                                               14713000
UCBMT    EQU   0                                                        14714000
UCBOCR   EQU   0                                                        14715000
UCB3540X EQU   0                                                        14716000
UCBDKBYT EQU   UCB3540X+6                                               14717000
UCB3800X EQU   0                                                        14718000
UCBOPTNS EQU   UCB3800X                                                 14719000
UCBACTIV EQU   UCB3800X+3                                               14720000
UCBMDRBF EQU   UCB3800X+36                                              14721000
UCBUCS   EQU   0                                                        14722000
UCBUCSOP EQU   UCBUCS+4                                                 14723000
UCBFCBOP EQU   UCBUCS+5                                                 14724000
IHADCB   EQU   0                                                        14725000
IHADCS00 EQU   0                                                        14726000
DCBFDAD  EQU   IHADCS00+5                                               14727000
IHADCS01 EQU   0                                                        14728000
DCBDVTBL EQU   IHADCS01                                                 14729000
IHADCS11 EQU   0                                                        14730000
DCBRELB  EQU   IHADCS11                                                 14731000
DCBREL   EQU   DCBRELB+1                                                14732000
DCBBUFCB EQU   IHADCS11+4                                               14733000
DCBDSORG EQU   IHADCS11+10                                              14734000
DCBDSRG1 EQU   DCBDSORG                                                 14735000
DCBDSRG2 EQU   DCBDSORG+1                                               14736000
DCBIOBAD EQU   IHADCS11+12                                              14737000
DCBODEB  EQU   DCBIOBAD                                                 14738000
DCBLNP   EQU   DCBODEB                                                  14739000
DCBQSLM  EQU   DCBLNP                                                   14740000
DCBIOBAA EQU   DCBODEB+1                                                14741000
IHADCS50 EQU   0                                                        14742000
DCBSVCXL EQU   IHADCS50                                                 14743000
DCBEODAD EQU   IHADCS50+4                                               14744000
DCBBFALN EQU   DCBEODAD                                                 14745000
DCBHIARC EQU   DCBBFALN                                                 14746000
DCBBFTEK EQU   DCBHIARC                                                 14747000
DCBBFT   EQU   DCBBFTEK                                                 14748000
DCBEXLST EQU   IHADCS50+8                                               14749000
DCBRECFM EQU   DCBEXLST                                                 14750000
DCBRECLA EQU   DCBRECFM                                                 14751000
DCBEXLSA EQU   DCBEXLST+1                                               14752000
IHADCS24 EQU   0                                                        14753000
DCBDDNAM EQU   IHADCS24                                                 14754000
DCBOFLGS EQU   IHADCS24+8                                               14755000
DCBOFLWR EQU   DCBOFLGS                                                 14756000
DCBOFOPN EQU   DCBOFLGS                                                 14757000
DCBIFLG  EQU   IHADCS24+9                                               14758000
DCBIBPCT EQU   DCBIFLG                                                  14759000
DCBMACR  EQU   IHADCS24+10                                              14760000
DCBMACR1 EQU   DCBMACR                                                  14761000
DCBMRFE  EQU   DCBMACR1                                                 14762000
DCBMRGET EQU   DCBMRFE                                                  14763000
DCBMRAPG EQU   DCBMACR1                                                 14764000
DCBMRRD  EQU   DCBMRAPG                                                 14765000
DCBMRCI  EQU   DCBMACR1                                                 14766000
DCBMRMVG EQU   DCBMRCI                                                  14767000
DCBMRLCG EQU   DCBMACR1                                                 14768000
DCBMRABC EQU   DCBMACR1                                                 14769000
DCBMRPT1 EQU   DCBMRABC                                                 14770000
DCBMRSBG EQU   DCBMRPT1                                                 14771000
DCBMRCRL EQU   DCBMACR1                                                 14772000
DCBMRCHK EQU   DCBMRCRL                                                 14773000
DCBMRRDX EQU   DCBMRCHK                                                 14774000
DCBMRDMG EQU   DCBMACR1                                                 14775000
DCBMACR2 EQU   DCBMACR+1                                                14776000
DCBMRPUT EQU   DCBMACR2                                                 14777000
DCBMRWRT EQU   DCBMACR2                                                 14778000
DCBMRMVP EQU   DCBMACR2                                                 14779000
DCBMR5WD EQU   DCBMACR2                                                 14780000
DCBMRLDM EQU   DCBMR5WD                                                 14781000
DCBMRLCP EQU   DCBMRLDM                                                 14782000
DCBMR4WD EQU   DCBMACR2                                                 14783000
DCBMRPT2 EQU   DCBMR4WD                                                 14784000
DCBMRTMD EQU   DCBMRPT2                                                 14785000
DCBMR3WD EQU   DCBMACR2                                                 14786000
DCBMRCTL EQU   DCBMR3WD                                                 14787000
DCBMRSTK EQU   DCBMRCTL                                                 14788000
DCBMR1WD EQU   DCBMACR2                                                 14789000
DCBMRSWA EQU   DCBMR1WD                                                 14790000
DCBMRDMD EQU   DCBMRSWA                                                 14791000
IHADCS25 EQU   0                                                        14792000
DCBMACRF EQU   IHADCS25+2                                               14793000
DCBMACF1 EQU   DCBMACRF                                                 14794000
DCBMFFE  EQU   DCBMACF1                                                 14795000
DCBMFGET EQU   DCBMFFE                                                  14796000
DCBMFAPG EQU   DCBMACF1                                                 14797000
DCBMFRD  EQU   DCBMFAPG                                                 14798000
DCBMFCI  EQU   DCBMACF1                                                 14799000
DCBMFMVG EQU   DCBMFCI                                                  14800000
DCBMFLCG EQU   DCBMACF1                                                 14801000
DCBMFABC EQU   DCBMACF1                                                 14802000
DCBMFPT1 EQU   DCBMFABC                                                 14803000
DCBMFSBG EQU   DCBMFPT1                                                 14804000
DCBMFCRL EQU   DCBMACF1                                                 14805000
DCBMFCHK EQU   DCBMFCRL                                                 14806000
DCBMFDMG EQU   DCBMACF1                                                 14807000
DCBMACF2 EQU   DCBMACRF+1                                               14808000
DCBMFPUT EQU   DCBMACF2                                                 14809000
DCBMFWRT EQU   DCBMACF2                                                 14810000
DCBMFMVP EQU   DCBMACF2                                                 14811000
DCBMF5WD EQU   DCBMACF2                                                 14812000
DCBMFLDM EQU   DCBMF5WD                                                 14813000
DCBMFLCP EQU   DCBMFLDM                                                 14814000
DCBMF4WD EQU   DCBMACF2                                                 14815000
DCBMFPT2 EQU   DCBMF4WD                                                 14816000
DCBMFTMD EQU   DCBMFPT2                                                 14817000
DCBMF3WD EQU   DCBMACF2                                                 14818000
DCBMFCTL EQU   DCBMF3WD                                                 14819000
DCBMFSTK EQU   DCBMFCTL                                                 14820000
DCBMF1WD EQU   DCBMACF2                                                 14821000
DCBMFSWA EQU   DCBMF1WD                                                 14822000
DCBMFDMD EQU   DCBMFSWA                                                 14823000
DCBDEBAD EQU   IHADCS25+4                                               14824000
DCBIFLGS EQU   DCBDEBAD                                                 14825000
DCBIFEC  EQU   DCBIFLGS                                                 14826000
DCBIFPCT EQU   DCBIFLGS                                                 14827000
IHADCS28 EQU   0                                                        14828000
DCBOPTCD EQU   IHADCS28                                                 14829000
DCBOPTZ  EQU   DCBOPTCD                                                 14830000
IHADCS44 EQU   0                                                        14831000
INFMJFCB EQU   0                                                        14832000
JFCBDSNM EQU   INFMJFCB                                                 14833000
JFCBELNM EQU   INFMJFCB+44                                              14834000
JFCBTSDM EQU   INFMJFCB+52                                              14835000
JFCVSL   EQU   JFCBTSDM                                                 14836000
JFCNWRIT EQU   JFCBTSDM                                                 14837000
JFCFCBID EQU   INFMJFCB+56                                              14838000
JFCBFRID EQU   JFCFCBID                                                 14839000
JFCBLTYP EQU   INFMJFCB+66                                              14840000
JFCBOTTR EQU   INFMJFCB+67                                              14841000
JFCBUFOF EQU   JFCBOTTR                                                 14842000
JFCBFLSQ EQU   JFCBOTTR+1                                               14843000
JFCFUNC  EQU   JFCBFLSQ                                                 14844000
JFCBMASK EQU   INFMJFCB+72                                              14845000
JFCBFLG1 EQU   JFCBMASK+5                                               14846000
JFCOPEN  EQU   JFCBFLG1                                                 14847000
JFCBFLG2 EQU   JFCBMASK+6                                               14848000
JFCDEFER EQU   JFCBFLG2                                                 14849000
JFCBIND1 EQU   INFMJFCB+86                                              14850000
JFCBIND2 EQU   INFMJFCB+87                                              14851000
JFCAMPTR EQU   INFMJFCB+88                                              14852000
JFCBUFRQ EQU   JFCAMPTR                                                 14853000
JFCBUFNO EQU   JFCBUFRQ                                                 14854000
JFCBGNCP EQU   JFCAMPTR+1                                               14855000
JFCBHIAR EQU   JFCBGNCP                                                 14856000
JFCBFALN EQU   JFCBHIAR                                                 14857000
JFCBFTEK EQU   JFCBFALN                                                 14858000
JFCBBFTA EQU   JFCBFTEK                                                 14859000
JFCEROPT EQU   INFMJFCB+92                                              14860000
JFCTRTCH EQU   INFMJFCB+93                                              14861000
JFCBX    EQU   0                                                        14862000
DEBBASIC EQU   0                                                        14863000
DEBTCBAD EQU   DEBBASIC                                                 14864000
DEBDEBAD EQU   DEBBASIC+4                                               14865000
DEBIRBAD EQU   DEBBASIC+8                                               14866000
DEBOFLGS EQU   DEBIRBAD                                                 14867000
DEBOPATB EQU   DEBBASIC+12                                              14868000
DEBFLGS1 EQU   DEBBASIC+14                                              14869000
DEBUSRPG EQU   DEBBASIC+16                                              14870000
DEBRRQ   EQU   DEBBASIC+20                                              14871000
DEBECBAD EQU   DEBRRQ                                                   14872000
DEBDCBAD EQU   DEBBASIC+24                                              14873000
DEBPROTG EQU   DEBDCBAD                                                 14874000
DEBAPPAD EQU   DEBBASIC+28                                              14875000
DEBEXSCL EQU   DEBAPPAD                                                 14876000
DEBBASND EQU   DEBBASIC+32                                              14877000
DEBDASD  EQU   0                                                        14878000
DEBUCBAD EQU   DEBDASD                                                  14879000
DEBDVMOD EQU   DEBUCBAD                                                 14880000
DEBSTRCC EQU   DEBDASD+6                                                14881000
DEBSTRHH EQU   DEBDASD+8                                                14882000
DEBENDCC EQU   DEBDASD+10                                               14883000
DEBENDHH EQU   DEBDASD+12                                               14884000
DEBNMTRK EQU   DEBDASD+14                                               14885000
DEBACSMD EQU   0                                                        14886000
DEBVOLSQ EQU   DEBACSMD                                                 14887000
DEBVOLBT EQU   DEBVOLSQ                                                 14888000
DEBDSNM  EQU   DEBACSMD+4                                               14889000
DEBUTSAA EQU   DEBDSNM                                                  14890000
DEBACS01 EQU   0                                                        14891000
DEBDSNAM EQU   DEBACS01                                                 14892000
DEBACS02 EQU   0                                                        14893000
DEBDBLK  EQU   DEBACS02                                                 14894000
DEBACS03 EQU   0                                                        14895000
DEBACS04 EQU   0                                                        14896000
DEBTBFRA EQU   DEBACS04                                                 14897000
DEBTCCWA EQU   DEBACS04+4                                               14898000
DEBACS05 EQU   0                                                        14899000
DEBFUCBA EQU   DEBACS05                                                 14900000
DEBLUCBA EQU   DEBACS05+4                                               14901000
DEBACS06 EQU   0                                                        14902000
DEBACS07 EQU   0                                                        14903000
DEBACS08 EQU   0                                                        14904000
DEBSUBNM EQU   0                                                        14905000
DEB      EQU   0                                                        14906000
DEBAVT   EQU   DEB                                                      14907000
DEBEOEA  EQU   DEBAVT                                                   14908000
DEBEOEAB EQU   DEBEOEA                                                  14909000
DEBSIOA  EQU   DEBAVT+4                                                 14910000
DEBSIOAB EQU   DEBSIOA                                                  14911000
DEBPCIA  EQU   DEBAVT+8                                                 14912000
DEBPCIAB EQU   DEBPCIA                                                  14913000
DEBCEA   EQU   DEBAVT+12                                                14914000
DEBCEAB  EQU   DEBCEA                                                   14915000
DEBXCEA  EQU   DEBAVT+16                                                14916000
DEBXCEAB EQU   DEBXCEA                                                  14917000
DEBXCEAD EQU   DEBXCEA+1                                                14918000
DEBPREFX EQU   DEB+20                                                   14919000
DEBXTNP  EQU   DEBPREFX+8                                               14920000
DEBXTN   EQU   0                                                        14921000
DEBXFLG1 EQU   DEBXTN+2                                                 14922000
IOBPREFX EQU   0                                                        14923000
IOBCFLG1 EQU   IOBPREFX                                                 14924000
IOBSTDRD EQU   0                                                        14925000
IOBFLAG1 EQU   IOBSTDRD                                                 14926000
IOBCMDCH EQU   IOBFLAG1                                                 14927000
IOBCYCCK EQU   IOBFLAG1                                                 14928000
IOBRSTRT EQU   IOBFLAG1                                                 14929000
IOBFLAG2 EQU   IOBSTDRD+1                                               14930000
IOBPURGE EQU   IOBFLAG2                                                 14931000
IOBRDHA0 EQU   IOBFLAG2                                                 14932000
IOBSENS0 EQU   IOBSTDRD+2                                               14933000
IOBS0B7  EQU   IOBSENS0                                                 14934000
IOBSENS1 EQU   IOBSTDRD+3                                               14935000
IOBECBPT EQU   IOBSTDRD+4                                               14936000
IOBFLAG3 EQU   IOBSTDRD+8                                               14937000
IOBFL3   EQU   IOBFLAG3                                                 14938000
IOBCNC   EQU   IOBFL3                                                   14939000
IOBICL   EQU   IOBFL3                                                   14940000
IOBCSW   EQU   IOBSTDRD+9                                               14941000
IOBIOCSW EQU   IOBCSW                                                   14942000
IOBCMDA  EQU   IOBIOCSW                                                 14943000
IOBSTBYT EQU   IOBIOCSW+3                                               14944000
IOBUSTAT EQU   IOBSTBYT                                                 14945000
IOBCSTAT EQU   IOBSTBYT+1                                               14946000
IOBSTART EQU   IOBSTDRD+16                                              14947000
IOBDCBPT EQU   IOBSTDRD+20                                              14948000
IOBFLAG4 EQU   IOBDCBPT                                                 14949000
IOBRESTR EQU   IOBSTDRD+24                                              14950000
IOBINCAM EQU   IOBSTDRD+28                                              14951000
IOBBTAMF EQU   IOBINCAM                                                 14952000
ECB      EQU   0                                                        14953000
ECBRB    EQU   ECB                                                      14954000
ECBEVTB  EQU   ECBRB                                                    14955000
ECBEXTB  EQU   ECBEVTB                                                  14956000
ECBCC    EQU   ECBEXTB                                                  14957000
ECBPOSTB EQU   ECBCC                                                    14958000
ECBCCCNT EQU   ECBEXTB+1                                                14959000
ECBRBA   EQU   ECBCCCNT                                                 14960000
ECBEVTBA EQU   ECBRBA                                                   14961000
ECBEXTBA EQU   ECBEVTBA                                                 14962000
ECBBYTE3 EQU   ECBEXTBA+2                                               14963000
ECBEXTND EQU   ECBBYTE3                                                 14964000
SDWA     EQU   0                                                        14965000
SDWAPARM EQU   SDWA                                                     14966000
SDWAFIOB EQU   SDWA+4                                                   14967000
SDWAABCC EQU   SDWAFIOB                                                 14968000
SDWACMPF EQU   SDWAABCC                                                 14969000
SDWACTL1 EQU   SDWA+8                                                   14970000
SDWACMKA EQU   SDWACTL1                                                 14971000
SDWAMWPA EQU   SDWACTL1+1                                               14972000
SDWAPMKA EQU   SDWACTL1+4                                               14973000
SDWACTL2 EQU   SDWA+16                                                  14974000
SDWACMKP EQU   SDWACTL2                                                 14975000
SDWAMWPP EQU   SDWACTL2+1                                               14976000
SDWAPMKP EQU   SDWACTL2+4                                               14977000
SDWAGRSV EQU   SDWA+24                                                  14978000
SDWAGR15 EQU   SDWAGRSV+60                                              14979000
SDWANAME EQU   SDWA+88                                                  14980000
SDWAEC1  EQU   SDWA+104                                                 14981000
SDWAEMK1 EQU   SDWAEC1                                                  14982000
SDWAMWP1 EQU   SDWAEC1+1                                                14983000
SDWAINT1 EQU   SDWAEC1+2                                                14984000
SDWANXT1 EQU   SDWAEC1+4                                                14985000
SDWAAEC1 EQU   SDWA+112                                                 14986000
SDWAILC1 EQU   SDWAAEC1+1                                               14987000
SDWAINC1 EQU   SDWAAEC1+2                                               14988000
SDWAICD1 EQU   SDWAINC1+1                                               14989000
SDWAEC2  EQU   SDWA+120                                                 14990000
SDWAEMK2 EQU   SDWAEC2                                                  14991000
SDWAMWP2 EQU   SDWAEC2+1                                                14992000
SDWAINT2 EQU   SDWAEC2+2                                                14993000
SDWANXT2 EQU   SDWAEC2+4                                                14994000
SDWAAEC2 EQU   SDWA+128                                                 14995000
SDWAILC2 EQU   SDWAAEC2+1                                               14996000
SDWAINC2 EQU   SDWAAEC2+2                                               14997000
SDWAICD2 EQU   SDWAINC2+1                                               14998000
SDWASRSV EQU   SDWA+136                                                 14999000
SDWAIDNT EQU   SDWA+200                                                 15000000
SDWAMCH  EQU   SDWA+204                                                 15001000
SDWASTCK EQU   SDWAMCH                                                  15002000
SDWAMCHI EQU   SDWAMCH+8                                                15003000
SDWAMCHS EQU   SDWAMCHI                                                 15004000
SDWAMCHD EQU   SDWAMCHI+1                                               15005000
SDWARSR1 EQU   SDWAMCH+12                                               15006000
SDWARSR2 EQU   SDWAMCH+13                                               15007000
SDWAFLGS EQU   SDWA+232                                                 15008000
SDWAERRA EQU   SDWAFLGS                                                 15009000
SDWAERRB EQU   SDWAFLGS+1                                               15010000
SDWAERRC EQU   SDWAFLGS+2                                               15011000
SDWAERRD EQU   SDWAFLGS+3                                               15012000
SDWAIOFS EQU   SDWA+238                                                 15013000
SDWACPUA EQU   SDWA+248                                                 15014000
SDWAPARQ EQU   SDWA+252                                                 15015000
SDWAACF2 EQU   SDWAPARQ+1                                               15016000
SDWAACF3 EQU   SDWAPARQ+2                                               15017000
SDWAACF4 EQU   SDWAPARQ+3                                               15018000
SDWALKWA EQU   SDWA+256                                                 15019000
SDWALKWS EQU   SDWALKWA                                                 15020000
SDWARECP EQU   SDWA+292                                                 15021000
SDWASNPA EQU   SDWA+320                                                 15022000
SDWADUMP EQU   SDWASNPA                                                 15023000
SDWADPFS EQU   SDWADUMP+1                                               15024000
SDWADDAT EQU   SDWASNPA+4                                               15025000
SDWASDAT EQU   SDWADDAT                                                 15026000
SDWAPDAT EQU   SDWADDAT+2                                               15027000
SDWADPSA EQU   SDWA+328                                                 15028000
SDWADPSL EQU   SDWADPSA                                                 15029000
SDWARA   EQU   SDWA+400                                                 15030000
SDWADPVA EQU   SDWARA+2                                                 15031000
CVTMAP   EQU   0                                                        15032000
CVTDAR   EQU   CVTMAP+72                                                15033000
CVTFLGS1 EQU   CVTDAR                                                   15034000
CVTDCB   EQU   CVTMAP+116                                               15035000
CVTIOQET EQU   CVTMAP+120                                               15036000
CVTIERLC EQU   CVTMAP+144                                               15037000
CVTHEAD  EQU   CVTMAP+160                                               15038000
CVTSV76C EQU   CVTHEAD                                                  15039000
CVTOPTA  EQU   CVTMAP+182                                               15040000
CVTOPTB  EQU   CVTMAP+183                                               15041000
CVTGTF   EQU   CVTMAP+236                                               15042000
CVTGTFST EQU   CVTGTF                                                   15043000
CVTGTFS  EQU   CVTGTFST                                                 15044000
CVTSTATE EQU   CVTGTFST                                                 15045000
CVTTMODE EQU   CVTGTFST                                                 15046000
CVTFORM  EQU   CVTGTFST                                                 15047000
CVTAQAVT EQU   CVTMAP+240                                               15048000
CVTTCMFG EQU   CVTAQAVT                                                 15049000
CVTVOLM2 EQU   CVTMAP+244                                               15050000
CVTTATA  EQU   CVTVOLM2                                                 15051000
CVTTSKS  EQU   CVTTATA                                                  15052000
CVTVOLF2 EQU   CVTTSKS                                                  15053000
CVTTAT   EQU   CVTTATA+1                                                15054000
CVTATER  EQU   CVTMAP+248                                               15055000
CVTEXT1  EQU   CVTMAP+252                                               15056000
CVTPURG  EQU   CVTMAP+260                                               15057000
CVTQMSG  EQU   CVTMAP+268                                               15058000
CVTDMSR  EQU   CVTMAP+272                                               15059000
CVTRSV37 EQU   CVTDMSR                                                  15060000
CVTDMSRF EQU   CVTRSV37                                                 15061000
CVTERPV  EQU   CVTMAP+316                                               15062000
CVTINTLA EQU   CVTMAP+320                                               15063000
CVTAPF   EQU   CVTMAP+324                                               15064000
CVTEXT2  EQU   CVTMAP+328                                               15065000
CVTHJES  EQU   CVTMAP+332                                               15066000
CVTPGSIA EQU   CVTMAP+348                                               15067000
CVTA1F1  EQU   CVTMAP+356                                               15068000
CVTSYSK  EQU   CVTMAP+357                                               15069000
CVTVOLM1 EQU   CVTMAP+380                                               15070000
CVTVOLF1 EQU   CVTVOLM1                                                 15071000
CVTATMCT EQU   CVTMAP+388                                               15072000
CVTXTNT1 EQU   0                                                        15073000
CVTXTNT2 EQU   0                                                        15074000
CVTDSSV  EQU   CVTXTNT2                                                 15075000
CVTFLGBT EQU   CVTXTNT2+5                                               15076000
CVTQID   EQU   CVTXTNT2+24                                              15077000
CVTRV400 EQU   CVTXTNT2+52                                              15078000
CVTRV409 EQU   CVTXTNT2+53                                              15079000
CVTATCVT EQU   CVTXTNT2+64                                              15080000
CVTRV429 EQU   CVTXTNT2+84                                              15081000
CVTRV438 EQU   CVTXTNT2+85                                              15082000
CVTRV457 EQU   CVTXTNT2+112                                             15083000
CVTRV466 EQU   CVTXTNT2+113                                             15084000
CVTFIX   EQU   0                                                        15085000
CVTRELNO EQU   CVTFIX+252                                               15086000
LOCTAB   EQU   0                                                        15087000
LOCADDR  EQU   LOCTAB                                                   15088000
LOCRCNT  EQU   LOCTAB+4                                                 15089000
LOCRCKD  EQU   LOCTAB+6                                                 15090000
LOCCNTFD EQU   LOCTAB+8                                                 15091000
LOCKLEN  EQU   LOCTAB+17                                                15092000
LOCDLEN  EQU   LOCTAB+18                                                15093000
RIOAREA  EQU   0                                                        15094000
RIOHDR   EQU   RIOAREA                                                  15095000
RFIRST   EQU   RIOHDR                                                   15096000
RPREV    EQU   RIOHDR+2                                                 15097000
RNUMREC  EQU   RIOHDR+8                                                 15098000
RBUFF    EQU   RIOAREA+282                                              15099000
RKEY     EQU   0                                                        15100000
RKEYCHR  EQU   RKEY+6                                                   15101000
RKEYFLG  EQU   RKEY+11                                                  15102000
RBUF     EQU   0                                                        15103000
RBUFCNT  EQU   RBUF                                                     15104000
RBCCHHR  EQU   RBUFCNT                                                  15105000
RBREC    EQU   RBCCHHR+4                                                15106000
RBKL     EQU   RBUFCNT+5                                                15107000
RBDL     EQU   RBUFCNT+6                                                15108000
WIOAREA  EQU   0                                                        15109000
WNUMREC  EQU   WIOAREA                                                  15110000
WBUFF    EQU   WIOAREA+4                                                15111000
WBUF     EQU   0                                                        15112000
WBUFCNT  EQU   WBUF                                                     15113000
WBCCHHR  EQU   WBUFCNT                                                  15114000
WBKL     EQU   WBUFCNT+5                                                15115000
WBDL     EQU   WBUFCNT+6                                                15116000
WKEYDAT  EQU   WBUF+8                                                   15117000
IOXCTLBK EQU   0                                                        15118000
IOCTLBK  EQU   IOXCTLBK                                                 15119000
IOXCHAIN EQU   IOCTLBK                                                  15120000
IOXID    EQU   IOCTLBK+4                                                15121000
IOXWRITE EQU   IOCTLBK+12                                               15122000
IOXREADS EQU   IOCTLBK+16                                               15123000
IOXACODE EQU   IOCTLBK+20                                               15124000
IOXRCODE EQU   IOCTLBK+22                                               15125000
IOXTYPE  EQU   IOCTLBK+24                                               15126000
IOXFLGS  EQU   IOCTLBK+25                                               15127000
IOXOPN   EQU   IOXFLGS                                                  15128000
IOXABEND EQU   IOXFLGS                                                  15129000
IOXCLOSE EQU   IOXFLGS                                                  15130000
IOXSYNAD EQU   IOXFLGS                                                  15131000
IOXDDN   EQU   IOCTLBK+28                                               15132000
IOXDCBID EQU   IOCTLBK+36                                               15133000
IOXDCB   EQU   IOCTLBK+40                                               15134000
IOXECBID EQU   IOCTLBK+112                                              15135000
IOXECB   EQU   IOCTLBK+116                                              15136000
IOXIOBID EQU   IOCTLBK+120                                              15137000
IOXIOB   EQU   IOCTLBK+124                                              15138000
IOXJFCBI EQU   IOCTLBK+164                                              15139000
IOXJFCB  EQU   IOCTLBK+168                                              15140000
IOXEXID  EQU   IOCTLBK+368                                              15141000
IOXEXLST EQU   IOCTLBK+372                                              15142000
IOXJFCBP EQU   IOXEXLST+1                                               15143000
IOXUCBP  EQU   IOCTLBK+380                                              15144000
IOXCCWID EQU   IOXCTLBK+384                                             15145000
IOXCCWS  EQU   IOXCTLBK+392                                             15146000
IOXCCW   EQU   IOXCCWS                                                  15147000
IOXCNTS  EQU   IOXCTLBK+1392                                            15148000
IOXCOUNT EQU   IOXCNTS                                                  15149000
USERIOBP EQU   0                                                        15150000
USERCCHH EQU   0                                                        15151000
USERDDN  EQU   0                                                        15152000
VOLLAB   EQU   0                                                        15153000
RTNEXTS  EQU   0                                                        15154000
BEGCC    EQU   RTNEXTS                                                  15155000
BEGHH    EQU   RTNEXTS+2                                                15156000
BEGR     EQU   RTNEXTS+4                                                15157000
ENDCC    EQU   RTNEXTS+5                                                15158000
ENDHH    EQU   RTNEXTS+7                                                15159000
VSMEXTS  EQU   0                                                        15160000
VSMBCC   EQU   VSMEXTS                                                  15161000
VSMBHH   EQU   VSMEXTS+2                                                15162000
VSMECC   EQU   VSMEXTS+8                                                15163000
VSMEHH   EQU   VSMEXTS+10                                               15164000
CHAINPTR EQU   0                                                        15165000
CCW      EQU   0                                                        15166000
CCWOP    EQU   CCW                                                      15167000
CCWADDR  EQU   CCW+1                                                    15168000
CCWCMDCH EQU   CCW+4                                                    15169000
CCWSUPP  EQU   CCW+4                                                    15170000
CCWDATLN EQU   CCW+6                                                    15171000
COUNT    EQU   0                                                        15172000
CNTCCHHR EQU   COUNT                                                    15173000
CNTRECNO EQU   CNTCCHHR+4                                               15174000
CNTKEYLN EQU   COUNT+5                                                  15175000
CNTDATLN EQU   COUNT+6                                                  15176000
FLDLENS  EQU   0                                                        15177000
FLDKEYLN EQU   FLDLENS                                                  15178000
FLDDATLN EQU   FLDLENS+1                                                15179000
VTOCLOC  EQU   0                                                        15180000
VTOCTT   EQU   VTOCLOC                                                  15181000
ARGHEAD  EQU   0                                                        15182000
USERDSN  EQU   0                                                        15183000
ERRORMSG EQU   0                                                        15184000
SYNADMSG EQU   ERRORMSG+68                                              15185000
SYNDNAME EQU   SYNADMSG+7                                               15186000
OPNCLOSE EQU   0                                                        15187000
OCABCODE EQU   OPNCLOSE                                                 15188000
OCREASON EQU   OPNCLOSE+2                                               15189000
OCOPTION EQU   OPNCLOSE+3                                               15190000
AMSTP041 EQU   0                                                        15191000
AMSTP042 EQU   0                                                        15192000
AMSTP043 EQU   0                                                        15193000
AMSTP044 EQU   0                                                        15194000
DMPTRM   EQU   0                                                        15195000
IDCIOCL0 EQU   0                                                        15196000
IDCIOCO0 EQU   0                                                        15197000
IDCIOGT0 EQU   0                                                        15198000
IDCIOIT0 EQU   0                                                        15199000
IDCIOOP0 EQU   0                                                        15200000
IDCIOPO0 EQU   0                                                        15201000
IDCIOPT0 EQU   0                                                        15202000
IDCIOSI0 EQU   0                                                        15203000
IDCIOST0 EQU   0                                                        15204000
IDCIOTM0 EQU   0                                                        15205000
IDCIOVY0 EQU   0                                                        15206000
IDCIO050 EQU   0                                                        15207000
IDCSAAL0 EQU   0                                                        15208000
IDCSACA0 EQU   0                                                        15209000
IDCSACL0 EQU   0                                                        15210000
IDCSACR0 EQU   0                                                        15211000
IDCSADE0 EQU   0                                                        15212000
IDCSADL0 EQU   0                                                        15213000
IDCSADQ0 EQU   0                                                        15214000
IDCSAFP0 EQU   0                                                        15215000
IDCSAGP0 EQU   0                                                        15216000
IDCSAID0 EQU   0                                                        15217000
IDCSALC0 EQU   0                                                        15218000
IDCSALD0 EQU   0                                                        15219000
IDCSALK0 EQU   0                                                        15220000
IDCSANQ0 EQU   0                                                        15221000
IDCSAPR0 EQU   0                                                        15222000
IDCSAPT0 EQU   0                                                        15223000
IDCSAQL0 EQU   0                                                        15224000
IDCSARC0 EQU   0                                                        15225000
IDCSARK0 EQU   0                                                        15226000
IDCSARV0 EQU   0                                                        15227000
IDCSASC0 EQU   0                                                        15228000
IDCSASI0 EQU   0                                                        15229000
IDCSASN0 EQU   0                                                        15230000
IDCSASS0 EQU   0                                                        15231000
IDCSATI0 EQU   0                                                        15232000
IDCSAUC0 EQU   0                                                        15233000
IDCSAWO0 EQU   0                                                        15234000
IDCSA060 EQU   0                                                        15235000
IDCST010 EQU   0                                                        15236000
IDCTPER0 EQU   0                                                        15237000
LISTTEST EQU   0                                                        15238000
NEWERID1 EQU   5                                                        15239000
NEXTPTR  EQU   0                                                        15240000
UCBBGN   EQU   0                                                        15241000
GDTTBL   EQU   0                                                        15242000
GDTTR1   EQU   GDTTBL+8                                                 15243000
GDTTR2   EQU   GDTTBL+12                                                15244000
GDTSAH   EQU   GDTTBL+32                                                15245000
GDTIOH   EQU   GDTTBL+36                                                15246000
GDTDBG   EQU   GDTTBL+40                                                15247000
GDTSTC   EQU   GDTTBL+44                                                15248000
GDTPRT   EQU   GDTTBL+48                                                15249000
GDTESS   EQU   GDTTBL+52                                                15250000
GDTESA   EQU   GDTTBL+56                                                15251000
GDTRST   EQU   GDTTBL+60                                                15252000
GDTRES   EQU   GDTTBL+64                                                15253000
GDTCAL   EQU   GDTTBL+68                                                15254000
GDTGSP   EQU   GDTTBL+72                                                15255000
GDTFSP   EQU   GDTTBL+76                                                15256000
GDTGPL   EQU   GDTTBL+80                                                15257000
GDTFPL   EQU   GDTTBL+84                                                15258000
GDTLOD   EQU   GDTTBL+88                                                15259000
GDTDEL   EQU   GDTTBL+92                                                15260000
GDTPRL   EQU   GDTTBL+96                                                15261000
GDTEPL   EQU   GDTTBL+100                                               15262000
GDTTIM   EQU   GDTTBL+104                                               15263000
GDTIIO   EQU   GDTTBL+108                                               15264000
GDTTIO   EQU   GDTTBL+112                                               15265000
GDTOPN   EQU   GDTTBL+124                                               15266000
GDTCLS   EQU   GDTTBL+128                                               15267000
GDTGET   EQU   GDTTBL+132                                               15268000
GDTPUT   EQU   GDTTBL+136                                               15269000
GDTPOS   EQU   GDTTBL+140                                               15270000
GDTCPY   EQU   GDTTBL+144                                               15271000
GDTCAT   EQU   GDTTBL+148                                               15272000
GDTABT   EQU   GDTTBL+152                                               15273000
GDTABH   EQU   GDTTBL+156                                               15274000
GDTSNP   EQU   GDTTBL+164                                               15275000
GDTVFY   EQU   GDTTBL+172                                               15276000
GDTUID   EQU   GDTTBL+192                                               15277000
GDTPMT   EQU   GDTTBL+196                                               15278000
GDTCIR   EQU   GDTTBL+200                                               15279000
GDTLNK   EQU   GDTTBL+204                                               15280000
GDTALC   EQU   GDTTBL+208                                               15281000
GDTDLC   EQU   GDTTBL+212                                               15282000
GDTQAL   EQU   GDTTBL+216                                               15283000
GDTSTW   EQU   GDTTBL+220                                               15284000
GDTSSC   EQU   GDTTBL+224                                               15285000
GDTENQ   EQU   GDTTBL+228                                               15286000
GDTRSV   EQU   GDTTBL+232                                               15287000
GDTDEQ   EQU   GDTTBL+236                                               15288000
GDTSFO   EQU   GDTTBL+240                                               15289000
GDTWTO   EQU   GDTTBL+244                                               15290000
GDTSCR   EQU   GDTTBL+248                                               15291000
GDTUNT   EQU   GDTTBL+252                                               15292000
GDTRCT   EQU   GDTTBL+256                                               15293000
GDTIFO   EQU   GDTTBL+260                                               15294000
GDTEXP   EQU   GDTTBL+264                                               15295000
GDTSTA   EQU   GDTTBL+268                                               15296000
GDTERR   EQU   GDTTBL+272                                               15297000
GDTUNC   EQU   GDTTBL+276                                               15298000
GDTLOC   EQU   GDTTBL+280                                               15299000
GDTRCK   EQU   GDTTBL+284                                               15300000
REQUEST  EQU   0                                                        15301000
ARGLIST  EQU   0                                                        15302000
UCBOBS01 EQU   UCBDEV                                                   15303000
UCBVTOC  EQU   UCBOBS01                                                 15304000
UCBSTAB  EQU   UCBOBS01+10                                              15305000
UCBBSVL  EQU   UCBSTAB                                                  15306000
UCBPRSRS EQU   UCBSTAB                                                  15307000
UCBDMCT  EQU   UCBOBS01+11                                              15308000
UCBFL4   EQU   UCBOBS01+13                                              15309000
UCBOBS02 EQU   UCBDEV                                                   15310000
UCBTFL1  EQU   UCBOBS02+19                                              15311000
UCBXTN   EQU   UCBOBS02+20                                              15312000
UCBVOPT  EQU   UCBXTN                                                   15313000
UCBOBS03 EQU   UCBDEV                                                   15314000
UCBXTADR EQU   UCBOBS03                                                 15315000
UCBOBS04 EQU   UCBDEV                                                   15316000
UCBBTA   EQU   UCBOBS04+12                                              15317000
UCBOBS06 EQU   UCBDEV                                                   15318000
UCBAOF   EQU   UCBOBS06                                                 15319000
UCBAOF1  EQU   UCBAOF                                                   15320000
UCBAOF2  EQU   UCBAOF+1                                                 15321000
@NM00103 EQU   UCBOBS06+3                                               15322000
UCBIRB   EQU   UCBOBS06+4                                               15323000
UCBGRAF  EQU   UCBIRB                                                   15324000
UCBLDNCA EQU   UCBOBS06+8                                               15325000
UCBRDYQ  EQU   UCBLDNCA                                                 15326000
UCBIRLN  EQU   UCBRDYQ                                                  15327000
UCBLDNCB EQU   UCBRDYQ+1                                                15328000
UCBCTLNK EQU   UCBOBS06+12                                              15329000
UCBOBS07 EQU   UCBDEV                                                   15330000
UCBOBS08 EQU   UCBDEV                                                   15331000
UCBCTCAD EQU   UCBOBS08                                                 15332000
UCBCTCF1 EQU   UCBOBS08+4                                               15333000
UCBOBS09 EQU   UCBDEV                                                   15334000
JFCKEYLE EQU   JFCTRTCH                                                 15335000
JFCCODE  EQU   JFCKEYLE                                                 15336000
JFCSTACK EQU   JFCTRTCH                                                 15337000
JFCMODE  EQU   JFCSTACK                                                 15338000
JFCSPPRT EQU   JFCTRTCH                                                 15339000
JFCBABFS EQU   JFCSPPRT+2                                               15340000
JFCLIMCT EQU   JFCBABFS                                                 15341000
JFCDSORG EQU   JFCSPPRT+5                                               15342000
JFCDSRG1 EQU   JFCDSORG                                                 15343000
JFCDSRG2 EQU   JFCDSORG+1                                               15344000
JFCRECFM EQU   JFCSPPRT+7                                               15345000
JFCRCFM  EQU   JFCRECFM                                                 15346000
JFCOPTCD EQU   JFCSPPRT+8                                               15347000
JFCWVCSP EQU   JFCOPTCD                                                 15348000
JFCWVCIS EQU   JFCWVCSP                                                 15349000
JFCWVCBD EQU   JFCWVCIS                                                 15350000
JFCALLOW EQU   JFCOPTCD                                                 15351000
JFCRSV17 EQU   JFCALLOW                                                 15352000
JFCOVER  EQU   JFCRSV17                                                 15353000
JFCPCIBT EQU   JFCOPTCD                                                 15354000
JFCMAST  EQU   JFCPCIBT                                                 15355000
JFCEXT   EQU   JFCMAST                                                  15356000
JFCBCKPT EQU   JFCOPTCD                                                 15357000
JFCIND   EQU   JFCBCKPT                                                 15358000
JFCRSV18 EQU   JFCOPTCD                                                 15359000
JFCCYL   EQU   JFCRSV18                                                 15360000
JFCACT   EQU   JFCCYL                                                   15361000
JFCREDUC EQU   JFCOPTCD                                                 15362000
JFCRSV19 EQU   JFCREDUC                                                 15363000
JFCRSV20 EQU   JFCRSV19                                                 15364000
JFCRSV21 EQU   JFCOPTCD                                                 15365000
JFCDEL   EQU   JFCRSV21                                                 15366000
JFCOPTJ  EQU   JFCOPTCD                                                 15367000
JFCREORG EQU   JFCOPTJ                                                  15368000
JFCBLKSI EQU   JFCSPPRT+9                                               15369000
JFCBUFSI EQU   JFCBLKSI                                                 15370000
JFCAMSYN EQU   JFCSPPRT+11                                              15371000
JFCNCP   EQU   JFCAMSYN+2                                               15372000
JFCNTM   EQU   JFCAMSYN+3                                               15373000
JFCBFSEQ EQU   JFCNTM                                                   15374000
JFCPCI   EQU   JFCBFSEQ                                                 15375000
JFCRESRV EQU   JFCAMSYN+4                                               15376000
JFCUCSEG EQU   JFCRESRV                                                 15377000
JFCUCSOP EQU   JFCUCSEG+4                                               15378000
JFCOUTLI EQU   JFCUCSEG+5                                               15379000
JFCTHRSH EQU   JFCOUTLI                                                 15380000
JFCCPRI  EQU   JFCTHRSH                                                 15381000
JFCBVOLS EQU   JFCUCSEG+10                                              15382000
JFCAVOLS EQU   JFCBVOLS                                                 15383000
JFCBS001 EQU   JFCBVOLS                                                 15384000
JFCBPQTY EQU   JFCBS001+34                                              15385000
JFCBCTRI EQU   JFCBS001+37                                              15386000
JFCBSQTY EQU   JFCBS001+38                                              15387000
JFCFLGS1 EQU   JFCBS001+41                                              15388000
JFCBSPNM EQU   JFCBS001+45                                              15389000
JFCBFLG3 EQU   JFCBSPNM                                                 15390000
DEBBAS02 EQU   DEBBASND                                                 15391000
DEBDDS1  EQU   DEBBAS02                                                 15392000
DEBSUCBA EQU   DEBDDS1                                                  15393000
DEBDEVED EQU   DEBDDS1+4                                                15394000
DEBRDCB  EQU   DEBDDS1+4                                                15395000
DEBPDCB  EQU   DEBDDS1+8                                                15396000
DEBWDCB  EQU   DEBDDS1+12                                               15397000
DEBACS09 EQU   DEBDEVED                                                 15398000
DEBASC09 EQU   DEBACS09                                                 15399000
DEBEAMFG EQU   DEBASC09+3                                               15400000
DEBDSID  EQU   DEBASC09+4                                               15401000
DEBEOD   EQU   DEBASC09+12                                              15402000
DEBBOE   EQU   DEBEOD                                                   15403000
DEBEODRV EQU   DEBBOE                                                   15404000
DEBEODTT EQU   DEBBOE+1                                                 15405000
DEBEOD0  EQU   DEBBOE+2                                                 15406000
DEBEODSS EQU   DEBBOE+3                                                 15407000
DEBBAS01 EQU   DEBBASND                                                 15408000
DEBISAM  EQU   DEBBAS01                                                 15409000
DEBFIEAD EQU   DEBISAM                                                  15410000
DEBFPEAD EQU   DEBISAM+4                                                15411000
DEBFOEAD EQU   DEBISAM+8                                                15412000
DEBEXPT  EQU   DEBISAM+12                                               15413000
DEBRPSID EQU   DEBEXPT                                                  15414000
IOBORG01 EQU   IOBPREFX+8                                               15415000
IOBNIOBA EQU   IOBORG01                                                 15416000
IOBNFLG1 EQU   IOBNIOBA                                                 15417000
IOBPRTOV EQU   IOBNFLG1                                                 15418000
IOBORG02 EQU   IOBPREFX+8                                               15419000
IOBDQADA EQU   IOBORG02                                                 15420000
IOBDEQIN EQU   IOBDQADA                                                 15421000
IOBORG03 EQU   IOBPREFX+12                                              15422000
IOBORG04 EQU   IOBINCAM                                                 15423000
IOBORG12 EQU   IOBINCAM                                                 15424000
IOBFL4   EQU   IOBORG12                                                 15425000
IOBEXTEN EQU   IOBSTDRD+32                                              15426000
IOBSEEK  EQU   IOBEXTEN                                                 15427000
IOBM     EQU   IOBSEEK                                                  15428000
IOBBB    EQU   IOBSEEK+1                                                15429000
IOBCC    EQU   IOBSEEK+3                                                15430000
IOBHH    EQU   IOBSEEK+5                                                15431000
IOBR     EQU   IOBSEEK+7                                                15432000
IOBORG05 EQU   IOBEXTEN                                                 15433000
IOBORG06 EQU   IOBEXTEN                                                 15434000
IOBNXTPT EQU   IOBORG06+4                                               15435000
IOBSTATA EQU   IOBNXTPT                                                 15436000
IOBORG07 EQU   IOBEXTEN+8                                               15437000
W1IEXTEN EQU   IOBORG07                                                 15438000
IOBORG08 EQU   IOBEXTEN+8                                               15439000
IOBINDCT EQU   IOBORG08+4                                               15440000
IOBUNSQR EQU   IOBORG08+5                                               15441000
IOBFCHAD EQU   IOBORG08+8                                               15442000
IOBORG09 EQU   IOBEXTEN+8                                               15443000
IOBDPLAD EQU   IOBORG09+4                                               15444000
IOBDTYPE EQU   IOBORG09+8                                               15445000
IOBDTYP2 EQU   IOBORG09+9                                               15446000
IOBDSTAT EQU   IOBORG09+10                                              15447000
IOBSTAT1 EQU   IOBDSTAT                                                 15448000
IOBORG10 EQU   IOBEXTEN+8                                               15449000
IOBSEEK2 EQU   IOBORG10                                                 15450000
IOBORG11 EQU   IOBEXTEN                                                 15451000
IOBERCT  EQU   IOBORG11                                                 15452000
IOBUCBXV EQU   IOBERCT                                                  15453000
IOBNAME  EQU   IOBORG11+4                                               15454000
IOBORG13 EQU   IOBEXTEN                                                 15455000
IOBSKADR EQU   IOBORG13                                                 15456000
CVTS01   EQU   CVTPGSIA                                                 15457000
CVTLPDIA EQU   CVTS01+12                                                15458000
CVTDIRST EQU   CVTLPDIA                                                 15459000
CVTSLIDA EQU   CVTS01+24                                                15460000
CVTCTLFG EQU   CVTS01+50                                                15461000
CVTRV210 EQU   CVTS01+424                                               15462000
CVTRV219 EQU   CVTS01+425                                               15463000
CVTRV228 EQU   CVTS01+426                                               15464000
CVTRV237 EQU   CVTS01+427                                               15465000
CVTMFRTR EQU   CVTS01+452                                               15466000
CVTRV262 EQU   CVTS01+468                                               15467000
CVTRV271 EQU   CVTS01+469                                               15468000
CVTRV280 EQU   CVTS01+470                                               15469000
CVTRV289 EQU   CVTS01+471                                               15470000
CVTGSDA  EQU   CVTS01+600                                               15471000
HEADNUM  EQU   BEGHHLOC                                                 15472000
REPVALS  EQU   EXSPACE                                                  15473000
SVCCWPTR EQU   REPVALS+1                                                15474000
LSTRECNM EQU   REPVALS+4                                                15475000
RECCNTSV EQU   REPVALS+6                                                15476000
RECCNT   EQU   REPVALS+8                                                15477000
EXTNTVAL EQU   DEBEXSCL                                                 15478000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    15479000
@NM00207 EQU   REPVALS                                                  15480000
CVTRV628 EQU   CVTS01+728                                               15481000
CVTRV627 EQU   CVTS01+724                                               15482000
CVTRV626 EQU   CVTS01+720                                               15483000
CVTRV625 EQU   CVTS01+716                                               15484000
CVTRV624 EQU   CVTS01+712                                               15485000
CVTRV623 EQU   CVTS01+708                                               15486000
CVTRV622 EQU   CVTS01+704                                               15487000
CVTRV621 EQU   CVTS01+700                                               15488000
CVTIHASU EQU   CVTS01+696                                               15489000
CVTRV619 EQU   CVTS01+692                                               15490000
CVTRV618 EQU   CVTS01+688                                               15491000
CVTRV617 EQU   CVTS01+684                                               15492000
CVTRV616 EQU   CVTS01+680                                               15493000
CVTRV615 EQU   CVTS01+676                                               15494000
CVTRV614 EQU   CVTS01+672                                               15495000
CVTRV613 EQU   CVTS01+668                                               15496000
CVTTCASP EQU   CVTS01+664                                               15497000
CVT0PT03 EQU   CVTS01+660                                               15498000
CVT0PT0E EQU   CVTS01+656                                               15499000
CVTRV609 EQU   CVTS01+652                                               15500000
CVTCGK   EQU   CVTS01+648                                               15501000
CVTRAC   EQU   CVTS01+644                                               15502000
CVTRV606 EQU   CVTS01+640                                               15503000
CVTRV605 EQU   CVTS01+636                                               15504000
CVTRV604 EQU   CVTS01+632                                               15505000
CVTEFF02 EQU   CVTS01+628                                               15506000
CVTCBBR  EQU   CVTS01+624                                               15507000
CVTSSCR  EQU   CVTS01+620                                               15508000
CVTEVENT EQU   CVTS01+616                                               15509000
CVTCRCA  EQU   CVTS01+612                                               15510000
CVTTPIO  EQU   CVTS01+608                                               15511000
CVTADV   EQU   CVTS01+604                                               15512000
CVTGSDAB EQU   CVTGSDA                                                  15513000
CVTQV3   EQU   CVTS01+596                                               15514000
CVTQV2   EQU   CVTS01+592                                               15515000
CVTQV1   EQU   CVTS01+588                                               15516000
CVTRPT   EQU   CVTS01+584                                               15517000
CVTSSRB  EQU   CVTS01+580                                               15518000
CVTCSDRL EQU   CVTS01+576                                               15519000
CVTEXP1  EQU   CVTS01+572                                               15520000
CVTRMPMT EQU   CVTS01+568                                               15521000
CVTRMPTT EQU   CVTS01+564                                               15522000
CVTVPSA  EQU   CVTS01+560                                               15523000
CVTVSTOP EQU   CVTS01+556                                               15524000
CVTGTFR8 EQU   CVTS01+552                                               15525000
CVTQUIT  EQU   CVTS01+548                                               15526000
CVTVACR  EQU   CVTS01+544                                               15527000
CVTWTCB  EQU   CVTS01+540                                               15528000
CVTSTPRS EQU   CVTS01+536                                               15529000
CVT0PT02 EQU   CVTS01+532                                               15530000
CVTDARCM EQU   CVTS01+528                                               15531000
CVTIRECM EQU   CVTS01+524                                               15532000
CVTJRECM EQU   CVTS01+520                                               15533000
CVTVEMS0 EQU   CVTS01+516                                               15534000
CVTSPFRR EQU   CVTS01+512                                               15535000
CVTRLSTG EQU   CVTS01+508                                               15536000
CVT0TC0A EQU   CVTS01+504                                               15537000
CVTGMBR  EQU   CVTS01+500                                               15538000
CVTLFRM  EQU   CVTS01+496                                               15539000
CVTRMBR  EQU   CVTS01+492                                               15540000
CVTVIOP  EQU   CVTS01+488                                               15541000
CVTRV307 EQU   CVTS01+486                                               15542000
CVTRV306 EQU   CVTS01+484                                               15543000
CVTRV305 EQU   CVTS01+482                                               15544000
CVTRV304 EQU   CVTS01+480                                               15545000
CVTRV303 EQU   CVTS01+478                                               15546000
CVTRV302 EQU   CVTS01+476                                               15547000
CVTTRCA  EQU   CVTS01+472                                               15548000
CVTRV297 EQU   CVTRV289                                                 15549000
CVTRV296 EQU   CVTRV289                                                 15550000
CVTRV295 EQU   CVTRV289                                                 15551000
CVTRV294 EQU   CVTRV289                                                 15552000
CVTRV293 EQU   CVTRV289                                                 15553000
CVTRV292 EQU   CVTRV289                                                 15554000
CVTRV291 EQU   CVTRV289                                                 15555000
CVTRV290 EQU   CVTRV289                                                 15556000
CVTRV288 EQU   CVTRV280                                                 15557000
CVTRV287 EQU   CVTRV280                                                 15558000
CVTRV286 EQU   CVTRV280                                                 15559000
CVTRV285 EQU   CVTRV280                                                 15560000
CVTRV284 EQU   CVTRV280                                                 15561000
CVTRV283 EQU   CVTRV280                                                 15562000
CVTRV282 EQU   CVTRV280                                                 15563000
CVTRV281 EQU   CVTRV280                                                 15564000
CVTRV279 EQU   CVTRV271                                                 15565000
CVTRV278 EQU   CVTRV271                                                 15566000
CVTRV277 EQU   CVTRV271                                                 15567000
CVTRV276 EQU   CVTRV271                                                 15568000
CVTRV275 EQU   CVTRV271                                                 15569000
CVTRV274 EQU   CVTRV271                                                 15570000
CVTRV273 EQU   CVTRV271                                                 15571000
CVTRV272 EQU   CVTRV271                                                 15572000
CVTRV270 EQU   CVTRV262                                                 15573000
CVTRV269 EQU   CVTRV262                                                 15574000
CVTRV268 EQU   CVTRV262                                                 15575000
CVTRV267 EQU   CVTRV262                                                 15576000
CVTRV266 EQU   CVTRV262                                                 15577000
CVTRV265 EQU   CVTRV262                                                 15578000
CVTRV264 EQU   CVTRV262                                                 15579000
CVTRV263 EQU   CVTRV262                                                 15580000
CVTVFP   EQU   CVTS01+464                                               15581000
CVTVSI   EQU   CVTS01+460                                               15582000
CVTVPSIB EQU   CVTS01+456                                               15583000
CVTMFACT EQU   CVTMFRTR                                                 15584000
CVTMFCTL EQU   CVTS01+448                                               15585000
CVTPVBP  EQU   CVTS01+444                                               15586000
CVTPWI   EQU   CVTS01+440                                               15587000
CVTRV254 EQU   CVTS01+438                                               15588000
CVTRV253 EQU   CVTS01+436                                               15589000
CVTRV252 EQU   CVTS01+434                                               15590000
CVTRV251 EQU   CVTS01+433                                               15591000
CVTRV250 EQU   CVTS01+432                                               15592000
CVTRV249 EQU   CVTS01+431                                               15593000
CVTRV248 EQU   CVTS01+430                                               15594000
CVTRV247 EQU   CVTS01+429                                               15595000
CVTRV246 EQU   CVTS01+428                                               15596000
CVTRV245 EQU   CVTRV237                                                 15597000
CVTRV244 EQU   CVTRV237                                                 15598000
CVTRV243 EQU   CVTRV237                                                 15599000
CVTRV242 EQU   CVTRV237                                                 15600000
CVTRV241 EQU   CVTRV237                                                 15601000
CVTRV240 EQU   CVTRV237                                                 15602000
CVTRV239 EQU   CVTRV237                                                 15603000
CVTRV238 EQU   CVTRV237                                                 15604000
CVTRV236 EQU   CVTRV228                                                 15605000
CVTRV235 EQU   CVTRV228                                                 15606000
CVTRV234 EQU   CVTRV228                                                 15607000
CVTRV233 EQU   CVTRV228                                                 15608000
CVTRV232 EQU   CVTRV228                                                 15609000
CVTRV231 EQU   CVTRV228                                                 15610000
CVTRV230 EQU   CVTRV228                                                 15611000
CVTRV229 EQU   CVTRV228                                                 15612000
CVTRV227 EQU   CVTRV219                                                 15613000
CVTRV226 EQU   CVTRV219                                                 15614000
CVTRV225 EQU   CVTRV219                                                 15615000
CVTRV224 EQU   CVTRV219                                                 15616000
CVTRV223 EQU   CVTRV219                                                 15617000
CVTRV222 EQU   CVTRV219                                                 15618000
CVTRV221 EQU   CVTRV219                                                 15619000
CVTRV220 EQU   CVTRV219                                                 15620000
CVTRV218 EQU   CVTRV210                                                 15621000
CVTRV217 EQU   CVTRV210                                                 15622000
CVTRV216 EQU   CVTRV210                                                 15623000
CVTRV215 EQU   CVTRV210                                                 15624000
CVTRV214 EQU   CVTRV210                                                 15625000
CVTRV213 EQU   CVTRV210                                                 15626000
CVTRV212 EQU   CVTRV210                                                 15627000
CVTRV211 EQU   CVTRV210                                                 15628000
CVTLCCAT EQU   CVTS01+420                                               15629000
CVTPCCAT EQU   CVTS01+416                                               15630000
CVTIPCRP EQU   CVTS01+412                                               15631000
CVTIPCRI EQU   CVTS01+408                                               15632000
CVTIPCDS EQU   CVTS01+404                                               15633000
CVTAIDVT EQU   CVTS01+400                                               15634000
CVTSSAP  EQU   CVTS01+396                                               15635000
CVTEHCIR EQU   CVTS01+392                                               15636000
CVTEHDEF EQU   CVTS01+388                                               15637000
CVTDAIR  EQU   CVTS01+384                                               15638000
CVTPERFM EQU   CVTS01+380                                               15639000
CVT044R2 EQU   CVTS01+376                                               15640000
CVTFETCH EQU   CVTS01+372                                               15641000
CVTRSTWD EQU   CVTS01+368                                               15642000
CVTSPOST EQU   CVTS01+364                                               15643000
CVTIOBP  EQU   CVTS01+360                                               15644000
CVTASMVT EQU   CVTS01+356                                               15645000
CVTRECRQ EQU   CVTS01+352                                               15646000
CVTWSAC  EQU   CVTS01+348                                               15647000
CVTRV149 EQU   CVTS01+344                                               15648000
CVTWSAL  EQU   CVTS01+340                                               15649000
CVTSPSA  EQU   CVTS01+336                                               15650000
CVTGLMN  EQU   CVTS01+332                                               15651000
CVTVEAC0 EQU   CVTS01+328                                               15652000
CVT062R1 EQU   CVTS01+324                                               15653000
CVTRPOST EQU   CVTS01+320                                               15654000
CVTDQIQE EQU   CVTS01+316                                               15655000
CVTCSD   EQU   CVTS01+312                                               15656000
CVTLKRMA EQU   CVTS01+308                                               15657000
CVTRSPIE EQU   CVTS01+304                                               15658000
CVTRENQ  EQU   CVTS01+300                                               15659000
CVTLQCB  EQU   CVTS01+296                                               15660000
CVTFQCB  EQU   CVTS01+292                                               15661000
CVTQCS01 EQU   CVTS01+288                                               15662000
CVTAPFT  EQU   CVTS01+284                                               15663000
CVTPARRL EQU   CVTS01+280                                               15664000
CVTVWAIT EQU   CVTS01+276                                               15665000
CVTGSPL  EQU   CVTS01+272                                               15666000
CVTLSMQ  EQU   CVTS01+268                                               15667000
CVTGSMQ  EQU   CVTS01+264                                               15668000
CVTEXPRO EQU   CVTS01+260                                               15669000
CVTOPCTP EQU   CVTS01+256                                               15670000
CVTSIC   EQU   CVTS01+252                                               15671000
CVTTPIOS EQU   CVTS01+248                                               15672000
CVTRTMS  EQU   CVTS01+244                                               15673000
CVTSDBF  EQU   CVTS01+240                                               15674000
CVTSCBP  EQU   CVTS01+236                                               15675000
CVTSDMP  EQU   CVTS01+232                                               15676000
CVTSV60  EQU   CVTS01+228                                               15677000
CVTRTMCT EQU   CVTS01+224                                               15678000
CVTASCBL EQU   CVTS01+220                                               15679000
CVTASCBH EQU   CVTS01+216                                               15680000
CVTGDA   EQU   CVTS01+212                                               15681000
CVTASVT  EQU   CVTS01+208                                               15682000
CVTVVMDI EQU   CVTS01+204                                               15683000
CVTAQTOP EQU   CVTS01+200                                               15684000
CVTIOSCS EQU   CVTS01+196                                               15685000
CVTSDRM  EQU   CVTS01+192                                               15686000
CVTOPTE  EQU   CVTS01+188                                               15687000
CVTSTXU  EQU   CVTS01+184                                               15688000
CVTQUIS  EQU   CVTS01+180                                               15689000
CVTPARS  EQU   CVTS01+176                                               15690000
CVTS1EE  EQU   CVTS01+172                                               15691000
CVTFRAS  EQU   CVTS01+168                                               15692000
CVTQSAS  EQU   CVTS01+164                                               15693000
CVTCRAS  EQU   CVTS01+160                                               15694000
CVTCRMN  EQU   CVTS01+156                                               15695000
CVTDELCP EQU   CVTS01+152                                               15696000
CVTFRECL EQU   CVTS01+148                                               15697000
CVTGETCL EQU   CVTS01+144                                               15698000
CVTBLDCP EQU   CVTS01+140                                               15699000
CVTAUTHL EQU   CVTS01+136                                               15700000
CVTSCAN  EQU   CVTS01+132                                               15701000
CVTRV144 EQU   CVTS01+130                                               15702000
CVTMAXMP EQU   CVTS01+128                                               15703000
CVTSTCK  EQU   CVTS01+124                                               15704000
CVTRV139 EQU   CVTS01+123                                               15705000
CVTDSSAC EQU   CVTS01+122                                               15706000
CVTRV513 EQU   CVTS01+121                                               15707000
CVTIOSPL EQU   CVTS01+120                                               15708000
CVTPTGT  EQU   CVTS01+116                                               15709000
CVTCSPIE EQU   CVTS01+112                                               15710000
CVTSMFEX EQU   CVTS01+108                                               15711000
CVTOLT0A EQU   CVTS01+104                                               15712000
CVTSRBRT EQU   CVTS01+100                                               15713000
CVTPUTL  EQU   CVTS01+96                                                15714000
CVTASCRL EQU   CVTS01+92                                                15715000
CVTASCRF EQU   CVTS01+88                                                15716000
CVTRV326 EQU   CVTS01+84                                                15717000
CVTRV325 EQU   CVTS01+80                                                15718000
CVTRV324 EQU   CVTS01+76                                                15719000
CVT0VL01 EQU   CVTS01+72                                                15720000
CVTSHRVM EQU   CVTS01+68                                                15721000
CVTRV332 EQU   CVTS01+64                                                15722000
CVTTAS   EQU   CVTS01+60                                                15723000
CVTRSCN  EQU   CVTS01+56                                                15724000
CVTTRAC2 EQU   CVTS01+54                                                15725000
CVTTRACE EQU   CVTS01+52                                                15726000
CVTAPG   EQU   CVTS01+51                                                15727000
CVTSDTRC EQU   CVTCTLFG                                                 15728000
CVTGTRCE EQU   CVTCTLFG                                                 15729000
CVTNOMP  EQU   CVTCTLFG                                                 15730000
CVTRSV79 EQU   CVTCTLFG                                                 15731000
CVTDSTAT EQU   CVTCTLFG                                                 15732000
CVTRSV78 EQU   CVTCTLFG                                                 15733000
CVTRV333 EQU   CVTCTLFG                                                 15734000
CVTRV323 EQU   CVTCTLFG                                                 15735000
CVTSPVLK EQU   CVTS01+49                                                15736000
CVTRSV77 EQU   CVTS01+48                                                15737000
CVTRV331 EQU   CVTS01+44                                                15738000
CVTRV330 EQU   CVTS01+40                                                15739000
CVTRV329 EQU   CVTS01+36                                                15740000
CVTRV328 EQU   CVTS01+32                                                15741000
CVTRV322 EQU   CVTS01+28                                                15742000
CVTSLID  EQU   CVTSLIDA+1                                               15743000
CVTSYLK  EQU   CVTSLIDA                                                 15744000
CVTRV321 EQU   CVTS01+20                                                15745000
CVTRV320 EQU   CVTS01+16                                                15746000
CVTLPDIR EQU   CVTLPDIA+1                                               15747000
CVTRSV69 EQU   CVTDIRST                                                 15748000
CVTRSV68 EQU   CVTDIRST                                                 15749000
CVTRSV67 EQU   CVTDIRST                                                 15750000
CVTRSV66 EQU   CVTDIRST                                                 15751000
CVTRSV65 EQU   CVTDIRST                                                 15752000
CVTRSV64 EQU   CVTDIRST                                                 15753000
CVTRSV63 EQU   CVTDIRST                                                 15754000
CVTDICOM EQU   CVTDIRST                                                 15755000
CVTPVTP  EQU   CVTS01+8                                                 15756000
CVTLPDSR EQU   CVTS01+4                                                 15757000
CVTGETL  EQU   CVTS01                                                   15758000
IOBSKSS  EQU   IOBSKADR+3                                               15759000
IOBSK0   EQU   IOBSKADR+2                                               15760000
IOBSKTT  EQU   IOBSKADR+1                                               15761000
IOBSKRV  EQU   IOBSKADR                                                 15762000
IOBCSWSV EQU   IOBORG11+17                                              15763000
IOBSENSV EQU   IOBORG11+16                                              15764000
IOBRCD   EQU   IOBORG11+12                                              15765000
IOBMDREC EQU   IOBORG11+8                                               15766000
IOBNAMEA EQU   IOBNAME+1                                                15767000
IOBNAMSZ EQU   IOBNAME                                                  15768000
IOBERCTA EQU   IOBERCT+1                                                15769000
IOBRTYPE EQU   IOBUCBXV                                                 15770000
IOBRDCHP EQU   IOBORG10+20                                              15771000
IOBNEXTA EQU   IOBORG10+16                                              15772000
IOBREADA EQU   IOBORG10+12                                              15773000
IOBBUFC  EQU   IOBORG10+8                                               15774000
IOBSK2R  EQU   IOBSEEK2+7                                               15775000
IOBSK2HH EQU   IOBSEEK2+5                                               15776000
IOBSK2CC EQU   IOBSEEK2+3                                               15777000
IOBSK2BB EQU   IOBSEEK2+1                                               15778000
IOBSK2M  EQU   IOBSEEK2                                                 15779000
IOBCHNPR EQU   IOBORG09+40                                              15780000
IOBDNCRF EQU   IOBORG09+32                                              15781000
IOBRSV35 EQU   IOBORG09+24                                              15782000
IOBDQPTR EQU   IOBORG09+20                                              15783000
IOBRSV34 EQU   IOBORG09+18                                              15784000
IOBDBYTN EQU   IOBORG09+16                                              15785000
IOBDCPND EQU   IOBORG09+12                                              15786000
IOBSTAT2 EQU   IOBDSTAT+1                                               15787000
IOBSIORT EQU   IOBSTAT1                                                 15788000
IOBADDVU EQU   IOBSTAT1                                                 15789000
IOBBUFF  EQU   IOBSTAT1                                                 15790000
IOBENQUE EQU   IOBSTAT1                                                 15791000
IOBPASS2 EQU   IOBSTAT1                                                 15792000
IOBSYNCH EQU   IOBSTAT1                                                 15793000
IOBNEWVL EQU   IOBSTAT1                                                 15794000
IOBABNRM EQU   IOBSTAT1                                                 15795000
IOBRELEX EQU   IOBDTYP2                                                 15796000
IOBADDTY EQU   IOBDTYP2                                                 15797000
IOBTYPE  EQU   IOBDTYP2                                                 15798000
IOBRQUST EQU   IOBDTYP2                                                 15799000
IOBSUFFX EQU   IOBDTYP2                                                 15800000
IOBSBLKL EQU   IOBDTYP2                                                 15801000
IOBSKEY  EQU   IOBDTYP2                                                 15802000
IOBRELBL EQU   IOBDTYPE                                                 15803000
IOBRDEXC EQU   IOBDTYPE                                                 15804000
IOBDYNBF EQU   IOBDTYPE                                                 15805000
IOBACTAD EQU   IOBDTYPE                                                 15806000
IOBFDBCK EQU   IOBDTYPE                                                 15807000
IOBEXTSC EQU   IOBDTYPE                                                 15808000
IOBOVFLO EQU   IOBDTYPE                                                 15809000
IOBVERFY EQU   IOBDTYPE                                                 15810000
IOBDPLB  EQU   IOBDPLAD+1                                               15811000
IOBDAYLI EQU   IOBDPLAD                                                 15812000
IOBDIOBS EQU   IOBORG09+2                                               15813000
IOBDBYTR EQU   IOBORG09                                                 15814000
IOBBCHAD EQU   IOBORG08+12                                              15815000
IOBFCHNB EQU   IOBFCHAD+1                                               15816000
IOBCOUNT EQU   IOBFCHAD                                                 15817000
IOBASYN  EQU   IOBORG08+7                                               15818000
IOBAPP   EQU   IOBORG08+6                                               15819000
IOBRSV32 EQU   IOBUNSQR                                                 15820000
IOBRSV31 EQU   IOBUNSQR                                                 15821000
IOBRSV30 EQU   IOBUNSQR                                                 15822000
IOBKNRWR EQU   IOBUNSQR                                                 15823000
IOBKNWR  EQU   IOBUNSQR                                                 15824000
IOBNTAV2 EQU   IOBUNSQR                                                 15825000
IOBNTAV1 EQU   IOBUNSQR                                                 15826000
IOBCPBSY EQU   IOBUNSQR                                                 15827000
IOBCHNNL EQU   IOBINDCT                                                 15828000
IOBRSV29 EQU   IOBINDCT                                                 15829000
IOBRSV28 EQU   IOBINDCT                                                 15830000
IOBRSV27 EQU   IOBINDCT                                                 15831000
IOBKEYAD EQU   IOBINDCT                                                 15832000
IOBOVPTR EQU   IOBINDCT                                                 15833000
IOBUNSCH EQU   IOBINDCT                                                 15834000
IOBDEQCP EQU   IOBINDCT                                                 15835000
IOBCCWAD EQU   IOBORG08                                                 15836000
W1OEXTEN EQU   W1IEXTEN                                                 15837000
IOBCCW   EQU   IOBORG06+8                                               15838000
IOBNXTPB EQU   IOBNXTPT+1                                               15839000
IOBRSV26 EQU   IOBSTATA                                                 15840000
IOBRSV25 EQU   IOBSTATA                                                 15841000
IOBRSV24 EQU   IOBSTATA                                                 15842000
IOBRSV23 EQU   IOBSTATA                                                 15843000
IOBRSV22 EQU   IOBSTATA                                                 15844000
IOBRSV21 EQU   IOBSTATA                                                 15845000
IOBRSV20 EQU   IOBSTATA                                                 15846000
IOBAVLFL EQU   IOBSTATA                                                 15847000
IOBRSV37 EQU   IOBORG06+1                                               15848000
IOBUCBXG EQU   IOBORG06                                                 15849000
IOBCPA   EQU   IOBORG05+32                                              15850000
IOBERINF EQU   IOBORG05+16                                              15851000
IOBERCCW EQU   IOBORG05+8                                               15852000
IOBSNDPT EQU   IOBORG05+7                                               15853000
IOBRCVPT EQU   IOBORG05+6                                               15854000
IOBWORK  EQU   IOBORG05+1                                               15855000
IOBUCBX  EQU   IOBORG05                                                 15856000
IOBHH2   EQU   IOBHH+1                                                  15857000
IOBHH1   EQU   IOBHH                                                    15858000
IOBCC2   EQU   IOBCC+1                                                  15859000
IOBCC1   EQU   IOBCC                                                    15860000
IOBBB2   EQU   IOBBB+1                                                  15861000
IOBBB1   EQU   IOBBB                                                    15862000
IOBRSV46 EQU   IOBFL4                                                   15863000
IOBRSV47 EQU   IOBFL4                                                   15864000
IOBENT   EQU   IOBFL4                                                   15865000
IOBEQP   EQU   IOBFL4                                                   15866000
IOBBUS   EQU   IOBFL4                                                   15867000
IOBDCK   EQU   IOBFL4                                                   15868000
IOBREJ   EQU   IOBFL4                                                   15869000
IOBOVR   EQU   IOBFL4                                                   15870000
IOBCRILC EQU   IOBORG04+1                                               15871000
IOBCRDCC EQU   IOBORG04                                                 15872000
IOBGQECB EQU   IOBORG03                                                 15873000
IOBSWAP  EQU   IOBORG02+4                                               15874000
IOBDQADB EQU   IOBDQADA+1                                               15875000
IOBRSV13 EQU   IOBDEQIN                                                 15876000
IOBRSV12 EQU   IOBDEQIN                                                 15877000
IOBRSV11 EQU   IOBDEQIN                                                 15878000
IOBRSV10 EQU   IOBDEQIN                                                 15879000
IOBRSV09 EQU   IOBDEQIN                                                 15880000
IOBRSV08 EQU   IOBDEQIN                                                 15881000
IOBRSV07 EQU   IOBDEQIN                                                 15882000
IOBDEQ   EQU   IOBDEQIN                                                 15883000
IOBNECB  EQU   IOBORG01+4                                               15884000
IOBNIOBB EQU   IOBNIOBA+1                                               15885000
IOBFIRST EQU   IOBNFLG1                                                 15886000
IOBUPERR EQU   IOBNFLG1                                                 15887000
IOBSPAN  EQU   IOBNFLG1                                                 15888000
IOBBKSPC EQU   IOBNFLG1                                                 15889000
IOBUPDAT EQU   IOBNFLG1                                                 15890000
IOBREAD  EQU   IOBNFLG1                                                 15891000
IOBWRITE EQU   IOBNFLG1                                                 15892000
IOBSEGMT EQU   IOBPRTOV                                                 15893000
DEBEXPTA EQU   DEBEXPT+1                                                15894000
DEBRSV12 EQU   DEBRPSID                                                 15895000
DEBRSV11 EQU   DEBRPSID                                                 15896000
DEBRSV10 EQU   DEBRPSID                                                 15897000
DEBRSV09 EQU   DEBRPSID                                                 15898000
DEBRPSAP EQU   DEBRPSID                                                 15899000
DEBRPSO  EQU   DEBRPSID                                                 15900000
DEBRPSI  EQU   DEBRPSID                                                 15901000
DEBRPSP  EQU   DEBRPSID                                                 15902000
DEBFOEB  EQU   DEBFOEAD+1                                               15903000
DEBNOEE  EQU   DEBFOEAD                                                 15904000
DEBFPEB  EQU   DEBFPEAD+1                                               15905000
DEBNPEE  EQU   DEBFPEAD                                                 15906000
DEBFIEB  EQU   DEBFIEAD+1                                               15907000
DEBNIEE  EQU   DEBFIEAD                                                 15908000
DEBBOESS EQU   DEBEODSS                                                 15909000
DEBBOE0  EQU   DEBEOD0                                                  15910000
DEBBOETT EQU   DEBEODTT                                                 15911000
DEBBOERV EQU   DEBEODRV                                                 15912000
DEBRV008 EQU   DEBDSID+7                                                15913000
DEBWTPTI EQU   DEBDSID+6                                                15914000
DEBEXDTE EQU   DEBDSID                                                  15915000
DEBRV007 EQU   DEBEAMFG                                                 15916000
DEBRV006 EQU   DEBEAMFG                                                 15917000
DEBRV005 EQU   DEBEAMFG                                                 15918000
DEBRV004 EQU   DEBEAMFG                                                 15919000
DEBSECVL EQU   DEBEAMFG                                                 15920000
DEBVAMSG EQU   DEBEAMFG                                                 15921000
DEBDSOPN EQU   DEBEAMFG                                                 15922000
DEBMULTI EQU   DEBEAMFG                                                 15923000
DEBVSEQU EQU   DEBASC09+2                                               15924000
DEBDSSQL EQU   DEBASC09+1                                               15925000
DEBVOLAC EQU   DEBASC09                                                 15926000
DEBWDCBA EQU   DEBWDCB+1                                                15927000
DEBRSV08 EQU   DEBWDCB                                                  15928000
DEBPDCBA EQU   DEBPDCB+1                                                15929000
DEBRSV07 EQU   DEBPDCB                                                  15930000
DEBRDCBA EQU   DEBRDCB+1                                                15931000
DEBRSV06 EQU   DEBRDCB                                                  15932000
DEBSUCBB EQU   DEBSUCBA+1                                               15933000
DEBSDVM  EQU   DEBSUCBA                                                 15934000
JFCBEND  EQU   JFCBS001+58                                              15935000
JFCBSPTN EQU   JFCBS001+57                                              15936000
JFCBVLCT EQU   JFCBS001+56                                              15937000
JFCBDRLH EQU   JFCBS001+53                                              15938000
JFCBSBNM EQU   JFCBS001+50                                              15939000
JFCBABST EQU   JFCBS001+48                                              15940000
JFCBRV08 EQU   JFCBSPNM+1                                               15941000
JFCBRV07 EQU   JFCBFLG3                                                 15942000
JFCBRV06 EQU   JFCBFLG3                                                 15943000
JFCBRV05 EQU   JFCBFLG3                                                 15944000
JFCBRV04 EQU   JFCBFLG3                                                 15945000
JFCBRV03 EQU   JFCBFLG3                                                 15946000
JFCBRV02 EQU   JFCBFLG3                                                 15947000
JFCBRV01 EQU   JFCBFLG3                                                 15948000
JFCDQDSP EQU   JFCBFLG3                                                 15949000
JFCBDQTY EQU   JFCBS001+42                                              15950000
JFCBUAFF EQU   JFCFLGS1                                                 15951000
JFCRSV45 EQU   JFCFLGS1                                                 15952000
JFCVRDS  EQU   JFCFLGS1                                                 15953000
JFCBCEOV EQU   JFCFLGS1                                                 15954000
JFCRSV42 EQU   JFCFLGS1                                                 15955000
JFCBADSP EQU   JFCFLGS1                                                 15956000
JFCTOPEN EQU   JFCFLGS1                                                 15957000
JFCBDLET EQU   JFCFLGS1                                                 15958000
JFCRQID  EQU   JFCBSQTY                                                 15959000
JFCROUND EQU   JFCBCTRI                                                 15960000
JFCALX   EQU   JFCBCTRI                                                 15961000
JFCMIXG  EQU   JFCBCTRI                                                 15962000
JFCONTIG EQU   JFCBCTRI                                                 15963000
JFCRSV29 EQU   JFCBCTRI                                                 15964000
JFCBMSGP EQU   JFCBCTRI                                                 15965000
JFCBSPAC EQU   JFCBCTRI                                                 15966000
JFCRUNIT EQU   JFCBPQTY                                                 15967000
JFCBEXAD EQU   JFCBS001+31                                              15968000
JFCBEXTL EQU   JFCBS001+30                                              15969000
JFCMSVGP EQU   JFCBS001+22                                              15970000
@NM00124 EQU   JFCBS001                                                 15971000
JFCBNVOL EQU   JFCUCSEG+9                                               15972000
JFCBNTCS EQU   JFCUCSEG+8                                               15973000
JFCSOWA  EQU   JFCOUTLI+1                                               15974000
JFCSEND  EQU   JFCCPRI                                                  15975000
JFCEQUAL EQU   JFCCPRI                                                  15976000
JFCRECV  EQU   JFCCPRI                                                  15977000
JFCRSV34 EQU   JFCCPRI                                                  15978000
JFCRSV33 EQU   JFCCPRI                                                  15979000
JFCRSV55 EQU   JFCCPRI                                                  15980000
JFCRSV54 EQU   JFCCPRI                                                  15981000
JFCRSV53 EQU   JFCCPRI                                                  15982000
JFCRSV27 EQU   JFCUCSOP                                                 15983000
JFCRSV26 EQU   JFCUCSOP                                                 15984000
JFCFCBVR EQU   JFCUCSOP                                                 15985000
JFCFCBAL EQU   JFCUCSOP                                                 15986000
JFCVER   EQU   JFCUCSOP                                                 15987000
JFCRSV25 EQU   JFCUCSOP                                                 15988000
JFCFOLD  EQU   JFCUCSOP                                                 15989000
JFCBEXTP EQU   JFCUCSOP                                                 15990000
JFCUCSID EQU   JFCUCSEG                                                 15991000
JFCINTVL EQU   JFCSPPRT+19                                              15992000
JFCDBUFN EQU   JFCRESRV+3                                               15993000
JFCCYLOF EQU   JFCRESRV+2                                               15994000
JFCRKP   EQU   JFCRESRV                                                 15995000
JFCPCIR2 EQU   JFCPCI                                                   15996000
JFCPCIR1 EQU   JFCPCI                                                   15997000
JFCPCIN2 EQU   JFCPCI                                                   15998000
JFCPCIN1 EQU   JFCPCI                                                   15999000
JFCPCIA2 EQU   JFCPCI                                                   16000000
JFCPCIA1 EQU   JFCPCI                                                   16001000
JFCPCIX2 EQU   JFCPCI                                                   16002000
JFCPCIX1 EQU   JFCPCI                                                   16003000
JFCBUFMX EQU   JFCNCP                                                   16004000
JFCLRECL EQU   JFCAMSYN                                                 16005000
JFCBAXBF EQU   JFCBUFSI                                                 16006000
JFCREL   EQU   JFCREORG                                                 16007000
JFCRSV22 EQU   JFCDEL                                                   16008000
JFCSRCHD EQU   JFCRSV20                                                 16009000
JFCOPTQ  EQU   JFCACT                                                   16010000
JFCFEED  EQU   JFCIND                                                   16011000
JFCCBWU  EQU   JFCEXT                                                   16012000
JFCWUMSG EQU   JFCOVER                                                  16013000
JFCSDNAM EQU   JFCWVCBD                                                 16014000
@NM00123 EQU   JFCRECFM                                                 16015000
JFCCHAR  EQU   JFCRECFM                                                 16016000
JFCRFS   EQU   JFCRECFM                                                 16017000
JFCRFB   EQU   JFCRECFM                                                 16018000
JFCRFO   EQU   JFCRCFM                                                  16019000
JFCFMREC EQU   JFCRCFM                                                  16020000
JFCRSV16 EQU   JFCDSRG2                                                 16021000
JFCRSV15 EQU   JFCDSRG2                                                 16022000
JFCORGTR EQU   JFCDSRG2                                                 16023000
JFCORGAM EQU   JFCDSRG2                                                 16024000
JFCRSV13 EQU   JFCDSRG2                                                 16025000
JFCORGTQ EQU   JFCDSRG2                                                 16026000
JFCORGTX EQU   JFCDSRG2                                                 16027000
JFCORGGS EQU   JFCDSRG2                                                 16028000
JFCORGU  EQU   JFCDSRG1                                                 16029000
JFCORGPO EQU   JFCDSRG1                                                 16030000
JFCORGMQ EQU   JFCDSRG1                                                 16031000
JFCORGCQ EQU   JFCDSRG1                                                 16032000
JFCORGCX EQU   JFCDSRG1                                                 16033000
JFCORGDA EQU   JFCDSRG1                                                 16034000
JFCORGPS EQU   JFCDSRG1                                                 16035000
JFCORGIS EQU   JFCDSRG1                                                 16036000
JFCTRKBL EQU   JFCLIMCT+1                                               16037000
@NM00122 EQU   JFCLIMCT                                                 16038000
JFCDEN   EQU   JFCSPPRT+1                                               16039000
JFCPRTSP EQU   JFCSPPRT                                                 16040000
JFCONE   EQU   JFCMODE                                                  16041000
JFCTWO   EQU   JFCMODE                                                  16042000
JFCRSV07 EQU   JFCMODE                                                  16043000
JFCRSV06 EQU   JFCMODE                                                  16044000
JFCMODER EQU   JFCMODE                                                  16045000
JFCMODEO EQU   JFCMODE                                                  16046000
JFCEBCD  EQU   JFCMODE                                                  16047000
JFCBIN   EQU   JFCMODE                                                  16048000
JFCRSV32 EQU   JFCCODE                                                  16049000
JFCTTY   EQU   JFCCODE                                                  16050000
JFCASCII EQU   JFCCODE                                                  16051000
JFCNCR   EQU   JFCCODE                                                  16052000
JFCBUR   EQU   JFCCODE                                                  16053000
JFCFRI   EQU   JFCCODE                                                  16054000
JFCBCD   EQU   JFCCODE                                                  16055000
JFCNOCON EQU   JFCCODE                                                  16056000
UCBRV066 EQU   UCBOBS09+4                                               16057000
UCBIOSBA EQU   UCBOBS09                                                 16058000
UCBRV042 EQU   UCBOBS08+5                                               16059000
UCBRV082 EQU   UCBCTCF1                                                 16060000
UCBRV081 EQU   UCBCTCF1                                                 16061000
UCBRV080 EQU   UCBCTCF1                                                 16062000
UCBRV079 EQU   UCBCTCF1                                                 16063000
UCBRV078 EQU   UCBCTCF1                                                 16064000
UCBRV077 EQU   UCBCTCF1                                                 16065000
UCBRV076 EQU   UCBCTCF1                                                 16066000
UCBCTC80 EQU   UCBCTCF1                                                 16067000
UCBCTCAL EQU   UCBCTCAD                                                 16068000
UCBICNCB EQU   UCBOBS07+4                                               16069000
UCBRV040 EQU   UCBOBS07                                                 16070000
UCBCTLNA EQU   UCBCTLNK+1                                               16071000
UCBRLN   EQU   UCBCTLNK                                                 16072000
UCBRDYQA EQU   UCBLDNCB                                                 16073000
UCBINRLN EQU   UCBIRLN                                                  16074000
UCBIRBA  EQU   UCBIRB+1                                                 16075000
UCBRV039 EQU   UCBGRAF                                                  16076000
UCBDWNR  EQU   UCBGRAF                                                  16077000
UCBRPND  EQU   UCBGRAF                                                  16078000
UCBUPM   EQU   UCBGRAF                                                  16079000
UCBBTAM  EQU   UCBGRAF                                                  16080000
UCBDRNO  EQU   UCBGRAF                                                  16081000
UCBDRO   EQU   UCBGRAF                                                  16082000
UCBOIP   EQU   UCBGRAF                                                  16083000
UCBATRCD EQU   @NM00103                                                 16084000
UCBSKPFG EQU   @NM00103                                                 16085000
UCBRIPND EQU   @NM00103                                                 16086000
UCBRTIAC EQU   @NM00103                                                 16087000
UCBRSV79 EQU   @NM00103                                                 16088000
UCBRSV78 EQU   @NM00103                                                 16089000
UCBRSV77 EQU   @NM00103                                                 16090000
UCBOLTEP EQU   @NM00103                                                 16091000
UCBATNCT EQU   UCBOBS06+2                                               16092000
UCBRSV76 EQU   UCBAOF2                                                  16093000
UCBRSV75 EQU   UCBAOF2                                                  16094000
UCBRSV74 EQU   UCBAOF2                                                  16095000
UCBRSV73 EQU   UCBAOF2                                                  16096000
UCBRSV72 EQU   UCBAOF2                                                  16097000
UCBRSV71 EQU   UCBAOF2                                                  16098000
UCBRSV70 EQU   UCBAOF2                                                  16099000
UCBRSV69 EQU   UCBAOF2                                                  16100000
UCBRSV68 EQU   UCBAOF1                                                  16101000
UCBRSV67 EQU   UCBAOF1                                                  16102000
UCBRSV66 EQU   UCBAOF1                                                  16103000
UCBRSV65 EQU   UCBAOF1                                                  16104000
UCBRSV64 EQU   UCBAOF1                                                  16105000
UCBOFNL  EQU   UCBAOF1                                                  16106000
UCBOFSP  EQU   UCBAOF1                                                  16107000
UCBOFMCR EQU   UCBAOF1                                                  16108000
UCBBTB   EQU   UCBBTA+1                                                 16109000
UCBDI    EQU   UCBBTA                                                   16110000
UCBSNS   EQU   UCBOBS04+8                                               16111000
UCBTEB   EQU   UCBOBS04+4                                               16112000
UCBGCB   EQU   UCBOBS04+3                                               16113000
UCBOPEN  EQU   UCBOBS04+2                                               16114000
UCBSTART EQU   UCBOBS04                                                 16115000
UCBXTNB  EQU   UCBXTN+1                                                 16116000
UCBRSV22 EQU   UCBVOPT                                                  16117000
UCBRSV21 EQU   UCBVOPT                                                  16118000
UCBRSV20 EQU   UCBVOPT                                                  16119000
UCBESVE  EQU   UCBVOPT                                                  16120000
UCBERPC  EQU   UCBVOPT                                                  16121000
UCBESVC  EQU   UCBVOPT                                                  16122000
UCBEVA   EQU   UCBVOPT                                                  16123000
UCBESV   EQU   UCBVOPT                                                  16124000
UCBRV009 EQU   UCBTFL1                                                  16125000
UCBRV008 EQU   UCBTFL1                                                  16126000
UCBRV007 EQU   UCBTFL1                                                  16127000
UCBRV006 EQU   UCBTFL1                                                  16128000
UCBRV005 EQU   UCBTFL1                                                  16129000
UCBDQDSP EQU   UCBTFL1                                                  16130000
UCBNSLTP EQU   UCBTFL1                                                  16131000
UCBNLTP  EQU   UCBTFL1                                                  16132000
UCBRES1B EQU   UCBOBS02+18                                              16133000
UCBFSER  EQU   UCBOBS02+12                                              16134000
@NM00102 EQU   UCBOBS02+4                                               16135000
UCBFSEQ  EQU   UCBOBS02+2                                               16136000
UCBFSCT  EQU   UCBOBS02                                                 16137000
UCBNEXP  EQU   UCBOBS01+20                                              16138000
UCBBASE  EQU   UCBOBS01+16                                              16139000
UCBRES1A EQU   UCBOBS01+15                                              16140000
UCBUSER  EQU   UCBOBS01+14                                              16141000
UCBFL47  EQU   UCBFL4                                                   16142000
UCBFL46  EQU   UCBFL4                                                   16143000
UCBFL45  EQU   UCBFL4                                                   16144000
UCBRV065 EQU   UCBFL4                                                   16145000
UCBDSS   EQU   UCBFL4                                                   16146000
UCBRESVP EQU   UCBFL4                                                   16147000
UCBWDAV  EQU   UCBFL4                                                   16148000
UCBDAVV  EQU   UCBFL4                                                   16149000
UCBSQC   EQU   UCBOBS01+12                                              16150000
UCBDATP  EQU   UCBOBS01+12                                              16151000
UCBDMC   EQU   UCBDMCT                                                  16152000
UCBMOUNT EQU   UCBDMCT                                                  16153000
UCBBNUL  EQU   UCBSTAB                                                  16154000
UCBSHAR  EQU   UCBSTAB                                                  16155000
UCBBSTR  EQU   UCBSTAB                                                  16156000
UCBBPUB  EQU   UCBSTAB                                                  16157000
UCBBPRV  EQU   UCBSTAB                                                  16158000
UCBBALB  EQU   UCBPRSRS                                                 16159000
UCBPGFL  EQU   UCBSTAB                                                  16160000
UCBDVSHR EQU   UCBBSVL                                                  16161000
UCBVOLI  EQU   UCBOBS01+4                                               16162000
GDTECT   EQU   GDTTBL+188                                               16163000
GDTPSB   EQU   GDTTBL+184                                               16164000
GDTUPT   EQU   GDTTBL+180                                               16165000
GDTCMB   EQU   GDTTBL+176                                               16166000
GDTSPR   EQU   GDTTBL+168                                               16167000
@NM00001 EQU   GDTTBL+160                                               16168000
GDTTOH   EQU   GDTTBL+120                                               16169000
GDTRIP   EQU   GDTTBL+116                                               16170000
GDTTPH   EQU   GDTTBL+28                                                16171000
GDTRIH   EQU   GDTTBL+24                                                16172000
GDTSTH   EQU   GDTTBL+20                                                16173000
GDTDBH   EQU   GDTTBL+16                                                16174000
GDTPRM   EQU   GDTTBL+4                                                 16175000
GDTHDR   EQU   GDTTBL                                                   16176000
@NM00210 EQU   SYNADMSG+15                                              16177000
@NM00209 EQU   SYNADMSG                                                 16178000
@NM00208 EQU   ERRORMSG                                                 16179000
@NM00206 EQU   VTOCLOC+3                                                16180000
VTOCR    EQU   VTOCLOC+2                                                16181000
@NM00205 EQU   CNTCCHHR                                                 16182000
@NM00204 EQU   CCW+5                                                    16183000
@NM00203 EQU   CCW+4                                                    16184000
@NM00202 EQU   CCW+4                                                    16185000
CCWDATCH EQU   CCW+4                                                    16186000
VSMER    EQU   VSMEXTS+12                                               16187000
@NM00200 EQU   VSMEXTS+5                                                16188000
VSMBR    EQU   VSMEXTS+4                                                16189000
@NM00199 EQU   RTNEXTS+9                                                16190000
@NM00196 EQU   IOXEXLST+4                                               16191000
@NM00195 EQU   IOXEXLST                                                 16192000
@NM00194 EQU   IOCTLBK+26                                               16193000
@NM00193 EQU   IOXFLGS                                                  16194000
WBREC    EQU   WBCCHHR+4                                                16195000
WBHH     EQU   WBCCHHR+2                                                16196000
WBCC     EQU   WBCCHHR                                                  16197000
RKEYDAT  EQU   RBUF+8                                                   16198000
RBHH     EQU   RBCCHHR+2                                                16199000
RBCC     EQU   RBCCHHR                                                  16200000
@NM00191 EQU   RKEYFLG+4                                                16201000
RKEYFLG3 EQU   RKEYFLG+3                                                16202000
RKEYFLG2 EQU   RKEYFLG+1                                                16203000
RKEYFLG1 EQU   RKEYFLG                                                  16204000
RKEYR    EQU   RKEYCHR+4                                                16205000
RKEYHH   EQU   RKEYCHR+2                                                16206000
RKEYCC   EQU   RKEYCHR                                                  16207000
RKEYVOL  EQU   RKEY                                                     16208000
@NM00190 EQU   RIOHDR+26                                                16209000
@NM00189 EQU   RIOHDR+10                                                16210000
@NM00188 EQU   RIOHDR+7                                                 16211000
RPREVR   EQU   RPREV+4                                                  16212000
RPREVHH  EQU   RPREV+2                                                  16213000
RPREVCC  EQU   RPREV                                                    16214000
@NM00187 EQU   RIOHDR+1                                                 16215000
@NM00186 EQU   LOCTAB+16                                                16216000
CVTLEVL  EQU   CVTRELNO+2                                               16217000
CVTNUMB  EQU   CVTRELNO                                                 16218000
CVTMDL   EQU   CVTFIX+250                                               16219000
@NM00185 EQU   CVTFIX+248                                               16220000
@NM00184 EQU   CVTFIX                                                   16221000
CVTRV482 EQU   CVTXTNT2+128                                             16222000
CVTRV481 EQU   CVTXTNT2+124                                             16223000
CVTRV480 EQU   CVTXTNT2+120                                             16224000
CVTRV479 EQU   CVTXTNT2+118                                             16225000
CVTRV478 EQU   CVTXTNT2+117                                             16226000
CVTRV477 EQU   CVTXTNT2+116                                             16227000
CVTRV476 EQU   CVTXTNT2+115                                             16228000
CVTRV475 EQU   CVTXTNT2+114                                             16229000
CVTRV474 EQU   CVTRV466                                                 16230000
CVTRV473 EQU   CVTRV466                                                 16231000
CVTRV472 EQU   CVTRV466                                                 16232000
CVTRV471 EQU   CVTRV466                                                 16233000
CVTRV470 EQU   CVTRV466                                                 16234000
CVTRV469 EQU   CVTRV466                                                 16235000
CVTRV468 EQU   CVTRV466                                                 16236000
CVTRV467 EQU   CVTRV466                                                 16237000
CVTRV465 EQU   CVTRV457                                                 16238000
CVTRV464 EQU   CVTRV457                                                 16239000
CVTRV463 EQU   CVTRV457                                                 16240000
CVTRV462 EQU   CVTRV457                                                 16241000
CVTRV461 EQU   CVTRV457                                                 16242000
CVTRV460 EQU   CVTRV457                                                 16243000
CVTRV459 EQU   CVTRV457                                                 16244000
CVTRV458 EQU   CVTRV457                                                 16245000
CVTRV456 EQU   CVTXTNT2+108                                             16246000
CVTRV455 EQU   CVTXTNT2+104                                             16247000
CVTRV454 EQU   CVTXTNT2+100                                             16248000
CVTRV453 EQU   CVTXTNT2+96                                              16249000
CVTRV452 EQU   CVTXTNT2+94                                              16250000
CVTRV451 EQU   CVTXTNT2+92                                              16251000
CVTRV450 EQU   CVTXTNT2+90                                              16252000
CVTRV449 EQU   CVTXTNT2+88                                              16253000
CVTRV448 EQU   CVTXTNT2+87                                              16254000
CVTRV447 EQU   CVTXTNT2+86                                              16255000
CVTRV446 EQU   CVTRV438                                                 16256000
CVTRV445 EQU   CVTRV438                                                 16257000
CVTRV444 EQU   CVTRV438                                                 16258000
CVTRV443 EQU   CVTRV438                                                 16259000
CVTRV442 EQU   CVTRV438                                                 16260000
CVTRV441 EQU   CVTRV438                                                 16261000
CVTRV440 EQU   CVTRV438                                                 16262000
CVTRV439 EQU   CVTRV438                                                 16263000
CVTRV437 EQU   CVTRV429                                                 16264000
CVTRV436 EQU   CVTRV429                                                 16265000
CVTRV435 EQU   CVTRV429                                                 16266000
CVTRV434 EQU   CVTRV429                                                 16267000
CVTRV433 EQU   CVTRV429                                                 16268000
CVTRV432 EQU   CVTRV429                                                 16269000
CVTRV431 EQU   CVTRV429                                                 16270000
CVTRV430 EQU   CVTRV429                                                 16271000
CVTRV428 EQU   CVTXTNT2+80                                              16272000
CVTRV427 EQU   CVTXTNT2+76                                              16273000
CVTRV426 EQU   CVTXTNT2+72                                              16274000
CVTRV425 EQU   CVTXTNT2+68                                              16275000
CVTATACT EQU   CVTATCVT                                                 16276000
CVTRV423 EQU   CVTXTNT2+62                                              16277000
CVTRV422 EQU   CVTXTNT2+60                                              16278000
CVTRV421 EQU   CVTXTNT2+58                                              16279000
CVTRV420 EQU   CVTXTNT2+56                                              16280000
CVTRV419 EQU   CVTXTNT2+55                                              16281000
CVTRV418 EQU   CVTXTNT2+54                                              16282000
CVTRV417 EQU   CVTRV409                                                 16283000
CVTRV416 EQU   CVTRV409                                                 16284000
CVTRV415 EQU   CVTRV409                                                 16285000
CVTRV414 EQU   CVTRV409                                                 16286000
CVTRV413 EQU   CVTRV409                                                 16287000
CVTRV412 EQU   CVTRV409                                                 16288000
CVTRV411 EQU   CVTRV409                                                 16289000
CVTRV410 EQU   CVTRV409                                                 16290000
CVTRV408 EQU   CVTRV400                                                 16291000
CVTRV407 EQU   CVTRV400                                                 16292000
CVTRV406 EQU   CVTRV400                                                 16293000
CVTRV405 EQU   CVTRV400                                                 16294000
CVTRV404 EQU   CVTRV400                                                 16295000
CVTRV403 EQU   CVTRV400                                                 16296000
CVTRV402 EQU   CVTRV400                                                 16297000
CVTRV401 EQU   CVTRV400                                                 16298000
CVTICB   EQU   CVTXTNT2+48                                              16299000
CVTSKTA  EQU   CVTXTNT2+44                                              16300000
CVTRSV99 EQU   CVTXTNT2+40                                              16301000
CVTRSV98 EQU   CVTXTNT2+36                                              16302000
CVTRSV97 EQU   CVTXTNT2+34                                              16303000
CVTRSV96 EQU   CVTXTNT2+32                                              16304000
CVTOLTEP EQU   CVTXTNT2+28                                              16305000
CVTQIDA  EQU   CVTQID+1                                                 16306000
CVTRSV95 EQU   CVTQID                                                   16307000
CVTRSV94 EQU   CVTXTNT2+20                                              16308000
CVTRSV93 EQU   CVTXTNT2+16                                              16309000
CVTRSV92 EQU   CVTXTNT2+12                                              16310000
CVTDEBVR EQU   CVTXTNT2+8                                               16311000
CVTRSV91 EQU   CVTXTNT2+6                                               16312000
CVTRSV9H EQU   CVTFLGBT                                                 16313000
CVTRSV9G EQU   CVTFLGBT                                                 16314000
CVTRSV9F EQU   CVTFLGBT                                                 16315000
CVTRSV9E EQU   CVTFLGBT                                                 16316000
CVTRSV9D EQU   CVTFLGBT                                                 16317000
CVTRSV9C EQU   CVTFLGBT                                                 16318000
CVTVME   EQU   CVTFLGBT                                                 16319000
CVTNPE   EQU   CVTFLGBT                                                 16320000
CVTNUCLS EQU   CVTXTNT2+4                                               16321000
CVTDSSVA EQU   CVTDSSV+1                                                16322000
CVTRSV89 EQU   CVTDSSV                                                  16323000
CVTRSV88 EQU   CVTXTNT1+8                                               16324000
CVTRSV87 EQU   CVTXTNT1+4                                               16325000
CVTFACHN EQU   CVTXTNT1                                                 16326000
CVTRV488 EQU   CVTMAP+412                                               16327000
CVTRV487 EQU   CVTMAP+408                                               16328000
CVTRV486 EQU   CVTMAP+404                                               16329000
CVTRV485 EQU   CVTMAP+400                                               16330000
CVTACTAP EQU   CVTMAP+396                                               16331000
CVTAUTH  EQU   CVTMAP+392                                               16332000
CVTATMCA EQU   CVTATMCT+1                                               16333000
CVTATMST EQU   CVTATMCT                                                 16334000
CVTRSV61 EQU   CVTMAP+384                                               16335000
CVTVOLT1 EQU   CVTVOLM1+1                                               16336000
CVTVOLI1 EQU   CVTVOLF1                                                 16337000
CVTSTOA  EQU   CVTMAP+376                                               16338000
CVTRSV58 EQU   CVTMAP+374                                               16339000
CVTRSV57 EQU   CVTMAP+372                                               16340000
CVTDDCE  EQU   CVTMAP+368                                               16341000
CVTPNWFR EQU   CVTMAP+364                                               16342000
CVTSMF   EQU   CVTMAP+360                                               16343000
CVTSULK  EQU   CVTMAP+358                                               16344000
CVTSLKO  EQU   CVTSYSK                                                  16345000
CVTSLKP  EQU   CVTSYSK                                                  16346000
CVTSLKQ  EQU   CVTSYSK                                                  16347000
CVTSLKR  EQU   CVTSYSK                                                  16348000
CVTRSV56 EQU   CVTSYSK                                                  16349000
CVTRSV55 EQU   CVTSYSK                                                  16350000
CVTRSV54 EQU   CVTSYSK                                                  16351000
CVTRSV53 EQU   CVTSYSK                                                  16352000
CVTRSV52 EQU   CVTA1F1                                                  16353000
CVTRSV51 EQU   CVTA1F1                                                  16354000
CVTRSV50 EQU   CVTA1F1                                                  16355000
CVTRSV49 EQU   CVTA1F1                                                  16356000
CVTRSV48 EQU   CVTA1F1                                                  16357000
CVTRSV47 EQU   CVTA1F1                                                  16358000
CVTSRSW  EQU   CVTA1F1                                                  16359000
CVTPFSW  EQU   CVTA1F1                                                  16360000
CVTPCVT  EQU   CVTMAP+352                                               16361000
CVTRSV46 EQU   CVTMAP+344                                               16362000
CVTRSV45 EQU   CVTMAP+340                                               16363000
CVTRSV44 EQU   CVTMAP+338                                               16364000
CVTRSV43 EQU   CVTMAP+336                                               16365000
CVTHJESA EQU   CVTHJES+1                                                16366000
CVTRSV42 EQU   CVTHJES                                                  16367000
CVTEXT2A EQU   CVTEXT2+1                                                16368000
CVTRSV41 EQU   CVTEXT2                                                  16369000
CVTAPFA  EQU   CVTAPF+1                                                 16370000
CVTRSV40 EQU   CVTAPF                                                   16371000
CVTRV518 EQU   CVTINTLA                                                 16372000
CVTRV517 EQU   CVTERPV                                                  16373000
CVTEORM  EQU   CVTMAP+312                                               16374000
CVTMCHPR EQU   CVTMAP+308                                               16375000
CVTTZ    EQU   CVTMAP+304                                               16376000
CVTJEPS  EQU   CVTMAP+300                                               16377000
CVTJESCT EQU   CVTMAP+296                                               16378000
CVTMODE  EQU   CVTMAP+292                                               16379000
CVTPTRV  EQU   CVTMAP+288                                               16380000
CVTREAL  EQU   CVTMAP+284                                               16381000
CVTRSV39 EQU   CVTMAP+280                                               16382000
CVTRSV38 EQU   CVTMAP+276                                               16383000
CVTDMSRA EQU   CVTDMSR+1                                                16384000
CVTRV634 EQU   CVTDMSRF                                                 16385000
CVTRV633 EQU   CVTDMSRF                                                 16386000
CVTRV632 EQU   CVTDMSRF                                                 16387000
CVTRV631 EQU   CVTDMSRF                                                 16388000
CVTRV630 EQU   CVTDMSRF                                                 16389000
CVTRV629 EQU   CVTDMSRF                                                 16390000
CVTUDUMP EQU   CVTDMSRF                                                 16391000
CVTSDUMP EQU   CVTDMSRF                                                 16392000
CVTQMSGA EQU   CVTQMSG+1                                                16393000
CVTRSV36 EQU   CVTQMSG                                                  16394000
CVTAMFF  EQU   CVTMAP+264                                               16395000
CVTPURGA EQU   CVTPURG+1                                                16396000
CVTRSV35 EQU   CVTPURG                                                  16397000
CVTCBSP  EQU   CVTMAP+256                                               16398000
CVTATERA EQU   CVTATER+1                                                16399000
CVTSYST  EQU   CVTATER                                                  16400000
CVTVOLT2 EQU   CVTTAT                                                   16401000
CVTVOLI2 EQU   CVTVOLF2                                                 16402000
CVTAQAVB EQU   CVTAQAVT+1                                               16403000
CVTRSV34 EQU   CVTTCMFG                                                 16404000
CVTRSV33 EQU   CVTTCMFG                                                 16405000
CVTRSV32 EQU   CVTTCMFG                                                 16406000
CVTRSV31 EQU   CVTTCMFG                                                 16407000
CVTRSV30 EQU   CVTTCMFG                                                 16408000
CVTRSV29 EQU   CVTTCMFG                                                 16409000
CVTRSV28 EQU   CVTTCMFG                                                 16410000
CVTTCRDY EQU   CVTTCMFG                                                 16411000
CVTGTFA  EQU   CVTGTF+1                                                 16412000
CVTRSV27 EQU   CVTGTFST                                                 16413000
CVTRNIO  EQU   CVTGTFST                                                 16414000
CVTUSR   EQU   CVTGTFST                                                 16415000
CVTRV318 EQU   CVTFORM                                                  16416000
CVTRV317 EQU   CVTTMODE                                                 16417000
CVTRV316 EQU   CVTSTATE                                                 16418000
CVTRV315 EQU   CVTGTFS                                                  16419000
CVTGTFAV EQU   CVTGTFS                                                  16420000
CVT0SCR1 EQU   CVTMAP+232                                               16421000
CVTRV515 EQU   CVTMAP+228                                               16422000
CVTRMS   EQU   CVTMAP+224                                               16423000
CVTPATCH EQU   CVTMAP+220                                               16424000
CVTTSCE  EQU   CVTMAP+216                                               16425000
CVTLNKSC EQU   CVTMAP+214                                               16426000
CVTQABST EQU   CVTMAP+212                                               16427000
CVTMDLDS EQU   CVTMAP+208                                               16428000
CVTUSER  EQU   CVTMAP+204                                               16429000
CVTABEND EQU   CVTMAP+200                                               16430000
CVTSMCA  EQU   CVTMAP+196                                               16431000
CVTRSV18 EQU   CVTMAP+192                                               16432000
CVTQLPAQ EQU   CVTMAP+188                                               16433000
CVTQCDSR EQU   CVTMAP+184                                               16434000
CVTRSV17 EQU   CVTOPTB                                                  16435000
CVTRSV16 EQU   CVTOPTB                                                  16436000
CVTFP    EQU   CVTOPTB                                                  16437000
CVTAPTHR EQU   CVTOPTB                                                  16438000
CVTNLOG  EQU   CVTOPTB                                                  16439000
CVTTOD   EQU   CVTOPTB                                                  16440000
CVTCTIMS EQU   CVTOPTB                                                  16441000
CVTPROT  EQU   CVTOPTB                                                  16442000
CVTXPFP  EQU   CVTOPTA                                                  16443000
CVTASCII EQU   CVTOPTA                                                  16444000
CVTRSV13 EQU   CVTOPTA                                                  16445000
CVTRSV12 EQU   CVTOPTA                                                  16446000
CVTNIP   EQU   CVTOPTA                                                  16447000
CVTDDR   EQU   CVTOPTA                                                  16448000
CVTAPR   EQU   CVTOPTA                                                  16449000
CVTCCH   EQU   CVTOPTA                                                  16450000
CVTSNCTR EQU   CVTMAP+180                                               16451000
CVTQMWR  EQU   CVTMAP+176                                               16452000
CVTQOCR  EQU   CVTMAP+172                                               16453000
CVT1EF00 EQU   CVTMAP+168                                               16454000
CVTMZ00  EQU   CVTMAP+164                                               16455000
CVTSV76Q EQU   CVTSV76C                                                 16456000
CVTRSV11 EQU   CVTMAP+156                                               16457000
CVT0PT01 EQU   CVTMAP+152                                               16458000
CVTMSER  EQU   CVTMAP+148                                               16459000
CVTRV516 EQU   CVTIERLC                                                 16460000
CVTILCH  EQU   CVTMAP+140                                               16461000
CVT0DS   EQU   CVTMAP+136                                               16462000
CVTFBOSV EQU   CVTMAP+132                                               16463000
CVTNUCB  EQU   CVTMAP+128                                               16464000
CVTIXAVL EQU   CVTMAP+124                                               16465000
CVTSV76M EQU   CVTIOQET                                                 16466000
CVTDCBA  EQU   CVTMAP+117                                               16467000
CVTMVS2  EQU   CVTDCB                                                   16468000
CVT6DAT  EQU   CVTDCB                                                   16469000
CVT4MPS  EQU   CVTDCB                                                   16470000
CVTRSV09 EQU   CVTDCB                                                   16471000
CVT4MS1  EQU   CVTDCB                                                   16472000
CVT2SPS  EQU   CVTDCB                                                   16473000
CVT1SSS  EQU   CVTDCB                                                   16474000
CVTRSV08 EQU   CVTDCB                                                   16475000
CVTSTB   EQU   CVTMAP+112                                               16476000
CVTQTD00 EQU   CVTMAP+108                                               16477000
CVTQTE00 EQU   CVTMAP+104                                               16478000
CVTCUCB  EQU   CVTMAP+100                                               16479000
CVTSJQ   EQU   CVTMAP+96                                                16480000
CVTPBLDL EQU   CVTMAP+92                                                16481000
CVTTPC   EQU   CVTMAP+88                                                16482000
CVTSVDCB EQU   CVTMAP+84                                                16483000
CVTBRET  EQU   CVTMAP+82                                                16484000
CVTEXIT  EQU   CVTMAP+80                                                16485000
CVT0FN00 EQU   CVTMAP+76                                                16486000
CVTDARA  EQU   CVTDAR+1                                                 16487000
CVTRSV07 EQU   CVTFLGS1                                                 16488000
CVTRSV06 EQU   CVTFLGS1                                                 16489000
CVTRSV05 EQU   CVTFLGS1                                                 16490000
CVTRSV04 EQU   CVTFLGS1                                                 16491000
CVTRSV03 EQU   CVTFLGS1                                                 16492000
CVTRSV02 EQU   CVTFLGS1                                                 16493000
CVTRSV01 EQU   CVTFLGS1                                                 16494000
CVTDMPLK EQU   CVTFLGS1                                                 16495000
CVTXITP  EQU   CVTMAP+68                                                16496000
CVTZDTAB EQU   CVTMAP+64                                                16497000
CVTMSLT  EQU   CVTMAP+60                                                16498000
CVTDATE  EQU   CVTMAP+56                                                16499000
CVTBTERM EQU   CVTMAP+52                                                16500000
CVTSYSAD EQU   CVTMAP+48                                                16501000
CVTXTLER EQU   CVTMAP+44                                                16502000
CVTILK2  EQU   CVTMAP+40                                                16503000
CVTILK1  EQU   CVTMAP+36                                                16504000
CVTPRLTV EQU   CVTMAP+32                                                16505000
CVTPCNVT EQU   CVTMAP+28                                                16506000
CVT0VL00 EQU   CVTMAP+24                                                16507000
CVTXAPG  EQU   CVTMAP+20                                                16508000
CVTBUF   EQU   CVTMAP+16                                                16509000
CVTJOB   EQU   CVTMAP+12                                                16510000
CVTLINK  EQU   CVTMAP+8                                                 16511000
CVT0EF00 EQU   CVTMAP+4                                                 16512000
CVTTCBP  EQU   CVTMAP                                                   16513000
CVT      EQU   CVTMAP                                                   16514000
@NM00183 EQU   SDWA+512                                                 16515000
SDWAVRA  EQU   SDWARA+4                                                 16516000
SDWAURAL EQU   SDWARA+3                                                 16517000
@NM00182 EQU   SDWADPVA                                                 16518000
SDWAEBC  EQU   SDWADPVA                                                 16519000
SDWAHEX  EQU   SDWADPVA                                                 16520000
SDWAVRAL EQU   SDWARA                                                   16521000
@NM00181 EQU   SDWA+396                                                 16522000
SDWACOMP EQU   SDWA+392                                                 16523000
SDWARCPL EQU   SDWA+364                                                 16524000
@NM00180 EQU   SDWADPSA+32                                              16525000
SDWATO4  EQU   SDWADPSL+28                                              16526000
SDWAFRM4 EQU   SDWADPSL+24                                              16527000
SDWATO3  EQU   SDWADPSL+20                                              16528000
SDWAFRM3 EQU   SDWADPSL+16                                              16529000
SDWATO2  EQU   SDWADPSL+12                                              16530000
SDWAFRM2 EQU   SDWADPSL+8                                               16531000
SDWATO1  EQU   SDWADPSL+4                                               16532000
SDWAFRM1 EQU   SDWADPSL                                                 16533000
@NM00179 EQU   SDWADDAT+3                                               16534000
@NM00178 EQU   SDWAPDAT                                                 16535000
SDWAUSPL EQU   SDWAPDAT                                                 16536000
SDWADPSW EQU   SDWAPDAT                                                 16537000
SDWATJPA EQU   SDWAPDAT                                                 16538000
SDWATLPA EQU   SDWAPDAT                                                 16539000
SDWADREG EQU   SDWAPDAT                                                 16540000
SDWADSAH EQU   SDWAPDAT                                                 16541000
SDWADSAS EQU   SDWAPDAT                                                 16542000
@NM00177 EQU   SDWADDAT+1                                               16543000
@NM00176 EQU   SDWASDAT                                                 16544000
SDWAQQS  EQU   SDWASDAT                                                 16545000
SDWACBS  EQU   SDWASDAT                                                 16546000
SDWAGTF  EQU   SDWASDAT                                                 16547000
SDWASWA  EQU   SDWASDAT                                                 16548000
SDWALSQA EQU   SDWASDAT                                                 16549000
SDWASQA  EQU   SDWASDAT                                                 16550000
SDWANUC  EQU   SDWASDAT                                                 16551000
@NM00175 EQU   SDWADUMP+2                                               16552000
@NM00174 EQU   SDWADPFS                                                 16553000
SDWASLST EQU   SDWADPFS                                                 16554000
@NM00173 EQU   SDWADPFS                                                 16555000
SDWADLST EQU   SDWADPFS                                                 16556000
SDWADPT  EQU   SDWADPFS                                                 16557000
SDWADPID EQU   SDWADUMP                                                 16558000
SDWADPLA EQU   SDWA+316                                                 16559000
SDWAREXN EQU   SDWARECP+16                                              16560000
SDWACSCT EQU   SDWARECP+8                                               16561000
SDWAMODN EQU   SDWARECP                                                 16562000
@NM00172 EQU   SDWALKWA+32                                              16563000
SDWATALW EQU   SDWALKWS+28                                              16564000
SDWATDLW EQU   SDWALKWS+24                                              16565000
SDWATNLW EQU   SDWALKWS+20                                              16566000
SDWAAPLW EQU   SDWALKWS+16                                              16567000
SDWAIPLW EQU   SDWALKWS+12                                              16568000
SDWAILLW EQU   SDWALKWS+8                                               16569000
SDWAIULW EQU   SDWALKWS+4                                               16570000
SDWAICLW EQU   SDWALKWS                                                 16571000
SDWAFLLK EQU   SDWAACF4                                                 16572000
SDWACMS  EQU   SDWAACF4                                                 16573000
SDWAOPTM EQU   SDWAACF4                                                 16574000
SDWATADB EQU   SDWAACF4                                                 16575000
SDWATDNB EQU   SDWAACF4                                                 16576000
SDWATNCB EQU   SDWAACF4                                                 16577000
SDWAILCH EQU   SDWAACF4                                                 16578000
SDWAIUCB EQU   SDWAACF4                                                 16579000
SDWAICAT EQU   SDWAACF3                                                 16580000
SDWAIPRG EQU   SDWAACF3                                                 16581000
SDWASALL EQU   SDWAACF3                                                 16582000
SDWAASMP EQU   SDWAACF3                                                 16583000
SDWADISP EQU   SDWAACF3                                                 16584000
@NM00171 EQU   SDWAACF3                                                 16585000
@NM00170 EQU   SDWAACF2                                                 16586000
SDWAFREE EQU   SDWAACF2                                                 16587000
SDWAUPRG EQU   SDWAACF2                                                 16588000
@NM00169 EQU   SDWAACF2                                                 16589000
SDWASPIN EQU   SDWAACF2                                                 16590000
@NM00168 EQU   SDWAACF2                                                 16591000
SDWARCRD EQU   SDWAACF2                                                 16592000
SDWARCDE EQU   SDWAPARQ                                                 16593000
SDWALCPU EQU   SDWACPUA+2                                               16594000
@NM00167 EQU   SDWACPUA                                                 16595000
SDWARECA EQU   SDWA+244                                                 16596000
SDWARTYA EQU   SDWA+240                                                 16597000
@NM00166 EQU   SDWA+239                                                 16598000
@NM00165 EQU   SDWAIOFS                                                 16599000
SDWANIOP EQU   SDWAIOFS                                                 16600000
SDWANOIO EQU   SDWAIOFS                                                 16601000
SDWAIOHT EQU   SDWAIOFS                                                 16602000
SDWAIOQR EQU   SDWAIOFS                                                 16603000
SDWAFMID EQU   SDWA+236                                                 16604000
@NM00164 EQU   SDWAERRD                                                 16605000
SDWAMCIV EQU   SDWAERRD                                                 16606000
SDWARPIV EQU   SDWAERRD                                                 16607000
SDWAMABD EQU   SDWAERRD                                                 16608000
SDWACTS  EQU   SDWAERRD                                                 16609000
SDWASTAE EQU   SDWAERRD                                                 16610000
SDWANRBE EQU   SDWAERRD                                                 16611000
SDWACLUP EQU   SDWAERRD                                                 16612000
@NM00163 EQU   SDWAERRC                                                 16613000
SDWAEAS  EQU   SDWAERRC                                                 16614000
SDWAPERC EQU   SDWAERRC                                                 16615000
SDWAIRB  EQU   SDWAERRC                                                 16616000
SDWASTAI EQU   SDWAERRC                                                 16617000
SDWASTAF EQU   SDWAERRC                                                 16618000
SDWASRBM EQU   SDWAERRB                                                 16619000
SDWALDIS EQU   SDWAERRB                                                 16620000
SDWAENRB EQU   SDWAERRB                                                 16621000
SDWATYP1 EQU   SDWAERRB                                                 16622000
@NM00162 EQU   SDWAERRB                                                 16623000
SDWAPGIO EQU   SDWAERRA                                                 16624000
SDWATEXC EQU   SDWAERRA                                                 16625000
SDWASVCE EQU   SDWAERRA                                                 16626000
SDWAABTM EQU   SDWAERRA                                                 16627000
SDWASVCD EQU   SDWAERRA                                                 16628000
SDWARKEY EQU   SDWAERRA                                                 16629000
SDWAPCHK EQU   SDWAERRA                                                 16630000
SDWAMCHK EQU   SDWAERRA                                                 16631000
SDWATIME EQU   SDWAMCH+20                                               16632000
SDWARFSA EQU   SDWAMCH+16                                               16633000
@NM00161 EQU   SDWAMCH+14                                               16634000
SDWAVEQR EQU   SDWARSR2                                                 16635000
SDWAPGFX EQU   SDWARSR2                                                 16636000
SDWAFLSQ EQU   SDWARSR2                                                 16637000
SDWAFSQA EQU   SDWARSR2                                                 16638000
SDWANUCL EQU   SDWARSR2                                                 16639000
SDWASPER EQU   SDWARSR2                                                 16640000
SDWAINTC EQU   SDWARSR2                                                 16641000
SDWAOFLN EQU   SDWARSR2                                                 16642000
SDWACHNG EQU   SDWARSR1                                                 16643000
SDWAMSER EQU   SDWARSR1                                                 16644000
@NM00160 EQU   SDWARSR1                                                 16645000
SDWACPID EQU   SDWAMCH+10                                               16646000
SDWATERR EQU   SDWAMCHD                                                 16647000
SDWAFPRX EQU   SDWAMCHD                                                 16648000
SDWAINSF EQU   SDWAMCHD                                                 16649000
SDWAACR  EQU   SDWAMCHD                                                 16650000
SDWASCK  EQU   SDWAMCHD                                                 16651000
SDWAPSWU EQU   SDWAMCHD                                                 16652000
SDWAREGU EQU   SDWAMCHD                                                 16653000
SDWASKYF EQU   SDWAMCHD                                                 16654000
@NM00159 EQU   SDWAMCHS                                                 16655000
SDWARSRF EQU   SDWAMCHS                                                 16656000
SDWARSRC EQU   SDWAMCHS                                                 16657000
SDWAINVP EQU   SDWAMCHS                                                 16658000
SDWATSVL EQU   SDWAMCHS                                                 16659000
SDWARCDF EQU   SDWAMCHS                                                 16660000
SDWASRVL EQU   SDWAMCHS                                                 16661000
SDWASCKE EQU   SDWASTCK+4                                               16662000
SDWASCKB EQU   SDWASTCK                                                 16663000
SDWALNTH EQU   SDWAIDNT+1                                               16664000
SDWASPID EQU   SDWAIDNT                                                 16665000
SDWASR15 EQU   SDWASRSV+60                                              16666000
SDWASR14 EQU   SDWASRSV+56                                              16667000
SDWASR13 EQU   SDWASRSV+52                                              16668000
SDWASR12 EQU   SDWASRSV+48                                              16669000
SDWASR11 EQU   SDWASRSV+44                                              16670000
SDWASR10 EQU   SDWASRSV+40                                              16671000
SDWASR09 EQU   SDWASRSV+36                                              16672000
SDWASR08 EQU   SDWASRSV+32                                              16673000
SDWASR07 EQU   SDWASRSV+28                                              16674000
SDWASR06 EQU   SDWASRSV+24                                              16675000
SDWASR05 EQU   SDWASRSV+20                                              16676000
SDWASR04 EQU   SDWASRSV+16                                              16677000
SDWASR03 EQU   SDWASRSV+12                                              16678000
SDWASR02 EQU   SDWASRSV+8                                               16679000
SDWASR01 EQU   SDWASRSV+4                                               16680000
SDWASR00 EQU   SDWASRSV                                                 16681000
SDWATRN2 EQU   SDWAAEC2+4                                               16682000
SDWAIPC2 EQU   SDWAICD2                                                 16683000
SDWAIMC2 EQU   SDWAICD2                                                 16684000
SDWAIPR2 EQU   SDWAICD2                                                 16685000
@NM00158 EQU   SDWAINC2                                                 16686000
@NM00157 EQU   SDWAILC2                                                 16687000
SDWAIL2  EQU   SDWAILC2                                                 16688000
@NM00156 EQU   SDWAILC2                                                 16689000
@NM00155 EQU   SDWAAEC2                                                 16690000
SDWAADD2 EQU   SDWANXT2+1                                               16691000
@NM00154 EQU   SDWANXT2                                                 16692000
@NM00153 EQU   SDWAEC2+3                                                16693000
SDWASGN2 EQU   SDWAINT2                                                 16694000
SDWAEXP2 EQU   SDWAINT2                                                 16695000
SDWADEC2 EQU   SDWAINT2                                                 16696000
SDWAFPO2 EQU   SDWAINT2                                                 16697000
SDWACC2  EQU   SDWAINT2                                                 16698000
@NM00152 EQU   SDWAINT2                                                 16699000
SDWAPGM2 EQU   SDWAMWP2                                                 16700000
SDWAWAT2 EQU   SDWAMWP2                                                 16701000
SDWAMCK2 EQU   SDWAMWP2                                                 16702000
SDWAECT2 EQU   SDWAMWP2                                                 16703000
SDWAKEY2 EQU   SDWAMWP2                                                 16704000
SDWAEXT2 EQU   SDWAEMK2                                                 16705000
SDWAIO2  EQU   SDWAEMK2                                                 16706000
SDWATRM2 EQU   SDWAEMK2                                                 16707000
@NM00151 EQU   SDWAEMK2                                                 16708000
SDWAPER2 EQU   SDWAEMK2                                                 16709000
@NM00150 EQU   SDWAEMK2                                                 16710000
SDWATRAN EQU   SDWAAEC1+4                                               16711000
SDWAIPC1 EQU   SDWAICD1                                                 16712000
SDWAIMC1 EQU   SDWAICD1                                                 16713000
SDWAIPR1 EQU   SDWAICD1                                                 16714000
@NM00149 EQU   SDWAINC1                                                 16715000
@NM00148 EQU   SDWAILC1                                                 16716000
SDWAIL1  EQU   SDWAILC1                                                 16717000
@NM00147 EQU   SDWAILC1                                                 16718000
@NM00146 EQU   SDWAAEC1                                                 16719000
SDWAADD1 EQU   SDWANXT1+1                                               16720000
@NM00145 EQU   SDWANXT1                                                 16721000
@NM00144 EQU   SDWAEC1+3                                                16722000
SDWASGN1 EQU   SDWAINT1                                                 16723000
SDWAEXP1 EQU   SDWAINT1                                                 16724000
SDWADEC1 EQU   SDWAINT1                                                 16725000
SDWAFPO1 EQU   SDWAINT1                                                 16726000
SDWACC1  EQU   SDWAINT1                                                 16727000
@NM00143 EQU   SDWAINT1                                                 16728000
SDWAPGM1 EQU   SDWAMWP1                                                 16729000
SDWAWAT1 EQU   SDWAMWP1                                                 16730000
SDWAMCK1 EQU   SDWAMWP1                                                 16731000
SDWAECT1 EQU   SDWAMWP1                                                 16732000
SDWAKEY1 EQU   SDWAMWP1                                                 16733000
SDWAEXT1 EQU   SDWAEMK1                                                 16734000
SDWAIO1  EQU   SDWAEMK1                                                 16735000
SDWATRM1 EQU   SDWAEMK1                                                 16736000
@NM00142 EQU   SDWAEMK1                                                 16737000
SDWAPER1 EQU   SDWAEMK1                                                 16738000
@NM00141 EQU   SDWAEMK1                                                 16739000
SDWAIOBR EQU   SDWA+100                                                 16740000
SDWAEPA  EQU   SDWA+96                                                  16741000
@NM00140 EQU   SDWANAME+4                                               16742000
SDWARBAD EQU   SDWANAME                                                 16743000
SDWAGR14 EQU   SDWAGRSV+56                                              16744000
SDWAGR13 EQU   SDWAGRSV+52                                              16745000
SDWAGR12 EQU   SDWAGRSV+48                                              16746000
SDWAGR11 EQU   SDWAGRSV+44                                              16747000
SDWAGR10 EQU   SDWAGRSV+40                                              16748000
SDWAGR09 EQU   SDWAGRSV+36                                              16749000
SDWAGR08 EQU   SDWAGRSV+32                                              16750000
SDWAGR07 EQU   SDWAGRSV+28                                              16751000
SDWAGR06 EQU   SDWAGRSV+24                                              16752000
SDWAGR05 EQU   SDWAGRSV+20                                              16753000
SDWAGR04 EQU   SDWAGRSV+16                                              16754000
SDWAGR03 EQU   SDWAGRSV+12                                              16755000
SDWAGR02 EQU   SDWAGRSV+8                                               16756000
SDWAGR01 EQU   SDWAGRSV+4                                               16757000
SDWAGR00 EQU   SDWAGRSV                                                 16758000
SDWANXTP EQU   SDWACTL2+5                                               16759000
SDWASGP  EQU   SDWAPMKP                                                 16760000
SDWAEUP  EQU   SDWAPMKP                                                 16761000
SDWADOP  EQU   SDWAPMKP                                                 16762000
SDWAFPP  EQU   SDWAPMKP                                                 16763000
SDWACCP  EQU   SDWAPMKP                                                 16764000
SDWAILP  EQU   SDWAPMKP                                                 16765000
SDWAINTP EQU   SDWACTL2+2                                               16766000
SDWASPVP EQU   SDWAMWPP                                                 16767000
SDWAWATP EQU   SDWAMWPP                                                 16768000
SDWAMCKP EQU   SDWAMWPP                                                 16769000
@NM00139 EQU   SDWAMWPP                                                 16770000
SDWAKEYP EQU   SDWAMWPP                                                 16771000
SDWAEXTP EQU   SDWACMKP                                                 16772000
SDWAIOP  EQU   SDWACMKP                                                 16773000
SDWANXTA EQU   SDWACTL1+5                                               16774000
SDWASGA  EQU   SDWAPMKA                                                 16775000
SDWAEUA  EQU   SDWAPMKA                                                 16776000
SDWADOA  EQU   SDWAPMKA                                                 16777000
SDWAFPA  EQU   SDWAPMKA                                                 16778000
SDWACCA  EQU   SDWAPMKA                                                 16779000
SDWAILA  EQU   SDWAPMKA                                                 16780000
SDWAINTA EQU   SDWACTL1+2                                               16781000
SDWASPVA EQU   SDWAMWPA                                                 16782000
SDWAWATA EQU   SDWAMWPA                                                 16783000
SDWAMCKA EQU   SDWAMWPA                                                 16784000
@NM00138 EQU   SDWAMWPA                                                 16785000
SDWAKEYA EQU   SDWAMWPA                                                 16786000
SDWAEXTA EQU   SDWACMKA                                                 16787000
SDWAIOA  EQU   SDWACMKA                                                 16788000
SDWACMPC EQU   SDWAABCC+1                                               16789000
@NM00137 EQU   SDWACMPF                                                 16790000
SDWASTCC EQU   SDWACMPF                                                 16791000
@NM00136 EQU   SDWACMPF                                                 16792000
SDWASTEP EQU   SDWACMPF                                                 16793000
SDWAREQ  EQU   SDWACMPF                                                 16794000
ECBEVNT  EQU   ECBEXTND                                                 16795000
@NM00135 EQU   ECBEXTND                                                 16796000
@NM00134 EQU   ECBBYTE3                                                 16797000
@NM00133 EQU   ECBEXTBA                                                 16798000
@NM00132 EQU   ECBCC                                                    16799000
ECBWAITB EQU   ECBCC                                                    16800000
IOBERRCT EQU   IOBSTDRD+30                                              16801000
IOBRSV19 EQU   IOBINCAM+1                                               16802000
IOBOLTST EQU   IOBBTAMF                                                 16803000
IOBRFTMG EQU   IOBBTAMF                                                 16804000
IOBRSV17 EQU   IOBBTAMF                                                 16805000
IOBRSV16 EQU   IOBBTAMF                                                 16806000
IOBRSV15 EQU   IOBBTAMF                                                 16807000
IOBRSV14 EQU   IOBBTAMF                                                 16808000
IOBINUSE EQU   IOBBTAMF                                                 16809000
IOBPRMER EQU   IOBBTAMF                                                 16810000
IOBRSTRB EQU   IOBRESTR+1                                               16811000
IOBREPOS EQU   IOBRESTR                                                 16812000
IOBDCBPB EQU   IOBDCBPT+1                                               16813000
IOBRSV44 EQU   IOBFLAG4                                                 16814000
IOBJES3I EQU   IOBFLAG4                                                 16815000
IOBRSV42 EQU   IOBFLAG4                                                 16816000
IOBRSV41 EQU   IOBFLAG4                                                 16817000
IOBRSV40 EQU   IOBFLAG4                                                 16818000
IOBPMERR EQU   IOBFLAG4                                                 16819000
IOBCC3WE EQU   IOBFLAG4                                                 16820000
IOBGDPOL EQU   IOBFLAG4                                                 16821000
IOBSTRTB EQU   IOBSTART+1                                               16822000
IOBSIOCC EQU   IOBSTART                                                 16823000
IOBCSB7  EQU   IOBCSTAT                                                 16824000
IOBCSB6  EQU   IOBCSTAT                                                 16825000
IOBCSB5  EQU   IOBCSTAT                                                 16826000
IOBCSB4  EQU   IOBCSTAT                                                 16827000
IOBCSB3  EQU   IOBCSTAT                                                 16828000
IOBCSB2  EQU   IOBCSTAT                                                 16829000
IOBCSB1  EQU   IOBCSTAT                                                 16830000
IOBCSB0  EQU   IOBCSTAT                                                 16831000
IOBUSB7  EQU   IOBUSTAT                                                 16832000
IOBUSB6  EQU   IOBUSTAT                                                 16833000
IOBUSB5  EQU   IOBUSTAT                                                 16834000
IOBUSB4  EQU   IOBUSTAT                                                 16835000
IOBUSB3  EQU   IOBUSTAT                                                 16836000
IOBUSB2  EQU   IOBUSTAT                                                 16837000
IOBUSB1  EQU   IOBUSTAT                                                 16838000
IOBUSB0  EQU   IOBUSTAT                                                 16839000
IOBLOG   EQU   IOBFL3                                                   16840000
IOBJAM   EQU   IOBICL                                                   16841000
IOBMSG   EQU   IOBFL3                                                   16842000
IOBSDR   EQU   IOBCNC                                                   16843000
IOBACU   EQU   IOBFL3                                                   16844000
IOBCDC   EQU   IOBFL3                                                   16845000
IOBICC   EQU   IOBFL3                                                   16846000
IOBCCC   EQU   IOBFL3                                                   16847000
IOBECBPB EQU   IOBECBPT+1                                               16848000
IOBECBCC EQU   IOBECBPT                                                 16849000
IOBS1B7  EQU   IOBSENS1                                                 16850000
IOBS1B6  EQU   IOBSENS1                                                 16851000
IOBS1B5  EQU   IOBSENS1                                                 16852000
IOBS1B4  EQU   IOBSENS1                                                 16853000
IOBS1B3  EQU   IOBSENS1                                                 16854000
IOBS1B2  EQU   IOBSENS1                                                 16855000
IOBS1B1  EQU   IOBSENS1                                                 16856000
IOBS1B0  EQU   IOBSENS1                                                 16857000
IOBSNSC9 EQU   IOBS0B7                                                  16858000
IOBS0B6  EQU   IOBSENS0                                                 16859000
IOBS0B5  EQU   IOBSENS0                                                 16860000
IOBS0B4  EQU   IOBSENS0                                                 16861000
IOBS0B3  EQU   IOBSENS0                                                 16862000
IOBS0B2  EQU   IOBSENS0                                                 16863000
IOBS0B1  EQU   IOBSENS0                                                 16864000
IOBS0B0  EQU   IOBSENS0                                                 16865000
IOBPNCH  EQU   IOBFLAG2                                                 16866000
IOBSTATO EQU   IOBFLAG2                                                 16867000
IOBSKUPD EQU   IOBFLAG2                                                 16868000
IOBALTTR EQU   IOBFLAG2                                                 16869000
IOBRRT2  EQU   IOBRDHA0                                                 16870000
IOBRRT3  EQU   IOBPURGE                                                 16871000
IOBSENSE EQU   IOBFLAG2                                                 16872000
IOBHALT  EQU   IOBFLAG2                                                 16873000
IOBSPSVC EQU   IOBRSTRT                                                 16874000
IOBUNREL EQU   IOBFLAG1                                                 16875000
IOBIOERR EQU   IOBFLAG1                                                 16876000
IOBFCREX EQU   IOBCYCCK                                                 16877000
IOBRPSTN EQU   IOBFLAG1                                                 16878000
IOBERRTN EQU   IOBFLAG1                                                 16879000
IOBDATCH EQU   IOBFLAG1                                                 16880000
IOBCNOPA EQU   IOBPREFX+12                                              16881000
IOBCICB  EQU   IOBPREFX+8                                               16882000
IOBCECB  EQU   IOBPREFX+4                                               16883000
IOBCONOP EQU   IOBPREFX+3                                               16884000
IOBCINOP EQU   IOBPREFX+2                                               16885000
IOBRSV05 EQU   IOBPREFX+1                                               16886000
IOBPCI   EQU   IOBCFLG1                                                 16887000
IOBRSTCH EQU   IOBCFLG1                                                 16888000
IOBABAPP EQU   IOBCFLG1                                                 16889000
IOBPTST  EQU   IOBCFLG1                                                 16890000
IOBRSV04 EQU   IOBCFLG1                                                 16891000
IOBRSV03 EQU   IOBCFLG1                                                 16892000
IOBRSV02 EQU   IOBCFLG1                                                 16893000
IOBRSV01 EQU   IOBCFLG1                                                 16894000
DEBXRV40 EQU   DEBXTN+28                                                16895000
DEBXOPNJ EQU   DEBXTN+24                                                16896000
DEBXXARG EQU   DEBXTN+20                                                16897000
DEBXMCF2 EQU   DEBXTN+19                                                16898000
DEBXMCF1 EQU   DEBXTN+18                                                16899000
DEBXDSO2 EQU   DEBXTN+17                                                16900000
DEBXDSO1 EQU   DEBXTN+16                                                16901000
DEBXDBPR EQU   DEBXTN+12                                                16902000
DEBXDCBM EQU   DEBXTN+8                                                 16903000
DEBXDSAB EQU   DEBXTN+4                                                 16904000
DEBXRV48 EQU   DEBXTN+3                                                 16905000
DEBXRV47 EQU   DEBXFLG1                                                 16906000
DEBXRV46 EQU   DEBXFLG1                                                 16907000
DEBXRV45 EQU   DEBXFLG1                                                 16908000
DEBXRV44 EQU   DEBXFLG1                                                 16909000
DEBXRV43 EQU   DEBXFLG1                                                 16910000
DEBXDSSI EQU   DEBXFLG1                                                 16911000
DEBXTSKC EQU   DEBXFLG1                                                 16912000
DEBXCDCB EQU   DEBXFLG1                                                 16913000
DEBXLNGH EQU   DEBXTN                                                   16914000
DEBTBLOF EQU   DEBPREFX+14                                              16915000
DEBAMTYP EQU   DEBPREFX+13                                              16916000
DEBLNGTH EQU   DEBPREFX+12                                              16917000
DEBDCBMK EQU   DEBXTNP                                                  16918000
DEBDSCBA EQU   DEBPREFX+1                                               16919000
DEBWKARA EQU   DEBPREFX                                                 16920000
DEBXCENP EQU   DEBXCEAB                                                 16921000
DEBRSV35 EQU   DEBXCEAB                                                 16922000
DEBRSV34 EQU   DEBXCEAB                                                 16923000
DEBRSV33 EQU   DEBXCEAB                                                 16924000
DEBRSV32 EQU   DEBXCEAB                                                 16925000
DEBCEAD  EQU   DEBCEA+1                                                 16926000
DEBCENP  EQU   DEBCEAB                                                  16927000
DEBRSV31 EQU   DEBCEAB                                                  16928000
DEBRSV30 EQU   DEBCEAB                                                  16929000
DEBRSV29 EQU   DEBCEAB                                                  16930000
DEBRSV28 EQU   DEBCEAB                                                  16931000
DEBPCIAD EQU   DEBPCIA+1                                                16932000
DEBPCINP EQU   DEBPCIAB                                                 16933000
DEBRSV27 EQU   DEBPCIAB                                                 16934000
DEBRSV26 EQU   DEBPCIAB                                                 16935000
DEBRSV25 EQU   DEBPCIAB                                                 16936000
DEBRSV24 EQU   DEBPCIAB                                                 16937000
DEBSIOAD EQU   DEBSIOA+1                                                16938000
DEBSIONP EQU   DEBSIOAB                                                 16939000
DEBFIX   EQU   DEBSIOAB                                                 16940000
DEBIOVR  EQU   DEBSIOAB                                                 16941000
DEBSIOX  EQU   DEBSIOAB                                                 16942000
DEBPGFX  EQU   DEBSIOAB                                                 16943000
DEBEOEAD EQU   DEBEOEA+1                                                16944000
DEBEOENP EQU   DEBEOEAB                                                 16945000
DEBRSV22 EQU   DEBEOEAB                                                 16946000
DEBRSV21 EQU   DEBEOEAB                                                 16947000
DEBRSV20 EQU   DEBEOEAB                                                 16948000
DEBRSV19 EQU   DEBEOEAB                                                 16949000
DEBSUBID EQU   DEBSUBNM                                                 16950000
DEBSIOA2 EQU   DEBACS08+24                                              16951000
DEBRPSIO EQU   DEBACS08+20                                              16952000
DEBFREED EQU   DEBACS08+16                                              16953000
@NM00131 EQU   DEBACS08+12                                              16954000
@NM00130 EQU   DEBACS08+8                                               16955000
DEBDISAD EQU   DEBACS08+4                                               16956000
@NM00129 EQU   DEBACS08                                                 16957000
DEBRPSST EQU   DEBACS07+64                                              16958000
DEBARECK EQU   DEBACS07+60                                              16959000
DEBAREWT EQU   DEBACS07+56                                              16960000
DEBACHK  EQU   DEBACS07+52                                              16961000
DEBAWRIT EQU   DEBACS07+48                                              16962000
DEBASETL EQU   DEBACS07+44                                              16963000
DEBAREAD EQU   DEBACS07+40                                              16964000
DEBCRECK EQU   DEBACS07+36                                              16965000
DEBCREWT EQU   DEBACS07+32                                              16966000
DEBCCHK  EQU   DEBACS07+28                                              16967000
DEBCWRIT EQU   DEBACS07+24                                              16968000
DEBCSETL EQU   DEBACS07+20                                              16969000
DEBCREAD EQU   DEBACS07+16                                              16970000
DEBWKPT5 EQU   DEBACS07+12                                              16971000
DEBWKPT4 EQU   DEBACS07+8                                               16972000
DEBGET   EQU   DEBACS07+4                                               16973000
@NM00128 EQU   DEBACS07                                                 16974000
DEBPUT   EQU   DEBACS06+4                                               16975000
DEBDCBFA EQU   DEBACS06                                                 16976000
DEBLUCBB EQU   DEBLUCBA+1                                               16977000
DEBRSV18 EQU   DEBLUCBA                                                 16978000
DEBFUCBB EQU   DEBFUCBA+1                                               16979000
DEBRSV17 EQU   DEBFUCBA                                                 16980000
DEBTCCWB EQU   DEBTCCWA+1                                               16981000
DEBRSV16 EQU   DEBTCCWA                                                 16982000
DEBTBFRB EQU   DEBTBFRA+1                                               16983000
DEBRSV15 EQU   DEBTBFRA                                                 16984000
DEBDBPEF EQU   DEBACS03+8                                               16985000
DEBDBPP  EQU   DEBACS03+4                                               16986000
DEBDTPP  EQU   DEBACS03                                                 16987000
DEBDBPE  EQU   DEBDBLK+1                                                16988000
DEBDBPT  EQU   DEBDBLK                                                  16989000
DEBEXTNM EQU   DEBDSNAM                                                 16990000
DEBLRECL EQU   DEBACSMD+14                                              16991000
DEBBLKSI EQU   DEBACSMD+12                                              16992000
DEBRSV14 EQU   DEBDSNM+4                                                16993000
DEBUTSAB EQU   DEBUTSAA+1                                               16994000
DEBRSV13 EQU   DEBUTSAA                                                 16995000
DEBVOLNM EQU   DEBACSMD+2                                               16996000
DEBVLSEQ EQU   DEBVOLSQ+1                                               16997000
DEBRSV42 EQU   DEBVOLBT                                                 16998000
DEBRSV41 EQU   DEBVOLBT                                                 16999000
DEBRSV40 EQU   DEBVOLBT                                                 17000000
DEBRSV39 EQU   DEBVOLBT                                                 17001000
DEBRSV38 EQU   DEBVOLBT                                                 17002000
DEBRSV37 EQU   DEBVOLBT                                                 17003000
DEBRSV36 EQU   DEBVOLBT                                                 17004000
DEBEXFUL EQU   DEBVOLBT                                                 17005000
DEBBINUM EQU   DEBDASD+4                                                17006000
DEBUCBA  EQU   DEBUCBAD+1                                               17007000
DEBAPPB  EQU   DEBAPPAD+1                                               17008000
DEBDCBB  EQU   DEBDCBAD+1                                               17009000
DEBDEBID EQU   DEBPROTG                                                 17010000
DEBECBB  EQU   DEBECBAD+1                                               17011000
DEBPRIOR EQU   DEBECBAD                                                 17012000
DEBUSRPB EQU   DEBUSRPG+1                                               17013000
DEBNMEXT EQU   DEBUSRPG                                                 17014000
DEBRSV05 EQU   DEBBASIC+15                                              17015000
DEBXTNIN EQU   DEBFLGS1                                                 17016000
DEBAPFIN EQU   DEBFLGS1                                                 17017000
DEBF1CEV EQU   DEBFLGS1                                                 17018000
DEBCINDI EQU   DEBFLGS1                                                 17019000
DEBRSV02 EQU   DEBFLGS1                                                 17020000
DEBRSIOA EQU   DEBFLGS1                                                 17021000
DEBEOFDF EQU   DEBFLGS1                                                 17022000
DEBPWCKD EQU   DEBFLGS1                                                 17023000
DEBQSCNT EQU   DEBBASIC+13                                              17024000
DEBACCS  EQU   DEBOPATB                                                 17025000
DEBPOSIT EQU   DEBOPATB                                                 17026000
DEBZERO  EQU   DEBOPATB                                                 17027000
DEBABEND EQU   DEBOPATB                                                 17028000
DEBIRBB  EQU   DEBIRBAD+1                                               17029000
DEBRERR  EQU   DEBOFLGS                                                 17030000
DEBLABEL EQU   DEBOFLGS                                                 17031000
DEBSPLIT EQU   DEBOFLGS                                                 17032000
DEBDCB   EQU   DEBOFLGS                                                 17033000
DEBRLSE  EQU   DEBOFLGS                                                 17034000
DEBEOF   EQU   DEBOFLGS                                                 17035000
DEBDISP  EQU   DEBOFLGS                                                 17036000
DEBDEBB  EQU   DEBDEBAD+1                                               17037000
DEBAMLNG EQU   DEBDEBAD                                                 17038000
DEBTCBB  EQU   DEBTCBAD+1                                               17039000
DEBNMSUB EQU   DEBTCBAD                                                 17040000
JFCBXNXT EQU   JFCBX+172                                                17041000
@NM00127 EQU   JFCBX+144                                                17042000
JFCBXDEV EQU   JFCBX+140                                                17043000
JFCBXNAM EQU   JFCBX+96                                                 17044000
@NM00126 EQU   JFCBX+94                                                 17045000
JFCBXVOL EQU   JFCBX+4                                                  17046000
@NM00125 EQU   JFCBX+3                                                  17047000
JFCBXTTR EQU   JFCBX                                                    17048000
JFCRSV05 EQU   JFCEROPT                                                 17049000
JFCRSV04 EQU   JFCEROPT                                                 17050000
JFCRSV03 EQU   JFCEROPT                                                 17051000
JFCRSV02 EQU   JFCEROPT                                                 17052000
JFCTOPT  EQU   JFCEROPT                                                 17053000
JFCABN   EQU   JFCEROPT                                                 17054000
JFCSKP   EQU   JFCEROPT                                                 17055000
JFCACC   EQU   JFCEROPT                                                 17056000
JFCBUFL  EQU   JFCAMPTR+2                                               17057000
JFCFWORD EQU   JFCBFTEK                                                 17058000
JFCDWORD EQU   JFCBFTEK                                                 17059000
JFCHIER1 EQU   JFCBFTEK                                                 17060000
JFCDYN   EQU   JFCBFTEK                                                 17061000
JFCEXC   EQU   JFCBFTEK                                                 17062000
JFCBBFTR EQU   JFCBBFTA                                                 17063000
JFCSIM   EQU   JFCBBFTA                                                 17064000
JFCHIER  EQU   JFCBFTEK                                                 17065000
JFCBFOUT EQU   JFCBUFNO                                                 17066000
JFCBUFIN EQU   JFCBUFNO                                                 17067000
JFCTEMP  EQU   JFCBIND2                                                 17068000
JFCREQ   EQU   JFCBIND2                                                 17069000
JFCENT   EQU   JFCBIND2                                                 17070000
JFCSHARE EQU   JFCBIND2                                                 17071000
JFCSECUR EQU   JFCBIND2                                                 17072000
JFCDISP  EQU   JFCBIND2                                                 17073000
JFCPDS   EQU   JFCBIND1                                                 17074000
JFCGDG   EQU   JFCBIND1                                                 17075000
JFCADDED EQU   JFCBIND1                                                 17076000
JFCLOC   EQU   JFCBIND1                                                 17077000
JFCRLSE  EQU   JFCBIND1                                                 17078000
JFCBXPDT EQU   INFMJFCB+83                                              17079000
JFCBCRDT EQU   INFMJFCB+80                                              17080000
JFCBOPS2 EQU   JFCBMASK+7                                               17081000
JFCRCTLG EQU   JFCBFLG2                                                 17082000
JFCBBUFF EQU   JFCBFLG2                                                 17083000
JFCTRACE EQU   JFCBFLG2                                                 17084000
JFCSDRPS EQU   JFCBFLG2                                                 17085000
JFCMODNW EQU   JFCBFLG2                                                 17086000
JFCNRPS  EQU   JFCDEFER                                                 17087000
JFCOUTOP EQU   JFCBFLG2                                                 17088000
JFCINOP  EQU   JFCBFLG2                                                 17089000
JFCBPWBP EQU   JFCOPEN                                                  17090000
@NM00121 EQU   JFCOPEN                                                  17091000
JFCDUAL  EQU   JFCBFLG1                                                 17092000
JFCSLDES EQU   JFCBFLG1                                                 17093000
JFCSLCRE EQU   JFCBFLG1                                                 17094000
JFCSTAND EQU   JFCBFLG1                                                 17095000
JFCBOPS1 EQU   JFCBMASK                                                 17096000
JFCBVLSQ EQU   INFMJFCB+70                                              17097000
JFCRSV31 EQU   JFCFUNC                                                  17098000
JFCFNCBT EQU   JFCFUNC                                                  17099000
JFCFNCBX EQU   JFCFUNC                                                  17100000
JFCFNCBD EQU   JFCFUNC                                                  17101000
JFCFNCBW EQU   JFCFUNC                                                  17102000
JFCFNCBP EQU   JFCFUNC                                                  17103000
JFCFNCBR EQU   JFCFUNC                                                  17104000
JFCFNCBI EQU   JFCFUNC                                                  17105000
JFCBFOFL EQU   JFCBUFOF                                                 17106000
JFCNL    EQU   JFCBLTYP                                                 17107000
JFCSL    EQU   JFCBLTYP                                                 17108000
JFCNSL   EQU   JFCBLTYP                                                 17109000
JFCSUL   EQU   JFCBLTYP                                                 17110000
JFCBLP   EQU   JFCBLTYP                                                 17111000
JFCBLTM  EQU   JFCBLTYP                                                 17112000
JFCBAL   EQU   JFCBLTYP                                                 17113000
JFCRSV38 EQU   JFCBLTYP                                                 17114000
JFCVINDX EQU   INFMJFCB+64                                              17115000
JFCNLREC EQU   INFMJFCB+62                                              17116000
JFCBADBF EQU   INFMJFCB+60                                              17117000
JFCAMSTR EQU   JFCBFRID+2                                               17118000
JFCAMCRO EQU   JFCBFRID                                                 17119000
JFCBDSCB EQU   INFMJFCB+53                                              17120000
JFCPAT   EQU   JFCBTSDM                                                 17121000
JFCNDCB  EQU   JFCBTSDM                                                 17122000
JFCNDSCB EQU   JFCBTSDM                                                 17123000
JFCTTR   EQU   JFCBTSDM                                                 17124000
JFCSDS   EQU   JFCBTSDM                                                 17125000
JFCCAT   EQU   JFCBTSDM                                                 17126000
JFCIPLTX EQU   JFCBELNM                                                 17127000
JFCBQNAM EQU   JFCBDSNM                                                 17128000
@NM00120 EQU   IHADCS44+10                                              17129000
DCBXENDA EQU   IHADCS44+8                                               17130000
DCBCENDA EQU   IHADCS44+6                                               17131000
DCBSIOA  EQU   IHADCS44+4                                               17132000
DCBPCIA  EQU   IHADCS44+2                                               17133000
DCBEOEA  EQU   IHADCS44                                                 17134000
@NM00119 EQU   IHADCS28+1                                               17135000
@NM00118 EQU   DCBOPTCD                                                 17136000
DCBSRCHD EQU   DCBOPTZ                                                  17137000
@NM00117 EQU   DCBOPTCD                                                 17138000
DCBDEBA  EQU   DCBDEBAD+1                                               17139000
@NM00116 EQU   DCBIFLGS                                                 17140000
DCBIFIOE EQU   DCBIFLGS                                                 17141000
DCBCH12  EQU   DCBIFPCT                                                 17142000
DCBCH9   EQU   DCBIFPCT                                                 17143000
DCBMFSTI EQU   DCBMFDMD                                                 17144000
DCBMFAWR EQU   DCBMFSTK                                                 17145000
DCBMFUIP EQU   DCBMFTMD                                                 17146000
DCBMFIDW EQU   DCBMFLCP                                                 17147000
DCBMFWRK EQU   DCBMFMVP                                                 17148000
DCBMFRDQ EQU   DCBMFWRT                                                 17149000
DCBMFGTQ EQU   DCBMFPUT                                                 17150000
DCBMFSTL EQU   DCBMACF2                                                 17151000
DCBMFCK  EQU   DCBMFDMG                                                 17152000
DCBMFRDX EQU   DCBMFCHK                                                 17153000
DCBMFDBF EQU   DCBMFSBG                                                 17154000
DCBMFRDI EQU   DCBMFLCG                                                 17155000
DCBMFRDK EQU   DCBMFMVG                                                 17156000
DCBMFWRQ EQU   DCBMFRD                                                  17157000
DCBMFPTQ EQU   DCBMFGET                                                 17158000
DCBMFECP EQU   DCBMACF1                                                 17159000
DCBTIOT  EQU   IHADCS25                                                 17160000
DCBMRSTI EQU   DCBMRDMD                                                 17161000
DCBMRAWR EQU   DCBMRSTK                                                 17162000
DCBMRUIP EQU   DCBMRTMD                                                 17163000
DCBMRIDW EQU   DCBMRLCP                                                 17164000
DCBMRWRK EQU   DCBMRMVP                                                 17165000
DCBMRRDQ EQU   DCBMRWRT                                                 17166000
DCBMRGTQ EQU   DCBMRPUT                                                 17167000
DCBMRSTL EQU   DCBMACR2                                                 17168000
DCBMRCK  EQU   DCBMRDMG                                                 17169000
DCBPGFXA EQU   DCBMRRDX                                                 17170000
DCBMRDBF EQU   DCBMRSBG                                                 17171000
DCBMRRDI EQU   DCBMRLCG                                                 17172000
DCBMRRDK EQU   DCBMRMVG                                                 17173000
DCBMRWRQ EQU   DCBMRRD                                                  17174000
DCBMRPTQ EQU   DCBMRGET                                                 17175000
DCBMRECP EQU   DCBMACR1                                                 17176000
@NM00115 EQU   DCBIFLG                                                  17177000
DCBIBIOE EQU   DCBIFLG                                                  17178000
DCBICH12 EQU   DCBIBPCT                                                 17179000
DCBICH9  EQU   DCBIBPCT                                                 17180000
DCBIBEC  EQU   DCBIFLG                                                  17181000
DCBOFIOF EQU   DCBOFLGS                                                 17182000
DCBOFUEX EQU   DCBOFLGS                                                 17183000
DCBOFTM  EQU   DCBOFLGS                                                 17184000
DCBOFPPC EQU   DCBOFLGS                                                 17185000
DCBOFEOV EQU   DCBOFLGS                                                 17186000
DCBOFLRB EQU   DCBOFLGS                                                 17187000
DCBOFIOD EQU   DCBOFLWR                                                 17188000
DCBRECKL EQU   DCBRECFM                                                 17189000
DCBRECCC EQU   DCBRECFM                                                 17190000
DCBRECSB EQU   DCBRECFM                                                 17191000
DCBRECBR EQU   DCBRECFM                                                 17192000
DCBRECTO EQU   DCBRECLA                                                 17193000
DCBRECL  EQU   DCBRECLA                                                 17194000
DCBEODA  EQU   DCBEODAD+1                                               17195000
DCBBFA   EQU   DCBBFTEK                                                 17196000
DCBH0    EQU   DCBBFTEK                                                 17197000
DCBBFTKD EQU   DCBBFTEK                                                 17198000
DCBBFTE  EQU   DCBBFT                                                   17199000
DCBBFTKR EQU   DCBBFT                                                   17200000
DCBBFTS  EQU   DCBBFT                                                   17201000
DCBH1    EQU   DCBBFTEK                                                 17202000
DCBSVCXA EQU   DCBSVCXL+1                                               17203000
@NM00114 EQU   DCBSVCXL                                                 17204000
DCBODEBA EQU   DCBIOBAA                                                 17205000
@NM00113 EQU   DCBQSLM                                                  17206000
DCBUPDBT EQU   DCBQSLM                                                  17207000
DCBUPDCM EQU   DCBQSLM                                                  17208000
DCB1DVDS EQU   DCBQSLM                                                  17209000
@NM00112 EQU   DCBDSRG2                                                 17210000
DCBDSGTR EQU   DCBDSRG2                                                 17211000
DCBACBM  EQU   DCBDSRG2                                                 17212000
@NM00111 EQU   DCBDSRG2                                                 17213000
DCBDSGTQ EQU   DCBDSRG2                                                 17214000
DCBDSGTX EQU   DCBDSRG2                                                 17215000
DCBDSGGS EQU   DCBDSRG2                                                 17216000
DCBDSGU  EQU   DCBDSRG1                                                 17217000
DCBDSGPO EQU   DCBDSRG1                                                 17218000
@NM00110 EQU   DCBDSRG1                                                 17219000
@NM00109 EQU   DCBDSRG1                                                 17220000
DCBDSGCX EQU   DCBDSRG1                                                 17221000
DCBDSGDA EQU   DCBDSRG1                                                 17222000
DCBDSGPS EQU   DCBDSRG1                                                 17223000
DCBDSGIS EQU   DCBDSRG1                                                 17224000
DCBBUFL  EQU   IHADCS11+8                                               17225000
DCBBUFCA EQU   DCBBUFCB+1                                               17226000
DCBBUFNO EQU   DCBBUFCB                                                 17227000
DCBDEVT  EQU   DCBREL                                                   17228000
DCBKEYLE EQU   DCBRELB                                                  17229000
DCBTRBAL EQU   IHADCS01+6                                               17230000
@NM00108 EQU   IHADCS01+5                                               17231000
@NM00107 EQU   IHADCS01+4                                               17232000
DCBDVTBA EQU   DCBDVTBL+1                                               17233000
@NM00106 EQU   DCBDVTBL                                                 17234000
DCBKEYCN EQU   IHADCS00+4                                               17235000
DCBRELAD EQU   IHADCS00                                                 17236000
@NM00105 EQU   IHADCB                                                   17237000
UCBERADR EQU   UCBUCS+12                                                17238000
UCBFCBID EQU   UCBUCS+8                                                 17239000
UCBERCNT EQU   UCBUCS+7                                                 17240000
UCBRSV51 EQU   UCBUCS+6                                                 17241000
UCBFCBPE EQU   UCBFCBOP                                                 17242000
UCBRSV49 EQU   UCBFCBOP                                                 17243000
UCBRSV48 EQU   UCBFCBOP                                                 17244000
UCBRSV47 EQU   UCBFCBOP                                                 17245000
UCBRSV46 EQU   UCBFCBOP                                                 17246000
UCBRSV45 EQU   UCBFCBOP                                                 17247000
UCBRSV44 EQU   UCBFCBOP                                                 17248000
UCBFCBO1 EQU   UCBFCBOP                                                 17249000
UCBUCSPE EQU   UCBUCSOP                                                 17250000
UCBRSV43 EQU   UCBUCSOP                                                 17251000
UCBRSV42 EQU   UCBUCSOP                                                 17252000
UCBRSV41 EQU   UCBUCSOP                                                 17253000
UCBRSV40 EQU   UCBUCSOP                                                 17254000
UCBRSV39 EQU   UCBUCSOP                                                 17255000
UCBUCSO2 EQU   UCBUCSOP                                                 17256000
UCBUCSO1 EQU   UCBUCSOP                                                 17257000
UCBUCSID EQU   UCBUCS                                                   17258000
UCBMDRBA EQU   UCBMDRBF+1                                               17259000
UCBRV075 EQU   UCBMDRBF                                                 17260000
UCBRV074 EQU   UCB3800X+32                                              17261000
UCBIMAGE EQU   UCB3800X+28                                              17262000
UCBFCBNM EQU   UCB3800X+24                                              17263000
UCBCHAR4 EQU   UCB3800X+20                                              17264000
UCBCHAR3 EQU   UCB3800X+16                                              17265000
UCBCHAR2 EQU   UCB3800X+12                                              17266000
UCBCHAR1 EQU   UCB3800X+8                                               17267000
UCBCGMID EQU   UCB3800X+4                                               17268000
UCBBRSTA EQU   UCBACTIV                                                 17269000
UCBRV063 EQU   UCBACTIV                                                 17270000
UCBRV062 EQU   UCBACTIV                                                 17271000
UCBRV061 EQU   UCBACTIV                                                 17272000
UCBRV060 EQU   UCBACTIV                                                 17273000
UCBRV059 EQU   UCBACTIV                                                 17274000
UCBRV058 EQU   UCBACTIV                                                 17275000
UCBRV057 EQU   UCBACTIV                                                 17276000
UCBRV050 EQU   UCB3800X+2                                               17277000
UCBCGMNO EQU   UCB3800X+1                                               17278000
UCBRV083 EQU   UCBOPTNS                                                 17279000
UCBBRSTR EQU   UCBOPTNS                                                 17280000
UCBRV056 EQU   UCBOPTNS                                                 17281000
UCBRV055 EQU   UCBOPTNS                                                 17282000
UCBRV054 EQU   UCBOPTNS                                                 17283000
UCBRV053 EQU   UCBOPTNS                                                 17284000
UCBRV052 EQU   UCBOPTNS                                                 17285000
UCBRV051 EQU   UCBOPTNS                                                 17286000
UCBRV073 EQU   UCB3540X+7                                               17287000
UCBRV072 EQU   UCBDKBYT                                                 17288000
UCBRV071 EQU   UCBDKBYT                                                 17289000
UCBRV070 EQU   UCBDKBYT                                                 17290000
UCBRV069 EQU   UCBDKBYT                                                 17291000
UCBRV068 EQU   UCBDKBYT                                                 17292000
UCBRV067 EQU   UCBDKBYT                                                 17293000
UCBVLVER EQU   UCBDKBYT                                                 17294000
UCBDKAMX EQU   UCBDKBYT                                                 17295000
UCBVLSER EQU   UCB3540X                                                 17296000
UCBRDATA EQU   UCBOCR+4                                                 17297000
UCBFRID  EQU   UCBOCR                                                   17298000
UCBCLN   EQU   UCBMT+14                                                 17299000
UCBERG   EQU   UCBMT+12                                                 17300000
UCBMS    EQU   UCBMT+11                                                 17301000
UCBNB    EQU   UCBMT+10                                                 17302000
UCBPW    EQU   UCBMT+9                                                  17303000
UCBPR    EQU   UCBMT+8                                                  17304000
UCBSIO   EQU   UCBMT+6                                                  17305000
UCBTW    EQU   UCBMT+5                                                  17306000
UCBTR    EQU   UCBMT+4                                                  17307000
UCBTWT   EQU   UCBMT+3                                                  17308000
UCBTRT   EQU   UCBMT+2                                                  17309000
UCBCTD   EQU   UCBMT                                                    17310000
UCBWTOID EQU   UCBCMEXT+17                                              17311000
UCBRV043 EQU   UCBCMEXT+16                                              17312000
UCBASID  EQU   UCBCMEXT+14                                              17313000
UCBMFCNT EQU   UCBCMEXT+12                                              17314000
UCBPMSK  EQU   UCBCMEXT+10                                              17315000
UCBCCWOF EQU   UCBCMEXT+8                                               17316000
UCBRV041 EQU   UCBCMEXT+6                                               17317000
UCBRV036 EQU   UCBFLP1                                                  17318000
UCBRV035 EQU   UCBFLP1                                                  17319000
UCBERLOG EQU   UCBFLP1                                                  17320000
UCBRV033 EQU   UCBFLP1                                                  17321000
UCBINHIO EQU   UCBFLP1                                                  17322000
UCBNSWAP EQU   UCBFLP1                                                  17323000
UCBSHRUP EQU   UCBFLP1                                                  17324000
UCBNSRCH EQU   UCBFLP1                                                  17325000
UCBSNSCT EQU   UCBCMEXT+4                                               17326000
UCBHPDV  EQU   @NM00104                                                 17327000
UCBHALI  EQU   @NM00104                                                 17328000
UCBRSV09 EQU   @NM00104                                                 17329000
UCBRSV08 EQU   @NM00104                                                 17330000
UCBRSV07 EQU   @NM00104                                                 17331000
UCBRSV06 EQU   @NM00104                                                 17332000
UCBRSV05 EQU   @NM00104                                                 17333000
UCBRSV04 EQU   @NM00104                                                 17334000
UCBDTI   EQU   UCBCMEXT+2                                               17335000
UCBSTI   EQU   UCBCMEXT+1                                               17336000
UCBETI   EQU   UCBCMEXT                                                 17337000
UCBEXTP  EQU   UCBEXTPT+1                                               17338000
UCBDDRSW EQU   UCBFLC                                                   17339000
UCBTICBT EQU   UCBFLC                                                   17340000
UCBIVRR  EQU   UCBFLC                                                   17341000
UCBIVRS  EQU   UCBFLC                                                   17342000
UCBITF   EQU   UCBFLC                                                   17343000
UCBUDE   EQU   UCBFLC                                                   17344000
UCBWAA   EQU   UCBFLC                                                   17345000
UCBATTP  EQU   UCBFLC                                                   17346000
UCBUNTYP EQU   UCBTBYT4                                                 17347000
UCBRSV11 EQU   UCBDVCLS                                                 17348000
UCBRSV10 EQU   UCBDVCLS                                                 17349000
UCB3CHAR EQU   UCBDVCLS                                                 17350000
UCB3UREC EQU   UCBDVCLS                                                 17351000
UCB3DISP EQU   UCBDVCLS                                                 17352000
UCB3DACC EQU   UCBDVCLS                                                 17353000
UCB3COMM EQU   UCBDVCLS                                                 17354000
UCB3TAPE EQU   UCBDVCLS                                                 17355000
UCBDVPWR EQU   UCB2OPT7                                                 17356000
UCBVLPWR EQU   UCB2OPT6                                                 17357000
UCB2OPT5 EQU   UCBTBYT2                                                 17358000
UCBRVDEV EQU   UCBRWTAU                                                 17359000
UCBRPS   EQU   UCBDUDN2                                                 17360000
UCBRR    EQU   UCBDUDN1                                                 17361000
UCB2OPT1 EQU   UCBTBYT2                                                 17362000
UCB2OPT0 EQU   UCBTBYT2                                                 17363000
UCB1FEA7 EQU   UCBTBYT1                                                 17364000
UCBD6250 EQU   UCB1FEA6                                                 17365000
UCBD1600 EQU   UCB1FEA5                                                 17366000
UCB1FEA4 EQU   UCBTBYT1                                                 17367000
UCB1FEA3 EQU   UCBTBYT1                                                 17368000
UCB1FEA2 EQU   UCBTBYT1                                                 17369000
UCB1FEA1 EQU   UCBTBYT1                                                 17370000
UCB1FEA0 EQU   UCBTBYT1                                                 17371000
UCBNAME  EQU   UCBOB+13                                                 17372000
UCBRV029 EQU   UCBWGT                                                   17373000
UCBVHRSN EQU   UCBWGT                                                   17374000
UCBVORSN EQU   UCBWGT                                                   17375000
UCBMTPXP EQU   UCBWGT                                                   17376000
UCBREW   EQU   UCBWGT                                                   17377000
UCBPUB   EQU   UCBWGT                                                   17378000
UCBOUT   EQU   UCBWGT                                                   17379000
UCBIN    EQU   UCBWGT                                                   17380000
UCBCPU   EQU   UCBOB+11                                                 17381000
UCBLCI   EQU   UCBOB+10                                                 17382000
UCBCNT   EQU   UCBOB+9                                                  17383000
UCBRV017 EQU   UCBCHM1                                                  17384000
UCBRV016 EQU   UCBCHM1                                                  17385000
UCBRV015 EQU   UCBCHM1                                                  17386000
UCBRV014 EQU   UCBCHM1                                                  17387000
UCBSPB   EQU   UCBPTH1                                                  17388000
UCBPPB   EQU   UCBPTH1                                                  17389000
UCBSPA   EQU   UCBPTH0                                                  17390000
UCBPPA   EQU   UCBPTH0                                                  17391000
UCBSIGP  EQU   UCBFLB                                                   17392000
UCBVALPH EQU   UCBFLB                                                   17393000
UCBCRHSN EQU   UCBFLB                                                   17394000
UCBCRHRV EQU   UCBFLB                                                   17395000
UCBRESVH EQU   UCBFLB                                                   17396000
UCBSPST  EQU   UCBFLB                                                   17397000
UCBASNS  EQU   UCBFLB                                                   17398000
UCBIORST EQU   UCBFLB                                                   17399000
UCBQISCE EQU   UCBFL1                                                   17400000
UCBACTV  EQU   UCBFL1                                                   17401000
UCBSAP   EQU   UCBFL1                                                   17402000
UCBNOTRC EQU   UCBCUB                                                   17403000
UCBPSNS  EQU   UCBFL1                                                   17404000
UCBUSING EQU   UCBPST                                                   17405000
UCBNOTRD EQU   UCBNRY                                                   17406000
UCBBUSYD EQU   UCBBSY                                                   17407000
UCBUA    EQU   UCBCHAN+1                                                17408000
UCBCHA   EQU   UCBCHAN                                                  17409000
UCBDADI  EQU   UCBSTAT                                                  17410000
UCBSYSR  EQU   UCBSTAT                                                  17411000
UCBPRES  EQU   UCBSTAT                                                  17412000
UCBALOC  EQU   UCBSTAT                                                  17413000
UCBUNLD  EQU   UCBSTAT                                                  17414000
UCBRESV  EQU   UCBSTAT                                                  17415000
UCBCHGS  EQU   UCBSTAT                                                  17416000
UCBONLI  EQU   UCBSTAT                                                  17417000
UCBID    EQU   UCBOB+2                                                  17418000
UCBALTPH EQU   UCBFL5                                                   17419000
UCBALTCU EQU   UCBFL5                                                   17420000
UCBNALOC EQU   UCBFL5                                                   17421000
UCBENVRD EQU   UCBFL5                                                   17422000
UCBVSDR  EQU   UCBFL5                                                   17423000
UCBSASK  EQU   UCBFL5                                                   17424000
UCBAMV   EQU   UCBAF                                                    17425000
UCBDCC   EQU   UCBFL5                                                   17426000
UCBMONT  EQU   UCBJBNR                                                  17427000
UCBRV011 EQU   UCBJBNR                                                  17428000
UCBMMSGP EQU   UCBJBNR                                                  17429000
UCBOLDSM EQU   UCBJBNR                                                  17430000
UCBRV003 EQU   UCBJBNR                                                  17431000
UCBDUC   EQU   UCBJBNR                                                  17432000
UCBJES3  EQU   UCBJBNR                                                  17433000
UCBVRDEV EQU   UCBJBNR                                                  17434000
UCBCMSEG EQU   UCBOB                                                    17435000
UCBPFXND EQU   UCB+512                                                  17436000
UCBIOQ   EQU   UCB+508                                                  17437000
UCBLOCK  EQU   UCB+504                                                  17438000
UCBPXST  EQU   UCB+504                                                  17439000
@NM00101 EQU   UCB                                                      17440000
PTR1     EQU   AUTOARAY+8                                               17441000
ASIZE    EQU   AUTOARAY+6                                               17442000
STATUS   EQU   AUTOARAY+4                                               17443000
AREAID   EQU   AUTOARAY                                                 17444000
GPLAST   EQU   SAHIST+4                                                 17445000
GPFIRST  EQU   SAHIST                                                   17446000
@NM00100 EQU   IOCRCV                                                   17447000
IOCRCVRA EQU   IOCRCV                                                   17448000
IOCRCVXM EQU   IOCRCV                                                   17449000
IOCVLN   EQU   IOCSEX+42                                                17450000
IOCDNM   EQU   IOCSEX+40                                                17451000
IOCDLM   EQU   IOCSEX+36                                                17452000
IOCMODEX EQU   IOCMOD                                                   17453000
IOCMODRP EQU   IOCMOD                                                   17454000
IOCMODXM EQU   IOCMOD                                                   17455000
IOCMODUB EQU   IOCMOD                                                   17456000
IOCMODRG EQU   IOCMOD                                                   17457000
IOCMODDY EQU   IOCMOD                                                   17458000
IOCMODRR EQU   IOCMOD                                                   17459000
IOCMODPD EQU   IOCMOD                                                   17460000
IOCINFR1 EQU   IOCINF                                                   17461000
IOCINFCT EQU   IOCINF                                                   17462000
IOCINFDO EQU   IOCINF                                                   17463000
IOCINFAC EQU   IOCINF                                                   17464000
IOCINFQX EQU   IOCINF                                                   17465000
IOCINFND EQU   IOCINF                                                   17466000
IOCINFAE EQU   IOCINF                                                   17467000
IOCINFPT EQU   IOCINF                                                   17468000
@NM00099 EQU   IOCDEV                                                   17469000
IOCDEVUR EQU   IOCDEV                                                   17470000
IOCDEVMT EQU   IOCDEV                                                   17471000
IOCDEVDA EQU   IOCDEV                                                   17472000
@NM00098 EQU   IOCFLG                                                   17473000
IOCFLGSP EQU   IOCFLG                                                   17474000
IOCFLGOE EQU   IOCFLG                                                   17475000
IOCFLGOP EQU   IOCFLG                                                   17476000
IOCFLGIO EQU   IOCFLG                                                   17477000
IOCFLGEF EQU   IOCFLG                                                   17478000
IOCFLGDF EQU   IOCFLG                                                   17479000
IOCFLGEX EQU   IOCFLG                                                   17480000
IOCSID   EQU   IOCSEX+28                                                17481000
IOCNIO   EQU   IOCSEX+24                                                17482000
@NM00097 EQU   IOCXPM+2                                                 17483000
IOCEXL   EQU   IOCXPM                                                   17484000
IOCEXA   EQU   IOCXAD                                                   17485000
IOCWKA   EQU   IOCSEX+12                                                17486000
IOCLRP   EQU   IOCSEX+10                                                17487000
IOCCBL   EQU   IOCSEX+8                                                 17488000
IOCDEC   EQU   IOCRPL                                                   17489000
IOCCBA   EQU   IOCSEX                                                   17490000
@NM00096 EQU   IODATA+64                                                17491000
IODAEI   EQU   IODATA+60                                                17492000
@NM00095 EQU   IODATA+56                                                17493000
IODOCS   EQU   IODATA+48                                                17494000
IODICS   EQU   IODATA+44                                                17495000
IODOSO   EQU   IODATA+40                                                17496000
IODOSS   EQU   IODATA+36                                                17497000
IODEOD   EQU   IODATA+32                                                17498000
@NM00094 EQU   IODATA+30                                                17499000
@NM00093 EQU   IODATA+28                                                17500000
IODOEV   EQU   IODATA+24                                                17501000
IODIEV   EQU   IODATA+20                                                17502000
IODINC   EQU   IODSID+2                                                 17503000
IODMID   EQU   IODSID                                                   17504000
IODXTN   EQU   IODATA+12                                                17505000
IODADD   EQU   IODATA+8                                                 17506000
IODMSG   EQU   IODATA+4                                                 17507000
IODIOC   EQU   IODATA                                                   17508000
VSDDSN   EQU   VSDARRAY+4                                               17509000
VSDVOLCT EQU   VSDARRAY                                                 17510000
VSDFMT0  EQU   VSDBLOCK+8                                               17511000
VSDVTOCS EQU   VSDBLOCK+4                                               17512000
VSDELEM  EQU   VSDBLOCK                                                 17513000
VSDFREE  EQU   VSDUSAGE+24                                              17514000
VSDALLC  EQU   VSDUSAGE+19                                              17515000
VSDDSOR3 EQU   VSDDSORG+2                                               17516000
@NM00092 EQU   VSDDSORG                                                 17517000
VSDSCAL  EQU   VSDUSAGE+12                                              17518000
@NM00091 EQU   VSDUSEF                                                  17519000
VSDCALFR EQU   VSDUSEF                                                  17520000
@NM00090 EQU   VSDALLOC                                                 17521000
VSDABSTR EQU   VSDALLOC                                                 17522000
VSDABLK  EQU   VSDALLOC                                                 17523000
VSDATRK  EQU   VSDALLOC                                                 17524000
VSDACYL  EQU   VSDALLOC                                                 17525000
@NM00089 EQU   VSDDORG                                                  17526000
VSDOU    EQU   VSDDORG                                                  17527000
VSDOIS   EQU   VSDDORG                                                  17528000
VSDODA   EQU   VSDDORG                                                  17529000
VSDOUN   EQU   VSDDORG                                                  17530000
VSDOPS   EQU   VSDDORG                                                  17531000
VSDOPO   EQU   VSDDORG                                                  17532000
VSDEXTS  EQU   VSDUSAGE+8                                               17533000
VSDSECAL EQU   VSDUSAGE+4                                               17534000
VSDFTRK  EQU   VSDUSAGE+2                                               17535000
VSDTRKS  EQU   VSDUSAGE                                                 17536000
@NM00088 EQU   VSDSCR+5                                                 17537000
@NM00087 EQU   VSDSCRFL                                                 17538000
VSDVSAM  EQU   VSDSCRFL                                                 17539000
VSDCATLC EQU   VSDSCRFL                                                 17540000
VSDACBPT EQU   VSDSCR                                                   17541000
@NM00086 EQU   VSDSTAT+29                                               17542000
VSDPRTC  EQU   VSDSTAT+25                                               17543000
VSDCAT   EQU   VSDSTAT+22                                               17544000
VSDEXP   EQU   VSDSTAT+20                                               17545000
VSDCRE   EQU   VSDSTAT+18                                               17546000
@NM00085 EQU   VSDFLG2                                                  17547000
VSDRACF  EQU   VSDFLG2                                                  17548000
VSDERROR EQU   VSDFLG2                                                  17549000
VSDPROT  EQU   VSDFLG2                                                  17550000
VSDPWW   EQU   VSDFLG2                                                  17551000
VSDPWR   EQU   VSDFLG2                                                  17552000
@NM00084 EQU   VSDSFLG1                                                 17553000
VSDCVSAM EQU   VSDSFLG1                                                 17554000
VSDCATLG EQU   VSDSFLG1                                                 17555000
VSDVSAME EQU   VSDSFLG1                                                 17556000
VSDVSAMC EQU   VSDSFLG1                                                 17557000
VSDVTOCE EQU   VSDSFLG1                                                 17558000
VSDVTOCC EQU   VSDSFLG1                                                 17559000
VSDOWNER EQU   VSDSTAT+8                                                17560000
VSDEXPIR EQU   VSDSTAT+4                                                17561000
VSDCREAT EQU   VSDSTAT                                                  17562000
VSDFRCCL EQU   VSDVTOC+21                                               17563000
@NM00083 EQU   VSDVTOC+20                                               17564000
VSDFREXT EQU   VSDVTOC+16                                               17565000
@NM00082 EQU   VSDVTOC+15                                               17566000
VSDFRTRK EQU   VSDVTOC+11                                               17567000
@NM00081 EQU   VSDVTOC+10                                               17568000
VSDFRCYL EQU   VSDVTOC+6                                                17569000
@NM00080 EQU   VSDVTOC                                                  17570000
@NM00079 EQU   VS3FLAGS                                                 17571000
VS3SYSNM EQU   VS3FLAGS                                                 17572000
VS3UNCAT EQU   VS3FLAGS                                                 17573000
VS3SCR   EQU   VS3FLAGS                                                 17574000
VS3USAGE EQU   VS3FLAGS                                                 17575000
VS3STAT  EQU   VS3FLAGS                                                 17576000
VS3DD    EQU   VS3AGL+50                                                17577000
VS3VOL   EQU   VS3AGL+44                                                17578000
VS3POOL  EQU   VS3AGL+40                                                17579000
VS3DEV   EQU   VS3AGL+36                                                17580000
VS3UCBP  EQU   VS3AGL+32                                                17581000
VS3CREAT EQU   VS3AGL+28                                                17582000
VS3EXPIR EQU   VS3AGL+24                                                17583000
VS3AST   EQU   VS3AGL+22                                                17584000
VS3LEVLN EQU   VS3AGL+20                                                17585000
VS3LEVP  EQU   VS3AGL+16                                                17586000
VS3EXDSP EQU   VS3AGL+12                                                17587000
VS3LISTP EQU   VS3AGL+8                                                 17588000
VS3HEAD  EQU   VS3AGL                                                   17589000
@NM00078 EQU   DATESOPT                                                 17590000
DATDAYOP EQU   DATESOPT                                                 17591000
DATDTEOP EQU   DATESOPT                                                 17592000
DATSUB   EQU   DATESOPT                                                 17593000
DATADD   EQU   DATESOPT                                                 17594000
DATRETRN EQU   DATESAGL+16                                              17595000
DATDAYS  EQU   DATESAGL+12                                              17596000
DATDATE  EQU   DATESAGL+8                                               17597000
DATHEAD  EQU   DATESAGL                                                 17598000
@NM00077 EQU   SELFLAGS                                                 17599000
SELVOL   EQU   SELAGL+16                                                17600000
SELDDNP  EQU   SELAGL+12                                                17601000
SELUCBP  EQU   SELAGL+8                                                 17602000
SELHEAD  EQU   SELAGL                                                   17603000
@NM00076 EQU   UCTFLAGS                                                 17604000
UCTVSCAT EQU   UCTFLAGS                                                 17605000
UCTDD    EQU   UCTAGL+60                                                17606000
UCTVOLP  EQU   UCTAGL+56                                                17607000
UCTACBP  EQU   UCTAGL+52                                                17608000
UCTDSN   EQU   UCTAGL+8                                                 17609000
UCTHEAD  EQU   UCTAGL                                                   17610000
@NM00075 EQU   LCTFLAGS                                                 17611000
LCTVSCAT EQU   LCTFLAGS                                                 17612000
LCTOWNER EQU   LCTINFO+24                                               17613000
LCTEXPIR EQU   LCTINFO+20                                               17614000
LCTCREAT EQU   LCTINFO+16                                               17615000
LCTACBP  EQU   LCTINFO+12                                               17616000
LCTMULVC EQU   LCTINFO+8                                                17617000
LCTHEAD  EQU   LCTINFO                                                  17618000
SRTWORKP EQU   SRTAGL+28                                                17619000
SRTFLDLN EQU   SRTAGL+24                                                17620000
SRTPOSIT EQU   SRTAGL+20                                                17621000
SRTLEN   EQU   SRTAGL+16                                                17622000
SRTNUM   EQU   SRTAGL+12                                                17623000
SRTADDR  EQU   SRTAGL+8                                                 17624000
SRTHEAD  EQU   SRTAGL                                                   17625000
SV82TTRP EQU   SV82LIST+8                                               17626000
SV82VOLP EQU   SV82DCBP                                                 17627000
VOLRESV3 EQU   VOLLABEL+55                                              17628000
VOLOWNER EQU   VOLLABEL+45                                              17629000
VOLRESV1 EQU   VOLLABEL+20                                              17630000
VOLVTOC  EQU   VOLLABEL+15                                              17631000
VOLSECTY EQU   VOLLABEL+14                                              17632000
VOLSERNO EQU   VOLLABEL+8                                               17633000
VOLNO    EQU   VOLLABEL+7                                               17634000
VOLLABI  EQU   VOLLABEL+4                                               17635000
VOLKEY   EQU   VOLLABEL                                                 17636000
STAVTTR  EQU   STAEPARM+54                                              17637000
@NM00072 EQU   STARETRY                                                 17638000
@NM00071 EQU   STARCVY                                                  17639000
STACLEAR EQU   STARCVY                                                  17640000
STAVPOST EQU   STARCVY                                                  17641000
STAVENQ  EQU   STARCVY                                                  17642000
STAVDMNT EQU   STARCVY                                                  17643000
STAVMNT  EQU   STARCVY                                                  17644000
STATCB   EQU   STAEPARM+48                                              17645000
STAEXSAV EQU   STAEPARM+40                                              17646000
STARTTR  EQU   STAEPARM+32                                              17647000
@NM00070 EQU   STAEPARM+30                                              17648000
STARVOL  EQU   STAEPARM+24                                              17649000
STARUCB  EQU   STAEPARM+20                                              17650000
@NM00069 EQU   STAEPARM+18                                              17651000
STAVVOL  EQU   STAEPARM+12                                              17652000
STAVUCB  EQU   STAEPARM+8                                               17653000
STAHEAD  EQU   STAEPARM                                                 17654000
RCTDSET  EQU   RCTAGL+32                                                17655000
RCTNVOL  EQU   RCTAGL+26                                                17656000
RCTOVOL  EQU   RCTAGL+20                                                17657000
RCTNDEV  EQU   RCTAGL+16                                                17658000
RCTODEV  EQU   RCTAGL+12                                                17659000
@NM00068 EQU   RCTAGL+10                                                17660000
@NM00067 EQU   RCTOPT                                                   17661000
RCTVOL   EQU   RCTOPT                                                   17662000
RCTDEV   EQU   RCTOPT                                                   17663000
RCTHEAD  EQU   RCTAGL                                                   17664000
@NM00066 EQU   VSRESOPT                                                 17665000
VSREAL   EQU   VSRESOPT                                                 17666000
VSRES    EQU   VSRESOPT                                                 17667000
@NM00065 EQU   VSMSG                                                    17668000
VSTOV    EQU   VSMSG                                                    17669000
VSFROMV  EQU   VSMSG                                                    17670000
@NM00064 EQU   VSRETURN                                                 17671000
VSUCAT   EQU   VSRETURN                                                 17672000
VSVSAM   EQU   VSRETURN                                                 17673000
@NM00063 EQU   VSCATOPT                                                 17674000
VSLIST   EQU   VSCATOPT                                                 17675000
VSSERIAL EQU   VSCATOPT                                                 17676000
VSDEVICE EQU   VSCATOPT                                                 17677000
@NM00062 EQU   VSVTOPT                                                  17678000
VSVSFLAG EQU   VSVTOPT                                                  17679000
VSALTTRK EQU   VSVTOPT                                                  17680000
VSTIME   EQU   VSVTOPT                                                  17681000
VSUCMAST EQU   VSSECOPT                                                 17682000
VSOPCAT  EQU   VSSECOPT                                                 17683000
VSUCTEST EQU   VSSECOPT                                                 17684000
VSWRITE  EQU   VSSECOPT                                                 17685000
VSREAD   EQU   VSSECOPT                                                 17686000
VSNONONV EQU   VSSECOPT                                                 17687000
VSMASTER EQU   VSSECOPT                                                 17688000
VSNOVSAM EQU   VSSECOPT                                                 17689000
VSODEVP  EQU   VS1AGL+64                                                17690000
VSOSERP  EQU   VS1AGL+60                                                17691000
VSDEVP   EQU   VS1AGL+56                                                17692000
VSSERP   EQU   VS1AGL+52                                                17693000
VSPFILEP EQU   VS1AGL+48                                                17694000
VSPSWDP  EQU   VS1AGL+44                                                17695000
VSCATDDP EQU   VS1AGL+40                                                17696000
VSACBP   EQU   VS1AGL+36                                                17697000
VSCATP   EQU   VS1AGL+32                                                17698000
VSNXTATP EQU   VS1AGL+28                                                17699000
VSNUMATP EQU   VS1AGL+24                                                17700000
VSIOP    EQU   VS1AGL+20                                                17701000
VSFILEP  EQU   VS1AGL+16                                                17702000
VSVOLP   EQU   VS1AGL+12                                                17703000
VSUCBP   EQU   VS1AGL+8                                                 17704000
VSHEAD   EQU   VS1AGL                                                   17705000
VSVTOCPT EQU   VS2AGL+48                                                17706000
@NM00061 EQU   VS2AGL+45                                                17707000
VSDDNAME EQU   VS2AGL+37                                                17708000
@NM00060 EQU   VS2RESOP                                                 17709000
VS2REAL  EQU   VS2RESOP                                                 17710000
VS2RES   EQU   VS2RESOP                                                 17711000
@NM00059 EQU   VS2MSG                                                   17712000
VS2TOV   EQU   VS2MSG                                                   17713000
VSVOLUME EQU   VS2AGL+29                                                17714000
@NM00058 EQU   VSLABOPT                                                 17715000
VSNOVTOC EQU   VSLABOPT                                                 17716000
VSVOLSER EQU   VSLABOPT                                                 17717000
VSOWNER  EQU   VSLABOPT                                                 17718000
VSIOBKPT EQU   VS2AGL+24                                                17719000
VSVOLPTR EQU   VS2AGL+20                                                17720000
VSOWNPTR EQU   VS2AGL+16                                                17721000
VSVTOCSZ EQU   VS2AGL+12                                                17722000
VSUCBPTR EQU   VS2AGL+8                                                 17723000
VS2HEAD  EQU   VS2AGL                                                   17724000
@NM00057 EQU   EXPARRAY+5                                               17725000
EXPHEAD  EQU   EXPARG                                                   17726000
@NM00056 EQU   EXSPACE+8                                                17727000
@NM00055 EQU   EXSPACE+6                                                17728000
@NM00054 EQU   EXSPACE+4                                                17729000
@NM00053 EQU   EXSPACE+1                                                17730000
@NM00052 EQU   EXSPACE                                                  17731000
@NM00051 EQU   EXWRARG+31                                               17732000
EXRWDARE EQU   EXWRARG+16                                               17733000
EXRWRES  EQU   EXWRARG                                                  17734000
@NM00050 EQU   EXGARG+29                                                17735000
EXGHEAD  EQU   EXGARG                                                   17736000
@NM00049 EQU   EXFLG                                                    17737000
@NM00048 EQU   EXOPT                                                    17738000
EXOHEAD  EQU   EXOARG                                                   17739000
@NM00047 EQU   EXCLFLAG                                                 17740000
EXCLMNT  EQU   EXCLFLAG                                                 17741000
EXCLVOL  EQU   EXCLAGL+16                                               17742000
EXCLDDP  EQU   EXCLAGL+12                                               17743000
EXCLUCBP EQU   EXCLAGL+8                                                17744000
EXCLHEAD EQU   EXCLAGL                                                  17745000
@NM00046 EQU   CKFLAGS                                                  17746000
CKDMTABL EQU   CKFLAGS                                                  17747000
CKRETTYP EQU   CKFLAGS                                                  17748000
CKTESTVT EQU   CKFLAGS                                                  17749000
CKLABELP EQU   CKAGL+24                                                 17750000
CKDATYPE EQU   CKAGL+20                                                 17751000
CKDDNAME EQU   CKAGL+12                                                 17752000
CKUCBPTR EQU   CKAGL+8                                                  17753000
CKHEAD   EQU   CKAGL                                                    17754000
PULABELP EQU   PUAGL+16                                                 17755000
PUTTRPTR EQU   PUAGL+12                                                 17756000
PUUCBPTR EQU   PUAGL+8                                                  17757000
PUHEAD   EQU   PUAGL                                                    17758000
MDR      EQU   MDVTOC+4                                                 17759000
MDHH     EQU   MDVTOC+2                                                 17760000
MDCC     EQU   MDVTOC                                                   17761000
@NM00045 EQU   MDAGL+31                                                 17762000
MDVTOCTR EQU   MDFLAGS                                                  17763000
MDFORCE  EQU   MDFLAGS                                                  17764000
MDDEQ    EQU   MDFLAGS                                                  17765000
MDENQ    EQU   MDFLAGS                                                  17766000
MDWAIT   EQU   MDFLAGS                                                  17767000
MDPOST   EQU   MDFLAGS                                                  17768000
MDCLEAR  EQU   MDFLAGS                                                  17769000
MDNEWVOL EQU   MDFLAGS                                                  17770000
MDLABEL  EQU   MDAGL+24                                                 17771000
MDPUAGL  EQU   MDAGL+20                                                 17772000
MDDDNAME EQU   MDAGL+12                                                 17773000
MDUCBPTR EQU   MDAGL+8                                                  17774000
MDHEAD   EQU   MDAGL                                                    17775000
CTTBLRR  EQU   CTARRAY+3                                                17776000
CTTBLHH  EQU   CTARRAY+2                                                17777000
CTTBLCC  EQU   CTARRAY+1                                                17778000
CTTBLID  EQU   CTARRAY                                                  17779000
CTREALH  EQU   CTMSG+3                                                  17780000
CTREALCC EQU   CTMSG+1                                                  17781000
@NM00044 EQU   CTMSG                                                    17782000
CMCSN2   EQU   CMMSG+28                                                 17783000
CMCSN1   EQU   CMMSG+16                                                 17784000
CMNUMCRT EQU   CMMSG+15                                                 17785000
@NM00043 EQU   CMMSG+14                                                 17786000
CMNEWVOL EQU   CMMSG+8                                                  17787000
@NM00042 EQU   CMMSG+7                                                  17788000
@NM00041 EQU   CMVOLFLG                                                 17789000
CMRONLY  EQU   CMVOLFLG                                                 17790000
CMBIND   EQU   CMVOLFLG                                                 17791000
CMSCRCRT EQU   CMVOLFLG                                                 17792000
CMEXCL   EQU   CMVOLFLG                                                 17793000
CMDERAS  EQU   CMVOLFLG                                                 17794000
CMSCRVOL EQU   CMVOLFLG                                                 17795000
CMCECART EQU   CMVOLFLG                                                 17796000
CMOLDVOL EQU   CMMSG                                                    17797000
CCOLDCSN EQU   CCMSG+24                                                 17798000
CCNEWCSN EQU   CCMSG+12                                                 17799000
@NM00040 EQU   CCMSG+10                                                 17800000
CCVOL    EQU   CCMSG+4                                                  17801000
@NM00039 EQU   CCMSG+2                                                  17802000
CCEJCODE EQU   CCMSG+1                                                  17803000
CCPSTCDE EQU   CCMSG                                                    17804000
@NM00038 EQU   DMPARY+15                                                17805000
DMPARYTP EQU   DMPARY+14                                                17806000
DMPARYEX EQU   DMPARY+12                                                17807000
DMPARYIC EQU   DMPARY+10                                                17808000
DMPARYSZ EQU   DMPARY+8                                                 17809000
DMPARYNM EQU   DMPARY                                                   17810000
@NM00037 EQU   DMPITM+15                                                17811000
DMPITMTP EQU   DMPITM+14                                                17812000
DMPITMLN EQU   DMPITM+12                                                17813000
DMPITMPT EQU   DMPITM+8                                                 17814000
DMPITMNM EQU   DMPITM                                                   17815000
@NM00036 EQU   ERCNVTAB+24                                              17816000
ERDARBPT EQU   ERCPLPT                                                  17817000
ERDYNRC  EQU   ERCATRC                                                  17818000
ERDSNM   EQU   ERCNVTAB+12                                              17819000
@NM00035 EQU   ERCNVTAB+4                                               17820000
@NM00034 EQU   ERCNVTAB+3                                               17821000
@NM00033 EQU   EROSOPER                                                 17822000
EROSUCDX EQU   EROSOPER                                                 17823000
EROSCATL EQU   EROSOPER                                                 17824000
@NM00032 EQU   EROPER                                                   17825000
ERCATAL  EQU   EROPER                                                   17826000
ERCATDL  EQU   EROPER                                                   17827000
ERCATDE  EQU   EROPER                                                   17828000
ERCATLC  EQU   EROPER                                                   17829000
@NM00031 EQU   ERTYPE                                                   17830000
ERDYNAL  EQU   ERTYPE                                                   17831000
EROSCAT  EQU   ERTYPE                                                   17832000
ERCATLG  EQU   ERTYPE                                                   17833000
@NM00030 EQU   FMTCNVF+1                                                17834000
FMTAR    EQU   FMTCNVF+1                                                17835000
FMTBS    EQU   FMTCNVF+1                                                17836000
FMTSS    EQU   FMTCNVF+1                                                17837000
FMTAL    EQU   FMTCNVF+1                                                17838000
FMTZS    EQU   FMTCNVF+1                                                17839000
@NM00029 EQU   FMTCNVF                                                  17840000
FMTPU    EQU   FMTCNVF                                                  17841000
FMTBD    EQU   FMTCNVF                                                  17842000
FMTBHD   EQU   FMTCNVF                                                  17843000
FMTBHA   EQU   FMTCNVF                                                  17844000
FMTBH    EQU   FMTCNVF                                                  17845000
FMTOLEN  EQU   FMTLIST+8                                                17846000
FMTRIO   EQU   FMTOCOL                                                  17847000
FMTSPT   EQU   FMTSTO                                                   17848000
FMTSTL   EQU   FMTILEN                                                  17849000
@NM00028 EQU   FMTFLGS+1                                                17850000
FMTSMSG  EQU   FMTFLGS+1                                                17851000
FMTHDF   EQU   FMTFLGS                                                  17852000
FMTDFF   EQU   FMTFLGS                                                  17853000
FMTSTF   EQU   FMTFLGS                                                  17854000
FMTREPF  EQU   FMTFLGS                                                  17855000
FMTBDF   EQU   FMTFLGS                                                  17856000
FMTIDF   EQU   FMTFLGS                                                  17857000
FMTSCF   EQU   FMTFLGS                                                  17858000
FMTEOLF  EQU   FMTFLGS                                                  17859000
DARGPCT  EQU   DARGINL                                                  17860000
DARGREP  EQU   DARGINS                                                  17861000
@NM00027 EQU   DARGLIST+19                                              17862000
DARGIND  EQU   DARGLIST+18                                              17863000
DARGRETL EQU   DARGLIST+16                                              17864000
DARGRETP EQU   DARGLIST+4                                               17865000
UVOLVOL  EQU   UVOLENT+4                                                17866000
UVOLDEV  EQU   UVOLENT                                                  17867000
UVOLCNT  EQU   UVOLLIST                                                 17868000
@NM00026 EQU   IOINFOPT                                                 17869000
IOINFLUB EQU   IOINFOPT                                                 17870000
IOINFTMS EQU   IOINFOPT                                                 17871000
IOINFSUP EQU   IOINFOPT                                                 17872000
IOINFDSN EQU   IOINFOPT                                                 17873000
IOINFVOL EQU   IOINFOPT                                                 17874000
IOINFDVT EQU   IOINFOPT                                                 17875000
OPNVOL   EQU   OPNAGL+44                                                17876000
OPNSTRNO EQU   OPNAGL+43                                                17877000
@NM00025 EQU   OPNOPT2                                                  17878000
OPNOPTJM EQU   OPNOPT2                                                  17879000
OPNOPTNM EQU   OPNOPT2                                                  17880000
OPNOPTAS EQU   OPNOPT2                                                  17881000
@NM00024 EQU   OPNDSO                                                   17882000
OPNDSOPO EQU   OPNDSO                                                   17883000
OPNDSOIS EQU   OPNDSO                                                   17884000
OPNDSOPS EQU   OPNDSO                                                   17885000
OPNDSOAM EQU   OPNDSO                                                   17886000
OPNKYL   EQU   OPNAGL+40                                                17887000
OPNBLK   EQU   OPNAGL+36                                                17888000
OPNREC   EQU   OPNAGL+32                                                17889000
OPNDEVIX EQU   OPNDEV+4                                                 17890000
OPNDEVDT EQU   OPNDEV                                                   17891000
OPNCBP   EQU   OPNAGL+20                                                17892000
OPNDSN   EQU   OPNAGL+16                                                17893000
OPNPWA   EQU   OPNAGL+12                                                17894000
OPNDDN   EQU   OPNAGL+8                                                 17895000
OPNIOC   EQU   OPNAGL+4                                                 17896000
OPNMODRP EQU   OPNMOD                                                   17897000
OPNMODUB EQU   OPNMOD                                                   17898000
OPNMODRS EQU   OPNMOD                                                   17899000
OPNMODAX EQU   OPNMOD                                                   17900000
OPNMODRR EQU   OPNMOD                                                   17901000
OPNMODRC EQU   OPNMOD                                                   17902000
OPNMODAC EQU   OPNMOD                                                   17903000
OPNMODPD EQU   OPNMOD                                                   17904000
OPNTYPSY EQU   OPNTYP                                                   17905000
OPNTYPRV EQU   OPNTYP                                                   17906000
OPNTYPEX EQU   OPNTYP                                                   17907000
OPNTYPRA EQU   OPNTYP                                                   17908000
OPNTYPXM EQU   OPNTYP                                                   17909000
OPNTYPCI EQU   OPNTYP                                                   17910000
OPNTYPSO EQU   OPNTYP                                                   17911000
OPNTYPSI EQU   OPNTYP                                                   17912000
@NM00023 EQU   OPNRFM                                                   17913000
OPNRFMBK EQU   OPNRFM                                                   17914000
OPNRFMSF EQU   OPNRFM                                                   17915000
OPNRFMUN EQU   OPNRFM                                                   17916000
OPNRFMVR EQU   OPNRFM                                                   17917000
OPNRFMFX EQU   OPNRFM                                                   17918000
OPNOPTSK EQU   OPNOPT                                                   17919000
OPNOPTDR EQU   OPNOPT                                                   17920000
OPNOPTCR EQU   OPNOPT                                                   17921000
OPNOPTKS EQU   OPNOPT                                                   17922000
OPNOPTBK EQU   OPNOPT                                                   17923000
OPNOPTUP EQU   OPNOPT                                                   17924000
OPNOPTOT EQU   OPNOPT                                                   17925000
OPNOPTIN EQU   OPNOPT                                                   17926000
IOCTSML  EQU   IOCREL+2                                                 17927000
IOCTPML  EQU   IOCREL                                                   17928000
IOCWORK  EQU   IOCSTR+56                                                17929000
IOCRRN   EQU   IOCSTR+52                                                17930000
IOCPNM   EQU   IOCNWM+2                                                 17931000
IOCPTL   EQU   IOCNWM                                                   17932000
IOCKYA   EQU   IOCMEM                                                   17933000
IOCVRC   EQU   IOCTTR                                                   17934000
IOCCBP   EQU   IOCSTR+36                                                17935000
IOCDSN   EQU   IOCSTR+32                                                17936000
IOCHURBA EQU   IOCSTR+28                                                17937000
IOCVOLSR EQU   IOCSTR+22                                                17938000
@NM00022 EQU   IOCMSG                                                   17939000
IOCMSGSM EQU   IOCMSG                                                   17940000
IOCMSGAE EQU   IOCMSG                                                   17941000
IOCMSGCE EQU   IOCMSG                                                   17942000
IOCMSGOE EQU   IOCMSG                                                   17943000
IOCMSGOP EQU   IOCMSG                                                   17944000
IOCCHPKG EQU   IOCMSG                                                   17945000
IOCCHPKE EQU   IOCMSG                                                   17946000
IOCCHPNU EQU   IOCCHP                                                   17947000
IOCCHPUP EQU   IOCCHP                                                   17948000
IOCCHPBK EQU   IOCCHP                                                   17949000
IOCCHPCR EQU   IOCCHP                                                   17950000
IOCCHPKS EQU   IOCCHP                                                   17951000
IOCCHPSK EQU   IOCCHP                                                   17952000
IOCCHPDR EQU   IOCCHP                                                   17953000
IOCCHPSQ EQU   IOCCHP                                                   17954000
IOCMACNT EQU   IOCMAC2                                                  17955000
IOCMACER EQU   IOCMAC2                                                  17956000
IOCMACPA EQU   IOCMAC2                                                  17957000
IOCMACEN EQU   IOCMAC2                                                  17958000
IOCMACCP EQU   IOCMAC2                                                  17959000
IOCMACRR EQU   IOCMAC2                                                  17960000
IOCMACAS EQU   IOCMAC2                                                  17961000
IOCMACSK EQU   IOCMAC2                                                  17962000
@NM00021 EQU   IOCMAC                                                   17963000
IOCMACCC EQU   IOCMAC                                                   17964000
IOCMACDR EQU   IOCMAC                                                   17965000
IOCMACBK EQU   IOCMAC                                                   17966000
IOCMACCR EQU   IOCMAC                                                   17967000
IOCMACUP EQU   IOCMAC                                                   17968000
IOCMACOT EQU   IOCMAC                                                   17969000
IOCMACIN EQU   IOCMAC                                                   17970000
@NM00020 EQU   IOCRFM                                                   17971000
IOCRFMBK EQU   IOCRFM                                                   17972000
IOCRFMSF EQU   IOCRFM                                                   17973000
IOCRFMUN EQU   IOCRFM                                                   17974000
IOCRFMVR EQU   IOCRFM                                                   17975000
IOCRFMFX EQU   IOCRFM                                                   17976000
@NM00019 EQU   IOCDSO                                                   17977000
IOCDSOPO EQU   IOCDSO                                                   17978000
IOCDSOIS EQU   IOCDSO                                                   17979000
IOCDSOPS EQU   IOCDSO                                                   17980000
IOCDSOAM EQU   IOCDSO                                                   17981000
IOCRKP   EQU   IOCSTR+13                                                17982000
IOCKYL   EQU   IOCSTR+12                                                17983000
IOCTRN   EQU   IOCSTR+8                                                 17984000
IOCDLN   EQU   IOCSTR+4                                                 17985000
IOCDAD   EQU   IOCSTR                                                   17986000
UNITVTOC EQU   UNITABL+7                                                17987000
@NM00018 EQU   UNITSTAT                                                 17988000
UNITUSHR EQU   UNITSTAT                                                 17989000
UNITXSHR EQU   UNITSTAT                                                 17990000
UNITISHR EQU   UNITSTAT                                                 17991000
UNITUA   EQU   @NM00017+1                                               17992000
UNITCHA  EQU   @NM00017                                                 17993000
UNITUCB  EQU   UNITABL                                                  17994000
RACFVOLS EQU   RACFAGL+16                                               17995000
RACFCLN  EQU   RACFAGL+12                                               17996000
RACFPROF EQU   RACFAGL+8                                                17997000
RACFENT  EQU   RACFAGL+4                                                17998000
@NM00016 EQU   RACFFLG4                                                 17999000
@NM00015 EQU   RACFFLG3                                                 18000000
RACFPRF  EQU   RACFFLG3                                                 18001000
@NM00014 EQU   RACFFLG3                                                 18002000
@NM00013 EQU   RACFFLG2                                                 18003000
RACFTRD  EQU   RACFFLG2                                                 18004000
RACFTUPD EQU   RACFFLG2                                                 18005000
RACFTCTL EQU   RACFFLG2                                                 18006000
@NM00012 EQU   RACFFLG2                                                 18007000
RACFTALT EQU   RACFFLG2                                                 18008000
RACFCSA  EQU   RACFFLG1                                                 18009000
RACFLOGN EQU   RACFFLG1                                                 18010000
RACFLOGF EQU   RACFFLG1                                                 18011000
@NM00011 EQU   RACFFLG1                                                 18012000
RACFDSTV EQU   RACFFLG1                                                 18013000
@NM00010 EQU   RACFFLG1                                                 18014000
ALLUNCNT EQU   ALLAGL+30                                                18015000
ALLVLCNT EQU   ALLAGL+29                                                18016000
@NM00009 EQU   ALLOPT                                                   18017000
ALLOPTUN EQU   ALLOPT                                                   18018000
ALLOPTPV EQU   ALLOPT                                                   18019000
ALLOPTDS EQU   ALLOPT                                                   18020000
ALLOPTVL EQU   ALLOPT                                                   18021000
@NM00008 EQU   ALLORG+1                                                 18022000
ALLORGVS EQU   ALLORG+1                                                 18023000
@NM00007 EQU   ALLORG+1                                                 18024000
ALLORGGS EQU   ALLORG+1                                                 18025000
ALLORGUN EQU   ALLORG                                                   18026000
ALLORGPO EQU   ALLORG                                                   18027000
ALLORGMQ EQU   ALLORG                                                   18028000
ALLORGCQ EQU   ALLORG                                                   18029000
ALLORGCX EQU   ALLORG                                                   18030000
ALLORGDA EQU   ALLORG                                                   18031000
ALLORGPS EQU   ALLORG                                                   18032000
ALLORGIS EQU   ALLORG                                                   18033000
ALLDSPUN EQU   ALLDSP                                                   18034000
ALLDSPCG EQU   ALLDSP                                                   18035000
ALLDSPDE EQU   ALLDSP                                                   18036000
ALLDSPKP EQU   ALLDSP                                                   18037000
@NM00006 EQU   ALLDSP                                                   18038000
ALLSTSOD EQU   ALLSTS                                                   18039000
ALLSTSMD EQU   ALLSTS                                                   18040000
ALLSTSNW EQU   ALLSTS                                                   18041000
ALLSTSSR EQU   ALLSTS                                                   18042000
@NM00005 EQU   ALLSTS                                                   18043000
ALLPWD   EQU   ALLAGL+20                                                18044000
ALLVLP   EQU   ALLAGL+16                                                18045000
ALLULP   EQU   ALLAGL+12                                                18046000
ALLDDN   EQU   ALLAGL+4                                                 18047000
ALLDSN   EQU   ALLAGL                                                   18048000
CIRPID   EQU   CIRAGL+28                                                18049000
CIRPWD   EQU   CIRAGL+24                                                18050000
CIRCAT   EQU   CIRAGL+20                                                18051000
CIRWKP   EQU   CIRAGL+16                                                18052000
CIRTLR   EQU   CIRAGL+12                                                18053000
CIRHDR   EQU   CIRAGL+8                                                 18054000
CIRTLN   EQU   CIRAGL+6                                                 18055000
CIRHLN   EQU   CIRAGL+4                                                 18056000
@NM00004 EQU   CIRAGL+1                                                 18057000
@NM00003 EQU   CIRTYPE                                                  18058000
CIRTYPAQ EQU   CIRTYPE                                                  18059000
CIRTYP1Q EQU   CIRTYPE                                                  18060000
NEWID1   EQU   TRACE1+95                                                18061000
CALLID   EQU   OLDERID1+90                                              18062000
@NM00002 EQU   OLDERID1                                                 18063000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      18064000
@RC00945 EQU   @RC00928                                                 18065000
@RF01145 EQU   @RC01126                                                 18066000
@RF01267 EQU   @RC01250                                                 18067000
@RC01262 EQU   @RC01250                                                 18068000
@RC01257 EQU   @RC01250                                                 18069000
@RC01550 EQU   @RC01532                                                 18070000
@RC01631 EQU   @RC01611                                                 18071000
@RC01637 EQU   @RC01611                                                 18072000
@RC01736 EQU   @RC01732                                                 18073000
@ENDDATA EQU   *                                                        18074000
         END   IDCIO05,(C'PLS1440',0701,77354)                          18075000
