         TITLE '***** IDCLC01: LISTCAT FSR - INITIALIZATION AND ROUTING*00001000
               G *****  '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCLC01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCLC01   78.033'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @11,4095(,@10)                                      0002 00023000
         LA    @12,4095(,@11)                                      0002 00024000
         USING @PSTART,@09                                         0002 00025000
         USING @PSTART+4095,@10                                    0002 00026000
         USING @PSTART+8190,@11                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0273 00038000
*        CALL IDCLC02(GDTTBL,                                      0274 00039000
*                     FDTTBL);                             /*@ZA05939*/ 00040000
*                                                                  0274 00041000
         L     @04,@PC00001                                        0274 00042000
         ST    @04,@AL00001                                        0274 00043000
         L     @04,@PC00001+4                                      0274 00044000
         ST    @04,@AL00001+4                                      0274 00045000
         L     @15,@CV00869                                        0274 00046000
         LA    @01,@AL00001                                        0274 00047000
         BALR  @14,@15                                             0274 00048000
*        /************************************************************/ 00049000
*        /*                                                  @ZA05939*/ 00050000
*        /* SAVE THE POINTER TO THE COMMON AREA RETURNED     @ZA05939*/ 00051000
*        /* BY IDCLC02.                                      @ZA05939*/ 00052000
*        /*                                                  @ZA05939*/ 00053000
*        /************************************************************/ 00054000
*                                                                  0275 00055000
*        RESPECIFY (RTNREG) RSTD;                          /*@ZA05939*/ 00056000
*        COMPTR = RTNREG;                                  /*@ZA05939*/ 00057000
         LR    COMPTR,RTNREG                                       0276 00058000
*        RESPECIFY (RTNREG) UNRSTD;                        /*@ZA05939*/ 00059000
*                                                                  0277 00060000
*        /************************************************************/ 00061000
*        /*                                                          */ 00062000
*        /*  GLOBAL INITIALIZATIONS                                  */ 00063000
*        /*                                                          */ 00064000
*        /************************************************************/ 00065000
*                                                                  0278 00066000
*        RESPECIFY DARGLIST BASED(DARGPTR);                /*@ZA05939*/ 00067000
*        FLAGS = ZEROAREA;                                         0279 00068000
         L     @04,COMFLGPT(,COMPTR)                               0279 00069000
         MVC   FLAGS(34,@04),ZEROAREA                              0279 00070000
*        TYPAUDIT = ZEROAREA;                                      0280 00071000
         L     @04,COMTOTPT(,COMPTR)                               0280 00072000
         MVC   TYPAUDIT(48,@04),ZEROAREA                           0280 00073000
*        SAVRC = 0;                                        /*@ZA05939*/ 00074000
         SLR   @04,@04                                             0281 00075000
         L     @02,COMVARPT(,COMPTR)                               0281 00076000
         STH   @04,SAVRC(,@02)                                     0281 00077000
*        ERRARGPT = ADDR(ERRDARG);                                 0282 00078000
         L     @02,COMSWKPT(,COMPTR)                               0282 00079000
         LA    @15,ERRDARG                                         0282 00080000
         ST    @15,ERRARGPT(,@02)                                  0282 00081000
*        ERRDARG = ZEROAREA;                                       0283 00082000
         MVC   ERRDARG(44),ZEROAREA                                0283 00083000
*        PWTALLY = 0;                                              0284 00084000
         ST    @04,PWTALLY                                         0284 00085000
*        DPLISTPT = ADDR(DAS#FLGS);                                0285 00086000
*                                                                  0285 00087000
         LA    @04,DAS#FLGS                                        0285 00088000
         ST    @04,DPLISTPT(,@02)                                  0285 00089000
*        /************************************************************/ 00090000
*        /*                                                  @YL026UE*/ 00091000
*        /* IN TSO USERID IS THE DEFAULT IF 'ENTRY' OR 'LEVEL' IS    */ 00092000
*        /* NOT SPECIFIED.  ISSUE UID MACRO TO OBTAIN USERID.        */ 00093000
*        /*                                                  @YL026UE*/ 00094000
*        /************************************************************/ 00095000
*                                                                  0286 00096000
*                                                                  0286 00097000
*        CALL IDCSAID0(GDTTBL,UIDNM,UIDLN);                /*@YL026UE*/ 00098000
*                                                                  0286 00099000
         L     @04,@PC00001                                        0286 00100000
         ST    @04,@AL00001                                        0286 00101000
         LA    @02,UIDNM                                           0286 00102000
         ST    @02,@AL00001+4                                      0286 00103000
         LA    @02,UIDLN                                           0286 00104000
         ST    @02,@AL00001+8                                      0286 00105000
         MVI   @AL00001+8,X'80'                                    0286 00106000
         L     @15,GDTUID(,@04)                                    0286 00107000
         LA    @01,@AL00001                                        0286 00108000
         BALR  @14,@15                                             0286 00109000
*        /************************************************************/ 00110000
*        /*                                                          */ 00111000
*        /* INITIALIZE FLAG TO INDICATE ENTPROC WILL BE CALLED       */ 00112000
*        /* IF APPLICABLE.                                   @YL026UE*/ 00113000
*        /* PROCEED TO INTERROGATE USER'S REQUEST AND SETUP REQUIRED */ 00114000
*        /* CATALOG WORKAREAS AND PARM LISTS.                        */ 00115000
*        /*                                                          */ 00116000
*        /************************************************************/ 00117000
*                                                                  0287 00118000
*        IF ADDR(ENT) > NULLPTR | ADDR(LVL) > NULLPTR | UIDLN > 0  0287 00119000
*          THEN                                                    0287 00120000
         SLR   @04,@04                                             0287 00121000
         L     @02,@PC00001+4                                      0287 00122000
         C     @04,FDTPTR+8(,@02)                                  0287 00123000
         BL    @RT00287                                            0287 00124000
         C     @04,FDTPTR+80(,@02)                                 0287 00125000
         BL    @RT00287                                            0287 00126000
         CH    @04,UIDLN                                           0287 00127000
         BNL   @RF00287                                            0287 00128000
@RT00287 DS    0H                                                  0288 00129000
*            ENLVUDFG = ON;                                /*@YL026UE*/ 00130000
*                                                                  0288 00131000
         L     @04,COMFLGPT(,COMPTR)                               0288 00132000
         OI    ENLVUDFG(@04),B'10000000'                           0288 00133000
*        /************************************************************/ 00134000
*        /*                                                  @YL026UE*/ 00135000
*        /* CATALOG DNAME WILL NOT BE USED. THE CATALOG WILL BE      */ 00136000
*        /* OPENED BY VSAM CATALOG IF NECESSARY              @YL026UE*/ 00137000
*        /*                                                  @YL026UE*/ 00138000
*        /************************************************************/ 00139000
*                                                                  0289 00140000
*        FDTPTR(12) = NULLPTR;         /* ADDR(CATDD)=0      @Y30SSMK*/ 00141000
@RF00287 L     @04,@PC00001+4                                      0289 00142000
         SLR   @02,@02                                             0289 00143000
         ST    @02,FDTPTR+44(,@04)                                 0289 00144000
*        CALL INITPROC;                                            0290 00145000
         BAL   @14,INITPROC                                        0290 00146000
*        RESPECIFY RTNREG RSTD;                                    0291 00147000
*        TESTRC = RTNREG;                                          0292 00148000
         LR    TESTRC,RTNREG                                       0292 00149000
*        RESPECIFY RTNREG UNRSTD;                                  0293 00150000
*                                                                  0293 00151000
*        /************************************************************/ 00152000
*        /*                                                  @Y30SSMK*/ 00153000
*        /* IF ANY ERRORS ARE ENCOUNTERED DURING INITIALIZATION,     */ 00154000
*        /* SAVE THE MAXIMUM RETURN CODE, AND IF ANY ERROR   @Y30SSMK*/ 00155000
*        /* MESSAGES HAVE NOT YET BEEN PRINTED, DO SO.       @Y30SSMK*/ 00156000
*        /*                                                  @Y30SSMK*/ 00157000
*        /************************************************************/ 00158000
*                                                                  0294 00159000
*        IF TESTRC ^= 0                                            0294 00160000
*          THEN                                                    0294 00161000
         LTR   TESTRC,TESTRC                                       0294 00162000
         BZ    @RF00294                                            0294 00163000
*            DO;                                                   0295 00164000
*              SAVRC = MAX (SAVRC, TESTRC);                /*@ZA05939*/ 00165000
         L     @02,COMVARPT(,COMPTR)                               0296 00166000
         LH    @15,SAVRC(,@02)                                     0296 00167000
         CR    @15,TESTRC                                          0296 00168000
         BNL   *+6                                                      00169000
         LR    @15,TESTRC                                          0296 00170000
         STH   @15,SAVRC(,@02)                                     0296 00171000
*              IF NOMSGFLG = ON                                    0297 00172000
*                THEN                                              0297 00173000
         L     @02,COMFLGPT(,COMPTR)                               0297 00174000
         TM    NOMSGFLG(@02),B'10000000'                           0297 00175000
         BNO   @RF00297                                            0297 00176000
*                  NOMSGFLG = OFF;                                 0298 00177000
         NI    NOMSGFLG(@02),B'01111111'                           0298 00178000
*                ELSE                                              0299 00179000
*                  CALL ERRPROC;                                   0299 00180000
         B     @RC00297                                            0299 00181000
@RF00297 L     @15,@CV00872                                        0299 00182000
         BALR  @14,@15                                             0299 00183000
*            END;                                                  0300 00184000
*                                                                  0300 00185000
@RC00297 DS    0H                                                  0301 00186000
*        /************************************************************/ 00187000
*        /*                                                          */ 00188000
*        /* BEGIN PROCESSING EITHER AN ENTRY LIST OR THE FULL        */ 00189000
*        /* CATALOG OR A SUBSET OF TYPES THEREFROM, UNLESS           */ 00190000
*        /* TERMINATING CONDITIONS EXIST.                            */ 00191000
*        /*                                                          */ 00192000
*        /************************************************************/ 00193000
*                                                                  0301 00194000
*        IF SAVRC < LASTCC12  &  CMDERRSW = OFF                    0301 00195000
*          THEN                                                    0301 00196000
@RF00294 L     @02,COMVARPT(,COMPTR)                               0301 00197000
         LH    @02,SAVRC(,@02)                                     0301 00198000
         C     @02,@CF00586                                        0301 00199000
         BNL   @RF00301                                            0301 00200000
         L     @02,COMFLGPT(,COMPTR)                               0301 00201000
         TM    CMDERRSW(@02),B'10000000'                           0301 00202000
         BNZ   @RF00301                                            0301 00203000
*            DO;                                                   0302 00204000
*              IF ENLVUDFG = ON                                    0303 00205000
*                THEN                                              0303 00206000
         TM    ENLVUDFG(@02),B'10000000'                           0303 00207000
         BNO   @RF00303                                            0303 00208000
*                  DO;                                     /*@YL026UE*/ 00209000
*                    IF ADDR(CATNM) = NULLPTR /*NO CATLG HEADER LINE */ 00210000
*                      THEN                                        0305 00211000
         L     @04,@PC00001+4                                      0305 00212000
         L     @04,FDTPTR+40(,@04)                                 0305 00213000
         LTR   @04,@04                                             0305 00214000
         BNZ   @RF00305                                            0305 00215000
*                        DO;                               /*@YL026UE*/ 00216000
*                          SUBTFLG = ON;                   /*@YL026UE*/ 00217000
         OI    SUBTFLG(@02),B'10000000'                            0307 00218000
*                          NOTTLFLG = ON;                  /*@YL026UE*/ 00219000
         OI    NOTTLFLG(@02),B'10000000'                           0308 00220000
*                        END;                              /*@YL026UE*/ 00221000
*                    ENTCT = 1;        /*INITIALIZE          @YL026UE*/ 00222000
@RF00305 MVC   ENTCT(4),@CF00045                                   0310 00223000
*                    ETYTYP = ' ';     /*INITIALIZE          @YL026UE*/ 00224000
         MVI   ETYTYP,C' '                                         0311 00225000
*                    CALL ENTPROC;                         /*@YL026UE*/ 00226000
         BAL   @14,ENTPROC                                         0312 00227000
*                  END;                                    /*@YL026UE*/ 00228000
*                ELSE                                              0314 00229000
*                  CALL GNXTPROC;                                  0314 00230000
         B     @RC00303                                            0314 00231000
@RF00303 BAL   @14,GNXTPROC                                        0314 00232000
*              RESPECIFY RTNREG RSTD;                              0315 00233000
@RC00303 DS    0H                                                  0316 00234000
*              TESTRC = RTNREG;                                    0316 00235000
         LR    TESTRC,RTNREG                                       0316 00236000
*              RESPECIFY RTNREG UNRSTD;                            0317 00237000
*              IF TESTRC ^= 0                                      0318 00238000
*                THEN                                              0318 00239000
         LTR   TESTRC,TESTRC                                       0318 00240000
         BZ    @RF00318                                            0318 00241000
*                  DO;                                             0319 00242000
*                    SAVRC = MAX (SAVRC, TESTRC);          /*@ZA05939*/ 00243000
         L     @02,COMVARPT(,COMPTR)                               0320 00244000
         LH    @15,SAVRC(,@02)                                     0320 00245000
         CR    @15,TESTRC                                          0320 00246000
         BNL   *+6                                                      00247000
         LR    @15,TESTRC                                          0320 00248000
         STH   @15,SAVRC(,@02)                                     0320 00249000
*                    IF NOMSGFLG = ON                              0321 00250000
*                      THEN                                        0321 00251000
         L     @02,COMFLGPT(,COMPTR)                               0321 00252000
         TM    NOMSGFLG(@02),B'10000000'                           0321 00253000
         BNO   @RF00321                                            0321 00254000
*                        NOMSGFLG = OFF;                           0322 00255000
         NI    NOMSGFLG(@02),B'01111111'                           0322 00256000
*                      ELSE                                        0323 00257000
*                        CALL ERRPROC;                             0323 00258000
         B     @RC00321                                            0323 00259000
@RF00321 L     @15,@CV00872                                        0323 00260000
         BALR  @14,@15                                             0323 00261000
*                  END;                                            0324 00262000
@RC00321 DS    0H                                                  0325 00263000
*        /************************************************************/ 00264000
*        /*                                                          */ 00265000
*        /* OUTPUT EOJ STATISTICS ON THE NUMBER OF ENTRIES PROCESSED */ 00266000
*        /* AND SUPPRESSED.                                          */ 00267000
*        /*                                                          */ 00268000
*        /* UNDER TSO, EOJ STATISTICS WILL NOT BE PRINTED,     YM4128*/ 00269000
*        /* AND THE NUMBER OF ENTRIES SUPPRESSED WILL ONLY     YM4128*/ 00270000
*        /* BE PRINTED IF NONZERO.                             YM4128*/ 00271000
*        /*                                                          */ 00272000
*        /************************************************************/ 00273000
*                                                                  0325 00274000
*        IF GDTECT = NULLPTR                                 /*YM4128*/ 00275000
*          THEN                                              /*YM4128*/ 00276000
@RF00318 L     @02,@PC00001                                        0325 00277000
         L     @02,GDTECT(,@02)                                    0325 00278000
         LTR   @02,@02                                             0325 00279000
         BNZ   @RF00325                                            0325 00280000
*            DO;                                             /*YM4128*/ 00281000
*              TOTLCNT = CTYPCNT +                                 0327 00282000
*                        DTYPCNT +                                 0327 00283000
*                        ITYPCNT +                                 0327 00284000
*                        ATYPCNT +                                 0327 00285000
*                        UTYPCNT +                                 0327 00286000
*                        VTYPCNT +                                 0327 00287000
*                        XTYPCNT +                                 0327 00288000
*                        BTYPCNT +                                 0327 00289000
*                        PTYPCNT +                         /*@Y30SSMK*/ 00290000
*                        GTYPCNT +                         /*@Y30SSMK*/ 00291000
*                        RTYPCNT;                          /*@Y30SSMK*/ 00292000
         L     @02,COMTOTPT(,COMPTR)                               0327 00293000
         L     @15,CTYPCNT(,@02)                                   0327 00294000
         AL    @15,DTYPCNT(,@02)                                   0327 00295000
         AL    @15,ITYPCNT(,@02)                                   0327 00296000
         AL    @15,ATYPCNT(,@02)                                   0327 00297000
         AL    @15,UTYPCNT(,@02)                                   0327 00298000
         AL    @15,VTYPCNT(,@02)                                   0327 00299000
         AL    @15,XTYPCNT(,@02)                                   0327 00300000
         AL    @15,BTYPCNT(,@02)                                   0327 00301000
         AL    @15,PTYPCNT(,@02)                                   0327 00302000
         AL    @15,GTYPCNT(,@02)                                   0327 00303000
         AL    @15,RTYPCNT(,@02)                                   0327 00304000
         ST    @15,TOTLCNT(,@02)                                   0327 00305000
*              DARGSMOD = LC1ID;                                   0328 00306000
         L     @01,COMSWKPT(,COMPTR)                               0328 00307000
         L     @15,DARGPTR(,@01)                                   0328 00308000
         MVC   DARGSMOD(3,@15),@CC01155                            0328 00309000
*              DARGSENT = LCMSG07;                                 0329 00310000
         MVI   DARGSENT(@15),X'07'                                 0329 00311000
*              DARGDBP = ADDR(TYPAUDIT);                           0330 00312000
         ST    @02,DARGDBP(,@15)                                   0330 00313000
*              DARGILP = LENGTH(TYPAUDIT);                         0331 00314000
         MVC   DARGILP(2,@15),@CH01565                             0331 00315000
*              CALL LISTPROC;                                      0332 00316000
         L     @15,@CV00871                                        0332 00317000
         BALR  @14,@15                                             0332 00318000
*            END;                                            /*YM4128*/ 00319000
*                                                                  0333 00320000
*              IF (PWTALLY ^= 0 & GDTECT ^= NULLPTR) |       /*YM4128*/ 00321000
*                 GDTECT = NULLPTR                           /*YM4128*/ 00322000
*                THEN                                        /*YM4128*/ 00323000
@RF00325 SLR   @02,@02                                             0334 00324000
         C     @02,PWTALLY                                         0334 00325000
         BE    @GL00004                                            0334 00326000
         L     @15,@PC00001                                        0334 00327000
         C     @02,GDTECT(,@15)                                    0334 00328000
         BNE   @RT00334                                            0334 00329000
@GL00004 L     @02,@PC00001                                        0334 00330000
         L     @02,GDTECT(,@02)                                    0334 00331000
         LTR   @02,@02                                             0334 00332000
         BNZ   @RF00334                                            0334 00333000
@RT00334 DS    0H                                                  0335 00334000
*                  DO;                                       /*YM4128*/ 00335000
*                    DARGSMOD = LC1ID;                             0336 00336000
         L     @02,COMSWKPT(,COMPTR)                               0336 00337000
         L     @02,DARGPTR(,@02)                                   0336 00338000
         MVC   DARGSMOD(3,@02),@CC01155                            0336 00339000
*                    DARGSENT = LCMSG10;                           0337 00340000
         MVI   DARGSENT(@02),X'0A'                                 0337 00341000
*                    DARGDBP = ADDR(PWTALLY);                      0338 00342000
         LA    @15,PWTALLY                                         0338 00343000
         ST    @15,DARGDBP(,@02)                                   0338 00344000
*                    DARGILP = LENGTH(PWTALLY);                    0339 00345000
         MVC   DARGILP(2,@02),@CH00050                             0339 00346000
*                    CALL LISTPROC;                                0340 00347000
         L     @15,@CV00871                                        0340 00348000
         BALR  @14,@15                                             0340 00349000
*                  END;                                      /*YM4128*/ 00350000
*            END;                                                  0342 00351000
@RF00334 DS    0H                                                  0343 00352000
*        /************************************************************/ 00353000
*        /*                                                          */ 00354000
*        /* SELECT THE APPROPRIATE EOJ MESSAGE.                      */ 00355000
*        /*                                                          */ 00356000
*        /************************************************************/ 00357000
*                                                                  0343 00358000
*        IF GDTECT ^= NULLPTR                                      0343 00359000
*          THEN                                                    0343 00360000
@RF00301 SLR   @02,@02                                             0343 00361000
         L     @15,@PC00001                                        0343 00362000
         C     @02,GDTECT(,@15)                                    0343 00363000
         BE    @RF00343                                            0343 00364000
*            DO;                                                   0344 00365000
*              IF SAVRC > 0                                        0345 00366000
*                THEN                                              0345 00367000
         L     @01,COMVARPT(,COMPTR)                               0345 00368000
         CH    @02,SAVRC(,@01)                                     0345 00369000
         BNL   @RF00345                                            0345 00370000
*                  DO;                                     /*@Y30SSMK*/ 00371000
*                    ERRARGPT->DARGSMOD = UV0ID;           /*@Y30SSMK*/ 00372000
         L     @02,COMSWKPT(,COMPTR)                               0347 00373000
         L     @02,ERRARGPT(,@02)                                  0347 00374000
         MVC   DARGSMOD(3,@02),@CC01149                            0347 00375000
*                    ERRARGPT->DARGSENT = UVMSG15;         /*@Y30SSMK*/ 00376000
         MVI   DARGSENT(@02),X'0F'                                 0348 00377000
*                    CALL ERRPROC;                         /*@Y30SSMK*/ 00378000
         L     @15,@CV00872                                        0349 00379000
         BALR  @14,@15                                             0349 00380000
*                  END;                                    /*@Y30SSMK*/ 00381000
*            END;                                          /*@Y30SSMK*/ 00382000
*          ELSE                                                    0352 00383000
*            DO;                                           /*@Y30SSMK*/ 00384000
         B     @RC00343                                            0352 00385000
@RF00343 DS    0H                                                  0353 00386000
*              IF SAVRC < LASTCC12                                 0353 00387000
*                THEN                                              0353 00388000
         L     @02,COMVARPT(,COMPTR)                               0353 00389000
         LH    @02,SAVRC(,@02)                                     0353 00390000
         C     @02,@CF00586                                        0353 00391000
         BNL   @RF00353                                            0353 00392000
*                  ERRARGPT->DARGSENT = UVMSG01;           /*@Y30SSMK*/ 00393000
         L     @02,COMSWKPT(,COMPTR)                               0354 00394000
         L     @02,ERRARGPT(,@02)                                  0354 00395000
         MVI   DARGSENT(@02),X'01'                                 0354 00396000
*                ELSE                                              0355 00397000
*                  ERRARGPT->DARGSENT = UVMSG03;           /*@Y30SSMK*/ 00398000
         B     @RC00353                                            0355 00399000
@RF00353 L     @02,COMSWKPT(,COMPTR)                               0355 00400000
         L     @02,ERRARGPT(,@02)                                  0355 00401000
         MVI   DARGSENT(@02),X'03'                                 0355 00402000
*              ERRARGPT->DARGSMOD = UV0ID;                 /*@Y30SSMK*/ 00403000
@RC00353 L     @02,COMSWKPT(,COMPTR)                               0356 00404000
         L     @02,ERRARGPT(,@02)                                  0356 00405000
         MVC   DARGSMOD(3,@02),@CC01149                            0356 00406000
*              CALL ERRPROC;                               /*@Y30SSMK*/ 00407000
         L     @15,@CV00872                                        0357 00408000
         BALR  @14,@15                                             0357 00409000
*            END;                                                  0358 00410000
*        /************************************************************/ 00411000
*        /*                                                          */ 00412000
*        /* CLOSE THE USER'S OUTPUT DATASET, IF IT IS NOT THE        */ 00413000
*        /* DEFAULT AMS OUTPUT DATASET.                              */ 00414000
*        /* NOTE - THE OUTPUT FILE IS NOT CLOSE UNTIL NOW IN ORDER   */ 00415000
*        /* TO ACCOMMODATE ANY FINAL EOJ MESSAGES.                   */ 00416000
*        /*                                                          */ 00417000
*        /************************************************************/ 00418000
*                                                                  0359 00419000
*        IF ADDR(OUTDD) ^= NULLPTR  & OTIOCSPT ^= PRTFILE          0359 00420000
*          THEN                                                    0359 00421000
@RC00343 SLR   @02,@02                                             0359 00422000
         L     @15,@PC00001+4                                      0359 00423000
         C     @02,FDTPTR+4(,@15)                                  0359 00424000
         BE    @RF00359                                            0359 00425000
         L     @15,COMSWKPT(,COMPTR)                               0359 00426000
         C     @02,OTIOCSPT(,@15)                                  0359 00427000
         BE    @RF00359                                            0359 00428000
*            DO;                                                   0360 00429000
*                                                                  0360 00430000
*              CALL IDCIOCL0 (GDTTBL,                              0361 00431000
*                      OTIOCSPT);                                  0361 00432000
         L     @02,@PC00001                                        0361 00433000
         ST    @02,@AL00001                                        0361 00434000
         LA    @15,OTIOCSPT(,@15)                                  0361 00435000
         ST    @15,@AL00001+4                                      0361 00436000
         MVI   @AL00001+4,X'80'                                    0361 00437000
         L     @15,GDTCLS(,@02)                                    0361 00438000
         LA    @01,@AL00001                                        0361 00439000
         BALR  @14,@15                                             0361 00440000
*              SAVRC = MAX(SAVRC, TESTRC);                 /*@ZA05939*/ 00441000
         L     @02,COMVARPT(,COMPTR)                               0362 00442000
         LH    @15,SAVRC(,@02)                                     0362 00443000
         CR    @15,TESTRC                                          0362 00444000
         BNL   *+6                                                      00445000
         LR    @15,TESTRC                                          0362 00446000
         STH   @15,SAVRC(,@02)                                     0362 00447000
*            END;                                                  0363 00448000
*                                                                  0363 00449000
*        /************************************************************/ 00450000
*        /*                                                          */ 00451000
*        /* DUMP FULL AMS REGION                                     */ 00452000
*        /*                                                          */ 00453000
*        /************************************************************/ 00454000
*                                                                  0364 00455000
*        IF GDTDBG = NULLPTR                                       0364 00456000
*          THEN;                                                   0364 00457000
@RF00359 L     @04,@PC00001                                        0364 00458000
         L     @04,GDTDBG(,@04)                                    0364 00459000
         LTR   @04,@04                                             0364 00460000
         BZ    @RT00364                                            0364 00461000
*          ELSE                                                    0366 00462000
*            CALL IDCDB010 (GDTTBL,'LC99');                        0366 00463000
*                                                                  0366 00464000
         L     @04,@PC00001                                        0366 00465000
         ST    @04,@AL00001                                        0366 00466000
         LA    @02,@CC01360                                        0366 00467000
         ST    @02,@AL00001+4                                      0366 00468000
         MVI   @AL00001+4,X'80'                                    0366 00469000
         L     @15,GDTDBG(,@04)                                    0366 00470000
         LA    @01,@AL00001                                        0366 00471000
         BALR  @14,@15                                             0366 00472000
*        /************************************************************/ 00473000
*        /*                                                          */ 00474000
*        /* FREE ALL STORAGE AREAS OBTAINED BY LISTCATALOG AND       */ 00475000
*        /* SET THE FINAL CONDITION CODE.                    @ZA05939*/ 00476000
*        /*                                                          */ 00477000
*        /************************************************************/ 00478000
*                                                                  0367 00479000
*        CALL IDCSAFP0 (GDTTBL,                                    0367 00480000
*                'LC00',                                           0367 00481000
*                ALL);                                             0367 00482000
*                                                                  0367 00483000
@RT00364 MVC   @AL00001+4(8),@AL00367                              0367 00484000
         L     @04,@PC00001                                        0367 00485000
         ST    @04,@AL00001                                        0367 00486000
         L     @15,GDTFPL(,@04)                                    0367 00487000
         LA    @01,@AL00001                                        0367 00488000
         BALR  @14,@15                                             0367 00489000
*        LASTCC = SAVRC;                                   /*@ZA05939*/ 00490000
*                                                                  0368 00491000
         L     @04,@PC00001+8                                      0368 00492000
         L     @02,COMVARPT(,COMPTR)                               0368 00493000
         LH    @02,SAVRC(,@02)                                     0368 00494000
         STH   @02,LASTCC(,@04)                                    0368 00495000
*        /************************************************************/ 00496000
*        /*                                                  @ZA05939*/ 00497000
*        /* INVOKE FREESTG TO FREE THE AUTOMATIC STORAGE     @ZA05939*/ 00498000
*        /* FOR IDCLC02.  CONTROL IS RETURNED.               @ZA05939*/ 00499000
*        /*                                                  @ZA05939*/ 00500000
*        /************************************************************/ 00501000
*                                                                  0369 00502000
*        CALL FREESTG;                                     /*@ZA05939*/ 00503000
*                                                                  0369 00504000
         L     @15,@CV00880                                        0369 00505000
         BALR  @14,@15                                             0369 00506000
*        /************************************************************/ 00507000
*        /*                                                  @ZA05939*/ 00508000
*        /* PROCESSING IS COMPLETE, EXIT FROM LISTCATALOG    @ZA05939*/ 00509000
*        /* RETURNING TO THE EXECUTIVE MODULE.               @ZA05939*/ 00510000
*        /*                                                  @ZA05939*/ 00511000
*        /************************************************************/ 00512000
*                                                                  0370 00513000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0370 00514000
         L     @04,@PC00001                                        0370 00515000
         ST    @04,@AL00001                                        0370 00516000
         LA    @15,MODID                                           0370 00517000
         ST    @15,@AL00001+4                                      0370 00518000
         L     @15,@PC00001+8                                      0370 00519000
         ST    @15,@AL00001+8                                      0370 00520000
         MVI   @AL00001+8,X'80'                                    0370 00521000
         L     @15,GDTEPL(,@04)                                    0370 00522000
         LA    @01,@AL00001                                        0370 00523000
         BALR  @14,@15                                             0370 00524000
*                                                                  0371 00525000
*        /************************************************************/ 00526000
*        /*                                                          */ 00527000
*        /* PROCEDURE NAME - INITPROC                                */ 00528000
*        /*                                                          */ 00529000
*        /* FUNCTION - INTERROGATION OF AMS LISTC COMMAND STATEMENT  */ 00530000
*        /*            AND INITIALIZATION OF CAT/DADSM PARAMETER     */ 00531000
*        /*            LISTS AND WORKAREAS.                          */ 00532000
*        /*                                                          */ 00533000
*        /* INPUT - LISTC COMMAND STATEMENT DATA                     */ 00534000
*        /*                                                          */ 00535000
*        /* OUTPUT - INITIALIZED CPLS AND FPLS, FORMATTED CATALOG    */ 00536000
*        /*          WORKAREAS, AND RETRIEVED STATIC TEXT FOR LISTC  */ 00537000
*        /*          OUTPUT.                                         */ 00538000
*        /*                                                          */ 00539000
*        /************************************************************/ 00540000
*                                                                  0371 00541000
*INITPROC:                                                         0371 00542000
*        PROCEDURE;                                                0371 00543000
*                                                                  0371 00544000
@EL00001 L     @13,4(,@13)                                         0371 00545000
@EF00001 L     @00,@SIZDATD                                        0371 00546000
         LR    @01,@08                                             0371 00547000
         FREEMAIN R,LV=(0),A=(1)                                        00548000
@ER00001 LM    @14,@12,12(@13)                                     0371 00549000
         BR    @14                                                 0371 00550000
INITPROC STM   @14,@12,@SA00002                                    0371 00551000
*        /************************************************************/ 00552000
*        /*                                                          */ 00553000
*        /* LOCAL VARIABLES                                          */ 00554000
*        /*                                                          */ 00555000
*        /************************************************************/ 00556000
*                                                                  0372 00557000
*        DCL DICTSZ    FIXED(31) INIT(1400);                       0372 00558000
*                                      /*CAT WKA SIZE FOR GETPOOL    */ 00559000
*        DCL GPDDSZ    FIXED(31) INIT(256);                        0373 00560000
*                                      /*AMS TP PARM LEN FOR GETPOOL */ 00561000
*        DCL SAPTR     PTR(31);        /*TEMP PTR FOR SAVEAREA FPL'S */ 00562000
*        DCL SAVFPL    CHAR(*) BASED;  /*OVERLAY OF AN FPL           */ 00563000
*        DCL IDX       FIXED(15);      /*INDEX VAR TO INIT THE FPL'S */ 00564000
*        DCL BYPASMUL  FIXED(15) CONSTANT(2);              /*@Y30SSMK*/ 00565000
*                                      /*COUNT TO BYPASS MULTITYP FPL*/ 00566000
*        DCL FPLPTLEN  FIXED(15) CONSTANT(8);              /*@Y30SSMK*/ 00567000
*                                      /*LEN FOR FPL PTR AND LEN     */ 00568000
*        DCL MULPTLEN  FIXED(15) CONSTANT(32);             /*@Y30SSMK*/ 00569000
*                                      /*LEN FOR MULT FPL PTR & LEN  */ 00570000
*        DCL STORCNT2  FIXED(15) CONSTANT(2);              /*@Y30SSMK*/ 00571000
*                                      /*STOR CNT FOR 2 STORAGE AREAS*/ 00572000
*        DCL STORCNT3  FIXED(15) CONSTANT(3);              /*@Y30SSMK*/ 00573000
*                                      /*STOR CNT FOR 3 STORAGE AREAS*/ 00574000
*        DCL WKLENFLD  FIXED(15) CONSTANT(4);              /*@Y30SSMK*/ 00575000
*                                      /*LEN FOR WORKAREA LEN FIELDS */ 00576000
*        DCL MULFLDNO  FIXED(15) CONSTANT(4);              /*@Y30SSMK*/ 00577000
*                                      /*NO. OF PTR AND LEN FIELDS   */ 00578000
*        DCL LC#PTLEN  FIXED(15) CONSTANT(12);             /*@Y30SSMK*/ 00579000
*                                      /*LEN FOR CPL PTR & LEN FIELDS*/ 00580000
*        DCL ENTCILEN  FIXED(15) CONSTANT(16);             /*@Y30SSMK*/ 00581000
*                                      /*LEN FOR CI & TYPE IN WKAREA */ 00582000
*        DCL ASSOCLEN  FIXED(15) CONSTANT(100);            /*@Y30SSMK*/ 00583000
*                                      /*LEN OF 25 ASSOC CI & TYPES  */ 00584000
*        /************************************************************/ 00585000
*        /*                                                          */ 00586000
*        /* SETUP THE OPEN ARGUMENT LIST FOR THE USER SPECIFIED      */ 00587000
*        /* OUTPUT DATASET.  IF NOT SPECIFIED, THEN THE STANDARD AMS */ 00588000
*        /* LISTING-OUTPUT DATA SET IS USED.                         */ 00589000
*        /* NOTE - THE OUTPUT FILE IS PROCESSED IMMEDIATELY TO       */ 00590000
*        /* ALLOW FOR ANY DIAGNOSTICS OUTPUT BY THE SUBSEQUENT       */ 00591000
*        /* LISTCAT PROCESSING.                                      */ 00592000
*        /*                                                          */ 00593000
*        /************************************************************/ 00594000
*                                                                  0387 00595000
*        OLDERID2 = NEWERID2;                                      0387 00596000
         L     @04,@PC00001                                        0387 00597000
         L     @02,GDTTR2(,@04)                                    0387 00598000
         MVC   @TS00001(95),NEWERID2(@02)                          0387 00599000
         MVC   OLDERID2(95,@02),@TS00001                           0387 00600000
*        NEWID2 = 'LCIN';                                          0388 00601000
*                                                                  0388 00602000
         MVC   NEWID2(4,@02),@CC01380                              0388 00603000
*        IF ADDR(OUTDD) ^= NULLPTR                                 0389 00604000
*          THEN                                                    0389 00605000
         L     @02,@PC00001+4                                      0389 00606000
         L     @02,FDTPTR+4(,@02)                                  0389 00607000
         LTR   @02,@02                                             0389 00608000
         BZ    @RF00389                                            0389 00609000
*            DO;                                                   0390 00610000
         ST    @02,@TF00001                                        0390 00611000
*              OTARGLST = ZEROAREA;                                0391 00612000
         MVC   OTARGLST(48),ZEROAREA                               0391 00613000
*              OPNPTR = ADDR(OTARGLST);                            0392 00614000
         LA    OPNPTR,OTARGLST                                     0392 00615000
*              OPNOPTOT = ON;                                      0393 00616000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0393 00617000
*              OPNMODAC = ON;                                      0394 00618000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0394 00619000
*              OPNIOC = ADDR(OTIOCSPT);                            0395 00620000
         L     @01,COMSWKPT(,COMPTR)                               0395 00621000
         LA    @15,OTIOCSPT(,@01)                                  0395 00622000
         ST    @15,OPNIOC(,OPNPTR)                                 0395 00623000
*              OPNDDN = ADDR(OUTDDVAL);                            0396 00624000
*                                                                  0396 00625000
         L     @01,@TF00001                                        0396 00626000
         LA    @15,OUTDDVAL(,@01)                                  0396 00627000
         ST    @15,OPNDDN(,OPNPTR)                                 0396 00628000
*              CALL IDCIOOP0 (GDTTBL,                              0397 00629000
*                     OTARGLST);                                   0397 00630000
         L     @02,@PC00001                                        0397 00631000
         ST    @02,@AL00001                                        0397 00632000
         LA    @15,OTARGLST                                        0397 00633000
         ST    @15,@AL00001+4                                      0397 00634000
         MVI   @AL00001+4,X'80'                                    0397 00635000
         L     @15,GDTOPN(,@02)                                    0397 00636000
         LA    @01,@AL00001                                        0397 00637000
         BALR  @14,@15                                             0397 00638000
*              RESPECIFY RTNREG RSTD;                              0398 00639000
*              TESTRC = RTNREG;                                    0399 00640000
         LR    TESTRC,RTNREG                                       0399 00641000
*              RESPECIFY RTNREG UNRSTD;                            0400 00642000
*              IF TESTRC ^= 0                                      0401 00643000
*                THEN                                              0401 00644000
*                                                                  0401 00645000
         SLR   @02,@02                                             0401 00646000
         CR    TESTRC,@02                                          0401 00647000
         BE    @RF00401                                            0401 00648000
*                  /**************************************************/ 00649000
*                  /*                                                */ 00650000
*                  /* ERROR OPENING USER'S OUTPUT FILE.  USE THE     */ 00651000
*                  /* DEFAULT AMS PRINT FILE FOR THE EOJ MESSAGES.   */ 00652000
*                  /*                                                */ 00653000
*                  /**************************************************/ 00654000
*                                                                  0402 00655000
*                  DO;                                             0402 00656000
*                    OTIOCSPT = PRTFILE;                           0403 00657000
         L     @04,COMSWKPT(,COMPTR)                               0403 00658000
         ST    @02,OTIOCSPT(,@04)                                  0403 00659000
*                    NOMSGFLG = ON;                                0404 00660000
         L     @04,COMFLGPT(,COMPTR)                               0404 00661000
         OI    NOMSGFLG(@04),B'10000000'                           0404 00662000
*                    RETURN CODE (LASTCC12);                       0405 00663000
         LA    @15,12                                              0405 00664000
         L     @14,@SA00002                                        0405 00665000
         LM    @00,@12,@SA00002+8                                  0405 00666000
         BR    @14                                                 0405 00667000
*                  END;                                            0406 00668000
*            END;                                                  0407 00669000
*          ELSE                                                    0408 00670000
*            OTIOCSPT = PRTFILE;       /*USE AMS PRINT O/P FILE      */ 00671000
         B     @RC00389                                            0408 00672000
@RF00389 L     @04,COMSWKPT(,COMPTR)                               0408 00673000
         SLR   @02,@02                                             0408 00674000
         ST    @02,OTIOCSPT(,@04)                                  0408 00675000
*                                                                  0409 00676000
*        /************************************************************/ 00677000
*        /*                                                          */ 00678000
*        /* COMPUTE CPL SIZE TO INCLUDE ADDRESSES OF ALL POSSIBLE    */ 00679000
*        /* FPLS.                                                    */ 00680000
*        /*                                                          */ 00681000
*        /************************************************************/ 00682000
*                                                                  0409 00683000
*        GPID = GPID00;                                            0409 00684000
@RC00389 MVC   GPID(4),@CC01245                                    0409 00685000
*        LCCPLLEN = LENGTH(CTGPL) + (4 * DIM(NMPTRS));             0410 00686000
*                                                                  0410 00687000
         L     @02,COMSWKPT(,COMPTR)                               0410 00688000
         LA    @15,164                                             0410 00689000
         STC   @15,LCCPLLEN(,@02)                                  0410 00690000
*        /************************************************************/ 00691000
*        /*                                                          */ 00692000
*        /* GET SPACE FOR THIS MAIN CPL WHICH WILL BE SETUP FOR      */ 00693000
*        /* LOCATE REQUESTS BY TYPE, ENTRY, OR C.I. NUMBER, I.E.,    */ 00694000
*        /* ALL GENERAL LISTINGS.                                    */ 00695000
*        /* SINCE THE CPL IS NOT A READ-ONLY PARM LIST, GET          */ 00696000
*        /* ADDITIONAL STORAGE FOR A SAVE AREA COPY OF THE           */ 00697000
*        /* INITIALIZED VERSION.                                     */ 00698000
*        /* A SECOND SAVEAREA IS ALSO NEEDED SHOULD THE CATALOG      */ 00699000
*        /* LOCATE REQUEST BE ISSUED TWICE WHEN A LARGER WORKAREA    */ 00700000
*        /* IS REQUIRED.                                             */ 00701000
*        /* A THIRD SAVEAREA IS ALSO NEEDED SHOULD A CATALOG ERROR   */ 00702000
*        /* OCCUR SINCE THE CALL TO UERROR REQUIRES THE CPL  @Y30SSMK*/ 00703000
*        /* INITIALIZED WITH THE VSAM ERROR REASON CODE.     @Y30SSMK*/ 00704000
*        /*                                                          */ 00705000
*        /************************************************************/ 00706000
*                                                                  0411 00707000
*        GPLEN = 4 * LCCPLLEN;                             /*@Y30SSMK*/ 00708000
*                                                                  0411 00709000
         SLA   @15,2                                               0411 00710000
         ST    @15,GPLEN                                           0411 00711000
*        CALL IDCSAGP0 (GDTTBL,                                    0412 00712000
*                GPLEN,                                            0412 00713000
*                CTGPLPTR,                                         0412 00714000
*                GPID,                                             0412 00715000
*                SETZERO);                                         0412 00716000
         L     @15,@PC00001                                        0412 00717000
         ST    @15,@AL00001                                        0412 00718000
         LA    @14,GPLEN                                           0412 00719000
         ST    @14,@AL00001+4                                      0412 00720000
         LA    @02,CTGPLPTR(,@02)                                  0412 00721000
         ST    @02,@AL00001+8                                      0412 00722000
         LA    @02,GPID                                            0412 00723000
         ST    @02,@AL00001+12                                     0412 00724000
         LA    @02,SETZERO                                         0412 00725000
         ST    @02,@AL00001+16                                     0412 00726000
         MVI   @AL00001+16,X'80'                                   0412 00727000
         L     @15,GDTGPL(,@15)                                    0412 00728000
         LA    @01,@AL00001                                        0412 00729000
         BALR  @14,@15                                             0412 00730000
*        RESPECIFY RTNREG RSTD;                                    0413 00731000
*        TESTRC = RTNREG;                                          0414 00732000
         LR    TESTRC,RTNREG                                       0414 00733000
*        RESPECIFY RTNREG UNRSTD;                                  0415 00734000
*                                                                  0415 00735000
*        /************************************************************/ 00736000
*        /*                                                  @Y30SSMK*/ 00737000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 00738000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 00739000
*        /*                                                  @Y30SSMK*/ 00740000
*        /************************************************************/ 00741000
*                                                                  0416 00742000
*        IF TESTRC ^= 0                                            0416 00743000
*          THEN                                                    0416 00744000
         LTR   TESTRC,TESTRC                                       0416 00745000
         BZ    @RF00416                                            0416 00746000
*            DO;                                                   0417 00747000
*              ERRARGPT->DARGSMOD = UV0ID;                         0418 00748000
         L     @04,COMSWKPT(,COMPTR)                               0418 00749000
         L     @04,ERRARGPT(,@04)                                  0418 00750000
         MVC   DARGSMOD(3,@04),@CC01149                            0418 00751000
*              ERRARGPT->DARGSENT = UVMSG04;                       0419 00752000
         MVI   DARGSENT(@04),X'04'                                 0419 00753000
*              RETURN CODE (LASTCC12);                             0420 00754000
         LA    @15,12                                              0420 00755000
         L     @14,@SA00002                                        0420 00756000
         LM    @00,@12,@SA00002+8                                  0420 00757000
         BR    @14                                                 0420 00758000
*            END;                                                  0421 00759000
*                                                                  0421 00760000
*        /************************************************************/ 00761000
*        /*                                                          */ 00762000
*        /* SAVE POINTERS TO THE MAIN CPL AND ITS SAVEAREA COPIES.   */ 00763000
*        /* THEN INITIALIZE THE MAIN CPL.                            */ 00764000
*        /*                                                          */ 00765000
*        /************************************************************/ 00766000
*                                                                  0422 00767000
*        TYPCPLPT = CTGPLPTR;                                      0422 00768000
@RF00416 L     @04,COMSWKPT(,COMPTR)                               0422 00769000
         L     @02,CTGPLPTR(,@04)                                  0422 00770000
         ST    @02,TYPCPLPT(,@04)                                  0422 00771000
*        SAVCPLPT = CTGPLPTR + LCCPLLEN;                           0423 00772000
         SLR   @15,@15                                             0423 00773000
         IC    @15,LCCPLLEN(,@04)                                  0423 00774000
         LR    @14,@02                                             0423 00775000
         ALR   @14,@15                                             0423 00776000
         ST    @14,SAVCPLPT(,@04)                                  0423 00777000
*        OLDCPLPT = SAVCPLPT + LCCPLLEN;                           0424 00778000
         ALR   @14,@15                                             0424 00779000
         ST    @14,OLDCPLPT(,@04)                                  0424 00780000
*        ERMCPLPT = OLDCPLPT + LCCPLLEN;                   /*@Y30SSMK*/ 00781000
         ALR   @14,@15                                             0425 00782000
         ST    @14,ERMCPLPT(,@04)                                  0425 00783000
*        CTGAM0 = ON;                  /*AM/0 REQUEST                */ 00784000
         OI    CTGAM0(@02),B'00000001'                             0426 00785000
*        CTGFUNC = CTGCMS;             /*CAT MGMT SERVICES REQUEST   */ 00786000
         NI    CTGFUNC(@02),B'10011111'                            0427 00787000
         OI    CTGFUNC(@02),B'10000000'                            0427 00788000
*        CTGOPTNS = CTGLTCAT;          /*AMS LISTCATALOG REQUEST     */ 00789000
         NI    CTGOPTNS(@02),B'00100111'                           0428 00790000
         OI    CTGOPTNS(@02),B'00100000'                           0428 00791000
*        /************************************************************/ 00792000
*        /*                                                          */ 00793000
*        /*   IF THE CATALOG IS NOT SPECIFIED, BLANK THE CATALOG NAME*/ 00794000
*        /*   SAVEAREA AND SETUP THE REQUEST TO CAT/DADSM TO RETRIEVE*/ 00795000
*        /*   CATNAME.                                               */ 00796000
*        /*                                                          */ 00797000
*        /************************************************************/ 00798000
*                                                                  0429 00799000
*        IF ADDR(CAT) = NULLPTR                                    0429 00800000
*          THEN                                                    0429 00801000
         L     @04,@PC00001+4                                      0429 00802000
         L     @04,FDTPTR(,@04)                                    0429 00803000
         LTR   @04,@04                                             0429 00804000
         BNZ   @RF00429                                            0429 00805000
*            DO;                                                   0430 00806000
*              CTGCNAME = ON;                                      0431 00807000
         OI    CTGCNAME(@02),B'00000010'                           0431 00808000
*              CATNAME = BLANK;                                    0432 00809000
         L     @04,COMVARPT(,COMPTR)                               0432 00810000
         MVI   CATNAME+1(@04),C' '                                 0432 00811000
         MVC   CATNAME+2(42,@04),CATNAME+1(@04)                    0432 00812000
         MVI   CATNAME(@04),C' '                                   0432 00813000
*              CTGCAT = ADDR(CATNAME);                             0433 00814000
         LA    @04,CATNAME(,@04)                                   0433 00815000
         ST    @04,CTGCAT(,@02)                                    0433 00816000
*              CACBFLG = ON;           /*LISTC NEEDS CAT ACB PTR     */ 00817000
         L     @04,COMFLGPT(,COMPTR)                               0434 00818000
         OI    CACBFLG(@04),B'10000000'                            0434 00819000
*            END;                                                  0435 00820000
*                                                                  0435 00821000
*        /************************************************************/ 00822000
*        /*                                                          */ 00823000
*        /*IF THE CATALOG TO BE LISTED IS SPECIFIED WITH ITS CORRE-  */ 00824000
*        /*SPONDING OPTIONAL PASSWORD, SET THE CATALOG NAME IN THE   */ 00825000
*        /*CPL.                                              @Y30SSMK*/ 00826000
*        /*                                                          */ 00827000
*        /************************************************************/ 00828000
*                                                                  0436 00829000
*          ELSE                                                    0436 00830000
*CMDCATNM:   DO;                                                   0436 00831000
         B     @RC00429                                            0436 00832000
@RF00429 DS    0H                                                  0436 00833000
CMDCATNM DS    0H                                                  0437 00834000
*              CATNAME = CATNMVAL;                         /*@YL026UE*/ 00835000
         L     @04,COMVARPT(,COMPTR)                               0437 00836000
         L     @02,@PC00001+4                                      0437 00837000
         L     @02,FDTPTR+40(,@02)                                 0437 00838000
         MVC   CATNAME(44,@04),CATNMVAL(@02)                       0437 00839000
*              IF CATNMPLN > 0                                     0438 00840000
*                THEN                                              0438 00841000
         CLI   CATNMPLN(@02),0                                     0438 00842000
         BNH   @RF00438                                            0438 00843000
*                  CTGPSWD = ADDR(CATNMPAS);                       0439 00844000
         L     @04,COMSWKPT(,COMPTR)                               0439 00845000
         L     @04,CTGPLPTR(,@04)                                  0439 00846000
         LA    @02,CATNMPAS(,@02)                                  0439 00847000
         ST    @02,CTGPSWD(,@04)                                   0439 00848000
*              CTGCNAME = ON;                              /*@Y30SSMK*/ 00849000
@RF00438 L     @04,COMSWKPT(,COMPTR)                               0440 00850000
         L     @04,CTGPLPTR(,@04)                                  0440 00851000
         OI    CTGCNAME(@04),B'00000010'                           0440 00852000
*              CTGCAT = ADDR(CATNAME);                     /*@Y30SSMK*/ 00853000
         L     @02,COMVARPT(,COMPTR)                               0441 00854000
         LA    @02,CATNAME(,@02)                                   0441 00855000
         ST    @02,CTGCAT(,@04)                                    0441 00856000
*              CACBFLG = ON;           /*LISTC NEEDS CAT ACB PTR     */ 00857000
         L     @04,COMFLGPT(,COMPTR)                               0442 00858000
         OI    CACBFLG(@04),B'10000000'                            0442 00859000
*            END CMDCATNM;                                         0443 00860000
*        /************************************************************/ 00861000
*        /*                                                          */ 00862000
*        /* DETERMINE WHICH SUBSET LISTING IS TO BE PRODUCED AND     */ 00863000
*        /* CALCULATE THE NUMBER OF FPLS REQUIRED FOR THAT SUBSET.   */ 00864000
*        /* NOTE - 'NAME' OR 'HISTORY' OR 'ALL' SUBSET       @Y30LSMK*/ 00865000
*        /*        APPLIES TO ALL CATALOG TYPES.             @Y30LSMK*/ 00866000
*        /*        'VOL' SUBSET APPLIES TO ALL TYPES, HOWEVER,       */ 00867000
*        /*        CLUSTER,AIX OR PATH MAY ONLY BE           @Y30SSMK*/ 00868000
*        /*        SPECIFIED WITH TYPES DATA AND INDEX.      @Y30SSMK*/ 00869000
*        /*        'ALLOC' SUBSET APPLIES ONLY TO TYPES DATA OR      */ 00870000
*        /*        INDEX, HOWEVER, CLUSTER,AIX OR PATH       @Y30SSMK*/ 00871000
*        /*        MAY ONLY BE SPECIFIED IN CONJUNCTION      @Y30SSMK*/ 00872000
*        /*        WITH TYPES DATA AND INDEX.                @Y30SSMK*/ 00873000
*        /*                                                          */ 00874000
*        /************************************************************/ 00875000
*                                                                  0444 00876000
*        IF ADDR(VOL) > NULLPTR                                    0444 00877000
*          THEN                        /*VOL SERIAL# & DEVICE SUBSET */ 00878000
@RC00429 L     @04,@PC00001+4                                      0444 00879000
         L     @04,FDTPTR+60(,@04)                                 0444 00880000
         LTR   @04,@04                                             0444 00881000
         BNP   @RF00444                                            0444 00882000
*            FPLCNT = DIM(VOLFLDS);                                0445 00883000
         L     @04,COMVARPT(,COMPTR)                               0445 00884000
         MVC   FPLCNT(2,@04),@CH00600                              0445 00885000
*          ELSE                                                    0446 00886000
*            IF ADDR(ALLOC) > NULLPTR                              0446 00887000
*              THEN                    /*D/I VOL ALLOCATION SUBSET   */ 00888000
         B     @RC00444                                            0446 00889000
@RF00444 L     @04,@PC00001+4                                      0446 00890000
         L     @04,FDTPTR+64(,@04)                                 0446 00891000
         LTR   @04,@04                                             0446 00892000
         BNP   @RF00446                                            0446 00893000
*                FPLCNT = DIM(SPACFLDS);                           0447 00894000
         L     @04,COMVARPT(,COMPTR)                               0447 00895000
         MVC   FPLCNT(2,@04),@CH00490                              0447 00896000
*              ELSE                                                0448 00897000
*                IF ADDR(FALL) > NULLPTR                           0448 00898000
*                  THEN               /*ALL DATA SUBSET LISTING     */  00899000
         B     @RC00446                                            0448 00900000
@RF00446 L     @04,@PC00001+4                                      0448 00901000
         L     @04,FDTPTR+56(,@04)                                 0448 00902000
         LTR   @04,@04                                             0448 00903000
         BNP   @RF00448                                            0448 00904000
*                    FPLCNT = DIM(ALLFLDS);                        0449 00905000
         L     @04,COMVARPT(,COMPTR)                               0449 00906000
         MVC   FPLCNT(2,@04),@CH01139                              0449 00907000
*                  ELSE                /*NAMES ONLY SUBSET LISTING   */ 00908000
*                    IF ADDR(HIST) > NULLPTR                       0450 00909000
*                      THEN            /*HISTORY DATA SUBSET LISTING */ 00910000
         B     @RC00448                                            0450 00911000
@RF00448 L     @04,@PC00001+4                                      0450 00912000
         L     @04,FDTPTR+104(,@04)                                0450 00913000
         LTR   @04,@04                                             0450 00914000
         BNP   @RF00450                                            0450 00915000
*                        FPLCNT = DIM(HISTFLDS);           /*@Y30LSMK*/ 00916000
         L     @04,COMVARPT(,COMPTR)                               0451 00917000
         MVC   FPLCNT(2,@04),@CH00646                              0451 00918000
*                      ELSE            /*NAMES ONLY SUBSET LISTING   */ 00919000
*                        FPLCNT = DIM(NMFLDS);             /*@Y30LSMK*/ 00920000
         B     @RC00450                                            0452 00921000
@RF00450 L     @04,COMVARPT(,COMPTR)                               0452 00922000
         MVC   FPLCNT(2,@04),@CH00293                              0452 00923000
*        /************************************************************/ 00924000
*        /*                                                          */ 00925000
*        /* BUILD STRING OF TYPE CODES IN ORDER TO GENERATE LISTING  */ 00926000
*        /* FOR ALL CATALOG TYPES OR A SPECIFIED SUBSET OF MULTIPLE  */ 00927000
*        /* TYPES.  THE SPECIAL FPL - MULTITYP WILL POINT TO A       */ 00928000
*        /* 2-BYTE COUNT OF THE TYPE CODES PLUS THIS STRING.         */ 00929000
*        /*                                                          */ 00930000
*        /************************************************************/ 00931000
*                                                                  0453 00932000
*        TYPECNT = 0;                                              0453 00933000
@RC00450 DS    0H                                                  0453 00934000
@RC00448 DS    0H                                                  0453 00935000
@RC00446 DS    0H                                                  0453 00936000
@RC00444 SLR   @04,@04                                             0453 00937000
         L     @02,COMVARPT(,COMPTR)                               0453 00938000
         STH   @04,TYPECNT(,@02)                                   0453 00939000
*        CMDERRSW = OFF;                                           0454 00940000
         L     @15,COMFLGPT(,COMPTR)                               0454 00941000
         NI    CMDERRSW(@15),B'01111111'                           0454 00942000
*        IF ADDR(DATUM) ^= NULLPTR                                 0455 00943000
*          THEN                                                    0455 00944000
         L     @14,@PC00001+4                                      0455 00945000
         C     @04,FDTPTR+20(,@14)                                 0455 00946000
         BE    @RF00455                                            0455 00947000
*            DO;                                                   0456 00948000
*              TYPECNT = TYPECNT + 1;                              0457 00949000
         AL    @04,@CF00045                                        0457 00950000
         STH   @04,TYPECNT(,@02)                                   0457 00951000
*              TYPELIST(TYPECNT) = CTGTDATA;                       0458 00952000
         ALR   @02,@04                                             0458 00953000
         MVI   TYPELIST-1(@02),C'D'                                0458 00954000
*              DTYPFLG = ON;                               /*@YL026UE*/ 00955000
         OI    DTYPFLG(@15),B'10000000'                            0459 00956000
*            END;                                                  0460 00957000
*        IF ADDR(INDEX) ^= NULLPTR                                 0461 00958000
*          THEN                                                    0461 00959000
@RF00455 L     @04,@PC00001+4                                      0461 00960000
         L     @04,FDTPTR+24(,@04)                                 0461 00961000
         LTR   @04,@04                                             0461 00962000
         BZ    @RF00461                                            0461 00963000
*            DO;                                                   0462 00964000
*              TYPECNT = TYPECNT + 1;                              0463 00965000
         L     @04,COMVARPT(,COMPTR)                               0463 00966000
         LA    @02,1                                               0463 00967000
         AH    @02,TYPECNT(,@04)                                   0463 00968000
         STH   @02,TYPECNT(,@04)                                   0463 00969000
*              TYPELIST(TYPECNT) = CTGTINDX;                       0464 00970000
         ALR   @04,@02                                             0464 00971000
         MVI   TYPELIST-1(@04),C'I'                                0464 00972000
*              ITYPFLG = ON;                               /*@YL026UE*/ 00973000
         L     @04,COMFLGPT(,COMPTR)                               0465 00974000
         OI    ITYPFLG(@04),B'10000000'                            0465 00975000
*            END;                                                  0466 00976000
*        IF ADDR(CLUST) ^= NULLPTR                                 0467 00977000
*          THEN                                                    0467 00978000
*                                                                  0467 00979000
@RF00461 SLR   @04,@04                                             0467 00980000
         L     @02,@PC00001+4                                      0467 00981000
         C     @04,FDTPTR+16(,@02)                                 0467 00982000
         BE    @RF00467                                            0467 00983000
*            /********************************************************/ 00984000
*            /*                                                      */ 00985000
*            /* BYPASS AND FLAG ANY CONFLICTING TYPE SPECIFICATION   */ 00986000
*            /* AS A USER ERROR.                                     */ 00987000
*            /*                                                      */ 00988000
*            /********************************************************/ 00989000
*                                                                  0468 00990000
*            IF (ADDR(ALLOC) > NULLPTR  |  ADDR(VOL) > NULLPTR)    0468 00991000
*              & ADDR(DATUM) = NULLPTR                             0468 00992000
*              & ADDR(INDEX) = NULLPTR                             0468 00993000
*              THEN                                                0468 00994000
         C     @04,FDTPTR+64(,@02)                                 0468 00995000
         BL    @GL00008                                            0468 00996000
         C     @04,FDTPTR+60(,@02)                                 0468 00997000
         BNL   @RF00468                                            0468 00998000
@GL00008 SLR   @04,@04                                             0468 00999000
         L     @02,@PC00001+4                                      0468 01000000
         C     @04,FDTPTR+20(,@02)                                 0468 01001000
         BNE   @RF00468                                            0468 01002000
         C     @04,FDTPTR+24(,@02)                                 0468 01003000
         BNE   @RF00468                                            0468 01004000
*                CMDERRSW = ON;                            /*@YL026UE*/ 01005000
         L     @04,COMFLGPT(,COMPTR)                               0469 01006000
         OI    CMDERRSW(@04),B'10000000'                           0469 01007000
*              ELSE                                                0470 01008000
*                DO;                                       /*@YL026UE*/ 01009000
         B     @RC00468                                            0470 01010000
@RF00468 DS    0H                                                  0471 01011000
*                  TYPECNT = TYPECNT + 1;                  /*@YL026UE*/ 01012000
         L     @04,COMVARPT(,COMPTR)                               0471 01013000
         LA    @02,1                                               0471 01014000
         AH    @02,TYPECNT(,@04)                                   0471 01015000
         STH   @02,TYPECNT(,@04)                                   0471 01016000
*                  TYPELIST(TYPECNT) = CTGTCL;             /*@YL026UE*/ 01017000
         ALR   @04,@02                                             0472 01018000
         MVI   TYPELIST-1(@04),C'C'                                0472 01019000
*                  CTYPFLG = ON;                           /*@Y30LSMK*/ 01020000
         L     @04,COMFLGPT(,COMPTR)                               0473 01021000
         OI    CTYPFLG(@04),B'10000000'                            0473 01022000
*                END;                                      /*@YL026UE*/ 01023000
*        IF ADDR(PGSPC) ^= NULLPTR                                 0475 01024000
*          THEN                                                    0475 01025000
@RC00468 DS    0H                                                  0475 01026000
@RF00467 SLR   @04,@04                                             0475 01027000
         L     @02,@PC00001+4                                      0475 01028000
         C     @04,FDTPTR+76(,@02)                                 0475 01029000
         BE    @RF00475                                            0475 01030000
*            DO;                                           /*@YL026UE*/ 01031000
*              IF (ADDR(ALLOC) > NULLPTR | ADDR(VOL) > NULLPTR)    0477 01032000
*                 & ADDR(DATUM) = NULLPTR                          0477 01033000
*                THEN                                              0477 01034000
         C     @04,FDTPTR+64(,@02)                                 0477 01035000
         BL    @GL00010                                            0477 01036000
         C     @04,FDTPTR+60(,@02)                                 0477 01037000
         BNL   @RF00477                                            0477 01038000
@GL00010 L     @04,@PC00001+4                                      0477 01039000
         L     @04,FDTPTR+20(,@04)                                 0477 01040000
         LTR   @04,@04                                             0477 01041000
         BNZ   @RF00477                                            0477 01042000
*                  CMDERRSW = ON;                          /*@YL026UE*/ 01043000
         L     @04,COMFLGPT(,COMPTR)                               0478 01044000
         OI    CMDERRSW(@04),B'10000000'                           0478 01045000
*                ELSE                                              0479 01046000
*                  DO;                                     /*@YL026UE*/ 01047000
         B     @RC00477                                            0479 01048000
@RF00477 DS    0H                                                  0480 01049000
*                    TYPECNT = TYPECNT + 1;                /*@YL026UE*/ 01050000
         L     @04,COMVARPT(,COMPTR)                               0480 01051000
         LA    @02,1                                               0480 01052000
         AH    @02,TYPECNT(,@04)                                   0480 01053000
         STH   @02,TYPECNT(,@04)                                   0480 01054000
*                    TYPELIST(TYPECNT) = CTGTPGSP;         /*@YL026UE*/ 01055000
         ALR   @04,@02                                             0481 01056000
         MVI   TYPELIST-1(@04),C'P'                                0481 01057000
*                    PTYPFLG = ON;                         /*@Y30LSMK*/ 01058000
         L     @04,COMFLGPT(,COMPTR)                               0482 01059000
         OI    PTYPFLG(@04),B'10000000'                            0482 01060000
*                  END;                                    /*@YL026UE*/ 01061000
*            END;                                          /*@YL026UE*/ 01062000
@RC00477 DS    0H                                                  0485 01063000
*        IF ADDR(AIX) ^= NULLPTR                                   0485 01064000
*          THEN                                                    0485 01065000
@RF00475 SLR   @04,@04                                             0485 01066000
         L     @02,@PC00001+4                                      0485 01067000
         C     @04,FDTPTR+84(,@02)                                 0485 01068000
         BE    @RF00485                                            0485 01069000
*            IF (ADDR(ALLOC) > NULLPTR  |  ADDR(VOL) > NULLPTR)    0486 01070000
*              & ADDR(DATUM) = NULLPTR                             0486 01071000
*              & ADDR(INDEX) = NULLPTR                             0486 01072000
*              THEN                                                0486 01073000
         C     @04,FDTPTR+64(,@02)                                 0486 01074000
         BL    @GL00013                                            0486 01075000
         C     @04,FDTPTR+60(,@02)                                 0486 01076000
         BNL   @RF00486                                            0486 01077000
@GL00013 SLR   @04,@04                                             0486 01078000
         L     @02,@PC00001+4                                      0486 01079000
         C     @04,FDTPTR+20(,@02)                                 0486 01080000
         BNE   @RF00486                                            0486 01081000
         C     @04,FDTPTR+24(,@02)                                 0486 01082000
         BNE   @RF00486                                            0486 01083000
*                CMDERRSW = ON;                            /*@Y30SSMK*/ 01084000
         L     @04,COMFLGPT(,COMPTR)                               0487 01085000
         OI    CMDERRSW(@04),B'10000000'                           0487 01086000
*              ELSE                                                0488 01087000
*                DO;                                       /*@Y30SSMK*/ 01088000
         B     @RC00486                                            0488 01089000
@RF00486 DS    0H                                                  0489 01090000
*                  TYPECNT = TYPECNT + 1;                  /*@Y30SSMK*/ 01091000
         L     @04,COMVARPT(,COMPTR)                               0489 01092000
         LA    @02,1                                               0489 01093000
         AH    @02,TYPECNT(,@04)                                   0489 01094000
         STH   @02,TYPECNT(,@04)                                   0489 01095000
*                  TYPELIST(TYPECNT) = CTGTAIX;            /*@Y30SSMK*/ 01096000
         ALR   @04,@02                                             0490 01097000
         MVI   TYPELIST-1(@04),C'G'                                0490 01098000
*                  GTYPFLG = ON;                           /*@Y30SSMK*/ 01099000
         L     @04,COMFLGPT(,COMPTR)                               0491 01100000
         OI    GTYPFLG(@04),B'10000000'                            0491 01101000
*                END;                                      /*@Y30SSMK*/ 01102000
*        IF ADDR(PATH) ^= NULLPTR                                  0493 01103000
*          THEN                                                    0493 01104000
@RC00486 DS    0H                                                  0493 01105000
@RF00485 SLR   @04,@04                                             0493 01106000
         L     @02,@PC00001+4                                      0493 01107000
         C     @04,FDTPTR+88(,@02)                                 0493 01108000
         BE    @RF00493                                            0493 01109000
*            IF (ADDR(ALLOC) > NULLPTR  |  ADDR(VOL) > NULLPTR)    0494 01110000
*              & ADDR(DATUM) = NULLPTR                             0494 01111000
*              & ADDR(INDEX) = NULLPTR                             0494 01112000
*              THEN                                                0494 01113000
         C     @04,FDTPTR+64(,@02)                                 0494 01114000
         BL    @GL00016                                            0494 01115000
         C     @04,FDTPTR+60(,@02)                                 0494 01116000
         BNL   @RF00494                                            0494 01117000
@GL00016 SLR   @04,@04                                             0494 01118000
         L     @02,@PC00001+4                                      0494 01119000
         C     @04,FDTPTR+20(,@02)                                 0494 01120000
         BNE   @RF00494                                            0494 01121000
         C     @04,FDTPTR+24(,@02)                                 0494 01122000
         BNE   @RF00494                                            0494 01123000
*                CMDERRSW = ON;                            /*@Y30SSMK*/ 01124000
         L     @04,COMFLGPT(,COMPTR)                               0495 01125000
         OI    CMDERRSW(@04),B'10000000'                           0495 01126000
*              ELSE                                                0496 01127000
*                DO;                                       /*@Y30SSMK*/ 01128000
         B     @RC00494                                            0496 01129000
@RF00494 DS    0H                                                  0497 01130000
*                  TYPECNT = TYPECNT + 1;                  /*@Y30SSMK*/ 01131000
         L     @04,COMVARPT(,COMPTR)                               0497 01132000
         LA    @02,1                                               0497 01133000
         AH    @02,TYPECNT(,@04)                                   0497 01134000
         STH   @02,TYPECNT(,@04)                                   0497 01135000
*                  TYPELIST(TYPECNT) = CTGTPTH;            /*@Y30SSMK*/ 01136000
         ALR   @04,@02                                             0498 01137000
         MVI   TYPELIST-1(@04),C'R'                                0498 01138000
*                  RTYPFLG = ON;                           /*@Y30SSMK*/ 01139000
         L     @04,COMFLGPT(,COMPTR)                               0499 01140000
         OI    RTYPFLG(@04),B'10000000'                            0499 01141000
*                END;                                      /*@Y30SSMK*/ 01142000
*        IF ADDR(SPACE) ^= NULLPTR                                 0501 01143000
*          THEN                                                    0501 01144000
@RC00494 DS    0H                                                  0501 01145000
@RF00493 SLR   @04,@04                                             0501 01146000
         L     @02,@PC00001+4                                      0501 01147000
         C     @04,FDTPTR+28(,@02)                                 0501 01148000
         BE    @RF00501                                            0501 01149000
*            IF ADDR(ALLOC) > NULLPTR                              0502 01150000
*              THEN                                                0502 01151000
         C     @04,FDTPTR+64(,@02)                                 0502 01152000
         BNL   @RF00502                                            0502 01153000
*                CMDERRSW = ON;                                    0503 01154000
         L     @04,COMFLGPT(,COMPTR)                               0503 01155000
         OI    CMDERRSW(@04),B'10000000'                           0503 01156000
*              ELSE                                                0504 01157000
*                DO;                                               0504 01158000
         B     @RC00502                                            0504 01159000
@RF00502 DS    0H                                                  0505 01160000
*                  TYPECNT = TYPECNT + 1;                          0505 01161000
         L     @04,COMVARPT(,COMPTR)                               0505 01162000
         LA    @02,1                                               0505 01163000
         AH    @02,TYPECNT(,@04)                                   0505 01164000
         STH   @02,TYPECNT(,@04)                                   0505 01165000
*                  TYPELIST(TYPECNT) = CTGTVOL;                    0506 01166000
         ALR   @04,@02                                             0506 01167000
         MVI   TYPELIST-1(@04),C'V'                                0506 01168000
*                  VTYPFLG = ON;                           /*@Y30LSMK*/ 01169000
         L     @04,COMFLGPT(,COMPTR)                               0507 01170000
         OI    VTYPFLG(@04),B'10000000'                            0507 01171000
*                END;                                              0508 01172000
*        IF ADDR(ALIEN) ^= NULLPTR                                 0509 01173000
*          THEN                                                    0509 01174000
@RC00502 DS    0H                                                  0509 01175000
@RF00501 SLR   @04,@04                                             0509 01176000
         L     @02,@PC00001+4                                      0509 01177000
         C     @04,FDTPTR+32(,@02)                                 0509 01178000
         BE    @RF00509                                            0509 01179000
*            IF ADDR(ALLOC) > NULLPTR                              0510 01180000
*              THEN                                                0510 01181000
         C     @04,FDTPTR+64(,@02)                                 0510 01182000
         BNL   @RF00510                                            0510 01183000
*                CMDERRSW = ON;                                    0511 01184000
         L     @04,COMFLGPT(,COMPTR)                               0511 01185000
         OI    CMDERRSW(@04),B'10000000'                           0511 01186000
*              ELSE                                                0512 01187000
*                DO;                                               0512 01188000
         B     @RC00510                                            0512 01189000
@RF00510 DS    0H                                                  0513 01190000
*                  TYPECNT = TYPECNT + 1;                          0513 01191000
         L     @04,COMVARPT(,COMPTR)                               0513 01192000
         LA    @02,1                                               0513 01193000
         AH    @02,TYPECNT(,@04)                                   0513 01194000
         STH   @02,TYPECNT(,@04)                                   0513 01195000
*                  TYPELIST(TYPECNT) = CTGTALIN;                   0514 01196000
         ALR   @04,@02                                             0514 01197000
         MVI   TYPELIST-1(@04),C'A'                                0514 01198000
*                  ATYPFLG = ON;                           /*@YL026UE*/ 01199000
         L     @04,COMFLGPT(,COMPTR)                               0515 01200000
         OI    ATYPFLG(@04),B'10000000'                            0515 01201000
*                END;                                              0516 01202000
*        IF ADDR(GDG) ^= NULLPTR                                   0517 01203000
*          THEN                                                    0517 01204000
@RC00510 DS    0H                                                  0517 01205000
@RF00509 SLR   @04,@04                                             0517 01206000
         L     @02,@PC00001+4                                      0517 01207000
         C     @04,FDTPTR+72(,@02)                                 0517 01208000
         BE    @RF00517                                            0517 01209000
*            DO;                                           /*@YL026UE*/ 01210000
*              IF (ADDR(VOL) > NULLPTR & ADDR(ALIEN) = NULLPTR)    0519 01211000
*                | ADDR(ALLOC) > NULLPTR                           0519 01212000
*                THEN                                              0519 01213000
         C     @04,FDTPTR+60(,@02)                                 0519 01214000
         BNL   @GL00018                                            0519 01215000
         C     @04,FDTPTR+32(,@02)                                 0519 01216000
         BE    @RT00519                                            0519 01217000
@GL00018 L     @04,@PC00001+4                                      0519 01218000
         L     @04,FDTPTR+64(,@04)                                 0519 01219000
         LTR   @04,@04                                             0519 01220000
         BNP   @RF00519                                            0519 01221000
@RT00519 DS    0H                                                  0520 01222000
*                  CMDERRSW = ON;                          /*@YL026UE*/ 01223000
         L     @04,COMFLGPT(,COMPTR)                               0520 01224000
         OI    CMDERRSW(@04),B'10000000'                           0520 01225000
*                ELSE                                              0521 01226000
*                  DO;                                     /*@YL026UE*/ 01227000
         B     @RC00519                                            0521 01228000
@RF00519 DS    0H                                                  0522 01229000
*                    TYPECNT = TYPECNT + 1;                /*@YL026UE*/ 01230000
         L     @04,COMVARPT(,COMPTR)                               0522 01231000
         LA    @02,1                                               0522 01232000
         AH    @02,TYPECNT(,@04)                                   0522 01233000
         STH   @02,TYPECNT(,@04)                                   0522 01234000
*                    TYPELIST(TYPECNT) = CTGTGBS;          /*@YL026UE*/ 01235000
         ALR   @04,@02                                             0523 01236000
         MVI   TYPELIST-1(@04),C'B'                                0523 01237000
*                    BTYPFLG = ON;                         /*@YL026UE*/ 01238000
         L     @04,COMFLGPT(,COMPTR)                               0524 01239000
         OI    BTYPFLG(@04),B'10000000'                            0524 01240000
*                  END;                                    /*@YL026UE*/ 01241000
*            END;                                          /*@YL026UE*/ 01242000
@RC00519 DS    0H                                                  0527 01243000
*        IF ADDR(ALIAS) ^= NULLPTR                                 0527 01244000
*          THEN                                                    0527 01245000
@RF00517 SLR   @04,@04                                             0527 01246000
         L     @02,@PC00001+4                                      0527 01247000
         C     @04,FDTPTR+68(,@02)                                 0527 01248000
         BE    @RF00527                                            0527 01249000
*            DO;                                           /*@YL026UE*/ 01250000
*              IF ADDR(ALLOC) > NULLPTR | ADDR(VOL) > NULLPTR      0529 01251000
*                THEN                                              0529 01252000
         C     @04,FDTPTR+64(,@02)                                 0529 01253000
         BL    @RT00529                                            0529 01254000
         C     @04,FDTPTR+60(,@02)                                 0529 01255000
         BNL   @RF00529                                            0529 01256000
@RT00529 DS    0H                                                  0530 01257000
*                  CMDERRSW = ON;                          /*@YL026UE*/ 01258000
         L     @04,COMFLGPT(,COMPTR)                               0530 01259000
         OI    CMDERRSW(@04),B'10000000'                           0530 01260000
*                ELSE                                              0531 01261000
*                  DO;                                     /*@YL026UE*/ 01262000
         B     @RC00529                                            0531 01263000
@RF00529 DS    0H                                                  0532 01264000
*                    TYPECNT = TYPECNT + 1;                /*@YL026UE*/ 01265000
         L     @04,COMVARPT(,COMPTR)                               0532 01266000
         LA    @02,1                                               0532 01267000
         AH    @02,TYPECNT(,@04)                                   0532 01268000
         STH   @02,TYPECNT(,@04)                                   0532 01269000
*                    TYPELIST(TYPECNT) = CTGTANM;          /*@YL026UE*/ 01270000
         ALR   @04,@02                                             0533 01271000
         MVI   TYPELIST-1(@04),C'X'                                0533 01272000
*                  END;                                    /*@YL026UE*/ 01273000
*            END;                                          /*@YL026UE*/ 01274000
@RC00529 DS    0H                                                  0536 01275000
*        IF ADDR(UCAT) ^= NULLPTR                                  0536 01276000
*          THEN                                                    0536 01277000
@RF00527 SLR   @04,@04                                             0536 01278000
         L     @02,@PC00001+4                                      0536 01279000
         C     @04,FDTPTR+36(,@02)                                 0536 01280000
         BE    @RF00536                                            0536 01281000
*            IF ADDR(ALLOC) > NULLPTR                              0537 01282000
*              THEN                                                0537 01283000
         C     @04,FDTPTR+64(,@02)                                 0537 01284000
         BNL   @RF00537                                            0537 01285000
*                CMDERRSW = ON;                                    0538 01286000
         L     @04,COMFLGPT(,COMPTR)                               0538 01287000
         OI    CMDERRSW(@04),B'10000000'                           0538 01288000
*              ELSE                                                0539 01289000
*                DO;                                               0539 01290000
         B     @RC00537                                            0539 01291000
@RF00537 DS    0H                                                  0540 01292000
*                  TYPECNT = TYPECNT + 1;                          0540 01293000
         L     @04,COMVARPT(,COMPTR)                               0540 01294000
         LA    @02,1                                               0540 01295000
         AH    @02,TYPECNT(,@04)                                   0540 01296000
         STH   @02,TYPECNT(,@04)                                   0540 01297000
*                  TYPELIST(TYPECNT) = CTGTUCAT;                   0541 01298000
         ALR   @04,@02                                             0541 01299000
         MVI   TYPELIST-1(@04),C'U'                                0541 01300000
*                END;                                              0542 01301000
*        /************************************************************/ 01302000
*        /*                                                  @Y30SSMK*/ 01303000
*        /* IF NOTUSABLE IS REQUESTED AND DATE AND INDEX     @Y30SSMK*/ 01304000
*        /* IS NOT REQUESTED, THEN ADD THE TYPE CODES TO     @Y30SSMK*/ 01305000
*        /* THE STRING FOR BOTH DATA AND INDEX.              @Y30SSMK*/ 01306000
*        /*                                                  @Y30SSMK*/ 01307000
*        /************************************************************/ 01308000
*                                                                  0543 01309000
*        IF ADDR(NUSE) > NULLPTR                                   0543 01310000
*          THEN                                                    0543 01311000
@RC00537 DS    0H                                                  0543 01312000
@RF00536 L     @04,@PC00001+4                                      0543 01313000
         L     @04,FDTPTR+92(,@04)                                 0543 01314000
         LTR   @04,@04                                             0543 01315000
         BNP   @RF00543                                            0543 01316000
*            DO;                                           /*@Y30SSMK*/ 01317000
*              NUSEFLG = ON;                               /*@Y30SSMK*/ 01318000
         L     @04,COMFLGPT(,COMPTR)                               0545 01319000
         OI    NUSEFLG(@04),B'10000000'                            0545 01320000
*              IF DTYPFLG = OFF  &  ITYPFLG = OFF                  0546 01321000
*                THEN                                              0546 01322000
         TM    DTYPFLG(@04),B'10000000'                            0546 01323000
         BNZ   @RF00546                                            0546 01324000
         TM    ITYPFLG(@04),B'10000000'                            0546 01325000
         BNZ   @RF00546                                            0546 01326000
*                  DO;                                     /*@Y30SSMK*/ 01327000
*                    TYPECNT = TYPECNT + 1;                /*@Y30SSMK*/ 01328000
         L     @04,COMVARPT(,COMPTR)                               0548 01329000
         LA    @02,1                                               0548 01330000
         LH    @15,TYPECNT(,@04)                                   0548 01331000
         ALR   @15,@02                                             0548 01332000
         STH   @15,TYPECNT(,@04)                                   0548 01333000
*                    TYPELIST(TYPECNT) = CTGTDATA;         /*@Y30SSMK*/ 01334000
         ST    @15,@TF00001                                        0549 01335000
         ALR   @15,@04                                             0549 01336000
         MVI   TYPELIST-1(@15),C'D'                                0549 01337000
*                    TYPECNT = TYPECNT + 1;                /*@Y30SSMK*/ 01338000
         AL    @02,@TF00001                                        0550 01339000
         STH   @02,TYPECNT(,@04)                                   0550 01340000
*                    TYPELIST(TYPECNT) = CTGTINDX;         /*@Y30SSMK*/ 01341000
         ALR   @04,@02                                             0551 01342000
         MVI   TYPELIST-1(@04),C'I'                                0551 01343000
*                  END;                                    /*@Y30SSMK*/ 01344000
*            END;                                          /*@Y30SSMK*/ 01345000
*          ELSE                                                    0554 01346000
*            NUSEFLG = OFF;                                /*@Y30SSMK*/ 01347000
         B     @RC00543                                            0554 01348000
@RF00543 L     @04,COMFLGPT(,COMPTR)                               0554 01349000
         NI    NUSEFLG(@04),B'01111111'                            0554 01350000
*        /************************************************************/ 01351000
*        /*                                                          */ 01352000
*        /* OUTPUT A MESSAGE FOR AN ALLOC OR VOL REQUEST FLAGGED AS  */ 01353000
*        /* CONFLICTING WITH THE TYPES SPECIFICATION.                */ 01354000
*        /*                                                          */ 01355000
*        /************************************************************/ 01356000
*                                                                  0555 01357000
*        IF (ADDR(ALLOC) > NULLPTR  |  ADDR(VOL) > NULLPTR)        0555 01358000
*          & CMDERRSW = ON                                         0555 01359000
*          THEN                                                    0555 01360000
@RC00543 SLR   @04,@04                                             0555 01361000
         L     @02,@PC00001+4                                      0555 01362000
         C     @04,FDTPTR+64(,@02)                                 0555 01363000
         BL    @GL00022                                            0555 01364000
         C     @04,FDTPTR+60(,@02)                                 0555 01365000
         BNL   @RF00555                                            0555 01366000
@GL00022 L     @04,COMFLGPT(,COMPTR)                               0555 01367000
         TM    CMDERRSW(@04),B'10000000'                           0555 01368000
         BNO   @RF00555                                            0555 01369000
*            DO;                                                   0556 01370000
*              SAVRC = MAX (SAVRC,LASTCC08);               /*@ZA05939*/ 01371000
         L     @04,COMVARPT(,COMPTR)                               0557 01372000
         LA    @02,8                                               0557 01373000
         LH    @15,SAVRC(,@04)                                     0557 01374000
         CR    @15,@02                                             0557 01375000
         BNL   *+6                                                      01376000
         LR    @15,@02                                             0557 01377000
         STH   @15,SAVRC(,@04)                                     0557 01378000
*              ERRARGPT->DARGSMOD = LC1ID;                         0558 01379000
         L     @01,COMSWKPT(,COMPTR)                               0558 01380000
         L     @15,ERRARGPT(,@01)                                  0558 01381000
         MVC   DARGSMOD(3,@15),@CC01155                            0558 01382000
*              ERRARGPT->DARGSENT = LCMSG04;                       0559 01383000
*                                                                  0559 01384000
         MVI   DARGSENT(@15),X'04'                                 0559 01385000
*              /******************************************************/ 01386000
*              /*                                                    */ 01387000
*              /* TERMINATE, IF NO PART OF THE USER'S REQUEST CAN BE */ 01388000
*              /* PROCESSED.                                         */ 01389000
*              /*                                                    */ 01390000
*              /******************************************************/ 01391000
*                                                                  0560 01392000
*              IF TYPECNT = 0                                      0560 01393000
*                THEN                                              0560 01394000
         LH    @04,TYPECNT(,@04)                                   0560 01395000
         LTR   @04,@04                                             0560 01396000
         BNZ   @RF00560                                            0560 01397000
*                  RETURN CODE (LASTCC08);                         0561 01398000
         LR    @15,@02                                             0561 01399000
         L     @14,@SA00002                                        0561 01400000
         LM    @00,@12,@SA00002+8                                  0561 01401000
         BR    @14                                                 0561 01402000
*              CALL ERRPROC;                                       0562 01403000
@RF00560 L     @15,@CV00872                                        0562 01404000
         BALR  @14,@15                                             0562 01405000
*              CMDERRSW = OFF;                                     0563 01406000
         L     @04,COMFLGPT(,COMPTR)                               0563 01407000
         NI    CMDERRSW(@04),B'01111111'                           0563 01408000
*            END;                                                  0564 01409000
*                                                                  0564 01410000
*        /************************************************************/ 01411000
*        /*                                                  @Y30LSMK*/ 01412000
*        /* OUTPUT A WARNING MESSAGE IF THE EXPIRATION DATE  @Y30LSMK*/ 01413000
*        /* PARAMETER IS SPECIFIED WITH ENTRIES THAT EITHER  @Y30LSMK*/ 01414000
*        /* DO NOT CONTAIN THE EXPIRATION DATE FIELD, OR     @Y30LSMK*/ 01415000
*        /* DO CONTAIN THE EXPIRATION DATE FIELD, BUT IS     @Y30LSMK*/ 01416000
*        /* NEVER INITIALIZED.                               @Y30LSMK*/ 01417000
*        /*                                                  @Y30LSMK*/ 01418000
*        /************************************************************/ 01419000
*                                                                  0565 01420000
*        IF TYPECNT ^= 0  &  ADDR(EXPIR) > NULLPTR                 0565 01421000
*          THEN                                                    0565 01422000
@RF00555 SLR   @04,@04                                             0565 01423000
         L     @02,COMVARPT(,COMPTR)                               0565 01424000
         CH    @04,TYPECNT(,@02)                                   0565 01425000
         BE    @RF00565                                            0565 01426000
         L     @15,@PC00001+4                                      0565 01427000
         C     @04,FDTPTR+100(,@15)                                0565 01428000
         BNL   @RF00565                                            0565 01429000
*            IF CTYPFLG ^= ON  &  ATYPFLG ^= ON  &  BTYPFLG ^= ON  &    01430000
*              PTYPFLG ^= ON  &  GTYPFLG ^= ON  &  RTYPFLG ^= ON   0566 01431000
*              THEN                                                0566 01432000
         L     @04,COMFLGPT(,COMPTR)                               0566 01433000
         TM    CTYPFLG(@04),B'10000000'                            0566 01434000
         BO    @RF00566                                            0566 01435000
         TM    ATYPFLG(@04),B'10000000'                            0566 01436000
         BO    @RF00566                                            0566 01437000
         TM    BTYPFLG(@04),B'10000000'                            0566 01438000
         BO    @RF00566                                            0566 01439000
         TM    PTYPFLG(@04),B'10000000'                            0566 01440000
         BO    @RF00566                                            0566 01441000
         TM    GTYPFLG(@04),B'10000000'                            0566 01442000
         BO    @RF00566                                            0566 01443000
         TM    RTYPFLG(@04),B'10000000'                            0566 01444000
         BO    @RF00566                                            0566 01445000
*                DO;                                       /*@Y30LSMK*/ 01446000
*                  SAVRC = MAX(SAVRC,LASTCC04);            /*@ZA05939*/ 01447000
         LH    @04,SAVRC(,@02)                                     0568 01448000
         LA    @15,4                                               0568 01449000
         CR    @04,@15                                             0568 01450000
         BNL   *+6                                                      01451000
         LR    @04,@15                                             0568 01452000
         STH   @04,SAVRC(,@02)                                     0568 01453000
*                  ERRARGPT->DARGSMOD = LC1ID;             /*@Y30LSMK*/ 01454000
         L     @04,COMSWKPT(,COMPTR)                               0569 01455000
         L     @04,ERRARGPT(,@04)                                  0569 01456000
         MVC   DARGSMOD(3,@04),@CC01155                            0569 01457000
*                  ERRARGPT->DARGSENT = LCMSG12;           /*@Y30LSMK*/ 01458000
         MVI   DARGSENT(@04),X'0C'                                 0570 01459000
*                  CALL ERRPROC;                           /*@Y30LSMK*/ 01460000
         L     @15,@CV00872                                        0571 01461000
         BALR  @14,@15                                             0571 01462000
*                END;                                      /*@Y30LSMK*/ 01463000
*        /************************************************************/ 01464000
*        /*                                                          */ 01465000
*        /*   A NON-QUALIFIED LISTING, I.E. NO ENTRY LIST OR TYPE    */ 01466000
*        /*   REQUEST, OF THE CATALOG IS GENERATED VIA THE           */ 01467000
*        /*   MULTITYP PROCESSING FEATURE OF THE LISTC GETNEXT MODE  */ 01468000
*        /*   RATHER THAN THE PURE LISTCAT GETNEXT MODE.  THIS       */ 01469000
*        /*   ELIMINATES UNNECESSARY LOCATES FOR DATA,       @Y30SSMK*/ 01470000
*        /*   INDEX AND PATH ENTRIES SINCE THESE ASSOCIATED  @Y30SSMK*/ 01471000
*        /*   DATASETS ARE LISTED UNDER A CLUSTER AND AIX    @Y30SSMK*/ 01472000
*        /*   NODE AND THUS ARE LOCATED VIA THEIR CONTROL    @Y30SSMK*/ 01473000
*        /*   INTERVAL NUMBERS.                              @Y30SSMK*/ 01474000
*        /*                                                          */ 01475000
*        /************************************************************/ 01476000
*                                                                  0573 01477000
*        IF TYPECNT = 0  &  ENLVUDFG = OFF                         0573 01478000
*          THEN                                                    0573 01479000
@RF00566 DS    0H                                                  0573 01480000
@RF00565 SLR   @04,@04                                             0573 01481000
         L     @02,COMVARPT(,COMPTR)                               0573 01482000
         CH    @04,TYPECNT(,@02)                                   0573 01483000
         BNE   @RF00573                                            0573 01484000
         L     @15,COMFLGPT(,COMPTR)                               0573 01485000
         TM    ENLVUDFG(@15),B'10000000'                           0573 01486000
         BNZ   @RF00573                                            0573 01487000
*            IF ADDR(ALLOC) > NULLPTR                              0574 01488000
*              THEN                                                0574 01489000
*                                                                  0574 01490000
         L     @14,@PC00001+4                                      0574 01491000
         C     @04,FDTPTR+64(,@14)                                 0574 01492000
         BNL   @RF00574                                            0574 01493000
*                /****************************************************/ 01494000
*                /*                                                  */ 01495000
*                /* SPACE ALLOCATION INFORMATION IS SIGNIFICANT ONLY */ 01496000
*                /* TO THE ASSOCIATIONS OF A CLUSTER, PAGESPACE OR   */ 01497000
*                /* AN AIX.                                  @Y30SSMK*/ 01498000
*                /*                                                  */ 01499000
*                /****************************************************/ 01500000
*                                                                  0575 01501000
*                DO;                                               0575 01502000
*                  TYPECNT = LENGTH(LALLOCTP);             /*@YL026UE*/ 01503000
         MVC   TYPECNT(2,@02),@CH00170                             0576 01504000
*                  TYPELIST = LALLOCTP;                    /*@YL026UE*/ 01505000
         MVI   TYPELIST+3(@02),C' '                                0577 01506000
         MVC   TYPELIST+4(7,@02),TYPELIST+3(@02)                   0577 01507000
         MVC   TYPELIST(3,@02),@CC01288                            0577 01508000
*                  LISTCFLG = ON;                                  0578 01509000
         OI    LISTCFLG(@15),B'10000000'                           0578 01510000
*                END;                                              0579 01511000
*              ELSE                                                0580 01512000
*                                                                  0580 01513000
*                /****************************************************/ 01514000
*                /*                                                  */ 01515000
*                /* RETRIEVE C, V, A, U, B, P, AND  G TYPES FOR VOL  */ 01516000
*                /* REQUESTS OR RETRIEVE C, V, A, U, X, B, P, AND  G */ 01517000
*                /* FOR TYPES REQUESTS OF ALL OR NAME INFORMATION.   */ 01518000
*                /*                                          @YL026UE*/ 01519000
*                /****************************************************/ 01520000
*                                                                  0580 01521000
*                DO;                                               0580 01522000
         B     @RC00574                                            0580 01523000
@RF00574 DS    0H                                                  0581 01524000
*                IF ADDR(VOL) > NULLPTR                            0581 01525000
*                  THEN                                            0581 01526000
         L     @04,@PC00001+4                                      0581 01527000
         L     @04,FDTPTR+60(,@04)                                 0581 01528000
         LTR   @04,@04                                             0581 01529000
         BNP   @RF00581                                            0581 01530000
*                    DO;                                   /*@YL026UE*/ 01531000
*                    LISTCFLG = ON;                        /*@YL026UE*/ 01532000
         L     @04,COMFLGPT(,COMPTR)                               0583 01533000
         OI    LISTCFLG(@04),B'10000000'                           0583 01534000
*                    TYPELIST = LVOLTYPS;                  /*@YL026UE*/ 01535000
         L     @04,COMVARPT(,COMPTR)                               0584 01536000
         MVI   TYPELIST+7(@04),C' '                                0584 01537000
         MVC   TYPELIST+8(3,@04),TYPELIST+7(@04)                   0584 01538000
         MVC   TYPELIST(7,@04),@CC01286                            0584 01539000
*                    TYPECNT = LENGTH(LVOLTYPS);           /*@YL026UE*/ 01540000
         MVC   TYPECNT(2,@04),@CH00480                             0585 01541000
*                    END;                                  /*@YL026UE*/ 01542000
*                  ELSE                                            0587 01543000
*                    DO;                                   /*@YL026UE*/ 01544000
         B     @RC00581                                            0587 01545000
@RF00581 DS    0H                                                  0588 01546000
*                    LISTCFLG = ON;                        /*@YL026UE*/ 01547000
         L     @04,COMFLGPT(,COMPTR)                               0588 01548000
         OI    LISTCFLG(@04),B'10000000'                           0588 01549000
*                    TYPELIST = LALLTYPS;                  /*@YL026UE*/ 01550000
         L     @04,COMVARPT(,COMPTR)                               0589 01551000
         MVI   TYPELIST+8(@04),C' '                                0589 01552000
         MVC   TYPELIST+9(2,@04),TYPELIST+8(@04)                   0589 01553000
         MVC   TYPELIST(8,@04),@CC01284                            0589 01554000
*                    TYPECNT = LENGTH(LALLTYPS);           /*@YL026UE*/ 01555000
         MVC   TYPECNT(2,@04),@CH00187                             0590 01556000
*                    END;                                  /*@YL026UE*/ 01557000
*                END;                                              0592 01558000
@RC00581 DS    0H                                                  0593 01559000
*        /************************************************************/ 01560000
*        /*                                                  @Y30LSMK*/ 01561000
*        /* OBTAIN THE CURRENT TIME AND DATE AND INVOKE      @Y30LSMK*/ 01562000
*        /* DATEPROC TO CALCULATE THE CREATION AND           @Y30LSMK*/ 01563000
*        /* EXPIRATION DATES.                                @Y30LSMK*/ 01564000
*        /*                                                  @Y30LSMK*/ 01565000
*        /************************************************************/ 01566000
*                                                                  0593 01567000
*        IF ADDR(CREAT) > NULLPTR  |  ADDR(EXPIR) > NULLPTR        0593 01568000
*          THEN                                                    0593 01569000
@RC00574 DS    0H                                                  0593 01570000
@RF00573 SLR   @04,@04                                             0593 01571000
         L     @02,@PC00001+4                                      0593 01572000
         C     @04,FDTPTR+96(,@02)                                 0593 01573000
         BL    @RT00593                                            0593 01574000
         C     @04,FDTPTR+100(,@02)                                0593 01575000
         BNL   @RF00593                                            0593 01576000
@RT00593 DS    0H                                                  0594 01577000
*CNVTDATE:   DO;                                           /*@Y30LSMK*/ 01578000
CNVTDATE DS    0H                                                  0595 01579000
*              DATEFLG = ON;                               /*@Y30LSMK*/ 01580000
         L     @04,COMFLGPT(,COMPTR)                               0595 01581000
         OI    DATEFLG(@04),B'10000000'                            0595 01582000
*              CALL IDCSATI0 (GDTTBL,TIMEODAY,CREATEDT,CLOCK);/*   0596 01583000
*                                                            @Y30LSMK*/ 01584000
         L     @04,@PC00001                                        0596 01585000
         ST    @04,@AL00001                                        0596 01586000
         LA    @02,TIMEODAY                                        0596 01587000
         ST    @02,@AL00001+4                                      0596 01588000
         LA    @02,CREATEDT                                        0596 01589000
         ST    @02,@AL00001+8                                      0596 01590000
         LA    @02,CLOCK                                           0596 01591000
         ST    @02,@AL00001+12                                     0596 01592000
         MVI   @AL00001+12,X'80'                                   0596 01593000
         L     @15,GDTTIM(,@04)                                    0596 01594000
         LA    @01,@AL00001                                        0596 01595000
         BALR  @14,@15                                             0596 01596000
*              CALL DATEPROC;                              /*@Y30LSMK*/ 01597000
         BAL   @14,DATEPROC                                        0597 01598000
*              IF ADDR(CREAT) > NULLPTR  &  (VTYPFLG = ON  |       0598 01599000
*                (LISTCFLG = ON  &  ADDR(ALLOC) = NULLPTR))        0598 01600000
*                THEN                                              0598 01601000
*                                                                  0598 01602000
         SLR   @04,@04                                             0598 01603000
         L     @02,@PC00001+4                                      0598 01604000
         C     @04,FDTPTR+96(,@02)                                 0598 01605000
         BNL   @RF00598                                            0598 01606000
         L     @15,COMFLGPT(,COMPTR)                               0598 01607000
         TM    VTYPFLG(@15),B'10000000'                            0598 01608000
         BO    @RT00598                                            0598 01609000
         TM    LISTCFLG(@15),B'10000000'                           0598 01610000
         BNO   @RF00598                                            0598 01611000
         C     @04,FDTPTR+64(,@02)                                 0598 01612000
         BNE   @RF00598                                            0598 01613000
@RT00598 DS    0H                                                  0599 01614000
*                  /**************************************************/ 01615000
*                  /*                                        @Y30LSMK*/ 01616000
*                  /* CONVERT THE REQUESTED CREATION VALUE   @Y30LSMK*/ 01617000
*                  /* INTO MICROSECONDS TO BE USED IN        @Y30LSMK*/ 01618000
*                  /* TESTING THE VOLUME TIME STAMP FOR      @Y30LSMK*/ 01619000
*                  /* VOLUME ENTRIES.                        @Y30LSMK*/ 01620000
*                  /*                                        @Y30LSMK*/ 01621000
*                  /**************************************************/ 01622000
*                                                                  0599 01623000
*                  DO;                                     /*@Y30LSMK*/ 01624000
*                    MICTIME = ZEROAREA;                   /*@Y30LSMK*/ 01625000
         MVC   MICTIME(16),ZEROAREA                                0600 01626000
*                    MICRSEC1 = MICROSEC;                  /*@Y30LSMK*/ 01627000
         L     MICRSEC1,@CF01343                                   0601 01628000
*                    CVD(MICRSEC1,TIMPACK1);               /*@Y30LSMK*/ 01629000
         CVD   MICRSEC1,TIMPACK1                                   0602 01630000
*                    MCTIME = TIMPACK1;                    /*@Y30LSMK*/ 01631000
         MVC   MCTIME(8),TIMPACK1                                  0603 01632000
*                    SECNDAY1 = SECINDAY;                  /*@Y30LSMK*/ 01633000
         L     SECNDAY1,@CF01346                                   0604 01634000
*                    CVD(SECNDAY1,TIMPACK1);               /*@Y30LSMK*/ 01635000
         CVD   SECNDAY1,TIMPACK1                                   0605 01636000
*                    MP(MICTIME,TIMPACK1);                 /*@Y30LSMK*/ 01637000
         MP    MICTIME(16),TIMPACK1(8)                             0606 01638000
*                    CVD(CREATVAL,TIMPACK1);               /*@Y30LSMK*/ 01639000
         L     @04,@PC00001+4                                      0607 01640000
         L     @04,FDTPTR+96(,@04)                                 0607 01641000
         L     @04,CREATVAL(,@04)                                  0607 01642000
         CVD   @04,TIMPACK1                                        0607 01643000
*                    MP(MICTIME,TIMPACK1);                 /*@Y30LSMK*/ 01644000
*                                                                  0608 01645000
         MP    MICTIME(16),TIMPACK1(8)                             0608 01646000
*                    /************************************************/ 01647000
*                    /*                                      @Y30LSMK*/ 01648000
*                    /* INVOKE TIMEPROC TO CONVERT THE TIME  @Y30LSMK*/ 01649000
*                    /* OF DAY INTO A PACKED DECIMAL NUMBER. @Y30LSMK*/ 01650000
*                    /*                                      @Y30LSMK*/ 01651000
*                    /************************************************/ 01652000
*                                                                  0609 01653000
*                    CALL TIMEPROC;                        /*@Y30LSMK*/ 01654000
         BAL   @14,TIMEPROC                                        0609 01655000
*                    SP(TIMEPACK,MICTIME);                 /*@Y30LSMK*/ 01656000
         SP    TIMEPACK(16),MICTIME(16)                            0610 01657000
*                    MICTIME = TIMEPACK;                   /*@Y30LSMK*/ 01658000
         MVC   MICTIME(16),TIMEPACK                                0611 01659000
*                  END;                                    /*@Y30LSMK*/ 01660000
*            END CNVTDATE;                                 /*@Y30LSMK*/ 01661000
*          ELSE                                                    0614 01662000
*            DATEFLG = OFF;                                /*@Y30LSMK*/ 01663000
         B     @RC00593                                            0614 01664000
@RF00593 L     @04,COMFLGPT(,COMPTR)                               0614 01665000
         NI    DATEFLG(@04),B'01111111'                            0614 01666000
*        /************************************************************/ 01667000
*        /*                                                          */ 01668000
*        /* A MULTIPLE TYPE LISTING MUST INCLUDE THE MULTITYP FPL    */ 01669000
*        /* AS THE VERY FIRST FPL BUILT FOR LOCATE REQUESTS.         */ 01670000
*        /* NOTE - IF THE CREATION OR EXPIRATION OPTION WAS  @Y30LSMK*/ 01671000
*        /* REQUESTED, OR IF THE NOTUSABLE OPTION WAS        @Y30SSMK*/ 01672000
*        /* REQUESTED, THIS WILL ALSO RESULT IN A MULTITYP   @Y30LSMK*/ 01673000
*        /* FPL.                                             @Y30LSMK*/ 01674000
*        /*                                                          */ 01675000
*        /************************************************************/ 01676000
*                                                                  0615 01677000
*        IF TYPECNT > 1  |  DATEFLG = ON  |  NUSEFLG = ON          0615 01678000
*          THEN                                                    0615 01679000
@RC00593 L     @04,COMVARPT(,COMPTR)                               0615 01680000
         CLC   TYPECNT(2,@04),@CH00045                             0615 01681000
         BH    @RT00615                                            0615 01682000
         L     @04,COMFLGPT(,COMPTR)                               0615 01683000
         TM    DATEFLG(@04),B'10000000'                            0615 01684000
         BO    @RT00615                                            0615 01685000
         TM    NUSEFLG(@04),B'10000000'                            0615 01686000
         BNO   @RF00615                                            0615 01687000
@RT00615 DS    0H                                                  0616 01688000
*            DO;                                                   0616 01689000
*              CTGTYPE = HEXFF;                                    0617 01690000
         L     @04,COMSWKPT(,COMPTR)                               0617 01691000
         L     @04,CTGPLPTR(,@04)                                  0617 01692000
         MVC   CTGTYPE(1,@04),HEXFF                                0617 01693000
*              FPLBEGN = 1;                                        0618 01694000
         L     @04,COMVARPT(,COMPTR)                               0618 01695000
         MVC   FPLBEGN(2,@04),@CH00045                             0618 01696000
*            END;                                                  0619 01697000
*                                                                  0619 01698000
*          /**********************************************************/ 01699000
*          /*                                                        */ 01700000
*          /* FOR SINGLE TYPE LISTINGS, THE TYPE CODE IS EMBEDDED    */ 01701000
*          /* WITHIN THE CPL, RATHER THAN SETTING UP THE SPECIAL     */ 01702000
*          /* MULTITYP FPL.                                          */ 01703000
*          /*                                                        */ 01704000
*          /**********************************************************/ 01705000
*                                                                  0620 01706000
*          ELSE                                                    0620 01707000
*            DO;                                                   0620 01708000
         B     @RC00615                                            0620 01709000
@RF00615 DS    0H                                                  0621 01710000
*              FPLBEGN = BYPASMUL;     /*BYPASS SPECIAL MULTITYP FPL */ 01711000
         L     @04,COMVARPT(,COMPTR)                               0621 01712000
         MVC   FPLBEGN(2,@04),@CH00161                             0621 01713000
*              IF TYPECNT = 1                                      0622 01714000
*                THEN                  /*SINGLE TYPE TO BE LISTED    */ 01715000
         CLC   TYPECNT(2,@04),@CH00045                             0622 01716000
         BNE   @RF00622                                            0622 01717000
*                  CTGTYPE = TYPELIST(1);                          0623 01718000
         L     @02,COMSWKPT(,COMPTR)                               0623 01719000
         L     @02,CTGPLPTR(,@02)                                  0623 01720000
         MVC   CTGTYPE(1,@02),TYPELIST(@04)                        0623 01721000
*                ELSE                  /*ENTRIES LISTED VIA NAME     */ 01722000
*                  CTGTYPE = NOTYPE;                               0624 01723000
         B     @RC00622                                            0624 01724000
@RF00622 L     @04,COMSWKPT(,COMPTR)                               0624 01725000
         L     @04,CTGPLPTR(,@04)                                  0624 01726000
         MVC   CTGTYPE(1,@04),NOTYPE                               0624 01727000
*            END;                                                  0625 01728000
@RC00622 DS    0H                                                  0626 01729000
*                                                                  0626 01730000
*        /************************************************************/ 01731000
*        /*                                                          */ 01732000
*        /* TEST FOR USER SPECIFICATION ERRORS CAUSING TERMINATION.  */ 01733000
*        /*                                                          */ 01734000
*        /************************************************************/ 01735000
*                                                                  0626 01736000
*        IF ENLVUDFG = OFF  &  LISTCFLG = OFF  &  TYPECNT = 0      0626 01737000
*          THEN                                                    0626 01738000
@RC00615 L     @04,COMFLGPT(,COMPTR)                               0626 01739000
         TM    ENLVUDFG(@04),B'10000000'                           0626 01740000
         BNZ   @RF00626                                            0626 01741000
         TM    LISTCFLG(@04),B'10000000'                           0626 01742000
         BNZ   @RF00626                                            0626 01743000
         L     @02,COMVARPT(,COMPTR)                               0626 01744000
         LH    @02,TYPECNT(,@02)                                   0626 01745000
         LTR   @02,@02                                             0626 01746000
         BNZ   @RF00626                                            0626 01747000
*            DO;                                                   0627 01748000
*              NOMSGFLG = ON;                                      0628 01749000
         OI    NOMSGFLG(@04),B'10000000'                           0628 01750000
*              RETURN CODE (LASTCC12);                             0629 01751000
         LA    @15,12                                              0629 01752000
         L     @14,@SA00002                                        0629 01753000
         LM    @00,@12,@SA00002+8                                  0629 01754000
         BR    @14                                                 0629 01755000
*            END;                                                  0630 01756000
*        /************************************************************/ 01757000
*        /*                                                  @Y30LSMK*/ 01758000
*        /* SINCE THE FPL'S REQUIRED TO CHECK THE CREATION   @Y30LSMK*/ 01759000
*        /* AND EXPIRATION DATES ARE NOT RETURNED WITH THE   @Y30LSMK*/ 01760000
*        /* NAME SUBSET, ADD TO THE FPL COUNT THESE          @Y30LSMK*/ 01761000
*        /* ADDITIONAL FPL'S. SAVE THE FPL COUNT TO BE       @Y30LSMK*/ 01762000
*        /* USED LATER IN THE RETRIEVAL OF THOSE FPL'S SINCE @Y30LSMK*/ 01763000
*        /* THEY WILL OVERLAY EXISTING FPL'S.                @Y30LSMK*/ 01764000
*        /*                                                  @Y30LSMK*/ 01765000
*        /************************************************************/ 01766000
*                                                                  0631 01767000
*        IF ADDR(EXPIR) > NULLPTR  &  ADDR(NAME) > NULLPTR         0631 01768000
*          THEN                                                    0631 01769000
@RF00626 SLR   @04,@04                                             0631 01770000
         L     @02,@PC00001+4                                      0631 01771000
         C     @04,FDTPTR+100(,@02)                                0631 01772000
         BNL   @RF00631                                            0631 01773000
         C     @04,FDTPTR+52(,@02)                                 0631 01774000
         BNL   @RF00631                                            0631 01775000
*            DO;                                           /*@Y30LSMK*/ 01776000
*              FPLCNT = FPLCNT + 1;                        /*@Y30LSMK*/ 01777000
         L     @04,COMVARPT(,COMPTR)                               0633 01778000
         LA    @02,1                                               0633 01779000
         AH    @02,FPLCNT(,@04)                                    0633 01780000
         STH   @02,FPLCNT(,@04)                                    0633 01781000
*              FPLEXP = FPLCNT;                            /*@Y30LSMK*/ 01782000
         STH   @02,FPLEXP                                          0634 01783000
*              EXFPLFLG = ON;                              /*@Y30LSMK*/ 01784000
         L     @04,COMFLGPT(,COMPTR)                               0635 01785000
         OI    EXFPLFLG(@04),B'10000000'                           0635 01786000
*            END;                                          /*@Y30LSMK*/ 01787000
*        IF ADDR(CREAT) > NULLPTR  &  ADDR(NAME) > NULLPTR         0637 01788000
*          THEN                                                    0637 01789000
@RF00631 SLR   @04,@04                                             0637 01790000
         L     @02,@PC00001+4                                      0637 01791000
         C     @04,FDTPTR+96(,@02)                                 0637 01792000
         BNL   @RF00637                                            0637 01793000
         C     @04,FDTPTR+52(,@02)                                 0637 01794000
         BNL   @RF00637                                            0637 01795000
*            DO;                                           /*@Y30LSMK*/ 01796000
*              FPLCNT = FPLCNT + 1;                        /*@Y30LSMK*/ 01797000
         L     @04,COMVARPT(,COMPTR)                               0639 01798000
         LA    @02,1                                               0639 01799000
         AH    @02,FPLCNT(,@04)                                    0639 01800000
         STH   @02,FPLCNT(,@04)                                    0639 01801000
*              FPLCDT = FPLCNT;                            /*@Y30LSMK*/ 01802000
         STH   @02,FPLCDT                                          0640 01803000
*              CRFPLFLG = ON;                              /*@Y30LSMK*/ 01804000
         L     @04,COMFLGPT(,COMPTR)                               0641 01805000
         OI    CRFPLFLG(@04),B'10000000'                           0641 01806000
*            END;                                          /*@Y30LSMK*/ 01807000
*                                                                  0642 01808000
*        /************************************************************/ 01809000
*        /*                                                  @Y30LSMK*/ 01810000
*        /* FOR A VOLUME ENTRY, THE VOLUME TIME STAMP FPL'S  @Y30LSMK*/ 01811000
*        /* WILL BE REQUIRED TO CHECK THE CREATION DATE      @Y30LSMK*/ 01812000
*        /* UNLESS ALL CATALOG INFORMATION WAS REQUESTED.    @Y30LSMK*/ 01813000
*        /* SAVE THE FPL COUNT TO BO USED LATER IN THE RETRIEVAL     */ 01814000
*        /* OF THOSE FPL'S SINCE THEY WILL OVERLAY EXISTING  @Y30LSMK*/ 01815000
*        /* FPL'S.                                           @Y30LSMK*/ 01816000
*        /*                                                  @Y30LSMK*/ 01817000
*        /************************************************************/ 01818000
*                                                                  0643 01819000
*        IF ADDR(CREAT) > NULLPTR  &  ADDR(FALL) = NULLPTR         0643 01820000
*          THEN                                                    0643 01821000
@RF00637 SLR   @04,@04                                             0643 01822000
         L     @02,@PC00001+4                                      0643 01823000
         C     @04,FDTPTR+96(,@02)                                 0643 01824000
         BNL   @RF00643                                            0643 01825000
         C     @04,FDTPTR+56(,@02)                                 0643 01826000
         BNE   @RF00643                                            0643 01827000
*            IF VTYPFLG = ON  |                                    0644 01828000
*              (LISTCFLG = ON  &  ADDR(ALLOC) = NULLPTR)           0644 01829000
*              THEN                                                0644 01830000
         L     @15,COMFLGPT(,COMPTR)                               0644 01831000
         TM    VTYPFLG(@15),B'10000000'                            0644 01832000
         BO    @RT00644                                            0644 01833000
         TM    LISTCFLG(@15),B'10000000'                           0644 01834000
         BNO   @RF00644                                            0644 01835000
         C     @04,FDTPTR+64(,@02)                                 0644 01836000
         BNE   @RF00644                                            0644 01837000
@RT00644 DS    0H                                                  0645 01838000
*                DO;                                       /*@Y30LSMK*/ 01839000
*                  FPLCNT = FPLCNT + 1;                    /*@Y30LSMK*/ 01840000
         L     @04,COMVARPT(,COMPTR)                               0646 01841000
         LA    @02,1                                               0646 01842000
         LH    @15,FPLCNT(,@04)                                    0646 01843000
         ALR   @15,@02                                             0646 01844000
         STH   @15,FPLCNT(,@04)                                    0646 01845000
*                  FPLSPH = FPLCNT;                        /*@Y30LSMK*/ 01846000
         STH   @15,FPLSPH                                          0647 01847000
*                  FPLCNT = FPLCNT + 1;                    /*@Y30LSMK*/ 01848000
         ALR   @15,@02                                             0648 01849000
         STH   @15,FPLCNT(,@04)                                    0648 01850000
*                  FPLVTM = FPLCNT;                        /*@Y30LSMK*/ 01851000
         STH   @15,FPLVTM                                          0649 01852000
*                  VTFPLFLG = ON;                          /*@Y30LSMK*/ 01853000
         L     @04,COMFLGPT(,COMPTR)                               0650 01854000
         OI    VTFPLFLG(@04),B'10000000'                           0650 01855000
*                END;                                      /*@Y30LSMK*/ 01856000
*                                                                  0651 01857000
*        /************************************************************/ 01858000
*        /*                                                  @Y30SSMK*/ 01859000
*        /* IF NOTUSABLE IS SPECIFIED AN ADDITIONAL FPL WILL @Y30SSMK*/ 01860000
*        /* BE REQUIRED TO REFERENCE THIS INFORMATION        @Y30SSMK*/ 01861000
*        /* UNLESS ALL CATALOG INFORMATION WAS REQUESTED.    @Y30SSMK*/ 01862000
*        /* SAVE THE FPL COUNT TO BE USED LATER IN RETRIEVAL @Y30SSMK*/ 01863000
*        /* OF THE FPL, SINCE IT WILL OVERLAY AN EXISTING FPL.       */ 01864000
*        /*                                                  @Y30SSMK*/ 01865000
*        /************************************************************/ 01866000
*                                                                  0652 01867000
*        IF ADDR(NUSE) > NULLPTR  &  ADDR(FALL) = NULLPTR          0652 01868000
*          THEN                                                    0652 01869000
@RF00644 DS    0H                                                  0652 01870000
@RF00643 SLR   @04,@04                                             0652 01871000
         L     @02,@PC00001+4                                      0652 01872000
         C     @04,FDTPTR+92(,@02)                                 0652 01873000
         BNL   @RF00652                                            0652 01874000
         C     @04,FDTPTR+56(,@02)                                 0652 01875000
         BNE   @RF00652                                            0652 01876000
*            DO;                                           /*@Y30SSMK*/ 01877000
*              FPLCNT = FPLCNT + 1;                        /*@Y30SSMK*/ 01878000
         L     @04,COMVARPT(,COMPTR)                               0654 01879000
         LA    @02,1                                               0654 01880000
         AH    @02,FPLCNT(,@04)                                    0654 01881000
         STH   @02,FPLCNT(,@04)                                    0654 01882000
*              FPLATR = FPLCNT;                            /*@Y30SSMK*/ 01883000
         STH   @02,FPLATR                                          0655 01884000
*              ATFPLFLG = ON;                              /*@Y30SSMK*/ 01885000
         L     @04,COMFLGPT(,COMPTR)                               0656 01886000
         OI    ATFPLFLG(@04),B'10000000'                           0656 01887000
*            END;                                          /*@Y30SSMK*/ 01888000
*                                                                  0657 01889000
*        /************************************************************/ 01890000
*        /*                                                          */ 01891000
*        /* IF CAT ACB PTR IS NOT KNOWN, BUILD FPL TO REFERENCE      */ 01892000
*        /* THIS INFORMATION.  LET THIS FPL BE THE LAST IN THE       */ 01893000
*        /* STRING OF FPLS. SO THAT, AFTER THE FIRST LOCATE, IT      */ 01894000
*        /* MAY BE DROPPED FROM THE STRING TO ELIMINATE UNNECESSARY  */ 01895000
*        /* CAT/DADSM RETRIEVALS.                                    */ 01896000
*        /*                                                          */ 01897000
*        /************************************************************/ 01898000
*                                                                  0658 01899000
*        IF CACBFLG = ON                                           0658 01900000
*          THEN                        /*INCL SPECIAL CAT ACB FPL    */ 01901000
@RF00652 L     @04,COMFLGPT(,COMPTR)                               0658 01902000
         TM    CACBFLG(@04),B'10000000'                            0658 01903000
         BNO   @RF00658                                            0658 01904000
*            FPLCNT = FPLCNT + 1;                                  0659 01905000
         L     @04,COMVARPT(,COMPTR)                               0659 01906000
         LA    @02,1                                               0659 01907000
         AH    @02,FPLCNT(,@04)                                    0659 01908000
         STH   @02,FPLCNT(,@04)                                    0659 01909000
*        FPLEND = FPLCNT;              /*RECORD THE LAST FPL         */ 01910000
@RF00658 L     @04,COMVARPT(,COMPTR)                               0660 01911000
         LH    @02,FPLCNT(,@04)                                    0660 01912000
         STH   @02,FPLEND(,@04)                                    0660 01913000
*        IF FPLBEGN = BYPASMUL                                     0661 01914000
*          THEN                        /*FIRST FPL NOT MULTI-TYPE    */ 01915000
         CLC   FPLBEGN(2,@04),@CH00161                             0661 01916000
         BNE   @RF00661                                            0661 01917000
*            FPLCNT = FPLCNT - 1;      /*EXCL THIS FPL FROM TOTAL CNT*/ 01918000
         BCTR  @02,0                                               0662 01919000
         STH   @02,FPLCNT(,@04)                                    0662 01920000
*                                                                  0663 01921000
*        /************************************************************/ 01922000
*        /*                                                          */ 01923000
*        /* OBTAIN STORAGE FOR ONLY THOSE NECESSARY FPLS.    @Y30LSMK*/ 01924000
*        /* SINCE THE FPL'S ARE NOT READ-ONLY PARM LISTS, OBTAIN     */ 01925000
*        /* ADDITIONAL STORAGE FOR A SAVE AREA COPY.                 */ 01926000
*        /* ADDITIONAL STORAGE WILL ALSO BE REQUIRED IF A    @Y30LSMK*/ 01927000
*        /* MULTITYP FPL IS TO BE INCLUDED, SINCE IT         @Y30LSMK*/ 01928000
*        /* REQUIRES ADDITIONAL POINTER AND LENGTH FIELDS.   @Y30LSMK*/ 01929000
*        /*                                                          */ 01930000
*        /************************************************************/ 01931000
*                                                                  0663 01932000
*        GPID = GPID01;                                            0663 01933000
@RF00661 MVC   GPID(4),@CC01247                                    0663 01934000
*        LCFPLLEN = LENGTH(CTGFL) + FPLPTLEN;              /*@Y30SSMK*/ 01935000
         L     @04,COMSWKPT(,COMPTR)                               0664 01936000
         LA    @02,24                                              0664 01937000
         STC   @02,LCFPLLEN(,@04)                                  0664 01938000
*        MTFPLLEN = LENGTH(CTGFL) + MULPTLEN;              /*@Y30SSMK*/ 01939000
*                                                                  0665 01940000
         LA    @15,48                                              0665 01941000
         STC   @15,MTFPLLEN(,@04)                                  0665 01942000
*        IF FPLBEGN = 1                                            0666 01943000
*          THEN                                                    0666 01944000
         L     @04,COMVARPT(,COMPTR)                               0666 01945000
         CLC   FPLBEGN(2,@04),@CH00045                             0666 01946000
         BNE   @RF00666                                            0666 01947000
*            GPLEN = STORCNT2 * ((LCFPLLEN * (FPLCNT - 1)) +       0667 01948000
*              MTFPLLEN);                                  /*@Y30LSMK*/ 01949000
         LH    @04,FPLCNT(,@04)                                    0667 01950000
         BCTR  @04,0                                               0667 01951000
         LR    @01,@02                                             0667 01952000
         MR    @00,@04                                             0667 01953000
         ALR   @01,@15                                             0667 01954000
         ALR   @01,@01                                             0667 01955000
         ST    @01,GPLEN                                           0667 01956000
*          ELSE                                                    0668 01957000
*            GPLEN = STORCNT2 * (LCFPLLEN * FPLCNT);       /*@Y30SSMK*/ 01958000
*                                                                  0668 01959000
         B     @RC00666                                            0668 01960000
@RF00666 L     @04,COMSWKPT(,COMPTR)                               0668 01961000
         L     @02,COMVARPT(,COMPTR)                               0668 01962000
         SLR   @15,@15                                             0668 01963000
         IC    @15,LCFPLLEN(,@04)                                  0668 01964000
         MH    @15,FPLCNT(,@02)                                    0668 01965000
         ALR   @15,@15                                             0668 01966000
         ST    @15,GPLEN                                           0668 01967000
*        CALL IDCSAGP0 (GDTTBL,                                    0669 01968000
*                GPLEN,                                            0669 01969000
*                CTGFLPTR,                                         0669 01970000
*                GPID,                                             0669 01971000
*                SETZERO);                                         0669 01972000
@RC00666 L     @02,@PC00001                                        0669 01973000
         ST    @02,@AL00001                                        0669 01974000
         LA    @15,GPLEN                                           0669 01975000
         ST    @15,@AL00001+4                                      0669 01976000
         L     @01,COMSWKPT(,COMPTR)                               0669 01977000
         LA    @15,CTGFLPTR(,@01)                                  0669 01978000
         ST    @15,@AL00001+8                                      0669 01979000
         LA    @15,GPID                                            0669 01980000
         ST    @15,@AL00001+12                                     0669 01981000
         LA    @15,SETZERO                                         0669 01982000
         ST    @15,@AL00001+16                                     0669 01983000
         MVI   @AL00001+16,X'80'                                   0669 01984000
         L     @15,GDTGPL(,@02)                                    0669 01985000
         LA    @01,@AL00001                                        0669 01986000
         BALR  @14,@15                                             0669 01987000
*        RESPECIFY RTNREG RSTD;                                    0670 01988000
*        TESTRC = RTNREG;                                          0671 01989000
         LR    TESTRC,RTNREG                                       0671 01990000
*        RESPECIFY RTNREG UNRSTD;                                  0672 01991000
*                                                                  0672 01992000
*        /************************************************************/ 01993000
*        /*                                                  @Y30SSMK*/ 01994000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 01995000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 01996000
*        /*                                                  @Y30SSMK*/ 01997000
*        /************************************************************/ 01998000
*                                                                  0673 01999000
*        IF TESTRC ^= 0                                            0673 02000000
*          THEN                                                    0673 02001000
         LTR   TESTRC,TESTRC                                       0673 02002000
         BZ    @RF00673                                            0673 02003000
*            DO;                                                   0674 02004000
*              ERRARGPT->DARGSMOD = UV0ID;                         0675 02005000
         L     @04,COMSWKPT(,COMPTR)                               0675 02006000
         L     @04,ERRARGPT(,@04)                                  0675 02007000
         MVC   DARGSMOD(3,@04),@CC01149                            0675 02008000
*              ERRARGPT->DARGSENT = UVMSG04;                       0676 02009000
         MVI   DARGSENT(@04),X'04'                                 0676 02010000
*              RETURN CODE (LASTCC12);                             0677 02011000
         LA    @15,12                                              0677 02012000
         L     @14,@SA00002                                        0677 02013000
         LM    @00,@12,@SA00002+8                                  0677 02014000
         BR    @14                                                 0677 02015000
*            END;                                                  0678 02016000
*        IF FPLBEGN = 1                                            0679 02017000
*          THEN                                                    0679 02018000
@RF00673 L     @04,COMVARPT(,COMPTR)                               0679 02019000
         CLC   FPLBEGN(2,@04),@CH00045                             0679 02020000
         BNE   @RF00679                                            0679 02021000
*            SAVFPLPT = CTGFLPTR +                                 0680 02022000
*              (LCFPLLEN * (FPLCNT - 1)) + MTFPLLEN;       /*@Y30LSMK*/ 02023000
         L     @02,COMSWKPT(,COMPTR)                               0680 02024000
         LH    @04,FPLCNT(,@04)                                    0680 02025000
         BCTR  @04,0                                               0680 02026000
         LR    @01,@04                                             0680 02027000
         SLR   @04,@04                                             0680 02028000
         IC    @04,LCFPLLEN(,@02)                                  0680 02029000
         MR    @00,@04                                             0680 02030000
         AL    @01,CTGFLPTR(,@02)                                  0680 02031000
         SLR   @04,@04                                             0680 02032000
         IC    @04,MTFPLLEN(,@02)                                  0680 02033000
         ALR   @01,@04                                             0680 02034000
         ST    @01,SAVFPLPT(,@02)                                  0680 02035000
*          ELSE                                                    0681 02036000
*            SAVFPLPT = CTGFLPTR + (LCFPLLEN * FPLCNT);    /*@Y30LSMK*/ 02037000
         B     @RC00679                                            0681 02038000
@RF00679 L     @04,COMSWKPT(,COMPTR)                               0681 02039000
         L     @02,COMVARPT(,COMPTR)                               0681 02040000
         SLR   @15,@15                                             0681 02041000
         IC    @15,LCFPLLEN(,@04)                                  0681 02042000
         MH    @15,FPLCNT(,@02)                                    0681 02043000
         AL    @15,CTGFLPTR(,@04)                                  0681 02044000
         ST    @15,SAVFPLPT(,@04)                                  0681 02045000
*                                                                  0682 02046000
*        /************************************************************/ 02047000
*        /*                                                          */ 02048000
*        /* BUILD APPROPRIATE FPLS FOR THE REQUESTED LISTING.        */ 02049000
*        /* SETUP EACH FPL TO REFERENCE A SINGLE CATALOG FIELD NAME. */ 02050000
*        /* SAVE THE POINTER OF EACH FPL.  THEN INSERT IN THE CPL    */ 02051000
*        /* THE POINTER TO EACH FPL AND THE FPL COUNT.               */ 02052000
*        /* ALSO STORE A SAVEAREA COPY OF EACH FPL.                  */ 02053000
*        /*                                                          */ 02054000
*        /************************************************************/ 02055000
*                                                                  0682 02056000
*        CTGNOFLD = 0;                                             0682 02057000
@RC00679 L     @04,COMSWKPT(,COMPTR)                               0682 02058000
         L     @01,CTGPLPTR(,@04)                                  0682 02059000
         MVI   CTGNOFLD(@01),X'00'                                 0682 02060000
*        SAPTR = SAVFPLPT;                                         0683 02061000
         L     SAPTR,SAVFPLPT(,@04)                                0683 02062000
*        DO IDX = FPLBEGN TO FPLEND;                               0684 02063000
         L     @01,COMVARPT(,COMPTR)                               0684 02064000
         LH    IDX,FPLBEGN(,@01)                                   0684 02065000
         B     @DE00684                                            0684 02066000
@DL00684 DS    0H                                                  0685 02067000
*          CTGFLDNO = 1;                                           0685 02068000
         L     @15,COMSWKPT(,COMPTR)                               0685 02069000
         L     @14,CTGFLPTR(,@15)                                  0685 02070000
         MVI   CTGFLDNO(@14),X'01'                                 0685 02071000
*          CTGFLDNM = NMPTRS(IDX);                                 0686 02072000
         LR    @07,IDX                                             0686 02073000
         SLA   @07,2                                               0686 02074000
         L     @06,NMPTRS-4(@07)                                   0686 02075000
         ST    @06,CTGFLDNM(,@14)                                  0686 02076000
*          FPLPTMAP(IDX) = CTGFLPTR;                               0687 02077000
         L     @01,COMFPLPT(,COMPTR)                               0687 02078000
         AL    @01,@CF01593                                        0687 02079000
         ST    @14,FPLPTMAP(@07,@01)                               0687 02080000
*          CTGNOFLD = CTGNOFLD + 1;                                0688 02081000
         L     @07,CTGPLPTR(,@15)                                  0688 02082000
         LA    @06,1                                               0688 02083000
         SLR   @01,@01                                             0688 02084000
         IC    @01,CTGNOFLD(,@07)                                  0688 02085000
         ALR   @01,@06                                             0688 02086000
         STC   @01,CTGNOFLD(,@07)                                  0688 02087000
*          CTGFIELD(CTGNOFLD) = CTGFLPTR;                          0689 02088000
*                                                                  0689 02089000
         SLA   @01,2                                               0689 02090000
         ST    @14,CTGFIELD-4(@01,@07)                             0689 02091000
*          /**********************************************************/ 02092000
*          /*                                                @Y30LSMK*/ 02093000
*          /* SINCE THE MULTITYP FPL IS LONGER THAN OTHER    @Y30LSMK*/ 02094000
*          /* FPL'S, IT REQUIRES SPECIAL PROCESSING DURING   @Y30LSMK*/ 02095000
*          /* THE FPL SETUP.                                 @Y30LSMK*/ 02096000
*          /*                                                @Y30LSMK*/ 02097000
*          /**********************************************************/ 02098000
*                                                                  0690 02099000
*          IF IDX = 1                                              0690 02100000
*            THEN                                                  0690 02101000
         CR    IDX,@06                                             0690 02102000
         BNE   @RF00690                                            0690 02103000
*              DO;                                         /*@Y30LSMK*/ 02104000
*                SAPTR->SAVFPL(1:MTFPLLEN) =                       0692 02105000
*                  CTGFL(1:MTFPLLEN);                      /*@Y30LSMK*/ 02106000
         SLR   @07,@07                                             0692 02107000
         IC    @07,MTFPLLEN(,@15)                                  0692 02108000
         LR    @06,@07                                             0692 02109000
         BCTR  @06,0                                               0692 02110000
         EX    @06,@SM01594                                        0692 02111000
*                SAPTR = SAPTR + MTFPLLEN;                 /*@Y30LSMK*/ 02112000
         ALR   SAPTR,@07                                           0693 02113000
*                CTGFLPTR = CTGFLPTR + MTFPLLEN;           /*@Y30LSMK*/ 02114000
         ALR   @14,@07                                             0694 02115000
         ST    @14,CTGFLPTR(,@15)                                  0694 02116000
*              END;                                        /*@Y30LSMK*/ 02117000
*            ELSE                                                  0696 02118000
*              DO;                                         /*@Y30LSMK*/ 02119000
         B     @RC00690                                            0696 02120000
@RF00690 DS    0H                                                  0697 02121000
*                SAPTR->SAVFPL(1:LCFPLLEN) =                       0697 02122000
*                  CTGFL(1:LCFPLLEN);                      /*@Y30LSMK*/ 02123000
         L     @15,COMSWKPT(,COMPTR)                               0697 02124000
         SLR   @14,@14                                             0697 02125000
         IC    @14,LCFPLLEN(,@15)                                  0697 02126000
         LR    @07,@14                                             0697 02127000
         BCTR  @07,0                                               0697 02128000
         L     @06,CTGFLPTR(,@15)                                  0697 02129000
         EX    @07,@SM01596                                        0697 02130000
*                SAPTR = SAPTR + LCFPLLEN;                 /*@Y30LSMK*/ 02131000
         ALR   SAPTR,@14                                           0698 02132000
*                CTGFLPTR = CTGFLPTR + LCFPLLEN;           /*@Y30LSMK*/ 02133000
         ALR   @06,@14                                             0699 02134000
         ST    @06,CTGFLPTR(,@15)                                  0699 02135000
*              END;                                        /*@Y30LSMK*/ 02136000
*        END;                                              /*@Y30LSMK*/ 02137000
@RC00690 AL    IDX,@CF00045                                        0701 02138000
@DE00684 L     @01,COMVARPT(,COMPTR)                               0701 02139000
         CH    IDX,FPLEND(,@01)                                    0701 02140000
         BNH   @DL00684                                            0701 02141000
*        /************************************************************/ 02142000
*        /*                                                          */ 02143000
*        /* SINCE THE NUMBER OF FPLS VARY ACCORDING TO THE TYPE OF   */ 02144000
*        /* SUBSET LISTING, FORCE THE LAST FPL AS THE SPECIAL CATACB */ 02145000
*        /* IF UNKNOWN.                                              */ 02146000
*        /*                                                          */ 02147000
*        /************************************************************/ 02148000
*                                                                  0702 02149000
*        IF CACBFLG = ON                                           0702 02150000
*          THEN                        /*YES CAT ACB IS NEEDED       */ 02151000
         L     @04,COMFLGPT(,COMPTR)                               0702 02152000
         TM    CACBFLG(@04),B'10000000'                            0702 02153000
         BNO   @RF00702                                            0702 02154000
*            DO;                                                   0703 02155000
*              /* POSITION TO THE LAST FPL AND ITS SAVE AREA COPY    */ 02156000
*              CTGFLPTR = CTGFLPTR - LCFPLLEN;                     0704 02157000
         L     @04,COMSWKPT(,COMPTR)                               0704 02158000
         SLR   @15,@15                                             0704 02159000
         IC    @15,LCFPLLEN(,@04)                                  0704 02160000
         L     @14,CTGFLPTR(,@04)                                  0704 02161000
         SLR   @14,@15                                             0704 02162000
         ST    @14,CTGFLPTR(,@04)                                  0704 02163000
*              SAPTR = SAPTR - LCFPLLEN;                           0705 02164000
         SLR   SAPTR,@15                                           0705 02165000
*              /* FORCE LAST FPL AS CATACB FIELD REQUEST             */ 02166000
*              CTGFLDNM = ADDR(CACBNM);                            0706 02167000
         LA    @04,CACBNM                                          0706 02168000
         ST    @04,CTGFLDNM(,@14)                                  0706 02169000
*              SAPTR->CTGFLDNM = ADDR(CACBNM);                     0707 02170000
         ST    @04,CTGFLDNM(,SAPTR)                                0707 02171000
*            END;                                                  0708 02172000
*                                                                  0708 02173000
*        /************************************************************/ 02174000
*        /*                                                  @Y30SSMK*/ 02175000
*        /* IF AN ADDITIONAL FPL IS REQUIRED TO CHECK FOR    @Y30SSMK*/ 02176000
*        /* NOTUSABLE, POSITION TO THE SUBSEQUENT FPL AND    @Y30SSMK*/ 02177000
*        /* FORCE IT TO BE THE DATA SET ATTRIBUTES FPL.      @Y30SSMK*/ 02178000
*        /*                                                  @Y30SSMK*/ 02179000
*        /************************************************************/ 02180000
*                                                                  0709 02181000
*        IF ATFPLFLG = ON                                          0709 02182000
*          THEN                                                    0709 02183000
@RF00702 L     @04,COMFLGPT(,COMPTR)                               0709 02184000
         TM    ATFPLFLG(@04),B'10000000'                           0709 02185000
         BNO   @RF00709                                            0709 02186000
*            DO;                                           /*@Y30SSMK*/ 02187000
*              CTGFLPTR = CTGFLPTR - LCFPLLEN;             /*@Y30SSMK*/ 02188000
         L     @04,COMSWKPT(,COMPTR)                               0711 02189000
         SLR   @15,@15                                             0711 02190000
         IC    @15,LCFPLLEN(,@04)                                  0711 02191000
         L     @14,CTGFLPTR(,@04)                                  0711 02192000
         SLR   @14,@15                                             0711 02193000
         ST    @14,CTGFLPTR(,@04)                                  0711 02194000
*              SAPTR = SAPTR - LCFPLLEN;                   /*@Y30SSMK*/ 02195000
         SLR   SAPTR,@15                                           0712 02196000
*              CTGFLDNM = ADDR(ATTRNM);                    /*@Y30SSMK*/ 02197000
         LA    @04,ATTRNM                                          0713 02198000
         ST    @04,CTGFLDNM(,@14)                                  0713 02199000
*              SAPTR->CTGFLDNM = ADDR(ATTRNM);             /*@Y30SSMK*/ 02200000
         ST    @04,CTGFLDNM(,SAPTR)                                0714 02201000
*            END;                                          /*@Y30SSMK*/ 02202000
*                                                                  0715 02203000
*        /************************************************************/ 02204000
*        /*                                                  @Y30LSMK*/ 02205000
*        /* IF ADDITIONAL FPL'S ARE REQUIRED TO CHECK THE    @Y30LSMK*/ 02206000
*        /* CREATION AND EXPIRATION DATES, POSITION TO THE   @Y30LSMK*/ 02207000
*        /* SUBSEQUENT FPL'S FORCE THEM TO BE THE CREATION,  @Y30LSMK*/ 02208000
*        /* EXPIRATION, AND VOLUME TIME STAMP FPL'S.         @Y30LSMK*/ 02209000
*        /*                                                  @Y30LSMK*/ 02210000
*        /************************************************************/ 02211000
*                                                                  0716 02212000
*        IF VTFPLFLG = ON                                          0716 02213000
*          THEN                                                    0716 02214000
@RF00709 L     @04,COMFLGPT(,COMPTR)                               0716 02215000
         TM    VTFPLFLG(@04),B'10000000'                           0716 02216000
         BNO   @RF00716                                            0716 02217000
*            DO;                                           /*@Y30LSMK*/ 02218000
*              CTGFLPTR = CTGFLPTR - LCFPLLEN;             /*@Y30LSMK*/ 02219000
         L     @04,COMSWKPT(,COMPTR)                               0718 02220000
         SLR   @15,@15                                             0718 02221000
         IC    @15,LCFPLLEN(,@04)                                  0718 02222000
         L     @14,CTGFLPTR(,@04)                                  0718 02223000
         SLR   @14,@15                                             0718 02224000
         ST    @14,CTGFLPTR(,@04)                                  0718 02225000
*              SAPTR = SAPTR - LCFPLLEN;                   /*@Y30LSMK*/ 02226000
         SLR   SAPTR,@15                                           0719 02227000
*              CTGFLDNM = ADDR(VTIMENM);                   /*@Y30LSMK*/ 02228000
         LA    @07,VTIMENM                                         0720 02229000
         ST    @07,CTGFLDNM(,@14)                                  0720 02230000
*              SAPTR->CTGFLDNM = ADDR(VTIMENM);            /*@Y30LSMK*/ 02231000
         ST    @07,CTGFLDNM(,SAPTR)                                0721 02232000
*              CTGFLPTR = CTGFLPTR - LCFPLLEN;             /*@Y30LSMK*/ 02233000
         SLR   @14,@15                                             0722 02234000
         ST    @14,CTGFLPTR(,@04)                                  0722 02235000
*              SAPTR = SAPTR - LCFPLLEN;                   /*@Y30LSMK*/ 02236000
         SLR   SAPTR,@15                                           0723 02237000
*              CTGFLDNM = ADDR(VSPHDRNM);                  /*@Y30LSMK*/ 02238000
         LA    @04,VSPHDRNM                                        0724 02239000
         ST    @04,CTGFLDNM(,@14)                                  0724 02240000
*              SAPTR->CTGFLDNM = ADDR(VSPHDRNM);           /*@Y30LSMK*/ 02241000
         ST    @04,CTGFLDNM(,SAPTR)                                0725 02242000
*            END;                                          /*@Y30LSMK*/ 02243000
*        IF CRFPLFLG = ON                                          0727 02244000
*          THEN                                                    0727 02245000
@RF00716 L     @04,COMFLGPT(,COMPTR)                               0727 02246000
         TM    CRFPLFLG(@04),B'10000000'                           0727 02247000
         BNO   @RF00727                                            0727 02248000
*            DO;                                           /*@Y30LSMK*/ 02249000
*              CTGFLPTR = CTGFLPTR - LCFPLLEN;             /*@Y30LSMK*/ 02250000
         L     @04,COMSWKPT(,COMPTR)                               0729 02251000
         SLR   @15,@15                                             0729 02252000
         IC    @15,LCFPLLEN(,@04)                                  0729 02253000
         L     @14,CTGFLPTR(,@04)                                  0729 02254000
         SLR   @14,@15                                             0729 02255000
         ST    @14,CTGFLPTR(,@04)                                  0729 02256000
*              SAPTR = SAPTR - LCFPLLEN;                   /*@Y30LSMK*/ 02257000
         SLR   SAPTR,@15                                           0730 02258000
*              CTGFLDNM = ADDR(CRDTNM);                    /*@Y30LSMK*/ 02259000
         LA    @04,CRDTNM                                          0731 02260000
         ST    @04,CTGFLDNM(,@14)                                  0731 02261000
*              SAPTR->CTGFLDNM = ADDR(CRDTNM);             /*@Y30LSMK*/ 02262000
         ST    @04,CTGFLDNM(,SAPTR)                                0732 02263000
*            END;                                          /*@Y30LSMK*/ 02264000
*        IF EXFPLFLG = ON                                          0734 02265000
*          THEN                                                    0734 02266000
@RF00727 L     @04,COMFLGPT(,COMPTR)                               0734 02267000
         TM    EXFPLFLG(@04),B'10000000'                           0734 02268000
         BNO   @RF00734                                            0734 02269000
*            DO;                                           /*@Y30LSMK*/ 02270000
*              CTGFLPTR = CTGFLPTR - LCFPLLEN;             /*@Y30LSMK*/ 02271000
         L     @04,COMSWKPT(,COMPTR)                               0736 02272000
         SLR   @15,@15                                             0736 02273000
         IC    @15,LCFPLLEN(,@04)                                  0736 02274000
         L     @14,CTGFLPTR(,@04)                                  0736 02275000
         SLR   @14,@15                                             0736 02276000
         ST    @14,CTGFLPTR(,@04)                                  0736 02277000
*              SAPTR = SAPTR - LCFPLLEN;                   /*@Y30LSMK*/ 02278000
         SLR   SAPTR,@15                                           0737 02279000
*              CTGFLDNM = ADDR(EXDTNM);                    /*@Y30LSMK*/ 02280000
         LA    @04,EXDTNM                                          0738 02281000
         ST    @04,CTGFLDNM(,@14)                                  0738 02282000
*              SAPTR->CTGFLDNM = ADDR(EXDTNM);             /*@Y30LSMK*/ 02283000
         ST    @04,CTGFLDNM(,SAPTR)                                0739 02284000
*            END;                                          /*@Y30LSMK*/ 02285000
*        /************************************************************/ 02286000
*        /*                                                  @Y30LSMK*/ 02287000
*        /* INITIALIZE THE SPECIAL FPL - MULTITYP AND ITS SAVEAREA.  */ 02288000
*        /* THIS FPL WILL HAVE 4 POINTER AND LENGTH FIELDS   @Y30LSMK*/ 02289000
*        /* AND WILL BE INITIALIZED AS FOLLOWS -             @Y30LSMK*/ 02290000
*        /*     1. TYPE CODE TEST.                           @Y30LSMK*/ 02291000
*        /*     2. NOTUSABLE TEST.                           @Y30SSMK*/ 02292000
*        /*     3. CREATION DATE TEST.                       @Y30LSMK*/ 02293000
*        /*     4. EXPIRATION DATE TEST.                     @Y30LSMK*/ 02294000
*        /*                                                  @Y30LSMK*/ 02295000
*        /************************************************************/ 02296000
*                                                                  0741 02297000
*        IF FPLBEGN = 1                                            0741 02298000
*          THEN                        /*YES, MULTITYP FPL IS NEEDED */ 02299000
@RF00734 L     @04,COMVARPT(,COMPTR)                               0741 02300000
         CLC   FPLBEGN(2,@04),@CH00045                             0741 02301000
         BNE   @RF00741                                            0741 02302000
*            DO;                                                   0742 02303000
*              CTGFLPTR = MULTIFPT;                                0743 02304000
         L     @02,COMSWKPT(,COMPTR)                               0743 02305000
         L     @01,COMFPLPT(,COMPTR)                               0743 02306000
         L     @15,MULTIFPT(,@01)                                  0743 02307000
         ST    @15,CTGFLPTR(,@02)                                  0743 02308000
*              CTGFLDNO = MULFLDNO;                        /*@Y30SSMK*/ 02309000
         MVI   CTGFLDNO(@15),X'04'                                 0744 02310000
*              SAVFPLPT->CTGFLDNO = MULFLDNO;              /*@Y30SSMK*/ 02311000
         L     @02,SAVFPLPT(,@02)                                  0745 02312000
         MVI   CTGFLDNO(@02),X'04'                                 0745 02313000
*              IF TYPECNT > 0                                      0746 02314000
*                THEN                                              0746 02315000
         LH    @14,TYPECNT(,@04)                                   0746 02316000
         LTR   @14,@14                                             0746 02317000
         BNP   @RF00746                                            0746 02318000
*                  DO;                                     /*@Y30LSMK*/ 02319000
*                    CTGFLNG(1) = TYPECNT + LENGTH(TYPECNT);       0748 02320000
         AL    @14,@CF00161                                        0748 02321000
         ST    @14,CTGFLNG(,@15)                                   0748 02322000
*                    CTGFLPT(1) = ADDR(TYPMULTI);                  0749 02323000
         LA    @04,TYPMULTI(,@04)                                  0749 02324000
         ST    @04,CTGFLPT(,@15)                                   0749 02325000
*                    SAVFPLPT->CTGFLNG(1) = CTGFLPTR->CTGFLNG(1);  0750 02326000
         L     @15,CTGFLNG(,@15)                                   0750 02327000
         ST    @15,CTGFLNG(,@02)                                   0750 02328000
*                    SAVFPLPT->CTGFLPT(1) = ADDR(TYPMULTI);        0751 02329000
         ST    @04,CTGFLPT(,@02)                                   0751 02330000
*                  END;                                    /*@Y30LSMK*/ 02331000
*              IF NUSEFLG = ON                                     0753 02332000
*                THEN                                              0753 02333000
@RF00746 L     @04,COMFLGPT(,COMPTR)                               0753 02334000
         TM    NUSEFLG(@04),B'10000000'                            0753 02335000
         BNO   @RF00753                                            0753 02336000
*                  DO;                                     /*@Y30SSMK*/ 02337000
*                    CTGFLNG(2) = LENGTH(NUSMULTI);        /*@Y30SSMK*/ 02338000
         L     @04,COMSWKPT(,COMPTR)                               0755 02339000
         L     @02,CTGFLPTR(,@04)                                  0755 02340000
         MVC   CTGFLNG+8(4,@02),@CF00045                           0755 02341000
*                    CTGFLPT(2) = ADDR(NUSMULTI);          /*@Y30SSMK*/ 02342000
         LA    @15,@CH00045+1                                      0756 02343000
         ST    @15,CTGFLPT+8(,@02)                                 0756 02344000
*                    SAVFPLPT->CTGFLNG(2) =                        0757 02345000
*                      CTGFLPTR->CTGFLNG(2);               /*@Y30SSMK*/ 02346000
         L     @04,SAVFPLPT(,@04)                                  0757 02347000
         L     @02,CTGFLNG+8(,@02)                                 0757 02348000
         ST    @02,CTGFLNG+8(,@04)                                 0757 02349000
*                    SAVFPLPT->CTGFLPT(2) =                        0758 02350000
*                      ADDR(NUSMULTI);                     /*@Y30SSMK*/ 02351000
         ST    @15,CTGFLPT+8(,@04)                                 0758 02352000
*                  END;                                    /*@Y30SSMK*/ 02353000
*              IF ADDR(CREAT) > NULLPTR                            0760 02354000
*                THEN                                              0760 02355000
@RF00753 L     @04,@PC00001+4                                      0760 02356000
         L     @04,FDTPTR+96(,@04)                                 0760 02357000
         LTR   @04,@04                                             0760 02358000
         BNP   @RF00760                                            0760 02359000
*                  DO;                                     /*@Y30LSMK*/ 02360000
*                    CTGFLNG(3) = LENGTH(CDTMULTI);        /*@Y30LSMK*/ 02361000
         L     @04,COMSWKPT(,COMPTR)                               0762 02362000
         L     @02,CTGFLPTR(,@04)                                  0762 02363000
         MVC   CTGFLNG+16(4,@02),@CF00170                          0762 02364000
*                    CTGFLPT(3) = ADDR(CDTMULTI);          /*@Y30LSMK*/ 02365000
         LA    @15,CDTMULTI                                        0763 02366000
         ST    @15,CTGFLPT+16(,@02)                                0763 02367000
*                    SAVFPLPT->CTGFLNG(3) =                        0764 02368000
*                      CTGFLPTR->CTGFLNG(3);               /*@Y30LSMK*/ 02369000
         L     @04,SAVFPLPT(,@04)                                  0764 02370000
         L     @02,CTGFLNG+16(,@02)                                0764 02371000
         ST    @02,CTGFLNG+16(,@04)                                0764 02372000
*                    SAVFPLPT->CTGFLPT(3) =                        0765 02373000
*                      ADDR(CDTMULTI);                     /*@Y30LSMK*/ 02374000
         ST    @15,CTGFLPT+16(,@04)                                0765 02375000
*                  END;                                    /*@Y30LSMK*/ 02376000
*              IF ADDR(EXPIR) > NULLPTR                            0767 02377000
*                THEN                                              0767 02378000
@RF00760 L     @04,@PC00001+4                                      0767 02379000
         L     @04,FDTPTR+100(,@04)                                0767 02380000
         LTR   @04,@04                                             0767 02381000
         BNP   @RF00767                                            0767 02382000
*                  DO;                                     /*@Y30LSMK*/ 02383000
*                    CTGFLNG(4) = LENGTH(EXPMULTI);        /*@Y30LSMK*/ 02384000
         L     @04,COMSWKPT(,COMPTR)                               0769 02385000
         L     @02,CTGFLPTR(,@04)                                  0769 02386000
         MVC   CTGFLNG+24(4,@02),@CF00170                          0769 02387000
*                    CTGFLPT(4) = ADDR(EXPMULTI);          /*@Y30LSMK*/ 02388000
         LA    @15,EXPMULTI                                        0770 02389000
         ST    @15,CTGFLPT+24(,@02)                                0770 02390000
*                    SAVFPLPT->CTGFLNG(4) =                        0771 02391000
*                      CTGFLPTR->CTGFLNG(4);               /*@Y30LSMK*/ 02392000
         L     @04,SAVFPLPT(,@04)                                  0771 02393000
         L     @02,CTGFLNG+24(,@02)                                0771 02394000
         ST    @02,CTGFLNG+24(,@04)                                0771 02395000
*                    SAVFPLPT->CTGFLPT(4) =                        0772 02396000
*                      ADDR(EXPMULTI);                     /*@Y30LSMK*/ 02397000
         ST    @15,CTGFLPT+24(,@04)                                0772 02398000
*                  END;                                    /*@Y30LSMK*/ 02399000
*            END;                                          /*@Y30LSMK*/ 02400000
@RF00767 DS    0H                                                  0775 02401000
*                                                                  0775 02402000
*        /************************************************************/ 02403000
*        /*                                                          */ 02404000
*        /* GET STORAGE FOR THE MINIMUM BYTES REQUIRED FOR A WORKAREA*/ 02405000
*        /* USED IN THE                                              */ 02406000
*        /* RETRIEVAL OF ALL CATALOG DICTIONARY FIELDS DURING ANY    */ 02407000
*        /* SINGLE LOCATE REQUEST.                                   */ 02408000
*        /*                                                          */ 02409000
*        /************************************************************/ 02410000
*                                                                  0775 02411000
*        GPID = GPID02;                                            0775 02412000
@RF00741 MVC   GPID(4),@CC01249                                    0775 02413000
*        GPLEN = DICTSZ + WKLENFLD;    /* INCLUDE 2 LENGTH FIELDS    */ 02414000
*                                                                  0776 02415000
         LA    @02,4                                               0776 02416000
         AL    @02,DICTSZ                                          0776 02417000
         ST    @02,GPLEN                                           0776 02418000
*        CALL IDCSAGP0(GDTTBL,                                     0777 02419000
*               GPLEN,                                             0777 02420000
*               CTGWKA,                                            0777 02421000
*               GPID,                                              0777 02422000
*               SETZERO);                                          0777 02423000
         L     @02,@PC00001                                        0777 02424000
         ST    @02,@AL00001                                        0777 02425000
         LA    @15,GPLEN                                           0777 02426000
         ST    @15,@AL00001+4                                      0777 02427000
         L     @01,COMSWKPT(,COMPTR)                               0777 02428000
         L     @01,CTGPLPTR(,@01)                                  0777 02429000
         LA    @15,CTGWKA(,@01)                                    0777 02430000
         ST    @15,@AL00001+8                                      0777 02431000
         LA    @15,GPID                                            0777 02432000
         ST    @15,@AL00001+12                                     0777 02433000
         LA    @15,SETZERO                                         0777 02434000
         ST    @15,@AL00001+16                                     0777 02435000
         MVI   @AL00001+16,X'80'                                   0777 02436000
         L     @15,GDTGPL(,@02)                                    0777 02437000
         LA    @01,@AL00001                                        0777 02438000
         BALR  @14,@15                                             0777 02439000
*        RESPECIFY RTNREG RSTD;                                    0778 02440000
*        TESTRC = RTNREG;                                          0779 02441000
         LR    TESTRC,RTNREG                                       0779 02442000
*        RESPECIFY RTNREG UNRSTD;                                  0780 02443000
*                                                                  0780 02444000
*        /************************************************************/ 02445000
*        /*                                                  @Y30SSMK*/ 02446000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02447000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02448000
*        /*                                                  @Y30SSMK*/ 02449000
*        /************************************************************/ 02450000
*                                                                  0781 02451000
*        IF TESTRC ^= 0                                            0781 02452000
*          THEN                                                    0781 02453000
         LTR   TESTRC,TESTRC                                       0781 02454000
         BZ    @RF00781                                            0781 02455000
*            DO;                                                   0782 02456000
*              ERRARGPT->DARGSMOD = UV0ID;                         0783 02457000
         L     @04,COMSWKPT(,COMPTR)                               0783 02458000
         L     @04,ERRARGPT(,@04)                                  0783 02459000
         MVC   DARGSMOD(3,@04),@CC01149                            0783 02460000
*              ERRARGPT->DARGSENT = UVMSG04;                       0784 02461000
         MVI   DARGSENT(@04),X'04'                                 0784 02462000
*              RETURN CODE(LASTCC12);                              0785 02463000
         LA    @15,12                                              0785 02464000
         L     @14,@SA00002                                        0785 02465000
         LM    @00,@12,@SA00002+8                                  0785 02466000
         BR    @14                                                 0785 02467000
*            END;                                                  0786 02468000
*        CPLWKASZ = GPLEN;             /*SET AS 1ST WKA LEN FIELD    */ 02469000
@RF00781 L     @02,COMSWKPT(,COMPTR)                               0787 02470000
         L     @01,CTGPLPTR(,@02)                                  0787 02471000
         L     @01,CTGWKA(,@01)                                    0787 02472000
         L     @00,GPLEN                                           0787 02473000
         STH   @00,CPLWKASZ(,@01)                                  0787 02474000
*        /************************************************************/ 02475000
*        /*                                                          */ 02476000
*        /* OBTAIN STORAGE FOR A SEPARATE CPL USED ONLY TO RETRIEVE  */ 02477000
*        /* AN ASSOCIATED DATASET NAME VIA A LOCATE ON ITS C.I.NO.   */ 02478000
*        /* SINCE THE CPL IS NOT A READ-ONLY PARM LIST, GET          */ 02479000
*        /* ADDITIONAL STORAGE FOR A SAVE AREA COPY.                 */ 02480000
*        /* ALSO OBTAIN STORAGE FOR AN ADDITIONAL SAVEAREA SHOULD    */ 02481000
*        /* A CATALOG ERROR OCCUR SINCE THE CALL TO UERROR REQUIRES  */ 02482000
*        /* THE CPL INITIALIZED WITH THE VSAM ERROR REASON CODE.     */ 02483000
*        /* NOTE: A SECOND FPL IS NEEDED FOR THE PAGESPACE ATTRIBUTE */ 02484000
*        /*                                                          */ 02485000
*        /************************************************************/ 02486000
*                                                                  0788 02487000
*        GPID = GPID03;                                            0788 02488000
         MVC   GPID(4),@CC01251                                    0788 02489000
*        LC#CPLLN = LENGTH(CTGPL) + LC#PTLEN;/*                    0789 02490000
*                                          ENTRYNAME & CATTR   & ASSOC  02491000
*                                          FPL ADDR          @Y30SSMK*/ 02492000
         LA    @15,40                                              0789 02493000
         STH   @15,LC#CPLLN(,@02)                                  0789 02494000
*        GPLEN = STORCNT3 * LC#CPLLN;                      /*@Y30SSMK*/ 02495000
*                                                                  0790 02496000
         MH    @15,@CH00170                                        0790 02497000
         ST    @15,GPLEN                                           0790 02498000
*        CALL IDCSAGP0(GDTTBL,                                     0791 02499000
*               GPLEN,                                             0791 02500000
*               GPPTR,                                             0791 02501000
*               GPID,                                              0791 02502000
*               SETZERO);                                          0791 02503000
         L     @02,@PC00001                                        0791 02504000
         ST    @02,@AL00001                                        0791 02505000
         LA    @15,GPLEN                                           0791 02506000
         ST    @15,@AL00001+4                                      0791 02507000
         LA    @15,GPPTR                                           0791 02508000
         ST    @15,@AL00001+8                                      0791 02509000
         LA    @15,GPID                                            0791 02510000
         ST    @15,@AL00001+12                                     0791 02511000
         LA    @15,SETZERO                                         0791 02512000
         ST    @15,@AL00001+16                                     0791 02513000
         MVI   @AL00001+16,X'80'                                   0791 02514000
         L     @15,GDTGPL(,@02)                                    0791 02515000
         LA    @01,@AL00001                                        0791 02516000
         BALR  @14,@15                                             0791 02517000
*        RESPECIFY RTNREG RSTD;                                    0792 02518000
*        TESTRC = RTNREG;                                          0793 02519000
         LR    TESTRC,RTNREG                                       0793 02520000
*        RESPECIFY RTNREG UNRSTD;                                  0794 02521000
*                                                                  0794 02522000
*        /************************************************************/ 02523000
*        /*                                                  @Y30SSMK*/ 02524000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02525000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02526000
*        /*                                                  @Y30SSMK*/ 02527000
*        /************************************************************/ 02528000
*                                                                  0795 02529000
*        IF TESTRC ^= 0                                            0795 02530000
*          THEN                                                    0795 02531000
         LTR   TESTRC,TESTRC                                       0795 02532000
         BZ    @RF00795                                            0795 02533000
*            DO;                                                   0796 02534000
*              ERRARGPT->DARGSMOD = UV0ID;                         0797 02535000
         L     @04,COMSWKPT(,COMPTR)                               0797 02536000
         L     @04,ERRARGPT(,@04)                                  0797 02537000
         MVC   DARGSMOD(3,@04),@CC01149                            0797 02538000
*              ERRARGPT->DARGSENT = UVMSG04;                       0798 02539000
         MVI   DARGSENT(@04),X'04'                                 0798 02540000
*              RETURN CODE (LASTCC12);                             0799 02541000
         LA    @15,12                                              0799 02542000
         L     @14,@SA00002                                        0799 02543000
         LM    @00,@12,@SA00002+8                                  0799 02544000
         BR    @14                                                 0799 02545000
*            END;                                                  0800 02546000
*        CI#CPLPT = GPPTR;                                         0801 02547000
@RF00795 L     @02,GPPTR                                           0801 02548000
         L     @15,COMSWKPT(,COMPTR)                               0801 02549000
         ST    @02,CI#CPLPT(,@15)                                  0801 02550000
*        SA#CPLPT = GPPTR + LC#CPLLN;  /*SAVE AREA POINTER           */ 02551000
         LH    @14,LC#CPLLN(,@15)                                  0802 02552000
         ALR   @02,@14                                             0802 02553000
         ST    @02,SA#CPLPT(,@15)                                  0802 02554000
*        ER#CPLPT = SA#CPLPT + LC#CPLLN;                   /*@Y30SSMK*/ 02555000
         ALR   @02,@14                                             0803 02556000
         ST    @02,ER#CPLPT(,@15)                                  0803 02557000
*        /************************************************************/ 02558000
*        /*                                                          */ 02559000
*        /* GET STORAGE FOR A SEPARATE WORKAREA USED IN THE RETRIEVAL*/ 02560000
*        /* OF ASSOCIATED DATASET NAMES OR THE DATASET NAMES FOR THE */ 02561000
*        /* SPACE DIRECTORY.                                         */ 02562000
*        /* ENTRY TYPE OR CLUSTER ATTRIBUTES AND THREE TYPE AND      */ 02563000
*        /* CI# FIELDS (ALIAS) MAY ALSO BE RETURNED.         @YL026UE*/ 02564000
*        /*                                                          */ 02565000
*        /************************************************************/ 02566000
*                                                                  0804 02567000
*        GPID = GPID04;                                            0804 02568000
         MVC   GPID(4),@CC01253                                    0804 02569000
*        GPLEN = LENGTH(ENT44) + LENGTH(ETYP) + ENTCILEN;  /*@Y30SSMK*/ 02570000
*                                                                  0805 02571000
         MVC   GPLEN(4),@CF01581                                   0805 02572000
*        CALL IDCSAGP0 (GDTTBL,                                    0806 02573000
*                GPLEN,                                            0806 02574000
*                ENTWKAPT,                                         0806 02575000
*                GPID,                                             0806 02576000
*                SETZERO);                                         0806 02577000
         L     @02,@PC00001                                        0806 02578000
         ST    @02,@AL00001                                        0806 02579000
         LA    @14,GPLEN                                           0806 02580000
         ST    @14,@AL00001+4                                      0806 02581000
         LA    @15,ENTWKAPT(,@15)                                  0806 02582000
         ST    @15,@AL00001+8                                      0806 02583000
         LA    @15,GPID                                            0806 02584000
         ST    @15,@AL00001+12                                     0806 02585000
         LA    @15,SETZERO                                         0806 02586000
         ST    @15,@AL00001+16                                     0806 02587000
         MVI   @AL00001+16,X'80'                                   0806 02588000
         L     @15,GDTGPL(,@02)                                    0806 02589000
         LA    @01,@AL00001                                        0806 02590000
         BALR  @14,@15                                             0806 02591000
*        RESPECIFY RTNREG RSTD;                                    0807 02592000
*        TESTRC = RTNREG;                                          0808 02593000
         LR    TESTRC,RTNREG                                       0808 02594000
*        RESPECIFY RTNREG UNRSTD;                                  0809 02595000
*                                                                  0809 02596000
*        /************************************************************/ 02597000
*        /*                                                  @Y30SSMK*/ 02598000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02599000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02600000
*        /*                                                  @Y30SSMK*/ 02601000
*        /************************************************************/ 02602000
*                                                                  0810 02603000
*        IF TESTRC ^= 0                                            0810 02604000
*          THEN                                                    0810 02605000
         LTR   TESTRC,TESTRC                                       0810 02606000
         BZ    @RF00810                                            0810 02607000
*            DO;                                                   0811 02608000
*              ERRARGPT->DARGSMOD = UV0ID;                         0812 02609000
         L     @04,COMSWKPT(,COMPTR)                               0812 02610000
         L     @04,ERRARGPT(,@04)                                  0812 02611000
         MVC   DARGSMOD(3,@04),@CC01149                            0812 02612000
*              ERRARGPT->DARGSENT = UVMSG04;                       0813 02613000
         MVI   DARGSENT(@04),X'04'                                 0813 02614000
*              RETURN CODE (LASTCC12);                             0814 02615000
         LA    @15,12                                              0814 02616000
         L     @14,@SA00002                                        0814 02617000
         LM    @00,@12,@SA00002+8                                  0814 02618000
         BR    @14                                                 0814 02619000
*            END;                                                  0815 02620000
*        ENTSETSZ = GPLEN;             /*SET AS 1ST WKA LEN FIELD    */ 02621000
@RF00810 L     @02,COMSWKPT(,COMPTR)                               0816 02622000
         L     @15,ENTWKAPT(,@02)                                  0816 02623000
         L     @14,GPLEN                                           0816 02624000
         STH   @14,ENTSETSZ(,@15)                                  0816 02625000
*        /************************************************************/ 02626000
*        /*                                                          */ 02627000
*        /* INITIALIZE THE CPL USED TO RETRIEVE ENTRY NAMES.         */ 02628000
*        /*                                                          */ 02629000
*        /************************************************************/ 02630000
*                                                                  0817 02631000
*        RESPECIFY CTGPL BASED(CI#CPLPT);                          0817 02632000
*        CTGNAME = OFF;                /* CINO. PTR TO BE FURNISHED  */ 02633000
*        CTGCNAME = OFF;               /*CAT ACB PTR                 */ 02634000
         L     @14,CI#CPLPT(,@02)                                  0819 02635000
         NI    CTGNAME(@14),B'11111001'                            0819 02636000
*        CTGGTNXT = OFF;               /*SINGLE ENTRY PROCESSING     */ 02637000
         NI    CTGGTNXT(@14),B'11101111'                           0820 02638000
*        CTGAM0 = ON;                  /*AM0 REQUEST                 */ 02639000
         OI    CTGAM0(@14),B'00000001'                             0821 02640000
*        CTGFUNC = CTGCMS;             /*CMS REQUEST                 */ 02641000
         NI    CTGFUNC(@14),B'10011111'                            0822 02642000
         OI    CTGFUNC(@14),B'10000000'                            0822 02643000
*        CTGOPTNS = CTGLTCAT;          /*AMS LISTCAT REQUEST         */ 02644000
         NI    CTGOPTNS(@14),B'00100111'                           0823 02645000
         OI    CTGOPTNS(@14),B'00100000'                           0823 02646000
*        CTGCAT = CTGPLPTR->CTGCAT;    /*CAT ACB POINTER             */ 02647000
         L     @01,CTGPLPTR(,@02)                                  0824 02648000
         L     @07,CTGCAT(,@01)                                    0824 02649000
         ST    @07,CTGCAT(,@14)                                    0824 02650000
*        CTGWKA = ENTWKAPT;            /*CAT WORKAREA POINTER        */ 02651000
         ST    @15,CTGWKA(,@14)                                    0825 02652000
*        CTGFIELD(1) = ENT44FPT;       /*ADDR OF ENTRYNAME FPL       */ 02653000
         L     @01,COMFPLPT(,COMPTR)                               0826 02654000
         L     @15,ENT44FPT(,@01)                                  0826 02655000
         ST    @15,CTGFIELD(,@14)                                  0826 02656000
*        CTGNOFLD = 1;                 /*ONLY 1 FPL SETUP            */ 02657000
         MVI   CTGNOFLD(@14),X'01'                                 0827 02658000
*        RESPECIFY CTGPL BASED(CTGPLPTR);                          0828 02659000
*                                                                  0829 02660000
*        /************************************************************/ 02661000
*        /*                                                          */ 02662000
*        /* OBTAIN STORAGE FOR STRING OF 25 ASSOCIATED DATASET       */ 02663000
*        /* CONTROL INTERVAL NUMBERS AND TYPE CODES.  THIS SAVE AREA */ 02664000
*        /* FOR ASSOCIATED DATASET INFORMATION ALLOWS SUBSEQUENT     */ 02665000
*        /* LOCATES VIA C.I.NO. FOR CLUSTER/AIX/PGSPC/GDG    @Y30SSMK*/ 02666000
*        /* GROUPING TO THE OUTPUT DATASET.                  @Y30SSMK*/ 02667000
*        /* (NOTE - THIS STORAGE REQUEST PROVIDES THE FACILITY TO    */ 02668000
*        /* EXPAND STORAGE AS THE DEFINITION OF ASSOCIATED DATASETS  */ 02669000
*        /* EXPANDS.)                                                */ 02670000
*        /*                                                          */ 02671000
*        /************************************************************/ 02672000
*                                                                  0829 02673000
*        GPID = GPID05;                                            0829 02674000
         MVC   GPID(4),@CC01255                                    0829 02675000
*        CILSTLEN = ASSOCLEN;                              /*@Y30SSMK*/ 02676000
*                                                                  0830 02677000
         MVC   CILSTLEN(4,@02),@CF00155                            0830 02678000
*        CALL IDCSAGP0(GDTTBL,                                     0831 02679000
*               CILSTLEN,                                          0831 02680000
*               CILSTPTR,                                          0831 02681000
*               GPID,                                              0831 02682000
*               SETZERO);                                          0831 02683000
         L     @15,@PC00001                                        0831 02684000
         ST    @15,@AL00001                                        0831 02685000
         LA    @14,CILSTLEN(,@02)                                  0831 02686000
         ST    @14,@AL00001+4                                      0831 02687000
         LA    @02,CILSTPTR(,@02)                                  0831 02688000
         ST    @02,@AL00001+8                                      0831 02689000
         LA    @02,GPID                                            0831 02690000
         ST    @02,@AL00001+12                                     0831 02691000
         LA    @02,SETZERO                                         0831 02692000
         ST    @02,@AL00001+16                                     0831 02693000
         MVI   @AL00001+16,X'80'                                   0831 02694000
         L     @15,GDTGPL(,@15)                                    0831 02695000
         LA    @01,@AL00001                                        0831 02696000
         BALR  @14,@15                                             0831 02697000
*        RESPECIFY RTNREG RSTD;                                    0832 02698000
*        TESTRC = RTNREG;                                          0833 02699000
         LR    TESTRC,RTNREG                                       0833 02700000
*        RESPECIFY RTNREG UNRSTD;                                  0834 02701000
*                                                                  0834 02702000
*        /************************************************************/ 02703000
*        /*                                                  @Y30SSMK*/ 02704000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02705000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02706000
*        /*                                                  @Y30SSMK*/ 02707000
*        /************************************************************/ 02708000
*                                                                  0835 02709000
*        IF TESTRC ^= 0                                            0835 02710000
*          THEN                                                    0835 02711000
         LTR   TESTRC,TESTRC                                       0835 02712000
         BZ    @RF00835                                            0835 02713000
*            DO;                                                   0836 02714000
*              ERRARGPT->DARGSMOD = UV0ID;                         0837 02715000
         L     @04,COMSWKPT(,COMPTR)                               0837 02716000
         L     @04,ERRARGPT(,@04)                                  0837 02717000
         MVC   DARGSMOD(3,@04),@CC01149                            0837 02718000
*              ERRARGPT->DARGSENT = UVMSG04;                       0838 02719000
         MVI   DARGSENT(@04),X'04'                                 0838 02720000
*              RETURN CODE (LASTCC12);                             0839 02721000
         LA    @15,12                                              0839 02722000
         L     @14,@SA00002                                        0839 02723000
         LM    @00,@12,@SA00002+8                                  0839 02724000
         BR    @14                                                 0839 02725000
*            END;                                                  0840 02726000
*        /************************************************************/ 02727000
*        /*                                                  @Y30SSMK*/ 02728000
*        /* OBTAIN STORAGE FOR STRING OF 25 ASSOCIATED DATASET       */ 02729000
*        /* CONTROL INTERVAL NUMBERS AND TYPE CODES.  THIS SAVE AREA */ 02730000
*        /* FOR ASSOCIATED DATASET INFORMATION ALLOWS SUBSEQUENT     */ 02731000
*        /* LOCATES VIA C.I.NO. FOR DATA/INDEX/PATH/NVSAM    @Y30SSMK*/ 02732000
*        /* GROUPING TO THE OUTPUT DATASET.                  @Y30SSMK*/ 02733000
*        /* (NOTE - THIS STORAGE REQUEST PROVIDES THE FACILITY TO    */ 02734000
*        /* EXPAND STORAGE AS THE DEFINITION OF ASSOCIATED DATASETS  */ 02735000
*        /* EXPANDS.)                                        @Y30SSMK*/ 02736000
*        /*                                                  @Y30SSMK*/ 02737000
*        /************************************************************/ 02738000
*                                                                  0841 02739000
*        GPID = GPID11;                                    /*@Y30SSMK*/ 02740000
@RF00835 MVC   GPID(4),@CC01263                                    0841 02741000
*        CIASOCLN = ASSOCLEN;                              /*@Y30SSMK*/ 02742000
*                                                                  0842 02743000
         L     @02,COMSWKPT(,COMPTR)                               0842 02744000
         MVC   CIASOCLN(4,@02),@CF00155                            0842 02745000
*        CALL IDCSAGP0(GDTTBL,                                     0843 02746000
*               CIASOCLN,                                          0843 02747000
*               CIASOCPT,                                          0843 02748000
*               GPID,                                              0843 02749000
*               SETZERO);                                  /*@Y30SSMK*/ 02750000
         L     @15,@PC00001                                        0843 02751000
         ST    @15,@AL00001                                        0843 02752000
         LA    @14,CIASOCLN(,@02)                                  0843 02753000
         ST    @14,@AL00001+4                                      0843 02754000
         LA    @02,CIASOCPT(,@02)                                  0843 02755000
         ST    @02,@AL00001+8                                      0843 02756000
         LA    @02,GPID                                            0843 02757000
         ST    @02,@AL00001+12                                     0843 02758000
         LA    @02,SETZERO                                         0843 02759000
         ST    @02,@AL00001+16                                     0843 02760000
         MVI   @AL00001+16,X'80'                                   0843 02761000
         L     @15,GDTGPL(,@15)                                    0843 02762000
         LA    @01,@AL00001                                        0843 02763000
         BALR  @14,@15                                             0843 02764000
*        RESPECIFY RTNREG RSTD;                                    0844 02765000
*        TESTRC = RTNREG;                                          0845 02766000
         LR    TESTRC,RTNREG                                       0845 02767000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSMK*/ 02768000
*                                                                  0846 02769000
*        /************************************************************/ 02770000
*        /*                                                  @Y30SSMK*/ 02771000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02772000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02773000
*        /*                                                  @Y30SSMK*/ 02774000
*        /************************************************************/ 02775000
*                                                                  0847 02776000
*        IF TESTRC ^= 0                                            0847 02777000
*          THEN                                                    0847 02778000
         LTR   TESTRC,TESTRC                                       0847 02779000
         BZ    @RF00847                                            0847 02780000
*            DO;                                           /*@Y30SSMK*/ 02781000
*              ERRARGPT->DARGSMOD = UV0ID;                 /*@Y30SSMK*/ 02782000
         L     @04,COMSWKPT(,COMPTR)                               0849 02783000
         L     @04,ERRARGPT(,@04)                                  0849 02784000
         MVC   DARGSMOD(3,@04),@CC01149                            0849 02785000
*              ERRARGPT->DARGSENT = UVMSG04;               /*@Y30SSMK*/ 02786000
         MVI   DARGSENT(@04),X'04'                                 0850 02787000
*              RETURN CODE (LASTCC12);                     /*@Y30SSMK*/ 02788000
         LA    @15,12                                              0851 02789000
         L     @14,@SA00002                                        0851 02790000
         LM    @00,@12,@SA00002+8                                  0851 02791000
         BR    @14                                                 0851 02792000
*            END;                                          /*@Y30SSMK*/ 02793000
*                                                                  0853 02794000
*        /************************************************************/ 02795000
*        /*                                                          */ 02796000
*        /* GET STORAGE FOR THE AMS TEXT PROCESSOR'S VARIABLE        */ 02797000
*        /* DYNAMIC DATA ARGUMENT LIST.  (NOTE--29 INSERTIONS IS THE */ 02798000
*        /* MAXIMUM POSSIBLE FOR THIS PARTICULAR GET-STORAGE REQUEST)*/ 02799000
*        /*                                                          */ 02800000
*        /************************************************************/ 02801000
*                                                                  0853 02802000
*        GPID = GPID06;                                            0853 02803000
*                                                                  0853 02804000
@RF00847 MVC   GPID(4),@CC01257                                    0853 02805000
*        CALL IDCSAGP0 (GDTTBL,                                    0854 02806000
*                GPDDSZ,                                           0854 02807000
*                DARGPTR,                                          0854 02808000
*                GPID,                                             0854 02809000
*                SETZERO);                                         0854 02810000
         L     @02,@PC00001                                        0854 02811000
         ST    @02,@AL00001                                        0854 02812000
         LA    @15,GPDDSZ                                          0854 02813000
         ST    @15,@AL00001+4                                      0854 02814000
         L     @01,COMSWKPT(,COMPTR)                               0854 02815000
         LA    @15,DARGPTR(,@01)                                   0854 02816000
         ST    @15,@AL00001+8                                      0854 02817000
         LA    @15,GPID                                            0854 02818000
         ST    @15,@AL00001+12                                     0854 02819000
         LA    @15,SETZERO                                         0854 02820000
         ST    @15,@AL00001+16                                     0854 02821000
         MVI   @AL00001+16,X'80'                                   0854 02822000
         L     @15,GDTGPL(,@02)                                    0854 02823000
         LA    @01,@AL00001                                        0854 02824000
         BALR  @14,@15                                             0854 02825000
*        RESPECIFY RTNREG RSTD;                                    0855 02826000
*        TESTRC = RTNREG;                                          0856 02827000
         LR    TESTRC,RTNREG                                       0856 02828000
*        RESPECIFY RTNREG UNRSTD;                                  0857 02829000
*                                                                  0857 02830000
*        /************************************************************/ 02831000
*        /*                                                  @Y30SSMK*/ 02832000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02833000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02834000
*        /*                                                  @Y30SSMK*/ 02835000
*        /************************************************************/ 02836000
*                                                                  0858 02837000
*        IF TESTRC ^= 0                                            0858 02838000
*          THEN                                                    0858 02839000
         LTR   TESTRC,TESTRC                                       0858 02840000
         BZ    @RF00858                                            0858 02841000
*            DO;                                                   0859 02842000
*              ERRARGPT->DARGSMOD = UV0ID;                         0860 02843000
         L     @04,COMSWKPT(,COMPTR)                               0860 02844000
         L     @04,ERRARGPT(,@04)                                  0860 02845000
         MVC   DARGSMOD(3,@04),@CC01149                            0860 02846000
*              ERRARGPT->DARGSENT = UVMSG04;                       0861 02847000
         MVI   DARGSENT(@04),X'04'                                 0861 02848000
*              RETURN CODE (LASTCC12);                             0862 02849000
         LA    @15,12                                              0862 02850000
         L     @14,@SA00002                                        0862 02851000
         LM    @00,@12,@SA00002+8                                  0862 02852000
         BR    @14                                                 0862 02853000
*            END;                                                  0863 02854000
*        DARGSMOD = LC0ID;             /* STATIC TEXT ID, LC0        */ 02855000
@RF00858 L     @02,COMSWKPT(,COMPTR)                               0864 02856000
         L     @01,DARGPTR(,@02)                                   0864 02857000
         MVC   DARGSMOD(3,@01),@CC01146                            0864 02858000
*                                                                  0865 02859000
*        /************************************************************/ 02860000
*        /*                                                          */ 02861000
*        /* OBTAIN STORAGE FOR STATIC TEXT ABBREVIATIONS USED IN THE */ 02862000
*        /* OUTPUT.                                                  */ 02863000
*        /*                                                          */ 02864000
*        /************************************************************/ 02865000
*                                                                  0865 02866000
*        GPID = GPID07;                                            0865 02867000
*                                                                  0865 02868000
         MVC   GPID(4),@CC01259                                    0865 02869000
*        CALL IDCSAGP0 (GDTTBL,                                    0866 02870000
*                LENGTH(LCTEXT),                                   0866 02871000
*                TEXTPTR,                                          0866 02872000
*                GPID,                                             0866 02873000
*                SETZERO);                                         0866 02874000
         L     @15,@PC00001                                        0866 02875000
         ST    @15,@AL00001                                        0866 02876000
         LA    @14,@CF01582                                        0866 02877000
         ST    @14,@AL00001+4                                      0866 02878000
         LA    @02,TEXTPTR(,@02)                                   0866 02879000
         ST    @02,@AL00001+8                                      0866 02880000
         LA    @02,GPID                                            0866 02881000
         ST    @02,@AL00001+12                                     0866 02882000
         LA    @02,SETZERO                                         0866 02883000
         ST    @02,@AL00001+16                                     0866 02884000
         MVI   @AL00001+16,X'80'                                   0866 02885000
         L     @15,GDTGPL(,@15)                                    0866 02886000
         LA    @01,@AL00001                                        0866 02887000
         BALR  @14,@15                                             0866 02888000
*        RESPECIFY RTNREG RSTD;                                    0867 02889000
*        TESTRC = RTNREG;                                          0868 02890000
         LR    TESTRC,RTNREG                                       0868 02891000
*        RESPECIFY RTNREG UNRSTD;                                  0869 02892000
*                                                                  0869 02893000
*        /************************************************************/ 02894000
*        /*                                                  @Y30SSMK*/ 02895000
*        /* IF STORAGE COULD NOT BE OBTAINED, SET UP ERROR   @Y30SSMK*/ 02896000
*        /* MESSAGE AND RETURN WITH A R.C. = 12.             @Y30SSMK*/ 02897000
*        /*                                                  @Y30SSMK*/ 02898000
*        /************************************************************/ 02899000
*                                                                  0870 02900000
*        IF TESTRC ^= 0                                            0870 02901000
*          THEN                                                    0870 02902000
         LTR   TESTRC,TESTRC                                       0870 02903000
         BZ    @RF00870                                            0870 02904000
*            DO;                                                   0871 02905000
*              ERRARGPT->DARGSMOD = UV0ID;                         0872 02906000
         L     @04,COMSWKPT(,COMPTR)                               0872 02907000
         L     @04,ERRARGPT(,@04)                                  0872 02908000
         MVC   DARGSMOD(3,@04),@CC01149                            0872 02909000
*              ERRARGPT->DARGSENT = UVMSG04;                       0873 02910000
         MVI   DARGSENT(@04),X'04'                                 0873 02911000
*              RETURN CODE (LASTCC12);                             0874 02912000
         LA    @15,12                                              0874 02913000
         L     @14,@SA00002                                        0874 02914000
         LM    @00,@12,@SA00002+8                                  0874 02915000
         BR    @14                                                 0874 02916000
*            END;                                                  0875 02917000
*                                                                  0875 02918000
*        /************************************************************/ 02919000
*        /*                                                          */ 02920000
*        /* TO RETRIEVE THE STATIC TEXT DATA, ISSUE AN               */ 02921000
*        /* AMS UPRINT MACRO WITH THE RETURN AREA INITIALIZED IN THE */ 02922000
*        /* DARGLIST TO THIS STORAGE AREA.                           */ 02923000
*        /************************************************************/ 02924000
*                                                                  0876 02925000
*        DARGSENT = LCST01;                                        0876 02926000
@RF00870 L     @04,COMSWKPT(,COMPTR)                               0876 02927000
         L     @02,DARGPTR(,@04)                                   0876 02928000
         MVI   DARGSENT(@02),X'01'                                 0876 02929000
*        DARGRETP = TEXTPTR;                                       0877 02930000
         L     @04,TEXTPTR(,@04)                                   0877 02931000
         ST    @04,DARGRETP(,@02)                                  0877 02932000
*        DARGRETL = LENGTH(LCTEXT);                                0878 02933000
         MVC   DARGRETL(2,@02),@CH01582                            0878 02934000
*        CALL LISTPROC;                                            0879 02935000
         L     @15,@CV00871                                        0879 02936000
         BALR  @14,@15                                             0879 02937000
*                                                                  0880 02938000
*        /************************************************************/ 02939000
*        /*                                                          */ 02940000
*        /* EXIT FROM INITIALIZATION ROUTINE, RETURNING TO           */ 02941000
*        /* EXECUTIVE ROUTINE.                                       */ 02942000
*        /*                                                          */ 02943000
*        /************************************************************/ 02944000
*                                                                  0880 02945000
*        RETURN CODE (0);                                          0880 02946000
         SLR   @15,@15                                             0880 02947000
         L     @14,@SA00002                                        0880 02948000
         LM    @00,@12,@SA00002+8                                  0880 02949000
         BR    @14                                                 0880 02950000
*        END INITPROC;                                             0881 02951000
*        /************************************************************/ 02952000
*        /*                                                          */ 02953000
*        /* PROCEDURE NAME - GNXTPROC                                */ 02954000
*        /*                                                          */ 02955000
*        /* FUNCTION - MANAGES THE REQUEST FOR ALL OR A SPECIFIED    */ 02956000
*        /*            SUBSET OF THE CATALOG ENTRY TYPES IN          */ 02957000
*        /*            ALPHANUMERIC SEQUENCE.                        */ 02958000
*        /*                                                          */ 02959000
*        /* INPUT - MAIN CPL, FPLS, AND CORRESPONDING CATALOG WKAS   */ 02960000
*        /*                                                          */ 02961000
*        /* OUTPUT - RETRIEVED CATALOG FIELDS                        */ 02962000
*        /*                                                          */ 02963000
*        /************************************************************/ 02964000
*                                                                  0882 02965000
*GNXTPROC:                                                         0882 02966000
*        PROCEDURE;                                                0882 02967000
*                                                                  0882 02968000
GNXTPROC STM   @14,@12,@SA00003                                    0882 02969000
*        DCL CMSEOFLG  BIT(1);         /*CAT MGMT SERVICES EOF SIGNAL*/ 02970000
*                                                                  0883 02971000
*        /************************************************************/ 02972000
*        /*                                                          */ 02973000
*        /* GETNEXT PROCESSING MODE LOOP FOR LISTING BY TYPES        */ 02974000
*        /* (INCLUDING TOTAL LISTC REQUEST).  FOR A COMPLETE         */ 02975000
*        /* CATALOG LISTING THE ASSOCIATED DATASET ENTRIES WILL BE   */ 02976000
*        /* LISTED WITH THE CLUSTER, AIX, PGSPC, OR          @Y30SSMK*/ 02977000
*        /* GDG ENTRY. WHEREAS, A TYPE REQUEST SPECIFYING    @Y30SSMK*/ 02978000
*        /* CLUSTER, AIX, PGSPC, OR GDG ENTRIES              @Y30SSMK*/ 02979000
*        /* WILL NOT HAVE THE ASSOCIATED DATASET ENTRIES     @Y30SSMK*/ 02980000
*        /* LISTED WITH THE CLUSTER , AIX, PGSPC, OR         @Y30SSMK*/ 02981000
*        /* GDG NODE.                                        @Y30SSMK*/ 02982000
*        /*                                                          */ 02983000
*        /************************************************************/ 02984000
*                                                                  0884 02985000
*        ENTNAME = BLANK;              /*INIT KEY FOR 1ST LOCATE     */ 02986000
         MVI   ENTNAME+1,C' '                                      0884 02987000
         MVC   ENTNAME+2(42),ENTNAME+1                             0884 02988000
         MVI   ENTNAME,C' '                                        0884 02989000
*        CMSEOFLG = OFF;                                           0885 02990000
         NI    CMSEOFLG,B'01111111'                                0885 02991000
*        NOGENFLG = ON;                                    /*@Y30SSMK*/ 02992000
*                                                                  0886 02993000
         L     @04,COMFLGPT(,COMPTR)                               0886 02994000
         OI    NOGENFLG(@04),B'10000000'                           0886 02995000
*GETNEXT:                                                          0887 02996000
*        DO WHILE CMSEOFLG = OFF;                                  0887 02997000
*                                                                  0887 02998000
GETNEXT  B     @DE00887                                            0887 02999000
@DL00887 DS    0H                                                  0888 03000000
*          OLDERID2 = NEWERID2;                                    0888 03001000
         L     @02,@PC00001                                        0888 03002000
         L     @02,GDTTR2(,@02)                                    0888 03003000
         MVC   @TS00001(95),NEWERID2(@02)                          0888 03004000
         MVC   OLDERID2(95,@02),@TS00001                           0888 03005000
*          NEWID2 = 'LCNX';                                        0889 03006000
*                                                                  0889 03007000
         MVC   NEWID2(4,@02),@CC01399                              0889 03008000
*          CTGGTNXT = ON;                                          0890 03009000
         L     @02,COMSWKPT(,COMPTR)                               0890 03010000
         L     @02,CTGPLPTR(,@02)                                  0890 03011000
         OI    CTGGTNXT(@02),B'00010000'                           0890 03012000
*          CTGNAME = ON;               /*44-BYTE ENTRYNAME IS USED   */ 03013000
         OI    CTGNAME(@02),B'00000100'                            0891 03014000
*          CTGENT = ADDR(ENTNAME);                                 0892 03015000
         LA    @15,ENTNAME                                         0892 03016000
         ST    @15,CTGENT(,@02)                                    0892 03017000
*          PGSPCFLG = OFF;                                 /*@YL026UE*/ 03018000
         L     @02,COMFLGPT(,COMPTR)                               0893 03019000
         NI    PGSPCFLG(@02),B'01111111'                           0893 03020000
*          /**********************************************************/ 03021000
*          /*                                                        */ 03022000
*          /* RETRIEVE AN ENTRY FROM THE CATALOG.                    */ 03023000
*          /* THE GET-NEXT MODE RETRIEVAL IS BASED ON A CAT/DADSM    */ 03024000
*          /* SEARCH FOR THE NEXT ENTRY G.T. OR EQUAL TO THE 44-BYTE */ 03025000
*          /* NAME REFERENCED IN THE CPL.                            */ 03026000
*          /*                                                        */ 03027000
*          /**********************************************************/ 03028000
*                                                                  0894 03029000
*          CALL LOCPROC (FPLEND,                                   0894 03030000
*                        CACBFLG,                                  0894 03031000
*                        ENTNMFLG);                                0894 03032000
         L     @01,COMVARPT(,COMPTR)                               0894 03033000
         LA    @15,FPLEND(,@01)                                    0894 03034000
         ST    @15,@AL00001                                        0894 03035000
         ST    @02,@AL00001+4                                      0894 03036000
         LA    @02,ENTNMFLG(,@02)                                  0894 03037000
         ST    @02,@AL00001+8                                      0894 03038000
         L     @15,@CV00870                                        0894 03039000
         LA    @01,@AL00001                                        0894 03040000
         BALR  @14,@15                                             0894 03041000
*          RESPECIFY RTNREG RSTD;                                  0895 03042000
*          TESTRC = RTNREG;                                        0896 03043000
         LR    TESTRC,RTNREG                                       0896 03044000
*          RESPECIFY RTNREG UNRSTD;                                0897 03045000
*          /**********************************************************/ 03046000
*          /*                                                        */ 03047000
*          /* PROCESS THE ENTRY FIELDS WHENEVER THE LOCATE WAS       */ 03048000
*          /* SUCCESSFUL OR ELSE PASSWORD VERIFICATION FAILED BUT    */ 03049000
*          /* ONLY THE NAME SUBSET WAS REQUESTED, AND THE LISTING    */ 03050000
*          /* WAS NOT DATE RESTRICTED, OR RESTRICTED TO      @Y30SSMK*/ 03051000
*          /* NOTUSABLE DATA SETS.                           @Y30SSMK*/ 03052000
*          /*                                                        */ 03053000
*          /**********************************************************/ 03054000
*                                                                  0898 03055000
*          IF TESTRC = 0  |                                        0898 03056000
*            (CATRC = CRCBADPW & ADDR(NAME) > NULLPTR & DATEFLG = OFF   03057000
*            & NUSEFLG = OFF)                                      0898 03058000
*            THEN                                                  0898 03059000
         SLR   @02,@02                                             0898 03060000
         CR    TESTRC,@02                                          0898 03061000
         BE    @RT00898                                            0898 03062000
         L     @01,COMVARPT(,COMPTR)                               0898 03063000
         CLC   CATRC(2,@01),@CH01313                               0898 03064000
         BNE   @RF00898                                            0898 03065000
         L     @15,@PC00001+4                                      0898 03066000
         C     @02,FDTPTR+52(,@15)                                 0898 03067000
         BNL   @RF00898                                            0898 03068000
         L     @02,COMFLGPT(,COMPTR)                               0898 03069000
         TM    DATEFLG(@02),B'10000000'                            0898 03070000
         BNZ   @RF00898                                            0898 03071000
         TM    NUSEFLG(@02),B'10000000'                            0898 03072000
         BNZ   @RF00898                                            0898 03073000
@RT00898 DS    0H                                                  0899 03074000
*GNXTGOOD:     DO;                                                 0899 03075000
GNXTGOOD DS    0H                                                  0900 03076000
*              IF CATRC = 0                                        0900 03077000
*                THEN                                              0900 03078000
         L     @04,COMVARPT(,COMPTR)                               0900 03079000
         LH    @02,CATRC(,@04)                                     0900 03080000
         LTR   @02,@02                                             0900 03081000
         BNZ   @RF00900                                            0900 03082000
*                  DO;                                             0901 03083000
*                  /*SAVE ENTRYNAME TO UPDATE AS KEY FOR NEXT LOCATE */ 03084000
*                  ENTNAME = ENT44FPT->CTGFLPT(1)->ENT44;          0902 03085000
         L     @02,COMFPLPT(,COMPTR)                               0902 03086000
         L     @01,ENT44FPT(,@02)                                  0902 03087000
         L     @01,CTGFLPT(,@01)                                   0902 03088000
         MVC   ENTNAME(44),ENT44(@01)                              0902 03089000
*                  HOLDETYP = ETYPFPT->CTGFLPT(1)->ETYP;           0903 03090000
         L     @01,ETYPFPT(,@02)                                   0903 03091000
         L     @01,CTGFLPT(,@01)                                   0903 03092000
         MVC   HOLDETYP(1,@04),ETYP(@01)                           0903 03093000
*                  IF HOLDETYP = CTGTCL &                          0904 03094000
*                     CATTRFPT->CTGFLPT(1)->PGSPAC ^= 'FF'X &      0904 03095000
*                     CATTRFPT->CTGFLPT(1)->PGSP=ON          /*YM6557*/ 03096000
*                    THEN                                          0904 03097000
         CLI   HOLDETYP(@04),C'C'                                  0904 03098000
         BNE   @RF00904                                            0904 03099000
         L     @04,CATTRFPT(,@02)                                  0904 03100000
         L     @04,CTGFLPT(,@04)                                   0904 03101000
         CLI   PGSPAC(@04),X'FF'                                   0904 03102000
         BE    @RF00904                                            0904 03103000
         TM    PGSP(@04),B'00000001'                               0904 03104000
         BNO   @RF00904                                            0904 03105000
*                      PGSPCFLG = ON;                      /*@YL026UE*/ 03106000
         L     @04,COMFLGPT(,COMPTR)                               0905 03107000
         OI    PGSPCFLG(@04),B'10000000'                           0905 03108000
*                  END;                                            0906 03109000
*                                                                  0906 03110000
*              /******************************************************/ 03111000
*              /*                                                    */ 03112000
*              /*  IF THE PROPER PASSWORD WAS NOT PROVIDED BUT ONLY  */ 03113000
*              /*  NAMES ARE REQUESTED, RETRIEVE THE NAME FROM THE   */ 03114000
*              /*  WORK AREA AND CALL RTEPROC TO HAVE THE NAME       */ 03115000
*              /*  LISTED.  DO NOT ISSUE ANY ERROR MESSAGES SINCE    */ 03116000
*              /*  ALL THE REQUESTED INFORMATION IS PROVIDED.        */ 03117000
*              /*                                                    */ 03118000
*              /******************************************************/ 03119000
*                                                                  0907 03120000
*                ELSE                                              0907 03121000
*                  DO;                                             0907 03122000
         B     @RC00900                                            0907 03123000
@RF00900 DS    0H                                                  0908 03124000
*                  ENTNAME = SUPPDSNM;                             0908 03125000
         L     @04,COMSWKPT(,COMPTR)                               0908 03126000
         L     @04,CTGPLPTR(,@04)                                  0908 03127000
         L     @04,CTGWKA(,@04)                                    0908 03128000
         MVC   ENTNAME(44),SUPPDSNM(@04)                           0908 03129000
*                  HOLDETYP = SUPPTYPE;                            0909 03130000
         L     @02,COMVARPT(,COMPTR)                               0909 03131000
         MVC   HOLDETYP(1,@02),SUPPTYPE(@04)                       0909 03132000
*                  IF HOLDETYP = CTGTPGSP                          0910 03133000
*                    THEN                                          0910 03134000
         CLI   HOLDETYP(@02),C'P'                                  0910 03135000
         BNE   @RF00910                                            0910 03136000
*                      DO;                                 /*@YL026UE*/ 03137000
*                      PGSPCFLG = ON;                      /*@YL026UE*/ 03138000
         L     @04,COMFLGPT(,COMPTR)                               0912 03139000
         OI    PGSPCFLG(@04),B'10000000'                           0912 03140000
*                      HOLDETYP = CTGTCL;                  /*@YL026UE*/ 03141000
         MVI   HOLDETYP(@02),C'C'                                  0913 03142000
*                      END;                                /*@YL026UE*/ 03143000
*                  END;                                            0915 03144000
@RF00910 DS    0H                                                  0916 03145000
*              /******************************************************/ 03146000
*              /*                                                    */ 03147000
*              /* ROUTE THE ENTRY TO THE APPROPRIATE FORMATTING      */ 03148000
*              /* ROUTINE.                                           */ 03149000
*              /*                                                    */ 03150000
*              /******************************************************/ 03151000
*                                                                  0916 03152000
*              CLENTFLG = OFF;         /*NON-QUALIFIED ENTRY @Y30SSMK*/ 03153000
@RC00900 L     @04,COMFLGPT(,COMPTR)                               0916 03154000
         NI    CLENTFLG(@04),B'01111111'                           0916 03155000
*              CALL RTEPROC (CLENTFLG);                            0917 03156000
         LA    @04,CLENTFLG(,@04)                                  0917 03157000
         ST    @04,@AL00001                                        0917 03158000
         LA    @01,@AL00001                                        0917 03159000
         BAL   @14,RTEPROC                                         0917 03160000
*              RESPECIFY RTNREG RSTD;                              0918 03161000
*              TESTRC = RTNREG;                                    0919 03162000
         LR    TESTRC,RTNREG                                       0919 03163000
*              RESPECIFY RTNREG UNRSTD;                            0920 03164000
*                                                                  0920 03165000
*              /******************************************************/ 03166000
*              /*                                            @Y30SSMK*/ 03167000
*              /* IF ANY ERRORS ARE ENCOUNTERED WHILE        @Y30SSMK*/ 03168000
*              /* PROCESSING THE ENTRIES, PROCEED TO PRINT   @Y30SSMK*/ 03169000
*              /* THE APPROPRIATE ERROR MESSAGE.  TERMINATE  @Y30SSMK*/ 03170000
*              /* PROCESSING IF A TERMINAL ERROR IS          @Y30SSMK*/ 03171000
*              /* ENCOUNTERED.                               @Y30SSMK*/ 03172000
*              /*                                            @Y30SSMK*/ 03173000
*              /******************************************************/ 03174000
*                                                                  0921 03175000
*              IF TESTRC ^= 0                                      0921 03176000
*                THEN                                              0921 03177000
         LTR   TESTRC,TESTRC                                       0921 03178000
         BZ    @RF00921                                            0921 03179000
*                  IF TESTRC < LASTCC12                            0922 03180000
*                    THEN                                          0922 03181000
         C     TESTRC,@CF00586                                     0922 03182000
         BNL   @RF00922                                            0922 03183000
*                      CALL ERRPROC;                               0923 03184000
         L     @15,@CV00872                                        0923 03185000
         BALR  @14,@15                                             0923 03186000
*                    ELSE                                          0924 03187000
*                      RETURN CODE(LASTCC12);                      0924 03188000
         B     @RC00922                                            0924 03189000
@RF00922 LA    @15,12                                              0924 03190000
         L     @14,@SA00003                                        0924 03191000
         LM    @00,@12,@SA00003+8                                  0924 03192000
         BR    @14                                                 0924 03193000
*              END GNXTGOOD;                                       0925 03194000
*            /********************************************************/ 03195000
*            /*                                                      */ 03196000
*            /* INTERROGATE THE NON-ZERO VSAM CATALOG RETURN CODE.   */ 03197000
*            /*                                                      */ 03198000
*            /********************************************************/ 03199000
*                                                                  0926 03200000
*            ELSE                                                  0926 03201000
*GNXTBAD:      DO;                                                 0926 03202000
         B     @RC00898                                            0926 03203000
@RF00898 DS    0H                                                  0926 03204000
GNXTBAD  DS    0H                                                  0927 03205000
*              IF CATRC = CRCEOF                                   0927 03206000
*                THEN                                              0927 03207000
         L     @04,COMVARPT(,COMPTR)                               0927 03208000
         CLC   CATRC(2,@04),@CH00187                               0927 03209000
         BNE   @RF00927                                            0927 03210000
*                  CMSEOFLG = ON;      /*EOF TERMINATES GETNEXT LOOP */ 03211000
         OI    CMSEOFLG,B'10000000'                                0928 03212000
*                ELSE                                              0929 03213000
*                  DO;                                             0929 03214000
         B     @RC00927                                            0929 03215000
@RF00927 DS    0H                                                  0930 03216000
*                  CALL ERRPROC;       /*O/P VSAM C.C. MESSAGE       */ 03217000
         L     @15,@CV00872                                        0930 03218000
         BALR  @14,@15                                             0930 03219000
*                  IF CATRC = CRCBADPW                             0931 03220000
*                    THEN                                          0931 03221000
*                                                                  0931 03222000
         L     @04,COMVARPT(,COMPTR)                               0931 03223000
         CLC   CATRC(2,@04),@CH01313                               0931 03224000
         BNE   @RF00931                                            0931 03225000
*                      /**********************************************/ 03226000
*                      /*                                            */ 03227000
*                      /* UPDATE THE PASSWORD SUPPRESSED TALLY.      */ 03228000
*                      /* SAVE THE ENTRYNAME AS A KEY FOR THE NEXT   */ 03229000
*                      /* REQUEST AND CONTINUE.                      */ 03230000
*                      /*                                            */ 03231000
*                      /**********************************************/ 03232000
*                                                                  0932 03233000
*                      DO;                                 /*@Y30LSMK*/ 03234000
*                      PWTALLY = PWTALLY + 1;              /*@Y30LSMK*/ 03235000
         LA    @02,1                                               0933 03236000
         AL    @02,PWTALLY                                         0933 03237000
         ST    @02,PWTALLY                                         0933 03238000
*                      ENTNAME = SUPPDSNM;                 /*@Y30LSMK*/ 03239000
         L     @02,COMSWKPT(,COMPTR)                               0934 03240000
         L     @02,CTGPLPTR(,@02)                                  0934 03241000
         L     @02,CTGWKA(,@02)                                    0934 03242000
         MVC   ENTNAME(44),SUPPDSNM(@02)                           0934 03243000
*                      SAVRC = MAX (SAVRC, LASTCC04);      /*@ZA05939*/ 03244000
         LH    @02,SAVRC(,@04)                                     0935 03245000
         LA    @15,4                                               0935 03246000
         CR    @02,@15                                             0935 03247000
         BNL   *+6                                                      03248000
         LR    @02,@15                                             0935 03249000
         STH   @02,SAVRC(,@04)                                     0935 03250000
*                      IF (DATEFLG = OFF &  NUSEFLG = OFF)  |      0936 03251000
*                        ADDR(NAME) = NULLPTR                      0936 03252000
*                        THEN                                      0936 03253000
*                                                                  0936 03254000
         L     @04,COMFLGPT(,COMPTR)                               0936 03255000
         TM    DATEFLG(@04),B'10000000'                            0936 03256000
         BNZ   @GL00051                                            0936 03257000
         TM    NUSEFLG(@04),B'10000000'                            0936 03258000
         BZ    @RT00936                                            0936 03259000
@GL00051 L     @04,@PC00001+4                                      0936 03260000
         L     @04,FDTPTR+52(,@04)                                 0936 03261000
         LTR   @04,@04                                             0936 03262000
         BNZ   @RF00936                                            0936 03263000
@RT00936 DS    0H                                                  0937 03264000
*                          /******************************************/ 03265000
*                          /*                                @Y30LSMK*/ 03266000
*                          /* IF THE LISTING WAS NOT DATE    @Y30LSMK*/ 03267000
*                          /* RESTRICTED, OR RESTRICTED TO   @Y30SSMK*/ 03268000
*                          /* NOTUSABLE DATA SETS, OUTPUT    @Y30SSMK*/ 03269000
*                          /* THE ENTRY SUPPRESSED MESSAGE.  @Y30SSMK*/ 03270000
*                          /*                                @Y30LSMK*/ 03271000
*                          /******************************************/ 03272000
*                                                                  0937 03273000
*                          DO;                             /*@Y30LSMK*/ 03274000
*                          ERRARGPT->DARGSMOD = LC1ID;     /*@Y30LSMK*/ 03275000
         L     @04,COMSWKPT(,COMPTR)                               0938 03276000
         L     @02,ERRARGPT(,@04)                                  0938 03277000
         MVC   DARGSMOD(3,@02),@CC01155                            0938 03278000
*                          ERRARGPT->DARGSENT = LCMSG08;   /*@Y30LSMK*/ 03279000
         MVI   DARGSENT(@02),X'08'                                 0939 03280000
*                          ERRARGPT->DARGDBP = ADDR(SUPPDSNM);     0940 03281000
         L     @04,CTGPLPTR(,@04)                                  0940 03282000
         L     @04,CTGWKA(,@04)                                    0940 03283000
         LA    @04,SUPPDSNM(,@04)                                  0940 03284000
         ST    @04,DARGDBP(,@02)                                   0940 03285000
*                          ERRARGPT->DARGILP = LENGTH(SUPPDSNM);   0941 03286000
         MVC   DARGILP(2,@02),@CH00610                             0941 03287000
*                          CALL ERRPROC;                   /*@Y30LSMK*/ 03288000
         L     @15,@CV00872                                        0942 03289000
         BALR  @14,@15                                             0942 03290000
*                          END;                            /*@Y30LSMK*/ 03291000
*                      END;                                /*@Y30LSMK*/ 03292000
*                    ELSE                                          0945 03293000
*                      IF CATRC = CRCINVCI                         0945 03294000
*                        THEN                                      0945 03295000
*                                                                  0945 03296000
         B     @RC00931                                            0945 03297000
@RF00931 L     @04,COMVARPT(,COMPTR)                               0945 03298000
         CLC   CATRC(2,@04),@CH01315                               0945 03299000
         BNE   @RF00945                                            0945 03300000
*                          /******************************************/ 03301000
*                          /*                                @ZA06148*/ 03302000
*                          /* FOR AN INVALID CI NUMBER, OUTPUT THE   */ 03303000
*                          /* APPROPRIATE ERROR MESSAGE AND CONTINUE */ 03304000
*                          /* PROCESSING THE REMAINING ENTRIES.      */ 03305000
*                          /* NOTE: VSAM CMS WILL RETURN THE ENTRY   */ 03306000
*                          /* NAME IN THE AREA POINTED TO BY CTGENT. */ 03307000
*                          /*                                @ZA06148*/ 03308000
*                          /******************************************/ 03309000
*                                                                  0946 03310000
*                          DO;                             /*@ZA06148*/ 03311000
*                          ERRARGPT->DARGSMOD = LC1ID;     /*@ZA06148*/ 03312000
         L     @04,COMSWKPT(,COMPTR)                               0947 03313000
         L     @04,ERRARGPT(,@04)                                  0947 03314000
         MVC   DARGSMOD(3,@04),@CC01155                            0947 03315000
*                          ERRARGPT->DARGSENT = LCMSG08;   /*@ZA06148*/ 03316000
         MVI   DARGSENT(@04),X'08'                                 0948 03317000
*                          ERRARGPT->DARGDBP = ADDR(ENTNAME);      0949 03318000
         LA    @02,ENTNAME                                         0949 03319000
         ST    @02,DARGDBP(,@04)                                   0949 03320000
*                          ERRARGPT->DARGILP = LENGTH(ENTNAME);    0950 03321000
*                                                                  0950 03322000
         MVC   DARGILP(2,@04),@CH00610                             0950 03323000
*                          CALL ERRPROC;                   /*@ZA06148*/ 03324000
         L     @15,@CV00872                                        0951 03325000
         BALR  @14,@15                                             0951 03326000
*                          END;                            /*@ZA06148*/ 03327000
*                      ELSE                                        0953 03328000
*                                                                  0953 03329000
*                      /**********************************************/ 03330000
*                      /*                                            */ 03331000
*                      /* FOR AN INSUFFICIENT WORKAREA OCCURRENCE    */ 03332000
*                      /* SAVE THE ENTRYNAME FOR THE NEXT LOCATE KEY */ 03333000
*                      /* AND CONTINUE.                              */ 03334000
*                      /*                                            */ 03335000
*                      /**********************************************/ 03336000
*                                                                  0953 03337000
*                      IF CATRC = CRCWKASZ                         0953 03338000
*                        THEN                                      0953 03339000
         B     @RC00945                                            0953 03340000
@RF00945 L     @04,COMVARPT(,COMPTR)                               0953 03341000
         CLC   CATRC(2,@04),@CH01311                               0953 03342000
         BNE   @RF00953                                            0953 03343000
*                          ENTNAME = ENT44FPT->CTGFLPT(1)->ENT44;  0954 03344000
         L     @04,COMFPLPT(,COMPTR)                               0954 03345000
         L     @04,ENT44FPT(,@04)                                  0954 03346000
         L     @04,CTGFLPT(,@04)                                   0954 03347000
         MVC   ENTNAME(44),ENT44(@04)                              0954 03348000
*                        ELSE                                      0955 03349000
*                                                                  0955 03350000
*                          /******************************************/ 03351000
*                          /*                                        */ 03352000
*                          /* TERMINATE PROCESSING FOR ALL OTHER     */ 03353000
*                          /* CONDITIONS, RETURNING WITH THE APPRO-  */ 03354000
*                          /* PRIATE RETURN CODE.                    */ 03355000
*                          /*                                        */ 03356000
*                          /******************************************/ 03357000
*                                                                  0955 03358000
*                          DO;                                     0955 03359000
         B     @RC00953                                            0955 03360000
@RF00953 DS    0H                                                  0956 03361000
*                          NOMSGFLG = ON;                          0956 03362000
         L     @04,COMFLGPT(,COMPTR)                               0956 03363000
         OI    NOMSGFLG(@04),B'10000000'                           0956 03364000
*                          IF SAVRC < LASTCC12                     0957 03365000
*                            THEN                                  0957 03366000
         L     @04,COMVARPT(,COMPTR)                               0957 03367000
         LH    @04,SAVRC(,@04)                                     0957 03368000
         C     @04,@CF00586                                        0957 03369000
         BNL   @RF00957                                            0957 03370000
*                              RETURN CODE (LASTCC08);             0958 03371000
         LA    @15,8                                               0958 03372000
         L     @14,@SA00003                                        0958 03373000
         LM    @00,@12,@SA00003+8                                  0958 03374000
         BR    @14                                                 0958 03375000
*                            ELSE                                  0959 03376000
*                              RETURN CODE (LASTCC12);             0959 03377000
@RF00957 LA    @15,12                                              0959 03378000
         L     @14,@SA00003                                        0959 03379000
         LM    @00,@12,@SA00003+8                                  0959 03380000
         BR    @14                                                 0959 03381000
*                          END;                                    0960 03382000
*                  END;                                            0961 03383000
@RC00953 DS    0H                                                  0961 03384000
@RC00945 DS    0H                                                  0961 03385000
@RC00931 DS    0H                                                  0962 03386000
*              END GNXTBAD;                                        0962 03387000
@RC00927 DS    0H                                                  0963 03388000
*          /**********************************************************/ 03389000
*          /*                                                        */ 03390000
*          /* RESTORE THE STRING OF FPL'S AND UPDATE ENTRY NAME AS   */ 03391000
*          /* THE KEY FOR THE NEXT LOCATE REQUEST.                   */ 03392000
*          /*                                                        */ 03393000
*          /**********************************************************/ 03394000
*                                                                  0963 03395000
*          CALL FPLPROC;                                           0963 03396000
@RC00898 L     @15,@CV00873                                        0963 03397000
         BALR  @14,@15                                             0963 03398000
*          ENTKEY = ENTKEY + 1;                                    0964 03399000
         IC    @04,ENTKEY                                          0964 03400000
         LA    @04,1(,@04)                                         0964 03401000
         STC   @04,ENTKEY                                          0964 03402000
*        END GETNEXT;                                              0965 03403000
@DE00887 TM    CMSEOFLG,B'10000000'                                0965 03404000
         BZ    @DL00887                                            0965 03405000
*        /************************************************************/ 03406000
*        /*                                                          */ 03407000
*        /* EXIT FROM ALPHANUMERIC GET-NEXT ROUTINE, RETURNING TO    */ 03408000
*        /* EXECUTIVE ROUTINE.                                       */ 03409000
*        /*                                                          */ 03410000
*        /************************************************************/ 03411000
*                                                                  0966 03412000
*        RETURN CODE (0);                                          0966 03413000
         SLR   @15,@15                                             0966 03414000
         L     @14,@SA00003                                        0966 03415000
         LM    @00,@12,@SA00003+8                                  0966 03416000
         BR    @14                                                 0966 03417000
*        END GNXTPROC;                                             0967 03418000
*        /************************************************************/ 03419000
*        /*                                                          */ 03420000
*        /* PROCEDURE NAME - ENTPROC                                 */ 03421000
*        /*                                                          */ 03422000
*        /* FUNCTION - MANAGES THE REQUEST FOR SPECIFIC ENTRIES FROM */ 03423000
*        /*            THE CATALOG.                                  */ 03424000
*        /*                                                          */ 03425000
*        /* INPUT - MAIN CPL, FPLS, CORRESPONDING CATALOG WORKAREAS, */ 03426000
*        /*         AND LISTC FUNCTION DATA TABLE.                   */ 03427000
*        /*                                                          */ 03428000
*        /* OUTPUT - RETRIEVED CATALOG FIELDS FOR A GIVEN ENTRY      */ 03429000
*        /*                                                          */ 03430000
*        /************************************************************/ 03431000
*                                                                  0968 03432000
*ENTPROC:                                                          0968 03433000
*        PROCEDURE;                                                0968 03434000
*                                                                  0968 03435000
ENTPROC  STM   @14,@12,@SA00004                                    0968 03436000
*        /************************************************************/ 03437000
*        /*                                                          */ 03438000
*        /* LOCAL VARIABLES                                          */ 03439000
*        /*                                                          */ 03440000
*        /************************************************************/ 03441000
*                                                                  0969 03442000
*        DCL ENTIDX    FIXED(15);      /*INDEX VAR FOR ENTRY LIST    */ 03443000
*        DCL TYPIDX    FIXED(15);      /*INDEX VAR FOR 'MULTITYP'SCAN*/ 03444000
*        DCL BYPASFLG  BIT(1);         /*BYPASS PROCESSING OF AN NTRY*/ 03445000
*        DCL TYPOKFLG  BIT(1);         /*ENTRY IS QUALIFIED BY TYPE  */ 03446000
*        DCL BADPWFLG  BIT(1);         /*PASSWORD TEST FOR CL INFO   */ 03447000
*        DCL SHORTFLG  BIT(1);         /*SHORT ENT NAME LIST @ZA01484*/ 03448000
*        DCL SHVOLFLG  BIT(1);         /*SHORT VOLUME LIST   @Y30SSMK*/ 03449000
*        DCL NOTRQFLG  BIT(1);         /*NOT REQUESTED TYPE  @Y30SSMK*/ 03450000
*        DCL NAMECNT   FIXED(15);      /*CNT OF NAMES TO BE PROCESSED   03451000
*                                                            @YL026UE*/ 03452000
*        DCL LVLNMWOA CHAR(44);        /*LVLNAME FOR '.'     @YL026UE*/ 03453000
*        DCL JJ        FIXED(15);      /*INDEX VAR FOR PSWD CHECK  0979 03454000
*                                                            @Y30LSMK*/ 03455000
*        DCL VOLSERLN  FIXED(15) CONSTANT(6);              /*@Y30SSMK*/ 03456000
*                                      /*LEN OF VOL SERIAL   @Y30SSMK*/ 03457000
*        DCL DSNLEN    FIXED(15) CONSTANT(44);             /*@Y30SSMK*/ 03458000
*                                      /*LEN OF DATA SET NAME@Y30SSMK*/ 03459000
*                                                                  0982 03460000
*        /************************************************************/ 03461000
*        /*                                                  @YL026UE*/ 03462000
*        /* ESTABLISH ADDRESSABILITY OF CIRAGL FOR THE UCIR MACRO    */ 03463000
*        /*                                                  @YL026UE*/ 03464000
*        /************************************************************/ 03465000
*                                                                  0982 03466000
*        RESPECIFY CIRAGL BASED(ADDR(CIRAREA));            /*@YL026UE*/ 03467000
*        CIRPID = 'LC10';                                  /*@YL026UE*/ 03468000
*                                                                  0983 03469000
         LA    @04,CIRAREA                                         0983 03470000
         MVC   CIRPID(4,@04),@CC01261                              0983 03471000
*        /************************************************************/ 03472000
*        /*                                                          */ 03473000
*        /*   SINGLE ENTRY PROCESSING MODE LOOP.  THE SPECIFIED      */ 03474000
*        /*   ENTRY LIST IS SCANNED AND EACH ENTRY IS LOCATED AND    */ 03475000
*        /*   LISTED.                                                */ 03476000
*        /*                                                          */ 03477000
*        /************************************************************/ 03478000
*                                                                  0984 03479000
*        IF ADDR(ENT) > NULLPTR                                    0984 03480000
*          THEN                                                    0984 03481000
         L     @04,@PC00001+4                                      0984 03482000
         L     @04,FDTPTR+8(,@04)                                  0984 03483000
         LTR   @04,@04                                             0984 03484000
         BNP   @RF00984                                            0984 03485000
*            NAMECNT = ENTCNT;         /*NO. OF ENTRYNAMES   @YL026UE*/ 03486000
         LH    @04,ENTCNT(,@04)                                    0985 03487000
         STH   @04,NAMECNT                                         0985 03488000
*          ELSE                                                    0986 03489000
*            NAMECNT = 1;              /*LEVEL OR USERID     @YL026UE*/ 03490000
*                                                                  0986 03491000
         B     @RC00984                                            0986 03492000
@RF00984 MVC   NAMECNT(2),@CH00045                                 0986 03493000
*ENTLIST:                                                          0987 03494000
*        DO ENTIDX = 1 TO NAMECNT;                         /*@YL026UE*/ 03495000
@RC00984 DS    0H                                                  0987 03496000
ENTLIST  LA    ENTIDX,1                                            0987 03497000
         B     @DE00987                                            0987 03498000
@DL00987 DS    0H                                                  0988 03499000
*          OLDERID2 = NEWERID2;                                    0988 03500000
         L     @07,@PC00001                                        0988 03501000
         L     @07,GDTTR2(,@07)                                    0988 03502000
         MVC   @TS00001(95),NEWERID2(@07)                          0988 03503000
         MVC   OLDERID2(95,@07),@TS00001                           0988 03504000
*          NEWID2 = 'LCEN';                                        0989 03505000
         MVC   NEWID2(4,@07),@CC01425                              0989 03506000
*          CIRAGL = ''B;                                   /*@YL026UE*/ 03507000
         LA    @07,CIRAREA                                         0990 03508000
         XC    CIRAGL(32,@07),CIRAGL(@07)                          0990 03509000
*          TESTRC = 0;                                     /*@Y30LSMK*/ 03510000
         SLR   TESTRC,TESTRC                                       0991 03511000
*          NOTRQFLG = OFF;                                 /*@Y30SSMK*/ 03512000
         NI    NOTRQFLG,B'01111111'                                0992 03513000
*          NOGENFLG = OFF;                                 /*@Y30SSMK*/ 03514000
         L     @07,COMFLGPT(,COMPTR)                               0993 03515000
         NI    NOGENFLG(@07),B'01111111'                           0993 03516000
*          /**********************************************************/ 03517000
*          /*                                                        */ 03518000
*          /* SPECIAL HANDLING OF TYPE=SPACE SPECIFICATION IS REQ'D  */ 03519000
*          /*                                                        */ 03520000
*          /**********************************************************/ 03521000
*                                                                  0994 03522000
*          IF TYPECNT = 1  &  TYPELIST(1) = CTGTVOL                0994 03523000
*            THEN                                                  0994 03524000
*                                                                  0994 03525000
         L     @07,COMVARPT(,COMPTR)                               0994 03526000
         CLC   TYPECNT(2,@07),@CH00045                             0994 03527000
         BNE   @RF00994                                            0994 03528000
         CLI   TYPELIST(@07),C'V'                                  0994 03529000
         BNE   @RF00994                                            0994 03530000
*              /******************************************************/ 03531000
*              /*                                                    */ 03532000
*              /* FLAG VOLUME SERIAL ENTRIES GREATER THAN 6 CHARS    */ 03533000
*              /* AS A USER ERROR.  BYPASS PROCESSING OF THIS ENTRY. */ 03534000
*              /*                                                    */ 03535000
*              /******************************************************/ 03536000
*                                                                  0995 03537000
*              IF ENTLEN(ENTIDX) > VOLSERLN                        0995 03538000
*                THEN                                              0995 03539000
         LR    @07,ENTIDX                                          0995 03540000
         MH    @07,@CH01583                                        0995 03541000
         L     @02,@PC00001+4                                      0995 03542000
         L     @02,FDTPTR+8(,@02)                                  0995 03543000
         LA    @01,0(@07,@02)                                      0995 03544000
         AL    @01,@CF01601                                        0995 03545000
         SLR   @15,@15                                             0995 03546000
         IC    @15,ENTLEN-22(,@01)                                 0995 03547000
         C     @15,@CF00164                                        0995 03548000
         BNH   @RF00995                                            0995 03549000
*                  DO;                                             0996 03550000
*                  ERRARGPT->DARGSMOD = LC1ID;                     0997 03551000
         L     @01,COMSWKPT(,COMPTR)                               0997 03552000
         L     @14,ERRARGPT(,@01)                                  0997 03553000
         MVC   DARGSMOD(3,@14),@CC01155                            0997 03554000
*                  ERRARGPT->DARGSENT = LCMSG03;                   0998 03555000
         MVI   DARGSENT(@14),X'03'                                 0998 03556000
*                  ERRARGPT->DARGDBP = ADDR(ENTVAL(ENTIDX));       0999 03557000
         AL    @02,@CF01602                                        0999 03558000
         LA    @07,ENTVAL-23(@07,@02)                              0999 03559000
         ST    @07,DARGDBP(,@14)                                   0999 03560000
*                  ERRARGPT->DARGILP = ENTLEN(ENTIDX);             1000 03561000
         STH   @15,DARGILP(,@14)                                   1000 03562000
*                  CALL ERRPROC;                                   1001 03563000
         L     @15,@CV00872                                        1001 03564000
         BALR  @14,@15                                             1001 03565000
*                  BYPASFLG = ON;                                  1002 03566000
         OI    BYPASFLG,B'10000000'                                1002 03567000
*                  SAVRC = MAX (SAVRC, LASTCC04);          /*@ZA05939*/ 03568000
         L     @07,COMVARPT(,COMPTR)                               1003 03569000
         LH    @02,SAVRC(,@07)                                     1003 03570000
         LA    @15,4                                               1003 03571000
         CR    @02,@15                                             1003 03572000
         BNL   *+6                                                      03573000
         LR    @02,@15                                             1003 03574000
         STH   @02,SAVRC(,@07)                                     1003 03575000
*                  END;                                            1004 03576000
*                ELSE                                              1005 03577000
*                                                                  1005 03578000
*                  /**************************************************/ 03579000
*                  /*                                                */ 03580000
*                  /* SETUP THE 44-BYTE KEY FOR THE VOLUME SERIAL NO.*/ 03581000
*                  /* FROM THE FDT EXTRACT THE 6-BYTE SERIAL NUMBER  */ 03582000
*                  /* WHICH HAS BEEN PADDED WITH BLANKS.  AND PAD    */ 03583000
*                  /* THE REMAINING 38 BYTES WITH BINARY ZEROES.     */ 03584000
*                  /*                                                */ 03585000
*                  /**************************************************/ 03586000
*                                                                  1005 03587000
*                  DO;                                             1005 03588000
         B     @RC00995                                            1005 03589000
@RF00995 DS    0H                                                  1006 03590000
*                  ENTNAME = ZEROAREA;                             1006 03591000
         MVC   ENTNAME(44),ZEROAREA                                1006 03592000
*                  ENTNAME(1:VOLSERLN) = ENTVAL(ENTIDX,1:VOLSERLN);     03593000
         LR    @07,ENTIDX                                          1007 03594000
         MH    @07,@CH01583                                        1007 03595000
         L     @02,@PC00001+4                                      1007 03596000
         L     @02,FDTPTR+8(,@02)                                  1007 03597000
         ALR   @02,@07                                             1007 03598000
         AL    @02,@CF01602                                        1007 03599000
         MVC   ENTNAME(6),ENTVAL-23(@02)                           1007 03600000
*                  ENTNM = ENTNAME;                        /*@YL026UE*/ 03601000
         MVC   ENTNM(44),ENTNAME                                   1008 03602000
*                  OBJNMPTR = ADDR(ENTYNM);                /*@YL026UE*/ 03603000
         L     @07,COMSWKPT(,COMPTR)                               1009 03604000
         LA    @02,ENTYNM                                          1009 03605000
         ST    @02,OBJNMPTR(,@07)                                  1009 03606000
*                  BYPASFLG = OFF;                                 1010 03607000
         NI    BYPASFLG,B'01111111'                                1010 03608000
*                  NOTRQFLG = ON;                          /*@Y30SSMK*/ 03609000
         OI    NOTRQFLG,B'10000000'                                1011 03610000
*                  END;                                            1012 03611000
*            ELSE                                                  1013 03612000
*                                                                  1013 03613000
*              /******************************************************/ 03614000
*              /*                                                    */ 03615000
*              /* FOR NON-SPACE REQUESTS, RESET BYPASS FLAG  @YL026UE*/ 03616000
*              /*                                                    */ 03617000
*              /******************************************************/ 03618000
*                                                                  1013 03619000
*              DO;                                                 1013 03620000
         B     @RC00994                                            1013 03621000
@RF00994 DS    0H                                                  1014 03622000
*              BYPASFLG = OFF;                                     1014 03623000
         NI    BYPASFLG,B'01111111'                                1014 03624000
*              END;                                                1015 03625000
*          /**********************************************************/ 03626000
*          /*                                                        */ 03627000
*          /* PROCEED TO LOCATE THE REQUESTED ENTRY FROM THE CATALOG */ 03628000
*          /* IF NO USER ERROR EXISTS.                               */ 03629000
*          /*                                                        */ 03630000
*          /**********************************************************/ 03631000
*                                                                  1016 03632000
*          IF BYPASFLG = OFF                                       1016 03633000
*            THEN                                                  1016 03634000
@RC00994 TM    BYPASFLG,B'10000000'                                1016 03635000
         BNZ   @RF01016                                            1016 03636000
*ENTLOC:       DO;                                                 1017 03637000
*                                                                  1017 03638000
ENTLOC   DS    0H                                                  1018 03639000
*              /******************************************************/ 03640000
*              /*                                                    */ 03641000
*              /* DETERMINE IF ENTRY IS PASSWORD PROTECTED AND       */ 03642000
*              /* USE THE ENTRY LEVEL PASSWORD ONLY IF THE CATALOG   */ 03643000
*              /* PASSWORD IS NOT KNOWN.                             */ 03644000
*              /*                                                    */ 03645000
*              /******************************************************/ 03646000
*                                                                  1018 03647000
*              IF ADDR(CATNM) > 0 & CATNMPLN > 0                   1018 03648000
*                THEN                                              1018 03649000
         L     @07,@PC00001+4                                      1018 03650000
         L     @07,FDTPTR+40(,@07)                                 1018 03651000
         LTR   @07,@07                                             1018 03652000
         BNP   @RF01018                                            1018 03653000
         CLI   CATNMPLN(@07),0                                     1018 03654000
         BNH   @RF01018                                            1018 03655000
*                  CTGPSWD = ADDR(CATNMPAS);                       1019 03656000
         L     @02,COMSWKPT(,COMPTR)                               1019 03657000
         L     @02,CTGPLPTR(,@02)                                  1019 03658000
         LA    @07,CATNMPAS(,@07)                                  1019 03659000
         ST    @07,CTGPSWD(,@02)                                   1019 03660000
*                ELSE                                              1020 03661000
*                  IF ENTPLN(ENTIDX) > 0                           1020 03662000
*                    THEN                                          1020 03663000
         B     @RC01018                                            1020 03664000
@RF01018 LR    @07,ENTIDX                                          1020 03665000
         MH    @07,@CH01583                                        1020 03666000
         L     @02,@PC00001+4                                      1020 03667000
         L     @02,FDTPTR+8(,@02)                                  1020 03668000
         LA    @01,0(@07,@02)                                      1020 03669000
         AL    @01,@CF01603                                        1020 03670000
         SLR   @00,@00                                             1020 03671000
         IC    @00,ENTPLN-2(,@01)                                  1020 03672000
         C     @00,@CF00123                                        1020 03673000
         BNH   @RF01020                                            1020 03674000
*                      CTGPSWD = ADDR(ENTPAS(ENTIDX));             1021 03675000
         L     @01,COMSWKPT(,COMPTR)                               1021 03676000
         L     @01,CTGPLPTR(,@01)                                  1021 03677000
         AL    @02,@CF01604                                        1021 03678000
         LA    @07,ENTPAS-3(@07,@02)                               1021 03679000
         ST    @07,CTGPSWD(,@01)                                   1021 03680000
*                    ELSE                                          1022 03681000
*                      CTGPSWD = NULLPTR;                          1022 03682000
         B     @RC01020                                            1022 03683000
@RF01020 L     @07,COMSWKPT(,COMPTR)                               1022 03684000
         L     @07,CTGPLPTR(,@07)                                  1022 03685000
         SLR   @02,@02                                             1022 03686000
         ST    @02,CTGPSWD(,@07)                                   1022 03687000
*              /******************************************************/ 03688000
*              /*                                            @YL026UE*/ 03689000
*              /* CONTROL FOR LOCATING CATALOG ACB WHEN NEEDED       */ 03690000
*              /*                                            @YL026UE*/ 03691000
*              /******************************************************/ 03692000
*                                                                  1023 03693000
*              IF ADDR(CATNM) = NULLPTR                            1023 03694000
*                THEN                                              1023 03695000
@RC01020 DS    0H                                                  1023 03696000
@RC01018 L     @07,@PC00001+4                                      1023 03697000
         L     @07,FDTPTR+40(,@07)                                 1023 03698000
         LTR   @07,@07                                             1023 03699000
         BNZ   @RF01023                                            1023 03700000
*                  DO;                                     /*@YL026UE*/ 03701000
*                    CTGGTALL = ON;    /*SEARCH ALL CATGS    @YL026UE*/ 03702000
         L     @07,COMSWKPT(,COMPTR)                               1025 03703000
         L     @07,CTGPLPTR(,@07)                                  1025 03704000
         OI    CTGGTALL(@07),B'01000000'                           1025 03705000
*                    IF CACBFLG ^= ON                              1026 03706000
*                      THEN                                        1026 03707000
         L     @02,COMFLGPT(,COMPTR)                               1026 03708000
         TM    CACBFLG(@02),B'10000000'                            1026 03709000
         BO    @RF01026                                            1026 03710000
*                        DO;                               /*@YL026UE*/ 03711000
*                          CACBFLG = ON;                   /*@YL026UE*/ 03712000
         OI    CACBFLG(@02),B'10000000'                            1028 03713000
*                          CTGCAT = ADDR(CATNAME);         /*@YL026UE*/ 03714000
         L     @02,COMVARPT(,COMPTR)                               1029 03715000
         LA    @15,CATNAME(,@02)                                   1029 03716000
         ST    @15,CTGCAT(,@07)                                    1029 03717000
*                          CTGCNAME = ON;                  /*@YL026UE*/ 03718000
         OI    CTGCNAME(@07),B'00000010'                           1030 03719000
*                          CTGNOFLD = CTGNOFLD + 1;        /*@YL026UE*/ 03720000
         LA    @15,1                                               1031 03721000
         SLR   @14,@14                                             1031 03722000
         IC    @14,CTGNOFLD(,@07)                                  1031 03723000
         ALR   @14,@15                                             1031 03724000
         STC   @14,CTGNOFLD(,@07)                                  1031 03725000
*                          FPLCNT = FPLCNT + 1;            /*@YL026UE*/ 03726000
         LH    @07,FPLCNT(,@02)                                    1032 03727000
         ALR   @07,@15                                             1032 03728000
         STH   @07,FPLCNT(,@02)                                    1032 03729000
*                          FPLEND = FPLEND + 1;            /*@ZA05939*/ 03730000
         AH    @15,FPLEND(,@02)                                    1033 03731000
         STH   @15,FPLEND(,@02)                                    1033 03732000
*                          CATNAME = BLANK;                /*@YL026UE*/ 03733000
         MVI   CATNAME+1(@02),C' '                                 1034 03734000
         MVC   CATNAME+2(42,@02),CATNAME+1(@02)                    1034 03735000
         MVI   CATNAME(@02),C' '                                   1034 03736000
*                        END;                              /*@YL026UE*/ 03737000
*                  END;                                    /*@YL026UE*/ 03738000
*                                                                  1036 03739000
@RF01026 DS    0H                                                  1037 03740000
*              /******************************************************/ 03741000
*              /*                                            @YL026UE*/ 03742000
*              /* GET THE APPROPRIATE OBJECT NAME, OR OBJECT NAME    */ 03743000
*              /* LIST.                                      @YL026UE*/ 03744000
*              /* IS IT AN ENTRY NAME? IF YES, THEN IS IT A  @YL026UE*/ 03745000
*              /* GENERIC NAME (UCIR MACRO), OR AN UNQUALIFIED NAME  */ 03746000
*              /* (UQUAL MACRO), OR A FULLY QUALIFIED ENTRY NAME?    */ 03747000
*              /* IS IT A LEVEL NAME OR USERID (UCIR MACRO)? @YL026UE*/ 03748000
*              /* OBTAIN OBJECT NAME(S), AND SET UP APPROPRIATE      */ 03749000
*              /* ADDRESSING.                                @YL026UE*/ 03750000
*              /*                                            @YL026UE*/ 03751000
*              /******************************************************/ 03752000
*                                                                  1037 03753000
*              IF ADDR(ENT) > NULLPTR & TYPELIST(1) ^= 'V'         1037 03754000
*                THEN                                              1037 03755000
@RF01023 SLR   @07,@07                                             1037 03756000
         L     @02,@PC00001+4                                      1037 03757000
         L     @02,FDTPTR+8(,@02)                                  1037 03758000
         CR    @02,@07                                             1037 03759000
         BNH   @RF01037                                            1037 03760000
         L     @01,COMVARPT(,COMPTR)                               1037 03761000
         CLI   TYPELIST(@01),C'V'                                  1037 03762000
         BE    @RF01037                                            1037 03763000
*                  DO;                                     /*@YL026UE*/ 03764000
*                    IF ENTPOS(ENTIDX) > 0                         1039 03765000
*                      THEN            /*SET UP FOR UCIR MACRO       */ 03766000
         LR    @15,ENTIDX                                          1039 03767000
         MH    @15,@CH01583                                        1039 03768000
         LA    @01,0(@15,@02)                                      1039 03769000
         AL    @01,@CF01605                                        1039 03770000
         SLR   @14,@14                                             1039 03771000
         IC    @14,ENTPOS-11(,@01)                                 1039 03772000
         CR    @14,@07                                             1039 03773000
         BNH   @RF01039                                            1039 03774000
*                        DO;                               /*@YL026UE*/ 03775000
*                          CIRPWD = 0;                     /*@YL026UE*/ 03776000
         LA    @04,CIRAREA                                         1041 03777000
         ST    @07,CIRPWD(,@04)                                    1041 03778000
*                          CIRCAT = 0;                     /*@YL026UE*/ 03779000
         ST    @07,CIRCAT(,@04)                                    1042 03780000
*                          CIRTYP1Q = ON;                  /*@YL026UE*/ 03781000
         OI    CIRTYP1Q(@04),B'10000000'                           1043 03782000
*                          CIRHLN = ENTPOS(ENTIDX) - 1;    /*@YL026UE*/ 03783000
         LR    @01,@14                                             1044 03784000
         BCTR  @01,0                                               1044 03785000
         STH   @01,CIRHLN(,@04)                                    1044 03786000
*                          CIRTLN = ENTLEN(ENTIDX) - ENTPOS(ENTIDX);    03787000
         LCR   @14,@14                                             1045 03788000
         LA    @01,0(@15,@02)                                      1045 03789000
         AL    @01,@CF01601                                        1045 03790000
         SLR   @00,@00                                             1045 03791000
         IC    @00,ENTLEN-22(,@01)                                 1045 03792000
         ALR   @14,@00                                             1045 03793000
         STH   @14,CIRTLN(,@04)                                    1045 03794000
*                          CIRHDR = ADDR(ENTVAL(ENTIDX));  /*@YL026UE*/ 03795000
         AL    @02,@CF01602                                        1046 03796000
         LA    @02,ENTVAL-23(@15,@02)                              1046 03797000
         ST    @02,CIRHDR(,@04)                                    1046 03798000
*                          IF CIRTLN = 0                           1047 03799000
*                            THEN                                  1047 03800000
         CR    @14,@07                                             1047 03801000
         BNE   @RF01047                                            1047 03802000
*                              CIRTLR = 0;                 /*@YL026UE*/ 03803000
         ST    @07,CIRTLR(,@04)                                    1048 03804000
*                            ELSE                                  1049 03805000
*                              CIRTLR = ADDR(ENTVAL(ENTIDX))       1049 03806000
*                                       + ENTPOS(ENTIDX);  /*@YL026UE*/ 03807000
         B     @RC01047                                            1049 03808000
@RF01047 LA    @07,CIRAREA                                         1049 03809000
         LR    @04,ENTIDX                                          1049 03810000
         MH    @04,@CH01583                                        1049 03811000
         L     @02,@PC00001+4                                      1049 03812000
         L     @02,FDTPTR+8(,@02)                                  1049 03813000
         LA    @01,0(@04,@02)                                      1049 03814000
         AL    @01,@CF01602                                        1049 03815000
         AL    @02,@CF01605                                        1049 03816000
         SLR   @00,@00                                             1049 03817000
         IC    @00,ENTPOS-11(@04,@02)                              1049 03818000
         ALR   @01,@00                                             1049 03819000
         ST    @01,CIRTLR(,@07)                                    1049 03820000
*                          CIRWKP = ADDR(OBJNMPTR);        /*@YL026UE*/ 03821000
@RC01047 LA    @07,CIRAREA                                         1050 03822000
         L     @04,COMSWKPT(,COMPTR)                               1050 03823000
         LA    @04,OBJNMPTR(,@04)                                  1050 03824000
         ST    @04,CIRWKP(,@07)                                    1050 03825000
*                          CIRPID = GPID10;                /*@ZA05939*/ 03826000
         MVC   CIRPID(4,@07),@CC01261                              1051 03827000
*                          IF ENTPLN(ENTIDX) > 0                   1052 03828000
*                            THEN                                  1052 03829000
         LR    @04,ENTIDX                                          1052 03830000
         MH    @04,@CH01583                                        1052 03831000
         L     @02,@PC00001+4                                      1052 03832000
         L     @02,FDTPTR+8(,@02)                                  1052 03833000
         LA    @01,0(@04,@02)                                      1052 03834000
         AL    @01,@CF01603                                        1052 03835000
         SLR   @00,@00                                             1052 03836000
         IC    @00,ENTPLN-2(,@01)                                  1052 03837000
         C     @00,@CF00123                                        1052 03838000
         BNH   @RF01052                                            1052 03839000
*                              CIRPWD = ADDR(ENTPAS(ENTIDX));      1053 03840000
         AL    @02,@CF01604                                        1053 03841000
         LA    @04,ENTPAS-3(@04,@02)                               1053 03842000
         ST    @04,CIRPWD(,@07)                                    1053 03843000
*                          IF ADDR(CATNM) > NULLPTR                1054 03844000
*                            THEN                                  1054 03845000
@RF01052 L     @07,@PC00001+4                                      1054 03846000
         L     @07,FDTPTR+40(,@07)                                 1054 03847000
         LTR   @07,@07                                             1054 03848000
         BNP   @RF01054                                            1054 03849000
*                              DO;                         /*@YL026UE*/ 03850000
*                                CIRCAT = ADDR(CATNMVAL);  /*@YL026UE*/ 03851000
         LA    @04,CIRAREA                                         1056 03852000
         LA    @02,CATNMVAL(,@07)                                  1056 03853000
         ST    @02,CIRCAT(,@04)                                    1056 03854000
*                                IF CATNMPLN > 0                   1057 03855000
*                                  THEN                            1057 03856000
         CLI   CATNMPLN(@07),0                                     1057 03857000
         BNH   @RF01057                                            1057 03858000
*                                    CIRPWD = ADDR(CATNMPAS);      1058 03859000
         LA    @07,CATNMPAS(,@07)                                  1058 03860000
         ST    @07,CIRPWD(,@04)                                    1058 03861000
*                              END;                        /*@YL026UE*/ 03862000
*                                                                  1059 03863000
@RF01057 DS    0H                                                  1060 03864000
*                          /******************************************/ 03865000
*                          /*                                @YL026UE*/ 03866000
*                          /* ISSUE UCIR MACRO               @YL026UE*/ 03867000
*                          /*                                @YL026UE*/ 03868000
*                          /******************************************/ 03869000
*                                                                  1060 03870000
*                          CALL IDCSACR0(GDTTBL,CIRAGL);   /*@YL026UE*/ 03871000
*                                                                  1060 03872000
@RF01054 L     @07,@PC00001                                        1060 03873000
         ST    @07,@AL00001                                        1060 03874000
         LA    @02,CIRAREA                                         1060 03875000
         ST    @02,@AL00001+4                                      1060 03876000
         MVI   @AL00001+4,X'80'                                    1060 03877000
         L     @15,GDTCIR(,@07)                                    1060 03878000
         LA    @01,@AL00001                                        1060 03879000
         BALR  @14,@15                                             1060 03880000
*                          RESPECIFY RTNREG RSTD;                  1061 03881000
*                          TESTRC = RTNREG;                        1062 03882000
         LR    TESTRC,RTNREG                                       1062 03883000
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30LSMK*/ 03884000
*                        END;                              /*@YL026UE*/ 03885000
*                      ELSE                                        1065 03886000
*                        DO;           /*MOVE ENTRY NAME TO OVLY AREA*/ 03887000
         B     @RC01039                                            1065 03888000
@RF01039 DS    0H                                                  1066 03889000
*                          ENTNM = ENTVAL(ENTIDX);         /*@YL026UE*/ 03890000
         LR    @07,ENTIDX                                          1066 03891000
         MH    @07,@CH01583                                        1066 03892000
         L     @02,@PC00001+4                                      1066 03893000
         L     @02,FDTPTR+8(,@02)                                  1066 03894000
         ST    @07,@TF00001                                        1066 03895000
         ALR   @07,@02                                             1066 03896000
         AL    @07,@CF01602                                        1066 03897000
         MVC   ENTNM(44),ENTVAL-23(@07)                            1066 03898000
*                          OBJNMPTR = ADDR(ENTYNM);        /*@YL026UE*/ 03899000
         L     @07,COMSWKPT(,COMPTR)                               1067 03900000
         LA    @15,ENTYNM                                          1067 03901000
         ST    @15,OBJNMPTR(,@07)                                  1067 03902000
*                          NOTRQFLG = ON;                  /*@Y30SSMK*/ 03903000
         OI    NOTRQFLG,B'10000000'                                1068 03904000
*                          NOGENFLG = ON;                  /*@Y30SSMK*/ 03905000
         L     @07,COMFLGPT(,COMPTR)                               1069 03906000
         OI    NOGENFLG(@07),B'10000000'                           1069 03907000
*                          IF ENTFUQ(ENTIDX) = ON                  1070 03908000
*                            THEN                                  1070 03909000
         LR    @07,@02                                             1070 03910000
         AL    @07,@TF00001                                        1070 03911000
         AL    @07,@CF01606                                        1070 03912000
         TM    ENTFUQ-12(@07),B'10000000'                          1070 03913000
         BNO   @RF01070                                            1070 03914000
*                              DO;     /*SET UP FOR UQUAL MACRO      */ 03915000
*                                UQCATPTR = 0;             /*@YL026UE*/ 03916000
         SLR   @07,@07                                             1072 03917000
         ST    @07,UQCATPTR                                        1072 03918000
*                                UQPASPTR = 0;             /*@YL026UE*/ 03919000
         ST    @07,UQPASPTR                                        1073 03920000
*                                UQENTPTR = ADDR(ENTNM);   /*@YL026UE*/ 03921000
         LA    @04,ENTNM                                           1074 03922000
         ST    @04,UQENTPTR                                        1074 03923000
*                                UQENTLEN = ENTLEN(ENTIDX);/*@YL026UE*/ 03924000
         L     @04,@TF00001                                        1075 03925000
         AL    @04,@CF01601                                        1075 03926000
         SLR   @15,@15                                             1075 03927000
         IC    @15,ENTLEN-22(@04,@02)                              1075 03928000
         STH   @15,UQENTLEN                                        1075 03929000
*                                IF ENTPLN(ENTIDX) > 0             1076 03930000
*                                  THEN                            1076 03931000
         L     @04,@TF00001                                        1076 03932000
         AL    @04,@CF01603                                        1076 03933000
         SLR   @15,@15                                             1076 03934000
         IC    @15,ENTPLN-2(@04,@02)                               1076 03935000
         CR    @07,@15                                             1076 03936000
         BNL   @RF01076                                            1076 03937000
*                                    UQPASPTR = ADDR(ENTPAS(ENTIDX));   03938000
         L     @07,@TF00001                                        1077 03939000
         AL    @02,@CF01604                                        1077 03940000
         LA    @07,ENTPAS-3(@07,@02)                               1077 03941000
         ST    @07,UQPASPTR                                        1077 03942000
*                                IF ADDR(CATNM) > NULLPTR          1078 03943000
*                                  THEN                            1078 03944000
@RF01076 L     @07,@PC00001+4                                      1078 03945000
         L     @07,FDTPTR+40(,@07)                                 1078 03946000
         LTR   @07,@07                                             1078 03947000
         BNP   @RF01078                                            1078 03948000
*                                    DO;                   /*@YL026UE*/ 03949000
*                                      UQCATPTR = ADDR(CATNMVAL);  1080 03950000
         LA    @04,CATNMVAL(,@07)                                  1080 03951000
         ST    @04,UQCATPTR                                        1080 03952000
*                                      IF CATNMPLN > 0             1081 03953000
*                                        THEN                      1081 03954000
         CLI   CATNMPLN(@07),0                                     1081 03955000
         BNH   @RF01081                                            1081 03956000
*                                          UQPASPTR = ADDR(CATNMPAS);   03957000
         LA    @07,CATNMPAS(,@07)                                  1082 03958000
         ST    @07,UQPASPTR                                        1082 03959000
*                                    END;                  /*@YL026UE*/ 03960000
*                                                                  1083 03961000
@RF01081 DS    0H                                                  1084 03962000
*                                /************************************/ 03963000
*                                /*                          @YL026UE*/ 03964000
*                                /* ISSUE UQUAL MACRO        @YL026UE*/ 03965000
*                                /*                          @YL026UE*/ 03966000
*                                /************************************/ 03967000
*                                                                  1084 03968000
*                             CALL IDCSAQL0 (GDTTBL,UQENTPTR,UQENTLEN,  03969000
*                                       UQCATPTR,UQPASPTR);/*@YL026UE*/ 03970000
*                                                                  1084 03971000
@RF01078 L     @07,@PC00001                                        1084 03972000
         ST    @07,@AL00001                                        1084 03973000
         LA    @02,UQENTPTR                                        1084 03974000
         ST    @02,@AL00001+4                                      1084 03975000
         LA    @02,UQENTLEN                                        1084 03976000
         ST    @02,@AL00001+8                                      1084 03977000
         LA    @02,UQCATPTR                                        1084 03978000
         ST    @02,@AL00001+12                                     1084 03979000
         LA    @02,UQPASPTR                                        1084 03980000
         ST    @02,@AL00001+16                                     1084 03981000
         MVI   @AL00001+16,X'80'                                   1084 03982000
         L     @15,GDTQAL(,@07)                                    1084 03983000
         LA    @01,@AL00001                                        1084 03984000
         BALR  @14,@15                                             1084 03985000
*                                RESPECIFY RTNREG RSTD;            1085 03986000
*                                TESTRC = RTNREG;                  1086 03987000
         LR    TESTRC,RTNREG                                       1086 03988000
*                                RESPECIFY RTNREG UNRSTD;  /*@Y30LSMK*/ 03989000
*                              END;                        /*@YL026UE*/ 03990000
*                        END;                              /*@YL026UE*/ 03991000
@RF01070 DS    0H                                                  1090 03992000
*                  END;                                    /*@YL026UE*/ 03993000
*                                                                  1090 03994000
@RC01039 DS    0H                                                  1091 03995000
*              /******************************************************/ 03996000
*              /*                                            @YL026UE*/ 03997000
*              /* LEVEL OR USERID OBJECT NAME? SET UP FOR UCIR MACRO */ 03998000
*              /*                                            @YL026UE*/ 03999000
*              /******************************************************/ 04000000
*                                                                  1091 04001000
*              IF ADDR(LVL) > NULLPTR | (UIDLN > 0 & ADDR(ENT)=NULLPTR) 04002000
*                THEN                                              1091 04003000
@RF01037 SLR   @07,@07                                             1091 04004000
         L     @02,@PC00001+4                                      1091 04005000
         C     @07,FDTPTR+80(,@02)                                 1091 04006000
         BL    @RT01091                                            1091 04007000
         CH    @07,UIDLN                                           1091 04008000
         BNL   @RF01091                                            1091 04009000
         C     @07,FDTPTR+8(,@02)                                  1091 04010000
         BNE   @RF01091                                            1091 04011000
@RT01091 DS    0H                                                  1092 04012000
*                  DO;                                     /*@YL026UE*/ 04013000
*                    CIRPWD = 0;                           /*@YL026UE*/ 04014000
         SLR   @07,@07                                             1093 04015000
         LA    @04,CIRAREA                                         1093 04016000
         ST    @07,CIRPWD(,@04)                                    1093 04017000
*                    IF ADDR(LVL) > NULLPTR                        1094 04018000
*                      THEN                                        1094 04019000
         L     @04,@PC00001+4                                      1094 04020000
         L     @04,FDTPTR+80(,@04)                                 1094 04021000
         CR    @04,@07                                             1094 04022000
         BNH   @RF01094                                            1094 04023000
*                        DO;           /*SET UP LEVEL NAME FOR UCIR  */ 04024000
*                          IF LVLVAL(LVLLEN) = '*' | LVLVAL(1) = '*'    04025000
*                            THEN                                  1096 04026000
         SLR   @07,@07                                             1096 04027000
         IC    @07,LVLLEN(,@04)                                    1096 04028000
         ALR   @07,@04                                             1096 04029000
         CLI   LVLVAL-1(@07),C'*'                                  1096 04030000
         BE    @RT01096                                            1096 04031000
         CLI   LVLVAL(@04),C'*'                                    1096 04032000
         BNE   @RF01096                                            1096 04033000
@RT01096 DS    0H                                                  1097 04034000
*                              DO;     /*LVL NAME ERROR      @YL026UE*/ 04035000
*                                ERRARGPT->DARGSMOD=LC1ID; /*@YL026UE*/ 04036000
         L     @04,COMSWKPT(,COMPTR)                               1098 04037000
         L     @04,ERRARGPT(,@04)                                  1098 04038000
         MVC   DARGSMOD(3,@04),@CC01155                            1098 04039000
*                                ERRARGPT->DARGSENT=LCMSG11;       1099 04040000
         MVI   DARGSENT(@04),X'0B'                                 1099 04041000
*                                ERRARGPT->DARGDBP                 1100 04042000
*                                 =ADDR(LVLVAL);           /*@YL026UE*/ 04043000
         L     @02,@PC00001+4                                      1100 04044000
         L     @02,FDTPTR+80(,@02)                                 1100 04045000
         LA    @15,LVLVAL(,@02)                                    1100 04046000
         ST    @15,DARGDBP(,@04)                                   1100 04047000
*                                ERRARGPT->DARGILP                 1101 04048000
*                                 =LVLLEN;                 /*@YL026UE*/ 04049000
         SLR   @15,@15                                             1101 04050000
         IC    @15,LVLLEN(,@02)                                    1101 04051000
         STH   @15,DARGILP(,@04)                                   1101 04052000
*                                RETURN CODE(LASTCC12);    /*@YL026UE*/ 04053000
         LA    @15,12                                              1102 04054000
         L     @14,@SA00004                                        1102 04055000
         LM    @00,@12,@SA00004+8                                  1102 04056000
         BR    @14                                                 1102 04057000
*                              END;                        /*@YL026UE*/ 04058000
*                          IF LVLPOS = 0                           1104 04059000
*                            THEN                                  1104 04060000
@RF01096 L     @07,@PC00001+4                                      1104 04061000
         L     @07,FDTPTR+80(,@07)                                 1104 04062000
         CLI   LVLPOS(@07),0                                       1104 04063000
         BNE   @RF01104                                            1104 04064000
*                              DO;                         /*@YL026UE*/ 04065000
*                              LVLNMWOA=LVLVAL;            /*@YL026UE*/ 04066000
         MVC   LVLNMWOA(44),LVLVAL(@07)                            1106 04067000
*                              LVLNMWOA(LVLLEN+1)='.';     /*@YL026UE*/ 04068000
         SLR   @04,@04                                             1107 04069000
         IC    @04,LVLLEN(,@07)                                    1107 04070000
         LA    @07,LVLNMWOA(@04)                                   1107 04071000
         MVI   0(@07),C'.'                                         1107 04072000
*                              CIRHLN=LVLLEN+1;            /*@YL026UE*/ 04073000
         LA    @07,CIRAREA                                         1108 04074000
         AL    @04,@CF00045                                        1108 04075000
         STH   @04,CIRHLN(,@07)                                    1108 04076000
*                              CIRHDR=ADDR(LVLNMWOA);      /*@YL026UE*/ 04077000
         LA    @04,LVLNMWOA                                        1109 04078000
         ST    @04,CIRHDR(,@07)                                    1109 04079000
*                              END;                        /*@YL026UE*/ 04080000
*                            ELSE                                  1111 04081000
*                              DO;                         /*@YL026UE*/ 04082000
         B     @RC01104                                            1111 04083000
@RF01104 DS    0H                                                  1112 04084000
*                              CIRHLN=LVLPOS-1;            /*@YL026UE*/ 04085000
         LA    @07,CIRAREA                                         1112 04086000
         L     @04,@PC00001+4                                      1112 04087000
         L     @04,FDTPTR+80(,@04)                                 1112 04088000
         SLR   @02,@02                                             1112 04089000
         IC    @02,LVLPOS(,@04)                                    1112 04090000
         LR    @15,@02                                             1112 04091000
         BCTR  @15,0                                               1112 04092000
         STH   @15,CIRHLN(,@07)                                    1112 04093000
*                              CIRTLN=LVLLEN-LVLPOS;       /*@YL026UE*/ 04094000
         SLR   @15,@15                                             1113 04095000
         IC    @15,LVLLEN(,@04)                                    1113 04096000
         SLR   @15,@02                                             1113 04097000
         STH   @15,CIRTLN(,@07)                                    1113 04098000
*                              CIRHDR=ADDR(LVLVAL);        /*@YL026UE*/ 04099000
         LA    @04,LVLVAL(,@04)                                    1114 04100000
         ST    @04,CIRHDR(,@07)                                    1114 04101000
*                              CIRTLR=ADDR(LVLVAL)+LVLPOS; /*@YL026UE*/ 04102000
         ALR   @04,@02                                             1115 04103000
         ST    @04,CIRTLR(,@07)                                    1115 04104000
*                              END;                        /*@YL026UE*/ 04105000
*                        END;                              /*@YL026UE*/ 04106000
*                      ELSE                                        1118 04107000
*                        DO;           /*SET UP USERID NAME FOR UCIR */ 04108000
         B     @RC01094                                            1118 04109000
@RF01094 DS    0H                                                  1119 04110000
*                          CIRHLN = UIDLN+1;               /*@YL026UE*/ 04111000
         LA    @07,CIRAREA                                         1119 04112000
         LH    @04,UIDLN                                           1119 04113000
         LA    @02,1                                               1119 04114000
         ALR   @02,@04                                             1119 04115000
         STH   @02,CIRHLN(,@07)                                    1119 04116000
*                          CIRTLN = 0;                     /*@YL026UE*/ 04117000
         SLR   @02,@02                                             1120 04118000
         STH   @02,CIRTLN(,@07)                                    1120 04119000
*                          LVLNMWOA=UIDNM;                 /*@YL026UE*/ 04120000
         MVI   LVLNMWOA+7,C' '                                     1121 04121000
         MVC   LVLNMWOA+8(36),LVLNMWOA+7                           1121 04122000
         MVC   LVLNMWOA(7),UIDNM                                   1121 04123000
*                          LVLNMWOA(UIDLN+1)='.';          /*@YL026UE*/ 04124000
         LA    @01,LVLNMWOA(@04)                                   1122 04125000
         MVI   0(@01),C'.'                                         1122 04126000
*                          CIRHDR = ADDR(LVLNMWOA);        /*@YL026UE*/ 04127000
         LA    @04,LVLNMWOA                                        1123 04128000
         ST    @04,CIRHDR(,@07)                                    1123 04129000
*                          CIRTLR = 0;                     /*@YL026UE*/ 04130000
         ST    @02,CIRTLR(,@07)                                    1124 04131000
*                        END;                              /*@YL026UE*/ 04132000
*                    CIRTYPAQ = ON;                        /*@YL026UE*/ 04133000
@RC01094 LA    @07,CIRAREA                                         1126 04134000
         OI    CIRTYPAQ(@07),B'01000000'                           1126 04135000
*                    CIRWKP = ADDR(OBJNMPTR);              /*@YL026UE*/ 04136000
         L     @04,COMSWKPT(,COMPTR)                               1127 04137000
         LA    @04,OBJNMPTR(,@04)                                  1127 04138000
         ST    @04,CIRWKP(,@07)                                    1127 04139000
*                    CIRPID = GPID10;                      /*@ZA05939*/ 04140000
         MVC   CIRPID(4,@07),@CC01261                              1128 04141000
*                    IF ADDR(CATNM) > NULLPTR                      1129 04142000
*                      THEN                                        1129 04143000
         L     @04,@PC00001+4                                      1129 04144000
         L     @04,FDTPTR+40(,@04)                                 1129 04145000
         LTR   @04,@04                                             1129 04146000
         BNP   @RF01129                                            1129 04147000
*                        DO;                               /*@YL026UE*/ 04148000
*                          CIRCAT = ADDR(CATNMVAL);        /*@YL026UE*/ 04149000
         LA    @02,CATNMVAL(,@04)                                  1131 04150000
         ST    @02,CIRCAT(,@07)                                    1131 04151000
*                          IF CATNMPLN > 0                         1132 04152000
*                            THEN                                  1132 04153000
         CLI   CATNMPLN(@04),0                                     1132 04154000
         BNH   @RF01132                                            1132 04155000
*                              CIRPWD = ADDR(CATNMPAS);    /*@YL026UE*/ 04156000
         LA    @04,CATNMPAS(,@04)                                  1133 04157000
         ST    @04,CIRPWD(,@07)                                    1133 04158000
*                        END;                              /*@YL026UE*/ 04159000
*                                                                  1134 04160000
@RF01132 DS    0H                                                  1135 04161000
*                    /************************************************/ 04162000
*                    /*                                      @YL026UE*/ 04163000
*                    /* ISSUE UCIR MACRO                     @YL026UE*/ 04164000
*                    /*                                      @YL026UE*/ 04165000
*                    /************************************************/ 04166000
*                                                                  1135 04167000
*                    CALL IDCSACR0(GDTTBL,CIRAGL);         /*@YL026UE*/ 04168000
*                                                                  1135 04169000
@RF01129 L     @07,@PC00001                                        1135 04170000
         ST    @07,@AL00001                                        1135 04171000
         LA    @02,CIRAREA                                         1135 04172000
         ST    @02,@AL00001+4                                      1135 04173000
         MVI   @AL00001+4,X'80'                                    1135 04174000
         L     @15,GDTCIR(,@07)                                    1135 04175000
         LA    @01,@AL00001                                        1135 04176000
         BALR  @14,@15                                             1135 04177000
*                    RESPECIFY RTNREG RSTD;                        1136 04178000
*                    TESTRC = RTNREG;                              1137 04179000
         LR    TESTRC,RTNREG                                       1137 04180000
*                    RESPECIFY RTNREG UNRSTD;              /*@ZA05939*/ 04181000
*                  END;                                    /*@YL026UE*/ 04182000
*              /*********************************************@ZA01484*/ 04183000
*              /*                                            @ZA01484*/ 04184000
*              /* PRODUCE AN ABBREVIATED LIST OF DATA SET    @ZA01484*/ 04185000
*              /* NAMES FOR THE TSO USER  FOR DEFAULT PARMS  @ZA01484*/ 04186000
*              /* ALSO PRODUCE AN ABBREVIATED LIST OF VOLUME @Y30SSMK*/ 04187000
*              /* INFORMATION FOR THE TSO USER WHEN ONLY THE @Y30SSMK*/ 04188000
*              /* VOLUME PARAMETER IS SPECIFIED.             @Y30SSMK*/ 04189000
*              /*                                            @ZA01484*/ 04190000
*              /*********************************************@ZA01484*/ 04191000
*              SHORTFLG = OFF;                             /*@OZ20485*/ 04192000
@RF01091 NI    SHORTFLG,B'01111111'                                1140 04193000
*              SHVOLFLG = OFF;                             /*@OZ20485*/ 04194000
         NI    SHVOLFLG,B'01111111'                                1141 04195000
*              IF UIDLN > 0 & TESTRC = 0 & TYPELIST = TYPECMPR     1142 04196000
*                & ADDR(LVL) = NULLPTR                             1142 04197000
*                & ADDR(ENT) = NULLPTR                             1142 04198000
*                & ADDR(CREAT) = NULLPTR                           1142 04199000
*                & ADDR(EXPIR) = NULLPTR                           1142 04200000
*                & ADDR(HIST) = NULLPTR                            1142 04201000
*                & ADDR(NUSE) = NULLPTR                            1142 04202000
*                & ADDR(FALL) = NULLPTR                            1142 04203000
*                & ADDR(ALLOC) = NULLPTR                           1142 04204000
*                THEN                                              1142 04205000
         SLR   @07,@07                                             1142 04206000
         CH    @07,UIDLN                                           1142 04207000
         BNL   @RF01142                                            1142 04208000
         CR    TESTRC,@07                                          1142 04209000
         BNE   @RF01142                                            1142 04210000
         L     @02,COMVARPT(,COMPTR)                               1142 04211000
         CLC   TYPELIST(11,@02),TYPECMPR                           1142 04212000
         BNE   @RF01142                                            1142 04213000
         L     @02,@PC00001+4                                      1142 04214000
         C     @07,FDTPTR+80(,@02)                                 1142 04215000
         BNE   @RF01142                                            1142 04216000
         C     @07,FDTPTR+8(,@02)                                  1142 04217000
         BNE   @RF01142                                            1142 04218000
         C     @07,FDTPTR+96(,@02)                                 1142 04219000
         BNE   @RF01142                                            1142 04220000
         C     @07,FDTPTR+100(,@02)                                1142 04221000
         BNE   @RF01142                                            1142 04222000
         C     @07,FDTPTR+104(,@02)                                1142 04223000
         BNE   @RF01142                                            1142 04224000
         C     @07,FDTPTR+92(,@02)                                 1142 04225000
         BNE   @RF01142                                            1142 04226000
         C     @07,FDTPTR+56(,@02)                                 1142 04227000
         BNE   @RF01142                                            1142 04228000
         C     @07,FDTPTR+64(,@02)                                 1142 04229000
         BNE   @RF01142                                            1142 04230000
*                  IF ADDR(VOL) = NULLPTR                          1143 04231000
*                    THEN                                          1143 04232000
         C     @07,FDTPTR+60(,@02)                                 1143 04233000
         BNE   @RF01143                                            1143 04234000
*                      DO;                                 /*@ZA01484*/ 04235000
*                      SHORTFLG = ON;                      /*@ZA01484*/ 04236000
         OI    SHORTFLG,B'10000000'                                1145 04237000
*                      CALL SHORTLST;                      /*@ZA01484*/ 04238000
         L     @15,@CV00878                                        1146 04239000
         BALR  @14,@15                                             1146 04240000
*                      END;                                /*@ZA01484*/ 04241000
*                    ELSE                                          1148 04242000
*                      SHVOLFLG = ON;                      /*@Y30SSMK*/ 04243000
         B     @RC01143                                            1148 04244000
@RF01143 OI    SHVOLFLG,B'10000000'                                1148 04245000
*                ELSE;                                     /*@OZ20485*/ 04246000
*                                                                  1149 04247000
@RF01142 DS    0H                                                  1150 04248000
*              /******************************************************/ 04249000
*              /*                                            @YL026UE*/ 04250000
*              /* LOOP CONTROLS FOR  STEPPING THRU THE OBJECT NAME   */ 04251000
*              /* LIST.                                      @YL026UE*/ 04252000
*              /* (1) RETURN CODE FROM UQUAL OR UCIR IS OK.  @YL026UE*/ 04253000
*              /*     IF NOT TRY NEXT NAME OR RETURN.        @YL026UE*/ 04254000
*              /* (2) STEP THRU THE OBJECT NAME LIST.        @YL026UE*/ 04255000
*              /* (3) IF THE OBJECT NAME IS THE NAME OF A CATALOG    */ 04256000
*              /*     ACCESSED BY THE UCIR MACRO, USE THIS CATALOG   */ 04257000
*              /*     NAME IN LOCATING THE FOLLOWING OBJECT NAMES.   */ 04258000
*              /*                                            @YL026UE*/ 04259000
*              /******************************************************/ 04260000
*                                                                  1150 04261000
*              IF TESTRC =  0  &  SHORTFLG = OFF                   1150 04262000
*                THEN                                              1150 04263000
@RC01142 LTR   TESTRC,TESTRC                                       1150 04264000
         BNZ   @RF01150                                            1150 04265000
         TM    SHORTFLG,B'10000000'                                1150 04266000
         BNZ   @RF01150                                            1150 04267000
*OBJLIST:          DO NLST = 1 TO OBJCNT;                  /*@YL026UE*/ 04268000
OBJLIST  LA    @07,1                                               1151 04269000
         B     @DE01151                                            1151 04270000
@DL01151 DS    0H                                                  1152 04271000
*                  CTGGTNXT = OFF;                         /*@YL026UE*/ 04272000
         L     @07,COMSWKPT(,COMPTR)                               1152 04273000
         L     @07,CTGPLPTR(,@07)                                  1152 04274000
         NI    CTGGTNXT(@07),B'11101111'                           1152 04275000
*                  CTGNAME = ON;                           /*@YL026UE*/ 04276000
         OI    CTGNAME(@07),B'00000100'                            1153 04277000
*                  ENTCLFLG = OFF;                         /*@YL026UE*/ 04278000
*                                                                  1154 04279000
*                                                                  1154 04280000
         L     @07,COMFLGPT(,COMPTR)                               1154 04281000
         NI    ENTCLFLG(@07),B'01111111'                           1154 04282000
*        IF GDTDBG = NULLPTR                                       1155 04283000
*          THEN;                                                   1155 04284000
         L     @07,@PC00001                                        1155 04285000
         L     @07,GDTDBG(,@07)                                    1155 04286000
         LTR   @07,@07                                             1155 04287000
         BZ    @RT01155                                            1155 04288000
*          ELSE                                                    1157 04289000
*            DO;                                                   1157 04290000
*              DMPINDEX = ADDR(DOBJNAM);                           /*@Y 04291000
*026UE*/                                                           1158 04292000
*                                                                  1158 04293000
         LA    DMPINDEX,DOBJNAM                                    1158 04294000
*              DMPITMNM = 'CATNAME';                               1159 04295000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1159 04296000
         MVC   DMPITMNM(7,DMPINDEX),@CC01433                       1159 04297000
*              DMPITMPT = ADDR(CATNAME);                           1160 04298000
         L     @07,COMVARPT(,COMPTR)                               1160 04299000
         LA    @04,CATNAME(,@07)                                   1160 04300000
         ST    @04,DMPITMPT(,DMPINDEX)                             1160 04301000
*              DMPITMLN = 44;                                      1161 04302000
         LA    @04,44                                              1161 04303000
         STH   @04,DMPITMLN(,DMPINDEX)                             1161 04304000
*              DMPITMTP = 'C';                                     1162 04305000
         MVI   DMPITMTP(DMPINDEX),C'C'                             1162 04306000
*              DMPINDEX = DMPINDEX + DMPELEMT;         /*@YL026UE*/     04307000
*                                                                  1163 04308000
         LA    @15,16                                              1163 04309000
         ALR   DMPINDEX,@15                                        1163 04310000
*              DMPITMNM = 'OBJCNT';                                1164 04311000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1164 04312000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1164 04313000
         MVC   DMPITMNM(6,DMPINDEX),@CC01434                       1164 04314000
*              DMPITMPT = ADDR(OBJCNT);                            1165 04315000
         L     @14,COMSWKPT(,COMPTR)                               1165 04316000
         L     @01,OBJNMPTR(,@14)                                  1165 04317000
         ST    @01,DMPITMPT(,DMPINDEX)                             1165 04318000
*              DMPITMLN = 4;                                       1166 04319000
         MVC   DMPITMLN(2,DMPINDEX),@CH00050                       1166 04320000
*              DMPITMTP = 'F';                                     1167 04321000
         MVI   DMPITMTP(DMPINDEX),C'F'                             1167 04322000
*              DMPINDEX = DMPINDEX + DMPELEMT;         /*@YL026UE*/     04323000
*                                                                  1168 04324000
         ALR   DMPINDEX,@15                                        1168 04325000
*              DMPITMNM = 'OBJTYP';                                1169 04326000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1169 04327000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1169 04328000
         MVC   DMPITMNM(6,DMPINDEX),@CC01435                       1169 04329000
*              DMPITMPT = ADDR(OBJTYP(NLST));                      1170 04330000
         LH    @00,NLST(,@07)                                      1170 04331000
         MH    @00,@CH01270                                        1170 04332000
         LR    @07,@00                                             1170 04333000
         AL    @07,@CF01607                                        1170 04334000
         LA    @07,OBJTYP-4(@07,@01)                               1170 04335000
         ST    @07,DMPITMPT(,DMPINDEX)                             1170 04336000
*              DMPITMLN = 1;                                       1171 04337000
         LA    @07,1                                               1171 04338000
         STH   @07,DMPITMLN(,DMPINDEX)                             1171 04339000
*              DMPITMTP = 'C';                                     1172 04340000
         MVI   DMPITMTP(DMPINDEX),C'C'                             1172 04341000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1173 04342000
*                                                                  1173 04343000
         ALR   DMPINDEX,@15                                        1173 04344000
*              DMPITMNM = 'OBJNM';                                 1174 04345000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           1174 04346000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         1174 04347000
         MVC   DMPITMNM(5,DMPINDEX),@CC01436                       1174 04348000
*              DMPITMPT = ADDR(OBJNM(NLST));                       1175 04349000
         LR    @07,@00                                             1175 04350000
         AL    @01,@CF01608                                        1175 04351000
         LA    @07,OBJNM-5(@07,@01)                                1175 04352000
         ST    @07,DMPITMPT(,DMPINDEX)                             1175 04353000
*              DMPITMLN = 44;                                      1176 04354000
         STH   @04,DMPITMLN(,DMPINDEX)                             1176 04355000
*              DMPITMTP = 'C';                                     1177 04356000
         MVI   DMPITMTP(DMPINDEX),C'C'                             1177 04357000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1178 04358000
*                                                                  1178 04359000
         ALR   DMPINDEX,@15                                        1178 04360000
*              DMPITMNM = 'CACBFLG';                               1179 04361000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1179 04362000
         MVC   DMPITMNM(7,DMPINDEX),@CC01437                       1179 04363000
*              DMPITMPT = ADDR(CACBFLG);                           1180 04364000
         L     @07,COMFLGPT(,COMPTR)                               1180 04365000
         ST    @07,DMPITMPT(,DMPINDEX)                             1180 04366000
*              DMPITMLN = 1;                                       1181 04367000
         LA    @04,1                                               1181 04368000
         STH   @04,DMPITMLN(,DMPINDEX)                             1181 04369000
*              DMPITMTP = 'B';                                     1182 04370000
         MVI   DMPITMTP(DMPINDEX),C'B'                             1182 04371000
*              DMPINDEX = DMPINDEX + DMPELEMT;          /*@YL026UE*/    04372000
*                                                                  1183 04373000
         ALR   DMPINDEX,@15                                        1183 04374000
*              DMPITMNM = 'CTGOPTN2';                              1184 04375000
         MVC   DMPITMNM(8,DMPINDEX),@CC01438                       1184 04376000
*              DMPITMPT = ADDR(CTGOPTN2);                          1185 04377000
         L     @01,CTGPLPTR(,@14)                                  1185 04378000
         LA    @14,CTGOPTN2(,@01)                                  1185 04379000
         ST    @14,DMPITMPT(,DMPINDEX)                             1185 04380000
*              DMPITMLN = 1;                                       1186 04381000
         STH   @04,DMPITMLN(,DMPINDEX)                             1186 04382000
*              DMPITMTP = 'B';                                     1187 04383000
         MVI   DMPITMTP(DMPINDEX),C'B'                             1187 04384000
*              DMPINDEX = DMPINDEX + DMPELEMT;         /*@YL026UE*/     04385000
*                                                                  1188 04386000
         ALR   DMPINDEX,@15                                        1188 04387000
*              DMPITMNM = 'FLAGS';                                 1189 04388000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           1189 04389000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         1189 04390000
         MVC   DMPITMNM(5,DMPINDEX),@CC01439                       1189 04391000
*              DMPITMPT = ADDR(FLAGS);                             1190 04392000
         ST    @07,DMPITMPT(,DMPINDEX)                             1190 04393000
*              DMPITMLN = 33;                                      1191 04394000
         MVC   DMPITMLN(2,DMPINDEX),@CH01139                       1191 04395000
*              DMPITMTP = 'H';                                     1192 04396000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1192 04397000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1193 04398000
*                                                                  1193 04399000
         ALR   DMPINDEX,@15                                        1193 04400000
*              DMPITMNM = 'TYPECNT';                               1194 04401000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1194 04402000
         MVC   DMPITMNM(7,DMPINDEX),@CC01441                       1194 04403000
*              DMPITMPT = ADDR(TYPECNT);                           1195 04404000
         L     @07,COMVARPT(,COMPTR)                               1195 04405000
         LA    @04,TYPECNT(,@07)                                   1195 04406000
         ST    @04,DMPITMPT(,DMPINDEX)                             1195 04407000
*              DMPITMLN = 2;                                       1196 04408000
         MVC   DMPITMLN(2,DMPINDEX),@CH00161                       1196 04409000
*              DMPITMTP = 'F';                                     1197 04410000
         MVI   DMPITMTP(DMPINDEX),C'F'                             1197 04411000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1198 04412000
*                                                                  1198 04413000
         ALR   DMPINDEX,@15                                        1198 04414000
*              DMPITMNM = 'TYPELIST';                              1199 04415000
         MVC   DMPITMNM(8,DMPINDEX),@CC01442                       1199 04416000
*              DMPITMPT = ADDR(TYPELIST);                          1200 04417000
         LA    @07,TYPELIST(,@07)                                  1200 04418000
         ST    @07,DMPITMPT(,DMPINDEX)                             1200 04419000
*              DMPITMLN = 9;                                       1201 04420000
         MVC   DMPITMLN(2,DMPINDEX),@CH00646                       1201 04421000
*              DMPITMTP = 'C';                                     1202 04422000
         MVI   DMPITMTP(DMPINDEX),C'C'                             1202 04423000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1203 04424000
*                                                                  1203 04425000
         ALR   DMPINDEX,@15                                        1203 04426000
*              DMPTRM = DMPTRMVL;                                  1204 04427000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1204 04428000
*            END;                                           /*@YL026UE* 04429000
*                                                                  1205 04430000
*        IF GDTDBG = NULLPTR                                       1206 04431000
*          THEN;                                                   1206 04432000
@RT01155 L     @07,@PC00001                                        1206 04433000
         L     @07,GDTDBG(,@07)                                    1206 04434000
         LTR   @07,@07                                             1206 04435000
         BZ    @RT01206                                            1206 04436000
*          ELSE                                                    1208 04437000
*            CALL IDCDB010(GDTTBL,'LCOJ',ADDR(DOBJNAM));           1208 04438000
         L     @07,@PC00001                                        1208 04439000
         ST    @07,@AL00001                                        1208 04440000
         LA    @04,@CC01443                                        1208 04441000
         ST    @04,@AL00001+4                                      1208 04442000
         LA    @04,DOBJNAM                                         1208 04443000
         ST    @04,@AFTEMPS                                        1208 04444000
         LA    @04,@AFTEMPS                                        1208 04445000
         ST    @04,@AL00001+8                                      1208 04446000
         MVI   @AL00001+8,X'80'                                    1208 04447000
         L     @15,GDTDBG(,@07)                                    1208 04448000
         LA    @01,@AL00001                                        1208 04449000
         BALR  @14,@15                                             1208 04450000
*                                                          /*@YL026UE*/ 04451000
*                                                                  1209 04452000
*                    IF OBJTYP(NLST) ^= 'F0'X                      1209 04453000
*                      THEN                                        1209 04454000
@RT01206 L     @07,COMVARPT(,COMPTR)                               1209 04455000
         LH    @07,NLST(,@07)                                      1209 04456000
         MH    @07,@CH01270                                        1209 04457000
         L     @04,COMSWKPT(,COMPTR)                               1209 04458000
         L     @04,OBJNMPTR(,@04)                                  1209 04459000
         ALR   @04,@07                                             1209 04460000
         AL    @04,@CF01607                                        1209 04461000
         CLI   OBJTYP-4(@04),X'F0'                                 1209 04462000
         BE    @RF01209                                            1209 04463000
*NOTCATNM:               DO;           /*OBJECTNAME IN CPL FOR LOCATE*/ 04464000
NOTCATNM DS    0H                                                  1211 04465000
*                          CTGENT = ADDR(OBJNM(NLST));     /*@YL026UE*/ 04466000
         L     @07,COMSWKPT(,COMPTR)                               1211 04467000
         L     @02,CTGPLPTR(,@07)                                  1211 04468000
         L     @15,COMVARPT(,COMPTR)                               1211 04469000
         LH    @14,NLST(,@15)                                      1211 04470000
         MH    @14,@CH01270                                        1211 04471000
         L     @07,OBJNMPTR(,@07)                                  1211 04472000
         AL    @07,@CF01608                                        1211 04473000
         LA    @07,OBJNM-5(@14,@07)                                1211 04474000
         ST    @07,CTGENT(,@02)                                    1211 04475000
*                          PGSPCFLG = OFF;                 /*@YL026UE*/ 04476000
*                                                                  1212 04477000
         L     @07,COMFLGPT(,COMPTR)                               1212 04478000
         NI    PGSPCFLG(@07),B'01111111'                           1212 04479000
*              /******************************************************/ 04480000
*              /*                                                    */ 04481000
*              /* LOCATE THE FIELD INFORMATION FOR THE ENTRY.        */ 04482000
*              /* PROCESS THE FIELDS FOR EITHER A SUCCESSFUL LOCATE  */ 04483000
*              /* OR PASSWORD VERIFICATION FAILURE WITH A NAME       */ 04484000
*              /* REQUEST ONLY, THAT IS NOT DATE RESTRICTED, @Y30SSMK*/ 04485000
*              /* OR RESTRICTED TO NOTUSABLE DATA SETS.      @Y30SSMK*/ 04486000
*              /* (IN THE CASE OF PASSWORD FAILURE, THE NAME IS      */ 04487000
*              /* RETURNED ANYWAY AND CAN BE PROCESSED.)             */ 04488000
*              /*                                                    */ 04489000
*              /******************************************************/ 04490000
*                                                                  1213 04491000
*              CALL LOCPROC (FPLEND,CACBFLG,ENTNMFLG);             1213 04492000
         LA    @02,FPLEND(,@15)                                    1213 04493000
         ST    @02,@AL00001                                        1213 04494000
         ST    @07,@AL00001+4                                      1213 04495000
         LA    @07,ENTNMFLG(,@07)                                  1213 04496000
         ST    @07,@AL00001+8                                      1213 04497000
         L     @15,@CV00870                                        1213 04498000
         LA    @01,@AL00001                                        1213 04499000
         BALR  @14,@15                                             1213 04500000
*              RESPECIFY RTNREG RSTD;                              1214 04501000
*              TESTRC = RTNREG;                                    1215 04502000
         LR    TESTRC,RTNREG                                       1215 04503000
*              RESPECIFY RTNREG UNRSTD;                            1216 04504000
*              IF TESTRC = 0  |                                    1217 04505000
*                (CATRC = CRCBADPW  &  ADDR(NAME) > NULLPTR  &     1217 04506000
*                DATEFLG = OFF  &  NUSEFLG = OFF)                  1217 04507000
*                THEN                                              1217 04508000
         SLR   @07,@07                                             1217 04509000
         CR    TESTRC,@07                                          1217 04510000
         BE    @RT01217                                            1217 04511000
         L     @02,COMVARPT(,COMPTR)                               1217 04512000
         CLC   CATRC(2,@02),@CH01313                               1217 04513000
         BNE   @RF01217                                            1217 04514000
         L     @02,@PC00001+4                                      1217 04515000
         C     @07,FDTPTR+52(,@02)                                 1217 04516000
         BNL   @RF01217                                            1217 04517000
         L     @07,COMFLGPT(,COMPTR)                               1217 04518000
         TM    DATEFLG(@07),B'10000000'                            1217 04519000
         BNZ   @RF01217                                            1217 04520000
         TM    NUSEFLG(@07),B'10000000'                            1217 04521000
         BNZ   @RF01217                                            1217 04522000
@RT01217 DS    0H                                                  1218 04523000
*                  /**************************************************/ 04524000
*                  /*                                                */ 04525000
*                  /* SAVE THE ENTRY TYPE FOR ROUTING TO THE         */ 04526000
*                  /* APPROPRIATE FORMATTING ROUTINE. THE ENTRY TYPE */ 04527000
*                  /* IS RETURNED IN A SPECIAL AREA IF PASSWORD      */ 04528000
*                  /* VERIFICATION FAILED. INVOKE VOLLIST FOR AN     */ 04529000
*                  /* ABBREVIATED VOLUME LIST FOR THE TSO USER.      */ 04530000
*                  /*                                                */ 04531000
*                  /**************************************************/ 04532000
*                                                                  1218 04533000
*ENTROUTE:         DO;                                             1218 04534000
ENTROUTE DS    0H                                                  1219 04535000
*                  IF CATRC = 0                                    1219 04536000
*                    THEN                                          1219 04537000
         L     @07,COMVARPT(,COMPTR)                               1219 04538000
         LH    @04,CATRC(,@07)                                     1219 04539000
         LTR   @04,@04                                             1219 04540000
         BNZ   @RF01219                                            1219 04541000
*                      DO;                                 /*@YL026UE*/ 04542000
*                      HOLDETYP = ETYPFPT->CTGFLPT(1)->ETYP;       1221 04543000
         L     @04,COMFPLPT(,COMPTR)                               1221 04544000
         L     @02,ETYPFPT(,@04)                                   1221 04545000
         L     @02,CTGFLPT(,@02)                                   1221 04546000
         MVC   HOLDETYP(1,@07),ETYP(@02)                           1221 04547000
*                      IF HOLDETYP=CTGTCL &                        1222 04548000
*                         CATTRFPT->CTGFLPT(1)->PGSPAC ^= 'FF'X &  1222 04549000
*                         CATTRFPT->CTGFLPT(1)->PGSP=ON      /*YM6557*/ 04550000
*                        THEN                                      1222 04551000
         CLI   HOLDETYP(@07),C'C'                                  1222 04552000
         BNE   @RF01222                                            1222 04553000
         L     @07,CATTRFPT(,@04)                                  1222 04554000
         L     @07,CTGFLPT(,@07)                                   1222 04555000
         CLI   PGSPAC(@07),X'FF'                                   1222 04556000
         BE    @RF01222                                            1222 04557000
         TM    PGSP(@07),B'00000001'                               1222 04558000
         BNO   @RF01222                                            1222 04559000
*                          PGSPCFLG = ON;                  /*@YL026UE*/ 04560000
         L     @07,COMFLGPT(,COMPTR)                               1223 04561000
         OI    PGSPCFLG(@07),B'10000000'                           1223 04562000
*                      END;                                /*@YL026UE*/ 04563000
*                    ELSE                                          1225 04564000
*                      DO;                                 /*@YL026UE*/ 04565000
         B     @RC01219                                            1225 04566000
@RF01219 DS    0H                                                  1226 04567000
*                      HOLDETYP = SUPPTYPE;                        1226 04568000
         L     @07,COMVARPT(,COMPTR)                               1226 04569000
         L     @04,COMSWKPT(,COMPTR)                               1226 04570000
         L     @04,CTGPLPTR(,@04)                                  1226 04571000
         L     @04,CTGWKA(,@04)                                    1226 04572000
         MVC   HOLDETYP(1,@07),SUPPTYPE(@04)                       1226 04573000
*                      IF HOLDETYP = CTGTPGSP                      1227 04574000
*                        THEN                                      1227 04575000
         CLI   HOLDETYP(@07),C'P'                                  1227 04576000
         BNE   @RF01227                                            1227 04577000
*                          DO;                             /*@YL026UE*/ 04578000
*                          PGSPCFLG = ON;                  /*@YL026UE*/ 04579000
         L     @04,COMFLGPT(,COMPTR)                               1229 04580000
         OI    PGSPCFLG(@04),B'10000000'                           1229 04581000
*                          HOLDETYP = CTGTCL;              /*@YL026UE*/ 04582000
         MVI   HOLDETYP(@07),C'C'                                  1230 04583000
*                          END;                            /*@YL026UE*/ 04584000
*                      END;                                /*@YL026UE*/ 04585000
@RF01227 DS    0H                                                  1233 04586000
*                  IF SHVOLFLG = ON                                1233 04587000
*                    THEN                                          1233 04588000
@RC01219 TM    SHVOLFLG,B'10000000'                                1233 04589000
         BNO   @RF01233                                            1233 04590000
*                      CALL VOLLIST;                       /*@Y30SSMK*/ 04591000
         L     @15,@CV00879                                        1234 04592000
         BALR  @14,@15                                             1234 04593000
*                    ELSE                                          1235 04594000
*NONTSOVL:             DO;                                 /*@Y30SSMK*/ 04595000
         B     @RC01233                                            1235 04596000
@RF01233 DS    0H                                                  1235 04597000
NONTSOVL DS    0H                                                  1236 04598000
*                      CLENTFLG = OFF;                     /*@Y30SSMK*/ 04599000
*                                                                  1236 04600000
         L     @07,COMFLGPT(,COMPTR)                               1236 04601000
         NI    CLENTFLG(@07),B'01111111'                           1236 04602000
*                  /**************************************************/ 04603000
*                  /*                                                */ 04604000
*                  /* IF THE RETRIEVED ENTRY IS NOT RESTRICTED BY A  */ 04605000
*                  /* TYPE REQUEST, HAVE THE APPROPRIATE PROCEDURE   */ 04606000
*                  /* LIST THE ENTRY.                                */ 04607000
*                  /* IF THE RETRIEVED ENTRY IS DATE RESTRICTED,     */ 04608000
*                  /* INVOKE CKDTPROC TO TEST THE CREATION AND       */ 04609000
*                  /* EXPIRATION DATES.                      @Y30LSMK*/ 04610000
*                  /* NOTE -- A CLUSTER OR AIX ENTRY THAT IS @Y30SSMK*/ 04611000
*                  /* NOT RESTRICTED BY A TYPE SPECIFICATION @Y30SSMK*/ 04612000
*                  /* WILL BE LISTED WITH THEIR ASSOCIATED   @Y30SSMK*/ 04613000
*                  /* DATA, INDEX AND PATH ENTRIES.          @Y30SSMK*/ 04614000
*                  /* A CLUSTER OR AIX THAT IS DATE          @Y30SSMK*/ 04615000
*                  /* RESTRICTED WILL BE LISTED WITH THERE   @Y30SSMK*/ 04616000
*                  /* ASSOCIATED DATA, INDEX, AND PATH       @Y30SSMK*/ 04617000
*                  /* ENTRIES ONLY IF THE DATE TEST IS       @Y30SSMK*/ 04618000
*                  /* SUCCESSFUL.                            @Y30SSMK*/ 04619000
*                  /* ALSO, A PAGESPACE OR GDG ENTRY         @Y30SSMK*/ 04620000
*                  /* THAT IS NOT RESTRICTED BY A TYPE SPECIFICATION */ 04621000
*                  /* WILL BE LISTED WITH THEIR RESPECTIVE DATA OR   */ 04622000
*                  /* NONVSAM ASSOCIATIONS.  A PAGESPACE OR GDG      */ 04623000
*                  /* ENTRY THAT IS DATE RESTRICTED WILL BE LISTED   */ 04624000
*                  /* WITH THEIR RESPECTIVE DATA OR NONVSAM ENTRIES  */ 04625000
*                  /* ONLY IF THE DATE TEST IS SUCCESSFUL.   @Y30SSMK*/ 04626000
*                  /* IF A NON-TERMINATING ERROR OCCURRED, ISSUE A   */ 04627000
*                  /* MESSAGE.  IF A TERMINATING ERROR OCCURRED,     */ 04628000
*                  /* EXIT FROM THE PROCEDURE.  OTHERWISE, PROCESS   */ 04629000
*                  /* THE NEXT ENTRY IN THE LIST.                    */ 04630000
*                  /*                                                */ 04631000
*                  /**************************************************/ 04632000
*                                                                  1237 04633000
*                  IF TYPECNT = 0                                  1237 04634000
*                    THEN                                          1237 04635000
         L     @04,COMVARPT(,COMPTR)                               1237 04636000
         LH    @04,TYPECNT(,@04)                                   1237 04637000
         LTR   @04,@04                                             1237 04638000
         BNZ   @RF01237                                            1237 04639000
*                      DO;                                         1238 04640000
*                      CRDTSW = OFF;                       /*@Y30LSMK*/ 04641000
         NI    CRDTSW(@07),B'01111111'                             1239 04642000
*                      EXDTSW = OFF;                       /*@Y30LSMK*/ 04643000
         NI    EXDTSW(@07),B'01111111'                             1240 04644000
*                      IF DATEFLG = ON                             1241 04645000
*                        THEN                                      1241 04646000
         TM    DATEFLG(@07),B'10000000'                            1241 04647000
         BNO   @RF01241                                            1241 04648000
*                          CALL CKDTPROC;                  /*@Y30LSMK*/ 04649000
         BAL   @14,CKDTPROC                                        1242 04650000
*                      IF DATEFLG = OFF  |                         1243 04651000
*                        (CRDTSW = ON  &  EXDTSW = ON)             1243 04652000
*                        THEN                                      1243 04653000
@RF01241 L     @07,COMFLGPT(,COMPTR)                               1243 04654000
         TM    DATEFLG(@07),B'10000000'                            1243 04655000
         BZ    @RT01243                                            1243 04656000
         TM    CRDTSW(@07),B'10000000'                             1243 04657000
         BNO   @RF01243                                            1243 04658000
         TM    EXDTSW(@07),B'10000000'                             1243 04659000
         BNO   @RF01243                                            1243 04660000
@RT01243 DS    0H                                                  1244 04661000
*                          DO;                             /*@Y30LSMK*/ 04662000
*                          CALL RTEPROC (CLENTFLG);                1245 04663000
         L     @07,COMFLGPT(,COMPTR)                               1245 04664000
         LA    @07,CLENTFLG(,@07)                                  1245 04665000
         ST    @07,@AL00001                                        1245 04666000
         LA    @01,@AL00001                                        1245 04667000
         BAL   @14,RTEPROC                                         1245 04668000
*                          RESPECIFY RTNREG RSTD;                  1246 04669000
*                          TESTRC = RTNREG;                        1247 04670000
         LR    TESTRC,RTNREG                                       1247 04671000
*                          RESPECIFY RTNREG UNRSTD;                1248 04672000
*                          IF TESTRC ^= 0                          1249 04673000
*                            THEN                                  1249 04674000
         LTR   TESTRC,TESTRC                                       1249 04675000
         BZ    @RF01249                                            1249 04676000
*                              IF TESTRC < LASTCC12                1250 04677000
*                                THEN                              1250 04678000
         C     TESTRC,@CF00586                                     1250 04679000
         BNL   @RF01250                                            1250 04680000
*                                  CALL ERRPROC;                   1251 04681000
         L     @15,@CV00872                                        1251 04682000
         BALR  @14,@15                                             1251 04683000
*                                ELSE                              1252 04684000
*                                  RETURN CODE(LASTCC12);          1252 04685000
         B     @RC01250                                            1252 04686000
@RF01250 LA    @15,12                                              1252 04687000
         L     @14,@SA00004                                        1252 04688000
         LM    @00,@12,@SA00004+8                                  1252 04689000
         BR    @14                                                 1252 04690000
*                          END;                            /*@Y30LSMK*/ 04691000
*                      END;                                        1254 04692000
*                    /************************************************/ 04693000
*                    /*                                              */ 04694000
*                    /* IF THE RETRIEVED ENTRY IS RESTRICTED BY A    */ 04695000
*                    /* TYPE REQUEST, LIST THE ENTRY ONLY IF THE     */ 04696000
*                    /* TYPE SPECIFICATION IS MET.                   */ 04697000
*                    /*                                              */ 04698000
*                    /************************************************/ 04699000
*                                                                  1255 04700000
*                    ELSE                                          1255 04701000
*ENTCOND:              DO;                                         1255 04702000
         B     @RC01237                                            1255 04703000
@RF01237 DS    0H                                                  1255 04704000
ENTCOND  DS    0H                                                  1256 04705000
*                      TYPOKFLG = OFF; /*QUALIFICATION FLAG          */ 04706000
         NI    TYPOKFLG,B'01111111'                                1256 04707000
*                      BADPWFLG=OFF;   /*PASSWORD VERIFICATION FLAG  */ 04708000
*                                                                  1257 04709000
         NI    BADPWFLG,B'01111111'                                1257 04710000
*                      /**********************************************/ 04711000
*                      /*                                            */ 04712000
*                      /* CHECK IF THE RETRIEVED ENTRY IS THE        */ 04713000
*                      /* SPECIFIED TYPE, OR THE OBJECT TYPE IS 'C'  */ 04714000
*                      /* AND 'P' WAS SPECIFIED OR THE OBJECT TYPE   */ 04715000
*                      /* IS 'B' AND 'A' WAS SPECIFIED.      @YL026UE*/ 04716000
*                      /*                                            */ 04717000
*                      /**********************************************/ 04718000
*                                                                  1258 04719000
*ENTNEST1:             DO TYPIDX = 1 TO TYPECNT WHILE (TYPOKFLG=OFF);   04720000
ENTNEST1 LA    TYPIDX,1                                            1258 04721000
         B     @DE01258                                            1258 04722000
@DL01258 TM    TYPOKFLG,B'10000000'                                1258 04723000
         BNZ   @DC01258                                            1258 04724000
*                        IF (HOLDETYP = TYPELIST(TYPIDX))          1259 04725000
*                           | (HOLDETYP = CTGTCL                   1259 04726000
*                           & TYPELIST(TYPIDX) = CTGTPGSP          1259 04727000
*                           & PGSPCFLG = ON)                       1259 04728000
*                          THEN                                    1259 04729000
         L     @04,COMVARPT(,COMPTR)                               1259 04730000
         LR    @02,@04                                             1259 04731000
         ALR   @02,TYPIDX                                          1259 04732000
         CLC   HOLDETYP(1,@04),TYPELIST-1(@02)                     1259 04733000
         BE    @RT01259                                            1259 04734000
         CLI   HOLDETYP(@04),C'C'                                  1259 04735000
         BNE   @RF01259                                            1259 04736000
         ALR   @04,TYPIDX                                          1259 04737000
         CLI   TYPELIST-1(@04),C'P'                                1259 04738000
         BNE   @RF01259                                            1259 04739000
         L     @04,COMFLGPT(,COMPTR)                               1259 04740000
         TM    PGSPCFLG(@04),B'10000000'                           1259 04741000
         BNO   @RF01259                                            1259 04742000
@RT01259 DS    0H                                                  1260 04743000
*ENTNEST2:                   DO;                                   1260 04744000
ENTNEST2 DS    0H                                                  1261 04745000
*                            IF HOLDETYP = CTGTCL                  1261 04746000
*                               & TYPELIST(TYPIDX) = CTGTCL        1261 04747000
*                               & PGSPCFLG = ON                    1261 04748000
*                              THEN;                       /*@YL026UE*/ 04749000
         L     @04,COMVARPT(,COMPTR)                               1261 04750000
         CLI   HOLDETYP(@04),C'C'                                  1261 04751000
         BNE   @RF01261                                            1261 04752000
         ALR   @04,TYPIDX                                          1261 04753000
         CLI   TYPELIST-1(@04),C'C'                                1261 04754000
         BNE   @RF01261                                            1261 04755000
         L     @04,COMFLGPT(,COMPTR)                               1261 04756000
         TM    PGSPCFLG(@04),B'10000000'                           1261 04757000
         BO    @RT01261                                            1261 04758000
*                              ELSE                                1263 04759000
*                                TYPOKFLG = ON;            /*@YL026UE*/ 04760000
@RF01261 OI    TYPOKFLG,B'10000000'                                1263 04761000
*                            IF HOLDETYP = CTGTGBS & ATYPFLG = ON  1264 04762000
*                              THEN                                1264 04763000
@RT01261 L     @04,COMVARPT(,COMPTR)                               1264 04764000
         CLI   HOLDETYP(@04),C'B'                                  1264 04765000
         BNE   @RF01264                                            1264 04766000
         L     @04,COMFLGPT(,COMPTR)                               1264 04767000
         TM    ATYPFLG(@04),B'10000000'                            1264 04768000
         BNO   @RF01264                                            1264 04769000
*                                CLENTFLG = ON;            /*@Y30LSMK*/ 04770000
         OI    CLENTFLG(@04),B'10000000'                           1265 04771000
*                            IF (HOLDETYP = CTGTCL                 1266 04772000
*                              |  HOLDETYP = CTGTAIX)              1266 04773000
*                              &  TYPOKFLG = ON                    1266 04774000
*                              THEN                                1266 04775000
*                                                                  1266 04776000
@RF01264 L     @04,COMVARPT(,COMPTR)                               1266 04777000
         CLI   HOLDETYP(@04),C'C'                                  1266 04778000
         BE    @GL00084                                            1266 04779000
         CLI   HOLDETYP(@04),C'G'                                  1266 04780000
         BNE   @RF01266                                            1266 04781000
@GL00084 TM    TYPOKFLG,B'10000000'                                1266 04782000
         BNO   @RF01266                                            1266 04783000
*                                /************************************/ 04784000
*                                /*                                  */ 04785000
*                                /* RESTRICTED ENTRY IS A    @Y30SSMK*/ 04786000
*                                /* CLUSTER OR AIX.          @Y30SSMK*/ 04787000
*                                /* IF THERE ARE DATA OR     @Y30SSMK*/ 04788000
*                                /* INDEX OR PATH TYPE       @Y30SSMK*/ 04789000
*                                /* SPECIFICATIONS FOR THE   @Y30SSMK*/ 04790000
*                                /* CLUSTER OR AIX ENTRY     @Y30SSMK*/ 04791000
*                                /* AND PASSWORD VERIFICATION        */ 04792000
*                                /* FAILED, THEN NO ASSOCIATED INFO  */ 04793000
*                                /* WAS RETURNED IN ORDER TO LOCATE  */ 04794000
*                                /* VIA C.I.NO. THE DATA OR  @Y30SSMK*/ 04795000
*                                /* INDEX OR PATH ENTRIES.   @Y30SSMK*/ 04796000
*                                /* HENCE OUTPUT THE         @Y30SSMK*/ 04797000
*                                /* APPROPRIATE ERROR MESSAGES AND   */ 04798000
*                                /* UPDATE THE ENTRY SUPPRESSION     */ 04799000
*                                /* TALLY.                           */ 04800000
*                                /*                                  */ 04801000
*                                /************************************/ 04802000
*                                                                  1267 04803000
*ENTNEST3:                       DO;                               1267 04804000
ENTNEST3 DS    0H                                                  1268 04805000
*                                CLENTFLG = ON;                    1268 04806000
         L     @04,COMFLGPT(,COMPTR)                               1268 04807000
         OI    CLENTFLG(@04),B'10000000'                           1268 04808000
*                                IF CATRC = CRCBADPW  &  TYPECNT > 1    04809000
*                                  THEN                            1269 04810000
         L     @04,COMVARPT(,COMPTR)                               1269 04811000
         CLC   CATRC(2,@04),@CH01313                               1269 04812000
         BNE   @RF01269                                            1269 04813000
         CLC   TYPECNT(2,@04),@CH00045                             1269 04814000
         BNH   @RF01269                                            1269 04815000
*ENTNEST4:                           DO JJ = 1 TO TYPECNT          1270 04816000
*                                      WHILE (BADPWFLG=OFF);       1270 04817000
ENTNEST4 LA    JJ,1                                                1270 04818000
         B     @DE01270                                            1270 04819000
@DL01270 TM    BADPWFLG,B'10000000'                                1270 04820000
         BNZ   @DC01270                                            1270 04821000
*                                      IF TYPELIST(JJ) = CTGTDATA  |    04822000
*                                        (TYPELIST(JJ) = CTGTINDX &     04823000
*                                        PGSPCFLG = OFF)  |        1271 04824000
*                                        (TYPELIST(JJ) = CTGTPTH & 1271 04825000
*                                        PGSPCFLG = OFF)           1271 04826000
*                                        THEN                      1271 04827000
         L     @04,COMVARPT(,COMPTR)                               1271 04828000
         LR    @01,@04                                             1271 04829000
         ALR   @01,JJ                                              1271 04830000
         CLI   TYPELIST-1(@01),C'D'                                1271 04831000
         BE    @RT01271                                            1271 04832000
         ALR   @04,JJ                                              1271 04833000
         CLI   TYPELIST-1(@04),C'I'                                1271 04834000
         BNE   @GL00087                                            1271 04835000
         L     @04,COMFLGPT(,COMPTR)                               1271 04836000
         TM    PGSPCFLG(@04),B'10000000'                           1271 04837000
         BZ    @RT01271                                            1271 04838000
@GL00087 L     @04,COMVARPT(,COMPTR)                               1271 04839000
         ALR   @04,JJ                                              1271 04840000
         CLI   TYPELIST-1(@04),C'R'                                1271 04841000
         BNE   @RF01271                                            1271 04842000
         L     @04,COMFLGPT(,COMPTR)                               1271 04843000
         TM    PGSPCFLG(@04),B'10000000'                           1271 04844000
         BNZ   @RF01271                                            1271 04845000
@RT01271 DS    0H                                                  1272 04846000
*ENTNEST5:                                 DO;                     1272 04847000
ENTNEST5 DS    0H                                                  1273 04848000
*                                          BADPWFLG = ON;          1273 04849000
         OI    BADPWFLG,B'10000000'                                1273 04850000
*                                          CALL ERRPROC;           1274 04851000
         L     @15,@CV00872                                        1274 04852000
         BALR  @14,@15                                             1274 04853000
*                                          ERRARGPT->DARGSMOD = LC1ID;  04854000
         L     @04,COMSWKPT(,COMPTR)                               1275 04855000
         L     @15,ERRARGPT(,@04)                                  1275 04856000
         MVC   DARGSMOD(3,@15),@CC01155                            1275 04857000
*                                          ERRARGPT->DARGSENT =LCMSG08; 04858000
         MVI   DARGSENT(@15),X'08'                                 1276 04859000
*                                          ERRARGPT->DARGDBP =     1277 04860000
*                                            ADDR(OBJNM(NLST));    1277 04861000
         L     @01,COMVARPT(,COMPTR)                               1277 04862000
         LH    @14,NLST(,@01)                                      1277 04863000
         MH    @14,@CH01270                                        1277 04864000
         L     @04,OBJNMPTR(,@04)                                  1277 04865000
         AL    @04,@CF01608                                        1277 04866000
         LA    @04,OBJNM-5(@14,@04)                                1277 04867000
         ST    @04,DARGDBP(,@15)                                   1277 04868000
*                                                          /*@Y30SSMK*/ 04869000
*                                          IF ADDR(SPACE) > 0      1278 04870000
*                                            THEN                  1278 04871000
         L     @04,@PC00001+4                                      1278 04872000
         L     @04,FDTPTR+28(,@04)                                 1278 04873000
         LTR   @04,@04                                             1278 04874000
         BNP   @RF01278                                            1278 04875000
*                                              ERRARGPT->DARGILP = 1279 04876000
*                                                VOLSERLN; /*@Y30SSMK*/ 04877000
         MVC   DARGILP(2,@15),@CH00164                             1279 04878000
*                                            ELSE                  1280 04879000
*                                              ERRARGPT->DARGILP = 1280 04880000
*                                                DSNLEN;   /*@Y30SSMK*/ 04881000
         B     @RC01278                                            1280 04882000
@RF01278 L     @04,COMSWKPT(,COMPTR)                               1280 04883000
         L     @04,ERRARGPT(,@04)                                  1280 04884000
         MVC   DARGILP(2,@04),@CH00610                             1280 04885000
*                                          CALL ERRPROC;           1281 04886000
@RC01278 L     @15,@CV00872                                        1281 04887000
         BALR  @14,@15                                             1281 04888000
*                                          PWTALLY = PWTALLY + 1;  1282 04889000
         LA    @04,1                                               1282 04890000
         AL    @04,PWTALLY                                         1282 04891000
         ST    @04,PWTALLY                                         1282 04892000
*                                          SAVRC = MAX(SAVRC,LASTCC04); 04893000
         L     @04,COMVARPT(,COMPTR)                               1283 04894000
         LH    @15,SAVRC(,@04)                                     1283 04895000
         LA    @14,4                                               1283 04896000
         CR    @15,@14                                             1283 04897000
         BNL   *+6                                                      04898000
         LR    @15,@14                                             1283 04899000
         STH   @15,SAVRC(,@04)                                     1283 04900000
*                                          END ENTNEST5;           1284 04901000
*                                    END ENTNEST4;                 1285 04902000
@RF01271 AL    JJ,@CF00045                                         1285 04903000
@DE01270 L     @04,COMVARPT(,COMPTR)                               1285 04904000
         CH    JJ,TYPECNT(,@04)                                    1285 04905000
         BNH   @DL01270                                            1285 04906000
@DC01270 DS    0H                                                  1286 04907000
*                                END ENTNEST3;                     1286 04908000
@RF01269 DS    0H                                                  1287 04909000
*                            /****************************************/ 04910000
*                            /*                                      */ 04911000
*                            /* IF THE RETRIEVED ENTRY MATCHES THE   */ 04912000
*                            /* TYPE SPECIFICATION, HAVE THE APPRO   */ 04913000
*                            /* PROCEDURE LIST THE ENTRY.            */ 04914000
*                            /* IF THE RETRIEVED ENTRY IS DATE       */ 04915000
*                            /* RESTRICTED, INVOKE CKDTPROC TO TEST  */ 04916000
*                            /* THE CREATION AND EXPIRATION DATES,   */ 04917000
*                            /* AND LIST THE ENTRY IF THE TEST IS    */ 04918000
*                            /* SUCCESSFUL.                  @Y30LSMK*/ 04919000
*                            /* IF THE RETRIEVED ENTRY IS RESTRICTED */ 04920000
*                            /* TO NOTUSABLE DATA SETS, LIST THE     */ 04921000
*                            /* ENTRY ONLY IF THE ENTRY HAS BEEN     */ 04922000
*                            /* MARKED AS UNUSABLE.          @Y30SSMK*/ 04923000
*                            /* IF PASSWORD VERIFICATION FAILED FOR  */ 04924000
*                            /* A CLUSTER OR AIX ENTRY WITH  @Y30SSMK*/ 04925000
*                            /* DATA OR INDEX OR PATH        @Y30SSMK*/ 04926000
*                            /* SPECIFICATIONS, BYPASS       @Y30SSMK*/ 04927000
*                            /* PROCESSING SINCE APPRO       @Y30SSMK*/ 04928000
*                            /* MESSAGES HAVE BEEN ISSUED.   @Y30SSMK*/ 04929000
*                            /* IF A NON-TERMINATING ERROR OCCURRED  */ 04930000
*                            /* ISSUE A MESSAGE.                     */ 04931000
*                            /* IF A TERMINATING ERROR OCCURRED,     */ 04932000
*                            /* EXIT FROM THE PROCEDURE.             */ 04933000
*                            /* OTHERWISE PROCESS THE NEXT ENTRY IN  */ 04934000
*                            /* THE LIST.                            */ 04935000
*                            /*                                      */ 04936000
*                            /****************************************/ 04937000
*                                                                  1287 04938000
*                            IF TYPOKFLG = ON  &  BADPWFLG=OFF     1287 04939000
*                              THEN                                1287 04940000
@RF01266 TM    TYPOKFLG,B'10000000'                                1287 04941000
         BNO   @RF01287                                            1287 04942000
         TM    BADPWFLG,B'10000000'                                1287 04943000
         BNZ   @RF01287                                            1287 04944000
*                                DO;                               1288 04945000
*                                CRDTSW = OFF;             /*@Y30LSMK*/ 04946000
         L     @04,COMFLGPT(,COMPTR)                               1289 04947000
         NI    CRDTSW(@04),B'01111111'                             1289 04948000
*                                EXDTSW = OFF;             /*@Y30LSMK*/ 04949000
         NI    EXDTSW(@04),B'01111111'                             1290 04950000
*                                IF DATEFLG = ON                   1291 04951000
*                                  THEN                            1291 04952000
         TM    DATEFLG(@04),B'10000000'                            1291 04953000
         BNO   @RF01291                                            1291 04954000
*                                    CALL CKDTPROC;        /*@Y30LSMK*/ 04955000
         BAL   @14,CKDTPROC                                        1292 04956000
*                                IF DATEFLG = OFF  |               1293 04957000
*                                  (CRDTSW = ON  &  EXDTSW = ON)   1293 04958000
*                                  THEN                            1293 04959000
@RF01291 L     @04,COMFLGPT(,COMPTR)                               1293 04960000
         TM    DATEFLG(@04),B'10000000'                            1293 04961000
         BZ    @RT01293                                            1293 04962000
         TM    CRDTSW(@04),B'10000000'                             1293 04963000
         BNO   @RF01293                                            1293 04964000
         TM    EXDTSW(@04),B'10000000'                             1293 04965000
         BNO   @RF01293                                            1293 04966000
@RT01293 DS    0H                                                  1294 04967000
*                                    DO;                   /*@Y30LSMK*/ 04968000
*                                    IF NUSEFLG = ON  &            1295 04969000
*                                      (HOLDETYP = CTGTDATA  |     1295 04970000
*                                      HOLDETYP = CTGTINDX)        1295 04971000
*                                      THEN                        1295 04972000
*                                                                  1295 04973000
         L     @04,COMFLGPT(,COMPTR)                               1295 04974000
         TM    NUSEFLG(@04),B'10000000'                            1295 04975000
         BNO   @RF01295                                            1295 04976000
         L     @04,COMVARPT(,COMPTR)                               1295 04977000
         CLI   HOLDETYP(@04),C'D'                                  1295 04978000
         BE    @RT01295                                            1295 04979000
         CLI   HOLDETYP(@04),C'I'                                  1295 04980000
         BNE   @RF01295                                            1295 04981000
@RT01295 DS    0H                                                  1296 04982000
*                                        /****************************/ 04983000
*                                        /*                  @Y30SSMK*/ 04984000
*                                        /* POSITION FPL POINTER TO  */ 04985000
*                                        /* THE DATA SET ATTRIBUTES  */ 04986000
*                                        /* FPL.             @Y30SSMK*/ 04987000
*                                        /*                  @Y30SSMK*/ 04988000
*                                        /****************************/ 04989000
*                                                                  1296 04990000
*                                        DO;               /*@Y30SSMK*/ 04991000
*                                        IF ADDR(FALL) = NULLPTR   1297 04992000
*                                          THEN                    1297 04993000
         L     @04,@PC00001+4                                      1297 04994000
         L     @04,FDTPTR+56(,@04)                                 1297 04995000
         LTR   @04,@04                                             1297 04996000
         BNZ   @RF01297                                            1297 04997000
*                                            CTGFLPTR =            1298 04998000
*                                              FPLPTMAP(FPLATR);   1298 04999000
         L     @04,COMSWKPT(,COMPTR)                               1298 05000000
         LH    @02,FPLATR                                          1298 05001000
         SLA   @02,2                                               1298 05002000
         L     @01,COMFPLPT(,COMPTR)                               1298 05003000
         AL    @01,@CF01593                                        1298 05004000
         L     @02,FPLPTMAP(@02,@01)                               1298 05005000
         ST    @02,CTGFLPTR(,@04)                                  1298 05006000
*                                          ELSE                    1299 05007000
*                                            CTGFLPTR = ATTRFPT;   1299 05008000
         B     @RC01297                                            1299 05009000
@RF01297 L     @04,COMSWKPT(,COMPTR)                               1299 05010000
         L     @02,COMFPLPT(,COMPTR)                               1299 05011000
         L     @02,ATTRFPT(,@02)                                   1299 05012000
         ST    @02,CTGFLPTR(,@04)                                  1299 05013000
*                                        IF CTGFLPT(1) > NULLPTR   1300 05014000
*                                          THEN                    1300 05015000
@RC01297 L     @04,COMSWKPT(,COMPTR)                               1300 05016000
         L     @04,CTGFLPTR(,@04)                                  1300 05017000
         L     @04,CTGFLPT(,@04)                                   1300 05018000
         LTR   @04,@04                                             1300 05019000
         BNP   @RF01300                                            1300 05020000
*                                            DO;           /*@Y30SSMK*/ 05021000
*                                            IF DSNUSE = ON        1302 05022000
*                                              THEN                1302 05023000
         TM    DSNUSE(@04),B'00000001'                             1302 05024000
         BNO   @RF01302                                            1302 05025000
*                                                DO;       /*@Y30SSMK*/ 05026000
*                                                CALL RTEPROC      1304 05027000
*                                                  (CLENTFLG);     1304 05028000
         L     @04,COMFLGPT(,COMPTR)                               1304 05029000
         LA    @04,CLENTFLG(,@04)                                  1304 05030000
         ST    @04,@AL00001                                        1304 05031000
         LA    @01,@AL00001                                        1304 05032000
         BAL   @14,RTEPROC                                         1304 05033000
*                                                RESPECIFY RTNREG RSTD; 05034000
*                                                TESTRC = RTNREG;  1306 05035000
         LR    TESTRC,RTNREG                                       1306 05036000
*                                                RESPECIFY RTNREG UNRST 05037000
*;                                                         /*@Y30SSMK*/ 05038000
*                                                IF TESTRC ^= 0    1308 05039000
*                                                  THEN            1308 05040000
         LTR   TESTRC,TESTRC                                       1308 05041000
         BZ    @RF01308                                            1308 05042000
*                                                    IF TESTRC <   1309 05043000
*                                                      LASTCC12    1309 05044000
*                                                      THEN        1309 05045000
         C     TESTRC,@CF00586                                     1309 05046000
         BNL   @RF01309                                            1309 05047000
*                                                        CALL ERRPROC;  05048000
         L     @15,@CV00872                                        1310 05049000
         BALR  @14,@15                                             1310 05050000
*                                                      ELSE        1311 05051000
*                                                        RETURN CODE    05052000
*                                                          (LASTCC12);  05053000
         B     @RC01309                                            1311 05054000
@RF01309 LA    @15,12                                              1311 05055000
         L     @14,@SA00004                                        1311 05056000
         LM    @00,@12,@SA00004+8                                  1311 05057000
         BR    @14                                                 1311 05058000
*                                                END;      /*@Y30SSMK*/ 05059000
*                                            END;          /*@Y30SSMK*/ 05060000
*                                        END;              /*@Y30SSMK*/ 05061000
*                                      ELSE                        1315 05062000
*                                        DO;               /*@Y30SSMK*/ 05063000
         B     @RC01295                                            1315 05064000
@RF01295 DS    0H                                                  1316 05065000
*                                        CALL RTEPROC (CLENTFLG);  1316 05066000
         L     @04,COMFLGPT(,COMPTR)                               1316 05067000
         LA    @04,CLENTFLG(,@04)                                  1316 05068000
         ST    @04,@AL00001                                        1316 05069000
         LA    @01,@AL00001                                        1316 05070000
         BAL   @14,RTEPROC                                         1316 05071000
*                                        RESPECIFY RTNREG RSTD;    1317 05072000
*                                        TESTRC = RTNREG;          1318 05073000
         LR    TESTRC,RTNREG                                       1318 05074000
*                                        RESPECIFY RTNREG UNRSTD;/*     05075000
*                                                            @Y30SSMK*/ 05076000
*                                        IF TESTRC ^= 0            1320 05077000
*                                          THEN                    1320 05078000
         LTR   TESTRC,TESTRC                                       1320 05079000
         BZ    @RF01320                                            1320 05080000
*                                            IF TESTRC < LASTCC12  1321 05081000
*                                              THEN                1321 05082000
         C     TESTRC,@CF00586                                     1321 05083000
         BNL   @RF01321                                            1321 05084000
*                                                CALL ERRPROC;     1322 05085000
         L     @15,@CV00872                                        1322 05086000
         BALR  @14,@15                                             1322 05087000
*                                              ELSE                1323 05088000
*                                                RETURN CODE(LASTCC12); 05089000
         B     @RC01321                                            1323 05090000
@RF01321 LA    @15,12                                              1323 05091000
         L     @14,@SA00004                                        1323 05092000
         LM    @00,@12,@SA00004+8                                  1323 05093000
         BR    @14                                                 1323 05094000
*                                        END;              /*@Y30SSMK*/ 05095000
@RC01321 DS    0H                                                  1324 05096000
@RF01320 DS    0H                                                  1325 05097000
*                                    END;                  /*@Y30SSMK*/ 05098000
@RC01295 DS    0H                                                  1326 05099000
*                                END;                      /*@Y30LSMK*/ 05100000
@RF01293 DS    0H                                                  1327 05101000
*                            END ENTNEST2;                         1327 05102000
@RF01287 DS    0H                                                  1328 05103000
*                      END ENTNEST1;                               1328 05104000
@RF01259 AL    TYPIDX,@CF00045                                     1328 05105000
@DE01258 L     @04,COMVARPT(,COMPTR)                               1328 05106000
         CH    TYPIDX,TYPECNT(,@04)                                1328 05107000
         BNH   @DL01258                                            1328 05108000
@DC01258 DS    0H                                                  1329 05109000
*                    /************************************************/ 05110000
*                    /*                                              */ 05111000
*                    /* ALTHOUGH THE RETRIEVED ENTRY DOES NOT MATCH  */ 05112000
*                    /* THE SPECIFIED TYPE, DETERMINE WHETHER ENTRY  */ 05113000
*                    /* IS A CLUSTER, PAGESPACE, GDG, OR AIX @Y30SSMK*/ 05114000
*                    /* AND WHETHER THE ASSOCIATED DATASETS QUALIFY  */ 05115000
*                    /* IF NOT, USER ERROR.                  @YL026UE*/ 05116000
*                    /*                                              */ 05117000
*                    /************************************************/ 05118000
*                                                                  1329 05119000
*                      IF TYPOKFLG = OFF                           1329 05120000
*                        THEN                                      1329 05121000
         TM    TYPOKFLG,B'10000000'                                1329 05122000
         BNZ   @RF01329                                            1329 05123000
*                      IF (((HOLDETYP=CTGTCL & PGSPCFLG=OFF)  |    1330 05124000
*                        HOLDETYP = CTGTAIX)                       1330 05125000
*                        & (DTYPFLG=ON | ITYPFLG=ON | RTYPFLG = ON 1330 05126000
*                        |  NUSEFLG = ON))                         1330 05127000
*                        | (HOLDETYP=CTGTGBS & ATYPFLG=ON)         1330 05128000
*                        | (PGSPCFLG=ON & (DTYPFLG=ON | NUSEFLG = ON))  05129000
*                        THEN                                      1330 05130000
         L     @07,COMVARPT(,COMPTR)                               1330 05131000
         CLI   HOLDETYP(@07),C'C'                                  1330 05132000
         BNE   @GL00099                                            1330 05133000
         L     @07,COMFLGPT(,COMPTR)                               1330 05134000
         TM    PGSPCFLG(@07),B'10000000'                           1330 05135000
         BZ    @GL00098                                            1330 05136000
@GL00099 L     @07,COMVARPT(,COMPTR)                               1330 05137000
         CLI   HOLDETYP(@07),C'G'                                  1330 05138000
         BNE   @GL00097                                            1330 05139000
@GL00098 L     @07,COMFLGPT(,COMPTR)                               1330 05140000
         TM    DTYPFLG(@07),B'10000000'                            1330 05141000
         BO    @RT01330                                            1330 05142000
         TM    ITYPFLG(@07),B'10000000'                            1330 05143000
         BO    @RT01330                                            1330 05144000
         TM    RTYPFLG(@07),B'10000000'                            1330 05145000
         BO    @RT01330                                            1330 05146000
         TM    NUSEFLG(@07),B'10000000'                            1330 05147000
         BO    @RT01330                                            1330 05148000
@GL00097 L     @07,COMVARPT(,COMPTR)                               1330 05149000
         CLI   HOLDETYP(@07),C'B'                                  1330 05150000
         BNE   @GL00096                                            1330 05151000
         L     @07,COMFLGPT(,COMPTR)                               1330 05152000
         TM    ATYPFLG(@07),B'10000000'                            1330 05153000
         BO    @RT01330                                            1330 05154000
@GL00096 L     @07,COMFLGPT(,COMPTR)                               1330 05155000
         TM    PGSPCFLG(@07),B'10000000'                           1330 05156000
         BNO   @RF01330                                            1330 05157000
         TM    DTYPFLG(@07),B'10000000'                            1330 05158000
         BO    @RT01330                                            1330 05159000
         TM    NUSEFLG(@07),B'10000000'                            1330 05160000
         BNO   @RF01330                                            1330 05161000
@RT01330 DS    0H                                                  1331 05162000
*                          IF CATRC = CRCBADPW                     1331 05163000
*                            THEN                                  1331 05164000
*                                                                  1331 05165000
         L     @07,COMVARPT(,COMPTR)                               1331 05166000
         CLC   CATRC(2,@07),@CH01313                               1331 05167000
         BNE   @RF01331                                            1331 05168000
*                              /**************************************/ 05169000
*                              /*                                    */ 05170000
*                              /* SINCE PASSWORD VERIFICATION FAILED */ 05171000
*                              /* NO ASSOCIATED C.I.NOS. WERE        */ 05172000
*                              /* RETURNED FOR PROCESSING.  OUTPUT   */ 05173000
*                              /* APPROPRIATE DIAGNOSTICS.           */ 05174000
*                              /*                                    */ 05175000
*                              /**************************************/ 05176000
*                                                                  1332 05177000
*                              DO;                                 1332 05178000
*                              CALL ERRPROC;                       1333 05179000
         L     @15,@CV00872                                        1333 05180000
         BALR  @14,@15                                             1333 05181000
*                              ERRARGPT->DARGSMOD = LC1ID;         1334 05182000
         L     @07,COMSWKPT(,COMPTR)                               1334 05183000
         L     @04,ERRARGPT(,@07)                                  1334 05184000
         MVC   DARGSMOD(3,@04),@CC01155                            1334 05185000
*                              ERRARGPT->DARGSENT = LCMSG08;       1335 05186000
         MVI   DARGSENT(@04),X'08'                                 1335 05187000
*                              ERRARGPT->DARGDBP =ADDR(OBJNM(NLST));    05188000
         L     @02,COMVARPT(,COMPTR)                               1336 05189000
         LH    @02,NLST(,@02)                                      1336 05190000
         MH    @02,@CH01270                                        1336 05191000
         L     @07,OBJNMPTR(,@07)                                  1336 05192000
         AL    @07,@CF01608                                        1336 05193000
         LA    @07,OBJNM-5(@02,@07)                                1336 05194000
         ST    @07,DARGDBP(,@04)                                   1336 05195000
*                                                          /*@YL026UE*/ 05196000
*                              IF ADDR(SPACE) > 0                  1337 05197000
*                                THEN                              1337 05198000
         L     @07,@PC00001+4                                      1337 05199000
         L     @07,FDTPTR+28(,@07)                                 1337 05200000
         LTR   @07,@07                                             1337 05201000
         BNP   @RF01337                                            1337 05202000
*                                  ERRARGPT->DARGILP = VOLSERLN;   1338 05203000
         MVC   DARGILP(2,@04),@CH00164                             1338 05204000
*                                ELSE                              1339 05205000
*                                  ERRARGPT->DARGILP = DSNLEN;     1339 05206000
         B     @RC01337                                            1339 05207000
@RF01337 L     @07,COMSWKPT(,COMPTR)                               1339 05208000
         L     @07,ERRARGPT(,@07)                                  1339 05209000
         MVC   DARGILP(2,@07),@CH00610                             1339 05210000
*                              CALL ERRPROC;                       1340 05211000
@RC01337 L     @15,@CV00872                                        1340 05212000
         BALR  @14,@15                                             1340 05213000
*                              PWTALLY = PWTALLY + 1;              1341 05214000
         LA    @07,1                                               1341 05215000
         AL    @07,PWTALLY                                         1341 05216000
         ST    @07,PWTALLY                                         1341 05217000
*                              SAVRC = MAX (SAVRC, LASTCC04);      1342 05218000
         L     @07,COMVARPT(,COMPTR)                               1342 05219000
         LH    @04,SAVRC(,@07)                                     1342 05220000
         LA    @02,4                                               1342 05221000
         CR    @04,@02                                             1342 05222000
         BNL   *+6                                                      05223000
         LR    @04,@02                                             1342 05224000
         STH   @04,SAVRC(,@07)                                     1342 05225000
*                              END;                                1343 05226000
*                            /****************************************/ 05227000
*                            /*                                      */ 05228000
*                            /* FOR A CLUSTER, AIX, PGSPC OR GDG     */ 05229000
*                            /* FROM WHICH ONLY THE DATA, INDEX,     */ 05230000
*                            /* PATH, OR NVSAM INFORMATION IS TO     */ 05231000
*                            /* BE LISTED, COMPUTE THE NUMBER OF     */ 05232000
*                            /* ASSOCIATIONS AND SAVE THE ASSOCIATED */ 05233000
*                            /* C.I.NOS.                             */ 05234000
*                            /*                                      */ 05235000
*                            /****************************************/ 05236000
*                                                                  1344 05237000
*                            ELSE                                  1344 05238000
*ENTASSOC:                     DO;                                 1344 05239000
         B     @RC01331                                            1344 05240000
@RF01331 DS    0H                                                  1344 05241000
ENTASSOC DS    0H                                                  1345 05242000
*                              CLENTFLG = ON;                      1345 05243000
         L     @07,COMFLGPT(,COMPTR)                               1345 05244000
         OI    CLENTFLG(@07),B'10000000'                           1345 05245000
*                              CALL ANSVPROC;              /*@YL026UE*/ 05246000
         L     @15,@CV00877                                        1346 05247000
         BALR  @14,@15                                             1346 05248000
*                              RESPECIFY RTNREG RSTD;              1347 05249000
*                              TESTRC = RTNREG;                    1348 05250000
         LR    TESTRC,RTNREG                                       1348 05251000
*                              RESPECIFY RTNREG UNRSTD;    /*@YL026UE*/ 05252000
*                              IF TESTRC ^= 0                      1350 05253000
*                                THEN                              1350 05254000
         LTR   TESTRC,TESTRC                                       1350 05255000
         BZ    @RF01350                                            1350 05256000
*                                 CALL ERRPROC;            /*@YL026UE*/ 05257000
         L     @15,@CV00872                                        1351 05258000
         BALR  @14,@15                                             1351 05259000
*                                ELSE                              1352 05260000
*                                                                  1352 05261000
*                                  /**********************************/ 05262000
*                                  /*                        @Y30SSMK*/ 05263000
*                                  /* BYPASS LISTING THE CLUSTER, AIX*/ 05264000
*                                  /* PGSPC OR GDG INFO, BUT @Y30SSMK*/ 05265000
*                                  /* PROCEED TO A SECONDARY @Y30SSMK*/ 05266000
*                                  /* ENTRY POINT TO HAVE THE        */ 05267000
*                                  /* APPRO PROCEDURE LIST THE       */ 05268000
*                                  /* ASSOCIATIONS.          @Y30SSMK*/ 05269000
*                                  /* IF A NON-TERMINATING ERROR     */ 05270000
*                                  /* OCCURED, ISSUE A MESSAGE.      */ 05271000
*                                  /* IF A TERMINATING ERROR @Y30SSMK*/ 05272000
*                                  /* OCCURED EXIT FROM THE  @Y30SSMK*/ 05273000
*                                  /* PROCEDURE. OTHERWISE   @Y30SSMK*/ 05274000
*                                  /* PROCESS THE NEXT ENTRY @Y30SSMK*/ 05275000
*                                  /* IN THE LIST.           @Y30SSMK*/ 05276000
*                                  /*                        @Y30SSMK*/ 05277000
*                                  /**********************************/ 05278000
*                                                                  1352 05279000
*                                  DO;                     /*@YL026UE*/ 05280000
         B     @RC01350                                            1352 05281000
@RF01350 DS    0H                                                  1353 05282000
*                                  PGSPCFLG = OFF;         /*@YL026UE*/ 05283000
         L     @07,COMFLGPT(,COMPTR)                               1353 05284000
         NI    PGSPCFLG(@07),B'01111111'                           1353 05285000
*                                  CALL RTEASSOC (CLENTFLG);       1354 05286000
         LA    @07,CLENTFLG(,@07)                                  1354 05287000
         ST    @07,@AL00001                                        1354 05288000
         LA    @01,@AL00001                                        1354 05289000
         BAL   @14,RTEASSOC                                        1354 05290000
*                                  RESPECIFY RTNREG RSTD;          1355 05291000
*                                  TESTRC = RTNREG;                1356 05292000
         LR    TESTRC,RTNREG                                       1356 05293000
*                                  RESPECIFY RTNREG UNRSTD;        1357 05294000
*                                  IF TESTRC ^= 0                  1358 05295000
*                                    THEN                          1358 05296000
         LTR   TESTRC,TESTRC                                       1358 05297000
         BZ    @RF01358                                            1358 05298000
*                                      IF TESTRC < LASTCC12        1359 05299000
*                                        THEN                      1359 05300000
         C     TESTRC,@CF00586                                     1359 05301000
         BNL   @RF01359                                            1359 05302000
*                                          CALL ERRPROC;           1360 05303000
         L     @15,@CV00872                                        1360 05304000
         BALR  @14,@15                                             1360 05305000
*                                        ELSE                      1361 05306000
*                                          RETURN CODE(LASTCC12);  1361 05307000
         B     @RC01359                                            1361 05308000
@RF01359 LA    @15,12                                              1361 05309000
         L     @14,@SA00004                                        1361 05310000
         LM    @00,@12,@SA00004+8                                  1361 05311000
         BR    @14                                                 1361 05312000
*                                  END;                    /*@YL026UE*/ 05313000
*                              END ENTASSOC;                       1363 05314000
*                        /********************************************/ 05315000
*                        /*                                          */ 05316000
*                        /* USER ERROR, THE RETRIEVED ENTRY AS       */ 05317000
*                        /* SPECIFIED IN THE USER'S ENTRY LIST DOES  */ 05318000
*                        /* NOT CORRESPOND TO THE USER'S TYPE REQUEST*/ 05319000
*                        /* SO OUTPUT THE APPROPRIATE DIAGNOSTICS.   */ 05320000
*                        /*                                          */ 05321000
*                        /********************************************/ 05322000
*                                                                  1364 05323000
*                        ELSE                                      1364 05324000
*                          IF NOTRQFLG = ON                        1364 05325000
*                            THEN                                  1364 05326000
         B     @RC01330                                            1364 05327000
@RF01330 TM    NOTRQFLG,B'10000000'                                1364 05328000
         BNO   @RF01364                                            1364 05329000
*                              DO;                         /*@Y30SSMK*/ 05330000
*                              ERRARGPT->DARGSMOD = LC1ID;         1366 05331000
         L     @07,COMSWKPT(,COMPTR)                               1366 05332000
         L     @04,ERRARGPT(,@07)                                  1366 05333000
         MVC   DARGSMOD(3,@04),@CC01155                            1366 05334000
*                              ERRARGPT->DARGSENT = LCMSG06;       1367 05335000
         MVI   DARGSENT(@04),X'06'                                 1367 05336000
*                              ERRARGPT->DARGDBP = ADDR(OBJNM(NLST));   05337000
         L     @02,COMVARPT(,COMPTR)                               1368 05338000
         LH    @02,NLST(,@02)                                      1368 05339000
         MH    @02,@CH01270                                        1368 05340000
         L     @07,OBJNMPTR(,@07)                                  1368 05341000
         AL    @07,@CF01608                                        1368 05342000
         LA    @07,OBJNM-5(@02,@07)                                1368 05343000
         ST    @07,DARGDBP(,@04)                                   1368 05344000
*                              IF ADDR(SPACE) > 0                  1369 05345000
*                                THEN                              1369 05346000
         L     @07,@PC00001+4                                      1369 05347000
         L     @07,FDTPTR+28(,@07)                                 1369 05348000
         LTR   @07,@07                                             1369 05349000
         BNP   @RF01369                                            1369 05350000
*                                  ERRARGPT->DARGILP = VOLSERLN;   1370 05351000
         MVC   DARGILP(2,@04),@CH00164                             1370 05352000
*                                ELSE                              1371 05353000
*                                  ERRARGPT->DARGILP = DSNLEN;     1371 05354000
         B     @RC01369                                            1371 05355000
@RF01369 L     @07,COMSWKPT(,COMPTR)                               1371 05356000
         L     @07,ERRARGPT(,@07)                                  1371 05357000
         MVC   DARGILP(2,@07),@CH00610                             1371 05358000
*                              CALL ERRPROC;                       1372 05359000
@RC01369 L     @15,@CV00872                                        1372 05360000
         BALR  @14,@15                                             1372 05361000
*                              SAVRC = MAX (SAVRC, LASTCC04);      1373 05362000
         L     @07,COMVARPT(,COMPTR)                               1373 05363000
         LH    @04,SAVRC(,@07)                                     1373 05364000
         LA    @02,4                                               1373 05365000
         CR    @04,@02                                             1373 05366000
         BNL   *+6                                                      05367000
         LR    @04,@02                                             1373 05368000
         STH   @04,SAVRC(,@07)                                     1373 05369000
*                              END;                                1374 05370000
*                      END ENTCOND;                                1375 05371000
@RF01364 DS    0H                                                  1375 05372000
@RC01330 DS    0H                                                  1375 05373000
@RF01329 DS    0H                                                  1376 05374000
*                    END NONTSOVL;                         /*@Y30SSMK*/ 05375000
@RC01237 DS    0H                                                  1377 05376000
*                  /**************************************************/ 05377000
*                  /*                                                */ 05378000
*                  /* RESTORE STRING OF FPL'S.                       */ 05379000
*                  /*                                                */ 05380000
*                  /**************************************************/ 05381000
*                                                                  1377 05382000
*                  CALL FPLPROC;                                   1377 05383000
@RC01233 L     @15,@CV00873                                        1377 05384000
         BALR  @14,@15                                             1377 05385000
*                  END ENTROUTE;                                   1378 05386000
*                /****************************************************/ 05387000
*                /*                                                  */ 05388000
*                /* FOR AN UNSUCCESSFUL LOCATE FOR THE ENTRY, OUTPUT */ 05389000
*                /* APPROPRIATE DIAGNOSTICS.  UPDATE THE ENTRY       */ 05390000
*                /* SUPPRESSION TALLY IF APPLICABLE.  CONTINUE       */ 05391000
*                /* PROCESSING THE REMAINDER OF THE USER'S ENTRYLIST.*/ 05392000
*                /* EXIT IF A TERMINAL ERROR OCCURRED.               */ 05393000
*                /*                                                  */ 05394000
*                /****************************************************/ 05395000
*                                                                  1379 05396000
*                ELSE                                              1379 05397000
*                  IF CATRC = CRCBADPW  &  (DATEFLG = ON  |        1379 05398000
*                    NUSEFLG = ON)  &  ADDR(NAME) > NULLPTR        1379 05399000
*                    THEN                                          1379 05400000
         B     @RC01217                                            1379 05401000
@RF01217 L     @07,COMVARPT(,COMPTR)                               1379 05402000
         CLC   CATRC(2,@07),@CH01313                               1379 05403000
         BNE   @RF01379                                            1379 05404000
         L     @07,COMFLGPT(,COMPTR)                               1379 05405000
         TM    DATEFLG(@07),B'10000000'                            1379 05406000
         BO    @GL00107                                            1379 05407000
         TM    NUSEFLG(@07),B'10000000'                            1379 05408000
         BNO   @RF01379                                            1379 05409000
@GL00107 L     @07,@PC00001+4                                      1379 05410000
         L     @07,FDTPTR+52(,@07)                                 1379 05411000
         LTR   @07,@07                                             1379 05412000
         BNP   @RF01379                                            1379 05413000
*                      DO;                                 /*@Y30LSMK*/ 05414000
*                      CALL ERRPROC;                       /*@Y30LSMK*/ 05415000
         L     @15,@CV00872                                        1381 05416000
         BALR  @14,@15                                             1381 05417000
*                      PWTALLY = PWTALLY + 1;              /*@Y30LSMK*/ 05418000
         LA    @07,1                                               1382 05419000
         AL    @07,PWTALLY                                         1382 05420000
         ST    @07,PWTALLY                                         1382 05421000
*                      SAVRC = MAX (SAVRC, LASTCC04);      /*@ZA05939*/ 05422000
         L     @07,COMVARPT(,COMPTR)                               1383 05423000
         LH    @04,SAVRC(,@07)                                     1383 05424000
         LA    @02,4                                               1383 05425000
         CR    @04,@02                                             1383 05426000
         BNL   *+6                                                      05427000
         LR    @04,@02                                             1383 05428000
         STH   @04,SAVRC(,@07)                                     1383 05429000
*                      END;                                /*@Y30LSMK*/ 05430000
*                    ELSE                                          1385 05431000
*                      IF TESTRC < LASTCC12                        1385 05432000
*                        THEN                                      1385 05433000
         B     @RC01379                                            1385 05434000
@RF01379 C     TESTRC,@CF00586                                     1385 05435000
         BNL   @RF01385                                            1385 05436000
*                          DO;                                     1386 05437000
*                          CALL ERRPROC;                           1387 05438000
         L     @15,@CV00872                                        1387 05439000
         BALR  @14,@15                                             1387 05440000
*                          ERRARGPT->DARGSMOD = LC1ID;             1388 05441000
         L     @07,COMSWKPT(,COMPTR)                               1388 05442000
         L     @04,ERRARGPT(,@07)                                  1388 05443000
         MVC   DARGSMOD(3,@04),@CC01155                            1388 05444000
*                          ERRARGPT->DARGSENT = LCMSG08;           1389 05445000
         MVI   DARGSENT(@04),X'08'                                 1389 05446000
*                          ERRARGPT->DARGDBP = ADDR(OBJNM(NLST));  1390 05447000
         L     @02,COMVARPT(,COMPTR)                               1390 05448000
         LH    @02,NLST(,@02)                                      1390 05449000
         MH    @02,@CH01270                                        1390 05450000
         L     @07,OBJNMPTR(,@07)                                  1390 05451000
         AL    @07,@CF01608                                        1390 05452000
         LA    @07,OBJNM-5(@02,@07)                                1390 05453000
         ST    @07,DARGDBP(,@04)                                   1390 05454000
*                          IF ADDR(SPACE) > 0                      1391 05455000
*                            THEN                                  1391 05456000
         L     @07,@PC00001+4                                      1391 05457000
         L     @07,FDTPTR+28(,@07)                                 1391 05458000
         LTR   @07,@07                                             1391 05459000
         BNP   @RF01391                                            1391 05460000
*                              ERRARGPT->DARGILP = VOLSERLN;       1392 05461000
         MVC   DARGILP(2,@04),@CH00164                             1392 05462000
*                            ELSE                                  1393 05463000
*                              ERRARGPT->DARGILP = DSNLEN; /*@Y30SSMK*/ 05464000
         B     @RC01391                                            1393 05465000
@RF01391 L     @07,COMSWKPT(,COMPTR)                               1393 05466000
         L     @07,ERRARGPT(,@07)                                  1393 05467000
         MVC   DARGILP(2,@07),@CH00610                             1393 05468000
*                          CALL ERRPROC;                           1394 05469000
@RC01391 L     @15,@CV00872                                        1394 05470000
         BALR  @14,@15                                             1394 05471000
*                          IF CATRC = CRCNOENT &           /*@OZ27823*/ 05472000
*                             ADDR(CATNM) = NULLPTR        /*@OZ27823*/ 05473000
*                            THEN                          /*@OZ27823*/ 05474000
         L     @07,COMVARPT(,COMPTR)                               1395 05475000
         CLC   CATRC(2,@07),@CH00187                               1395 05476000
         BNE   @RF01395                                            1395 05477000
         L     @04,@PC00001+4                                      1395 05478000
         L     @04,FDTPTR+40(,@04)                                 1395 05479000
         LTR   @04,@04                                             1395 05480000
         BNZ   @RF01395                                            1395 05481000
*                              CATNAME = BLANK;            /*@OZ27823*/ 05482000
         MVI   CATNAME+1(@07),C' '                                 1396 05483000
         MVC   CATNAME+2(42,@07),CATNAME+1(@07)                    1396 05484000
         MVI   CATNAME(@07),C' '                                   1396 05485000
*                          IF CATRC = CRCBADPW                     1397 05486000
*                            THEN                                  1397 05487000
@RF01395 L     @07,COMVARPT(,COMPTR)                               1397 05488000
         CLC   CATRC(2,@07),@CH01313                               1397 05489000
         BNE   @RF01397                                            1397 05490000
*                              PWTALLY = PWTALLY + 1;              1398 05491000
         LA    @07,1                                               1398 05492000
         AL    @07,PWTALLY                                         1398 05493000
         ST    @07,PWTALLY                                         1398 05494000
*                          END;                                    1399 05495000
*                        ELSE                                      1400 05496000
*                          RETURN CODE (LASTCC12);                 1400 05497000
         B     @RC01385                                            1400 05498000
@RF01385 LA    @15,12                                              1400 05499000
         L     @14,@SA00004                                        1400 05500000
         LM    @00,@12,@SA00004+8                                  1400 05501000
         BR    @14                                                 1400 05502000
*                      END NOTCATNM;                       /*@YL026UE*/ 05503000
*                  ELSE                                            1402 05504000
*                                                                  1402 05505000
*                    /************************************************/ 05506000
*                    /*                                      @Y30SSMK*/ 05507000
*                    /* OBJECT NAME IN THE UCIR WORKAREA IS  @Y30SSMK*/ 05508000
*                    /* A CATALOG NAME.  GET THE ACB POINTER @Y30SSMK*/ 05509000
*                    /* USED IN SEARCHING THE CATALOG UNTIL  @Y30SSMK*/ 05510000
*                    /* THE NEXT CATALOG OBJECT NAME IS      @Y30SSMK*/ 05511000
*                    /* ENCOUNTERED.                         @Y30SSMK*/ 05512000
*                    /*                                      @Y30SSMK*/ 05513000
*                    /************************************************/ 05514000
*                                                                  1402 05515000
*OBJCATNM:           DO;               /*OBJECT IS CATLG NAME GET ACB*/ 05516000
         B     @RC01209                                            1402 05517000
@RF01209 DS    0H                                                  1402 05518000
OBJCATNM DS    0H                                                  1403 05519000
*                      CTGGTALL = OFF; /*SEARCH ONLY 1 CATLG @YL026UE*/ 05520000
         L     @07,COMSWKPT(,COMPTR)                               1403 05521000
         L     @04,CTGPLPTR(,@07)                                  1403 05522000
         NI    CTGGTALL(@04),B'10111111'                           1403 05523000
*                      IF ADDR(CATNM) = NULLPTR                    1404 05524000
*                        THEN                                      1404 05525000
         L     @04,@PC00001+4                                      1404 05526000
         L     @04,FDTPTR+40(,@04)                                 1404 05527000
         LTR   @04,@04                                             1404 05528000
         BNZ   @RF01404                                            1404 05529000
*                          DO;         /*CATLG NOT USER SPECIFIED    */ 05530000
*                            IF CACBFLG = ON                       1406 05531000
*                              THEN                                1406 05532000
         L     @04,COMFLGPT(,COMPTR)                               1406 05533000
         TM    CACBFLG(@04),B'10000000'                            1406 05534000
         BNO   @RF01406                                            1406 05535000
*        DO;                                               /*@YL026UE*/ 05536000
*                                CATNAME = OBJNM(NLST);    /*@YL026UE*/ 05537000
         L     @04,COMVARPT(,COMPTR)                               1408 05538000
         LH    @02,NLST(,@04)                                      1408 05539000
         MH    @02,@CH01270                                        1408 05540000
         L     @07,OBJNMPTR(,@07)                                  1408 05541000
         ALR   @07,@02                                             1408 05542000
         AL    @07,@CF01608                                        1408 05543000
         MVC   CATNAME(44,@04),OBJNM-5(@07)                        1408 05544000
*        END;                                              /*@YL026UE*/ 05545000
*                              ELSE                                1410 05546000
*                                DO;                       /*@YL026UE*/ 05547000
         B     @RC01406                                            1410 05548000
@RF01406 DS    0H                                                  1411 05549000
*                                  CACBFLG = ON;            /*@YL026UE* 05550000
         L     @07,COMFLGPT(,COMPTR)                               1411 05551000
         OI    CACBFLG(@07),B'10000000'                            1411 05552000
*                                  CTGCAT = ADDR(CATNAME); /*@YL026UE*/ 05553000
         L     @07,COMSWKPT(,COMPTR)                               1412 05554000
         L     @04,CTGPLPTR(,@07)                                  1412 05555000
         L     @02,COMVARPT(,COMPTR)                               1412 05556000
         LA    @15,CATNAME(,@02)                                   1412 05557000
         ST    @15,CTGCAT(,@04)                                    1412 05558000
*                                  CTGCNAME = ON;          /*@YL026UE*/ 05559000
         OI    CTGCNAME(@04),B'00000010'                           1413 05560000
*                                  CTGNOFLD = CTGNOFLD + 1;/*@YL026UE*/ 05561000
         LA    @15,1                                               1414 05562000
         SLR   @14,@14                                             1414 05563000
         IC    @14,CTGNOFLD(,@04)                                  1414 05564000
         ALR   @14,@15                                             1414 05565000
         STC   @14,CTGNOFLD(,@04)                                  1414 05566000
*                                  FPLCNT = FPLCNT + 1;    /*@YL026UE*/ 05567000
         LH    @04,FPLCNT(,@02)                                    1415 05568000
         ALR   @04,@15                                             1415 05569000
         STH   @04,FPLCNT(,@02)                                    1415 05570000
*                                  FPLEND = FPLEND + 1;    /*@ZA05939*/ 05571000
         AH    @15,FPLEND(,@02)                                    1416 05572000
         STH   @15,FPLEND(,@02)                                    1416 05573000
*                                  CATNAME = OBJNM(NLST);  /*@YL026UE*/ 05574000
         LH    @04,NLST(,@02)                                      1417 05575000
         MH    @04,@CH01270                                        1417 05576000
         L     @07,OBJNMPTR(,@07)                                  1417 05577000
         ALR   @07,@04                                             1417 05578000
         AL    @07,@CF01608                                        1417 05579000
         MVC   CATNAME(44,@02),OBJNM-5(@07)                        1417 05580000
*                                END;                      /*@YL026UE*/ 05581000
*                          END;                            /*@YL026UE*/ 05582000
@RC01406 DS    0H                                                  1420 05583000
*                    END OBJCATNM;                         /*@YL026UE*/ 05584000
@RF01404 DS    0H                                                  1421 05585000
*                  END OBJLIST;                            /*@Y30LSMK*/ 05586000
@RC01209 L     @04,COMVARPT(,COMPTR)                               1421 05587000
         LA    @07,1                                               1421 05588000
         AH    @07,NLST(,@04)                                      1421 05589000
@DE01151 L     @04,COMVARPT(,COMPTR)                               1421 05590000
         STH   @07,NLST(,@04)                                      1421 05591000
         L     @04,COMSWKPT(,COMPTR)                               1421 05592000
         L     @04,OBJNMPTR(,@04)                                  1421 05593000
         C     @07,OBJCNT(,@04)                                    1421 05594000
         BNH   @DL01151                                            1421 05595000
*                ELSE                                              1422 05596000
*                  IF TESTRC ^= 0                                  1422 05597000
*                    THEN                                          1422 05598000
         B     @RC01150                                            1422 05599000
@RF01150 LTR   TESTRC,TESTRC                                       1422 05600000
         BZ    @RF01422                                            1422 05601000
*                      SAVRC = MAX(SAVRC,TESTRC);          /*@ZA05939*/ 05602000
         L     @07,COMVARPT(,COMPTR)                               1423 05603000
         LH    @02,SAVRC(,@07)                                     1423 05604000
         CR    @02,TESTRC                                          1423 05605000
         BNL   *+6                                                      05606000
         LR    @02,TESTRC                                          1423 05607000
         STH   @02,SAVRC(,@07)                                     1423 05608000
*              END ENTLOC;                                         1424 05609000
@RF01422 DS    0H                                                  1424 05610000
@RC01150 DS    0H                                                  1425 05611000
*        END ENTLIST;                                              1425 05612000
@RF01016 AL    ENTIDX,@CF00045                                     1425 05613000
@DE00987 CH    ENTIDX,NAMECNT                                      1425 05614000
         BNH   @DL00987                                            1425 05615000
*        /************************************************************/ 05616000
*        /*                                                          */ 05617000
*        /* EXIT FROM ENTRYNAME LIST ROUTINE, RETURNING TO EXECUTIVE */ 05618000
*        /* ROUTINE.                                                 */ 05619000
*        /*                                                          */ 05620000
*        /************************************************************/ 05621000
*                                                                  1426 05622000
*        RETURN CODE (0);                                          1426 05623000
         SLR   @15,@15                                             1426 05624000
         L     @14,@SA00004                                        1426 05625000
         LM    @00,@12,@SA00004+8                                  1426 05626000
         BR    @14                                                 1426 05627000
*        END ENTPROC;                                              1427 05628000
*        /************************************************************/ 05629000
*        /*                                                          */ 05630000
*        /* PROCEDURE NAME - RTEPROC                                 */ 05631000
*        /*                                                          */ 05632000
*        /* FUNCTION - ROUTES CONTROL TO THE APPROPRIATE OUTPUT      */ 05633000
*        /* FORMATTING PROCEDURE.  ALSO ROUTES THE ASSOCIATIONS      */ 05634000
*        /* OF A CLUSTER, AIX, PGSPC, OR GDG FOR OUTPUT FORMATTING,  */ 05635000
*        /* IF THERE ARE NO RESTRICTIONS.                    @Y30SSMK*/ 05636000
*        /*                                                          */ 05637000
*        /* INPUT - THE TYPE OF THE RETRIEVED ENTRY.  THE VSAM       */ 05638000
*        /* CATALOG PARM LIST.  AND IF THE ENTRY IS A        @Y30SSMK*/ 05639000
*        /* CLUSTER, AIX, PGSPC, OR GDG, THE ACCOMPANYING C.I.NO.    */ 05640000
*        /* LIST AND A TYPE RESTRICTION SWITCH.              @Y30SSMK*/ 05641000
*        /*                                                          */ 05642000
*        /* OUTPUT - RESTRICTED SWITCH RESET, POSSIBLE ERROR @Y30SSMK*/ 05643000
*        /* MESSAGES.                                        @Y30SSMK*/ 05644000
*        /*                                                          */ 05645000
*        /************************************************************/ 05646000
*                                                                  1428 05647000
*RTEPROC: PROCEDURE (CLENTSW);                                     1428 05648000
*                                                                  1428 05649000
RTEPROC  STM   @14,@12,@SA00005                                    1428 05650000
         MVC   @PC00005(4),0(@01)                                  1428 05651000
*        /************************************************************/ 05652000
*        /*                                                          */ 05653000
*        /* PARAMETERS WHICH MAY BE MODIFIED.                        */ 05654000
*        /*                                                          */ 05655000
*        /************************************************************/ 05656000
*                                                                  1429 05657000
*        DCL CLENTSW   BIT(1);         /*ENTRY RESTRICTED BY TYPES   */ 05658000
*                                                                  1429 05659000
*        /************************************************************/ 05660000
*        /*                                                          */ 05661000
*        /* LOCAL VARIABLES                                          */ 05662000
*        /*                                                          */ 05663000
*        /************************************************************/ 05664000
*                                                                  1430 05665000
*        DCL SAVTYPE   CHAR(1);        /*HOLD FOR TYPES FROM MAIN CPL*/ 05666000
*        DCL CI#IDX    FIXED(15);      /*DO GROUP CONTROL VAR        */ 05667000
*        DCL ASSOCFLG  BIT(1);         /*ASSOC ENTRY O/P SWITCH      */ 05668000
*        DCL NN        FIXED(15);      /*DO GROUP CONTROL VAR        */ 05669000
*        DCL ASSOCNO FIXED(15) UNSIGNED; /*NO. OF ASSOC.     @YL026UE*/ 05670000
*        DCL NUSESW    BIT(1)          /*NOTUSABLE TEST SUCESSFUL    */ 05671000
*                      BDY(BYTE);                          /*@Y30SSMK*/ 05672000
*        DCL DATESW    BIT(1)          /*DATE TEST SUCESSFUL @Y30SSMK*/ 05673000
*                      BDY(BYTE);                          /*@Y30SSMK*/ 05674000
*        DCL VHDRLN    FIXED(31);      /*LEN OF REPEATING DSP INFO 1437 05675000
*                                                            @Y30LSMK*/ 05676000
*        DCL VOLSW     BIT(1)          /*ENTRY IS A VOLUME   @Y30LSMK*/ 05677000
*                      BDY(BYTE);                          /*@Y30LSMK*/ 05678000
*        DCL TIMLESSW  BIT(1)          /*DSCB VOL TIME STAMP SWITCH  */ 05679000
*                      BDY(BYTE);                          /*@Y30LSMK*/ 05680000
*                                                                  1440 05681000
*        OLDERID2 = NEWERID2;                                      1440 05682000
         L     @04,@PC00001                                        1440 05683000
         L     @04,GDTTR2(,@04)                                    1440 05684000
         MVC   @TS00001(95),NEWERID2(@04)                          1440 05685000
         MVC   OLDERID2(95,@04),@TS00001                           1440 05686000
*        NEWID2 = 'LCRT';                                          1441 05687000
         MVC   NEWID2(4,@04),@CC01484                              1441 05688000
*        CTGGTALL = OFF;               /*SEARCH ONE CATALOG  @YL026UE*/ 05689000
*                                                                  1442 05690000
         L     @04,COMSWKPT(,COMPTR)                               1442 05691000
         L     @04,CTGPLPTR(,@04)                                  1442 05692000
         NI    CTGGTALL(@04),B'10111111'                           1442 05693000
*        /************************************************************/ 05694000
*        /*                                                          */ 05695000
*        /*  IF THE PROPER PASSWORD WAS NOT PROVIDED AND EITHER      */ 05696000
*        /*  A FULL LISTING OF THE NAMES IN THE CATALOG IS           */ 05697000
*        /*  REQUESTED OR AN ENTRY LIST WITHOUT TYPE RESTRICTIONS    */ 05698000
*        /*  IS BEING PROCESSED, THE ASSOCIATED NAMES UNDER A        */ 05699000
*        /*  CLUSTER, AIX, OR PGSPC CANNOT BE LOCATED AND LISTED.    */ 05700000
*        /*  SO, PRINT THE CATALOG RETURN CODE MESSAGE AND THE       */ 05701000
*        /*  'ENTRY CANNOT BE LISTED' MESSAGE AND RETURN.            */ 05702000
*        /*                                                          */ 05703000
*        /************************************************************/ 05704000
*                                                                  1443 05705000
*        IF (CATRC=CRCBADPW  &  ADDR(NAME) > NULLPTR)  &   /*@OZ17514*/ 05706000
*         (LISTCFLG=ON  |  (ENLVUDFG=ON  &  TYPECNT=0))    /*@OZ17514*/ 05707000
*          THEN                                            /*@OZ17514*/ 05708000
         L     @04,COMVARPT(,COMPTR)                               1443 05709000
         CLC   CATRC(2,@04),@CH01313                               1443 05710000
         BNE   @RF01443                                            1443 05711000
         SLR   @02,@02                                             1443 05712000
         L     @15,@PC00001+4                                      1443 05713000
         C     @02,FDTPTR+52(,@15)                                 1443 05714000
         BNL   @RF01443                                            1443 05715000
         L     @15,COMFLGPT(,COMPTR)                               1443 05716000
         TM    LISTCFLG(@15),B'10000000'                           1443 05717000
         BO    @RT01443                                            1443 05718000
         TM    ENLVUDFG(@15),B'10000000'                           1443 05719000
         BNO   @RF01443                                            1443 05720000
         CH    @02,TYPECNT(,@04)                                   1443 05721000
         BNE   @RF01443                                            1443 05722000
@RT01443 DS    0H                                                  1444 05723000
*            DO;                                           /*@OZ17514*/ 05724000
*              CALL ERRPROC;                               /*@OZ17514*/ 05725000
         L     @15,@CV00872                                        1445 05726000
         BALR  @14,@15                                             1445 05727000
*              ERRARGPT -> DARGSMOD = LC1ID;               /*@OZ17514*/ 05728000
         L     @04,COMSWKPT(,COMPTR)                               1446 05729000
         L     @02,ERRARGPT(,@04)                                  1446 05730000
         MVC   DARGSMOD(3,@02),@CC01155                            1446 05731000
*              ERRARGPT -> DARGSENT = LCMSG08;             /*@OZ17514*/ 05732000
         MVI   DARGSENT(@02),X'08'                                 1447 05733000
*              ERRARGPT -> DARGDBP = ADDR(SUPPDSNM);       /*@OZ17514*/ 05734000
         L     @04,CTGPLPTR(,@04)                                  1448 05735000
         L     @04,CTGWKA(,@04)                                    1448 05736000
         LA    @04,SUPPDSNM(,@04)                                  1448 05737000
         ST    @04,DARGDBP(,@02)                                   1448 05738000
*              ERRARGPT -> DARGILP = LENGTH(SUPPDSNM);     /*@OZ17514*/ 05739000
         MVC   DARGILP(2,@02),@CH00610                             1449 05740000
*              CALL ERRPROC;                               /*@OZ17514*/ 05741000
         L     @15,@CV00872                                        1450 05742000
         BALR  @14,@15                                             1450 05743000
*              PWTALLY = PWTALLY + 1;                      /*@OZ17514*/ 05744000
         LA    @04,1                                               1451 05745000
         AL    @04,PWTALLY                                         1451 05746000
         ST    @04,PWTALLY                                         1451 05747000
*              SAVRC = MAX (SAVRC, LASTCC04);              /*@ZA05939*/ 05748000
         L     @04,COMVARPT(,COMPTR)                               1452 05749000
         LH    @02,SAVRC(,@04)                                     1452 05750000
         LA    @15,4                                               1452 05751000
         CR    @02,@15                                             1452 05752000
         BNL   *+6                                                      05753000
         LR    @02,@15                                             1452 05754000
         STH   @02,SAVRC(,@04)                                     1452 05755000
*              RETURN CODE(0);                             /*@OZ17514*/ 05756000
         SLR   @15,@15                                             1453 05757000
         L     @14,@SA00005                                        1453 05758000
         LM    @00,@12,@SA00005+8                                  1453 05759000
         BR    @14                                                 1453 05760000
*            END;                                          /*@OZ17514*/ 05761000
*                                                                  1454 05762000
*        /************************************************************/ 05763000
*        /*                                                          */ 05764000
*        /* ROUTE CLUSTER, AIX, OR PGSPC ENTRY TO THE ROUTINE        */ 05765000
*        /* WHICH FORMATS A CLUSTER, AIX, PGSPC, DATA, INDEX,        */ 05766000
*        /* OR PATH OBJECTS.                                         */ 05767000
*        /* NOTE - A PGSPC ENTRY IS ENTERED IN THE CATALOG AS        */ 05768000
*        /* A TYPE 'C' ENTRY.                                        */ 05769000
*        /* ROUTE THE GDG ENTRY TO THE ROUTINE WHICH FORMATS         */ 05770000
*        /* A GDG, UCAT, NVSAM, OR ALIAS OBJECTS.                    */ 05771000
*        /* PASS THE INDICATORS FOR THE TYPE OF LISTING REQUESTED.   */ 05772000
*        /*                                                          */ 05773000
*        /************************************************************/ 05774000
*                                                                  1455 05775000
*        IF HOLDETYP = CTGTCL  |  HOLDETYP = CTGTGBS  |            1455 05776000
*         HOLDETYP = CTGTAIX                                       1455 05777000
*          THEN                                                    1455 05778000
@RF01443 L     @04,COMVARPT(,COMPTR)                               1455 05779000
         CLI   HOLDETYP(@04),C'C'                                  1455 05780000
         BE    @RT01455                                            1455 05781000
         CLI   HOLDETYP(@04),C'B'                                  1455 05782000
         BE    @RT01455                                            1455 05783000
         CLI   HOLDETYP(@04),C'G'                                  1455 05784000
         BNE   @RF01455                                            1455 05785000
@RT01455 DS    0H                                                  1456 05786000
*CLUSTGRP:   DO;                                                   1456 05787000
*                                                                  1456 05788000
CLUSTGRP DS    0H                                                  1457 05789000
*        IF GDTDBG = NULLPTR                                       1457 05790000
*          THEN;                                                   1457 05791000
         L     @04,@PC00001                                        1457 05792000
         L     @04,GDTDBG(,@04)                                    1457 05793000
         LTR   @04,@04                                             1457 05794000
         BZ    @RT01457                                            1457 05795000
*          ELSE                                                    1459 05796000
*            DO;                                                   1459 05797000
*              DMPINDEX = ADDR(DAS#FLGS);                          1460 05798000
*                                                                  1460 05799000
         LA    DMPINDEX,DAS#FLGS                                   1460 05800000
*              DMPITMNM = 'FLAGS';                                 1461 05801000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           1461 05802000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         1461 05803000
         MVC   DMPITMNM(5,DMPINDEX),@CC01439                       1461 05804000
*              DMPITMPT = ADDR(FLAGS);                             1462 05805000
         L     @04,COMFLGPT(,COMPTR)                               1462 05806000
         ST    @04,DMPITMPT(,DMPINDEX)                             1462 05807000
*              DMPITMLN = 33;                                      1463 05808000
         MVC   DMPITMLN(2,DMPINDEX),@CH01139                       1463 05809000
*              DMPITMTP = 'H';                                     1464 05810000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1464 05811000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1465 05812000
*                                                                  1465 05813000
         LA    @04,16                                              1465 05814000
         ALR   DMPINDEX,@04                                        1465 05815000
*              DMPITMNM = 'ASSOC#';                                1466 05816000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1466 05817000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1466 05818000
         MVC   DMPITMNM(6,DMPINDEX),@CC01487                       1466 05819000
*              DMPITMPT = ADDR(ASSOC#);                            1467 05820000
         L     @15,COMVARPT(,COMPTR)                               1467 05821000
         LA    @14,ASSOC#(,@15)                                    1467 05822000
         ST    @14,DMPITMPT(,DMPINDEX)                             1467 05823000
*              DMPITMLN = 2;                                       1468 05824000
         MVC   DMPITMLN(2,DMPINDEX),@CH00161                       1468 05825000
*              DMPITMTP = 'F';                                     1469 05826000
         MVI   DMPITMTP(DMPINDEX),C'F'                             1469 05827000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1470 05828000
*                                                                  1470 05829000
         ALR   DMPINDEX,@04                                        1470 05830000
*              DMPITMNM = 'HOLDETYP';                              1471 05831000
         MVC   DMPITMNM(8,DMPINDEX),@CC01488                       1471 05832000
*              DMPITMPT = ADDR(HOLDETYP);                          1472 05833000
         LA    @15,HOLDETYP(,@15)                                  1472 05834000
         ST    @15,DMPITMPT(,DMPINDEX)                             1472 05835000
*              DMPITMLN = 1;                                       1473 05836000
         MVC   DMPITMLN(2,DMPINDEX),@CH00045                       1473 05837000
*              DMPITMTP = 'C';                                     1474 05838000
         MVI   DMPITMTP(DMPINDEX),C'C'                             1474 05839000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1475 05840000
*                                                                  1475 05841000
         ALR   DMPINDEX,@04                                        1475 05842000
*              DMPTRM = DMPTRMVL;                                  1476 05843000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1476 05844000
*            END;                                           /*@YL026UE* 05845000
*                                                                  1477 05846000
*        IF GDTDBG = NULLPTR                                       1478 05847000
*          THEN;                                                   1478 05848000
@RT01457 L     @04,@PC00001                                        1478 05849000
         L     @04,GDTDBG(,@04)                                    1478 05850000
         LTR   @04,@04                                             1478 05851000
         BZ    @RT01478                                            1478 05852000
*          ELSE                                                    1480 05853000
*            CALL IDCDB010(GDTTBL,'LCRP',DPLISTPT);                1480 05854000
         L     @04,@PC00001                                        1480 05855000
         ST    @04,@AL00001                                        1480 05856000
         LA    @02,@CC01489                                        1480 05857000
         ST    @02,@AL00001+4                                      1480 05858000
         L     @02,COMSWKPT(,COMPTR)                               1480 05859000
         LA    @02,DPLISTPT(,@02)                                  1480 05860000
         ST    @02,@AL00001+8                                      1480 05861000
         MVI   @AL00001+8,X'80'                                    1480 05862000
         L     @15,GDTDBG(,@04)                                    1480 05863000
         LA    @01,@AL00001                                        1480 05864000
         BALR  @14,@15                                             1480 05865000
*                                                          /*@ZA05939*/ 05866000
*                                                                  1481 05867000
*            IF HOLDETYP = CTGTGBS                                 1481 05868000
*              THEN                                                1481 05869000
@RT01478 L     @04,COMVARPT(,COMPTR)                               1481 05870000
         CLI   HOLDETYP(@04),C'B'                                  1481 05871000
         BNE   @RF01481                                            1481 05872000
*                DO;                                       /*@YL026UE*/ 05873000
*                  CALL ANSVPROC;      /* SAVE ASSOC CI#     @YL026UE*/ 05874000
         L     @15,@CV00877                                        1483 05875000
         BALR  @14,@15                                             1483 05876000
*                  RESPECIFY RTNREG RSTD;                          1484 05877000
*                  TESTRC = RTNREG;                                1485 05878000
         LR    TESTRC,RTNREG                                       1485 05879000
*                  RESPECIFY RTNREG UNRSTD;                /*@YL026UE*/ 05880000
*                  IF TESTRC ^= 0                                  1487 05881000
*                    THEN                                          1487 05882000
         LTR   TESTRC,TESTRC                                       1487 05883000
         BZ    @RF01487                                            1487 05884000
*                      RETURN CODE(SAVRC);                 /*@ZA05939*/ 05885000
         L     @04,COMVARPT(,COMPTR)                               1488 05886000
         LH    @15,SAVRC(,@04)                                     1488 05887000
         L     @14,@SA00005                                        1488 05888000
         LM    @00,@12,@SA00005+8                                  1488 05889000
         BR    @14                                                 1488 05890000
*                  CALL AUPROC;                            /*@YL026UE*/ 05891000
@RF01487 L     @15,@CV00874                                        1489 05892000
         BALR  @14,@15                                             1489 05893000
*                END;                                      /*@YL026UE*/ 05894000
*                                                                  1490 05895000
*                                                                  1490 05896000
*              ELSE                                                1491 05897000
*                DO;                                               1491 05898000
         B     @RC01481                                            1491 05899000
@RF01481 DS    0H                                                  1492 05900000
*                  ENTCLFLG = ON;                          /*@YL026UE*/ 05901000
         L     @04,COMFLGPT(,COMPTR)                               1492 05902000
         OI    ENTCLFLG(@04),B'10000000'                           1492 05903000
*                  CALL CDIPROC;                           /*@YL026UE*/ 05904000
         L     @15,@CV00875                                        1493 05905000
         BALR  @14,@15                                             1493 05906000
*                END;                                              1494 05907000
*                                                                  1494 05908000
*            RESPECIFY RTNREG RSTD;                                1495 05909000
@RC01481 DS    0H                                                  1496 05910000
*            TESTRC = RTNREG;                                      1496 05911000
         LR    TESTRC,RTNREG                                       1496 05912000
*            RESPECIFY RTNREG UNRSTD;                              1497 05913000
*                                                                  1497 05914000
*            /********************************************************/ 05915000
*            /*                                                      */ 05916000
*            /* IF THE LISTING OF THE CLUSTER , AIX, PGSPC, OR GDG   */ 05917000
*            /* WAS UNSUCCESSFUL EXIT FROM THIS PROCEDURE.   @Y30SSMK*/ 05918000
*            /*                                                      */ 05919000
*            /********************************************************/ 05920000
*                                                                  1498 05921000
*            IF TESTRC ^= 0                                        1498 05922000
*              THEN                                                1498 05923000
         LTR   TESTRC,TESTRC                                       1498 05924000
         BZ    @RF01498                                            1498 05925000
*                RETURN CODE (SAVRC);                      /*@ZA05939*/ 05926000
         L     @04,COMVARPT(,COMPTR)                               1499 05927000
         LH    @15,SAVRC(,@04)                                     1499 05928000
         L     @14,@SA00005                                        1499 05929000
         LM    @00,@12,@SA00005+8                                  1499 05930000
         BR    @14                                                 1499 05931000
*            /********************************************************/ 05932000
*            /*                                                      */ 05933000
*            /* RESTORE STRING OF FPL'S BEFORE PROCESSING ANY        */ 05934000
*            /* ASSOCIATED ENTRIES.                                  */ 05935000
*            /*                                                      */ 05936000
*            /********************************************************/ 05937000
*                                                                  1500 05938000
*            CALL FPLPROC;                                         1500 05939000
@RF01498 L     @15,@CV00873                                        1500 05940000
         BALR  @14,@15                                             1500 05941000
*            /********************************************************/ 05942000
*            /*                                                      */ 05943000
*            /*   SECONDARY ENTRY POINT BYPASSES CALL TO FORMAT A    */ 05944000
*            /*   CLUSTER, AIX, PGSPC, OR GDG ENTRY WHICH FAILS TO   */ 05945000
*            /*   MATCH A TYPE QUALIFICATION. HOWEVER, THE   @Y30SSMK*/ 05946000
*            /*   ASSOCIATED DATASETS OF THE CLUSTER, AIX, PGSPC,    */ 05947000
*            /*   OR GDG ARE CHECKED FOR QUALIFICATION       @Y30SSMK*/ 05948000
*            /*   AND SUBSEQUENTLY OUTPUT.                   @Y30SSMK*/ 05949000
*            /*                                                      */ 05950000
*            /********************************************************/ 05951000
*                                                                  1501 05952000
*RTEASSOC:   ENTRY (CLENTSW);                                      1501 05953000
         B     @EC01501                                            1501 05954000
RTEASSOC STM   @14,@12,@SA00005                                    1501 05955000
         MVC   @PC00005(4),0(@01)                                  1501 05956000
@EC01501 DS    0H                                                  1502 05957000
*              OLDERID2 = NEWERID2;                                1502 05958000
         L     @04,@PC00001                                        1502 05959000
         L     @02,GDTTR2(,@04)                                    1502 05960000
         MVC   @TS00001(95),NEWERID2(@02)                          1502 05961000
         MVC   OLDERID2(95,@02),@TS00001                           1502 05962000
*              NEWID2 = 'LCR2';                                    1503 05963000
*                                                                  1503 05964000
         MVC   NEWID2(4,@02),@CC01494                              1503 05965000
*        IF GDTDBG = NULLPTR                                       1504 05966000
*          THEN;                                                   1504 05967000
         L     @04,GDTDBG(,@04)                                    1504 05968000
         LTR   @04,@04                                             1504 05969000
         BZ    @RT01504                                            1504 05970000
*          ELSE                                                    1506 05971000
*            CALL IDCDB010(GDTTBL,'LCRA',DPLISTPT);                1506 05972000
         L     @04,@PC00001                                        1506 05973000
         ST    @04,@AL00001                                        1506 05974000
         LA    @02,@CC01495                                        1506 05975000
         ST    @02,@AL00001+4                                      1506 05976000
         L     @02,COMSWKPT(,COMPTR)                               1506 05977000
         LA    @02,DPLISTPT(,@02)                                  1506 05978000
         ST    @02,@AL00001+8                                      1506 05979000
         MVI   @AL00001+8,X'80'                                    1506 05980000
         L     @15,GDTDBG(,@04)                                    1506 05981000
         LA    @01,@AL00001                                        1506 05982000
         BALR  @14,@15                                             1506 05983000
*                                                          /*@ZA05939*/ 05984000
*                                                                  1507 05985000
*            /********************************************************/ 05986000
*            /*                                                      */ 05987000
*            /* PROCESS THE CATALOG INFORMATION FOR EACH ASSOCIATION */ 05988000
*            /* OF A CLUSTER, AIX, PGSPC, OR GDG IF THERE    @Y30SSMK*/ 05989000
*            /* ARE ASSOCIATIONS AND A GENERIC LOCATE WAS    @Y30SSMK*/ 05990000
*            /* NOT ISSUED AND:                              @Y30SSMK*/ 05991000
*            /*    1)  THE TYPE SPECIFICATION IS MET, OR             */ 05992000
*            /*    2)  THERE ARE NO TYPE RESTRICTIONS, OR            */ 05993000
*            /*    3)  A FULL LISTING OF THE CATALOG IS REQUESTED    */ 05994000
*            /*                                                      */ 05995000
*            /********************************************************/ 05996000
*                                                                  1507 05997000
*            IF (CLENTSW=ON | TYPECNT=0 | LISTCFLG=ON)             1507 05998000
*               &  ASSOC# >0  &  NOGENFLG=ON                       1507 05999000
*              THEN                                                1507 06000000
@RT01504 L     @04,@PC00005                                        1507 06001000
         TM    CLENTSW(@04),B'10000000'                            1507 06002000
         BO    @GL00118                                            1507 06003000
         L     @04,COMVARPT(,COMPTR)                               1507 06004000
         LH    @04,TYPECNT(,@04)                                   1507 06005000
         LTR   @04,@04                                             1507 06006000
         BZ    @GL00118                                            1507 06007000
         L     @04,COMFLGPT(,COMPTR)                               1507 06008000
         TM    LISTCFLG(@04),B'10000000'                           1507 06009000
         BNO   @RF01507                                            1507 06010000
@GL00118 L     @04,COMVARPT(,COMPTR)                               1507 06011000
         LH    @04,ASSOC#(,@04)                                    1507 06012000
         LTR   @04,@04                                             1507 06013000
         BNP   @RF01507                                            1507 06014000
         L     @04,COMFLGPT(,COMPTR)                               1507 06015000
         TM    NOGENFLG(@04),B'10000000'                           1507 06016000
         BNO   @RF01507                                            1507 06017000
*LSTASSOC:       DO;                                               1508 06018000
LSTASSOC DS    0H                                                  1509 06019000
*                SAVTYPE = CTGTYPE;                                1509 06020000
         L     @06,COMSWKPT(,COMPTR)                               1509 06021000
         L     @06,CTGPLPTR(,@06)                                  1509 06022000
         MVC   SAVTYPE(1),CTGTYPE(@06)                             1509 06023000
*                CTGTYPE = NOTYPE;     /*NO TYPE REQUEST             */ 06024000
         MVC   CTGTYPE(1,@06),NOTYPE                               1510 06025000
*                CTGNAME = OFF;        /*C.I.NO. FURNISHED           */ 06026000
         NI    CTGNAME(@06),B'11111011'                            1511 06027000
*                CTGGTNXT = OFF;       /*SINGLE ENTRY MODE           */ 06028000
         NI    CTGGTNXT(@06),B'11101111'                           1512 06029000
*                /****************************************************/ 06030000
*                /*                                                  */ 06031000
*                /* PROCESS THE LIST OF ASSOCIATED TYPES AND C.I.NOS.*/ 06032000
*                /* FURNISHED BY CAT/MGMT.  IF ANY ELEMENT IN THE    */ 06033000
*                /* LIST WAS DETECTED EARLIER TO BE INVALID, BYPASS  */ 06034000
*                /* IT.  IF A TYPE RESTRICTION WAS SPECIFIED AND AN  */ 06035000
*                /* ASSOCIATION DOES NOT MEET IT, BYPASS IT.         */ 06036000
*                /*                                                  */ 06037000
*                /****************************************************/ 06038000
*                                                                  1513 06039000
*                ASSOCNO = ASSOC#;                         /*@YL026UE*/ 06040000
         L     @04,COMVARPT(,COMPTR)                               1513 06041000
         LH    ASSOCNO,ASSOC#(,@04)                                1513 06042000
*CKASSOC:        DO CI#IDX = 1 TO ASSOCNO;                 /*@YL026UE*/ 06043000
CKASSOC  LA    CI#IDX,1                                            1514 06044000
         B     @DE01514                                            1514 06045000
@DL01514 DS    0H                                                  1515 06046000
*                  IF CILSTPTR->ASSOC(CI#IDX) ^= BLANK             1515 06047000
*                    THEN                                          1515 06048000
         LR    @04,CI#IDX                                          1515 06049000
         SLA   @04,2                                               1515 06050000
         L     @02,COMSWKPT(,COMPTR)                               1515 06051000
         L     @02,CILSTPTR(,@02)                                  1515 06052000
         ALR   @02,@04                                             1515 06053000
         AL    @02,@CF01593                                        1515 06054000
         CLI   ASSOC(@02),C' '                                     1515 06055000
         BE    @RF01515                                            1515 06056000
*GOODCI#:              DO;                                         1516 06057000
GOODCI#  DS    0H                                                  1517 06058000
*                      ASSOCFLG = OFF; /*INITIALIZE TO BYPASS ASSOC  */ 06059000
         NI    ASSOCFLG,B'01111111'                                1517 06060000
*                      NDENTFLG = OFF; /*INITIALIZE          @YL026UE*/ 06061000
         L     @04,COMFLGPT(,COMPTR)                               1518 06062000
         NI    NDENTFLG(@04),B'01111111'                           1518 06063000
*                      IF CLENTSW = ON                             1519 06064000
*                        THEN                                      1519 06065000
         L     @04,@PC00005                                        1519 06066000
         TM    CLENTSW(@04),B'10000000'                            1519 06067000
         BNO   @RF01519                                            1519 06068000
*                          DO NN = 1 TO TYPECNT WHILE (ASSOCFLG=OFF);   06069000
         LA    NN,1                                                1520 06070000
         B     @DE01520                                            1520 06071000
@DL01520 TM    ASSOCFLG,B'10000000'                                1520 06072000
         BNZ   @DC01520                                            1520 06073000
*                            IF CILSTPTR->KIND(CI#IDX) = TYPELIST(NN)   06074000
*                              THEN                                1521 06075000
*                                                                  1521 06076000
         LR    @04,CI#IDX                                          1521 06077000
         SLA   @04,2                                               1521 06078000
         L     @01,COMSWKPT(,COMPTR)                               1521 06079000
         L     @15,CILSTPTR(,@01)                                  1521 06080000
         L     @14,COMVARPT(,COMPTR)                               1521 06081000
         ST    @04,@TF00001                                        1521 06082000
         ALR   @04,@15                                             1521 06083000
         AL    @04,@CF01593                                        1521 06084000
         ALR   @14,NN                                              1521 06085000
         CLC   KIND(1,@04),TYPELIST-1(@14)                         1521 06086000
         BNE   @RF01521                                            1521 06087000
*                                /************************************/ 06088000
*                                /*                                  */ 06089000
*                                /* PROCESS ONLY THE DATA, INDEX,    */ 06090000
*                                /* PATH, OR NVSAM ASSOCIATION       */ 06091000
*                                /* MEETING A TYPE SPECIFICATION.    */ 06092000
*                                /*                                  */ 06093000
*                                /************************************/ 06094000
*                                                                  1522 06095000
*                                IF CILSTPTR->KIND(CI#IDX) = CTGTDATA | 06096000
*                                  CILSTPTR->KIND(CI#IDX) = CTGTINDX |  06097000
*                                  CILSTPTR->KIND(CI#IDX) = CTGTPTH |   06098000
*                                  CILSTPTR->KIND(CI#IDX) = CTGTALIN    06099000
*                                  THEN                            1522 06100000
         LR    @04,@15                                             1522 06101000
         AL    @04,@TF00001                                        1522 06102000
         AL    @04,@CF01593                                        1522 06103000
         CLI   KIND(@04),C'D'                                      1522 06104000
         BE    @RT01522                                            1522 06105000
         LR    @04,@15                                             1522 06106000
         AL    @04,@TF00001                                        1522 06107000
         AL    @04,@CF01593                                        1522 06108000
         CLI   KIND(@04),C'I'                                      1522 06109000
         BE    @RT01522                                            1522 06110000
         LR    @04,@15                                             1522 06111000
         AL    @04,@TF00001                                        1522 06112000
         AL    @04,@CF01593                                        1522 06113000
         CLI   KIND(@04),C'R'                                      1522 06114000
         BE    @RT01522                                            1522 06115000
         AL    @15,@TF00001                                        1522 06116000
         AL    @15,@CF01593                                        1522 06117000
         CLI   KIND(@15),C'A'                                      1522 06118000
         BNE   @RF01522                                            1522 06119000
@RT01522 DS    0H                                                  1523 06120000
*                                    ASSOCFLG = ON;        /*@Y30SSMK*/ 06121000
         OI    ASSOCFLG,B'10000000'                                1523 06122000
*                          END;                                    1524 06123000
*                                                                  1524 06124000
@RF01522 DS    0H                                                  1524 06125000
@RF01521 AL    NN,@CF00045                                         1524 06126000
@DE01520 L     @04,COMVARPT(,COMPTR)                               1524 06127000
         CH    NN,TYPECNT(,@04)                                    1524 06128000
         BNH   @DL01520                                            1524 06129000
@DC01520 DS    0H                                                  1525 06130000
*                        /********************************************/ 06131000
*                        /*                                          */ 06132000
*                        /* PROCESS ONLY THE DATA, INDEX, PATH, OR   */ 06133000
*                        /* NVSAM ASSOCIATION THAT IS NOT RESTRICTED */ 06134000
*                        /* BY A TYPE SPECIFICATION.         @Y30SSMK*/ 06135000
*                        /*                                          */ 06136000
*                        /********************************************/ 06137000
*                                                                  1525 06138000
*                        ELSE                                      1525 06139000
*                          IF CILSTPTR->KIND(CI#IDX) = CTGTDATA |  1525 06140000
*                            CILSTPTR->KIND(CI#IDX) = CTGTINDX |   1525 06141000
*                            CILSTPTR->KIND(CI#IDX) = CTGTPTH |    1525 06142000
*                            CILSTPTR->KIND(CI#IDX) = CTGTALIN     1525 06143000
*                            THEN                                  1525 06144000
         B     @RC01519                                            1525 06145000
@RF01519 LR    @04,CI#IDX                                          1525 06146000
         SLA   @04,2                                               1525 06147000
         L     @02,COMSWKPT(,COMPTR)                               1525 06148000
         L     @02,CILSTPTR(,@02)                                  1525 06149000
         ST    @04,@TF00001                                        1525 06150000
         ALR   @04,@02                                             1525 06151000
         AL    @04,@CF01593                                        1525 06152000
         CLI   KIND(@04),C'D'                                      1525 06153000
         BE    @RT01525                                            1525 06154000
         LR    @04,@02                                             1525 06155000
         AL    @04,@TF00001                                        1525 06156000
         AL    @04,@CF01593                                        1525 06157000
         CLI   KIND(@04),C'I'                                      1525 06158000
         BE    @RT01525                                            1525 06159000
         LR    @04,@02                                             1525 06160000
         AL    @04,@TF00001                                        1525 06161000
         AL    @04,@CF01593                                        1525 06162000
         CLI   KIND(@04),C'R'                                      1525 06163000
         BE    @RT01525                                            1525 06164000
         AL    @02,@TF00001                                        1525 06165000
         AL    @02,@CF01593                                        1525 06166000
         CLI   KIND(@02),C'A'                                      1525 06167000
         BNE   @RF01525                                            1525 06168000
@RT01525 DS    0H                                                  1526 06169000
*                              ASSOCFLG = ON;              /*@Y30SSMK*/ 06170000
         OI    ASSOCFLG,B'10000000'                                1526 06171000
*                      /**********************************************/ 06172000
*                      /*                                            */ 06173000
*                      /* IF THE ASSOCIATED ENTRY HAS BEEN FLAGGED   */ 06174000
*                      /* FOR PROCESSING, OBTAIN THE CATALOG FIELDS  */ 06175000
*                      /* FOR THIS ASSOCIATION.                      */ 06176000
*                      /*                                            */ 06177000
*                      /**********************************************/ 06178000
*                                                                  1527 06179000
*                      IF ASSOCFLG = ON                            1527 06180000
*                        THEN                                      1527 06181000
@RF01525 DS    0H                                                  1527 06182000
@RC01519 TM    ASSOCFLG,B'10000000'                                1527 06183000
         BNO   @RF01527                                            1527 06184000
*YESASSOC:                 DO;                                     1528 06185000
YESASSOC DS    0H                                                  1529 06186000
*                          NDENTFLG = ON; /*INDENT ASSOC     @YL026UE*/ 06187000
         L     @02,COMFLGPT(,COMPTR)                               1529 06188000
         OI    NDENTFLG(@02),B'10000000'                           1529 06189000
*                          CTGENT = ADDR(CILSTPTR->CI#(CI#IDX));   1530 06190000
         L     @15,COMSWKPT(,COMPTR)                               1530 06191000
         L     @01,CTGPLPTR(,@15)                                  1530 06192000
         LR    @14,CI#IDX                                          1530 06193000
         SLA   @14,2                                               1530 06194000
         L     @15,CILSTPTR(,@15)                                  1530 06195000
         AL    @15,@CF01611                                        1530 06196000
         LA    @00,CI#-1(@14,@15)                                  1530 06197000
         ST    @00,CTGENT(,@01)                                    1530 06198000
*                          CALL LOCPROC (FPLEND,CACBFLG,ENTNMFLG); 1531 06199000
         L     @01,COMVARPT(,COMPTR)                               1531 06200000
         LA    @15,FPLEND(,@01)                                    1531 06201000
         ST    @15,@AL00001                                        1531 06202000
         ST    @02,@AL00001+4                                      1531 06203000
         LA    @02,ENTNMFLG(,@02)                                  1531 06204000
         ST    @02,@AL00001+8                                      1531 06205000
         L     @15,@CV00870                                        1531 06206000
         LA    @01,@AL00001                                        1531 06207000
         BALR  @14,@15                                             1531 06208000
*                          RESPECIFY RTNREG RSTD;                  1532 06209000
*                          TESTRC = RTNREG;                        1533 06210000
         LR    TESTRC,RTNREG                                       1533 06211000
*                          RESPECIFY RTNREG UNRSTD;                1534 06212000
*                                                                  1534 06213000
*                          /******************************************/ 06214000
*                          /*                                        */ 06215000
*                          /* IF THE LOCATE WAS UNSUCCESSFUL,        */ 06216000
*                          /* INTERROGATE THE NON-ZERO CATALOG       */ 06217000
*                          /* RETURN CODE.                           */ 06218000
*                          /*                                        */ 06219000
*                          /******************************************/ 06220000
*                                                                  1535 06221000
*                          IF TESTRC ^= 0                          1535 06222000
*                            THEN                                  1535 06223000
         LTR   TESTRC,TESTRC                                       1535 06224000
         BZ    @RF01535                                            1535 06225000
*BADCRC:                       DO;                                 1536 06226000
*                                                                  1536 06227000
BADCRC   DS    0H                                                  1537 06228000
*                              /**************************************/ 06229000
*                              /*                                    */ 06230000
*                              /* EXIT FOR TERMINATING ERRORS.       */ 06231000
*                              /*                                    */ 06232000
*                              /**************************************/ 06233000
*                                                                  1537 06234000
*                              IF TESTRC = LASTCC12                1537 06235000
*                                THEN                              1537 06236000
         LA    @02,12                                              1537 06237000
         CR    TESTRC,@02                                          1537 06238000
         BNE   @RF01537                                            1537 06239000
*                                  RETURN CODE (LASTCC12);         1538 06240000
*                                                                  1538 06241000
         LR    @15,@02                                             1538 06242000
         L     @14,@SA00005                                        1538 06243000
         LM    @00,@12,@SA00005+8                                  1538 06244000
         BR    @14                                                 1538 06245000
*                              /**************************************/ 06246000
*                              /*                                    */ 06247000
*                              /* OUTPUT DIAGNOSTICS FOR AN          */ 06248000
*                              /* INSUFFICIENT WORKAREA CONDITION OR */ 06249000
*                              /* PASSWORD VERIFICATION FAILURE.     */ 06250000
*                              /*                                    */ 06251000
*                              /**************************************/ 06252000
*                                                                  1539 06253000
*                              IF CATRC = CRCWKASZ  |              1539 06254000
*                                (CATRC = CRCBADPW  &              1539 06255000
*                                ADDR(NAME) = NULLPTR)             1539 06256000
*                                THEN                              1539 06257000
@RF01537 L     @02,COMVARPT(,COMPTR)                               1539 06258000
         LH    @02,CATRC(,@02)                                     1539 06259000
         C     @02,@CF01311                                        1539 06260000
         BE    @RT01539                                            1539 06261000
         C     @02,@CF01313                                        1539 06262000
         BNE   @RF01539                                            1539 06263000
         L     @02,@PC00001+4                                      1539 06264000
         L     @02,FDTPTR+52(,@02)                                 1539 06265000
         LTR   @02,@02                                             1539 06266000
         BNZ   @RF01539                                            1539 06267000
@RT01539 DS    0H                                                  1540 06268000
*                                  DO;                             1540 06269000
*                                  SAVRC = MAX (SAVRC, TESTRC);    1541 06270000
         L     @02,COMVARPT(,COMPTR)                               1541 06271000
         LH    @15,SAVRC(,@02)                                     1541 06272000
         CR    @15,TESTRC                                          1541 06273000
         BNL   *+6                                                      06274000
         LR    @15,TESTRC                                          1541 06275000
         STH   @15,SAVRC(,@02)                                     1541 06276000
*                                  CALL ERRPROC;                   1542 06277000
*                                                                  1542 06278000
         L     @15,@CV00872                                        1542 06279000
         BALR  @14,@15                                             1542 06280000
*                                  /**********************************/ 06281000
*                                  /*                                */ 06282000
*                                  /* IF PASSWORD VERIFICATION FAILED*/ 06283000
*                                  /* WHEN PROCESSING THE CATALOG FOR*/ 06284000
*                                  /* MORE THAN JUST ENTRYNAMES, LIST*/ 06285000
*                                  /* THE APPRO MESSAGES AND UPDATE  */ 06286000
*                                  /* THE ENTRY SUPPRESSED TALLY.    */ 06287000
*                                  /*                                */ 06288000
*                                  /**********************************/ 06289000
*                                                                  1543 06290000
*                                  IF CATRC = CRCBADPW             1543 06291000
*                                    THEN                          1543 06292000
         L     @04,COMVARPT(,COMPTR)                               1543 06293000
         CLC   CATRC(2,@04),@CH01313                               1543 06294000
         BNE   @RF01543                                            1543 06295000
*                                      DO;                         1544 06296000
*                                      ERRARGPT->DARGSMOD = LC1ID; 1545 06297000
         L     @04,COMSWKPT(,COMPTR)                               1545 06298000
         L     @02,ERRARGPT(,@04)                                  1545 06299000
         MVC   DARGSMOD(3,@02),@CC01155                            1545 06300000
*                                      ERRARGPT->DARGSENT = LCMSG08;    06301000
         MVI   DARGSENT(@02),X'08'                                 1546 06302000
*                                      ERRARGPT->DARGDBP=ADDR(SUPPDSNM) 06303000
         L     @04,CTGPLPTR(,@04)                                  1547 06304000
         L     @04,CTGWKA(,@04)                                    1547 06305000
         LA    @04,SUPPDSNM(,@04)                                  1547 06306000
         ST    @04,DARGDBP(,@02)                                   1547 06307000
*                                      ERRARGPT->DARGILP =         1548 06308000
*                                        LENGTH(SUPPDSNM);         1548 06309000
         MVC   DARGILP(2,@02),@CH00610                             1548 06310000
*                                      CALL ERRPROC;               1549 06311000
         L     @15,@CV00872                                        1549 06312000
         BALR  @14,@15                                             1549 06313000
*                                      PWTALLY = PWTALLY + 1;      1550 06314000
         LA    @04,1                                               1550 06315000
         AL    @04,PWTALLY                                         1550 06316000
         ST    @04,PWTALLY                                         1550 06317000
*                                      END;                        1551 06318000
*                                  END;                            1552 06319000
*                                                                  1552 06320000
*                                /************************************/ 06321000
*                                /*                                  */ 06322000
*                                /* IF THE LOCATE VIA A C.I.NO. WAS  */ 06323000
*                                /* UNSUCCESSFUL, LIST THE VSAM CAT  */ 06324000
*                                /* CONDITION CODE MESSAGE AND THE   */ 06325000
*                                /* INVALID C.I.NO. MESSAGE.         */ 06326000
*                                /* CONTINUE PROCESSING THE LIST OF  */ 06327000
*                                /* ASSOCIATIONS.                    */ 06328000
*                                /*                                  */ 06329000
*                                /************************************/ 06330000
*                                                                  1553 06331000
*                                ELSE                              1553 06332000
*                                  IF CATRC = CRCNOENT             1553 06333000
*                                    THEN                          1553 06334000
         B     @RC01539                                            1553 06335000
@RF01539 L     @02,COMVARPT(,COMPTR)                               1553 06336000
         CLC   CATRC(2,@02),@CH00187                               1553 06337000
         BNE   @RF01553                                            1553 06338000
*                                      DO;                         1554 06339000
*                                      SAVRC = MAX (SAVRC, LASTCC04);   06340000
         LH    @04,SAVRC(,@02)                                     1555 06341000
         LA    @15,4                                               1555 06342000
         CR    @04,@15                                             1555 06343000
         BNL   *+6                                                      06344000
         LR    @04,@15                                             1555 06345000
         STH   @04,SAVRC(,@02)                                     1555 06346000
*                                      CILOCFLG = ON;      /*@OZ09407*/ 06347000
         L     @04,COMFLGPT(,COMPTR)                               1556 06348000
         OI    CILOCFLG(@04),B'10000000'                           1556 06349000
*                                      CALL ERRPROC;               1557 06350000
         L     @15,@CV00872                                        1557 06351000
         BALR  @14,@15                                             1557 06352000
*                                      CILOCFLG = OFF;     /*@OZ09407*/ 06353000
         L     @04,COMFLGPT(,COMPTR)                               1558 06354000
         NI    CILOCFLG(@04),B'01111111'                           1558 06355000
*                                      ERRARGPT->DARGSMOD = LC1ID; 1559 06356000
         L     @04,COMSWKPT(,COMPTR)                               1559 06357000
         L     @02,ERRARGPT(,@04)                                  1559 06358000
         MVC   DARGSMOD(3,@02),@CC01155                            1559 06359000
*                                      ERRARGPT->DARGSENT = LCMSG09;    06360000
         MVI   DARGSENT(@02),X'09'                                 1560 06361000
*                                      ERRARGPT->DARGDBP =         1561 06362000
*                                        ADDR(CILSTPTR->CI#(CI#IDX));   06363000
         LR    @15,CI#IDX                                          1561 06364000
         SLA   @15,2                                               1561 06365000
         L     @04,CILSTPTR(,@04)                                  1561 06366000
         AL    @04,@CF01611                                        1561 06367000
         LA    @04,CI#-1(@15,@04)                                  1561 06368000
         ST    @04,DARGDBP(,@02)                                   1561 06369000
*                                      ERRARGPT->DARGILP =         1562 06370000
*                                        LENGTH(CI#(CI#IDX));      1562 06371000
         MVC   DARGILP(2,@02),@CH00170                             1562 06372000
*                                      CALL ERRPROC;               1563 06373000
         L     @15,@CV00872                                        1563 06374000
         BALR  @14,@15                                             1563 06375000
*                                      END;                        1564 06376000
*                                    ELSE                          1565 06377000
*                                                                  1565 06378000
*                                      /******************************/ 06379000
*                                      /*                            */ 06380000
*                                      /* IF THE PROPER PASSWORD WAS */ 06381000
*                                      /* NOT PROVIDED BUT ONLY ASSOC*/ 06382000
*                                      /* NAMES ARE REQUESTED,       */ 06383000
*                                      /* AND LISTING WAS    @Y30LSMK*/ 06384000
*                                      /* NOT DATE RESTRICTED, OR    */ 06385000
*                                      /* RESTRICTED TO NOTUSABLE    */ 06386000
*                                      /* DATA SETS, CALL    @Y30SSMK*/ 06387000
*                                      /* THE FORMATTING ROUTINE TO  */ 06388000
*                                      /* LIST THE NAME AND DO NOT   */ 06389000
*                                      /* CONSIDER THIS AN ERROR     */ 06390000
*                                      /* SINCE THE TYPE AND NAME OF */ 06391000
*                                      /* THE SUPPRESSED ASSOC ENTRY */ 06392000
*                                      /* WAS RETURNED.              */ 06393000
*                                      /*                            */ 06394000
*                                      /******************************/ 06395000
*                                                                  1565 06396000
*                                      IF CATRC = CRCBADPW &       1565 06397000
*                                        ADDR(NAME) > NULLPTR &    1565 06398000
*                                        DATEFLG = OFF & NUSEFLG = OFF  06399000
*                                        THEN                      1565 06400000
         B     @RC01553                                            1565 06401000
@RF01553 L     @02,COMVARPT(,COMPTR)                               1565 06402000
         CLC   CATRC(2,@02),@CH01313                               1565 06403000
         BNE   @RF01565                                            1565 06404000
         L     @15,@PC00001+4                                      1565 06405000
         L     @15,FDTPTR+52(,@15)                                 1565 06406000
         LTR   @15,@15                                             1565 06407000
         BNP   @RF01565                                            1565 06408000
         L     @15,COMFLGPT(,COMPTR)                               1565 06409000
         TM    DATEFLG(@15),B'10000000'                            1565 06410000
         BNZ   @RF01565                                            1565 06411000
         TM    NUSEFLG(@15),B'10000000'                            1565 06412000
         BNZ   @RF01565                                            1565 06413000
*                                          DO;                     1566 06414000
*                                          HOLDETYP = SUPPTYPE;    1567 06415000
         L     @01,COMSWKPT(,COMPTR)                               1567 06416000
         L     @01,CTGPLPTR(,@01)                                  1567 06417000
         L     @01,CTGWKA(,@01)                                    1567 06418000
         MVC   HOLDETYP(1,@02),SUPPTYPE(@01)                       1567 06419000
*                                          CALL CDIPROC;           1568 06420000
         L     @15,@CV00875                                        1568 06421000
         BALR  @14,@15                                             1568 06422000
*                                          RESPECIFY RTNREG RSTD;  1569 06423000
*                                          TESTRC = RTNREG;        1570 06424000
         LR    TESTRC,RTNREG                                       1570 06425000
*                                          RESPECIFY RTNREG UNRSTD;     06426000
*                                          IF TESTRC ^= 0          1572 06427000
*                                            THEN                  1572 06428000
         LTR   TESTRC,TESTRC                                       1572 06429000
         BZ    @RF01572                                            1572 06430000
*                                              RETURN CODE(SAVRC); 1573 06431000
         L     @04,COMVARPT(,COMPTR)                               1573 06432000
         LH    @15,SAVRC(,@04)                                     1573 06433000
         L     @14,@SA00005                                        1573 06434000
         LM    @00,@12,@SA00005+8                                  1573 06435000
         BR    @14                                                 1573 06436000
*                                          CALL FPLPROC;           1574 06437000
@RF01572 L     @15,@CV00873                                        1574 06438000
         BALR  @14,@15                                             1574 06439000
*                                          END;                    1575 06440000
*                                        ELSE                      1576 06441000
*                                          DO;                     1576 06442000
         B     @RC01565                                            1576 06443000
@RF01565 DS    0H                                                  1577 06444000
*                                          SAVRC = MAX (SAVRC,TESTRC);  06445000
         L     @02,COMVARPT(,COMPTR)                               1577 06446000
         LH    @15,SAVRC(,@02)                                     1577 06447000
         CR    @15,TESTRC                                          1577 06448000
         BNL   *+6                                                      06449000
         LR    @15,TESTRC                                          1577 06450000
         STH   @15,SAVRC(,@02)                                     1577 06451000
*                                          CALL ERRPROC;           1578 06452000
         L     @15,@CV00872                                        1578 06453000
         BALR  @14,@15                                             1578 06454000
*                                          IF CATRC = CRCBADPW &   1579 06455000
*                                            ADDR(NAME) > NULLPTR &     06456000
*                                            (DATEFLG = ON  |      1579 06457000
*                                            NUSEFLG = ON)         1579 06458000
*                                            THEN                  1579 06459000
         L     @04,COMVARPT(,COMPTR)                               1579 06460000
         CLC   CATRC(2,@04),@CH01313                               1579 06461000
         BNE   @RF01579                                            1579 06462000
         L     @04,@PC00001+4                                      1579 06463000
         L     @04,FDTPTR+52(,@04)                                 1579 06464000
         LTR   @04,@04                                             1579 06465000
         BNP   @RF01579                                            1579 06466000
         L     @04,COMFLGPT(,COMPTR)                               1579 06467000
         TM    DATEFLG(@04),B'10000000'                            1579 06468000
         BO    @RT01579                                            1579 06469000
         TM    NUSEFLG(@04),B'10000000'                            1579 06470000
         BNO   @RF01579                                            1579 06471000
@RT01579 DS    0H                                                  1580 06472000
*                                              PWTALLY = PWTALLY + 1;   06473000
         LA    @04,1                                               1580 06474000
         AL    @04,PWTALLY                                         1580 06475000
         ST    @04,PWTALLY                                         1580 06476000
*                                          END;                    1581 06477000
*                              END BADCRC;                         1582 06478000
*                            /****************************************/ 06479000
*                            /*                              @Y30SSMK*/ 06480000
*                            /* CONTINUE PROCESSING IF -     @Y30SSMK*/ 06481000
*                            /*   1. NOTUSABLE OPTION AND    @Y30SSMK*/ 06482000
*                            /*      CREATION/EXPIRATION OPTION HAVE */ 06483000
*                            /*      NOT BEEN REQUESTED, OR  @Y30SSMK*/ 06484000
*                            /*   2. NOTUSABLE OPTION HAS BEEN       */ 06485000
*                            /*      REQUESTED AND THE ASSOCIATED    */ 06486000
*                            /*      DATA OR INDEX CATALOG ENTRY HAS */ 06487000
*                            /*      BEEN MARKED UNUSABLE, AND/OR    */ 06488000
*                            /*   3. CREATION/EXPIRATION OPTION HAS  */ 06489000
*                            /*      BEEN REQUESTED AND THE  @Y30SSMK*/ 06490000
*                            /*      ASSOCIATED CATALOG ENTRY PASSES */ 06491000
*                            /*      THE DATE TEST.          @Y30SSMK*/ 06492000
*                            /*                              @Y30SSMK*/ 06493000
*                            /****************************************/ 06494000
*                                                                  1583 06495000
*                            ELSE                                  1583 06496000
*GOODCRC:                      DO;                         /*@Y30SSMK*/ 06497000
         B     @RC01535                                            1583 06498000
@RF01535 DS    0H                                                  1583 06499000
GOODCRC  DS    0H                                                  1584 06500000
*                              HOLDETYP = CILSTPTR->KIND(CI#IDX);  1584 06501000
         L     @04,COMVARPT(,COMPTR)                               1584 06502000
         LR    @02,CI#IDX                                          1584 06503000
         SLA   @02,2                                               1584 06504000
         L     @01,COMSWKPT(,COMPTR)                               1584 06505000
         L     @01,CILSTPTR(,@01)                                  1584 06506000
         ALR   @01,@02                                             1584 06507000
         AL    @01,@CF01593                                        1584 06508000
         MVC   HOLDETYP(1,@04),KIND(@01)                           1584 06509000
*                              IF (NUSEFLG = ON  &                 1585 06510000
*                                (HOLDETYP = CTGTDATA  |           1585 06511000
*                                HOLDETYP = CTGTINDX))  |          1585 06512000
*                                (CLENTSW = ON  &  DATEFLG = ON)   1585 06513000
*                                THEN                              1585 06514000
         L     @02,COMFLGPT(,COMPTR)                               1585 06515000
         TM    NUSEFLG(@02),B'10000000'                            1585 06516000
         BNO   @GL00135                                            1585 06517000
         CLI   HOLDETYP(@04),C'D'                                  1585 06518000
         BE    @RT01585                                            1585 06519000
         CLI   HOLDETYP(@04),C'I'                                  1585 06520000
         BE    @RT01585                                            1585 06521000
@GL00135 L     @04,@PC00005                                        1585 06522000
         TM    CLENTSW(@04),B'10000000'                            1585 06523000
         BNO   @RF01585                                            1585 06524000
         L     @04,COMFLGPT(,COMPTR)                               1585 06525000
         TM    DATEFLG(@04),B'10000000'                            1585 06526000
         BNO   @RF01585                                            1585 06527000
@RT01585 DS    0H                                                  1586 06528000
*                                  DO;                     /*@Y30SSMK*/ 06529000
*                                  NUSESW = OFF;           /*@Y30SSMK*/ 06530000
         NI    NUSESW,B'01111111'                                  1587 06531000
*                                  DATESW = OFF;           /*@Y30SSMK*/ 06532000
         NI    DATESW,B'01111111'                                  1588 06533000
*                                  IF NUSEFLG = ON  &              1589 06534000
*                                    (HOLDETYP = CTGTDATA  |       1589 06535000
*                                    HOLDETYP = CTGTINDX)          1589 06536000
*                                    THEN                          1589 06537000
*                                                                  1589 06538000
         L     @04,COMFLGPT(,COMPTR)                               1589 06539000
         TM    NUSEFLG(@04),B'10000000'                            1589 06540000
         BNO   @RF01589                                            1589 06541000
         L     @04,COMVARPT(,COMPTR)                               1589 06542000
         CLI   HOLDETYP(@04),C'D'                                  1589 06543000
         BE    @RT01589                                            1589 06544000
         CLI   HOLDETYP(@04),C'I'                                  1589 06545000
         BNE   @RF01589                                            1589 06546000
@RT01589 DS    0H                                                  1590 06547000
*                                      /******************************/ 06548000
*                                      /*                    @Y30SSMK*/ 06549000
*                                      /* POSITION FPL POINTER TO THE*/ 06550000
*                                      /* DATA SET ATTRIBUTES FPL.   */ 06551000
*                                      /*                    @Y30SSMK*/ 06552000
*                                      /******************************/ 06553000
*                                                                  1590 06554000
*                                      DO;                 /*@Y30SSMK*/ 06555000
*                                      IF ADDR(FALL) = NULLPTR     1591 06556000
*                                        THEN                      1591 06557000
         L     @04,@PC00001+4                                      1591 06558000
         L     @04,FDTPTR+56(,@04)                                 1591 06559000
         LTR   @04,@04                                             1591 06560000
         BNZ   @RF01591                                            1591 06561000
*                                          CTGFLPTR = FPLPTMAP(FPLATR); 06562000
         L     @04,COMSWKPT(,COMPTR)                               1592 06563000
         LH    @02,FPLATR                                          1592 06564000
         SLA   @02,2                                               1592 06565000
         L     @01,COMFPLPT(,COMPTR)                               1592 06566000
         AL    @01,@CF01593                                        1592 06567000
         L     @02,FPLPTMAP(@02,@01)                               1592 06568000
         ST    @02,CTGFLPTR(,@04)                                  1592 06569000
*                                        ELSE                      1593 06570000
*                                          CTGFLPTR = ATTRFPT;     1593 06571000
         B     @RC01591                                            1593 06572000
@RF01591 L     @04,COMSWKPT(,COMPTR)                               1593 06573000
         L     @02,COMFPLPT(,COMPTR)                               1593 06574000
         L     @02,ATTRFPT(,@02)                                   1593 06575000
         ST    @02,CTGFLPTR(,@04)                                  1593 06576000
*                                      IF CTGFLPT(1)  >  NULLPTR   1594 06577000
*                                        THEN                      1594 06578000
@RC01591 L     @04,COMSWKPT(,COMPTR)                               1594 06579000
         L     @04,CTGFLPTR(,@04)                                  1594 06580000
         L     @04,CTGFLPT(,@04)                                   1594 06581000
         LTR   @04,@04                                             1594 06582000
         BNP   @RF01594                                            1594 06583000
*                                          DO;             /*@Y30SSMK*/ 06584000
*                                          IF DSNUSE = ON          1596 06585000
*                                            THEN                  1596 06586000
*                                                                  1596 06587000
         TM    DSNUSE(@04),B'00000001'                             1596 06588000
         BNO   @RF01596                                            1596 06589000
*                                              /**********************/ 06590000
*                                              /*            @Y30SSMK*/ 06591000
*                                              /* PROCESS ENTRY FOR  */ 06592000
*                                              /* SUCCESSFUL @Y30SSMK*/ 06593000
*                                              /* NOTUSABLE TEST.    */ 06594000
*                                              /*            @Y30SSMK*/ 06595000
*                                              /**********************/ 06596000
*                                                                  1597 06597000
*                                              NUSESW = ON;/*@Y30SSMK*/ 06598000
         OI    NUSESW,B'10000000'                                  1597 06599000
*                                          END;            /*@Y30SSMK*/ 06600000
*                                      END;                /*@Y30SSMK*/ 06601000
*                                    ELSE                          1600 06602000
*                                                                  1600 06603000
*                                      /******************************/ 06604000
*                                      /*                    @Y30SSMK*/ 06605000
*                                      /* PROCESS ENTRY IF NOTUSABLE */ 06606000
*                                      /* OPTION WAS NOT REQUESTED.  */ 06607000
*                                      /*                    @Y30SSMK*/ 06608000
*                                      /******************************/ 06609000
*                                                                  1600 06610000
*                                      NUSESW = ON;        /*@Y30SSMK*/ 06611000
*                                                                  1600 06612000
         B     @RC01589                                            1600 06613000
@RF01589 OI    NUSESW,B'10000000'                                  1600 06614000
*                                  IF CLENTSW = ON  &  DATEFLG = ON     06615000
*                                    THEN                          1601 06616000
*                                                                  1601 06617000
@RC01589 L     @04,@PC00005                                        1601 06618000
         TM    CLENTSW(@04),B'10000000'                            1601 06619000
         BNO   @RF01601                                            1601 06620000
         L     @04,COMFLGPT(,COMPTR)                               1601 06621000
         TM    DATEFLG(@04),B'10000000'                            1601 06622000
         BNO   @RF01601                                            1601 06623000
*                                      /******************************/ 06624000
*                                      /*                            */ 06625000
*                                      /* RESET DATE TEST SWITCHES   */ 06626000
*                                      /* AND INVOKE CKDTPROC TO     */ 06627000
*                                      /* TEST THE CREATION AND      */ 06628000
*                                      /* EXPIRATION DATES.  @Y30LSMK*/ 06629000
*                                      /*                            */ 06630000
*                                      /******************************/ 06631000
*                                                                  1602 06632000
*                                      DO;                 /*@Y30LSMK*/ 06633000
*                                      CRDTSW = OFF;       /*@Y30LSMK*/ 06634000
         NI    CRDTSW(@04),B'01111111'                             1603 06635000
*                                      EXDTSW = OFF;       /*@Y30LSMK*/ 06636000
         NI    EXDTSW(@04),B'01111111'                             1604 06637000
*                                      CALL CKDTPROC;      /*@Y30LSMK*/ 06638000
         BAL   @14,CKDTPROC                                        1605 06639000
*                                      IF CRDTSW = ON  &  EXDTSW = ON   06640000
*                                        THEN                      1606 06641000
*                                                                  1606 06642000
         L     @04,COMFLGPT(,COMPTR)                               1606 06643000
         TM    CRDTSW(@04),B'10000000'                             1606 06644000
         BNO   @RF01606                                            1606 06645000
         TM    EXDTSW(@04),B'10000000'                             1606 06646000
         BNO   @RF01606                                            1606 06647000
*                                          /**************************/ 06648000
*                                          /*                        */ 06649000
*                                          /* PROCESS THE ENTRY FOR  */ 06650000
*                                          /* SUCCESSFUL DATE TEST.  */ 06651000
*                                          /*                        */ 06652000
*                                          /**************************/ 06653000
*                                                                  1607 06654000
*                                          DATESW = ON;    /*@Y30LSMK*/ 06655000
         OI    DATESW,B'10000000'                                  1607 06656000
*                                      END;                        1608 06657000
*                                    ELSE                          1609 06658000
*                                                                  1609 06659000
*                                      /******************************/ 06660000
*                                      /*                            */ 06661000
*                                      /* PROCESS ENTRY IF CREATION  */ 06662000
*                                      /* EXPIRATION OPTION WAS NOT  */ 06663000
*                                      /* REQUESTED.                 */ 06664000
*                                      /*                            */ 06665000
*                                      /******************************/ 06666000
*                                                                  1609 06667000
*                                      DATESW = ON;        /*@Y30SSMK*/ 06668000
*                                                                  1609 06669000
         B     @RC01601                                            1609 06670000
@RF01601 OI    DATESW,B'10000000'                                  1609 06671000
*                                  IF NUSESW = ON  &  DATESW = ON  1610 06672000
*                                    THEN                          1610 06673000
*                                                                  1610 06674000
@RC01601 TM    NUSESW,B'10000000'                                  1610 06675000
         BNO   @RF01610                                            1610 06676000
         TM    DATESW,B'10000000'                                  1610 06677000
         BNO   @RF01610                                            1610 06678000
*                                      /******************************/ 06679000
*                                      /*                    @Y30SSMK*/ 06680000
*                                      /* IF BOTH THE NOTUSABLE AND  */ 06681000
*                                      /* CREATION/EXPIRATION TEST   */ 06682000
*                                      /* HAVE BEEN SUCCESSFUL, CALL */ 06683000
*                                      /* THE OUTPUT FORMATTING      */ 06684000
*                                      /* ROUTINE FOR THE ASSOCIATED */ 06685000
*                                      /* DATA, INDEX, PATH, OR      */ 06686000
*                                      /* NVSAM PASSING THE TYPE OF  */ 06687000
*                                      /* ASSOCIATED ENTRY.  @Y30SSMK*/ 06688000
*                                      /*                    @Y30SSMK*/ 06689000
*                                      /******************************/ 06690000
*                                                                  1611 06691000
*                                      DO;                 /*@Y30SSMK*/ 06692000
*                                      IF HOLDETYP = CTGTDATA  |   1612 06693000
*                                        HOLDETYP = CTGTINDX  |    1612 06694000
*                                        HOLDETYP = CTGTPTH        1612 06695000
*                                        THEN                      1612 06696000
         L     @04,COMVARPT(,COMPTR)                               1612 06697000
         CLI   HOLDETYP(@04),C'D'                                  1612 06698000
         BE    @RT01612                                            1612 06699000
         CLI   HOLDETYP(@04),C'I'                                  1612 06700000
         BE    @RT01612                                            1612 06701000
         CLI   HOLDETYP(@04),C'R'                                  1612 06702000
         BNE   @RF01612                                            1612 06703000
@RT01612 DS    0H                                                  1613 06704000
*                                          CALL CDIPROC;   /*@Y30SSMK*/ 06705000
         L     @15,@CV00875                                        1613 06706000
         BALR  @14,@15                                             1613 06707000
*                                        ELSE                      1614 06708000
*                                          IF HOLDETYP = CTGTALIN  1614 06709000
*                                            THEN                  1614 06710000
         B     @RC01612                                            1614 06711000
@RF01612 L     @04,COMVARPT(,COMPTR)                               1614 06712000
         CLI   HOLDETYP(@04),C'A'                                  1614 06713000
         BNE   @RF01614                                            1614 06714000
*                                              CALL AUPROC;        1615 06715000
         L     @15,@CV00874                                        1615 06716000
         BALR  @14,@15                                             1615 06717000
*                                      RESPECIFY RTNREG RSTD;      1616 06718000
@RF01614 DS    0H                                                  1616 06719000
@RC01612 DS    0H                                                  1617 06720000
*                                      TESTRC = RTNREG;            1617 06721000
         LR    TESTRC,RTNREG                                       1617 06722000
*                                      RESPECIFY RTNREG UNRSTD;/*  1618 06723000
*                                                            @Y30SSMK*/ 06724000
*                                                                  1618 06725000
*                                      /******************************/ 06726000
*                                      /*                    @Y30SSMK*/ 06727000
*                                      /* RETURN WHEN ANY NON-ZERO   */ 06728000
*                                      /* RETURN CODE IS ENCOUNTERED */ 06729000
*                                      /* WHILE PROCESSING THE       */ 06730000
*                                      /* ASSOCIATED ENTRIES.  USE   */ 06731000
*                                      /* THE RETURN CODE 'SAVRC'    */ 06732000
*                                      /* WHICH WAS SET IN THE       */ 06733000
*                                      /* FORMATTING ROUTINE.        */ 06734000
*                                      /*                    @Y30SSMK*/ 06735000
*                                      /******************************/ 06736000
*                                                                  1619 06737000
*                                      IF TESTRC ^= 0              1619 06738000
*                                        THEN                      1619 06739000
         LTR   TESTRC,TESTRC                                       1619 06740000
         BZ    @RF01619                                            1619 06741000
*                                          RETURN CODE (SAVRC);    1620 06742000
         L     @04,COMVARPT(,COMPTR)                               1620 06743000
         LH    @15,SAVRC(,@04)                                     1620 06744000
         L     @14,@SA00005                                        1620 06745000
         LM    @00,@12,@SA00005+8                                  1620 06746000
         BR    @14                                                 1620 06747000
*                                      END;                /*@Y30SSMK*/ 06748000
*                                  END;                    /*@Y30SSMK*/ 06749000
*                                ELSE                              1623 06750000
*                                                                  1623 06751000
*                                  /**********************************/ 06752000
*                                  /*                        @Y30SSMK*/ 06753000
*                                  /* FOR AN ENTRY THAT IS NOT       */ 06754000
*                                  /* DATE RESTRICTED, OR RESTRICTED */ 06755000
*                                  /* TO NOTUSABLE DATA SETS, CALL   */ 06756000
*                                  /* THE OUTPUT FORMATTING ROUTINE  */ 06757000
*                                  /* FOR THE ASSOCIATED ENTRY.      */ 06758000
*                                  /* IF AN UNKNOWN ENTRY TYPE       */ 06759000
*                                  /* IS ENCOUNTERED, ISSUE AN       */ 06760000
*                                  /* APPROPRIATE ERROR MESSAGE.     */ 06761000
*                                  /*                        @Y30SSMK*/ 06762000
*                                  /**********************************/ 06763000
*                                                                  1623 06764000
*                                  DO;                     /*@Y30SSMK*/ 06765000
         B     @RC01585                                            1623 06766000
@RF01585 DS    0H                                                  1624 06767000
*                                  IF HOLDETYP = CTGTCL            1624 06768000
*                                    | HOLDETYP = CTGTDATA         1624 06769000
*                                    | HOLDETYP=CTGTINDX           1624 06770000
*                                    | HOLDETYP=CTGTPGSP           1624 06771000
*                                    | HOLDETYP = CTGTPTH          1624 06772000
*                                    THEN                          1624 06773000
         L     @04,COMVARPT(,COMPTR)                               1624 06774000
         CLI   HOLDETYP(@04),C'C'                                  1624 06775000
         BE    @RT01624                                            1624 06776000
         CLI   HOLDETYP(@04),C'D'                                  1624 06777000
         BE    @RT01624                                            1624 06778000
         CLI   HOLDETYP(@04),C'I'                                  1624 06779000
         BE    @RT01624                                            1624 06780000
         CLI   HOLDETYP(@04),C'P'                                  1624 06781000
         BE    @RT01624                                            1624 06782000
         CLI   HOLDETYP(@04),C'R'                                  1624 06783000
         BNE   @RF01624                                            1624 06784000
@RT01624 DS    0H                                                  1625 06785000
*                                      CALL CDIPROC;       /*@YL026UE*/ 06786000
         L     @15,@CV00875                                        1625 06787000
         BALR  @14,@15                                             1625 06788000
*                                    ELSE                          1626 06789000
*                                      IF HOLDETYP=CTGTALIN        1626 06790000
*                                        | HOLDETYP=CTGTUCAT       1626 06791000
*                                        | HOLDETYP=CTGTANM        1626 06792000
*                                        | HOLDETYP=CTGTGBS        1626 06793000
*                                        THEN                      1626 06794000
         B     @RC01624                                            1626 06795000
@RF01624 L     @04,COMVARPT(,COMPTR)                               1626 06796000
         CLI   HOLDETYP(@04),C'A'                                  1626 06797000
         BE    @RT01626                                            1626 06798000
         CLI   HOLDETYP(@04),C'U'                                  1626 06799000
         BE    @RT01626                                            1626 06800000
         CLI   HOLDETYP(@04),C'X'                                  1626 06801000
         BE    @RT01626                                            1626 06802000
         CLI   HOLDETYP(@04),C'B'                                  1626 06803000
         BNE   @RF01626                                            1626 06804000
@RT01626 DS    0H                                                  1627 06805000
*                                          CALL AUPROC;    /*@YL026UE*/ 06806000
         L     @15,@CV00874                                        1627 06807000
         BALR  @14,@15                                             1627 06808000
*                                        ELSE                      1628 06809000
*                                          DO;             /*@YL026UE*/ 06810000
         B     @RC01626                                            1628 06811000
@RF01626 DS    0H                                                  1629 06812000
*                                          ERRARGPT->DARGSMOD=LC1ID;    06813000
         L     @04,COMSWKPT(,COMPTR)                               1629 06814000
         L     @04,ERRARGPT(,@04)                                  1629 06815000
         MVC   DARGSMOD(3,@04),@CC01155                            1629 06816000
*                                          ERRARGPT->DARGSENT=LCMSG05;  06817000
         MVI   DARGSENT(@04),X'05'                                 1630 06818000
*                                          ERRARGPT->DARGDBP=      1631 06819000
*                                            ETYPFPT->CTGFLPT(1);  1631 06820000
         L     @02,COMFPLPT(,COMPTR)                               1631 06821000
         L     @02,ETYPFPT(,@02)                                   1631 06822000
         L     @15,CTGFLPT(,@02)                                   1631 06823000
         ST    @15,DARGDBP(,@04)                                   1631 06824000
*                                          ERRARGPT->DARGILP=      1632 06825000
*                                            ETYPFPT->CTGFLNG(1);  1632 06826000
         L     @02,CTGFLNG(,@02)                                   1632 06827000
         STH   @02,DARGILP(,@04)                                   1632 06828000
*                                          CALL ERRPROC;   /*@YL026UE*/ 06829000
         L     @15,@CV00872                                        1633 06830000
         BALR  @14,@15                                             1633 06831000
*                                          ERRARGPT->DARGSMOD=LC1ID;    06832000
         L     @04,COMSWKPT(,COMPTR)                               1634 06833000
         L     @04,ERRARGPT(,@04)                                  1634 06834000
         MVC   DARGSMOD(3,@04),@CC01155                            1634 06835000
*                                          ERRARGPT->DARGSENT=LCMSG08;  06836000
         MVI   DARGSENT(@04),X'08'                                 1635 06837000
*                                          ERRARGPT->DARGDBP=      1636 06838000
*                                            ENT44FPT->CTGFLPT(1); 1636 06839000
         L     @02,COMFPLPT(,COMPTR)                               1636 06840000
         L     @02,ENT44FPT(,@02)                                  1636 06841000
         L     @15,CTGFLPT(,@02)                                   1636 06842000
         ST    @15,DARGDBP(,@04)                                   1636 06843000
*                                          ERRARGPT->DARGILP=      1637 06844000
*                                            ENT44FPT->CTGFLNG(1); 1637 06845000
         L     @02,CTGFLNG(,@02)                                   1637 06846000
         STH   @02,DARGILP(,@04)                                   1637 06847000
*                                          IF SAVRC < LASTCC04     1638 06848000
*                                            THEN                  1638 06849000
         LA    @04,4                                               1638 06850000
         L     @02,COMVARPT(,COMPTR)                               1638 06851000
         CH    @04,SAVRC(,@02)                                     1638 06852000
         BNH   @RF01638                                            1638 06853000
*                                              SAVRC = LASTCC04;   1639 06854000
         STH   @04,SAVRC(,@02)                                     1639 06855000
*                                          END;            /*@YL026UE*/ 06856000
@RF01638 DS    0H                                                  1641 06857000
*                                  RESPECIFY RTNREG RSTD;          1641 06858000
@RC01626 DS    0H                                                  1641 06859000
@RC01624 DS    0H                                                  1642 06860000
*                                  TESTRC = RTNREG;                1642 06861000
         LR    TESTRC,RTNREG                                       1642 06862000
*                                  RESPECIFY RTNREG UNRSTD;        1643 06863000
*                                  IF TESTRC ^= 0                  1644 06864000
*                                    THEN                          1644 06865000
         LTR   TESTRC,TESTRC                                       1644 06866000
         BZ    @RF01644                                            1644 06867000
*                                      RETURN CODE (SAVRC);/*@ZA05939*/ 06868000
         L     @04,COMVARPT(,COMPTR)                               1645 06869000
         LH    @15,SAVRC(,@04)                                     1645 06870000
         L     @14,@SA00005                                        1645 06871000
         LM    @00,@12,@SA00005+8                                  1645 06872000
         BR    @14                                                 1645 06873000
*                                  END;                    /*@Y30LSMK*/ 06874000
*                                                                  1646 06875000
@RF01644 DS    0H                                                  1647 06876000
*                              /**************************************/ 06877000
*                              /*                                    */ 06878000
*                              /* RESTORE STRING OF FPL'S FOR NEXT   */ 06879000
*                              /* CATALOG REQUEST.                   */ 06880000
*                              /*                                    */ 06881000
*                              /**************************************/ 06882000
*                                                                  1647 06883000
*                              CALL FPLPROC;                       1647 06884000
@RC01585 L     @15,@CV00873                                        1647 06885000
         BALR  @14,@15                                             1647 06886000
*                              END GOODCRC;                        1648 06887000
*                          END YESASSOC;                           1649 06888000
@RC01535 DS    0H                                                  1650 06889000
*                      END GOODCI#;                                1650 06890000
@RF01527 DS    0H                                                  1651 06891000
*                END CKASSOC;                                      1651 06892000
@RF01515 AL    CI#IDX,@CF00045                                     1651 06893000
@DE01514 CR    CI#IDX,ASSOCNO                                      1651 06894000
         BNH   @DL01514                                            1651 06895000
*                /****************************************************/ 06896000
*                /*                                                  */ 06897000
*                /* ASSOCIATED ENTRY PROCESSING IS COMPLETED.        */ 06898000
*                /* RESTORE THE TYPE SPECIFICATION CODE TO THE CPL   */ 06899000
*                /* FOR THE NEXT ENTRY LIST REQUEST.  CLEAR THE      */ 06900000
*                /* INDICATOR FOR A RESTRICTED ENTRY.        @Y30SSMK*/ 06901000
*                /*                                                  */ 06902000
*                /****************************************************/ 06903000
*                                                                  1652 06904000
*                CTGTYPE = SAVTYPE;                                1652 06905000
         L     @04,COMSWKPT(,COMPTR)                               1652 06906000
         L     @04,CTGPLPTR(,@04)                                  1652 06907000
         MVC   CTGTYPE(1,@04),SAVTYPE                              1652 06908000
*                CLENTSW = OFF;                                    1653 06909000
         L     @04,@PC00005                                        1653 06910000
         NI    CLENTSW(@04),B'01111111'                            1653 06911000
*                END LSTASSOC;                                     1654 06912000
*            END CLUSTGRP;                                         1655 06913000
*          /**********************************************************/ 06914000
*          /*                                                        */ 06915000
*          /* FOR THE RETRIEVED ENTRY THAT IS NOT A  CLUSTER, AIX,   */ 06916000
*          /* PGSPC OR GDG, CALL THE APPROPRIATE OUTPUT      @Y30SSMK*/ 06917000
*          /* FORMATTING ROUTINE.                            @Y30SSMK*/ 06918000
*          /*                                                        */ 06919000
*          /**********************************************************/ 06920000
*                                                                  1656 06921000
*          ELSE                                                    1656 06922000
*NONCTYPE:   DO;                                                   1656 06923000
         B     @RC01455                                            1656 06924000
@RF01455 DS    0H                                                  1656 06925000
NONCTYPE DS    0H                                                  1657 06926000
*              VOLSW = OFF;                                /*@Y30LSMK*/ 06927000
         NI    VOLSW,B'01111111'                                   1657 06928000
*              NDENTFLG = OFF;         /*DON'T INDENT NVSAM  @YL026UE*/ 06929000
         L     @04,COMFLGPT(,COMPTR)                               1658 06930000
         NI    NDENTFLG(@04),B'01111111'                           1658 06931000
*              IF HOLDETYP = CTGTDATA  |  HOLDETYP = CTGTINDX  |   1659 06932000
*                HOLDETYP = CTGTPTH                                1659 06933000
*                THEN                                              1659 06934000
         L     @04,COMVARPT(,COMPTR)                               1659 06935000
         CLI   HOLDETYP(@04),C'D'                                  1659 06936000
         BE    @RT01659                                            1659 06937000
         CLI   HOLDETYP(@04),C'I'                                  1659 06938000
         BE    @RT01659                                            1659 06939000
         CLI   HOLDETYP(@04),C'R'                                  1659 06940000
         BNE   @RF01659                                            1659 06941000
@RT01659 DS    0H                                                  1660 06942000
*                  CALL CDIPROC;                                   1660 06943000
         L     @15,@CV00875                                        1660 06944000
         BALR  @14,@15                                             1660 06945000
*                ELSE                                              1661 06946000
*                  DO;                                     /*@YL026UE*/ 06947000
*                                                                  1661 06948000
         B     @RC01659                                            1661 06949000
@RF01659 DS    0H                                                  1662 06950000
*                  /**************************************************/ 06951000
*                  /*                                        @YL026UE*/ 06952000
*                  /* IF IN GETNEXT MODE AND THE ENTRY IS GDG NVSAM  */ 06953000
*                  /* AND GDG TYPE IS SPECIFIED OR NO TYPE IS        */ 06954000
*                  /* SPECIFIED, THEN DO NOT PROCESS AS A SEPERATE   */ 06955000
*                  /* ENTRY.                                 @YL026UE*/ 06956000
*                  /*                                        @YL026UE*/ 06957000
*                  /**************************************************/ 06958000
*                                                                  1662 06959000
*                  IF HOLDETYP = CTGTALIN                          1662 06960000
*                    THEN                                          1662 06961000
         L     @04,COMVARPT(,COMPTR)                               1662 06962000
         CLI   HOLDETYP(@04),C'A'                                  1662 06963000
         BNE   @RF01662                                            1662 06964000
*                      IF LISTCFLG=ON                              1663 06965000
*                         & ASSOCFPT->CTGFLPT(1)->KIND(1)=CTGTGBS  1663 06966000
*                        THEN                                      1663 06967000
         L     @04,COMFLGPT(,COMPTR)                               1663 06968000
         TM    LISTCFLG(@04),B'10000000'                           1663 06969000
         BNO   @RF01663                                            1663 06970000
         L     @04,COMFPLPT(,COMPTR)                               1663 06971000
         L     @04,ASSOCFPT(,@04)                                  1663 06972000
         L     @04,CTGFLPT(,@04)                                   1663 06973000
         CLI   KIND(@04),C'B'                                      1663 06974000
         BNE   @RF01663                                            1663 06975000
*                          RETURN CODE(0);                 /*@YL026UE*/ 06976000
         SLR   @15,@15                                             1664 06977000
         L     @14,@SA00005                                        1664 06978000
         LM    @00,@12,@SA00005+8                                  1664 06979000
         BR    @14                                                 1664 06980000
*                  IF HOLDETYP = CTGTANM  |  HOLDETYP = CTGTUCAT   1665 06981000
*                       | HOLDETYP = CTGTALIN                      1665 06982000
*                    THEN                                          1665 06983000
@RF01663 DS    0H                                                  1665 06984000
@RF01662 L     @04,COMVARPT(,COMPTR)                               1665 06985000
         CLI   HOLDETYP(@04),C'X'                                  1665 06986000
         BE    @RT01665                                            1665 06987000
         CLI   HOLDETYP(@04),C'U'                                  1665 06988000
         BE    @RT01665                                            1665 06989000
         CLI   HOLDETYP(@04),C'A'                                  1665 06990000
         BNE   @RF01665                                            1665 06991000
@RT01665 DS    0H                                                  1666 06992000
*                      CALL AUPROC;                                1666 06993000
         L     @15,@CV00874                                        1666 06994000
         BALR  @14,@15                                             1666 06995000
*                    ELSE                                          1667 06996000
*                      IF HOLDETYP = CTGTVOL                       1667 06997000
*                        THEN                                      1667 06998000
         B     @RC01665                                            1667 06999000
@RF01665 L     @04,COMVARPT(,COMPTR)                               1667 07000000
         CLI   HOLDETYP(@04),C'V'                                  1667 07001000
         BNE   @RF01667                                            1667 07002000
*                          VOLSW = ON;                     /*@Y30LSMK*/ 07003000
*                                                                  1668 07004000
         OI    VOLSW,B'10000000'                                   1668 07005000
*                        /********************************************/ 07006000
*                        /*                                          */ 07007000
*                        /* ERROR - UNKNOWN ENTRY TYPE.              */ 07008000
*                        /* SETUP APPROPRIATE DIAGNOSTICS.           */ 07009000
*                        /* EXIT FROM ENTRY ROUTING ROUTINE,         */ 07010000
*                        /* RETURNING TO CALLER.                     */ 07011000
*                        /*                                          */ 07012000
*                        /********************************************/ 07013000
*                                                                  1669 07014000
*                        ELSE                                      1669 07015000
*                          DO;                                     1669 07016000
         B     @RC01667                                            1669 07017000
@RF01667 DS    0H                                                  1670 07018000
*                            ERRARGPT->DARGSMOD = LC1ID;           1670 07019000
         L     @04,COMSWKPT(,COMPTR)                               1670 07020000
         L     @04,ERRARGPT(,@04)                                  1670 07021000
         MVC   DARGSMOD(3,@04),@CC01155                            1670 07022000
*                            ERRARGPT->DARGSENT = LCMSG05;         1671 07023000
         MVI   DARGSENT(@04),X'05'                                 1671 07024000
*                            ERRARGPT->DARGDBP = ETYPFPT->CTGFLPT(1);   07025000
         L     @02,COMFPLPT(,COMPTR)                               1672 07026000
         L     @02,ETYPFPT(,@02)                                   1672 07027000
         L     @15,CTGFLPT(,@02)                                   1672 07028000
         ST    @15,DARGDBP(,@04)                                   1672 07029000
*                            ERRARGPT->DARGILP = ETYPFPT->CTGFLNG(1);   07030000
         L     @02,CTGFLNG(,@02)                                   1673 07031000
         STH   @02,DARGILP(,@04)                                   1673 07032000
*                            CALL ERRPROC;                         1674 07033000
         L     @15,@CV00872                                        1674 07034000
         BALR  @14,@15                                             1674 07035000
*                            ERRARGPT->DARGSMOD = LC1ID;           1675 07036000
         L     @04,COMSWKPT(,COMPTR)                               1675 07037000
         L     @04,ERRARGPT(,@04)                                  1675 07038000
         MVC   DARGSMOD(3,@04),@CC01155                            1675 07039000
*                            ERRARGPT->DARGSENT = LCMSG08;         1676 07040000
         MVI   DARGSENT(@04),X'08'                                 1676 07041000
*                            ERRARGPT->DARGDBP = ENT44FPT->CTGFLPT(1);  07042000
         L     @02,COMFPLPT(,COMPTR)                               1677 07043000
         L     @02,ENT44FPT(,@02)                                  1677 07044000
         L     @15,CTGFLPT(,@02)                                   1677 07045000
         ST    @15,DARGDBP(,@04)                                   1677 07046000
*                            ERRARGPT->DARGILP = ENT44FPT->CTGFLNG(1);  07047000
         L     @02,CTGFLNG(,@02)                                   1678 07048000
         STH   @02,DARGILP(,@04)                                   1678 07049000
*                            IF SAVRC < LASTCC04                   1679 07050000
*                              THEN                                1679 07051000
         LA    @04,4                                               1679 07052000
         L     @02,COMVARPT(,COMPTR)                               1679 07053000
         CH    @04,SAVRC(,@02)                                     1679 07054000
         BNH   @RF01679                                            1679 07055000
*                                SAVRC = LASTCC04;         /*@ZA05939*/ 07056000
         STH   @04,SAVRC(,@02)                                     1680 07057000
*                            RETURN CODE (LASTCC04);               1681 07058000
@RF01679 LA    @15,4                                               1681 07059000
         L     @14,@SA00005                                        1681 07060000
         LM    @00,@12,@SA00005+8                                  1681 07061000
         BR    @14                                                 1681 07062000
*                          END;                                    1682 07063000
*                  END;                                    /*@YL026UE*/ 07064000
@RC01667 DS    0H                                                  1683 07065000
@RC01665 DS    0H                                                  1684 07066000
*              /******************************************************/ 07067000
*              /*                                            @Y30LSMK*/ 07068000
*              /* FOR A VOLUME ENTRY THAT IS DATE RESTRICTED @Y30LSMK*/ 07069000
*              /* INVOKE TIMEPROC TO CONVERT THE VOLUME TIME @Y30LSMK*/ 07070000
*              /* STAMP TO A PACKED DECIMAL NUMBER TO TEST   @Y30LSMK*/ 07071000
*              /* AGAINST THE LISTC CONVERTED CREAT VALUE.   @Y30LSMK*/ 07072000
*              /*                                            @Y30LSMK*/ 07073000
*              /******************************************************/ 07074000
*                                                                  1684 07075000
*              IF VOLSW = ON                                       1684 07076000
*                THEN                                              1684 07077000
@RC01659 TM    VOLSW,B'10000000'                                   1684 07078000
         BNO   @RF01684                                            1684 07079000
*                  IF ADDR(CREAT) > NULLPTR                        1685 07080000
*                    THEN                                          1685 07081000
*                                                                  1685 07082000
         L     @04,@PC00001+4                                      1685 07083000
         L     @04,FDTPTR+96(,@04)                                 1685 07084000
         LTR   @04,@04                                             1685 07085000
         BNP   @RF01685                                            1685 07086000
*                      /**********************************************/ 07087000
*                      /*                                    @Y30LSMK*/ 07088000
*                      /* POSITION FPL POINTER TO THE VOLUME @Y30LSMK*/ 07089000
*                      /* TIME STAMP FPL.                    @Y30LSMK*/ 07090000
*                      /*                                    @Y30LSMK*/ 07091000
*                      /**********************************************/ 07092000
*                                                                  1686 07093000
*VOLTIMSP:             DO;                                 /*@Y30LSMK*/ 07094000
VOLTIMSP DS    0H                                                  1687 07095000
*                        IF ADDR(FALL) = NULLPTR                   1687 07096000
*                          THEN                                    1687 07097000
         L     @04,@PC00001+4                                      1687 07098000
         L     @04,FDTPTR+56(,@04)                                 1687 07099000
         LTR   @04,@04                                             1687 07100000
         BNZ   @RF01687                                            1687 07101000
*                            CTGFLPTR = FPLPTMAP(FPLVTM);  /*@Y30LSMK*/ 07102000
         L     @04,COMSWKPT(,COMPTR)                               1688 07103000
         LH    @02,FPLVTM                                          1688 07104000
         SLA   @02,2                                               1688 07105000
         L     @01,COMFPLPT(,COMPTR)                               1688 07106000
         AL    @01,@CF01593                                        1688 07107000
         L     @02,FPLPTMAP(@02,@01)                               1688 07108000
         ST    @02,CTGFLPTR(,@04)                                  1688 07109000
*                          ELSE                                    1689 07110000
*                            CTGFLPTR = VTIMEFPT;          /*@Y30LSMK*/ 07111000
         B     @RC01687                                            1689 07112000
@RF01687 L     @04,COMSWKPT(,COMPTR)                               1689 07113000
         L     @02,COMFPLPT(,COMPTR)                               1689 07114000
         L     @02,VTIMEFPT(,@02)                                  1689 07115000
         ST    @02,CTGFLPTR(,@04)                                  1689 07116000
*                        TIMEODAY = VTIME;                 /*@Y30LSMK*/ 07117000
@RC01687 L     @04,COMSWKPT(,COMPTR)                               1690 07118000
         L     @04,CTGFLPTR(,@04)                                  1690 07119000
         L     @04,CTGFLPT(,@04)                                   1690 07120000
         MVC   TIMEODAY(8),VTIME(@04)                              1690 07121000
*                        CALL TIMEPROC;                    /*@Y30LSMK*/ 07122000
         BAL   @14,TIMEPROC                                        1691 07123000
*                        IF TIMEPACK <= MICTIME            /*@Y30LSMK*/ 07124000
*                          THEN                                    1692 07125000
         CLC   TIMEPACK(16),MICTIME                                1692 07126000
         BH    @RF01692                                            1692 07127000
*                            CALL VPROC;                   /*@Y30LSMK*/ 07128000
         L     @15,@CV00876                                        1693 07129000
         BALR  @14,@15                                             1693 07130000
*                          ELSE                                    1694 07131000
*                                                                  1694 07132000
*                            /****************************************/ 07133000
*                            /*                              @Y30LSMK*/ 07134000
*                            /* IF THE VOLUME TIME STAMP IS NOT      */ 07135000
*                            /* EARLIER THAN THE CONVERTED CREAT     */ 07136000
*                            /* VALUE, POSITION FPL POINTER  @Y30LSMK*/ 07137000
*                            /* TO THE DATA SPACE CHARACTERISTICS FPL*/ 07138000
*                            /* TO TEST THE DSCB VOLUME TIME STAMP.  */ 07139000
*                            /*                              @Y30LSMK*/ 07140000
*                            /****************************************/ 07141000
*                                                                  1694 07142000
*                            DO;                           /*@Y30LSMK*/ 07143000
         B     @RC01692                                            1694 07144000
@RF01692 DS    0H                                                  1695 07145000
*                            IF ADDR(FALL) = NULLPTR               1695 07146000
*                              THEN                                1695 07147000
         L     @04,@PC00001+4                                      1695 07148000
         L     @04,FDTPTR+56(,@04)                                 1695 07149000
         LTR   @04,@04                                             1695 07150000
         BNZ   @RF01695                                            1695 07151000
*                                CTGFLPTR = FPLPTMAP(FPLSPH);      1696 07152000
         L     @04,COMSWKPT(,COMPTR)                               1696 07153000
         LH    @02,FPLSPH                                          1696 07154000
         SLA   @02,2                                               1696 07155000
         L     @01,COMFPLPT(,COMPTR)                               1696 07156000
         AL    @01,@CF01593                                        1696 07157000
         L     @02,FPLPTMAP(@02,@01)                               1696 07158000
         ST    @02,CTGFLPTR(,@04)                                  1696 07159000
*                              ELSE                                1697 07160000
*                                CTGFLPTR = VHDRFPT;       /*@Y30LSMK*/ 07161000
         B     @RC01695                                            1697 07162000
@RF01695 L     @04,COMSWKPT(,COMPTR)                               1697 07163000
         L     @02,COMFPLPT(,COMPTR)                               1697 07164000
         L     @02,VHDRFPT(,@02)                                   1697 07165000
         ST    @02,CTGFLPTR(,@04)                                  1697 07166000
*                            IF CTGFLNG(1) > 0 & CTGFLPT(1) > NULLPTR   07167000
*                              THEN                                1698 07168000
@RC01695 SLR   @04,@04                                             1698 07169000
         L     @02,COMSWKPT(,COMPTR)                               1698 07170000
         L     @02,CTGFLPTR(,@02)                                  1698 07171000
         C     @04,CTGFLNG(,@02)                                   1698 07172000
         BNL   @RF01698                                            1698 07173000
         C     @04,CTGFLPT(,@02)                                   1698 07174000
         BNL   @RF01698                                            1698 07175000
*DSBTIMSP:                       DO;                       /*@Y30LSMK*/ 07176000
DSBTIMSP DS    0H                                                  1700 07177000
*                                TIMLESSW = OFF;           /*@Y30LSMK*/ 07178000
         NI    TIMLESSW,B'01111111'                                1700 07179000
*                                VHDRPTR = CTGFLPT(1);     /*@Y30LSMK*/ 07180000
         L     @04,COMSWKPT(,COMPTR)                               1701 07181000
         L     @15,CTGFLPTR(,@04)                                  1701 07182000
         L     @14,CTGFLPT(,@15)                                   1701 07183000
         ST    @14,VHDRPTR(,@04)                                   1701 07184000
*                                VHDRLN = CTGFLNG(1);      /*@Y30LSMK*/ 07185000
*                                                                  1702 07186000
         L     VHDRLN,CTGFLNG(,@15)                                1702 07187000
*                                /************************************/ 07188000
*                                /*                          @Y30LSMK*/ 07189000
*                                /* CYCLE THROUGH THE DATA SPACE     */ 07190000
*                                /* HEADER FIELDS PICKING UP THE     */ 07191000
*                                /* VOLUME TIME STAMP. CONVERT IT    */ 07192000
*                                /* TO A PACKED DECIMAL NUMBER AND   */ 07193000
*                                /* TEST IT AGAINST THE LISTC        */ 07194000
*                                /* CONVERTED CREAT VALUE.   @Y30LSMK*/ 07195000
*                                /*                          @Y30LSMK*/ 07196000
*                                /************************************/ 07197000
*                                                                  1703 07198000
*                                DO WHILE(VHDRLN >= LENGTH(VDSPHDR) &   07199000
*                                  TIMLESSW = OFF);        /*@Y30LSMK*/ 07200000
         B     @DE01703                                            1703 07201000
@DL01703 DS    0H                                                  1704 07202000
*                                  TIMEODAY = VDSCBTIM;    /*@Y30LSMK*/ 07203000
         L     @04,COMSWKPT(,COMPTR)                               1704 07204000
         L     @04,VHDRPTR(,@04)                                   1704 07205000
         MVC   TIMEODAY(8),VDSCBTIM(@04)                           1704 07206000
*                                  CALL TIMEPROC;          /*@Y30LSMK*/ 07207000
         BAL   @14,TIMEPROC                                        1705 07208000
*                                  IF TIMEPACK <= MICTIME          1706 07209000
*                                    THEN                          1706 07210000
         CLC   TIMEPACK(16),MICTIME                                1706 07211000
         BH    @RF01706                                            1706 07212000
*                                      TIMLESSW = ON;      /*@Y30LSMK*/ 07213000
         OI    TIMLESSW,B'10000000'                                1707 07214000
*                                    ELSE                          1708 07215000
*                                      DO;                 /*@Y30LSMK*/ 07216000
         B     @RC01706                                            1708 07217000
@RF01706 DS    0H                                                  1709 07218000
*                                      VHDRLN = VHDRLN -           1709 07219000
*                                        LENGTH(VDSPHDR);  /*@Y30LSMK*/ 07220000
         LA    @04,23                                              1709 07221000
         SLR   VHDRLN,@04                                          1709 07222000
*                                      VHDRPTR = VHDRPTR +         1710 07223000
*                                        LENGTH(VDSPHDR);  /*@Y30LSMK*/ 07224000
         L     @15,COMSWKPT(,COMPTR)                               1710 07225000
         AL    @04,VHDRPTR(,@15)                                   1710 07226000
         ST    @04,VHDRPTR(,@15)                                   1710 07227000
*                                      END;                /*@Y30LSMK*/ 07228000
*                                END;                      /*@Y30LSMK*/ 07229000
*                                                                  1712 07230000
@RC01706 DS    0H                                                  1712 07231000
@DE01703 C     VHDRLN,@CF00657                                     1712 07232000
         BL    @DC01703                                            1712 07233000
         TM    TIMLESSW,B'10000000'                                1712 07234000
         BZ    @DL01703                                            1712 07235000
@DC01703 DS    0H                                                  1713 07236000
*                                IF TIMLESSW = ON                  1713 07237000
*                                  THEN                            1713 07238000
         TM    TIMLESSW,B'10000000'                                1713 07239000
         BNO   @RF01713                                            1713 07240000
*                                    CALL VPROC;           /*@Y30LSMK*/ 07241000
         L     @15,@CV00876                                        1714 07242000
         BALR  @14,@15                                             1714 07243000
*                                END DSBTIMSP;             /*@Y30LSMK*/ 07244000
*                            END;                          /*@Y30LSMK*/ 07245000
*                      END VOLTIMSP;                       /*@Y30LSMK*/ 07246000
*                    ELSE                                          1718 07247000
*                      CALL VPROC;                         /*@Y30LSMK*/ 07248000
*                                                                  1718 07249000
         B     @RC01685                                            1718 07250000
@RF01685 L     @15,@CV00876                                        1718 07251000
         BALR  @14,@15                                             1718 07252000
*              /******************************************************/ 07253000
*              /*                                                    */ 07254000
*              /* IF LISTING THE ENTRY WAS UNSUCCESSFUL, EXIT FROM   */ 07255000
*              /* THIS PROCEDURE USING THE RETURN CODE 'SAVRC'       */ 07256000
*              /* WHICH IS ALREADY SET TO THE HIGHEST RETURN @Y30SSMK*/ 07257000
*              /* CODE ENCOUNTERED IN THE FORMATTING ROUTINES.       */ 07258000
*              /*                                                    */ 07259000
*              /******************************************************/ 07260000
*                                                                  1719 07261000
*              RESPECIFY RTNREG RSTD;                              1719 07262000
@RC01685 DS    0H                                                  1719 07263000
@RF01684 DS    0H                                                  1720 07264000
*              TESTRC = RTNREG;                                    1720 07265000
         LR    TESTRC,RTNREG                                       1720 07266000
*              RESPECIFY RTNREG UNRSTD;                            1721 07267000
*              IF TESTRC ^= 0                                      1722 07268000
*                THEN                                              1722 07269000
         LTR   TESTRC,TESTRC                                       1722 07270000
         BZ    @RF01722                                            1722 07271000
*                  RETURN CODE (SAVRC);                    /*@ZA05939*/ 07272000
         L     @04,COMVARPT(,COMPTR)                               1723 07273000
         LH    @15,SAVRC(,@04)                                     1723 07274000
         L     @14,@SA00005                                        1723 07275000
         LM    @00,@12,@SA00005+8                                  1723 07276000
         BR    @14                                                 1723 07277000
*            END NONCTYPE;                                         1724 07278000
@RF01722 DS    0H                                                  1725 07279000
*        /************************************************************/ 07280000
*        /*                                                          */ 07281000
*        /* EXIT FROM ENTRY ROUTING ROUTINE, RETURNING TO CALLER.    */ 07282000
*        /*                                                          */ 07283000
*        /************************************************************/ 07284000
*                                                                  1725 07285000
*        RETURN CODE(0);                                           1725 07286000
@RC01455 SLR   @15,@15                                             1725 07287000
         L     @14,@SA00005                                        1725 07288000
         LM    @00,@12,@SA00005+8                                  1725 07289000
         BR    @14                                                 1725 07290000
*        END RTEPROC;                                              1726 07291000
*        /************************************************************/ 07292000
*        /*                                                  @Y30LSMK*/ 07293000
*        /* PROCEDURE - DATEPROC                             @Y30LSMK*/ 07294000
*        /*                                                  @Y30LSMK*/ 07295000
*        /* FUNCTION - CALCULATES THE CREATION AND           @Y30LSMK*/ 07296000
*        /* EXPIRATION LISTC OPTIONS TO BE USED IN TESTING   @Y30LSMK*/ 07297000
*        /* OF THE CATALOG CREATION AND EXPIRATION DATE      @Y30LSMK*/ 07298000
*        /* FIELDS.                                          @Y30LSMK*/ 07299000
*        /*                                                  @Y30LSMK*/ 07300000
*        /* INPUT - THE DATA AREA CONTAINING THE CURRENT DATE@Y30LSMK*/ 07301000
*        /* OBTAINED FROM A UTIME MACRO.                     @Y30LSMK*/ 07302000
*        /*                                                  @Y30LSMK*/ 07303000
*        /* OUTPUT - INITIALIZED CREATION AND EXPIRATION     @Y30LSMK*/ 07304000
*        /* DATE DATA AREAS.                                 @Y30LSMK*/ 07305000
*        /*                                                  @Y30LSMK*/ 07306000
*        /************************************************************/ 07307000
*                                                                  1727 07308000
*DATEPROC: PROCEDURE;                                      /*@Y30LSMK*/ 07309000
*                                                                  1727 07310000
DATEPROC STM   @14,@12,12(@13)                                     1727 07311000
*        /************************************************************/ 07312000
*        /*                                                  @Y30LSMK*/ 07313000
*        /* LOCAL VARIABLES                                  @Y30LSMK*/ 07314000
*        /*                                                  @Y30LSMK*/ 07315000
*        /************************************************************/ 07316000
*                                                                  1728 07317000
*        DCL NOWYEAR   FIXED(15);      /*CURRENT YEAR        @Y30LSMK*/ 07318000
*        DCL NOWDAY    FIXED(15);      /*CURRENT DAY         @Y30LSMK*/ 07319000
*        DCL YRTOTAL   FIXED(15);      /*CALCULATED YEAR     @Y30LSMK*/ 07320000
*        DCL DAYTOTAL  FIXED(15);      /*CALCULATED DAY      @Y30LSMK*/ 07321000
*        DCL NOLEAPYR  FIXED(15)       /*NO. OF DAYS PER YEAR        */ 07322000
*                      CONSTANT(365);                      /*@Y30LSMK*/ 07323000
*        DCL LEAPYEAR  FIXED(15)       /*NO. OF DAYS PER LEAP YEAR   */ 07324000
*                      CONSTANT(366);                      /*@Y30LSMK*/ 07325000
*        DCL DAYPERYR  FIXED(15);      /*NO. OF DAYS IN CURRENT YEAR */ 07326000
*        DCL YRLOOP    BIT(1)          /*YEAR LOOP INDICATOR @Y30LSMK*/ 07327000
*                      BDY(BYTE);                          /*@Y30LSMK*/ 07328000
*        DECLARE                       /*CURRENT YEAR CONVERSION AREA*/ 07329000
*          1 CNVTYEAR   BIT(16) BDY(BYTE),                         1736 07330000
*            2 CVTYEAR  BIT(8),                                    1736 07331000
*            2 CVTPACK BIT(8);                             /*@Y30LSMK*/ 07332000
*        DCL LPYRCNT   FIXED(15) CONSTANT(4);              /*@Y30SSMK*/ 07333000
*                                      /*LEAP YEAR OCCURENCE @Y30SSMK*/ 07334000
*                                                                  1738 07335000
*        /************************************************************/ 07336000
*        /*                                                  @Y30LSMK*/ 07337000
*        /* SINCE THE CURRENT YEAR AND DAY ARE RETURNED IN A @Y30LSMK*/ 07338000
*        /* PACKED DECIMAL FORMAT (YYDDDF), CONVERT VALUE    @Y30LSMK*/ 07339000
*        /* TO BINARY.                                       @Y30LSMK*/ 07340000
*        /* NOTE - WHEN CONVERTING THE YEAR TO BINARY, A     @Y30LSMK*/ 07341000
*        /* 'F0'X IS INSERTED IN THE VALUE TO SIMULATE       @Y30LSMK*/ 07342000
*        /* A PACKED DECIMAL FORMAT.                         @Y30LSMK*/ 07343000
*        /*                                                  @Y30LSMK*/ 07344000
*        /************************************************************/ 07345000
*                                                                  1738 07346000
*        OLDERID2 = NEWERID2;                                      1738 07347000
         L     @04,@PC00001                                        1738 07348000
         L     @04,GDTTR2(,@04)                                    1738 07349000
         MVC   @TS00001(95),NEWERID2(@04)                          1738 07350000
         MVC   OLDERID2(95,@04),@TS00001                           1738 07351000
*        NEWID2 = 'LCDT';                                  /*@Y30LSMK*/ 07352000
*                                                                  1739 07353000
         MVC   NEWID2(4,@04),@CC01531                              1739 07354000
*        CVB(NOWDAY,XUTDAY);                               /*@Y30LSMK*/ 07355000
         XC    @TS00001(8),@TS00001                                1740 07356000
         MVC   @TS00001+6(2),XUTDAY                                1740 07357000
         CVB   NOWDAY,@TS00001                                     1740 07358000
*        CVTYEAR = XUTYEAR;                                /*@Y30LSMK*/ 07359000
         MVC   CVTYEAR(1),XUTYEAR                                  1741 07360000
*        CVTPACK = 'F0'X;                                  /*@Y30LSMK*/ 07361000
         MVI   CVTPACK,X'F0'                                       1742 07362000
*        SRL(CNVTYEAR,SHIFTVAL);                           /*@Y30LSMK*/ 07363000
         SLR   @04,@04                                             1743 07364000
         ICM   @04,3,CNVTYEAR                                      1743 07365000
         SRL   @04,4                                               1743 07366000
         STCM  @04,3,CNVTYEAR                                      1743 07367000
*        CVB(NOWYEAR,CNVTYEAR);                            /*@Y30LSMK*/ 07368000
*                                                                  1744 07369000
         XC    @TS00001(8),@TS00001                                1744 07370000
         MVC   @TS00001+6(2),CNVTYEAR                              1744 07371000
         CVB   NOWYEAR,@TS00001                                    1744 07372000
*        IF ADDR(CREAT) > NULLPTR                                  1745 07373000
*          THEN                                                    1745 07374000
*                                                                  1745 07375000
         L     @04,@PC00001+4                                      1745 07376000
         L     @04,FDTPTR+96(,@04)                                 1745 07377000
         LTR   @04,@04                                             1745 07378000
         BNP   @RF01745                                            1745 07379000
*            /********************************************************/ 07380000
*            /*                                              @Y30LSMK*/ 07381000
*            /* TO CONVERT THE CREATION DATE, COMPUTE THE    @Y30LSMK*/ 07382000
*            /* TOTAL NUMBER OF DAYS FROM THE END OF THE     @Y30LSMK*/ 07383000
*            /* CURRENT YEAR.                                @Y30LSMK*/ 07384000
*            /* NOTE - A CHECK FOR LEAP YEAR IS MADE DURING  @Y30LSMK*/ 07385000
*            /* THIS CALCULATION.                            @Y30LSMK*/ 07386000
*            /*                                              @Y30LSMK*/ 07387000
*            /********************************************************/ 07388000
*                                                                  1746 07389000
*CRDTION:    DO;                                           /*@Y30LSMK*/ 07390000
CRDTION  DS    0H                                                  1747 07391000
*              YRLOOP = ON;                                /*@Y30LSMK*/ 07392000
         OI    YRLOOP,B'10000000'                                  1747 07393000
*              YRTOTAL = NOWYEAR;                          /*@Y30LSMK*/ 07394000
         LR    YRTOTAL,NOWYEAR                                     1748 07395000
*              IF (YRTOTAL // LPYRCNT) = 0                         1749 07396000
*                THEN                                              1749 07397000
         LR    @00,YRTOTAL                                         1749 07398000
         SRDA  @00,32                                              1749 07399000
         D     @00,@CF00050                                        1749 07400000
         LTR   @00,@00                                             1749 07401000
         BNZ   @RF01749                                            1749 07402000
*                  DAYTOTAL = (LEAPYEAR - NOWDAY) + CREATVAL;      1750 07403000
         LA    DAYTOTAL,366                                        1750 07404000
         SLR   DAYTOTAL,NOWDAY                                     1750 07405000
         L     @04,@PC00001+4                                      1750 07406000
         L     @04,FDTPTR+96(,@04)                                 1750 07407000
         AL    DAYTOTAL,CREATVAL(,@04)                             1750 07408000
*                ELSE                                              1751 07409000
*                  DAYTOTAL = (NOLEAPYR - NOWDAY) + CREATVAL;      1751 07410000
*                                                                  1751 07411000
         B     @RC01749                                            1751 07412000
@RF01749 LA    DAYTOTAL,365                                        1751 07413000
         SLR   DAYTOTAL,NOWDAY                                     1751 07414000
         L     @04,@PC00001+4                                      1751 07415000
         L     @04,FDTPTR+96(,@04)                                 1751 07416000
         AL    DAYTOTAL,CREATVAL(,@04)                             1751 07417000
*              /******************************************************/ 07418000
*              /*                                            @Y30LSMK*/ 07419000
*              /* WHEN THE NUMBER OF DAYS REQUESTED IS       @Y30LSMK*/ 07420000
*              /* GREATER THAN ONE YEAR, PROCEED TO LOOP     @Y30LSMK*/ 07421000
*              /* THROUGH THE YEARS DECREMENTING THE TOTAL   @Y30LSMK*/ 07422000
*              /* COUNT OF DAYS AND YEARS.                   @Y30LSMK*/ 07423000
*              /*                                            @Y30LSMK*/ 07424000
*              /******************************************************/ 07425000
*                                                                  1752 07426000
*CDTLOOP:      DO WHILE (YRLOOP = ON);                     /*@Y30LSMK*/ 07427000
@RC01749 DS    0H                                                  1752 07428000
CDTLOOP  B     @DE01752                                            1752 07429000
@DL01752 DS    0H                                                  1753 07430000
*                IF (YRTOTAL // LPYRCNT) = 0                       1753 07431000
*                  THEN                                            1753 07432000
         LR    @00,YRTOTAL                                         1753 07433000
         SRDA  @00,32                                              1753 07434000
         D     @00,@CF00050                                        1753 07435000
         LTR   @00,@00                                             1753 07436000
         BNZ   @RF01753                                            1753 07437000
*                    DAYPERYR = LEAPYEAR;                  /*@Y30LSMK*/ 07438000
         LA    DAYPERYR,366                                        1754 07439000
*                  ELSE                                            1755 07440000
*                    DAYPERYR = NOLEAPYR;                  /*@Y30LSMK*/ 07441000
         B     @RC01753                                            1755 07442000
@RF01753 LA    DAYPERYR,365                                        1755 07443000
*                IF DAYTOTAL >= DAYPERYR                           1756 07444000
*                  THEN                                            1756 07445000
@RC01753 CR    DAYTOTAL,DAYPERYR                                   1756 07446000
         BL    @RF01756                                            1756 07447000
*                    DO;                                   /*@Y30LSMK*/ 07448000
*                      DAYTOTAL = DAYTOTAL - DAYPERYR;     /*@Y30LSMK*/ 07449000
         SLR   DAYTOTAL,DAYPERYR                                   1758 07450000
*                      YRTOTAL = YRTOTAL - 1;              /*@Y30LSMK*/ 07451000
         BCTR  YRTOTAL,0                                           1759 07452000
*                    END;                                  /*@Y30LSMK*/ 07453000
*                  ELSE                                            1761 07454000
*                    DO;                                   /*@Y30LSMK*/ 07455000
         B     @RC01756                                            1761 07456000
@RF01756 DS    0H                                                  1762 07457000
*                      DAYTOTAL = DAYPERYR - DAYTOTAL;     /*@Y30LSMK*/ 07458000
         LR    @15,DAYPERYR                                        1762 07459000
         SLR   @15,DAYTOTAL                                        1762 07460000
         LR    DAYTOTAL,@15                                        1762 07461000
*                      YRLOOP = OFF;                       /*@Y30LSMK*/ 07462000
         NI    YRLOOP,B'01111111'                                  1763 07463000
*                    END;                                  /*@Y30LSMK*/ 07464000
*              END CDTLOOP;                                /*@Y30LSMK*/ 07465000
*                                                                  1765 07466000
@RC01756 DS    0H                                                  1765 07467000
@DE01752 TM    YRLOOP,B'10000000'                                  1765 07468000
         BO    @DL01752                                            1765 07469000
*              /******************************************************/ 07470000
*              /*                                            @Y30LSMK*/ 07471000
*              /* CONVERT THE DAY AND YEAR BACK TO A PACKED  @Y30LSMK*/ 07472000
*              /* DECIMAL FORMAT.                            @Y30LSMK*/ 07473000
*              /*                                            @Y30LSMK*/ 07474000
*              /******************************************************/ 07475000
*                                                                  1766 07476000
*              CVD(DAYTOTAL,CDTDAY);                       /*@Y30LSMK*/ 07477000
         CVD   DAYTOTAL,@TS00001                                   1766 07478000
         MVC   CDTDAY(2),@TS00001+6                                1766 07479000
*              CVD(YRTOTAL,CNVTYEAR);                      /*@Y30LSMK*/ 07480000
         CVD   YRTOTAL,@TS00001                                    1767 07481000
         MVC   CNVTYEAR(2),@TS00001+6                              1767 07482000
*              SLL(CNVTYEAR,SHIFTVAL);                     /*@Y30LSMK*/ 07483000
         SLR   @04,@04                                             1768 07484000
         ICM   @04,3,CNVTYEAR                                      1768 07485000
         SLL   @04,4                                               1768 07486000
         STCM  @04,3,CNVTYEAR                                      1768 07487000
*              CDTYEAR = CVTYEAR;                          /*@Y30LSMK*/ 07488000
         MVC   CDTYEAR(1),CVTYEAR                                  1769 07489000
*            END CRDTION;                                  /*@Y30LSMK*/ 07490000
*                                                                  1770 07491000
*        IF ADDR(EXPIR) > NULLPTR                                  1771 07492000
*          THEN                                                    1771 07493000
*                                                                  1771 07494000
@RF01745 L     @04,@PC00001+4                                      1771 07495000
         L     @04,FDTPTR+100(,@04)                                1771 07496000
         LTR   @04,@04                                             1771 07497000
         BNP   @RF01771                                            1771 07498000
*            /********************************************************/ 07499000
*            /*                                              @Y30LSMK*/ 07500000
*            /* TO CALCULATE THE EXPIRATION DATE, COMPUTE    @Y30LSMK*/ 07501000
*            /* THE TOTAL NUMBER OF DAYS FROM THE BEGINING   @Y30LSMK*/ 07502000
*            /* OF THE CURRENT YEAR.                         @Y30LSMK*/ 07503000
*            /* NOTE - A CHECK FOR LEAP YEAR IS MADE DURING  @Y30LSMK*/ 07504000
*            /* THIS CALCULATION.                            @Y30LSMK*/ 07505000
*            /*                                              @Y30LSMK*/ 07506000
*            /********************************************************/ 07507000
*                                                                  1772 07508000
*EXDTION:    DO;                                           /*@Y30LSMK*/ 07509000
EXDTION  DS    0H                                                  1773 07510000
*              YRLOOP = ON;                                /*@Y30LSMK*/ 07511000
         OI    YRLOOP,B'10000000'                                  1773 07512000
*              YRTOTAL = NOWYEAR;                          /*@Y30LSMK*/ 07513000
         LR    YRTOTAL,NOWYEAR                                     1774 07514000
*              DAYTOTAL = EXPIRVAL + NOWDAY;               /*@Y30LSMK*/ 07515000
*                                                                  1775 07516000
         L     @07,@PC00001+4                                      1775 07517000
         L     @07,FDTPTR+100(,@07)                                1775 07518000
         LR    DAYTOTAL,NOWDAY                                     1775 07519000
         AL    DAYTOTAL,EXPIRVAL(,@07)                             1775 07520000
*              /******************************************************/ 07521000
*              /*                                            @Y30LSMK*/ 07522000
*              /* WHEN THE NUMBER OF DAYS REQUESTED IS       @Y30LSMK*/ 07523000
*              /* GREATER THAN ONE YEAR, PROCEED TO LOOP     @Y30LSMK*/ 07524000
*              /* THROUGH THE YEARS INCREMENTING THE TOTAL   @Y30LSMK*/ 07525000
*              /* COUNT OF DAYS AND YEARS.                   @Y30LSMK*/ 07526000
*              /* NOTE - ANY CALCULATION RESULTING IN A DATE @Y30LSMK*/ 07527000
*              /* PAST THE YEAR 2000 WILL BE SET TO 99.999   @Y30LSMK*/ 07528000
*              /* (YYDDD).                                   @Y30LSMK*/ 07529000
*              /*                                            @Y30LSMK*/ 07530000
*              /******************************************************/ 07531000
*                                                                  1776 07532000
*EXPLOOP:      DO WHILE (YRLOOP = ON);                     /*@Y30LSMK*/ 07533000
EXPLOOP  B     @DE01776                                            1776 07534000
@DL01776 DS    0H                                                  1777 07535000
*                IF (YRTOTAL // LPYRCNT) = 0                       1777 07536000
*                  THEN                                            1777 07537000
         LR    @00,YRTOTAL                                         1777 07538000
         SRDA  @00,32                                              1777 07539000
         D     @00,@CF00050                                        1777 07540000
         LTR   @00,@00                                             1777 07541000
         BNZ   @RF01777                                            1777 07542000
*                    DAYPERYR = LEAPYEAR;                  /*@Y30LSMK*/ 07543000
         LA    DAYPERYR,366                                        1778 07544000
*                  ELSE                                            1779 07545000
*                    DAYPERYR = NOLEAPYR;                  /*@Y30LSMK*/ 07546000
         B     @RC01777                                            1779 07547000
@RF01777 LA    DAYPERYR,365                                        1779 07548000
*                IF DAYTOTAL > DAYPERYR                            1780 07549000
*                  THEN                                            1780 07550000
@RC01777 CR    DAYTOTAL,DAYPERYR                                   1780 07551000
         BNH   @RF01780                                            1780 07552000
*                    DO;                                   /*@Y30LSMK*/ 07553000
*                      DAYTOTAL = DAYTOTAL - DAYPERYR;     /*@Y30LSMK*/ 07554000
         SLR   DAYTOTAL,DAYPERYR                                   1782 07555000
*                      YRTOTAL = YRTOTAL + 1;              /*@Y30LSMK*/ 07556000
         AL    YRTOTAL,@CF00045                                    1783 07557000
*                      IF YRTOTAL = 99  &  DAYTOTAL > DAYPERYR     1784 07558000
*                        THEN                                      1784 07559000
         C     YRTOTAL,@CF01543                                    1784 07560000
         BNE   @RF01784                                            1784 07561000
         CR    DAYTOTAL,DAYPERYR                                   1784 07562000
         BNH   @RF01784                                            1784 07563000
*                          DO;                             /*@Y30LSMK*/ 07564000
*                            DAYTOTAL = 999;               /*@Y30LSMK*/ 07565000
         LA    DAYTOTAL,999                                        1786 07566000
*                            YRLOOP = OFF;                 /*@Y30LSMK*/ 07567000
         NI    YRLOOP,B'01111111'                                  1787 07568000
*                          END;                            /*@Y30LSMK*/ 07569000
*                    END;                                  /*@Y30LSMK*/ 07570000
*                  ELSE                                            1790 07571000
*                    YRLOOP = OFF;                         /*@Y30LSMK*/ 07572000
         B     @RC01780                                            1790 07573000
@RF01780 NI    YRLOOP,B'01111111'                                  1790 07574000
*              END EXPLOOP;                                /*@Y30LSMK*/ 07575000
*                                                                  1791 07576000
@RC01780 DS    0H                                                  1791 07577000
@DE01776 TM    YRLOOP,B'10000000'                                  1791 07578000
         BO    @DL01776                                            1791 07579000
*              /******************************************************/ 07580000
*              /*                                            @Y30LSMK*/ 07581000
*              /* CONVERT THE DAY AND YEAR BACK TO A PACKED  @Y30LSMK*/ 07582000
*              /* DECIMAL FORMAT.                            @Y30LSMK*/ 07583000
*              /*                                            @Y30LSMK*/ 07584000
*              /******************************************************/ 07585000
*                                                                  1792 07586000
*              CVD(DAYTOTAL,EXPDAY);                       /*@Y30LSMK*/ 07587000
         CVD   DAYTOTAL,@TS00001                                   1792 07588000
         MVC   EXPDAY(2),@TS00001+6                                1792 07589000
*              CVD(YRTOTAL,CNVTYEAR);                      /*@Y30LSMK*/ 07590000
         CVD   YRTOTAL,@TS00001                                    1793 07591000
         MVC   CNVTYEAR(2),@TS00001+6                              1793 07592000
*              SLL(CNVTYEAR,SHIFTVAL);                     /*@Y30LSMK*/ 07593000
         SLR   @04,@04                                             1794 07594000
         ICM   @04,3,CNVTYEAR                                      1794 07595000
         SLL   @04,4                                               1794 07596000
         STCM  @04,3,CNVTYEAR                                      1794 07597000
*              EXPYEAR = CVTYEAR;                          /*@Y30LSMK*/ 07598000
         MVC   EXPYEAR(1),CVTYEAR                                  1795 07599000
*            END EXDTION;                                  /*@Y30LSMK*/ 07600000
*                                                                  1796 07601000
*        /************************************************************/ 07602000
*        /*                                                  @Y30LSMK*/ 07603000
*        /* THE CREATION AND EXPIRATION DATES HAVE NOW BEEN  @Y30LSMK*/ 07604000
*        /* CALCULATED.  EXIT FROM DATEPROC RETURNING TO THE @Y30LSMK*/ 07605000
*        /* CALLING PROCEDURE.                               @Y30LSMK*/ 07606000
*        /*                                                  @Y30LSMK*/ 07607000
*        /************************************************************/ 07608000
*                                                                  1797 07609000
*        RETURN CODE(0);                                   /*@Y30LSMK*/ 07610000
@RF01771 SLR   @15,@15                                             1797 07611000
         L     @14,12(,@13)                                        1797 07612000
         LM    @00,@12,20(@13)                                     1797 07613000
         BR    @14                                                 1797 07614000
*        END DATEPROC;                                     /*@Y30LSMK*/ 07615000
*        /************************************************************/ 07616000
*        /*                                                  @Y30LSMK*/ 07617000
*        /* PROCEDURE - TIMEPROC                             @Y30LSMK*/ 07618000
*        /*                                                  @Y30LSMK*/ 07619000
*        /* FUNCTION - CONVERTS THE TIME OF DAY, EITHER FROM @Y30LSMK*/ 07620000
*        /* THE UTIME MACRO OR THE CATALOG VOLUME TIME STAMP @Y30LSMK*/ 07621000
*        /* TO A PACKED DECIMAL FORMAT.                      @Y30LSMK*/ 07622000
*        /*                                                  @Y30LSMK*/ 07623000
*        /* INPUT - DATA AREA CONTAINING THE TIME OF DAY.    @Y30LSMK*/ 07624000
*        /*                                                  @Y30LSMK*/ 07625000
*        /* OUTPUT - INITIALIZED TIME OF DAY DATA AREA IN    @Y30LSMK*/ 07626000
*        /* PACKED DECIMAL FORMAT.                           @Y30LSMK*/ 07627000
*        /*                                                  @Y30LSMK*/ 07628000
*        /************************************************************/ 07629000
*                                                                  1799 07630000
*TIMEPROC: PROCEDURE;                                      /*@Y30LSMK*/ 07631000
*                                                                  1799 07632000
TIMEPROC STM   @14,@12,12(@13)                                     1799 07633000
*        /************************************************************/ 07634000
*        /*                                                  @Y30LSMK*/ 07635000
*        /* LOCAL VARIABLES                                  @Y30LSMK*/ 07636000
*        /*                                                  @Y30LSMK*/ 07637000
*        /************************************************************/ 07638000
*                                                                  1800 07639000
*        DCL TODPACK   CHAR(8) BDY(DWORD); /*CONVERSION AREA @Y30LSMK*/ 07640000
*        DCL TIMSHIFT  FIXED(8)        /*TOD SHIFT VALUE     @Y30LSMK*/ 07641000
*                      CONSTANT(12);                       /*@Y30LSMK*/ 07642000
*        DCL TIMCVFAC  FIXED(31)       /*TIME CONVERSION FACTOR      */ 07643000
*                      CONSTANT(65536);                    /*@Y30LSMK*/ 07644000
*        DCL TIMCFAC1  FIXED(31);      /*WORKAREA FOR TIME CONVERSION*/ 07645000
*                                                                  1803 07646000
*        /************************************************************/ 07647000
*        /*                                                  @Y30LSMK*/ 07648000
*        /* SINCE THE TIME OF DAY IS IN BINARY, CONVERT TO   @Y30LSMK*/ 07649000
*        /* A PACKED DECIMAL FORMAT. SINCE BIT POSITION 51   @Y30LSMK*/ 07650000
*        /* IN THE DATA AREA IS THE HIGHEST SIGNIFICANT      @Y30LSMK*/ 07651000
*        /* DIGIT RETURNED FROM THE UTIME MACRO, SHIFT THE   @Y30LSMK*/ 07652000
*        /* VALUE TO THE LOWEST ORDER POSITION.  ALSO        @Y30LSMK*/ 07653000
*        /* SINCE THE VALUE IS GREATER THAN 4 BYTES, THE     @Y30LSMK*/ 07654000
*        /* CONVERSION IS ACCOMPLISHED BY CONVERTING         @Y30LSMK*/ 07655000
*        /* ONLY 4 BYTES AT A TIME.  THE HIGH ORDER 4        @Y30LSMK*/ 07656000
*        /* BYTES ARE ADJUSTED TO IT'S CORRECT VALUE.        @Y30LSMK*/ 07657000
*        /*                                                  @Y30LSMK*/ 07658000
*        /************************************************************/ 07659000
*                                                                  1804 07660000
*        OLDERID2 = NEWERID2;                                      1804 07661000
         L     @04,@PC00001                                        1804 07662000
         L     @04,GDTTR2(,@04)                                    1804 07663000
         MVC   @TS00001(95),NEWERID2(@04)                          1804 07664000
         MVC   OLDERID2(95,@04),@TS00001                           1804 07665000
*        NEWID2 = 'LCTM';                                  /*@Y30LSMK*/ 07666000
*                                                                  1805 07667000
         MVC   NEWID2(4,@04),@CC01553                              1805 07668000
*        TIMEPACK = ZEROAREA;                              /*@Y30LSMK*/ 07669000
         MVC   TIMEPACK(16),ZEROAREA                               1806 07670000
*        SRDL(TIMEODAY,TIMSHIFT);                          /*@Y30LSMK*/ 07671000
         LM    @00,@01,TIMEODAY                                    1807 07672000
         SRDL  @00,12                                              1807 07673000
         STM   @00,@01,TIMEODAY                                    1807 07674000
*        CVD(FIRSTTM,TIMPACK1);                            /*@Y30LSMK*/ 07675000
         L     @04,FIRSTTM                                         1808 07676000
         CVD   @04,TIMPACK1                                        1808 07677000
*        TIMCFAC1 = TIMCVFAC;                              /*@Y30LSMK*/ 07678000
         L     TIMCFAC1,@CF01551                                   1809 07679000
*        CVD(TIMCFAC1,TODPACK);                            /*@Y30LSMK*/ 07680000
         CVD   TIMCFAC1,TODPACK                                    1810 07681000
*        TMPACK = TIMPACK1;                                /*@Y30LSMK*/ 07682000
         MVC   TMPACK(8),TIMPACK1                                  1811 07683000
*        MP(TIMEPACK,TODPACK);                             /*@Y30LSMK*/ 07684000
         MP    TIMEPACK(16),TODPACK(8)                             1812 07685000
*        MP(TIMEPACK,TODPACK);                             /*@Y30LSMK*/ 07686000
         MP    TIMEPACK(16),TODPACK(8)                             1813 07687000
*        CVD(SECONDTM,TODPACK);                            /*@Y30LSMK*/ 07688000
         L     @04,SECONDTM                                        1814 07689000
         CVD   @04,TODPACK                                         1814 07690000
*        AP(TIMEPACK,TODPACK);                             /*@Y30LSMK*/ 07691000
*                                                                  1815 07692000
         AP    TIMEPACK(16),TODPACK(8)                             1815 07693000
*        /************************************************************/ 07694000
*        /*                                                  @Y30LSMK*/ 07695000
*        /* THE TIME OF DAY HAS NOW BEEN CONVERTED TO A      @Y30LSMK*/ 07696000
*        /* PACKED DECIMAL FORMAT.  EXIT FROM TIMEPROC       @Y30LSMK*/ 07697000
*        /* RETURNING TO THE CALLING PROCEDURE.              @Y30LSMK*/ 07698000
*        /*                                                  @Y30LSMK*/ 07699000
*        /************************************************************/ 07700000
*                                                                  1816 07701000
*        RETURN CODE(0);                                   /*@Y30LSMK*/ 07702000
         SLR   @15,@15                                             1816 07703000
         L     @14,12(,@13)                                        1816 07704000
         LM    @00,@12,20(@13)                                     1816 07705000
         BR    @14                                                 1816 07706000
*        END TIMEPROC;                                     /*@Y30LSMK*/ 07707000
*        /************************************************************/ 07708000
*        /*                                                  @Y30LSMK*/ 07709000
*        /* PROCEDURE - CKDTPROC                             @Y30LSMK*/ 07710000
*        /*                                                  @Y30LSMK*/ 07711000
*        /* FUNCTION - TESTS THE ENTRY'S CREATION AND        @Y30LSMK*/ 07712000
*        /* EXPIRATION DATE CATALOG FIELDS AGAINST THE       @Y30LSMK*/ 07713000
*        /* REQUESTED CREATION AND EXPIRATION LISTC OPTIONS. @Y30LSMK*/ 07714000
*        /*                                                  @Y30LSMK*/ 07715000
*        /* INPUT - CREATION AND EXPIRATION DATE SWITCHES.   @Y30LSMK*/ 07716000
*        /*                                                  @Y30LSMK*/ 07717000
*        /* OUTPUT - CREATION AND EXPIRATION DATE SWITCHES   @Y30LSMK*/ 07718000
*        /* SET.                                             @Y30LSMK*/ 07719000
*        /*                                                  @Y30LSMK*/ 07720000
*        /************************************************************/ 07721000
*                                                                  1818 07722000
*CKDTPROC: PROCEDURE;                                      /*@Y30LSMK*/ 07723000
*                                                                  1818 07724000
CKDTPROC STM   @14,@12,12(@13)                                     1818 07725000
*        /************************************************************/ 07726000
*        /*                                                  @Y30LSMK*/ 07727000
*        /* LOCAL VARIABLES                                  @Y30LSMK*/ 07728000
*        /*                                                  @Y30LSMK*/ 07729000
*        /************************************************************/ 07730000
*                                                                  1819 07731000
*        DECLARE                       /*DATASET DATE        @Y30LSMK*/ 07732000
*          1 DSDATE   CHAR(3)  BDY(WORD),                          1819 07733000
*            2 DSDT   BIT(24);                             /*@Y30LSMK*/ 07734000
*                                                                  1819 07735000
*        DECLARE                       /*USER CALCULATED DATE        */ 07736000
*          1 USDATE   CHAR(3)  BDY(WORD),                          1820 07737000
*            2 USDT   BIT(24);                             /*@Y30LSMK*/ 07738000
*                                                                  1820 07739000
*        /************************************************************/ 07740000
*        /*                                                  @Y30LSMK*/ 07741000
*        /* TEST THE ENTRY'S CREATION AND EXPIRATION DATE    @Y30LSMK*/ 07742000
*        /* FIELDS AGAINST THE LISTC CALCULATED CREATION AND @Y30LSMK*/ 07743000
*        /* EXPIRATION DATE FIELDS.  THE TEST IS CONSIDERED  @Y30LSMK*/ 07744000
*        /* SUCCESSFUL IF:                                   @Y30LSMK*/ 07745000
*        /*   1. NO DATE FIELDS EXIST FOR THIS ENTRY, OR     @Y30LSMK*/ 07746000
*        /*   2. THE DATE FIELDS EXIST, BUT ARE NOT INITIALIZED, OR  */ 07747000
*        /*   3. THE DATE FIELDS EXIST AND ARE LESS THAN OR  @Y30LSMK*/ 07748000
*        /*      EQUAL TO THE LISTC CALCULATED DATES.        @Y30LSMK*/ 07749000
*        /* NOTE - THE SIGN DIGIT IS NOT TESTED.             @Y30LSMK*/ 07750000
*        /*                                                  @Y30LSMK*/ 07751000
*        /************************************************************/ 07752000
*                                                                  1821 07753000
*        OLDERID2 = NEWERID2;                                      1821 07754000
         L     @04,@PC00001                                        1821 07755000
         L     @04,GDTTR2(,@04)                                    1821 07756000
         MVC   @TS00001(95),NEWERID2(@04)                          1821 07757000
         MVC   OLDERID2(95,@04),@TS00001                           1821 07758000
*        NEWID2 = 'LCCK';                                  /*@Y30LSMK*/ 07759000
*                                                                  1822 07760000
         MVC   NEWID2(4,@04),@CC01563                              1822 07761000
*        IF ADDR(CREAT) > NULLPTR                                  1823 07762000
*          THEN                                                    1823 07763000
*                                                                  1823 07764000
         SLR   @04,@04                                             1823 07765000
         L     @02,@PC00001+4                                      1823 07766000
         C     @04,FDTPTR+96(,@02)                                 1823 07767000
         BNL   @RF01823                                            1823 07768000
*            /********************************************************/ 07769000
*            /*                                              @Y30LSMK*/ 07770000
*            /* POSITION FPL POINTER TO CREATION DATE FPL.   @Y30LSMK*/ 07771000
*            /*                                              @Y30LSMK*/ 07772000
*            /********************************************************/ 07773000
*                                                                  1824 07774000
*            DO;                                           /*@Y30LSMK*/ 07775000
*              IF ADDR(NAME) > NULLPTR                             1825 07776000
*                THEN                                              1825 07777000
         C     @04,FDTPTR+52(,@02)                                 1825 07778000
         BNL   @RF01825                                            1825 07779000
*                  CTGFLPTR = FPLPTMAP(FPLCDT);            /*@Y30LSMK*/ 07780000
         L     @04,COMSWKPT(,COMPTR)                               1826 07781000
         LH    @02,FPLCDT                                          1826 07782000
         SLA   @02,2                                               1826 07783000
         L     @01,COMFPLPT(,COMPTR)                               1826 07784000
         AL    @01,@CF01593                                        1826 07785000
         L     @02,FPLPTMAP(@02,@01)                               1826 07786000
         ST    @02,CTGFLPTR(,@04)                                  1826 07787000
*                ELSE                                              1827 07788000
*                  CTGFLPTR = CRDTFPT;                     /*@Y30LSMK*/ 07789000
         B     @RC01825                                            1827 07790000
@RF01825 L     @04,COMSWKPT(,COMPTR)                               1827 07791000
         L     @02,COMFPLPT(,COMPTR)                               1827 07792000
         L     @02,CRDTFPT(,@02)                                   1827 07793000
         ST    @02,CTGFLPTR(,@04)                                  1827 07794000
*              IF CTGFLPT(1) > NULLPTR                             1828 07795000
*                THEN                                              1828 07796000
@RC01825 L     @04,COMSWKPT(,COMPTR)                               1828 07797000
         L     @04,CTGFLPTR(,@04)                                  1828 07798000
         L     @04,CTGFLPT(,@04)                                   1828 07799000
         LTR   @04,@04                                             1828 07800000
         BNP   @RF01828                                            1828 07801000
*                  DO;                                     /*@Y30LSMK*/ 07802000
*                    DSDATE = CRDT;                        /*@Y30LSMK*/ 07803000
         MVC   DSDATE(3),CRDT(@04)                                 1830 07804000
*                    SRL(DSDT,SHIFTVAL);                   /*@Y30LSMK*/ 07805000
         SLR   @02,@02                                             1831 07806000
         ICM   @02,7,DSDT                                          1831 07807000
         SRL   @02,4                                               1831 07808000
         STCM  @02,7,DSDT                                          1831 07809000
*                    USDATE = CDTMULTI;                    /*@Y30LSMK*/ 07810000
         MVC   USDATE(3),CDTMULTI                                  1832 07811000
*                    SRL(USDT,SHIFTVAL);                   /*@Y30LSMK*/ 07812000
         SLR   @02,@02                                             1833 07813000
         ICM   @02,7,USDT                                          1833 07814000
         SRL   @02,4                                               1833 07815000
         STCM  @02,7,USDT                                          1833 07816000
*                    IF CRDT = ARITH4FF  |  DSDATE <= USDATE       1834 07817000
*                      THEN                                        1834 07818000
         CLC   CRDT(3,@04),ARITH4FF                                1834 07819000
         BE    @RT01834                                            1834 07820000
         CLC   DSDATE(3),USDATE                                    1834 07821000
         BH    @RF01834                                            1834 07822000
@RT01834 DS    0H                                                  1835 07823000
*                        CRDTSW = ON;                      /*@Y30LSMK*/ 07824000
         L     @04,COMFLGPT(,COMPTR)                               1835 07825000
         OI    CRDTSW(@04),B'10000000'                             1835 07826000
*                  END;                                    /*@Y30LSMK*/ 07827000
*                ELSE                                              1837 07828000
*                  CRDTSW = ON;                            /*@Y30LSMK*/ 07829000
         B     @RC01828                                            1837 07830000
@RF01828 L     @04,COMFLGPT(,COMPTR)                               1837 07831000
         OI    CRDTSW(@04),B'10000000'                             1837 07832000
*            END;                                          /*@Y30LSMK*/ 07833000
*          ELSE                                                    1839 07834000
*            CRDTSW = ON;                                  /*@Y30LSMK*/ 07835000
*                                                                  1839 07836000
         B     @RC01823                                            1839 07837000
@RF01823 L     @04,COMFLGPT(,COMPTR)                               1839 07838000
         OI    CRDTSW(@04),B'10000000'                             1839 07839000
*        IF ADDR(EXPIR) > NULLPTR                                  1840 07840000
*          THEN                                                    1840 07841000
*                                                                  1840 07842000
@RC01823 SLR   @04,@04                                             1840 07843000
         L     @02,@PC00001+4                                      1840 07844000
         C     @04,FDTPTR+100(,@02)                                1840 07845000
         BNL   @RF01840                                            1840 07846000
*            /********************************************************/ 07847000
*            /*                                              @Y30LSMK*/ 07848000
*            /* POSITION FPL POINTER TO EXPIRATION DATE FPL. @Y30LSMK*/ 07849000
*            /*                                              @Y30LSMK*/ 07850000
*            /********************************************************/ 07851000
*                                                                  1841 07852000
*            DO;                                           /*@Y30LSMK*/ 07853000
*              IF ADDR(NAME) > NULLPTR                             1842 07854000
*                THEN                                              1842 07855000
         C     @04,FDTPTR+52(,@02)                                 1842 07856000
         BNL   @RF01842                                            1842 07857000
*                  CTGFLPTR = FPLPTMAP(FPLEXP);            /*@Y30LSMK*/ 07858000
         L     @04,COMSWKPT(,COMPTR)                               1843 07859000
         LH    @02,FPLEXP                                          1843 07860000
         SLA   @02,2                                               1843 07861000
         L     @01,COMFPLPT(,COMPTR)                               1843 07862000
         AL    @01,@CF01593                                        1843 07863000
         L     @02,FPLPTMAP(@02,@01)                               1843 07864000
         ST    @02,CTGFLPTR(,@04)                                  1843 07865000
*                ELSE                                              1844 07866000
*                  CTGFLPTR = EXDTFPT;                     /*@Y30LSMK*/ 07867000
         B     @RC01842                                            1844 07868000
@RF01842 L     @04,COMSWKPT(,COMPTR)                               1844 07869000
         L     @02,COMFPLPT(,COMPTR)                               1844 07870000
         L     @02,EXDTFPT(,@02)                                   1844 07871000
         ST    @02,CTGFLPTR(,@04)                                  1844 07872000
*              IF CTGFLPT(1) > NULLPTR                             1845 07873000
*                THEN                                              1845 07874000
@RC01842 L     @04,COMSWKPT(,COMPTR)                               1845 07875000
         L     @04,CTGFLPTR(,@04)                                  1845 07876000
         L     @04,CTGFLPT(,@04)                                   1845 07877000
         LTR   @04,@04                                             1845 07878000
         BNP   @RF01845                                            1845 07879000
*                  DO;                                     /*@Y30LSMK*/ 07880000
*                    DSDATE = EXDT;                        /*@Y30LSMK*/ 07881000
         MVC   DSDATE(3),EXDT(@04)                                 1847 07882000
*                    SRL(DSDT,SHIFTVAL);                   /*@Y30LSMK*/ 07883000
         SLR   @02,@02                                             1848 07884000
         ICM   @02,7,DSDT                                          1848 07885000
         SRL   @02,4                                               1848 07886000
         STCM  @02,7,DSDT                                          1848 07887000
*                    USDATE = EXPMULTI;                    /*@Y30LSMK*/ 07888000
         MVC   USDATE(3),EXPMULTI                                  1849 07889000
*                    SRL(USDT,SHIFTVAL);                   /*@Y30LSMK*/ 07890000
         SLR   @02,@02                                             1850 07891000
         ICM   @02,7,USDT                                          1850 07892000
         SRL   @02,4                                               1850 07893000
         STCM  @02,7,USDT                                          1850 07894000
*                    IF EXDT = ARITH4FF  |  DSDATE <= USDATE       1851 07895000
*                      THEN                                        1851 07896000
         CLC   EXDT(3,@04),ARITH4FF                                1851 07897000
         BE    @RT01851                                            1851 07898000
         CLC   DSDATE(3),USDATE                                    1851 07899000
         BH    @RF01851                                            1851 07900000
@RT01851 DS    0H                                                  1852 07901000
*                        EXDTSW = ON;                      /*@Y30LSMK*/ 07902000
         L     @04,COMFLGPT(,COMPTR)                               1852 07903000
         OI    EXDTSW(@04),B'10000000'                             1852 07904000
*                  END;                                    /*@Y30LSMK*/ 07905000
*                ELSE                                              1854 07906000
*                  EXDTSW = ON;                            /*@Y30LSMK*/ 07907000
         B     @RC01845                                            1854 07908000
@RF01845 L     @04,COMFLGPT(,COMPTR)                               1854 07909000
         OI    EXDTSW(@04),B'10000000'                             1854 07910000
*            END;                                          /*@Y30LSMK*/ 07911000
*          ELSE                                                    1856 07912000
*            EXDTSW = ON;                                  /*@Y30LSMK*/ 07913000
*                                                                  1856 07914000
         B     @RC01840                                            1856 07915000
@RF01840 L     @04,COMFLGPT(,COMPTR)                               1856 07916000
         OI    EXDTSW(@04),B'10000000'                             1856 07917000
*        /************************************************************/ 07918000
*        /*                                                  @Y30LSMK*/ 07919000
*        /* BOTH THE CREATION AND EXPIRATION DATE FIELDS     @Y30LSMK*/ 07920000
*        /* HAVE BEEN TESTED AND THE APPROPRIATE SWITCHES    @Y30LSMK*/ 07921000
*        /* HAVE BEEN SET.  EXIT HERE RETURNING TO THE       @Y30LSMK*/ 07922000
*        /* CALLING PROCEDURE.                               @Y30LSMK*/ 07923000
*        /*                                                  @Y30LSMK*/ 07924000
*        /************************************************************/ 07925000
*                                                                  1857 07926000
*        RETURN CODE(0);                                   /*@Y30LSMK*/ 07927000
@RC01840 SLR   @15,@15                                             1857 07928000
         L     @14,12(,@13)                                        1857 07929000
         LM    @00,@12,20(@13)                                     1857 07930000
         BR    @14                                                 1857 07931000
*        END CKDTPROC;                                     /*@Y30LSMK*/ 07932000
*        /************************************************************/ 07933000
*        /*                                                          */ 07934000
*        /* LISTCAT IDCLC01 EOJ.                             @ZA05939*/ 07935000
*        /*                                                          */ 07936000
*        /************************************************************/ 07937000
*                                                                  1859 07938000
*        END IDCLC01                                               1859 07939000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07940000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 07941000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 07942000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 07943000
*/*%INCLUDE SYSLIB  (IDCCSLC )                                        * 07944000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 07945000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 07946000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 07947000
*;                                                                 1859 07948000
@DATA    DS    0H                                                       07949000
@CH00293 DC    H'5'                                                     07950000
@CH00480 DC    H'7'                                                     07951000
@CH00187 DC    H'8'                                                     07952000
@CH00646 DC    H'9'                                                     07953000
@CH00600 DC    H'11'                                                    07954000
@CH00490 DC    H'16'                                                    07955000
@CH01139 DC    H'33'                                                    07956000
@CH00610 DC    H'44'                                                    07957000
@CH01270 DC    H'45'                                                    07958000
@CH01565 DC    H'48'                                                    07959000
@CH01583 DC    H'66'                                                    07960000
@CH01315 DC    H'124'                                                   07961000
@SM01594 MVC   SAVFPL(0,SAPTR),CTGFL(@14)                               07962000
@SM01596 MVC   SAVFPL(0,SAPTR),CTGFL(@06)                               07963000
         DS    0F                                                       07964000
@AL00367 DC    A(@CC01245)             LIST WITH   2 ARGUMENT(S)        07965000
         DC    AL1(X'80')                                               07966000
         DC    AL3(ALL)                                                 07967000
@DATD    DSECT                                                          07968000
         DS    0F                                                       07969000
@SA00001 DS    18F                                                      07970000
@PC00001 DS    3F                                                       07971000
@SA00002 DS    15F                                                      07972000
@SA00004 DS    15F                                                      07973000
@SA00003 DS    15F                                                      07974000
@SA00005 DS    15F                                                      07975000
@PC00005 DS    1F                                                       07976000
@AL00001 DS    5A                                                       07977000
@TF00001 DS    F                                                        07978000
@AFTEMPS DS    1F                                                       07979000
IDCLC01  CSECT                                                          07980000
         DS    0F                                                       07981000
@CF00123 DC    F'0'                                                     07982000
@CF00045 DC    F'1'                                                     07983000
@CH00045 EQU   @CF00045+2                                               07984000
@CF00161 DC    F'2'                                                     07985000
@CH00161 EQU   @CF00161+2                                               07986000
@CF00170 DC    F'3'                                                     07987000
@CH00170 EQU   @CF00170+2                                               07988000
@CF00050 DC    F'4'                                                     07989000
@CH00050 EQU   @CF00050+2                                               07990000
@CF00164 DC    F'6'                                                     07991000
@CH00164 EQU   @CF00164+2                                               07992000
@CF00586 DC    F'12'                                                    07993000
@CF00657 DC    F'23'                                                    07994000
@CF01311 DC    F'40'                                                    07995000
@CH01311 EQU   @CF01311+2                                               07996000
@CF01313 DC    F'56'                                                    07997000
@CH01313 EQU   @CF01313+2                                               07998000
@CF01581 DC    F'61'                                                    07999000
@CF01543 DC    F'99'                                                    08000000
@CF00155 DC    F'100'                                                   08001000
@CF01582 DC    F'710'                                                   08002000
@CH01582 EQU   @CF01582+2                                               08003000
@CF01551 DC    F'65536'                                                 08004000
@CF01346 DC    F'86400'                                                 08005000
@CF01343 DC    F'1000000'                                               08006000
@CF01603 DC    F'-64'                                                   08007000
@CF01604 DC    F'-63'                                                   08008000
@CF01605 DC    F'-55'                                                   08009000
@CF01606 DC    F'-54'                                                   08010000
@CF01601 DC    F'-44'                                                   08011000
@CF01602 DC    F'-43'                                                   08012000
@CF01607 DC    F'-41'                                                   08013000
@CF01608 DC    F'-40'                                                   08014000
@CF01593 DC    F'-4'                                                    08015000
@CF01611 DC    F'-3'                                                    08016000
@DATD    DSECT                                                          08017000
         DS    0D                                                       08018000
LISTSCAN DS    A                                                        08019000
IOCSPTR  DS    A                                                        08020000
DDSTRU   DS    A                                                        08021000
FSADDR   DS    A                                                        08022000
ERCNVADR DS    A                                                        08023000
GPPTR    DS    F                                                        08024000
GPLEN    DS    F                                                        08025000
UQCATPTR DS    A                                                        08026000
UQPASPTR DS    A                                                        08027000
UQENTPTR DS    A                                                        08028000
PWTALLY  DS    F                                                        08029000
LISTPTR  DS    A                                                        08030000
FPLATR   DS    H                                                        08031000
FPLEXP   DS    H                                                        08032000
FPLCDT   DS    H                                                        08033000
FPLSPH   DS    H                                                        08034000
FPLVTM   DS    H                                                        08035000
UIDLN    DS    H                                                        08036000
UQENTLEN DS    H                                                        08037000
NAMECNT  DS    H                                                        08038000
SETRC    DS    H                                                        08039000
LISTLN   DS    FL1                                                      08040000
         DS    0D                                                       08041000
@TS00001 DS    CL95                                                     08042000
         DS    CL1                                                      08043000
ERRDARG  DS    CL44                                                     08044000
GPID     DS    CL4                                                      08045000
OTARGLST DS    BL48                                                     08046000
UIDNM    DS    CL7                                                      08047000
         DS    CL1                                                      08048000
ENTYNM   DS    CL49                                                     08049000
         ORG   ENTYNM                                                   08050000
ENTCT    DS    FL4                                                      08051000
@NM00050 DS    CL45                                                     08052000
         ORG   @NM00050                                                 08053000
ETYTYP   DS    CL1                                                      08054000
ENTNM    DS    CL44                                                     08055000
         ORG   ENTYNM+49                                                08056000
         DS    CL3                                                      08057000
CIRAREA  DS    CL32                                                     08058000
CDTMULTI DS    CL3                                                      08059000
         ORG   CDTMULTI                                                 08060000
CDTYEAR  DS    BL1                                                      08061000
CDTDAY   DS    BL2                                                      08062000
         ORG   CDTMULTI+3                                               08063000
EXPMULTI DS    CL3                                                      08064000
         ORG   EXPMULTI                                                 08065000
EXPYEAR  DS    BL1                                                      08066000
EXPDAY   DS    BL2                                                      08067000
         ORG   EXPMULTI+3                                               08068000
ENTNAME  DS    CL44                                                     08069000
         DS    CL2                                                      08070000
DOBJNAM  DS    CL145                                                    08071000
         DS    CL3                                                      08072000
DAS#FLGS DS    CL49                                                     08073000
         DS    CL3                                                      08074000
TIMEODAY DS    CL8                                                      08075000
         ORG   TIMEODAY                                                 08076000
FIRSTTM  DS    FL4                                                      08077000
SECONDTM DS    FL4                                                      08078000
         ORG   TIMEODAY+8                                               08079000
CREATEDT DS    CL4                                                      08080000
         ORG   CREATEDT                                                 08081000
@NM00054 DS    CL1                                                      08082000
XUTYEAR  DS    BL1                                                      08083000
XUTDAY   DS    BL2                                                      08084000
         ORG   CREATEDT+4                                               08085000
TIMEPACK DS    CL16                                                     08086000
         ORG   TIMEPACK                                                 08087000
@NM00055 DS    CL8                                                      08088000
TMPACK   DS    CL8                                                      08089000
         ORG   TIMEPACK+16                                              08090000
         DS    CL4                                                      08091000
TIMPACK1 DS    CL8                                                      08092000
MICTIME  DS    CL16                                                     08093000
         ORG   MICTIME                                                  08094000
@NM00056 DS    CL8                                                      08095000
MCTIME   DS    CL8                                                      08096000
         ORG   MICTIME+16                                               08097000
CMSEOFLG DS    BL1                                                      08098000
BYPASFLG DS    BL1                                                      08099000
TYPOKFLG DS    BL1                                                      08100000
BADPWFLG DS    BL1                                                      08101000
SHORTFLG DS    BL1                                                      08102000
SHVOLFLG DS    BL1                                                      08103000
NOTRQFLG DS    BL1                                                      08104000
LVLNMWOA DS    CL44                                                     08105000
SAVTYPE  DS    CL1                                                      08106000
ASSOCFLG DS    BL1                                                      08107000
NUSESW   DS    BL1                                                      08108000
DATESW   DS    BL1                                                      08109000
VOLSW    DS    BL1                                                      08110000
TIMLESSW DS    BL1                                                      08111000
YRLOOP   DS    BL1                                                      08112000
CNVTYEAR DS    BL2                                                      08113000
         ORG   CNVTYEAR                                                 08114000
CVTYEAR  DS    BL1                                                      08115000
CVTPACK  DS    BL1                                                      08116000
         ORG   CNVTYEAR+2                                               08117000
         DS    CL4                                                      08118000
TODPACK  DS    CL8                                                      08119000
DSDATE   DS    CL3                                                      08120000
         ORG   DSDATE                                                   08121000
DSDT     DS    BL3                                                      08122000
         ORG   DSDATE+3                                                 08123000
         DS    CL1                                                      08124000
USDATE   DS    CL3                                                      08125000
         ORG   USDATE                                                   08126000
USDT     DS    BL3                                                      08127000
         ORG   USDATE+3                                                 08128000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08129000
@ENDDATD EQU   *                                                        08130000
IDCLC01  CSECT                                                          08131000
         DS    0F                                                       08132000
@SIZDATD DC    AL1(0)                                                   08133000
         DC    AL3(@ENDDATD-@DATD)                                      08134000
@CV00869 DC    V(IDCLC02)                                               08135000
@CV00870 DC    V(LOCPROC)                                               08136000
@CV00871 DC    V(LISTPROC)                                              08137000
@CV00872 DC    V(ERRPROC)                                               08138000
@CV00873 DC    V(FPLPROC)                                               08139000
@CV00874 DC    V(AUPROC)                                                08140000
@CV00875 DC    V(CDIPROC)                                               08141000
@CV00876 DC    V(VPROC)                                                 08142000
@CV00877 DC    V(ANSVPROC)                                              08143000
@CV00878 DC    V(SHORTLST)                                              08144000
@CV00879 DC    V(VOLLIST)                                               08145000
@CV00880 DC    V(FREESTG)                                               08146000
         DS    0D                                                       08147000
DICTSZ   DC    F'1400'                                                  08148000
GPDDSZ   DC    F'256'                                                   08149000
@CC01284 DC    C'CVAUXBPG'                                              08150000
@CC01438 DC    C'CTGOPTN2'                                              08151000
@CC01442 DC    C'TYPELIST'                                              08152000
@CC01488 DC    C'HOLDETYP'                                              08153000
@CC01286 DC    C'CVAUBPG'                                               08154000
@CC01433 DC    C'CATNAME'                                               08155000
@CC01437 DC    C'CACBFLG'                                               08156000
@CC01441 DC    C'TYPECNT'                                               08157000
@CC01434 DC    C'OBJCNT'                                                08158000
@CC01435 DC    C'OBJTYP'                                                08159000
@CC01487 DC    C'ASSOC#'                                                08160000
@CC01436 DC    C'OBJNM'                                                 08161000
@CC01439 DC    C'FLAGS'                                                 08162000
@CC01245 DC    C'LC00'                                                  08163000
@CC01247 DC    C'LC01'                                                  08164000
@CC01249 DC    C'LC02'                                                  08165000
@CC01251 DC    C'LC03'                                                  08166000
@CC01253 DC    C'LC04'                                                  08167000
@CC01255 DC    C'LC05'                                                  08168000
@CC01257 DC    C'LC06'                                                  08169000
@CC01259 DC    C'LC07'                                                  08170000
@CC01261 DC    C'LC10'                                                  08171000
@CC01263 DC    C'LC11'                                                  08172000
@CC01360 DC    C'LC99'                                                  08173000
@CC01380 DC    C'LCIN'                                                  08174000
@CC01399 DC    C'LCNX'                                                  08175000
@CC01425 DC    C'LCEN'                                                  08176000
@CC01443 DC    C'LCOJ'                                                  08177000
@CC01484 DC    C'LCRT'                                                  08178000
@CC01489 DC    C'LCRP'                                                  08179000
@CC01494 DC    C'LCR2'                                                  08180000
@CC01495 DC    C'LCRA'                                                  08181000
@CC01531 DC    C'LCDT'                                                  08182000
@CC01553 DC    C'LCTM'                                                  08183000
@CC01563 DC    C'LCCK'                                                  08184000
@CC01146 EQU   @CC01245                                                 08185000
@CC01149 DC    C'UV0'                                                   08186000
@CC01155 EQU   @CC01261                                                 08187000
@CC01288 DC    C'CPG'                                                   08188000
FIXAREA  DS    CL768                                                    08189000
         ORG   FIXAREA                                                  08190000
@NM00001 DC    256X'00'                                                 08191000
@NM00002 DC    256X'00'                                                 08192000
@NM00003 DC    256X'00'                                                 08193000
         ORG   FIXAREA+768                                              08194000
ALL      DC    CL3'ALL'                                                 08195000
FORMAT   DC    CL4'FORM'                                                08196000
HSECOND  DC    CL4'HSEC'                                                08197000
CLOCK    DC    CL4'KLOK'                                                08198000
SETZERO  DC    CL4'ZERO'                                                08199000
SETBLANK DC    CL4'BLNK'                                                08200000
NOSET    DC    CL4'NSET'                                                08201000
OVERRIDE DC    CL4'OVRD'                                                08202000
ACQUIRE  DC    CL8'ACQUIRE '                                            08203000
RELINQ   DC    CL8'RELINQ  '                                            08204000
MOUNT    DC    CL8'MOUNT   '                                            08205000
DEMOUNT  DC    CL8'DEMOUNT '                                            08206000
DEFINE   DC    CL8'DEFINE  '                                            08207000
MOVE     DC    CL8'MOVE    '                                            08208000
TRACEQ   DC    CL8'TRACEQ  '                                            08209000
COPYTABL DC    CL8'COPYTABL'                                            08210000
COPYCRTG DC    CL8'COPYCRTG'                                            08211000
COPYVOL  DC    CL8'COPYVOL '                                            08212000
VVIC     DC    CL8'VVIC    '                                            08213000
TUNE     DC    CL8'TUNE    '                                            08214000
NAMES    DC    CL4'NAME'                                                08215000
UNIT     DC    CL4'UNIT'                                                08216000
SHR      DC    CL4'SHR '                                                08217000
EXCL     DC    CL4'EXCL'                                                08218000
NOWAIT   DC    CL4'NWAI'                                                08219000
WAIT     DC    CL4'WAIT'                                                08220000
SECURENM DC    CL8'PASSWALL'                                            08221000
ASSOCNM  DC    CL8'NAMEDS  '                                            08222000
CATTRNM  DC    CL8'CATTR   '                                            08223000
RELNM    DC    CL8'RELCRA  '                                            08224000
RGATTRNM DC    CL8'RGATTR  '                                            08225000
ATTRNM   DC    CL8'DSATTR  '                                            08226000
DSETSPNM DC    CL8'SPACPARM'                                            08227000
PGBYTKNM DC    CL8'NOBYTTRK'                                            08228000
DSETVLNM DC    CL8'ENTVOL  '                                            08229000
ETYPNM   DC    CL8'ENTYPE  '                                            08230000
ENT44NM  DC    CL8'ENTNAME '                                            08231000
DSBNM    DC    CL8'AMDSBCAT'                                            08232000
DSIDNM   DC    CL8'OWNERID '                                            08233000
CRDTNM   DC    CL8'DSETCRDT'                                            08234000
EXDTNM   DC    CL8'DSETEXDT'                                            08235000
BUFFNM   DC    CL8'BUFSIZE '                                            08236000
DSHUNM   DC    CL8'HURBADS '                                            08237000
DSHANM   DC    CL8'HARBADS '                                            08238000
RECLNM   DC    CL8'LRECL   '                                            08239000
EXITNM   DC    CL8'EXCPEXIT'                                            08240000
SECFLAGS DC    CL8'SECFLAGS'                                            08241000
MULTITNM DC    CL8'MULTITYP'                                            08242000
CACBNM   DC    CL8'CATACB  '                                            08243000
AUVOLNM  DC    CL8'CATVOL  '                                            08244000
VTIMENM  DC    CL8'VOLTSTMP'                                            08245000
VSYSXNM  DC    CL8'SYSEXTDS'                                            08246000
V#DSPNM  DC    CL8'NODSPACE'                                            08247000
V#DSNM   DC    CL8'NODSET  '                                            08248000
VCHARNM  DC    CL8'VOLDVCHR'                                            08249000
VSPHDRNM DC    CL8'SPACEHDR'                                            08250000
VDSDIRNM DC    CL8'DSDIRECT'                                            08251000
VXDESNM  DC    CL8'DSPDSCRP'                                            08252000
GDGATRNM DC    CL8'GDGATTR '                                            08253000
GDGLMTNM DC    CL8'GDGLIMIT'                                            08254000
MODID    DC    CL4'LC01'                                                08255000
NOTYPE   DC    X'00'                                                    08256000
TYPECMPR DC    X'00'                                                    08257000
         DC    XL10'0'                                                  08258000
         DS    CL3                                                      08259000
ARITH4FF DC    X'FFFFFFFF'                                              08260000
HEXFF    DS    CL256                                                    08261000
         ORG   HEXFF                                                    08262000
@NM00057 DC    256X'FF'                                                 08263000
         ORG   HEXFF+256                                                08264000
ZEROAREA DS    CL256                                                    08265000
         ORG   ZEROAREA                                                 08266000
@NM00058 DC    256X'00'                                                 08267000
         ORG   ZEROAREA+256                                             08268000
NMPTRS   DC    AL4(MULTITNM)                                            08269000
         DC    AL4(ETYPNM)                                              08270000
         DC    AL4(ENT44NM)                                             08271000
         DC    AL4(CATTRNM)                                             08272000
         DC    AL4(ASSOCNM)                                             08273000
         DC    AL4(EXDTNM)                                              08274000
         DC    AL4(CRDTNM)                                              08275000
         DC    AL4(DSIDNM)                                              08276000
         DC    AL4(RELNM)                                               08277000
         DC    AL4(AUVOLNM)                                             08278000
         DC    AL4(VCHARNM)                                             08279000
         DC    AL4(DSETSPNM)                                            08280000
         DC    AL4(DSHUNM)                                              08281000
         DC    AL4(DSHANM)                                              08282000
         DC    AL4(DSETVLNM)                                            08283000
         DC    AL4(PGBYTKNM)                                            08284000
         DC    AL4(VTIMENM)                                             08285000
         DC    AL4(VSYSXNM)                                             08286000
         DC    AL4(V#DSPNM)                                             08287000
         DC    AL4(V#DSNM)                                              08288000
         DC    AL4(VSPHDRNM)                                            08289000
         DC    AL4(VDSDIRNM)                                            08290000
         DC    AL4(VXDESNM)                                             08291000
         DC    AL4(SECURENM)                                            08292000
         DC    AL4(DSBNM)                                               08293000
         DC    AL4(ATTRNM)                                              08294000
         DC    AL4(BUFFNM)                                              08295000
         DC    AL4(RECLNM)                                              08296000
         DC    AL4(GDGATRNM)                                            08297000
         DC    AL4(GDGLMTNM)                                            08298000
         DC    AL4(RGATTRNM)                                            08299000
         DC    AL4(EXITNM)                                              08300000
         DC    AL4(SECFLAGS)                                            08301000
         DC    AL4(CACBNM)                                              08302000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08303000
@01      EQU   01                                                       08304000
@02      EQU   02                                                       08305000
@03      EQU   03                                                       08306000
@04      EQU   04                                                       08307000
@05      EQU   05                                                       08308000
@06      EQU   06                                                       08309000
@07      EQU   07                                                       08310000
@08      EQU   08                                                       08311000
@09      EQU   09                                                       08312000
@10      EQU   10                                                       08313000
@11      EQU   11                                                       08314000
@12      EQU   12                                                       08315000
@13      EQU   13                                                       08316000
@14      EQU   14                                                       08317000
@15      EQU   15                                                       08318000
TIMCFAC1 EQU   @02                                                      08319000
DAYPERYR EQU   @04                                                      08320000
DAYTOTAL EQU   @02                                                      08321000
YRTOTAL  EQU   @03                                                      08322000
NOWDAY   EQU   @06                                                      08323000
NOWYEAR  EQU   @07                                                      08324000
VHDRLN   EQU   @02                                                      08325000
ASSOCNO  EQU   @07                                                      08326000
NN       EQU   @02                                                      08327000
CI#IDX   EQU   @06                                                      08328000
JJ       EQU   @02                                                      08329000
TYPIDX   EQU   @07                                                      08330000
ENTIDX   EQU   @06                                                      08331000
IDX      EQU   @04                                                      08332000
SAPTR    EQU   @02                                                      08333000
SECNDAY1 EQU   @02                                                      08334000
MICRSEC1 EQU   @02                                                      08335000
COMPTR   EQU   @03                                                      08336000
DMPINDEX EQU   @02                                                      08337000
OPNPTR   EQU   @02                                                      08338000
TESTRC   EQU   @04                                                      08339000
REG9     EQU   @09                                                      08340000
REG10    EQU   @10                                                      08341000
REG11    EQU   @11                                                      08342000
REG12    EQU   @12                                                      08343000
RTNREG   EQU   @15                                                      08344000
REG5     EQU   @05                                                      08345000
REG0     EQU   @00                                                      08346000
REG1     EQU   @01                                                      08347000
REG13    EQU   @13                                                      08348000
REG14    EQU   @14                                                      08349000
REG15    EQU   @15                                                      08350000
REG2     EQU   @02                                                      08351000
REG3     EQU   @03                                                      08352000
REG4     EQU   @04                                                      08353000
REG6     EQU   @06                                                      08354000
REG7     EQU   @07                                                      08355000
REG8     EQU   @08                                                      08356000
IDCSAEP0 EQU   0                                                        08357000
IDCSAGP0 EQU   0                                                        08358000
IDCSAFP0 EQU   0                                                        08359000
IDCSATI0 EQU   0                                                        08360000
IDCSAID0 EQU   0                                                        08361000
IDCSACR0 EQU   0                                                        08362000
IDCSAQL0 EQU   0                                                        08363000
TRACE1   EQU   0                                                        08364000
OLDERID1 EQU   TRACE1                                                   08365000
TRACE2   EQU   0                                                        08366000
OLDERID2 EQU   TRACE2                                                   08367000
NEWID2   EQU   TRACE2+95                                                08368000
NEWERID2 EQU   5                                                        08369000
CIRAGL   EQU   0                                                        08370000
CIRTYPE  EQU   CIRAGL                                                   08371000
CIRTYP1Q EQU   CIRTYPE                                                  08372000
CIRTYPAQ EQU   CIRTYPE                                                  08373000
CIRHLN   EQU   CIRAGL+4                                                 08374000
CIRTLN   EQU   CIRAGL+6                                                 08375000
CIRHDR   EQU   CIRAGL+8                                                 08376000
CIRTLR   EQU   CIRAGL+12                                                08377000
CIRWKP   EQU   CIRAGL+16                                                08378000
CIRCAT   EQU   CIRAGL+20                                                08379000
CIRPWD   EQU   CIRAGL+24                                                08380000
CIRPID   EQU   CIRAGL+28                                                08381000
ALLAGL   EQU   0                                                        08382000
ALLSTS   EQU   ALLAGL+24                                                08383000
ALLDSP   EQU   ALLAGL+25                                                08384000
ALLORG   EQU   ALLAGL+26                                                08385000
ALLOPT   EQU   ALLAGL+28                                                08386000
UNITABL  EQU   0                                                        08387000
UNITADR  EQU   UNITABL+4                                                08388000
@NM00013 EQU   UNITADR                                                  08389000
UNITSTAT EQU   UNITABL+6                                                08390000
IDCIOOP0 EQU   0                                                        08391000
IDCIOCL0 EQU   0                                                        08392000
IOCSTR   EQU   0                                                        08393000
IOCDSO   EQU   IOCSTR+16                                                08394000
IOCRFM   EQU   IOCSTR+17                                                08395000
IOCMAC   EQU   IOCSTR+18                                                08396000
IOCMAC2  EQU   IOCSTR+19                                                08397000
IOCCHP   EQU   IOCSTR+20                                                08398000
IOCMSG   EQU   IOCSTR+21                                                08399000
IOCRBA   EQU   IOCSTR+40                                                08400000
IOCTTR   EQU   IOCRBA                                                   08401000
IOCMEM   EQU   IOCSTR+44                                                08402000
IOCNWM   EQU   IOCSTR+48                                                08403000
IOCREL   EQU   IOCSTR+60                                                08404000
OPNAGL   EQU   0                                                        08405000
OPNOPT   EQU   OPNAGL                                                   08406000
OPNOPTOT EQU   OPNOPT                                                   08407000
OPNRFM   EQU   OPNAGL+1                                                 08408000
OPNTYP   EQU   OPNAGL+2                                                 08409000
OPNMOD   EQU   OPNAGL+3                                                 08410000
OPNMODAC EQU   OPNMOD                                                   08411000
OPNIOC   EQU   OPNAGL+4                                                 08412000
OPNDDN   EQU   OPNAGL+8                                                 08413000
OPNDEV   EQU   OPNAGL+24                                                08414000
OPNDSO   EQU   OPNAGL+41                                                08415000
OPNOPT2  EQU   OPNAGL+42                                                08416000
IOINFOPT EQU   0                                                        08417000
UVOLLIST EQU   0                                                        08418000
UVOLENT  EQU   UVOLLIST+2                                               08419000
DARGLIST EQU   0                                                        08420000
DARGDBP  EQU   DARGLIST                                                 08421000
DARGRETP EQU   DARGLIST+4                                               08422000
DARGSTID EQU   DARGLIST+8                                               08423000
DARGSMOD EQU   DARGSTID                                                 08424000
DARGSENT EQU   DARGSTID+3                                               08425000
DARGILP  EQU   DARGLIST+12                                              08426000
DARGRETL EQU   DARGLIST+16                                              08427000
DARGFLGS EQU   DARGLIST+19                                              08428000
DARGARY  EQU   DARGLIST+20                                              08429000
DARGINS  EQU   DARGARY                                                  08430000
DARGINL  EQU   DARGARY+2                                                08431000
FMTLIST  EQU   0                                                        08432000
FMTFLGS  EQU   FMTLIST                                                  08433000
FMTSPF   EQU   FMTLIST+2                                                08434000
FMTRFNO  EQU   FMTSPF                                                   08435000
FMTILEN  EQU   FMTRFNO                                                  08436000
FMTIOFF  EQU   FMTLIST+4                                                08437000
FMTTRBC  EQU   FMTIOFF                                                  08438000
FMTSTO   EQU   FMTTRBC                                                  08439000
FMTOCOL  EQU   FMTLIST+6                                                08440000
FMTCNVF  EQU   FMTLIST+10                                               08441000
ERCNVTAB EQU   0                                                        08442000
ERTYPE   EQU   ERCNVTAB                                                 08443000
EROPER   EQU   ERCNVTAB+1                                               08444000
EROSOPER EQU   ERCNVTAB+2                                               08445000
ERCATRC  EQU   ERCNVTAB+16                                              08446000
ERCPLPT  EQU   ERCNVTAB+20                                              08447000
IDCDB010 EQU   0                                                        08448000
DMPITM   EQU   0                                                        08449000
DMPITMNM EQU   DMPITM                                                   08450000
DMPITMPT EQU   DMPITM+8                                                 08451000
DMPITMLN EQU   DMPITM+12                                                08452000
DMPITMTP EQU   DMPITM+14                                                08453000
DMPARY   EQU   0                                                        08454000
DMPTRM   EQU   0                                                        08455000
CAT      EQU   0                                                        08456000
CATNM    EQU   0                                                        08457000
CATNMPLN EQU   CATNM                                                    08458000
CATNMPAS EQU   CATNM+1                                                  08459000
CATNMFLG EQU   CATNM+10                                                 08460000
CATNMVAL EQU   CATNM+21                                                 08461000
CATDD    EQU   0                                                        08462000
OUTDD    EQU   0                                                        08463000
OUTDDVAL EQU   OUTDD+1                                                  08464000
ENT      EQU   0                                                        08465000
ENTCNT   EQU   ENT                                                      08466000
@NM00035 EQU   ENT+2                                                    08467000
ENTPLN   EQU   @NM00035                                                 08468000
ENTPAS   EQU   @NM00035+1                                               08469000
ENTPOS   EQU   @NM00035+9                                               08470000
ENTFLG   EQU   @NM00035+10                                              08471000
ENTFUQ   EQU   ENTFLG                                                   08472000
ENTLEN   EQU   @NM00035+20                                              08473000
ENTVAL   EQU   @NM00035+21                                              08474000
LVL      EQU   0                                                        08475000
LVLPOS   EQU   LVL+9                                                    08476000
LVLFLG   EQU   LVL+10                                                   08477000
LVLLEN   EQU   LVL+20                                                   08478000
LVLVAL   EQU   LVL+21                                                   08479000
CLUST    EQU   0                                                        08480000
DATUM    EQU   0                                                        08481000
INDEX    EQU   0                                                        08482000
SPACE    EQU   0                                                        08483000
ALIEN    EQU   0                                                        08484000
UCAT     EQU   0                                                        08485000
ALIAS    EQU   0                                                        08486000
GDG      EQU   0                                                        08487000
PGSPC    EQU   0                                                        08488000
AIX      EQU   0                                                        08489000
PATH     EQU   0                                                        08490000
NUSE     EQU   0                                                        08491000
CREAT    EQU   0                                                        08492000
CREATVAL EQU   CREAT                                                    08493000
EXPIR    EQU   0                                                        08494000
EXPIRVAL EQU   EXPIR                                                    08495000
HIST     EQU   0                                                        08496000
NAME     EQU   0                                                        08497000
FALL     EQU   0                                                        08498000
VOL      EQU   0                                                        08499000
ALLOC    EQU   0                                                        08500000
IDAAMDSB EQU   0                                                        08501000
AMDATTR  EQU   IDAAMDSB+1                                               08502000
AMDNEST  EQU   IDAAMDSB+4                                               08503000
AMDHLRBA EQU   IDAAMDSB+28                                              08504000
AMDSSRBA EQU   IDAAMDSB+32                                              08505000
AMDATTR3 EQU   IDAAMDSB+40                                              08506000
AMDSTAT  EQU   IDAAMDSB+48                                              08507000
CTGPL    EQU   0                                                        08508000
CTGOPTN1 EQU   CTGPL                                                    08509000
CTGNAME  EQU   CTGOPTN1                                                 08510000
CTGCNAME EQU   CTGOPTN1                                                 08511000
CTGOPTN2 EQU   CTGPL+1                                                  08512000
CTGEXT   EQU   CTGOPTN2                                                 08513000
CTGERASE EQU   CTGOPTN2                                                 08514000
CTGSMF   EQU   CTGERASE                                                 08515000
CTGREL   EQU   CTGSMF                                                   08516000
CTGGTALL EQU   CTGREL                                                   08517000
CTGPURG  EQU   CTGOPTN2                                                 08518000
CTGVMNT  EQU   CTGPURG                                                  08519000
CTGRCATN EQU   CTGVMNT                                                  08520000
CTGGTNXT EQU   CTGOPTN2                                                 08521000
CTGOPTN3 EQU   CTGPL+2                                                  08522000
CTGFUNC  EQU   CTGOPTN3                                                 08523000
CTGAM0   EQU   CTGOPTN3                                                 08524000
CTGOPTN4 EQU   CTGPL+3                                                  08525000
CTGENT   EQU   CTGPL+4                                                  08526000
CTGCAT   EQU   CTGPL+8                                                  08527000
CTGWKA   EQU   CTGPL+12                                                 08528000
CTGDSORG EQU   CTGPL+16                                                 08529000
CTGOPTNS EQU   CTGDSORG                                                 08530000
CTGTYPE  EQU   CTGPL+18                                                 08531000
CTGNOFLD EQU   CTGPL+19                                                 08532000
CTGDDNM  EQU   CTGPL+20                                                 08533000
CTGNEWNM EQU   CTGDDNM                                                  08534000
CTGFBFLG EQU   CTGNEWNM+2                                               08535000
CTGJSCB  EQU   CTGPL+24                                                 08536000
CTGPSWD  EQU   CTGJSCB                                                  08537000
CTGFIELD EQU   CTGPL+28                                                 08538000
CTGFL    EQU   0                                                        08539000
CTGFLDNO EQU   CTGFL                                                    08540000
CTGFLDRE EQU   CTGFL+3                                                  08541000
CTGFLDNM EQU   CTGFL+8                                                  08542000
CTGFLDAT EQU   CTGFL+16                                                 08543000
CTGFLNG  EQU   CTGFLDAT                                                 08544000
CTGFLPT  EQU   CTGFLDAT+4                                               08545000
ASSOC    EQU   0                                                        08546000
KIND     EQU   ASSOC                                                    08547000
CI#      EQU   ASSOC+1                                                  08548000
DSCHARS  EQU   0                                                        08549000
ATTR#1   EQU   DSCHARS                                                  08550000
ATTR#2   EQU   DSCHARS+1                                                08551000
DSNUSE   EQU   ATTR#2                                                   08552000
PGSPAC   EQU   0                                                        08553000
PGSP     EQU   PGSPAC                                                   08554000
ETYP     EQU   0                                                        08555000
ENT44    EQU   0                                                        08556000
CRDT     EQU   0                                                        08557000
EXDT     EQU   0                                                        08558000
VDSPHDR  EQU   0                                                        08559000
VDSCBTIM EQU   VDSPHDR+2                                                08560000
VDSPFLG  EQU   VDSPHDR+15                                               08561000
@NM00047 EQU   VDSPHDR+19                                               08562000
VTIME    EQU   0                                                        08563000
COMAREA  EQU   0                                                        08564000
COMSWKPT EQU   COMAREA                                                  08565000
COMFPLPT EQU   COMAREA+4                                                08566000
COMFLGPT EQU   COMAREA+8                                                08567000
COMVARPT EQU   COMAREA+12                                               08568000
COMTOTPT EQU   COMAREA+16                                               08569000
SAVWKPTR EQU   0                                                        08570000
CTGPLPTR EQU   SAVWKPTR+4                                               08571000
TYPCPLPT EQU   SAVWKPTR+8                                               08572000
SAVCPLPT EQU   SAVWKPTR+12                                              08573000
OLDCPLPT EQU   SAVWKPTR+16                                              08574000
ERMCPLPT EQU   SAVWKPTR+20                                              08575000
LCCPLLEN EQU   SAVWKPTR+24                                              08576000
CI#CPLPT EQU   SAVWKPTR+28                                              08577000
SA#CPLPT EQU   SAVWKPTR+32                                              08578000
ER#CPLPT EQU   SAVWKPTR+36                                              08579000
LC#CPLLN EQU   SAVWKPTR+40                                              08580000
LCFPLLEN EQU   SAVWKPTR+42                                              08581000
MTFPLLEN EQU   SAVWKPTR+43                                              08582000
CTGFLPTR EQU   SAVWKPTR+44                                              08583000
SAVFPLPT EQU   SAVWKPTR+48                                              08584000
CILSTLEN EQU   SAVWKPTR+52                                              08585000
CILSTPTR EQU   SAVWKPTR+56                                              08586000
CIASOCLN EQU   SAVWKPTR+60                                              08587000
CIASOCPT EQU   SAVWKPTR+64                                              08588000
ERRARGPT EQU   SAVWKPTR+72                                              08589000
DARGPTR  EQU   SAVWKPTR+76                                              08590000
OTIOCSPT EQU   SAVWKPTR+80                                              08591000
OBJNMPTR EQU   SAVWKPTR+84                                              08592000
ENTWKAPT EQU   SAVWKPTR+88                                              08593000
DPLISTPT EQU   SAVWKPTR+92                                              08594000
TEXTPTR  EQU   SAVWKPTR+96                                              08595000
VHDRPTR  EQU   SAVWKPTR+100                                             08596000
CORRFPLS EQU   0                                                        08597000
FIRSTFPL EQU   CORRFPLS                                                 08598000
MULTIFPT EQU   FIRSTFPL                                                 08599000
SUBSETS  EQU   CORRFPLS+4                                               08600000
ETYPFPT  EQU   SUBSETS                                                  08601000
ENT44FPT EQU   SUBSETS+4                                                08602000
CATTRFPT EQU   SUBSETS+8                                                08603000
ASSOCFPT EQU   SUBSETS+12                                               08604000
EXDTFPT  EQU   SUBSETS+16                                               08605000
CRDTFPT  EQU   SUBSETS+20                                               08606000
AUVOLFPT EQU   SUBSETS+32                                               08607000
DSSPFPT  EQU   SUBSETS+40                                               08608000
VTIMEFPT EQU   SUBSETS+60                                               08609000
VHDRFPT  EQU   SUBSETS+76                                               08610000
ATTRFPT  EQU   SUBSETS+96                                               08611000
LASTFPT  EQU   CORRFPLS+132                                             08612000
FLAGS    EQU   0                                                        08613000
CACBFLG  EQU   FLAGS                                                    08614000
CLENTFLG EQU   FLAGS+1                                                  08615000
ENTNMFLG EQU   FLAGS+2                                                  08616000
LISTCFLG EQU   FLAGS+3                                                  08617000
NOMSGFLG EQU   FLAGS+4                                                  08618000
CMDERRSW EQU   FLAGS+5                                                  08619000
SUBTFLG  EQU   FLAGS+6                                                  08620000
NOTTLFLG EQU   FLAGS+7                                                  08621000
ATYPFLG  EQU   FLAGS+8                                                  08622000
BTYPFLG  EQU   FLAGS+9                                                  08623000
DTYPFLG  EQU   FLAGS+10                                                 08624000
ITYPFLG  EQU   FLAGS+11                                                 08625000
NDENTFLG EQU   FLAGS+12                                                 08626000
ENLVUDFG EQU   FLAGS+13                                                 08627000
PGSPCFLG EQU   FLAGS+14                                                 08628000
ENTCLFLG EQU   FLAGS+16                                                 08629000
NUSEFLG  EQU   FLAGS+18                                                 08630000
GTYPFLG  EQU   FLAGS+19                                                 08631000
RTYPFLG  EQU   FLAGS+20                                                 08632000
ATFPLFLG EQU   FLAGS+21                                                 08633000
DATEFLG  EQU   FLAGS+23                                                 08634000
CRDTSW   EQU   FLAGS+24                                                 08635000
EXDTSW   EQU   FLAGS+25                                                 08636000
VTYPFLG  EQU   FLAGS+26                                                 08637000
VTFPLFLG EQU   FLAGS+27                                                 08638000
EXFPLFLG EQU   FLAGS+28                                                 08639000
CRFPLFLG EQU   FLAGS+29                                                 08640000
CTYPFLG  EQU   FLAGS+30                                                 08641000
PTYPFLG  EQU   FLAGS+31                                                 08642000
NOGENFLG EQU   FLAGS+32                                                 08643000
CILOCFLG EQU   FLAGS+33                                                 08644000
MISCVAR  EQU   0                                                        08645000
FPLBEGN  EQU   MISCVAR                                                  08646000
FPLEND   EQU   MISCVAR+2                                                08647000
FPLCNT   EQU   MISCVAR+4                                                08648000
CATRC    EQU   MISCVAR+6                                                08649000
ASSOC#   EQU   MISCVAR+8                                                08650000
NLST     EQU   MISCVAR+10                                               08651000
SAVRC    EQU   MISCVAR+12                                               08652000
CATNAME  EQU   MISCVAR+14                                               08653000
TYPMULTI EQU   MISCVAR+58                                               08654000
TYPECNT  EQU   TYPMULTI                                                 08655000
TYPELIST EQU   TYPMULTI+2                                               08656000
HOLDETYP EQU   MISCVAR+71                                               08657000
TYPAUDIT EQU   0                                                        08658000
CTYPCNT  EQU   TYPAUDIT                                                 08659000
DTYPCNT  EQU   TYPAUDIT+4                                               08660000
ITYPCNT  EQU   TYPAUDIT+8                                               08661000
ATYPCNT  EQU   TYPAUDIT+12                                              08662000
UTYPCNT  EQU   TYPAUDIT+16                                              08663000
VTYPCNT  EQU   TYPAUDIT+20                                              08664000
XTYPCNT  EQU   TYPAUDIT+24                                              08665000
BTYPCNT  EQU   TYPAUDIT+28                                              08666000
PTYPCNT  EQU   TYPAUDIT+32                                              08667000
GTYPCNT  EQU   TYPAUDIT+36                                              08668000
RTYPCNT  EQU   TYPAUDIT+40                                              08669000
TOTLCNT  EQU   TYPAUDIT+44                                              08670000
LCTEXT   EQU   0                                                        08671000
OBJOVR   EQU   0                                                        08672000
OBJCNT   EQU   OBJOVR                                                   08673000
@NM00049 EQU   OBJOVR+4                                                 08674000
OBJTYP   EQU   @NM00049                                                 08675000
OBJNM    EQU   @NM00049+1                                               08676000
CPLWKA   EQU   0                                                        08677000
CPLWKASZ EQU   CPLWKA                                                   08678000
ENT44WKA EQU   0                                                        08679000
ENTSETSZ EQU   ENT44WKA                                                 08680000
SUPPWKA  EQU   0                                                        08681000
SUPPTYPE EQU   SUPPWKA+4                                                08682000
SUPPDSNM EQU   SUPPWKA+5                                                08683000
SAVFPL   EQU   0                                                        08684000
AMSTP011 EQU   0                                                        08685000
AMSTP041 EQU   0                                                        08686000
AMSTP042 EQU   0                                                        08687000
AMSTP043 EQU   0                                                        08688000
AMSTP044 EQU   0                                                        08689000
IDCIOCO0 EQU   0                                                        08690000
IDCIOGT0 EQU   0                                                        08691000
IDCIOIT0 EQU   0                                                        08692000
IDCIOPO0 EQU   0                                                        08693000
IDCIOPT0 EQU   0                                                        08694000
IDCIOSI0 EQU   0                                                        08695000
IDCIOST0 EQU   0                                                        08696000
IDCIOTM0 EQU   0                                                        08697000
IDCIOVY0 EQU   0                                                        08698000
IDCIO050 EQU   0                                                        08699000
IDCSAAL0 EQU   0                                                        08700000
IDCSACA0 EQU   0                                                        08701000
IDCSACL0 EQU   0                                                        08702000
IDCSADE0 EQU   0                                                        08703000
IDCSADL0 EQU   0                                                        08704000
IDCSADQ0 EQU   0                                                        08705000
IDCSAFS0 EQU   0                                                        08706000
IDCSAGS0 EQU   0                                                        08707000
IDCSALC0 EQU   0                                                        08708000
IDCSALD0 EQU   0                                                        08709000
IDCSALK0 EQU   0                                                        08710000
IDCSANQ0 EQU   0                                                        08711000
IDCSAPR0 EQU   0                                                        08712000
IDCSAPT0 EQU   0                                                        08713000
IDCSARC0 EQU   0                                                        08714000
IDCSARV0 EQU   0                                                        08715000
IDCSASC0 EQU   0                                                        08716000
IDCSASI0 EQU   0                                                        08717000
IDCSASN0 EQU   0                                                        08718000
IDCSASS0 EQU   0                                                        08719000
IDCSAST0 EQU   0                                                        08720000
IDCSAUC0 EQU   0                                                        08721000
IDCSAWO0 EQU   0                                                        08722000
IDCSA060 EQU   0                                                        08723000
IDCST010 EQU   0                                                        08724000
IDCTPER0 EQU   0                                                        08725000
LISTTEST EQU   0                                                        08726000
NEWERID1 EQU   5                                                        08727000
GDTTBL   EQU   0                                                        08728000
GDTTR1   EQU   GDTTBL+8                                                 08729000
GDTTR2   EQU   GDTTBL+12                                                08730000
GDTDBG   EQU   GDTTBL+40                                                08731000
GDTSTC   EQU   GDTTBL+44                                                08732000
GDTPRT   EQU   GDTTBL+48                                                08733000
GDTESS   EQU   GDTTBL+52                                                08734000
GDTESA   EQU   GDTTBL+56                                                08735000
GDTRST   EQU   GDTTBL+60                                                08736000
GDTRES   EQU   GDTTBL+64                                                08737000
GDTCAL   EQU   GDTTBL+68                                                08738000
GDTGSP   EQU   GDTTBL+72                                                08739000
GDTFSP   EQU   GDTTBL+76                                                08740000
GDTGPL   EQU   GDTTBL+80                                                08741000
GDTFPL   EQU   GDTTBL+84                                                08742000
GDTLOD   EQU   GDTTBL+88                                                08743000
GDTDEL   EQU   GDTTBL+92                                                08744000
GDTPRL   EQU   GDTTBL+96                                                08745000
GDTEPL   EQU   GDTTBL+100                                               08746000
GDTTIM   EQU   GDTTBL+104                                               08747000
GDTIIO   EQU   GDTTBL+108                                               08748000
GDTTIO   EQU   GDTTBL+112                                               08749000
GDTOPN   EQU   GDTTBL+124                                               08750000
GDTCLS   EQU   GDTTBL+128                                               08751000
GDTGET   EQU   GDTTBL+132                                               08752000
GDTPUT   EQU   GDTTBL+136                                               08753000
GDTPOS   EQU   GDTTBL+140                                               08754000
GDTCPY   EQU   GDTTBL+144                                               08755000
GDTCAT   EQU   GDTTBL+148                                               08756000
GDTSNP   EQU   GDTTBL+164                                               08757000
GDTVFY   EQU   GDTTBL+172                                               08758000
GDTECT   EQU   GDTTBL+188                                               08759000
GDTUID   EQU   GDTTBL+192                                               08760000
GDTPMT   EQU   GDTTBL+196                                               08761000
GDTCIR   EQU   GDTTBL+200                                               08762000
GDTLNK   EQU   GDTTBL+204                                               08763000
GDTALC   EQU   GDTTBL+208                                               08764000
GDTDLC   EQU   GDTTBL+212                                               08765000
GDTQAL   EQU   GDTTBL+216                                               08766000
GDTSTW   EQU   GDTTBL+220                                               08767000
GDTSSC   EQU   GDTTBL+224                                               08768000
GDTENQ   EQU   GDTTBL+228                                               08769000
GDTRSV   EQU   GDTTBL+232                                               08770000
GDTDEQ   EQU   GDTTBL+236                                               08771000
GDTSFO   EQU   GDTTBL+240                                               08772000
GDTWTO   EQU   GDTTBL+244                                               08773000
GDTSCR   EQU   GDTTBL+248                                               08774000
GDTUNT   EQU   GDTTBL+252                                               08775000
GDTRCT   EQU   GDTTBL+256                                               08776000
GDTIFO   EQU   GDTTBL+260                                               08777000
GDTEXP   EQU   GDTTBL+264                                               08778000
GDTSTA   EQU   GDTTBL+268                                               08779000
GDTERR   EQU   GDTTBL+272                                               08780000
GDTUNC   EQU   GDTTBL+276                                               08781000
GDTLOC   EQU   GDTTBL+280                                               08782000
FDTTBL   EQU   0                                                        08783000
FDTPTR   EQU   FDTTBL+8                                                 08784000
LASTCC   EQU   0                                                        08785000
CLENTSW  EQU   0                                                        08786000
@NM00042 EQU   CTGDDNM                                                  08787000
CTGPROB  EQU   @NM00042                                                 08788000
CTGREASN EQU   CTGPROB+2                                                08789000
FPLPTMAP EQU   CORRFPLS                                                 08790000
NMFLDS   EQU   CORRFPLS                                                 08791000
HISTFLDS EQU   CORRFPLS                                                 08792000
VOLFLDS  EQU   CORRFPLS                                                 08793000
SPACFLDS EQU   CORRFPLS                                                 08794000
ALLFLDS  EQU   CORRFPLS                                                 08795000
ENTKEY   EQU   ENTNAME+43                                               08796000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08797000
CTGREAS2 EQU   CTGREASN+1                                               08798000
CTGREAS1 EQU   CTGREASN                                                 08799000
CTGMODID EQU   CTGPROB                                                  08800000
FDTVERB  EQU   FDTTBL                                                   08801000
GDTPSB   EQU   GDTTBL+184                                               08802000
GDTUPT   EQU   GDTTBL+180                                               08803000
GDTCMB   EQU   GDTTBL+176                                               08804000
GDTSPR   EQU   GDTTBL+168                                               08805000
@NM00004 EQU   GDTTBL+160                                               08806000
GDTABH   EQU   GDTTBL+156                                               08807000
GDTABT   EQU   GDTTBL+152                                               08808000
GDTTOH   EQU   GDTTBL+120                                               08809000
GDTRIP   EQU   GDTTBL+116                                               08810000
GDTIOH   EQU   GDTTBL+36                                                08811000
GDTSAH   EQU   GDTTBL+32                                                08812000
GDTTPH   EQU   GDTTBL+28                                                08813000
GDTRIH   EQU   GDTTBL+24                                                08814000
GDTSTH   EQU   GDTTBL+20                                                08815000
GDTDBH   EQU   GDTTBL+16                                                08816000
GDTPRM   EQU   GDTTBL+4                                                 08817000
GDTHDR   EQU   GDTTBL                                                   08818000
@NM00053 EQU   SUPPWKA                                                  08819000
@NM00052 EQU   ENT44WKA+4                                               08820000
ENTREQSZ EQU   ENT44WKA+2                                               08821000
@NM00051 EQU   CPLWKA+4                                                 08822000
REQWKASZ EQU   CPLWKA+2                                                 08823000
NONM     EQU   LCTEXT+700                                               08824000
YESNM    EQU   LCTEXT+690                                               08825000
NSWAPNM  EQU   LCTEXT+680                                               08826000
SWAPNM   EQU   LCTEXT+670                                               08827000
DSTGWNM  EQU   LCTEXT+660                                               08828000
BINDNM   EQU   LCTEXT+650                                               08829000
CYLFNM   EQU   LCTEXT+640                                               08830000
NUSNM    EQU   LCTEXT+630                                               08831000
RVBLNM   EQU   LCTEXT+620                                               08832000
NUNQKNM  EQU   LCTEXT+610                                               08833000
UNQKNM   EQU   LCTEXT+600                                               08834000
NUPDNM   EQU   LCTEXT+590                                               08835000
UPDNM    EQU   LCTEXT+580                                               08836000
NUPGNM   EQU   LCTEXT+570                                               08837000
UPGNM    EQU   LCTEXT+560                                               08838000
AIXNM    EQU   LCTEXT+550                                               08839000
NSPNDNM  EQU   LCTEXT+540                                               08840000
SPNDNM   EQU   LCTEXT+530                                               08841000
PATHNM   EQU   LCTEXT+520                                               08842000
NRUSNM   EQU   LCTEXT+510                                               08843000
RUSNM    EQU   LCTEXT+500                                               08844000
NUMDNM   EQU   LCTEXT+490                                               08845000
PGSPCNM  EQU   LCTEXT+480                                               08846000
ALIASNM  EQU   LCTEXT+470                                               08847000
GDGNM    EQU   LCTEXT+460                                               08848000
NVSAMNM  EQU   LCTEXT+450                                               08849000
NEMPTYNM EQU   LCTEXT+440                                               08850000
EMPTYNM  EQU   LCTEXT+430                                               08851000
NSCRNM   EQU   LCTEXT+420                                               08852000
SCRNM    EQU   LCTEXT+410                                               08853000
NTOVFLNM EQU   LCTEXT+400                                               08854000
TOVFLNM  EQU   LCTEXT+390                                               08855000
SHR4NM   EQU   LCTEXT+380                                               08856000
SHR3NM   EQU   LCTEXT+370                                               08857000
SHR2NM   EQU   LCTEXT+360                                               08858000
SHR1NM   EQU   LCTEXT+350                                               08859000
SHRPRNM  EQU   LCTEXT+340                                               08860000
SHRNM    EQU   LCTEXT+330                                               08861000
MCATNM   EQU   LCTEXT+320                                               08862000
UCATNM   EQU   LCTEXT+310                                               08863000
TEMEXPNM EQU   LCTEXT+300                                               08864000
INHUPDNM EQU   LCTEXT+290                                               08865000
NULLNM   EQU   LCTEXT+280                                               08866000
SUPPNM   EQU   LCTEXT+270                                               08867000
CYLNM    EQU   LCTEXT+260                                               08868000
TRKNM    EQU   LCTEXT+250                                               08869000
RECSZNM  EQU   LCTEXT+240                                               08870000
UNORDNM  EQU   LCTEXT+230                                               08871000
ORDNM    EQU   LCTEXT+220                                               08872000
NREPLNM  EQU   LCTEXT+210                                               08873000
REPLNM   EQU   LCTEXT+200                                               08874000
NIMBDNM  EQU   LCTEXT+190                                               08875000
IMBDNM   EQU   LCTEXT+180                                               08876000
NWCKNM   EQU   LCTEXT+170                                               08877000
WCKNM    EQU   LCTEXT+160                                               08878000
NIXDNM   EQU   LCTEXT+150                                               08879000
IXDNM    EQU   LCTEXT+140                                               08880000
NERASNM  EQU   LCTEXT+130                                               08881000
ERASNM   EQU   LCTEXT+120                                               08882000
SUBALNM  EQU   LCTEXT+110                                               08883000
UNQNM    EQU   LCTEXT+100                                               08884000
RCVYNM   EQU   LCTEXT+90                                                08885000
SPEEDNM  EQU   LCTEXT+80                                                08886000
CLNM     EQU   LCTEXT+70                                                08887000
INDEXNM  EQU   LCTEXT+60                                                08888000
DATANM   EQU   LCTEXT+50                                                08889000
EXPLNM   EQU   LCTEXT+40                                                08890000
AUTONM   EQU   LCTEXT+30                                                08891000
OVFLONM  EQU   LCTEXT+20                                                08892000
CANNM    EQU   LCTEXT+10                                                08893000
PRIMENM  EQU   LCTEXT                                                   08894000
GASSOCSW EQU   FLAGS+22                                                 08895000
G0V0FLG  EQU   FLAGS+17                                                 08896000
DENTAFLG EQU   FLAGS+15                                                 08897000
CACBFPT5 EQU   LASTFPT                                                  08898000
RACFPT   EQU   SUBSETS+124                                              08899000
EXITFPT  EQU   SUBSETS+120                                              08900000
RGATRFPT EQU   SUBSETS+116                                              08901000
GDGLMFPT EQU   SUBSETS+112                                              08902000
GDGATFPT EQU   SUBSETS+108                                              08903000
RECLFPT  EQU   SUBSETS+104                                              08904000
BUFFFPT  EQU   SUBSETS+100                                              08905000
DSBFPT   EQU   SUBSETS+92                                               08906000
SECURFPT EQU   SUBSETS+88                                               08907000
VXDESFPT EQU   SUBSETS+84                                               08908000
VDIRFPT  EQU   SUBSETS+80                                               08909000
V#DSFPT  EQU   SUBSETS+72                                               08910000
V#DSPFPT EQU   SUBSETS+68                                               08911000
VSYSXFPT EQU   SUBSETS+64                                               08912000
CACBFPT4 EQU   VTIMEFPT                                                 08913000
PGBYTFPT EQU   SUBSETS+56                                               08914000
DSVLFPT  EQU   SUBSETS+52                                               08915000
DSHAFPT  EQU   SUBSETS+48                                               08916000
DSHUFPT  EQU   SUBSETS+44                                               08917000
CACBFPT3 EQU   DSSPFPT                                                  08918000
VCHARFPT EQU   SUBSETS+36                                               08919000
CACBFPT2 EQU   AUVOLFPT                                                 08920000
RELFPT   EQU   SUBSETS+28                                               08921000
DSIDFPT  EQU   SUBSETS+24                                               08922000
CACBFPT1 EQU   EXDTFPT                                                  08923000
ERRCPLPT EQU   SAVWKPTR+68                                              08924000
DSBCATPT EQU   SAVWKPTR                                                 08925000
VDSPSCON EQU   VDSPHDR+20                                               08926000
@NM00048 EQU   @NM00047                                                 08927000
VDSPOPT  EQU   @NM00047                                                 08928000
VDSPXT   EQU   VDSPHDR+18                                               08929000
VDSPDS#  EQU   VDSPHDR+16                                               08930000
@NM00046 EQU   VDSPFLG                                                  08931000
VDSPMCAT EQU   VDSPFLG                                                  08932000
VDSPUCAT EQU   VDSPFLG                                                  08933000
VDSPAUTO EQU   VDSPFLG                                                  08934000
VDSPUNQ  EQU   VDSPFLG                                                  08935000
VDSCBPTR EQU   VDSPHDR+10                                               08936000
VHDRREPN EQU   VDSPHDR                                                  08937000
PGSWAP   EQU   PGSPAC                                                   08938000
@NM00045 EQU   PGSPAC                                                   08939000
@NM00044 EQU   ATTR#2                                                   08940000
INTERSHR EQU   ATTR#2                                                   08941000
INTRASHR EQU   ATTR#2                                                   08942000
DSTKOV   EQU   ATTR#1                                                   08943000
DSTEXP   EQU   ATTR#1                                                   08944000
DSINH    EQU   ATTR#1                                                   08945000
DSRCVR   EQU   ATTR#1                                                   08946000
DSERAS   EQU   ATTR#1                                                   08947000
DSREUSE  EQU   ATTR#1                                                   08948000
DSUNQ    EQU   ATTR#1                                                   08949000
DSSPEED  EQU   ATTR#1                                                   08950000
CTGFLCHN EQU   CTGFL+12                                                 08951000
CTGFLDWA EQU   CTGFL+4                                                  08952000
CTGFLDTS EQU   CTGFLDRE                                                 08953000
@NM00043 EQU   CTGFLDRE                                                 08954000
CTGFLDGC EQU   CTGFL+2                                                  08955000
CTGFLDCD EQU   CTGFL+1                                                  08956000
@NM00041 EQU   CTGFBFLG                                                 08957000
CTGNGDSN EQU   CTGFBFLG                                                 08958000
CTGGDGB  EQU   CTGFBFLG                                                 08959000
CTGKEEP  EQU   CTGFBFLG                                                 08960000
CTGPAR   EQU   CTGFBFLG                                                 08961000
CTGFDBK  EQU   CTGNEWNM                                                 08962000
@NM00040 EQU   CTGDSORG                                                 08963000
CTGCVOL  EQU   CTGCAT                                                   08964000
CTGFVT   EQU   CTGENT                                                   08965000
@NM00039 EQU   CTGOPTN4                                                 08966000
CTGTIOT  EQU   CTGOPTN4                                                 08967000
CTGBYPMT EQU   CTGOPTN4                                                 08968000
CTGCOIN  EQU   CTGOPTN4                                                 08969000
CTGNPROF EQU   CTGOPTN4                                                 08970000
CTGDOCAT EQU   CTGOPTN4                                                 08971000
CTGLBASE EQU   CTGOPTN4                                                 08972000
CTGNUM   EQU   CTGOPTN3                                                 08973000
CTGSRH   EQU   CTGOPTN3                                                 08974000
CTGGDGL  EQU   CTGOPTN3                                                 08975000
CTGSUPLT EQU   CTGOPTN3                                                 08976000
@NM00038 EQU   CTGOPTN2                                                 08977000
CTGSCR   EQU   CTGOPTN2                                                 08978000
CTGOVRID EQU   CTGOPTN2                                                 08979000
CTGDISC  EQU   CTGOPTN2                                                 08980000
CTGSWAP  EQU   CTGRCATN                                                 08981000
CTGNSVS  EQU   CTGEXT                                                   08982000
CTGGENLD EQU   CTGOPTN1                                                 08983000
CTGREAD  EQU   CTGOPTN1                                                 08984000
CTGUPD   EQU   CTGOPTN1                                                 08985000
CTGCI    EQU   CTGOPTN1                                                 08986000
CTGMAST  EQU   CTGOPTN1                                                 08987000
CTGBYPSS EQU   CTGOPTN1                                                 08988000
AMDEXCP  EQU   AMDSTAT+44                                               08989000
AMDNCAS  EQU   AMDSTAT+40                                               08990000
AMDNCIS  EQU   AMDSTAT+36                                               08991000
AMDASPA  EQU   AMDSTAT+32                                               08992000
AMDRETR  EQU   AMDSTAT+28                                               08993000
AMDUPR   EQU   AMDSTAT+24                                               08994000
AMDIREC  EQU   AMDSTAT+20                                               08995000
AMDDELR  EQU   AMDSTAT+16                                               08996000
AMDNLR   EQU   AMDSTAT+12                                               08997000
AMDNEXT  EQU   AMDSTAT+10                                               08998000
AMDNIL   EQU   AMDSTAT+8                                                08999000
AMDSTSP  EQU   AMDSTAT                                                  09000000
@NM00037 EQU   IDAAMDSB+41                                              09001000
@NM00036 EQU   AMDATTR3                                                 09002000
AMDLM    EQU   AMDATTR3                                                 09003000
AMDWAIT  EQU   AMDATTR3                                                 09004000
AMDBIND  EQU   AMDATTR3                                                 09005000
AMDFAULT EQU   AMDATTR3                                                 09006000
AMDUNQ   EQU   AMDATTR3                                                 09007000
AMDPARDB EQU   IDAAMDSB+36                                              09008000
AMDMAXRR EQU   AMDSSRBA                                                 09009000
AMDNSLOT EQU   AMDHLRBA                                                 09010000
AMDLRECL EQU   IDAAMDSB+24                                              09011000
AMDCINV  EQU   IDAAMDSB+20                                              09012000
AMDFSCI  EQU   IDAAMDSB+16                                              09013000
AMDFSCA  EQU   IDAAMDSB+14                                              09014000
AMDCIPCA EQU   IDAAMDSB+12                                              09015000
AMDPCTCI EQU   IDAAMDSB+11                                              09016000
AMDPCTCA EQU   IDAAMDSB+10                                              09017000
AMDKEYLN EQU   IDAAMDSB+8                                               09018000
AMDRKP   EQU   IDAAMDSB+6                                               09019000
AMDAXRKP EQU   AMDNEST                                                  09020000
AMDLEN   EQU   IDAAMDSB+2                                               09021000
AMDSPAN  EQU   AMDATTR                                                  09022000
AMDRRDS  EQU   AMDATTR                                                  09023000
AMDRANGE EQU   AMDATTR                                                  09024000
AMDORDER EQU   AMDATTR                                                  09025000
AMDREPL  EQU   AMDATTR                                                  09026000
AMDSDT   EQU   AMDATTR                                                  09027000
AMDWCK   EQU   AMDATTR                                                  09028000
AMDDST   EQU   AMDATTR                                                  09029000
AMDSBID  EQU   IDAAMDSB                                                 09030000
LVLMEM   EQU   LVL+12                                                   09031000
LVLMLN   EQU   LVL+11                                                   09032000
LVLFUQ   EQU   LVLFLG                                                   09033000
LVLPAS   EQU   LVL+1                                                    09034000
LVLPLN   EQU   LVL                                                      09035000
ENTMEM   EQU   @NM00035+12                                              09036000
ENTMLN   EQU   @NM00035+11                                              09037000
OUTDDLEN EQU   OUTDD                                                    09038000
CATDDVAL EQU   CATDD+1                                                  09039000
CATDDLEN EQU   CATDD                                                    09040000
CATNMLEN EQU   CATNM+20                                                 09041000
CATNMMEM EQU   CATNM+12                                                 09042000
CATNMMLN EQU   CATNM+11                                                 09043000
CATNMFUQ EQU   CATNMFLG                                                 09044000
CATNMPOS EQU   CATNM+9                                                  09045000
@NM00034 EQU   DMPARY+15                                                09046000
DMPARYTP EQU   DMPARY+14                                                09047000
DMPARYEX EQU   DMPARY+12                                                09048000
DMPARYIC EQU   DMPARY+10                                                09049000
DMPARYSZ EQU   DMPARY+8                                                 09050000
DMPARYNM EQU   DMPARY                                                   09051000
@NM00033 EQU   DMPITM+15                                                09052000
@NM00032 EQU   ERCNVTAB+24                                              09053000
ERDARBPT EQU   ERCPLPT                                                  09054000
ERDYNRC  EQU   ERCATRC                                                  09055000
ERDSNM   EQU   ERCNVTAB+12                                              09056000
@NM00031 EQU   ERCNVTAB+4                                               09057000
@NM00030 EQU   ERCNVTAB+3                                               09058000
@NM00029 EQU   EROSOPER                                                 09059000
EROSUCDX EQU   EROSOPER                                                 09060000
EROSCATL EQU   EROSOPER                                                 09061000
@NM00028 EQU   EROPER                                                   09062000
ERCATAL  EQU   EROPER                                                   09063000
ERCATDL  EQU   EROPER                                                   09064000
ERCATDE  EQU   EROPER                                                   09065000
ERCATLC  EQU   EROPER                                                   09066000
@NM00027 EQU   ERTYPE                                                   09067000
ERDYNAL  EQU   ERTYPE                                                   09068000
EROSCAT  EQU   ERTYPE                                                   09069000
ERCATLG  EQU   ERTYPE                                                   09070000
@NM00026 EQU   FMTCNVF+1                                                09071000
FMTAR    EQU   FMTCNVF+1                                                09072000
FMTBS    EQU   FMTCNVF+1                                                09073000
FMTSS    EQU   FMTCNVF+1                                                09074000
FMTAL    EQU   FMTCNVF+1                                                09075000
FMTZS    EQU   FMTCNVF+1                                                09076000
@NM00025 EQU   FMTCNVF                                                  09077000
FMTPU    EQU   FMTCNVF                                                  09078000
FMTBD    EQU   FMTCNVF                                                  09079000
FMTBHD   EQU   FMTCNVF                                                  09080000
FMTBHA   EQU   FMTCNVF                                                  09081000
FMTBH    EQU   FMTCNVF                                                  09082000
FMTOLEN  EQU   FMTLIST+8                                                09083000
FMTRIO   EQU   FMTOCOL                                                  09084000
FMTSPT   EQU   FMTSTO                                                   09085000
FMTSTL   EQU   FMTILEN                                                  09086000
@NM00024 EQU   FMTFLGS+1                                                09087000
FMTSMSG  EQU   FMTFLGS+1                                                09088000
FMTHDF   EQU   FMTFLGS                                                  09089000
FMTDFF   EQU   FMTFLGS                                                  09090000
FMTSTF   EQU   FMTFLGS                                                  09091000
FMTREPF  EQU   FMTFLGS                                                  09092000
FMTBDF   EQU   FMTFLGS                                                  09093000
FMTIDF   EQU   FMTFLGS                                                  09094000
FMTSCF   EQU   FMTFLGS                                                  09095000
FMTEOLF  EQU   FMTFLGS                                                  09096000
DARGDTM  EQU   DARGARY+4                                                09097000
DARGPCT  EQU   DARGINL                                                  09098000
DARGREP  EQU   DARGINS                                                  09099000
@NM00023 EQU   DARGFLGS                                                 09100000
DARGFULL EQU   DARGFLGS                                                 09101000
DARGIND  EQU   DARGLIST+18                                              09102000
DARGCNT  EQU   DARGLIST+14                                              09103000
UVOLVOL  EQU   UVOLENT+4                                                09104000
UVOLDEV  EQU   UVOLENT                                                  09105000
UVOLCNT  EQU   UVOLLIST                                                 09106000
@NM00022 EQU   IOINFOPT                                                 09107000
IOINFLUB EQU   IOINFOPT                                                 09108000
IOINFTMS EQU   IOINFOPT                                                 09109000
IOINFSUP EQU   IOINFOPT                                                 09110000
IOINFDSN EQU   IOINFOPT                                                 09111000
IOINFVOL EQU   IOINFOPT                                                 09112000
IOINFDVT EQU   IOINFOPT                                                 09113000
OPNVOL   EQU   OPNAGL+44                                                09114000
OPNSTRNO EQU   OPNAGL+43                                                09115000
@NM00021 EQU   OPNOPT2                                                  09116000
OPNOPTJM EQU   OPNOPT2                                                  09117000
OPNOPTNM EQU   OPNOPT2                                                  09118000
OPNOPTAS EQU   OPNOPT2                                                  09119000
@NM00020 EQU   OPNDSO                                                   09120000
OPNDSOPO EQU   OPNDSO                                                   09121000
OPNDSOIS EQU   OPNDSO                                                   09122000
OPNDSOPS EQU   OPNDSO                                                   09123000
OPNDSOAM EQU   OPNDSO                                                   09124000
OPNKYL   EQU   OPNAGL+40                                                09125000
OPNBLK   EQU   OPNAGL+36                                                09126000
OPNREC   EQU   OPNAGL+32                                                09127000
OPNDEVIX EQU   OPNDEV+4                                                 09128000
OPNDEVDT EQU   OPNDEV                                                   09129000
OPNCBP   EQU   OPNAGL+20                                                09130000
OPNDSN   EQU   OPNAGL+16                                                09131000
OPNPWA   EQU   OPNAGL+12                                                09132000
OPNMODRP EQU   OPNMOD                                                   09133000
OPNMODUB EQU   OPNMOD                                                   09134000
OPNMODRS EQU   OPNMOD                                                   09135000
OPNMODAX EQU   OPNMOD                                                   09136000
OPNMODRR EQU   OPNMOD                                                   09137000
OPNMODRC EQU   OPNMOD                                                   09138000
OPNMODPD EQU   OPNMOD                                                   09139000
OPNTYPSY EQU   OPNTYP                                                   09140000
OPNTYPRV EQU   OPNTYP                                                   09141000
OPNTYPEX EQU   OPNTYP                                                   09142000
OPNTYPRA EQU   OPNTYP                                                   09143000
OPNTYPXM EQU   OPNTYP                                                   09144000
OPNTYPCI EQU   OPNTYP                                                   09145000
OPNTYPSO EQU   OPNTYP                                                   09146000
OPNTYPSI EQU   OPNTYP                                                   09147000
@NM00019 EQU   OPNRFM                                                   09148000
OPNRFMBK EQU   OPNRFM                                                   09149000
OPNRFMSF EQU   OPNRFM                                                   09150000
OPNRFMUN EQU   OPNRFM                                                   09151000
OPNRFMVR EQU   OPNRFM                                                   09152000
OPNRFMFX EQU   OPNRFM                                                   09153000
OPNOPTSK EQU   OPNOPT                                                   09154000
OPNOPTDR EQU   OPNOPT                                                   09155000
OPNOPTCR EQU   OPNOPT                                                   09156000
OPNOPTKS EQU   OPNOPT                                                   09157000
OPNOPTBK EQU   OPNOPT                                                   09158000
OPNOPTUP EQU   OPNOPT                                                   09159000
OPNOPTIN EQU   OPNOPT                                                   09160000
IOCEXT   EQU   IOCSTR+64                                                09161000
IOCTSML  EQU   IOCREL+2                                                 09162000
IOCTPML  EQU   IOCREL                                                   09163000
IOCWORK  EQU   IOCSTR+56                                                09164000
IOCRRN   EQU   IOCSTR+52                                                09165000
IOCPNM   EQU   IOCNWM+2                                                 09166000
IOCPTL   EQU   IOCNWM                                                   09167000
IOCKYA   EQU   IOCMEM                                                   09168000
IOCVRC   EQU   IOCTTR                                                   09169000
IOCCBP   EQU   IOCSTR+36                                                09170000
IOCDSN   EQU   IOCSTR+32                                                09171000
IOCHURBA EQU   IOCSTR+28                                                09172000
IOCVOLSR EQU   IOCSTR+22                                                09173000
@NM00018 EQU   IOCMSG                                                   09174000
IOCMSGSM EQU   IOCMSG                                                   09175000
IOCMSGAE EQU   IOCMSG                                                   09176000
IOCMSGCE EQU   IOCMSG                                                   09177000
IOCMSGOE EQU   IOCMSG                                                   09178000
IOCMSGOP EQU   IOCMSG                                                   09179000
IOCCHPKG EQU   IOCMSG                                                   09180000
IOCCHPKE EQU   IOCMSG                                                   09181000
IOCCHPNU EQU   IOCCHP                                                   09182000
IOCCHPUP EQU   IOCCHP                                                   09183000
IOCCHPBK EQU   IOCCHP                                                   09184000
IOCCHPCR EQU   IOCCHP                                                   09185000
IOCCHPKS EQU   IOCCHP                                                   09186000
IOCCHPSK EQU   IOCCHP                                                   09187000
IOCCHPDR EQU   IOCCHP                                                   09188000
IOCCHPSQ EQU   IOCCHP                                                   09189000
IOCMACNT EQU   IOCMAC2                                                  09190000
IOCMACER EQU   IOCMAC2                                                  09191000
IOCMACPA EQU   IOCMAC2                                                  09192000
IOCMACEN EQU   IOCMAC2                                                  09193000
IOCMACCP EQU   IOCMAC2                                                  09194000
IOCMACRR EQU   IOCMAC2                                                  09195000
IOCMACAS EQU   IOCMAC2                                                  09196000
IOCMACSK EQU   IOCMAC2                                                  09197000
@NM00017 EQU   IOCMAC                                                   09198000
IOCMACCC EQU   IOCMAC                                                   09199000
IOCMACDR EQU   IOCMAC                                                   09200000
IOCMACBK EQU   IOCMAC                                                   09201000
IOCMACCR EQU   IOCMAC                                                   09202000
IOCMACUP EQU   IOCMAC                                                   09203000
IOCMACOT EQU   IOCMAC                                                   09204000
IOCMACIN EQU   IOCMAC                                                   09205000
@NM00016 EQU   IOCRFM                                                   09206000
IOCRFMBK EQU   IOCRFM                                                   09207000
IOCRFMSF EQU   IOCRFM                                                   09208000
IOCRFMUN EQU   IOCRFM                                                   09209000
IOCRFMVR EQU   IOCRFM                                                   09210000
IOCRFMFX EQU   IOCRFM                                                   09211000
@NM00015 EQU   IOCDSO                                                   09212000
IOCDSOPO EQU   IOCDSO                                                   09213000
IOCDSOIS EQU   IOCDSO                                                   09214000
IOCDSOPS EQU   IOCDSO                                                   09215000
IOCDSOAM EQU   IOCDSO                                                   09216000
IOCRKP   EQU   IOCSTR+13                                                09217000
IOCKYL   EQU   IOCSTR+12                                                09218000
IOCTRN   EQU   IOCSTR+8                                                 09219000
IOCDLN   EQU   IOCSTR+4                                                 09220000
IOCDAD   EQU   IOCSTR                                                   09221000
UNITVTOC EQU   UNITABL+7                                                09222000
@NM00014 EQU   UNITSTAT                                                 09223000
UNITUSHR EQU   UNITSTAT                                                 09224000
UNITXSHR EQU   UNITSTAT                                                 09225000
UNITISHR EQU   UNITSTAT                                                 09226000
UNITUA   EQU   @NM00013+1                                               09227000
UNITCHA  EQU   @NM00013                                                 09228000
UNITUCB  EQU   UNITABL                                                  09229000
ALLUNCNT EQU   ALLAGL+30                                                09230000
ALLVLCNT EQU   ALLAGL+29                                                09231000
@NM00012 EQU   ALLOPT                                                   09232000
ALLOPTUN EQU   ALLOPT                                                   09233000
ALLOPTPV EQU   ALLOPT                                                   09234000
ALLOPTDS EQU   ALLOPT                                                   09235000
ALLOPTVL EQU   ALLOPT                                                   09236000
@NM00011 EQU   ALLORG+1                                                 09237000
ALLORGVS EQU   ALLORG+1                                                 09238000
@NM00010 EQU   ALLORG+1                                                 09239000
ALLORGGS EQU   ALLORG+1                                                 09240000
ALLORGUN EQU   ALLORG                                                   09241000
ALLORGPO EQU   ALLORG                                                   09242000
ALLORGMQ EQU   ALLORG                                                   09243000
ALLORGCQ EQU   ALLORG                                                   09244000
ALLORGCX EQU   ALLORG                                                   09245000
ALLORGDA EQU   ALLORG                                                   09246000
ALLORGPS EQU   ALLORG                                                   09247000
ALLORGIS EQU   ALLORG                                                   09248000
ALLDSPUN EQU   ALLDSP                                                   09249000
ALLDSPCG EQU   ALLDSP                                                   09250000
ALLDSPDE EQU   ALLDSP                                                   09251000
ALLDSPKP EQU   ALLDSP                                                   09252000
@NM00009 EQU   ALLDSP                                                   09253000
ALLSTSOD EQU   ALLSTS                                                   09254000
ALLSTSMD EQU   ALLSTS                                                   09255000
ALLSTSNW EQU   ALLSTS                                                   09256000
ALLSTSSR EQU   ALLSTS                                                   09257000
@NM00008 EQU   ALLSTS                                                   09258000
ALLPWD   EQU   ALLAGL+20                                                09259000
ALLVLP   EQU   ALLAGL+16                                                09260000
ALLULP   EQU   ALLAGL+12                                                09261000
ALLDDN   EQU   ALLAGL+4                                                 09262000
ALLDSN   EQU   ALLAGL                                                   09263000
@NM00007 EQU   CIRAGL+1                                                 09264000
@NM00006 EQU   CIRTYPE                                                  09265000
NEWID1   EQU   TRACE1+95                                                09266000
CALLID   EQU   OLDERID1+90                                              09267000
@NM00005 EQU   OLDERID1                                                 09268000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09269000
@RF00345 EQU   @RC00343                                                 09270000
@RF00401 EQU   @RC00389                                                 09271000
@RF00546 EQU   @RC00543                                                 09272000
@RF00598 EQU   @RC00593                                                 09273000
@RF00904 EQU   @RC00900                                                 09274000
@RC00922 EQU   @RC00898                                                 09275000
@RF00921 EQU   @RC00898                                                 09276000
@RF00936 EQU   @RC00931                                                 09277000
@RC00995 EQU   @RC00994                                                 09278000
@RC01104 EQU   @RC01094                                                 09279000
@RC01143 EQU   @RC01142                                                 09280000
@RF01222 EQU   @RC01219                                                 09281000
@RF01243 EQU   @RC01237                                                 09282000
@RC01250 EQU   @RC01237                                                 09283000
@RF01249 EQU   @RC01237                                                 09284000
@RF01300 EQU   @RC01295                                                 09285000
@RF01302 EQU   @RC01295                                                 09286000
@RC01309 EQU   @RC01295                                                 09287000
@RF01308 EQU   @RC01295                                                 09288000
@RC01331 EQU   @RC01330                                                 09289000
@RC01350 EQU   @RC01330                                                 09290000
@RC01359 EQU   @RC01330                                                 09291000
@RF01358 EQU   @RC01330                                                 09292000
@RC01385 EQU   @RC01209                                                 09293000
@RC01379 EQU   @RC01209                                                 09294000
@RC01217 EQU   @RC01209                                                 09295000
@RC01565 EQU   @RC01535                                                 09296000
@RC01553 EQU   @RC01535                                                 09297000
@RC01539 EQU   @RC01535                                                 09298000
@RF01579 EQU   @RC01535                                                 09299000
@RF01594 EQU   @RC01589                                                 09300000
@RF01596 EQU   @RC01589                                                 09301000
@RF01606 EQU   @RC01601                                                 09302000
@RF01610 EQU   @RC01585                                                 09303000
@RF01619 EQU   @RC01585                                                 09304000
@RF01507 EQU   @RC01455                                                 09305000
@RC01692 EQU   @RC01685                                                 09306000
@RF01698 EQU   @RC01685                                                 09307000
@RF01713 EQU   @RC01685                                                 09308000
@RF01784 EQU   @RC01780                                                 09309000
@RC01828 EQU   @RC01823                                                 09310000
@RC01845 EQU   @RC01840                                                 09311000
@PB00008 EQU   @EL00001                                                 09312000
@RF01397 EQU   @RC01385                                                 09313000
@RF01543 EQU   @RC01539                                                 09314000
@PB00007 EQU   @PB00008                                                 09315000
@RF01834 EQU   @RC01828                                                 09316000
@RF01851 EQU   @RC01845                                                 09317000
@PB00006 EQU   @PB00007                                                 09318000
@PB00005 EQU   @PB00006                                                 09319000
@PB00004 EQU   @PB00005                                                 09320000
@PB00003 EQU   @PB00004                                                 09321000
@PB00002 EQU   @PB00003                                                 09322000
@ENDDATA EQU   *                                                        09323000
         END   IDCLC01,(C'PLS1403',0701,78033)                          09324000
