         TITLE '***** IDCLC02: LISTCAT FSR - FORMATTING AND LISTING ****00001000
               ***      '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
        MACRO                                                           00013000
        FREEMAIN &MODE,&LV=,&LA=,&A=,&SP=,&MF=I                         00014000
        MEND                                                            00015000
IDCLC02  CSECT ,                                                   0003 00016000
@MAINENT DS    0H                                                  0003 00017000
         USING *,@15                                               0003 00018000
         B     @PROLOG                                             0003 00019000
         DC    AL1(16)                                             0003 00020000
         DC    C'IDCLC02   76.335'                                 0003 00021000
         DROP  @15                                                      00022000
@PROLOG  STM   @14,@04,12(@13)                                     0003 00023000
         STM   @06,@12,44(@13)                                     0003 00024000
         BALR  @08,0                                               0003 00025000
@PSTART  LA    @09,4095(,@08)                                      0003 00026000
         LA    @10,4095(,@09)                                      0003 00027000
         LA    @11,4095(,@10)                                      0003 00028000
         LA    @12,4095(,@11)                                      0003 00029000
         USING @PSTART,@08                                         0003 00030000
         USING @PSTART+4095,@09                                    0003 00031000
         USING @PSTART+8190,@10                                    0003 00032000
         USING @PSTART+12285,@11                                   0003 00033000
         USING @PSTART+16380,@12                                   0003 00034000
         L     @00,@SIZDATD                                        0003 00035000
         GETMAIN  R,LV=(0)                                              00036000
         LR    @05,@01                                             0003 00037000
         USING @DATD,@05                                           0003 00038000
         ST    @13,@SA00001+4                                      0003 00039000
         LM    @00,@01,20(@13)                                     0003 00040000
         ST    @05,8(,@13)                                         0003 00041000
         LR    @13,@05                                             0003 00042000
         MVC   @PC00001(8),0(@01)                                  0003 00043000
*                                                                  0264 00044000
*        /************************************************************/ 00045000
*        /************************************************************/ 00046000
*        /*                                                  @ZA05939*/ 00047000
*        /* MAIN ENTRY POINT IN IDCLC02.  THIS ENTRY POINT   @ZA05939*/ 00048000
*        /* IS CALLED ONLY ONCE BY IDCLC01 TO ACQUIRE        @ZA05939*/ 00049000
*        /* AUTOMATIC STORAGE, ESTABLISH ADDRESSABILITY AND  @ZA05939*/ 00050000
*        /* INITIALIZE THE COMMON AREA POINTER STRUCTURE.    @ZA05939*/ 00051000
*        /*                                                  @ZA05939*/ 00052000
*        /************************************************************/ 00053000
*        /************************************************************/ 00054000
*                                                                  0264 00055000
*        IF GDTDBG = NULLPTR                                       0264 00056000
*          THEN;                                                   0264 00057000
         L     @04,@PC00001                                        0264 00058000
         L     @04,GDTDBG(,@04)                                    0264 00059000
         LTR   @04,@04                                             0264 00060000
         BZ    @RT00264                                            0264 00061000
*          ELSE                                                    0266 00062000
*            CALL IDCDB010 (GDTTBL,'LC02');                        0266 00063000
         L     @04,@PC00001                                        0266 00064000
         ST    @04,@AL00001                                        0266 00065000
         LA    @15,@CC01427                                        0266 00066000
         ST    @15,@AL00001+4                                      0266 00067000
         MVI   @AL00001+4,X'80'                                    0266 00068000
         L     @15,GDTDBG(,@04)                                    0266 00069000
         LA    @01,@AL00001                                        0266 00070000
         BALR  @14,@15                                             0266 00071000
*                                                          /*@ZA05939*/ 00072000
*        STM(REG8,REG12,BASESAVE);     /*SAVE INTERNAL BASE REGS     */ 00073000
*                                                                  0267 00074000
@RT00264 STM   REG8,REG12,BASESAVE                                 0267 00075000
*        /************************************************************/ 00076000
*        /*                                                  @ZA05939*/ 00077000
*        /* INITIALIZE THE COMMON AREA POINTER STRUCTURE     @ZA05939*/ 00078000
*        /* TO THE ADDRESSES OF THE COMMON AREA DATA         @ZA05939*/ 00079000
*        /* STRUCTURES.  RETURN TO IDCLC01 PASSING BACK      @ZA05939*/ 00080000
*        /* THE ADDRESS OF THE COMMON AREA POINTER STRUCTURE @ZA05939*/ 00081000
*        /* IN REGISTER 15.                                  @ZA05939*/ 00082000
*        /*                                                  @ZA05939*/ 00083000
*        /************************************************************/ 00084000
*                                                                  0268 00085000
*        RESPECIFY DARGLIST BASED(DARGPTR);                /*@ZA05939*/ 00086000
*        COMSWKPT = ADDR(SAVWKPTR);                        /*@ZA05939*/ 00087000
         LA    @04,SAVWKPTR                                        0269 00088000
         ST    @04,COMSWKPT                                        0269 00089000
*        COMFPLPT = ADDR(CORRFPLS);                        /*@ZA05939*/ 00090000
         LA    @04,CORRFPLS                                        0270 00091000
         ST    @04,COMFPLPT                                        0270 00092000
*        COMFLGPT = ADDR(FLAGS);                           /*@ZA05939*/ 00093000
         LA    @04,FLAGS                                           0271 00094000
         ST    @04,COMFLGPT                                        0271 00095000
*        COMVARPT = ADDR(MISCVAR);                         /*@ZA05939*/ 00096000
         LA    @04,MISCVAR                                         0272 00097000
         ST    @04,COMVARPT                                        0272 00098000
*        COMTOTPT = ADDR(TYPAUDIT);                        /*@ZA05939*/ 00099000
         LA    @04,TYPAUDIT                                        0273 00100000
         ST    @04,COMTOTPT                                        0273 00101000
*        COMPTR = ADDR(COMAREA);                           /*@ZA05939*/ 00102000
*                                                                  0274 00103000
         LA    COMPTR,COMAREA                                      0274 00104000
*        RETURN CODE(COMPTR);          /*RETURN TO IDCLC01   @ZA05939*/ 00105000
*                                                                  0275 00106000
         L     @13,4(,@13)                                         0275 00107000
         L     @00,@SIZDATD                                        0275 00108000
         LR    @01,@05                                             0275 00109000
         FREEMAIN R,LV=(0),A=(1)                                        00110000
         LR    @15,@02                                             0275 00111000
         L     @14,12(,@13)                                        0275 00112000
         LM    @00,@04,20(@13)                                     0275 00113000
         LM    @06,@12,44(@13)                                     0275 00114000
         BR    @14                                                 0275 00115000
*        /************************************************************/ 00116000
*        /*                                                          */ 00117000
*        /* PROCEDURE NAME - LOCPROC                                 */ 00118000
*        /*                                                          */ 00119000
*        /* FUNCTION - ISSUES VSAM CATALOG/DADSM LOCATE REQUEST.     */ 00120000
*        /* OBTAINS ADDITIONAL CATALOG WORKSPACE IF REQUIRED.        */ 00121000
*        /* ESTABLISHES THE SUBTITLE WITH CATALOG NAME AFTER THE     */ 00122000
*        /* FIRST LOCATE IS ISSUED.                                  */ 00123000
*        /* AND SETS THE CATALOG ACB INFORMATION IN THE CPL AFTER    */ 00124000
*        /* THE FIRST SUCCESSFUL LOCATE IS ISSUED.                   */ 00125000
*        /*                                                          */ 00126000
*        /* INPUT - VSAM CATALOG PARM AND FIELD LISTS AND THE        */ 00127000
*        /* SAVE AREAS FOR THESE LISTS.  ALSO, SWITCHES TO SIGNAL    */ 00128000
*        /* REQUESTS FOR ASSOCIATED ENTRY NAME OR CATALOG ACB PTR    */ 00129000
*        /* OR SUBTITLE.                                             */ 00130000
*        /*                                                          */ 00131000
*        /* OUTPUT - VSAM CATALOG/DADSM RETURN CODE, RETRIEVED       */ 00132000
*        /* CATALOG FIELD INFORMATION, AND SWITCH SETTINGS.          */ 00133000
*        /*                                                          */ 00134000
*        /************************************************************/ 00135000
*                                                                  0276 00136000
*LOCPROC:  PROCEDURE (FPLLAST,                                     0276 00137000
*                     CACBSW,                                      0276 00138000
*                     ENTNMSW) OPTIONS(SAVEAREA);                  0276 00139000
*                                                                  0276 00140000
LOCPROC  STM   @14,@12,12(@13)                                     0276 00141000
         ST    @13,@SA00002+4                                      0276 00142000
         LA    @14,@SA00002                                        0276 00143000
         ST    @14,8(,@13)                                         0276 00144000
         LR    @13,@14                                             0276 00145000
         MVC   @PC00002(12),0(@01)                                 0276 00146000
*        GEN(ENTRY LOCPROC);           /*EXT ENTRY POINT     @ZA05939*/ 00147000
         ENTRY LOCPROC                                                  00148000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 00149000
*                                                                  0278 00150000
         LM    REG8,REG12,BASESAVE                                 0278 00151000
*        /************************************************************/ 00152000
*        /*                                                          */ 00153000
*        /* PARAMETERS WHICH MAY BE MODIFIED.                        */ 00154000
*        /*                                                          */ 00155000
*        /************************************************************/ 00156000
*                                                                  0279 00157000
*        DCL FPLLAST   FIXED(15) UNSIGNED;                         0279 00158000
*        DCL CACBSW    BIT(1);                                     0280 00159000
*        DCL ENTNMSW   BIT(1);                                     0281 00160000
*                                                                  0281 00161000
*        /************************************************************/ 00162000
*        /*                                                          */ 00163000
*        /* LOCAL VARIABLES                                          */ 00164000
*        /*                                                          */ 00165000
*        /************************************************************/ 00166000
*                                                                  0282 00167000
*        DCL SAVCPL    CHAR(*) BASED;  /*OVERLAY OF CPL              */ 00168000
*        DCL CACBPTR   PTR(31);        /*SAVEAREA FOR PTR TO CAT ACB */ 00169000
*        DCL TEMPWKA   PTR(31);        /*GET POOL PTR FOR LARGER WKA */ 00170000
*        DCL MAXMVLEN  FIXED(15) CONSTANT(256);            /*@Y30SSMK*/ 00171000
*                                      /*MAX LENGTH FOR MOVE @Y30SSMK*/ 00172000
*        /************************************************************/ 00173000
*        /*                                                          */ 00174000
*        /* ARGUMENT LISTS FOR THE AMS UDUMP MACRO TO LIST THE       */ 00175000
*        /* WORKAREA USED BY LOCATE, THE CATALOG PARM LIST, AND      */ 00176000
*        /* THE FIELD PARM LISTS, THE CATALOG RETURN CODE, THE KEY=  */ 00177000
*        /* ENTRYNAME OR C.I.#, AND THE PASSWORD.                    */ 00178000
*        /*                                                          */ 00179000
*        /************************************************************/ 00180000
*                                                                  0286 00181000
*        DECLARE                                                   0286 00182000
*          1 DUMPWKA,                  /*DUMP DESCRIPTOR FOR CAT WKA */ 00183000
*            2 ITEM0,                  /*DUMP DESCRIPTOR FOR WKA ADDR*/ 00184000
*              3 ITEM0NM   CHAR(8),                                0286 00185000
*              3 ITEM0PTR  PTR(31),                                0286 00186000
*              3 ITEM0LEN  FIXED(15),                              0286 00187000
*              3 ITEM0TYP  CHAR(1),                                0286 00188000
*              3 *         CHAR(1),                                0286 00189000
*            2 ARYFORM,                /*FOR MULTIPLES OF 256 BYTES  */ 00190000
*              3 ARYNM   CHAR(8),                                  0286 00191000
*              3 ARYSZ   FIXED(15) UNSIGNED,                       0286 00192000
*              3 ARYITEM FIXED(15) UNSIGNED,                       0286 00193000
*              3 ARYEXT  FIXED(15) UNSIGNED,                       0286 00194000
*              3 ARYHDR  CHAR(1),                                  0286 00195000
*              3 *       CHAR(1),                                  0286 00196000
*            2 ITEM1,                                              0286 00197000
*              3 ITEM1NM  CHAR(8),                                 0286 00198000
*              3 ITEM1PTR PTR(31),                                 0286 00199000
*              3 ITEM1LEN FIXED(15) UNSIGNED,                      0286 00200000
*              3 ITEM1TYP CHAR(1),                                 0286 00201000
*              3 *        CHAR(1),                                 0286 00202000
*            2 ITEM2,                  /*FOR A REMAINDER LT 256 BYTES*/ 00203000
*              3 ITEM2NM   CHAR(8),                                0286 00204000
*                4 LIST2END  CHAR(1),  /*LIST ENDS WHEN NO REMAINDER */ 00205000
*                4 *         CHAR(7),                              0286 00206000
*              3 ITEM2PTR  PTR(31),                                0286 00207000
*              3 ITEM2LEN  FIXED(15) UNSIGNED,                     0286 00208000
*              3 ITEM2TYP  CHAR(1),                                0286 00209000
*              3 *         CHAR(1),                                0286 00210000
*            2 LISTEND   CHAR(1);                                  0286 00211000
*                                                                  0286 00212000
*        DECLARE                                                   0287 00213000
*          1 DUMPARMS,                                             0287 00214000
*            2 ITEM6,                  /*DUMP DESCRIPTOR FOR CAT R.C.*/ 00215000
*              3 ITEM6NM CHAR(8),                                  0287 00216000
*              3 ITEM6PTR  PTR(31),                                0287 00217000
*              3 ITEM6LEN  FIXED(15),                              0287 00218000
*              3 ITEM6TYP  CHAR(1),                                0287 00219000
*              3 *         CHAR(1),                                0287 00220000
*            2 ITEM7,                  /*DUMP DESCRIPTOR FOR KEY     */ 00221000
*              3 ITEM7NM   CHAR(8),                                0287 00222000
*              3 ITEM7PTR  PTR(31),                                0287 00223000
*              3 ITEM7LEN  FIXED(15),                              0287 00224000
*              3 ITEM7TYP  CHAR(1),                                0287 00225000
*              3 *         CHAR(1),                                0287 00226000
*            2 ITEM8,                  /*DUMP DESCRIPTOR FOR PASSWORD*/ 00227000
*              3 ITEM8NM   CHAR(8),                                0287 00228000
*              3 ITEM8PTR  PTR(31),                                0287 00229000
*              3 ITEM8LEN  FIXED(15),                              0287 00230000
*              3 ITEM8TYP  CHAR(1),                                0287 00231000
*              3 *         CHAR(1),                                0287 00232000
*            2 ITEM3,                  /*DUMP DESCRIPTOR FOR CPL     */ 00233000
*              3 ITEM3NM   CHAR(8),                                0287 00234000
*              3 ITEM3PTR  PTR(31),                                0287 00235000
*              3 ITEM3LEN  FIXED(15) UNSIGNED,                     0287 00236000
*              3 ITEM3TYP  CHAR(1),                                0287 00237000
*              3 *         CHAR(1),                                0287 00238000
*            2 ARY2FORM,               /*FPL ARRAY DUMP DESCRIPTOR   */ 00239000
*              3 ARY2NM    CHAR(8),                                0287 00240000
*              3 ARY2SZ    FIXED(15) UNSIGNED,                     0287 00241000
*              3 ARY2ITEM  FIXED(15) UNSIGNED,                     0287 00242000
*              3 ARY2EXT   FIXED(15) UNSIGNED,                     0287 00243000
*              3 ARY2HDR   CHAR(1),                                0287 00244000
*              3 *         CHAR(1),                                0287 00245000
*            2 ITEM4,                  /*DUMP DESCRIPTOR FOR EACH FPL*/ 00246000
*              3 ITEM4NM   CHAR(8),                                0287 00247000
*              3 ITEM4PTR  PTR(31),                                0287 00248000
*              3 ITEM4LEN  FIXED(15) UNSIGNED,                     0287 00249000
*              3 ITEM4TYP  CHAR(1),                                0287 00250000
*              3 *         CHAR(1),                                0287 00251000
*            2 ITEM9,                  /*DUMP DESC FOR MULTITYP FPL  */ 00252000
*              3 ITEM9NM   CHAR(8),                                0287 00253000
*                4 LIST3END CHAR(1),                               0287 00254000
*                4 *        CHAR(7),                               0287 00255000
*              3 ITEM9PTR  PTR(31),                                0287 00256000
*              3 ITEM9LEN  FIXED(15) UNSIGNED,                     0287 00257000
*              3 ITEM9TYP  CHAR(1),                                0287 00258000
*              3 *         CHAR(1),                                0287 00259000
*            2 LIST4END    CHAR(1);                                0287 00260000
*        /************************************************************/ 00261000
*        /*                                                          */ 00262000
*        /* SAVE A COPY OF THE CPL SINCE IT IS NOT A READ-ONLY PARM  */ 00263000
*        /* LIST AND IS NEEDED TO REINITIALIZE CPL VALUES FOR THE    */ 00264000
*        /* NEXT LOCATE REQUEST.                                     */ 00265000
*        /* SAVE A SECOND COPY OF THE CPL SHOULD THE LOCATE ATTEMPT  */ 00266000
*        /* RESULT IN AN INSUFFICIENT-CATALOG-WORKAREA CONDITION.    */ 00267000
*        /* THE SECOND LOCATE REQUEST WITH A LARGER WORKAREA         */ 00268000
*        /* WILL REQUIRE THE ORIGINAL CPL VALUES, NOT THE VALUES     */ 00269000
*        /* MODIFIED BY CAT/DADSM DURING THE FIRST LOCATE ATTEMPT.   */ 00270000
*        /*                                                          */ 00271000
*        /************************************************************/ 00272000
*                                                                  0288 00273000
*                                                                  0288 00274000
*        IF GDTDBG = NULLPTR                                       0288 00275000
*          THEN;                                                   0288 00276000
         L     @04,@PC00001                                        0288 00277000
         L     @04,GDTDBG(,@04)                                    0288 00278000
         LTR   @04,@04                                             0288 00279000
         BZ    @RT00288                                            0288 00280000
*          ELSE                                                    0290 00281000
*            DO;                                                   0290 00282000
*              DMPINDEX = ADDR(DFLAGS);                            /*@Y 00283000
*026UE*/                                                           0291 00284000
*                                                                  0291 00285000
         LA    DMPINDEX,DFLAGS                                     0291 00286000
*              DMPITMNM = 'FLAGS';                                 0292 00287000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0292 00288000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0292 00289000
         MVC   DMPITMNM(5,DMPINDEX),@CC01544                       0292 00290000
*              DMPITMPT = ADDR(FLAGS);                             0293 00291000
         LA    @04,FLAGS                                           0293 00292000
         ST    @04,DMPITMPT(,DMPINDEX)                             0293 00293000
*              DMPITMLN = 33;                                      0294 00294000
         MVC   DMPITMLN(2,DMPINDEX),@CH01235                       0294 00295000
*              DMPITMTP = 'H';                                     0295 00296000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0295 00297000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0296 00298000
*                                                                  0296 00299000
         AL    DMPINDEX,@CF00487                                   0296 00300000
*              DMPTRM = DMPTRMVL;                                  0297 00301000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0297 00302000
*            END;                                           /*@YL026UE* 00303000
*                                                                  0298 00304000
*        IF GDTDBG = NULLPTR                                       0299 00305000
*          THEN;                                                   0299 00306000
@RT00288 L     @04,@PC00001                                        0299 00307000
         L     @04,GDTDBG(,@04)                                    0299 00308000
         LTR   @04,@04                                             0299 00309000
         BZ    @RT00299                                            0299 00310000
*          ELSE                                                    0301 00311000
*            CALL IDCDB010(GDTTBL,'LCLO',ADDR(DFLAGS));            0301 00312000
         L     @04,@PC00001                                        0301 00313000
         ST    @04,@AL00001                                        0301 00314000
         LA    @15,@CC01546                                        0301 00315000
         ST    @15,@AL00001+4                                      0301 00316000
         LA    @15,DFLAGS                                          0301 00317000
         ST    @15,@AFTEMPS                                        0301 00318000
         LA    @15,@AFTEMPS                                        0301 00319000
         ST    @15,@AL00001+8                                      0301 00320000
         MVI   @AL00001+8,X'80'                                    0301 00321000
         L     @15,GDTDBG(,@04)                                    0301 00322000
         LA    @01,@AL00001                                        0301 00323000
         BALR  @14,@15                                             0301 00324000
*                                                          /*@YL026UE*/ 00325000
*                                                                  0302 00326000
*        IF ENTNMSW = ON                                           0302 00327000
*          THEN                        /* CPL FOR ASSOC ENTRYNAME    */ 00328000
@RT00299 L     @04,@PC00002+8                                      0302 00329000
         TM    ENTNMSW(@04),B'10000000'                            0302 00330000
         BNO   @RF00302                                            0302 00331000
*            SA#CPLPT->SAVCPL(1:LC#CPLLN) = CTGPL(1:LC#CPLLN);     0303 00332000
         L     @04,SA#CPLPT                                        0303 00333000
         LH    @15,LC#CPLLN                                        0303 00334000
         BCTR  @15,0                                               0303 00335000
         L     @01,CTGPLPTR                                        0303 00336000
         EX    @15,@SM01747                                        0303 00337000
*          ELSE                        /* MAIN CPL AND SETUP-COPY    */ 00338000
*            DO;                                                   0304 00339000
         B     @RC00302                                            0304 00340000
@RF00302 DS    0H                                                  0305 00341000
*              OLDCPLPT->SAVCPL(1:LCCPLLEN) = CTGPL(1:LCCPLLEN);   0305 00342000
         L     @04,OLDCPLPT                                        0305 00343000
         SLR   @15,@15                                             0305 00344000
         IC    @15,LCCPLLEN                                        0305 00345000
         BCTR  @15,0                                               0305 00346000
         L     @14,CTGPLPTR                                        0305 00347000
         EX    @15,@SM01749                                        0305 00348000
*              SAVCPLPT->SAVCPL(1:LCCPLLEN) = CTGPL(1:LCCPLLEN);   0306 00349000
         L     @04,SAVCPLPT                                        0306 00350000
         EX    @15,@SM01749                                        0306 00351000
*            END;                                                  0307 00352000
*                                                                  0307 00353000
*        /************************************************************/ 00354000
*        /*                                                          */ 00355000
*        /* ZERO THE CATALOG RETURN CODE PRIOR TO ISSUING THE LOCATE.*/ 00356000
*        /* THEN DURING A TEST MODE, THE SELECTIVE DUMPING BEFORE A  */ 00357000
*        /* LOCATE WILL REFLECT THE PROPER INITIALIZATION.           */ 00358000
*        /*                                                          */ 00359000
*        /************************************************************/ 00360000
*                                                                  0308 00361000
*        CATRC = 0;                                                0308 00362000
@RC00302 SLR   @04,@04                                             0308 00363000
         STH   @04,CATRC                                           0308 00364000
*        /************************************************************/ 00365000
*        /*                                                          */ 00366000
*        /* PRIOR TO ISSUING THE LOCATE, INITIALIZE THE UDUMP LIST   */ 00367000
*        /* TO SELECTIVELY DUMP THE FOLLOWING WHEN IN A TEST MODE:   */ 00368000
*        /*   1) CATALOG PARM LIST                                   */ 00369000
*        /*   2) FIELD PARM LISTS                                    */ 00370000
*        /*   3) CATALOG RETURN CODE                                 */ 00371000
*        /*   4) LOCATE KEY = A 44-BYTE ENTRYNAME OR A 3-BYTE CI#    */ 00372000
*        /*   5) PASSWORD                                            */ 00373000
*        /*                                                          */ 00374000
*        /************************************************************/ 00375000
*                                                                  0309 00376000
*        IF GDTDBG ^= NULLPTR                                      0309 00377000
*          THEN                                                    0309 00378000
         L     @15,@PC00001                                        0309 00379000
         C     @04,GDTDBG(,@15)                                    0309 00380000
         BE    @RF00309                                            0309 00381000
*            DO;                                                   0310 00382000
*              ITEM3NM = 'CTGPL';      /*CATALOG PARM LIST           */ 00383000
         MVI   ITEM3NM+5,C' '                                      0311 00384000
         MVC   ITEM3NM+6(2),ITEM3NM+5                              0311 00385000
         MVC   ITEM3NM(5),@CC01547                                 0311 00386000
*              ITEM3PTR = CTGPLPTR;                                0312 00387000
         L     @04,CTGPLPTR                                        0312 00388000
         ST    @04,ITEM3PTR                                        0312 00389000
*              ITEM3TYP = 'H';                                     0313 00390000
         MVI   ITEM3TYP,C'H'                                       0313 00391000
*              ITEM4NM = 'FPL';        /*FIELD PARM LISTS            */ 00392000
         MVI   ITEM4NM+3,C' '                                      0314 00393000
         MVC   ITEM4NM+4(4),ITEM4NM+3                              0314 00394000
         MVC   ITEM4NM(3),@CC01548                                 0314 00395000
*              ITEM4LEN = LCFPLLEN;                                0315 00396000
         SLR   @15,@15                                             0315 00397000
         IC    @15,LCFPLLEN                                        0315 00398000
         STH   @15,ITEM4LEN                                        0315 00399000
*              ITEM4TYP = 'H';                                     0316 00400000
         MVI   ITEM4TYP,C'H'                                       0316 00401000
*              ARY2NM = 'CTGFL';                                   0317 00402000
         MVI   ARY2NM+5,C' '                                       0317 00403000
         MVC   ARY2NM+6(2),ARY2NM+5                                0317 00404000
         MVC   ARY2NM(5),@CC01549                                  0317 00405000
*              ARY2SZ = LCFPLLEN;                                  0318 00406000
         STH   @15,ARY2SZ                                          0318 00407000
*              ARY2HDR = 'A';                                      0319 00408000
         MVI   ARY2HDR,C'A'                                        0319 00409000
*              ARY2ITEM = 1;                                       0320 00410000
         MVC   ARY2ITEM(2),@CH00045                                0320 00411000
*              IF ENTNMSW = ON                                     0321 00412000
*                THEN                  /*REQUEST FOR ENTRYNAME ONLY  */ 00413000
         L     @15,@PC00002+8                                      0321 00414000
         TM    ENTNMSW(@15),B'10000000'                            0321 00415000
         BNO   @RF00321                                            0321 00416000
*                  DO;                                             0322 00417000
*                    ITEM3LEN = LC#CPLLN;                          0323 00418000
         LH    @15,LC#CPLLN                                        0323 00419000
         STH   @15,ITEM3LEN                                        0323 00420000
*                    ITEM4PTR = CTGFIELD(1);               /*@YL026UE*/ 00421000
         L     @15,CTGFIELD(,@04)                                  0324 00422000
         ST    @15,ITEM4PTR                                        0324 00423000
*                    ARY2EXT = CTGNOFLD;                   /*@YL026UE*/ 00424000
         SLR   @15,@15                                             0325 00425000
         IC    @15,CTGNOFLD(,@04)                                  0325 00426000
         STH   @15,ARY2EXT                                         0325 00427000
*                    LIST3END = 'FF'X;                     /*@Y30LSMK*/ 00428000
         MVI   LIST3END,X'FF'                                      0326 00429000
*                  END;                                            0327 00430000
*                ELSE                                              0328 00431000
*                  IF FPLBEGN = 1                                  0328 00432000
*                    THEN                                          0328 00433000
         B     @RC00321                                            0328 00434000
@RF00321 LH    @04,FPLBEGN                                         0328 00435000
         C     @04,@CF00045                                        0328 00436000
         BNE   @RF00328                                            0328 00437000
*                      DO;                                 /*@Y30LSMK*/ 00438000
*                        ITEM9NM = 'MULTIFPL';             /*@Y30LSMK*/ 00439000
         MVC   ITEM9NM(8),@CC01550                                 0330 00440000
*                        ITEM9LEN = MTFPLLEN;              /*@Y30LSMK*/ 00441000
         SLR   @15,@15                                             0331 00442000
         IC    @15,MTFPLLEN                                        0331 00443000
         STH   @15,ITEM9LEN                                        0331 00444000
*                        ITEM9TYP = 'H';                   /*@Y30LSMK*/ 00445000
         MVI   ITEM9TYP,C'H'                                       0332 00446000
*                        ITEM9PTR = FPLPTMAP(FPLBEGN);     /*@Y30LSMK*/ 00447000
         SLA   @04,2                                               0333 00448000
         L     @15,FPLPTMAP-4(@04)                                 0333 00449000
         ST    @15,ITEM9PTR                                        0333 00450000
*                        ITEM3LEN = LCCPLLEN;              /*@Y30LSMK*/ 00451000
         SLR   @15,@15                                             0334 00452000
         IC    @15,LCCPLLEN                                        0334 00453000
         STH   @15,ITEM3LEN                                        0334 00454000
*                        ITEM4PTR = FPLPTMAP(FPLBEGN + 1); /*@Y30LSMK*/ 00455000
         L     @04,FPLPTMAP(@04)                                   0335 00456000
         ST    @04,ITEM4PTR                                        0335 00457000
*                        ARY2EXT = FPLCNT - 1;             /*@Y30LSMK*/ 00458000
         LH    @04,FPLCNT                                          0336 00459000
         BCTR  @04,0                                               0336 00460000
         STH   @04,ARY2EXT                                         0336 00461000
*                        LIST4END = 'FF'X;                 /*@Y30LSMK*/ 00462000
         MVI   LIST4END,X'FF'                                      0337 00463000
*                      END;                                /*@Y30LSMK*/ 00464000
*                    ELSE              /*REQUEST FOR ALL CAT FIELDS  */ 00465000
*                      DO;                                         0339 00466000
         B     @RC00328                                            0339 00467000
@RF00328 DS    0H                                                  0340 00468000
*                        ITEM3LEN = LCCPLLEN;                      0340 00469000
         SLR   @04,@04                                             0340 00470000
         IC    @04,LCCPLLEN                                        0340 00471000
         STH   @04,ITEM3LEN                                        0340 00472000
*                        ITEM4PTR = FPLPTMAP(FPLBEGN);             0341 00473000
         LH    @04,FPLBEGN                                         0341 00474000
         SLA   @04,2                                               0341 00475000
         L     @04,FPLPTMAP-4(@04)                                 0341 00476000
         ST    @04,ITEM4PTR                                        0341 00477000
*                        ARY2EXT = FPLCNT;                         0342 00478000
         LH    @04,FPLCNT                                          0342 00479000
         STH   @04,ARY2EXT                                         0342 00480000
*                        LIST3END = 'FF'X;                         0343 00481000
         MVI   LIST3END,X'FF'                                      0343 00482000
*                      END;                                        0344 00483000
*              ITEM6NM = 'CATRC';      /*CATALOG RETURN CODE         */ 00484000
@RC00328 DS    0H                                                  0345 00485000
@RC00321 MVI   ITEM6NM+5,C' '                                      0345 00486000
         MVC   ITEM6NM+6(2),ITEM6NM+5                              0345 00487000
         MVC   ITEM6NM(5),@CC01551                                 0345 00488000
*              ITEM6PTR = ADDR(CATRC);                             0346 00489000
         LA    @04,CATRC                                           0346 00490000
         ST    @04,ITEM6PTR                                        0346 00491000
*              ITEM6LEN = LENGTH(CATRC);                           0347 00492000
         MVC   ITEM6LEN(2),@CH00161                                0347 00493000
*              ITEM6TYP = 'H';                                     0348 00494000
*                                                                  0348 00495000
         MVI   ITEM6TYP,C'H'                                       0348 00496000
*              ITEM7NM = 'CTGENT';     /*LOCATE KEY                  */ 00497000
         MVI   ITEM7NM+6,C' '                                      0349 00498000
         MVI   ITEM7NM+7,C' '                                      0349 00499000
         MVC   ITEM7NM(6),@CC01552                                 0349 00500000
*              ITEM7PTR = CTGENT;                                  0350 00501000
         L     @04,CTGPLPTR                                        0350 00502000
         L     @15,CTGENT(,@04)                                    0350 00503000
         ST    @15,ITEM7PTR                                        0350 00504000
*              ITEM7TYP = 'H';                                     0351 00505000
         MVI   ITEM7TYP,C'H'                                       0351 00506000
*              IF CTGNAME = ON                                     0352 00507000
*                THEN                                              0352 00508000
         TM    CTGNAME(@04),B'00000100'                            0352 00509000
         BNO   @RF00352                                            0352 00510000
*                  ITEM7LEN = LENGTH(ENT44);                       0353 00511000
         MVC   ITEM7LEN(2),@CH00606                                0353 00512000
*                ELSE                                              0354 00513000
*                  ITEM7LEN = LENGTH(CI#);                         0354 00514000
*                                                                  0354 00515000
         B     @RC00352                                            0354 00516000
@RF00352 MVC   ITEM7LEN(2),@CH00170                                0354 00517000
*              ITEM8NM = 'CTGPSWD';    /*PASSWORD                    */ 00518000
@RC00352 MVI   ITEM8NM+7,C' '                                      0355 00519000
         MVC   ITEM8NM(7),@CC01553                                 0355 00520000
*              IF CTGPSWD = NULLPTR                                0356 00521000
*                THEN                                              0356 00522000
         L     @04,CTGPLPTR                                        0356 00523000
         L     @15,CTGPSWD(,@04)                                   0356 00524000
         LTR   @15,@15                                             0356 00525000
         BNZ   @RF00356                                            0356 00526000
*                  DO;                                             0357 00527000
*                  ITEM8PTR = ADDR(CTGPSWD);                       0358 00528000
         LA    @04,CTGPSWD(,@04)                                   0358 00529000
         ST    @04,ITEM8PTR                                        0358 00530000
*                  ITEM8LEN = LENGTH(CTGPSWD);                     0359 00531000
         MVC   ITEM8LEN(2),@CH00050                                0359 00532000
*                  ITEM8TYP = 'H';                                 0360 00533000
         MVI   ITEM8TYP,C'H'                                       0360 00534000
*                  END;                                            0361 00535000
*                ELSE                                              0362 00536000
*                  DO;                                             0362 00537000
         B     @RC00356                                            0362 00538000
@RF00356 DS    0H                                                  0363 00539000
*                  ITEM8PTR = CTGPSWD;                             0363 00540000
         L     @04,CTGPLPTR                                        0363 00541000
         L     @04,CTGPSWD(,@04)                                   0363 00542000
         ST    @04,ITEM8PTR                                        0363 00543000
*                  ITEM8TYP = 'C';                                 0364 00544000
         MVI   ITEM8TYP,C'C'                                       0364 00545000
*                  ITEM8LEN = LENGTH(MPW);                         0365 00546000
         MVC   ITEM8LEN(2),@CH00187                                0365 00547000
*                  END;                                            0366 00548000
*              IF GDTDBG = NULLPTR                                 0367 00549000
*                THEN;                                             0367 00550000
@RC00356 L     @04,@PC00001                                        0367 00551000
         L     @04,GDTDBG(,@04)                                    0367 00552000
         LTR   @04,@04                                             0367 00553000
         BZ    @RT00367                                            0367 00554000
*                ELSE                                              0369 00555000
*                  CALL IDCDB010 (GDTTBL, 'LCBL',ADDR(DUMPARMS));  0369 00556000
         L     @04,@PC00001                                        0369 00557000
         ST    @04,@AL00001                                        0369 00558000
         LA    @15,@CC01554                                        0369 00559000
         ST    @15,@AL00001+4                                      0369 00560000
         LA    @15,DUMPARMS                                        0369 00561000
         ST    @15,@AFTEMPS                                        0369 00562000
         LA    @15,@AFTEMPS                                        0369 00563000
         ST    @15,@AL00001+8                                      0369 00564000
         MVI   @AL00001+8,X'80'                                    0369 00565000
         L     @15,GDTDBG(,@04)                                    0369 00566000
         LA    @01,@AL00001                                        0369 00567000
         BALR  @14,@15                                             0369 00568000
*            END;                                                  0370 00569000
@RT00367 DS    0H                                                  0371 00570000
*        /************************************************************/ 00571000
*        /*                                                          */ 00572000
*        /* ISSUE VSAM CATALOG LOCATE REQUEST.                       */ 00573000
*        /*                                                          */ 00574000
*        /************************************************************/ 00575000
*                                                                  0371 00576000
*        CALL IDCSACA0 (GDTTBL,                                    0371 00577000
*                CTGPLPTR);                                        0371 00578000
*                                                                  0371 00579000
@RF00309 L     @04,@PC00001                                        0371 00580000
         ST    @04,@AL00001                                        0371 00581000
         LA    @15,CTGPLPTR                                        0371 00582000
         ST    @15,@AL00001+4                                      0371 00583000
         L     @15,GDTCAT(,@04)                                    0371 00584000
         LA    @01,@AL00001                                        0371 00585000
         BALR  @14,@15                                             0371 00586000
*        RESPECIFY (CATRCREG) RSTD;                        /*@ZA05939*/ 00587000
*        CATRC = CATRCREG;                                         0373 00588000
         STH   CATRCREG,CATRC                                      0373 00589000
*        RESPECIFY (CATRCREG) UNRSTD;                      /*@ZA05939*/ 00590000
*                                                                  0374 00591000
*        /************************************************************/ 00592000
*        /*                                                  @Y30SSMK*/ 00593000
*        /* SAVE THE CPL WITH THE VSAM INITIALIZED FIELDS    @Y30SSMK*/ 00594000
*        /* FOR USE LATER IF UERROR IS INVOKED AS A RESULT   @Y30SSMK*/ 00595000
*        /* OF A CATALOG LOCATE ERROR.                       @Y30SSMK*/ 00596000
*        /*                                                  @Y30SSMK*/ 00597000
*        /************************************************************/ 00598000
*                                                                  0375 00599000
*        IF ENTNMSW = ON                                           0375 00600000
*          THEN                                                    0375 00601000
         L     @04,@PC00002+8                                      0375 00602000
         TM    ENTNMSW(@04),B'10000000'                            0375 00603000
         BNO   @RF00375                                            0375 00604000
*            DO;                                           /*@Y30SSMK*/ 00605000
*              ERRCPLPT = ER#CPLPT;                        /*@Y30SSMK*/ 00606000
         L     @04,ER#CPLPT                                        0377 00607000
         ST    @04,ERRCPLPT                                        0377 00608000
*              ER#CPLPT->SAVCPL(1:LC#CPLLN) = CTGPL(1:LC#CPLLN);   0378 00609000
         LH    @15,LC#CPLLN                                        0378 00610000
         BCTR  @15,0                                               0378 00611000
         L     @01,CTGPLPTR                                        0378 00612000
         EX    @15,@SM01747                                        0378 00613000
*            END;                                          /*@Y30SSMK*/ 00614000
*          ELSE                                                    0380 00615000
*            DO;                                           /*@Y30SSMK*/ 00616000
         B     @RC00375                                            0380 00617000
@RF00375 DS    0H                                                  0381 00618000
*              ERRCPLPT = ERMCPLPT;                        /*@Y30SSMK*/ 00619000
         L     @04,ERMCPLPT                                        0381 00620000
         ST    @04,ERRCPLPT                                        0381 00621000
*              ERMCPLPT->SAVCPL(1:LCCPLLEN) = CTGPL(1:LCCPLLEN);   0382 00622000
         SLR   @15,@15                                             0382 00623000
         IC    @15,LCCPLLEN                                        0382 00624000
         BCTR  @15,0                                               0382 00625000
         L     @01,CTGPLPTR                                        0382 00626000
         EX    @15,@SM01747                                        0382 00627000
*            END;                                          /*@Y30SSMK*/ 00628000
*                                                                  0383 00629000
*        /************************************************************/ 00630000
*        /*                                                          */ 00631000
*        /* CHECK FOR AN UNSUCCESSFUL LOCATE AND MAKE A SECOND       */ 00632000
*        /* LOCATE ATTEMPT SHOULD THE VSAM CATALOG RETURN CODE       */ 00633000
*        /* INDICATE AN INSUFFICIENT WORKAREA.  OTHERWISE, RETURN    */ 00634000
*        /* TO THE CALLER TO PROCESS THE NON-ZERO RETURN CODE.       */ 00635000
*        /*                                                          */ 00636000
*        /************************************************************/ 00637000
*                                                                  0384 00638000
*        IF CATRC > CRCSUCC                                        0384 00639000
*          THEN                                                    0384 00640000
@RC00375 LH    @04,CATRC                                           0384 00641000
         LTR   @04,@04                                             0384 00642000
         BNP   @RF00384                                            0384 00643000
*            IF CATRC = CRCWKASZ                                   0385 00644000
*              THEN                                                0385 00645000
         C     @04,@CF01249                                        0385 00646000
         BNE   @RF00385                                            0385 00647000
*                IF ENTNMSW = ON                                   0386 00648000
*                  THEN                                            0386 00649000
*                                                                  0386 00650000
         L     @04,@PC00002+8                                      0386 00651000
         TM    ENTNMSW(@04),B'10000000'                            0386 00652000
         BNO   @RF00386                                            0386 00653000
*                    /************************************************/ 00654000
*                    /*                                      @YL026UE*/ 00655000
*                    /* INSUFFICIENT-WORKAREA CONDITION OCCURRED UPON*/ 00656000
*                    /* RETRIEVAL OF ONLY AN ENTRYNAME.  EXIT WITH   */ 00657000
*                    /* A TERMINATING ERROR.                 @YL026UE*/ 00658000
*                    /* NOTE - THIS CONDITION SHOULD NOT OCCUR       */ 00659000
*                    /* UNLESS A CHANGE IN FUNCTIONAL SPECIFICATIONS */ 00660000
*                    /* WAS NOT IMPLEMENTED.                 @YL026UE*/ 00661000
*                    /*                                      @YL026UE*/ 00662000
*                    /************************************************/ 00663000
*                                                                  0387 00664000
*                    DO;                                   /*@YL026UE*/ 00665000
*                      ERRARGPT->DARGSMOD = UV0ID;         /*@YL026UE*/ 00666000
         L     @04,ERRARGPT                                        0388 00667000
         MVC   DARGSMOD(3,@04),@CC01290                            0388 00668000
*                      ERRARGPT->DARGSENT = UVMSG07;       /*@YL026UE*/ 00669000
         MVI   DARGSENT(@04),X'07'                                 0389 00670000
*                      SAVRC = LASTCC12;                   /*@ZA05939*/ 00671000
         LA    @04,12                                              0390 00672000
         STH   @04,SAVRC                                           0390 00673000
*                      RETURN CODE (LASTCC12);             /*@YL026UE*/ 00674000
         LR    @15,@04                                             0391 00675000
         L     @13,4(,@13)                                         0391 00676000
         L     @14,12(,@13)                                        0391 00677000
         LM    @00,@12,20(@13)                                     0391 00678000
         BR    @14                                                 0391 00679000
*                    END;                                  /*@YL026UE*/ 00680000
*                  /**************************************************/ 00681000
*                  /*                                        @YL026UE*/ 00682000
*                  /* THE INSUFFICIENT WORKAREA CONDITION OCCURRED   */ 00683000
*                  /* UPON RETRIEVAL OF A SUBSET OF ENTRY FIELDS.    */ 00684000
*                  /* OBTAIN STORAGE FOR THE LARGER WORKAREA @YL026UE*/ 00685000
*                  /* SPECIFIED BY CAT/DADSM IN THE SECOND LENGTH    */ 00686000
*                  /* FIELD OF THE WORKAREA.                 @YL026UE*/ 00687000
*                  /*                                        @YL026UE*/ 00688000
*                  /**************************************************/ 00689000
*                                                                  0393 00690000
*                  ELSE                                            0393 00691000
*MOREWKA:            DO;                                           0393 00692000
@RF00386 DS    0H                                                  0393 00693000
MOREWKA  DS    0H                                                  0394 00694000
*                      GPID = GPID08;                      /*@ZA05939*/ 00695000
         MVC   GPID(4),@CC01396                                    0394 00696000
*                      GPLEN = REQWKASZ;                           0395 00697000
*                                                                  0395 00698000
         L     @04,CTGPLPTR                                        0395 00699000
         L     @04,CTGWKA(,@04)                                    0395 00700000
         LH    @04,REQWKASZ(,@04)                                  0395 00701000
         ST    @04,GPLEN                                           0395 00702000
*                      CALL IDCSAGP0 (GDTTBL,                      0396 00703000
*                              GPLEN,                              0396 00704000
*                              TEMPWKA,                            0396 00705000
*                              GPID,                               0396 00706000
*                              SETZERO);                           0396 00707000
         L     @04,@PC00001                                        0396 00708000
         ST    @04,@AL00001                                        0396 00709000
         LA    @02,GPLEN                                           0396 00710000
         ST    @02,@AL00001+4                                      0396 00711000
         LA    @02,TEMPWKA                                         0396 00712000
         ST    @02,@AL00001+8                                      0396 00713000
         LA    @02,GPID                                            0396 00714000
         ST    @02,@AL00001+12                                     0396 00715000
         LA    @02,SETZERO                                         0396 00716000
         ST    @02,@AL00001+16                                     0396 00717000
         MVI   @AL00001+16,X'80'                                   0396 00718000
         L     @15,GDTGPL(,@04)                                    0396 00719000
         LA    @01,@AL00001                                        0396 00720000
         BALR  @14,@15                                             0396 00721000
*                      RESPECIFY RTNREG RSTD;                      0397 00722000
*                      TESTRC = RTNREG;                            0398 00723000
         LR    TESTRC,RTNREG                                       0398 00724000
*                      RESPECIFY RTNREG UNRSTD;                    0399 00725000
*                      IF TESTRC ^= 0                              0400 00726000
*                        THEN                                      0400 00727000
*                                                                  0400 00728000
         LTR   TESTRC,TESTRC                                       0400 00729000
         BZ    @RF00400                                            0400 00730000
*                          /******************************************/ 00731000
*                          /*                                        */ 00732000
*                          /* GET STORAGE REQUEST FAILED.            */ 00733000
*                          /* SETUP THE APPROPRIATE DIAGNOSTIC.      */ 00734000
*                          /*                                        */ 00735000
*                          /******************************************/ 00736000
*                                                                  0401 00737000
*                          DO;                                     0401 00738000
*                            ERRARGPT->DARGSMOD = LC1ID;           0402 00739000
         L     @04,ERRARGPT                                        0402 00740000
         MVC   DARGSMOD(3,@04),@CC01297                            0402 00741000
*                            ERRARGPT->DARGSENT = LCMSG02;         0403 00742000
         MVI   DARGSENT(@04),X'02'                                 0403 00743000
*                            ERRARGPT->DARGDBP = ENT44FPT->CTGFLPT(1);  00744000
         L     @15,ENT44FPT                                        0404 00745000
         L     @14,CTGFLPT(,@15)                                   0404 00746000
         ST    @14,DARGDBP(,@04)                                   0404 00747000
*                            ERRARGPT->DARGILP = ENT44FPT->CTGFLNG(1);  00748000
         L     @15,CTGFLNG(,@15)                                   0405 00749000
         STH   @15,DARGILP(,@04)                                   0405 00750000
*                          END;                                    0406 00751000
*                        /********************************************/ 00752000
*                        /*                                          */ 00753000
*                        /* RELEASE THE SMALLER WORKAREA.            */ 00754000
*                        /* PREPARE FOR THE SECOND LOCATE ATTEMPT.   */ 00755000
*                        /*                                          */ 00756000
*                        /********************************************/ 00757000
*                                                                  0407 00758000
*                        ELSE                                      0407 00759000
*                          DO;                                     0407 00760000
         B     @RC00400                                            0407 00761000
@RF00400 DS    0H                                                  0408 00762000
*                            CALL IDCSAFP0 (GDTTBL,                0408 00763000
*                                    'LC02');                      0408 00764000
         L     @04,@PC00001                                        0408 00765000
         ST    @04,@AL00001                                        0408 00766000
         LA    @15,@CC01427                                        0408 00767000
         ST    @15,@AL00001+4                                      0408 00768000
         MVI   @AL00001+4,X'80'                                    0408 00769000
         L     @15,GDTFPL(,@04)                                    0408 00770000
         LA    @01,@AL00001                                        0408 00771000
         BALR  @14,@15                                             0408 00772000
*                            SAVCPLPT->CTGWKA = TEMPWKA;           0409 00773000
         L     @04,TEMPWKA                                         0409 00774000
         L     @01,SAVCPLPT                                        0409 00775000
         ST    @04,CTGWKA(,@01)                                    0409 00776000
*                            OLDCPLPT->CTGWKA = TEMPWKA;           0410 00777000
         L     @15,OLDCPLPT                                        0410 00778000
         ST    @04,CTGWKA(,@15)                                    0410 00779000
*                            CTGPL(1:LCCPLLEN) =                   0411 00780000
*                              OLDCPLPT->SAVCPL(1:LCCPLLEN);       0411 00781000
         L     @04,CTGPLPTR                                        0411 00782000
         SLR   @14,@14                                             0411 00783000
         IC    @14,LCCPLLEN                                        0411 00784000
         BCTR  @14,0                                               0411 00785000
         EX    @14,@SM01751                                        0411 00786000
*                            CPLWKASZ = GPLEN;                     0412 00787000
*                                                                  0412 00788000
         L     @04,CTGWKA(,@04)                                    0412 00789000
         L     @15,GPLEN                                           0412 00790000
         STH   @15,CPLWKASZ(,@04)                                  0412 00791000
*                            CALL FPLPROC;                         0413 00792000
         BAL   @14,FPLPROC                                         0413 00793000
*                            CATRC = 0;                            0414 00794000
*                                                                  0414 00795000
         SLR   @04,@04                                             0414 00796000
         STH   @04,CATRC                                           0414 00797000
*                            /****************************************/ 00798000
*                            /*                                      */ 00799000
*                            /* ISSUE THE SECOND LOCATE BECAUSE OF   */ 00800000
*                            /* AN INSUFFICIENT WORKAREA CONDITION.  */ 00801000
*                            /*                                      */ 00802000
*                            /****************************************/ 00803000
*                                                                  0415 00804000
*                            CALL IDCSACA0 (GDTTBL,                0415 00805000
*                                    CTGPLPTR);                    0415 00806000
*                                                                  0415 00807000
         L     @04,@PC00001                                        0415 00808000
         ST    @04,@AL00001                                        0415 00809000
         LA    @15,CTGPLPTR                                        0415 00810000
         ST    @15,@AL00001+4                                      0415 00811000
         L     @15,GDTCAT(,@04)                                    0415 00812000
         LA    @01,@AL00001                                        0415 00813000
         BALR  @14,@15                                             0415 00814000
*                            RESPECIFY (CATRCREG) RSTD;    /*@ZA05939*/ 00815000
*                            CATRC = CATRCREG;                     0417 00816000
         STH   CATRCREG,CATRC                                      0417 00817000
*                            RESPECIFY (CATRCREG) UNRSTD;  /*@ZA05939*/ 00818000
*                                                                  0418 00819000
*                            /****************************************/ 00820000
*                            /*                              @Y30SSMK*/ 00821000
*                            /* SAVE THE CPL WITH THE VSAM   @Y30SSMK*/ 00822000
*                            /* INITIALIZED FIELDS FOR USE   @Y30SSMK*/ 00823000
*                            /* LATER IF UERROR IS INVOKED   @Y30SSMK*/ 00824000
*                            /* AS A RESULT OF A CATALOG     @Y30SSMK*/ 00825000
*                            /* LOCATE ERROR.                @Y30SSMK*/ 00826000
*                            /*                              @Y30SSMK*/ 00827000
*                            /****************************************/ 00828000
*                                                                  0419 00829000
*                            ERRCPLPT = ERMCPLPT;          /*@Y30SSMK*/ 00830000
         L     @04,ERMCPLPT                                        0419 00831000
         ST    @04,ERRCPLPT                                        0419 00832000
*                            ERMCPLPT->SAVCPL(1:LCCPLLEN) =        0420 00833000
*                              CTGPL(1:LCCPLLEN);          /*@Y30SSMK*/ 00834000
*                                                                  0420 00835000
         SLR   @15,@15                                             0420 00836000
         IC    @15,LCCPLLEN                                        0420 00837000
         BCTR  @15,0                                               0420 00838000
         L     @01,CTGPLPTR                                        0420 00839000
         EX    @15,@SM01747                                        0420 00840000
*                            /****************************************/ 00841000
*                            /*                                      */ 00842000
*                            /* IF THE LOCATE IS AGAIN UNSUCCESSFUL, */ 00843000
*                            /* SETUP THE APPROPRIATE DIAGNOSTIC.    */ 00844000
*                            /*                                      */ 00845000
*                            /****************************************/ 00846000
*                                                                  0421 00847000
*                            IF CATRC ^= CRCSUCC                   0421 00848000
*                              THEN                                0421 00849000
         LH    @04,CATRC                                           0421 00850000
         LTR   @04,@04                                             0421 00851000
         BZ    @RF00421                                            0421 00852000
*                                IF CATRC = CRCWKASZ               0422 00853000
*                                  THEN                            0422 00854000
         C     @04,@CF01249                                        0422 00855000
         BNE   @RF00422                                            0422 00856000
*                                    DO;                           0423 00857000
*                                    ERRARGPT->DARGSMOD = LC1ID;   0424 00858000
         L     @04,ERRARGPT                                        0424 00859000
         MVC   DARGSMOD(3,@04),@CC01297                            0424 00860000
*                                    ERRARGPT->DARGSENT = LCMSG02; 0425 00861000
         MVI   DARGSENT(@04),X'02'                                 0425 00862000
*                                    ERRARGPT->DARGDBP =           0426 00863000
*                                      ENT44FPT->CTGFLPT(1);       0426 00864000
         L     @15,ENT44FPT                                        0426 00865000
         L     @14,CTGFLPT(,@15)                                   0426 00866000
         ST    @14,DARGDBP(,@04)                                   0426 00867000
*                                    ERRARGPT->DARGILP =           0427 00868000
*                                      ENT44FPT->CTGFLNG(1);       0427 00869000
         L     @15,CTGFLNG(,@15)                                   0427 00870000
         STH   @15,DARGILP(,@04)                                   0427 00871000
*                                    END;                          0428 00872000
*                                  ELSE                            0429 00873000
*                                    DO;                           0429 00874000
         B     @RC00422                                            0429 00875000
@RF00422 DS    0H                                                  0430 00876000
*                                      ERRARGPT->DARGSMOD = UV0ID; 0430 00877000
         L     @04,ERRARGPT                                        0430 00878000
         MVC   DARGSMOD(3,@04),@CC01290                            0430 00879000
*                                      ERRARGPT->DARGSENT = UVMSG07;    00880000
         MVI   DARGSENT(@04),X'07'                                 0431 00881000
*                                    END;                          0432 00882000
*                          END;                                    0433 00883000
*                    END MOREWKA;                                  0434 00884000
*                                                                  0434 00885000
*              /******************************************************/ 00886000
*              /*                                                    */ 00887000
*              /* SETUP THE MESSAGE LISTING THE VSAM CATALOG RETURN  */ 00888000
*              /* CODE FOR ALL OTHER NON-ZERO VALUES.                */ 00889000
*              /*                                                    */ 00890000
*              /******************************************************/ 00891000
*                                                                  0435 00892000
*              ELSE                                                0435 00893000
*                DO;                                               0435 00894000
         B     @RC00385                                            0435 00895000
@RF00385 DS    0H                                                  0436 00896000
*                  ERRARGPT->DARGSMOD = UV0ID;                     0436 00897000
         L     @04,ERRARGPT                                        0436 00898000
         MVC   DARGSMOD(3,@04),@CC01290                            0436 00899000
*                  ERRARGPT->DARGSENT = UVMSG07;                   0437 00900000
         MVI   DARGSENT(@04),X'07'                                 0437 00901000
*                END;                                              0438 00902000
*                                                                  0439 00903000
*        /************************************************************/ 00904000
*        /*                                                          */ 00905000
*        /* DUMP THE CATALOG PARM LIST AND THE FIELD PARM LISTS      */ 00906000
*        /* FOLLOWING THE LOCATE REQUEST.                            */ 00907000
*        /*                                                          */ 00908000
*        /************************************************************/ 00909000
*                                                                  0439 00910000
*        IF GDTDBG = NULLPTR                                       0439 00911000
*          THEN;                                                   0439 00912000
@RC00385 DS    0H                                                  0439 00913000
@RF00384 L     @04,@PC00001                                        0439 00914000
         L     @04,GDTDBG(,@04)                                    0439 00915000
         LTR   @04,@04                                             0439 00916000
         BZ    @RT00439                                            0439 00917000
*          ELSE                                                    0441 00918000
*            CALL IDCDB010 (GDTTBL,'LCAL',ADDR(DUMPARMS));         0441 00919000
*                                                                  0441 00920000
         L     @04,@PC00001                                        0441 00921000
         ST    @04,@AL00001                                        0441 00922000
         LA    @15,@CC01558                                        0441 00923000
         ST    @15,@AL00001+4                                      0441 00924000
         LA    @15,DUMPARMS                                        0441 00925000
         ST    @15,@AFTEMPS                                        0441 00926000
         LA    @15,@AFTEMPS                                        0441 00927000
         ST    @15,@AL00001+8                                      0441 00928000
         MVI   @AL00001+8,X'80'                                    0441 00929000
         L     @15,GDTDBG(,@04)                                    0441 00930000
         LA    @01,@AL00001                                        0441 00931000
         BALR  @14,@15                                             0441 00932000
*        /************************************************************/ 00933000
*        /*                                                          */ 00934000
*        /* DUMP THE CATALOG DICTIONARY WORKAREA IN 256 BYTE BLOCKS, */ 00935000
*        /* USING THE LENGTH FIELD SET BY VSAM CATALOG MGMT.         */ 00936000
*        /*                                                          */ 00937000
*        /************************************************************/ 00938000
*                                                                  0442 00939000
*        IF GDTDBG ^= NULLPTR                                      0442 00940000
*          THEN                                                    0442 00941000
@RT00439 SLR   @04,@04                                             0442 00942000
         L     @15,@PC00001                                        0442 00943000
         C     @04,GDTDBG(,@15)                                    0442 00944000
         BE    @RF00442                                            0442 00945000
*            DO;                                                   0443 00946000
*            ARYNM = 'CTGWKA';                                     0444 00947000
         MVI   ARYNM+6,C' '                                        0444 00948000
         MVI   ARYNM+7,C' '                                        0444 00949000
         MVC   ARYNM(6),@CC01559                                   0444 00950000
*            ARYITEM = 1;                                          0445 00951000
         LA    @15,1                                               0445 00952000
         STH   @15,ARYITEM                                         0445 00953000
*            ARYHDR = 'A';                                         0446 00954000
         MVI   ARYHDR,C'A'                                         0446 00955000
*            ITEM1NM = 'WKA';                                      0447 00956000
         MVI   ITEM1NM+3,C' '                                      0447 00957000
         MVC   ITEM1NM+4(4),ITEM1NM+3                              0447 00958000
         MVC   ITEM1NM(3),@CC01560                                 0447 00959000
*            ITEM1PTR = CTGWKA;                                    0448 00960000
         L     @14,CTGPLPTR                                        0448 00961000
         L     @07,CTGWKA(,@14)                                    0448 00962000
         ST    @07,ITEM1PTR                                        0448 00963000
*            ITEM1TYP = 'H';                                       0449 00964000
         MVI   ITEM1TYP,C'H'                                       0449 00965000
*            ITEM0NM = 'CTGWKAPT';                                 0450 00966000
         MVC   ITEM0NM(8),@CC01561                                 0450 00967000
*            ITEM0PTR = ADDR(CTGWKA);                              0451 00968000
         LA    @14,CTGWKA(,@14)                                    0451 00969000
         ST    @14,ITEM0PTR                                        0451 00970000
*            ITEM0TYP = 'H';                                       0452 00971000
         MVI   ITEM0TYP,C'H'                                       0452 00972000
*            ITEM0LEN = LENGTH(CTGWKA);                            0453 00973000
*                                                                  0453 00974000
         LA    @14,4                                               0453 00975000
         STH   @14,ITEM0LEN                                        0453 00976000
*            /********************************************************/ 00977000
*            /*                                                      */ 00978000
*            /* FOR AN UNSUCCESSFUL LOCATE REQUEST, THE LENGTH FIELD */ 00979000
*            /* SET BY CATALOG MANAGEMENT MAY BE ZERO.  IF SO, DUMP  */ 00980000
*            /* ONLY THE TWO LENGTH FIELDS OF THE WORKAREA.          */ 00981000
*            /*                                                      */ 00982000
*            /********************************************************/ 00983000
*                                                                  0454 00984000
*            IF REQWKASZ = 0                                       0454 00985000
*              THEN                                                0454 00986000
         CH    @04,REQWKASZ(,@07)                                  0454 00987000
         BNE   @RF00454                                            0454 00988000
*                DO;                                               0455 00989000
*                ARYSZ = LENGTH(CPLWKASZ) + LENGTH(REQWKASZ);      0456 00990000
         STH   @14,ARYSZ                                           0456 00991000
*                ITEM1LEN = ARYSZ;                                 0457 00992000
         STH   @14,ITEM1LEN                                        0457 00993000
*                ARYEXT = 1;                                       0458 00994000
         STH   @15,ARYEXT                                          0458 00995000
*                LIST2END = 'FF'X;                                 0459 00996000
         MVI   LIST2END,X'FF'                                      0459 00997000
*                END;                                              0460 00998000
*              ELSE                                                0461 00999000
*                IF ENTNMSW = ON                                   0461 01000000
*                  THEN                /*SHORT WKA FOR ENTRYNAME     */ 01001000
         B     @RC00454                                            0461 01002000
@RF00454 L     @04,@PC00002+8                                      0461 01003000
         TM    ENTNMSW(@04),B'10000000'                            0461 01004000
         BNO   @RF00461                                            0461 01005000
*                    DO;                                           0462 01006000
*                    ARYSZ = ENTREQSZ;                             0463 01007000
         L     @04,ENTWKAPT                                        0463 01008000
         LH    @04,ENTREQSZ(,@04)                                  0463 01009000
         STH   @04,ARYSZ                                           0463 01010000
*                    ITEM1LEN = ENTREQSZ;                          0464 01011000
         STH   @04,ITEM1LEN                                        0464 01012000
*                    ARYEXT = 1;                                   0465 01013000
         MVC   ARYEXT(2),@CH00045                                  0465 01014000
*                    LIST2END = 'FF'X;                             0466 01015000
         MVI   LIST2END,X'FF'                                      0466 01016000
*                    END;                                          0467 01017000
*                  /**************************************************/ 01018000
*                  /*                                                */ 01019000
*                  /* DUMP THE FIELDS RETURNED IN THE MAIN WORKAREA. */ 01020000
*                  /* TO AVOID REFERENCING OUTSIDE THE LISTC STORAGE */ 01021000
*                  /* AREA, SETUP ADDITIONAL DUMP PARMS FOR THOSE    */ 01022000
*                  /* TRAILING WORKAREA BYTES LESS THAN A 256 BYTE   */ 01023000
*                  /* MULTIPLE.                                      */ 01024000
*                  /*                                                */ 01025000
*                  /**************************************************/ 01026000
*                                                                  0468 01027000
*                  ELSE                                            0468 01028000
*TOTWKA:             DO;                                           0468 01029000
         B     @RC00461                                            0468 01030000
@RF00461 DS    0H                                                  0468 01031000
TOTWKA   DS    0H                                                  0469 01032000
*                    ARYEXT = REQWKASZ/MAXMVLEN;           /*@Y30SSMK*/ 01033000
         L     @04,CTGPLPTR                                        0469 01034000
         L     @04,CTGWKA(,@04)                                    0469 01035000
         LH    @04,REQWKASZ(,@04)                                  0469 01036000
         LR    @15,@04                                             0469 01037000
         SRL   @15,8                                               0469 01038000
         STH   @15,ARYEXT                                          0469 01039000
*                    ITEM2LEN = REQWKASZ//MAXMVLEN;        /*@Y30SSMK*/ 01040000
         LR    @00,@04                                             0470 01041000
         SRDA  @00,32                                              0470 01042000
         D     @00,@CF00044                                        0470 01043000
         STH   @00,ITEM2LEN                                        0470 01044000
*                    IF ARYEXT = 0                                 0471 01045000
*                      THEN            /*WKA LT 256 BYTES            */ 01046000
         LTR   @15,@15                                             0471 01047000
         BNZ   @RF00471                                            0471 01048000
*                        DO;                                       0472 01049000
*                          ARYSZ = ITEM2LEN;                       0473 01050000
         STH   @00,ARYSZ                                           0473 01051000
*                          ITEM1LEN = ITEM2LEN;                    0474 01052000
         STH   @00,ITEM1LEN                                        0474 01053000
*                          ARYEXT = 1;                             0475 01054000
         MVC   ARYEXT(2),@CH00045                                  0475 01055000
*                          LIST2END = 'FF'X;                       0476 01056000
         MVI   LIST2END,X'FF'                                      0476 01057000
*                        END;                                      0477 01058000
*                      ELSE            /*WKA MULTIPLE OF 256 BYTES   */ 01059000
*                        DO;                                       0478 01060000
         B     @RC00471                                            0478 01061000
@RF00471 DS    0H                                                  0479 01062000
*                          ARYSZ = MAXMVLEN;               /*@Y30SSMK*/ 01063000
         LA    @04,256                                             0479 01064000
         STH   @04,ARYSZ                                           0479 01065000
*                          ITEM1LEN = MAXMVLEN;            /*@Y30SSMK*/ 01066000
         STH   @04,ITEM1LEN                                        0480 01067000
*                          IF ITEM2LEN > 0                         0481 01068000
*                            THEN      /*WKA REMAINDER LT 256 BYTES  */ 01069000
         LH    @00,ITEM2LEN                                        0481 01070000
         LTR   @00,@00                                             0481 01071000
         BNP   @RF00481                                            0481 01072000
*                              DO;                                 0482 01073000
*                                LISTEND = 'FF'X;                  0483 01074000
         MVI   LISTEND,X'FF'                                       0483 01075000
*                                ITEM2NM = 'WKAEND';               0484 01076000
         MVI   ITEM2NM+6,C' '                                      0484 01077000
         MVI   ITEM2NM+7,C' '                                      0484 01078000
         MVC   ITEM2NM(6),@CC01564                                 0484 01079000
*                                ITEM2PTR = CTGWKA + (ARYEXT*MAXMVLEN); 01080000
         LH    @04,ARYEXT                                          0485 01081000
         SLA   @04,8                                               0485 01082000
         L     @15,CTGPLPTR                                        0485 01083000
         AL    @04,CTGWKA(,@15)                                    0485 01084000
         ST    @04,ITEM2PTR                                        0485 01085000
*                                ITEM2TYP = 'H';                   0486 01086000
         MVI   ITEM2TYP,C'H'                                       0486 01087000
*                              END;                                0487 01088000
*                            ELSE      /*NO WKA REMAINDER            */ 01089000
*                              LIST2END = 'FF'X;                   0488 01090000
         B     @RC00481                                            0488 01091000
@RF00481 MVI   LIST2END,X'FF'                                      0488 01092000
*                        END;                                      0489 01093000
@RC00481 DS    0H                                                  0490 01094000
*                    END TOTWKA;                                   0490 01095000
*                                                                  0490 01096000
@RC00471 DS    0H                                                  0491 01097000
*              IF GDTDBG = NULLPTR                                 0491 01098000
*                THEN;                                             0491 01099000
@RC00461 DS    0H                                                  0491 01100000
@RC00454 L     @04,@PC00001                                        0491 01101000
         L     @04,GDTDBG(,@04)                                    0491 01102000
         LTR   @04,@04                                             0491 01103000
         BZ    @RT00491                                            0491 01104000
*                ELSE                                              0493 01105000
*                  CALL IDCDB010 (GDTTBL,'LCWA',ADDR(DUMPWKA));    0493 01106000
         L     @04,@PC00001                                        0493 01107000
         ST    @04,@AL00001                                        0493 01108000
         LA    @00,@CC01565                                        0493 01109000
         ST    @00,@AL00001+4                                      0493 01110000
         LA    @00,DUMPWKA                                         0493 01111000
         ST    @00,@AFTEMPS                                        0493 01112000
         LA    @00,@AFTEMPS                                        0493 01113000
         ST    @00,@AL00001+8                                      0493 01114000
         MVI   @AL00001+8,X'80'                                    0493 01115000
         L     @15,GDTDBG(,@04)                                    0493 01116000
         LA    @01,@AL00001                                        0493 01117000
         BALR  @14,@15                                             0493 01118000
*            END;                                                  0494 01119000
@RT00491 DS    0H                                                  0495 01120000
*        /************************************************************/ 01121000
*        /*                                                          */ 01122000
*        /* RESTORE THE APPROPRIATE CPL                              */ 01123000
*        /*                                                          */ 01124000
*        /************************************************************/ 01125000
*                                                                  0495 01126000
*        IF ENTNMSW = ON                                           0495 01127000
*          THEN                        /*RESTORE ENTRYNAME CPL       */ 01128000
@RF00442 L     @04,@PC00002+8                                      0495 01129000
         TM    ENTNMSW(@04),B'10000000'                            0495 01130000
         BNO   @RF00495                                            0495 01131000
*            CTGPL(1:LC#CPLLN) = SA#CPLPT->SAVCPL(1:LC#CPLLN);     0496 01132000
         L     @04,CTGPLPTR                                        0496 01133000
         LH    @15,LC#CPLLN                                        0496 01134000
         BCTR  @15,0                                               0496 01135000
         L     @14,SA#CPLPT                                        0496 01136000
         EX    @15,@SM01753                                        0496 01137000
*          ELSE                        /*RESTORE SUPERSET CPL        */ 01138000
*            CTGPL(1:LCCPLLEN) = SAVCPLPT->SAVCPL(1:LCCPLLEN);     0497 01139000
         B     @RC00495                                            0497 01140000
@RF00495 L     @04,CTGPLPTR                                        0497 01141000
         SLR   @15,@15                                             0497 01142000
         IC    @15,LCCPLLEN                                        0497 01143000
         BCTR  @15,0                                               0497 01144000
         L     @14,SAVCPLPT                                        0497 01145000
         EX    @15,@SM01753                                        0497 01146000
*        /************************************************************/ 01147000
*        /*                                                          */ 01148000
*        /* ESTABLISH THE SUBTITLE LINE AT THIS POINT NOW THAT THE   */ 01149000
*        /* CATALOG NAME IS SURELY KNOWN AFTER THE FIRST LOCATE      */ 01150000
*        /* REQUEST.                                                 */ 01151000
*        /*                                                          */ 01152000
*        /************************************************************/ 01153000
*                                                                  0498 01154000
*        IF SUBTFLG = OFF & GDTECT = NULLPTR                 /*YM4128*/ 01155000
*          THEN                        /*GET SUBTITLE STATIC TEXT    */ 01156000
@RC00495 TM    SUBTFLG,B'10000000'                                 0498 01157000
         BNZ   @RF00498                                            0498 01158000
         L     @04,@PC00001                                        0498 01159000
         L     @04,GDTECT(,@04)                                    0498 01160000
         LTR   @04,@04                                             0498 01161000
         BNZ   @RF00498                                            0498 01162000
*            DO;                                                   0499 01163000
*              SUBTFLG = ON;                                       0500 01164000
         OI    SUBTFLG,B'10000000'                                 0500 01165000
*              DARGSENT = LCST02;                                  0501 01166000
         L     @04,DARGPTR                                         0501 01167000
         MVI   DARGSENT(@04),X'02'                                 0501 01168000
*              DARGRETP = ADDR(LCSUBTIT);                          0502 01169000
         LA    @00,LCSUBTIT                                        0502 01170000
         ST    @00,DARGRETP(,@04)                                  0502 01171000
*              DARGRETL = LENGTH(LCSUBTIT);                        0503 01172000
         MVC   DARGRETL(2,@04),@CH01743                            0503 01173000
*              DARGCNT = DRGCNT1;                          /*@Y30SSMK*/ 01174000
         MVC   DARGCNT(2,@04),@CH00045                             0504 01175000
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/ 01176000
         MVC   DARGINS(2,@04),@CH00457                             0505 01177000
*              DARGINL(1) = LENGTH(CATNAME);                       0506 01178000
         MVC   DARGINL(2,@04),@CH00606                             0506 01179000
*              DARGDTM(1) = ADDR(CATNAME);                         0507 01180000
         LA    @00,CATNAME                                         0507 01181000
         ST    @00,DARGDTM(,@04)                                   0507 01182000
*              CALL LISTPROC;                                      0508 01183000
*                                                                  0508 01184000
         BAL   @14,LISTPROC                                        0508 01185000
*              /******************************************************/ 01186000
*              /*                                                    */ 01187000
*              /* ESTABLISH THE SUBTITLE FOR THE CATALOG LISTING VIA */ 01188000
*              /* THE UESTA AMS TEXT PROCESSOR MACRO.                */ 01189000
*              /*                                                    */ 01190000
*              /******************************************************/ 01191000
*                                                                  0509 01192000
*              PCARG = ZEROAREA;                                   0509 01193000
         MVC   PCARG(33),ZEROAREA                                  0509 01194000
*              PCSTLP = ADDR(LCSUBTIT);                            0510 01195000
         LA    @04,LCSUBTIT                                        0510 01196000
         ST    @04,PCSTLP                                          0510 01197000
*              PCSTLC = 1;                                         0511 01198000
*                                                                  0511 01199000
         MVC   PCSTLC(2),@CH00045                                  0511 01200000
*              CALL AMSTP042 (GDTTBL, OTIOCSPT, PCARG);            0512 01201000
         L     @04,@PC00001                                        0512 01202000
         ST    @04,@AL00001                                        0512 01203000
         LA    @02,OTIOCSPT                                        0512 01204000
         ST    @02,@AL00001+4                                      0512 01205000
         LA    @02,PCARG                                           0512 01206000
         ST    @02,@AL00001+8                                      0512 01207000
         L     @15,GDTESA(,@04)                                    0512 01208000
         LA    @01,@AL00001                                        0512 01209000
         BALR  @14,@15                                             0512 01210000
*              RESPECIFY RTNREG RSTD;                              0513 01211000
*              TESTRC = RTNREG;                                    0514 01212000
         LR    TESTRC,RTNREG                                       0514 01213000
*              RESPECIFY RTNREG UNRSTD;                            0515 01214000
*              SAVRC = MAX (SAVRC, TESTRC);                /*@ZA05939*/ 01215000
         LH    @04,SAVRC                                           0516 01216000
         CR    @04,TESTRC                                          0516 01217000
         BNL   *+6                                                      01218000
         LR    @04,TESTRC                                          0516 01219000
         STH   @04,SAVRC                                           0516 01220000
*            END;                                                  0517 01221000
*        /************************************************************/ 01222000
*        /*                                                          */ 01223000
*        /* FOR A NON-ZERO VSAM CATALOG RETURN CODE, UPDATE THE      */ 01224000
*        /* LISTC FINAL CONDITION CODE AND EXIT AT THIS POINT.       */ 01225000
*        /*                                                          */ 01226000
*        /************************************************************/ 01227000
*                                                                  0518 01228000
*        IF CATRC ^= CRCSUCC                                       0518 01229000
*          THEN                                                    0518 01230000
*                                                                  0518 01231000
@RF00498 LH    @04,CATRC                                           0518 01232000
         LTR   @04,@04                                             0518 01233000
         BZ    @RF00518                                            0518 01234000
*            /********************************************************/ 01235000
*            /*                                                      */ 01236000
*            /* UPDATE THE FINAL CONDITION CODE UNLESS AN EOF FOR    */ 01237000
*            /* THE GETNEXT MODE OCCURRED.                           */ 01238000
*            /*                                                      */ 01239000
*            /********************************************************/ 01240000
*                                                                  0519 01241000
*            IF CATRC ^= CRCNOENT |  ENLVUDFG = ON                 0519 01242000
*              THEN                                                0519 01243000
         C     @04,@CF00187                                        0519 01244000
         BNE   @RT00519                                            0519 01245000
         TM    ENLVUDFG,B'10000000'                                0519 01246000
         BNO   @RF00519                                            0519 01247000
@RT00519 DS    0H                                                  0520 01248000
*                DO;                                               0520 01249000
*                                                                  0520 01250000
*                /****************************************************/ 01251000
*                /*                                                  */ 01252000
*                /* SHOULD PASSWORD VERIFICATION FAIL FOR EITHER THE */ 01253000
*                /* NAME SUBSET REQUEST OR WHEN LISTING THE          */ 01254000
*                /* ASSOCIATED NAMES OF A CLUSTER OR THE ENTRYNAMES  */ 01255000
*                /* FOR THE SPACE DATASET DIRECTORY, DO NOT UPDATE   */ 01256000
*                /* THE FINAL CONDITION CODE OR OUTPUT DIAGNOSTICS.  */ 01257000
*                /*                                                  */ 01258000
*                /****************************************************/ 01259000
*                                                                  0521 01260000
*                IF CATRC = CRCBADPW  &                            0521 01261000
*                  (ENTNMSW = ON  |  ADDR(NAME) > NULLPTR)         0521 01262000
*                  THEN;                                           0521 01263000
         CLC   CATRC(2),@CH01280                                   0521 01264000
         BNE   @RF00521                                            0521 01265000
         L     @04,@PC00002+8                                      0521 01266000
         TM    ENTNMSW(@04),B'10000000'                            0521 01267000
         BO    @RT00521                                            0521 01268000
         L     @04,@PC00001+4                                      0521 01269000
         L     @04,FDTPTR+52(,@04)                                 0521 01270000
         LTR   @04,@04                                             0521 01271000
         BP    @RT00521                                            0521 01272000
*                  ELSE                                            0523 01273000
*                    SAVRC = MAX (SAVRC, LASTCC04);        /*@ZA05939*/ 01274000
@RF00521 LH    @04,SAVRC                                           0523 01275000
         LA    @00,4                                               0523 01276000
         CR    @04,@00                                             0523 01277000
         BNL   *+6                                                      01278000
         LR    @04,@00                                             0523 01279000
         STH   @04,SAVRC                                           0523 01280000
*                ENTNMSW = OFF;                                    0524 01281000
@RT00521 L     @04,@PC00002+8                                      0524 01282000
         NI    ENTNMSW(@04),B'01111111'                            0524 01283000
*                RETURN CODE (LASTCC04);                           0525 01284000
         LA    @15,4                                               0525 01285000
         L     @13,4(,@13)                                         0525 01286000
         L     @14,12(,@13)                                        0525 01287000
         LM    @00,@12,20(@13)                                     0525 01288000
         BR    @14                                                 0525 01289000
*                END;                                              0526 01290000
*                                                                  0526 01291000
*              /******************************************************/ 01292000
*              /*                                                    */ 01293000
*              /* EXIT WITHOUT UPDATING THE FINAL CONDITIONAL CODE   */ 01294000
*              /* BECAUSE A VSAM CATALOG RETURN CODE OF 8 IN THE     */ 01295000
*              /* GET-NEXT MODE INDICATES AN EOF.                    */ 01296000
*              /*                                                    */ 01297000
*              /******************************************************/ 01298000
*                                                                  0527 01299000
*              ELSE                                                0527 01300000
*                DO;                                               0527 01301000
@RF00519 DS    0H                                                  0528 01302000
*                ENTNMSW = OFF;                                    0528 01303000
         L     @04,@PC00002+8                                      0528 01304000
         NI    ENTNMSW(@04),B'01111111'                            0528 01305000
*                RETURN CODE(LASTCC04);                            0529 01306000
         LA    @15,4                                               0529 01307000
         L     @13,4(,@13)                                         0529 01308000
         L     @14,12(,@13)                                        0529 01309000
         LM    @00,@12,20(@13)                                     0529 01310000
         BR    @14                                                 0529 01311000
*                END;                                              0530 01312000
*          ELSE                                                    0531 01313000
*            ENTNMSW = OFF;                                        0531 01314000
@RF00518 L     @04,@PC00002+8                                      0531 01315000
         NI    ENTNMSW(@04),B'01111111'                            0531 01316000
*        /************************************************************/ 01317000
*        /*                                                          */ 01318000
*        /* DETERMINE WHETHER THE CATALOG ACB POINTER WAS UNKNOWN    */ 01319000
*        /* FOR FIRST LOCATE REQUEST.  IF SO, INSERT IN THE CPL      */ 01320000
*        /* THE RETRIEVED ACB POINTER.                               */ 01321000
*        /*                                                          */ 01322000
*        /************************************************************/ 01323000
*                                                                  0532 01324000
*        IF CACBSW = ON    &                               /*@YL026UE*/ 01325000
*           FPLPTMAP(FPLLAST) -> CTGFLPT(1) ^= NULLPTR     /*@YL026UE*/ 01326000
*          THEN                                                    0532 01327000
         L     @04,@PC00002+4                                      0532 01328000
         TM    CACBSW(@04),B'10000000'                             0532 01329000
         BNO   @RF00532                                            0532 01330000
         L     @15,@PC00002                                        0532 01331000
         LH    @14,FPLLAST(,@15)                                   0532 01332000
         LR    @07,@14                                             0532 01333000
         SLA   @07,2                                               0532 01334000
         L     @07,FPLPTMAP-4(@07)                                 0532 01335000
         L     @06,CTGFLPT(,@07)                                   0532 01336000
         LTR   @06,@06                                             0532 01337000
         BZ    @RF00532                                            0532 01338000
*            DO;                                                   0533 01339000
*              CACBSW = OFF;           /*RESET INTERNAL SWITCH       */ 01340000
*                                                                  0534 01341000
         NI    CACBSW(@04),B'01111111'                             0534 01342000
*              /******************************************************/ 01343000
*              /*                                                    */ 01344000
*              /* LOCATE FPL ASSOCIATED WITH CATALOG ACB             */ 01345000
*              /*                                                    */ 01346000
*              /******************************************************/ 01347000
*                                                                  0535 01348000
*              CTGFLPTR = FPLPTMAP(FPLLAST);                       0535 01349000
         ST    @07,CTGFLPTR                                        0535 01350000
*              CACBPTR = CACB;         /*MOVE CAT ACB PTR TO SAVEAREA*/ 01351000
         L     @04,CTGFLPT(,@07)                                   0536 01352000
         MVC   CACBPTR(4),CACB(@04)                                0536 01353000
*              CTGCAT = ADDR(CACBPTR); /*ADDR(CAT ACB PTR) IN CPL    */ 01354000
         L     @04,CTGPLPTR                                        0537 01355000
         LA    @07,CACBPTR                                         0537 01356000
         ST    @07,CTGCAT(,@04)                                    0537 01357000
*              CTGCNAME = OFF;         /*SET CPL TO INDICATE CAT ACB */ 01358000
         NI    CTGCNAME(@04),B'11111101'                           0538 01359000
*              CTGNOFLD = CTGNOFLD-1;  /*RESET TOTAL FPL'S           */ 01360000
*                                                                  0539 01361000
         SLR   @06,@06                                             0539 01362000
         IC    @06,CTGNOFLD(,@04)                                  0539 01363000
         BCTR  @06,0                                               0539 01364000
         STC   @06,CTGNOFLD(,@04)                                  0539 01365000
*              /******************************************************/ 01366000
*              /*                                                    */ 01367000
*              /*RESET ENTRYNAME-CPL VALUES                          */ 01368000
*              /*                                                    */ 01369000
*              /******************************************************/ 01370000
*                                                                  0540 01371000
*              CI#CPLPT->CTGCAT = ADDR(CACBPTR);                   0540 01372000
         L     @04,CI#CPLPT                                        0540 01373000
         ST    @07,CTGCAT(,@04)                                    0540 01374000
*              CI#CPLPT->CTGCNAME = OFF;                           0541 01375000
*                                                                  0541 01376000
         NI    CTGCNAME(@04),B'11111101'                           0541 01377000
*              /******************************************************/ 01378000
*              /*                                                    */ 01379000
*              /*DROP THE SPECIAL CATACB FPL                         */ 01380000
*              /*                                                    */ 01381000
*              /******************************************************/ 01382000
*                                                                  0542 01383000
*              FPLCNT = FPLCNT - 1;                                0542 01384000
         LH    @04,FPLCNT                                          0542 01385000
         BCTR  @04,0                                               0542 01386000
         STH   @04,FPLCNT                                          0542 01387000
*              FPLLAST = FPLLAST - 1;                              0543 01388000
         BCTR  @14,0                                               0543 01389000
         STH   @14,FPLLAST(,@15)                                   0543 01390000
*            END;                                                  0544 01391000
*                                                                  0544 01392000
*        /************************************************************/ 01393000
*        /*                                                          */ 01394000
*        /* EXIT FROM CATALOG LOCATE ROUTINE, RETURNING TO CALLER.   */ 01395000
*        /*                                                          */ 01396000
*        /************************************************************/ 01397000
*                                                                  0545 01398000
*        RETURN CODE(0);                                           0545 01399000
@RF00532 SLR   @15,@15                                             0545 01400000
         L     @13,4(,@13)                                         0545 01401000
         L     @14,12(,@13)                                        0545 01402000
         LM    @00,@12,20(@13)                                     0545 01403000
         BR    @14                                                 0545 01404000
*        END LOCPROC;                                              0546 01405000
*        /************************************************************/ 01406000
*        /*                                                          */ 01407000
*        /* PROCEDURE NAME - FPLPROC                                 */ 01408000
*        /*                                                          */ 01409000
*        /* FUNCTION - REINITIALIZES THE STRING OF FPLS PRIOR TO     */ 01410000
*        /*            EACH CATALOG LOCATE REQUEST, BY USING THE     */ 01411000
*        /*            SAVEAREA COPY STORED AT ORIGINAL FPL BUILD    */ 01412000
*        /*            TIME.                                         */ 01413000
*        /*                                                          */ 01414000
*        /* INPUT - LENGTH OF EACH FPL AND TOTAL NUMBER OF FPLS      */ 01415000
*        /*                                                          */ 01416000
*        /* OUTPUT - RESTORED FPLS TO INITIALIZED STATE              */ 01417000
*        /*                                                          */ 01418000
*        /************************************************************/ 01419000
*                                                                  0547 01420000
*FPLPROC:                                                          0547 01421000
*        PROCEDURE OPTIONS(SAVEAREA);                              0547 01422000
*                                                                  0547 01423000
FPLPROC  STM   @14,@12,12(@13)                                     0547 01424000
         ST    @13,@SA00003+4                                      0547 01425000
         LA    @14,@SA00003                                        0547 01426000
         ST    @14,8(,@13)                                         0547 01427000
         LR    @13,@14                                             0547 01428000
*        GEN(ENTRY FPLPROC);           /*EXT ENTRY POINT     @ZA05939*/ 01429000
         ENTRY FPLPROC                                                  01430000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 01431000
*                                                                  0549 01432000
         LM    REG8,REG12,BASESAVE                                 0549 01433000
*        /************************************************************/ 01434000
*        /*                                                          */ 01435000
*        /* LOCAL VARIABLES                                          */ 01436000
*        /*                                                          */ 01437000
*        /************************************************************/ 01438000
*                                                                  0550 01439000
*        DCL FJJ  FIXED(15) UNSIGNED;  /*DO GROUP INDEX VARIABLE     */ 01440000
*        DCL TEMPTR  PTR(31);          /*TEMP PTR FOR SAVEAREA FPL'S */ 01441000
*        DCL SAFPL   CHAR(*) BASED;    /*OVERLAY OF AN FPL           */ 01442000
*        DCL FPLNAME CHAR(8) BASED;    /*OVERLAY OF FPL DICT NAME  0553 01443000
*                                                            @ZA05939*/ 01444000
*                                                                  0553 01445000
*        OLDERID2 = NEWERID2;                                      0554 01446000
         L     @04,@PC00001                                        0554 01447000
         L     @04,GDTTR2(,@04)                                    0554 01448000
         MVC   @TS00001(95),NEWERID2(@04)                          0554 01449000
         MVC   OLDERID2(95,@04),@TS00001                           0554 01450000
*        NEWID2 = 'LCFP';                                          0555 01451000
         MVC   NEWID2(4,@04),@CC01575                              0555 01452000
*        TEMPTR = SAVFPLPT;            /*POSITION TO 1ST SAVEAREA FPL*/ 01453000
         L     TEMPTR,SAVFPLPT                                     0556 01454000
*        DO FJJ = 1 TO FPLCNT;                                     0557 01455000
*                                                                  0557 01456000
         LA    FJJ,1                                               0557 01457000
         B     @DE00557                                            0557 01458000
@DL00557 DS    0H                                                  0558 01459000
*          /**********************************************************/ 01460000
*          /*                                                @Y30LSMK*/ 01461000
*          /* IF A MULTITYP FPL WAS THE FIRST FPL, RESTORE   @Y30LSMK*/ 01462000
*          /* IT WITH THE CORRECT LENGTH SINCE IT IS LONGER  @Y30LSMK*/ 01463000
*          /* THAN NORMAL FPL'S.                             @Y30LSMK*/ 01464000
*          /*                                                @Y30LSMK*/ 01465000
*          /**********************************************************/ 01466000
*                                                                  0558 01467000
*          IF CTGFIELD(FJJ)->CTGFLDNM->FPLNAME = MULTITNM          0558 01468000
*            THEN                                                  0558 01469000
         LR    @04,FJJ                                             0558 01470000
         SLA   @04,2                                               0558 01471000
         L     @15,CTGPLPTR                                        0558 01472000
         L     @04,CTGFIELD-4(@04,@15)                             0558 01473000
         L     @15,CTGFLDNM(,@04)                                  0558 01474000
         CLC   FPLNAME(8,@15),MULTITNM                             0558 01475000
         BNE   @RF00558                                            0558 01476000
*              DO;                                         /*@ZA05939*/ 01477000
*                CTGFIELD(FJJ)->CTGFL(1:MTFPLLEN) =                0560 01478000
*                  TEMPTR->SAFPL(1:MTFPLLEN);              /*@Y30LSMK*/ 01479000
         SLR   @15,@15                                             0560 01480000
         IC    @15,MTFPLLEN                                        0560 01481000
         LR    @14,@15                                             0560 01482000
         BCTR  @14,0                                               0560 01483000
         EX    @14,@SM01758                                        0560 01484000
*                TEMPTR = TEMPTR + MTFPLLEN;               /*@Y30LSMK*/ 01485000
         ALR   TEMPTR,@15                                          0561 01486000
*              END;                                        /*@Y30LSMK*/ 01487000
*            ELSE                                                  0563 01488000
*              DO;                                         /*@Y30LSMK*/ 01489000
         B     @RC00558                                            0563 01490000
@RF00558 DS    0H                                                  0564 01491000
*                CTGFIELD(FJJ)->CTGFL(1:LCFPLLEN) =                0564 01492000
*                  TEMPTR->SAFPL(1:LCFPLLEN);              /*@Y30LSMK*/ 01493000
         LR    @04,FJJ                                             0564 01494000
         SLA   @04,2                                               0564 01495000
         L     @15,CTGPLPTR                                        0564 01496000
         L     @04,CTGFIELD-4(@04,@15)                             0564 01497000
         SLR   @15,@15                                             0564 01498000
         IC    @15,LCFPLLEN                                        0564 01499000
         LR    @14,@15                                             0564 01500000
         BCTR  @14,0                                               0564 01501000
         EX    @14,@SM01758                                        0564 01502000
*                TEMPTR = TEMPTR + LCFPLLEN;               /*@Y30LSMK*/ 01503000
         ALR   TEMPTR,@15                                          0565 01504000
*              END;                                        /*@Y30LSMK*/ 01505000
*        END;                                              /*@Y30LSMK*/ 01506000
*                                                                  0567 01507000
@RC00558 AL    FJJ,@CF00045                                        0567 01508000
@DE00557 CH    FJJ,FPLCNT                                          0567 01509000
         BNH   @DL00557                                            0567 01510000
*        /************************************************************/ 01511000
*        /*                                                          */ 01512000
*        /* EXIT FROM FPL REINITIALIZATION ROUTINE, RETURNING TO     */ 01513000
*        /* CALLER.                                                  */ 01514000
*        /*                                                          */ 01515000
*        /************************************************************/ 01516000
*                                                                  0568 01517000
*        END FPLPROC;                                              0568 01518000
@EL00003 L     @13,4(,@13)                                         0568 01519000
@EF00003 DS    0H                                                  0568 01520000
@ER00003 LM    @14,@12,12(@13)                                     0568 01521000
         BR    @14                                                 0568 01522000
*        /************************************************************/ 01523000
*        /*                                                          */ 01524000
*        /* PROCEDURE NAME - ERRPROC                                 */ 01525000
*        /*                                                          */ 01526000
*        /* FUNCTION - ISSUES AMS TEXT PROCESSOR MACRO, UPRINT, AND  */ 01527000
*        /* ZEROES OUT THE DYNAMIC DATA ARGUMENT LIST UPON EXITING.  */ 01528000
*        /*                                                          */ 01529000
*        /* INPUT - OUTPUT DATA SET POINTER, AND THE DYNAMIC DATA    */ 01530000
*        /* PARM LIST FOR THE AMS TEXT PROCESSOR.                    */ 01531000
*        /*                                                          */ 01532000
*        /* OUTPUT - FORMATTED AND PRINTED MSGS AS DESCRIBED IN TEXT */ 01533000
*        /* PROCESSOR'S PARM LIST.                                   */ 01534000
*        /*                                                          */ 01535000
*        /************************************************************/ 01536000
*                                                                  0569 01537000
*ERRPROC:                                                          0569 01538000
*        PROCEDURE OPTIONS(SAVEAREA);                      /*@ZA05939*/ 01539000
*                                                                  0569 01540000
ERRPROC  STM   @14,@12,12(@13)                                     0569 01541000
         ST    @13,@SA00004+4                                      0569 01542000
         LA    @14,@SA00004                                        0569 01543000
         ST    @14,8(,@13)                                         0569 01544000
         LR    @13,@14                                             0569 01545000
*        GEN(ENTRY ERRPROC);           /*EXT ENTRY POINT     @ZA05939*/ 01546000
         ENTRY ERRPROC                                                  01547000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 01548000
*                                                                  0571 01549000
         LM    REG8,REG12,BASESAVE                                 0571 01550000
*        /************************************************************/ 01551000
*        /*                                                          */ 01552000
*        /* LOCAL VARIABLES - ARGUMENT LIST FOR THE AMS UDUMP MACRO  */ 01553000
*        /* TO LIST THE AMS TEXT PROCESSOR ARGUMENT LIST PRIOR TO A  */ 01554000
*        /* PRINT REQUEST.                                           */ 01555000
*        /*                                                          */ 01556000
*        /************************************************************/ 01557000
*                                                                  0572 01558000
*        DECLARE                                                   0572 01559000
*          1 DUMPMARG,                                             0572 01560000
*            2 ITEMM,                                              0572 01561000
*              3 ITEMMNM   CHAR(8),                                0572 01562000
*              3 ITEMMPTR  PTR(31),                                0572 01563000
*              3 ITEMMLEN  FIXED(15) UNSIGNED,                     0572 01564000
*              3 ITEMMTYP  CHAR(1),                                0572 01565000
*              3 *         CHAR(1),                                0572 01566000
*            2 LISTMEND    CHAR(1);                                0572 01567000
*                                                                  0572 01568000
*        /************************************************************/ 01569000
*        /*                                                          */ 01570000
*        /* WHEN IN THE DEBUG MODE, DUMP THE AMS TEXT PROCESSOR      */ 01571000
*        /* ARGUMENT LIST.                                           */ 01572000
*        /*                                                          */ 01573000
*        /************************************************************/ 01574000
*                                                                  0573 01575000
*        IF GDTDBG ^= NULLPTR                                      0573 01576000
*          THEN                                                    0573 01577000
         SLR   @04,@04                                             0573 01578000
         L     @15,@PC00001                                        0573 01579000
         L     @15,GDTDBG(,@15)                                    0573 01580000
         CR    @15,@04                                             0573 01581000
         BE    @RF00573                                            0573 01582000
*            DO;                                                   0574 01583000
*              ITEMMNM = 'ERRDARG';                                0575 01584000
         MVI   ITEMMNM+7,C' '                                      0575 01585000
         MVC   ITEMMNM(7),@CC01588                                 0575 01586000
*              ITEMMPTR = ERRARGPT;                                0576 01587000
         L     @14,ERRARGPT                                        0576 01588000
         ST    @14,ITEMMPTR                                        0576 01589000
*              ITEMMTYP = 'H';                                     0577 01590000
         MVI   ITEMMTYP,C'H'                                       0577 01591000
*              ITEMMLEN = LENGTH(ERRDARG);                         0578 01592000
         MVC   ITEMMLEN(2),@CH00606                                0578 01593000
*              LISTMEND = 'FF'X;                                   0579 01594000
         MVI   LISTMEND,X'FF'                                      0579 01595000
*              IF GDTDBG = NULLPTR                                 0580 01596000
*                THEN;                                             0580 01597000
         CR    @15,@04                                             0580 01598000
         BE    @RT00580                                            0580 01599000
*                ELSE                                              0582 01600000
*                  CALL IDCDB010 (GDTTBL,'LCMG',ADDR(DUMPMARG));   0582 01601000
         L     @04,@PC00001                                        0582 01602000
         ST    @04,@AL00001                                        0582 01603000
         LA    @00,@CC01589                                        0582 01604000
         ST    @00,@AL00001+4                                      0582 01605000
         LA    @00,DUMPMARG                                        0582 01606000
         ST    @00,@AFTEMPS+4                                      0582 01607000
         LA    @00,@AFTEMPS+4                                      0582 01608000
         ST    @00,@AL00001+8                                      0582 01609000
         MVI   @AL00001+8,X'80'                                    0582 01610000
         L     @15,GDTDBG(,@04)                                    0582 01611000
         LA    @01,@AL00001                                        0582 01612000
         BALR  @14,@15                                             0582 01613000
*            END;                                                  0583 01614000
@RT00580 DS    0H                                                  0584 01615000
*        /************************************************************/ 01616000
*        /*                                                          */ 01617000
*        /* DETERMINE IF THE MESSAGE TO BE PRINTED REQUIRES A        */ 01618000
*        /* CONDITION CODE TO COMPLETE THE MESSAGE TEXT.             */ 01619000
*        /*                                                          */ 01620000
*        /************************************************************/ 01621000
*                                                                  0584 01622000
*        OLDERID2 = NEWERID2;                                      0584 01623000
@RF00573 L     @04,@PC00001                                        0584 01624000
         L     @04,GDTTR2(,@04)                                    0584 01625000
         MVC   @TS00001(95),NEWERID2(@04)                          0584 01626000
         MVC   OLDERID2(95,@04),@TS00001                           0584 01627000
*        NEWID2 = 'LCER';                                          0585 01628000
         MVC   NEWID2(4,@04),@CC01590                              0585 01629000
*        IF ERRARGPT->DARGSMOD = UV0ID                             0586 01630000
*          THEN                                                    0586 01631000
         L     @04,ERRARGPT                                        0586 01632000
         CLC   DARGSMOD(3,@04),@CC01290                            0586 01633000
         BNE   @RF00586                                            0586 01634000
*            IF ERRARGPT->DARGSENT = UVMSG01  |                    0587 01635000
*              ERRARGPT->DARGSENT = UVMSG03   |                    0587 01636000
*              ERRARGPT->DARGSENT = UVMSG15                        0587 01637000
*              THEN                                                0587 01638000
         CLI   DARGSENT(@04),1                                     0587 01639000
         BE    @RT00587                                            0587 01640000
         CLI   DARGSENT(@04),3                                     0587 01641000
         BE    @RT00587                                            0587 01642000
         CLI   DARGSENT(@04),15                                    0587 01643000
         BNE   @RF00587                                            0587 01644000
@RT00587 DS    0H                                                  0588 01645000
*                DO;                                               0588 01646000
*                  ERRARGPT->DARGDBP = ADDR(SAVRC);        /*@ZA05939*/ 01647000
         L     @04,ERRARGPT                                        0589 01648000
         LA    @00,SAVRC                                           0589 01649000
         ST    @00,DARGDBP(,@04)                                   0589 01650000
*                  ERRARGPT->DARGILP = LENGTH(SAVRC);      /*@ZA05939*/ 01651000
         MVC   DARGILP(2,@04),@CH00161                             0590 01652000
*                END;                                              0591 01653000
*              ELSE                                                0592 01654000
*                IF ERRARGPT->DARGSENT = UVMSG07                   0592 01655000
*                  THEN                                            0592 01656000
*                                                                  0592 01657000
         B     @RC00587                                            0592 01658000
@RF00587 L     @04,ERRARGPT                                        0592 01659000
         CLI   DARGSENT(@04),7                                     0592 01660000
         BNE   @RF00592                                            0592 01661000
*                    /************************************************/ 01662000
*                    /*                                      @Y30SSMK*/ 01663000
*                    /* AN ERROR WAS ENCOUNTERED DURING A VSAM       */ 01664000
*                    /* LOCATE, INITIALIZE THE ERROR CONVERSION      */ 01665000
*                    /* TABLE AND INVOKE UERROR TO PRINT     @Y30SSMK*/ 01666000
*                    /* THE APPROPRIATE ERROR MESSAGE.       @Y30SSMK*/ 01667000
*                    /*                                      @Y30SSMK*/ 01668000
*                    /************************************************/ 01669000
*                                                                  0593 01670000
*                    DO;                                   /*@Y30SSMK*/ 01671000
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Y30SSMK*/ 01672000
         LA    @04,ERRORTAB                                        0594 01673000
         ST    @04,ERCNVADR                                        0594 01674000
*                      ERCNVTAB = ZEROAREA;                /*@Y30SSMK*/ 01675000
         MVC   ERCNVTAB(32,@04),ZEROAREA                           0595 01676000
*                      ERCATLG = ON;                       /*@Y30SSMK*/ 01677000
         OI    ERCATLG(@04),B'10000000'                            0596 01678000
*                      ERCATLC = ON;                       /*@Y30SSMK*/ 01679000
         OI    ERCATLC(@04),B'10000000'                            0597 01680000
*                      ERCATRC = CATRC;                    /*@Y30SSMK*/ 01681000
         LH    @15,CATRC                                           0598 01682000
         ST    @15,ERCATRC(,@04)                                   0598 01683000
*                      ERCPLPT = ERRCPLPT;                 /*@Y30SSMK*/ 01684000
         L     @14,ERRCPLPT                                        0599 01685000
         ST    @14,ERCPLPT(,@04)                                   0599 01686000
*                      IF CATRC = CATRC8 & CILOCFLG = OFF          0600 01687000
*                        THEN                                      0600 01688000
         C     @15,@CF00187                                        0600 01689000
         BNE   @RF00600                                            0600 01690000
         TM    CILOCFLG,B'10000000'                                0600 01691000
         BNZ   @RF00600                                            0600 01692000
*                          ERDSNM = ADDR(OBJNM(NLST));     /*@Y30SSMK*/ 01693000
*                                                                  0601 01694000
         LH    @15,NLST                                            0601 01695000
         MH    @15,@CH01258                                        0601 01696000
         L     @14,OBJNMPTR                                        0601 01697000
         AL    @14,@CF01760                                        0601 01698000
         LA    @00,OBJNM-5(@15,@14)                                0601 01699000
         ST    @00,ERDSNM(,@04)                                    0601 01700000
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Y30SSMK*/ 01701000
*                                                                  0602 01702000
@RF00600 L     @04,@PC00001                                        0602 01703000
         ST    @04,@AL00001                                        0602 01704000
         LA    @02,ERCNVADR                                        0602 01705000
         ST    @02,@AL00001+4                                      0602 01706000
         MVI   @AL00001+4,X'80'                                    0602 01707000
         L     @15,GDTERR(,@04)                                    0602 01708000
         LA    @01,@AL00001                                        0602 01709000
         BALR  @14,@15                                             0602 01710000
*                      RESPECIFY RTNREG RSTD;                      0603 01711000
*                      TESTRC = RTNREG;                            0604 01712000
         LR    TESTRC,RTNREG                                       0604 01713000
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSMK*/ 01714000
*                      SAVRC = MAX(SAVRC,TESTRC);          /*@ZA05939*/ 01715000
         LH    @04,SAVRC                                           0606 01716000
         CR    @04,TESTRC                                          0606 01717000
         BNL   *+6                                                      01718000
         LR    @04,TESTRC                                          0606 01719000
         STH   @04,SAVRC                                           0606 01720000
*                    END;                                  /*@Y30SSMK*/ 01721000
*                                                                  0607 01722000
*        /************************************************************/ 01723000
*        /*                                                          */ 01724000
*        /* IF UERROR WAS NOT INVOKED TO PRINT THE ERROR MESSAGE,    */ 01725000
*        /* ISSUE THE AMS UPRINT MACRO TO LIST THE MESSAGE SPECIFIED */ 01726000
*        /* IN THE AMS TEXT PROCESSOR DARGLIST.                      */ 01727000
*        /* UPDATE THE LISTC FINAL CONDITION CODE WITH THE RETURN    */ 01728000
*        /* CODE FROM THE TEXT PROCESSOR.                            */ 01729000
*        /* AND REINITIALIZE THE DARGLIST FOR THE NEXT MESSAGE.      */ 01730000
*        /*                                                          */ 01731000
*        /************************************************************/ 01732000
*                                                                  0608 01733000
*        IF ERRARGPT->DARGSENT ^= UVMSG07                          0608 01734000
*          THEN                                                    0608 01735000
@RF00592 DS    0H                                                  0608 01736000
@RC00587 DS    0H                                                  0608 01737000
@RF00586 L     @04,ERRARGPT                                        0608 01738000
         CLI   DARGSENT(@04),7                                     0608 01739000
         BE    @RF00608                                            0608 01740000
*            DO;                                           /*@Y30SSMK*/ 01741000
*              CALL AMSTP011 (GDTTBL,                              0610 01742000
*                      OTIOCSPT,                                   0610 01743000
*                      ERRARGPT);                                  0610 01744000
         L     @04,@PC00001                                        0610 01745000
         ST    @04,@AL00001                                        0610 01746000
         LA    @02,OTIOCSPT                                        0610 01747000
         ST    @02,@AL00001+4                                      0610 01748000
         LA    @02,ERRARGPT                                        0610 01749000
         ST    @02,@AL00001+8                                      0610 01750000
         MVI   @AL00001+8,X'80'                                    0610 01751000
         L     @15,GDTPRT(,@04)                                    0610 01752000
         LA    @01,@AL00001                                        0610 01753000
         BALR  @14,@15                                             0610 01754000
*              RESPECIFY RTNREG RSTD;                              0611 01755000
*              TESTRC = RTNREG;                                    0612 01756000
         LR    TESTRC,RTNREG                                       0612 01757000
*              RESPECIFY RTNREG UNRSTD;                            0613 01758000
*              SAVRC = MAX (SAVRC, TESTRC);                /*@ZA05939*/ 01759000
         LH    @04,SAVRC                                           0614 01760000
         CR    @04,TESTRC                                          0614 01761000
         BNL   *+6                                                      01762000
         LR    @04,TESTRC                                          0614 01763000
         STH   @04,SAVRC                                           0614 01764000
*            END;                                                  0615 01765000
*        ERRDARG = ZEROAREA;                                       0616 01766000
*                                                                  0616 01767000
@RF00608 L     @04,ERRARGPT                                        0616 01768000
         MVC   ERRDARG(44,@04),ZEROAREA                            0616 01769000
*        /************************************************************/ 01770000
*        /*                                                          */ 01771000
*        /* EXIT FROM THE ERROR PRINT ROUTINE, RETURNING TO CALLER.  */ 01772000
*        /*                                                          */ 01773000
*        /************************************************************/ 01774000
*                                                                  0617 01775000
*        RETURN CODE (0);                                          0617 01776000
         SLR   @15,@15                                             0617 01777000
         L     @13,4(,@13)                                         0617 01778000
         L     @14,12(,@13)                                        0617 01779000
         LM    @00,@12,20(@13)                                     0617 01780000
         BR    @14                                                 0617 01781000
*        END ERRPROC;                                              0618 01782000
*        /************************************************************/ 01783000
*        /*                                                          */ 01784000
*        /* PROCEDURE NAME - LISTPROC                                */ 01785000
*        /*                                                          */ 01786000
*        /* FUNCTION - ISSUES AMS TEXT PROCESSOR MACRO, UPRINT, AND  */ 01787000
*        /* ZEROES OUT THE DYNAMIC DATA ARGUMENT LIST UPON EXITING.  */ 01788000
*        /*                                                          */ 01789000
*        /* INPUT - OUTPUT DATA SET POINTER, AND THE DYNAMIC DATA    */ 01790000
*        /* PARM LIST FOR THE AMS TEXT PROCESSOR.                    */ 01791000
*        /*                                                          */ 01792000
*        /* OUTPUT - FORMATTED AND PRINTED DATA AS DESCRIBED IN TEXT */ 01793000
*        /* PROCESSOR'S PARM LIST.                                   */ 01794000
*        /*                                                          */ 01795000
*        /************************************************************/ 01796000
*                                                                  0619 01797000
*LISTPROC: PROCEDURE OPTIONS(SAVEAREA);                    /*@ZA05939*/ 01798000
*                                                                  0619 01799000
LISTPROC STM   @14,@12,12(@13)                                     0619 01800000
         ST    @13,@SA00005+4                                      0619 01801000
         LA    @14,@SA00005                                        0619 01802000
         ST    @14,8(,@13)                                         0619 01803000
         LR    @13,@14                                             0619 01804000
*        GEN(ENTRY LISTPROC);          /*EXT ENTRY POINT     @ZA05939*/ 01805000
         ENTRY LISTPROC                                                 01806000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 01807000
*                                                                  0621 01808000
         LM    REG8,REG12,BASESAVE                                 0621 01809000
*        /************************************************************/ 01810000
*        /*                                                          */ 01811000
*        /* LOCAL VARIABLES - ARGUMENT LIST FOR THE AMS UDUMP MACRO  */ 01812000
*        /* TO LIST THE AMS TEXT PROCESSOR ARGUMENT LIST PRIOR TO A  */ 01813000
*        /* PRINT REQUEST.                                           */ 01814000
*        /*                                                          */ 01815000
*        /************************************************************/ 01816000
*                                                                  0622 01817000
*        DECLARE                                                   0622 01818000
*          1 DUMPDARG,                                             0622 01819000
*            2 ITEM5,                                              0622 01820000
*              3 ITEM5NM   CHAR(8),                                0622 01821000
*              3 ITEM5PTR  PTR(31),                                0622 01822000
*              3 ITEM5LEN  FIXED(15) UNSIGNED,                     0622 01823000
*              3 ITEM5TYP  CHAR(1),                                0622 01824000
*              3 *         CHAR(1),                                0622 01825000
*            2 LIST5END    CHAR(1);                                0622 01826000
*                                                                  0622 01827000
*        /************************************************************/ 01828000
*        /*                                                          */ 01829000
*        /* WHEN IN THE DEBUG MODE, DUMP THE AMS TEXT PROCESSOR      */ 01830000
*        /* ARGUMENT LIST.                                           */ 01831000
*        /*                                                          */ 01832000
*        /************************************************************/ 01833000
*                                                                  0623 01834000
*        IF GDTDBG ^= NULLPTR                                      0623 01835000
*          THEN                                                    0623 01836000
         SLR   @04,@04                                             0623 01837000
         L     @15,@PC00001                                        0623 01838000
         L     @15,GDTDBG(,@15)                                    0623 01839000
         CR    @15,@04                                             0623 01840000
         BE    @RF00623                                            0623 01841000
*            DO;                                                   0624 01842000
*              ITEM5NM = 'DARGLIST';                               0625 01843000
         MVC   ITEM5NM(8),@CC01602                                 0625 01844000
*              ITEM5PTR = DARGPTR;                         /*@ZA05939*/ 01845000
         L     @14,DARGPTR                                         0626 01846000
         ST    @14,ITEM5PTR                                        0626 01847000
*              ITEM5TYP = 'H';                                     0627 01848000
         MVI   ITEM5TYP,C'H'                                       0627 01849000
*              ITEM5LEN = LENGTH(DARGLIST) +                       0628 01850000
*                (DARGCNT * LENGTH(DARGARY));                      0628 01851000
         LH    @14,DARGCNT(,@14)                                   0628 01852000
         SLA   @14,3                                               0628 01853000
         LA    @14,20(,@14)                                        0628 01854000
         STH   @14,ITEM5LEN                                        0628 01855000
*              LIST5END = 'FF'X;                                   0629 01856000
         MVI   LIST5END,X'FF'                                      0629 01857000
*              IF GDTDBG = NULLPTR                                 0630 01858000
*                THEN;                                             0630 01859000
         CR    @15,@04                                             0630 01860000
         BE    @RT00630                                            0630 01861000
*                ELSE                                              0632 01862000
*                  CALL IDCDB010 (GDTTBL,'LCTP',ADDR(DUMPDARG));   0632 01863000
         L     @04,@PC00001                                        0632 01864000
         ST    @04,@AL00001                                        0632 01865000
         LA    @00,@CC01603                                        0632 01866000
         ST    @00,@AL00001+4                                      0632 01867000
         LA    @00,DUMPDARG                                        0632 01868000
         ST    @00,@AFTEMPS+8                                      0632 01869000
         LA    @00,@AFTEMPS+8                                      0632 01870000
         ST    @00,@AL00001+8                                      0632 01871000
         MVI   @AL00001+8,X'80'                                    0632 01872000
         L     @15,GDTDBG(,@04)                                    0632 01873000
         LA    @01,@AL00001                                        0632 01874000
         BALR  @14,@15                                             0632 01875000
*            END;                                                  0633 01876000
@RT00630 DS    0H                                                  0634 01877000
*        /************************************************************/ 01878000
*        /*                                                          */ 01879000
*        /* ISSUE THE AMS UPRINT MACRO TO LIST THE DATA SPECIFIED IN */ 01880000
*        /* THE AMS TEXT PROCESSOR DARGLIST.                         */ 01881000
*        /*                                                          */ 01882000
*        /************************************************************/ 01883000
*                                                                  0634 01884000
*        OLDERID2 = NEWERID2;                                      0634 01885000
@RF00623 L     @04,@PC00001                                        0634 01886000
         L     @02,GDTTR2(,@04)                                    0634 01887000
         MVC   @TS00001(95),NEWERID2(@02)                          0634 01888000
         MVC   OLDERID2(95,@02),@TS00001                           0634 01889000
*        NEWID2 = 'LCLT';                                          0635 01890000
*                                                                  0635 01891000
         MVC   NEWID2(4,@02),@CC01604                              0635 01892000
*        CALL AMSTP011 (GDTTBL,                                    0636 01893000
*                OTIOCSPT,                                         0636 01894000
*                DARGPTR);                                 /*@ZA05939*/ 01895000
         ST    @04,@AL00001                                        0636 01896000
         LA    @02,OTIOCSPT                                        0636 01897000
         ST    @02,@AL00001+4                                      0636 01898000
         LA    @02,DARGPTR                                         0636 01899000
         ST    @02,@AL00001+8                                      0636 01900000
         MVI   @AL00001+8,X'80'                                    0636 01901000
         L     @15,GDTPRT(,@04)                                    0636 01902000
         LA    @01,@AL00001                                        0636 01903000
         BALR  @14,@15                                             0636 01904000
*        RESPECIFY RTNREG RSTD;                                    0637 01905000
*        TESTRC = RTNREG;                                          0638 01906000
         LR    TESTRC,RTNREG                                       0638 01907000
*        RESPECIFY RTNREG UNRSTD;                                  0639 01908000
*        SAVRC = MAX (SAVRC, TESTRC);                      /*@ZA05939*/ 01909000
*                                                                  0640 01910000
         LH    @04,SAVRC                                           0640 01911000
         CR    @04,TESTRC                                          0640 01912000
         BNL   *+6                                                      01913000
         LR    @04,TESTRC                                          0640 01914000
         STH   @04,SAVRC                                           0640 01915000
*        /************************************************************/ 01916000
*        /*                                                          */ 01917000
*        /* FOR REUSE, INITIALIZE THE DARGLIST TO ZERO AND SET THE   */ 01918000
*        /* LISTC STATIC TEXT ID.                                    */ 01919000
*        /*                                                          */ 01920000
*        /************************************************************/ 01921000
*                                                                  0641 01922000
*        DARGLIST = ZEROAREA;                                      0641 01923000
         L     @04,DARGPTR                                         0641 01924000
         MVC   DARGLIST(20,@04),ZEROAREA                           0641 01925000
*        DARGSMOD = LC0ID;                                         0642 01926000
*                                                                  0642 01927000
         MVC   DARGSMOD(3,@04),@CC01198                            0642 01928000
*        /************************************************************/ 01929000
*        /*                                                          */ 01930000
*        /* EXIT FROM THE PRINT ROUTINE, RETURNING TO CALLER.        */ 01931000
*        /*                                                          */ 01932000
*        /************************************************************/ 01933000
*                                                                  0643 01934000
*        RETURN CODE(0);                                           0643 01935000
         SLR   @15,@15                                             0643 01936000
         L     @13,4(,@13)                                         0643 01937000
         L     @14,12(,@13)                                        0643 01938000
         LM    @00,@12,20(@13)                                     0643 01939000
         BR    @14                                                 0643 01940000
*        END LISTPROC;                                             0644 01941000
*        /************************************************************/ 01942000
*        /*                                                          */ 01943000
*        /* PROCEDURE - AUPROC                                       */ 01944000
*        /*                                                          */ 01945000
*        /* FUNCTION - REPETITIVELY BUILDS THE AMS TEXT PROCESSOR    */ 01946000
*        /* DYNAMIC DATA ARGUMENT LIST FOR FORMATTING AND LISTING    */ 01947000
*        /* THE VSAM CATALOG FIELDS FOR A NONVSAM, USERCATALOG,      */ 01948000
*        /* ALIAS, OR GDG ENTRY.                             @Y30SSMK*/ 01949000
*        /* LISTPROC IS REPEATEDLY INVOKED TO PRINT THE DATA.        */ 01950000
*        /*                                                          */ 01951000
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM CATALOG DATA    */ 01952000
*        /* RETRIEVED VIA A LOCATE REQUEST.  THE VSAM CPL AND FPL'S  */ 01953000
*        /* AND THE AMS GDT AND FROM STATIC TEXT THE PRE-FORMATTED   */ 01954000
*        /* DESCRIPTORS FOR EDITING THE CATALOG DATA.                */ 01955000
*        /*                                                          */ 01956000
*        /* OUTPUT - PRINTED VSAM CATALOG DATA FOR EITHER AN NONVSAM,*/ 01957000
*        /* USERCATALOG, ALIAS, OR GDG ENTRY.                @Y30SSMK*/ 01958000
*        /*                                                          */ 01959000
*        /************************************************************/ 01960000
*                                                                  0645 01961000
*AUPROC: PROCEDURE OPTIONS(SAVEAREA);                      /*@ZA05939*/ 01962000
*                                                                  0645 01963000
AUPROC   STM   @14,@12,12(@13)                                     0645 01964000
         ST    @13,@SA00006+4                                      0645 01965000
         LA    @14,@SA00006                                        0645 01966000
         ST    @14,8(,@13)                                         0645 01967000
         LR    @13,@14                                             0645 01968000
*        GEN(ENTRY AUPROC);            /*EXT ENTRY POINT     @ZA05939*/ 01969000
         ENTRY AUPROC                                                   01970000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 01971000
*                                                                  0647 01972000
         LM    REG8,REG12,BASESAVE                                 0647 01973000
*        /************************************************************/ 01974000
*        /*                                                  @Y30SSMK*/ 01975000
*        /* LOCAL VARIABLES                                  @Y30SSMK*/ 01976000
*        /*                                                  @Y30SSMK*/ 01977000
*        /************************************************************/ 01978000
*                                                                  0648 01979000
*        DCL CITYPLEN  FIXED(15) CONSTANT(4);              /*@Y30SSMK*/ 01980000
*                                      /*LEN OF ONE CI & TYPE FIELD  */ 01981000
*                                                                  0649 01982000
*        /************************************************************/ 01983000
*        /*                                                          */ 01984000
*        /* SETUP THE AMS DARGLIST TO LIST EITHER A NONVSAM, @Y30SSMK*/ 01985000
*        /* USERCATALOG, ALIAS, OR GDG HEADER CONTAINING THE 44-BYTE */ 01986000
*        /* ENTRY NAME. UPDATE THE APPROPRIATE ENTRY TYPE COUNTER.   */ 01987000
*        /*  IF THE PROPER PASSWORD WAS NOT PROVIDED AND ONLY        */ 01988000
*        /*  THE NAME SUBSET IS REQUESTED, PICK UP THE ENTRY NAME    */ 01989000
*        /*  FROM THE SPECIALLY FORMATTED WORKAREA.                  */ 01990000
*        /*                                                          */ 01991000
*        /************************************************************/ 01992000
*                                                                  0649 01993000
*        OLDERID2 = NEWERID2;                                      0649 01994000
         L     @04,@PC00001                                        0649 01995000
         L     @15,GDTTR2(,@04)                                    0649 01996000
         MVC   @TS00001(95),NEWERID2(@15)                          0649 01997000
         MVC   OLDERID2(95,@15),@TS00001                           0649 01998000
*        NEWID2 = 'LCAU';                                          0650 01999000
*                                                                  0650 02000000
*                                                                  0650 02001000
         MVC   NEWID2(4,@15),@CC01610                              0650 02002000
*        IF GDTDBG = NULLPTR                                       0651 02003000
*          THEN;                                                   0651 02004000
         L     @04,GDTDBG(,@04)                                    0651 02005000
         LTR   @04,@04                                             0651 02006000
         BZ    @RT00651                                            0651 02007000
*          ELSE                                                    0653 02008000
*            CALL IDCDB010(GDTTBL,'LCAP',DPLISTPT);                0653 02009000
         L     @04,@PC00001                                        0653 02010000
         ST    @04,@AL00001                                        0653 02011000
         LA    @00,@CC01611                                        0653 02012000
         ST    @00,@AL00001+4                                      0653 02013000
         LA    @00,DPLISTPT                                        0653 02014000
         ST    @00,@AL00001+8                                      0653 02015000
         MVI   @AL00001+8,X'80'                                    0653 02016000
         L     @15,GDTDBG(,@04)                                    0653 02017000
         LA    @01,@AL00001                                        0653 02018000
         BALR  @14,@15                                             0653 02019000
*                                                          /*@ZA05939*/ 02020000
*                                                                  0654 02021000
*        ALIASCI# = 0;                                     /*@YL026UE*/ 02022000
@RT00651 SLR   @04,@04                                             0654 02023000
         STCM  @04,7,ALIASCI#                                      0654 02024000
*        G0V0FLG = OFF;                                    /*@YL026UE*/ 02025000
*                                                                  0655 02026000
*                                                                  0655 02027000
         NI    G0V0FLG,B'01111111'                                 0655 02028000
*        IF HOLDETYP = CTGTALIN                                    0656 02029000
*          THEN                                                    0656 02030000
         CLI   HOLDETYP,C'A'                                       0656 02031000
         BNE   @RF00656                                            0656 02032000
*            DO;                                           /*@YL026UE*/ 02033000
*            ATYPCNT = ATYPCNT+1;      /*UPDATE NVSAM CTR    @YL026UE*/ 02034000
         LA    @04,1                                               0658 02035000
         AL    @04,ATYPCNT                                         0658 02036000
         ST    @04,ATYPCNT                                         0658 02037000
*            IF NDENTFLG = ON                                      0659 02038000
*              THEN                                                0659 02039000
         TM    NDENTFLG,B'10000000'                                0659 02040000
         BNO   @RF00659                                            0659 02041000
*                DARGSENT = LCST44;    /*INDENTED NVSAM ENTY HEADER     02042000
*                                                            @YL026UE*/ 02043000
         L     @04,DARGPTR                                         0660 02044000
         MVI   DARGSENT(@04),X'2C'                                 0660 02045000
*              ELSE                                                0661 02046000
*                DARGSENT = LCST03;    /*NON-INDENTED NVSAM HEADER 0661 02047000
*                                                            @YL026UE*/ 02048000
         B     @RC00659                                            0661 02049000
@RF00659 L     @04,DARGPTR                                         0661 02050000
         MVI   DARGSENT(@04),X'03'                                 0661 02051000
*            END;                                          /*@YL026UE*/ 02052000
*          ELSE                                                    0663 02053000
*            IF HOLDETYP = CTGTUCAT                                0663 02054000
*              THEN                                                0663 02055000
         B     @RC00656                                            0663 02056000
@RF00656 CLI   HOLDETYP,C'U'                                       0663 02057000
         BNE   @RF00663                                            0663 02058000
*                DO;                                       /*@YL026UE*/ 02059000
*                UTYPCNT = UTYPCNT+1;  /*UPDATE UCAT COUNTER @YL026UE*/ 02060000
         LA    @04,1                                               0665 02061000
         AL    @04,UTYPCNT                                         0665 02062000
         ST    @04,UTYPCNT                                         0665 02063000
*                DARGSENT = LCST04;    /*USERCAT ENTY HEADER @YL026UE*/ 02064000
         L     @04,DARGPTR                                         0666 02065000
         MVI   DARGSENT(@04),X'04'                                 0666 02066000
*                END;                                      /*@YL026UE*/ 02067000
*              ELSE                                                0668 02068000
*                  IF HOLDETYP = CTGTANM                           0668 02069000
*                    THEN                                          0668 02070000
         B     @RC00663                                            0668 02071000
@RF00663 CLI   HOLDETYP,C'X'                                       0668 02072000
         BNE   @RF00668                                            0668 02073000
*                      DO;                                 /*@YL026UE*/ 02074000
*                      XTYPCNT=XTYPCNT+1; /*UPDT ALIAS CTR   @YL026UE*/ 02075000
         LA    @04,1                                               0670 02076000
         AL    @04,XTYPCNT                                         0670 02077000
         ST    @04,XTYPCNT                                         0670 02078000
*                      DARGSENT=LCST43; /*ALIAS ENTRY HDR    @YL026UE*/ 02079000
         L     @04,DARGPTR                                         0671 02080000
         MVI   DARGSENT(@04),X'2B'                                 0671 02081000
*                      END;                                /*@YL026UE*/ 02082000
*                    ELSE                                          0673 02083000
*                      DO;                                 /*@YL026UE*/ 02084000
         B     @RC00668                                            0673 02085000
@RF00668 DS    0H                                                  0674 02086000
*                      BTYPCNT=BTYPCNT+1; /*GDG BASE CTR     @YL026UE*/ 02087000
         LA    @04,1                                               0674 02088000
         AL    @04,BTYPCNT                                         0674 02089000
         ST    @04,BTYPCNT                                         0674 02090000
*                      DARGSENT=LCST42; /*GDG BASE ENTRY HDR @YL026UE*/ 02091000
         L     @04,DARGPTR                                         0675 02092000
         MVI   DARGSENT(@04),X'2A'                                 0675 02093000
*                      END;                                /*@YL026UE*/ 02094000
*        IF CATRC = CRCBADPW & ADDR(NAME) > NULLPTR                0677 02095000
*          THEN                                                    0677 02096000
@RC00668 DS    0H                                                  0677 02097000
@RC00663 DS    0H                                                  0677 02098000
@RC00656 CLC   CATRC(2),@CH01280                                   0677 02099000
         BNE   @RF00677                                            0677 02100000
         L     @04,@PC00001+4                                      0677 02101000
         L     @04,FDTPTR+52(,@04)                                 0677 02102000
         LTR   @04,@04                                             0677 02103000
         BNP   @RF00677                                            0677 02104000
*            DO;                                                   0678 02105000
*            DARGDBP = ADDR(SUPPDSNM);                             0679 02106000
         L     @04,DARGPTR                                         0679 02107000
         L     @15,CTGPLPTR                                        0679 02108000
         L     @15,CTGWKA(,@15)                                    0679 02109000
         LA    @00,SUPPDSNM(,@15)                                  0679 02110000
         ST    @00,DARGDBP(,@04)                                   0679 02111000
*            DARGILP = LENGTH(SUPPDSNM);                           0680 02112000
         MVC   DARGILP(2,@04),@CH00606                             0680 02113000
*            END;                                                  0681 02114000
*          ELSE                                                    0682 02115000
*            DO;                                                   0682 02116000
         B     @RC00677                                            0682 02117000
@RF00677 DS    0H                                                  0683 02118000
*            DARGDBP = ENT44FPT->CTGFLPT(1);                       0683 02119000
         L     @04,DARGPTR                                         0683 02120000
         L     @15,ENT44FPT                                        0683 02121000
         L     @14,CTGFLPT(,@15)                                   0683 02122000
         ST    @14,DARGDBP(,@04)                                   0683 02123000
*            DARGILP = ENT44FPT->CTGFLNG(1);                       0684 02124000
         L     @00,CTGFLNG(,@15)                                   0684 02125000
         STH   @00,DARGILP(,@04)                                   0684 02126000
*            END;                                                  0685 02127000
*        CALL LISTPROC;                                            0686 02128000
*                                                                  0686 02129000
@RC00677 BAL   @14,LISTPROC                                        0686 02130000
*        /************************************************************/ 02131000
*        /*                                                  @YL026UE*/ 02132000
*        /* IF THE CATNAME SUBTITLE IS NOT USED, IDENTIFY THE        */ 02133000
*        /* CATALOG FOR EACH ENTRY VIA A CATNAME HEADER.     @YL026UE*/ 02134000
*        /*                                                  @YL026UE*/ 02135000
*        /************************************************************/ 02136000
*                                                                  0687 02137000
*        IF NOTTLFLG = ON                                          0687 02138000
*          THEN                                                    0687 02139000
         TM    NOTTLFLG,B'10000000'                                0687 02140000
         BNO   @RF00687                                            0687 02141000
*            DO;                                           /*@YL026UE*/ 02142000
*            DARGSENT = LCST40;                            /*@YL026UE*/ 02143000
         L     @04,DARGPTR                                         0689 02144000
         MVI   DARGSENT(@04),X'28'                                 0689 02145000
*            DARGDBP = ADDR(CATNAME);                      /*@YL026UE*/ 02146000
         LA    @00,CATNAME                                         0690 02147000
         ST    @00,DARGDBP(,@04)                                   0690 02148000
*            DARGILP = LENGTH(CATNAME);                    /*@YL026UE*/ 02149000
         MVC   DARGILP(2,@04),@CH00606                             0691 02150000
*            CALL LISTPROC;                                /*@YL026UE*/ 02151000
         BAL   @14,LISTPROC                                        0692 02152000
*            END;                                          /*@YL026UE*/ 02153000
*        /************************************************************/ 02154000
*        /*                                                          */ 02155000
*        /* EXIT FROM NVSAM/USERCAT ROUTINE SINCE NAME ONLY SUBSET   */ 02156000
*        /* LISTING WAS REQUESTED.  RETURN TO ROUTING ROUTINE.       */ 02157000
*        /*                                                          */ 02158000
*        /************************************************************/ 02159000
*                                                                  0694 02160000
*        IF ADDR(NAME) > NULLPTR                                   0694 02161000
*          THEN                                                    0694 02162000
@RF00687 SLR   @04,@04                                             0694 02163000
         L     @15,@PC00001+4                                      0694 02164000
         C     @04,FDTPTR+52(,@15)                                 0694 02165000
         BNL   @RF00694                                            0694 02166000
*            RETURN CODE (0);                                      0695 02167000
*                                                                  0695 02168000
         LR    @15,@04                                             0695 02169000
         L     @13,4(,@13)                                         0695 02170000
         L     @14,12(,@13)                                        0695 02171000
         LM    @00,@12,20(@13)                                     0695 02172000
         BR    @14                                                 0695 02173000
*        /************************************************************/ 02174000
*        /*                                                  @YL026UE*/ 02175000
*        /* EXIT FROM NVSAM/UCAT ROUTINE IF A GDG BASE SPECIFIED     */ 02176000
*        /* BY THE USER IS RESTRICTED BY THE USER'S TYPE     @YL026UE*/ 02177000
*        /* SPECIFICATION.                                   @YL026UE*/ 02178000
*        /*                                                  @YL026UE*/ 02179000
*        /************************************************************/ 02180000
*                                                                  0696 02181000
*        IF HOLDETYP = CTGTGBS & ENLVUDFG = ON                     0696 02182000
*           & TYPECNT > 0 & BTYPFLG = OFF                          0696 02183000
*          THEN                                                    0696 02184000
@RF00694 CLI   HOLDETYP,C'B'                                       0696 02185000
         BNE   @RF00696                                            0696 02186000
         TM    ENLVUDFG,B'10000000'                                0696 02187000
         BNO   @RF00696                                            0696 02188000
         SLR   @04,@04                                             0696 02189000
         CH    @04,TYPECNT                                         0696 02190000
         BNL   @RF00696                                            0696 02191000
         TM    BTYPFLG,B'10000000'                                 0696 02192000
         BNZ   @RF00696                                            0696 02193000
*            RETURN CODE(0);                               /*@YL026UE*/ 02194000
         LR    @15,@04                                             0697 02195000
         L     @13,4(,@13)                                         0697 02196000
         L     @14,12(,@13)                                        0697 02197000
         LM    @00,@12,20(@13)                                     0697 02198000
         BR    @14                                                 0697 02199000
*        /************************************************************/ 02200000
*        /*                                                          */ 02201000
*        /* USER ERROR, IF ALLOCATION INFORMATION REQUESTED FOR A    */ 02202000
*        /* LIST OF ENTRIES THAT CONTAINED A NONVSAM OR USERCAT      */ 02203000
*        /* OR ALIAS OR GDG BASE ENTRY, OR IF VOL INFO REQUESTED     */ 02204000
*        /* FOR AN ALIAS ENTRY.                              @YL026UE*/ 02205000
*        /* SETUP THE ALLOC/VOL CONFLICT MESSAGE AND RETURN  @YL026UE*/ 02206000
*        /* TO THE ROUTING PROCEDURE.                                */ 02207000
*        /*                                                          */ 02208000
*        /************************************************************/ 02209000
*                                                                  0698 02210000
*        IF ADDR(ALLOC) > NULLPTR | (ADDR(VOL) > NULLPTR           0698 02211000
*            & HOLDETYP = CTGTANM)                                 0698 02212000
*          THEN                                                    0698 02213000
@RF00696 SLR   @04,@04                                             0698 02214000
         L     @15,@PC00001+4                                      0698 02215000
         C     @04,FDTPTR+64(,@15)                                 0698 02216000
         BL    @RT00698                                            0698 02217000
         C     @04,FDTPTR+60(,@15)                                 0698 02218000
         BNL   @RF00698                                            0698 02219000
         CLI   HOLDETYP,C'X'                                       0698 02220000
         BNE   @RF00698                                            0698 02221000
@RT00698 DS    0H                                                  0699 02222000
*            DO;                                                   0699 02223000
*              SAVRC = MAX (SAVRC, LASTCC08);              /*@ZA05939*/ 02224000
         LH    @04,SAVRC                                           0700 02225000
         LA    @00,8                                               0700 02226000
         CR    @04,@00                                             0700 02227000
         BNL   *+6                                                      02228000
         LR    @04,@00                                             0700 02229000
         STH   @04,SAVRC                                           0700 02230000
*              ERRARGPT->DARGSMOD = LC1ID;                         0701 02231000
         L     @15,ERRARGPT                                        0701 02232000
         MVC   DARGSMOD(3,@15),@CC01297                            0701 02233000
*              ERRARGPT->DARGSENT = LCMSG04;                       0702 02234000
         MVI   DARGSENT(@15),X'04'                                 0702 02235000
*              RETURN CODE (SAVRC);                        /*@ZA05939*/ 02236000
         LR    @15,@04                                             0703 02237000
         L     @13,4(,@13)                                         0703 02238000
         L     @14,12(,@13)                                        0703 02239000
         LM    @00,@12,20(@13)                                     0703 02240000
         BR    @14                                                 0703 02241000
*            END;                                                  0704 02242000
*        /************************************************************/ 02243000
*        /*                                                  @Y30LSMK*/ 02244000
*        /* FOR A NONVSAM OR GDG ENTRY, PROCEED TO BUILD THE @Y30LSMK*/ 02245000
*        /* DARGLIST TO PRINT OUT THE OWNER, DATE, RELEASE   @Y30SSMK*/ 02246000
*        /* AND CATALOG RECOVERY FIELDS.                     @Y30SSMK*/ 02247000
*        /*                                                  @Y30LSMK*/ 02248000
*        /************************************************************/ 02249000
*                                                                  0705 02250000
*        IF ADDR(NAME) = NULLPTR  &  (HOLDETYP = CTGTALIN  |       0705 02251000
*          HOLDETYP = CTGTGBS)                                     0705 02252000
*          THEN                                                    0705 02253000
*                                                                  0705 02254000
@RF00698 L     @04,@PC00001+4                                      0705 02255000
         L     @04,FDTPTR+52(,@04)                                 0705 02256000
         LTR   @04,@04                                             0705 02257000
         BNZ   @RF00705                                            0705 02258000
         CLI   HOLDETYP,C'A'                                       0705 02259000
         BE    @RT00705                                            0705 02260000
         CLI   HOLDETYP,C'B'                                       0705 02261000
         BNE   @RF00705                                            0705 02262000
@RT00705 DS    0H                                                  0706 02263000
*            /********************************************************/ 02264000
*            /*                                              @Y30LSMK*/ 02265000
*            /* BUILD THE TEXT PROCESSOR DARGLIST FOR PRINTING THE   */ 02266000
*            /* OWNER AND DATE FIELDS.                       @Y30LSMK*/ 02267000
*            /* NOTE - ANY FIELDS RETURNED FROM THE CATALOG PADDED   */ 02268000
*            /* WITH HEX FF'S REQUIRE SPECIAL HANDLING TO SETUP A    */ 02269000
*            /* PRINTABLE FORMAT.  HENCE ARITHMETIC FIELDS ARE       */ 02270000
*            /* OVERLAYED WITH ZEROES AND CHARACTER FIELDS ARE       */ 02271000
*            /* OVERRIDDEN WITH THE 'NULL' STATIC TEXT ENTRY.        */ 02272000
*            /*                                              @Y30LSMK*/ 02273000
*            /********************************************************/ 02274000
*                                                                  0706 02275000
*            DO;                                           /*@Y30LSMK*/ 02276000
*              DARGSENT = LCST13;      /* OWNER AND DATE HEADER      */ 02277000
         L     @04,DARGPTR                                         0707 02278000
         MVI   DARGSENT(@04),X'0D'                                 0707 02279000
*              DARGCNT = DRGCNT7;                          /*@Y30SSMK*/ 02280000
         MVC   DARGCNT(2,@04),@CH00498                             0708 02281000
*              CTGFLPTR = DSIDFPT;                         /*@Y30LSMK*/ 02282000
         L     @04,DSIDFPT                                         0709 02283000
         ST    @04,CTGFLPTR                                        0709 02284000
*              IF DSID = HEXFF                                     0710 02285000
*                THEN                                              0710 02286000
         L     @04,CTGFLPT(,@04)                                   0710 02287000
         CLC   DSID(8,@04),HEXFF                                   0710 02288000
         BNE   @RF00710                                            0710 02289000
*                  DSID = NULLNM;                          /*@Y30LSMK*/ 02290000
         L     @15,TEXTPTR                                         0711 02291000
         MVC   DSID(8,@04),NULLNM(@15)                             0711 02292000
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/ 02293000
@RF00710 L     @04,DARGPTR                                         0712 02294000
         MVC   DARGINS(2,@04),@CH00457                             0712 02295000
*              DARGINL(1) = CTGFLNG(1);                    /*@Y30LSMK*/ 02296000
         L     @15,CTGFLPTR                                        0713 02297000
         L     @14,CTGFLNG(,@15)                                   0713 02298000
         STH   @14,DARGINL(,@04)                                   0713 02299000
*              DARGDTM(1) = CTGFLPT(1);                    /*@Y30LSMK*/ 02300000
*                                                                  0714 02301000
         L     @00,CTGFLPT(,@15)                                   0714 02302000
         ST    @00,DARGDTM(,@04)                                   0714 02303000
*              CTGFLPTR = CRDTFPT;                         /*@Y30LSMK*/ 02304000
         L     @04,CRDTFPT                                         0715 02305000
         ST    @04,CTGFLPTR                                        0715 02306000
*              IF CRDT = ARITH4FF                                  0716 02307000
*                THEN                                              0716 02308000
         L     @04,CTGFLPT(,@04)                                   0716 02309000
         CLC   CRDT(3,@04),ARITH4FF                                0716 02310000
         BNE   @RF00716                                            0716 02311000
*                  CRDT = ZEROAREA;                        /*@Y30LSMK*/ 02312000
         MVC   CRDT(3,@04),ZEROAREA                                0717 02313000
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/ 02314000
@RF00716 L     @04,DARGPTR                                         0718 02315000
         MVC   DARGINS+8(2,@04),@CH00649                           0718 02316000
*              DARGINL(2) = CTGFLNG(1);                    /*@Y30LSMK*/ 02317000
         L     @15,CTGFLPTR                                        0719 02318000
         L     @14,CTGFLNG(,@15)                                   0719 02319000
         STH   @14,DARGINL+8(,@04)                                 0719 02320000
*              DARGDTM(2) = CTGFLPT(1);                    /*@Y30LSMK*/ 02321000
*                                                                  0720 02322000
         L     @00,CTGFLPT(,@15)                                   0720 02323000
         ST    @00,DARGDTM+8(,@04)                                 0720 02324000
*              CTGFLPTR = EXDTFPT;                         /*@Y30LSMK*/ 02325000
         L     @04,EXDTFPT                                         0721 02326000
         ST    @04,CTGFLPTR                                        0721 02327000
*              IF EXDT = ARITH4FF                                  0722 02328000
*                THEN                                              0722 02329000
         L     @04,CTGFLPT(,@04)                                   0722 02330000
         CLC   EXDT(3,@04),ARITH4FF                                0722 02331000
         BNE   @RF00722                                            0722 02332000
*                  EXDT = ZEROAREA;                        /*@Y30LSMK*/ 02333000
         MVC   EXDT(3,@04),ZEROAREA                                0723 02334000
*              DARGINS(3) = DRGINS30;                      /*@Y30SSMK*/ 02335000
@RF00722 L     @04,DARGPTR                                         0724 02336000
         MVC   DARGINS+16(2,@04),@CH01231                          0724 02337000
*              DARGINL(3) = CTGFLNG(1);                    /*@Y30LSMK*/ 02338000
         L     @15,CTGFLPTR                                        0725 02339000
         L     @14,CTGFLNG(,@15)                                   0725 02340000
         STH   @14,DARGINL+16(,@04)                                0725 02341000
*              DARGDTM(3) = CTGFLPT(1);                    /*@Y30LSMK*/ 02342000
*                                                                  0726 02343000
         L     @00,CTGFLPT(,@15)                                   0726 02344000
         ST    @00,DARGDTM+16(,@04)                                0726 02345000
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/ 02346000
         L     @00,RELFPT                                          0727 02347000
         ST    @00,CTGFLPTR                                        0727 02348000
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/ 02349000
         LR    @15,@00                                             0728 02350000
         L     @15,CTGFLPT(,@15)                                   0728 02351000
         ST    @15,DARGDBP(,@04)                                   0728 02352000
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/ 02353000
         LR    @14,@00                                             0729 02354000
         L     @14,CTGFLNG(,@14)                                   0729 02355000
         STH   @14,DARGILP(,@04)                                   0729 02356000
*              DSREL = DSREL + 1;      /*CALUCATE REL NO.    @Y30SSMK*/ 02357000
         LA    @14,1                                               0730 02358000
         SLR   @00,@00                                             0730 02359000
         IC    @00,DSREL(,@15)                                     0730 02360000
         ALR   @14,@00                                             0730 02361000
         STC   @14,DSREL(,@15)                                     0730 02362000
*              IF DSSER = ZEROAREA                                 0731 02363000
*                THEN                                              0731 02364000
         CLC   DSSER(6,@15),ZEROAREA                               0731 02365000
         BNE   @RF00731                                            0731 02366000
*                  DARGSENT = LCST13;  /*EXCLUDE CRA INFO    @Y30SSMK*/ 02367000
         MVI   DARGSENT(@04),X'0D'                                 0732 02368000
*                ELSE                                              0733 02369000
*                  DARGSENT = LCST50;  /*INCLUDE CRA INFO    @Y30SSMK*/ 02370000
         B     @RC00731                                            0733 02371000
@RF00731 L     @04,DARGPTR                                         0733 02372000
         MVI   DARGSENT(@04),X'32'                                 0733 02373000
*              CALL LISTPROC;                              /*@Y30LSMK*/ 02374000
@RC00731 BAL   @14,LISTPROC                                        0734 02375000
*            END;                                          /*@Y30LSMK*/ 02376000
*        /************************************************************/ 02377000
*        /*                                                  @Y30SSMK*/ 02378000
*        /* FOR A USERCATALOG OR ALIAS ENTRY PROCEED TO      @Y30SSMK*/ 02379000
*        /* BUILD THE TEXT PROCESSOR DARGLIST FOR PRINTING   @Y30SSMK*/ 02380000
*        /* THE RELEASE AND CATALOG RECOVERY FIELDS.         @Y30SSMK*/ 02381000
*        /*                                                  @Y30SSMK*/ 02382000
*        /************************************************************/ 02383000
*                                                                  0736 02384000
*        IF ADDR(NAME) = NULLPTR  &  (HOLDETYP = CTGTUCAT  |       0736 02385000
*          HOLDETYP = CTGTANM)                                     0736 02386000
*          THEN                                                    0736 02387000
@RF00705 L     @04,@PC00001+4                                      0736 02388000
         L     @04,FDTPTR+52(,@04)                                 0736 02389000
         LTR   @04,@04                                             0736 02390000
         BNZ   @RF00736                                            0736 02391000
         CLI   HOLDETYP,C'U'                                       0736 02392000
         BE    @RT00736                                            0736 02393000
         CLI   HOLDETYP,C'X'                                       0736 02394000
         BNE   @RF00736                                            0736 02395000
@RT00736 DS    0H                                                  0737 02396000
*            DO;                                           /*@Y30SSMK*/ 02397000
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/ 02398000
         L     @04,RELFPT                                          0738 02399000
         ST    @04,CTGFLPTR                                        0738 02400000
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/ 02401000
         L     @15,DARGPTR                                         0739 02402000
         L     @14,CTGFLPT(,@04)                                   0739 02403000
         ST    @14,DARGDBP(,@15)                                   0739 02404000
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/ 02405000
         L     @04,CTGFLNG(,@04)                                   0740 02406000
         STH   @04,DARGILP(,@15)                                   0740 02407000
*              DSREL = DSREL +1;       /* CALCULATE REL NO.  @Y30SSMK*/ 02408000
         LA    @04,1                                               0741 02409000
         SLR   @00,@00                                             0741 02410000
         IC    @00,DSREL(,@14)                                     0741 02411000
         ALR   @04,@00                                             0741 02412000
         STC   @04,DSREL(,@14)                                     0741 02413000
*              IF DSSER = ZEROAREA                                 0742 02414000
*                THEN                                              0742 02415000
         CLC   DSSER(6,@14),ZEROAREA                               0742 02416000
         BNE   @RF00742                                            0742 02417000
*                  DARGSENT = LCST47;  /* EXCLUDE CRA INFO   @Y30SSMK*/ 02418000
         MVI   DARGSENT(@15),X'2F'                                 0743 02419000
*                ELSE                                              0744 02420000
*                  DARGSENT = LCST56;  /* INCLUDE CRA INFO   @Y30SSMK*/ 02421000
         B     @RC00742                                            0744 02422000
@RF00742 L     @04,DARGPTR                                         0744 02423000
         MVI   DARGSENT(@04),X'38'                                 0744 02424000
*              CALL LISTPROC;                              /*@Y30SSMK*/ 02425000
@RC00742 BAL   @14,LISTPROC                                        0745 02426000
*            END;                                          /*@Y30SSMK*/ 02427000
*        /************************************************************/ 02428000
*        /*                                                  @Y30LSMK*/ 02429000
*        /* EXIT HERE IF THE HISTORY SUBSET WAS REQUESTED.   @Y30LSMK*/ 02430000
*        /*                                                  @Y30LSMK*/ 02431000
*        /************************************************************/ 02432000
*                                                                  0747 02433000
*        IF ADDR(HIST) > NULLPTR                                   0747 02434000
*          THEN                                                    0747 02435000
@RF00736 SLR   @04,@04                                             0747 02436000
         L     @15,@PC00001+4                                      0747 02437000
         C     @04,FDTPTR+104(,@15)                                0747 02438000
         BNL   @RF00747                                            0747 02439000
*            RETURN CODE(0);                               /*@Y30LSMK*/ 02440000
         LR    @15,@04                                             0748 02441000
         L     @13,4(,@13)                                         0748 02442000
         L     @14,12(,@13)                                        0748 02443000
         LM    @00,@12,20(@13)                                     0748 02444000
         BR    @14                                                 0748 02445000
*        /************************************************************/ 02446000
*        /*                                                          */ 02447000
*        /* LIST THE VOLUME HEADER USING THE PRE-FORMATTED   @ZA05939*/ 02448000
*        /* STATIC TEXT DESCRIPTOR.                          @ZA05939*/ 02449000
*        /*                                                          */ 02450000
*        /************************************************************/ 02451000
*                                                                  0749 02452000
*        IF HOLDETYP = CTGTALIN | HOLDETYP = CTGTUCAT              0749 02453000
*          THEN                                                    0749 02454000
@RF00747 CLI   HOLDETYP,C'A'                                       0749 02455000
         BE    @RT00749                                            0749 02456000
         CLI   HOLDETYP,C'U'                                       0749 02457000
         BNE   @RF00749                                            0749 02458000
@RT00749 DS    0H                                                  0750 02459000
*AUOUTPUT:   DO;                                           /*@YL026UE*/ 02460000
AUOUTPUT DS    0H                                                  0751 02461000
*            DARGSENT = LCST34;        /*VOL SERIAL HEADER   @ZA05939*/ 02462000
*                                                                  0751 02463000
         L     @04,DARGPTR                                         0751 02464000
         MVI   DARGSENT(@04),X'22'                                 0751 02465000
*            CALL LISTPROC;                                /*@ZA05939*/ 02466000
*                                                                  0752 02467000
         BAL   @14,LISTPROC                                        0752 02468000
*        /************************************************************/ 02469000
*        /*                                                          */ 02470000
*        /* POSITION THE FPL POINTER TO THE FPL REQUESTING THE       */ 02471000
*        /* NONVSAM/USERCAT FIELDS AND LIST THE DATA IF RETURNED     */ 02472000
*        /* IN THE WORKAREA.                                         */ 02473000
*        /* ALSO INITIALIZE THE SERIAL NUMBER HOLD AREA TO HEX FF'S  */ 02474000
*        /* SINCE THIS VALUE DETERMINES WHETHER REPETITIVE FIELDS    */ 02475000
*        /* ARE LISTED.                                              */ 02476000
*        /*                                                          */ 02477000
*        /************************************************************/ 02478000
*                                                                  0753 02479000
*        CTGFLPTR = AUVOLFPT;                                      0753 02480000
         L     @04,AUVOLFPT                                        0753 02481000
         ST    @04,CTGFLPTR                                        0753 02482000
*        OLDVOL# = HEXFF;                                          0754 02483000
         MVC   OLDVOL#(6),HEXFF                                    0754 02484000
*        IF CTGFLPT(1) > 0                                         0755 02485000
*          THEN                                                    0755 02486000
*                                                                  0755 02487000
         L     @04,CTGFLPT(,@04)                                   0755 02488000
         LTR   @04,@04                                             0755 02489000
         BNP   @RF00755                                            0755 02490000
*            /********************************************************/ 02491000
*            /*                                                      */ 02492000
*            /* LIST THE CATALOG DATA, LOOPING THROUGH THE REPETITIVE*/ 02493000
*            /* FIELDS.  ONE PASS IS DETERMINED BY THE TOTAL LENGTH  */ 02494000
*            /* OF THE INDIVIDUAL FIXED-LENGTH FIELDS RETRIEVED BY   */ 02495000
*            /* THIS FPL REQUEST.                                    */ 02496000
*            /*                                                      */ 02497000
*            /********************************************************/ 02498000
*                                                                  0756 02499000
*AULIST:     DO WHILE CTGFLNG(1) >= LENGTH(AUDATA);                0756 02500000
*                                                                  0756 02501000
AULIST   B     @DE00756                                            0756 02502000
@DL00756 DS    0H                                                  0757 02503000
*              /******************************************************/ 02504000
*              /*                                                    */ 02505000
*              /* DETERMINE IF ONLY VOLUME SUBSET INFORMATION        */ 02506000
*              /* REQUESTED.  AND LIST EACH UNIQUE VOLUME SERIAL NO. */ 02507000
*              /* AND ITS CORRESPONDING DEVICE TYPE.                 */ 02508000
*              /*                                                    */ 02509000
*              /******************************************************/ 02510000
*                                                                  0757 02511000
*              IF ADDR(VOL) > NULLPTR                              0757 02512000
*                THEN                                              0757 02513000
         L     @04,@PC00001+4                                      0757 02514000
         L     @04,FDTPTR+60(,@04)                                 0757 02515000
         LTR   @04,@04                                             0757 02516000
         BNP   @RF00757                                            0757 02517000
*AUVOLFLD:         DO;                                             0758 02518000
AUVOLFLD DS    0H                                                  0759 02519000
*                    IF AUSER ^= OLDVOL#                           0759 02520000
*                      THEN                                        0759 02521000
         L     @04,CTGFLPTR                                        0759 02522000
         L     @04,CTGFLPT(,@04)                                   0759 02523000
         CLC   AUSER(6,@04),OLDVOL#                                0759 02524000
         BE    @RF00759                                            0759 02525000
*                        DO;                                       0760 02526000
*                          OLDVOL# = AUSER;                        0761 02527000
         MVC   OLDVOL#(6),AUSER(@04)                               0761 02528000
*                          DARGSENT = LCST12; /*VOL SUBSET DATA      */ 02529000
         L     @15,DARGPTR                                         0762 02530000
         MVI   DARGSENT(@15),X'0C'                                 0762 02531000
*                          DARGCNT = DRGCNT2;              /*@Y30SSMK*/ 02532000
         MVC   DARGCNT(2,@15),@CH00161                             0763 02533000
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/ 02534000
         MVC   DARGINS(2,@15),@CH00457                             0764 02535000
*                          DARGINL(1) = LENGTH(AUSER);             0765 02536000
         MVC   DARGINL(2,@15),@CH00164                             0765 02537000
*                          DARGDTM(1) = ADDR(AUSER);               0766 02538000
         LA    @14,AUSER(,@04)                                     0766 02539000
         ST    @14,DARGDTM(,@15)                                   0766 02540000
*                          DARGINS(2) = DRGINS20;          /*@Y30SSMK*/ 02541000
         MVC   DARGINS+8(2,@15),@CH00649                           0767 02542000
*                          DARGINL(2) = LENGTH(AUDEV);             0768 02543000
         MVC   DARGINL+8(2,@15),@CH00050                           0768 02544000
*                          DARGDTM(2) = ADDR(AUDEV);               0769 02545000
         LA    @04,AUDEV(,@04)                                     0769 02546000
         ST    @04,DARGDTM+8(,@15)                                 0769 02547000
*                          CALL LISTPROC;                          0770 02548000
         BAL   @14,LISTPROC                                        0770 02549000
*                        END;                                      0771 02550000
*                  END AUVOLFLD;                                   0772 02551000
*                /****************************************************/ 02552000
*                /*                                                  */ 02553000
*                /* LIST ALL THE CATALOG DATA FOR A NONVSAM OR UCAT  */ 02554000
*                /* ENTRY.                                           */ 02555000
*                /*                                                  */ 02556000
*                /****************************************************/ 02557000
*                                                                  0773 02558000
*                ELSE                                              0773 02559000
*AUALLFLD:         DO;                                             0773 02560000
         B     @RC00757                                            0773 02561000
@RF00757 DS    0H                                                  0773 02562000
AUALLFLD DS    0H                                                  0774 02563000
*                    DARGDBP = CTGFLPT(1);                         0774 02564000
         L     @04,DARGPTR                                         0774 02565000
         L     @15,CTGFLPTR                                        0774 02566000
         L     @14,CTGFLPT(,@15)                                   0774 02567000
         ST    @14,DARGDBP(,@04)                                   0774 02568000
*                    DARGILP = CTGFLNG(1);                         0775 02569000
         L     @15,CTGFLNG(,@15)                                   0775 02570000
         STH   @15,DARGILP(,@04)                                   0775 02571000
*                    DARGCNT = DRGCNT1;                    /*@Y30SSMK*/ 02572000
*                                                                  0776 02573000
         MVC   DARGCNT(2,@04),@CH00045                             0776 02574000
*                    /************************************************/ 02575000
*                    /*                                              */ 02576000
*                    /* FOR A UCAT ENTRY LIST THE VOLUME FLAG VALUE  */ 02577000
*                    /* BY INSERTING THE ADDRESS OF THE APPROPRIATE  */ 02578000
*                    /* STATIC TEXT DESCRIPTOR INTO THE DARGLIST.    */ 02579000
*                    /*                                              */ 02580000
*                    /************************************************/ 02581000
*                                                                  0777 02582000
*                    IF HOLDETYP = CTGTUCAT                        0777 02583000
*                      THEN                                        0777 02584000
         CLI   HOLDETYP,C'U'                                       0777 02585000
         BNE   @RF00777                                            0777 02586000
*                        DO;                                       0778 02587000
*                          DARGSENT = LCST11;              /*@ZA05939*/ 02588000
         MVI   DARGSENT(@04),X'0B'                                 0779 02589000
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/ 02590000
         LA    @15,10                                              0780 02591000
         STH   @15,DARGINS(,@04)                                   0780 02592000
*                          DARGINL(1) = ABBREVLN;                  0781 02593000
         STH   @15,DARGINL(,@04)                                   0781 02594000
*                          IF AUVPRIM = ON                         0782 02595000
*                            THEN                                  0782 02596000
         TM    AUVPRIM(@14),B'10000000'                            0782 02597000
         BNO   @RF00782                                            0782 02598000
*                              DARGDTM(1) = ADDR(PRIMENM);         0783 02599000
         L     @00,TEXTPTR                                         0783 02600000
         ST    @00,DARGDTM(,@04)                                   0783 02601000
*                            ELSE                                  0784 02602000
*                              IF AUVCAN = ON                      0784 02603000
*                                THEN                              0784 02604000
         B     @RC00782                                            0784 02605000
@RF00782 L     @04,CTGFLPTR                                        0784 02606000
         L     @04,CTGFLPT(,@04)                                   0784 02607000
         TM    AUVCAN(@04),B'01000000'                             0784 02608000
         BNO   @RF00784                                            0784 02609000
*                                  DARGDTM(1) = ADDR(CANNM);       0785 02610000
         L     @04,TEXTPTR                                         0785 02611000
         LA    @04,CANNM(,@04)                                     0785 02612000
         L     @15,DARGPTR                                         0785 02613000
         ST    @04,DARGDTM(,@15)                                   0785 02614000
*                                ELSE                              0786 02615000
*                                  IF AUVOVFL = ON                 0786 02616000
*                                    THEN                          0786 02617000
         B     @RC00784                                            0786 02618000
@RF00784 L     @04,CTGFLPTR                                        0786 02619000
         L     @04,CTGFLPT(,@04)                                   0786 02620000
         TM    AUVOVFL(@04),B'00100000'                            0786 02621000
         BNO   @RF00786                                            0786 02622000
*                                      DARGDTM(1) = ADDR(OVFLONM); 0787 02623000
         L     @04,TEXTPTR                                         0787 02624000
         LA    @04,OVFLONM(,@04)                                   0787 02625000
         L     @15,DARGPTR                                         0787 02626000
         ST    @04,DARGDTM(,@15)                                   0787 02627000
*                                    ELSE                          0788 02628000
*                                     DARGDTM(1) = ADDR(NULLNM);   0788 02629000
         B     @RC00786                                            0788 02630000
@RF00786 L     @04,TEXTPTR                                         0788 02631000
         LA    @04,NULLNM(,@04)                                    0788 02632000
         L     @15,DARGPTR                                         0788 02633000
         ST    @04,DARGDTM(,@15)                                   0788 02634000
*                        END;                                      0789 02635000
*                                                                  0789 02636000
*                      /**********************************************/ 02637000
*                      /*                                            */ 02638000
*                      /* FOR A NONVSAM ENTRY LIST THE FILE SEQ.NO.  */ 02639000
*                      /*                                            */ 02640000
*                      /**********************************************/ 02641000
*                                                                  0790 02642000
*                      ELSE                                        0790 02643000
*                        DO;                                       0790 02644000
         B     @RC00777                                            0790 02645000
@RF00777 DS    0H                                                  0791 02646000
*                          DARGSENT = LCST10;              /*@ZA05939*/ 02647000
         L     @04,DARGPTR                                         0791 02648000
         MVI   DARGSENT(@04),X'0A'                                 0791 02649000
*                          DARGINS(1) = DRGINS10;          /*@ZA05939*/ 02650000
         MVC   DARGINS(2,@04),@CH00457                             0792 02651000
*                          DARGINL(1) = LENGTH(AUFILE);    /*@ZA05939*/ 02652000
         MVC   DARGINL(2,@04),@CH00161                             0793 02653000
*                          DARGDTM(1) = ADDR(AUFILE);      /*@ZA05939*/ 02654000
         L     @15,CTGFLPTR                                        0794 02655000
         L     @15,CTGFLPT(,@15)                                   0794 02656000
         LA    @00,AUFILE(,@15)                                    0794 02657000
         ST    @00,DARGDTM(,@04)                                   0794 02658000
*                        END;                                      0795 02659000
*                    CALL LISTPROC;                                0796 02660000
@RC00777 BAL   @14,LISTPROC                                        0796 02661000
*                  END AUALLFLD;                                   0797 02662000
*                                                                  0797 02663000
*              /******************************************************/ 02664000
*              /*                                                    */ 02665000
*              /* UPDATE THE FPL POINTER TO THE NEXT OCCURRENCE AND  */ 02666000
*              /* ACCORDINGLY DECREMENT THE TOTAL LENGTH BY THAT DATA*/ 02667000
*              /* JUST PROCESSED.                                    */ 02668000
*              /*                                                    */ 02669000
*              /******************************************************/ 02670000
*                                                                  0798 02671000
*              CTGFLNG(1) = CTGFLNG(1) - LENGTH(AUDATA);           0798 02672000
@RC00757 L     @04,CTGFLPTR                                        0798 02673000
         LA    @15,15                                              0798 02674000
         L     @14,CTGFLNG(,@04)                                   0798 02675000
         SLR   @14,@15                                             0798 02676000
         ST    @14,CTGFLNG(,@04)                                   0798 02677000
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(AUDATA);           0799 02678000
         AL    @15,CTGFLPT(,@04)                                   0799 02679000
         ST    @15,CTGFLPT(,@04)                                   0799 02680000
*            END AULIST;                                           0800 02681000
*                                                                  0800 02682000
@DE00756 L     @04,CTGFLPTR                                        0800 02683000
         L     @04,CTGFLNG(,@04)                                   0800 02684000
         C     @04,@CF00235                                        0800 02685000
         BNL   @DL00756                                            0800 02686000
*        /************************************************************/ 02687000
*        /*                                                  @YL026UE*/ 02688000
*        /* EXIT HERE FROM AUPROC IF ONLY THE VOL SUBSET WAS @YL026UE*/ 02689000
*        /* REQUESTED.                                       @YL026UE*/ 02690000
*        /*                                                  @YL026UE*/ 02691000
*        /************************************************************/ 02692000
*                                                                  0801 02693000
*        IF ADDR(VOL) > NULLPTR                                    0801 02694000
*          THEN                                                    0801 02695000
@RF00755 SLR   @04,@04                                             0801 02696000
         L     @15,@PC00001+4                                      0801 02697000
         C     @04,FDTPTR+60(,@15)                                 0801 02698000
         BNL   @RF00801                                            0801 02699000
*          RETURN CODE(0);                                 /*@YL026UE*/ 02700000
*                                                                  0802 02701000
         LR    @15,@04                                             0802 02702000
         L     @13,4(,@13)                                         0802 02703000
         L     @14,12(,@13)                                        0802 02704000
         LM    @00,@12,20(@13)                                     0802 02705000
         BR    @14                                                 0802 02706000
*        END AUOUTPUT;                                     /*@YL026UE*/ 02707000
*                                                                  0803 02708000
@RF00801 DS    0H                                                  0804 02709000
*        /************************************************************/ 02710000
*        /*                                                  @YL026UE*/ 02711000
*        /* LIST THE GDG BASE ATTRIBUTES - LIMIT, SCRATCH, EMPTY     */ 02712000
*        /* (NOTE THAT 'FF'X IS LIMIT(255), NOT NONEXISTENT FIELD)   */ 02713000
*        /*                                                  @YL026UE*/ 02714000
*        /************************************************************/ 02715000
*                                                                  0804 02716000
*        IF HOLDETYP = CTGTGBS & ADDR(VOL) = NULLPTR               0804 02717000
*          THEN                                                    0804 02718000
@RF00749 CLI   HOLDETYP,C'B'                                       0804 02719000
         BNE   @RF00804                                            0804 02720000
         L     @04,@PC00001+4                                      0804 02721000
         L     @04,FDTPTR+60(,@04)                                 0804 02722000
         LTR   @04,@04                                             0804 02723000
         BNZ   @RF00804                                            0804 02724000
*            DO;                                           /*@YL026UE*/ 02725000
*            DARGSENT = LCST45;                            /*@YL026UE*/ 02726000
         L     @04,DARGPTR                                         0806 02727000
         MVI   DARGSENT(@04),X'2D'                                 0806 02728000
*            CTGFLPTR = GDGLMFPT;      /*GDG LIMIT FPL       @YL026UE*/ 02729000
*                                                                  0807 02730000
         L     @00,GDGLMFPT                                        0807 02731000
         ST    @00,CTGFLPTR                                        0807 02732000
*            DARGDBP = CTGFLPT(1);                         /*@YL026UE*/ 02733000
         LR    @15,@00                                             0808 02734000
         L     @15,CTGFLPT(,@15)                                   0808 02735000
         ST    @15,DARGDBP(,@04)                                   0808 02736000
*            DARGILP = CTGFLNG(1);                         /*@YL026UE*/ 02737000
         LR    @15,@00                                             0809 02738000
         L     @00,CTGFLNG(,@15)                                   0809 02739000
         STH   @00,DARGILP(,@04)                                   0809 02740000
*            CTGFLPTR = GDGATFPT;      /*GDG ATTRIBUTE FPL   @YL026UE*/ 02741000
         L     @00,GDGATFPT                                        0810 02742000
         ST    @00,CTGFLPTR                                        0810 02743000
*            DARGCNT = DRGCNT2;                            /*@Y30SSMK*/ 02744000
         MVC   DARGCNT(2,@04),@CH00161                             0811 02745000
*            DARGINS(1) = DRGINS10;                        /*@Y30SSMK*/ 02746000
         LA    @15,10                                              0812 02747000
         STH   @15,DARGINS(,@04)                                   0812 02748000
*            DARGINL(1) = ABBREVLN;                        /*@YL026UE*/ 02749000
         STH   @15,DARGINL(,@04)                                   0813 02750000
*            IF GSCRAT = ON                                        0814 02751000
*              THEN                                                0814 02752000
         LR    @15,@00                                             0814 02753000
         L     @15,CTGFLPT(,@15)                                   0814 02754000
         TM    GSCRAT(@15),B'01000000'                             0814 02755000
         BNO   @RF00814                                            0814 02756000
*                DARGDTM(1) = ADDR(SCRNM);                 /*@YL026UE*/ 02757000
         L     @15,TEXTPTR                                         0815 02758000
         LA    @00,SCRNM(,@15)                                     0815 02759000
         ST    @00,DARGDTM(,@04)                                   0815 02760000
*              ELSE                                                0816 02761000
*                DARGDTM(1) = ADDR(NSCRNM);                /*@YL026UE*/ 02762000
         B     @RC00814                                            0816 02763000
@RF00814 L     @04,TEXTPTR                                         0816 02764000
         LA    @04,NSCRNM(,@04)                                    0816 02765000
         L     @15,DARGPTR                                         0816 02766000
         ST    @04,DARGDTM(,@15)                                   0816 02767000
*            DARGINS(2) = DRGINS20;                        /*@Y30SSMK*/ 02768000
@RC00814 L     @04,DARGPTR                                         0817 02769000
         MVC   DARGINS+8(2,@04),@CH00649                           0817 02770000
*            DARGINL(2) = ABBREVLN;                        /*@YL026UE*/ 02771000
         MVC   DARGINL+8(2,@04),@CH00457                           0818 02772000
*            IF GDELET = ON                                        0819 02773000
*              THEN                                                0819 02774000
         L     @15,CTGFLPTR                                        0819 02775000
         L     @15,CTGFLPT(,@15)                                   0819 02776000
         TM    GDELET(@15),B'10000000'                             0819 02777000
         BNO   @RF00819                                            0819 02778000
*                DARGDTM(2) = ADDR(EMPTYNM);               /*@YL026UE*/ 02779000
         L     @15,TEXTPTR                                         0820 02780000
         LA    @00,EMPTYNM(,@15)                                   0820 02781000
         ST    @00,DARGDTM+8(,@04)                                 0820 02782000
*              ELSE                                                0821 02783000
*                DARGDTM(2) = ADDR(NEMPTYNM);              /*@YL026UE*/ 02784000
         B     @RC00819                                            0821 02785000
@RF00819 L     @04,TEXTPTR                                         0821 02786000
         LA    @04,NEMPTYNM(,@04)                                  0821 02787000
         L     @15,DARGPTR                                         0821 02788000
         ST    @04,DARGDTM+8(,@15)                                 0821 02789000
*            CALL LISTPROC;                                /*@YL026UE*/ 02790000
@RC00819 BAL   @14,LISTPROC                                        0822 02791000
*            END;                                          /*@YL026UE*/ 02792000
*                                                                  0823 02793000
*        /************************************************************/ 02794000
*        /*                                                  @YL026UE*/ 02795000
*        /* LIST THE ASSOCIATED ENTRY TYPES                  @YL026UE*/ 02796000
*        /* FOR A GDG, NONVSAM, UCAT, OR ALIAS ENTRY         @YL026UE*/ 02797000
*        /*                                                  @YL026UE*/ 02798000
*        /************************************************************/ 02799000
*                                                                  0824 02800000
*        CTGFLPTR = ASSOCFPT;                              /*@YL026UE*/ 02801000
@RF00804 L     @04,ASSOCFPT                                        0824 02802000
         ST    @04,CTGFLPTR                                        0824 02803000
*        IF HOLDETYP = CTGTUCAT | HOLDETYP = CTGTANM               0825 02804000
*          THEN                                                    0825 02805000
         CLI   HOLDETYP,C'U'                                       0825 02806000
         BE    @RT00825                                            0825 02807000
         CLI   HOLDETYP,C'X'                                       0825 02808000
         BNE   @RF00825                                            0825 02809000
@RT00825 DS    0H                                                  0826 02810000
*            DO;                                           /*@YL026UE*/ 02811000
*                                                                  0826 02812000
*            CALL ALSPROC;                                 /*@YL026UE*/ 02813000
*                                                                  0827 02814000
         BAL   @14,ALSPROC                                         0827 02815000
*            RESPECIFY RTNREG RSTD;                                0828 02816000
*            TESTRC = RTNREG;                                      0829 02817000
         LR    TESTRC,RTNREG                                       0829 02818000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LSMK*/ 02819000
*                                                                  0830 02820000
*            /********************************************************/ 02821000
*            /*                                              @Y30SSMK*/ 02822000
*            /* RETURN WHEN ANY NON-ZERO RETURN CODE IS      @Y30SSMK*/ 02823000
*            /* ENCOUNTERED WHILE PROCESSING THE UCAT AND    @Y30SSMK*/ 02824000
*            /* ALIAS ASSOCIATIONS.  USE THE RETURN CODE     @Y30SSMK*/ 02825000
*            /* 'SAVRC' WHICH WAS SET IN ALSPROC.            @ZA05939*/ 02826000
*            /*                                              @Y30SSMK*/ 02827000
*            /********************************************************/ 02828000
*                                                                  0831 02829000
*            IF TESTRC ^= 0                                        0831 02830000
*              THEN                                                0831 02831000
         LTR   TESTRC,TESTRC                                       0831 02832000
         BZ    @RF00831                                            0831 02833000
*                RETURN CODE(SAVRC);                       /*@ZA05939*/ 02834000
         LH    @15,SAVRC                                           0832 02835000
         L     @13,4(,@13)                                         0832 02836000
         L     @14,12(,@13)                                        0832 02837000
         LM    @00,@12,20(@13)                                     0832 02838000
         BR    @14                                                 0832 02839000
*            END;                                          /*@YL026UE*/ 02840000
*                                                                  0833 02841000
@RF00831 DS    0H                                                  0834 02842000
*        /************************************************************/ 02843000
*        /*                                                  @Y30SSMK*/ 02844000
*        /* RETRIEVE AND LIST THE ASSOCIATIONS FOR THE       @Y30SSMK*/ 02845000
*        /* NONVSAM ENTRIES.                                 @Y30SSMK*/ 02846000
*        /*                                                  @Y30SSMK*/ 02847000
*        /************************************************************/ 02848000
*                                                                  0834 02849000
*        IF HOLDETYP = CTGTALIN                                    0834 02850000
*          THEN                                                    0834 02851000
@RF00825 CLI   HOLDETYP,C'A'                                       0834 02852000
         BNE   @RF00834                                            0834 02853000
*NVSAMENT:   DO;                                           /*@YL026UE*/ 02854000
*                                                                  0835 02855000
NVSAMENT DS    0H                                                  0836 02856000
*            /********************************************************/ 02857000
*            /*                                              @Y30SSMK*/ 02858000
*            /* FOR A NONVSAM ENTRY OF A GDG, CHECK FOR      @Y30SSMK*/ 02859000
*            /* ALIAS ASSOCIATIONS.                          @Y30SSMK*/ 02860000
*            /*                                              @Y30SSMK*/ 02861000
*            /********************************************************/ 02862000
*                                                                  0836 02863000
*            IF KIND(1) = CTGTGBS                                  0836 02864000
*              THEN                                                0836 02865000
         L     @04,CTGFLPTR                                        0836 02866000
         L     @04,CTGFLPT(,@04)                                   0836 02867000
         CLI   KIND(@04),C'B'                                      0836 02868000
         BNE   @RF00836                                            0836 02869000
*NVSMG0V0:       DO;                                       /*@Y30LSMK*/ 02870000
NVSMG0V0 DS    0H                                                  0838 02871000
*                IF CTGFLNG(1) > CITYPLEN                          0838 02872000
*                  THEN                                            0838 02873000
         L     @04,CTGFLPTR                                        0838 02874000
         L     @00,CTGFLNG(,@04)                                   0838 02875000
         C     @00,@CF00050                                        0838 02876000
         BNH   @RF00838                                            0838 02877000
*                    DO;                                   /*@YL026UE*/ 02878000
*                    ALIASCI# = CI#(2);                    /*@YL026UE*/ 02879000
         L     @04,CTGFLPT(,@04)                                   0840 02880000
         MVC   ALIASCI#(3),CI#+4(@04)                              0840 02881000
*                    ALIASKND = KIND(2);                   /*@YL026UE*/ 02882000
         MVC   ALIASKND(1),KIND+4(@04)                             0841 02883000
*                    G0V0FLG = ON;                         /*@YL026UE*/ 02884000
         OI    G0V0FLG,B'10000000'                                 0842 02885000
*                    END;                                  /*@YL026UE*/ 02886000
*                CALL ANSVPROC;                            /*@YL026UE*/ 02887000
*                                                                  0844 02888000
@RF00838 BAL   @14,ANSVPROC                                        0844 02889000
*                RESPECIFY RTNREG RSTD;                            0845 02890000
*                TESTRC = RTNREG;                                  0846 02891000
         LR    TESTRC,RTNREG                                       0846 02892000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LSMK*/ 02893000
*                                                                  0847 02894000
*                /****************************************************/ 02895000
*                /*                                          @Y30SSMK*/ 02896000
*                /* RETURN WHEN ANY NON-ZERO RETURN CODE IS  @Y30SSMK*/ 02897000
*                /* ENCOUNTERED WHILE RETRIEVING THE NONVSAM @Y30SSMK*/ 02898000
*                /* ASSOCIATIONS.  USE THE RETURN CODE       @Y30SSMK*/ 02899000
*                /* 'SAVRC' WHICH WAS SET IN ANSVPROC.       @ZA05939*/ 02900000
*                /*                                          @Y30SSMK*/ 02901000
*                /****************************************************/ 02902000
*                                                                  0848 02903000
*                IF TESTRC ^= 0                                    0848 02904000
*                  THEN                                            0848 02905000
         LTR   TESTRC,TESTRC                                       0848 02906000
         BZ    @RF00848                                            0848 02907000
*                    RETURN CODE(SAVRC);                   /*@ZA05939*/ 02908000
         LH    @15,SAVRC                                           0849 02909000
         L     @13,4(,@13)                                         0849 02910000
         L     @14,12(,@13)                                        0849 02911000
         LM    @00,@12,20(@13)                                     0849 02912000
         BR    @14                                                 0849 02913000
*                CALL ANLTPROC;                            /*@YL026UE*/ 02914000
*                                                                  0850 02915000
@RF00848 BAL   @14,ANLTPROC                                        0850 02916000
*                RESPECIFY RTNREG RSTD;                            0851 02917000
*                TESTRC = RTNREG;                                  0852 02918000
         LR    TESTRC,RTNREG                                       0852 02919000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LSMK*/ 02920000
*                                                                  0853 02921000
*                /****************************************************/ 02922000
*                /*                                          @Y30SSMK*/ 02923000
*                /* RETURN WHEN ANY NON-ZERO RETURN CODE IS  @Y30SSMK*/ 02924000
*                /* ENCOUNTERED WHILE PROCESSING THE NONVSAM @Y30SSMK*/ 02925000
*                /* ASSOCIATIONS.  USE THE RETURN CODE       @Y30SSMK*/ 02926000
*                /* 'SAVRC' WHICH WAS SET IN ANLTPROC.       @ZA05939*/ 02927000
*                /*                                          @Y30SSMK*/ 02928000
*                /****************************************************/ 02929000
*                                                                  0854 02930000
*                IF TESTRC ^= 0                                    0854 02931000
*                  THEN                                            0854 02932000
         LTR   TESTRC,TESTRC                                       0854 02933000
         BZ    @RF00854                                            0854 02934000
*                    RETURN CODE(SAVRC);                   /*@ZA05939*/ 02935000
         LH    @15,SAVRC                                           0855 02936000
         L     @13,4(,@13)                                         0855 02937000
         L     @14,12(,@13)                                        0855 02938000
         LM    @00,@12,20(@13)                                     0855 02939000
         BR    @14                                                 0855 02940000
*                IF G0V0FLG = ON                                   0856 02941000
*                  THEN                                            0856 02942000
@RF00854 TM    G0V0FLG,B'10000000'                                 0856 02943000
         BNO   @RF00856                                            0856 02944000
*                    DO;                                   /*@YL026UE*/ 02945000
*                    CALL ALSPROC;                         /*@YL026UE*/ 02946000
*                                                                  0858 02947000
         BAL   @14,ALSPROC                                         0858 02948000
*                    RESPECIFY RTNREG RSTD;                        0859 02949000
*                    TESTRC = RTNREG;                              0860 02950000
         LR    TESTRC,RTNREG                                       0860 02951000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30LSMK*/ 02952000
*                                                                  0861 02953000
*                    /************************************************/ 02954000
*                    /*                                      @Y30SSMK*/ 02955000
*                    /* RETURN WHEN ANY NON-ZERO RETURN CODE @Y30SSMK*/ 02956000
*                    /* IS ENCOUNTERED WHILE PROCESSING THE  @Y30SSMK*/ 02957000
*                    /* NONVSAM ALIAS ASSOCIATIONS.  USE THE @Y30SSMK*/ 02958000
*                    /* RETURN CODE 'SAVRC' WHICH WAS SET    @ZA05939*/ 02959000
*                    /* IN ALSPROC.                          @Y30SSMK*/ 02960000
*                    /*                                      @Y30SSMK*/ 02961000
*                    /************************************************/ 02962000
*                                                                  0862 02963000
*                    IF TESTRC ^= 0                                0862 02964000
*                      THEN                                        0862 02965000
         LTR   TESTRC,TESTRC                                       0862 02966000
         BZ    @RF00862                                            0862 02967000
*                        RETURN CODE(SAVRC);               /*@ZA05939*/ 02968000
         LH    @15,SAVRC                                           0863 02969000
         L     @13,4(,@13)                                         0863 02970000
         L     @14,12(,@13)                                        0863 02971000
         LM    @00,@12,20(@13)                                     0863 02972000
         BR    @14                                                 0863 02973000
*                    END;                                  /*@YL026UE*/ 02974000
*                END NVSMG0V0;                             /*@Y30LSMK*/ 02975000
*              ELSE                                                0866 02976000
*                DO;                                       /*@YL026UE*/ 02977000
         B     @RC00836                                            0866 02978000
@RF00836 DS    0H                                                  0867 02979000
*                CALL ALSPROC;                             /*@YL026UE*/ 02980000
*                                                                  0867 02981000
         BAL   @14,ALSPROC                                         0867 02982000
*                RESPECIFY RTNREG RSTD;                            0868 02983000
*                TESTRC = RTNREG;                                  0869 02984000
         LR    TESTRC,RTNREG                                       0869 02985000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LSMK*/ 02986000
*                                                                  0870 02987000
*                /****************************************************/ 02988000
*                /*                                          @Y30SSMK*/ 02989000
*                /* RETURN WHEN ANY NON-ZERO RETURN CODE     @Y30SSMK*/ 02990000
*                /* IS ENCOUNTERED WHILE PROCESSING THE      @Y30SSMK*/ 02991000
*                /* NONVSAM ALIAS ASSOCIATIONS.  USE THE     @Y30SSMK*/ 02992000
*                /* RETURN CODE 'SAVRC' WHICH WAS SET        @ZA05939*/ 02993000
*                /* IN ALSPROC.                              @Y30SSMK*/ 02994000
*                /*                                          @Y30SSMK*/ 02995000
*                /****************************************************/ 02996000
*                                                                  0871 02997000
*                IF TESTRC ^= 0                                    0871 02998000
*                  THEN                                            0871 02999000
         LTR   TESTRC,TESTRC                                       0871 03000000
         BZ    @RF00871                                            0871 03001000
*                    RETURN CODE(SAVRC);                   /*@ZA05939*/ 03002000
         LH    @15,SAVRC                                           0872 03003000
         L     @13,4(,@13)                                         0872 03004000
         L     @14,12(,@13)                                        0872 03005000
         LM    @00,@12,20(@13)                                     0872 03006000
         BR    @14                                                 0872 03007000
*                END;                                      /*@YL026UE*/ 03008000
@RF00871 DS    0H                                                  0874 03009000
*            END NVSAMENT;                                 /*@YL026UE*/ 03010000
*                                                                  0874 03011000
@RC00836 DS    0H                                                  0875 03012000
*          /**********************************************************/ 03013000
*          /*                                                @Y30SSMK*/ 03014000
*          /* RETRIEVE AND LIST THE ASSOCIATIONS OF A GDG    @Y30SSMK*/ 03015000
*          /* ENTRY.                                         @Y30SSMK*/ 03016000
*          /*                                                @Y30SSMK*/ 03017000
*          /**********************************************************/ 03018000
*                                                                  0875 03019000
*          IF HOLDETYP = CTGTGBS                                   0875 03020000
*            THEN                                                  0875 03021000
@RF00834 CLI   HOLDETYP,C'B'                                       0875 03022000
         BNE   @RF00875                                            0875 03023000
*              DO;                                         /*@YL026UE*/ 03024000
*              CALL ANSVPROC;                              /*@YL026UE*/ 03025000
*                                                                  0877 03026000
         BAL   @14,ANSVPROC                                        0877 03027000
*              RESPECIFY RTNREG RSTD;                              0878 03028000
*              TESTRC = RTNREG;                                    0879 03029000
         LR    TESTRC,RTNREG                                       0879 03030000
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30LSMK*/ 03031000
*                                                                  0880 03032000
*              /******************************************************/ 03033000
*              /*                                            @Y30SSMK*/ 03034000
*              /* RETURN WHEN ANY NON-ZERO RETURN CODE IS    @Y30SSMK*/ 03035000
*              /* ENCOUNTERED WHILE RETRIEVING THE GDG       @Y30SSMK*/ 03036000
*              /* ASSOCIATIONS.  USE THE RETURN CODE         @Y30SSMK*/ 03037000
*              /* 'SAVRC' WHICH WAS SET IN ANSVPROC.         @ZA05939*/ 03038000
*              /*                                            @Y30SSMK*/ 03039000
*              /******************************************************/ 03040000
*                                                                  0881 03041000
*              IF TESTRC ^= 0                                      0881 03042000
*                THEN                                              0881 03043000
         LTR   TESTRC,TESTRC                                       0881 03044000
         BZ    @RF00881                                            0881 03045000
*                  RETURN CODE(SAVRC);                     /*@ZA05939*/ 03046000
         LH    @15,SAVRC                                           0882 03047000
         L     @13,4(,@13)                                         0882 03048000
         L     @14,12(,@13)                                        0882 03049000
         LM    @00,@12,20(@13)                                     0882 03050000
         BR    @14                                                 0882 03051000
*              IF ADDR(VOL) = NULLPTR                              0883 03052000
*                THEN                                              0883 03053000
@RF00881 L     @04,@PC00001+4                                      0883 03054000
         L     @04,FDTPTR+60(,@04)                                 0883 03055000
         LTR   @04,@04                                             0883 03056000
         BNZ   @RF00883                                            0883 03057000
*                  DO;                                     /*@YL026UE*/ 03058000
*                  CALL ANLTPROC;                          /*@YL026UE*/ 03059000
*                                                                  0885 03060000
         BAL   @14,ANLTPROC                                        0885 03061000
*                  RESPECIFY RTNREG RSTD;                          0886 03062000
*                  TESTRC = RTNREG;                                0887 03063000
         LR    TESTRC,RTNREG                                       0887 03064000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LSMK*/ 03065000
*                                                                  0888 03066000
*                  /**************************************************/ 03067000
*                  /*                                        @Y30SSMK*/ 03068000
*                  /* RETURN WHEN ANY NON-ZERO RETURN CODE   @Y30SSMK*/ 03069000
*                  /* IS ENCOUNTERED WHILE PROCESSING THE    @Y30SSMK*/ 03070000
*                  /* GDG ASSOCIATIONS.  USE THE RETURN      @Y30SSMK*/ 03071000
*                  /* CODE 'SAVRC' WHICH WAS SET IN ANLTPROC.@ZA05939*/ 03072000
*                  /*                                        @Y30SSMK*/ 03073000
*                  /**************************************************/ 03074000
*                                                                  0889 03075000
*                  IF TESTRC ^= 0                                  0889 03076000
*                    THEN                                          0889 03077000
         LTR   TESTRC,TESTRC                                       0889 03078000
         BZ    @RF00889                                            0889 03079000
*                      RETURN CODE(SAVRC);                 /*@ZA05939*/ 03080000
         LH    @15,SAVRC                                           0890 03081000
         L     @13,4(,@13)                                         0890 03082000
         L     @14,12(,@13)                                        0890 03083000
         LM    @00,@12,20(@13)                                     0890 03084000
         BR    @14                                                 0890 03085000
*                  END;                                    /*@YL026UE*/ 03086000
@RF00889 DS    0H                                                  0892 03087000
*              END;                                        /*@YL026UE*/ 03088000
@RF00883 DS    0H                                                  0893 03089000
*        /************************************************************/ 03090000
*        /*                                                          */ 03091000
*        /* EXIT FROM THE NONVSAM/USERCAT ROUTINE, RETURNING TO THE  */ 03092000
*        /* ROUTING PROCEDURE.                                       */ 03093000
*        /*                                                          */ 03094000
*        /************************************************************/ 03095000
*                                                                  0893 03096000
*        RETURN CODE(0);                                           0893 03097000
@RF00875 SLR   @15,@15                                             0893 03098000
         L     @13,4(,@13)                                         0893 03099000
         L     @14,12(,@13)                                        0893 03100000
         LM    @00,@12,20(@13)                                     0893 03101000
         BR    @14                                                 0893 03102000
*        END AUPROC;                                               0894 03103000
*        /************************************************************/ 03104000
*        /*                                                          */ 03105000
*        /* PROCEDURE - CDIPROC                                      */ 03106000
*        /*                                                          */ 03107000
*        /* FUNCTION - FORMATS THE VSAM CATALOG DATA FOR CLUSTER,    */ 03108000
*        /* AIX, PGSPC, DATA, INDEX OR PATH ENTRIES.         @Y30SSMK*/ 03109000
*        /* THEN PROCESSING ALL CATALOG INFORMATION,         @Y30SSMK*/ 03110000
*        /* ISSUES THE LOCATE REQUEST TO OBTAIN THE          @Y30SSMK*/ 03111000
*        /* OTHER ASSOCIATED ENTRYNAMES OF THE ENTRY BEING CURRENTLY */ 03112000
*        /* PROCESSED.  REPETITIVELY BUILDS THE AMS TEXT PROCESSOR   */ 03113000
*        /* ARGUMENT LIST AND INVOKES LISTPROC TO ISSUE THE AMS      */ 03114000
*        /* UPRINT MACRO TO OUTPUT THE CATALOG DATA.                 */ 03115000
*        /*                                                          */ 03116000
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM CATALOG DATA    */ 03117000
*        /* RETRIEVED VIA A LOCATE REQUEST.  THE VSAM CPL AND FPL'S  */ 03118000
*        /* AND THE AMS GDT AND THE PREFORMATTED DESCRIPTORS FROM    */ 03119000
*        /* STATIC TEXT FOR EDITING THE CATALOG DATA.                */ 03120000
*        /*                                                          */ 03121000
*        /* OUTPUT - PRINTED VSAM CATALOG DATA FOR EITHER A CLUSTER, */ 03122000
*        /* AIX, PGSPC, DATA, INDEX OR PATH ENTRY.           @Y30SSMK*/ 03123000
*        /*                                                          */ 03124000
*        /************************************************************/ 03125000
*                                                                  0895 03126000
*CDIPROC: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA05939*/ 03127000
*                                                                  0895 03128000
CDIPROC  STM   @14,@12,12(@13)                                     0895 03129000
         ST    @13,@SA00007+4                                      0895 03130000
         LA    @14,@SA00007                                        0895 03131000
         ST    @14,8(,@13)                                         0895 03132000
         LR    @13,@14                                             0895 03133000
*        GEN(ENTRY CDIPROC);           /*EXT ENTRY POINT     @ZA05939*/ 03134000
         ENTRY CDIPROC                                                  03135000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 03136000
*                                                                  0897 03137000
         LM    REG8,REG12,BASESAVE                                 0897 03138000
*        /************************************************************/ 03139000
*        /*                                                          */ 03140000
*        /* LOCAL VARIABLES                                          */ 03141000
*        /*                                                          */ 03142000
*        /************************************************************/ 03143000
*                                                                  0898 03144000
*        DCL CKK       FIXED(15);      /*DO GROUP CONTROL VAR        */ 03145000
*        DCL CLENGTH1  FIXED(15)       /*SHR OPTN STATIC TEXT VAR    */ 03146000
*                      CONSTANT(1);                                0899 03147000
*        DCL CVARPTR   PTR(31);        /*WORK POINTER FOR ENTVOL INFO*/ 03148000
*        DCL CURRLEN   FIXED(31);      /*WKA FOR ENTVOL LENGTH       */ 03149000
*        DCL PGPTR     PTR(31);        /*FOR REPETITIVE NOBYTTRK INFO   03150000
*                                                            @YL026UE*/ 03151000
*        DCL DALLOCNM  PTR(31);        /* RETAINS PTR TO DATA NAME 0903 03152000
*                                        FOR ALLOC LOCATE    @YL026UE*/ 03153000
*        /************************************************************/ 03154000
*        /*                                                          */ 03155000
*        /* DETERMINE THE PROPER PREFORMATTED STATIC TEXT DESCRIPTOR */ 03156000
*        /* TO IDENTIFY THE ENTRY AS A CLUSTER OR AIX OR     @Y30SSMK*/ 03157000
*        /* PGSPC OR DATA OR INDEX OR PATH.  ALSO UPDATE THE @Y30SSMK*/ 03158000
*        /* APPROPRIATE ENTRY TYPE COUNTER.                  @Y30SSMK*/ 03159000
*        /*                                                          */ 03160000
*        /************************************************************/ 03161000
*                                                                  0904 03162000
*        OLDERID2 = NEWERID2;                                      0904 03163000
         L     @04,@PC00001                                        0904 03164000
         L     @15,GDTTR2(,@04)                                    0904 03165000
         MVC   @TS00001(95),NEWERID2(@15)                          0904 03166000
         MVC   OLDERID2(95,@15),@TS00001                           0904 03167000
*        NEWID2 = 'LCCL';                                          0905 03168000
*                                                                  0905 03169000
*                                                                  0905 03170000
         MVC   NEWID2(4,@15),@CC01637                              0905 03171000
*        IF GDTDBG = NULLPTR                                       0906 03172000
*          THEN;                                                   0906 03173000
         L     @04,GDTDBG(,@04)                                    0906 03174000
         LTR   @04,@04                                             0906 03175000
         BZ    @RT00906                                            0906 03176000
*          ELSE                                                    0908 03177000
*            CALL IDCDB010(GDTTBL,'LCCD',DPLISTPT);                0908 03178000
         L     @04,@PC00001                                        0908 03179000
         ST    @04,@AL00001                                        0908 03180000
         LA    @00,@CC01638                                        0908 03181000
         ST    @00,@AL00001+4                                      0908 03182000
         LA    @00,DPLISTPT                                        0908 03183000
         ST    @00,@AL00001+8                                      0908 03184000
         MVI   @AL00001+8,X'80'                                    0908 03185000
         L     @15,GDTDBG(,@04)                                    0908 03186000
         LA    @01,@AL00001                                        0908 03187000
         BALR  @14,@15                                             0908 03188000
*                                                          /*@ZA05939*/ 03189000
*                                                                  0909 03190000
*                                                                  0909 03191000
*        /************************************************************/ 03192000
*        /*                                                  @YL026UE*/ 03193000
*        /* IF THE TYPE VALUE  PASSED TO CDIPROC IS A CLUSTER,       */ 03194000
*        /* IT MUST BE DETERMINED VIA THE CATTR FPL WHETHER  @YL026UE*/ 03195000
*        /* THIS ENTRY IS A CLUSTER OR PAGESPACE.            @YL026UE*/ 03196000
*        /*                                                  @YL026UE*/ 03197000
*        /************************************************************/ 03198000
*                                                                  0909 03199000
*        IF HOLDETYP = CTGTCL                                      0909 03200000
*          THEN                                                    0909 03201000
@RT00906 CLI   HOLDETYP,C'C'                                       0909 03202000
         BNE   @RF00909                                            0909 03203000
*            DO;                                           /*@YL026UE*/ 03204000
*              IF PGSPCFLG = OFF                                   0911 03205000
*                THEN                                              0911 03206000
         TM    PGSPCFLG,B'10000000'                                0911 03207000
         BNZ   @RF00911                                            0911 03208000
*                  DO;                                     /*@YL026UE*/ 03209000
*                  CTYPCNT = CTYPCNT + 1;                  /*@YL026UE*/ 03210000
         LA    @04,1                                               0913 03211000
         AL    @04,CTYPCNT                                         0913 03212000
         ST    @04,CTYPCNT                                         0913 03213000
*                  DARGSENT = LCST06;                      /*@YL026UE*/ 03214000
         L     @04,DARGPTR                                         0914 03215000
         MVI   DARGSENT(@04),X'06'                                 0914 03216000
*                  END;                                    /*@YL026UE*/ 03217000
*                ELSE                                              0916 03218000
*                  DO;                                     /*@YL026UE*/ 03219000
         B     @RC00911                                            0916 03220000
@RF00911 DS    0H                                                  0917 03221000
*                  PTYPCNT = PTYPCNT + 1;                  /*@YL026UE*/ 03222000
         LA    @04,1                                               0917 03223000
         AL    @04,PTYPCNT                                         0917 03224000
         ST    @04,PTYPCNT                                         0917 03225000
*                  DARGSENT = LCST41;                      /*@YL026UE*/ 03226000
         L     @04,DARGPTR                                         0918 03227000
         MVI   DARGSENT(@04),X'29'                                 0918 03228000
*                  END;                                    /*@YL026UE*/ 03229000
*            END;                                          /*@YL026UE*/ 03230000
*          ELSE                                                    0921 03231000
*            IF HOLDETYP = CTGTAIX                                 0921 03232000
*              THEN                                                0921 03233000
         B     @RC00909                                            0921 03234000
@RF00909 CLI   HOLDETYP,C'G'                                       0921 03235000
         BNE   @RF00921                                            0921 03236000
*                DO;                                       /*@Y30SSMK*/ 03237000
*                  GTYPCNT = GTYPCNT + 1;                  /*@Y30SSMK*/ 03238000
         LA    @04,1                                               0923 03239000
         AL    @04,GTYPCNT                                         0923 03240000
         ST    @04,GTYPCNT                                         0923 03241000
*                  DARGSENT = LCST48;                      /*@Y30SSMK*/ 03242000
         L     @04,DARGPTR                                         0924 03243000
         MVI   DARGSENT(@04),X'30'                                 0924 03244000
*                END;                                      /*@Y30SSMK*/ 03245000
*              ELSE                                                0926 03246000
*                IF HOLDETYP = CTGTDATA                            0926 03247000
*                  THEN                                            0926 03248000
         B     @RC00921                                            0926 03249000
@RF00921 CLI   HOLDETYP,C'D'                                       0926 03250000
         BNE   @RF00926                                            0926 03251000
*                    DO;                                           0927 03252000
*                      DTYPCNT = DTYPCNT + 1;                      0928 03253000
         LA    @04,1                                               0928 03254000
         AL    @04,DTYPCNT                                         0928 03255000
         ST    @04,DTYPCNT                                         0928 03256000
*                      DENTAFLG = OFF;                     /*@YL026UE*/ 03257000
*                                                                  0929 03258000
         NI    DENTAFLG,B'01111111'                                0929 03259000
*                      /**********************************************/ 03260000
*                      /*                                    @YL026UE*/ 03261000
*                      /* DETERMINE IF DATA ENTRY IS PART OF A       */ 03262000
*                      /* PAGESPACE BY CHECKING ASSOCIATION. @YL026UE*/ 03263000
*                      /*                                    @YL026UE*/ 03264000
*                      /**********************************************/ 03265000
*                                                                  0930 03266000
*                      IF ADDR(ALLOC) > NULLPTR & CATRC ^= CRCBADPW     03267000
*                         & ENTCLFLG = OFF                         0930 03268000
*                        THEN                                      0930 03269000
         L     @04,@PC00001+4                                      0930 03270000
         L     @04,FDTPTR+64(,@04)                                 0930 03271000
         LTR   @04,@04                                             0930 03272000
         BNP   @RF00930                                            0930 03273000
         CLC   CATRC(2),@CH01280                                   0930 03274000
         BE    @RF00930                                            0930 03275000
         TM    ENTCLFLG,B'10000000'                                0930 03276000
         BNZ   @RF00930                                            0930 03277000
*                          DO;                             /*@YL026UE*/ 03278000
*                                                                  0931 03279000
*                          CALL ANSVPROC;                  /*@YL026UE*/ 03280000
*                                                                  0932 03281000
         BAL   @14,ANSVPROC                                        0932 03282000
*                          RESPECIFY RTNREG RSTD;                  0933 03283000
*                          TESTRC = RTNREG;                        0934 03284000
         LR    TESTRC,RTNREG                                       0934 03285000
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30LSMK*/ 03286000
*                                                                  0935 03287000
*                          /******************************************/ 03288000
*                          /*                                @Y30SSMK*/ 03289000
*                          /* RETURN WHEN ANY NON-ZERO       @Y30SSMK*/ 03290000
*                          /* RETURN CODE IS ENCOUNTERED     @Y30SSMK*/ 03291000
*                          /* WHILE RETRIEVING THE DATA      @Y30SSMK*/ 03292000
*                          /* ASSOCIATIONS.  USE THE         @Y30SSMK*/ 03293000
*                          /* RETURN CODE 'SAVRC' WHICH WAS  @ZA05939*/ 03294000
*                          /* SET IN ANSVPROC.               @Y30SSMK*/ 03295000
*                          /*                                @Y30SSMK*/ 03296000
*                          /******************************************/ 03297000
*                                                                  0936 03298000
*                          IF TESTRC ^= 0                          0936 03299000
*                            THEN                                  0936 03300000
         LTR   TESTRC,TESTRC                                       0936 03301000
         BZ    @RF00936                                            0936 03302000
*                              RETURN CODE(SAVRC);         /*@ZA05939*/ 03303000
         LH    @15,SAVRC                                           0937 03304000
         L     @13,4(,@13)                                         0937 03305000
         L     @14,12(,@13)                                        0937 03306000
         LM    @00,@12,20(@13)                                     0937 03307000
         BR    @14                                                 0937 03308000
*                          DENTAFLG = ON;                  /*@YL026UE*/ 03309000
@RF00936 OI    DENTAFLG,B'10000000'                                0938 03310000
*                          CTGFLPTR = ENT44FPT;            /*@YL026UE*/ 03311000
         L     @04,ENT44FPT                                        0939 03312000
         ST    @04,CTGFLPTR                                        0939 03313000
*                          DALLOCNM = CTGFLPT(1);          /*@YL026UE*/ 03314000
*                                                                  0940 03315000
         L     DALLOCNM,CTGFLPT(,@04)                              0940 03316000
*                          CALL ANLTPROC;                  /*@YL026UE*/ 03317000
*                                                                  0941 03318000
         BAL   @14,ANLTPROC                                        0941 03319000
*                          DENTAFLG = OFF;                 /*@YL026UE*/ 03320000
         NI    DENTAFLG,B'01111111'                                0942 03321000
*                          CTGFLPTR = ENT44FPT;            /*@YL026UE*/ 03322000
         L     @04,ENT44FPT                                        0943 03323000
         ST    @04,CTGFLPTR                                        0943 03324000
*                          CTGFLPT(1) = DALLOCNM;          /*@YL026UE*/ 03325000
         ST    DALLOCNM,CTGFLPT(,@04)                              0944 03326000
*                          CTGNOFLD = 1;                   /*@YL026UE*/ 03327000
         L     @04,CTGPLPTR                                        0945 03328000
         MVI   CTGNOFLD(@04),X'01'                                 0945 03329000
*                          CTGPLPTR = TYPCPLPT;            /*@YL026UE*/ 03330000
         L     @04,TYPCPLPT                                        0946 03331000
         ST    @04,CTGPLPTR                                        0946 03332000
*                          RESPECIFY ASSOC                         0947 03333000
*                            BASED(CTGFLPT(1));            /*@YL026UE*/ 03334000
*                          ENTNMFLG = OFF;                 /*@YL026UE*/ 03335000
         NI    ENTNMFLG,B'01111111'                                0948 03336000
*                          DARGLIST = ZEROAREA;            /*@YL026UE*/ 03337000
         L     @04,DARGPTR                                         0949 03338000
         MVC   DARGLIST(20,@04),ZEROAREA                           0949 03339000
*                          DARGSMOD = LC0ID;               /*@YL026UE*/ 03340000
         MVC   DARGSMOD(3,@04),@CC01198                            0950 03341000
*                          END;                            /*@YL026UE*/ 03342000
*                                                                  0951 03343000
*                      /**********************************************/ 03344000
*                      /*                                            */ 03345000
*                      /* THE DATA, INDEX, AND PATH OBJECTS ARE      */ 03346000
*                      /* LISTED INDENTED UNDER THE CLUSTER  @Y30SSMK*/ 03347000
*                      /* AND AIX ENTRY ONLY WHEN THE LISTCAT        */ 03348000
*                      /* REQUEST HAS NOT BEEN RESTRICTED TO @Y30SSMK*/ 03349000
*                      /* A PARTICULAR TYPE.                 @Y30SSMK*/ 03350000
*                      /*                                    @Y30SSMK*/ 03351000
*                      /**********************************************/ 03352000
*                                                                  0952 03353000
*                      IF NDENTFLG = ON                            0952 03354000
*                        THEN                                      0952 03355000
@RF00930 TM    NDENTFLG,B'10000000'                                0952 03356000
         BNO   @RF00952                                            0952 03357000
*                          DARGSENT = LCST07; /*INDENTED DATA HDR    */ 03358000
         L     @04,DARGPTR                                         0953 03359000
         MVI   DARGSENT(@04),X'07'                                 0953 03360000
*                        ELSE                                      0954 03361000
*                          DARGSENT = LCST38; /*NON-INDENTED DATA HDR*/ 03362000
         B     @RC00952                                            0954 03363000
@RF00952 L     @04,DARGPTR                                         0954 03364000
         MVI   DARGSENT(@04),X'26'                                 0954 03365000
*                    END;                                  /*@Y30SSMK*/ 03366000
*                  ELSE                                            0956 03367000
*                    IF HOLDETYP = CTGTINDX                        0956 03368000
*                      THEN                                        0956 03369000
         B     @RC00926                                            0956 03370000
@RF00926 CLI   HOLDETYP,C'I'                                       0956 03371000
         BNE   @RF00956                                            0956 03372000
*                        DO;                                       0957 03373000
*                          ITYPCNT = ITYPCNT + 1;                  0958 03374000
         LA    @04,1                                               0958 03375000
         AL    @04,ITYPCNT                                         0958 03376000
         ST    @04,ITYPCNT                                         0958 03377000
*                          IF NDENTFLG = ON                        0959 03378000
*                            THEN                                  0959 03379000
         TM    NDENTFLG,B'10000000'                                0959 03380000
         BNO   @RF00959                                            0959 03381000
*                              /*INDENTED INDEX HDR                  */ 03382000
*                              DARGSENT = LCST08;                  0960 03383000
         L     @04,DARGPTR                                         0960 03384000
         MVI   DARGSENT(@04),X'08'                                 0960 03385000
*                            ELSE                                  0961 03386000
*                              /*NON-INDENTED INDEX HDR              */ 03387000
*                              DARGSENT = LCST39;                  0961 03388000
         B     @RC00959                                            0961 03389000
@RF00959 L     @04,DARGPTR                                         0961 03390000
         MVI   DARGSENT(@04),X'27'                                 0961 03391000
*                        END;                                      0962 03392000
*                      ELSE                                        0963 03393000
*                        DO;                               /*@Y30SSMK*/ 03394000
         B     @RC00956                                            0963 03395000
@RF00956 DS    0H                                                  0964 03396000
*                          RTYPCNT = RTYPCNT + 1;          /*@Y30SSMK*/ 03397000
         LA    @04,1                                               0964 03398000
         AL    @04,RTYPCNT                                         0964 03399000
         ST    @04,RTYPCNT                                         0964 03400000
*                          IF NDENTFLG = ON                        0965 03401000
*                            THEN                                  0965 03402000
         TM    NDENTFLG,B'10000000'                                0965 03403000
         BNO   @RF00965                                            0965 03404000
*                              /*INDENTED PATH HDR           @Y30SSMK*/ 03405000
*                              DARGSENT = LCST09;          /*@Y30SSMK*/ 03406000
         L     @04,DARGPTR                                         0966 03407000
         MVI   DARGSENT(@04),X'09'                                 0966 03408000
*                            ELSE                                  0967 03409000
*                              /*NON-INDENTED PATH HDR       @Y30SSMK*/ 03410000
*                              DARGSENT = LCST53;          /*@Y30SSMK*/ 03411000
         B     @RC00965                                            0967 03412000
@RF00965 L     @04,DARGPTR                                         0967 03413000
         MVI   DARGSENT(@04),X'35'                                 0967 03414000
*                        END;                              /*@Y30SSMK*/ 03415000
@RC00965 DS    0H                                                  0969 03416000
*        /************************************************************/ 03417000
*        /*                                                          */ 03418000
*        /* LIST THE ENTRY TYPE HEADER WITH THE 44-BYTE ENTRYNAME.   */ 03419000
*        /*  IF THE PROPER PASSWORD WAS NOT PROVIDED AND ONLY THE    */ 03420000
*        /*  NAME SUBSET IS REQUESTED, PICK UP THE ENTRY NAME FROM   */ 03421000
*        /* THE SPECIALLY FORMATTED WORKAREA.                        */ 03422000
*        /*                                                          */ 03423000
*        /************************************************************/ 03424000
*                                                                  0969 03425000
*        IF CATRC = CRCBADPW & ADDR(NAME) > NULLPTR                0969 03426000
*          THEN                                                    0969 03427000
@RC00956 DS    0H                                                  0969 03428000
@RC00926 DS    0H                                                  0969 03429000
@RC00921 DS    0H                                                  0969 03430000
@RC00909 CLC   CATRC(2),@CH01280                                   0969 03431000
         BNE   @RF00969                                            0969 03432000
         L     @04,@PC00001+4                                      0969 03433000
         L     @04,FDTPTR+52(,@04)                                 0969 03434000
         LTR   @04,@04                                             0969 03435000
         BNP   @RF00969                                            0969 03436000
*            DO;                                                   0970 03437000
*            DARGDBP = ADDR(SUPPDSNM);                             0971 03438000
         L     @04,DARGPTR                                         0971 03439000
         L     @15,CTGPLPTR                                        0971 03440000
         L     @15,CTGWKA(,@15)                                    0971 03441000
         LA    @00,SUPPDSNM(,@15)                                  0971 03442000
         ST    @00,DARGDBP(,@04)                                   0971 03443000
*            DARGILP = LENGTH(SUPPDSNM);                           0972 03444000
         MVC   DARGILP(2,@04),@CH00606                             0972 03445000
*            END;                                                  0973 03446000
*          ELSE                                                    0974 03447000
*            DO;                                                   0974 03448000
         B     @RC00969                                            0974 03449000
@RF00969 DS    0H                                                  0975 03450000
*            CTGFLPTR = ENT44FPT;                                  0975 03451000
         L     @04,ENT44FPT                                        0975 03452000
         ST    @04,CTGFLPTR                                        0975 03453000
*            DARGDBP = CTGFLPT(1);                                 0976 03454000
         L     @15,DARGPTR                                         0976 03455000
         L     @14,CTGFLPT(,@04)                                   0976 03456000
         ST    @14,DARGDBP(,@15)                                   0976 03457000
*            DARGILP = CTGFLNG(1);                                 0977 03458000
         L     @04,CTGFLNG(,@04)                                   0977 03459000
         STH   @04,DARGILP(,@15)                                   0977 03460000
*            END;                                                  0978 03461000
*        CALL LISTPROC;                                            0979 03462000
*                                                                  0979 03463000
@RC00969 BAL   @14,LISTPROC                                        0979 03464000
*        /************************************************************/ 03465000
*        /*                                                  @YL026UE*/ 03466000
*        /* IF THE CATNAME SUBTITLE IS NOT USED, IDENTIFY THE        */ 03467000
*        /* CATALOG FOR EACH ENTRY VIA A CATNAME HEADER.     @YL026UE*/ 03468000
*        /*                                                  @YL026UE*/ 03469000
*        /************************************************************/ 03470000
*                                                                  0980 03471000
*        IF NOTTLFLG = ON                                          0980 03472000
*          THEN                                                    0980 03473000
         TM    NOTTLFLG,B'10000000'                                0980 03474000
         BNO   @RF00980                                            0980 03475000
*            DO;                                           /*@YL026UE*/ 03476000
*            DARGSENT = LCST40;                            /*@YL026UE*/ 03477000
         L     @04,DARGPTR                                         0982 03478000
         MVI   DARGSENT(@04),X'28'                                 0982 03479000
*            DARGDBP = ADDR(CATNAME);                      /*@YL026UE*/ 03480000
         LA    @00,CATNAME                                         0983 03481000
         ST    @00,DARGDBP(,@04)                                   0983 03482000
*            DARGILP = LENGTH(CATNAME);                    /*@YL026UE*/ 03483000
         MVC   DARGILP(2,@04),@CH00606                             0984 03484000
*            CALL LISTPROC;                                /*@YL026UE*/ 03485000
         BAL   @14,LISTPROC                                        0985 03486000
*            END;                                          /*@YL026UE*/ 03487000
*        /************************************************************/ 03488000
*        /*                                                          */ 03489000
*        /* EXIT HERE FROM CDIPROC IF:                       @Y30SSMK*/ 03490000
*        /*   1) ONLY THE ENTRYNAME SUBSET WAS REQUESTED, AND        */ 03491000
*        /*   2) A DATA OR INDEX OR PATH ENTRY IS BEING      @Y30SSMK*/ 03492000
*        /*      PROCESSED RATHER THAN A CLUSTER OR AIX      @Y30SSMK*/ 03493000
*        /*      SINCE IT REQUIRES ADDITIONAL PROCESSING TO RETRIEVE */ 03494000
*        /*      THE LIST OF ASSOCIATIONS FOR LOGICAL FORMATTING     */ 03495000
*        /*      OF ALL ASSOCIATIONS UNDER THE CLUSTER OR    @Y30SSMK*/ 03496000
*        /*      AIX INFORMATION, OR                         @Y30SSMK*/ 03497000
*        /*   3) PASSWORD VERIFICATION FAILED FOR THIS ENTRY, IN     */ 03498000
*        /*      WHICH CASE ONLY THE HEADER FOR THE ENTRY TYPE AND   */ 03499000
*        /*      NAME WAS TO BE LISTED.                              */ 03500000
*        /*                                                          */ 03501000
*        /************************************************************/ 03502000
*                                                                  0987 03503000
*        IF ADDR(NAME) > NULLPTR  &                                0987 03504000
*          (CATRC=CRCBADPW  |  HOLDETYP = CTGTDATA  |              0987 03505000
*          HOLDETYP = CTGTINDX  |  HOLDETYP = CTGTPTH)             0987 03506000
*          THEN                                                    0987 03507000
@RF00980 L     @04,@PC00001+4                                      0987 03508000
         L     @04,FDTPTR+52(,@04)                                 0987 03509000
         LTR   @04,@04                                             0987 03510000
         BNP   @RF00987                                            0987 03511000
         CLC   CATRC(2),@CH01280                                   0987 03512000
         BE    @RT00987                                            0987 03513000
         CLI   HOLDETYP,C'D'                                       0987 03514000
         BE    @RT00987                                            0987 03515000
         CLI   HOLDETYP,C'I'                                       0987 03516000
         BE    @RT00987                                            0987 03517000
         CLI   HOLDETYP,C'R'                                       0987 03518000
         BNE   @RF00987                                            0987 03519000
@RT00987 DS    0H                                                  0988 03520000
*            DO;                                                   0988 03521000
*                                                                  0988 03522000
*            /********************************************************/ 03523000
*            /*                                                      */ 03524000
*            /* IF PASSWORD VERIFICATION FAILED FOR A CLUSTER        */ 03525000
*            /* OR AIX ENTRY IS BEING PROCESSED, SET TO      @Y30SSMK*/ 03526000
*            /* ZERO THE NUMBER OF ASSOCIATIONS TO BE PROCESSED      */ 03527000
*            /* LATER BY THE ROUTING ROUTINE                 @Y30SSMK*/ 03528000
*            /*                                                      */ 03529000
*            /********************************************************/ 03530000
*                                                                  0989 03531000
*            IF HOLDETYP = CTGTCL  |  HOLDETYP = CTGTAIX           0989 03532000
*              THEN                                                0989 03533000
         CLI   HOLDETYP,C'C'                                       0989 03534000
         BE    @RT00989                                            0989 03535000
         CLI   HOLDETYP,C'G'                                       0989 03536000
         BNE   @RF00989                                            0989 03537000
@RT00989 DS    0H                                                  0990 03538000
*                ASSOC# = 0;                                       0990 03539000
         SLR   @04,@04                                             0990 03540000
         STH   @04,ASSOC#                                          0990 03541000
*            RETURN CODE (0);                                      0991 03542000
@RF00989 SLR   @15,@15                                             0991 03543000
         L     @13,4(,@13)                                         0991 03544000
         L     @14,12(,@13)                                        0991 03545000
         LM    @00,@12,20(@13)                                     0991 03546000
         BR    @14                                                 0991 03547000
*            END;                                                  0992 03548000
*        /************************************************************/ 03549000
*        /*                                                  @Y30LSMK*/ 03550000
*        /* PROCEED TO PROCESS THE OWNER, DATE, RELEASE, AND @Y30SSMK*/ 03551000
*        /* CATALOG RECOVERY FIELDS FOR EITHER THE CLUSTER   @Y30SSMK*/ 03552000
*        /* OR AIX OR DATA OR INDEX OR PATH ENTRY.           @Y30SSMK*/ 03553000
*        /*                                                  @Y30LSMK*/ 03554000
*        /************************************************************/ 03555000
*                                                                  0993 03556000
*        IF ADDR(NAME) = NULLPTR                                   0993 03557000
*          THEN                                                    0993 03558000
*                                                                  0993 03559000
@RF00987 L     @04,@PC00001+4                                      0993 03560000
         L     @04,FDTPTR+52(,@04)                                 0993 03561000
         LTR   @04,@04                                             0993 03562000
         BNZ   @RF00993                                            0993 03563000
*            /********************************************************/ 03564000
*            /*                                              @Y30LSMK*/ 03565000
*            /* BUILD THE TEXT PROCESSOR DARGLIST.           @Y30LSMK*/ 03566000
*            /* NOTE - ANY FIELDS RETURNED FROM THE CATALOG PADDED   */ 03567000
*            /* WITH HEX FF'S REQUIRE SPECIAL HANDLING TO SETUP A    */ 03568000
*            /* PRINTABLE FORMAT.  HENCE ARITHMETIC FIELDS ARE       */ 03569000
*            /* OVERLAYED WITH ZEROES AND CHARACTER FIELDS ARE       */ 03570000
*            /* OVERRIDDEN WITH THE 'NULL' STATIC TEXT ENTRY.        */ 03571000
*            /*                                              @Y30LSMK*/ 03572000
*            /********************************************************/ 03573000
*                                                                  0994 03574000
*            DO;                                           /*@Y30LSMK*/ 03575000
*              DARGSENT = LCST13;      /* OWNER AND DATE HEADER      */ 03576000
         L     @04,DARGPTR                                         0995 03577000
         MVI   DARGSENT(@04),X'0D'                                 0995 03578000
*              DARGCNT = DRGCNT7;                          /*@Y30SSMK*/ 03579000
         MVC   DARGCNT(2,@04),@CH00498                             0996 03580000
*              CTGFLPTR = DSIDFPT;                         /*@Y30LSMK*/ 03581000
         L     @04,DSIDFPT                                         0997 03582000
         ST    @04,CTGFLPTR                                        0997 03583000
*              IF DSID = HEXFF                                     0998 03584000
*                THEN                                              0998 03585000
         L     @04,CTGFLPT(,@04)                                   0998 03586000
         CLC   DSID(8,@04),HEXFF                                   0998 03587000
         BNE   @RF00998                                            0998 03588000
*                  DSID = NULLNM;                          /*@Y30LSMK*/ 03589000
         L     @15,TEXTPTR                                         0999 03590000
         MVC   DSID(8,@04),NULLNM(@15)                             0999 03591000
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/ 03592000
@RF00998 L     @04,DARGPTR                                         1000 03593000
         MVC   DARGINS(2,@04),@CH00457                             1000 03594000
*              DARGINL(1) = CTGFLNG(1);                    /*@Y30LSMK*/ 03595000
         L     @15,CTGFLPTR                                        1001 03596000
         L     @14,CTGFLNG(,@15)                                   1001 03597000
         STH   @14,DARGINL(,@04)                                   1001 03598000
*              DARGDTM(1) = CTGFLPT(1);                    /*@Y30LSMK*/ 03599000
*                                                                  1002 03600000
         L     @00,CTGFLPT(,@15)                                   1002 03601000
         ST    @00,DARGDTM(,@04)                                   1002 03602000
*              CTGFLPTR = CRDTFPT;                         /*@Y30LSMK*/ 03603000
         L     @04,CRDTFPT                                         1003 03604000
         ST    @04,CTGFLPTR                                        1003 03605000
*              IF CRDT = ARITH4FF                                  1004 03606000
*                THEN                                              1004 03607000
         L     @04,CTGFLPT(,@04)                                   1004 03608000
         CLC   CRDT(3,@04),ARITH4FF                                1004 03609000
         BNE   @RF01004                                            1004 03610000
*                  CRDT = ZEROAREA;                        /*@Y30LSMK*/ 03611000
         MVC   CRDT(3,@04),ZEROAREA                                1005 03612000
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/ 03613000
@RF01004 L     @04,DARGPTR                                         1006 03614000
         MVC   DARGINS+8(2,@04),@CH00649                           1006 03615000
*              DARGINL(2) = CTGFLNG(1);                    /*@Y30LSMK*/ 03616000
         L     @15,CTGFLPTR                                        1007 03617000
         L     @14,CTGFLNG(,@15)                                   1007 03618000
         STH   @14,DARGINL+8(,@04)                                 1007 03619000
*              DARGDTM(2) = CTGFLPT(1);                    /*@Y30LSMK*/ 03620000
*                                                                  1008 03621000
         L     @00,CTGFLPT(,@15)                                   1008 03622000
         ST    @00,DARGDTM+8(,@04)                                 1008 03623000
*              CTGFLPTR = EXDTFPT;                         /*@Y30LSMK*/ 03624000
         L     @04,EXDTFPT                                         1009 03625000
         ST    @04,CTGFLPTR                                        1009 03626000
*              IF EXDT = ARITH4FF                                  1010 03627000
*                THEN                                              1010 03628000
         L     @04,CTGFLPT(,@04)                                   1010 03629000
         CLC   EXDT(3,@04),ARITH4FF                                1010 03630000
         BNE   @RF01010                                            1010 03631000
*                  EXDT = ZEROAREA;                        /*@Y30LSMK*/ 03632000
         MVC   EXDT(3,@04),ZEROAREA                                1011 03633000
*              DARGINS(3) = DRGINS30;                      /*@Y30SSMK*/ 03634000
@RF01010 L     @04,DARGPTR                                         1012 03635000
         MVC   DARGINS+16(2,@04),@CH01231                          1012 03636000
*              DARGINL(3) = CTGFLNG(1);                    /*@Y30LSMK*/ 03637000
         L     @15,CTGFLPTR                                        1013 03638000
         L     @14,CTGFLNG(,@15)                                   1013 03639000
         STH   @14,DARGINL+16(,@04)                                1013 03640000
*              DARGDTM(3) = CTGFLPT(1);                    /*@Y30LSMK*/ 03641000
*                                                                  1014 03642000
         L     @00,CTGFLPT(,@15)                                   1014 03643000
         ST    @00,DARGDTM+16(,@04)                                1014 03644000
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/ 03645000
         L     @00,RELFPT                                          1015 03646000
         ST    @00,CTGFLPTR                                        1015 03647000
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/ 03648000
         LR    @15,@00                                             1016 03649000
         L     @15,CTGFLPT(,@15)                                   1016 03650000
         ST    @15,DARGDBP(,@04)                                   1016 03651000
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/ 03652000
         LR    @14,@00                                             1017 03653000
         L     @14,CTGFLNG(,@14)                                   1017 03654000
         STH   @14,DARGILP(,@04)                                   1017 03655000
*              DSREL = DSREL + 1;      /*CALUCATE REL NO.    @Y30SSMK*/ 03656000
         LA    @14,1                                               1018 03657000
         SLR   @00,@00                                             1018 03658000
         IC    @00,DSREL(,@15)                                     1018 03659000
         ALR   @14,@00                                             1018 03660000
         STC   @14,DSREL(,@15)                                     1018 03661000
*              IF DSSER = ZEROAREA                                 1019 03662000
*                THEN                                              1019 03663000
         CLC   DSSER(6,@15),ZEROAREA                               1019 03664000
         BNE   @RF01019                                            1019 03665000
*                  DARGSENT = LCST13;  /*EXCLUDE CRA INFO    @Y30SSMK*/ 03666000
         MVI   DARGSENT(@04),X'0D'                                 1020 03667000
*                ELSE                                              1021 03668000
*                  DARGSENT = LCST50;  /*INCLUDE CRA INFO    @Y30SSMK*/ 03669000
         B     @RC01019                                            1021 03670000
@RF01019 L     @04,DARGPTR                                         1021 03671000
         MVI   DARGSENT(@04),X'32'                                 1021 03672000
*              CALL LISTPROC;                              /*@Y30LSMK*/ 03673000
@RC01019 BAL   @14,LISTPROC                                        1022 03674000
*            END;                                          /*@Y30LSMK*/ 03675000
*        /************************************************************/ 03676000
*        /*                                                  @Y30LSMK*/ 03677000
*        /* EXIT HERE FROM CDIPROC IF                        @Y30SSMK*/ 03678000
*        /*   1) ONLY THE HISTORY SUBSET WAS REQUESTED, AND  @Y30LSMK*/ 03679000
*        /*   2) A DATA OR INDEX OR PATH ENTRY IS BEING PROCESSED    */ 03680000
*        /*      RATHER THAN A CL OR AIX SINCE IT REQUIRES ADDITIONAL*/ 03681000
*        /*      PROCESSING TO RETRIEVE THE LIST OF ASSOCIATIONS     */ 03682000
*        /*      FOR LOGICAL FORMATTING OF ALL ASSOCIATIONS UNDER    */ 03683000
*        /*      THE CLUSTER OR AIX INFORMATION.             @Y30SSMK*/ 03684000
*        /*                                                  @Y30LSMK*/ 03685000
*        /************************************************************/ 03686000
*                                                                  1024 03687000
*        IF ADDR(HIST) > NULLPTR  &  (HOLDETYP = CTGTDATA  |       1024 03688000
*          HOLDETYP = CTGTINDX  |  HOLDETYP = CTGTPTH)             1024 03689000
*          THEN                                                    1024 03690000
@RF00993 L     @04,@PC00001+4                                      1024 03691000
         L     @04,FDTPTR+104(,@04)                                1024 03692000
         LTR   @04,@04                                             1024 03693000
         BNP   @RF01024                                            1024 03694000
         CLI   HOLDETYP,C'D'                                       1024 03695000
         BE    @RT01024                                            1024 03696000
         CLI   HOLDETYP,C'I'                                       1024 03697000
         BE    @RT01024                                            1024 03698000
         CLI   HOLDETYP,C'R'                                       1024 03699000
         BNE   @RF01024                                            1024 03700000
@RT01024 DS    0H                                                  1025 03701000
*            RETURN CODE (0);                              /*@Y30LSMK*/ 03702000
         SLR   @15,@15                                             1025 03703000
         L     @13,4(,@13)                                         1025 03704000
         L     @14,12(,@13)                                        1025 03705000
         LM    @00,@12,20(@13)                                     1025 03706000
         BR    @14                                                 1025 03707000
*        /************************************************************/ 03708000
*        /*                                                  @X04SVMK*/ 03709000
*        /* EXIT HERE IF A PATH IS BEING PROCESSED AND ALL   @X04SVMK*/ 03710000
*        /* CATALOG DATA HAS NOT BEEN SPECIFIED              @X04SVMK*/ 03711000
*        /*                                                  @X04SVMK*/ 03712000
*        /************************************************************/ 03713000
*                                                                  1026 03714000
*        IF ADDR(FALL) = NULLPTR  &  HOLDETYP = CTGTPTH            1026 03715000
*          THEN                                                    1026 03716000
@RF01024 SLR   @04,@04                                             1026 03717000
         L     @15,@PC00001+4                                      1026 03718000
         C     @04,FDTPTR+56(,@15)                                 1026 03719000
         BNE   @RF01026                                            1026 03720000
         CLI   HOLDETYP,C'R'                                       1026 03721000
         BNE   @RF01026                                            1026 03722000
*            RETURN CODE(0);                               /*@X04SVMK*/ 03723000
         LR    @15,@04                                             1027 03724000
         L     @13,4(,@13)                                         1027 03725000
         L     @14,12(,@13)                                        1027 03726000
         LM    @00,@12,20(@13)                                     1027 03727000
         BR    @14                                                 1027 03728000
*        /************************************************************/ 03729000
*        /*                                                          */ 03730000
*        /* IF THIS IS A VOLUME SUBSET REQUEST AND THE ENTRY IS A    */ 03731000
*        /* DATA OR INDEX TYPE, LIST THE VOLUME SERIAL NUMBER AND    */ 03732000
*        /* DEVICE TYPE FIELDS.                                      */ 03733000
*        /*                                                          */ 03734000
*        /************************************************************/ 03735000
*                                                                  1028 03736000
*        IF ADDR(VOL) > NULLPTR  &                                 1028 03737000
*          (HOLDETYP = CTGTDATA  |  HOLDETYP = CTGTINDX)           1028 03738000
*          THEN                                                    1028 03739000
*                                                                  1028 03740000
@RF01026 L     @04,@PC00001+4                                      1028 03741000
         L     @04,FDTPTR+60(,@04)                                 1028 03742000
         LTR   @04,@04                                             1028 03743000
         BNP   @RF01028                                            1028 03744000
         CLI   HOLDETYP,C'D'                                       1028 03745000
         BE    @RT01028                                            1028 03746000
         CLI   HOLDETYP,C'I'                                       1028 03747000
         BNE   @RF01028                                            1028 03748000
@RT01028 DS    0H                                                  1029 03749000
*            /********************************************************/ 03750000
*            /*                                                      */ 03751000
*            /* SET THE FPL POINTER TO THE FPL REQUESTING VOLUME     */ 03752000
*            /* INFORMATION.  INITIALIZE THE SERIAL NO. HOLD AREA    */ 03753000
*            /* TO HEX FF'S SINCE THIS VALUE DETERMINES THE LISTING  */ 03754000
*            /* OF UNIQUE VOLUME DATA.  THEN LIST THE VOLUME HEADER  */ 03755000
*            /* USING THE APPROPRIATE PRE-FORMATTED STATIC TEXT      */ 03756000
*            /* DESCRIPTOR.                                          */ 03757000
*            /*                                                      */ 03758000
*            /********************************************************/ 03759000
*                                                                  1029 03760000
*            DO;                                                   1029 03761000
*              CTGFLPTR = AUVOLFPT;                                1030 03762000
         L     @04,AUVOLFPT                                        1030 03763000
         ST    @04,CTGFLPTR                                        1030 03764000
*              OLDVOL# = HEXFF;                                    1031 03765000
         MVC   OLDVOL#(6),HEXFF                                    1031 03766000
*              DARGSENT = LCST34;                                  1032 03767000
         L     @04,DARGPTR                                         1032 03768000
         MVI   DARGSENT(@04),X'22'                                 1032 03769000
*              CALL LISTPROC;                                      1033 03770000
*                                                                  1033 03771000
         BAL   @14,LISTPROC                                        1033 03772000
*              /******************************************************/ 03773000
*              /*                                                    */ 03774000
*              /* LIST THE CATALOG DATA, LOOPING THROUGH THE         */ 03775000
*              /* REPETITIVE FIELDS.  ONE PASS IS DETERMINED BY THE  */ 03776000
*              /* THE TOTAL LENGTH OF THE INDIVIDUAL FIXED LENGTH    */ 03777000
*              /* FIELDS RETRIEVED BY THIS FPL REQUEST.              */ 03778000
*              /*                                                    */ 03779000
*              /******************************************************/ 03780000
*                                                                  1034 03781000
*              DO WHILE CTGFLNG(1) >= LENGTH(AUDATA);              1034 03782000
         B     @DE01034                                            1034 03783000
@DL01034 DS    0H                                                  1035 03784000
*                IF AUSER ^= OLDVOL#                               1035 03785000
*                  THEN                                            1035 03786000
*                                                                  1035 03787000
         L     @04,CTGFLPTR                                        1035 03788000
         L     @04,CTGFLPT(,@04)                                   1035 03789000
         CLC   AUSER(6,@04),OLDVOL#                                1035 03790000
         BE    @RF01035                                            1035 03791000
*                      /**********************************************/ 03792000
*                      /*                                            */ 03793000
*                      /* LIST EACH UNIQUE VOLUME SERIAL NUMBER AND  */ 03794000
*                      /* ITS CORRESPONDING DEVICE TYPE              */ 03795000
*                      /*                                            */ 03796000
*                      /**********************************************/ 03797000
*                                                                  1036 03798000
*                      DO;                                         1036 03799000
*                        OLDVOL# = AUSER;                          1037 03800000
         MVC   OLDVOL#(6),AUSER(@04)                               1037 03801000
*                        DARGSENT = LCST12;                /*@ZA05939*/ 03802000
         L     @15,DARGPTR                                         1038 03803000
         MVI   DARGSENT(@15),X'0C'                                 1038 03804000
*                        DARGCNT = DRGCNT2;                /*@Y30SSMK*/ 03805000
         MVC   DARGCNT(2,@15),@CH00161                             1039 03806000
*                        DARGINS(1) = DRGINS10;            /*@Y30SSMK*/ 03807000
         MVC   DARGINS(2,@15),@CH00457                             1040 03808000
*                        DARGINL(1) = LENGTH(AUSER);               1041 03809000
         MVC   DARGINL(2,@15),@CH00164                             1041 03810000
*                        DARGDTM(1) = ADDR(AUSER);                 1042 03811000
         LA    @14,AUSER(,@04)                                     1042 03812000
         ST    @14,DARGDTM(,@15)                                   1042 03813000
*                        DARGINS(2) = DRGINS20;            /*@Y30SSMK*/ 03814000
         MVC   DARGINS+8(2,@15),@CH00649                           1043 03815000
*                        DARGINL(2) = LENGTH(AUDEV);               1044 03816000
         MVC   DARGINL+8(2,@15),@CH00050                           1044 03817000
*                        DARGDTM(2) = ADDR(AUDEV);                 1045 03818000
         LA    @04,AUDEV(,@04)                                     1045 03819000
         ST    @04,DARGDTM+8(,@15)                                 1045 03820000
*                        CALL LISTPROC;                            1046 03821000
         BAL   @14,LISTPROC                                        1046 03822000
*                      END;                                        1047 03823000
*                                                                  1047 03824000
*                /****************************************************/ 03825000
*                /*                                                  */ 03826000
*                /* UPDATE THE FPL POINTER TO THE NEXT OCCURRENCE AND*/ 03827000
*                /* ACCORDINGLY DECREMENT THE TOTAL LENGTH BY THAT   */ 03828000
*                /* JUST PROCESSED.                                  */ 03829000
*                /*                                                  */ 03830000
*                /****************************************************/ 03831000
*                                                                  1048 03832000
*                CTGFLNG(1) = CTGFLNG(1) - LENGTH(AUDATA);         1048 03833000
@RF01035 L     @04,CTGFLPTR                                        1048 03834000
         LA    @15,15                                              1048 03835000
         L     @14,CTGFLNG(,@04)                                   1048 03836000
         SLR   @14,@15                                             1048 03837000
         ST    @14,CTGFLNG(,@04)                                   1048 03838000
*                CTGFLPT(1) = CTGFLPT(1) + LENGTH(AUDATA);         1049 03839000
         AL    @15,CTGFLPT(,@04)                                   1049 03840000
         ST    @15,CTGFLPT(,@04)                                   1049 03841000
*              END;                                                1050 03842000
*                                                                  1050 03843000
@DE01034 L     @04,CTGFLPTR                                        1050 03844000
         L     @04,CTGFLNG(,@04)                                   1050 03845000
         C     @04,@CF00235                                        1050 03846000
         BNL   @DL01034                                            1050 03847000
*              /******************************************************/ 03848000
*              /*                                                    */ 03849000
*              /* EXIT WHEN THE PROCESSING OF ENTRY FIELDS FOR A     */ 03850000
*              /* VOLUME SUBSET REQUEST IS COMPLETED.                */ 03851000
*              /*                                                    */ 03852000
*              /******************************************************/ 03853000
*                                                                  1051 03854000
*              RETURN CODE (0);                                    1051 03855000
         SLR   @15,@15                                             1051 03856000
         L     @13,4(,@13)                                         1051 03857000
         L     @14,12(,@13)                                        1051 03858000
         LM    @00,@12,20(@13)                                     1051 03859000
         BR    @14                                                 1051 03860000
*            END;                                                  1052 03861000
*        /************************************************************/ 03862000
*        /*                                                          */ 03863000
*        /* WHEN ALL ENTRY DATA IS REQUESTED, PROCEED TO PROCESS THE */ 03864000
*        /* CATALOG PASSWORD FIELDS FOR EITHER THE CLUSTER   @X04SVMK*/ 03865000
*        /* OR AIX OR DATA OR INDEX OR PATH ENTRY.           @X04SVMK*/ 03866000
*        /*                                                          */ 03867000
*        /************************************************************/ 03868000
*                                                                  1053 03869000
*        IF ADDR(FALL) > NULLPTR                                   1053 03870000
*          THEN                                                    1053 03871000
*                                                                  1053 03872000
@RF01028 L     @04,@PC00001+4                                      1053 03873000
         L     @04,FDTPTR+56(,@04)                                 1053 03874000
         LTR   @04,@04                                             1053 03875000
         BNP   @RF01053                                            1053 03876000
*            /********************************************************/ 03877000
*            /*                                                      */ 03878000
*            /* BUILD THE DARGLIST TO PRINT THE SECURITY STATUS--    */ 03879000
*            /*   THIS IS OUTPUT IN 2 PARTS, PASSWORD PROTECTION     */ 03880000
*            /*   INFORMATION AND THE RACF INDICATOR.  THE RACF      */ 03881000
*            /*   INDICATOR CAN ALWAYS BE RETRIEVED AND OUTPUT.      */ 03882000
*            /*                                                      */ 03883000
*            /*    PASSWORD PROTECTION STATUS WILL BE ONE OF THE     */ 03884000
*            /*      FOLLOWING.                                      */ 03885000
*            /*   1) NULL IF SECURITY WAS NEVER INITIALIZED          */ 03886000
*            /*           (POINTER AND LENGTH BOTH ZERO), OR         */ 03887000
*            /*           IF SECURITY WAS NULLIFIED VIA AN ALTER     */ 03888000
*            /*           (MASTER PSWD PADDED WITH HEX FF'S).        */ 03889000
*            /*   2) SUPPRESSED WHEN THE FPL POINTER IS ZERO BUT     */ 03890000
*            /*           THE LENGTH IS NOT.                         */ 03891000
*            /*   3) EXISTS IF THE FPL PTR AND LENGTH ARE NOT ZERO   */ 03892000
*            /*           AND THE MASTER PASSWORD IS NOT HEX FF'S.   */ 03893000
*            /*                                                      */ 03894000
*            /********************************************************/ 03895000
*                                                                  1054 03896000
*ALLONLY:    DO;                                           /*@Y30LSMK*/ 03897000
ALLONLY  DS    0H                                                  1055 03898000
*              CTGFLPTR = RACFPT;     /*  SECFLAGS           @Z40RSSA*/ 03899000
         L     @04,RACFPT                                          1055 03900000
         ST    @04,CTGFLPTR                                        1055 03901000
*              DARGCNT = DRGCNT1;                          /*@Z40RSSA*/ 03902000
         L     @15,DARGPTR                                         1056 03903000
         MVC   DARGCNT(2,@15),@CH00045                             1056 03904000
*              DARGINS(1) = DRGINS10;                      /*@Z40RSSA*/ 03905000
         LA    @14,10                                              1057 03906000
         STH   @14,DARGINS(,@15)                                   1057 03907000
*              DARGINL(1) = ABBREVLN;                      /*@Z40RSRC*/ 03908000
         STH   @14,DARGINL(,@15)                                   1058 03909000
*              IF RACIND = ON THEN                         /*@Z40RSSA*/ 03910000
         L     @04,CTGFLPT(,@04)                                   1059 03911000
         TM    RACIND(@04),B'10000000'                             1059 03912000
         BNO   @RF01059                                            1059 03913000
*                DARGDTM(1) = ADDR(YESNM);    /* RACF INDICATOR ON   */ 03914000
         L     @04,TEXTPTR                                         1060 03915000
         LA    @04,YESNM(,@04)                                     1060 03916000
         ST    @04,DARGDTM(,@15)                                   1060 03917000
*              ELSE                                        /*@Z40RSSA*/ 03918000
*                DARGDTM(1) = ADDR(NONM);     /* RACF INDICATOR ON   */ 03919000
         B     @RC01059                                            1061 03920000
@RF01059 L     @04,TEXTPTR                                         1061 03921000
         LA    @04,NONM(,@04)                                      1061 03922000
         L     @15,DARGPTR                                         1061 03923000
         ST    @04,DARGDTM(,@15)                                   1061 03924000
*              CTGFLPTR = SECURFPT;                                1062 03925000
@RC01059 L     @04,SECURFPT                                        1062 03926000
         ST    @04,CTGFLPTR                                        1062 03927000
*              IF CTGFLPT(1) = 0  |  MPW = HEXFF                   1063 03928000
*                THEN        /* NO PASSWORD DATA                     */ 03929000
         L     @04,CTGFLPT(,@04)                                   1063 03930000
         LTR   @04,@04                                             1063 03931000
         BZ    @RT01063                                            1063 03932000
         CLC   MPW(8,@04),HEXFF                                    1063 03933000
         BNE   @RF01063                                            1063 03934000
@RT01063 DS    0H                                                  1064 03935000
*                  DO;                                             1064 03936000
*                    DARGSENT = LCST14;                    /*@ZA05939*/ 03937000
         L     @04,DARGPTR                                         1065 03938000
         MVI   DARGSENT(@04),X'0E'                                 1065 03939000
*                    DARGCNT = DRGCNT2;                    /*@Z40RSSA*/ 03940000
         MVC   DARGCNT(2,@04),@CH00161                             1066 03941000
*                    DARGINS(2) = DRGINS20;                /*@Z40RSSA*/ 03942000
         MVC   DARGINS+8(2,@04),@CH00649                           1067 03943000
*                    DARGINL(2) = ABBREVLN;                /*@Z40RSSA*/ 03944000
         MVC   DARGINL+8(2,@04),@CH00457                           1068 03945000
*                    IF CTGFLNG(1) > 0  &  CTGFLPT(1) = 0          1069 03946000
*                      THEN           /*SECURITY DATA WAS SUPPRESSED */ 03947000
         SLR   @15,@15                                             1069 03948000
         L     @14,CTGFLPTR                                        1069 03949000
         C     @15,CTGFLNG(,@14)                                   1069 03950000
         BNL   @RF01069                                            1069 03951000
         C     @15,CTGFLPT(,@14)                                   1069 03952000
         BNE   @RF01069                                            1069 03953000
*                        DARGDTM(2) = ADDR(SUPPNM);        /*@Z40RSSA*/ 03954000
         L     @15,TEXTPTR                                         1070 03955000
         LA    @00,SUPPNM(,@15)                                    1070 03956000
         ST    @00,DARGDTM+8(,@04)                                 1070 03957000
*                      ELSE           /*SECURITY NOT INITIALIZED     */ 03958000
*                        DARGDTM(2) = ADDR(NULLNM);        /*@Z40RSSA*/ 03959000
*                                                                  1071 03960000
         B     @RC01069                                            1071 03961000
@RF01069 L     @04,TEXTPTR                                         1071 03962000
         LA    @04,NULLNM(,@04)                                    1071 03963000
         L     @15,DARGPTR                                         1071 03964000
         ST    @04,DARGDTM+8(,@15)                                 1071 03965000
*                    CALL LISTPROC;                        /*@ZA05939*/ 03966000
@RC01069 BAL   @14,LISTPROC                                        1072 03967000
*                    END;                                          1073 03968000
*              /******************************************************/ 03969000
*              /*                                                    */ 03970000
*              /* IF SECURITY DATA EXISTS AND HAS NOT BEEN NULLIFIED */ 03971000
*              /* BUILD THE DARGLIST TO PRINT IT.                    */ 03972000
*              /* TO INSURE PRINTABILITY OVERRIDE ANY NON-INITIALIZED*/ 03973000
*              /* ARITHMETIC FIELDS WITH ZEROES AND ANY NON-INIT     */ 03974000
*              /* CHARACTER FIELDS WITH THE 'NULL' STATIC TEXT ENTRY.*/ 03975000
*              /*                                                    */ 03976000
*              /******************************************************/ 03977000
*                                                                  1074 03978000
*                ELSE                                              1074 03979000
*                  DO;                                             1074 03980000
         B     @RC01063                                            1074 03981000
@RF01063 DS    0H                                                  1075 03982000
*                    DARGSENT = LCST15;                            1075 03983000
         L     @04,DARGPTR                                         1075 03984000
         MVI   DARGSENT(@04),X'0F'                                 1075 03985000
*                    DARGDBP = CTGFLPT(1);                         1076 03986000
         L     @15,CTGFLPTR                                        1076 03987000
         L     @14,CTGFLPT(,@15)                                   1076 03988000
         ST    @14,DARGDBP(,@04)                                   1076 03989000
*                    DARGILP = CTGFLNG(1);                         1077 03990000
         L     @15,CTGFLNG(,@15)                                   1077 03991000
         STH   @15,DARGILP(,@04)                                   1077 03992000
*                    IF ATMP = ARITH4FF                            1078 03993000
*                      THEN                                        1078 03994000
         CLC   ATMP(2,@14),ARITH4FF                                1078 03995000
         BNE   @RF01078                                            1078 03996000
*                        ATMP = ZEROAREA;                          1079 03997000
         MVC   ATMP(2,@14),ZEROAREA                                1079 03998000
*                    IF MPW = HEXFF                                1080 03999000
*                      THEN                                        1080 04000000
@RF01078 L     @04,CTGFLPTR                                        1080 04001000
         L     @04,CTGFLPT(,@04)                                   1080 04002000
         CLC   MPW(8,@04),HEXFF                                    1080 04003000
         BNE   @RF01080                                            1080 04004000
*                        MPW = NULLNM;                             1081 04005000
         L     @15,TEXTPTR                                         1081 04006000
         MVC   MPW(8,@04),NULLNM(@15)                              1081 04007000
*                    IF CPW = HEXFF                                1082 04008000
*                      THEN                                        1082 04009000
@RF01080 L     @04,CTGFLPTR                                        1082 04010000
         L     @04,CTGFLPT(,@04)                                   1082 04011000
         CLC   CPW(8,@04),HEXFF                                    1082 04012000
         BNE   @RF01082                                            1082 04013000
*                        CPW = NULLNM;                             1083 04014000
         L     @15,TEXTPTR                                         1083 04015000
         MVC   CPW(8,@04),NULLNM(@15)                              1083 04016000
*                    IF UPW = HEXFF                                1084 04017000
*                      THEN                                        1084 04018000
@RF01082 L     @04,CTGFLPTR                                        1084 04019000
         L     @04,CTGFLPT(,@04)                                   1084 04020000
         CLC   UPW(8,@04),HEXFF                                    1084 04021000
         BNE   @RF01084                                            1084 04022000
*                        UPW = NULLNM;                             1085 04023000
         L     @15,TEXTPTR                                         1085 04024000
         MVC   UPW(8,@04),NULLNM(@15)                              1085 04025000
*                    IF RPW = HEXFF                                1086 04026000
*                      THEN                                        1086 04027000
@RF01084 L     @04,CTGFLPTR                                        1086 04028000
         L     @04,CTGFLPT(,@04)                                   1086 04029000
         CLC   RPW(8,@04),HEXFF                                    1086 04030000
         BNE   @RF01086                                            1086 04031000
*                        RPW = NULLNM;                             1087 04032000
         L     @15,TEXTPTR                                         1087 04033000
         MVC   RPW(8,@04),NULLNM(@15)                              1087 04034000
*                    IF PRMT = HEXFF                               1088 04035000
*                      THEN                                        1088 04036000
@RF01086 L     @04,CTGFLPTR                                        1088 04037000
         L     @04,CTGFLPT(,@04)                                   1088 04038000
         CLC   PRMT(8,@04),HEXFF                                   1088 04039000
         BNE   @RF01088                                            1088 04040000
*                        PRMT = NULLNM;                            1089 04041000
         L     @15,TEXTPTR                                         1089 04042000
         MVC   PRMT(8,@04),NULLNM(@15)                             1089 04043000
*                    IF SMOD = HEXFF                               1090 04044000
*                      THEN                                        1090 04045000
@RF01088 L     @04,CTGFLPTR                                        1090 04046000
         L     @04,CTGFLPT(,@04)                                   1090 04047000
         CLC   SMOD(8,@04),HEXFF                                   1090 04048000
         BNE   @RF01090                                            1090 04049000
*                        SMOD = NULLNM;                            1091 04050000
         L     @15,TEXTPTR                                         1091 04051000
         MVC   SMOD(8,@04),NULLNM(@15)                             1091 04052000
*                    CALL LISTPROC;                                1092 04053000
@RF01090 BAL   @14,LISTPROC                                        1092 04054000
*                    /************************************************/ 04055000
*                    /*                                              */ 04056000
*                    /* IF A USER-SECURITY-AUTHORIZATION-RECORD      */ 04057000
*                    /* EXISTS, BUILD THE DARGLIST TO PRINT IT.      */ 04058000
*                    /*                                              */ 04059000
*                    /************************************************/ 04060000
*                                                                  1093 04061000
*                    DARGSENT = LCST16;                            1093 04062000
         L     @04,DARGPTR                                         1093 04063000
         MVI   DARGSENT(@04),X'10'                                 1093 04064000
*                    IF SRECLEN > 0                                1094 04065000
*                      THEN                                        1094 04066000
         L     @15,CTGFLPTR                                        1094 04067000
         L     @15,CTGFLPT(,@15)                                   1094 04068000
         SLR   @14,@14                                             1094 04069000
         ICM   @14,3,SRECLEN(@15)                                  1094 04070000
         LTR   @14,@14                                             1094 04071000
         BNP   @RF01094                                            1094 04072000
*                        DO;                                       1095 04073000
*                          DARGCNT = DRGCNT1;              /*@Y30SSMK*/ 04074000
         MVC   DARGCNT(2,@04),@CH00045                             1096 04075000
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/ 04076000
         MVC   DARGINS(2,@04),@CH00457                             1097 04077000
*                          DARGDTM(1) = ADDR(SREC);                1098 04078000
         LA    @15,SREC(,@15)                                      1098 04079000
         ST    @15,DARGDTM(,@04)                                   1098 04080000
*                          DARGINL(1) = SRECLEN;                   1099 04081000
         STH   @14,DARGINL(,@04)                                   1099 04082000
*                        END;                                      1100 04083000
*                    CALL LISTPROC;                                1101 04084000
@RF01094 BAL   @14,LISTPROC                                        1101 04085000
*                  END;                                            1102 04086000
*            END ALLONLY;                                          1103 04087000
@RC01063 DS    0H                                                  1104 04088000
*        /************************************************************/ 04089000
*        /*                                                          */ 04090000
*        /* IF THE CATALOG FIELDS FOR THIS ENTRY WERE NOT SUPPRESSED */ 04091000
*        /* BECAUSE OF PASSWORD VERIFICATION FAILURE AND IF THE      */ 04092000
*        /* LISTC REQUEST IS FOR ALL CATALOG DATA OR ELSE THE TYPE   */ 04093000
*        /* BEING PROCESSED IS A CLUSTER OR AIX RETRIEVE     @X04SVMK*/ 04094000
*        /* THE LIST OF ASSOCIATED TYPES AND C.I.NOS. FROM   @X04SVMK*/ 04095000
*        /* THE WORKAREA. AND BECAUSE THE WORKAREA WILL SUBSEQUENTLY */ 04096000
*        /* BE REUSED, DESTROYING THE LIST CREATE A SAVEAREA COPY    */ 04097000
*        /* PROCESSING LATER.                                @X04SVMK*/ 04098000
*        /*                                                          */ 04099000
*        /************************************************************/ 04100000
*                                                                  1104 04101000
*                                                                  1104 04102000
*        IF (ADDR(FALL) > NULLPTR  |  HOLDETYP = CTGTCL  |         1104 04103000
*          HOLDETYP = CTGTAIX)                                     1104 04104000
*          & CATRC ^= CRCBADPW                                     1104 04105000
*          THEN                                                    1104 04106000
@RF01053 L     @04,@PC00001+4                                      1104 04107000
         L     @04,FDTPTR+56(,@04)                                 1104 04108000
         LTR   @04,@04                                             1104 04109000
         BP    @GL00038                                            1104 04110000
         CLI   HOLDETYP,C'C'                                       1104 04111000
         BE    @GL00038                                            1104 04112000
         CLI   HOLDETYP,C'G'                                       1104 04113000
         BNE   @RF01104                                            1104 04114000
@GL00038 CLC   CATRC(2),@CH01280                                   1104 04115000
         BE    @RF01104                                            1104 04116000
*ALLORNM:    DO;                                           /*@YL026UE*/ 04117000
ALLORNM  DS    0H                                                  1106 04118000
*              CALL ANSVPROC;                              /*@YL026UE*/ 04119000
*                                                                  1106 04120000
         BAL   @14,ANSVPROC                                        1106 04121000
*              RESPECIFY RTNREG RSTD;                              1107 04122000
*              TESTRC = RTNREG;                                    1108 04123000
         LR    TESTRC,RTNREG                                       1108 04124000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UE*/ 04125000
*                                                                  1109 04126000
*              /******************************************************/ 04127000
*              /*                                            @Y30SSMK*/ 04128000
*              /* RETURN WHEN ANY NON-ZERO RETURN CODE IS    @Y30SSMK*/ 04129000
*              /* ENCOUNTERED WHILE RETRIEVING THE           @Y30SSMK*/ 04130000
*              /* ASSOCIATED ENTRIES.  USE THE RETURN CODE   @Y30SSMK*/ 04131000
*              /* 'SAVRC' WHICH WAS SET IN ANSVPROC.         @ZA05939*/ 04132000
*              /*                                            @Y30SSMK*/ 04133000
*              /******************************************************/ 04134000
*                                                                  1110 04135000
*              IF TESTRC ^= 0                                      1110 04136000
*                THEN                                              1110 04137000
         LTR   TESTRC,TESTRC                                       1110 04138000
         BZ    @RF01110                                            1110 04139000
*                  RETURN CODE(SAVRC);                     /*@ZA05939*/ 04140000
         LH    @15,SAVRC                                           1111 04141000
         L     @13,4(,@13)                                         1111 04142000
         L     @14,12(,@13)                                        1111 04143000
         LM    @00,@12,20(@13)                                     1111 04144000
         BR    @14                                                 1111 04145000
*        /************************************************************/ 04146000
*        /*                                                          */ 04147000
*        /* THE LIST OF ASSOCIATIONS IS NOW RETRIEVED.  EXIT HERE    */ 04148000
*        /* UNLESS PROCESSING A LISTC REQUEST FOR ALL CATALOG DATA.  */ 04149000
*        /*                                                          */ 04150000
*        /************************************************************/ 04151000
*                                                                  1112 04152000
*        IF ADDR(FALL) = NULLPTR                                   1112 04153000
*          THEN                                                    1112 04154000
@RF01110 SLR   @04,@04                                             1112 04155000
         L     @15,@PC00001+4                                      1112 04156000
         C     @04,FDTPTR+56(,@15)                                 1112 04157000
         BNE   @RF01112                                            1112 04158000
*            DO;                                                   1113 04159000
*              RETURN CODE (0);                                    1114 04160000
         LR    @15,@04                                             1114 04161000
         L     @13,4(,@13)                                         1114 04162000
         L     @14,12(,@13)                                        1114 04163000
         LM    @00,@12,20(@13)                                     1114 04164000
         BR    @14                                                 1114 04165000
*            END;                                                  1115 04166000
*                                                                  1115 04167000
*        /************************************************************/ 04168000
*        /*                                                  @YL026UE*/ 04169000
*        /* OUTPUT THE ASSOCIATION HEADER WITH THE ASSOCIATED ENTRY  */ 04170000
*        /* TYPES AND NAMES FOR A CLUSTER, AIX, DATA, INDEX OR       */ 04171000
*        /* PATH ENTRY.                                              */ 04172000
*        /*                                                  @YL026UE*/ 04173000
*        /************************************************************/ 04174000
*                                                                  1116 04175000
*        CALL ANLTPROC;                                    /*@YL026UE*/ 04176000
*                                                                  1116 04177000
@RF01112 BAL   @14,ANLTPROC                                        1116 04178000
*        RESPECIFY RTNREG RSTD;                                    1117 04179000
*        TESTRC = RTNREG;                                          1118 04180000
         LR    TESTRC,RTNREG                                       1118 04181000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UE*/ 04182000
*                                                                  1119 04183000
*        /************************************************************/ 04184000
*        /*                                                  @Y30SSMK*/ 04185000
*        /* RETURN WHEN ANY NON-ZERO RETURN CODE IS          @Y30SSMK*/ 04186000
*        /* ENCOUNTERED WHILE PROCESSING THE ASSOCIATED      @Y30SSMK*/ 04187000
*        /* ENTRIES.  USE THE RETURN CODE 'SAVRC' WHICH WAS  @ZA05939*/ 04188000
*        /* SET IN ANLTPROC.                                 @Y30SSMK*/ 04189000
*        /*                                                  @Y30SSMK*/ 04190000
*        /************************************************************/ 04191000
*                                                                  1120 04192000
*        IF TESTRC ^= 0                                            1120 04193000
*          THEN                                                    1120 04194000
         LTR   TESTRC,TESTRC                                       1120 04195000
         BZ    @RF01120                                            1120 04196000
*            RETURN CODE(SAVRC);                           /*@ZA05939*/ 04197000
         LH    @15,SAVRC                                           1121 04198000
         L     @13,4(,@13)                                         1121 04199000
         L     @14,12(,@13)                                        1121 04200000
         LM    @00,@12,20(@13)                                     1121 04201000
         BR    @14                                                 1121 04202000
*        /************************************************************/ 04203000
*        /*                                                          */ 04204000
*        /* EXIT HERE IF A CLUSTER ENTRY IS BEING PROCESSED, FOR ALL */ 04205000
*        /* CLUSTER FIELDS HAVE BEEN LISTED.                         */ 04206000
*        /*                                                          */ 04207000
*        /************************************************************/ 04208000
*                                                                  1122 04209000
*        IF HOLDETYP = CTGTCL                                      1122 04210000
*          THEN                                                    1122 04211000
@RF01120 CLI   HOLDETYP,C'C'                                       1122 04212000
         BNE   @RF01122                                            1122 04213000
*            DO;                                                   1123 04214000
*              RETURN CODE(0);                                     1124 04215000
         SLR   @15,@15                                             1124 04216000
         L     @13,4(,@13)                                         1124 04217000
         L     @14,12(,@13)                                        1124 04218000
         LM    @00,@12,20(@13)                                     1124 04219000
         BR    @14                                                 1124 04220000
*            END;                                                  1125 04221000
*        /************************************************************/ 04222000
*        /*                                                  @Y30SSMK*/ 04223000
*        /* BUILD THE DARGLIST TO PRINT THE AIX AND PATH     @Y30SSMK*/ 04224000
*        /* ATTRIBUTES.                                      @Y30SSMK*/ 04225000
*        /*                                                  @Y30SSMK*/ 04226000
*        /************************************************************/ 04227000
*                                                                  1126 04228000
*        IF HOLDETYP = CTGTAIX  |  HOLDETYP = CTGTPTH              1126 04229000
*          THEN                                                    1126 04230000
@RF01122 CLI   HOLDETYP,C'G'                                       1126 04231000
         BE    @RT01126                                            1126 04232000
         CLI   HOLDETYP,C'R'                                       1126 04233000
         BNE   @RF01126                                            1126 04234000
@RT01126 DS    0H                                                  1127 04235000
*            DO;                                           /*@Y30SSMK*/ 04236000
*              CTGFLPTR = RGATRFPT;                        /*@Y30SSMK*/ 04237000
         L     @04,RGATRFPT                                        1128 04238000
         ST    @04,CTGFLPTR                                        1128 04239000
*              DARGSENT = LCST51;                          /*@Y30SSMK*/ 04240000
         L     @15,DARGPTR                                         1129 04241000
         MVI   DARGSENT(@15),X'33'                                 1129 04242000
*              DARGCNT = DRGCNT1;                          /*@Y30SSMK*/ 04243000
         MVC   DARGCNT(2,@15),@CH00045                             1130 04244000
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/ 04245000
         LA    @14,10                                              1131 04246000
         STH   @14,DARGINS(,@15)                                   1131 04247000
*              DARGINL(1) = ABBREVLN;                      /*@Y30SSMK*/ 04248000
         STH   @14,DARGINL(,@15)                                   1132 04249000
*              IF HOLDETYP = CTGTAIX                               1133 04250000
*                THEN                                              1133 04251000
*                                                                  1133 04252000
         CLI   HOLDETYP,C'G'                                       1133 04253000
         BNE   @RF01133                                            1133 04254000
*                  /**************************************************/ 04255000
*                  /*                                        @Y30SSMK*/ 04256000
*                  /* CHECK FOR UPGRADE/NOUPGRADE            @Y30SSMK*/ 04257000
*                  /* ATTRIBUTES FOR AN AIX ENTRY.           @Y30SSMK*/ 04258000
*                  /*                                        @Y30SSMK*/ 04259000
*                  /**************************************************/ 04260000
*                                                                  1134 04261000
*                  IF RGUPG = ON                                   1134 04262000
*                    THEN                                          1134 04263000
         L     @04,CTGFLPT(,@04)                                   1134 04264000
         TM    RGUPG(@04),B'10000000'                              1134 04265000
         BNO   @RF01134                                            1134 04266000
*                      DARGDTM(1) = ADDR(UPGNM);           /*@Y30SSMK*/ 04267000
         L     @04,TEXTPTR                                         1135 04268000
         LA    @04,UPGNM(,@04)                                     1135 04269000
         ST    @04,DARGDTM(,@15)                                   1135 04270000
*                    ELSE                                          1136 04271000
*                      DARGDTM(1) = ADDR(NUPGNM);          /*@Y30SSMK*/ 04272000
         B     @RC01134                                            1136 04273000
@RF01134 L     @04,TEXTPTR                                         1136 04274000
         LA    @04,NUPGNM(,@04)                                    1136 04275000
         L     @15,DARGPTR                                         1136 04276000
         ST    @04,DARGDTM(,@15)                                   1136 04277000
*                ELSE                                              1137 04278000
*                                                                  1137 04279000
*                  /**************************************************/ 04280000
*                  /*                                        @Y30SSMK*/ 04281000
*                  /* CHECK FOR UPDATE/NOUPDATE              @Y30SSMK*/ 04282000
*                  /* ATTRIBUTES FOR AN PATH ENTRY.          @Y30SSMK*/ 04283000
*                  /*                                        @Y30SSMK*/ 04284000
*                  /**************************************************/ 04285000
*                                                                  1137 04286000
*                  IF RGUPD = ON                                   1137 04287000
*                    THEN                                          1137 04288000
         B     @RC01133                                            1137 04289000
@RF01133 L     @04,CTGFLPTR                                        1137 04290000
         L     @04,CTGFLPT(,@04)                                   1137 04291000
         TM    RGUPD(@04),B'10000000'                              1137 04292000
         BNO   @RF01137                                            1137 04293000
*                      DARGDTM(1) = ADDR(UPDNM);           /*@Y30SSMK*/ 04294000
         L     @04,TEXTPTR                                         1138 04295000
         LA    @04,UPDNM(,@04)                                     1138 04296000
         L     @15,DARGPTR                                         1138 04297000
         ST    @04,DARGDTM(,@15)                                   1138 04298000
*                    ELSE                                          1139 04299000
*                      DARGDTM(1) = ADDR(NUPDNM);          /*@Y30SSMK*/ 04300000
         B     @RC01137                                            1139 04301000
@RF01137 L     @04,TEXTPTR                                         1139 04302000
         LA    @04,NUPDNM(,@04)                                    1139 04303000
         L     @15,DARGPTR                                         1139 04304000
         ST    @04,DARGDTM(,@15)                                   1139 04305000
*              CALL LISTPROC;                              /*@Y30SSMK*/ 04306000
*                                                                  1140 04307000
@RC01137 DS    0H                                                  1140 04308000
@RC01133 BAL   @14,LISTPROC                                        1140 04309000
*              /******************************************************/ 04310000
*              /*                                            @Y30SSMK*/ 04311000
*              /* EXIT HERE SINCE ALL THE AIX OR PATH FIELDS @Y30SSMK*/ 04312000
*              /* HAVE BEEN LISTED.                          @Y30SSMK*/ 04313000
*              /*                                            @Y30SSMK*/ 04314000
*              /******************************************************/ 04315000
*                                                                  1141 04316000
*              RETURN CODE(0);                             /*@Y30SSMK*/ 04317000
         SLR   @15,@15                                             1141 04318000
         L     @13,4(,@13)                                         1141 04319000
         L     @14,12(,@13)                                        1141 04320000
         LM    @00,@12,20(@13)                                     1141 04321000
         BR    @14                                                 1141 04322000
*            END;                                          /*@Y30SSMK*/ 04323000
*        /************************************************************/ 04324000
*        /*                                                          */ 04325000
*        /* PRINT THE DATASET SIZE ATTRIBUTES FOR A DATA OR INDEX    */ 04326000
*        /* ENTRY.  INITIALIZE THE POINTER TO THE CONTROL BLOCK,     */ 04327000
*        /* CATALOG AMDSB, CONTAINING SOME OF THE ATTRIBUTES.        */ 04328000
*        /* DETERMINE IF THE FPL REQUESTING THIS CONTROL BLOCK HAS   */ 04329000
*        /* A VALID WORKAREA POINTER.                                */ 04330000
*        /*                                                          */ 04331000
*        /************************************************************/ 04332000
*                                                                  1143 04333000
*        DARGSENT = LCST20;                                        1143 04334000
@RF01126 L     @04,DARGPTR                                         1143 04335000
         MVI   DARGSENT(@04),X'14'                                 1143 04336000
*        RESPECIFY IDAAMDSB BASED(DSBCATPT);                       1144 04337000
*        IF DSBFPT->CTGFLPT(1) > NULLPTR                           1145 04338000
*          THEN                                                    1145 04339000
         L     @04,DSBFPT                                          1145 04340000
         L     @04,CTGFLPT(,@04)                                   1145 04341000
         LTR   @04,@04                                             1145 04342000
         BNP   @RF01145                                            1145 04343000
*            DSBCATPT = DSBFPT->CTGFLPT(1);                        1146 04344000
         ST    @04,DSBCATPT                                        1146 04345000
*          ELSE                                                    1147 04346000
*            DSBCATPT = NULLPTR;                                   1147 04347000
*                                                                  1147 04348000
         B     @RC01145                                            1147 04349000
@RF01145 SLR   @04,@04                                             1147 04350000
         ST    @04,DSBCATPT                                        1147 04351000
*        /************************************************************/ 04352000
*        /*                                                          */ 04353000
*        /* IF THE CATALOG AMDSB CONTROL BLOCK WAS RETURNED FROM     */ 04354000
*        /* THE CATALOG, LIST THE DATASET SIZE ATTRIBUTES FROM IT.   */ 04355000
*        /*                                                          */ 04356000
*        /************************************************************/ 04357000
*                                                                  1148 04358000
*        IF DSBCATPT > NULLPTR                                     1148 04359000
*          THEN                                                    1148 04360000
@RC01145 L     @04,DSBCATPT                                        1148 04361000
         SLR   @15,@15                                             1148 04362000
         CR    @04,@15                                             1148 04363000
         BNH   @RF01148                                            1148 04364000
*            DO;                                                   1149 04365000
*            DARGSENT = LCST20;                                    1150 04366000
         L     @14,DARGPTR                                         1150 04367000
         MVI   DARGSENT(@14),X'14'                                 1150 04368000
*            CTGFLPTR = DSBFPT;                                    1151 04369000
         L     @00,DSBFPT                                          1151 04370000
         ST    @00,CTGFLPTR                                        1151 04371000
*            DARGDBP = CTGFLPT(1);                                 1152 04372000
         LR    @07,@00                                             1152 04373000
         L     @07,CTGFLPT(,@07)                                   1152 04374000
         ST    @07,DARGDBP(,@14)                                   1152 04375000
*            DARGILP = CTGFLNG(1);                                 1153 04376000
         LR    @07,@00                                             1153 04377000
         L     @00,CTGFLNG(,@07)                                   1153 04378000
         STH   @00,DARGILP(,@14)                                   1153 04379000
*            IF AMDRKP = ARITH4FF      /* RKP                        */ 04380000
*              THEN                                                1154 04381000
         LH    @14,AMDRKP(,@04)                                    1154 04382000
         CL    @14,ARITH4FF                                        1154 04383000
         BNE   @RF01154                                            1154 04384000
*                AMDRKP = 0;                                       1155 04385000
         STH   @15,AMDRKP(,@04)                                    1155 04386000
*            IF AMDKEYLN = ARITH4FF    /* KEY LENGTH                 */ 04387000
*              THEN                                                1156 04388000
@RF01154 L     @04,DSBCATPT                                        1156 04389000
         LH    @00,AMDKEYLN(,@04)                                  1156 04390000
         CL    @00,ARITH4FF                                        1156 04391000
         BNE   @RF01156                                            1156 04392000
*                AMDKEYLN = 0;                                     1157 04393000
         SLR   @00,@00                                             1157 04394000
         STH   @00,AMDKEYLN(,@04)                                  1157 04395000
*            IF AMDLRECL = ARITH4FF    /* MAX RECORD SIZE            */ 04396000
*              THEN                                                1158 04397000
@RF01156 L     @04,DSBCATPT                                        1158 04398000
         CLC   AMDLRECL(4,@04),ARITH4FF                            1158 04399000
         BNE   @RF01158                                            1158 04400000
*                AMDLRECL = 0;                                     1159 04401000
         SLR   @00,@00                                             1159 04402000
         ST    @00,AMDLRECL(,@04)                                  1159 04403000
*            IF AMDCINV = ARITH4FF     /* C.I. SIZE                  */ 04404000
*              THEN                                                1160 04405000
@RF01158 L     @04,DSBCATPT                                        1160 04406000
         CLC   AMDCINV(4,@04),ARITH4FF                             1160 04407000
         BNE   @RF01160                                            1160 04408000
*                AMDCINV = 0;                                      1161 04409000
         SLR   @00,@00                                             1161 04410000
         ST    @00,AMDCINV(,@04)                                   1161 04411000
*            IF AMDCIPCA = ARITH4FF    /* C.I.'S PER C.A.            */ 04412000
*              THEN                                                1162 04413000
@RF01160 L     @04,DSBCATPT                                        1162 04414000
         LH    @00,AMDCIPCA(,@04)                                  1162 04415000
         CL    @00,ARITH4FF                                        1162 04416000
         BNE   @RF01162                                            1162 04417000
*                AMDCIPCA = 0;                                     1163 04418000
         SLR   @00,@00                                             1163 04419000
         STH   @00,AMDCIPCA(,@04)                                  1163 04420000
*            END;                                                  1164 04421000
@RF01162 DS    0H                                                  1165 04422000
*        DARGCNT = DRGCNT3;                                /*@Y30SSMK*/ 04423000
*                                                                  1165 04424000
@RF01148 L     @04,DARGPTR                                         1165 04425000
         MVC   DARGCNT(2,@04),@CH00170                             1165 04426000
*        /************************************************************/ 04427000
*        /*                                                          */ 04428000
*        /* INCLUDE IN THE DARGLIST THOSE DATASET SIZE ATTRIBUTES    */ 04429000
*        /* RETURNED IN THE WORKAREA AS INDIVIDUAL FIELDS.           */ 04430000
*        /*                                                          */ 04431000
*        /************************************************************/ 04432000
*                                                                  1166 04433000
*        CTGFLPTR = RECLFPT;                                       1166 04434000
         L     @00,RECLFPT                                         1166 04435000
         ST    @00,CTGFLPTR                                        1166 04436000
*        DARGINS(1) = DRGINS10;                            /*@Y30SSMK*/ 04437000
         MVC   DARGINS(2,@04),@CH00457                             1167 04438000
*        DARGINL(1) = CTGFLNG(1);                                  1168 04439000
         LR    @15,@00                                             1168 04440000
         L     @15,CTGFLNG(,@15)                                   1168 04441000
         STH   @15,DARGINL(,@04)                                   1168 04442000
*        DARGDTM(1) = CTGFLPT(1);                                  1169 04443000
         LR    @15,@00                                             1169 04444000
         L     @15,CTGFLPT(,@15)                                   1169 04445000
         ST    @15,DARGDTM(,@04)                                   1169 04446000
*        IF RECL = ARITH4FF            /*AVERAGE LOGICAL REC SIZE    */ 04447000
*          THEN                                                    1170 04448000
         CLC   RECL(4,@15),ARITH4FF                                1170 04449000
         BNE   @RF01170                                            1170 04450000
*            RECL = ZEROAREA;                                      1171 04451000
         MVC   RECL(4,@15),ZEROAREA                                1171 04452000
*        CTGFLPTR = BUFFFPT;                                       1172 04453000
@RF01170 L     @04,BUFFFPT                                         1172 04454000
         ST    @04,CTGFLPTR                                        1172 04455000
*        DARGINS(2) = DRGINS20;                            /*@Y30SSMK*/ 04456000
         L     @15,DARGPTR                                         1173 04457000
         MVC   DARGINS+8(2,@15),@CH00649                           1173 04458000
*        DARGINL(2) = CTGFLNG(1);                                  1174 04459000
         L     @14,CTGFLNG(,@04)                                   1174 04460000
         STH   @14,DARGINL+8(,@15)                                 1174 04461000
*        DARGDTM(2) = CTGFLPT(1);                                  1175 04462000
         L     @04,CTGFLPT(,@04)                                   1175 04463000
         ST    @04,DARGDTM+8(,@15)                                 1175 04464000
*        IF BUFF = ARITH4FF            /*MINIMUM BUFFER              */ 04465000
*          THEN                                                    1176 04466000
         CLC   BUFF(4,@04),ARITH4FF                                1176 04467000
         BNE   @RF01176                                            1176 04468000
*            BUFF = ZEROAREA;                                      1177 04469000
         MVC   BUFF(4,@04),ZEROAREA                                1177 04470000
*        CTGFLPTR = EXITFPT;                               /*@Y30SSMK*/ 04471000
@RF01176 L     @04,EXITFPT                                         1178 04472000
         ST    @04,CTGFLPTR                                        1178 04473000
*        DARGINS(3) = DRGINS30;                            /*@Y30SSMK*/ 04474000
         L     @15,DARGPTR                                         1179 04475000
         MVC   DARGINS+16(2,@15),@CH01231                          1179 04476000
*        DARGINL(3) = CTGFLNG(1);                          /*@Y30SSMK*/ 04477000
         L     @14,CTGFLNG(,@04)                                   1180 04478000
         STH   @14,DARGINL+16(,@15)                                1180 04479000
*        DARGDTM(3) = CTGFLPT(1);                          /*@Y30SSMK*/ 04480000
         L     @04,CTGFLPT(,@04)                                   1181 04481000
         ST    @04,DARGDTM+16(,@15)                                1181 04482000
*        IF EXIT = HEXFF               /*EXECPTION EXIT NAME @Y30SSMK*/ 04483000
*          THEN                                                    1182 04484000
         CLC   EXIT(8,@04),HEXFF                                   1182 04485000
         BNE   @RF01182                                            1182 04486000
*            EXIT = NULLNM;                                /*@Y30SSMK*/ 04487000
         L     @15,TEXTPTR                                         1183 04488000
         MVC   EXIT(8,@04),NULLNM(@15)                             1183 04489000
*        CALL LISTPROC;                                            1184 04490000
*                                                                  1184 04491000
@RF01182 BAL   @14,LISTPROC                                        1184 04492000
*        IF DSBCATPT > NULLPTR                                     1185 04493000
*          THEN                                                    1185 04494000
*                                                                  1185 04495000
         L     @04,DSBCATPT                                        1185 04496000
         SLR   @15,@15                                             1185 04497000
         CR    @04,@15                                             1185 04498000
         BNH   @RF01185                                            1185 04499000
*            /********************************************************/ 04500000
*            /*                                              @ZA05939*/ 04501000
*            /* FOR THE DATA ENTRY OF AN AIX, BUILD THE      @ZA05939*/ 04502000
*            /* DARGLIST TO PRINT THE AXRKP DATA INFO.       @ZA05939*/ 04503000
*            /*                                              @ZA05939*/ 04504000
*            /********************************************************/ 04505000
*                                                                  1186 04506000
*            IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA  &  GASSOCSW = ON  04507000
*              THEN                                                1186 04508000
         L     @14,ETYPFPT                                         1186 04509000
         L     @14,CTGFLPT(,@14)                                   1186 04510000
         CLI   ETYP(@14),C'D'                                      1186 04511000
         BNE   @RF01186                                            1186 04512000
         TM    GASSOCSW,B'10000000'                                1186 04513000
         BNO   @RF01186                                            1186 04514000
*                DO;                                       /*@ZA05939*/ 04515000
*                  CTGFLPTR = DSBFPT;                      /*@ZA05939*/ 04516000
         L     @14,DSBFPT                                          1188 04517000
         ST    @14,CTGFLPTR                                        1188 04518000
*                  DARGSENT = LCST49;                      /*@ZA05939*/ 04519000
         L     @07,DARGPTR                                         1189 04520000
         MVI   DARGSENT(@07),X'31'                                 1189 04521000
*                  DARGDBP = CTGFLPT(1);                   /*@ZA05939*/ 04522000
         L     @06,CTGFLPT(,@14)                                   1190 04523000
         ST    @06,DARGDBP(,@07)                                   1190 04524000
*                  DARGILP = CTGFLNG(1);                   /*@ZA05939*/ 04525000
         L     @06,CTGFLNG(,@14)                                   1191 04526000
         STH   @06,DARGILP(,@07)                                   1191 04527000
*                  IF AMDAXRKP = ARITH4FF                          1192 04528000
*                    THEN                                          1192 04529000
         LH    @14,AMDAXRKP(,@04)                                  1192 04530000
         CL    @14,ARITH4FF                                        1192 04531000
         BNE   @RF01192                                            1192 04532000
*                      AMDAXRKP = 0;                       /*@ZA05939*/ 04533000
*                                                                  1193 04534000
         STH   @15,AMDAXRKP(,@04)                                  1193 04535000
*                  CALL LISTPROC;                          /*@ZA05939*/ 04536000
@RF01192 BAL   @14,LISTPROC                                        1194 04537000
*                END;                                      /*@ZA05939*/ 04538000
*                                                                  1195 04539000
*        IF DSBCATPT > NULLPTR                                     1196 04540000
*          THEN                                                    1196 04541000
*                                                                  1196 04542000
@RF01186 DS    0H                                                  1196 04543000
@RF01185 L     @04,DSBCATPT                                        1196 04544000
         SLR   @15,@15                                             1196 04545000
         CR    @04,@15                                             1196 04546000
         BNH   @RF01196                                            1196 04547000
*            /********************************************************/ 04548000
*            /*                                              @ZA05939*/ 04549000
*            /* FOR THE DATA ENTRY OF A RELATIVE RECORD      @ZA05939*/ 04550000
*            /* DATA SET, BUILD THE DARGLIST TO PRINT THE    @ZA05939*/ 04551000
*            /* RECORDS/CI AND MAXRECS DATA INFORMATION.     @ZA05939*/ 04552000
*            /*                                              @ZA05939*/ 04553000
*            /********************************************************/ 04554000
*                                                                  1197 04555000
*            IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA               1197 04556000
*              THEN                                                1197 04557000
         L     @14,ETYPFPT                                         1197 04558000
         L     @14,CTGFLPT(,@14)                                   1197 04559000
         CLI   ETYP(@14),C'D'                                      1197 04560000
         BNE   @RF01197                                            1197 04561000
*                IF AMDRRDS = ON                                   1198 04562000
*                  THEN                                            1198 04563000
         TM    AMDRRDS(@04),B'00000010'                            1198 04564000
         BNO   @RF01198                                            1198 04565000
*                    DO;                                   /*@ZA05939*/ 04566000
*                      CTGFLPTR = DSBFPT;                  /*@ZA05939*/ 04567000
         L     @14,DSBFPT                                          1200 04568000
         ST    @14,CTGFLPTR                                        1200 04569000
*                      DARGSENT = LCST52;                  /*@ZA05939*/ 04570000
         L     @07,DARGPTR                                         1201 04571000
         MVI   DARGSENT(@07),X'34'                                 1201 04572000
*                      DARGDBP = CTGFLPT(1);               /*@ZA05939*/ 04573000
         L     @06,CTGFLPT(,@14)                                   1202 04574000
         ST    @06,DARGDBP(,@07)                                   1202 04575000
*                      DARGILP = CTGFLNG(1);               /*@ZA05939*/ 04576000
         L     @06,CTGFLNG(,@14)                                   1203 04577000
         STH   @06,DARGILP(,@07)                                   1203 04578000
*                      IF AMDNSLOT = ARITH4FF                      1204 04579000
*                        THEN                                      1204 04580000
         CLC   AMDNSLOT(4,@04),ARITH4FF                            1204 04581000
         BNE   @RF01204                                            1204 04582000
*                          AMDNSLOT = 0;                   /*@ZA05939*/ 04583000
         ST    @15,AMDNSLOT(,@04)                                  1205 04584000
*                      IF AMDMAXRR = ARITH4FF                      1206 04585000
*                        THEN                                      1206 04586000
@RF01204 L     @04,DSBCATPT                                        1206 04587000
         CLC   AMDMAXRR(4,@04),ARITH4FF                            1206 04588000
         BNE   @RF01206                                            1206 04589000
*                          AMDMAXRR = 0;                   /*@ZA05939*/ 04590000
*                                                                  1207 04591000
         SLR   @00,@00                                             1207 04592000
         ST    @00,AMDMAXRR(,@04)                                  1207 04593000
*                      CALL LISTPROC;                      /*@ZA05939*/ 04594000
@RF01206 BAL   @14,LISTPROC                                        1208 04595000
*                    END;                                  /*@ZA05939*/ 04596000
*        /************************************************************/ 04597000
*        /*                                                          */ 04598000
*        /* THE DATASET ATTRIBUTES TO BE LISTED ARE STORED AS EIGHT- */ 04599000
*        /* BYTE ENTRIES IN A STATIC TEXT TABLE.  A MAXIMUM OF 11    */ 04600000
*        /* ATTRIBUTES (10 PRINT POSITIONS EACH) CAN BE OUTPUT TO    */ 04601000
*        /* THE 120-POSITION DEFAULT PRINT LINE.                     */ 04602000
*        /*                                                          */ 04603000
*        /************************************************************/ 04604000
*                                                                  1210 04605000
*                                                                  1210 04606000
*        IF ATTRFPT->CTGFLPT(1) > NULLPTR                          1210 04607000
*          THEN                                                    1210 04608000
@RF01198 DS    0H                                                  1210 04609000
@RF01197 DS    0H                                                  1210 04610000
@RF01196 L     @04,ATTRFPT                                         1210 04611000
         L     @04,CTGFLPT(,@04)                                   1210 04612000
         LTR   @04,@04                                             1210 04613000
         BNP   @RF01210                                            1210 04614000
*DATATTR:    DO;                                                   1211 04615000
*                                                                  1211 04616000
DATATTR  DS    0H                                                  1212 04617000
*              DARGSENT = LCST19;                                  1212 04618000
         L     @04,DARGPTR                                         1212 04619000
         MVI   DARGSENT(@04),X'13'                                 1212 04620000
*              CTGFLPTR = ATTRFPT;                                 1213 04621000
*                                                                  1213 04622000
         L     @00,ATTRFPT                                         1213 04623000
         ST    @00,CTGFLPTR                                        1213 04624000
*              /******************************************************/ 04625000
*              /*                                                    */ 04626000
*              /* THE SHAREOPTIONS ATTRIBUTE, SHR(N,N), IS ALWAYS    */ 04627000
*              /* LISTED FIRST SINCE 3 INSERT STRUCTURES ARE REQUIRED*/ 04628000
*              /* FOR THE AMS TEXT PROCESSOR INTERFACE TO FORMAT IT. */ 04629000
*              /*                                                    */ 04630000
*              /******************************************************/ 04631000
*                                                                  1214 04632000
*              DARGCNT = DRGCNT4;                          /*@ZA05939*/ 04633000
         MVC   DARGCNT(2,@04),@CH00050                             1214 04634000
*              DARGDTM(1) = ADDR(SHRNM);                           1215 04635000
         L     @15,TEXTPTR                                         1215 04636000
         LA    @14,SHRNM(,@15)                                     1215 04637000
         ST    @14,DARGDTM(,@04)                                   1215 04638000
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/ 04639000
         LA    @14,10                                              1216 04640000
         STH   @14,DARGINS(,@04)                                   1216 04641000
*              DARGINL(1) = ABBREVLN;                              1217 04642000
         STH   @14,DARGINL(,@04)                                   1217 04643000
*              DARGDTM(2) = ADDR(SHRPRNM);                 /*@ZA05939*/ 04644000
         LA    @07,SHRPRNM(,@15)                                   1218 04645000
         ST    @07,DARGDTM+8(,@04)                                 1218 04646000
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/ 04647000
         MVC   DARGINS+8(2,@04),@CH00649                           1219 04648000
*              DARGINL(2) = ABBREVLN;                      /*@ZA05939*/ 04649000
         STH   @14,DARGINL+8(,@04)                                 1220 04650000
*              DARGINS(3) = DRGINS30;                      /*@ZA05939*/ 04651000
*                                                                  1221 04652000
         MVC   DARGINS+16(2,@04),@CH01231                          1221 04653000
*              /******************************************************/ 04654000
*              /*                                                    */ 04655000
*              /* INTERPRET THE FIRST SHAREOPTION RECORDING CROSS-   */ 04656000
*              /* REGION DATA.                                       */ 04657000
*              /*                                                    */ 04658000
*              /******************************************************/ 04659000
*                                                                  1222 04660000
*              DARGINL(3) = CLENGTH1;                      /*@ZA05939*/ 04661000
         MVC   DARGINL+16(2,@04),@CH00045                          1222 04662000
*              IF INTRASHR = SHROPTN1                              1223 04663000
*                THEN                                              1223 04664000
         LR    @14,@00                                             1223 04665000
         L     @14,CTGFLPT(,@14)                                   1223 04666000
         TM    INTRASHR(@14),B'11000000'                           1223 04667000
         BNZ   @RF01223                                            1223 04668000
*                  DARGDTM(3) = ADDR(SHR1NM);              /*@ZA05939*/ 04669000
         LA    @00,SHR1NM(,@15)                                    1224 04670000
         ST    @00,DARGDTM+16(,@04)                                1224 04671000
*                ELSE                                              1225 04672000
*                  IF INTRASHR = SHROPTN2                          1225 04673000
*                    THEN                                          1225 04674000
         B     @RC01223                                            1225 04675000
@RF01223 L     @04,CTGFLPTR                                        1225 04676000
         L     @04,CTGFLPT(,@04)                                   1225 04677000
         TM    INTRASHR(@04),B'01000000'                           1225 04678000
         BNO   @RF01225                                            1225 04679000
         TM    INTRASHR(@04),B'10000000'                           1225 04680000
         BNZ   @RF01225                                            1225 04681000
*                      DARGDTM(3) = ADDR(SHR2NM);          /*@ZA05939*/ 04682000
         L     @04,TEXTPTR                                         1226 04683000
         LA    @04,SHR2NM(,@04)                                    1226 04684000
         L     @15,DARGPTR                                         1226 04685000
         ST    @04,DARGDTM+16(,@15)                                1226 04686000
*                    ELSE                                          1227 04687000
*                        IF INTRASHR = SHROPTN3                    1227 04688000
*                          THEN                                    1227 04689000
         B     @RC01225                                            1227 04690000
@RF01225 L     @04,CTGFLPTR                                        1227 04691000
         L     @04,CTGFLPT(,@04)                                   1227 04692000
         TM    INTRASHR(@04),B'10000000'                           1227 04693000
         BNO   @RF01227                                            1227 04694000
         TM    INTRASHR(@04),B'01000000'                           1227 04695000
         BNZ   @RF01227                                            1227 04696000
*                            DARGDTM(3) = ADDR(SHR3NM);    /*@ZA05939*/ 04697000
         L     @04,TEXTPTR                                         1228 04698000
         LA    @04,SHR3NM(,@04)                                    1228 04699000
         L     @15,DARGPTR                                         1228 04700000
         ST    @04,DARGDTM+16(,@15)                                1228 04701000
*                          ELSE                                    1229 04702000
*                            DARGDTM(3) = ADDR(SHR4NM);    /*@ZA05939*/ 04703000
*                                                                  1229 04704000
         B     @RC01227                                            1229 04705000
@RF01227 L     @04,TEXTPTR                                         1229 04706000
         LA    @04,SHR4NM(,@04)                                    1229 04707000
         L     @15,DARGPTR                                         1229 04708000
         ST    @04,DARGDTM+16(,@15)                                1229 04709000
*              /******************************************************/ 04710000
*              /*                                                    */ 04711000
*              /* INTERPRET THE SECOND SHAREOPTION RECORDING CROSS-  */ 04712000
*              /* SYSTEM DATA.                                       */ 04713000
*              /*                                                    */ 04714000
*              /******************************************************/ 04715000
*                                                                  1230 04716000
*              DARGINS(4) = DRGINS40;                      /*@ZA05939*/ 04717000
@RC01227 DS    0H                                                  1230 04718000
@RC01225 DS    0H                                                  1230 04719000
@RC01223 L     @04,DARGPTR                                         1230 04720000
         MVC   DARGINS+24(2,@04),@CH01249                          1230 04721000
*              DARGINL(4) = CLENGTH1;                      /*@ZA05939*/ 04722000
         MVC   DARGINL+24(2,@04),@CH00045                          1231 04723000
*              IF INTERSHR = SHROPTN1                              1232 04724000
*                THEN                                              1232 04725000
         L     @15,CTGFLPTR                                        1232 04726000
         L     @15,CTGFLPT(,@15)                                   1232 04727000
         TM    INTERSHR(@15),B'00110000'                           1232 04728000
         BNZ   @RF01232                                            1232 04729000
*                  DARGDTM(4) = ADDR(SHR1NM);              /*@ZA05939*/ 04730000
         L     @15,TEXTPTR                                         1233 04731000
         LA    @00,SHR1NM(,@15)                                    1233 04732000
         ST    @00,DARGDTM+24(,@04)                                1233 04733000
*                ELSE                                              1234 04734000
*                  IF INTERSHR = SHROPTN2                          1234 04735000
*                    THEN                                          1234 04736000
         B     @RC01232                                            1234 04737000
@RF01232 L     @04,CTGFLPTR                                        1234 04738000
         L     @04,CTGFLPT(,@04)                                   1234 04739000
         TM    INTERSHR(@04),B'00010000'                           1234 04740000
         BNO   @RF01234                                            1234 04741000
         TM    INTERSHR(@04),B'00100000'                           1234 04742000
         BNZ   @RF01234                                            1234 04743000
*                      DARGDTM(4) = ADDR(SHR2NM);          /*@ZA05939*/ 04744000
         L     @04,TEXTPTR                                         1235 04745000
         LA    @04,SHR2NM(,@04)                                    1235 04746000
         L     @15,DARGPTR                                         1235 04747000
         ST    @04,DARGDTM+24(,@15)                                1235 04748000
*                    ELSE                                          1236 04749000
*                      IF INTERSHR = SHROPTN3                      1236 04750000
*                        THEN                                      1236 04751000
         B     @RC01234                                            1236 04752000
@RF01234 L     @04,CTGFLPTR                                        1236 04753000
         L     @04,CTGFLPT(,@04)                                   1236 04754000
         TM    INTERSHR(@04),B'00100000'                           1236 04755000
         BNO   @RF01236                                            1236 04756000
         TM    INTERSHR(@04),B'00010000'                           1236 04757000
         BNZ   @RF01236                                            1236 04758000
*                          DARGDTM(4) = ADDR(SHR3NM);      /*@ZA05939*/ 04759000
         L     @04,TEXTPTR                                         1237 04760000
         LA    @04,SHR3NM(,@04)                                    1237 04761000
         L     @15,DARGPTR                                         1237 04762000
         ST    @04,DARGDTM+24(,@15)                                1237 04763000
*                        ELSE                                      1238 04764000
*                          DARGDTM(4) = ADDR(SHR4NM);      /*@ZA05939*/ 04765000
         B     @RC01236                                            1238 04766000
@RF01236 L     @04,TEXTPTR                                         1238 04767000
         LA    @04,SHR4NM(,@04)                                    1238 04768000
         L     @15,DARGPTR                                         1238 04769000
         ST    @04,DARGDTM+24(,@15)                                1238 04770000
*              /******************************************************/ 04771000
*              /*                                                    */ 04772000
*              /* NOW INCLUDE IN THE DARGLIST THOSE ATTRIBUTED ALWAYS*/ 04773000
*              /* INITIALIZED FOR A DATA OR INDEX DATASET.           */ 04774000
*              /* NOTE - THE DARGLIST INSERT COUNTER IS INCREMENTED  */ 04775000
*              /* FOR EACH SUBSEQUENT ATTRIBUTE.  WHEN PROCESSING    */ 04776000
*              /* OF THE DATASET ATTRIBUTES IS FINISHED, THE DARGLIST*/ 04777000
*              /* INSERT PARAMETERS ARE COMPLETED BASED UPON THE     */ 04778000
*              /* INSERT COUNTER.                                    */ 04779000
*              /*                                                    */ 04780000
*              /******************************************************/ 04781000
*                                                                  1239 04782000
*              DARGCNT = DARGCNT + 1;                              1239 04783000
@RC01236 DS    0H                                                  1239 04784000
@RC01234 DS    0H                                                  1239 04785000
@RC01232 L     @04,DARGPTR                                         1239 04786000
         LA    @00,1                                               1239 04787000
         AH    @00,DARGCNT(,@04)                                   1239 04788000
         STH   @00,DARGCNT(,@04)                                   1239 04789000
*              IF DSSPEED = ON                                     1240 04790000
*                THEN                                              1240 04791000
         L     @15,CTGFLPTR                                        1240 04792000
         L     @15,CTGFLPT(,@15)                                   1240 04793000
         TM    DSSPEED(@15),B'10000000'                            1240 04794000
         BNO   @RF01240                                            1240 04795000
*                  DARGDTM(DARGCNT) = ADDR(SPEEDNM);               1241 04796000
         SLA   @00,3                                               1241 04797000
         L     @15,TEXTPTR                                         1241 04798000
         LA    @15,SPEEDNM(,@15)                                   1241 04799000
         LR    @14,@00                                             1241 04800000
         ST    @15,DARGDTM-8(@14,@04)                              1241 04801000
*                ELSE                                              1242 04802000
*                  DARGDTM(DARGCNT) = ADDR(RCVYNM);                1242 04803000
         B     @RC01240                                            1242 04804000
@RF01240 L     @04,DARGPTR                                         1242 04805000
         LH    @15,DARGCNT(,@04)                                   1242 04806000
         SLA   @15,3                                               1242 04807000
         L     @14,TEXTPTR                                         1242 04808000
         LA    @14,RCVYNM(,@14)                                    1242 04809000
         ST    @14,DARGDTM-8(@15,@04)                              1242 04810000
*              DARGCNT = DARGCNT + 1;                              1243 04811000
@RC01240 L     @04,DARGPTR                                         1243 04812000
         LA    @00,1                                               1243 04813000
         AH    @00,DARGCNT(,@04)                                   1243 04814000
         STH   @00,DARGCNT(,@04)                                   1243 04815000
*              IF DSUNQ = ON                                       1244 04816000
*                THEN                                              1244 04817000
         L     @15,CTGFLPTR                                        1244 04818000
         L     @15,CTGFLPT(,@15)                                   1244 04819000
         TM    DSUNQ(@15),B'01000000'                              1244 04820000
         BNO   @RF01244                                            1244 04821000
*                  DARGDTM(DARGCNT) = ADDR(UNQNM);                 1245 04822000
         SLA   @00,3                                               1245 04823000
         L     @15,TEXTPTR                                         1245 04824000
         LA    @15,UNQNM(,@15)                                     1245 04825000
         LR    @14,@00                                             1245 04826000
         ST    @15,DARGDTM-8(@14,@04)                              1245 04827000
*                ELSE                                              1246 04828000
*                  DARGDTM(DARGCNT) = ADDR(SUBALNM);               1246 04829000
         B     @RC01244                                            1246 04830000
@RF01244 L     @04,DARGPTR                                         1246 04831000
         LH    @15,DARGCNT(,@04)                                   1246 04832000
         SLA   @15,3                                               1246 04833000
         L     @14,TEXTPTR                                         1246 04834000
         LA    @14,SUBALNM(,@14)                                   1246 04835000
         ST    @14,DARGDTM-8(@15,@04)                              1246 04836000
*              DARGCNT = DARGCNT + 1;                              1247 04837000
@RC01244 L     @04,DARGPTR                                         1247 04838000
         LA    @00,1                                               1247 04839000
         AH    @00,DARGCNT(,@04)                                   1247 04840000
         STH   @00,DARGCNT(,@04)                                   1247 04841000
*              IF DSERAS = ON                                      1248 04842000
*                THEN                                              1248 04843000
         L     @15,CTGFLPTR                                        1248 04844000
         L     @15,CTGFLPT(,@15)                                   1248 04845000
         TM    DSERAS(@15),B'00010000'                             1248 04846000
         BNO   @RF01248                                            1248 04847000
*                  DARGDTM(DARGCNT) = ADDR(ERASNM);                1249 04848000
         SLA   @00,3                                               1249 04849000
         L     @15,TEXTPTR                                         1249 04850000
         LA    @15,ERASNM(,@15)                                    1249 04851000
         LR    @14,@00                                             1249 04852000
         ST    @15,DARGDTM-8(@14,@04)                              1249 04853000
*                ELSE                                              1250 04854000
*                  DARGDTM(DARGCNT) = ADDR(NERASNM);               1250 04855000
         B     @RC01248                                            1250 04856000
@RF01248 L     @04,DARGPTR                                         1250 04857000
         LH    @15,DARGCNT(,@04)                                   1250 04858000
         SLA   @15,3                                               1250 04859000
         L     @14,TEXTPTR                                         1250 04860000
         LA    @14,NERASNM(,@14)                                   1250 04861000
         ST    @14,DARGDTM-8(@15,@04)                              1250 04862000
*        /************************************************************/ 04863000
*        /*                                                          */ 04864000
*        /* ADD TO THE DARGLIST THOSE DATASET ATTRIBUTED RECORDED IN */ 04865000
*        /* THE CATALOG AMDSB CONTROL BLOCK RETURNED IN THE WORKAREA.*/ 04866000
*        /*                                                          */ 04867000
*        /************************************************************/ 04868000
*                                                                  1251 04869000
*        IF DSBCATPT > NULLPTR                                     1251 04870000
*          THEN                                                    1251 04871000
@RC01248 L     @04,DSBCATPT                                        1251 04872000
         LTR   @04,@04                                             1251 04873000
         BNP   @RF01251                                            1251 04874000
*            DO;                                                   1252 04875000
*                                                                  1252 04876000
*              /******************************************************/ 04877000
*              /*                                                    */ 04878000
*              /* ONLY FOR DATA ENTRIES IS THE               @Y30SSMK*/ 04879000
*              /* INDEXED/NONINDEXED/NUMBERED                @Y30SSMK*/ 04880000
*              /* DESCRIPTOR TO BE INCLUDED IN THE DARGLIST.         */ 04881000
*              /*                                                    */ 04882000
*              /******************************************************/ 04883000
*                                                                  1253 04884000
*              IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA             1253 04885000
*                THEN                                              1253 04886000
         L     @15,ETYPFPT                                         1253 04887000
         L     @15,CTGFLPT(,@15)                                   1253 04888000
         CLI   ETYP(@15),C'D'                                      1253 04889000
         BNE   @RF01253                                            1253 04890000
*                  DO;                                             1254 04891000
*                    DARGCNT = DARGCNT + 1;                        1255 04892000
         L     @15,DARGPTR                                         1255 04893000
         LA    @14,1                                               1255 04894000
         AH    @14,DARGCNT(,@15)                                   1255 04895000
         STH   @14,DARGCNT(,@15)                                   1255 04896000
*                    IF AMDRRDS = ON                               1256 04897000
*                      THEN                                        1256 04898000
         TM    AMDRRDS(@04),B'00000010'                            1256 04899000
         BNO   @RF01256                                            1256 04900000
*                        DARGDTM(DARGCNT) = ADDR(NUMDNM);  /*@Y30SSMK*/ 04901000
         SLA   @14,3                                               1257 04902000
         L     @04,TEXTPTR                                         1257 04903000
         LA    @04,NUMDNM(,@04)                                    1257 04904000
         ST    @04,DARGDTM-8(@14,@15)                              1257 04905000
*                      ELSE                                        1258 04906000
*                        IF AMDDST = ON                            1258 04907000
*                          THEN                                    1258 04908000
         B     @RC01256                                            1258 04909000
@RF01256 L     @04,DSBCATPT                                        1258 04910000
         TM    AMDDST(@04),B'10000000'                             1258 04911000
         BNO   @RF01258                                            1258 04912000
*                            DARGDTM(DARGCNT) = ADDR(IXDNM);       1259 04913000
         L     @04,DARGPTR                                         1259 04914000
         LH    @15,DARGCNT(,@04)                                   1259 04915000
         SLA   @15,3                                               1259 04916000
         L     @14,TEXTPTR                                         1259 04917000
         LA    @14,IXDNM(,@14)                                     1259 04918000
         ST    @14,DARGDTM-8(@15,@04)                              1259 04919000
*                          ELSE                                    1260 04920000
*                            DARGDTM(DARGCNT) = ADDR(NIXDNM);      1260 04921000
         B     @RC01258                                            1260 04922000
@RF01258 L     @04,DARGPTR                                         1260 04923000
         LH    @15,DARGCNT(,@04)                                   1260 04924000
         SLA   @15,3                                               1260 04925000
         L     @14,TEXTPTR                                         1260 04926000
         LA    @14,NIXDNM(,@14)                                    1260 04927000
         ST    @14,DARGDTM-8(@15,@04)                              1260 04928000
*                  END;                                            1261 04929000
@RC01258 DS    0H                                                  1261 04930000
@RC01256 DS    0H                                                  1262 04931000
*              DARGCNT = DARGCNT + 1;                              1262 04932000
@RF01253 L     @04,DARGPTR                                         1262 04933000
         LA    @00,1                                               1262 04934000
         AH    @00,DARGCNT(,@04)                                   1262 04935000
         STH   @00,DARGCNT(,@04)                                   1262 04936000
*              IF AMDWCK = ON                                      1263 04937000
*                THEN                                              1263 04938000
         L     @15,DSBCATPT                                        1263 04939000
         TM    AMDWCK(@15),B'01000000'                             1263 04940000
         BNO   @RF01263                                            1263 04941000
*                  DARGDTM(DARGCNT) = ADDR(WCKNM);                 1264 04942000
         SLA   @00,3                                               1264 04943000
         L     @15,TEXTPTR                                         1264 04944000
         LA    @15,WCKNM(,@15)                                     1264 04945000
         LR    @14,@00                                             1264 04946000
         ST    @15,DARGDTM-8(@14,@04)                              1264 04947000
*                ELSE                                              1265 04948000
*                  DARGDTM(DARGCNT) = ADDR(NWCKNM);                1265 04949000
         B     @RC01263                                            1265 04950000
@RF01263 L     @04,DARGPTR                                         1265 04951000
         LH    @15,DARGCNT(,@04)                                   1265 04952000
         SLA   @15,3                                               1265 04953000
         L     @14,TEXTPTR                                         1265 04954000
         LA    @14,NWCKNM(,@14)                                    1265 04955000
         ST    @14,DARGDTM-8(@15,@04)                              1265 04956000
*              DARGCNT = DARGCNT + 1;                              1266 04957000
@RC01263 L     @04,DARGPTR                                         1266 04958000
         LA    @00,1                                               1266 04959000
         AH    @00,DARGCNT(,@04)                                   1266 04960000
         STH   @00,DARGCNT(,@04)                                   1266 04961000
*              IF AMDSDT = ON                                      1267 04962000
*                THEN                                              1267 04963000
         L     @15,DSBCATPT                                        1267 04964000
         TM    AMDSDT(@15),B'00100000'                             1267 04965000
         BNO   @RF01267                                            1267 04966000
*                  DARGDTM(DARGCNT) = ADDR(IMBDNM);                1268 04967000
         SLA   @00,3                                               1268 04968000
         L     @15,TEXTPTR                                         1268 04969000
         LA    @15,IMBDNM(,@15)                                    1268 04970000
         LR    @14,@00                                             1268 04971000
         ST    @15,DARGDTM-8(@14,@04)                              1268 04972000
*                ELSE                                              1269 04973000
*                  DARGDTM(DARGCNT) = ADDR(NIMBDNM);               1269 04974000
         B     @RC01267                                            1269 04975000
@RF01267 L     @04,DARGPTR                                         1269 04976000
         LH    @15,DARGCNT(,@04)                                   1269 04977000
         SLA   @15,3                                               1269 04978000
         L     @14,TEXTPTR                                         1269 04979000
         LA    @14,NIMBDNM(,@14)                                   1269 04980000
         ST    @14,DARGDTM-8(@15,@04)                              1269 04981000
*              DARGCNT = DARGCNT + 1;                              1270 04982000
@RC01267 L     @04,DARGPTR                                         1270 04983000
         LA    @00,1                                               1270 04984000
         AH    @00,DARGCNT(,@04)                                   1270 04985000
         STH   @00,DARGCNT(,@04)                                   1270 04986000
*              IF AMDREPL = ON                                     1271 04987000
*                THEN                                              1271 04988000
         L     @15,DSBCATPT                                        1271 04989000
         TM    AMDREPL(@15),B'00010000'                            1271 04990000
         BNO   @RF01271                                            1271 04991000
*                  DARGDTM(DARGCNT) = ADDR(REPLNM);                1272 04992000
         SLA   @00,3                                               1272 04993000
         L     @15,TEXTPTR                                         1272 04994000
         LA    @15,REPLNM(,@15)                                    1272 04995000
         LR    @14,@00                                             1272 04996000
         ST    @15,DARGDTM-8(@14,@04)                              1272 04997000
*                ELSE                                              1273 04998000
*                  DARGDTM(DARGCNT) = ADDR(NREPLNM);               1273 04999000
         B     @RC01271                                            1273 05000000
@RF01271 L     @04,DARGPTR                                         1273 05001000
         LH    @15,DARGCNT(,@04)                                   1273 05002000
         SLA   @15,3                                               1273 05003000
         L     @14,TEXTPTR                                         1273 05004000
         LA    @14,NREPLNM(,@14)                                   1273 05005000
         ST    @14,DARGDTM-8(@15,@04)                              1273 05006000
*              DARGCNT = DARGCNT + 1;                              1274 05007000
@RC01271 L     @04,DARGPTR                                         1274 05008000
         LA    @00,1                                               1274 05009000
         AH    @00,DARGCNT(,@04)                                   1274 05010000
         STH   @00,DARGCNT(,@04)                                   1274 05011000
*              IF AMDORDER = ON                                    1275 05012000
*                THEN                                              1275 05013000
         L     @15,DSBCATPT                                        1275 05014000
         TM    AMDORDER(@15),B'00001000'                           1275 05015000
         BNO   @RF01275                                            1275 05016000
*                  DARGDTM(DARGCNT) = ADDR(ORDNM);                 1276 05017000
         SLA   @00,3                                               1276 05018000
         L     @15,TEXTPTR                                         1276 05019000
         LA    @15,ORDNM(,@15)                                     1276 05020000
         LR    @14,@00                                             1276 05021000
         ST    @15,DARGDTM-8(@14,@04)                              1276 05022000
*                ELSE                                              1277 05023000
*                  DARGDTM(DARGCNT) = ADDR(UNORDNM);               1277 05024000
         B     @RC01275                                            1277 05025000
@RF01275 L     @04,DARGPTR                                         1277 05026000
         LH    @15,DARGCNT(,@04)                                   1277 05027000
         SLA   @15,3                                               1277 05028000
         L     @14,TEXTPTR                                         1277 05029000
         LA    @14,UNORDNM(,@14)                                   1277 05030000
         ST    @14,DARGDTM-8(@15,@04)                              1277 05031000
*            END;                                                  1278 05032000
@RC01275 DS    0H                                                  1279 05033000
*                                                                  1279 05034000
*        /************************************************************/ 05035000
*        /*                                                  @YL026UE*/ 05036000
*        /* IF THE DATA ENTRY IS A PAGESPACE, LIST THE TRACK-        */ 05037000
*        /* OVERFLOW OR NO-TRACK-OVERFLOW ATTRIBUTES.        @YL026UE*/ 05038000
*        /*                                                  @YL026UE*/ 05039000
*        /************************************************************/ 05040000
*                                                                  1279 05041000
*        IF PGSPCFLG = ON                                          1279 05042000
*          THEN                                                    1279 05043000
@RF01251 TM    PGSPCFLG,B'10000000'                                1279 05044000
         BNO   @RF01279                                            1279 05045000
*            DO;                                           /*@YL026UE*/ 05046000
*            DARGCNT = DARGCNT + 1;                        /*@YL026UE*/ 05047000
         L     @04,DARGPTR                                         1281 05048000
         LA    @00,1                                               1281 05049000
         AH    @00,DARGCNT(,@04)                                   1281 05050000
         STH   @00,DARGCNT(,@04)                                   1281 05051000
*            DARGINS(DARGCNT) = DARGCNT*DRGINS10;          /*@Y30SSMK*/ 05052000
         LR    @15,@00                                             1282 05053000
         SLA   @15,3                                               1282 05054000
         LA    @14,10                                              1282 05055000
         LR    @03,@00                                             1282 05056000
         MR    @02,@14                                             1282 05057000
         STH   @03,DARGINS-8(@15,@04)                              1282 05058000
*            DARGINL(DARGCNT) = ABBREVLN;                  /*@YL026UE*/ 05059000
         STH   @14,DARGINL-8(@15,@04)                              1283 05060000
*            IF DSTKOV = ON                                        1284 05061000
*              THEN                                                1284 05062000
         L     @14,CTGFLPTR                                        1284 05063000
         L     @14,CTGFLPT(,@14)                                   1284 05064000
         TM    DSTKOV(@14),B'00000001'                             1284 05065000
         BNO   @RF01284                                            1284 05066000
*                DARGDTM(DARGCNT) = ADDR(TOVFLNM);         /*@YL026UE*/ 05067000
         L     @14,TEXTPTR                                         1285 05068000
         LA    @14,TOVFLNM(,@14)                                   1285 05069000
         ST    @14,DARGDTM-8(@15,@04)                              1285 05070000
*              ELSE                                                1286 05071000
*                DARGDTM(DARGCNT) = ADDR(NTOVFLNM);        /*@YL026UE*/ 05072000
*                                                                  1286 05073000
         B     @RC01284                                            1286 05074000
@RF01284 L     @04,DARGPTR                                         1286 05075000
         LH    @15,DARGCNT(,@04)                                   1286 05076000
         SLA   @15,3                                               1286 05077000
         L     @14,TEXTPTR                                         1286 05078000
         LA    @14,NTOVFLNM(,@14)                                  1286 05079000
         ST    @14,DARGDTM-8(@15,@04)                              1286 05080000
*            /********************************************************/ 05081000
*            /*                                              @Z40WSMK*/ 05082000
*            /* FOR THE DATA COMPONENT OF A PAGESPACE,       @Z40WSMK*/ 05083000
*            /* CONTINUE TO LIST THE SWAP OR NOSWAP          @Z40WSMK*/ 05084000
*            /* ATTRIBUTES.                                  @Z40WSMK*/ 05085000
*            /*                                              @Z40WSMK*/ 05086000
*            /********************************************************/ 05087000
*                                                                  1287 05088000
*            DARGCNT = DARGCNT + 1;                        /*@Z40WSMK*/ 05089000
@RC01284 L     @04,DARGPTR                                         1287 05090000
         LA    @00,1                                               1287 05091000
         AH    @00,DARGCNT(,@04)                                   1287 05092000
         STH   @00,DARGCNT(,@04)                                   1287 05093000
*            DARGINS(DARGCNT) = DARGCNT * DRGINS10;        /*@Z40WSMK*/ 05094000
         LR    @15,@00                                             1288 05095000
         SLA   @15,3                                               1288 05096000
         LA    @14,10                                              1288 05097000
         LR    @03,@00                                             1288 05098000
         MR    @02,@14                                             1288 05099000
         STH   @03,DARGINS-8(@15,@04)                              1288 05100000
*            DARGINL(DARGCNT) = ABBREVLN;                  /*@Z40WSMK*/ 05101000
         STH   @14,DARGINL-8(@15,@04)                              1289 05102000
*            IF CATTRFPT->CTGFLPT(1)->PGSWAP = ON                  1290 05103000
*              THEN                                                1290 05104000
         L     @14,CATTRFPT                                        1290 05105000
         L     @14,CTGFLPT(,@14)                                   1290 05106000
         TM    PGSWAP(@14),B'00000010'                             1290 05107000
         BNO   @RF01290                                            1290 05108000
*                DARGDTM(DARGCNT) = ADDR(SWAPNM);          /*@Z40WSMK*/ 05109000
         L     @14,TEXTPTR                                         1291 05110000
         LA    @14,SWAPNM(,@14)                                    1291 05111000
         ST    @14,DARGDTM-8(@15,@04)                              1291 05112000
*              ELSE                                                1292 05113000
*                DARGDTM(DARGCNT) = ADDR(NSWAPNM);         /*@Z40WSMK*/ 05114000
         B     @RC01290                                            1292 05115000
@RF01290 L     @04,DARGPTR                                         1292 05116000
         LH    @15,DARGCNT(,@04)                                   1292 05117000
         SLA   @15,3                                               1292 05118000
         L     @14,TEXTPTR                                         1292 05119000
         LA    @14,NSWAPNM(,@14)                                   1292 05120000
         ST    @14,DARGDTM-8(@15,@04)                              1292 05121000
*            END;                                          /*#YL026UE*/ 05122000
*          ELSE                                                    1294 05123000
*XPDATA:     DO;                                           /*@YL026UE*/ 05124000
*                                                                  1294 05125000
         B     @RC01279                                            1294 05126000
@RF01279 DS    0H                                                  1294 05127000
XPDATA   DS    0H                                                  1295 05128000
*              /******************************************************/ 05129000
*              /*                                                    */ 05130000
*              /* DETERMINE WHETHER THE OPTIONAL ATTRIBUTES -        */ 05131000
*              /* INHIBIT UPDATE, TEMPORARY EXPORT - ARE TO BE       */ 05132000
*              /* LISTED. NOTE - A PAGESPACE DATA ENTRY CAN NOT      */ 05133000
*              /* BE EXPORTED.                               @YL026UE*/ 05134000
*              /*                                                    */ 05135000
*              /******************************************************/ 05136000
*                                                                  1295 05137000
*              IF DSINH = ON                                       1295 05138000
*                THEN                                              1295 05139000
         L     @04,CTGFLPTR                                        1295 05140000
         L     @04,CTGFLPT(,@04)                                   1295 05141000
         TM    DSINH(@04),B'00000100'                              1295 05142000
         BNO   @RF01295                                            1295 05143000
*                  DO;                                             1296 05144000
*                    DARGCNT = DARGCNT + 1;                        1297 05145000
         L     @04,DARGPTR                                         1297 05146000
         LA    @00,1                                               1297 05147000
         AH    @00,DARGCNT(,@04)                                   1297 05148000
         STH   @00,DARGCNT(,@04)                                   1297 05149000
*                    DARGINS(DARGCNT) = DARGCNT * DRGINS10;/*@Y30SSMK*/ 05150000
         LR    @15,@00                                             1298 05151000
         SLA   @15,3                                               1298 05152000
         LA    @14,10                                              1298 05153000
         LR    @03,@00                                             1298 05154000
         MR    @02,@14                                             1298 05155000
         STH   @03,DARGINS-8(@15,@04)                              1298 05156000
*                    DARGINL(DARGCNT) = ABBREVLN;                  1299 05157000
         STH   @14,DARGINL-8(@15,@04)                              1299 05158000
*                    DARGDTM(DARGCNT) = ADDR(INHUPDNM);            1300 05159000
         L     @14,TEXTPTR                                         1300 05160000
         LA    @14,INHUPDNM(,@14)                                  1300 05161000
         ST    @14,DARGDTM-8(@15,@04)                              1300 05162000
*                  END;                                            1301 05163000
*              IF DSTEXP = ON                                      1302 05164000
*                THEN                                              1302 05165000
@RF01295 L     @04,CTGFLPTR                                        1302 05166000
         L     @04,CTGFLPT(,@04)                                   1302 05167000
         TM    DSTEXP(@04),B'00000010'                             1302 05168000
         BNO   @RF01302                                            1302 05169000
*                  DO;                                             1303 05170000
*                    DARGCNT = DARGCNT + 1;                        1304 05171000
         L     @04,DARGPTR                                         1304 05172000
         LA    @00,1                                               1304 05173000
         AH    @00,DARGCNT(,@04)                                   1304 05174000
         STH   @00,DARGCNT(,@04)                                   1304 05175000
*                    DARGINS(DARGCNT) = DARGCNT * DRGINS10;/*@Y30SSMK*/ 05176000
         LR    @15,@00                                             1305 05177000
         SLA   @15,3                                               1305 05178000
         LA    @14,10                                              1305 05179000
         LR    @03,@00                                             1305 05180000
         MR    @02,@14                                             1305 05181000
         STH   @03,DARGINS-8(@15,@04)                              1305 05182000
*                    DARGINL(DARGCNT) = ABBREVLN;                  1306 05183000
         STH   @14,DARGINL-8(@15,@04)                              1306 05184000
*                    DARGDTM(DARGCNT) = ADDR(TEMEXPNM);            1307 05185000
         L     @14,TEXTPTR                                         1307 05186000
         LA    @14,TEMEXPNM(,@14)                                  1307 05187000
         ST    @14,DARGDTM-8(@15,@04)                              1307 05188000
*                  END;                                            1308 05189000
*            END XPDATA;                                   /*@YL026UE*/ 05190000
@RF01302 DS    0H                                                  1310 05191000
*              /******************************************************/ 05192000
*              /*                                            @Y30SSMK*/ 05193000
*              /* DETERMINE WHETHER THE DATA SET IS REUSABLE @Y30SSMK*/ 05194000
*              /* AND INCLUDE THIS ATTRIBUTE IN THE DARGLIST @Y30SSMK*/ 05195000
*              /*                                            @Y30SSMK*/ 05196000
*              /******************************************************/ 05197000
*                                                                  1310 05198000
*              DARGCNT = DARGCNT + 1;                      /*@Y30SSMK*/ 05199000
@RC01279 L     @04,DARGPTR                                         1310 05200000
         LA    @00,1                                               1310 05201000
         AH    @00,DARGCNT(,@04)                                   1310 05202000
         STH   @00,DARGCNT(,@04)                                   1310 05203000
*              IF DSREUSE = ON                                     1311 05204000
*                THEN                                              1311 05205000
         L     @15,CTGFLPTR                                        1311 05206000
         L     @15,CTGFLPT(,@15)                                   1311 05207000
         TM    DSREUSE(@15),B'00100000'                            1311 05208000
         BNO   @RF01311                                            1311 05209000
*                  DARGDTM(DARGCNT) = ADDR(RUSNM);         /*@Y30SSMK*/ 05210000
         SLA   @00,3                                               1312 05211000
         L     @15,TEXTPTR                                         1312 05212000
         LA    @15,RUSNM(,@15)                                     1312 05213000
         LR    @14,@00                                             1312 05214000
         ST    @15,DARGDTM-8(@14,@04)                              1312 05215000
*                ELSE                                              1313 05216000
*                  DARGDTM(DARGCNT) = ADDR(NRUSNM);        /*@Y30SSMK*/ 05217000
*                                                                  1313 05218000
         B     @RC01311                                            1313 05219000
@RF01311 L     @04,DARGPTR                                         1313 05220000
         LH    @15,DARGCNT(,@04)                                   1313 05221000
         SLA   @15,3                                               1313 05222000
         L     @14,TEXTPTR                                         1313 05223000
         LA    @14,NRUSNM(,@14)                                    1313 05224000
         ST    @14,DARGDTM-8(@15,@04)                              1313 05225000
*              /******************************************************/ 05226000
*              /*                                            @Y30SSMK*/ 05227000
*              /* ADD TO THE DARGLIST THOSE DATA SET         @Y30SSMK*/ 05228000
*              /* ATTRIBUTES RECORDED IN THE CATALOG AMDSB   @Y30SSMK*/ 05229000
*              /* CONTROL BLOCK RETURNED IN THE WORKAREA.    @Y30SSMK*/ 05230000
*              /*                                            @Y30SSMK*/ 05231000
*              /******************************************************/ 05232000
*                                                                  1314 05233000
*              IF DSBCATPT > NULLPTR                               1314 05234000
*                THEN                                              1314 05235000
@RC01311 L     @04,DSBCATPT                                        1314 05236000
         LTR   @04,@04                                             1314 05237000
         BNP   @RF01314                                            1314 05238000
*                  DO;                                     /*@Y30SSMK*/ 05239000
*                    IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA       1316 05240000
*                      THEN                                        1316 05241000
         L     @15,ETYPFPT                                         1316 05242000
         L     @15,CTGFLPT(,@15)                                   1316 05243000
         CLI   ETYP(@15),C'D'                                      1316 05244000
         BNE   @RF01316                                            1316 05245000
*                        DO;                               /*@Y30SSMK*/ 05246000
*                                                                  1317 05247000
*                          /******************************************/ 05248000
*                          /*                                @Y30SSMK*/ 05249000
*                          /* ONLY FOR THE DATA ENTRY IS     @Y30SSMK*/ 05250000
*                          /* THE SPANNED/NONSPANNED         @Y30SSMK*/ 05251000
*                          /* DESCRIPTOR TO BE INCLUDED      @Y30SSMK*/ 05252000
*                          /* IN THE DARGLIST.               @Y30SSMK*/ 05253000
*                          /*                                @Y30SSMK*/ 05254000
*                          /******************************************/ 05255000
*                                                                  1318 05256000
*                          DARGCNT = DARGCNT + 1;          /*@Y30SSMK*/ 05257000
         L     @15,DARGPTR                                         1318 05258000
         LA    @14,1                                               1318 05259000
         AH    @14,DARGCNT(,@15)                                   1318 05260000
         STH   @14,DARGCNT(,@15)                                   1318 05261000
*                          IF AMDSPAN = ON                         1319 05262000
*                            THEN                                  1319 05263000
         TM    AMDSPAN(@04),B'00000001'                            1319 05264000
         BNO   @RF01319                                            1319 05265000
*                              DARGDTM(DARGCNT) =                  1320 05266000
*                                ADDR(SPNDNM);             /*@Y30SSMK*/ 05267000
         SLA   @14,3                                               1320 05268000
         L     @04,TEXTPTR                                         1320 05269000
         LA    @04,SPNDNM(,@04)                                    1320 05270000
         ST    @04,DARGDTM-8(@14,@15)                              1320 05271000
*                            ELSE                                  1321 05272000
*                              DARGDTM(DARGCNT) =                  1321 05273000
*                                ADDR(NSPNDNM);            /*@Y30SSMK*/ 05274000
*                                                                  1321 05275000
         B     @RC01319                                            1321 05276000
@RF01319 L     @04,DARGPTR                                         1321 05277000
         LH    @15,DARGCNT(,@04)                                   1321 05278000
         SLA   @15,3                                               1321 05279000
         L     @14,TEXTPTR                                         1321 05280000
         LA    @14,NSPNDNM(,@14)                                   1321 05281000
         ST    @14,DARGDTM-8(@15,@04)                              1321 05282000
*                          /******************************************/ 05283000
*                          /*                                @Y30SSMK*/ 05284000
*                          /* ONLY FOR THE DATA ENTRY OF AN  @Y30SSMK*/ 05285000
*                          /* AIX IS THE UNIQUEKEY/NONUNIQUEKEY      */ 05286000
*                          /* DESCRIPTOR TO BE INCLUDED IN   @Y30SSMK*/ 05287000
*                          /* THE DARGLIST.                  @Y30SSMK*/ 05288000
*                          /*                                @Y30SSMK*/ 05289000
*                          /******************************************/ 05290000
*                                                                  1322 05291000
*                          IF GASSOCSW = ON                        1322 05292000
*                            THEN                                  1322 05293000
@RC01319 TM    GASSOCSW,B'10000000'                                1322 05294000
         BNO   @RF01322                                            1322 05295000
*                              DO;                         /*@Y30SSMK*/ 05296000
*                                DARGCNT = DARGCNT + 1;    /*@Y30SSMK*/ 05297000
         L     @04,DARGPTR                                         1324 05298000
         LA    @00,1                                               1324 05299000
         AH    @00,DARGCNT(,@04)                                   1324 05300000
         STH   @00,DARGCNT(,@04)                                   1324 05301000
*                                IF AMDUNQ = ON                    1325 05302000
*                                  THEN                            1325 05303000
         L     @15,DSBCATPT                                        1325 05304000
         TM    AMDUNQ(@15),B'10000000'                             1325 05305000
         BNO   @RF01325                                            1325 05306000
*                                    DARGDTM(DARGCNT) =            1326 05307000
*                                      ADDR(NUNQKNM);      /*@Y30SSMK*/ 05308000
         SLA   @00,3                                               1326 05309000
         L     @15,TEXTPTR                                         1326 05310000
         LA    @15,NUNQKNM(,@15)                                   1326 05311000
         LR    @14,@00                                             1326 05312000
         ST    @15,DARGDTM-8(@14,@04)                              1326 05313000
*                                  ELSE                            1327 05314000
*                                    DARGDTM(DARGCNT) =            1327 05315000
*                                      ADDR(UNQKNM);       /*@Y30SSMK*/ 05316000
         B     @RC01325                                            1327 05317000
@RF01325 L     @04,DARGPTR                                         1327 05318000
         LH    @15,DARGCNT(,@04)                                   1327 05319000
         SLA   @15,3                                               1327 05320000
         L     @14,TEXTPTR                                         1327 05321000
         LA    @14,UNQKNM(,@14)                                    1327 05322000
         ST    @14,DARGDTM-8(@15,@04)                              1327 05323000
*                              END;                        /*@Y30SSMK*/ 05324000
@RC01325 DS    0H                                                  1329 05325000
*                        END;                              /*@Y30SSMK*/ 05326000
*                                                                  1329 05327000
@RF01322 DS    0H                                                  1330 05328000
*                    /************************************************/ 05329000
*                    /*                                      @Y30LSMK*/ 05330000
*                    /* ADD TO THE DARGLIST THOSE DATA SET   @Y30LSMK*/ 05331000
*                    /* ATTRIBUTES CYLINDERFAULT,BIND, AND   @Y30LSMK*/ 05332000
*                    /* DESTAGEWAIT THAT ARE RECORDED IN THE @Y30LSMK*/ 05333000
*                    /* CATALOG AMDSB CONTROL BLOCK RETURNED @Y30LSMK*/ 05334000
*                    /* IN THE WORKAREA.                     @Y30LSMK*/ 05335000
*                    /*                                      @Y30LSMK*/ 05336000
*                    /************************************************/ 05337000
*                                                                  1330 05338000
*                    IF AMDFAULT = ON                              1330 05339000
*                      THEN                                        1330 05340000
@RF01316 L     @04,DSBCATPT                                        1330 05341000
         TM    AMDFAULT(@04),B'01000000'                           1330 05342000
         BNO   @RF01330                                            1330 05343000
*                        DO;                               /*@Y30LSMK*/ 05344000
*                          DARGCNT = DARGCNT + 1;          /*@Y30LSMK*/ 05345000
         L     @04,DARGPTR                                         1332 05346000
         LA    @00,1                                               1332 05347000
         AH    @00,DARGCNT(,@04)                                   1332 05348000
         STH   @00,DARGCNT(,@04)                                   1332 05349000
*                          DARGDTM(DARGCNT) = ADDR(CYLFNM);/*@Y30LSMK*/ 05350000
         SLA   @00,3                                               1333 05351000
         L     @15,TEXTPTR                                         1333 05352000
         LA    @15,CYLFNM(,@15)                                    1333 05353000
         LR    @14,@00                                             1333 05354000
         ST    @15,DARGDTM-8(@14,@04)                              1333 05355000
*                        END;                              /*@Y30LSMK*/ 05356000
*                    IF AMDBIND = ON                               1335 05357000
*                      THEN                                        1335 05358000
@RF01330 L     @04,DSBCATPT                                        1335 05359000
         TM    AMDBIND(@04),B'00100000'                            1335 05360000
         BNO   @RF01335                                            1335 05361000
*                        DO;                               /*@Y30LSMK*/ 05362000
*                          DARGCNT = DARGCNT + 1;          /*@Y30LSMK*/ 05363000
         L     @04,DARGPTR                                         1337 05364000
         LA    @00,1                                               1337 05365000
         AH    @00,DARGCNT(,@04)                                   1337 05366000
         STH   @00,DARGCNT(,@04)                                   1337 05367000
*                          DARGDTM(DARGCNT) = ADDR(BINDNM);/*@Y30LSMK*/ 05368000
         SLA   @00,3                                               1338 05369000
         L     @15,TEXTPTR                                         1338 05370000
         LA    @15,BINDNM(,@15)                                    1338 05371000
         LR    @14,@00                                             1338 05372000
         ST    @15,DARGDTM-8(@14,@04)                              1338 05373000
*                        END;                              /*@Y30LSMK*/ 05374000
*                    IF AMDWAIT = ON                               1340 05375000
*                      THEN                                        1340 05376000
@RF01335 L     @04,DSBCATPT                                        1340 05377000
         TM    AMDWAIT(@04),B'00010000'                            1340 05378000
         BNO   @RF01340                                            1340 05379000
*                        DO;                               /*@Y30LSMK*/ 05380000
*                          DARGCNT = DARGCNT + 1;          /*@Y30LSMK*/ 05381000
         L     @04,DARGPTR                                         1342 05382000
         LA    @00,1                                               1342 05383000
         AH    @00,DARGCNT(,@04)                                   1342 05384000
         STH   @00,DARGCNT(,@04)                                   1342 05385000
*                          DARGDTM(DARGCNT) = ADDR(DSTGWNM);       1343 05386000
         SLA   @00,3                                               1343 05387000
         L     @15,TEXTPTR                                         1343 05388000
         LA    @15,DSTGWNM(,@15)                                   1343 05389000
         LR    @14,@00                                             1343 05390000
         ST    @15,DARGDTM-8(@14,@04)                              1343 05391000
*                        END;                              /*@Y30LSMK*/ 05392000
*                  END;                                            1345 05393000
*                                                                  1345 05394000
@RF01340 DS    0H                                                  1346 05395000
*              /******************************************************/ 05396000
*              /*                                            @Y30SSMK*/ 05397000
*              /* ONLY FOR THE DATA ENTRY OF A RECOVERABLE   @Y30SSMK*/ 05398000
*              /* CATALOG IS THE RECOVERABLE DESCRIPTOR      @Y30SSMK*/ 05399000
*              /* TO BE INCLUDED IN THE DARGLIST.            @Y30SSMK*/ 05400000
*              /*                                            @Y30SSMK*/ 05401000
*              /******************************************************/ 05402000
*                                                                  1346 05403000
*              IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA             1346 05404000
*                THEN                                              1346 05405000
@RF01314 L     @04,ETYPFPT                                         1346 05406000
         L     @04,CTGFLPT(,@04)                                   1346 05407000
         CLI   ETYP(@04),C'D'                                      1346 05408000
         BNE   @RF01346                                            1346 05409000
*                  IF DSRCVR = ON                                  1347 05410000
*                    THEN                                          1347 05411000
         L     @04,CTGFLPTR                                        1347 05412000
         L     @04,CTGFLPT(,@04)                                   1347 05413000
         TM    DSRCVR(@04),B'00001000'                             1347 05414000
         BNO   @RF01347                                            1347 05415000
*                      DO;                                 /*@Y30SSMK*/ 05416000
*                        DARGCNT = DARGCNT + 1;            /*@Y30SSMK*/ 05417000
         L     @04,DARGPTR                                         1349 05418000
         LA    @00,1                                               1349 05419000
         AH    @00,DARGCNT(,@04)                                   1349 05420000
         STH   @00,DARGCNT(,@04)                                   1349 05421000
*                        DARGDTM(DARGCNT) = ADDR(RVBLNM);  /*@Y30SSMK*/ 05422000
         SLA   @00,3                                               1350 05423000
         L     @15,TEXTPTR                                         1350 05424000
         LA    @15,RVBLNM(,@15)                                    1350 05425000
         LR    @14,@00                                             1350 05426000
         ST    @15,DARGDTM-8(@14,@04)                              1350 05427000
*                      END;                                /*@Y30SSMK*/ 05428000
*                                                                  1351 05429000
*              /******************************************************/ 05430000
*              /*                                            @Y30SSMK*/ 05431000
*              /* DETERMINE WHETHER THE OPTIONAL ATTRIBUTE   @Y30SSMK*/ 05432000
*              /* NOTUSABLE IS TO BE LISTED.                 @Y30SSMK*/ 05433000
*              /*                                            @Y30SSMK*/ 05434000
*              /******************************************************/ 05435000
*                                                                  1352 05436000
*              IF DSNUSE = ON                                      1352 05437000
*                THEN                                              1352 05438000
@RF01347 DS    0H                                                  1352 05439000
@RF01346 L     @04,CTGFLPTR                                        1352 05440000
         L     @04,CTGFLPT(,@04)                                   1352 05441000
         TM    DSNUSE(@04),B'00000001'                             1352 05442000
         BNO   @RF01352                                            1352 05443000
*                  DO;                                     /*@Y30SSMK*/ 05444000
*                    DARGCNT = DARGCNT + 1;                /*@Y30SSMK*/ 05445000
         L     @04,DARGPTR                                         1354 05446000
         LA    @00,1                                               1354 05447000
         AH    @00,DARGCNT(,@04)                                   1354 05448000
         STH   @00,DARGCNT(,@04)                                   1354 05449000
*                    DARGDTM(DARGCNT) = ADDR(NUSNM);       /*@Y30SSMK*/ 05450000
         SLA   @00,3                                               1355 05451000
         L     @15,TEXTPTR                                         1355 05452000
         LA    @15,NUSNM(,@15)                                     1355 05453000
         LR    @14,@00                                             1355 05454000
         ST    @15,DARGDTM-8(@14,@04)                              1355 05455000
*                  END;                                    /*@Y30SSMK*/ 05456000
*                                                                  1356 05457000
*              /******************************************************/ 05458000
*              /*                                                    */ 05459000
*              /* SETUP THE COMMON DATA FOR THE AMS TEXT PROCESSOR   */ 05460000
*              /* INSERT STRUCTURES, EXCLUDING SHAREOPTIONS.         */ 05461000
*              /* THEN PRINT THE DATASET CHARACTERISTICS.            */ 05462000
*              /*                                                    */ 05463000
*              /******************************************************/ 05464000
*                                                                  1357 05465000
*              DO CKK = DRGCNT5 TO DARGCNT;                /*@ZA05939*/ 05466000
@RF01352 LA    CKK,5                                               1357 05467000
         B     @DE01357                                            1357 05468000
@DL01357 DS    0H                                                  1358 05469000
*                DARGINS(CKK) = CKK * DRGINS10;            /*@Y30SSMK*/ 05470000
         L     @07,DARGPTR                                         1358 05471000
         LR    @04,CKK                                             1358 05472000
         SLA   @04,3                                               1358 05473000
         LA    @15,10                                              1358 05474000
         LR    @03,CKK                                             1358 05475000
         MR    @02,@15                                             1358 05476000
         STH   @03,DARGINS-8(@04,@07)                              1358 05477000
*                DARGINL(CKK) = ABBREVLN;                          1359 05478000
         STH   @15,DARGINL-8(@04,@07)                              1359 05479000
*              END;                                                1360 05480000
*                                                                  1360 05481000
         AL    CKK,@CF00045                                        1360 05482000
@DE01357 L     @07,DARGPTR                                         1360 05483000
         CH    CKK,DARGCNT(,@07)                                   1360 05484000
         BNH   @DL01357                                            1360 05485000
*              CALL LISTPROC;                                      1361 05486000
         BAL   @14,LISTPROC                                        1361 05487000
*            END DATATTR;                                  /*@Y30LSMK*/ 05488000
*        /************************************************************/ 05489000
*        /*                                                          */ 05490000
*        /* FOR A DATA OR INDEX ENTRY, BUILD THE DARGLIST    @ZA05939*/ 05491000
*        /* TO PROCESS THE STATISTICS RECORDED IN THE        @ZA05939*/ 05492000
*        /* CATALOG AMDSB CONTROL BLOCK.                     @ZA05939*/ 05493000
*        /* ZERO-OUT ANY NON-INITIALIZED ARITHMETIC VALUES   @ZA05939*/ 05494000
*        /* TO INSURE PRINTABILITY.                                  */ 05495000
*        /*                                                          */ 05496000
*        /************************************************************/ 05497000
*                                                                  1363 05498000
*        DARGSENT = LCST21;            /*STATISTICS HEADER           */ 05499000
@RF01210 L     @04,DARGPTR                                         1363 05500000
         MVI   DARGSENT(@04),X'15'                                 1363 05501000
*        CTGFLPTR = DSBFPT;                                        1364 05502000
         L     @00,DSBFPT                                          1364 05503000
         ST    @00,CTGFLPTR                                        1364 05504000
*        DARGDBP = CTGFLPT(1);                                     1365 05505000
         LR    @15,@00                                             1365 05506000
         L     @15,CTGFLPT(,@15)                                   1365 05507000
         ST    @15,DARGDBP(,@04)                                   1365 05508000
*        DARGILP = CTGFLNG(1);                                     1366 05509000
         LR    @15,@00                                             1366 05510000
         L     @00,CTGFLNG(,@15)                                   1366 05511000
         STH   @00,DARGILP(,@04)                                   1366 05512000
*        IF AMDPCTCI = ARITH4FF        /* PERCENT FREE BYTES IN C.I. */ 05513000
*          THEN                                                    1367 05514000
         L     @04,DSBCATPT                                        1367 05515000
         SLR   @00,@00                                             1367 05516000
         IC    @00,AMDPCTCI(,@04)                                  1367 05517000
         CL    @00,ARITH4FF                                        1367 05518000
         BNE   @RF01367                                            1367 05519000
*            AMDPCTCI = 0;                                         1368 05520000
         MVI   AMDPCTCI(@04),X'00'                                 1368 05521000
*        IF AMDPCTCA = ARITH4FF        /* PERCENT FREE C.I. IN C.A.  */ 05522000
*          THEN                                                    1369 05523000
@RF01367 L     @04,DSBCATPT                                        1369 05524000
         SLR   @00,@00                                             1369 05525000
         IC    @00,AMDPCTCA(,@04)                                  1369 05526000
         CL    @00,ARITH4FF                                        1369 05527000
         BNE   @RF01369                                            1369 05528000
*            AMDPCTCA = 0;                                         1370 05529000
         MVI   AMDPCTCA(@04),X'00'                                 1370 05530000
*        IF AMDASPA = ARITH4FF         /* NO. OF FREE BYTES IN D.S.  */ 05531000
*          THEN                                                    1371 05532000
@RF01369 L     @04,DSBCATPT                                        1371 05533000
         CLC   AMDASPA(4,@04),ARITH4FF                             1371 05534000
         BNE   @RF01371                                            1371 05535000
*            AMDASPA = 0;                                          1372 05536000
         SLR   @00,@00                                             1372 05537000
         ST    @00,AMDASPA(,@04)                                   1372 05538000
*        IF AMDNLR = ARITH4FF          /*NO. OF TOTAL RECORDS        */ 05539000
*          THEN                                                    1373 05540000
@RF01371 L     @04,DSBCATPT                                        1373 05541000
         CLC   AMDNLR(4,@04),ARITH4FF                              1373 05542000
         BNE   @RF01373                                            1373 05543000
*            AMDNLR = 0;                                           1374 05544000
         SLR   @00,@00                                             1374 05545000
         ST    @00,AMDNLR(,@04)                                    1374 05546000
*        IF AMDDELR = ARITH4FF         /*NO. OF DELETED RECORDS      */ 05547000
*          THEN                                                    1375 05548000
@RF01373 L     @04,DSBCATPT                                        1375 05549000
         CLC   AMDDELR(4,@04),ARITH4FF                             1375 05550000
         BNE   @RF01375                                            1375 05551000
*            AMDDELR = 0;                                          1376 05552000
         SLR   @00,@00                                             1376 05553000
         ST    @00,AMDDELR(,@04)                                   1376 05554000
*        IF AMDIREC = ARITH4FF         /*NO. OF INSERTED RECORDS     */ 05555000
*          THEN                                                    1377 05556000
@RF01375 L     @04,DSBCATPT                                        1377 05557000
         CLC   AMDIREC(4,@04),ARITH4FF                             1377 05558000
         BNE   @RF01377                                            1377 05559000
*            AMDIREC = 0;                                          1378 05560000
         SLR   @00,@00                                             1378 05561000
         ST    @00,AMDIREC(,@04)                                   1378 05562000
*        IF AMDUPR = ARITH4FF          /*NO. OF UPDATED RECORDS      */ 05563000
*          THEN                                                    1379 05564000
@RF01377 L     @04,DSBCATPT                                        1379 05565000
         CLC   AMDUPR(4,@04),ARITH4FF                              1379 05566000
         BNE   @RF01379                                            1379 05567000
*            AMDUPR = 0;                                           1380 05568000
         SLR   @00,@00                                             1380 05569000
         ST    @00,AMDUPR(,@04)                                    1380 05570000
*        IF AMDRETR = ARITH4FF         /*NO. OF RETRIEVED RECORDS    */ 05571000
*          THEN                                                    1381 05572000
@RF01379 L     @04,DSBCATPT                                        1381 05573000
         CLC   AMDRETR(4,@04),ARITH4FF                             1381 05574000
         BNE   @RF01381                                            1381 05575000
*            AMDRETR = 0;                                          1382 05576000
         SLR   @00,@00                                             1382 05577000
         ST    @00,AMDRETR(,@04)                                   1382 05578000
*        IF AMDNCIS = ARITH4FF         /*NO. OF C.I. SPLITS          */ 05579000
*          THEN                                                    1383 05580000
@RF01381 L     @04,DSBCATPT                                        1383 05581000
         CLC   AMDNCIS(4,@04),ARITH4FF                             1383 05582000
         BNE   @RF01383                                            1383 05583000
*            AMDNCIS = 0;                                          1384 05584000
         SLR   @00,@00                                             1384 05585000
         ST    @00,AMDNCIS(,@04)                                   1384 05586000
*        IF AMDNCAS = ARITH4FF         /*NO. OF C.A. SPLITS          */ 05587000
*          THEN                                                    1385 05588000
@RF01383 L     @04,DSBCATPT                                        1385 05589000
         CLC   AMDNCAS(4,@04),ARITH4FF                             1385 05590000
         BNE   @RF01385                                            1385 05591000
*            AMDNCAS = 0;                                          1386 05592000
         SLR   @00,@00                                             1386 05593000
         ST    @00,AMDNCAS(,@04)                                   1386 05594000
*        IF AMDEXCP = ARITH4FF         /*NO. OF EXCPS                */ 05595000
*          THEN                                                    1387 05596000
@RF01385 L     @04,DSBCATPT                                        1387 05597000
         CLC   AMDEXCP(4,@04),ARITH4FF                             1387 05598000
         BNE   @RF01387                                            1387 05599000
*            AMDEXCP = 0;                                          1388 05600000
         SLR   @00,@00                                             1388 05601000
         ST    @00,AMDEXCP(,@04)                                   1388 05602000
*        IF AMDNEXT = ARITH4FF         /*NO. OF EXTENTS              */ 05603000
*          THEN                                                    1389 05604000
@RF01387 L     @04,DSBCATPT                                        1389 05605000
         LH    @00,AMDNEXT(,@04)                                   1389 05606000
         CL    @00,ARITH4FF                                        1389 05607000
         BNE   @RF01389                                            1389 05608000
*            AMDNEXT = 0;                                          1390 05609000
         SLR   @00,@00                                             1390 05610000
         STH   @00,AMDNEXT(,@04)                                   1390 05611000
*        /************************************************************/ 05612000
*        /*                                                          */ 05613000
*        /* IF AN INDEX ENTRY IS BEING PROCESSED, CONTINUE   @ZA05939*/ 05614000
*        /* BUILDING THE DARGLIST TO PRINT THOSE ADDITIONAL  @ZA05939*/ 05615000
*        /* CATALOG AMDSB STATISTICS WHICH ARE RELEVANT TO   @ZA05939*/ 05616000
*        /* AN INDEX DATASET ONLY.                                   */ 05617000
*        /*                                                          */ 05618000
*        /************************************************************/ 05619000
*                                                                  1391 05620000
*        IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTINDX                   1391 05621000
*          THEN                                                    1391 05622000
@RF01389 L     @04,ETYPFPT                                         1391 05623000
         L     @04,CTGFLPT(,@04)                                   1391 05624000
         CLI   ETYP(@04),C'I'                                      1391 05625000
         BNE   @RF01391                                            1391 05626000
*            DO;                                                   1392 05627000
*              DARGSENT = LCST22;      /*INDEX STATISTICS HEADER     */ 05628000
         L     @04,DARGPTR                                         1393 05629000
         MVI   DARGSENT(@04),X'16'                                 1393 05630000
*              IF AMDNIL = ARITH4FF    /*NO. OF INDEX LEVELS         */ 05631000
*                THEN                                              1394 05632000
         L     @04,DSBCATPT                                        1394 05633000
         LH    @00,AMDNIL(,@04)                                    1394 05634000
         CL    @00,ARITH4FF                                        1394 05635000
         BNE   @RF01394                                            1394 05636000
*                  AMDNIL = 0;                                     1395 05637000
         SLR   @00,@00                                             1395 05638000
         STH   @00,AMDNIL(,@04)                                    1395 05639000
*              IF AMDNEST = ARITH4FF   /*NO. OF ENTRIES IN IX SECTION*/ 05640000
*                THEN                                              1396 05641000
@RF01394 L     @04,DSBCATPT                                        1396 05642000
         LH    @00,AMDNEST(,@04)                                   1396 05643000
         CL    @00,ARITH4FF                                        1396 05644000
         BNE   @RF01396                                            1396 05645000
*                  AMDNEST = 0;                                    1397 05646000
         SLR   @00,@00                                             1397 05647000
         STH   @00,AMDNEST(,@04)                                   1397 05648000
*              IF AMDSSRBA = ARITH4FF  /*RBA OF FIRST SEQ SET REC    */ 05649000
*                THEN                                              1398 05650000
@RF01396 L     @04,DSBCATPT                                        1398 05651000
         CLC   AMDSSRBA(4,@04),ARITH4FF                            1398 05652000
         BNE   @RF01398                                            1398 05653000
*                  AMDSSRBA = 0;                                   1399 05654000
         SLR   @00,@00                                             1399 05655000
         ST    @00,AMDSSRBA(,@04)                                  1399 05656000
*              IF AMDHLRBA = ARITH4FF  /*RBA OF HIGH LEVEL IX REC    */ 05657000
*                THEN                                              1400 05658000
@RF01398 L     @04,DSBCATPT                                        1400 05659000
         CLC   AMDHLRBA(4,@04),ARITH4FF                            1400 05660000
         BNE   @RF01400                                            1400 05661000
*                  AMDHLRBA = 0;                                   1401 05662000
         SLR   @00,@00                                             1401 05663000
         ST    @00,AMDHLRBA(,@04)                                  1401 05664000
*            END;                                                  1402 05665000
*                                                                  1402 05666000
@RF01400 DS    0H                                                  1403 05667000
*        CALL LISTPROC;                                    /*@ZA05939*/ 05668000
@RF01391 BAL   @14,LISTPROC                                        1403 05669000
*        END ALLORNM;                                              1404 05670000
*        /************************************************************/ 05671000
*        /*                                                          */ 05672000
*        /* IF THE LISTC REQUEST IS FOR EITHER ALLOCATION INFORMATION*/ 05673000
*        /* OR ALL THE CATALOG DATA, CONTINUE PROCESSING.            */ 05674000
*        /*                                                          */ 05675000
*        /************************************************************/ 05676000
*                                                                  1405 05677000
*        IF ADDR(FALL) > NULLPTR  |  ADDR(ALLOC) > NULLPTR         1405 05678000
*          THEN                                                    1405 05679000
@RF01104 SLR   @04,@04                                             1405 05680000
         L     @15,@PC00001+4                                      1405 05681000
         C     @04,FDTPTR+56(,@15)                                 1405 05682000
         BL    @RT01405                                            1405 05683000
         C     @04,FDTPTR+64(,@15)                                 1405 05684000
         BNL   @RF01405                                            1405 05685000
@RT01405 DS    0H                                                  1406 05686000
*ALLORSP:    DO;                                                   1406 05687000
ALLORSP  DS    0H                                                  1407 05688000
*        DARGSENT = LCST24;            /*SPACE ALLOCATION HEADERS    */ 05689000
         L     @04,DARGPTR                                         1407 05690000
         MVI   DARGSENT(@04),X'18'                                 1407 05691000
*        CTGFLPTR = DSSPFPT;                                       1408 05692000
         L     @04,DSSPFPT                                         1408 05693000
         ST    @04,CTGFLPTR                                        1408 05694000
*        IF PRIM = ARITH4FF            /* PRIMARY ALLOC              */ 05695000
*          THEN                                                    1409 05696000
         L     @04,CTGFLPT(,@04)                                   1409 05697000
         CLC   PRIM(3,@04),ARITH4FF                                1409 05698000
         BNE   @RF01409                                            1409 05699000
*            PRIM = ZEROAREA;                                      1410 05700000
         MVC   PRIM(3,@04),ZEROAREA                                1410 05701000
*        IF SCON = ARITH4FF            /* SECONDARY ALLOC            */ 05702000
*          THEN                                                    1411 05703000
@RF01409 L     @04,CTGFLPTR                                        1411 05704000
         L     @04,CTGFLPT(,@04)                                   1411 05705000
         CLC   SCON(3,@04),ARITH4FF                                1411 05706000
         BNE   @RF01411                                            1411 05707000
*            SCON = ZEROAREA;                                      1412 05708000
         MVC   SCON(3,@04),ZEROAREA                                1412 05709000
*        DARGDBP = CTGFLPT(1);                                     1413 05710000
@RF01411 L     @04,DARGPTR                                         1413 05711000
         L     @15,CTGFLPTR                                        1413 05712000
         L     @14,CTGFLPT(,@15)                                   1413 05713000
         ST    @14,DARGDBP(,@04)                                   1413 05714000
*        DARGILP = CTGFLNG(1);                                     1414 05715000
         L     @15,CTGFLNG(,@15)                                   1414 05716000
         STH   @15,DARGILP(,@04)                                   1414 05717000
*        DARGCNT = DRGCNT3;                                /*@Y30SSMK*/ 05718000
         MVC   DARGCNT(2,@04),@CH00170                             1415 05719000
*        DARGINS(1) = DRGINS10;                            /*@Y30SSMK*/ 05720000
         LA    @15,10                                              1416 05721000
         STH   @15,DARGINS(,@04)                                   1416 05722000
*        DARGINL(1) = ABBREVLN;                                    1417 05723000
*                                                                  1417 05724000
         STH   @15,DARGINL(,@04)                                   1417 05725000
*        /************************************************************/ 05726000
*        /*                                                          */ 05727000
*        /* INTERPRET THE SPACE OPTION FLAG TO DETERMINE THE TYPE OF */ 05728000
*        /* ALLOCATION REQUEST.  THEN SETUP THE DARGLIST POINTER TO  */ 05729000
*        /* THE CORRESPONDING STATIC TEXT ENTRY.                     */ 05730000
*        /*                                                          */ 05731000
*        /************************************************************/ 05732000
*                                                                  1418 05733000
*        IF SFLG = CANOPTN                                         1418 05734000
*          THEN                                                    1418 05735000
         TM    SFLG(@14),B'11000000'                               1418 05736000
         BNZ   @RF01418                                            1418 05737000
*            DARGDTM(1) = ADDR(CANNM); /* CANDIDATE REQUEST          */ 05738000
         L     @15,TEXTPTR                                         1419 05739000
         LA    @00,CANNM(,@15)                                     1419 05740000
         ST    @00,DARGDTM(,@04)                                   1419 05741000
*          ELSE                                                    1420 05742000
*            IF SFLG = RSZOPTN                                     1420 05743000
*              THEN                                                1420 05744000
         B     @RC01418                                            1420 05745000
@RF01418 L     @04,CTGFLPTR                                        1420 05746000
         L     @04,CTGFLPT(,@04)                                   1420 05747000
         TM    SFLG(@04),B'01000000'                               1420 05748000
         BNO   @RF01420                                            1420 05749000
         TM    SFLG(@04),B'10000000'                               1420 05750000
         BNZ   @RF01420                                            1420 05751000
*                DARGDTM(1) = ADDR(RECSZNM); /* RECORD REQUEST       */ 05752000
         L     @04,TEXTPTR                                         1421 05753000
         LA    @04,RECSZNM(,@04)                                   1421 05754000
         L     @15,DARGPTR                                         1421 05755000
         ST    @04,DARGDTM(,@15)                                   1421 05756000
*              ELSE                                                1422 05757000
*                IF SFLG = TRKOPTN                                 1422 05758000
*                  THEN                                            1422 05759000
         B     @RC01420                                            1422 05760000
@RF01420 L     @04,CTGFLPTR                                        1422 05761000
         L     @04,CTGFLPT(,@04)                                   1422 05762000
         TM    SFLG(@04),B'10000000'                               1422 05763000
         BNO   @RF01422                                            1422 05764000
         TM    SFLG(@04),B'01000000'                               1422 05765000
         BNZ   @RF01422                                            1422 05766000
*                    DARGDTM(1) = ADDR(TRKNM); /* TRACK REQUEST      */ 05767000
         L     @04,TEXTPTR                                         1423 05768000
         LA    @04,TRKNM(,@04)                                     1423 05769000
         L     @15,DARGPTR                                         1423 05770000
         ST    @04,DARGDTM(,@15)                                   1423 05771000
*                  ELSE                                            1424 05772000
*                    IF SFLG = CYLOPTN                             1424 05773000
*                      THEN                                        1424 05774000
         B     @RC01422                                            1424 05775000
@RF01422 L     @04,CTGFLPTR                                        1424 05776000
         L     @04,CTGFLPT(,@04)                                   1424 05777000
         TM    SFLG(@04),B'11000000'                               1424 05778000
         BNO   @RF01424                                            1424 05779000
*                        DARGDTM(1) = ADDR(CYLNM); /*CYLINDER REQUEST*/ 05780000
         L     @04,TEXTPTR                                         1425 05781000
         LA    @04,CYLNM(,@04)                                     1425 05782000
         L     @15,DARGPTR                                         1425 05783000
         ST    @04,DARGDTM(,@15)                                   1425 05784000
*                      ELSE                                        1426 05785000
*                        DARGDTM(1) = ADDR(NULLNM); /*NOT-INITIALIZED*/ 05786000
*                                                                  1426 05787000
         B     @RC01424                                            1426 05788000
@RF01424 L     @04,TEXTPTR                                         1426 05789000
         LA    @04,NULLNM(,@04)                                    1426 05790000
         L     @15,DARGPTR                                         1426 05791000
         ST    @04,DARGDTM(,@15)                                   1426 05792000
*        /************************************************************/ 05793000
*        /*                                                          */ 05794000
*        /* INCLUDE IN THE DARGLIST INSERT STRUCTURES FOR THE        */ 05795000
*        /* DATASET HIGH ALLOCATED AND HIGH USED RBA'S.              */ 05796000
*        /*                                                          */ 05797000
*        /************************************************************/ 05798000
*                                                                  1427 05799000
*        CTGFLPTR = DSHAFPT;                                       1427 05800000
@RC01424 DS    0H                                                  1427 05801000
@RC01422 DS    0H                                                  1427 05802000
@RC01420 DS    0H                                                  1427 05803000
@RC01418 L     @04,DSHAFPT                                         1427 05804000
         ST    @04,CTGFLPTR                                        1427 05805000
*        DARGINS(2) = DRGINS20;                            /*@Y30SSMK*/ 05806000
         L     @15,DARGPTR                                         1428 05807000
         MVC   DARGINS+8(2,@15),@CH00649                           1428 05808000
*        DARGINL(2) = CTGFLNG(1);                                  1429 05809000
         L     @14,CTGFLNG(,@04)                                   1429 05810000
         STH   @14,DARGINL+8(,@15)                                 1429 05811000
*        IF DSHA = ARITH4FF                                        1430 05812000
*          THEN                                                    1430 05813000
         L     @04,CTGFLPT(,@04)                                   1430 05814000
         CLC   DSHA(4,@04),ARITH4FF                                1430 05815000
         BNE   @RF01430                                            1430 05816000
*            DSHA = ZEROAREA;                                      1431 05817000
         MVC   DSHA(4,@04),ZEROAREA                                1431 05818000
*        DARGDTM(2) = CTGFLPT(1);                                  1432 05819000
@RF01430 L     @04,DARGPTR                                         1432 05820000
         L     @15,CTGFLPTR                                        1432 05821000
         L     @00,CTGFLPT(,@15)                                   1432 05822000
         ST    @00,DARGDTM+8(,@04)                                 1432 05823000
*        CTGFLPTR = DSHUFPT;                                       1433 05824000
         L     @00,DSHUFPT                                         1433 05825000
         ST    @00,CTGFLPTR                                        1433 05826000
*        DARGINS(3) = DRGINS30;                            /*@Y30SSMK*/ 05827000
         MVC   DARGINS+16(2,@04),@CH01231                          1434 05828000
*        DARGINL(3) = CTGFLNG(1);                                  1435 05829000
         LR    @15,@00                                             1435 05830000
         L     @15,CTGFLNG(,@15)                                   1435 05831000
         STH   @15,DARGINL+16(,@04)                                1435 05832000
*        IF DSHU = ARITH4FF                                        1436 05833000
*          THEN                                                    1436 05834000
         LR    @04,@00                                             1436 05835000
         L     @04,CTGFLPT(,@04)                                   1436 05836000
         CLC   DSHU(4,@04),ARITH4FF                                1436 05837000
         BNE   @RF01436                                            1436 05838000
*            DSHU = ZEROAREA;                                      1437 05839000
         MVC   DSHU(4,@04),ZEROAREA                                1437 05840000
*        DARGDTM(3) = CTGFLPT(1);                                  1438 05841000
@RF01436 L     @04,CTGFLPTR                                        1438 05842000
         L     @04,CTGFLPT(,@04)                                   1438 05843000
         L     @15,DARGPTR                                         1438 05844000
         ST    @04,DARGDTM+16(,@15)                                1438 05845000
*        CALL LISTPROC;                                            1439 05846000
         BAL   @14,LISTPROC                                        1439 05847000
*        /************************************************************/ 05848000
*        /*                                                          */ 05849000
*        /* NEXT PROCESS THE ALLOCATION INFORMATION COVERING VOLUME  */ 05850000
*        /* CHARACTERISTICS.  THIS VOLUME OCCURRENCE DATA MAY BE     */ 05851000
*        /* REPETITIVE.  THE FORMAT OF ONE VOLUME OCCURRENCE IS A    */ 05852000
*        /* COMBINATION OF FIXED FIELDS FOLLOWED BY VARIABLE LENGTH  */ 05853000
*        /* KEYS AND EXTENT DATA, EACH PRECEDED BY A LENGTH          */ 05854000
*        /* DESCRIPTOR.  THEREFORE, A SEPARATE POINTER AND LENGTH    */ 05855000
*        /* VARIABLE ARE USED TO TRACK THE FIELDS AS THEY ARE        */ 05856000
*        /* PROCESSED.                                               */ 05857000
*        /* IF AT LEAST ONE OCCURRENCE OF THE FIXED FIELDS WAS       */ 05858000
*        /* RETURNED IN THE WORKAREA, BEGIN THE VOLUME ALLOCATION    */ 05859000
*        /* PROCESSING.                                              */ 05860000
*        /*                                                          */ 05861000
*        /************************************************************/ 05862000
*                                                                  1440 05863000
*        CTGFLPTR = DSVLFPT;                                       1440 05864000
         L     @06,DSVLFPT                                         1440 05865000
         ST    @06,CTGFLPTR                                        1440 05866000
*        PGPTR=PGBYTFPT->CTGFLPT(1);                       /*@ZA05939*/ 05867000
*                                                                  1441 05868000
         L     @04,PGBYTFPT                                        1441 05869000
         L     PGPTR,CTGFLPT(,@04)                                 1441 05870000
*        /************************************************************/ 05871000
*        /*                                                  @ZA05939*/ 05872000
*        /* START PROCESSING THE VOLUME ALLOCATION.          @ZA05939*/ 05873000
*        /*                                                  @ZA05939*/ 05874000
*        /************************************************************/ 05875000
*                                                                  1442 05876000
*ENTVLOOP:                                                         1442 05877000
*        DO WHILE CTGFLNG(1) >= LENGTH(FIXFLDS);                   1442 05878000
*                                                                  1442 05879000
ENTVLOOP B     @DE01442                                            1442 05880000
@DL01442 DS    0H                                                  1443 05881000
*          DARGSENT = LCST25;          /*VOL OCCURRENCES HEADER      */ 05882000
         L     @06,DARGPTR                                         1443 05883000
         MVI   DARGSENT(@06),X'19'                                 1443 05884000
*          DARGDBP = CTGFLPT(1);                                   1444 05885000
         L     @04,CTGFLPTR                                        1444 05886000
         L     @15,CTGFLPT(,@04)                                   1444 05887000
         ST    @15,DARGDBP(,@06)                                   1444 05888000
*          DARGILP = CTGFLNG(1);                                   1445 05889000
         L     @04,CTGFLNG(,@04)                                   1445 05890000
         STH   @04,DARGILP(,@06)                                   1445 05891000
*          IF VEXT = ARITH4FF          /* NUMBER OF EXTENTS          */ 05892000
*            THEN                                                  1446 05893000
         CLC   VEXT(1,@15),ARITH4FF                                1446 05894000
         BNE   @RF01446                                            1446 05895000
*              VEXT = ZEROAREA;                                    1447 05896000
         MVC   VEXT(1,@15),ZEROAREA                                1447 05897000
*          IF VHA = ARITH4FF           /* HIGH ALLOCATED RBA         */ 05898000
*            THEN                                                  1448 05899000
@RF01446 L     @06,CTGFLPTR                                        1448 05900000
         L     @06,CTGFLPT(,@06)                                   1448 05901000
         CLC   VHA(4,@06),ARITH4FF                                 1448 05902000
         BNE   @RF01448                                            1448 05903000
*              VHA = ZEROAREA;                                     1449 05904000
         MVC   VHA(4,@06),ZEROAREA                                 1449 05905000
*          IF VHU = ARITH4FF           /*HIGH USED RBA               */ 05906000
*            THEN                                                  1450 05907000
@RF01448 L     @06,CTGFLPTR                                        1450 05908000
         L     @06,CTGFLPT(,@06)                                   1450 05909000
         CLC   VHU(4,@06),ARITH4FF                                 1450 05910000
         BNE   @RF01450                                            1450 05911000
*              VHU = ZEROAREA;                                     1451 05912000
         MVC   VHU(4,@06),ZEROAREA                                 1451 05913000
*          IF BLK = ARITH4FF           /* PHYSICAL RECORD SIZE       */ 05914000
*            THEN                                                  1452 05915000
@RF01450 L     @06,CTGFLPTR                                        1452 05916000
         L     @06,CTGFLPT(,@06)                                   1452 05917000
         CLC   BLK(4,@06),ARITH4FF                                 1452 05918000
         BNE   @RF01452                                            1452 05919000
*              BLK = ZEROAREA;                                     1453 05920000
         MVC   BLK(4,@06),ZEROAREA                                 1453 05921000
*          IF BPT = ARITH4FF           /* PHYRECS PER TRACK          */ 05922000
*            THEN                                                  1454 05923000
@RF01452 L     @06,CTGFLPTR                                        1454 05924000
         L     @06,CTGFLPT(,@06)                                   1454 05925000
         CLC   BPT(2,@06),ARITH4FF                                 1454 05926000
         BNE   @RF01454                                            1454 05927000
*              BPT = ARITH4FF;                                     1455 05928000
         MVC   BPT(2,@06),ARITH4FF                                 1455 05929000
*          IF TPCA = ARITH4FF          /* TRACKS PER C.A.            */ 05930000
*            THEN                                                  1456 05931000
@RF01454 L     @06,CTGFLPTR                                        1456 05932000
         L     @06,CTGFLPT(,@06)                                   1456 05933000
         CLC   TPCA(2,@06),ARITH4FF                                1456 05934000
         BNE   @RF01456                                            1456 05935000
*              TPCA = ZEROAREA;                                    1457 05936000
         MVC   TPCA(2,@06),ZEROAREA                                1457 05937000
*          DARGCNT = DRGCNT1;                              /*@Y30SSMK*/ 05938000
@RF01456 L     @06,DARGPTR                                         1458 05939000
         MVC   DARGCNT(2,@06),@CH00045                             1458 05940000
*          DARGINS(1) = DRGINS10;                          /*@Y30SSMK*/ 05941000
         LA    @04,10                                              1459 05942000
         STH   @04,DARGINS(,@06)                                   1459 05943000
*          DARGINL(1) = ABBREVLN;                                  1460 05944000
*                                                                  1460 05945000
         STH   @04,DARGINL(,@06)                                   1460 05946000
*          /**********************************************************/ 05947000
*          /*                                                        */ 05948000
*          /* INTERPRET THE VOLUME FLAG AND INCLUDE IN THE DARGLIST  */ 05949000
*          /* THE POINTER TO THE CORRESPONDING STATIC TEXT ENTRY.    */ 05950000
*          /*                                                        */ 05951000
*          /**********************************************************/ 05952000
*                                                                  1461 05953000
*          IF VPRIM = ON                                           1461 05954000
*            THEN                                                  1461 05955000
         L     @04,CTGFLPTR                                        1461 05956000
         L     @04,CTGFLPT(,@04)                                   1461 05957000
         TM    VPRIM(@04),B'10000000'                              1461 05958000
         BNO   @RF01461                                            1461 05959000
*              DARGDTM(1) = ADDR(PRIMENM); /* PRIME                  */ 05960000
         L     @04,TEXTPTR                                         1462 05961000
         ST    @04,DARGDTM(,@06)                                   1462 05962000
*            ELSE                                                  1463 05963000
*              IF VCAN = ON                                        1463 05964000
*                THEN                                              1463 05965000
         B     @RC01461                                            1463 05966000
@RF01461 L     @06,CTGFLPTR                                        1463 05967000
         L     @06,CTGFLPT(,@06)                                   1463 05968000
         TM    VCAN(@06),B'01000000'                               1463 05969000
         BNO   @RF01463                                            1463 05970000
*                  DARGDTM(1) = ADDR(CANNM); /* CANDIDATE            */ 05971000
         L     @06,TEXTPTR                                         1464 05972000
         LA    @06,CANNM(,@06)                                     1464 05973000
         L     @04,DARGPTR                                         1464 05974000
         ST    @06,DARGDTM(,@04)                                   1464 05975000
*                ELSE                                              1465 05976000
*                  IF VOVFL = ON                                   1465 05977000
*                    THEN                                          1465 05978000
         B     @RC01463                                            1465 05979000
@RF01463 L     @06,CTGFLPTR                                        1465 05980000
         L     @06,CTGFLPT(,@06)                                   1465 05981000
         TM    VOVFL(@06),B'00100000'                              1465 05982000
         BNO   @RF01465                                            1465 05983000
*                      DARGDTM(1) = ADDR(OVFLONM); /* OVERFLOW       */ 05984000
         L     @06,TEXTPTR                                         1466 05985000
         LA    @06,OVFLONM(,@06)                                   1466 05986000
         L     @04,DARGPTR                                         1466 05987000
         ST    @06,DARGDTM(,@04)                                   1466 05988000
*                    ELSE                                          1467 05989000
*                      DARGDTM(1) = ADDR(NULLNM); /* NOT-INITIALIZED */ 05990000
         B     @RC01465                                            1467 05991000
@RF01465 L     @06,TEXTPTR                                         1467 05992000
         LA    @06,NULLNM(,@06)                                    1467 05993000
         L     @04,DARGPTR                                         1467 05994000
         ST    @06,DARGDTM(,@04)                                   1467 05995000
*          CALL LISTPROC;                                          1468 05996000
*                                                                  1468 05997000
@RC01465 DS    0H                                                  1468 05998000
@RC01463 DS    0H                                                  1468 05999000
@RC01461 BAL   @14,LISTPROC                                        1468 06000000
*        /************************************************************/ 06001000
*        /*                                                  @YL026UE*/ 06002000
*        /* OUTPUT THE NO. OF BYTES/TRACK FOR A PAGESPACE DATA ENTRY */ 06003000
*        /*                                                  @YL026UE*/ 06004000
*        /************************************************************/ 06005000
*                                                                  1469 06006000
*        IF PGSPCFLG = ON &           /* IF PAGE SPACE AND   @ZA13553*/ 06007000
*        CATTRFPT -> CTGFLPT(1) -> PGSWAP=OFF /* NOT SWAP    @ZA13553*/ 06008000
*          THEN                                                    1469 06009000
         TM    PGSPCFLG,B'10000000'                                1469 06010000
         BNO   @RF01469                                            1469 06011000
         L     @06,CATTRFPT                                        1469 06012000
         L     @06,CTGFLPT(,@06)                                   1469 06013000
         TM    PGSWAP(@06),B'00000010'                             1469 06014000
         BNZ   @RF01469                                            1469 06015000
*            DO;                                           /*@YL026UE*/ 06016000
*            DARGSENT = LCST46;                            /*@YL026UE*/ 06017000
         L     @06,DARGPTR                                         1471 06018000
         MVI   DARGSENT(@06),X'2E'                                 1471 06019000
*            DARGDBP = PGPTR;                              /*@YL026UE*/ 06020000
         ST    PGPTR,DARGDBP(,@06)                                 1472 06021000
*            DARGILP = LENGTH(PGBYTTRK);                   /*@YL026UE*/ 06022000
         MVC   DARGILP(2,@06),@CH00050                             1473 06023000
*            CALL LISTPROC;                                /*@YL026UE*/ 06024000
         BAL   @14,LISTPROC                                        1474 06025000
*            PGPTR = PGPTR + LENGTH(PGBYTTRK);             /*@YL026UE*/ 06026000
         AL    PGPTR,@CF00050                                      1475 06027000
*            END;                                          /*@YL026UE*/ 06028000
*          /**********************************************************/ 06029000
*          /*                                                        */ 06030000
*          /* PROCESS THE FIRST VARIABLE-LENGTH FIELD IN THE VOLUME  */ 06031000
*          /* OCCURRENCE DATA.  INITIALIZE THE CURRENT LENGTH VALUE  */ 06032000
*          /* TO THE LENGTH OF THE FIXED FIELDS JUST PROCESSED.      */ 06033000
*          /* USE THIS VALUE TO UPDATE THE CURRENT POINTER TO THE    */ 06034000
*          /* FIRST VARIABLE LENGTH FIELD.                           */ 06035000
*          /*                                                        */ 06036000
*          /**********************************************************/ 06037000
*                                                                  1477 06038000
*          CURRLEN = LENGTH(FIXFLDS);                              1477 06039000
@RF01469 LA    CURRLEN,39                                          1477 06040000
*          CVARPTR = CTGFLPT(1) + CURRLEN;                         1478 06041000
         LR    CVARPTR,CURRLEN                                     1478 06042000
         L     @06,CTGFLPTR                                        1478 06043000
         AL    CVARPTR,CTGFLPT(,@06)                               1478 06044000
*          RESPECIFY VLOWKEY BASED(CVARPTR);                       1479 06045000
*                                                                  1479 06046000
*          /**********************************************************/ 06047000
*          /*                                                        */ 06048000
*          /* IF A LOW KEY EXISTS, BUILD THE DARGLIST TO PRINT IT.   */ 06049000
*          /* AND UPDATE THE PROCESSED-DATA LENGTH BY THE SIZE       */ 06050000
*          /* OF THE KEY PLUS THE SIZE OF ITS LENGTH DESCRIPTOR.     */ 06051000
*          /*                                                        */ 06052000
*          /**********************************************************/ 06053000
*                                                                  1480 06054000
*          IF VLKYLEN > 0                                          1480 06055000
*            THEN                                                  1480 06056000
         SLR   @06,@06                                             1480 06057000
         ICM   @06,3,VLKYLEN(CVARPTR)                              1480 06058000
         LTR   @06,@06                                             1480 06059000
         BNP   @RF01480                                            1480 06060000
*              DO;                                                 1481 06061000
*                CURRLEN = CURRLEN + VLKYLEN + LENGTH(VLKYLEN);    1482 06062000
         LR    @04,CURRLEN                                         1482 06063000
         ALR   @04,@06                                             1482 06064000
         AL    @04,@CF00161                                        1482 06065000
         LR    CURRLEN,@04                                         1482 06066000
*                DARGSENT = LCST26;                                1483 06067000
         L     @04,DARGPTR                                         1483 06068000
         MVI   DARGSENT(@04),X'1A'                                 1483 06069000
*                DARGDBP = ADDR(VLKY);                             1484 06070000
         LA    @00,VLKY(,CVARPTR)                                  1484 06071000
         ST    @00,DARGDBP(,@04)                                   1484 06072000
*                DARGILP = VLKYLEN;                                1485 06073000
         STH   @06,DARGILP(,@04)                                   1485 06074000
*                CALL LISTPROC;                                    1486 06075000
         BAL   @14,LISTPROC                                        1486 06076000
*              END;                                                1487 06077000
*            ELSE                                                  1488 06078000
*                                                                  1488 06079000
*              /******************************************************/ 06080000
*              /*                                                    */ 06081000
*              /* NO LOW KEY TO PRINT.  UPDATE THE PROCESSED-DATA    */ 06082000
*              /* LENGTH BY THE SIZE OF THE LOW KEY LENGTH           */ 06083000
*              /* DESCRIPTOR.                                        */ 06084000
*              /*                                                    */ 06085000
*              /******************************************************/ 06086000
*                                                                  1488 06087000
*              CURRLEN = CURRLEN + LENGTH(VLKYLEN);                1488 06088000
         B     @RC01480                                            1488 06089000
@RF01480 AL    CURRLEN,@CF00161                                    1488 06090000
*          /**********************************************************/ 06091000
*          /*                                                        */ 06092000
*          /* PROCESS THE HIGH KEY, THE NEXT VARIABLE-LENGTH FIELD   */ 06093000
*          /* IN THE VOLUME OCCURRENCE DATA.                         */ 06094000
*          /*                                                        */ 06095000
*          /**********************************************************/ 06096000
*                                                                  1489 06097000
*          CVARPTR = CTGFLPT(1) + CURRLEN;                         1489 06098000
@RC01480 LR    CVARPTR,CURRLEN                                     1489 06099000
         L     @06,CTGFLPTR                                        1489 06100000
         AL    CVARPTR,CTGFLPT(,@06)                               1489 06101000
*          RESPECIFY VHIKEY BASED(CVARPTR);                        1490 06102000
*          IF VHKYLEN > 0                                          1491 06103000
*            THEN                                                  1491 06104000
         SLR   @06,@06                                             1491 06105000
         ICM   @06,3,VHKYLEN(CVARPTR)                              1491 06106000
         LTR   @06,@06                                             1491 06107000
         BNP   @RF01491                                            1491 06108000
*              DO;                                                 1492 06109000
*                CURRLEN = CURRLEN + VHKYLEN + LENGTH(VHKYLEN);    1493 06110000
         LR    @04,CURRLEN                                         1493 06111000
         ALR   @04,@06                                             1493 06112000
         AL    @04,@CF00161                                        1493 06113000
         LR    CURRLEN,@04                                         1493 06114000
*                DARGSENT = LCST27;                                1494 06115000
         L     @04,DARGPTR                                         1494 06116000
         MVI   DARGSENT(@04),X'1B'                                 1494 06117000
*                DARGDBP = ADDR(VHKY);                             1495 06118000
         LA    @00,VHKY(,CVARPTR)                                  1495 06119000
         ST    @00,DARGDBP(,@04)                                   1495 06120000
*                DARGILP = VHKYLEN;                                1496 06121000
         STH   @06,DARGILP(,@04)                                   1496 06122000
*                CALL LISTPROC;                                    1497 06123000
*                                                                  1497 06124000
         BAL   @14,LISTPROC                                        1497 06125000
*                /****************************************************/ 06126000
*                /*                                                  */ 06127000
*                /* WHEN A HIGH KEY EXISTS AND THE ENTRY BEING       */ 06128000
*                /* PROCESSED IS TYPE DATA, PRINT THE RBA OF THE     */ 06129000
*                /* CONTROL INTERVAL CONTAINING THE HIGH KEY.        */ 06130000
*                /* NOTE - THIS IS A FIXED FIELD THAT PRECEDES ALL   */ 06131000
*                /* VARIALBE LENGTH DATA AND IS NOT INCLUDED IN THE  */ 06132000
*                /* CURRENT POINTER AND LENGTH UPDATES.              */ 06133000
*                /*                                                  */ 06134000
*                /****************************************************/ 06135000
*                                                                  1498 06136000
*                IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA  &        1498 06137000
*                  VHKR ^= ARITH4FF                                1498 06138000
*                  THEN                                            1498 06139000
         L     @06,ETYPFPT                                         1498 06140000
         L     @06,CTGFLPT(,@06)                                   1498 06141000
         CLI   ETYP(@06),C'D'                                      1498 06142000
         BNE   @RF01498                                            1498 06143000
         L     @06,CTGFLPTR                                        1498 06144000
         L     @06,CTGFLPT(,@06)                                   1498 06145000
         CLC   VHKR(4,@06),ARITH4FF                                1498 06146000
         BE    @RF01498                                            1498 06147000
*                    DO;                                           1499 06148000
*                    DARGSENT = LCST28;                            1500 06149000
         L     @04,DARGPTR                                         1500 06150000
         MVI   DARGSENT(@04),X'1C'                                 1500 06151000
*                    DARGDBP = ADDR(VHKR);                         1501 06152000
         LA    @06,VHKR(,@06)                                      1501 06153000
         ST    @06,DARGDBP(,@04)                                   1501 06154000
*                    DARGILP = LENGTH(VHKR);                       1502 06155000
         MVC   DARGILP(2,@04),@CH00050                             1502 06156000
*                    CALL LISTPROC;                                1503 06157000
         BAL   @14,LISTPROC                                        1503 06158000
*                    END;                                          1504 06159000
*              END;                                                1505 06160000
*            ELSE                                                  1506 06161000
*              CURRLEN = CURRLEN + LENGTH(VHKYLEN);                1506 06162000
         B     @RC01491                                            1506 06163000
@RF01491 AL    CURRLEN,@CF00161                                    1506 06164000
*          /**********************************************************/ 06165000
*          /*                                                        */ 06166000
*          /* PROCESS THE LAST VARIABLE-LENGTH FIELD COVERING        */ 06167000
*          /* PHYSICAL AND LOGICAL EXTENT INFORMATION.               */ 06168000
*          /*                                                        */ 06169000
*          /**********************************************************/ 06170000
*                                                                  1507 06171000
*          CVARPTR = CTGFLPT(1) + CURRLEN;                         1507 06172000
@RC01491 LR    CVARPTR,CURRLEN                                     1507 06173000
         L     @06,CTGFLPTR                                        1507 06174000
         AL    CVARPTR,CTGFLPT(,@06)                               1507 06175000
*          RESPECIFY CCHHS BASED(CVARPTR);                         1508 06176000
*          IF CCHHLEN >= LENGTH(CCHH)                              1509 06177000
*            THEN                                                  1509 06178000
         LA    @06,20                                              1509 06179000
         SLR   @04,@04                                             1509 06180000
         ICM   @04,3,CCHHLEN(CVARPTR)                              1509 06181000
         CR    @04,@06                                             1509 06182000
         BL    @RF01509                                            1509 06183000
*              DO;                                                 1510 06184000
*                CURRLEN = CURRLEN + CCHHLEN + LENGTH(CCHHLEN);    1511 06185000
         LR    @00,CURRLEN                                         1511 06186000
         ALR   @00,@04                                             1511 06187000
         AL    @00,@CF00161                                        1511 06188000
         LR    CURRLEN,@00                                         1511 06189000
*                DARGSENT = LCST29;    /*EXTENT STATISTICS HEADER    */ 06190000
         L     @15,DARGPTR                                         1512 06191000
         MVI   DARGSENT(@15),X'1D'                                 1512 06192000
*                DARGDBP = ADDR(CCHH);                             1513 06193000
         LA    @14,CCHH(,CVARPTR)                                  1513 06194000
         ST    @14,DARGDBP(,@15)                                   1513 06195000
*                DARGILP = CCHHLEN;                                1514 06196000
         STH   @04,DARGILP(,@15)                                   1514 06197000
*                DARGCNT = DRGCNT1;                        /*@Y30SSMK*/ 06198000
*                                                                  1515 06199000
         LA    @14,1                                               1515 06200000
         STH   @14,DARGCNT(,@15)                                   1515 06201000
*                /****************************************************/ 06202000
*                /*                                                  */ 06203000
*                /* BECASUE THE EXTENT INFORMATION IS REPLICATED IN  */ 06204000
*                /* A CONTIGUOUS AREA, THE TEXT PROCESSOR REPLICATION*/ 06205000
*                /* FEATURE IS USED TO FORMAT AND PRINT THE EXTENT   */ 06206000
*                /* FIELDS IN A REPETITIVE MANNER.                   */ 06207000
*                /*                                                  */ 06208000
*                /****************************************************/ 06209000
*                                                                  1516 06210000
*                DARGREP(1) = DRGREP10;                    /*@Y30SSMK*/ 06211000
         MVC   DARGREP(2,@15),@CH00457                             1516 06212000
*                DARGPCT(1) = CCHHLEN/LENGTH(CCHH);                1517 06213000
         LR    @01,@04                                             1517 06214000
         SLR   @00,@00                                             1517 06215000
         DR    @00,@06                                             1517 06216000
         STH   @01,DARGPCT(,@15)                                   1517 06217000
*                DARGDTM(1) = 0;                                   1518 06218000
*                                                                  1518 06219000
         SLR   @06,@06                                             1518 06220000
         ST    @06,DARGDTM(,@15)                                   1518 06221000
*                /****************************************************/ 06222000
*                /*                                                  */ 06223000
*                /* ZERO-OUT ANY NON-INITIALIZED ARITHMETIC FIELDS   */ 06224000
*                /* BEFORE PRINTING TO INSURE PRINTABILITY.          */ 06225000
*                /*                                                  */ 06226000
*                /****************************************************/ 06227000
*                                                                  1519 06228000
*                DO CKK = 1 TO DARGPCT(1);                         1519 06229000
         LR    CKK,@14                                             1519 06230000
         B     @DE01519                                            1519 06231000
@DL01519 DS    0H                                                  1520 06232000
*                  IF TT(CKK) = ARITH4FF                           1520 06233000
*                    THEN                                          1520 06234000
         LR    @04,CKK                                             1520 06235000
         MH    @04,@CH00649                                        1520 06236000
         ST    @04,@TF00001                                        1520 06237000
         ALR   @04,CVARPTR                                         1520 06238000
         AL    @04,@CF01761                                        1520 06239000
         CLC   TT-12(2,@04),ARITH4FF                               1520 06240000
         BNE   @RF01520                                            1520 06241000
*                      TT(CKK) = ZEROAREA;                         1521 06242000
         LR    @04,CVARPTR                                         1521 06243000
         AL    @04,@TF00001                                        1521 06244000
         AL    @04,@CF01761                                        1521 06245000
         MVC   TT-12(2,@04),ZEROAREA                               1521 06246000
*                  IF DDDD1(CKK) = ARITH4FF                        1522 06247000
*                    THEN                                          1522 06248000
@RF01520 LR    @04,CKK                                             1522 06249000
         MH    @04,@CH00649                                        1522 06250000
         ST    @04,@TF00001                                        1522 06251000
         ALR   @04,CVARPTR                                         1522 06252000
         AL    @04,@CF01762                                        1522 06253000
         CLC   DDDD1-14(4,@04),ARITH4FF                            1522 06254000
         BNE   @RF01522                                            1522 06255000
*                      DDDD1(CKK) = ZEROAREA;                      1523 06256000
         LR    @04,CVARPTR                                         1523 06257000
         AL    @04,@TF00001                                        1523 06258000
         AL    @04,@CF01762                                        1523 06259000
         MVC   DDDD1-14(4,@04),ZEROAREA                            1523 06260000
*                  IF DDDD2(CKK) = ARITH4FF                        1524 06261000
*                    THEN                                          1524 06262000
@RF01522 LR    @04,CKK                                             1524 06263000
         MH    @04,@CH00649                                        1524 06264000
         ST    @04,@TF00001                                        1524 06265000
         ALR   @04,CVARPTR                                         1524 06266000
         BCTR  @04,0                                               1524 06267000
         BCTR  @04,0                                               1524 06268000
         CLC   DDDD2-18(4,@04),ARITH4FF                            1524 06269000
         BNE   @RF01524                                            1524 06270000
*                      DDDD2(CKK) = ZEROAREA;                      1525 06271000
         LR    @04,CVARPTR                                         1525 06272000
         AL    @04,@TF00001                                        1525 06273000
         BCTR  @04,0                                               1525 06274000
         BCTR  @04,0                                               1525 06275000
         MVC   DDDD2-18(4,@04),ZEROAREA                            1525 06276000
*                END;                                              1526 06277000
@RF01524 AL    CKK,@CF00045                                        1526 06278000
@DE01519 L     @04,DARGPTR                                         1526 06279000
         CH    CKK,DARGPCT(,@04)                                   1526 06280000
         BNH   @DL01519                                            1526 06281000
*                CALL LISTPROC;                                    1527 06282000
         BAL   @14,LISTPROC                                        1527 06283000
*              END;                                                1528 06284000
*            ELSE                                                  1529 06285000
*              CURRLEN = CURRLEN + LENGTH(CCHHLEN);                1529 06286000
         B     @RC01509                                            1529 06287000
@RF01509 AL    CURRLEN,@CF00161                                    1529 06288000
*          /**********************************************************/ 06289000
*          /*                                                        */ 06290000
*          /* ONE VOLUME OCCURRENCE HAS BEEN PROCESSED.  UPDATE THE  */ 06291000
*          /* FPL POINTER TO THE NEXT OCCURRENCE IN THE WORKAREA.    */ 06292000
*          /* AND DECREMENT THE FPL LENGTH BY THE AMOUNT OF DATA     */ 06293000
*          /* JUST PROCESSED.  UPON THE NEXT PASS THROUGH THE VOLUME */ 06294000
*          /* ALLOCATION INFORMATION, THIS FPL LENGTH WILL BE CHECKED*/ 06295000
*          /* TO ASSURE THAT THE NEXT VOLUME OCCURRENCE CONTAINS AT  */ 06296000
*          /* LEAST ALL FIXED-FIELD DATA FOR PROCESSING.             */ 06297000
*          /*                                                        */ 06298000
*          /**********************************************************/ 06299000
*                                                                  1530 06300000
*          CTGFLPT(1) = CTGFLPT(1) + CURRLEN;                      1530 06301000
@RC01509 L     @06,CTGFLPTR                                        1530 06302000
         LR    @04,CURRLEN                                         1530 06303000
         AL    @04,CTGFLPT(,@06)                                   1530 06304000
         ST    @04,CTGFLPT(,@06)                                   1530 06305000
*          CTGFLNG(1) = CTGFLNG(1) - CURRLEN;                      1531 06306000
         L     @04,CTGFLNG(,@06)                                   1531 06307000
         SLR   @04,CURRLEN                                         1531 06308000
         ST    @04,CTGFLNG(,@06)                                   1531 06309000
*        END ENTVLOOP;                                             1532 06310000
@DE01442 L     @06,CTGFLPTR                                        1532 06311000
         L     @06,CTGFLNG(,@06)                                   1532 06312000
         C     @06,@CF01247                                        1532 06313000
         BNL   @DL01442                                            1532 06314000
*        END ALLORSP;                                              1533 06315000
*        /************************************************************/ 06316000
*        /*                                                          */ 06317000
*        /* PROCESSING OF A DATA OR INDEX ENTRY IS COMPLETED.        */ 06318000
*        /* EXIT FROM THE CLUSTER/DATA/INDEX FORMATTING ROUTINE.     */ 06319000
*        /* RETURN TO THE ROUTING PROCEDURE.                         */ 06320000
*        /*                                                          */ 06321000
*        /************************************************************/ 06322000
*                                                                  1534 06323000
*        RETURN CODE(0);                                           1534 06324000
@RF01405 SLR   @15,@15                                             1534 06325000
         L     @13,4(,@13)                                         1534 06326000
         L     @14,12(,@13)                                        1534 06327000
         LM    @00,@12,20(@13)                                     1534 06328000
         BR    @14                                                 1534 06329000
*        END CDIPROC;                                              1535 06330000
*        /************************************************************/ 06331000
*        /*                                                          */ 06332000
*        /* PROCEDURE - VPROC                                        */ 06333000
*        /*                                                          */ 06334000
*        /* FUNCTION - REPETITIVELY BUILDS THE AMS TEXT PROCESSOR    */ 06335000
*        /*            DYNAMIC DATA ARGUMENT LIST FOR FORMATTING AND */ 06336000
*        /*            LISTING THE VSAM CATALOG FIELDS FOR A VOLUME  */ 06337000
*        /*            RECORD ENTRY.  LISTPROC IS REPEATEDLY INVOKED */ 06338000
*        /*            TO PRINT THE DATA.                            */ 06339000
*        /*                                                          */ 06340000
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM CATALOG DATA    */ 06341000
*        /*         RETRIEVED VIA A LOCATE REQUEST, THE VSAM CPL     */ 06342000
*        /*         AND FPL'S AND THE AMS GDT AND FDT                */ 06343000
*        /*         AND FROM STATIC TEXT                             */ 06344000
*        /*         THE PRE-FORMATTED DESCRIPTORS FOR EDITING THE    */ 06345000
*        /*         CATALOG DATA.                                    */ 06346000
*        /*                                                          */ 06347000
*        /************************************************************/ 06348000
*                                                                  1536 06349000
*VPROC:  PROCEDURE OPTIONS(SAVEAREA);                      /*@ZA05939*/ 06350000
*                                                                  1536 06351000
VPROC    STM   @14,@12,12(@13)                                     1536 06352000
         ST    @13,@SA00008+4                                      1536 06353000
         LA    @14,@SA00008                                        1536 06354000
         ST    @14,8(,@13)                                         1536 06355000
         LR    @13,@14                                             1536 06356000
*        GEN(ENTRY VPROC);             /*EXT ENTRY POINT     @ZA05939*/ 06357000
         ENTRY VPROC                                                    06358000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 06359000
*                                                                  1538 06360000
         LM    REG8,REG12,BASESAVE                                 1538 06361000
*        /************************************************************/ 06362000
*        /*                                                          */ 06363000
*        /* LOCAL VARIABLES                                          */ 06364000
*        /*                                                          */ 06365000
*        /************************************************************/ 06366000
*                                                                  1539 06367000
*        DCL VHDRLEN   FIXED(31);      /*LEN OF REPEATING DSP INFO   */ 06368000
*        DCL VXDESLEN  FIXED(31);      /*LEN OF REPEATING EXTENT INFO*/ 06369000
*        DCL VDIRLEN   FIXED(31);      /*LEN OF REPEATING DS INFO    */ 06370000
*        DCL VWKA      FIXED(31);      /*FOR LENGTH CALCULATIONS     */ 06371000
*        DCL VSER#LEN  FIXED(8) CONSTANT(6); /*VOL SUBSET INFO       */ 06372000
*        DCL VXTITLSW  BIT(1);         /*CONTROLS EXTENT TITLE O/P   */ 06373000
*        DCL VDSHDRSW  BIT(1);         /*CONTROLS DS DIRECT TITLE O/P*/ 06374000
*        DCL VMM       FIXED(15);      /*DO GROUP CONTROL VARIABLE   */ 06375000
*        DCL VDSFPL    CHAR(*) BASED;  /*OVERLAY OF ENTRYNAME FPL    */ 06376000
*        /************************************************************/ 06377000
*        /*                                                          */ 06378000
*        /* LIST THE ENTRYNAME AND TYPE.  EXIT IF NAME OR HISTORY    */ 06379000
*        /* SUBSET WAS REQUESTED.                            @Y30LSMK*/ 06380000
*        /* IF THE PROPER PASSWORD WAS NOT PROVIDED, PICK UP THE     */ 06381000
*        /* ENTRY NAME FROM THE WORK AREA.                   @Y30LSMK*/ 06382000
*        /*                                                          */ 06383000
*        /************************************************************/ 06384000
*                                                                  1548 06385000
*        OLDERID2 = NEWERID2;                                      1548 06386000
         L     @04,@PC00001                                        1548 06387000
         L     @04,GDTTR2(,@04)                                    1548 06388000
         MVC   @TS00001(95),NEWERID2(@04)                          1548 06389000
         MVC   OLDERID2(95,@04),@TS00001                           1548 06390000
*        NEWID2 = 'LCVL';                                          1549 06391000
*                                                                  1549 06392000
         MVC   NEWID2(4,@04),@CC01670                              1549 06393000
*        VTYPCNT = VTYPCNT + 1;                                    1550 06394000
         LA    @04,1                                               1550 06395000
         AL    @04,VTYPCNT                                         1550 06396000
         ST    @04,VTYPCNT                                         1550 06397000
*        DARGSENT = LCST05;            /*VOLUME ENTRY HEADER         */ 06398000
         L     @04,DARGPTR                                         1551 06399000
         MVI   DARGSENT(@04),X'05'                                 1551 06400000
*        IF CATRC = CRCBADPW & ADDR(NAME) > NULLPTR                1552 06401000
*          THEN                                                    1552 06402000
         CLC   CATRC(2),@CH01280                                   1552 06403000
         BNE   @RF01552                                            1552 06404000
         L     @15,@PC00001+4                                      1552 06405000
         L     @15,FDTPTR+52(,@15)                                 1552 06406000
         LTR   @15,@15                                             1552 06407000
         BNP   @RF01552                                            1552 06408000
*            DO;                                                   1553 06409000
*            DARGDBP = ADDR(SUPPDSNM);                             1554 06410000
         L     @01,CTGPLPTR                                        1554 06411000
         L     @01,CTGWKA(,@01)                                    1554 06412000
         LA    @15,SUPPDSNM(,@01)                                  1554 06413000
         ST    @15,DARGDBP(,@04)                                   1554 06414000
*            DARGILP = LENGTH(SUPPDSNM);                           1555 06415000
         MVC   DARGILP(2,@04),@CH00606                             1555 06416000
*            END;                                                  1556 06417000
*          ELSE                                                    1557 06418000
*            DO;                                                   1557 06419000
         B     @RC01552                                            1557 06420000
@RF01552 DS    0H                                                  1558 06421000
*            DARGDBP = ENT44FPT->CTGFLPT(1);                       1558 06422000
         L     @04,DARGPTR                                         1558 06423000
         L     @01,ENT44FPT                                        1558 06424000
         L     @15,CTGFLPT(,@01)                                   1558 06425000
         ST    @15,DARGDBP(,@04)                                   1558 06426000
*            DARGILP = VSER#LEN;                                   1559 06427000
         MVC   DARGILP(2,@04),@CH00164                             1559 06428000
*            END;                                                  1560 06429000
*        CALL LISTPROC;                                            1561 06430000
*                                                                  1561 06431000
@RC01552 BAL   @14,LISTPROC                                        1561 06432000
*        /************************************************************/ 06433000
*        /*                                                  @YL026UE*/ 06434000
*        /* IF THE CATNAME SUBTITLE IS NOT USED, IDENTIFY THE        */ 06435000
*        /* CATALOG FOR EACH ENTRY VIA A CATNAME HEADER.     @YL026UE*/ 06436000
*        /*                                                  @YL026UE*/ 06437000
*        /************************************************************/ 06438000
*                                                                  1562 06439000
*        IF NOTTLFLG = ON                                          1562 06440000
*          THEN                                                    1562 06441000
         TM    NOTTLFLG,B'10000000'                                1562 06442000
         BNO   @RF01562                                            1562 06443000
*            DO;                                           /*@YL026UE*/ 06444000
*            DARGSENT = LCST40;                            /*@YL026UE*/ 06445000
         L     @04,DARGPTR                                         1564 06446000
         MVI   DARGSENT(@04),X'28'                                 1564 06447000
*            DARGDBP = ADDR(CATNAME);                      /*@YL026UE*/ 06448000
         LA    @15,CATNAME                                         1565 06449000
         ST    @15,DARGDBP(,@04)                                   1565 06450000
*            DARGILP = LENGTH(CATNAME);                    /*@YL026UE*/ 06451000
         MVC   DARGILP(2,@04),@CH00606                             1566 06452000
*            CALL LISTPROC;                                /*@YL026UE*/ 06453000
         BAL   @14,LISTPROC                                        1567 06454000
*            END;                                          /*@YL026UE*/ 06455000
*                                                                  1568 06456000
*        /************************************************************/ 06457000
*        /*                                                  @Y30SSMK*/ 06458000
*        /* EXIT HERE IF ONLY THE NAME SUBSET WAS REQUESTED. @Y30SSMK*/ 06459000
*        /*                                                  @Y30SSMK*/ 06460000
*        /************************************************************/ 06461000
*                                                                  1569 06462000
*        IF ADDR(NAME) > NULLPTR                                   1569 06463000
*          THEN                                                    1569 06464000
@RF01562 SLR   @04,@04                                             1569 06465000
         L     @15,@PC00001+4                                      1569 06466000
         C     @04,FDTPTR+52(,@15)                                 1569 06467000
         BNL   @RF01569                                            1569 06468000
*            RETURN CODE (0);                                      1570 06469000
         LR    @15,@04                                             1570 06470000
         L     @13,4(,@13)                                         1570 06471000
         L     @14,12(,@13)                                        1570 06472000
         LM    @00,@12,20(@13)                                     1570 06473000
         BR    @14                                                 1570 06474000
*        /************************************************************/ 06475000
*        /*                                                          */ 06476000
*        /* EXIT UPON USER ERROR WHEN PROCESSING AN ENTRIES LIST AND */ 06477000
*        /* THIS RETRIEVED ENTRY TYPE CONFLICTS WITH THE ALLOCATION  */ 06478000
*        /* SUBSET REQUEST.                                          */ 06479000
*        /*                                                          */ 06480000
*        /************************************************************/ 06481000
*                                                                  1571 06482000
*        IF ADDR(ALLOC) > NULLPTR                                  1571 06483000
*          THEN                                                    1571 06484000
@RF01569 L     @04,@PC00001+4                                      1571 06485000
         L     @04,FDTPTR+64(,@04)                                 1571 06486000
         LTR   @04,@04                                             1571 06487000
         BNP   @RF01571                                            1571 06488000
*            DO;                                                   1572 06489000
*              ERRARGPT->DARGSMOD = LC1ID;                         1573 06490000
         L     @04,ERRARGPT                                        1573 06491000
         MVC   DARGSMOD(3,@04),@CC01297                            1573 06492000
*              ERRARGPT->DARGSENT = LCMSG04;                       1574 06493000
         MVI   DARGSENT(@04),X'04'                                 1574 06494000
*              SAVRC = MAX (SAVRC, LASTCC08);              /*@ZA05939*/ 06495000
         LH    @04,SAVRC                                           1575 06496000
         LA    @15,8                                               1575 06497000
         CR    @04,@15                                             1575 06498000
         BNL   *+6                                                      06499000
         LR    @04,@15                                             1575 06500000
         STH   @04,SAVRC                                           1575 06501000
*              RETURN CODE (SAVRC);                        /*@ZA05939*/ 06502000
         LR    @15,@04                                             1576 06503000
         L     @13,4(,@13)                                         1576 06504000
         L     @14,12(,@13)                                        1576 06505000
         LM    @00,@12,20(@13)                                     1576 06506000
         BR    @14                                                 1576 06507000
*            END;                                                  1577 06508000
*        /************************************************************/ 06509000
*        /*                                                  @Y30SSMK*/ 06510000
*        /* BUILD THE TEXT PROCESSOR DARGLIST FOR PRINTING   @Y30SSMK*/ 06511000
*        /* THE RELEASE AND CATALOG RECOVERY FIELDS.         @Y30SSMK*/ 06512000
*        /*                                                  @Y30SSMK*/ 06513000
*        /************************************************************/ 06514000
*                                                                  1578 06515000
*        IF ADDR(NAME) = NULLPTR                                   1578 06516000
*          THEN                                                    1578 06517000
@RF01571 L     @04,@PC00001+4                                      1578 06518000
         L     @04,FDTPTR+52(,@04)                                 1578 06519000
         LTR   @04,@04                                             1578 06520000
         BNZ   @RF01578                                            1578 06521000
*            DO;                                           /*@Y30SSMK*/ 06522000
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/ 06523000
         L     @04,RELFPT                                          1580 06524000
         ST    @04,CTGFLPTR                                        1580 06525000
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/ 06526000
         L     @15,DARGPTR                                         1581 06527000
         L     @14,CTGFLPT(,@04)                                   1581 06528000
         ST    @14,DARGDBP(,@15)                                   1581 06529000
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/ 06530000
         L     @04,CTGFLNG(,@04)                                   1582 06531000
         STH   @04,DARGILP(,@15)                                   1582 06532000
*              DSREL = DSREL +1;       /* CALCULATE REL NO.  @Y30SSMK*/ 06533000
         LA    @04,1                                               1583 06534000
         SLR   @03,@03                                             1583 06535000
         IC    @03,DSREL(,@14)                                     1583 06536000
         ALR   @04,@03                                             1583 06537000
         STC   @04,DSREL(,@14)                                     1583 06538000
*              IF DSSER = ZEROAREA                                 1584 06539000
*                THEN                                              1584 06540000
         CLC   DSSER(6,@14),ZEROAREA                               1584 06541000
         BNE   @RF01584                                            1584 06542000
*                  DARGSENT = LCST47;  /*EXCLUDE CRA         @ZA05939*/ 06543000
         MVI   DARGSENT(@15),X'2F'                                 1585 06544000
*                ELSE                                              1586 06545000
*                  DARGSENT = LCST56;  /*INCLUDE CRA         @ZA05939*/ 06546000
         B     @RC01584                                            1586 06547000
@RF01584 L     @04,DARGPTR                                         1586 06548000
         MVI   DARGSENT(@04),X'38'                                 1586 06549000
*              CALL LISTPROC;                              /*@Y30SSMK*/ 06550000
@RC01584 BAL   @14,LISTPROC                                        1587 06551000
*            END;                                          /*@Y30SSMK*/ 06552000
*        /************************************************************/ 06553000
*        /*                                                  @Y30SSMK*/ 06554000
*        /* EXIT HERE IF ONLY THE HISTORY SUBSET WAS REQUESTED.      */ 06555000
*        /*                                                  @Y30SSMK*/ 06556000
*        /************************************************************/ 06557000
*                                                                  1589 06558000
*        IF ADDR(HIST) > NULLPTR                                   1589 06559000
*          THEN                                                    1589 06560000
@RF01578 SLR   @04,@04                                             1589 06561000
         L     @15,@PC00001+4                                      1589 06562000
         C     @04,FDTPTR+104(,@15)                                1589 06563000
         BNL   @RF01589                                            1589 06564000
*            RETURN CODE(0);                               /*@Y30SSMK*/ 06565000
         LR    @15,@04                                             1590 06566000
         L     @13,4(,@13)                                         1590 06567000
         L     @14,12(,@13)                                        1590 06568000
         LM    @00,@12,20(@13)                                     1590 06569000
         BR    @14                                                 1590 06570000
*        /************************************************************/ 06571000
*        /*                                                          */ 06572000
*        /* FOR A VOLUME SUBSET REQUEST, LIST THE VOLUME SERIAL AND  */ 06573000
*        /* DEVICE TYPE DATA.  EXIT.                                 */ 06574000
*        /*                                                          */ 06575000
*        /************************************************************/ 06576000
*                                                                  1591 06577000
*        IF ADDR(VOL) > NULLPTR                                    1591 06578000
*          THEN                                                    1591 06579000
@RF01589 L     @04,@PC00001+4                                      1591 06580000
         L     @04,FDTPTR+60(,@04)                                 1591 06581000
         LTR   @04,@04                                             1591 06582000
         BNP   @RF01591                                            1591 06583000
*            DO;                                                   1592 06584000
*              DARGSENT = LCST34;      /*VOL SERIAL AND DEVICE HEADER*/ 06585000
         L     @04,DARGPTR                                         1593 06586000
         MVI   DARGSENT(@04),X'22'                                 1593 06587000
*              CALL LISTPROC;                                      1594 06588000
*                                                                  1594 06589000
         BAL   @14,LISTPROC                                        1594 06590000
*              DARGSENT = LCST12;      /*VOL SERIAL AND DEVICE DATA  */ 06591000
         L     @04,DARGPTR                                         1595 06592000
         MVI   DARGSENT(@04),X'0C'                                 1595 06593000
*              DARGCNT = DRGCNT2;                          /*@Y30SSMK*/ 06594000
         MVC   DARGCNT(2,@04),@CH00161                             1596 06595000
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/ 06596000
         MVC   DARGINS(2,@04),@CH00457                             1597 06597000
*              DARGINL(1) = VSER#LEN;                              1598 06598000
*                                                                  1598 06599000
         MVC   DARGINL(2,@04),@CH00164                             1598 06600000
*              /*REPEAT VOL SER NO. FROM VOL ENTRYNAME               */ 06601000
*              DARGDTM(1) = ENT44FPT->CTGFLPT(1);                  1599 06602000
*                                                                  1599 06603000
         L     @01,ENT44FPT                                        1599 06604000
         L     @15,CTGFLPT(,@01)                                   1599 06605000
         ST    @15,DARGDTM(,@04)                                   1599 06606000
*              /*OBTAIN DEVICE TYPE                                  */ 06607000
*              CTGFLPTR = VCHARFPT;                                1600 06608000
         L     @15,VCHARFPT                                        1600 06609000
         ST    @15,CTGFLPTR                                        1600 06610000
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/ 06611000
         MVC   DARGINS+8(2,@04),@CH00649                           1601 06612000
*              DARGINL(2) = LENGTH(VDEV);                          1602 06613000
         MVC   DARGINL+8(2,@04),@CH00050                           1602 06614000
*              DARGDTM(2) = ADDR(VDEV);                            1603 06615000
*                                                                  1603 06616000
         L     @15,CTGFLPT(,@15)                                   1603 06617000
         ST    @15,DARGDTM+8(,@04)                                 1603 06618000
*              CALL LISTPROC;                                      1604 06619000
         BAL   @14,LISTPROC                                        1604 06620000
*              RETURN CODE (0);                                    1605 06621000
         SLR   @15,@15                                             1605 06622000
         L     @13,4(,@13)                                         1605 06623000
         L     @14,12(,@13)                                        1605 06624000
         LM    @00,@12,20(@13)                                     1605 06625000
         BR    @14                                                 1605 06626000
*            END;                                                  1606 06627000
*        /************************************************************/ 06628000
*        /*                                                          */ 06629000
*        /* LIST THE NON-REPEATING VOLUME CHARACTERISTICS AND        */ 06630000
*        /* STATISTICS.                                              */ 06631000
*        /*                                                          */ 06632000
*        /************************************************************/ 06633000
*                                                                  1607 06634000
*        DARGSENT = LCST30;            /*VOLUME CHARACTERISTICS HDR  */ 06635000
@RF01591 L     @04,DARGPTR                                         1607 06636000
         MVI   DARGSENT(@04),X'1E'                                 1607 06637000
*        DARGDBP = VCHARFPT->CTGFLPT(1); /*VOL CHAR DATA             */ 06638000
         L     @15,VCHARFPT                                        1608 06639000
         L     @14,CTGFLPT(,@15)                                   1608 06640000
         ST    @14,DARGDBP(,@04)                                   1608 06641000
*        DARGILP = VCHARFPT->CTGFLNG(1);                           1609 06642000
         L     @15,CTGFLNG(,@15)                                   1609 06643000
         STH   @15,DARGILP(,@04)                                   1609 06644000
*        DARGCNT = DRGCNT4;                                /*@Y30SSMK*/ 06645000
         MVC   DARGCNT(2,@04),@CH00050                             1610 06646000
*        CTGFLPTR = VTIMEFPT;                                      1611 06647000
         L     @15,VTIMEFPT                                        1611 06648000
         ST    @15,CTGFLPTR                                        1611 06649000
*        DARGINS(1) = DRGINS10;        /*VOL TIMESTAMP       @Y30SSMK*/ 06650000
         MVC   DARGINS(2,@04),@CH00457                             1612 06651000
*        DARGINL(1) = CTGFLNG(1);                                  1613 06652000
         L     @14,CTGFLNG(,@15)                                   1613 06653000
         STH   @14,DARGINL(,@04)                                   1613 06654000
*        DARGDTM(1) = CTGFLPT(1);                                  1614 06655000
         L     @15,CTGFLPT(,@15)                                   1614 06656000
         ST    @15,DARGDTM(,@04)                                   1614 06657000
*        CTGFLPTR = VSYSXFPT;                                      1615 06658000
         L     @15,VSYSXFPT                                        1615 06659000
         ST    @15,CTGFLPTR                                        1615 06660000
*        DARGINS(2) = DRGINS20;        /*MAX. DS EXTENTS ALLOWABLE   */ 06661000
         MVC   DARGINS+8(2,@04),@CH00649                           1616 06662000
*        DARGINL(2) = CTGFLNG(1);                                  1617 06663000
         L     @14,CTGFLNG(,@15)                                   1617 06664000
         STH   @14,DARGINL+8(,@04)                                 1617 06665000
*        DARGDTM(2) = CTGFLPT(1);                                  1618 06666000
         L     @15,CTGFLPT(,@15)                                   1618 06667000
         ST    @15,DARGDTM+8(,@04)                                 1618 06668000
*        IF VSYSX = ARITH4FF                                       1619 06669000
*          THEN                                                    1619 06670000
         CLC   VSYSX(1,@15),ARITH4FF                               1619 06671000
         BNE   @RF01619                                            1619 06672000
*            VSYSX = ZEROAREA;                                     1620 06673000
         MVC   VSYSX(1,@15),ZEROAREA                               1620 06674000
*        CTGFLPTR = V#DSFPT;                                       1621 06675000
@RF01619 L     @04,V#DSFPT                                         1621 06676000
         ST    @04,CTGFLPTR                                        1621 06677000
*        IF V#DS = ARITH4FF                                        1622 06678000
*          THEN                                                    1622 06679000
         L     @04,CTGFLPT(,@04)                                   1622 06680000
         CLC   V#DS(2,@04),ARITH4FF                                1622 06681000
         BNE   @RF01622                                            1622 06682000
*            V#DS = ZEROAREA;                                      1623 06683000
         MVC   V#DS(2,@04),ZEROAREA                                1623 06684000
*        DARGINS(3) = DRGINS30;        /*DATA SETS ON VOL    @Y30SSMK*/ 06685000
@RF01622 L     @04,DARGPTR                                         1624 06686000
         MVC   DARGINS+16(2,@04),@CH01231                          1624 06687000
*        DARGINL(3) = CTGFLNG(1);                                  1625 06688000
         L     @15,CTGFLPTR                                        1625 06689000
         L     @14,CTGFLNG(,@15)                                   1625 06690000
         STH   @14,DARGINL+16(,@04)                                1625 06691000
*        DARGDTM(3) = CTGFLPT(1);                                  1626 06692000
         L     @15,CTGFLPT(,@15)                                   1626 06693000
         ST    @15,DARGDTM+16(,@04)                                1626 06694000
*        CTGFLPTR = V#DSPFPT;                                      1627 06695000
         L     @04,V#DSPFPT                                        1627 06696000
         ST    @04,CTGFLPTR                                        1627 06697000
*        IF V#DSP = ARITH4FF                                       1628 06698000
*          THEN                                                    1628 06699000
         L     @04,CTGFLPT(,@04)                                   1628 06700000
         CLC   V#DSP(2,@04),ARITH4FF                               1628 06701000
         BNE   @RF01628                                            1628 06702000
*            V#DSP = ZEROAREA;                                     1629 06703000
         MVC   V#DSP(2,@04),ZEROAREA                               1629 06704000
*        DARGINS(4) = DRGINS40;        /*DATA SPACES ON VOL  @Y30SSMK*/ 06705000
@RF01628 L     @04,DARGPTR                                         1630 06706000
         MVC   DARGINS+24(2,@04),@CH01249                          1630 06707000
*        DARGINL(4) = CTGFLNG(1);                                  1631 06708000
         L     @15,CTGFLPTR                                        1631 06709000
         L     @14,CTGFLNG(,@15)                                   1631 06710000
         STH   @14,DARGINL+24(,@04)                                1631 06711000
*        DARGDTM(4) = CTGFLPT(1);                                  1632 06712000
         L     @15,CTGFLPT(,@15)                                   1632 06713000
         ST    @15,DARGDTM+24(,@04)                                1632 06714000
*        CALL LISTPROC;                                            1633 06715000
         BAL   @14,LISTPROC                                        1633 06716000
*        /************************************************************/ 06717000
*        /*                                                          */ 06718000
*        /* FOR A CANDIDATE VOLUME, NO DATASPACE INFORMATION EXISTS. */ 06719000
*        /* FOR A NON-CANDIDATE VOLUME LOGICALLY LIST FOR EACH       */ 06720000
*        /* DATASPACE ON THE VOLUME, THE EXTENT AND DATASET INFOR-   */ 06721000
*        /* MATION.                                                  */ 06722000
*        /* INITIALIZE WORKAREA LENGTHS AND POINTERS FOR ADVANCING   */ 06723000
*        /* THROUGH THIS VARIABLE LENGTH, REPEATING DATA.            */ 06724000
*        /*                                                          */ 06725000
*        /************************************************************/ 06726000
*                                                                  1634 06727000
*        CTGFLPTR = VHDRFPT;           /*POSITION TO THE DSP FPL     */ 06728000
         L     @04,VHDRFPT                                         1634 06729000
         ST    @04,CTGFLPTR                                        1634 06730000
*        IF CTGFLNG(1) > 0  &  CTGFLPT(1) > NULLPTR                1635 06731000
*          THEN                                                    1635 06732000
         SLR   @15,@15                                             1635 06733000
         L     @14,CTGFLNG(,@04)                                   1635 06734000
         CR    @14,@15                                             1635 06735000
         BNH   @RF01635                                            1635 06736000
         L     @04,CTGFLPT(,@04)                                   1635 06737000
         CR    @04,@15                                             1635 06738000
         BNH   @RF01635                                            1635 06739000
*            DO;                                                   1636 06740000
         ST    @04,@TF00001                                        1636 06741000
*              VHDRPTR = CTGFLPT(1);                               1637 06742000
         L     @03,@TF00001                                        1637 06743000
         ST    @03,VHDRPTR                                         1637 06744000
*              VHDRLEN = CTGFLNG(1);                               1638 06745000
*                                                                  1638 06746000
         LR    VHDRLEN,@14                                         1638 06747000
*              CTGFLPTR = VXDESFPT;    /*POSITION TO DSP EXTENT FPL  */ 06748000
         L     @14,VXDESFPT                                        1639 06749000
         ST    @14,CTGFLPTR                                        1639 06750000
*              IF CTGFLNG(1) > 0  &  CTGFLPT(1) > NULLPTR          1640 06751000
*                THEN                                              1640 06752000
         L     @03,CTGFLNG(,@14)                                   1640 06753000
         CR    @03,@15                                             1640 06754000
         BNH   @RF01640                                            1640 06755000
         L     @14,CTGFLPT(,@14)                                   1640 06756000
         CR    @14,@15                                             1640 06757000
         BNH   @RF01640                                            1640 06758000
*                  DO;                                             1641 06759000
*                    VXDESPTR = CTGFLPT(1);                        1642 06760000
         LR    VXDESPTR,@14                                        1642 06761000
*                    VXDESLEN = CTGFLNG(1);                        1643 06762000
         ST    @03,VXDESLEN                                        1643 06763000
*                  END;                                            1644 06764000
*                ELSE                  /*NO DATASPACE EXTENT INFO    */ 06765000
*                  VXDESLEN = 0;                                   1645 06766000
         B     @RC01640                                            1645 06767000
@RF01640 SLR   @15,@15                                             1645 06768000
         ST    @15,VXDESLEN                                        1645 06769000
*            END;                                                  1646 06770000
*          ELSE                        /*NO DATASPACES ON VOL        */ 06771000
*            VHDRLEN = 0;                                          1647 06772000
         B     @RC01635                                            1647 06773000
@RF01635 SLR   VHDRLEN,VHDRLEN                                     1647 06774000
*        /************************************************************/ 06775000
*        /*                                                          */ 06776000
*        /* ALL SUBSEQUENT PROCESSING OF THE SPACE ENTRY INFORMATION */ 06777000
*        /* INVOLVES THE FORMATTING OF                               */ 06778000
*        /*  1) A DATASPACE DESCRIPTOR FROM THE DATASPACE-HEADER     */ 06779000
*        /*     FIELDS, AND                                          */ 06780000
*        /*  2) THE EXTENT FIELDS SIGNIFICANT TO THE DATASPACE-HEADER*/ 06781000
*        /*     JUST PROCESSED, AND                                  */ 06782000
*        /*  3) THE DATASET DIRECTORY FIELDS SIGNIFICANT TO THE      */ 06783000
*        /*     DATASPACE JUST PROCESSED.                            */ 06784000
*        /* THIS CYCLE IS REPEATED UNTIL ALL DATASPACES HAVE BEEN    */ 06785000
*        /* LISTED WITH THEIR CORRESPONDING EXTENTS AND DATASETS.    */ 06786000
*        /* IF AT LEAST ONE GROUP OF DATASPACE-HEADER FIELDS WAS     */ 06787000
*        /* RETURNED IN THE WORKAREA, BEGIN PROCESSING.              */ 06788000
*        /*                                                          */ 06789000
*        /************************************************************/ 06790000
*                                                                  1648 06791000
*VHDR:   DO WHILE VHDRLEN >= LENGTH(VDSPHDR);                      1648 06792000
*                                                                  1648 06793000
@RC01635 DS    0H                                                  1648 06794000
VHDR     B     @DE01648                                            1648 06795000
@DL01648 DS    0H                                                  1649 06796000
*          /**********************************************************/ 06797000
*          /*                                                        */ 06798000
*          /* BUILD THE DARGLIST TO PRINT THE DATASPACE-HEADER FIELDS*/ 06799000
*          /* AND TO INSURE PRINTABILITY, ZERO ANY NON-INITIALIZED   */ 06800000
*          /* ARITHMETIC FIELDS.                                     */ 06801000
*          /*                                                        */ 06802000
*          /**********************************************************/ 06803000
*                                                                  1649 06804000
*          DARGSENT = LCST31;          /*DATASPACE TITLE             */ 06805000
         L     @15,DARGPTR                                         1649 06806000
         MVI   DARGSENT(@15),X'1F'                                 1649 06807000
*          DARGDBP = VHDRPTR;                                      1650 06808000
         L     @14,VHDRPTR                                         1650 06809000
         ST    @14,DARGDBP(,@15)                                   1650 06810000
*          DARGILP = LENGTH(VDSPHDR);                              1651 06811000
         MVC   DARGILP(2,@15),@CH00653                             1651 06812000
*          IF VDSPDS# = ARITH4FF       /*NO. DATASETS IN DATASPACE   */ 06813000
*            THEN                                                  1652 06814000
         CLC   VDSPDS#(2,@14),ARITH4FF                             1652 06815000
         BNE   @RF01652                                            1652 06816000
*              VDSPDS# = ZEROAREA;                                 1653 06817000
         MVC   VDSPDS#(2,@14),ZEROAREA                             1653 06818000
*          IF VDSPXT = ARITH4FF        /*NO. DATASPACE EXTENTS       */ 06819000
*            THEN                                                  1654 06820000
@RF01652 L     @15,VHDRPTR                                         1654 06821000
         CLC   VDSPXT(1,@15),ARITH4FF                              1654 06822000
         BNE   @RF01654                                            1654 06823000
*              VDSPXT = ZEROAREA;                                  1655 06824000
         MVC   VDSPXT(1,@15),ZEROAREA                              1655 06825000
*          IF VDSPSCON = ARITH4FF      /*DATASPACE SECONDARY SPACE   */ 06826000
*            THEN                                                  1656 06827000
@RF01654 L     @15,VHDRPTR                                         1656 06828000
         CLC   VDSPSCON(3,@15),ARITH4FF                            1656 06829000
         BNE   @RF01656                                            1656 06830000
*              VDSPSCON = ZEROAREA;                                1657 06831000
*                                                                  1657 06832000
         MVC   VDSPSCON(3,@15),ZEROAREA                            1657 06833000
*          /**********************************************************/ 06834000
*          /*                                                        */ 06835000
*          /* INTERPRET THE DATASPACE SPACE CREATION OPTION AND      */ 06836000
*          /* SELECT THE APPROPRIATE STATIC TEXT DESCRIPTOR.         */ 06837000
*          /* NOTE - THE FORMAT IS THE SAME AS THE JFCB SPACE OPTION */ 06838000
*          /* FIELD FOR A DATA OR INDEX ENTRY.                       */ 06839000
*          /*                                                        */ 06840000
*          /**********************************************************/ 06841000
*                                                                  1658 06842000
*          DARGCNT = DRGCNT3;                              /*@Y30SSMK*/ 06843000
@RF01656 L     @15,DARGPTR                                         1658 06844000
         MVC   DARGCNT(2,@15),@CH00170                             1658 06845000
*          DARGINS(1) = DRGINS10;                          /*@Y30SSMK*/ 06846000
         LA    @14,10                                              1659 06847000
         STH   @14,DARGINS(,@15)                                   1659 06848000
*          DARGINL(1) = ABBREVLN;                                  1660 06849000
         STH   @14,DARGINL(,@15)                                   1660 06850000
*          IF VDSPOPT = RSZOPTN                                    1661 06851000
*            THEN                                                  1661 06852000
         L     @01,VHDRPTR                                         1661 06853000
         TM    VDSPOPT(@01),B'01000000'                            1661 06854000
         BNO   @RF01661                                            1661 06855000
         TM    VDSPOPT(@01),B'10000000'                            1661 06856000
         BNZ   @RF01661                                            1661 06857000
*              DARGDTM(1) = ADDR(RECSZNM);                         1662 06858000
         L     @01,TEXTPTR                                         1662 06859000
         LA    @14,RECSZNM(,@01)                                   1662 06860000
         ST    @14,DARGDTM(,@15)                                   1662 06861000
*            ELSE                                                  1663 06862000
*              IF VDSPOPT = TRKOPTN                                1663 06863000
*                THEN                                              1663 06864000
         B     @RC01661                                            1663 06865000
@RF01661 L     @01,VHDRPTR                                         1663 06866000
         TM    VDSPOPT(@01),B'10000000'                            1663 06867000
         BNO   @RF01663                                            1663 06868000
         TM    VDSPOPT(@01),B'01000000'                            1663 06869000
         BNZ   @RF01663                                            1663 06870000
*                  DARGDTM(1) = ADDR(TRKNM);                       1664 06871000
         L     @01,TEXTPTR                                         1664 06872000
         LA    @15,TRKNM(,@01)                                     1664 06873000
         L     @14,DARGPTR                                         1664 06874000
         ST    @15,DARGDTM(,@14)                                   1664 06875000
*                ELSE                                              1665 06876000
*                  IF VDSPOPT = CYLOPTN                            1665 06877000
*                    THEN                                          1665 06878000
         B     @RC01663                                            1665 06879000
@RF01663 L     @01,VHDRPTR                                         1665 06880000
         TM    VDSPOPT(@01),B'11000000'                            1665 06881000
         BNO   @RF01665                                            1665 06882000
*                      DARGDTM(1) = ADDR(CYLNM);                   1666 06883000
         L     @01,TEXTPTR                                         1666 06884000
         LA    @15,CYLNM(,@01)                                     1666 06885000
         L     @14,DARGPTR                                         1666 06886000
         ST    @15,DARGDTM(,@14)                                   1666 06887000
*                    ELSE                                          1667 06888000
*                      DARGDTM(1) = ADDR(NULLNM);                  1667 06889000
*                                                                  1667 06890000
         B     @RC01665                                            1667 06891000
@RF01665 L     @01,TEXTPTR                                         1667 06892000
         LA    @15,NULLNM(,@01)                                    1667 06893000
         L     @14,DARGPTR                                         1667 06894000
         ST    @15,DARGDTM(,@14)                                   1667 06895000
*          /**********************************************************/ 06896000
*          /*                                                        */ 06897000
*          /* INTERPRET THE DATASPACE ATTRIBUTE FLAG AND SELECT THE  */ 06898000
*          /* APPROPRIATE STATIC TEXT DESCRIPTOR.                    */ 06899000
*          /*                                                        */ 06900000
*          /**********************************************************/ 06901000
*                                                                  1668 06902000
*          DARGINS(2) = DRGINS20;                          /*@Y30SSMK*/ 06903000
@RC01665 DS    0H                                                  1668 06904000
@RC01663 DS    0H                                                  1668 06905000
@RC01661 L     @15,DARGPTR                                         1668 06906000
         MVC   DARGINS+8(2,@15),@CH00649                           1668 06907000
*          DARGINL(2) = ABBREVLN;                                  1669 06908000
         MVC   DARGINL+8(2,@15),@CH00457                           1669 06909000
*          IF VDSPUNQ = ON                                         1670 06910000
*            THEN                                                  1670 06911000
         L     @01,VHDRPTR                                         1670 06912000
         TM    VDSPUNQ(@01),B'10000000'                            1670 06913000
         BNO   @RF01670                                            1670 06914000
*              DARGDTM(2) = ADDR(UNQNM);                           1671 06915000
         L     @01,TEXTPTR                                         1671 06916000
         LA    @14,UNQNM(,@01)                                     1671 06917000
         ST    @14,DARGDTM+8(,@15)                                 1671 06918000
*            ELSE                                                  1672 06919000
*              DARGDTM(2) = ADDR(SUBALNM);                         1672 06920000
         B     @RC01670                                            1672 06921000
@RF01670 L     @01,TEXTPTR                                         1672 06922000
         LA    @15,SUBALNM(,@01)                                   1672 06923000
         L     @14,DARGPTR                                         1672 06924000
         ST    @15,DARGDTM+8(,@14)                                 1672 06925000
*          DARGINS(3) = DRGINS30;                          /*@Y30SSMK*/ 06926000
@RC01670 L     @15,DARGPTR                                         1673 06927000
         MVC   DARGINS+16(2,@15),@CH01231                          1673 06928000
*          DARGINL(3) = ABBREVLN;                                  1674 06929000
         MVC   DARGINL+16(2,@15),@CH00457                          1674 06930000
*          IF VDSPAUTO = ON                                        1675 06931000
*            THEN                                                  1675 06932000
         L     @01,VHDRPTR                                         1675 06933000
         TM    VDSPAUTO(@01),B'01000000'                           1675 06934000
         BNO   @RF01675                                            1675 06935000
*              DARGDTM(3) = ADDR(AUTONM);                          1676 06936000
         L     @01,TEXTPTR                                         1676 06937000
         LA    @14,AUTONM(,@01)                                    1676 06938000
         ST    @14,DARGDTM+16(,@15)                                1676 06939000
*            ELSE                                                  1677 06940000
*              DARGDTM(3) = ADDR(EXPLNM);                          1677 06941000
*                                                                  1677 06942000
         B     @RC01675                                            1677 06943000
@RF01675 L     @01,TEXTPTR                                         1677 06944000
         LA    @15,EXPLNM(,@01)                                    1677 06945000
         L     @14,DARGPTR                                         1677 06946000
         ST    @15,DARGDTM+16(,@14)                                1677 06947000
*          /**********************************************************/ 06948000
*          /*                                                        */ 06949000
*          /* DETERMINE IF EITHER THE USERCAT OR MASTERCAT INDICATOR */ 06950000
*          /* IS SET IN THE DATASPACE ATTRIBUTE FLAG.  IF SO, BUILD  */ 06951000
*          /* A DARGLIST INSERT STRUCTURE FOR IT.                    */ 06952000
*          /*                                                        */ 06953000
*          /**********************************************************/ 06954000
*                                                                  1678 06955000
*          IF VDSPUCAT = ON  |  VDSPMCAT = ON                      1678 06956000
*            THEN                                                  1678 06957000
@RC01675 L     @15,VHDRPTR                                         1678 06958000
         TM    VDSPUCAT(@15),B'00110000'                           1678 06959000
         BZ    @RF01678                                            1678 06960000
*              DO;                                                 1679 06961000
*                DARGCNT = DARGCNT + 1;                            1680 06962000
         L     @14,DARGPTR                                         1680 06963000
         LA    @03,1                                               1680 06964000
         AH    @03,DARGCNT(,@14)                                   1680 06965000
         STH   @03,DARGCNT(,@14)                                   1680 06966000
*                DARGINS(DARGCNT) = DARGCNT * DRGINS10;    /*@Y30SSMK*/ 06967000
         LR    @02,@03                                             1681 06968000
         SLA   @02,3                                               1681 06969000
         LA    @01,10                                              1681 06970000
         ST    @02,@TF00001                                        1681 06971000
         MR    @02,@01                                             1681 06972000
         L     @02,@TF00001                                        1681 06973000
         STH   @03,DARGINS-8(@02,@14)                              1681 06974000
*                DARGINL(DARGCNT) = ABBREVLN;                      1682 06975000
*                                                                  1682 06976000
         L     @03,@TF00001                                        1682 06977000
         STH   @01,DARGINL-8(@03,@14)                              1682 06978000
*                /****************************************************/ 06979000
*                /*                                                  */ 06980000
*                /* THE USERCAT INDICATOR AND THE MASTERCAT INDICATOR*/ 06981000
*                /* CANNOT BOTH BE SIGNIFICANT FOR THE SAME DATASPACE*/ 06982000
*                /* THEREFORE, ONLY ONE OR THE OTHER ATTRIBUTE IS    */ 06983000
*                /* LISTED.                                          */ 06984000
*                /*                                                  */ 06985000
*                /****************************************************/ 06986000
*                                                                  1683 06987000
*                IF VDSPUCAT = ON                                  1683 06988000
*                  THEN                                            1683 06989000
         TM    VDSPUCAT(@15),B'00100000'                           1683 06990000
         BNO   @RF01683                                            1683 06991000
*                    DARGDTM(DARGCNT) = ADDR(UCATNM);              1684 06992000
         L     @01,TEXTPTR                                         1684 06993000
         LA    @15,UCATNM(,@01)                                    1684 06994000
         L     @01,@TF00001                                        1684 06995000
         ST    @15,DARGDTM-8(@01,@14)                              1684 06996000
*                  ELSE                                            1685 06997000
*                    DARGDTM(DARGCNT) = ADDR(MCATNM);              1685 06998000
         B     @RC01683                                            1685 06999000
@RF01683 L     @15,DARGPTR                                         1685 07000000
         LH    @14,DARGCNT(,@15)                                   1685 07001000
         SLA   @14,3                                               1685 07002000
         L     @01,TEXTPTR                                         1685 07003000
         LA    @03,MCATNM(,@01)                                    1685 07004000
         ST    @03,DARGDTM-8(@14,@15)                              1685 07005000
*              END;                                                1686 07006000
*                                                                  1686 07007000
@RC01683 DS    0H                                                  1687 07008000
*          /**********************************************************/ 07009000
*          /*                                                        */ 07010000
*          /* PRINT THE DATASPACE-HEADER INFORMATION SETUP IN THE    */ 07011000
*          /* DARGLIST.                                              */ 07012000
*          /*                                                        */ 07013000
*          /**********************************************************/ 07014000
*                                                                  1687 07015000
*          CALL LISTPROC;                                          1687 07016000
@RF01678 BAL   @14,LISTPROC                                        1687 07017000
*          /**********************************************************/ 07018000
*          /*                                                        */ 07019000
*          /* IF AT LEAST ONE GROUP OF DATASPACE EXTENT FIELDS WAS   */ 07020000
*          /* RETURNED FROM THE CATALOG AND IF THIS EXTENT GROUP IS  */ 07021000
*          /* ASSOCIATED WITH THE DATASPACE-HEADER JUST PROCESSED,   */ 07022000
*          /* BUILD THE DARGLIST TO PRINT THE INFORMATION.  AND SET  */ 07023000
*          /* AN INDICATOR TO PRINT AN EXTENT DESCRIPTOR TITLE AFTER */ 07024000
*          /* EACH DATASPACE.                                        */ 07025000
*          /*                                                        */ 07026000
*          /**********************************************************/ 07027000
*                                                                  1688 07028000
*          VXTITLSW = YES;                                         1688 07029000
*                                                                  1688 07030000
         OI    VXTITLSW,B'10000000'                                1688 07031000
*VXDES:    DO WHILE (VXDESLEN >= LENGTH(VDSPDES)  &  VXSS#=VHDRREPN);   07032000
*                                                                  1689 07033000
VXDES    B     @DE01689                                            1689 07034000
@DL01689 DS    0H                                                  1690 07035000
*            /********************************************************/ 07036000
*            /*                                                      */ 07037000
*            /* PRINT THE EXTENT TITLE IF THIS IS THE FIRST EXTENT   */ 07038000
*            /* GROUP TO BE LISTED FOR THIS DATASPACE.               */ 07039000
*            /* NOTE - MORE THAN ONE EXTENT GROUP MAY BE ASSOCIATED  */ 07040000
*            /* WITH THE SAME DATASPACE.                             */ 07041000
*            /*                                                      */ 07042000
*            /********************************************************/ 07043000
*                                                                  1690 07044000
*            IF VXTITLSW = YES                                     1690 07045000
*              THEN                                                1690 07046000
         TM    VXTITLSW,B'10000000'                                1690 07047000
         BNO   @RF01690                                            1690 07048000
*                DO;                                               1691 07049000
*                  VXTITLSW = NO;                                  1692 07050000
         NI    VXTITLSW,B'01111111'                                1692 07051000
*                  DARGSENT = LCST32;  /*DATASPACE EXTENT TITLE      */ 07052000
         L     @01,DARGPTR                                         1693 07053000
         MVI   DARGSENT(@01),X'20'                                 1693 07054000
*                  CALL LISTPROC;                                  1694 07055000
         BAL   @14,LISTPROC                                        1694 07056000
*                END;                                              1695 07057000
*                                                                  1695 07058000
*            /********************************************************/ 07059000
*            /*                                                      */ 07060000
*            /* BUILD THE DARGLIST TO PRINT THE EXTENT FIELDS.  AND  */ 07061000
*            /* TO INSURE PRINTABILITY, ZERO ANY NON-INITIALIZED     */ 07062000
*            /* ARITHMETIC FIELDS.                                   */ 07063000
*            /*                                                      */ 07064000
*            /********************************************************/ 07065000
*                                                                  1696 07066000
*            DARGSENT = LCST36;        /*DATASPACE EXTENT DESCRIPTOR */ 07067000
@RF01690 L     @15,DARGPTR                                         1696 07068000
         MVI   DARGSENT(@15),X'24'                                 1696 07069000
*            DARGDBP = VXDESPTR;                                   1697 07070000
         ST    VXDESPTR,DARGDBP(,@15)                              1697 07071000
*            DARGILP = LENGTH(VDSPDES);                            1698 07072000
         MVC   DARGILP(2,@15),@CH00664                             1698 07073000
*            IF VTRKPX = ARITH4FF                                  1699 07074000
*              THEN                                                1699 07075000
         CLC   VTRKPX(2,VXDESPTR),ARITH4FF                         1699 07076000
         BNE   @RF01699                                            1699 07077000
*                VTRKPX = ZEROAREA;                                1700 07078000
         MVC   VTRKPX(2,VXDESPTR),ZEROAREA                         1700 07079000
*            IF VTRKUSED = ARITH4FF                                1701 07080000
*              THEN                                                1701 07081000
@RF01699 CLC   VTRKUSED(2,VXDESPTR),ARITH4FF                       1701 07082000
         BNE   @RF01701                                            1701 07083000
*                VTRKUSED = ZEROAREA;                              1702 07084000
*                                                                  1702 07085000
*                                                                  1702 07086000
         MVC   VTRKUSED(2,VXDESPTR),ZEROAREA                       1702 07087000
*            /********************************************************/ 07088000
*            /*                                                      */ 07089000
*            /* DETERMINE IF A VARIABLE LENGTH SPACEMAP, SHOWING THE */ 07090000
*            /* FREE AND USED TRACKS OF THE EXTENT, IS TO BE @ZA05939*/ 07091000
*            /* LISTED.                                      @ZA05939*/ 07092000
*            /*                                                      */ 07093000
*            /********************************************************/ 07094000
*                                                                  1703 07095000
*            IF VSPMAPLN > 0                                       1703 07096000
*              THEN                                                1703 07097000
@RF01701 ICM   @15,12,VSPMAPLN(VXDESPTR)                           1703 07098000
         SRA   @15,16                                              1703 07099000
         LTR   @15,@15                                             1703 07100000
         BNP   @RF01703                                            1703 07101000
*                DO;                                               1704 07102000
*                  DARGCNT = DRGCNT1;                      /*@Y30SSMK*/ 07103000
         L     @14,DARGPTR                                         1705 07104000
         MVC   DARGCNT(2,@14),@CH00045                             1705 07105000
*                  DARGINS(1) = DRGINS10;                  /*@Y30SSMK*/ 07106000
         MVC   DARGINS(2,@14),@CH00457                             1706 07107000
*                  DARGINL(1) = VSPMAPLN;                          1707 07108000
         STH   @15,DARGINL(,@14)                                   1707 07109000
*                  DARGDTM(1) = ADDR(VSPMAP);                      1708 07110000
         LA    @15,VSPMAP(,VXDESPTR)                               1708 07111000
         ST    @15,DARGDTM(,@14)                                   1708 07112000
*                END;                                      /*@ZA05939*/ 07113000
*                                                                  1709 07114000
*            CALL LISTPROC;                                /*@ZA05939*/ 07115000
*                                                                  1710 07116000
@RF01703 BAL   @14,LISTPROC                                        1710 07117000
*            /********************************************************/ 07118000
*            /*                                                      */ 07119000
*            /* COMPUTE THE TOTAL LENGTH OF THE ONE EXTENT GROUP JUST*/ 07120000
*            /* PROCESSED.   UPDATE THE POINTER TO THE NEXT EXTENT   */ 07121000
*            /* GROUP AND ADJUST THE EXTENT LENGTH USED AS A CONTROL */ 07122000
*            /* VARIABLE TO DETERMINE WHETHER OR NOT ANOTHER EXTENT  */ 07123000
*            /* GROUP EXISTS THAT MAY BE ASSOCIATED WITH THIS        */ 07124000
*            /* DATASPACE.                                           */ 07125000
*            /*                                                      */ 07126000
*            /********************************************************/ 07127000
*                                                                  1711 07128000
*            VWKA = LENGTH(VDSPDES) + VSPMAPLN;                    1711 07129000
         LA    VWKA,14                                             1711 07130000
         ICM   @03,12,VSPMAPLN(VXDESPTR)                           1711 07131000
         SRA   @03,16                                              1711 07132000
         ALR   VWKA,@03                                            1711 07133000
*            VXDESLEN = VXDESLEN - VWKA;                           1712 07134000
         L     @03,VXDESLEN                                        1712 07135000
         SLR   @03,VWKA                                            1712 07136000
         ST    @03,VXDESLEN                                        1712 07137000
*            VXDESPTR = VXDESPTR + VWKA;                           1713 07138000
         ALR   VXDESPTR,VWKA                                       1713 07139000
*          END VXDES;                                              1714 07140000
@DE01689 L     @15,VXDESLEN                                        1714 07141000
         C     @15,@CF00664                                        1714 07142000
         BL    @DC01689                                            1714 07143000
         L     @01,VHDRPTR                                         1714 07144000
         CLC   VXSS#(2,VXDESPTR),VHDRREPN(@01)                     1714 07145000
         BE    @DL01689                                            1714 07146000
@DC01689 DS    0H                                                  1715 07147000
*          /**********************************************************/ 07148000
*          /*                                                        */ 07149000
*          /* DETERMINE IF ANY DATASET DIRECTORY INFORMATION WAS     */ 07150000
*          /* RETURNED IN THE WORKAREA.  IF YES, INITIALIZE A POINTER*/ 07151000
*          /* AND LENGTH TO BE USED IN STEPPING THROUGH THE REPEATING*/ 07152000
*          /* GROUPS OF FIXED AND VARIABLE LENGTH DIRECTORY FIELDS.  */ 07153000
*          /* IF NOT, ZERO THE LENGTH INDICATOR FOR NO DIRECTORY DATA*/ 07154000
*          /*                                                        */ 07155000
*          /**********************************************************/ 07156000
*                                                                  1715 07157000
*          CTGFLPTR = VDIRFPT;         /*POSITION TO DS DIRECTORY FPL*/ 07158000
         L     @15,VDIRFPT                                         1715 07159000
         ST    @15,CTGFLPTR                                        1715 07160000
*          IF CTGFLNG(1) > 0  &  CTGFLPT(1) > NULLPTR              1716 07161000
*            THEN                      /*DATASETS ARE IN DATASPACE   */ 07162000
         SLR   @14,@14                                             1716 07163000
         L     @03,CTGFLNG(,@15)                                   1716 07164000
         CR    @03,@14                                             1716 07165000
         BNH   @RF01716                                            1716 07166000
         L     @15,CTGFLPT(,@15)                                   1716 07167000
         CR    @15,@14                                             1716 07168000
         BNH   @RF01716                                            1716 07169000
*              DO;                                                 1717 07170000
*                VDIRPTR = CTGFLPT(1);                             1718 07171000
         LR    VDIRPTR,@15                                         1718 07172000
*                VDIRLEN = CTGFLNG(1);                             1719 07173000
         ST    @03,VDIRLEN                                         1719 07174000
*                VDSHDRSW = YES;                                   1720 07175000
         OI    VDSHDRSW,B'10000000'                                1720 07176000
*              END;                                                1721 07177000
*            ELSE                                                  1722 07178000
*              VDIRLEN = 0;                                        1722 07179000
         B     @RC01716                                            1722 07180000
@RF01716 SLR   @15,@15                                             1722 07181000
         ST    @15,VDIRLEN                                         1722 07182000
*          /**********************************************************/ 07183000
*          /*                                                        */ 07184000
*          /* IF AT LEAST ONE GROUP OF DATASET DIRECTORY FIELDS WAS  */ 07185000
*          /* RETURNED FROM THE CATALOG, PROCESS THE DIRECTORY DATA. */ 07186000
*          /*                                                        */ 07187000
*          /**********************************************************/ 07188000
*                                                                  1723 07189000
*VDIR:     DO WHILE VDIRLEN >= LENGTH(VDSDIR);                     1723 07190000
*                                                                  1723 07191000
@RC01716 DS    0H                                                  1723 07192000
VDIR     B     @DE01723                                            1723 07193000
@DL01723 DS    0H                                                  1724 07194000
*            /********************************************************/ 07195000
*            /*                                                      */ 07196000
*            /* COMPUTE THE NUMBER OF ASSOCIATED DATASPACE           */ 07197000
*            /* IDENTIFIERS IN THIS PARTICULAR DATASET DIRECTORY,    */ 07198000
*            /* SINCE A GIVEN DATASET MAY BE ASSOCIATED WITH MORE    */ 07199000
*            /* THAN ONE DATASPACE.  THEN CHECK EACH IDENTIFIER TO   */ 07200000
*            /* DETERMINE IF THIS DATASET DIRECTORY IS ASSOCIATED    */ 07201000
*            /* WITH THE DATASPACE CURRENTLY BEING PROCESSED.        */ 07202000
*            /*                                                      */ 07203000
*            /********************************************************/ 07204000
*                                                                  1724 07205000
*SS#CK:      DO VMM = 1 TO VSS#LEN/LENGTH(VSS#INFO);               1724 07206000
SS#CK    LA    @15,1                                               1724 07207000
         B     @DE01724                                            1724 07208000
@DL01724 DS    0H                                                  1725 07209000
*              IF VDIRSS#(VMM) = VHDRREPN                          1725 07210000
*                THEN                                              1725 07211000
         MH    @15,@CH00170                                        1725 07212000
         ALR   @15,VDIRPTR                                         1725 07213000
         L     @14,VHDRPTR                                         1725 07214000
         CLC   VDIRSS#-3(2,@15),VHDRREPN(@14)                      1725 07215000
         BNE   @RF01725                                            1725 07216000
*LISTDIR:          DO;                                             1726 07217000
*                                                                  1726 07218000
*                                                                  1726 07219000
LISTDIR  DS    0H                                                  1727 07220000
*                    /************************************************/ 07221000
*                    /*                                              */ 07222000
*                    /* PRINT THE DATASET DIRECTORY TITLE IF THIS IS */ 07223000
*                    /* THE FIRST PASS.                              */ 07224000
*                    /*                                              */ 07225000
*                    /************************************************/ 07226000
*                                                                  1727 07227000
*                    IF VDSHDRSW = YES                             1727 07228000
*                      THEN                                        1727 07229000
         TM    VDSHDRSW,B'10000000'                                1727 07230000
         BNO   @RF01727                                            1727 07231000
*                        DO;                                       1728 07232000
*                          VDSHDRSW = NO;                          1729 07233000
         NI    VDSHDRSW,B'01111111'                                1729 07234000
*                          DARGSENT = LCST33;                      1730 07235000
         L     @01,DARGPTR                                         1730 07236000
         MVI   DARGSENT(@01),X'21'                                 1730 07237000
*                          CALL LISTPROC;                          1731 07238000
         BAL   @14,LISTPROC                                        1731 07239000
*                        END;                                      1732 07240000
*                                                                  1732 07241000
*                    /************************************************/ 07242000
*                    /*                                              */ 07243000
*                    /* RESET THE CPL POINTER TO THE CPL SETUP       */ 07244000
*                    /* ESPECIALLY FOR ENTRYNAME RETRIEVAL VIA A     */ 07245000
*                    /* C.I.NO.  SET THE INDICATOR FOR IDENTIFYING   */ 07246000
*                    /* WHICH SAVEAREA IS TO BE USED DURING THE      */ 07247000
*                    /* LOCATE REQUEST.  AND INITIALIZE AN FPL TO    */ 07248000
*                    /* BE USED IN THE ENTRYNAME REQUEST.            */ 07249000
*                    /* NOTE - THE FPL IS NOT A READ ONLY PARM LIST  */ 07250000
*                    /* AND IS THEREFORE REINITIALIZED FOR EACH      */ 07251000
*                    /* LOCATE REQUEST.                              */ 07252000
*                    /*                                              */ 07253000
*                    /************************************************/ 07254000
*                                                                  1733 07255000
*                    CTGPLPTR = CI#CPLPT;                          1733 07256000
@RF01727 L     @15,CI#CPLPT                                        1733 07257000
         ST    @15,CTGPLPTR                                        1733 07258000
*                    ENTNMFLG = ON;                                1734 07259000
         OI    ENTNMFLG,B'10000000'                                1734 07260000
*                    CTGFLPTR = ENT44FPT;                          1735 07261000
         L     @14,ENT44FPT                                        1735 07262000
         ST    @14,CTGFLPTR                                        1735 07263000
*                    CTGFLPTR->VDSFPL(1:LCFPLLEN) =                1736 07264000
*                      ZEROAREA(1:LCFPLLEN);                       1736 07265000
         SLR   @03,@03                                             1736 07266000
         IC    @03,LCFPLLEN                                        1736 07267000
         BCTR  @03,0                                               1736 07268000
         EX    @03,@SM01763                                        1736 07269000
*                    CTGFLDNO = 1;                                 1737 07270000
         MVI   CTGFLDNO(@14),X'01'                                 1737 07271000
*                    CTGFLDNM = ADDR(ENT44NM);                     1738 07272000
*                                                                  1738 07273000
         LA    @03,ENT44NM                                         1738 07274000
         ST    @03,CTGFLDNM(,@14)                                  1738 07275000
*                    /************************************************/ 07276000
*                    /*                                              */ 07277000
*                    /* IN THE SPECIAL CPL, SET THE C.I.NO. ADDRESS  */ 07278000
*                    /* FROM THE DATASET DIRECTORY.  AND SET THE SAME*/ 07279000
*                    /* PASSWORD VALUE THAT WAS USED FOR THE SPACE   */ 07280000
*                    /* ENTRY LOCATE.                                */ 07281000
*                    /*                                              */ 07282000
*                    /************************************************/ 07283000
*                                                                  1739 07284000
*                    CTGENT = ADDR(VDSCI#);                        1739 07285000
         LA    @14,VDSCI#(,VDIRPTR)                                1739 07286000
         ST    @14,CTGENT(,@15)                                    1739 07287000
*                    CTGPSWD = TYPCPLPT->CTGPSWD;                  1740 07288000
         L     @01,TYPCPLPT                                        1740 07289000
         L     @14,CTGPSWD(,@01)                                   1740 07290000
         ST    @14,CTGPSWD(,@15)                                   1740 07291000
*                    /************************************************/ 07292000
*                    /*                                              */ 07293000
*                    /* ISSUE  THE LOCATE FOR THE DATASET NAME       */ 07294000
*                    /* ASSOCIATED WITH THE CURRENT DATASPACE.       */ 07295000
*                    /*                                              */ 07296000
*                    /************************************************/ 07297000
*                                                                  1741 07298000
*                    CALL LOCPROC (FPLEND,                         1741 07299000
*                                  CACBFLG,                        1741 07300000
*                                  ENTNMFLG);                      1741 07301000
         LA    @15,FPLEND                                          1741 07302000
         ST    @15,@AL00001                                        1741 07303000
         LA    @15,CACBFLG                                         1741 07304000
         ST    @15,@AL00001+4                                      1741 07305000
         LA    @15,ENTNMFLG                                        1741 07306000
         ST    @15,@AL00001+8                                      1741 07307000
         LA    @01,@AL00001                                        1741 07308000
         BAL   @14,LOCPROC                                         1741 07309000
*                    RESPECIFY RTNREG RSTD;                        1742 07310000
*                    TESTRC = RTNREG;                              1743 07311000
         LR    TESTRC,RTNREG                                       1743 07312000
*                    RESPECIFY RTNREG UNRSTD;                      1744 07313000
*                                                                  1744 07314000
*                    /************************************************/ 07315000
*                    /*                                              */ 07316000
*                    /* IF THE LOCATE WAS UNSUCCESSFUL BUT NOT DUE TO*/ 07317000
*                    /* PASSWORD VERIFICATION FAILURE, PROCESS THE   */ 07318000
*                    /* ERROR CONDITION.                             */ 07319000
*                    /*                                              */ 07320000
*                    /************************************************/ 07321000
*                                                                  1745 07322000
*                    IF TESTRC ^= 0  &  CATRC ^= CRCBADPW          1745 07323000
*                      THEN                                        1745 07324000
         LTR   TESTRC,TESTRC                                       1745 07325000
         BZ    @RF01745                                            1745 07326000
         LH    @02,CATRC                                           1745 07327000
         C     @02,@CF01280                                        1745 07328000
         BE    @RF01745                                            1745 07329000
*                        IF CATRC = CRCNOENT                       1746 07330000
*                                                                  1746 07331000
*                          /******************************************/ 07332000
*                          /*                                        */ 07333000
*                          /* IF AN ENTRY NOT FOUND CONDITION        */ 07334000
*                          /* OCCURRED FOR THIS LOCATE VIA A C.I.NO.,*/ 07335000
*                          /* PRINT THE VSAM CONDITION CODE MESSAGE  */ 07336000
*                          /* AND THE INVALID C.I.NO. MESSAGE.       */ 07337000
*                          /* UPDATE THE LISTC FINAL CONDITION CODE. */ 07338000
*                          /* CONTINUE PROCESSING THE OTHER DATASET  */ 07339000
*                          /* DIRECTORIES.                           */ 07340000
*                          /*                                        */ 07341000
*                          /******************************************/ 07342000
*                                                                  1746 07343000
*                          THEN                                    1746 07344000
         C     @02,@CF00187                                        1746 07345000
         BNE   @RF01746                                            1746 07346000
*                            DO;                                   1747 07347000
*                              CILOCFLG = ON;              /*@OZ09407*/ 07348000
         OI    CILOCFLG,B'10000000'                                1748 07349000
*                              CALL ERRPROC;                       1749 07350000
         BAL   @14,ERRPROC                                         1749 07351000
*                              CILOCFLG = OFF;             /*@OZ09407*/ 07352000
         NI    CILOCFLG,B'01111111'                                1750 07353000
*                              ERRARGPT->DARGSMOD = LC1ID;         1751 07354000
         L     @15,ERRARGPT                                        1751 07355000
         MVC   DARGSMOD(3,@15),@CC01297                            1751 07356000
*                              ERRARGPT->DARGSENT = LCMSG09;       1752 07357000
         MVI   DARGSENT(@15),X'09'                                 1752 07358000
*                              ERRARGPT->DARGDBP  = ADDR(VDSCI#);  1753 07359000
         LA    @14,VDSCI#(,VDIRPTR)                                1753 07360000
         ST    @14,DARGDBP(,@15)                                   1753 07361000
*                              ERRARGPT->DARGILP = LENGTH(VDSCI#); 1754 07362000
         MVC   DARGILP(2,@15),@CH00170                             1754 07363000
*                              CALL ERRPROC;                       1755 07364000
         BAL   @14,ERRPROC                                         1755 07365000
*                              SAVRC = MAX (SAVRC, LASTCC04);      1756 07366000
         LH    @15,SAVRC                                           1756 07367000
         LA    @14,4                                               1756 07368000
         CR    @15,@14                                             1756 07369000
         BNL   *+6                                                      07370000
         LR    @15,@14                                             1756 07371000
         STH   @15,SAVRC                                           1756 07372000
*                            END;                                  1757 07373000
*                                                                  1757 07374000
*                          /******************************************/ 07375000
*                          /*                                        */ 07376000
*                          /* FOR ALL OTHER UNRECOVERABLE LOCATE     */ 07377000
*                          /* ERROR CONDITIONS, TERMINATE PROCESSING */ 07378000
*                          /* OF THE SPACE ENTRY.  CLEAR THE SPECIAL */ 07379000
*                          /* CPL SAVEAREA INDICATOR AND RESET THE   */ 07380000
*                          /* CPL POINTER TO THE CPL FOR SUBSET      */ 07381000
*                          /* REQUESTS.  EXIT, RETURNING TO THE      */ 07382000
*                          /* ROUTING PROCEDURE.                     */ 07383000
*                          /*                                        */ 07384000
*                          /******************************************/ 07385000
*                                                                  1758 07386000
*                          ELSE                                    1758 07387000
*                            DO;                                   1758 07388000
         B     @RC01746                                            1758 07389000
@RF01746 DS    0H                                                  1759 07390000
*                              ENTNMFLG = OFF;                     1759 07391000
         NI    ENTNMFLG,B'01111111'                                1759 07392000
*                              CTGPLPTR = TYPCPLPT;                1760 07393000
         L     @04,TYPCPLPT                                        1760 07394000
         ST    @04,CTGPLPTR                                        1760 07395000
*                              RETURN CODE (SAVRC);        /*@ZA05939*/ 07396000
         LH    @15,SAVRC                                           1761 07397000
         L     @13,4(,@13)                                         1761 07398000
         L     @14,12(,@13)                                        1761 07399000
         LM    @00,@12,20(@13)                                     1761 07400000
         BR    @14                                                 1761 07401000
*                            END;                                  1762 07402000
*                      /**********************************************/ 07403000
*                      /*                                            */ 07404000
*                      /* THE LOCATE FOR THE DATASET NAME WAS        */ 07405000
*                      /* SUCCESSFUL.  BUILD THE DARGLIST TO LIST    */ 07406000
*                      /* THE NAME, INCLUDING FROM THE DIRECTORY     */ 07407000
*                      /* FIELDS, WHETHER THE DATASET IS A CANDIDATE */ 07408000
*                      /* AND THE NUMBER OF DATASET EXTENTS ASSIGNED */ 07409000
*                      /* IN THIS DATASPACE.                         */ 07410000
*                      /*                                            */ 07411000
*                      /**********************************************/ 07412000
*                                                                  1763 07413000
*                      ELSE                                        1763 07414000
*                        DO;                                       1763 07415000
         B     @RC01745                                            1763 07416000
@RF01745 DS    0H                                                  1764 07417000
*                          DARGSENT = LCST37;                      1764 07418000
         L     @15,DARGPTR                                         1764 07419000
         MVI   DARGSENT(@15),X'25'                                 1764 07420000
*                          DARGCNT = DRGCNT3;              /*@Y30SSMK*/ 07421000
         MVC   DARGCNT(2,@15),@CH00170                             1765 07422000
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/ 07423000
         LA    @14,10                                              1766 07424000
         STH   @14,DARGINS(,@15)                                   1766 07425000
*                          DARGINS(2) = DRGINS20;          /*@Y30SSMK*/ 07426000
         MVC   DARGINS+8(2,@15),@CH00649                           1767 07427000
*                          DARGINL(2) = ABBREVLN;                  1768 07428000
         STH   @14,DARGINL+8(,@15)                                 1768 07429000
*                          DARGINS(3) = DRGINS30;          /*@Y30SSMK*/ 07430000
         MVC   DARGINS+16(2,@15),@CH01231                          1769 07431000
*                          IF VDSCAN = ON                          1770 07432000
*                            THEN                                  1770 07433000
         TM    VDSCAN(VDIRPTR),B'10000000'                         1770 07434000
         BNO   @RF01770                                            1770 07435000
*                              DARGDTM(2) = ADDR(CANNM);           1771 07436000
         L     @01,TEXTPTR                                         1771 07437000
         LA    @14,CANNM(,@01)                                     1771 07438000
         ST    @14,DARGDTM+8(,@15)                                 1771 07439000
*                            ELSE                                  1772 07440000
*                              DARGDTM(2) = ADDR(NULLNM);          1772 07441000
         B     @RC01770                                            1772 07442000
@RF01770 L     @01,TEXTPTR                                         1772 07443000
         LA    @15,NULLNM(,@01)                                    1772 07444000
         L     @14,DARGPTR                                         1772 07445000
         ST    @15,DARGDTM+8(,@14)                                 1772 07446000
*                          DARGINL(3) = LENGTH(VX#(1));            1773 07447000
@RC01770 L     @15,DARGPTR                                         1773 07448000
         MVC   DARGINL+16(2,@15),@CH00045                          1773 07449000
*                          DARGDTM(3) = ADDR(VX#(VMM));            1774 07450000
*                                                                  1774 07451000
         LH    @14,VMM                                             1774 07452000
         MH    @14,@CH00170                                        1774 07453000
         LA    @14,VX#-3(@14,VDIRPTR)                              1774 07454000
         ST    @14,DARGDTM+16(,@15)                                1774 07455000
*                          /******************************************/ 07456000
*                          /*                                        */ 07457000
*                          /* DETERMINE IF THE DATASET NAME TO BE    */ 07458000
*                          /* LISTED WAS RETURNED IN THE SPECIALLY   */ 07459000
*                          /* FORMATTED WORKAREA.                    */ 07460000
*                          /*                                        */ 07461000
*                          /******************************************/ 07462000
*                                                                  1775 07463000
*                          IF CATRC ^= CRCBADPW                    1775 07464000
*                            THEN                                  1775 07465000
         CLC   CATRC(2),@CH01280                                   1775 07466000
         BE    @RF01775                                            1775 07467000
*                              DO;                                 1776 07468000
*                                DARGINL(1) = CTGFLNG(1);          1777 07469000
         L     @14,CTGFLPTR                                        1777 07470000
         L     @03,CTGFLNG(,@14)                                   1777 07471000
         STH   @03,DARGINL(,@15)                                   1777 07472000
*                                DARGDTM(1) = CTGFLPT(1);          1778 07473000
         L     @14,CTGFLPT(,@14)                                   1778 07474000
         ST    @14,DARGDTM(,@15)                                   1778 07475000
*                              END;                                1779 07476000
*                            ELSE                                  1780 07477000
*                              DO;                                 1780 07478000
         B     @RC01775                                            1780 07479000
@RF01775 DS    0H                                                  1781 07480000
*                                DARGINL(1) = LENGTH(SUPPDSNM);    1781 07481000
         L     @15,DARGPTR                                         1781 07482000
         MVC   DARGINL(2,@15),@CH00606                             1781 07483000
*                                DARGDTM(1) = ADDR(SUPPDSNM);      1782 07484000
         L     @01,CTGPLPTR                                        1782 07485000
         L     @01,CTGWKA(,@01)                                    1782 07486000
         LA    @14,SUPPDSNM(,@01)                                  1782 07487000
         ST    @14,DARGDTM(,@15)                                   1782 07488000
*                              END;                                1783 07489000
*                          CALL LISTPROC;                          1784 07490000
@RC01775 BAL   @14,LISTPROC                                        1784 07491000
*                        END;                                      1785 07492000
*                  END LISTDIR;                                    1786 07493000
@RC01745 DS    0H                                                  1787 07494000
*            END SS#CK;                                            1787 07495000
*                                                                  1787 07496000
@RF01725 LA    @15,1                                               1787 07497000
         AH    @15,VMM                                             1787 07498000
@DE01724 STH   @15,VMM                                             1787 07499000
         SLR   @01,@01                                             1787 07500000
         ICM   @01,3,VSS#LEN(VDIRPTR)                              1787 07501000
         SLR   @00,@00                                             1787 07502000
         D     @00,@CF00170                                        1787 07503000
         CR    @15,@01                                             1787 07504000
         BNH   @DL01724                                            1787 07505000
*            /********************************************************/ 07506000
*            /*                                                      */ 07507000
*            /* COMPUTE THE TOTAL LENGTH OF THE DATASET DIRECTORY    */ 07508000
*            /* JUST PROCESSED.  UPDATE THE POINTER TO THE NEXT      */ 07509000
*            /* DIRECTORY AND ADJUST THE DIRECTORY LENGTH USED AS A  */ 07510000
*            /* CONTROL VARIABLE TO DETERMINE IF THERE IS ANOTHER    */ 07511000
*            /* DIRECTORY TO BE PROCESSED.                           */ 07512000
*            /*                                                      */ 07513000
*            /********************************************************/ 07514000
*                                                                  1788 07515000
*            VWKA = LENGTH(VDSDIR) + VSS#LEN;                      1788 07516000
         LA    VWKA,9                                              1788 07517000
         SLR   @03,@03                                             1788 07518000
         ICM   @03,3,VSS#LEN(VDIRPTR)                              1788 07519000
         ALR   VWKA,@03                                            1788 07520000
*            VDIRLEN = VDIRLEN - VWKA;                             1789 07521000
         L     @03,VDIRLEN                                         1789 07522000
         SLR   @03,VWKA                                            1789 07523000
         ST    @03,VDIRLEN                                         1789 07524000
*            VDIRPTR = VDIRPTR + VWKA;                             1790 07525000
         ALR   VDIRPTR,VWKA                                        1790 07526000
*          END VDIR;                                               1791 07527000
*                                                                  1791 07528000
@DE01723 L     @15,VDIRLEN                                         1791 07529000
         C     @15,@CF00642                                        1791 07530000
         BNL   @DL01723                                            1791 07531000
*          /**********************************************************/ 07532000
*          /*                                                        */ 07533000
*          /* DATASET DIRECTORY PROCESSING IS COMPLETED.  CLEAR THE  */ 07534000
*          /* SPECIAL CPL SAVEAREA INDICATOR AND RESET THE CPL       */ 07535000
*          /* POINTER TO THE MAIN CPL SETUP FOR SUBSET REQUESTS.     */ 07536000
*          /*                                                        */ 07537000
*          /**********************************************************/ 07538000
*                                                                  1792 07539000
*          ENTNMFLG = OFF;                                         1792 07540000
         NI    ENTNMFLG,B'01111111'                                1792 07541000
*          CTGPLPTR = TYPCPLPT;                                    1793 07542000
         L     @15,TYPCPLPT                                        1793 07543000
         ST    @15,CTGPLPTR                                        1793 07544000
*          /**********************************************************/ 07545000
*          /*                                                        */ 07546000
*          /* UPDATE THE DATASPACE-HEADER POINTER TO THE NEXT GROUP  */ 07547000
*          /* OF DATASPACE FIELDS.  AND ADJUST THE DATASPACE-HEADER  */ 07548000
*          /* LENGTH USED AS A CONTROL VARIABLE TO DETERMINE IF      */ 07549000
*          /* THERE IS ANOTHER DATASPACE TO BE PROCESSED.            */ 07550000
*          /*                                                        */ 07551000
*          /**********************************************************/ 07552000
*                                                                  1794 07553000
*          VHDRLEN = VHDRLEN - LENGTH(VDSPHDR);                    1794 07554000
         LA    @15,23                                              1794 07555000
         SLR   VHDRLEN,@15                                         1794 07556000
*          VHDRPTR = VHDRPTR + LENGTH(VDSPHDR);                    1795 07557000
         AL    @15,VHDRPTR                                         1795 07558000
         ST    @15,VHDRPTR                                         1795 07559000
*        END VHDR;                                                 1796 07560000
*                                                                  1796 07561000
@DE01648 C     VHDRLEN,@CF00653                                    1796 07562000
         BNL   @DL01648                                            1796 07563000
*        /************************************************************/ 07564000
*        /*                                                          */ 07565000
*        /* EXIT FROM THE VOLUME ENTRY FORMATTING PROCEDURE.         */ 07566000
*        /* PROCESSING OF THE SPACE ENTRY IS COMPLETED.              */ 07567000
*        /*                                                          */ 07568000
*        /************************************************************/ 07569000
*                                                                  1797 07570000
*        RETURN CODE (0);                                          1797 07571000
         SLR   @15,@15                                             1797 07572000
         L     @13,4(,@13)                                         1797 07573000
         L     @14,12(,@13)                                        1797 07574000
         LM    @00,@12,20(@13)                                     1797 07575000
         BR    @14                                                 1797 07576000
*        END VPROC;                                                1798 07577000
*        /************************************************************/ 07578000
*        /*                                                  @YL026UE*/ 07579000
*        /* PROCEDURE - ANSVPROC                             @YL026UE*/ 07580000
*        /* FUNCTION - RETRIEVES THE LIST OF ASSOCIATED TYPES AND    */ 07581000
*        /* C.I. NUMBERS FROM THE WORKAREA AND CREATES A SAVE AREA   */ 07582000
*        /* COPY SINCE THE WORK AREA IS REUSED.              @YL026UE*/ 07583000
*        /*                                                  @YL026UE*/ 07584000
*        /* INPUT - THE FPL IDENTIFYING THE ASSOCIATIONS OF A        */ 07585000
*        /* CATALOG ENTRY.                                   @YL026UE*/ 07586000
*        /*                                                  @YL026UE*/ 07587000
*        /* OUTPUT - SAVEAREA COPY OF THE ASSOCIATED TYPES AND       */ 07588000
*        /* C.I. NUMBERS OR AN ERROR MESSAGE.                @YL026UE*/ 07589000
*        /*                                                  @YL026UE*/ 07590000
*        /************************************************************/ 07591000
*                                                                  1799 07592000
*ANSVPROC: PROCEDURE OPTIONS(SAVEAREA);                    /*@ZA05939*/ 07593000
*                                                                  1799 07594000
ANSVPROC STM   @14,@12,12(@13)                                     1799 07595000
         ST    @13,@SA00009+4                                      1799 07596000
         LA    @14,@SA00009                                        1799 07597000
         ST    @14,8(,@13)                                         1799 07598000
         LR    @13,@14                                             1799 07599000
*        GEN(ENTRY ANSVPROC);          /*EXT ENTRY POINT     @ZA05939*/ 07600000
         ENTRY ANSVPROC                                                 07601000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 07602000
*                                                                  1801 07603000
         LM    REG8,REG12,BASESAVE                                 1801 07604000
*        /************************************************************/ 07605000
*        /*                                                  @YL026UE*/ 07606000
*        /* LOCAL VARIABLES                                  @YL026UE*/ 07607000
*        /*                                                  @YL026UE*/ 07608000
*        /************************************************************/ 07609000
*                                                                  1802 07610000
*        DCL CASTRING  CHAR(*) BASED;  /*OVERLAY FOR STRING DATA     */ 07611000
*        DCL TEMPSAPT  PTR(31);        /*TEMP PTR FOR ASSOC SAVEAREA    07612000
*                                                            @Y30SSMK*/ 07613000
*        DCL TEMPSALN  FIXED(31);      /*TEMP LEN FOR ASSOC SAVEAREA    07614000
*                                                            @Y30SSMK*/ 07615000
*        DCL FLOFFSET  FIXED(31);                          /*@ZA00951*/ 07616000
*        DCL FLENGTH   FIXED(31);                          /*@ZA00951*/ 07617000
*        DCL MVLEN     FIXED(15) CONSTANT(256);            /*@Y30SSMK*/ 07618000
*                                      /*MAX MOVE LENGTH     @Y30SSMK*/ 07619000
*        DCL MVPOS     FIXED(15) CONSTANT(255);            /*@Y30SSMK*/ 07620000
*                                      /*MAX MOVE POSITION   @Y30SSMK*/ 07621000
*                                                                  1809 07622000
*        /************************************************************/ 07623000
*        /*                                                  @YL026UE*/ 07624000
*        /* POSITION TEMPORARY POINTER TO THE SAVEAREA AND   @Y30SSMK*/ 07625000
*        /* OBTAIN A LARGER STORAGE AREA SHOULD THE          @Y30SSMK*/ 07626000
*        /* STRING OF C.I. NUMBERS BE GREATER THAN THE       @Y30SSMK*/ 07627000
*        /* PRESENT SAVEAREA.                                @Y30SSMK*/ 07628000
*        /*                                                  @YL026UE*/ 07629000
*        /************************************************************/ 07630000
*                                                                  1809 07631000
*        OLDERID2 = NEWERID2;                                      1809 07632000
         L     @04,@PC00001                                        1809 07633000
         L     @04,GDTTR2(,@04)                                    1809 07634000
         MVC   @TS00001(95),NEWERID2(@04)                          1809 07635000
         MVC   OLDERID2(95,@04),@TS00001                           1809 07636000
*        NEWID2 = 'LCSA';                                  /*@YL026UE*/ 07637000
*                                                                  1810 07638000
         MVC   NEWID2(4,@04),@CC01691                              1810 07639000
*        CTGFLPTR = ASSOCFPT;                              /*@YL026UE*/ 07640000
         L     @04,ASSOCFPT                                        1811 07641000
         ST    @04,CTGFLPTR                                        1811 07642000
*        IF CTGFLPT(1) = NULLPTR                                   1812 07643000
*          THEN                                                    1812 07644000
         SLR   @15,@15                                             1812 07645000
         C     @15,CTGFLPT(,@04)                                   1812 07646000
         BNE   @RF01812                                            1812 07647000
*            DO;                       /*NO ASSOC RETURNED   @YL026UE*/ 07648000
*            ASSOC# = 0;                                   /*@YL026UE*/ 07649000
         STH   @15,ASSOC#                                          1814 07650000
*            RETURN CODE(0);                               /*@YL026UE*/ 07651000
         L     @13,4(,@13)                                         1815 07652000
         L     @14,12(,@13)                                        1815 07653000
         LM    @00,@12,20(@13)                                     1815 07654000
         BR    @14                                                 1815 07655000
*            END;                                          /*@YL026UE*/ 07656000
*        ASSOC# = CTGFLNG(1)/LENGTH(ASSOC);                /*@YL026UE*/ 07657000
@RF01812 L     @04,CTGFLPTR                                        1817 07658000
         L     @00,CTGFLNG(,@04)                                   1817 07659000
         SRDA  @00,32                                              1817 07660000
         D     @00,@CF00050                                        1817 07661000
         STH   @01,ASSOC#                                          1817 07662000
*        IF HOLDETYP = CTGTCL  |  HOLDETYP = CTGTAIX  |            1818 07663000
*          HOLDETYP = CTGTGBS                                      1818 07664000
*          THEN                                                    1818 07665000
         CLI   HOLDETYP,C'C'                                       1818 07666000
         BE    @RT01818                                            1818 07667000
         CLI   HOLDETYP,C'G'                                       1818 07668000
         BE    @RT01818                                            1818 07669000
         CLI   HOLDETYP,C'B'                                       1818 07670000
         BNE   @RF01818                                            1818 07671000
@RT01818 DS    0H                                                  1819 07672000
*            DO;                                           /*@Y30SSMK*/ 07673000
*              TEMPSAPT = CILSTPTR;                        /*@Y30SSMK*/ 07674000
         L     @04,CILSTPTR                                        1820 07675000
         ST    @04,TEMPSAPT                                        1820 07676000
*              TEMPSALN = CILSTLEN;                        /*@Y30SSMK*/ 07677000
         L     TEMPSALN,CILSTLEN                                   1821 07678000
*            END;                                          /*@Y30SSMK*/ 07679000
*          ELSE                                                    1823 07680000
*            DO;                                           /*@Y30SSMK*/ 07681000
         B     @RC01818                                            1823 07682000
@RF01818 DS    0H                                                  1824 07683000
*              TEMPSAPT = CIASOCPT;                        /*@Y30SSMK*/ 07684000
         L     @04,CIASOCPT                                        1824 07685000
         ST    @04,TEMPSAPT                                        1824 07686000
*              TEMPSALN = CIASOCLN;                        /*@Y30SSMK*/ 07687000
         L     TEMPSALN,CIASOCLN                                   1825 07688000
*            END;                                          /*@Y30SSMK*/ 07689000
*        IF CTGFLNG(1) > TEMPSALN                                  1827 07690000
*          THEN                                                    1827 07691000
@RC01818 L     @04,CTGFLPTR                                        1827 07692000
         L     @04,CTGFLNG(,@04)                                   1827 07693000
         CR    @04,TEMPSALN                                        1827 07694000
         BNH   @RF01827                                            1827 07695000
*            DO;                                           /*@YL026UE*/ 07696000
*              GPID = GPID09;                              /*@YL026UE*/ 07697000
         MVC   GPID(4),@CC01398                                    1829 07698000
*              GPLEN = CTGFLNG(1);                         /*@YL026UE*/ 07699000
         ST    @04,GPLEN                                           1830 07700000
*              CALL IDCSAGP0 (GDTTBL,                              1831 07701000
*                      GPLEN,                                      1831 07702000
*                      TEMPSAPT,                                   1831 07703000
*                      GPID,                                       1831 07704000
*                      SETZERO);                           /*@YL026UE*/ 07705000
         L     @04,@PC00001                                        1831 07706000
         ST    @04,@AL00001                                        1831 07707000
         LA    @02,GPLEN                                           1831 07708000
         ST    @02,@AL00001+4                                      1831 07709000
         LA    @02,TEMPSAPT                                        1831 07710000
         ST    @02,@AL00001+8                                      1831 07711000
         LA    @02,GPID                                            1831 07712000
         ST    @02,@AL00001+12                                     1831 07713000
         LA    @02,SETZERO                                         1831 07714000
         ST    @02,@AL00001+16                                     1831 07715000
         MVI   @AL00001+16,X'80'                                   1831 07716000
         L     @15,GDTGPL(,@04)                                    1831 07717000
         LA    @01,@AL00001                                        1831 07718000
         BALR  @14,@15                                             1831 07719000
*              RESPECIFY RTNREG RSTD;                              1832 07720000
*              TESTRC = RTNREG;                                    1833 07721000
         LR    TESTRC,RTNREG                                       1833 07722000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UE*/ 07723000
*              IF TESTRC ^= 0                                      1835 07724000
*                THEN                                              1835 07725000
*                                                                  1835 07726000
         SLR   @04,@04                                             1835 07727000
         CR    TESTRC,@04                                          1835 07728000
         BE    @RF01835                                            1835 07729000
*                  /**************************************************/ 07730000
*                  /*                                        @YL026UE*/ 07731000
*                  /* THE REQUEST FOR A LARGER STORAGE AREA FAILED.  */ 07732000
*                  /* SETUP THE LACKING WORKSPACE MSG.  SET THE NO.  */ 07733000
*                  /* OF ASSOCIATIONS TO ZERO.  UPDATE THE FINAL     */ 07734000
*                  /* LISTC CONDITION CODE.  BYPASS FURTHER  @YL026UE*/ 07735000
*                  /* PROCESSING OF THIS ENTRY AND EXIT FROM THE     */ 07736000
*                  /* PROCEDURE.  RETURN TO TTHE ROUTING PROCEDURE.  */ 07737000
*                  /*                                        @YL026UE*/ 07738000
*                  /**************************************************/ 07739000
*                                                                  1836 07740000
*                  DO;                                     /*@YL026UE*/ 07741000
*                    ASSOC# = 0;                           /*@YL026UE*/ 07742000
         STH   @04,ASSOC#                                          1837 07743000
*                    ERRARGPT->DARGSMOD = LC1ID;           /*@YL026UE*/ 07744000
         L     @04,ERRARGPT                                        1838 07745000
         MVC   DARGSMOD(3,@04),@CC01297                            1838 07746000
*                    ERRARGPT->DARGSENT = LCMSG02;         /*@YL026UE*/ 07747000
         MVI   DARGSENT(@04),X'02'                                 1839 07748000
*                    ERRARGPT->DARGDBP = ENT44FPT->CTGFLPT(1);     1840 07749000
         L     @15,ENT44FPT                                        1840 07750000
         L     @14,CTGFLPT(,@15)                                   1840 07751000
         ST    @14,DARGDBP(,@04)                                   1840 07752000
*                    ERRARGPT->DARGILP = ENT44FPT->CTGFLNG(1);     1841 07753000
         L     @15,CTGFLNG(,@15)                                   1841 07754000
         STH   @15,DARGILP(,@04)                                   1841 07755000
*                    SAVRC = MAX (SAVRC, LASTCC04);        /*@ZA05939*/ 07756000
         LH    @04,SAVRC                                           1842 07757000
         LA    @15,4                                               1842 07758000
         CR    @04,@15                                             1842 07759000
         BNL   *+6                                                      07760000
         LR    @04,@15                                             1842 07761000
         STH   @04,SAVRC                                           1842 07762000
*                    RETURN CODE (SAVRC);                  /*@ZA05939*/ 07763000
         LR    @15,@04                                             1843 07764000
         L     @13,4(,@13)                                         1843 07765000
         L     @14,12(,@13)                                        1843 07766000
         LM    @00,@12,20(@13)                                     1843 07767000
         BR    @14                                                 1843 07768000
*                  END;                                    /*@YL026UE*/ 07769000
*                ELSE                                              1845 07770000
*                                                                  1845 07771000
*                  /**************************************************/ 07772000
*                  /*                                        @YL026UE*/ 07773000
*                  /* THE STORAGE REQUEST WAS SUCCESSFUL.    @YL026UE*/ 07774000
*                  /* UPDATE THE SAVEAREA LENGTH TO THE LARGER       */ 07775000
*                  /* STORAGE SIZE AND RELEASE THE SMALLER AREA.     */ 07776000
*                  /*                                        @YL026UE*/ 07777000
*                  /**************************************************/ 07778000
*                                                                  1845 07779000
*                  DO;                                     /*@YL026UE*/ 07780000
@RF01835 DS    0H                                                  1846 07781000
*                    IF HOLDETYP = CTGTCL  |  HOLDETYP = CTGTAIX  |     07782000
*                      HOLDETYP = CTGTGBS                          1846 07783000
*                      THEN                                        1846 07784000
         CLI   HOLDETYP,C'C'                                       1846 07785000
         BE    @RT01846                                            1846 07786000
         CLI   HOLDETYP,C'G'                                       1846 07787000
         BE    @RT01846                                            1846 07788000
         CLI   HOLDETYP,C'B'                                       1846 07789000
         BNE   @RF01846                                            1846 07790000
@RT01846 DS    0H                                                  1847 07791000
*                        DO;                               /*@Y30SSMK*/ 07792000
*                          CILSTLEN = GPLEN;               /*@Y30SSMK*/ 07793000
         L     @04,GPLEN                                           1848 07794000
         ST    @04,CILSTLEN                                        1848 07795000
*                          CILSTPTR = TEMPSAPT;            /*@Y30SSMK*/ 07796000
         L     @04,TEMPSAPT                                        1849 07797000
         ST    @04,CILSTPTR                                        1849 07798000
*                          CALL IDCSAFP0 (GDTTBL,                  1850 07799000
*                                 'LC05');                 /*@Y30SSMK*/ 07800000
         L     @04,@PC00001                                        1850 07801000
         ST    @04,@AL00001                                        1850 07802000
         LA    @15,@CC01692                                        1850 07803000
         ST    @15,@AL00001+4                                      1850 07804000
         MVI   @AL00001+4,X'80'                                    1850 07805000
         L     @15,GDTFPL(,@04)                                    1850 07806000
         LA    @01,@AL00001                                        1850 07807000
         BALR  @14,@15                                             1850 07808000
*                        END;                              /*@Y30SSMK*/ 07809000
*                      ELSE                                        1852 07810000
*                        DO;                               /*@Y30SSMK*/ 07811000
         B     @RC01846                                            1852 07812000
@RF01846 DS    0H                                                  1853 07813000
*                          CIASOCLN = GPLEN;               /*@Y30SSMK*/ 07814000
         L     @04,GPLEN                                           1853 07815000
         ST    @04,CIASOCLN                                        1853 07816000
*                          CIASOCPT = TEMPSAPT;            /*@Y30SSMK*/ 07817000
         L     @04,TEMPSAPT                                        1854 07818000
         ST    @04,CIASOCPT                                        1854 07819000
*                          CALL IDCSAFP0 (GDTTBL,                  1855 07820000
*                                 'LC11');                 /*@Y30SSMK*/ 07821000
         L     @04,@PC00001                                        1855 07822000
         ST    @04,@AL00001                                        1855 07823000
         LA    @15,@CC01693                                        1855 07824000
         ST    @15,@AL00001+4                                      1855 07825000
         MVI   @AL00001+4,X'80'                                    1855 07826000
         L     @15,GDTFPL(,@04)                                    1855 07827000
         LA    @01,@AL00001                                        1855 07828000
         BALR  @14,@15                                             1855 07829000
*                        END;                              /*@Y30SSMK*/ 07830000
*                  END;                                    /*@YL026UE*/ 07831000
@RC01846 DS    0H                                                  1858 07832000
*            END;                                          /*@YL026UE*/ 07833000
*                                                                  1858 07834000
*        /************************************************************/ 07835000
*        /*                                                  @YL026UE*/ 07836000
*        /* SAVE THE LIST OF ASSOCIATED C.I.NOS. AND TYPES RETURNED  */ 07837000
*        /* IN THE WORKAREA.                                 @YL026UE*/ 07838000
*        /*                                                  @YL026UE*/ 07839000
*        /************************************************************/ 07840000
*                                                                  1859 07841000
*        FLOFFSET = 1;                                     /*@ZA00951*/ 07842000
@RF01827 LA    FLOFFSET,1                                          1859 07843000
*        FLENGTH = CTGFLNG(1);                             /*@ZA00951*/ 07844000
         L     @04,CTGFLPTR                                        1860 07845000
         L     FLENGTH,CTGFLNG(,@04)                               1860 07846000
*        DO WHILE FLENGTH > 0;                             /*@ZA00951*/ 07847000
         B     @DE01861                                            1861 07848000
@DL01861 DS    0H                                                  1862 07849000
*          IF FLENGTH >= MVLEN                             /*@ZA00951*/ 07850000
*            THEN                                          /*@ZA00951*/ 07851000
         LA    @04,256                                             1862 07852000
         CR    FLENGTH,@04                                         1862 07853000
         BL    @RF01862                                            1862 07854000
*              TEMPSAPT -> CASTRING(FLOFFSET:FLOFFSET+MVPOS) =     1863 07855000
*                CTGFLPT(1) -> CASTRING(FLOFFSET:MVLEN);   /*@ZA00951*/ 07856000
         L     @01,TEMPSAPT                                        1863 07857000
         ALR   @01,FLOFFSET                                        1863 07858000
         BCTR  @01,0                                               1863 07859000
         MVI   CASTRING+1(@01),C' '                                1863 07860000
         MVC   CASTRING+2(254,@01),CASTRING+1(@01)                 1863 07861000
         SLR   @04,FLOFFSET                                        1863 07862000
         L     @15,CTGFLPTR                                        1863 07863000
         L     @15,CTGFLPT(,@15)                                   1863 07864000
         ALR   @15,FLOFFSET                                        1863 07865000
         BCTR  @15,0                                               1863 07866000
         EX    @04,@SM01765                                        1863 07867000
*            ELSE                                          /*@ZA00951*/ 07868000
*              TEMPSAPT -> CASTRING(FLOFFSET:FLOFFSET+FLENGTH-1) = 1864 07869000
*                CTGFLPT(1) -> CASTRING(FLOFFSET:FLENGTH); /*@ZA00951*/ 07870000
         B     @RC01862                                            1864 07871000
@RF01862 L     @04,TEMPSAPT                                        1864 07872000
         ALR   @04,FLOFFSET                                        1864 07873000
         BCTR  @04,0                                               1864 07874000
         LR    @15,FLENGTH                                         1864 07875000
         BCTR  @15,0                                               1864 07876000
         L     @01,CTGFLPTR                                        1864 07877000
         L     @01,CTGFLPT(,@01)                                   1864 07878000
         ALR   @01,FLOFFSET                                        1864 07879000
         BCTR  @01,0                                               1864 07880000
         EX    @15,@SM01767                                        1864 07881000
*          FLOFFSET = FLOFFSET + MVLEN;                    /*@ZA00951*/ 07882000
@RC01862 LA    @04,256                                             1865 07883000
         ALR   FLOFFSET,@04                                        1865 07884000
*          FLENGTH  = FLENGTH - MVLEN;                     /*@ZA00951*/ 07885000
         SLR   FLENGTH,@04                                         1866 07886000
*        END;                                              /*@ZA00951*/ 07887000
*                                                                  1867 07888000
@DE01861 SLR   @04,@04                                             1867 07889000
         CR    FLENGTH,@04                                         1867 07890000
         BH    @DL01861                                            1867 07891000
*        /************************************************************/ 07892000
*        /*                                                  @YL026UE*/ 07893000
*        /* THE LIST OF ASSOCIATIONS IS NOW RETRIEVED. EXIT FROM     */ 07894000
*        /* THE ANSVPROC ROUTINE, RETURNING TO THE CALLING   @YL026UE*/ 07895000
*        /* PROCEDURE.                                       @YL026UE*/ 07896000
*        /*                                                  @YL026UE*/ 07897000
*        /************************************************************/ 07898000
*                                                                  1868 07899000
*        RETURN CODE(0);                                   /*@YL026UE*/ 07900000
         LR    @15,@04                                             1868 07901000
         L     @13,4(,@13)                                         1868 07902000
         L     @14,12(,@13)                                        1868 07903000
         LM    @00,@12,20(@13)                                     1868 07904000
         BR    @14                                                 1868 07905000
*        END ANSVPROC;                                     /*@YL026UE*/ 07906000
*        /************************************************************/ 07907000
*        /*                                                  @YL026UE*/ 07908000
*        /* PROCEDURE - ANLTPROC                             @YL026UE*/ 07909000
*        /*                                                  @YL026UE*/ 07910000
*        /* FUNCTION - RETRIEVES FROM THE CATALOG THE ASSOCIATED     */ 07911000
*        /* ENTRYNAMES VIA C.I. NOS., AND LISTS THESE ASSOCIATED     */ 07912000
*        /* ENTRYNAMES AND TYPES FOLLOWING THE ASSOCIATIONS  @YL026UE*/ 07913000
*        /* HEADER.                                          @YL026UE*/ 07914000
*        /*                                                  @YL026UE*/ 07915000
*        /* INPUT - SEPARATE CPL AND WORKAREA FOR RETREIVING AN      */ 07916000
*        /* ASSOCIATED ENTRYNAME, THE SAVEAREA LIST OF C.I. NOS.     */ 07917000
*        /* AND THE NUMBER OF ASSOCIATIONS.                  @YL026UE*/ 07918000
*        /*                                                  @YL026UE*/ 07919000
*        /* OUTPUT - A LISTING OF THE 44-BYTE ASSOCIATED ENTRYNAMES  */ 07920000
*        /* AND TYPES.                                       @YL026UE*/ 07921000
*        /*                                                  @YL026UE*/ 07922000
*        /************************************************************/ 07923000
*                                                                  1870 07924000
*ANLTPROC: PROCEDURE;                                      /*@YL026UE*/ 07925000
*                                                                  1870 07926000
ANLTPROC STM   @14,@12,@SA00010                                    1870 07927000
*        /************************************************************/ 07928000
*        /*                                                  @YL026UE*/ 07929000
*        /* LOCAL VARIABLES                                  @YL026UE*/ 07930000
*        /*                                                  @YL026UE*/ 07931000
*        /************************************************************/ 07932000
*                                                                  1871 07933000
*        DCL CLSTRING  CHAR(*) BASED;  /*OVERLAY FOR STRING  @YL026UE*/ 07934000
*        DCL CLT       FIXED(15);      /*DO GRP CONTROL VAR  @YL026UE*/ 07935000
*        DCL ASOCSAPT  PTR(31);        /*PTR TO ASSOC SAVEAREA     1873 07936000
*                                                            @Y30SSMK*/ 07937000
*        DCL CLFLDNO   FIXED(15) CONSTANT(2);              /*@Y30SSMK*/ 07938000
*                                      /*NO. OF FPL'S FOR CL ASSOC   */ 07939000
*                                                                  1875 07940000
*        /************************************************************/ 07941000
*        /*                                                  @YL026UE*/ 07942000
*        /* SETUP THE DARGLIST TO PRINT THE ASSOCIATIONS HEADER.     */ 07943000
*        /* IF NO ASSOCIATED C.I.NOS. WERE RETURNED FROM THE @YL026UE*/ 07944000
*        /* CATALOG, PRINT THE 'NULL' STATIC TEXT ENTRY WITH THE     */ 07945000
*        /* ASSOCIATIONS HEADER. OTHERWISE, PRINT THE ASSOCIATED     */ 07946000
*        /* ENTRYNAMES FOLLOWING THE ASSOCIATIONS HEADER.    @YL026UE*/ 07947000
*        /*                                                  @YL026UE*/ 07948000
*        /************************************************************/ 07949000
*                                                                  1875 07950000
*        DARGSENT = LCST35;                                /*@ZA05939*/ 07951000
         L     @04,DARGPTR                                         1875 07952000
         MVI   DARGSENT(@04),X'23'                                 1875 07953000
*        OLDERID2 = NEWERID2;                                      1876 07954000
         L     @15,@PC00001                                        1876 07955000
         L     @15,GDTTR2(,@15)                                    1876 07956000
         MVC   @TS00001(95),NEWERID2(@15)                          1876 07957000
         MVC   OLDERID2(95,@15),@TS00001                           1876 07958000
*        NEWID2 = 'LCLA';                                  /*@YL026UE*/ 07959000
         MVC   NEWID2(4,@15),@CC01701                              1877 07960000
*        IF ASSOC# <= 0                                            1878 07961000
*          THEN                                                    1878 07962000
         LH    @15,ASSOC#                                          1878 07963000
         LTR   @15,@15                                             1878 07964000
         BP    @RF01878                                            1878 07965000
*            DO;                                           /*@YL026UE*/ 07966000
*            DARGSENT = LCST17;                            /*@ZA05939*/ 07967000
         MVI   DARGSENT(@04),X'11'                                 1880 07968000
*            DARGCNT = DRGCNT1;                            /*@Y30SSMK*/ 07969000
         MVC   DARGCNT(2,@04),@CH00045                             1881 07970000
*            DARGINS(1) = DRGINS10;                        /*@Y30SSMK*/ 07971000
         LA    @15,10                                              1882 07972000
         STH   @15,DARGINS(,@04)                                   1882 07973000
*            DARGINL(1) = ABBREVLN;                        /*@YL026UE*/ 07974000
         STH   @15,DARGINL(,@04)                                   1883 07975000
*            DARGDTM(1) = ADDR(NULLNM);                    /*@YL026UE*/ 07976000
         L     @01,TEXTPTR                                         1884 07977000
         LA    @15,NULLNM(,@01)                                    1884 07978000
         ST    @15,DARGDTM(,@04)                                   1884 07979000
*            CALL LISTPROC;                                /*@YL026UE*/ 07980000
         BAL   @14,LISTPROC                                        1885 07981000
*            RETURN CODE(0);                               /*@YL026UE*/ 07982000
         SLR   @15,@15                                             1886 07983000
         L     @14,@SA00010                                        1886 07984000
         LM    @00,@12,@SA00010+8                                  1886 07985000
         BR    @14                                                 1886 07986000
*            END;                                          /*@YL026UE*/ 07987000
*          ELSE                                                    1888 07988000
*            IF DENTAFLG = OFF                                     1888 07989000
*              THEN                                                1888 07990000
@RF01878 TM    DENTAFLG,B'10000000'                                1888 07991000
         BNZ   @RF01888                                            1888 07992000
*                CALL LISTPROC;                            /*@YL026UE*/ 07993000
*                                                                  1889 07994000
         BAL   @14,LISTPROC                                        1889 07995000
*        /************************************************************/ 07996000
*        /*                                                  @YL026UE*/ 07997000
*        /* IF THE ASSOCIATION IS RELATED TO A NON-VSAM G0000V00     */ 07998000
*        /* ENTRY, THEN JUST LIST THE GDG BASE ASSOCIATION USING     */ 07999000
*        /* THIS PROCEDURE                                   @YL026UE*/ 08000000
*        /*                                                  @YL026UE*/ 08001000
*        /************************************************************/ 08002000
*                                                                  1890 08003000
*        IF ASSOC# > 0                                             1890 08004000
*          THEN                                                    1890 08005000
@RF01888 LH    @04,ASSOC#                                          1890 08006000
         LTR   @04,@04                                             1890 08007000
         BNP   @RF01890                                            1890 08008000
*            IF G0V0FLG = ON                                       1891 08009000
*              THEN                                                1891 08010000
         TM    G0V0FLG,B'10000000'                                 1891 08011000
         BNO   @RF01891                                            1891 08012000
*                ASSOC# = 1;                               /*@YL026UE*/ 08013000
*                                                                  1892 08014000
         MVC   ASSOC#(2),@CH00045                                  1892 08015000
*            /********************************************************/ 08016000
*            /*                                              @YL026UE*/ 08017000
*            /* INITIALIZE THE CPL POINTER TO ANOTHER CPL SETUP      */ 08018000
*            /* ESPECIALLY FOR ENTRYNAME REQUESTS VIA C.I.NOS.       */ 08019000
*            /*                                              @YL026UE*/ 08020000
*            /********************************************************/ 08021000
*                                                                  1893 08022000
*              CTGPLPTR = CI#CPLPT;                        /*@YL026UE*/ 08023000
@RF01891 DS    0H                                                  1893 08024000
@RF01890 L     @04,CI#CPLPT                                        1893 08025000
         ST    @04,CTGPLPTR                                        1893 08026000
*              IF HOLDETYP = CTGTCL  |  HOLDETYP = CTGTAIX  |      1894 08027000
*                HOLDETYP = CTGTGBS                                1894 08028000
*                THEN                                              1894 08029000
         CLI   HOLDETYP,C'C'                                       1894 08030000
         BE    @RT01894                                            1894 08031000
         CLI   HOLDETYP,C'G'                                       1894 08032000
         BE    @RT01894                                            1894 08033000
         CLI   HOLDETYP,C'B'                                       1894 08034000
         BNE   @RF01894                                            1894 08035000
@RT01894 DS    0H                                                  1895 08036000
*                  ASOCSAPT = CILSTPTR;                    /*@Y30SSMK*/ 08037000
         L     ASOCSAPT,CILSTPTR                                   1895 08038000
*                ELSE                                              1896 08039000
*                  ASOCSAPT = CIASOCPT;                    /*@Y30SSMK*/ 08040000
         B     @RC01894                                            1896 08041000
@RF01894 L     ASOCSAPT,CIASOCPT                                   1896 08042000
*              RESPECIFY ASSOC BASED(ASOCSAPT);            /*@Y30SSMK*/ 08043000
@RC01894 DS    0H                                                  1898 08044000
*              GASSOCSW = OFF;                             /*@Y30SSMK*/ 08045000
         NI    GASSOCSW,B'01111111'                                1898 08046000
*ASSOCS:       DO CLT = 1 TO ASSOC#;                       /*@YL026UE*/ 08047000
ASSOCS   LA    CLT,1                                               1899 08048000
         B     @DE01899                                            1899 08049000
@DL01899 DS    0H                                                  1900 08050000
*                IF KIND(CLT) ^= CTGTUPG                           1900 08051000
*                  THEN                                            1900 08052000
*                                                                  1900 08053000
         LR    @04,CLT                                             1900 08054000
         SLA   @04,2                                               1900 08055000
         ST    @04,@TF00001                                        1900 08056000
         ALR   @04,ASOCSAPT                                        1900 08057000
         AL    @04,@CF01769                                        1900 08058000
         CLI   KIND(@04),C'Y'                                      1900 08059000
         BE    @RF01900                                            1900 08060000
*                    /************************************************/ 08061000
*                    /*                                      @YL026UE*/ 08062000
*                    /* INITIALIZE AN FPL TO REQUEST THE     @YL026UE*/ 08063000
*                    /* 44-BYTE ASSOCIATED ENTRYNAME.        @YL026UE*/ 08064000
*                    /*                                      @YL026UE*/ 08065000
*                    /************************************************/ 08066000
*                                                                  1901 08067000
*                    DO;                                   /*@Y30SSMK*/ 08068000
*                      CTGFLPTR = ENT44FPT;                /*@YL026UE*/ 08069000
         L     @04,ENT44FPT                                        1902 08070000
         ST    @04,CTGFLPTR                                        1902 08071000
*                      CTGFLPTR->CLSTRING(1:LCFPLLEN) =            1903 08072000
*                        ZEROAREA(1:LCFPLLEN);                     1903 08073000
         SLR   @15,@15                                             1903 08074000
         IC    @15,LCFPLLEN                                        1903 08075000
         BCTR  @15,0                                               1903 08076000
         EX    @15,@SM01770                                        1903 08077000
*                      CTGFLDNO = 1;                       /*@YL026UE*/ 08078000
         MVI   CTGFLDNO(@04),X'01'                                 1904 08079000
*                      CTGFLDNM = ADDR(ENT44NM);           /*@YL026UE*/ 08080000
*                                                                  1905 08081000
*                                                                  1905 08082000
         LA    @14,ENT44NM                                         1905 08083000
         ST    @14,CTGFLDNM(,@04)                                  1905 08084000
*                      /**********************************************/ 08085000
*                      /*                                    @YL026UE*/ 08086000
*                      /* FOR A CLUSTER ASSOCIATION, THE PAGESPACE   */ 08087000
*                      /* ATTRIBUTE AS WELL AS THE ENTRY NAME WILL BE*/ 08088000
*                      /* LOCATED FROM THE CATALOG IN ORDER TO       */ 08089000
*                      /* DETERMINE IF THE ASSOCIATED TYPE SHOULD BE */ 08090000
*                      /* LISTED AS A CLUSTER OR PAGESPACE. THEREFORE*/ 08091000
*                      /* MODIFY THE CPL AND INITIALIZE THE          */ 08092000
*                      /* APPROPRIATE FPL.                   @YL026UE*/ 08093000
*                      /*                                    @YL026UE*/ 08094000
*                      /**********************************************/ 08095000
*                                                                  1906 08096000
*                      IF KIND(CLT) = CTGTCL                       1906 08097000
*                        THEN                                      1906 08098000
         LR    @04,ASOCSAPT                                        1906 08099000
         AL    @04,@TF00001                                        1906 08100000
         AL    @04,@CF01769                                        1906 08101000
         CLI   KIND(@04),C'C'                                      1906 08102000
         BNE   @RF01906                                            1906 08103000
*                          DO;                             /*@YL026UE*/ 08104000
*                          CTGNOFLD = CLFLDNO;             /*@Y30SSMK*/ 08105000
         L     @04,CTGPLPTR                                        1908 08106000
         MVI   CTGNOFLD(@04),X'02'                                 1908 08107000
*                          CTGFIELD(2) = CATTRFPT;         /*@YL026UE*/ 08108000
         L     @14,CATTRFPT                                        1909 08109000
         ST    @14,CTGFIELD+4(,@04)                                1909 08110000
*                          CTGFLPTR = CATTRFPT;            /*@YL026UE*/ 08111000
         ST    @14,CTGFLPTR                                        1910 08112000
*                          CTGFLPTR->CLSTRING(1:LCFPLLEN)=         1911 08113000
*                            ZEROAREA(1:LCFPLLEN);         /*@YL026UE*/ 08114000
         EX    @15,@SM01772                                        1911 08115000
*                          CTGFLDNO = 1;                   /*@YL026UE*/ 08116000
         MVI   CTGFLDNO(@14),X'01'                                 1912 08117000
*                          CTGFLDNM=ADDR(CATTRNM);         /*@YL026UE*/ 08118000
         LA    @04,CATTRNM                                         1913 08119000
         ST    @04,CTGFLDNM(,@14)                                  1913 08120000
*                          END;                            /*@YL026UE*/ 08121000
*                        ELSE                                      1915 08122000
*                          CTGNOFLD=1;                     /*@YL026UE*/ 08123000
*                                                                  1915 08124000
         B     @RC01906                                            1915 08125000
@RF01906 L     @04,CTGPLPTR                                        1915 08126000
         MVI   CTGNOFLD(@04),X'01'                                 1915 08127000
*                      /**********************************************/ 08128000
*                      /*                                    @YL026UE*/ 08129000
*                      /* INSERT THE ASSOCIATED C.I.NO. ADDRESS AND  */ 08130000
*                      /* TYPE IN THE CPL.  ALSO SET AN INDICATOR TO */ 08131000
*                      /* IDENTIFY WHICH CPL SAVEAREA IS TO USED     */ 08132000
*                      /* DURING THE LOCATE REQUEST OF AN    @YL026UE*/ 08133000
*                      /* ENTRYNAME ONLY.                    @YL026UE*/ 08134000
*                      /*                                    @YL026UE*/ 08135000
*                      /**********************************************/ 08136000
*                                                                  1916 08137000
*                      CTGENT = ADDR(CI#(CLT));            /*@YL026UE*/ 08138000
@RC01906 L     @04,CTGPLPTR                                        1916 08139000
         LR    @15,CLT                                             1916 08140000
         SLA   @15,2                                               1916 08141000
         AL    @15,@CF01774                                        1916 08142000
         LA    @15,CI#-1(@15,ASOCSAPT)                             1916 08143000
         ST    @15,CTGENT(,@04)                                    1916 08144000
*                      CTGPSWD = TYPCPLPT->CTGPSWD;        /*@YL026UE*/ 08145000
         L     @01,TYPCPLPT                                        1917 08146000
         L     @15,CTGPSWD(,@01)                                   1917 08147000
         ST    @15,CTGPSWD(,@04)                                   1917 08148000
*                      ENTNMFLG = ON;  /*LOCATE ENTRYNAME ONLY       */ 08149000
*                                                                  1918 08150000
         OI    ENTNMFLG,B'10000000'                                1918 08151000
*                      /**********************************************/ 08152000
*                      /*                                    @YL026UE*/ 08153000
*                      /* ISSUE THE LOCATE REQUEST FOR THE ASSOCIATED*/ 08154000
*                      /* ENTRYNAME.                         @YL026UE*/ 08155000
*                      /*                                    @YL026UE*/ 08156000
*                      /**********************************************/ 08157000
*                                                                  1919 08158000
*                      CALL LOCPROC (FPLEND,CACBFLG,ENTNMFLG);     1919 08159000
         LA    @04,FPLEND                                          1919 08160000
         ST    @04,@AL00001                                        1919 08161000
         LA    @04,CACBFLG                                         1919 08162000
         ST    @04,@AL00001+4                                      1919 08163000
         LA    @04,ENTNMFLG                                        1919 08164000
         ST    @04,@AL00001+8                                      1919 08165000
         LA    @01,@AL00001                                        1919 08166000
         BAL   @14,LOCPROC                                         1919 08167000
*                      RESPECIFY RTNREG RSTD;                      1920 08168000
*                      TESTRC = RTNREG;                            1921 08169000
         LR    TESTRC,RTNREG                                       1921 08170000
*                      RESPECIFY RTNREG UNRSTD;            /*@YL026UE*/ 08171000
*                                                                  1922 08172000
*                      /**********************************************/ 08173000
*                      /*                                    @YL026UE*/ 08174000
*                      /* IF THERE IS A NON-ZERO CATALOG RETURN CODE,*/ 08175000
*                      /* DETERMINE IF PASSWORD VERIFICATION FAILED. */ 08176000
*                      /* THIS IS NOT CONSIDERED AN ERROR WHEN       */ 08177000
*                      /* LISTING JUST ASSOCIATED ENTRYNAMES SINCE   */ 08178000
*                      /* THE NAME AND TYPE ARE STILL RETURNED IN THE*/ 08179000
*                      /* WORKAREA.                          @YL026UE*/ 08180000
*                      /*                                    @YL026UE*/ 08181000
*                      /**********************************************/ 08182000
*                                                                  1923 08183000
*                      IF TESTRC ^= 0 & CATRC ^= CRCBADPW          1923 08184000
*                        THEN                                      1923 08185000
         LTR   TESTRC,TESTRC                                       1923 08186000
         BZ    @RF01923                                            1923 08187000
         LH    @04,CATRC                                           1923 08188000
         C     @04,@CF01280                                        1923 08189000
         BE    @RF01923                                            1923 08190000
*                          IF CATRC = CRCNOENT                     1924 08191000
*                                                                  1924 08192000
*                            /****************************************/ 08193000
*                            /*                              @YL026UE*/ 08194000
*                            /* FOR AN ENTRY NOT FOUND CONDITION,    */ 08195000
*                            /* PRINT THE VSAM CAT CONDITION CODE MSG*/ 08196000
*                            /* AND THE INVALID C.I.NO. MSG.  UPDATE */ 08197000
*                            /* THE LISTC FINAL CONDITIONAL CODE.    */ 08198000
*                            /* BLANK THE INVALID ASSOCIATED ENTRY   */ 08199000
*                            /* IN THE SAVEAREA LIST. AND CONTINUE   */ 08200000
*                            /* PROCESSING THE LIST.         @YL026UE*/ 08201000
*                            /*                              @YL026UE*/ 08202000
*                            /****************************************/ 08203000
*                                                                  1924 08204000
*                            THEN                                  1924 08205000
         C     @04,@CF00187                                        1924 08206000
         BNE   @RF01924                                            1924 08207000
*                              DO;                         /*@YL026UE*/ 08208000
*                                CILOCFLG = ON;            /*@OZ09407*/ 08209000
         OI    CILOCFLG,B'10000000'                                1926 08210000
*                                CALL ERRPROC;             /*@YL026UE*/ 08211000
         BAL   @14,ERRPROC                                         1927 08212000
*                                CILOCFLG = OFF;           /*@OZ09407*/ 08213000
         NI    CILOCFLG,B'01111111'                                1928 08214000
*                                ERRARGPT->DARGSMOD = LC1ID;       1929 08215000
         L     @04,ERRARGPT                                        1929 08216000
         MVC   DARGSMOD(3,@04),@CC01297                            1929 08217000
*                                ERRARGPT->DARGSENT = LCMSG09;     1930 08218000
         MVI   DARGSENT(@04),X'09'                                 1930 08219000
*                                ERRARGPT->DARGDBP = ADDR(CI#(CLT));    08220000
         LR    @15,CLT                                             1931 08221000
         SLA   @15,2                                               1931 08222000
         AL    @15,@CF01774                                        1931 08223000
         LA    @15,CI#-1(@15,ASOCSAPT)                             1931 08224000
         ST    @15,DARGDBP(,@04)                                   1931 08225000
*                                ERRARGPT->DARGILP = LENGTH(CI#(CLT));  08226000
         MVC   DARGILP(2,@04),@CH00170                             1932 08227000
*                                CALL ERRPROC;             /*@YL026UE*/ 08228000
         BAL   @14,ERRPROC                                         1933 08229000
*                                SAVRC = MAX (SAVRC, LASTCC04);    1934 08230000
         LH    @04,SAVRC                                           1934 08231000
         LA    @15,4                                               1934 08232000
         CR    @04,@15                                             1934 08233000
         BNL   *+6                                                      08234000
         LR    @04,@15                                             1934 08235000
         STH   @04,SAVRC                                           1934 08236000
*                                ASSOC(CLT) = BLANK;       /*@YL026UE*/ 08237000
         LR    @04,CLT                                             1935 08238000
         SLA   @04,2                                               1935 08239000
         ALR   @04,ASOCSAPT                                        1935 08240000
         AL    @04,@CF01769                                        1935 08241000
         MVI   ASSOC+1(@04),C' '                                   1935 08242000
         MVC   ASSOC+2(2,@04),ASSOC+1(@04)                         1935 08243000
         MVI   ASSOC(@04),C' '                                     1935 08244000
*                              END;                        /*@YL026UE*/ 08245000
*                                                                  1936 08246000
*                            /****************************************/ 08247000
*                            /*                              @YL026UE*/ 08248000
*                            /* EXIT FOR ALL OTHER NON-ZERO CATALOG  */ 08249000
*                            /* RETURN CODES.  RESET THE CPL POINTER */ 08250000
*                            /* TO THE MAIN CPL SETUP FOR SUBSET     */ 08251000
*                            /* REQUEST.                     @YL026UE*/ 08252000
*                            /*                              @YL026UE*/ 08253000
*                            /****************************************/ 08254000
*                                                                  1937 08255000
*                            ELSE                                  1937 08256000
*                              DO;                         /*@YL026UE*/ 08257000
         B     @RC01924                                            1937 08258000
@RF01924 DS    0H                                                  1938 08259000
*                                CTGPLPTR = TYPCPLPT;      /*@YL026UE*/ 08260000
         L     @04,TYPCPLPT                                        1938 08261000
         ST    @04,CTGPLPTR                                        1938 08262000
*                                ENTNMFLG = OFF;           /*@YL026UE*/ 08263000
         NI    ENTNMFLG,B'01111111'                                1939 08264000
*                                RETURN CODE (SAVRC);      /*@ZA05939*/ 08265000
         LH    @15,SAVRC                                           1940 08266000
         L     @14,@SA00010                                        1940 08267000
         LM    @00,@12,@SA00010+8                                  1940 08268000
         BR    @14                                                 1940 08269000
*                              END;                        /*@YL026UE*/ 08270000
*                        /********************************************/ 08271000
*                        /*                                  @YL026UE*/ 08272000
*                        /* BUILD THE DARGLIST TO PRINT THE  @YL026UE*/ 08273000
*                        /* ASSOCIATED TYPE AND NAME.        @YL026UE*/ 08274000
*                        /*                                  @YL026UE*/ 08275000
*                        /********************************************/ 08276000
*                                                                  1942 08277000
*                        ELSE                                      1942 08278000
*                          DO;                             /*@YL026UE*/ 08279000
         B     @RC01923                                            1942 08280000
@RF01923 DS    0H                                                  1943 08281000
*                            DARGSENT = LCST18;            /*@YL026UE*/ 08282000
         L     @04,DARGPTR                                         1943 08283000
         MVI   DARGSENT(@04),X'12'                                 1943 08284000
*                            DARGCNT = DRGCNT2;            /*@Y30SSMK*/ 08285000
         MVC   DARGCNT(2,@04),@CH00161                             1944 08286000
*                            DARGINS(1) = DRGINS10;        /*@Y30SSMK*/ 08287000
         LA    @15,10                                              1945 08288000
         STH   @15,DARGINS(,@04)                                   1945 08289000
*                            DARGINL(1) = ABBREVLN;        /*@YL026UE*/ 08290000
*                                                                  1946 08291000
         STH   @15,DARGINL(,@04)                                   1946 08292000
*                            /****************************************/ 08293000
*                            /*                              @YL026UE*/ 08294000
*                            /* NOTE: THE TYPE, PAGESPACE, IS        */ 08295000
*                            /* RETURNED THE WORKAREA IF THE PASSWORD*/ 08296000
*                            /* VERIFICATION FAILED. OTHERWISE, THE  */ 08297000
*                            /* PAGESPACE ATTRIBUTE IS RETURNED      */ 08298000
*                            /* VIA THE CATTR FPL.           @YL026UE*/ 08299000
*                            /*                              @YL026UE*/ 08300000
*                            /****************************************/ 08301000
*                                                                  1947 08302000
*                            IF KIND(CLT) = CTGTCL                 1947 08303000
*                              THEN                                1947 08304000
         LR    @15,CLT                                             1947 08305000
         SLA   @15,2                                               1947 08306000
         ALR   @15,ASOCSAPT                                        1947 08307000
         AL    @15,@CF01769                                        1947 08308000
         CLI   KIND(@15),C'C'                                      1947 08309000
         BNE   @RF01947                                            1947 08310000
*                                DO;                       /*@YL026UE*/ 08311000
*                                IF CATRC ^= CRCBADPW              1949 08312000
*                                  THEN                            1949 08313000
         CLC   CATRC(2),@CH01280                                   1949 08314000
         BE    @RF01949                                            1949 08315000
*                                    IF CATTRFPT->CTGFLPT(1)->PGSPAC    08316000
*                                       ^= 'FF'X &           /*YM6557*/ 08317000
*                                       CATTRFPT->CTGFLPT(1)->PGSP=ON   08318000
*                                      THEN                        1950 08319000
         L     @01,CATTRFPT                                        1950 08320000
         L     @15,CTGFLPT(,@01)                                   1950 08321000
         CLI   PGSPAC(@15),X'FF'                                   1950 08322000
         BE    @RF01950                                            1950 08323000
         TM    PGSP(@15),B'00000001'                               1950 08324000
         BNO   @RF01950                                            1950 08325000
*                                        DO;               /*@YL026UE*/ 08326000
*                                        DARGDTM(1)= ADDR(PGSPCNM);     08327000
         L     @01,TEXTPTR                                         1952 08328000
         LA    @15,PGSPCNM(,@01)                                   1952 08329000
         ST    @15,DARGDTM(,@04)                                   1952 08330000
*                                        PGSPCFLG = ON;    /*@YL026UE*/ 08331000
         OI    PGSPCFLG,B'10000000'                                1953 08332000
*                                        END;              /*@YL026UE*/ 08333000
*                                      ELSE                        1955 08334000
*                                        DARGDTM(1)= ADDR(CLNM);   1955 08335000
         B     @RC01950                                            1955 08336000
@RF01950 L     @04,TEXTPTR                                         1955 08337000
         LA    @04,CLNM(,@04)                                      1955 08338000
         L     @01,DARGPTR                                         1955 08339000
         ST    @04,DARGDTM(,@01)                                   1955 08340000
*                                  ELSE                            1956 08341000
*                                    IF SUPPTYPE=CTGTPGSP          1956 08342000
*                                      THEN                        1956 08343000
         B     @RC01949                                            1956 08344000
@RF01949 L     @04,CTGPLPTR                                        1956 08345000
         L     @04,CTGWKA(,@04)                                    1956 08346000
         CLI   SUPPTYPE(@04),C'P'                                  1956 08347000
         BNE   @RF01956                                            1956 08348000
*                                        DO;               /*@YL026UE*/ 08349000
*                                        DARGDTM(1)= ADDR(PGSPCNM);     08350000
         L     @04,TEXTPTR                                         1958 08351000
         LA    @04,PGSPCNM(,@04)                                   1958 08352000
         L     @01,DARGPTR                                         1958 08353000
         ST    @04,DARGDTM(,@01)                                   1958 08354000
*                                        PGSPCFLG = ON;    /*@YL026UE*/ 08355000
         OI    PGSPCFLG,B'10000000'                                1959 08356000
*                                        END;              /*@YL026UE*/ 08357000
*                                      ELSE                        1961 08358000
*                                        DARGDTM(1)=ADDR(CLNM);    1961 08359000
         B     @RC01956                                            1961 08360000
@RF01956 L     @04,TEXTPTR                                         1961 08361000
         LA    @04,CLNM(,@04)                                      1961 08362000
         L     @01,DARGPTR                                         1961 08363000
         ST    @04,DARGDTM(,@01)                                   1961 08364000
*                                IF DENTAFLG = ON                  1962 08365000
*                                  THEN                            1962 08366000
@RC01956 DS    0H                                                  1962 08367000
@RC01949 TM    DENTAFLG,B'10000000'                                1962 08368000
         BNO   @RF01962                                            1962 08369000
*                                    RETURN CODE(SAVRC);   /*@ZA05939*/ 08370000
         LH    @15,SAVRC                                           1963 08371000
         L     @14,@SA00010                                        1963 08372000
         LM    @00,@12,@SA00010+8                                  1963 08373000
         BR    @14                                                 1963 08374000
*                                END;                      /*@YL026UE*/ 08375000
*                              ELSE                                1965 08376000
*                                IF KIND(CLT) = CTGTAIX            1965 08377000
*                                  THEN                            1965 08378000
         B     @RC01947                                            1965 08379000
@RF01947 LR    @04,CLT                                             1965 08380000
         SLA   @04,2                                               1965 08381000
         ALR   @04,ASOCSAPT                                        1965 08382000
         AL    @04,@CF01769                                        1965 08383000
         CLI   KIND(@04),C'G'                                      1965 08384000
         BNE   @RF01965                                            1965 08385000
*                                    DO;                   /*@Y30SSMK*/ 08386000
*                                      DARGDTM(1) =                1967 08387000
*                                        ADDR(AIXNM);      /*@Y30SSMK*/ 08388000
         L     @04,TEXTPTR                                         1967 08389000
         LA    @04,AIXNM(,@04)                                     1967 08390000
         L     @01,DARGPTR                                         1967 08391000
         ST    @04,DARGDTM(,@01)                                   1967 08392000
*                                      GASSOCSW = ON;      /*@Y30SSMK*/ 08393000
         OI    GASSOCSW,B'10000000'                                1968 08394000
*                                    END;                  /*@Y30SSMK*/ 08395000
*                                  ELSE                            1970 08396000
*                                    IF KIND(CLT) = CTGTDATA       1970 08397000
*                                      THEN                        1970 08398000
         B     @RC01965                                            1970 08399000
@RF01965 LR    @04,CLT                                             1970 08400000
         SLA   @04,2                                               1970 08401000
         ALR   @04,ASOCSAPT                                        1970 08402000
         AL    @04,@CF01769                                        1970 08403000
         CLI   KIND(@04),C'D'                                      1970 08404000
         BNE   @RF01970                                            1970 08405000
*                                        DARGDTM(1) =              1971 08406000
*                                          ADDR(DATANM);   /*@YL026UE*/ 08407000
         L     @04,TEXTPTR                                         1971 08408000
         LA    @04,DATANM(,@04)                                    1971 08409000
         L     @01,DARGPTR                                         1971 08410000
         ST    @04,DARGDTM(,@01)                                   1971 08411000
*                                      ELSE                        1972 08412000
*                                        IF KIND(CLT) = CTGTINDX   1972 08413000
*                                          THEN                    1972 08414000
         B     @RC01970                                            1972 08415000
@RF01970 LR    @04,CLT                                             1972 08416000
         SLA   @04,2                                               1972 08417000
         ALR   @04,ASOCSAPT                                        1972 08418000
         AL    @04,@CF01769                                        1972 08419000
         CLI   KIND(@04),C'I'                                      1972 08420000
         BNE   @RF01972                                            1972 08421000
*                                            DARGDTM(1) =          1973 08422000
*                                              ADDR(INDEXNM);      1973 08423000
         L     @04,TEXTPTR                                         1973 08424000
         LA    @04,INDEXNM(,@04)                                   1973 08425000
         L     @01,DARGPTR                                         1973 08426000
         ST    @04,DARGDTM(,@01)                                   1973 08427000
*                                      ELSE                        1974 08428000
*                                        IF KIND(CLT) = CTGTALIN   1974 08429000
*                                          THEN                    1974 08430000
         B     @RC01972                                            1974 08431000
@RF01972 LR    @04,CLT                                             1974 08432000
         SLA   @04,2                                               1974 08433000
         ALR   @04,ASOCSAPT                                        1974 08434000
         AL    @04,@CF01769                                        1974 08435000
         CLI   KIND(@04),C'A'                                      1974 08436000
         BNE   @RF01974                                            1974 08437000
*                                            DARGDTM(1) =          1975 08438000
*                                              ADDR(NVSAMNM);      1975 08439000
         L     @04,TEXTPTR                                         1975 08440000
         LA    @04,NVSAMNM(,@04)                                   1975 08441000
         L     @01,DARGPTR                                         1975 08442000
         ST    @04,DARGDTM(,@01)                                   1975 08443000
*                                      ELSE                        1976 08444000
*                                        IF KIND(CLT) = CTGTGBS    1976 08445000
*                                          THEN                    1976 08446000
         B     @RC01974                                            1976 08447000
@RF01974 LR    @04,CLT                                             1976 08448000
         SLA   @04,2                                               1976 08449000
         ALR   @04,ASOCSAPT                                        1976 08450000
         AL    @04,@CF01769                                        1976 08451000
         CLI   KIND(@04),C'B'                                      1976 08452000
         BNE   @RF01976                                            1976 08453000
*                                            DARGDTM(1) =          1977 08454000
*                                              ADDR(GDGNM);        1977 08455000
         L     @04,TEXTPTR                                         1977 08456000
         LA    @04,GDGNM(,@04)                                     1977 08457000
         L     @01,DARGPTR                                         1977 08458000
         ST    @04,DARGDTM(,@01)                                   1977 08459000
*                                      ELSE                        1978 08460000
*                                        IF KIND(CLT) = CTGTUCAT   1978 08461000
*                                          THEN                    1978 08462000
         B     @RC01976                                            1978 08463000
@RF01976 LR    @04,CLT                                             1978 08464000
         SLA   @04,2                                               1978 08465000
         ALR   @04,ASOCSAPT                                        1978 08466000
         AL    @04,@CF01769                                        1978 08467000
         CLI   KIND(@04),C'U'                                      1978 08468000
         BNE   @RF01978                                            1978 08469000
*                                            DARGDTM(1) =          1979 08470000
*                                              ADDR(UCATNM);       1979 08471000
         L     @04,TEXTPTR                                         1979 08472000
         LA    @04,UCATNM(,@04)                                    1979 08473000
         L     @01,DARGPTR                                         1979 08474000
         ST    @04,DARGDTM(,@01)                                   1979 08475000
*                                      ELSE                        1980 08476000
*                                        IF KIND(CLT) = CTGTANM    1980 08477000
*                                          THEN                    1980 08478000
         B     @RC01978                                            1980 08479000
@RF01978 LR    @04,CLT                                             1980 08480000
         SLA   @04,2                                               1980 08481000
         ALR   @04,ASOCSAPT                                        1980 08482000
         AL    @04,@CF01769                                        1980 08483000
         CLI   KIND(@04),C'X'                                      1980 08484000
         BNE   @RF01980                                            1980 08485000
*                                            DARGDTM(1) =          1981 08486000
*                                              ADDR(ALIASNM);      1981 08487000
         L     @04,TEXTPTR                                         1981 08488000
         LA    @04,ALIASNM(,@04)                                   1981 08489000
         L     @01,DARGPTR                                         1981 08490000
         ST    @04,DARGDTM(,@01)                                   1981 08491000
*                                      ELSE                        1982 08492000
*                                        IF KIND(CLT) = CTGTPTH    1982 08493000
*                                          THEN                    1982 08494000
         B     @RC01980                                            1982 08495000
@RF01980 LR    @04,CLT                                             1982 08496000
         SLA   @04,2                                               1982 08497000
         ALR   @04,ASOCSAPT                                        1982 08498000
         AL    @04,@CF01769                                        1982 08499000
         CLI   KIND(@04),C'R'                                      1982 08500000
         BNE   @RF01982                                            1982 08501000
*                                            DARGDTM(1) =          1983 08502000
*                                              ADDR(PATHNM);       1983 08503000
         L     @04,TEXTPTR                                         1983 08504000
         LA    @04,PATHNM(,@04)                                    1983 08505000
         L     @01,DARGPTR                                         1983 08506000
         ST    @04,DARGDTM(,@01)                                   1983 08507000
*                                          ELSE                    1984 08508000
*                                            DARGDTM(1)=           1984 08509000
*                                              ADDR(NULLNM);       1984 08510000
         B     @RC01982                                            1984 08511000
@RF01982 L     @04,TEXTPTR                                         1984 08512000
         LA    @04,NULLNM(,@04)                                    1984 08513000
         L     @01,DARGPTR                                         1984 08514000
         ST    @04,DARGDTM(,@01)                                   1984 08515000
*                            DARGINS(2) = DRGINS20;        /*@Y30SSMK*/ 08516000
*                                                                  1985 08517000
@RC01982 DS    0H                                                  1985 08518000
@RC01980 DS    0H                                                  1985 08519000
@RC01978 DS    0H                                                  1985 08520000
@RC01976 DS    0H                                                  1985 08521000
@RC01974 DS    0H                                                  1985 08522000
@RC01972 DS    0H                                                  1985 08523000
@RC01970 DS    0H                                                  1985 08524000
@RC01965 DS    0H                                                  1985 08525000
@RC01947 L     @04,DARGPTR                                         1985 08526000
         MVC   DARGINS+8(2,@04),@CH00649                           1985 08527000
*                            /****************************************/ 08528000
*                            /*                              @YL026UE*/ 08529000
*                            /* INSERT IN THE DARGLIST THE ASSOCIATED*/ 08530000
*                            /* NAME FROM THE SPECIALLY FORMATTED    */ 08531000
*                            /* WORKAREA DUE TO PASSWORD VERIFICATION*/ 08532000
*                            /* FAILURE.                     @YL026UE*/ 08533000
*                            /*                              @YL026UE*/ 08534000
*                            /****************************************/ 08535000
*                                                                  1986 08536000
*                            IF CATRC = CRCBADPW                   1986 08537000
*                              THEN                                1986 08538000
         CLC   CATRC(2),@CH01280                                   1986 08539000
         BNE   @RF01986                                            1986 08540000
*                                DO;                       /*@YL026UE*/ 08541000
*                                  ERRDARG = ZEROAREA;     /*@YL026UE*/ 08542000
         L     @01,ERRARGPT                                        1988 08543000
         MVC   ERRDARG(44,@01),ZEROAREA                            1988 08544000
*                                  DARGINL(2) = LENGTH(SUPPDSNM);  1989 08545000
         MVC   DARGINL+8(2,@04),@CH00606                           1989 08546000
*                                  DARGDTM(2) = ADDR(SUPPDSNM);    1990 08547000
         L     @01,CTGPLPTR                                        1990 08548000
         L     @01,CTGWKA(,@01)                                    1990 08549000
         LA    @15,SUPPDSNM(,@01)                                  1990 08550000
         ST    @15,DARGDTM+8(,@04)                                 1990 08551000
*                                END;                      /*@YL026UE*/ 08552000
*                              ELSE                                1992 08553000
*                                DO;                       /*@YL026UE*/ 08554000
         B     @RC01986                                            1992 08555000
@RF01986 DS    0H                                                  1993 08556000
*                                  CTGFLPTR = ENT44FPT;    /*@YL026UE*/ 08557000
         L     @04,ENT44FPT                                        1993 08558000
         ST    @04,CTGFLPTR                                        1993 08559000
*                                  DARGINL(2) = CTGFLNG(1);        1994 08560000
         L     @15,DARGPTR                                         1994 08561000
         L     @14,CTGFLNG(,@04)                                   1994 08562000
         STH   @14,DARGINL+8(,@15)                                 1994 08563000
*                                  DARGDTM(2) = CTGFLPT(1);        1995 08564000
         L     @04,CTGFLPT(,@04)                                   1995 08565000
         ST    @04,DARGDTM+8(,@15)                                 1995 08566000
*                                END;                      /*@YL026UE*/ 08567000
*                            CALL LISTPROC;                /*@YL026UE*/ 08568000
@RC01986 BAL   @14,LISTPROC                                        1997 08569000
*                          END;                            /*@YL026UE*/ 08570000
*                        END;                              /*@Y30SSMK*/ 08571000
@RC01923 DS    0H                                                  2000 08572000
*                    END ASSOCS;                           /*@YL026UE*/ 08573000
*                                                                  2000 08574000
@RF01900 AL    CLT,@CF00045                                        2000 08575000
@DE01899 CH    CLT,ASSOC#                                          2000 08576000
         BNH   @DL01899                                            2000 08577000
*                    /************************************************/ 08578000
*                    /*                                      @YL026UE*/ 08579000
*                    /* PROCESSING THE LIST OF ASSOCIATIONS IS       */ 08580000
*                    /* COMPLETED. RESTORE THE CPL POINTER TO THE    */ 08581000
*                    /* MAIN CPL SETUP FOR SUBSET REQUESTS.  CLEAR   */ 08582000
*                    /* THE ENTRYNAME LOCATE INDICATOR.      @YL026UE*/ 08583000
*                    /*                                      @YL026UE*/ 08584000
*                    /************************************************/ 08585000
*                                                                  2001 08586000
*                    CTGNOFLD = 1;                         /*@YL026UE*/ 08587000
         L     @04,CTGPLPTR                                        2001 08588000
         MVI   CTGNOFLD(@04),X'01'                                 2001 08589000
*                    CTGPLPTR = TYPCPLPT;                  /*@YL026UE*/ 08590000
         L     @04,TYPCPLPT                                        2002 08591000
         ST    @04,CTGPLPTR                                        2002 08592000
*                    RESPECIFY ASSOC BASED(CTGFLPT(1));    /*@YL026UE*/ 08593000
*                    ENTNMFLG = OFF;                       /*@YL026UE*/ 08594000
         NI    ENTNMFLG,B'01111111'                                2004 08595000
*                RETURN CODE(0);                           /*@YL026UE*/ 08596000
         SLR   @15,@15                                             2005 08597000
         L     @14,@SA00010                                        2005 08598000
         LM    @00,@12,@SA00010+8                                  2005 08599000
         BR    @14                                                 2005 08600000
*              END ANLTPROC;                               /*@YL026UE*/ 08601000
*        /************************************************************/ 08602000
*        /*                                                  @YL026UE*/ 08603000
*        /* PROCEDURE - ALSPROC                              @YL026UE*/ 08604000
*        /*                                                  @YL026UE*/ 08605000
*        /* FUNCTION - RETRIEVES FROM THE CATALOG THE ASSOCIATED     */ 08606000
*        /* ENTRYNAMES VIA C.I. NOS., AND LISTS THESE ASSOCIATED     */ 08607000
*        /* ENTRYNAMES AND TYPES FOLLOWING THE ASSOCIATIONS  @YL026UE*/ 08608000
*        /* HEADER FOR ALIAS ENTRIES                         @YL026UE*/ 08609000
*        /*                                                  @YL026UE*/ 08610000
*        /* INPUT - SEPARATE CPL AND WORKAREA FOR RETREIVING AN      */ 08611000
*        /* ASSOCIATED ENTRYNAME, AND THE FIRST CI# AND TYPE OF      */ 08612000
*        /* THE ALIAS ASSOCIATION STRING OR REAL NAME.       @YL026UE*/ 08613000
*        /*                                                  @YL026UE*/ 08614000
*        /* OUTPUT - A LISTING OF THE 44-BYTE ASSOCIATED ENTRYNAMES  */ 08615000
*        /* AND TYPES.                                       @YL026UE*/ 08616000
*        /*                                                  @YL026UE*/ 08617000
*        /************************************************************/ 08618000
*                                                                  2007 08619000
*ALSPROC: PROCEDURE;                                       /*@YL026UE*/ 08620000
*                                                                  2007 08621000
ALSPROC  STM   @14,@12,@SA00011                                    2007 08622000
*        /************************************************************/ 08623000
*        /*                                                  @YL026UE*/ 08624000
*        /* LOCAL VARIABLES                                  @YL026UE*/ 08625000
*        /*                                                  @YL026UE*/ 08626000
*        /************************************************************/ 08627000
*                                                                  2008 08628000
*        DCL ALSTRING  CHAR(*) BASED;  /*OVERLAY FOR STRING  @YL026UE*/ 08629000
*        DCL INITFLG   BIT(1) BDY(BYTE); /*INITIAL ENTRY TO DO LOOP     08630000
*                                                            @YL026UE*/ 08631000
*        DCL NXTNAMFG  BIT(1) BDY(BYTE); /*ALIAS NAME STRING CONTINUES  08632000
*                                                            @YL026UE*/ 08633000
*        DCL ASFLDNO   FIXED(15) CONSTANT(3);              /*@Y30SSMK*/ 08634000
*                                        /*NO. OF FPLS FOR ALIAS ASSOC  08635000
*                                                            @Y30SSMK*/ 08636000
*                                                                  2012 08637000
*        /************************************************************/ 08638000
*        /*                                                  @YL026UE*/ 08639000
*        /* SETUP THE DARGLIST TO PRINT THE ASSOCIATIONS HEADER.     */ 08640000
*        /* IF NO ASSOCIATED C.I.NOS. WERE RETURNED FROM THE @YL026UE*/ 08641000
*        /* CATALOG, PRINT THE 'NULL' STATIC TEXT ENTRY WITH THE     */ 08642000
*        /* ASSOCIATIONS HEADER. OTHERWISE, PRINT THE ASSOCIATED     */ 08643000
*        /* ENTRYNAMES FOLLOWING THE ASSOCIATIONS HEADER.    @YL026UE*/ 08644000
*        /*                                                  @YL026UE*/ 08645000
*        /************************************************************/ 08646000
*                                                                  2012 08647000
*        DARGSENT = LCST35;                                /*@ZA05939*/ 08648000
         L     @04,DARGPTR                                         2012 08649000
         MVI   DARGSENT(@04),X'23'                                 2012 08650000
*        OLDERID2 = NEWERID2;                                      2013 08651000
         L     @15,@PC00001                                        2013 08652000
         L     @15,GDTTR2(,@15)                                    2013 08653000
         MVC   @TS00001(95),NEWERID2(@15)                          2013 08654000
         MVC   OLDERID2(95,@15),@TS00001                           2013 08655000
*        NEWID2 = 'LCAS';                                  /*@YL026UE*/ 08656000
         MVC   NEWID2(4,@15),@CC01714                              2014 08657000
*        NXTNAMFG = ON;                                    /*@YL026UE*/ 08658000
         OI    NXTNAMFG,B'10000000'                                2015 08659000
*        INITFLG = ON;                                     /*@YL026UE*/ 08660000
         OI    INITFLG,B'10000000'                                 2016 08661000
*        CTGFLPTR = ASSOCFPT;                              /*@YL026UE*/ 08662000
         L     @15,ASSOCFPT                                        2017 08663000
         ST    @15,CTGFLPTR                                        2017 08664000
*        IF CTGFLNG(1) <= 0 & G0V0FLG = OFF                        2018 08665000
*          THEN                                                    2018 08666000
         L     @15,CTGFLNG(,@15)                                   2018 08667000
         LTR   @15,@15                                             2018 08668000
         BP    @RF02018                                            2018 08669000
         TM    G0V0FLG,B'10000000'                                 2018 08670000
         BNZ   @RF02018                                            2018 08671000
*            DO;                                           /*@YL026UE*/ 08672000
*            DARGSENT = LCST17;                            /*@ZA05939*/ 08673000
         MVI   DARGSENT(@04),X'11'                                 2020 08674000
*            DARGCNT = DRGCNT1;                            /*@Y30SSMK*/ 08675000
         MVC   DARGCNT(2,@04),@CH00045                             2021 08676000
*            DARGINS(1) = DRGINS10;                        /*@Y30SSMK*/ 08677000
         LA    @15,10                                              2022 08678000
         STH   @15,DARGINS(,@04)                                   2022 08679000
*            DARGINL(1) = ABBREVLN;                        /*@YL026UE*/ 08680000
         STH   @15,DARGINL(,@04)                                   2023 08681000
*            DARGDTM(1) = ADDR(NULLNM);                    /*@YL026UE*/ 08682000
         L     @01,TEXTPTR                                         2024 08683000
         LA    @15,NULLNM(,@01)                                    2024 08684000
         ST    @15,DARGDTM(,@04)                                   2024 08685000
*            CALL LISTPROC;                                /*@YL026UE*/ 08686000
         BAL   @14,LISTPROC                                        2025 08687000
*            RETURN CODE(0);                               /*@YL026UE*/ 08688000
         SLR   @15,@15                                             2026 08689000
         L     @14,@SA00011                                        2026 08690000
         LM    @00,@12,@SA00011+8                                  2026 08691000
         BR    @14                                                 2026 08692000
*            END;                                          /*@YL026UE*/ 08693000
*          ELSE                                                    2028 08694000
*            IF G0V0FLG = OFF                                      2028 08695000
*              THEN                                                2028 08696000
@RF02018 TM    G0V0FLG,B'10000000'                                 2028 08697000
         BNZ   @RF02028                                            2028 08698000
*                CALL LISTPROC;                            /*@YL026UE*/ 08699000
*                                                                  2029 08700000
         BAL   @14,LISTPROC                                        2029 08701000
*            /********************************************************/ 08702000
*            /*                                              @YL026UE*/ 08703000
*            /* INITIALIZE THE CPL POINTER TO ANOTHER CPL SETUP      */ 08704000
*            /* ESPECIALLY FOR ENTRYNAME REQUESTS VIA C.I.NOS.       */ 08705000
*            /*                                              @YL026UE*/ 08706000
*            /********************************************************/ 08707000
*                                                                  2030 08708000
*              IF G0V0FLG = OFF                                    2030 08709000
*                THEN                                              2030 08710000
@RF02028 TM    G0V0FLG,B'10000000'                                 2030 08711000
         BNZ   @RF02030                                            2030 08712000
*                  DO;                                     /*@YL026UE*/ 08713000
*                  ALIASCI# = CI#(1);                      /*@YL026UE*/ 08714000
         L     @04,CTGFLPTR                                        2032 08715000
         L     @04,CTGFLPT(,@04)                                   2032 08716000
         MVC   ALIASCI#(3),CI#(@04)                                2032 08717000
*                  ALIASKND = KIND(1);                     /*@YL026UE*/ 08718000
         MVC   ALIASKND(1),KIND(@04)                               2033 08719000
*                  END;                                    /*@YL026UE*/ 08720000
*              IF HOLDETYP = CTGTANM                               2035 08721000
*                THEN                                              2035 08722000
@RF02030 CLI   HOLDETYP,C'X'                                       2035 08723000
         BNE   @RF02035                                            2035 08724000
*                  NXTNAMFG = OFF;                         /*@YL026UE*/ 08725000
         NI    NXTNAMFG,B'01111111'                                2036 08726000
*              CTGPLPTR = CI#CPLPT;                        /*@YL026UE*/ 08727000
@RF02035 L     @04,CI#CPLPT                                        2037 08728000
         ST    @04,CTGPLPTR                                        2037 08729000
*ALIASLP:      DO WHILE(NXTNAMFG = ON | INITFLG = ON);     /*@YL026UE*/ 08730000
*                                                                  2038 08731000
ALIASLP  B     @DE02038                                            2038 08732000
@DL02038 DS    0H                                                  2039 08733000
*                INITFLG = OFF;                            /*@YL026UE*/ 08734000
         NI    INITFLG,B'01111111'                                 2039 08735000
*                /****************************************************/ 08736000
*                /*                                          @YL026UE*/ 08737000
*                /* INSERT THE ASSOCIATED C.I.NO. ADDRESS AND TYPE   */ 08738000
*                /* IN THE CPL.  ALSO SET AN INDICATOR TO IDENTIFY   */ 08739000
*                /* WHICH CPL SAVEAREA IS TO USED DURING THE LOCATE  */ 08740000
*                /* REQUEST OF AN ENTRYNAME ONLY.            @YL026UE*/ 08741000
*                /*                                          @YL026UE*/ 08742000
*                /****************************************************/ 08743000
*                                                                  2040 08744000
*                CTGPSWD = TYPCPLPT->CTGPSWD;              /*@YL026UE*/ 08745000
         L     @04,CTGPLPTR                                        2040 08746000
         L     @01,TYPCPLPT                                        2040 08747000
         L     @15,CTGPSWD(,@01)                                   2040 08748000
         ST    @15,CTGPSWD(,@04)                                   2040 08749000
*                CTGENT = ADDR(ALIASCI#);                  /*@YL026UE*/ 08750000
         LA    @15,ALIASCI#                                        2041 08751000
         ST    @15,CTGENT(,@04)                                    2041 08752000
*                ENTNMFLG = ON;        /*LOCATE ENTRYNAME ONLY       */ 08753000
*                                                                  2042 08754000
         OI    ENTNMFLG,B'10000000'                                2042 08755000
*                /****************************************************/ 08756000
*                /*                                          @YL026UE*/ 08757000
*                /* INITIALIZE THE REQUIRED FPLS             @YL026UE*/ 08758000
*                /*                                          @YL026UE*/ 08759000
*                /****************************************************/ 08760000
*                                                                  2043 08761000
*                CTGFLPTR = ENT44FPT;                      /*@YL026UE*/ 08762000
         L     @15,ENT44FPT                                        2043 08763000
         ST    @15,CTGFLPTR                                        2043 08764000
*                CTGFLPTR->ALSTRING(1:LCFPLLEN) = ZEROAREA(1:LCFPLLEN); 08765000
         SLR   @14,@14                                             2044 08766000
         IC    @14,LCFPLLEN                                        2044 08767000
         BCTR  @14,0                                               2044 08768000
         EX    @14,@SM01775                                        2044 08769000
*                CTGFLDNO = 1;                             /*@YL026UE*/ 08770000
         MVI   CTGFLDNO(@15),X'01'                                 2045 08771000
*                CTGFLDNM = ADDR(ENT44NM);                 /*@YL026UE*/ 08772000
*                                                                  2046 08773000
*                                                                  2046 08774000
*                                                                  2046 08775000
         LA    @07,ENT44NM                                         2046 08776000
         ST    @07,CTGFLDNM(,@15)                                  2046 08777000
*                CTGFIELD(2) = CATTRFPT;                   /*@YL026UE*/ 08778000
         L     @15,CATTRFPT                                        2047 08779000
         ST    @15,CTGFIELD+4(,@04)                                2047 08780000
*                CTGFLPTR = CATTRFPT;                      /*@YL026UE*/ 08781000
         ST    @15,CTGFLPTR                                        2048 08782000
*                CTGFLPTR->ALSTRING(1:LCFPLLEN)=                   2049 08783000
*                  ZEROAREA(1:LCFPLLEN);                   /*@YL026UE*/ 08784000
         EX    @14,@SM01775                                        2049 08785000
*                CTGFLDNO = 1;                             /*@YL026UE*/ 08786000
         MVI   CTGFLDNO(@15),X'01'                                 2050 08787000
*                CTGFLDNM=ADDR(CATTRNM);                   /*@YL026UE*/ 08788000
*                                                                  2051 08789000
         LA    @07,CATTRNM                                         2051 08790000
         ST    @07,CTGFLDNM(,@15)                                  2051 08791000
*                CTGNOFLD = ASFLDNO;                       /*@Y30SSMK*/ 08792000
         MVI   CTGNOFLD(@04),X'03'                                 2052 08793000
*                CTGFIELD(3) = ASSOCFPT;                   /*@YL026UE*/ 08794000
         L     @15,ASSOCFPT                                        2053 08795000
         ST    @15,CTGFIELD+8(,@04)                                2053 08796000
*                CTGFLPTR = ASSOCFPT;                      /*@YL026UE*/ 08797000
         ST    @15,CTGFLPTR                                        2054 08798000
*                CTGFLPTR ->ALSTRING(1:LCFPLLEN)=                  2055 08799000
*                  ZEROAREA(1:LCFPLLEN);                   /*@YL026UE*/ 08800000
         EX    @14,@SM01775                                        2055 08801000
*                CTGFLDNO = 1;                             /*@YL026UE*/ 08802000
         MVI   CTGFLDNO(@15),X'01'                                 2056 08803000
*                CTGFLDNM = ADDR(ASSOCNM);                 /*@YL026UE*/ 08804000
*                                                                  2057 08805000
         LA    @04,ASSOCNM                                         2057 08806000
         ST    @04,CTGFLDNM(,@15)                                  2057 08807000
*                /****************************************************/ 08808000
*                /*                                          @YL026UE*/ 08809000
*                /* ISSUE THE LOCATE REQUEST FOR THE ASSOCIATED      */ 08810000
*                /* ENTRYNAME.                               @YL026UE*/ 08811000
*                /*                                          @YL026UE*/ 08812000
*                /****************************************************/ 08813000
*                                                                  2058 08814000
*                CALL LOCPROC (FPLEND,CACBFLG,ENTNMFLG);   /*@YL026UE*/ 08815000
         LA    @04,FPLEND                                          2058 08816000
         ST    @04,@AL00001                                        2058 08817000
         LA    @04,CACBFLG                                         2058 08818000
         ST    @04,@AL00001+4                                      2058 08819000
         LA    @04,ENTNMFLG                                        2058 08820000
         ST    @04,@AL00001+8                                      2058 08821000
         LA    @01,@AL00001                                        2058 08822000
         BAL   @14,LOCPROC                                         2058 08823000
*                RESPECIFY RTNREG RSTD;                            2059 08824000
*                TESTRC = RTNREG;                                  2060 08825000
         LR    TESTRC,RTNREG                                       2060 08826000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UE*/ 08827000
*                                                                  2061 08828000
*                /****************************************************/ 08829000
*                /*                                          @YL026UE*/ 08830000
*                /* IF THERE IS A NON-ZERO CATALOG RETURN CODE,      */ 08831000
*                /* PROCESS AS INDICATED BELOW, NO MORE      @YL026UE*/ 08832000
*                /* ASSOCIATIONS CAN BE LISTED.              @YL026UE*/ 08833000
*                /*                                          @YL026UE*/ 08834000
*                /****************************************************/ 08835000
*                                                                  2062 08836000
*                IF TESTRC ^= 0                                    2062 08837000
*                  THEN                                            2062 08838000
         LTR   TESTRC,TESTRC                                       2062 08839000
         BZ    @RF02062                                            2062 08840000
*                    IF CATRC = CRCNOENT                           2063 08841000
*                                                                  2063 08842000
*                      /**********************************************/ 08843000
*                      /*                                    @YL026UE*/ 08844000
*                      /* FOR AN ENTRY NOT FOUND CONDITION, PRINT    */ 08845000
*                      /* THE VSAM CAT CONDITION CODE MSG AND THE    */ 08846000
*                      /* INVALID C.I.NO. MSG.  UPDATE THE LISTC     */ 08847000
*                      /* FINAL CONDITIONAL CODE.            @YL026UE*/ 08848000
*                      /* NO MORE ASSOCIATIONS CAN BE OBTAINED.      */ 08849000
*                      /* STOP PROCESSING ASSOCIATION OF THIS        */ 08850000
*                      /* ENTRY NAME.                        @YL026UE*/ 08851000
*                      /*                                    @YL026UE*/ 08852000
*                      /**********************************************/ 08853000
*                                                                  2063 08854000
*                      THEN                                        2063 08855000
         CLC   CATRC(2),@CH00187                                   2063 08856000
         BNE   @RF02063                                            2063 08857000
*                        DO;                               /*@YL026UE*/ 08858000
*                          CILOCFLG = ON;                  /*@OZ09407*/ 08859000
         OI    CILOCFLG,B'10000000'                                2065 08860000
*                          CALL ERRPROC;                   /*@YL026UE*/ 08861000
         BAL   @14,ERRPROC                                         2066 08862000
*                          CILOCFLG = OFF;                 /*@OZ09407*/ 08863000
         NI    CILOCFLG,B'01111111'                                2067 08864000
*                          ERRARGPT->DARGSMOD = LC1ID;     /*@YL026UE*/ 08865000
         L     @04,ERRARGPT                                        2068 08866000
         MVC   DARGSMOD(3,@04),@CC01297                            2068 08867000
*                          ERRARGPT->DARGSENT = LCMSG09;   /*@YL026UE*/ 08868000
         MVI   DARGSENT(@04),X'09'                                 2069 08869000
*                          ERRARGPT->DARGDBP = ADDR(ALIASCI#);     2070 08870000
         LA    @15,ALIASCI#                                        2070 08871000
         ST    @15,DARGDBP(,@04)                                   2070 08872000
*                          ERRARGPT->DARGILP = LENGTH(ALIASCI#);   2071 08873000
         MVC   DARGILP(2,@04),@CH00170                             2071 08874000
*                          CALL ERRPROC;                   /*@YL026UE*/ 08875000
         BAL   @14,ERRPROC                                         2072 08876000
*                          SAVRC = MAX (SAVRC, LASTCC04);  /*@ZA05939*/ 08877000
         LH    @04,SAVRC                                           2073 08878000
         LA    @15,4                                               2073 08879000
         CR    @04,@15                                             2073 08880000
         BNL   *+6                                                      08881000
         LR    @04,@15                                             2073 08882000
         STH   @04,SAVRC                                           2073 08883000
*                          CTGNOFLD = 1;                   /*@YL026UE*/ 08884000
         L     @01,CTGPLPTR                                        2074 08885000
         MVI   CTGNOFLD(@01),X'01'                                 2074 08886000
*                          CTGPLPTR = TYPCPLPT;            /*@YL026UE*/ 08887000
         L     @15,TYPCPLPT                                        2075 08888000
         ST    @15,CTGPLPTR                                        2075 08889000
*                          ENTNMFLG = OFF;                 /*@YL026UE*/ 08890000
         NI    ENTNMFLG,B'01111111'                                2076 08891000
*                          RETURN CODE(SAVRC);             /*@ZA05939*/ 08892000
         LR    @15,@04                                             2077 08893000
         L     @14,@SA00011                                        2077 08894000
         LM    @00,@12,@SA00011+8                                  2077 08895000
         BR    @14                                                 2077 08896000
*                        END;                              /*@YL026UE*/ 08897000
*                                                                  2078 08898000
*                      /**********************************************/ 08899000
*                      /*                                    @YL026UE*/ 08900000
*                      /* EXIT FOR ALL OTHER NON-ZERO CATALOG RETURN */ 08901000
*                      /* CODES.  RESET THE CPL POINTER TO THE MAIN  */ 08902000
*                      /* CPL SETUP FOR SUBSET REQUESTS.     @YL026UE*/ 08903000
*                      /*                                    @YL026UE*/ 08904000
*                      /**********************************************/ 08905000
*                                                                  2079 08906000
*                      ELSE                                        2079 08907000
*                        DO;                               /*@YL026UE*/ 08908000
@RF02063 DS    0H                                                  2080 08909000
*                          CTGPLPTR = TYPCPLPT;            /*@YL026UE*/ 08910000
         L     @04,TYPCPLPT                                        2080 08911000
         ST    @04,CTGPLPTR                                        2080 08912000
*                          ENTNMFLG = OFF;                 /*@YL026UE*/ 08913000
         NI    ENTNMFLG,B'01111111'                                2081 08914000
*                          RETURN CODE (SAVRC);            /*@ZA05939*/ 08915000
         LH    @15,SAVRC                                           2082 08916000
         L     @14,@SA00011                                        2082 08917000
         LM    @00,@12,@SA00011+8                                  2082 08918000
         BR    @14                                                 2082 08919000
*                        END;                              /*@YL026UE*/ 08920000
*                  /**************************************************/ 08921000
*                  /*                                        @YL026UE*/ 08922000
*                  /* BUILD THE DARGLIST TO PRINT THE ASSOCIATED TYPE*/ 08923000
*                  /* AND NAME.                              @YL026UE*/ 08924000
*                  /*                                        @YL026UE*/ 08925000
*                  /**************************************************/ 08926000
*                                                                  2084 08927000
*                  ELSE                                            2084 08928000
*                    DO;                                   /*@YL026UE*/ 08929000
@RF02062 DS    0H                                                  2085 08930000
*                      DARGSENT = LCST18;                  /*@YL026UE*/ 08931000
         L     @04,DARGPTR                                         2085 08932000
         MVI   DARGSENT(@04),X'12'                                 2085 08933000
*                      DARGCNT = DRGCNT2;                  /*@Y30SSMK*/ 08934000
         MVC   DARGCNT(2,@04),@CH00161                             2086 08935000
*                      DARGINS(1) = DRGINS10;              /*@Y30SSMK*/ 08936000
         LA    @15,10                                              2087 08937000
         STH   @15,DARGINS(,@04)                                   2087 08938000
*                      DARGINL(1) = ABBREVLN;              /*@YL026UE*/ 08939000
         STH   @15,DARGINL(,@04)                                   2088 08940000
*                      IF ALIASKND = CTGTALIN                      2089 08941000
*                        THEN                                      2089 08942000
         CLI   ALIASKND,C'A'                                       2089 08943000
         BNE   @RF02089                                            2089 08944000
*                          DARGDTM(1) = ADDR(NVSAMNM);     /*@YL026UE*/ 08945000
         L     @01,TEXTPTR                                         2090 08946000
         LA    @15,NVSAMNM(,@01)                                   2090 08947000
         ST    @15,DARGDTM(,@04)                                   2090 08948000
*                        ELSE                                      2091 08949000
*                          IF ALIASKND = CTGTGBS                   2091 08950000
*                            THEN                                  2091 08951000
         B     @RC02089                                            2091 08952000
@RF02089 CLI   ALIASKND,C'B'                                       2091 08953000
         BNE   @RF02091                                            2091 08954000
*                              DARGDTM(1) = ADDR(GDGNM);   /*@YL026UE*/ 08955000
         L     @04,TEXTPTR                                         2092 08956000
         LA    @04,GDGNM(,@04)                                     2092 08957000
         L     @01,DARGPTR                                         2092 08958000
         ST    @04,DARGDTM(,@01)                                   2092 08959000
*                            ELSE                                  2093 08960000
*                              IF ALIASKND=CTGTUCAT                2093 08961000
*                                THEN                              2093 08962000
         B     @RC02091                                            2093 08963000
@RF02091 CLI   ALIASKND,C'U'                                       2093 08964000
         BNE   @RF02093                                            2093 08965000
*                                  DARGDTM(1)=ADDR(UCATNM);/*@YL026UE*/ 08966000
         L     @04,TEXTPTR                                         2094 08967000
         LA    @04,UCATNM(,@04)                                    2094 08968000
         L     @01,DARGPTR                                         2094 08969000
         ST    @04,DARGDTM(,@01)                                   2094 08970000
*                                ELSE                              2095 08971000
*                                  IF ALIASKND=CTGTANM             2095 08972000
*                                    THEN                          2095 08973000
         B     @RC02093                                            2095 08974000
@RF02093 CLI   ALIASKND,C'X'                                       2095 08975000
         BNE   @RF02095                                            2095 08976000
*                                      DARGDTM(1)=                 2096 08977000
*                                        ADDR(ALIASNM);    /*@YL026UE*/ 08978000
         L     @04,TEXTPTR                                         2096 08979000
         LA    @04,ALIASNM(,@04)                                   2096 08980000
         L     @01,DARGPTR                                         2096 08981000
         ST    @04,DARGDTM(,@01)                                   2096 08982000
*                                    ELSE                          2097 08983000
*                                      DARGDTM(1)=                 2097 08984000
*                                        ADDR(NULLNM);     /*@YL026UE*/ 08985000
         B     @RC02095                                            2097 08986000
@RF02095 L     @04,TEXTPTR                                         2097 08987000
         LA    @04,NULLNM(,@04)                                    2097 08988000
         L     @01,DARGPTR                                         2097 08989000
         ST    @04,DARGDTM(,@01)                                   2097 08990000
*                      DARGINS(2) = DRGINS20;              /*@Y30SSMK*/ 08991000
@RC02095 DS    0H                                                  2098 08992000
@RC02093 DS    0H                                                  2098 08993000
@RC02091 DS    0H                                                  2098 08994000
@RC02089 L     @04,DARGPTR                                         2098 08995000
         MVC   DARGINS+8(2,@04),@CH00649                           2098 08996000
*                      CTGFLPTR = ENT44FPT;                /*@YL026UE*/ 08997000
         L     @15,ENT44FPT                                        2099 08998000
         ST    @15,CTGFLPTR                                        2099 08999000
*                      DARGINL(2) = CTGFLNG(1);            /*@YL026UE*/ 09000000
         L     @14,CTGFLNG(,@15)                                   2100 09001000
         STH   @14,DARGINL+8(,@04)                                 2100 09002000
*                      DARGDTM(2) = CTGFLPT(1);            /*@YL026UE*/ 09003000
         L     @15,CTGFLPT(,@15)                                   2101 09004000
         ST    @15,DARGDTM+8(,@04)                                 2101 09005000
*                      CALL LISTPROC;                      /*@YL026UE*/ 09006000
         BAL   @14,LISTPROC                                        2102 09007000
*                      IF NXTNAMFG = ON                            2103 09008000
*                        THEN                                      2103 09009000
         TM    NXTNAMFG,B'10000000'                                2103 09010000
         BNO   @RF02103                                            2103 09011000
*                          DO;                             /*@YL026UE*/ 09012000
*                          CTGFLPTR = ASSOCFPT;            /*@YL026UE*/ 09013000
         L     @04,ASSOCFPT                                        2105 09014000
         ST    @04,CTGFLPTR                                        2105 09015000
*                          ALIASCI# = NXTNMPTR;            /*@YL026UE*/ 09016000
         L     @04,CTGFLPT(,@04)                                   2106 09017000
         MVC   ALIASCI#(3),NXTNMPTR(@04)                           2106 09018000
*                          ALIASKND = NXTNMTY;             /*@YL026UE*/ 09019000
         MVC   ALIASKND(1),NXTNMTY(@04)                            2107 09020000
*                          IF NXTNMPTR = 0                         2108 09021000
*                            THEN                                  2108 09022000
         ICM   @15,7,NXTNMPTR(@04)                                 2108 09023000
         BNZ   @RF02108                                            2108 09024000
*                              NXTNAMFG = OFF;             /*@YL026UE*/ 09025000
         NI    NXTNAMFG,B'01111111'                                2109 09026000
*                          END;                            /*@YL026UE*/ 09027000
@RF02108 DS    0H                                                  2111 09028000
*                    END;                                  /*@YL026UE*/ 09029000
@RF02103 DS    0H                                                  2112 09030000
*              END ALIASLP;                                /*@YL026UE*/ 09031000
*                                                                  2112 09032000
@DE02038 TM    NXTNAMFG,B'10000000'                                2112 09033000
         BO    @DL02038                                            2112 09034000
         TM    INITFLG,B'10000000'                                 2112 09035000
         BO    @DL02038                                            2112 09036000
*              /******************************************************/ 09037000
*              /*                                            @YL026UE*/ 09038000
*              /* PROCESSING THE LIST OF ASSOCIATIONS IS COMPLETED.  */ 09039000
*              /* RESTORE THE CPL POINTER TO THE MAIN CPL SETUP FOR  */ 09040000
*              /* SUBSET REQUESTS.  CLEAR THE ENTRYNAME LOCATE       */ 09041000
*              /* INDICATOR.                                 @YL026UE*/ 09042000
*              /*                                            @YL026UE*/ 09043000
*              /******************************************************/ 09044000
*                                                                  2113 09045000
*              CTGNOFLD = 1;                               /*@YL026UE*/ 09046000
         L     @04,CTGPLPTR                                        2113 09047000
         MVI   CTGNOFLD(@04),X'01'                                 2113 09048000
*              CTGPLPTR = TYPCPLPT;                        /*@YL026UE*/ 09049000
         L     @04,TYPCPLPT                                        2114 09050000
         ST    @04,CTGPLPTR                                        2114 09051000
*              RESPECIFY ASSOC BASED(CTGFLPT(1));          /*@YL026UE*/ 09052000
*              ENTNMFLG = OFF;                             /*@YL026UE*/ 09053000
         NI    ENTNMFLG,B'01111111'                                2116 09054000
*          RETURN CODE(0);                                 /*@YL026UE*/ 09055000
         SLR   @15,@15                                             2117 09056000
         L     @14,@SA00011                                        2117 09057000
         LM    @00,@12,@SA00011+8                                  2117 09058000
         BR    @14                                                 2117 09059000
*        END ALSPROC;                                      /*@YL026UE*/ 09060000
*        /************************************************************/ 09061000
*        /*                                                  @ZA01484*/ 09062000
*        /* PROCEDURE  NAME - SHORTLST                       @ZA01484*/ 09063000
*        /*                                                  @ZA01484*/ 09064000
*        /*                                                  @ZA01484*/ 09065000
*        /* FUNCTION - PRODUCES AN ABBREVIATED LISTING OF    @ZA01484*/ 09066000
*        /*            CATALOG ENTRY NAMES THAT ARE IN THE   @ZA01484*/ 09067000
*        /*            WORK AREA.                            @ZA01484*/ 09068000
*        /*                                                  @ZA01484*/ 09069000
*        /* INPUT - IMPLICIT WORK AREA CONTAINING CATALOG    @ZA01484*/ 09070000
*        /*         NAMES AND DATA SET NAMES RETURNED        @ZA01484*/ 09071000
*        /*         FROM A UCIR GENERIC LOCATE.              @ZA01484*/ 09072000
*        /*                                                  @ZA01484*/ 09073000
*        /* OUTPUT - A PRINTED LIST CONSISTING OF A CATALOG  @ZA01484*/ 09074000
*        /*          NAME HEADER LINE FOLLOW BY THE          @ZA01484*/ 09075000
*        /*          DATA SET NAMES.                         @ZA01484*/ 09076000
*        /*                                                  @ZA01484*/ 09077000
*        /************************************************************/ 09078000
*                                                                  2119 09079000
*SHORTLST: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA0148*/ 09080000
*                                                                  2119 09081000
SHORTLST STM   @14,@12,12(@13)                                     2119 09082000
         ST    @13,@SA00012+4                                      2119 09083000
         LA    @14,@SA00012                                        2119 09084000
         ST    @14,8(,@13)                                         2119 09085000
         LR    @13,@14                                             2119 09086000
*        GEN(ENTRY SHORTLST);          /*EXT ENTRY POINT     @ZA05939*/ 09087000
         ENTRY SHORTLST                                                 09088000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 09089000
*                                                                  2121 09090000
         LM    REG8,REG12,BASESAVE                                 2121 09091000
*        /************************************************************/ 09092000
*        /*                                                  @ZA01484*/ 09093000
*        /* SET UP A SEPARATE TEXT PROCESSOR PARM LIST FOR   @ZA01484*/ 09094000
*        /* THE MINIMUM PARAMETERS NEEDED.                   @ZA01484*/ 09095000
*        /*                                                  @ZA01484*/ 09096000
*        /************************************************************/ 09097000
*                                                                  2122 09098000
*             DCL SRTDARG    CHAR(LENGTH(DARGLIST) +               2122 09099000
*                             LENGTH(DARGARY))  BDY(WORD); /*@ZA01484*/ 09100000
*             DCL SRTARGPT   PTR(31);                      /*@ZA01484*/ 09101000
*                                                                  2123 09102000
*        /************************************************************/ 09103000
*        /*                                                  @ZA01484*/ 09104000
*        /* LOCAL VARIABLES                                  @ZA01484*/ 09105000
*        /*                                                  @ZA01484*/ 09106000
*        /************************************************************/ 09107000
*                                                                  2124 09108000
*             DCL LSTCNT    FIXED(15); /*NO. OF ENT FOR LIST @ZA01484*/ 09109000
*             DCL REPCNT    FIXED(15) CONSTANT(1);         /*@ZA01484*/ 09110000
*                                /* NO. OF REPITITION ELEM   @ZA01484*/ 09111000
*             DCL PRTCOL    FIXED(8) CONSTANT(0);          /*@ZA01484*/ 09112000
*                                       /*PRINT COL OFFSET   @ZA01484*/ 09113000
*             DCL REDOREF   FIXED(15) CONSTANT(10);        /*@ZA01484*/ 09114000
*                                        /*REP ELEM REF NO.  @ZA01484*/ 09115000
*                                                                  2128 09116000
*        /************************************************************/ 09117000
*        /*                                                  @ZA01484*/ 09118000
*        /* INITIALIZE TEXT PROCESSOR PARM LIST AND LOCAL    @ZA01484*/ 09119000
*        /* SWITCHES.                                        @ZA01484*/ 09120000
*        /*                                                  @ZA01484*/ 09121000
*        /************************************************************/ 09122000
*                                                                  2128 09123000
*        OLDERID2 = NEWERID2;                                      2128 09124000
         L     @04,@PC00001                                        2128 09125000
         L     @04,GDTTR2(,@04)                                    2128 09126000
         MVC   @TS00001(95),NEWERID2(@04)                          2128 09127000
         MVC   OLDERID2(95,@04),@TS00001                           2128 09128000
*        NEWID2 = 'LCSH';                                  /*@Y30LSMK*/ 09129000
*                                                                  2129 09130000
         MVC   NEWID2(4,@04),@CC01729                              2129 09131000
*        SRTARGPT = ADDR(SRTDARG);                         /*@ZA01484*/ 09132000
         LA    @04,SRTDARG                                         2130 09133000
         ST    @04,SRTARGPT                                        2130 09134000
*        SRTARGPT->DARGRETP = 0; /*NULL FORMAT AREA          @ZA01484*/ 09135000
         SLR   @02,@02                                             2131 09136000
         ST    @02,DARGRETP(,@04)                                  2131 09137000
*        SRTARGPT->DARGSMOD = LC0ID;   /*LISTC STATIC TEXT   @ZA01484*/ 09138000
         MVC   DARGSMOD(3,@04),@CC01198                            2132 09139000
*        SRTARGPT->DARGSENT = LCST57;  /* TEXT STRUC NO.     @ZA01484*/ 09140000
         MVI   DARGSENT(@04),X'39'                                 2133 09141000
*        SRTARGPT->DARGCNT = REPCNT;  /* NO. OF REP ELEM     @ZA01484*/ 09142000
         MVC   DARGCNT(2,@04),@CH00045                             2134 09143000
*        SRTARGPT->DARGIND = PRTCOL;  /* PRINT COL OFFSET    @ZA01484*/ 09144000
         MVI   DARGIND(@04),X'00'                                  2135 09145000
*        SRTARGPT->DARGREP(1) = REDOREF;  /* REP ELEM REF NO. */   2136 09146000
         MVC   DARGREP(2,@04),@CH00457                             2136 09147000
*        SRTARGPT->DARGDTM(1) = 0;  /* NULL INSERT DATA ADDR @ZA01484*/ 09148000
*                                                                  2137 09149000
         ST    @02,DARGDTM(,@04)                                   2137 09150000
*        LSTCNT = 0;                                       /*@ZA01484*/ 09151000
*                                                                  2138 09152000
         SLR   LSTCNT,LSTCNT                                       2138 09153000
*        /************************************************************/ 09154000
*        /*                                                  @ZA01484*/ 09155000
*        /* PROCESS SHORT LIST LOOP.                         @ZA01484*/ 09156000
*        /*                                                  @ZA01484*/ 09157000
*        /************************************************************/ 09158000
*                                                                  2139 09159000
*NAMELST:     DO NLST = 1 TO OBJCNT;                       /*@ZA01484*/ 09160000
*                                                                  2139 09161000
NAMELST  LA    @04,1                                               2139 09162000
         B     @DE02139                                            2139 09163000
@DL02139 DS    0H                                                  2140 09164000
*               IF OBJTYP(NLST) = 'F0'X       /* CHECK FOR CAT NAME  */ 09165000
*                 THEN                                             2140 09166000
*                                                                  2140 09167000
         LA    @02,45                                              2140 09168000
         LR    @01,@04                                             2140 09169000
         MR    @00,@02                                             2140 09170000
         L     @04,OBJNMPTR                                        2140 09171000
         ALR   @04,@01                                             2140 09172000
         AL    @04,@CF01777                                        2140 09173000
         CLI   OBJTYP-4(@04),X'F0'                                 2140 09174000
         BNE   @RF02140                                            2140 09175000
*                       IF LSTCNT > 0                              2141 09176000
*                         THEN                                     2141 09177000
         LTR   LSTCNT,LSTCNT                                       2141 09178000
         BNP   @RF02141                                            2141 09179000
*                           DO;                            /*@ZA01484*/ 09180000
*                           SRTARGPT->DARGPCT(1) = LSTCNT; /*@ZA01484*/ 09181000
         L     @04,SRTARGPT                                        2143 09182000
         STH   LSTCNT,DARGPCT(,@04)                                2143 09183000
*                           SRTARGPT->DARGILP = LSTCNT*45+45;      2144 09184000
         LR    @01,LSTCNT                                          2144 09185000
         MR    @00,@02                                             2144 09186000
         ALR   @01,@02                                             2144 09187000
         STH   @01,DARGILP(,@04)                                   2144 09188000
*                                                          /*@ZA01484*/ 09189000
*                           CALL AMSTP011(GDTTBL,OTIOCSPT,SRTARGPT);    09190000
         L     @04,@PC00001                                        2145 09191000
         ST    @04,@AL00001                                        2145 09192000
         LA    @02,OTIOCSPT                                        2145 09193000
         ST    @02,@AL00001+4                                      2145 09194000
         LA    @02,SRTARGPT                                        2145 09195000
         ST    @02,@AL00001+8                                      2145 09196000
         MVI   @AL00001+8,X'80'                                    2145 09197000
         L     @15,GDTPRT(,@04)                                    2145 09198000
         LA    @01,@AL00001                                        2145 09199000
         BALR  @14,@15                                             2145 09200000
*                           RESPECIFY RTNREG RSTD;                 2146 09201000
*                           TESTRC = RTNREG;                       2147 09202000
         LR    TESTRC,RTNREG                                       2147 09203000
*                           RESPECIFY RTNREG UNRSTD;       /*@ZA01484*/ 09204000
*                           SAVRC = MAX(SAVRC, TESTRC);    /*@ZA01484*/ 09205000
         LH    @04,SAVRC                                           2149 09206000
         CR    @04,TESTRC                                          2149 09207000
         BNL   *+6                                                      09208000
         LR    @04,TESTRC                                          2149 09209000
         STH   @04,SAVRC                                           2149 09210000
*                           SRTARGPT->DARGDBP = ADDR(OBJTYP(NLST));     09211000
         LH    @04,NLST                                            2150 09212000
         MH    @04,@CH01258                                        2150 09213000
         L     @02,OBJNMPTR                                        2150 09214000
         AL    @02,@CF01777                                        2150 09215000
         LA    @04,OBJTYP-4(@04,@02)                               2150 09216000
         L     @02,SRTARGPT                                        2150 09217000
         ST    @04,DARGDBP(,@02)                                   2150 09218000
*                           LSTCNT = 0;                    /*@ZA01484*/ 09219000
         SLR   LSTCNT,LSTCNT                                       2151 09220000
*                           END;                           /*@ZA01484*/ 09221000
*                         ELSE                                     2153 09222000
*                           DO;                            /*@ZA01484*/ 09223000
         B     @RC02141                                            2153 09224000
@RF02141 DS    0H                                                  2154 09225000
*                           SRTARGPT->DARGDBP = ADDR(OBJTYP(NLST));     09226000
         LH    @04,NLST                                            2154 09227000
         MH    @04,@CH01258                                        2154 09228000
         L     @02,OBJNMPTR                                        2154 09229000
         AL    @02,@CF01777                                        2154 09230000
         LA    @04,OBJTYP-4(@04,@02)                               2154 09231000
         L     @02,SRTARGPT                                        2154 09232000
         ST    @04,DARGDBP(,@02)                                   2154 09233000
*                           END;                           /*@ZA01484*/ 09234000
*                                                                  2155 09235000
*                 ELSE      /* COUNT DATA SET NAMES          @ZA01484*/ 09236000
*                   LSTCNT = LSTCNT + 1;                   /*@ZA01484*/ 09237000
         B     @RC02140                                            2156 09238000
@RF02140 AL    LSTCNT,@CF00045                                     2156 09239000
*        END NAMELST;                                      /*@ZA01484*/ 09240000
*                                                                  2157 09241000
@RC02140 LA    @04,1                                               2157 09242000
         AH    @04,NLST                                            2157 09243000
@DE02139 STH   @04,NLST                                            2157 09244000
         L     @02,OBJNMPTR                                        2157 09245000
         C     @04,OBJCNT(,@02)                                    2157 09246000
         BNH   @DL02139                                            2157 09247000
*        /************************************************************/ 09248000
*        /*                                                  @ZA01484*/ 09249000
*        /* PROCESS BALANCE OF DATA SET NAMES.               @ZA01484*/ 09250000
*        /* IF THERE ARE NO NAMES SKIP ANY PRINTOUT.         @ZA01484*/ 09251000
*        /*                                                  @ZA01484*/ 09252000
*        /************************************************************/ 09253000
*                                                                  2158 09254000
*        IF LSTCNT > 0                                             2158 09255000
*             THEN                                                 2158 09256000
         LTR   LSTCNT,LSTCNT                                       2158 09257000
         BNP   @RF02158                                            2158 09258000
*                  DO;                                     /*@ZA01484*/ 09259000
*                  SRTARGPT->DARGPCT(1) = LSTCNT;          /*@ZA01484*/ 09260000
         L     @04,SRTARGPT                                        2160 09261000
         STH   LSTCNT,DARGPCT(,@04)                                2160 09262000
*                  SRTARGPT->DARGILP = LSTCNT*45+45;       /*@ZA01484*/ 09263000
         LA    @02,45                                              2161 09264000
         LR    @01,LSTCNT                                          2161 09265000
         MR    @00,@02                                             2161 09266000
         ALR   @01,@02                                             2161 09267000
         STH   @01,DARGILP(,@04)                                   2161 09268000
*                  CALL AMSTP011(GDTTBL,OTIOCSPT,SRTARGPT);/*@ZA01484*/ 09269000
         L     @04,@PC00001                                        2162 09270000
         ST    @04,@AL00001                                        2162 09271000
         LA    @02,OTIOCSPT                                        2162 09272000
         ST    @02,@AL00001+4                                      2162 09273000
         LA    @02,SRTARGPT                                        2162 09274000
         ST    @02,@AL00001+8                                      2162 09275000
         MVI   @AL00001+8,X'80'                                    2162 09276000
         L     @15,GDTPRT(,@04)                                    2162 09277000
         LA    @01,@AL00001                                        2162 09278000
         BALR  @14,@15                                             2162 09279000
*                  RESPECIFY RTNREG RSTD;                          2163 09280000
*                  TESTRC = RTNREG;                                2164 09281000
         LR    TESTRC,RTNREG                                       2164 09282000
*                  RESPECIFY RTNREG UNRSTD;                /*@ZA01484*/ 09283000
*                  SAVRC = MAX (SAVRC, TESTRC);            /*@ZA01484*/ 09284000
         LH    @04,SAVRC                                           2166 09285000
         CR    @04,TESTRC                                          2166 09286000
         BNL   *+6                                                      09287000
         LR    @04,TESTRC                                          2166 09288000
         STH   @04,SAVRC                                           2166 09289000
*                  END;                                    /*@ZA01484*/ 09290000
*                                                                  2167 09291000
*        RETURN CODE(0);                                   /*@ZA01484*/ 09292000
@RF02158 SLR   @15,@15                                             2168 09293000
         L     @13,4(,@13)                                         2168 09294000
         L     @14,12(,@13)                                        2168 09295000
         LM    @00,@12,20(@13)                                     2168 09296000
         BR    @14                                                 2168 09297000
*      END SHORTLST;                                       /*@ZA01484*/ 09298000
*        /************************************************************/ 09299000
*        /*                                                  @Y30SSMK*/ 09300000
*        /* PROCEDURE - VOLLIST                              @Y30SSMK*/ 09301000
*        /*                                                  @Y30SSMK*/ 09302000
*        /* FUNCTION - PRODUCES AN ABBREVIATED LISTING OF    @Y30SSMK*/ 09303000
*        /* CATALOG ENTRY NAMES AND VOLUME INFORMATION.      @Y30SSMK*/ 09304000
*        /*                                                  @Y30SSMK*/ 09305000
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM DATA    @Y30SSMK*/ 09306000
*        /* RETRIEVED VIA A LOCATE REQUEST.                  @Y30SSMK*/ 09307000
*        /*                                                  @Y30SSMK*/ 09308000
*        /* OUTPUT - A PRINTED LIST CONSISTING OF THE DATA   @Y30SSMK*/ 09309000
*        /* SET NAME AND, FOR ENTRIES CONTAINING VOLUME      @Y30SSMK*/ 09310000
*        /* INFORMATION, THE VOLUME SERIAL NUMBERS.          @Y30SSMK*/ 09311000
*        /*                                                  @Y30SSMK*/ 09312000
*        /************************************************************/ 09313000
*                                                                  2170 09314000
*VOLLIST: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA05939*/ 09315000
*                                                                  2170 09316000
VOLLIST  STM   @14,@12,12(@13)                                     2170 09317000
         ST    @13,@SA00013+4                                      2170 09318000
         LA    @14,@SA00013                                        2170 09319000
         ST    @14,8(,@13)                                         2170 09320000
         LR    @13,@14                                             2170 09321000
*        GEN(ENTRY VOLLIST);           /*EXT ENTRY POINT     @ZA05939*/ 09322000
         ENTRY VOLLIST                                                  09323000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 09324000
*                                                                  2172 09325000
         LM    REG8,REG12,BASESAVE                                 2172 09326000
*        /************************************************************/ 09327000
*        /*                                                  @Y30SSMK*/ 09328000
*        /* BUILD THE DARGLIST TO PRINT THE CATALOG ENTRY    @Y30SSMK*/ 09329000
*        /* NAME.                                            @Y30SSMK*/ 09330000
*        /*                                                  @Y30SSMK*/ 09331000
*        /************************************************************/ 09332000
*                                                                  2173 09333000
*        OLDERID2 = NEWERID2;                                      2173 09334000
         L     @04,@PC00001                                        2173 09335000
         L     @04,GDTTR2(,@04)                                    2173 09336000
         MVC   @TS00001(95),NEWERID2(@04)                          2173 09337000
         MVC   OLDERID2(95,@04),@TS00001                           2173 09338000
*        NEWID2 = 'LCVO';                                  /*@Y30SSMK*/ 09339000
*                                                                  2174 09340000
         MVC   NEWID2(4,@04),@CC01737                              2174 09341000
*        DARGSENT = LCST58;                                /*@Y30SSMK*/ 09342000
         L     @04,DARGPTR                                         2175 09343000
         MVI   DARGSENT(@04),X'3A'                                 2175 09344000
*        DARGDBP = ENT44FPT->CTGFLPT(1);                   /*@Y30SSMK*/ 09345000
         L     @15,ENT44FPT                                        2176 09346000
         L     @14,CTGFLPT(,@15)                                   2176 09347000
         ST    @14,DARGDBP(,@04)                                   2176 09348000
*        DARGILP = ENT44FPT->CTGFLNG(1);                   /*@Y30SSMK*/ 09349000
*                                                                  2177 09350000
         L     @15,CTGFLNG(,@15)                                   2177 09351000
         STH   @15,DARGILP(,@04)                                   2177 09352000
*        CALL LISTPROC;                                    /*@Y30SSMK*/ 09353000
*                                                                  2178 09354000
         BAL   @14,LISTPROC                                        2178 09355000
*        /************************************************************/ 09356000
*        /*                                                  @Y30SSMK*/ 09357000
*        /* IF THE ENTRY CONTAINS VOLUME INFORMATION, LIST   @Y30SSMK*/ 09358000
*        /* THE VOLUME SERIAL NUMBERS.                       @Y30SSMK*/ 09359000
*        /*                                                  @Y30SSMK*/ 09360000
*        /************************************************************/ 09361000
*                                                                  2179 09362000
*        IF HOLDETYP = CTGTDATA  |                                 2179 09363000
*          HOLDETYP = CTGTINDX  |                                  2179 09364000
*          HOLDETYP = CTGTALIN  |                                  2179 09365000
*          HOLDETYP = CTGTUCAT                                     2179 09366000
*          THEN                                                    2179 09367000
*                                                                  2179 09368000
         CLI   HOLDETYP,C'D'                                       2179 09369000
         BE    @RT02179                                            2179 09370000
         CLI   HOLDETYP,C'I'                                       2179 09371000
         BE    @RT02179                                            2179 09372000
         CLI   HOLDETYP,C'A'                                       2179 09373000
         BE    @RT02179                                            2179 09374000
         CLI   HOLDETYP,C'U'                                       2179 09375000
         BNE   @RF02179                                            2179 09376000
@RT02179 DS    0H                                                  2180 09377000
*            /********************************************************/ 09378000
*            /*                                              @Y30SSMK*/ 09379000
*            /* SET THE FPL POINTER TO THE FPL REQUESTING    @Y30SSMK*/ 09380000
*            /* VOLUME INFORMATION.  INITIALIZE THE SERIAL   @Y30SSMK*/ 09381000
*            /* NO. HOLD AREA TO HEX FF'S SINCE THIS VALUE   @Y30SSMK*/ 09382000
*            /* DETERMINES THE LISTING OF UNIQUE VOLUME      @Y30SSMK*/ 09383000
*            /* DATA. THEN LIST THE VOLUME HEADER            @Y30SSMK*/ 09384000
*            /* USING THE APPROPRIATE PRE-FORMATTED STATIC   @Y30SSMK*/ 09385000
*            /* TEXT DESCRIPTOR.                             @Y30SSMK*/ 09386000
*            /*                                              @Y30SSMK*/ 09387000
*            /********************************************************/ 09388000
*                                                                  2180 09389000
*            DO;                                           /*@Y30SSMK*/ 09390000
*              CTGFLPTR = AUVOLFPT;                        /*@Y30SSMK*/ 09391000
         L     @04,AUVOLFPT                                        2181 09392000
         ST    @04,CTGFLPTR                                        2181 09393000
*              OLDVOL# = HEXFF;                            /*@Y30SSMK*/ 09394000
         MVC   OLDVOL#(6),HEXFF                                    2182 09395000
*              DARGSENT = LCST59;                          /*@Y30SSMK*/ 09396000
         L     @04,DARGPTR                                         2183 09397000
         MVI   DARGSENT(@04),X'3B'                                 2183 09398000
*              CALL LISTPROC;                              /*@Y30SSMK*/ 09399000
*                                                                  2184 09400000
         BAL   @14,LISTPROC                                        2184 09401000
*              /******************************************************/ 09402000
*              /*                                            @Y30SSMK*/ 09403000
*              /* LIST THE CATALOG DATA, LOOPING THROUGH THE @Y30SSMK*/ 09404000
*              /* REPETITIVE FIELDS.  ONE PASS IS DETERMINED @Y30SSMK*/ 09405000
*              /* BY THE THE TOTAL LENGTH OF THE INDIVIDUAL  @Y30SSMK*/ 09406000
*              /* FIXED LENGTH FIELDS RETRIEVED BY THIS FPL  @Y30SSMK*/ 09407000
*              /* REQUEST.                                   @Y30SSMK*/ 09408000
*              /*                                            @Y30SSMK*/ 09409000
*              /******************************************************/ 09410000
*                                                                  2185 09411000
*              DO WHILE CTGFLNG(1) >= LENGTH(AUDATA);      /*@Y30SSMK*/ 09412000
         B     @DE02185                                            2185 09413000
@DL02185 DS    0H                                                  2186 09414000
*                IF AUSER ^= OLDVOL#                               2186 09415000
*                  THEN                                            2186 09416000
*                                                                  2186 09417000
         L     @04,CTGFLPTR                                        2186 09418000
         L     @04,CTGFLPT(,@04)                                   2186 09419000
         CLC   AUSER(6,@04),OLDVOL#                                2186 09420000
         BE    @RF02186                                            2186 09421000
*                      /**********************************************/ 09422000
*                      /*                                    @Y30SSMK*/ 09423000
*                      /* LIST EACH UNIQUE VOLUME SERIAL     @Y30SSMK*/ 09424000
*                      /* NUMBER.                            @Y30SSMK*/ 09425000
*                      /*                                    @Y30SSMK*/ 09426000
*                      /**********************************************/ 09427000
*                                                                  2187 09428000
*                      DO;                                 /*@Y30SSMK*/ 09429000
*                        OLDVOL# = AUSER;                  /*@Y30SSMK*/ 09430000
         MVC   OLDVOL#(6),AUSER(@04)                               2188 09431000
*                        DARGSENT = LCST60;                /*@Y30SSMK*/ 09432000
         L     @15,DARGPTR                                         2189 09433000
         MVI   DARGSENT(@15),X'3C'                                 2189 09434000
*                        DARGILP = LENGTH(AUSER);          /*@Y30SSMK*/ 09435000
         MVC   DARGILP(2,@15),@CH00164                             2190 09436000
*                        DARGDBP = ADDR(AUSER);            /*@Y30SSMK*/ 09437000
         LA    @04,AUSER(,@04)                                     2191 09438000
         ST    @04,DARGDBP(,@15)                                   2191 09439000
*                        CALL LISTPROC;                    /*@Y30SSMK*/ 09440000
         BAL   @14,LISTPROC                                        2192 09441000
*                      END;                                /*@Y30SSMK*/ 09442000
*                                                                  2193 09443000
*                /****************************************************/ 09444000
*                /*                                          @Y30SSMK*/ 09445000
*                /* UPDATE THE FPL POINTER TO THE NEXT       @Y30SSMK*/ 09446000
*                /* OCCURRENCE AND ACCORDINGLY DECREMENT     @Y30SSMK*/ 09447000
*                /* THE TOTAL LENGTH BY THAT JUST PROCESSED. @Y30SSMK*/ 09448000
*                /*                                          @Y30SSMK*/ 09449000
*                /****************************************************/ 09450000
*                                                                  2194 09451000
*                CTGFLNG(1) = CTGFLNG(1) - LENGTH(AUDATA); /*@Y30SSMK*/ 09452000
@RF02186 L     @04,CTGFLPTR                                        2194 09453000
         LA    @15,15                                              2194 09454000
         L     @14,CTGFLNG(,@04)                                   2194 09455000
         SLR   @14,@15                                             2194 09456000
         ST    @14,CTGFLNG(,@04)                                   2194 09457000
*                CTGFLPT(1) = CTGFLPT(1) + LENGTH(AUDATA); /*@Y30SSMK*/ 09458000
         AL    @15,CTGFLPT(,@04)                                   2195 09459000
         ST    @15,CTGFLPT(,@04)                                   2195 09460000
*              END;                                        /*@Y30SSMK*/ 09461000
@DE02185 L     @04,CTGFLPTR                                        2196 09462000
         L     @04,CTGFLNG(,@04)                                   2196 09463000
         C     @04,@CF00235                                        2196 09464000
         BNL   @DL02185                                            2196 09465000
*            END;                                          /*@Y30SSMK*/ 09466000
*                                                                  2197 09467000
*        /************************************************************/ 09468000
*        /*                                                  @Y30SSMK*/ 09469000
*        /* EXIT WHEN THE PROCESSING OF ENTRY FIELDS IS      @Y30SSMK*/ 09470000
*        /* COMPLETED.                                       @Y30SSMK*/ 09471000
*        /*                                                  @Y30SSMK*/ 09472000
*        /************************************************************/ 09473000
*                                                                  2198 09474000
*        RETURN CODE (0);                                  /*@Y30SSMK*/ 09475000
@RF02179 SLR   @15,@15                                             2198 09476000
         L     @13,4(,@13)                                         2198 09477000
         L     @14,12(,@13)                                        2198 09478000
         LM    @00,@12,20(@13)                                     2198 09479000
         BR    @14                                                 2198 09480000
*        END VOLLIST;                                      /*@Y30SSMK*/ 09481000
*                                                                  2200 09482000
*        /************************************************************/ 09483000
*        /*                                                  @ZA05939*/ 09484000
*        /* PROCEDURE - FREESTG                              @ZA05939*/ 09485000
*        /*                                                  @ZA05939*/ 09486000
*        /* FUNCTION - FREESTG HAS A SINGLE PURPOSE, TO FREE @ZA05939*/ 09487000
*        /*            AUTOMATIC STORAGE GOTTEN BY IDCLC02.  @ZA05939*/ 09488000
*        /*            IT DOES THIS BY INVOKING THE SYSTEM   @ZA05939*/ 09489000
*        /*            ADAPTER VIA THE UEPIL MACRO.  UPON    @ZA05939*/ 09490000
*        /*            COMPLETION, THE SYSTEM ADAPTER        @ZA05939*/ 09491000
*        /*            RETURNS CONTROL TO IDCLC02'S CALLER,  @ZA05939*/ 09492000
*        /*            IDCLC01.                              @ZA05939*/ 09493000
*        /*                                                  @ZA05939*/ 09494000
*        /* INPUT - NONE                                     @ZA05939*/ 09495000
*        /*                                                  @ZA05939*/ 09496000
*        /* OUTPUT - IDCLC02'S AUTOMATIC STORAGE IS          @ZA05939*/ 09497000
*        /*          RELEASED.                               @ZA05939*/ 09498000
*        /*                                                  @ZA05939*/ 09499000
*        /************************************************************/ 09500000
*                                                                  2200 09501000
*FREESTG: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA05939*/ 09502000
*                                                                  2200 09503000
FREESTG  STM   @14,@12,12(@13)                                     2200 09504000
         ST    @13,@SA00014+4                                      2200 09505000
         LA    @14,@SA00014                                        2200 09506000
         ST    @14,8(,@13)                                         2200 09507000
         LR    @13,@14                                             2200 09508000
*        GEN(ENTRY FREESTG);           /*EXT ENTRY POINT     @ZA05939*/ 09509000
         ENTRY FREESTG                                                  09510000
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/ 09511000
*                                                                  2202 09512000
         LM    REG8,REG12,BASESAVE                                 2202 09513000
*        /************************************************************/ 09514000
*        /*                                                  @ZA05939*/ 09515000
*        /* ISSUE THE UEPIL MACRO                            @ZA05939*/ 09516000
*        /*                                                  @ZA05939*/ 09517000
*        /************************************************************/ 09518000
*                                                                  2203 09519000
*        IF GDTDBG = NULLPTR                                       2203 09520000
*          THEN;                                                   2203 09521000
         L     @04,@PC00001                                        2203 09522000
         L     @04,GDTDBG(,@04)                                    2203 09523000
         LTR   @04,@04                                             2203 09524000
         BZ    @RT02203                                            2203 09525000
*          ELSE                                                    2205 09526000
*            CALL IDCDB010 (GDTTBL,'LC98');                        2205 09527000
         L     @04,@PC00001                                        2205 09528000
         ST    @04,@AL00001                                        2205 09529000
         LA    @15,@CC01742                                        2205 09530000
         ST    @15,@AL00001+4                                      2205 09531000
         MVI   @AL00001+4,X'80'                                    2205 09532000
         L     @15,GDTDBG(,@04)                                    2205 09533000
         LA    @01,@AL00001                                        2205 09534000
         BALR  @14,@15                                             2205 09535000
*                                                          /*@ZA05939*/ 09536000
*                                                                  2206 09537000
*        RFY(REG13,REG5) RSTD;                             /*@ZA05939*/ 09538000
@RT02203 DS    0H                                                  2207 09539000
*        REG13 = REG5;                                     /*@ZA05939*/ 09540000
*                                                                  2207 09541000
         LR    REG13,REG5                                          2207 09542000
*        CALL IDCSAEP0(GDTTBL,MODID);                              2208 09543000
         L     @04,@PC00001                                        2208 09544000
         ST    @04,@AL00001                                        2208 09545000
         LA    @15,MODID                                           2208 09546000
         ST    @15,@AL00001+4                                      2208 09547000
         MVI   @AL00001+4,X'80'                                    2208 09548000
         L     @15,GDTEPL(,@04)                                    2208 09549000
         LA    @01,@AL00001                                        2208 09550000
         BALR  @14,@15                                             2208 09551000
*                                                          /*@ZA05939*/ 09552000
*        RFY(REG13,REG5) UNRSTD;                           /*@ZA05939*/ 09553000
*        END FREESTG;                                      /*@ZA05939*/ 09554000
@EL00014 L     @13,4(,@13)                                         2210 09555000
@EF00014 DS    0H                                                  2210 09556000
@ER00014 LM    @14,@12,12(@13)                                     2210 09557000
         BR    @14                                                 2210 09558000
*        /************************************************************/ 09559000
*        /*                                                  @ZA05939*/ 09560000
*        /* LISTCAT IDCLC02 EOJ.                             @ZA05939*/ 09561000
*        /*                                                  @ZA05939*/ 09562000
*        /************************************************************/ 09563000
*                                                                  2211 09564000
*        END IDCLC02                                       /*@ZA05939*/ 09565000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 09566000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 09567000
*/*%INCLUDE SYSLIB  (AMSDF03 )                                        * 09568000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 09569000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 09570000
*/*%INCLUDE SYSLIB  (IDCCSLC )                                        * 09571000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 09572000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 09573000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 09574000
*;                                                                 2211 09575000
@DATA    DS    0H                                                       09576000
@CH00164 DC    H'6'                                                     09577000
@CH00498 DC    H'7'                                                     09578000
@CH00457 DC    H'10'                                                    09579000
@CH00649 DC    H'20'                                                    09580000
@CH01231 DC    H'30'                                                    09581000
@CH01235 DC    H'33'                                                    09582000
@CH00606 DC    H'44'                                                    09583000
@CH01258 DC    H'45'                                                    09584000
@CH01743 DC    H'121'                                                   09585000
@SM01747 MVC   SAVCPL(0,@04),CTGPL(@01)                                 09586000
@SM01749 MVC   SAVCPL(0,@04),CTGPL(@14)                                 09587000
@SM01751 MVC   CTGPL(0,@04),SAVCPL(@15)                                 09588000
@SM01753 MVC   CTGPL(0,@04),SAVCPL(@14)                                 09589000
@SM01758 MVC   CTGFL(0,@04),SAFPL(TEMPTR)                               09590000
@SM01763 MVC   VDSFPL(0,@14),ZEROAREA                                   09591000
@SM01765 MVC   CASTRING(0,@01),CASTRING(@15)                            09592000
@SM01767 MVC   CASTRING(0,@04),CASTRING(@01)                            09593000
@SM01770 MVC   CLSTRING(0,@04),ZEROAREA                                 09594000
@SM01772 MVC   CLSTRING(0,@14),ZEROAREA                                 09595000
@SM01775 MVC   ALSTRING(0,@15),ZEROAREA                                 09596000
@DATD    DSECT                                                          09597000
         DS    0F                                                       09598000
@SA00001 DS    18F                                                      09599000
@PC00001 DS    2F                                                       09600000
@SA00002 DS    18F                                                      09601000
@PC00002 DS    3F                                                       09602000
@SA00003 DS    18F                                                      09603000
@SA00005 DS    18F                                                      09604000
@SA00004 DS    18F                                                      09605000
@SA00006 DS    18F                                                      09606000
@SA00011 DS    15F                                                      09607000
@SA00009 DS    18F                                                      09608000
@SA00010 DS    15F                                                      09609000
@SA00007 DS    18F                                                      09610000
@SA00008 DS    18F                                                      09611000
@SA00012 DS    18F                                                      09612000
@SA00013 DS    18F                                                      09613000
@SA00014 DS    18F                                                      09614000
@AL00001 DS    5A                                                       09615000
@TF00001 DS    F                                                        09616000
@AFTEMPS DS    3F                                                       09617000
IDCLC02  CSECT                                                          09618000
         DS    0F                                                       09619000
@CF00045 DC    F'1'                                                     09620000
@CH00045 EQU   @CF00045+2                                               09621000
@CF00161 DC    F'2'                                                     09622000
@CH00161 EQU   @CF00161+2                                               09623000
@CF00170 DC    F'3'                                                     09624000
@CH00170 EQU   @CF00170+2                                               09625000
@CF00050 DC    F'4'                                                     09626000
@CH00050 EQU   @CF00050+2                                               09627000
@CF00187 DC    F'8'                                                     09628000
@CH00187 EQU   @CF00187+2                                               09629000
@CF00642 DC    F'9'                                                     09630000
@CF00664 DC    F'14'                                                    09631000
@CH00664 EQU   @CF00664+2                                               09632000
@CF00235 DC    F'15'                                                    09633000
@CF00487 DC    F'16'                                                    09634000
@CF00653 DC    F'23'                                                    09635000
@CH00653 EQU   @CF00653+2                                               09636000
@CF01247 DC    F'39'                                                    09637000
@CF01249 DC    F'40'                                                    09638000
@CH01249 EQU   @CF01249+2                                               09639000
@CF01280 DC    F'56'                                                    09640000
@CH01280 EQU   @CF01280+2                                               09641000
@CF00044 DC    F'256'                                                   09642000
@CF01777 DC    F'-41'                                                   09643000
@CF01760 DC    F'-40'                                                   09644000
@CF01761 DC    F'-8'                                                    09645000
@CF01762 DC    F'-6'                                                    09646000
@CF01769 DC    F'-4'                                                    09647000
@CF01774 DC    F'-3'                                                    09648000
@DATD    DSECT                                                          09649000
         DS    0D                                                       09650000
LISTSCAN DS    A                                                        09651000
IOCSPTR  DS    A                                                        09652000
OPNPTR   DS    A                                                        09653000
DDSTRU   DS    A                                                        09654000
FSADDR   DS    A                                                        09655000
ERCNVADR DS    A                                                        09656000
GPLEN    DS    F                                                        09657000
CACBPTR  DS    A                                                        09658000
TEMPWKA  DS    A                                                        09659000
VXDESLEN DS    F                                                        09660000
VDIRLEN  DS    F                                                        09661000
TEMPSAPT DS    A                                                        09662000
SRTARGPT DS    A                                                        09663000
LISTPTR  DS    A                                                        09664000
VMM      DS    H                                                        09665000
SETRC    DS    H                                                        09666000
LISTLN   DS    FL1                                                      09667000
@TS00001 DS    CL95                                                     09668000
COMAREA  DS    CL20                                                     09669000
         ORG   COMAREA                                                  09670000
COMSWKPT DS    AL4                                                      09671000
COMFPLPT DS    AL4                                                      09672000
COMFLGPT DS    AL4                                                      09673000
COMVARPT DS    AL4                                                      09674000
COMTOTPT DS    AL4                                                      09675000
         ORG   COMAREA+20                                               09676000
SAVWKPTR DS    CL104                                                    09677000
         ORG   SAVWKPTR                                                 09678000
DSBCATPT DS    AL4                                                      09679000
CTGPLPTR DS    AL4                                                      09680000
TYPCPLPT DS    AL4                                                      09681000
SAVCPLPT DS    AL4                                                      09682000
OLDCPLPT DS    AL4                                                      09683000
ERMCPLPT DS    AL4                                                      09684000
LCCPLLEN DS    FL1                                                      09685000
         DS    CL3                                                      09686000
CI#CPLPT DS    AL4                                                      09687000
SA#CPLPT DS    AL4                                                      09688000
ER#CPLPT DS    AL4                                                      09689000
LC#CPLLN DS    FL2                                                      09690000
LCFPLLEN DS    FL1                                                      09691000
MTFPLLEN DS    FL1                                                      09692000
CTGFLPTR DS    AL4                                                      09693000
SAVFPLPT DS    AL4                                                      09694000
CILSTLEN DS    FL4                                                      09695000
CILSTPTR DS    AL4                                                      09696000
CIASOCLN DS    FL4                                                      09697000
CIASOCPT DS    AL4                                                      09698000
ERRCPLPT DS    AL4                                                      09699000
ERRARGPT DS    AL4                                                      09700000
DARGPTR  DS    AL4                                                      09701000
OTIOCSPT DS    AL4                                                      09702000
OBJNMPTR DS    AL4                                                      09703000
ENTWKAPT DS    AL4                                                      09704000
DPLISTPT DS    AL4                                                      09705000
TEXTPTR  DS    AL4                                                      09706000
VHDRPTR  DS    AL4                                                      09707000
         ORG   SAVWKPTR+104                                             09708000
CORRFPLS DS    CL136                                                    09709000
         ORG   CORRFPLS                                                 09710000
FIRSTFPL DS    CL4                                                      09711000
         ORG   FIRSTFPL                                                 09712000
MULTIFPT DS    AL4                                                      09713000
         ORG   CORRFPLS+4                                               09714000
SUBSETS  DS    CL128                                                    09715000
         ORG   SUBSETS                                                  09716000
ETYPFPT  DS    AL4                                                      09717000
ENT44FPT DS    AL4                                                      09718000
CATTRFPT DS    AL4                                                      09719000
ASSOCFPT DS    AL4                                                      09720000
EXDTFPT  DS    AL4                                                      09721000
         ORG   EXDTFPT                                                  09722000
CACBFPT1 DS    AL4                                                      09723000
         ORG   SUBSETS+20                                               09724000
CRDTFPT  DS    AL4                                                      09725000
DSIDFPT  DS    AL4                                                      09726000
RELFPT   DS    AL4                                                      09727000
AUVOLFPT DS    AL4                                                      09728000
         ORG   AUVOLFPT                                                 09729000
CACBFPT2 DS    AL4                                                      09730000
         ORG   SUBSETS+36                                               09731000
VCHARFPT DS    AL4                                                      09732000
DSSPFPT  DS    AL4                                                      09733000
         ORG   DSSPFPT                                                  09734000
CACBFPT3 DS    AL4                                                      09735000
         ORG   SUBSETS+44                                               09736000
DSHUFPT  DS    AL4                                                      09737000
DSHAFPT  DS    AL4                                                      09738000
DSVLFPT  DS    AL4                                                      09739000
PGBYTFPT DS    AL4                                                      09740000
VTIMEFPT DS    AL4                                                      09741000
         ORG   VTIMEFPT                                                 09742000
CACBFPT4 DS    AL4                                                      09743000
         ORG   SUBSETS+64                                               09744000
VSYSXFPT DS    AL4                                                      09745000
V#DSPFPT DS    AL4                                                      09746000
V#DSFPT  DS    AL4                                                      09747000
VHDRFPT  DS    AL4                                                      09748000
VDIRFPT  DS    AL4                                                      09749000
VXDESFPT DS    AL4                                                      09750000
SECURFPT DS    AL4                                                      09751000
DSBFPT   DS    AL4                                                      09752000
ATTRFPT  DS    AL4                                                      09753000
BUFFFPT  DS    AL4                                                      09754000
RECLFPT  DS    AL4                                                      09755000
GDGATFPT DS    AL4                                                      09756000
GDGLMFPT DS    AL4                                                      09757000
RGATRFPT DS    AL4                                                      09758000
EXITFPT  DS    AL4                                                      09759000
RACFPT   DS    AL4                                                      09760000
         ORG   CORRFPLS+132                                             09761000
LASTFPT  DS    CL4                                                      09762000
         ORG   LASTFPT                                                  09763000
CACBFPT5 DS    AL4                                                      09764000
         ORG   CORRFPLS+136                                             09765000
FLAGS    DS    CL34                                                     09766000
         ORG   FLAGS                                                    09767000
CACBFLG  DS    BL1                                                      09768000
CLENTFLG DS    BL1                                                      09769000
ENTNMFLG DS    BL1                                                      09770000
LISTCFLG DS    BL1                                                      09771000
NOMSGFLG DS    BL1                                                      09772000
CMDERRSW DS    BL1                                                      09773000
SUBTFLG  DS    BL1                                                      09774000
NOTTLFLG DS    BL1                                                      09775000
ATYPFLG  DS    BL1                                                      09776000
BTYPFLG  DS    BL1                                                      09777000
DTYPFLG  DS    BL1                                                      09778000
ITYPFLG  DS    BL1                                                      09779000
NDENTFLG DS    BL1                                                      09780000
ENLVUDFG DS    BL1                                                      09781000
PGSPCFLG DS    BL1                                                      09782000
DENTAFLG DS    BL1                                                      09783000
ENTCLFLG DS    BL1                                                      09784000
G0V0FLG  DS    BL1                                                      09785000
NUSEFLG  DS    BL1                                                      09786000
GTYPFLG  DS    BL1                                                      09787000
RTYPFLG  DS    BL1                                                      09788000
ATFPLFLG DS    BL1                                                      09789000
GASSOCSW DS    BL1                                                      09790000
DATEFLG  DS    BL1                                                      09791000
CRDTSW   DS    BL1                                                      09792000
EXDTSW   DS    BL1                                                      09793000
VTYPFLG  DS    BL1                                                      09794000
VTFPLFLG DS    BL1                                                      09795000
EXFPLFLG DS    BL1                                                      09796000
CRFPLFLG DS    BL1                                                      09797000
CTYPFLG  DS    BL1                                                      09798000
PTYPFLG  DS    BL1                                                      09799000
NOGENFLG DS    BL1                                                      09800000
CILOCFLG DS    BL1                                                      09801000
         ORG   FLAGS+34                                                 09802000
         DS    CL2                                                      09803000
MISCVAR  DS    CL72                                                     09804000
         ORG   MISCVAR                                                  09805000
FPLBEGN  DS    FL2                                                      09806000
FPLEND   DS    FL2                                                      09807000
FPLCNT   DS    FL2                                                      09808000
CATRC    DS    FL2                                                      09809000
ASSOC#   DS    FL2                                                      09810000
NLST     DS    FL2                                                      09811000
SAVRC    DS    FL2                                                      09812000
CATNAME  DS    CL44                                                     09813000
TYPMULTI DS    CL13                                                     09814000
         ORG   TYPMULTI                                                 09815000
TYPECNT  DS    FL2                                                      09816000
TYPELIST DS    CL11                                                     09817000
         ORG   MISCVAR+71                                               09818000
HOLDETYP DS    CL1                                                      09819000
         ORG   MISCVAR+72                                               09820000
TYPAUDIT DS    CL48                                                     09821000
         ORG   TYPAUDIT                                                 09822000
CTYPCNT  DS    FL4                                                      09823000
DTYPCNT  DS    FL4                                                      09824000
ITYPCNT  DS    FL4                                                      09825000
ATYPCNT  DS    FL4                                                      09826000
UTYPCNT  DS    FL4                                                      09827000
VTYPCNT  DS    FL4                                                      09828000
XTYPCNT  DS    FL4                                                      09829000
BTYPCNT  DS    FL4                                                      09830000
PTYPCNT  DS    FL4                                                      09831000
GTYPCNT  DS    FL4                                                      09832000
RTYPCNT  DS    FL4                                                      09833000
TOTLCNT  DS    FL4                                                      09834000
         ORG   TYPAUDIT+48                                              09835000
PCARG    DS    CL33                                                     09836000
         ORG   PCARG                                                    09837000
PCMTLP   DS    AL4                                                      09838000
PCSTLP   DS    AL4                                                      09839000
PCFLP    DS    AL4                                                      09840000
PCPCP    DS    AL4                                                      09841000
PCPNL    DS    FL2                                                      09842000
PCPTL    DS    FL2                                                      09843000
PCPDL    DS    FL2                                                      09844000
PCMTLC   DS    FL2                                                      09845000
PCSTLC   DS    FL2                                                      09846000
PCFLC    DS    FL2                                                      09847000
PCLW     DS    FL2                                                      09848000
PCPD     DS    FL2                                                      09849000
PCDSC    DS    AL1                                                      09850000
         ORG   PCARG+33                                                 09851000
LCSUBTIT DS    CL121                                                    09852000
         ORG   LCSUBTIT                                                 09853000
CARRC    DS    CL1                                                      09854000
@NM00059 DS    CL120                                                    09855000
         ORG   LCSUBTIT+121                                             09856000
GPID     DS    CL4                                                      09857000
ALIASLOC DS    CL4                                                      09858000
         ORG   ALIASLOC                                                 09859000
ALIASKND DS    CL1                                                      09860000
ALIASCI# DS    CL3                                                      09861000
         ORG   ALIASLOC+4                                               09862000
         DS    CL2                                                      09863000
ERRORTAB DS    CL32                                                     09864000
BASESAVE DS    CL20                                                     09865000
OLDVOL#  DS    CL6                                                      09866000
         DS    CL2                                                      09867000
DFLAGS   DS    CL17                                                     09868000
         DS    CL3                                                      09869000
DUMPWKA  DS    CL65                                                     09870000
         ORG   DUMPWKA                                                  09871000
ITEM0    DS    CL16                                                     09872000
         ORG   ITEM0                                                    09873000
ITEM0NM  DS    CL8                                                      09874000
ITEM0PTR DS    AL4                                                      09875000
ITEM0LEN DS    FL2                                                      09876000
ITEM0TYP DS    CL1                                                      09877000
@NM00066 DS    CL1                                                      09878000
         ORG   DUMPWKA+16                                               09879000
ARYFORM  DS    CL16                                                     09880000
         ORG   ARYFORM                                                  09881000
ARYNM    DS    CL8                                                      09882000
ARYSZ    DS    FL2                                                      09883000
ARYITEM  DS    FL2                                                      09884000
ARYEXT   DS    FL2                                                      09885000
ARYHDR   DS    CL1                                                      09886000
@NM00067 DS    CL1                                                      09887000
         ORG   DUMPWKA+32                                               09888000
ITEM1    DS    CL16                                                     09889000
         ORG   ITEM1                                                    09890000
ITEM1NM  DS    CL8                                                      09891000
ITEM1PTR DS    AL4                                                      09892000
ITEM1LEN DS    FL2                                                      09893000
ITEM1TYP DS    CL1                                                      09894000
@NM00068 DS    CL1                                                      09895000
         ORG   DUMPWKA+48                                               09896000
ITEM2    DS    CL16                                                     09897000
         ORG   ITEM2                                                    09898000
ITEM2NM  DS    CL8                                                      09899000
         ORG   ITEM2NM                                                  09900000
LIST2END DS    CL1                                                      09901000
@NM00069 DS    CL7                                                      09902000
         ORG   ITEM2+8                                                  09903000
ITEM2PTR DS    AL4                                                      09904000
ITEM2LEN DS    FL2                                                      09905000
ITEM2TYP DS    CL1                                                      09906000
@NM00070 DS    CL1                                                      09907000
         ORG   DUMPWKA+64                                               09908000
LISTEND  DS    CL1                                                      09909000
         ORG   DUMPWKA+65                                               09910000
         DS    CL3                                                      09911000
DUMPARMS DS    CL113                                                    09912000
         ORG   DUMPARMS                                                 09913000
ITEM6    DS    CL16                                                     09914000
         ORG   ITEM6                                                    09915000
ITEM6NM  DS    CL8                                                      09916000
ITEM6PTR DS    AL4                                                      09917000
ITEM6LEN DS    FL2                                                      09918000
ITEM6TYP DS    CL1                                                      09919000
@NM00071 DS    CL1                                                      09920000
         ORG   DUMPARMS+16                                              09921000
ITEM7    DS    CL16                                                     09922000
         ORG   ITEM7                                                    09923000
ITEM7NM  DS    CL8                                                      09924000
ITEM7PTR DS    AL4                                                      09925000
ITEM7LEN DS    FL2                                                      09926000
ITEM7TYP DS    CL1                                                      09927000
@NM00072 DS    CL1                                                      09928000
         ORG   DUMPARMS+32                                              09929000
ITEM8    DS    CL16                                                     09930000
         ORG   ITEM8                                                    09931000
ITEM8NM  DS    CL8                                                      09932000
ITEM8PTR DS    AL4                                                      09933000
ITEM8LEN DS    FL2                                                      09934000
ITEM8TYP DS    CL1                                                      09935000
@NM00073 DS    CL1                                                      09936000
         ORG   DUMPARMS+48                                              09937000
ITEM3    DS    CL16                                                     09938000
         ORG   ITEM3                                                    09939000
ITEM3NM  DS    CL8                                                      09940000
ITEM3PTR DS    AL4                                                      09941000
ITEM3LEN DS    FL2                                                      09942000
ITEM3TYP DS    CL1                                                      09943000
@NM00074 DS    CL1                                                      09944000
         ORG   DUMPARMS+64                                              09945000
ARY2FORM DS    CL16                                                     09946000
         ORG   ARY2FORM                                                 09947000
ARY2NM   DS    CL8                                                      09948000
ARY2SZ   DS    FL2                                                      09949000
ARY2ITEM DS    FL2                                                      09950000
ARY2EXT  DS    FL2                                                      09951000
ARY2HDR  DS    CL1                                                      09952000
@NM00075 DS    CL1                                                      09953000
         ORG   DUMPARMS+80                                              09954000
ITEM4    DS    CL16                                                     09955000
         ORG   ITEM4                                                    09956000
ITEM4NM  DS    CL8                                                      09957000
ITEM4PTR DS    AL4                                                      09958000
ITEM4LEN DS    FL2                                                      09959000
ITEM4TYP DS    CL1                                                      09960000
@NM00076 DS    CL1                                                      09961000
         ORG   DUMPARMS+96                                              09962000
ITEM9    DS    CL16                                                     09963000
         ORG   ITEM9                                                    09964000
ITEM9NM  DS    CL8                                                      09965000
         ORG   ITEM9NM                                                  09966000
LIST3END DS    CL1                                                      09967000
@NM00077 DS    CL7                                                      09968000
         ORG   ITEM9+8                                                  09969000
ITEM9PTR DS    AL4                                                      09970000
ITEM9LEN DS    FL2                                                      09971000
ITEM9TYP DS    CL1                                                      09972000
@NM00078 DS    CL1                                                      09973000
         ORG   DUMPARMS+112                                             09974000
LIST4END DS    CL1                                                      09975000
         ORG   DUMPARMS+113                                             09976000
         DS    CL3                                                      09977000
DUMPMARG DS    CL17                                                     09978000
         ORG   DUMPMARG                                                 09979000
ITEMM    DS    CL16                                                     09980000
         ORG   ITEMM                                                    09981000
ITEMMNM  DS    CL8                                                      09982000
ITEMMPTR DS    AL4                                                      09983000
ITEMMLEN DS    FL2                                                      09984000
ITEMMTYP DS    CL1                                                      09985000
@NM00079 DS    CL1                                                      09986000
         ORG   DUMPMARG+16                                              09987000
LISTMEND DS    CL1                                                      09988000
         ORG   DUMPMARG+17                                              09989000
         DS    CL3                                                      09990000
DUMPDARG DS    CL17                                                     09991000
         ORG   DUMPDARG                                                 09992000
ITEM5    DS    CL16                                                     09993000
         ORG   ITEM5                                                    09994000
ITEM5NM  DS    CL8                                                      09995000
ITEM5PTR DS    AL4                                                      09996000
ITEM5LEN DS    FL2                                                      09997000
ITEM5TYP DS    CL1                                                      09998000
@NM00080 DS    CL1                                                      09999000
         ORG   DUMPDARG+16                                              10000000
LIST5END DS    CL1                                                      10001000
         ORG   DUMPDARG+17                                              10002000
VXTITLSW DS    BL1                                                      10003000
VDSHDRSW DS    BL1                                                      10004000
INITFLG  DS    BL1                                                      10005000
NXTNAMFG DS    BL1                                                      10006000
         DS    CL3                                                      10007000
SRTDARG  DS    CL28                                                     10008000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                10009000
@ENDDATD EQU   *                                                        10010000
IDCLC02  CSECT                                                          10011000
         DS    0F                                                       10012000
@SIZDATD DC    AL1(0)                                                   10013000
         DC    AL3(@ENDDATD-@DATD)                                      10014000
         DS    0D                                                       10015000
@CC01550 DC    C'MULTIFPL'                                              10016000
@CC01561 DC    C'CTGWKAPT'                                              10017000
@CC01602 DC    C'DARGLIST'                                              10018000
@CC01553 DC    C'CTGPSWD'                                               10019000
@CC01588 DC    C'ERRDARG'                                               10020000
@CC01552 DC    C'CTGENT'                                                10021000
@CC01559 EQU   @CC01561                                                 10022000
@CC01564 DC    C'WKAEND'                                                10023000
@CC01544 DC    C'FLAGS'                                                 10024000
@CC01547 DC    C'CTGPL'                                                 10025000
@CC01549 DC    C'CTGFL'                                                 10026000
@CC01551 DC    C'CATRC'                                                 10027000
@CC01396 DC    C'LC08'                                                  10028000
@CC01398 DC    C'LC09'                                                  10029000
@CC01427 DC    C'LC02'                                                  10030000
@CC01546 DC    C'LCLO'                                                  10031000
@CC01554 DC    C'LCBL'                                                  10032000
@CC01558 DC    C'LCAL'                                                  10033000
@CC01565 DC    C'LCWA'                                                  10034000
@CC01575 DC    C'LCFP'                                                  10035000
@CC01589 DC    C'LCMG'                                                  10036000
@CC01590 DC    C'LCER'                                                  10037000
@CC01603 DC    C'LCTP'                                                  10038000
@CC01604 DC    C'LCLT'                                                  10039000
@CC01610 DC    C'LCAU'                                                  10040000
@CC01611 DC    C'LCAP'                                                  10041000
@CC01637 DC    C'LCCL'                                                  10042000
@CC01638 DC    C'LCCD'                                                  10043000
@CC01670 DC    C'LCVL'                                                  10044000
@CC01691 DC    C'LCSA'                                                  10045000
@CC01692 DC    C'LC05'                                                  10046000
@CC01693 DC    C'LC11'                                                  10047000
@CC01701 DC    C'LCLA'                                                  10048000
@CC01714 DC    C'LCAS'                                                  10049000
@CC01729 DC    C'LCSH'                                                  10050000
@CC01737 DC    C'LCVO'                                                  10051000
@CC01742 DC    C'LC98'                                                  10052000
@CC01198 EQU   @CC01396                                                 10053000
@CC01290 DC    C'UV0'                                                   10054000
@CC01297 EQU   @CC01693                                                 10055000
@CC01548 DC    C'FPL'                                                   10056000
@CC01560 EQU   @CC01564                                                 10057000
FIXAREA  DS    CL768                                                    10058000
         ORG   FIXAREA                                                  10059000
@NM00001 DC    256X'00'                                                 10060000
@NM00002 DC    256X'00'                                                 10061000
@NM00003 DC    256X'00'                                                 10062000
         ORG   FIXAREA+768                                              10063000
ALL      DC    CL3'ALL'                                                 10064000
FORMAT   DC    CL4'FORM'                                                10065000
HSECOND  DC    CL4'HSEC'                                                10066000
CLOCK    DC    CL4'KLOK'                                                10067000
SETZERO  DC    CL4'ZERO'                                                10068000
SETBLANK DC    CL4'BLNK'                                                10069000
NOSET    DC    CL4'NSET'                                                10070000
OVERRIDE DC    CL4'OVRD'                                                10071000
ACQUIRE  DC    CL8'ACQUIRE '                                            10072000
RELINQ   DC    CL8'RELINQ  '                                            10073000
MOUNT    DC    CL8'MOUNT   '                                            10074000
DEMOUNT  DC    CL8'DEMOUNT '                                            10075000
DEFINE   DC    CL8'DEFINE  '                                            10076000
MOVE     DC    CL8'MOVE    '                                            10077000
TRACEQ   DC    CL8'TRACEQ  '                                            10078000
COPYTABL DC    CL8'COPYTABL'                                            10079000
COPYCRTG DC    CL8'COPYCRTG'                                            10080000
COPYVOL  DC    CL8'COPYVOL '                                            10081000
VVIC     DC    CL8'VVIC    '                                            10082000
TUNE     DC    CL8'TUNE    '                                            10083000
NAMES    DC    CL4'NAME'                                                10084000
UNIT     DC    CL4'UNIT'                                                10085000
SHR      DC    CL4'SHR '                                                10086000
EXCL     DC    CL4'EXCL'                                                10087000
NOWAIT   DC    CL4'NWAI'                                                10088000
WAIT     DC    CL4'WAIT'                                                10089000
ASSOCNM  DC    CL8'NAMEDS  '                                            10090000
CATTRNM  DC    CL8'CATTR   '                                            10091000
ENT44NM  DC    CL8'ENTNAME '                                            10092000
MULTITNM DC    CL8'MULTITYP'                                            10093000
MODID    DC    CL4'LC02'                                                10094000
         DS    CL1                                                      10095000
ARITH4FF DC    X'FFFFFFFF'                                              10096000
HEXFF    DS    CL256                                                    10097000
         ORG   HEXFF                                                    10098000
@NM00064 DC    256X'FF'                                                 10099000
         ORG   HEXFF+256                                                10100000
ZEROAREA DS    CL256                                                    10101000
         ORG   ZEROAREA                                                 10102000
@NM00065 DC    256X'00'                                                 10103000
         ORG   ZEROAREA+256                                             10104000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       10105000
@01      EQU   01                                                       10106000
@02      EQU   02                                                       10107000
@03      EQU   03                                                       10108000
@04      EQU   04                                                       10109000
@05      EQU   05                                                       10110000
@06      EQU   06                                                       10111000
@07      EQU   07                                                       10112000
@08      EQU   08                                                       10113000
@09      EQU   09                                                       10114000
@10      EQU   10                                                       10115000
@11      EQU   11                                                       10116000
@12      EQU   12                                                       10117000
@13      EQU   13                                                       10118000
@14      EQU   14                                                       10119000
@15      EQU   15                                                       10120000
LSTCNT   EQU   @03                                                      10121000
ASOCSAPT EQU   @06                                                      10122000
CLT      EQU   @07                                                      10123000
FLENGTH  EQU   @03                                                      10124000
FLOFFSET EQU   @02                                                      10125000
TEMPSALN EQU   @02                                                      10126000
VWKA     EQU   @02                                                      10127000
VHDRLEN  EQU   @04                                                      10128000
DALLOCNM EQU   @02                                                      10129000
PGPTR    EQU   @07                                                      10130000
CURRLEN  EQU   @03                                                      10131000
CVARPTR  EQU   @02                                                      10132000
CKK      EQU   @06                                                      10133000
TEMPTR   EQU   @02                                                      10134000
FJJ      EQU   @03                                                      10135000
COMPTR   EQU   @02                                                      10136000
VDIRPTR  EQU   @07                                                      10137000
VXDESPTR EQU   @06                                                      10138000
DMPINDEX EQU   @02                                                      10139000
TESTRC   EQU   @03                                                      10140000
REG5     EQU   @05                                                      10141000
REG8     EQU   @08                                                      10142000
REG9     EQU   @09                                                      10143000
REG10    EQU   @10                                                      10144000
REG11    EQU   @11                                                      10145000
REG12    EQU   @12                                                      10146000
RTNREG   EQU   @15                                                      10147000
REG13    EQU   @13                                                      10148000
CATRCREG EQU   @15                                                      10149000
REG0     EQU   @00                                                      10150000
REG1     EQU   @01                                                      10151000
REG14    EQU   @14                                                      10152000
REG15    EQU   @15                                                      10153000
REG2     EQU   @02                                                      10154000
REG3     EQU   @03                                                      10155000
REG4     EQU   @04                                                      10156000
REG6     EQU   @06                                                      10157000
REG7     EQU   @07                                                      10158000
IDCSAEP0 EQU   0                                                        10159000
IDCSAGP0 EQU   0                                                        10160000
IDCSAFP0 EQU   0                                                        10161000
IDCSACA0 EQU   0                                                        10162000
TRACE1   EQU   0                                                        10163000
OLDERID1 EQU   TRACE1                                                   10164000
TRACE2   EQU   0                                                        10165000
OLDERID2 EQU   TRACE2                                                   10166000
NEWID2   EQU   TRACE2+95                                                10167000
NEWERID2 EQU   5                                                        10168000
CIRAGL   EQU   0                                                        10169000
CIRTYPE  EQU   CIRAGL                                                   10170000
ALLAGL   EQU   0                                                        10171000
ALLSTS   EQU   ALLAGL+24                                                10172000
ALLDSP   EQU   ALLAGL+25                                                10173000
ALLORG   EQU   ALLAGL+26                                                10174000
ALLOPT   EQU   ALLAGL+28                                                10175000
UNITABL  EQU   0                                                        10176000
UNITADR  EQU   UNITABL+4                                                10177000
@NM00013 EQU   UNITADR                                                  10178000
UNITSTAT EQU   UNITABL+6                                                10179000
IOCSTR   EQU   0                                                        10180000
IOCDSO   EQU   IOCSTR+16                                                10181000
IOCRFM   EQU   IOCSTR+17                                                10182000
IOCMAC   EQU   IOCSTR+18                                                10183000
IOCMAC2  EQU   IOCSTR+19                                                10184000
IOCCHP   EQU   IOCSTR+20                                                10185000
IOCMSG   EQU   IOCSTR+21                                                10186000
IOCRBA   EQU   IOCSTR+40                                                10187000
IOCTTR   EQU   IOCRBA                                                   10188000
IOCMEM   EQU   IOCSTR+44                                                10189000
IOCNWM   EQU   IOCSTR+48                                                10190000
IOCREL   EQU   IOCSTR+60                                                10191000
OPNAGL   EQU   0                                                        10192000
OPNOPT   EQU   OPNAGL                                                   10193000
OPNRFM   EQU   OPNAGL+1                                                 10194000
OPNTYP   EQU   OPNAGL+2                                                 10195000
OPNMOD   EQU   OPNAGL+3                                                 10196000
OPNDEV   EQU   OPNAGL+24                                                10197000
OPNDSO   EQU   OPNAGL+41                                                10198000
OPNOPT2  EQU   OPNAGL+42                                                10199000
IOINFOPT EQU   0                                                        10200000
UVOLLIST EQU   0                                                        10201000
UVOLENT  EQU   UVOLLIST+2                                               10202000
AMSTP011 EQU   0                                                        10203000
AMSTP042 EQU   0                                                        10204000
IDCTPER0 EQU   0                                                        10205000
DARGLIST EQU   0                                                        10206000
DARGDBP  EQU   DARGLIST                                                 10207000
DARGRETP EQU   DARGLIST+4                                               10208000
DARGSTID EQU   DARGLIST+8                                               10209000
DARGSMOD EQU   DARGSTID                                                 10210000
DARGSENT EQU   DARGSTID+3                                               10211000
DARGILP  EQU   DARGLIST+12                                              10212000
DARGCNT  EQU   DARGLIST+14                                              10213000
DARGRETL EQU   DARGLIST+16                                              10214000
DARGIND  EQU   DARGLIST+18                                              10215000
DARGARY  EQU   DARGLIST+20                                              10216000
DARGINS  EQU   DARGARY                                                  10217000
DARGREP  EQU   DARGINS                                                  10218000
DARGINL  EQU   DARGARY+2                                                10219000
DARGPCT  EQU   DARGINL                                                  10220000
DARGDTM  EQU   DARGARY+4                                                10221000
FMTLIST  EQU   0                                                        10222000
FMTFLGS  EQU   FMTLIST                                                  10223000
FMTSPF   EQU   FMTLIST+2                                                10224000
FMTRFNO  EQU   FMTSPF                                                   10225000
FMTILEN  EQU   FMTRFNO                                                  10226000
FMTIOFF  EQU   FMTLIST+4                                                10227000
FMTTRBC  EQU   FMTIOFF                                                  10228000
FMTSTO   EQU   FMTTRBC                                                  10229000
FMTOCOL  EQU   FMTLIST+6                                                10230000
FMTCNVF  EQU   FMTLIST+10                                               10231000
ERCNVTAB EQU   0                                                        10232000
ERTYPE   EQU   ERCNVTAB                                                 10233000
ERCATLG  EQU   ERTYPE                                                   10234000
EROPER   EQU   ERCNVTAB+1                                               10235000
ERCATLC  EQU   EROPER                                                   10236000
EROSOPER EQU   ERCNVTAB+2                                               10237000
ERDSNM   EQU   ERCNVTAB+12                                              10238000
ERCATRC  EQU   ERCNVTAB+16                                              10239000
ERCPLPT  EQU   ERCNVTAB+20                                              10240000
IDCDB010 EQU   0                                                        10241000
DMPITM   EQU   0                                                        10242000
DMPITMNM EQU   DMPITM                                                   10243000
DMPITMPT EQU   DMPITM+8                                                 10244000
DMPITMLN EQU   DMPITM+12                                                10245000
DMPITMTP EQU   DMPITM+14                                                10246000
DMPARY   EQU   0                                                        10247000
DMPTRM   EQU   0                                                        10248000
CATNM    EQU   0                                                        10249000
CATNMFLG EQU   CATNM+10                                                 10250000
CATDD    EQU   0                                                        10251000
OUTDD    EQU   0                                                        10252000
ENT      EQU   0                                                        10253000
@NM00035 EQU   ENT+2                                                    10254000
ENTFLG   EQU   @NM00035+10                                              10255000
LVL      EQU   0                                                        10256000
LVLFLG   EQU   LVL+10                                                   10257000
CREAT    EQU   0                                                        10258000
EXPIR    EQU   0                                                        10259000
HIST     EQU   0                                                        10260000
NAME     EQU   0                                                        10261000
FALL     EQU   0                                                        10262000
VOL      EQU   0                                                        10263000
ALLOC    EQU   0                                                        10264000
IDAAMDSB EQU   0                                                        10265000
AMDATTR  EQU   IDAAMDSB+1                                               10266000
AMDDST   EQU   AMDATTR                                                  10267000
AMDWCK   EQU   AMDATTR                                                  10268000
AMDSDT   EQU   AMDATTR                                                  10269000
AMDREPL  EQU   AMDATTR                                                  10270000
AMDORDER EQU   AMDATTR                                                  10271000
AMDRRDS  EQU   AMDATTR                                                  10272000
AMDSPAN  EQU   AMDATTR                                                  10273000
AMDNEST  EQU   IDAAMDSB+4                                               10274000
AMDAXRKP EQU   AMDNEST                                                  10275000
AMDRKP   EQU   IDAAMDSB+6                                               10276000
AMDKEYLN EQU   IDAAMDSB+8                                               10277000
AMDPCTCA EQU   IDAAMDSB+10                                              10278000
AMDPCTCI EQU   IDAAMDSB+11                                              10279000
AMDCIPCA EQU   IDAAMDSB+12                                              10280000
AMDCINV  EQU   IDAAMDSB+20                                              10281000
AMDLRECL EQU   IDAAMDSB+24                                              10282000
AMDHLRBA EQU   IDAAMDSB+28                                              10283000
AMDNSLOT EQU   AMDHLRBA                                                 10284000
AMDSSRBA EQU   IDAAMDSB+32                                              10285000
AMDMAXRR EQU   AMDSSRBA                                                 10286000
AMDATTR3 EQU   IDAAMDSB+40                                              10287000
AMDUNQ   EQU   AMDATTR3                                                 10288000
AMDFAULT EQU   AMDATTR3                                                 10289000
AMDBIND  EQU   AMDATTR3                                                 10290000
AMDWAIT  EQU   AMDATTR3                                                 10291000
AMDSTAT  EQU   IDAAMDSB+48                                              10292000
AMDNIL   EQU   AMDSTAT+8                                                10293000
AMDNEXT  EQU   AMDSTAT+10                                               10294000
AMDNLR   EQU   AMDSTAT+12                                               10295000
AMDDELR  EQU   AMDSTAT+16                                               10296000
AMDIREC  EQU   AMDSTAT+20                                               10297000
AMDUPR   EQU   AMDSTAT+24                                               10298000
AMDRETR  EQU   AMDSTAT+28                                               10299000
AMDASPA  EQU   AMDSTAT+32                                               10300000
AMDNCIS  EQU   AMDSTAT+36                                               10301000
AMDNCAS  EQU   AMDSTAT+40                                               10302000
AMDEXCP  EQU   AMDSTAT+44                                               10303000
CTGPL    EQU   0                                                        10304000
CTGOPTN1 EQU   CTGPL                                                    10305000
CTGNAME  EQU   CTGOPTN1                                                 10306000
CTGCNAME EQU   CTGOPTN1                                                 10307000
CTGOPTN2 EQU   CTGPL+1                                                  10308000
CTGEXT   EQU   CTGOPTN2                                                 10309000
CTGERASE EQU   CTGOPTN2                                                 10310000
CTGSMF   EQU   CTGERASE                                                 10311000
CTGREL   EQU   CTGSMF                                                   10312000
CTGPURG  EQU   CTGOPTN2                                                 10313000
CTGVMNT  EQU   CTGPURG                                                  10314000
CTGRCATN EQU   CTGVMNT                                                  10315000
CTGOPTN3 EQU   CTGPL+2                                                  10316000
CTGOPTN4 EQU   CTGPL+3                                                  10317000
CTGENT   EQU   CTGPL+4                                                  10318000
CTGCAT   EQU   CTGPL+8                                                  10319000
CTGWKA   EQU   CTGPL+12                                                 10320000
CTGDSORG EQU   CTGPL+16                                                 10321000
CTGNOFLD EQU   CTGPL+19                                                 10322000
CTGDDNM  EQU   CTGPL+20                                                 10323000
CTGNEWNM EQU   CTGDDNM                                                  10324000
CTGFBFLG EQU   CTGNEWNM+2                                               10325000
CTGJSCB  EQU   CTGPL+24                                                 10326000
CTGPSWD  EQU   CTGJSCB                                                  10327000
CTGFIELD EQU   CTGPL+28                                                 10328000
CTGFL    EQU   0                                                        10329000
CTGFLDNO EQU   CTGFL                                                    10330000
CTGFLDRE EQU   CTGFL+3                                                  10331000
CTGFLDNM EQU   CTGFL+8                                                  10332000
CTGFLDAT EQU   CTGFL+16                                                 10333000
CTGFLNG  EQU   CTGFLDAT                                                 10334000
CTGFLPT  EQU   CTGFLDAT+4                                               10335000
SECURE   EQU   0                                                        10336000
PSWD     EQU   SECURE                                                   10337000
MPW      EQU   PSWD                                                     10338000
CPW      EQU   PSWD+8                                                   10339000
UPW      EQU   PSWD+16                                                  10340000
RPW      EQU   PSWD+24                                                  10341000
PRMT     EQU   SECURE+32                                                10342000
ATMP     EQU   SECURE+40                                                10343000
SMOD     EQU   SECURE+42                                                10344000
@NM00045 EQU   SECURE+50                                                10345000
SRECLEN  EQU   @NM00045                                                 10346000
SREC     EQU   @NM00045+2                                               10347000
ASSOC    EQU   0                                                        10348000
KIND     EQU   ASSOC                                                    10349000
CI#      EQU   ASSOC+1                                                  10350000
ALIASASC EQU   0                                                        10351000
NXTNMTY  EQU   ALIASASC+4                                               10352000
NXTNMPTR EQU   ALIASASC+5                                               10353000
DSRELCRA EQU   0                                                        10354000
DSREL    EQU   DSRELCRA                                                 10355000
DSSER    EQU   DSRELCRA+1                                               10356000
RGCHARS  EQU   0                                                        10357000
RGATTR   EQU   RGCHARS                                                  10358000
RGUPG    EQU   RGATTR                                                   10359000
RGUPD    EQU   RGUPG                                                    10360000
DSCHARS  EQU   0                                                        10361000
ATTR#1   EQU   DSCHARS                                                  10362000
DSSPEED  EQU   ATTR#1                                                   10363000
DSUNQ    EQU   ATTR#1                                                   10364000
DSREUSE  EQU   ATTR#1                                                   10365000
DSERAS   EQU   ATTR#1                                                   10366000
DSRCVR   EQU   ATTR#1                                                   10367000
DSINH    EQU   ATTR#1                                                   10368000
DSTEXP   EQU   ATTR#1                                                   10369000
DSTKOV   EQU   ATTR#1                                                   10370000
ATTR#2   EQU   DSCHARS+1                                                10371000
INTRASHR EQU   ATTR#2                                                   10372000
INTERSHR EQU   ATTR#2                                                   10373000
DSNUSE   EQU   ATTR#2                                                   10374000
PGSPAC   EQU   0                                                        10375000
PGSWAP   EQU   PGSPAC                                                   10376000
PGSP     EQU   PGSPAC                                                   10377000
RACFIELD EQU   0                                                        10378000
RACIND   EQU   RACFIELD                                                 10379000
DSETSP   EQU   0                                                        10380000
PRIM     EQU   DSETSP                                                   10381000
SCON     EQU   DSETSP+3                                                 10382000
@NM00050 EQU   DSETSP+6                                                 10383000
SFLG     EQU   @NM00050                                                 10384000
DSETVL   EQU   0                                                        10385000
FIXFLDS  EQU   DSETVL                                                   10386000
VFLG     EQU   FIXFLDS+14                                               10387000
VPRIM    EQU   VFLG                                                     10388000
VCAN     EQU   VFLG                                                     10389000
VOVFL    EQU   VFLG                                                     10390000
VEXT     EQU   FIXFLDS+15                                               10391000
VHKR     EQU   FIXFLDS+16                                               10392000
VHU      EQU   FIXFLDS+20                                               10393000
VHA      EQU   FIXFLDS+24                                               10394000
BLK      EQU   FIXFLDS+28                                               10395000
BPT      EQU   FIXFLDS+32                                               10396000
TPCA     EQU   FIXFLDS+34                                               10397000
VLOWKEY  EQU   0                                                        10398000
VLKYLEN  EQU   VLOWKEY                                                  10399000
VLKY     EQU   VLOWKEY+2                                                10400000
VHIKEY   EQU   0                                                        10401000
VHKYLEN  EQU   VHIKEY                                                   10402000
VHKY     EQU   VHIKEY+2                                                 10403000
CCHHS    EQU   0                                                        10404000
CCHHLEN  EQU   CCHHS                                                    10405000
CCHH     EQU   CCHHS+2                                                  10406000
TT       EQU   CCHH+10                                                  10407000
DDDD1    EQU   CCHH+12                                                  10408000
DDDD2    EQU   CCHH+16                                                  10409000
PGBYTTRK EQU   0                                                        10410000
ETYP     EQU   0                                                        10411000
ENT44    EQU   0                                                        10412000
DSID     EQU   0                                                        10413000
BUFF     EQU   0                                                        10414000
DSHU     EQU   0                                                        10415000
DSHA     EQU   0                                                        10416000
RECL     EQU   0                                                        10417000
CRDT     EQU   0                                                        10418000
EXDT     EQU   0                                                        10419000
EXIT     EQU   0                                                        10420000
CACB     EQU   0                                                        10421000
VDSPHDR  EQU   0                                                        10422000
VHDRREPN EQU   VDSPHDR                                                  10423000
VDSPFLG  EQU   VDSPHDR+15                                               10424000
VDSPUNQ  EQU   VDSPFLG                                                  10425000
VDSPAUTO EQU   VDSPFLG                                                  10426000
VDSPUCAT EQU   VDSPFLG                                                  10427000
VDSPMCAT EQU   VDSPFLG                                                  10428000
VDSPDS#  EQU   VDSPHDR+16                                               10429000
VDSPXT   EQU   VDSPHDR+18                                               10430000
@NM00054 EQU   VDSPHDR+19                                               10431000
VDSPOPT  EQU   @NM00054                                                 10432000
VDSPSCON EQU   VDSPHDR+20                                               10433000
VDSPDES  EQU   0                                                        10434000
VTRKUSED EQU   VDSPDES+2                                                10435000
VTRKPX   EQU   VDSPDES+8                                                10436000
VXSS#    EQU   VDSPDES+10                                               10437000
VSPMAPLN EQU   VDSPDES+12                                               10438000
VSPMAP   EQU   VDSPDES+14                                               10439000
VDSDIR   EQU   0                                                        10440000
VDSCI#   EQU   VDSDIR+3                                                 10441000
VDSFLG   EQU   VDSDIR+6                                                 10442000
VDSCAN   EQU   VDSFLG                                                   10443000
VSS#LEN  EQU   VDSDIR+7                                                 10444000
VSS#INFO EQU   VDSDIR+9                                                 10445000
VDIRSS#  EQU   VSS#INFO                                                 10446000
VX#      EQU   VSS#INFO+2                                               10447000
VCHAR    EQU   0                                                        10448000
VDEV     EQU   VCHAR                                                    10449000
VSYSX    EQU   0                                                        10450000
V#DSP    EQU   0                                                        10451000
V#DS     EQU   0                                                        10452000
AUDATA   EQU   0                                                        10453000
AUDEV    EQU   AUDATA+2                                                 10454000
AUSER    EQU   AUDATA+6                                                 10455000
AUFILE   EQU   AUDATA+12                                                10456000
AUVFLG   EQU   AUDATA+14                                                10457000
AUVPRIM  EQU   AUVFLG                                                   10458000
AUVCAN   EQU   AUVFLG                                                   10459000
AUVOVFL  EQU   AUVFLG                                                   10460000
GDGATR   EQU   0                                                        10461000
GDELET   EQU   GDGATR                                                   10462000
GSCRAT   EQU   GDGATR                                                   10463000
ERRDARG  EQU   0                                                        10464000
LCTEXT   EQU   0                                                        10465000
PRIMENM  EQU   LCTEXT                                                   10466000
CANNM    EQU   LCTEXT+10                                                10467000
OVFLONM  EQU   LCTEXT+20                                                10468000
AUTONM   EQU   LCTEXT+30                                                10469000
EXPLNM   EQU   LCTEXT+40                                                10470000
DATANM   EQU   LCTEXT+50                                                10471000
INDEXNM  EQU   LCTEXT+60                                                10472000
CLNM     EQU   LCTEXT+70                                                10473000
SPEEDNM  EQU   LCTEXT+80                                                10474000
RCVYNM   EQU   LCTEXT+90                                                10475000
UNQNM    EQU   LCTEXT+100                                               10476000
SUBALNM  EQU   LCTEXT+110                                               10477000
ERASNM   EQU   LCTEXT+120                                               10478000
NERASNM  EQU   LCTEXT+130                                               10479000
IXDNM    EQU   LCTEXT+140                                               10480000
NIXDNM   EQU   LCTEXT+150                                               10481000
WCKNM    EQU   LCTEXT+160                                               10482000
NWCKNM   EQU   LCTEXT+170                                               10483000
IMBDNM   EQU   LCTEXT+180                                               10484000
NIMBDNM  EQU   LCTEXT+190                                               10485000
REPLNM   EQU   LCTEXT+200                                               10486000
NREPLNM  EQU   LCTEXT+210                                               10487000
ORDNM    EQU   LCTEXT+220                                               10488000
UNORDNM  EQU   LCTEXT+230                                               10489000
RECSZNM  EQU   LCTEXT+240                                               10490000
TRKNM    EQU   LCTEXT+250                                               10491000
CYLNM    EQU   LCTEXT+260                                               10492000
SUPPNM   EQU   LCTEXT+270                                               10493000
NULLNM   EQU   LCTEXT+280                                               10494000
INHUPDNM EQU   LCTEXT+290                                               10495000
TEMEXPNM EQU   LCTEXT+300                                               10496000
UCATNM   EQU   LCTEXT+310                                               10497000
MCATNM   EQU   LCTEXT+320                                               10498000
SHRNM    EQU   LCTEXT+330                                               10499000
SHRPRNM  EQU   LCTEXT+340                                               10500000
SHR1NM   EQU   LCTEXT+350                                               10501000
SHR2NM   EQU   LCTEXT+360                                               10502000
SHR3NM   EQU   LCTEXT+370                                               10503000
SHR4NM   EQU   LCTEXT+380                                               10504000
TOVFLNM  EQU   LCTEXT+390                                               10505000
NTOVFLNM EQU   LCTEXT+400                                               10506000
SCRNM    EQU   LCTEXT+410                                               10507000
NSCRNM   EQU   LCTEXT+420                                               10508000
EMPTYNM  EQU   LCTEXT+430                                               10509000
NEMPTYNM EQU   LCTEXT+440                                               10510000
NVSAMNM  EQU   LCTEXT+450                                               10511000
GDGNM    EQU   LCTEXT+460                                               10512000
ALIASNM  EQU   LCTEXT+470                                               10513000
PGSPCNM  EQU   LCTEXT+480                                               10514000
NUMDNM   EQU   LCTEXT+490                                               10515000
RUSNM    EQU   LCTEXT+500                                               10516000
NRUSNM   EQU   LCTEXT+510                                               10517000
PATHNM   EQU   LCTEXT+520                                               10518000
SPNDNM   EQU   LCTEXT+530                                               10519000
NSPNDNM  EQU   LCTEXT+540                                               10520000
AIXNM    EQU   LCTEXT+550                                               10521000
UPGNM    EQU   LCTEXT+560                                               10522000
NUPGNM   EQU   LCTEXT+570                                               10523000
UPDNM    EQU   LCTEXT+580                                               10524000
NUPDNM   EQU   LCTEXT+590                                               10525000
UNQKNM   EQU   LCTEXT+600                                               10526000
NUNQKNM  EQU   LCTEXT+610                                               10527000
RVBLNM   EQU   LCTEXT+620                                               10528000
NUSNM    EQU   LCTEXT+630                                               10529000
CYLFNM   EQU   LCTEXT+640                                               10530000
BINDNM   EQU   LCTEXT+650                                               10531000
DSTGWNM  EQU   LCTEXT+660                                               10532000
SWAPNM   EQU   LCTEXT+670                                               10533000
NSWAPNM  EQU   LCTEXT+680                                               10534000
YESNM    EQU   LCTEXT+690                                               10535000
NONM     EQU   LCTEXT+700                                               10536000
OBJOVR   EQU   0                                                        10537000
OBJCNT   EQU   OBJOVR                                                   10538000
@NM00060 EQU   OBJOVR+4                                                 10539000
OBJTYP   EQU   @NM00060                                                 10540000
OBJNM    EQU   @NM00060+1                                               10541000
CPLWKA   EQU   0                                                        10542000
CPLWKASZ EQU   CPLWKA                                                   10543000
REQWKASZ EQU   CPLWKA+2                                                 10544000
ENT44WKA EQU   0                                                        10545000
ENTREQSZ EQU   ENT44WKA+2                                               10546000
SUPPWKA  EQU   0                                                        10547000
SUPPTYPE EQU   SUPPWKA+4                                                10548000
SUPPDSNM EQU   SUPPWKA+5                                                10549000
SAVCPL   EQU   0                                                        10550000
SAFPL    EQU   0                                                        10551000
FPLNAME  EQU   0                                                        10552000
VDSFPL   EQU   0                                                        10553000
CASTRING EQU   0                                                        10554000
CLSTRING EQU   0                                                        10555000
ALSTRING EQU   0                                                        10556000
AIX      EQU   0                                                        10557000
ALIAS    EQU   0                                                        10558000
ALIEN    EQU   0                                                        10559000
AMSTP041 EQU   0                                                        10560000
AMSTP043 EQU   0                                                        10561000
AMSTP044 EQU   0                                                        10562000
CAT      EQU   0                                                        10563000
CLUST    EQU   0                                                        10564000
DATUM    EQU   0                                                        10565000
DSB      EQU   0                                                        10566000
GDG      EQU   0                                                        10567000
GDGLMT   EQU   0                                                        10568000
IDCIOCL0 EQU   0                                                        10569000
IDCIOCO0 EQU   0                                                        10570000
IDCIOGT0 EQU   0                                                        10571000
IDCIOIT0 EQU   0                                                        10572000
IDCIOOP0 EQU   0                                                        10573000
IDCIOPO0 EQU   0                                                        10574000
IDCIOPT0 EQU   0                                                        10575000
IDCIOSI0 EQU   0                                                        10576000
IDCIOST0 EQU   0                                                        10577000
IDCIOTM0 EQU   0                                                        10578000
IDCIOVY0 EQU   0                                                        10579000
IDCIO050 EQU   0                                                        10580000
IDCSAAL0 EQU   0                                                        10581000
IDCSACL0 EQU   0                                                        10582000
IDCSACR0 EQU   0                                                        10583000
IDCSADE0 EQU   0                                                        10584000
IDCSADL0 EQU   0                                                        10585000
IDCSADQ0 EQU   0                                                        10586000
IDCSAFS0 EQU   0                                                        10587000
IDCSAGS0 EQU   0                                                        10588000
IDCSAID0 EQU   0                                                        10589000
IDCSALC0 EQU   0                                                        10590000
IDCSALD0 EQU   0                                                        10591000
IDCSALK0 EQU   0                                                        10592000
IDCSANQ0 EQU   0                                                        10593000
IDCSAPR0 EQU   0                                                        10594000
IDCSAPT0 EQU   0                                                        10595000
IDCSAQL0 EQU   0                                                        10596000
IDCSARC0 EQU   0                                                        10597000
IDCSARV0 EQU   0                                                        10598000
IDCSASC0 EQU   0                                                        10599000
IDCSASI0 EQU   0                                                        10600000
IDCSASN0 EQU   0                                                        10601000
IDCSASS0 EQU   0                                                        10602000
IDCSAST0 EQU   0                                                        10603000
IDCSATI0 EQU   0                                                        10604000
IDCSAUC0 EQU   0                                                        10605000
IDCSAWO0 EQU   0                                                        10606000
IDCSA060 EQU   0                                                        10607000
IDCST010 EQU   0                                                        10608000
INDEX    EQU   0                                                        10609000
LISTTEST EQU   0                                                        10610000
NEWERID1 EQU   5                                                        10611000
NUSE     EQU   0                                                        10612000
PATH     EQU   0                                                        10613000
PGSPC    EQU   0                                                        10614000
SPACE    EQU   0                                                        10615000
UCAT     EQU   0                                                        10616000
VTIME    EQU   0                                                        10617000
GDTTBL   EQU   0                                                        10618000
GDTTR1   EQU   GDTTBL+8                                                 10619000
GDTTR2   EQU   GDTTBL+12                                                10620000
GDTDBG   EQU   GDTTBL+40                                                10621000
GDTSTC   EQU   GDTTBL+44                                                10622000
GDTPRT   EQU   GDTTBL+48                                                10623000
GDTESS   EQU   GDTTBL+52                                                10624000
GDTESA   EQU   GDTTBL+56                                                10625000
GDTRST   EQU   GDTTBL+60                                                10626000
GDTRES   EQU   GDTTBL+64                                                10627000
GDTCAL   EQU   GDTTBL+68                                                10628000
GDTGSP   EQU   GDTTBL+72                                                10629000
GDTFSP   EQU   GDTTBL+76                                                10630000
GDTGPL   EQU   GDTTBL+80                                                10631000
GDTFPL   EQU   GDTTBL+84                                                10632000
GDTLOD   EQU   GDTTBL+88                                                10633000
GDTDEL   EQU   GDTTBL+92                                                10634000
GDTPRL   EQU   GDTTBL+96                                                10635000
GDTEPL   EQU   GDTTBL+100                                               10636000
GDTTIM   EQU   GDTTBL+104                                               10637000
GDTIIO   EQU   GDTTBL+108                                               10638000
GDTTIO   EQU   GDTTBL+112                                               10639000
GDTOPN   EQU   GDTTBL+124                                               10640000
GDTCLS   EQU   GDTTBL+128                                               10641000
GDTGET   EQU   GDTTBL+132                                               10642000
GDTPUT   EQU   GDTTBL+136                                               10643000
GDTPOS   EQU   GDTTBL+140                                               10644000
GDTCPY   EQU   GDTTBL+144                                               10645000
GDTCAT   EQU   GDTTBL+148                                               10646000
GDTSNP   EQU   GDTTBL+164                                               10647000
GDTVFY   EQU   GDTTBL+172                                               10648000
GDTECT   EQU   GDTTBL+188                                               10649000
GDTUID   EQU   GDTTBL+192                                               10650000
GDTPMT   EQU   GDTTBL+196                                               10651000
GDTCIR   EQU   GDTTBL+200                                               10652000
GDTLNK   EQU   GDTTBL+204                                               10653000
GDTALC   EQU   GDTTBL+208                                               10654000
GDTDLC   EQU   GDTTBL+212                                               10655000
GDTQAL   EQU   GDTTBL+216                                               10656000
GDTSTW   EQU   GDTTBL+220                                               10657000
GDTSSC   EQU   GDTTBL+224                                               10658000
GDTENQ   EQU   GDTTBL+228                                               10659000
GDTRSV   EQU   GDTTBL+232                                               10660000
GDTDEQ   EQU   GDTTBL+236                                               10661000
GDTSFO   EQU   GDTTBL+240                                               10662000
GDTWTO   EQU   GDTTBL+244                                               10663000
GDTSCR   EQU   GDTTBL+248                                               10664000
GDTUNT   EQU   GDTTBL+252                                               10665000
GDTRCT   EQU   GDTTBL+256                                               10666000
GDTIFO   EQU   GDTTBL+260                                               10667000
GDTEXP   EQU   GDTTBL+264                                               10668000
GDTSTA   EQU   GDTTBL+268                                               10669000
GDTERR   EQU   GDTTBL+272                                               10670000
GDTUNC   EQU   GDTTBL+276                                               10671000
GDTLOC   EQU   GDTTBL+280                                               10672000
FDTTBL   EQU   0                                                        10673000
FDTPTR   EQU   FDTTBL+8                                                 10674000
FPLLAST  EQU   0                                                        10675000
CACBSW   EQU   0                                                        10676000
ENTNMSW  EQU   0                                                        10677000
@NM00043 EQU   CTGDDNM                                                  10678000
CTGPROB  EQU   @NM00043                                                 10679000
CTGREASN EQU   CTGPROB+2                                                10680000
FPLPTMAP EQU   CORRFPLS                                                 10681000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    10682000
CTGREAS2 EQU   CTGREASN+1                                               10683000
CTGREAS1 EQU   CTGREASN                                                 10684000
CTGMODID EQU   CTGPROB                                                  10685000
FDTVERB  EQU   FDTTBL                                                   10686000
GDTPSB   EQU   GDTTBL+184                                               10687000
GDTUPT   EQU   GDTTBL+180                                               10688000
GDTCMB   EQU   GDTTBL+176                                               10689000
GDTSPR   EQU   GDTTBL+168                                               10690000
@NM00004 EQU   GDTTBL+160                                               10691000
GDTABH   EQU   GDTTBL+156                                               10692000
GDTABT   EQU   GDTTBL+152                                               10693000
GDTTOH   EQU   GDTTBL+120                                               10694000
GDTRIP   EQU   GDTTBL+116                                               10695000
GDTIOH   EQU   GDTTBL+36                                                10696000
GDTSAH   EQU   GDTTBL+32                                                10697000
GDTTPH   EQU   GDTTBL+28                                                10698000
GDTRIH   EQU   GDTTBL+24                                                10699000
GDTSTH   EQU   GDTTBL+20                                                10700000
GDTDBH   EQU   GDTTBL+16                                                10701000
GDTPRM   EQU   GDTTBL+4                                                 10702000
GDTHDR   EQU   GDTTBL                                                   10703000
@NM00063 EQU   SUPPWKA                                                  10704000
@NM00062 EQU   ENT44WKA+4                                               10705000
ENTSETSZ EQU   ENT44WKA                                                 10706000
@NM00061 EQU   CPLWKA+4                                                 10707000
@NM00058 EQU   GDGATR                                                   10708000
@NM00057 EQU   AUVFLG                                                   10709000
AUREPN   EQU   AUDATA                                                   10710000
VTOL     EQU   VCHAR+14                                                 10711000
VTRKSZ   EQU   VCHAR+12                                                 10712000
V#TRK    EQU   VCHAR+10                                                 10713000
V#CYL    EQU   VCHAR+8                                                  10714000
VMXBLK   EQU   VCHAR+4                                                  10715000
@NM00056 EQU   VDSFLG                                                   10716000
VXPDS    EQU   VDSDIR+2                                                 10717000
VDIRREPN EQU   VDSDIR                                                   10718000
SPRLCX   EQU   VSPMAP+1                                                 10719000
SPRLC    EQU   VSPMAP                                                   10720000
VXBEGN   EQU   VDSPDES+4                                                10721000
VDESREPN EQU   VDSPDES                                                  10722000
@NM00055 EQU   @NM00054                                                 10723000
@NM00053 EQU   VDSPFLG                                                  10724000
VDSCBPTR EQU   VDSPHDR+10                                               10725000
VDSCBTIM EQU   VDSPHDR+2                                                10726000
CCHH2    EQU   CCHH+6                                                   10727000
CCHH1    EQU   CCHH+2                                                   10728000
SS       EQU   CCHH                                                     10729000
DIR#     EQU   FIXFLDS+37                                               10730000
EFLG     EQU   FIXFLDS+36                                               10731000
@NM00052 EQU   VFLG                                                     10732000
FILE     EQU   FIXFLDS+12                                               10733000
SER      EQU   FIXFLDS+6                                                10734000
DEV      EQU   FIXFLDS+2                                                10735000
REPN     EQU   FIXFLDS                                                  10736000
@NM00051 EQU   @NM00050                                                 10737000
@NM00049 EQU   RACFIELD                                                 10738000
@NM00048 EQU   PGSPAC                                                   10739000
@NM00047 EQU   ATTR#2                                                   10740000
@NM00046 EQU   RGATTR                                                   10741000
DSDEV    EQU   DSRELCRA+10                                              10742000
DSCINO   EQU   DSRELCRA+7                                               10743000
LASTNMPT EQU   ALIASASC+9                                               10744000
LASTNMTY EQU   ALIASASC+8                                               10745000
REALNMPT EQU   ALIASASC+1                                               10746000
REALNMTY EQU   ALIASASC                                                 10747000
CTGFLCHN EQU   CTGFL+12                                                 10748000
CTGFLDWA EQU   CTGFL+4                                                  10749000
CTGFLDTS EQU   CTGFLDRE                                                 10750000
@NM00044 EQU   CTGFLDRE                                                 10751000
CTGFLDGC EQU   CTGFL+2                                                  10752000
CTGFLDCD EQU   CTGFL+1                                                  10753000
@NM00042 EQU   CTGFBFLG                                                 10754000
CTGNGDSN EQU   CTGFBFLG                                                 10755000
CTGGDGB  EQU   CTGFBFLG                                                 10756000
CTGKEEP  EQU   CTGFBFLG                                                 10757000
CTGPAR   EQU   CTGFBFLG                                                 10758000
CTGFDBK  EQU   CTGNEWNM                                                 10759000
CTGTYPE  EQU   CTGPL+18                                                 10760000
@NM00041 EQU   CTGDSORG                                                 10761000
CTGOPTNS EQU   CTGDSORG                                                 10762000
CTGCVOL  EQU   CTGCAT                                                   10763000
CTGFVT   EQU   CTGENT                                                   10764000
@NM00040 EQU   CTGOPTN4                                                 10765000
CTGBYPMT EQU   CTGOPTN4                                                 10766000
@NM00039 EQU   CTGOPTN4                                                 10767000
CTGNPROF EQU   CTGOPTN4                                                 10768000
CTGDOCAT EQU   CTGOPTN4                                                 10769000
CTGLBASE EQU   CTGOPTN4                                                 10770000
CTGAM0   EQU   CTGOPTN3                                                 10771000
CTGNUM   EQU   CTGOPTN3                                                 10772000
CTGSRH   EQU   CTGOPTN3                                                 10773000
CTGGDGL  EQU   CTGOPTN3                                                 10774000
CTGSUPLT EQU   CTGOPTN3                                                 10775000
CTGFUNC  EQU   CTGOPTN3                                                 10776000
@NM00038 EQU   CTGOPTN2                                                 10777000
CTGSCR   EQU   CTGOPTN2                                                 10778000
CTGOVRID EQU   CTGOPTN2                                                 10779000
CTGDISC  EQU   CTGOPTN2                                                 10780000
CTGGTNXT EQU   CTGOPTN2                                                 10781000
CTGSWAP  EQU   CTGRCATN                                                 10782000
CTGGTALL EQU   CTGREL                                                   10783000
CTGNSVS  EQU   CTGEXT                                                   10784000
CTGGENLD EQU   CTGOPTN1                                                 10785000
CTGREAD  EQU   CTGOPTN1                                                 10786000
CTGUPD   EQU   CTGOPTN1                                                 10787000
CTGCI    EQU   CTGOPTN1                                                 10788000
CTGMAST  EQU   CTGOPTN1                                                 10789000
CTGBYPSS EQU   CTGOPTN1                                                 10790000
AMDSTSP  EQU   AMDSTAT                                                  10791000
@NM00037 EQU   IDAAMDSB+41                                              10792000
@NM00036 EQU   AMDATTR3                                                 10793000
AMDLM    EQU   AMDATTR3                                                 10794000
AMDPARDB EQU   IDAAMDSB+36                                              10795000
AMDFSCI  EQU   IDAAMDSB+16                                              10796000
AMDFSCA  EQU   IDAAMDSB+14                                              10797000
AMDLEN   EQU   IDAAMDSB+2                                               10798000
AMDRANGE EQU   AMDATTR                                                  10799000
AMDSBID  EQU   IDAAMDSB                                                 10800000
EXPIRVAL EQU   EXPIR                                                    10801000
CREATVAL EQU   CREAT                                                    10802000
LVLVAL   EQU   LVL+21                                                   10803000
LVLLEN   EQU   LVL+20                                                   10804000
LVLMEM   EQU   LVL+12                                                   10805000
LVLMLN   EQU   LVL+11                                                   10806000
LVLFUQ   EQU   LVLFLG                                                   10807000
LVLPOS   EQU   LVL+9                                                    10808000
LVLPAS   EQU   LVL+1                                                    10809000
LVLPLN   EQU   LVL                                                      10810000
ENTVAL   EQU   @NM00035+21                                              10811000
ENTLEN   EQU   @NM00035+20                                              10812000
ENTMEM   EQU   @NM00035+12                                              10813000
ENTMLN   EQU   @NM00035+11                                              10814000
ENTFUQ   EQU   ENTFLG                                                   10815000
ENTPOS   EQU   @NM00035+9                                               10816000
ENTPAS   EQU   @NM00035+1                                               10817000
ENTPLN   EQU   @NM00035                                                 10818000
ENTCNT   EQU   ENT                                                      10819000
OUTDDVAL EQU   OUTDD+1                                                  10820000
OUTDDLEN EQU   OUTDD                                                    10821000
CATDDVAL EQU   CATDD+1                                                  10822000
CATDDLEN EQU   CATDD                                                    10823000
CATNMVAL EQU   CATNM+21                                                 10824000
CATNMLEN EQU   CATNM+20                                                 10825000
CATNMMEM EQU   CATNM+12                                                 10826000
CATNMMLN EQU   CATNM+11                                                 10827000
CATNMFUQ EQU   CATNMFLG                                                 10828000
CATNMPOS EQU   CATNM+9                                                  10829000
CATNMPAS EQU   CATNM+1                                                  10830000
CATNMPLN EQU   CATNM                                                    10831000
@NM00034 EQU   DMPARY+15                                                10832000
DMPARYTP EQU   DMPARY+14                                                10833000
DMPARYEX EQU   DMPARY+12                                                10834000
DMPARYIC EQU   DMPARY+10                                                10835000
DMPARYSZ EQU   DMPARY+8                                                 10836000
DMPARYNM EQU   DMPARY                                                   10837000
@NM00033 EQU   DMPITM+15                                                10838000
@NM00032 EQU   ERCNVTAB+24                                              10839000
ERDARBPT EQU   ERCPLPT                                                  10840000
ERDYNRC  EQU   ERCATRC                                                  10841000
@NM00031 EQU   ERCNVTAB+4                                               10842000
@NM00030 EQU   ERCNVTAB+3                                               10843000
@NM00029 EQU   EROSOPER                                                 10844000
EROSUCDX EQU   EROSOPER                                                 10845000
EROSCATL EQU   EROSOPER                                                 10846000
@NM00028 EQU   EROPER                                                   10847000
ERCATAL  EQU   EROPER                                                   10848000
ERCATDL  EQU   EROPER                                                   10849000
ERCATDE  EQU   EROPER                                                   10850000
@NM00027 EQU   ERTYPE                                                   10851000
ERDYNAL  EQU   ERTYPE                                                   10852000
EROSCAT  EQU   ERTYPE                                                   10853000
@NM00026 EQU   FMTCNVF+1                                                10854000
FMTAR    EQU   FMTCNVF+1                                                10855000
FMTBS    EQU   FMTCNVF+1                                                10856000
FMTSS    EQU   FMTCNVF+1                                                10857000
FMTAL    EQU   FMTCNVF+1                                                10858000
FMTZS    EQU   FMTCNVF+1                                                10859000
@NM00025 EQU   FMTCNVF                                                  10860000
FMTPU    EQU   FMTCNVF                                                  10861000
FMTBD    EQU   FMTCNVF                                                  10862000
FMTBHD   EQU   FMTCNVF                                                  10863000
FMTBHA   EQU   FMTCNVF                                                  10864000
FMTBH    EQU   FMTCNVF                                                  10865000
FMTOLEN  EQU   FMTLIST+8                                                10866000
FMTRIO   EQU   FMTOCOL                                                  10867000
FMTSPT   EQU   FMTSTO                                                   10868000
FMTSTL   EQU   FMTILEN                                                  10869000
@NM00024 EQU   FMTFLGS+1                                                10870000
FMTSMSG  EQU   FMTFLGS+1                                                10871000
FMTHDF   EQU   FMTFLGS                                                  10872000
FMTDFF   EQU   FMTFLGS                                                  10873000
FMTSTF   EQU   FMTFLGS                                                  10874000
FMTREPF  EQU   FMTFLGS                                                  10875000
FMTBDF   EQU   FMTFLGS                                                  10876000
FMTIDF   EQU   FMTFLGS                                                  10877000
FMTSCF   EQU   FMTFLGS                                                  10878000
FMTEOLF  EQU   FMTFLGS                                                  10879000
@NM00023 EQU   DARGLIST+19                                              10880000
UVOLVOL  EQU   UVOLENT+4                                                10881000
UVOLDEV  EQU   UVOLENT                                                  10882000
UVOLCNT  EQU   UVOLLIST                                                 10883000
@NM00022 EQU   IOINFOPT                                                 10884000
IOINFLUB EQU   IOINFOPT                                                 10885000
IOINFTMS EQU   IOINFOPT                                                 10886000
IOINFSUP EQU   IOINFOPT                                                 10887000
IOINFDSN EQU   IOINFOPT                                                 10888000
IOINFVOL EQU   IOINFOPT                                                 10889000
IOINFDVT EQU   IOINFOPT                                                 10890000
OPNVOL   EQU   OPNAGL+44                                                10891000
OPNSTRNO EQU   OPNAGL+43                                                10892000
@NM00021 EQU   OPNOPT2                                                  10893000
OPNOPTJM EQU   OPNOPT2                                                  10894000
OPNOPTNM EQU   OPNOPT2                                                  10895000
OPNOPTAS EQU   OPNOPT2                                                  10896000
@NM00020 EQU   OPNDSO                                                   10897000
OPNDSOPO EQU   OPNDSO                                                   10898000
OPNDSOIS EQU   OPNDSO                                                   10899000
OPNDSOPS EQU   OPNDSO                                                   10900000
OPNDSOAM EQU   OPNDSO                                                   10901000
OPNKYL   EQU   OPNAGL+40                                                10902000
OPNBLK   EQU   OPNAGL+36                                                10903000
OPNREC   EQU   OPNAGL+32                                                10904000
OPNDEVIX EQU   OPNDEV+4                                                 10905000
OPNDEVDT EQU   OPNDEV                                                   10906000
OPNCBP   EQU   OPNAGL+20                                                10907000
OPNDSN   EQU   OPNAGL+16                                                10908000
OPNPWA   EQU   OPNAGL+12                                                10909000
OPNDDN   EQU   OPNAGL+8                                                 10910000
OPNIOC   EQU   OPNAGL+4                                                 10911000
OPNMODRP EQU   OPNMOD                                                   10912000
OPNMODUB EQU   OPNMOD                                                   10913000
OPNMODRS EQU   OPNMOD                                                   10914000
OPNMODAX EQU   OPNMOD                                                   10915000
OPNMODRR EQU   OPNMOD                                                   10916000
OPNMODRC EQU   OPNMOD                                                   10917000
OPNMODAC EQU   OPNMOD                                                   10918000
OPNMODPD EQU   OPNMOD                                                   10919000
OPNTYPSY EQU   OPNTYP                                                   10920000
OPNTYPRV EQU   OPNTYP                                                   10921000
OPNTYPEX EQU   OPNTYP                                                   10922000
OPNTYPRA EQU   OPNTYP                                                   10923000
OPNTYPXM EQU   OPNTYP                                                   10924000
OPNTYPCI EQU   OPNTYP                                                   10925000
OPNTYPSO EQU   OPNTYP                                                   10926000
OPNTYPSI EQU   OPNTYP                                                   10927000
@NM00019 EQU   OPNRFM                                                   10928000
OPNRFMBK EQU   OPNRFM                                                   10929000
OPNRFMSF EQU   OPNRFM                                                   10930000
OPNRFMUN EQU   OPNRFM                                                   10931000
OPNRFMVR EQU   OPNRFM                                                   10932000
OPNRFMFX EQU   OPNRFM                                                   10933000
OPNOPTSK EQU   OPNOPT                                                   10934000
OPNOPTDR EQU   OPNOPT                                                   10935000
OPNOPTCR EQU   OPNOPT                                                   10936000
OPNOPTKS EQU   OPNOPT                                                   10937000
OPNOPTBK EQU   OPNOPT                                                   10938000
OPNOPTUP EQU   OPNOPT                                                   10939000
OPNOPTOT EQU   OPNOPT                                                   10940000
OPNOPTIN EQU   OPNOPT                                                   10941000
IOCEXT   EQU   IOCSTR+64                                                10942000
IOCTSML  EQU   IOCREL+2                                                 10943000
IOCTPML  EQU   IOCREL                                                   10944000
IOCWORK  EQU   IOCSTR+56                                                10945000
IOCRRN   EQU   IOCSTR+52                                                10946000
IOCPNM   EQU   IOCNWM+2                                                 10947000
IOCPTL   EQU   IOCNWM                                                   10948000
IOCKYA   EQU   IOCMEM                                                   10949000
IOCVRC   EQU   IOCTTR                                                   10950000
IOCCBP   EQU   IOCSTR+36                                                10951000
IOCDSN   EQU   IOCSTR+32                                                10952000
IOCHURBA EQU   IOCSTR+28                                                10953000
IOCVOLSR EQU   IOCSTR+22                                                10954000
@NM00018 EQU   IOCMSG                                                   10955000
IOCMSGSM EQU   IOCMSG                                                   10956000
IOCMSGAE EQU   IOCMSG                                                   10957000
IOCMSGCE EQU   IOCMSG                                                   10958000
IOCMSGOE EQU   IOCMSG                                                   10959000
IOCMSGOP EQU   IOCMSG                                                   10960000
IOCCHPKG EQU   IOCMSG                                                   10961000
IOCCHPKE EQU   IOCMSG                                                   10962000
IOCCHPNU EQU   IOCCHP                                                   10963000
IOCCHPUP EQU   IOCCHP                                                   10964000
IOCCHPBK EQU   IOCCHP                                                   10965000
IOCCHPCR EQU   IOCCHP                                                   10966000
IOCCHPKS EQU   IOCCHP                                                   10967000
IOCCHPSK EQU   IOCCHP                                                   10968000
IOCCHPDR EQU   IOCCHP                                                   10969000
IOCCHPSQ EQU   IOCCHP                                                   10970000
IOCMACNT EQU   IOCMAC2                                                  10971000
IOCMACER EQU   IOCMAC2                                                  10972000
IOCMACPA EQU   IOCMAC2                                                  10973000
IOCMACEN EQU   IOCMAC2                                                  10974000
IOCMACCP EQU   IOCMAC2                                                  10975000
IOCMACRR EQU   IOCMAC2                                                  10976000
IOCMACAS EQU   IOCMAC2                                                  10977000
IOCMACSK EQU   IOCMAC2                                                  10978000
@NM00017 EQU   IOCMAC                                                   10979000
IOCMACCC EQU   IOCMAC                                                   10980000
IOCMACDR EQU   IOCMAC                                                   10981000
IOCMACBK EQU   IOCMAC                                                   10982000
IOCMACCR EQU   IOCMAC                                                   10983000
IOCMACUP EQU   IOCMAC                                                   10984000
IOCMACOT EQU   IOCMAC                                                   10985000
IOCMACIN EQU   IOCMAC                                                   10986000
@NM00016 EQU   IOCRFM                                                   10987000
IOCRFMBK EQU   IOCRFM                                                   10988000
IOCRFMSF EQU   IOCRFM                                                   10989000
IOCRFMUN EQU   IOCRFM                                                   10990000
IOCRFMVR EQU   IOCRFM                                                   10991000
IOCRFMFX EQU   IOCRFM                                                   10992000
@NM00015 EQU   IOCDSO                                                   10993000
IOCDSOPO EQU   IOCDSO                                                   10994000
IOCDSOIS EQU   IOCDSO                                                   10995000
IOCDSOPS EQU   IOCDSO                                                   10996000
IOCDSOAM EQU   IOCDSO                                                   10997000
IOCRKP   EQU   IOCSTR+13                                                10998000
IOCKYL   EQU   IOCSTR+12                                                10999000
IOCTRN   EQU   IOCSTR+8                                                 11000000
IOCDLN   EQU   IOCSTR+4                                                 11001000
IOCDAD   EQU   IOCSTR                                                   11002000
UNITVTOC EQU   UNITABL+7                                                11003000
@NM00014 EQU   UNITSTAT                                                 11004000
UNITUSHR EQU   UNITSTAT                                                 11005000
UNITXSHR EQU   UNITSTAT                                                 11006000
UNITISHR EQU   UNITSTAT                                                 11007000
UNITUA   EQU   @NM00013+1                                               11008000
UNITCHA  EQU   @NM00013                                                 11009000
UNITUCB  EQU   UNITABL                                                  11010000
ALLUNCNT EQU   ALLAGL+30                                                11011000
ALLVLCNT EQU   ALLAGL+29                                                11012000
@NM00012 EQU   ALLOPT                                                   11013000
ALLOPTUN EQU   ALLOPT                                                   11014000
ALLOPTPV EQU   ALLOPT                                                   11015000
ALLOPTDS EQU   ALLOPT                                                   11016000
ALLOPTVL EQU   ALLOPT                                                   11017000
@NM00011 EQU   ALLORG+1                                                 11018000
ALLORGVS EQU   ALLORG+1                                                 11019000
@NM00010 EQU   ALLORG+1                                                 11020000
ALLORGGS EQU   ALLORG+1                                                 11021000
ALLORGUN EQU   ALLORG                                                   11022000
ALLORGPO EQU   ALLORG                                                   11023000
ALLORGMQ EQU   ALLORG                                                   11024000
ALLORGCQ EQU   ALLORG                                                   11025000
ALLORGCX EQU   ALLORG                                                   11026000
ALLORGDA EQU   ALLORG                                                   11027000
ALLORGPS EQU   ALLORG                                                   11028000
ALLORGIS EQU   ALLORG                                                   11029000
ALLDSPUN EQU   ALLDSP                                                   11030000
ALLDSPCG EQU   ALLDSP                                                   11031000
ALLDSPDE EQU   ALLDSP                                                   11032000
ALLDSPKP EQU   ALLDSP                                                   11033000
@NM00009 EQU   ALLDSP                                                   11034000
ALLSTSOD EQU   ALLSTS                                                   11035000
ALLSTSMD EQU   ALLSTS                                                   11036000
ALLSTSNW EQU   ALLSTS                                                   11037000
ALLSTSSR EQU   ALLSTS                                                   11038000
@NM00008 EQU   ALLSTS                                                   11039000
ALLPWD   EQU   ALLAGL+20                                                11040000
ALLVLP   EQU   ALLAGL+16                                                11041000
ALLULP   EQU   ALLAGL+12                                                11042000
ALLDDN   EQU   ALLAGL+4                                                 11043000
ALLDSN   EQU   ALLAGL                                                   11044000
CIRPID   EQU   CIRAGL+28                                                11045000
CIRPWD   EQU   CIRAGL+24                                                11046000
CIRCAT   EQU   CIRAGL+20                                                11047000
CIRWKP   EQU   CIRAGL+16                                                11048000
CIRTLR   EQU   CIRAGL+12                                                11049000
CIRHDR   EQU   CIRAGL+8                                                 11050000
CIRTLN   EQU   CIRAGL+6                                                 11051000
CIRHLN   EQU   CIRAGL+4                                                 11052000
@NM00007 EQU   CIRAGL+1                                                 11053000
@NM00006 EQU   CIRTYPE                                                  11054000
CIRTYPAQ EQU   CIRTYPE                                                  11055000
CIRTYP1Q EQU   CIRTYPE                                                  11056000
NEWID1   EQU   TRACE1+95                                                11057000
CALLID   EQU   OLDERID1+90                                              11058000
@NM00005 EQU   OLDERID1                                                 11059000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      11060000
@RC00400 EQU   @RC00385                                                 11061000
@RC00422 EQU   @RC00385                                                 11062000
@RF00421 EQU   @RC00385                                                 11063000
@RC00659 EQU   @RC00656                                                 11064000
@RF00759 EQU   @RC00757                                                 11065000
@RC00786 EQU   @RC00777                                                 11066000
@RC00784 EQU   @RC00777                                                 11067000
@RC00782 EQU   @RC00777                                                 11068000
@RF00856 EQU   @RC00836                                                 11069000
@RF00862 EQU   @RC00836                                                 11070000
@RC00911 EQU   @RC00909                                                 11071000
@RC00952 EQU   @RC00926                                                 11072000
@RC00959 EQU   @RC00956                                                 11073000
@RC01134 EQU   @RC01133                                                 11074000
@RC01290 EQU   @RC01279                                                 11075000
@RF01498 EQU   @RC01491                                                 11076000
@RC01640 EQU   @RC01635                                                 11077000
@RC01746 EQU   @RC01745                                                 11078000
@RC01924 EQU   @RC01923                                                 11079000
@RC01950 EQU   @RC01949                                                 11080000
@RF01962 EQU   @RC01947                                                 11081000
@RC02141 EQU   @RC02140                                                 11082000
@ENDDATA EQU   *                                                        11083000
         END   IDCLC02,(C'PLS2157',0701,76335)                          11084000
