         TITLE '************* IDCLD01: LISTDSET FSR ********************00001000
               *********'                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCLD01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCLD01   76.306'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0332 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* THIS IS THE START OF IDCLD01 MODULE. THIS SECTION     @Z40LB26*/ 00041000
*   /* INITIALIZES, CHECKS THE LEVEL PARAMETER FOR           @Z40LB26*/ 00042000
*   /* VALIDITY, CALLS A PROCEDURE TO CALCULATE AN EXPIRA-   @Z40LB26*/ 00043000
*   /* TION OR CREATION DATE, OPENS AND CLOSES THE ALTERNATE @Z40LB26*/ 00044000
*   /* OUTPUT DATA SET, CALLS THE CORRECT PROCEDURE TO       @Z40LB26*/ 00045000
*   /* EXECUTE THE FUNCTION REQUESTED ON THE COMMAND, AND    @Z40LB26*/ 00046000
*   /* SETS THE LASTCOND FIELD.                              @Z40LB26*/ 00047000
*   /*                                                       @Z40LB26*/ 00048000
*   /* ESTABLISH TRACE POINT AND FULL REGION DUMP POINT      @Z40LB26*/ 00049000
*   /*                                                               */ 00050000
*   /*****************************************************************/ 00051000
*                                                                  0332 00052000
*   OLDERID2=NEWERID2;                                             0332 00053000
         L     @15,@PC00001                                        0332 00054000
         L     @14,GDTTR2(,@15)                                    0332 00055000
         MVC   @TS00001(95),NEWERID2(@14)                          0332 00056000
         MVC   OLDERID2(95,@14),@TS00001                           0332 00057000
*   NEWID2='LD01';                  /*                       @Z40LB26*/ 00058000
         MVC   NEWID2(4,@14),@CC01376                              0333 00059000
*   IF GDTDBG=NULLPTR THEN                                         0334 00060000
         L     @15,GDTDBG(,@15)                                    0334 00061000
         LTR   @15,@15                                             0334 00062000
         BZ    @RT00334                                            0334 00063000
*     ;                                                            0335 00064000
*   ELSE                                                           0336 00065000
*     CALL IDCDB010(GDTTBL,'LDST'); /*                       @Z40LB26*/ 00066000
*                                                                  0336 00067000
         L     @15,@PC00001                                        0336 00068000
         ST    @15,@AL00001                                        0336 00069000
         LA    @14,@CC01564                                        0336 00070000
         ST    @14,@AL00001+4                                      0336 00071000
         MVI   @AL00001+4,X'80'                                    0336 00072000
         L     @15,GDTDBG(,@15)                                    0336 00073000
         LA    @01,@AL00001                                        0336 00074000
         BALR  @14,@15                                             0336 00075000
*   /*****************************************************************/ 00076000
*   /*                                                               */ 00077000
*   /* SET ADDRESSABILITY TO UPRINT AGRUMENT LIST            @Z40LB26*/ 00078000
*   /*                                                               */ 00079000
*   /*****************************************************************/ 00080000
*                                                                  0337 00081000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB26*/ 00082000
*                                                                  0337 00083000
@RT00334 LA    @15,DARGAREA                                        0337 00084000
         ST    @15,DDSTRU                                          0337 00085000
*   /*****************************************************************/ 00086000
*   /*                                                               */ 00087000
*   /* ZERO FLAG AREAS AND IOCS POINTER FOR ALTERNATE        @Z40LB26*/ 00088000
*   /* PRINT FILE OR SYSPRINT DATA SET.                      @Z40LB26*/ 00089000
*   /*                                                               */ 00090000
*   /*****************************************************************/ 00091000
*                                                                  0338 00092000
*   COMFLAGS=''B;                   /*                       @Z40LB26*/ 00093000
         MVI   COMFLAGS,X'00'                                      0338 00094000
*   INTERFLG=''B;                   /*                       @Z40LB26*/ 00095000
         MVI   INTERFLG,X'00'                                      0339 00096000
*   PRINTIT=NULLPTR;                /* INIT ALT IOCS PTR     @Z40LB26*/ 00097000
*                                                                  0340 00098000
         SLR   @14,@14                                             0340 00099000
         ST    @14,PRINTIT                                         0340 00100000
*   /*****************************************************************/ 00101000
*   /*                                                               */ 00102000
*   /* BLANK OUT SUB-TITLE LINES BEFORE USE                  @Z40LB26*/ 00103000
*   /*                                                               */ 00104000
*   /*****************************************************************/ 00105000
*                                                                  0341 00106000
*   STGRPUSE=BLANK;                 /*                       @Z40LB26*/ 00107000
         MVI   STGRPUSE+1,C' '                                     0341 00108000
         MVC   STGRPUSE+2(119),STGRPUSE+1                          0341 00109000
         MVI   STGRPUSE,C' '                                       0341 00110000
*   STGRPSTA=BLANK;                 /*                       @Z40LB26*/ 00111000
         MVI   STGRPSTA+1,C' '                                     0342 00112000
         MVC   STGRPSTA+2(119),STGRPSTA+1                          0342 00113000
         MVI   STGRPSTA,C' '                                       0342 00114000
*   STVOLUSE=BLANK;                 /*                       @Z40LB26*/ 00115000
         MVI   STVOLUSE+1,C' '                                     0343 00116000
         MVC   STVOLUSE+2(119),STVOLUSE+1                          0343 00117000
         MVI   STVOLUSE,C' '                                       0343 00118000
*   STVOLSTA=BLANK;                 /*                       @Z40LB26*/ 00119000
         MVI   STVOLSTA+1,C' '                                     0344 00120000
         MVC   STVOLSTA+2(119),STVOLSTA+1                          0344 00121000
         MVI   STVOLSTA,C' '                                       0344 00122000
*   STLGND=BLANK;                   /*                       @Z40LB26*/ 00123000
*                                                                  0345 00124000
         MVI   STLGND+1,C' '                                       0345 00125000
         MVC   STLGND+2(119),STLGND+1                              0345 00126000
         MVI   STLGND,C' '                                         0345 00127000
*   /*****************************************************************/ 00128000
*   /*                                                               */ 00129000
*   /* INITILIZE NAME OF LAST GROUP PROCESSED TO ZERO        @Z40LB26*/ 00130000
*   /*                                                               */ 00131000
*   /*****************************************************************/ 00132000
*                                                                  0346 00133000
*   OLDGROUP=''B;                   /*                       @Z40LB26*/ 00134000
*                                                                  0346 00135000
         XC    OLDGROUP(8),OLDGROUP                                0346 00136000
*   /*****************************************************************/ 00137000
*   /*                                                               */ 00138000
*   /* INITILIZE FIELDS IN THE UREST ARGUMENT LIST           @Z40LB26*/ 00139000
*   /*                                                               */ 00140000
*   /*****************************************************************/ 00141000
*                                                                  0347 00142000
*   PCRSST=SUBTITLE;                /* INDIC CHANGE SUB-TITLE      0347 00143000
*                                                            @Z40LB26*/ 00144000
         MVC   PCRSST(2),@CC01523                                  0347 00145000
*   PCRSTLC=LINECNT;                /* NO LINES IN SUB-TITLE @Z40LB26*/ 00146000
*                                                                  0348 00147000
         MVC   PCRSTLC(2),@CH00222                                 0348 00148000
*   /*****************************************************************/ 00149000
*   /*                                                               */ 00150000
*   /* SET ADDRESSABILITY TO VOLUME RECORD AND GROUP RECORD  @Z40LB26*/ 00151000
*   /*                                                               */ 00152000
*   /*****************************************************************/ 00153000
*                                                                  0349 00154000
*   BASEVPTR=ADDR(VOLREC);          /*                       @Z40LB26*/ 00155000
         LA    BASEVPTR,VOLREC                                     0349 00156000
*   GROUPPTR=ADDR(GRPREC);          /*                       @Z40LB26*/ 00157000
*                                                                  0350 00158000
         LA    @07,GRPREC                                          0350 00159000
         ST    @07,GROUPPTR                                        0350 00160000
*   /*****************************************************************/ 00161000
*   /*                                                               */ 00162000
*   /* SET UP ADDRESSING TO PARAMETER LISTS                  @Z40LB26*/ 00163000
*   /*                                                               */ 00164000
*   /*****************************************************************/ 00165000
*                                                                  0351 00166000
*   RESPECIFY                                                      0351 00167000
*     ALLAGL BASED(ADDR(ALOCAREA)); /*                       @Z40LB26*/ 00168000
*   RESPECIFY                                                      0352 00169000
*     VS3AGL BASED(ADDR(AREAVS3));  /*                       @Z40LB26*/ 00170000
*   RESPECIFY                                                      0353 00171000
*     SELAGL BASED(ADDR(SLTAREA));  /*                       @Z40LB26*/ 00172000
*   RESPECIFY                                                      0354 00173000
*     CKAGL BASED(ADDR(CHKAREA));   /*                       @Z40LB26*/ 00174000
*   RESPECIFY                                                      0355 00175000
*     DATESAGL BASED(ADDR(DTSAREA));/*                       @Z40LB26*/ 00176000
*   RESPECIFY                                                      0356 00177000
*     SRTAGL BASED(ADDR(SORTAREA)); /*                       @Z40LB26*/ 00178000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB26*/ 00179000
         ST    @15,DDSTRU                                          0357 00180000
*   OPNPTR=ADDR(OPNAREA);           /*                       @Z40LB26*/ 00181000
         LA    OPNPTR,OPNAREA                                      0358 00182000
*   RESPECIFY                                                      0359 00183000
*     VSDBLOCK BASED(LISTADDR);     /*                       @Z40LB26*/ 00184000
*                                                                  0360 00185000
*   /*****************************************************************/ 00186000
*   /*                                                               */ 00187000
*   /* IF THE LEVEL PARAMETER WAS SPECIFIED AND THE LAST     @Z40LB26*/ 00188000
*   /* CHARACTER IS AN ASTERISK, ISSUE MESSAGE IDC3113I      @Z40LB26*/ 00189000
*   /* AND SET THE LASTCOND FIELD                            @Z40LB26*/ 00190000
*   /*                                                               */ 00191000
*   /*****************************************************************/ 00192000
*                                                                  0360 00193000
*   IF ADDR(LEVEL)^=NULLPTR&LEVELPOS=LEVELLEN THEN/*         @Z40LB26*/ 00194000
         L     @07,@PC00001+4                                      0360 00195000
         L     @07,FDTPTR+20(,@07)                                 0360 00196000
         CR    @07,@14                                             0360 00197000
         BE    @RF00360                                            0360 00198000
         CLC   LEVELPOS(1,@07),LEVELLEN(@07)                       0360 00199000
         BNE   @RF00360                                            0360 00200000
*     DO;                           /*                       @Z40LB26*/ 00201000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 00202000
         XC    DARGAREA(76),DARGAREA                               0362 00203000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/ 00204000
         MVC   DARGSMOD(3,@15),@CC01475                            0363 00205000
*       DARGSENT=MSG3113I;          /*                       @Z40LB26*/ 00206000
         MVI   DARGSENT(@15),X'45'                                 0364 00207000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 00208000
         L     @15,@PC00001                                        0365 00209000
         ST    @15,@AL00001                                        0365 00210000
         LA    @14,@CF00117                                        0365 00211000
         ST    @14,@AL00001+4                                      0365 00212000
         LA    @14,DDSTRU                                          0365 00213000
         ST    @14,@AL00001+8                                      0365 00214000
         MVI   @AL00001+8,X'80'                                    0365 00215000
         L     @15,GDTPRT(,@15)                                    0365 00216000
         LA    @01,@AL00001                                        0365 00217000
         BALR  @14,@15                                             0365 00218000
*       LASTCOND=LASTCC12;          /*                       @Z40LB26*/ 00219000
         L     @15,@PC00001+8                                      0366 00220000
         MVC   LASTCOND(2,@15),@CH00035                            0366 00221000
*     END;                          /*                       @Z40LB26*/ 00222000
*                                                                  0367 00223000
*   /*****************************************************************/ 00224000
*   /*                                                               */ 00225000
*   /* IF THE FILE PARAMETER WAS SPECIFIED ON THE COMMAND,   @Z40LB26*/ 00226000
*   /* ISSUE THE UMSSUNIT MACRO TO CHECK THAT IT IS          @Z40LB26*/ 00227000
*   /* A VIRTUAL DEVICE AND A DEMOUNTABLE UNIT. SAVE THE     @Z40LB26*/ 00228000
*   /* RETURN CODE AND SET THE LASTCOND FIELD.               @Z40LB26*/ 00229000
*   /*                                                               */ 00230000
*   /*****************************************************************/ 00231000
*                                                                  0368 00232000
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Z40LB26*/ 00233000
@RF00360 SLR   @15,@15                                             0368 00234000
         L     @14,@PC00001+4                                      0368 00235000
         L     @14,FDTPTR+44(,@14)                                 0368 00236000
         CR    @14,@15                                             0368 00237000
         BE    @RF00368                                            0368 00238000
*     DO;                           /*                       @Z40LB26*/ 00239000
*       CKAGL=''B;                  /*                       @Z40LB26*/ 00240000
         LA    @02,CHKAREA                                         0370 00241000
         XC    CKAGL(29,@02),CKAGL(@02)                            0370 00242000
*       CKTESTVT=ON;                /* TEST FOR VIRTUAL      @Z40LB26*/ 00243000
*       CKDMTABL=ON;                /* TEST FOR DEMOUNTABLE  @Z40LB26*/ 00244000
         OI    CKTESTVT(@02),B'10100000'                           0372 00245000
*       CKDDNAME=FILEVAL;           /*                       @Z40LB26*/ 00246000
         MVC   CKDDNAME(8,@02),FILEVAL(@14)                        0373 00247000
*       CKUCBPTR=ADDR(FILEUCB);     /* UCB ADDRESS TO BE     @Z40LB26   00248000
*                                      RETURNED              @Z40LB26*/ 00249000
         LA    @14,FILEUCB                                         0374 00250000
         ST    @14,CKUCBPTR(,@02)                                  0374 00251000
*       FILEUCB=NULLPTR;            /*                       @Z40LB26*/ 00252000
         ST    @15,FILEUCB                                         0375 00253000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB26*/ 00254000
         L     @15,@PC00001                                        0376 00255000
         ST    @15,@AL00001                                        0376 00256000
         LA    @14,CHECK                                           0376 00257000
         ST    @14,@AL00001+4                                      0376 00258000
         ST    @02,@AL00001+8                                      0376 00259000
         MVI   @AL00001+8,X'80'                                    0376 00260000
         L     @15,GDTUNT(,@15)                                    0376 00261000
         LA    @01,@AL00001                                        0376 00262000
         BALR  @14,@15                                             0376 00263000
*       RESPECIFY                                                  0377 00264000
*         RTNREG RSTD;                                             0377 00265000
*       TESTRC=RTNREG;                                             0378 00266000
         LR    TESTRC,RTNREG                                       0378 00267000
*       RESPECIFY                                                  0379 00268000
*         RTNREG UNRSTD;            /*                       @Z40LB26*/ 00269000
*       IF TESTRC^=0 THEN           /*                       @Z40LB26*/ 00270000
         LTR   TESTRC,TESTRC                                       0380 00271000
         BZ    @RF00380                                            0380 00272000
*         LASTCOND=LASTCC12;        /*                       @Z40LB26*/ 00273000
         L     @15,@PC00001+8                                      0381 00274000
         MVC   LASTCOND(2,@15),@CH00035                            0381 00275000
*     END;                          /*                       @Z40LB26*/ 00276000
*                                                                  0382 00277000
@RF00380 DS    0H                                                  0383 00278000
*   /*****************************************************************/ 00279000
*   /*                                                               */ 00280000
*   /* CHECK TO SEE IF AN ALTERNATE OUTPUT DATA SET WAS      @Z40LB26*/ 00281000
*   /* SPECIFIED. IF SPECIFIED, OPEN IT AND SET LASTCOND     @Z40LB26*/ 00282000
*   /* FIELD, IF AN ERROR OCCURS.                            @Z40LB26*/ 00283000
*   /*                                                               */ 00284000
*   /*****************************************************************/ 00285000
*                                                                  0383 00286000
*   IF(ADDR(OFILE)^=NULLPTR|ADDR(ODS)^=NULLPTR)&/*           @Z40LB26*/ 00287000
*       LASTCOND=LASTCC00 THEN      /*                       @Z40LB26*/ 00288000
@RF00368 SLR   @15,@15                                             0383 00289000
         L     @14,@PC00001+4                                      0383 00290000
         C     @15,FDTPTR+68(,@14)                                 0383 00291000
         BNE   @GL00002                                            0383 00292000
         C     @15,FDTPTR+72(,@14)                                 0383 00293000
         BE    @RF00383                                            0383 00294000
@GL00002 SLR   @15,@15                                             0383 00295000
         L     @14,@PC00001+8                                      0383 00296000
         CH    @15,LASTCOND(,@14)                                  0383 00297000
         BNE   @RF00383                                            0383 00298000
*     DO;                           /*                       @Z40LB26*/ 00299000
*       OPNAREA=''B;                /*                       @Z40LB26*/ 00300000
         XC    OPNAREA(48),OPNAREA                                 0385 00301000
*       OPNOPTOT=ON;                /* OPEN FOR OUTPUT       @Z40LB26*/ 00302000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0386 00303000
*       OPNIOC=ADDR(PRINTIT);       /* SET IOCS POINTER      @Z40LB26*/ 00304000
         LA    @14,PRINTIT                                         0387 00305000
         ST    @14,OPNIOC(,OPNPTR)                                 0387 00306000
*       OPNMODAC=ON;                /* ASA CARRIAGE CONTROL  @Z40LB26*/ 00307000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0388 00308000
*       IF ADDR(OFILE)^=NULLPTR THEN/*                       @Z40LB26*/ 00309000
         L     @14,@PC00001+4                                      0389 00310000
         L     @14,FDTPTR+68(,@14)                                 0389 00311000
         CR    @14,@15                                             0389 00312000
         BE    @RF00389                                            0389 00313000
*         OPNDDN=ADDR(OFILEVAL);    /* ADDRESS OF DDNAME     @Z40LB26*/ 00314000
         LA    @15,OFILEVAL(,@14)                                  0390 00315000
         ST    @15,OPNDDN(,OPNPTR)                                 0390 00316000
*       ELSE                        /*                       @Z40LB26*/ 00317000
*         OPNDSN=ADDR(ODSVAL);      /* ADDRESS OF DATA SET   @Z40LB26   00318000
*                                      NAME                  @Z40LB26*/ 00319000
         B     @RC00389                                            0391 00320000
@RF00389 L     @15,@PC00001+4                                      0391 00321000
         L     @01,FDTPTR+72(,@15)                                 0391 00322000
         LA    @15,ODSVAL(,@01)                                    0391 00323000
         ST    @15,OPNDSN(,OPNPTR)                                 0391 00324000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Z40LB26*/ 00325000
@RC00389 L     @02,@PC00001                                        0392 00326000
         ST    @02,@AL00001                                        0392 00327000
         ST    OPNPTR,@AL00001+4                                   0392 00328000
         MVI   @AL00001+4,X'80'                                    0392 00329000
         L     @15,GDTOPN(,@02)                                    0392 00330000
         LA    @01,@AL00001                                        0392 00331000
         BALR  @14,@15                                             0392 00332000
*       RESPECIFY                                                  0393 00333000
*         RTNREG RSTD;                                             0393 00334000
*       TESTRC=RTNREG;                                             0394 00335000
         LR    TESTRC,RTNREG                                       0394 00336000
*       RESPECIFY                                                  0395 00337000
*         RTNREG UNRSTD;            /*                       @Z40LB26*/ 00338000
*       IF TESTRC=4 THEN            /*                       @Z40LB26*/ 00339000
         C     TESTRC,@CF00043                                     0396 00340000
         BNE   @RF00396                                            0396 00341000
*         LASTCOND=LASTCC12;        /*                       @Z40LB26*/ 00342000
         L     @04,@PC00001+8                                      0397 00343000
         MVC   LASTCOND(2,@04),@CH00035                            0397 00344000
*     END;                          /*                       @Z40LB26*/ 00345000
@RF00396 DS    0H                                                  0399 00346000
*                                                                  0399 00347000
*   /*****************************************************************/ 00348000
*   /*                                                               */ 00349000
*   /* IF ALL CHECKS AND OPEN OF THE OUTPUT DATA SET WERE    @Z40LB26*/ 00350000
*   /* SUCCESSFUL, CONTINUE WITH PROCESSING.                 @Z40LB26*/ 00351000
*   /*                                                               */ 00352000
*   /*****************************************************************/ 00353000
*                                                                  0399 00354000
*   IF LASTCOND=LASTCC00 THEN       /*                       @Z40LB26*/ 00355000
@RF00383 L     @04,@PC00001+8                                      0399 00356000
         LH    @04,LASTCOND(,@04)                                  0399 00357000
         LTR   @04,@04                                             0399 00358000
         BNZ   @RF00399                                            0399 00359000
*     DO;                           /*                       @Z40LB26*/ 00360000
*                                                                  0400 00361000
*       /*************************************************************/ 00362000
*       /*                                                           */ 00363000
*       /* ISSUE UPRINT MACRO TO READ INTO STORAGE           @Z40LB26*/ 00364000
*       /* THE CONSTANTS TO BE INSERTED INTO THE REPORTS     @Z40LB26*/ 00365000
*       /*                                                           */ 00366000
*       /*************************************************************/ 00367000
*                                                                  0401 00368000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 00369000
         XC    DARGAREA(76),DARGAREA                               0401 00370000
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/ 00371000
         L     @04,DDSTRU                                          0402 00372000
         MVC   DARGSMOD(3,@04),@CC01477                            0402 00373000
*       DARGSENT=PRTCON;            /*                       @Z40LB26*/ 00374000
         MVI   DARGSENT(@04),X'0C'                                 0403 00375000
*       DARGRETP=ADDR(PRINTCON);    /* AREA TO RETURN CONS   @Z40LB26*/ 00376000
         LA    @15,PRINTCON                                        0404 00377000
         ST    @15,DARGRETP(,@04)                                  0404 00378000
*       DARGRETL=LENGTH(PRINTCON);  /*                       @Z40LB26*/ 00379000
         MVC   DARGRETL(2,@04),@CH01501                            0405 00380000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 00381000
*                                                                  0406 00382000
         L     @04,@PC00001                                        0406 00383000
         ST    @04,@AL00001                                        0406 00384000
         LA    @15,@CF00117                                        0406 00385000
         ST    @15,@AL00001+4                                      0406 00386000
         LA    @15,DDSTRU                                          0406 00387000
         ST    @15,@AL00001+8                                      0406 00388000
         MVI   @AL00001+8,X'80'                                    0406 00389000
         L     @15,GDTPRT(,@04)                                    0406 00390000
         LA    @01,@AL00001                                        0406 00391000
         BALR  @14,@15                                             0406 00392000
*       /*************************************************************/ 00393000
*       /*                                                           */ 00394000
*       /* IF EXPIRATION PARAMETERS WERE SPECIFIED ON        @Z40LB26*/ 00395000
*       /* THE COMMAND, CALL THE DATES PROCEDURE TO          @Z40LB26*/ 00396000
*       /* CALCULATE A DATE FOR COMPARISON                   @Z40LB26*/ 00397000
*       /*                                                           */ 00398000
*       /*************************************************************/ 00399000
*                                                                  0407 00400000
*       IF ADDR(EXPIR)^=NULLPTR|ADDR(EXPDT)^=NULLPTR/*       @Z40LB26*/ 00401000
*         THEN                      /*                       @Z40LB26*/ 00402000
         SLR   @04,@04                                             0407 00403000
         L     @15,@PC00001+4                                      0407 00404000
         C     @04,FDTPTR+32(,@15)                                 0407 00405000
         BNE   @RT00407                                            0407 00406000
         C     @04,FDTPTR+28(,@15)                                 0407 00407000
         BE    @RF00407                                            0407 00408000
@RT00407 DS    0H                                                  0408 00409000
*         DO;                       /*                       @Z40LB26*/ 00410000
*           DATESAGL=''B;           /*                       @Z40LB26*/ 00411000
         LA    @04,DTSAREA                                         0409 00412000
         XC    DATESAGL(21,@04),DATESAGL(@04)                      0409 00413000
*           DATRETRN=ADDR(EXPDATE); /* PLACE TO RETURN       @Z40LB26   00414000
*                                      DATE                  @Z40LB26*/ 00415000
*                                                                  0410 00416000
         LA    @15,EXPDATE                                         0410 00417000
         ST    @15,DATRETRN(,@04)                                  0410 00418000
*           /*********************************************************/ 00419000
*           /*                                                       */ 00420000
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB26*/ 00421000
*           /*                                                       */ 00422000
*           /*********************************************************/ 00423000
*                                                                  0411 00424000
*           IF ADDR(EXPIR)^=NULLPTR THEN/*                   @Z40LB26*/ 00425000
         L     @15,@PC00001+4                                      0411 00426000
         L     @15,FDTPTR+32(,@15)                                 0411 00427000
         LTR   @15,@15                                             0411 00428000
         BZ    @RF00411                                            0411 00429000
*             DO;                   /*                       @Z40LB26*/ 00430000
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB26*/ 00431000
         OI    DATDAYOP(@04),B'00010000'                           0413 00432000
*               DATDAYS=EXPIRVAL;   /* NUMBER OF DAYS        @Z40LB26*/ 00433000
         L     @15,EXPIRVAL(,@15)                                  0414 00434000
         ST    @15,DATDAYS(,@04)                                   0414 00435000
*               DATADD=ON;          /* ADD DAYS TO CURRENT   @Z40LB26   00436000
*                                      DATE                  @Z40LB26*/ 00437000
         OI    DATADD(@04),B'10000000'                             0415 00438000
*             END;                  /*                       @Z40LB26*/ 00439000
*           ELSE                    /*                       @Z40LB26*/ 00440000
*             DO;                   /*                       @Z40LB26*/ 00441000
         B     @RC00411                                            0417 00442000
@RF00411 DS    0H                                                  0418 00443000
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB26*/ 00444000
         LA    @04,DTSAREA                                         0418 00445000
         OI    DATDTEOP(@04),B'00100000'                           0418 00446000
*               DATDATE=EXPDTVAL;   /* DATE                  @Z40LB26*/ 00447000
         L     @15,@PC00001+4                                      0419 00448000
         L     @01,FDTPTR+28(,@15)                                 0419 00449000
         L     @15,EXPDTVAL(,@01)                                  0419 00450000
         ST    @15,DATDATE(,@04)                                   0419 00451000
*             END;                  /*                       @Z40LB26*/ 00452000
*           CALL DATES(DATESAGL);   /*                       @Z40LB26*/ 00453000
@RC00411 LA    @04,DTSAREA                                         0421 00454000
         ST    @04,@AL00001                                        0421 00455000
         LA    @01,@AL00001                                        0421 00456000
         BAL   @14,DATES                                           0421 00457000
*         END;                      /*                       @Z40LB26*/ 00458000
*                                                                  0423 00459000
*       /*************************************************************/ 00460000
*       /*                                                           */ 00461000
*       /* IF CREATION PARAMETERS WERE SPECIFIED ON THE      @Z40LB26*/ 00462000
*       /* COMMAND, CALL THE DATES PROCEDURE TO CALCULATE    @Z40LB26*/ 00463000
*       /* A DATE FOR COMPARISON                             @Z40LB26*/ 00464000
*       /*                                                           */ 00465000
*       /*************************************************************/ 00466000
*                                                                  0423 00467000
*       IF ADDR(CREAT)^=NULLPTR|ADDR(CREDT)^=NULLPTR/*       @Z40LB26*/ 00468000
*         THEN                      /*                       @Z40LB26*/ 00469000
@RF00407 SLR   @04,@04                                             0423 00470000
         L     @15,@PC00001+4                                      0423 00471000
         C     @04,FDTPTR+40(,@15)                                 0423 00472000
         BNE   @RT00423                                            0423 00473000
         C     @04,FDTPTR+36(,@15)                                 0423 00474000
         BE    @RF00423                                            0423 00475000
@RT00423 DS    0H                                                  0424 00476000
*         DO;                       /*                       @Z40LB26*/ 00477000
*           DATESAGL=''B;           /*                       @Z40LB26*/ 00478000
         LA    @04,DTSAREA                                         0425 00479000
         XC    DATESAGL(21,@04),DATESAGL(@04)                      0425 00480000
*           DATRETRN=ADDR(CREDATE); /* PLACE TO RETURN       @Z40LB26   00481000
*                                      DATE                  @Z40LB26*/ 00482000
*                                                                  0426 00483000
         LA    @15,CREDATE                                         0426 00484000
         ST    @15,DATRETRN(,@04)                                  0426 00485000
*           /*********************************************************/ 00486000
*           /*                                                       */ 00487000
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB26*/ 00488000
*           /*                                                       */ 00489000
*           /*********************************************************/ 00490000
*                                                                  0427 00491000
*           IF ADDR(CREAT)^=NULLPTR THEN/*                   @Z40LB26*/ 00492000
         L     @15,@PC00001+4                                      0427 00493000
         L     @15,FDTPTR+40(,@15)                                 0427 00494000
         LTR   @15,@15                                             0427 00495000
         BZ    @RF00427                                            0427 00496000
*             DO;                   /*                       @Z40LB26*/ 00497000
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB26*/ 00498000
         OI    DATDAYOP(@04),B'00010000'                           0429 00499000
*               DATDAYS=CREATVAL;   /* NUMBER OF DAYS        @Z40LB26*/ 00500000
         L     @15,CREATVAL(,@15)                                  0430 00501000
         ST    @15,DATDAYS(,@04)                                   0430 00502000
*               DATSUB=ON;          /* SUBTRACT DAYS FROM    @Z40LB26   00503000
*                                      CURRENT DATE          @Z40LB26*/ 00504000
         OI    DATSUB(@04),B'01000000'                             0431 00505000
*             END;                  /*                       @Z40LB26*/ 00506000
*           ELSE                    /*                       @Z40LB26*/ 00507000
*             DO;                   /*                       @Z40LB26*/ 00508000
         B     @RC00427                                            0433 00509000
@RF00427 DS    0H                                                  0434 00510000
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB26*/ 00511000
         LA    @04,DTSAREA                                         0434 00512000
         OI    DATDTEOP(@04),B'00100000'                           0434 00513000
*               DATDATE=CREDTVAL;   /* DATE                  @Z40LB26*/ 00514000
         L     @15,@PC00001+4                                      0435 00515000
         L     @01,FDTPTR+36(,@15)                                 0435 00516000
         L     @15,CREDTVAL(,@01)                                  0435 00517000
         ST    @15,DATDATE(,@04)                                   0435 00518000
*             END;                  /*                       @Z40LB26*/ 00519000
*           CALL DATES(DATESAGL);   /*                       @Z40LB26*/ 00520000
@RC00427 LA    @04,DTSAREA                                         0437 00521000
         ST    @04,@AL00001                                        0437 00522000
         LA    @01,@AL00001                                        0437 00523000
         BAL   @14,DATES                                           0437 00524000
*         END;                      /*                       @Z40LB26*/ 00525000
*                                                                  0439 00526000
*       /*************************************************************/ 00527000
*       /*                                                           */ 00528000
*       /* CALL THE PROPER PROCEDURE TO PROCESS THE VOLUMES  @Z40LB26*/ 00529000
*       /* BASED ON THE PARAMETER SPECIFIED ON THE COMMAND:  @Z40LB26*/ 00530000
*       /* VOLUMES, GROUPS, NONGROUPED, ALLVOLUMES, OR       @Z40LB26*/ 00531000
*       /* ALLGROUPS                                         @Z40LB26*/ 00532000
*       /*                                                           */ 00533000
*       /*************************************************************/ 00534000
*                                                                  0439 00535000
*       IF ADDR(VOL)^=NULLPTR THEN  /*                       @Z40LB26*/ 00536000
@RF00423 L     @04,@PC00001+4                                      0439 00537000
         L     @04,FDTPTR(,@04)                                    0439 00538000
         LTR   @04,@04                                             0439 00539000
         BZ    @RF00439                                            0439 00540000
*         CALL SPECVOL;             /*                       @Z40LB26*/ 00541000
         BAL   @14,SPECVOL                                         0440 00542000
*       ELSE                        /*                       @Z40LB26*/ 00543000
*         IF ADDR(GRP)^=NULLPTR THEN/*                       @Z40LB26*/ 00544000
         B     @RC00439                                            0441 00545000
@RF00439 L     @04,@PC00001+4                                      0441 00546000
         L     @04,FDTPTR+4(,@04)                                  0441 00547000
         LTR   @04,@04                                             0441 00548000
         BZ    @RF00441                                            0441 00549000
*           CALL SPECGRP;           /*                       @Z40LB26*/ 00550000
         BAL   @14,SPECGRP                                         0442 00551000
*         ELSE                      /*                       @Z40LB26*/ 00552000
*           IF ADDR(NGRPD)^=NULLPTR THEN/*                   @Z40LB26*/ 00553000
         B     @RC00441                                            0443 00554000
@RF00441 L     @04,@PC00001+4                                      0443 00555000
         L     @04,FDTPTR+16(,@04)                                 0443 00556000
         LTR   @04,@04                                             0443 00557000
         BZ    @RF00443                                            0443 00558000
*             CALL NONGRPD;         /*                       @Z40LB26*/ 00559000
         BAL   @14,NONGRPD                                         0444 00560000
*           ELSE                    /*                       @Z40LB26*/ 00561000
*             IF ADDR(AGRP)^=NULLPTR THEN/*                  @Z40LB26*/ 00562000
         B     @RC00443                                            0445 00563000
@RF00443 L     @04,@PC00001+4                                      0445 00564000
         L     @04,FDTPTR+12(,@04)                                 0445 00565000
         LTR   @04,@04                                             0445 00566000
         BZ    @RF00445                                            0445 00567000
*               CALL ALLGRPS;       /*                       @Z40LB26*/ 00568000
         BAL   @14,ALLGRPS                                         0446 00569000
*             ELSE                  /*                       @Z40LB26*/ 00570000
*               IF ADDR(AVOL)^=NULLPTR THEN/*                @Z40LB26*/ 00571000
         B     @RC00445                                            0447 00572000
@RF00445 L     @04,@PC00001+4                                      0447 00573000
         L     @04,FDTPTR+8(,@04)                                  0447 00574000
         LTR   @04,@04                                             0447 00575000
         BZ    @RF00447                                            0447 00576000
*                 CALL ALLVOLS;     /*                       @Z40LB26*/ 00577000
*                                                                  0448 00578000
         BAL   @14,ALLVOLS                                         0448 00579000
*       /*************************************************************/ 00580000
*       /*                                                           */ 00581000
*       /* SAVE THE RETURN CODE AND SET THE LASTCOND         @Z40LB26*/ 00582000
*       /* FIELD EQUAL TO THE RETURN CODE                    @Z40LB26*/ 00583000
*       /*                                                           */ 00584000
*       /*************************************************************/ 00585000
*                                                                  0449 00586000
*       RESPECIFY                                                  0449 00587000
*         RTNREG RSTD;                                             0449 00588000
@RF00447 DS    0H                                                  0449 00589000
@RC00445 DS    0H                                                  0449 00590000
@RC00443 DS    0H                                                  0449 00591000
@RC00441 DS    0H                                                  0449 00592000
@RC00439 DS    0H                                                  0450 00593000
*       TESTRC=RTNREG;                                             0450 00594000
         LR    TESTRC,RTNREG                                       0450 00595000
*       RESPECIFY                                                  0451 00596000
*         RTNREG UNRSTD;            /*                       @Z40LB26*/ 00597000
*       LASTCOND=TESTRC;            /*                       @Z40LB26*/ 00598000
*                                                                  0452 00599000
         L     @02,@PC00001+8                                      0452 00600000
         STH   TESTRC,LASTCOND(,@02)                               0452 00601000
*       /*************************************************************/ 00602000
*       /*                                                           */ 00603000
*       /* CHECK IF NEED TO CALL LEGEND ROUTINE              @Z40LB26*/ 00604000
*       /*                                                           */ 00605000
*       /*************************************************************/ 00606000
*                                                                  0453 00607000
*       IF LASTCOND<LASTCC12&ADDR(LGND)^=NULLPTR THEN/*      @Z40LB26*/ 00608000
         L     @15,@PC00001+8                                      0453 00609000
         LH    @15,LASTCOND(,@15)                                  0453 00610000
         C     @15,@CF00035                                        0453 00611000
         BNL   @RF00453                                            0453 00612000
         L     @15,@PC00001+4                                      0453 00613000
         L     @15,FDTPTR+60(,@15)                                 0453 00614000
         LTR   @15,@15                                             0453 00615000
         BZ    @RF00453                                            0453 00616000
*         CALL LEGENDS;             /*                       @Z40LB26*/ 00617000
         BAL   @14,LEGENDS                                         0454 00618000
*     END;                          /*                       @Z40LB26*/ 00619000
@RF00453 DS    0H                                                  0456 00620000
*                                                                  0456 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* ISSUE MESSAGE IDC0001I IF THE LAST CONDITION CODE     @Z40LB26*/ 00624000
*   /* IS < 12 OR ISSUE MESSAGE IDC3003I IF THE LAST         @Z40LB26*/ 00625000
*   /* CONDITION CODE IS 12                                  @Z40LB26*/ 00626000
*   /*                                                               */ 00627000
*   /*****************************************************************/ 00628000
*                                                                  0456 00629000
*   DARGAREA=''B;                   /*                       @Z40LB26*/ 00630000
@RF00399 XC    DARGAREA(76),DARGAREA                               0456 00631000
*   DARGSMOD=UV0MSG;                /*                       @Z40LB26*/ 00632000
         L     @15,DDSTRU                                          0457 00633000
         MVC   DARGSMOD(3,@15),@CC01479                            0457 00634000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Z40LB26*/ 00635000
         L     @14,@PC00001+8                                      0458 00636000
         ST    @14,DARGDBP(,@15)                                   0458 00637000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Z40LB26*/ 00638000
         MVC   DARGILP(2,@15),@CH00156                             0459 00639000
*   IF LASTCOND<LASTCC12 THEN       /*                       @Z40LB26*/ 00640000
         LH    @14,LASTCOND(,@14)                                  0460 00641000
         C     @14,@CF00035                                        0460 00642000
         BNL   @RF00460                                            0460 00643000
*     DARGSENT=MSG0001I;            /*                       @Z40LB26*/ 00644000
         MVI   DARGSENT(@15),X'01'                                 0461 00645000
*   ELSE                            /*                       @Z40LB26*/ 00646000
*     DARGSENT=MSG3003I;            /*                       @Z40LB26*/ 00647000
         B     @RC00460                                            0462 00648000
@RF00460 L     @01,DDSTRU                                          0462 00649000
         MVI   DARGSENT(@01),X'03'                                 0462 00650000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB26*/ 00651000
*                                                                  0463 00652000
@RC00460 L     @15,@PC00001                                        0463 00653000
         ST    @15,@AL00001                                        0463 00654000
         LA    @14,@CF00117                                        0463 00655000
         ST    @14,@AL00001+4                                      0463 00656000
         LA    @14,DDSTRU                                          0463 00657000
         ST    @14,@AL00001+8                                      0463 00658000
         MVI   @AL00001+8,X'80'                                    0463 00659000
         L     @15,GDTPRT(,@15)                                    0463 00660000
         LA    @01,@AL00001                                        0463 00661000
         BALR  @14,@15                                             0463 00662000
*   /*****************************************************************/ 00663000
*   /*                                                               */ 00664000
*   /* SEE IF NEED TO CLOSE OUTPUT DATA SET                  @Z40LB26*/ 00665000
*   /*                                                               */ 00666000
*   /*****************************************************************/ 00667000
*                                                                  0464 00668000
*   IF PRINTIT^=NULLPTR THEN        /*                       @Z40LB26*/ 00669000
         L     @15,PRINTIT                                         0464 00670000
         LTR   @15,@15                                             0464 00671000
         BZ    @RF00464                                            0464 00672000
*     CALL IDCIOCL0(GDTTBL,PRINTIT);/*                       @Z40LB26*/ 00673000
*                                                                  0465 00674000
         L     @15,@PC00001                                        0465 00675000
         ST    @15,@AL00001                                        0465 00676000
         LA    @14,PRINTIT                                         0465 00677000
         ST    @14,@AL00001+4                                      0465 00678000
         MVI   @AL00001+4,X'80'                                    0465 00679000
         L     @15,GDTCLS(,@15)                                    0465 00680000
         LA    @01,@AL00001                                        0465 00681000
         BALR  @14,@15                                             0465 00682000
*   /*****************************************************************/ 00683000
*   /*                                                               */ 00684000
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB26*/ 00685000
*   /*                                                               */ 00686000
*   /*****************************************************************/ 00687000
*                                                                  0466 00688000
*   IF GDTDBG=NULLPTR THEN                                         0466 00689000
@RF00464 L     @15,@PC00001                                        0466 00690000
         L     @15,GDTDBG(,@15)                                    0466 00691000
         LTR   @15,@15                                             0466 00692000
         BZ    @RT00466                                            0466 00693000
*     ;                                                            0467 00694000
*   ELSE                                                           0468 00695000
*     CALL IDCDB010(GDTTBL,'LDED'); /*                       @Z40LB26*/ 00696000
*                                                                  0468 00697000
         L     @15,@PC00001                                        0468 00698000
         ST    @15,@AL00001                                        0468 00699000
         LA    @14,@CC01586                                        0468 00700000
         ST    @14,@AL00001+4                                      0468 00701000
         MVI   @AL00001+4,X'80'                                    0468 00702000
         L     @15,GDTDBG(,@15)                                    0468 00703000
         LA    @01,@AL00001                                        0468 00704000
         BALR  @14,@15                                             0468 00705000
*   /*****************************************************************/ 00706000
*   /*                                                               */ 00707000
*   /* RETURN TO THE CALLER                                  @Z40LB26*/ 00708000
*   /*                                                               */ 00709000
*   /*****************************************************************/ 00710000
*                                                                  0469 00711000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);/*                  @Z40LB26*/ 00712000
@RT00466 L     @15,@PC00001                                        0469 00713000
         ST    @15,@AL00001                                        0469 00714000
         LA    @14,MODID                                           0469 00715000
         ST    @14,@AL00001+4                                      0469 00716000
         L     @14,@PC00001+8                                      0469 00717000
         ST    @14,@AL00001+8                                      0469 00718000
         MVI   @AL00001+8,X'80'                                    0469 00719000
         L     @15,GDTEPL(,@15)                                    0469 00720000
         LA    @01,@AL00001                                        0469 00721000
         BALR  @14,@15                                             0469 00722000
*                                                                  0470 00723000
*/********************************************************   @Z40LB30*/ 00724000
*/*                                                          @Z40LB30*/ 00725000
*/* PROCEDURE - SPECVOL                                      @Z40LB30*/ 00726000
*/*                                                          @Z40LB30*/ 00727000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/ 00728000
*/*           TO READ EACH VOLUME RECORD SPECIFIED ON THE    @Z40LB30*/ 00729000
*/*           LISTDSET COMMAND.  CALL PROCEDURES TO CHECK    @Z40LB30*/ 00730000
*/*           IF THERE ARE ANY RECOVERY FLAGS ON AND         @Z40LB30*/ 00731000
*/*           TO PROCESS THE VOLUME.  PRINT MESSAGE          @Z40LB30*/ 00732000
*/*           IDC2074I IF THE VOLUME IS NOT ACTIVE,          @Z40LB30*/ 00733000
*/*           FOLLOWED BY MESSAGE IDC2108I.  IF AN ERROR     @Z40LB30*/ 00734000
*/*           OCCURS READING A VOLUME RECORD, PRINT MESSAGE  @Z40LB30*/ 00735000
*/*           IDC2080I.                                      @Z40LB30*/ 00736000
*/*                                                          @Z40LB30*/ 00737000
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/ 00738000
*/*                                                          @Z40LB30*/ 00739000
*/* OUTPUT - REGISTER 15 = 0, NO ERROR OCCURRED              @Z40LB30*/ 00740000
*/*                        4, ERROR DEALLOCATING VOLUME      @Z40LB30*/ 00741000
*/*                           OR CLOSING VTOC                @Z40LB30*/ 00742000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 00743000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 00744000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 00745000
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/ 00746000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 00747000
*/*                                                          @Z40LB30*/ 00748000
*/********************************************************   @Z40LB30*/ 00749000
*                                                                  0470 00750000
*SPECVOL:                                                          0470 00751000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 00752000
@EL00001 L     @13,4(,@13)                                         0470 00753000
@EF00001 L     @00,@SIZDATD                                        0470 00754000
         LR    @01,@08                                             0470 00755000
         FREEMAIN R,LV=(0),A=(1)                                        00756000
@ER00001 LM    @14,@12,12(@13)                                     0470 00757000
         BR    @14                                                 0470 00758000
SPECVOL  ST    @14,@SA00002                                        0470 00759000
*                                                                  0471 00760000
*   /*****************************************************************/ 00761000
*   /*                                                               */ 00762000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 00763000
*   /*                                                               */ 00764000
*   /*****************************************************************/ 00765000
*                                                                  0471 00766000
*   OLDERID2=NEWERID2;                                             0471 00767000
         L     @15,@PC00001                                        0471 00768000
         L     @15,GDTTR2(,@15)                                    0471 00769000
         MVC   @TS00001(95),NEWERID2(@15)                          0471 00770000
         MVC   OLDERID2(95,@15),@TS00001                           0471 00771000
*   NEWID2='LDSV';                  /*                       @Z40LB30*/ 00772000
*                                                                  0472 00773000
         MVC   NEWID2(4,@15),@CC01590                              0472 00774000
*   /*****************************************************************/ 00775000
*   /*                                                               */ 00776000
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/ 00777000
*   /*                                                               */ 00778000
*   /*****************************************************************/ 00779000
*                                                                  0473 00780000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 00781000
*                                                                  0473 00782000
         SLR   CC01,CC01                                           0473 00783000
*   /*****************************************************************/ 00784000
*   /*                                                               */ 00785000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ A SPECIFIC   @Z40LB30*/ 00786000
*   /* BASE VOLUME RECORD FROM THE INVENTORY AND TEST THAT   @Z40LB30*/ 00787000
*   /* IT IS ACTIVE                                          @Z40LB30*/ 00788000
*   /*                                                               */ 00789000
*   /*****************************************************************/ 00790000
*                                                                  0474 00791000
*   VOLRVVI=''B;                    /*                       @Z40LB30*/ 00792000
         XC    VOLRVVI(68),VOLRVVI                                 0474 00793000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/ 00794000
         LA    @15,VOLRVVI                                         0475 00795000
         ST    @15,RVVIPTR                                         0475 00796000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 00797000
         LH    @14,RVVLEN                                          0476 00798000
         ST    @14,RVVLNGTH(,@15)                                  0476 00799000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 00800000
         MVI   RVVCODE(@15),X'87'                                  0477 00801000
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/ 00802000
         MVC   RVVBUFLN(2,@15),@CH01761                            0478 00803000
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 00804000
         LA    @14,VOLREC                                          0479 00805000
         ST    @14,RVVRTBUF(,@15)                                  0479 00806000
*   RVVRDR=ON;                      /* READ A RECORD         @Z40LB30*/ 00807000
         OI    RVVRDR(@15),B'10000000'                             0480 00808000
*   RVVBVRCD=ON;                    /* BASE RECORD           @Z40LB30*/ 00809000
         OI    RVVBVRCD(@15),B'10000000'                           0481 00810000
*   RVVACTV=ON;                     /* ACTIVE VOLUME         @Z40LB30*/ 00811000
         OI    RVVACTV(@15),B'00000100'                            0482 00812000
*   RVVSVOL=ON;                     /* VOLUME SERIAL IS      @Z40LB30   00813000
*                                      SPECIFIED             @Z40LB30*/ 00814000
         OI    RVVSVOL(@15),B'00000001'                            0483 00815000
*                                                                  0484 00816000
*   /*****************************************************************/ 00817000
*   /*                                                               */ 00818000
*   /* READ THE BASE VOLUME RECORD FOR EACH VOLUME SPECIFIED @Z40LB30*/ 00819000
*   /* ON THE LISTDSET COMMAND                               @Z40LB30*/ 00820000
*   /*                                                               */ 00821000
*   /*****************************************************************/ 00822000
*                                                                  0484 00823000
*   DO INDEX=1 TO VOLCNT;           /*                       @Z40LB30*/ 00824000
*                                                                  0484 00825000
         LA    @15,1                                               0484 00826000
         B     @DE00484                                            0484 00827000
@DL00484 DS    0H                                                  0485 00828000
*     /***************************************************************/ 00829000
*     /*                                                             */ 00830000
*     /* PUT THE VOLUME SERIAL IN THE IEZRVVI PARAMETER LIST @Z40LB30*/ 00831000
*     /*                                                             */ 00832000
*     /***************************************************************/ 00833000
*                                                                  0485 00834000
*     RVVOLUME=VOLVAL(INDEX);       /*                       @Z40LB30*/ 00835000
*                                                                  0485 00836000
         L     @02,RVVIPTR                                         0485 00837000
         SLA   @15,3                                               0485 00838000
         L     @14,@PC00001+4                                      0485 00839000
         L     @01,FDTPTR(,@14)                                    0485 00840000
         ALR   @01,@15                                             0485 00841000
         AL    @01,@CF01781                                        0485 00842000
         MVC   RVVOLUME(6,@02),VOLVAL-3(@01)                       0485 00843000
*     /***************************************************************/ 00844000
*     /*                                                             */ 00845000
*     /* ISSUE USSC TO READ THE RECORD. SAVE THE RETURN      @Z40LB30*/ 00846000
*     /* CODE                                                @Z40LB30*/ 00847000
*     /*                                                             */ 00848000
*     /***************************************************************/ 00849000
*                                                                  0486 00850000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/ 00851000
         L     @02,@PC00001                                        0486 00852000
         ST    @02,@AL00001                                        0486 00853000
         LA    @15,VVIC                                            0486 00854000
         ST    @15,@AL00001+4                                      0486 00855000
         LA    @15,RVVIPTR                                         0486 00856000
         ST    @15,@AL00001+8                                      0486 00857000
         LA    @15,VVICODE                                         0486 00858000
         ST    @15,@AL00001+12                                     0486 00859000
         MVI   @AL00001+12,X'80'                                   0486 00860000
         L     @15,GDTSSC(,@02)                                    0486 00861000
         LA    @01,@AL00001                                        0486 00862000
         BALR  @14,@15                                             0486 00863000
*     RESPECIFY                                                    0487 00864000
*       RTNREG RSTD;                                               0487 00865000
*     TESTRC=RTNREG;                                               0488 00866000
         LR    TESTRC,RTNREG                                       0488 00867000
*     RESPECIFY                                                    0489 00868000
*       RTNREG UNRSTD;              /*                       @Z40LB30*/ 00869000
*                                                                  0489 00870000
*     /***************************************************************/ 00871000
*     /*                                                             */ 00872000
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/ 00873000
*     /*                                                             */ 00874000
*     /***************************************************************/ 00875000
*                                                                  0490 00876000
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/ 00877000
         LTR   TESTRC,TESTRC                                       0490 00878000
         BNZ   @RF00490                                            0490 00879000
*       DO;                         /*                       @Z40LB30*/ 00880000
*                                                                  0491 00881000
*         /***********************************************************/ 00882000
*         /*                                                         */ 00883000
*         /* CALL CKRECOV TO SEE IF ANY RECOVERY FLAGS ARE   @Z40LB30*/ 00884000
*         /* ON IN THE RECORD AND THE VOLUME CANNOT BE       @Z40LB30*/ 00885000
*         /* PROCESSED                                       @Z40LB30*/ 00886000
*         /*                                                         */ 00887000
*         /***********************************************************/ 00888000
*                                                                  0492 00889000
*         CALL CKRECOV;             /*                       @Z40LB30*/ 00890000
         BAL   @14,CKRECOV                                         0492 00891000
*         RESPECIFY                                                0493 00892000
*           RTNREG RSTD;                                           0493 00893000
*         TESTRC=RTNREG;                                           0494 00894000
         LR    TESTRC,RTNREG                                       0494 00895000
*         RESPECIFY                                                0495 00896000
*           RTNREG UNRSTD;          /*                       @Z40LB30*/ 00897000
*                                                                  0495 00898000
*         /***********************************************************/ 00899000
*         /*                                                         */ 00900000
*         /* ACCUMULATE THE HIGHEST RETURN CODE IN THE       @Z40LB30*/ 00901000
*         /* INTERNAL CONDITION CODE AREA                    @Z40LB30*/ 00902000
*         /*                                                         */ 00903000
*         /***********************************************************/ 00904000
*                                                                  0496 00905000
*         CC01=MAX(CC01,TESTRC);    /*                       @Z40LB30*/ 00906000
*                                                                  0496 00907000
         CR    CC01,TESTRC                                         0496 00908000
         BNL   *+6                                                      00909000
         LR    CC01,TESTRC                                         0496 00910000
*         /***********************************************************/ 00911000
*         /*                                                         */ 00912000
*         /* IF NO ERRORS WERE FOUND, CALL PROCVOL TO        @Z40LB30*/ 00913000
*         /* PROCESS THE VOLUME. SAVE THE RETURN CODE        @Z40LB30*/ 00914000
*         /* AND PUT THE HIGHEST RETURN CODE IN THE INTER-   @Z40LB30*/ 00915000
*         /* NAL CONDITION CODE AREA                         @Z40LB30*/ 00916000
*         /*                                                         */ 00917000
*         /***********************************************************/ 00918000
*                                                                  0497 00919000
*         IF TESTRC=LASTCC00 THEN   /*                       @Z40LB30*/ 00920000
         LTR   TESTRC,TESTRC                                       0497 00921000
         BNZ   @RF00497                                            0497 00922000
*           DO;                     /*                       @Z40LB30*/ 00923000
*             CALL PROCVOL;         /*                       @Z40LB30*/ 00924000
         BAL   @14,PROCVOL                                         0499 00925000
*             RESPECIFY                                            0500 00926000
*               RTNREG RSTD;                                       0500 00927000
*             TESTRC=RTNREG;                                       0501 00928000
         LR    TESTRC,RTNREG                                       0501 00929000
*             RESPECIFY                                            0502 00930000
*               RTNREG UNRSTD;      /*                       @Z40LB30*/ 00931000
*             CC01=MAX(CC01,TESTRC);/*                       @Z40LB30*/ 00932000
*                                                                  0503 00933000
         CR    CC01,TESTRC                                         0503 00934000
         BNL   *+6                                                      00935000
         LR    CC01,TESTRC                                         0503 00936000
*             /*******************************************************/ 00937000
*             /*                                                     */ 00938000
*             /* IF THE RETURN CODE INDICATES A VOLUME WAS   @Z40LB30*/ 00939000
*             /* PROCESSED, SET AN INDICATOR                 @Z40LB30*/ 00940000
*             /*                                                     */ 00941000
*             /*******************************************************/ 00942000
*                                                                  0504 00943000
*             IF TESTRC<LASTCC12 THEN/*                      @Z40LB30*/ 00944000
         C     TESTRC,@CF00035                                     0504 00945000
         BNL   @RF00504                                            0504 00946000
*               ONEDONE=ON;         /*                       @Z40LB30*/ 00947000
         OI    ONEDONE,B'10000000'                                 0505 00948000
*           END;                    /*                       @Z40LB30*/ 00949000
*       END;                        /*                       @Z40LB30*/ 00950000
*                                                                  0507 00951000
*     /***************************************************************/ 00952000
*     /*                                                             */ 00953000
*     /* IF THE READ WAS NOT SUCCESSFUL, ISSUE THE PROPER    @Z40LB30*/ 00954000
*     /* MESSAGES                                            @Z40LB30*/ 00955000
*     /*                                                             */ 00956000
*     /***************************************************************/ 00957000
*                                                                  0508 00958000
*     ELSE                          /*                       @Z40LB30*/ 00959000
*                                                                  0508 00960000
*       /*************************************************************/ 00961000
*       /*                                                           */ 00962000
*       /* IF THE REASON CODE INDICATES THE VOLUME IS NOT    @Z40LB30*/ 00963000
*       /* ACTIVE, PRINT MESSAGE IDC2074I, FOLLOWED BY       @Z40LB30*/ 00964000
*       /* MESSAGE IDC2108I. SET THE CONDITION CODE          @Z40LB30*/ 00965000
*       /*                                                           */ 00966000
*       /*************************************************************/ 00967000
*                                                                  0508 00968000
*       IF VVICODE=NOACTIVE THEN    /*                       @Z40LB30*/ 00969000
         B     @RC00490                                            0508 00970000
@RF00490 CLC   VVICODE(4),@CF01519                                 0508 00971000
         BNE   @RF00508                                            0508 00972000
*         DO;                       /*                       @Z40LB30*/ 00973000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 00974000
         XC    DARGAREA(76),DARGAREA                               0510 00975000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 00976000
         L     @15,DDSTRU                                          0511 00977000
         MVC   DARGSMOD(3,@15),@CC01475                            0511 00978000
*           DARGSENT=MSG2074I;      /*                       @Z40LB30*/ 00979000
         MVI   DARGSENT(@15),X'20'                                 0512 00980000
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/ 00981000
         LH    @14,INDEX                                           0513 00982000
         SLA   @14,3                                               0513 00983000
         L     @07,@PC00001+4                                      0513 00984000
         L     @01,FDTPTR(,@07)                                    0513 00985000
         AL    @01,@CF01781                                        0513 00986000
         LA    @14,VOLVAL-3(@14,@01)                               0513 00987000
         ST    @14,DARGDBP(,@15)                                   0513 00988000
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/ 00989000
         MVC   DARGILP(2,@15),@CH00159                             0514 00990000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 00991000
         L     @15,@PC00001                                        0515 00992000
         ST    @15,@AL00001                                        0515 00993000
         LA    @14,@CF00117                                        0515 00994000
         ST    @14,@AL00001+4                                      0515 00995000
         LA    @14,DDSTRU                                          0515 00996000
         ST    @14,@AL00001+8                                      0515 00997000
         MVI   @AL00001+8,X'80'                                    0515 00998000
         L     @15,GDTPRT(,@15)                                    0515 00999000
         LA    @01,@AL00001                                        0515 01000000
         BALR  @14,@15                                             0515 01001000
*           DARGSENT=MSG2108I;      /*                       @Z40LB30*/ 01002000
         L     @01,DDSTRU                                          0516 01003000
         MVI   DARGSENT(@01),X'40'                                 0516 01004000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 01005000
         L     @15,@PC00001                                        0517 01006000
         ST    @15,@AL00001                                        0517 01007000
         LA    @14,@CF00117                                        0517 01008000
         ST    @14,@AL00001+4                                      0517 01009000
         LA    @14,DDSTRU                                          0517 01010000
         ST    @14,@AL00001+8                                      0517 01011000
         MVI   @AL00001+8,X'80'                                    0517 01012000
         L     @15,GDTPRT(,@15)                                    0517 01013000
         LA    @01,@AL00001                                        0517 01014000
         BALR  @14,@15                                             0517 01015000
*           CC01=LASTCC12;          /*                       @Z40LB30*/ 01016000
         LA    CC01,12                                             0518 01017000
*         END;                      /*                       @Z40LB30*/ 01018000
*                                                                  0519 01019000
*     /***************************************************************/ 01020000
*     /*                                                             */ 01021000
*     /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG TO PRINT     @Z40LB30*/ 01022000
*     /* THE REASON CODE. THEN ISSUE MESSAGE IDC2080I TO     @Z40LB30*/ 01023000
*     /* IDENTIFY THE VOLUME. SET THE CONDITION CODE         @Z40LB30*/ 01024000
*     /*                                                             */ 01025000
*     /***************************************************************/ 01026000
*                                                                  0520 01027000
*       ELSE                        /*                       @Z40LB30*/ 01028000
*         DO;                       /*                       @Z40LB30*/ 01029000
         B     @RC00508                                            0520 01030000
@RF00508 DS    0H                                                  0521 01031000
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/ 01032000
         LA    @04,VVICODE                                         0521 01033000
         ST    @04,@AL00001                                        0521 01034000
         LA    @01,@AL00001                                        0521 01035000
         BAL   @14,SSCMSG                                          0521 01036000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 01037000
         XC    DARGAREA(76),DARGAREA                               0522 01038000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 01039000
         L     @15,DDSTRU                                          0523 01040000
         MVC   DARGSMOD(3,@15),@CC01475                            0523 01041000
*           DARGSENT=MSG2080I;      /*                       @Z40LB30*/ 01042000
         MVI   DARGSENT(@15),X'1A'                                 0524 01043000
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/ 01044000
         LH    @14,INDEX                                           0525 01045000
         SLA   @14,3                                               0525 01046000
         L     @07,@PC00001+4                                      0525 01047000
         L     @01,FDTPTR(,@07)                                    0525 01048000
         AL    @01,@CF01781                                        0525 01049000
         LA    @14,VOLVAL-3(@14,@01)                               0525 01050000
         ST    @14,DARGDBP(,@15)                                   0525 01051000
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/ 01052000
         MVC   DARGILP(2,@15),@CH00159                             0526 01053000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 01054000
         L     @15,@PC00001                                        0527 01055000
         ST    @15,@AL00001                                        0527 01056000
         LA    @14,@CF00117                                        0527 01057000
         ST    @14,@AL00001+4                                      0527 01058000
         LA    @14,DDSTRU                                          0527 01059000
         ST    @14,@AL00001+8                                      0527 01060000
         MVI   @AL00001+8,X'80'                                    0527 01061000
         L     @15,GDTPRT(,@15)                                    0527 01062000
         LA    @01,@AL00001                                        0527 01063000
         BALR  @14,@15                                             0527 01064000
*           CC01=LASTCC12;          /*                       @Z40LB30*/ 01065000
         LA    CC01,12                                             0528 01066000
*         END;                      /*                       @Z40LB30*/ 01067000
*   END;                            /*                       @Z40LB30*/ 01068000
@RC00508 DS    0H                                                  0530 01069000
@RC00490 LA    @15,1                                               0530 01070000
         AH    @15,INDEX                                           0530 01071000
@DE00484 STH   @15,INDEX                                           0530 01072000
         L     @14,@PC00001+4                                      0530 01073000
         L     @14,FDTPTR(,@14)                                    0530 01074000
         CH    @15,VOLCNT(,@14)                                    0530 01075000
         BNH   @DL00484                                            0530 01076000
*                                                                  0531 01077000
*   /*****************************************************************/ 01078000
*   /*                                                               */ 01079000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 01080000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 01081000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/ 01082000
*   /* THE FINAL CONDITION CODE                              @Z40LB30*/ 01083000
*   /*                                                               */ 01084000
*   /*****************************************************************/ 01085000
*                                                                  0531 01086000
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/ 01087000
         C     CC01,@CF00035                                       0531 01088000
         BNE   @RF00531                                            0531 01089000
         TM    ONEDONE,B'10000000'                                 0531 01090000
         BNO   @RF00531                                            0531 01091000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 01092000
*                                                                  0532 01093000
         LA    CC01,8                                              0532 01094000
*   /*****************************************************************/ 01095000
*   /*                                                               */ 01096000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 01097000
*   /*                                                               */ 01098000
*   /*****************************************************************/ 01099000
*                                                                  0533 01100000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01101000
@RF00531 LR    @15,CC01                                            0533 01102000
@EL00002 DS    0H                                                  0533 01103000
@EF00002 DS    0H                                                  0533 01104000
@ER00002 L     @14,@SA00002                                        0533 01105000
         BR    @14                                                 0533 01106000
*   END SPECVOL;                    /*                       @Z40LB30*/ 01107000
*                                                                  0535 01108000
*/********************************************************   @Z40LB30*/ 01109000
*/*                                                          @Z40LB30*/ 01110000
*/* PROCEDURE - SPECGRP                                      @Z40LB30*/ 01111000
*/*                                                          @Z40LB30*/ 01112000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/ 01113000
*/*           TO READ THE INVENTORY RECORD FOR EACH GROUP    @Z40LB30*/ 01114000
*/*           SPECIFIED ON THE LISTDSET COMMAND.  THEN CALL  @Z40LB30*/ 01115000
*/*           A PROCEDURE TO READ THE RECORD FOR EACH ACTIVE @Z40LB30*/ 01116000
*/*           BASE VOLUME IN THE GROUP.  FOR EACH VOLUME,    @Z40LB30*/ 01117000
*/*           CALL PROCEDURES TO SEE IF THE VOLUME           @Z40LB30*/ 01118000
*/*           HAS RECOVERY FLAGS ON IN THE RECORD AND TO     @Z40LB26*/ 01119000
*/*           PROCESS THE VOLUME.  ISSUE MESSAGE IDC2079I IF @Z40LB26*/ 01120000
*/*           A GROUP RECORD CANNOT BE READ.                 @Z40LB26*/ 01121000
*/*                                                          @Z40LB30*/ 01122000
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/ 01123000
*/*                                                          @Z40LB30*/ 01124000
*/* OUTPUT - REGISTER 15 = 0, NO ERROR                       @Z40LB30*/ 01125000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 01126000
*/*                           CLOSING VTOC                   @Z40LB30*/ 01127000
*/*                        8, ONE OR MORE DATA SETS OR       @Z40LB30*/ 01128000
*/*                           VOLUMES COULD NOT BE PROCESSED @Z40LB30*/ 01129000
*/*                           DUE TO ERROR                   @Z40LB30*/ 01130000
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/ 01131000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 01132000
*/*                                                          @Z40LB30*/ 01133000
*/********************************************************   @Z40LB30*/ 01134000
*                                                                  0535 01135000
*SPECGRP:                                                          0535 01136000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 01137000
SPECGRP  ST    @14,@SA00003                                        0535 01138000
*                                                                  0536 01139000
*   /*****************************************************************/ 01140000
*   /*                                                               */ 01141000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 01142000
*   /*                                                               */ 01143000
*   /*****************************************************************/ 01144000
*                                                                  0536 01145000
*   OLDERID2=NEWERID2;                                             0536 01146000
         L     @15,@PC00001                                        0536 01147000
         L     @15,GDTTR2(,@15)                                    0536 01148000
         MVC   @TS00001(95),NEWERID2(@15)                          0536 01149000
         MVC   OLDERID2(95,@15),@TS00001                           0536 01150000
*   NEWID2='LDSG';                  /*                       @Z40LB30*/ 01151000
*                                                                  0537 01152000
         MVC   NEWID2(4,@15),@CC01597                              0537 01153000
*   /*****************************************************************/ 01154000
*   /*                                                               */ 01155000
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/ 01156000
*   /*                                                               */ 01157000
*   /*****************************************************************/ 01158000
*                                                                  0538 01159000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 01160000
*                                                                  0538 01161000
         SLR   CC01,CC01                                           0538 01162000
*   /*****************************************************************/ 01163000
*   /*                                                               */ 01164000
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST TO READ A        @Z40LB30*/ 01165000
*   /* SPECIFIC GROUP RECORD FROM THE INVENTORY              @Z40LB30*/ 01166000
*   /*                                                               */ 01167000
*   /*****************************************************************/ 01168000
*                                                                  0539 01169000
*   GRPRVVI=''B;                    /*                       @Z40LB30*/ 01170000
         XC    GRPRVVI(68),GRPRVVI                                 0539 01171000
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/ 01172000
         LA    @15,GRPRVVI                                         0540 01173000
         ST    @15,RVVIPTR                                         0540 01174000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 01175000
         LH    @14,RVVLEN                                          0541 01176000
         ST    @14,RVVLNGTH(,@15)                                  0541 01177000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 01178000
         MVI   RVVCODE(@15),X'87'                                  0542 01179000
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/ 01180000
         MVC   RVVBUFLN(2,@15),@CH01762                            0543 01181000
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 01182000
         LA    @14,GRPREC                                          0544 01183000
         ST    @14,RVVRTBUF(,@15)                                  0544 01184000
*   RVVRDR=ON;                      /* READ NEXT             @Z40LB30*/ 01185000
         OI    RVVRDR(@15),B'10000000'                             0545 01186000
*   RVVGRPRC=ON;                    /* READ GROUP RECORD     @Z40LB30*/ 01187000
         OI    RVVGRPRC(@15),B'01000000'                           0546 01188000
*   RVVSGRP=ON;                     /* GROUP NAME SPECIFIED  @Z40LB30*/ 01189000
         OI    RVVSGRP(@15),B'10000000'                            0547 01190000
*                                                                  0548 01191000
*   /*****************************************************************/ 01192000
*   /*                                                               */ 01193000
*   /* READ THE RECORD FOR EACH GROUP SPECIFIED ON THE       @Z40LB30*/ 01194000
*   /* LISTDSET COMMAND                                      @Z40LB30*/ 01195000
*   /*                                                               */ 01196000
*   /*****************************************************************/ 01197000
*                                                                  0548 01198000
*   DO INDEX=1 TO GRPCNT;           /*                       @Z40LB30*/ 01199000
*                                                                  0548 01200000
         LA    @15,1                                               0548 01201000
         B     @DE00548                                            0548 01202000
@DL00548 DS    0H                                                  0549 01203000
*     /***************************************************************/ 01204000
*     /*                                                             */ 01205000
*     /* RESET THE POINTER TO THE IEZRVVI PARAMETER LIST AND @Z40LB30*/ 01206000
*     /* SET THE GROUP NAME IN THE PARAMETER LIST            @Z40LB30*/ 01207000
*     /*                                                             */ 01208000
*     /***************************************************************/ 01209000
*                                                                  0549 01210000
*     RVVIPTR=ADDR(GRPRVVI);        /*                       @Z40LB30*/ 01211000
         LA    @02,GRPRVVI                                         0549 01212000
         ST    @02,RVVIPTR                                         0549 01213000
*     RVVGROUP=GRPVAL(INDEX);       /*                       @Z40LB30*/ 01214000
*                                                                  0550 01215000
         MH    @15,@CH00037                                        0550 01216000
         L     @14,@PC00001+4                                      0550 01217000
         L     @01,FDTPTR+4(,@14)                                  0550 01218000
         ALR   @01,@15                                             0550 01219000
         AL    @01,@CF01782                                        0550 01220000
         MVC   RVVGROUP(8,@02),GRPVAL-3(@01)                       0550 01221000
*     /***************************************************************/ 01222000
*     /*                                                             */ 01223000
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD. SAVE THE   @Z40LB30*/ 01224000
*     /* RETURN CODE                                         @Z40LB30*/ 01225000
*     /*                                                             */ 01226000
*     /***************************************************************/ 01227000
*                                                                  0551 01228000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/ 01229000
         L     @02,@PC00001                                        0551 01230000
         ST    @02,@AL00001                                        0551 01231000
         LA    @15,VVIC                                            0551 01232000
         ST    @15,@AL00001+4                                      0551 01233000
         LA    @15,RVVIPTR                                         0551 01234000
         ST    @15,@AL00001+8                                      0551 01235000
         LA    @15,VVICODE                                         0551 01236000
         ST    @15,@AL00001+12                                     0551 01237000
         MVI   @AL00001+12,X'80'                                   0551 01238000
         L     @15,GDTSSC(,@02)                                    0551 01239000
         LA    @01,@AL00001                                        0551 01240000
         BALR  @14,@15                                             0551 01241000
*     RESPECIFY                                                    0552 01242000
*       RTNREG RSTD;                                               0552 01243000
*     TESTRC=RTNREG;                                               0553 01244000
         LR    TESTRC,RTNREG                                       0553 01245000
*     RESPECIFY                                                    0554 01246000
*       RTNREG UNRSTD;              /*                       @Z40LB30*/ 01247000
*                                                                  0554 01248000
*     /***************************************************************/ 01249000
*     /*                                                             */ 01250000
*     /* IF THE GROUP RECORD WAS READ SUCCESSFULLY, CONTINUE @Z40LB30*/ 01251000
*     /*                                                             */ 01252000
*     /***************************************************************/ 01253000
*                                                                  0555 01254000
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/ 01255000
         SLR   @02,@02                                             0555 01256000
         CR    TESTRC,@02                                          0555 01257000
         BNE   @RF00555                                            0555 01258000
*       DO;                         /*                       @Z40LB30*/ 01259000
*                                                                  0556 01260000
*         /***********************************************************/ 01261000
*         /*                                                         */ 01262000
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO 0  @Z40LB30*/ 01263000
*         /* TO PASS TO RDGRPCHN                             @Z40LB30*/ 01264000
*         /*                                                         */ 01265000
*         /***********************************************************/ 01266000
*                                                                  0557 01267000
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/ 01268000
*                                                                  0557 01269000
         ST    @02,VOLPTR                                          0557 01270000
*         /***********************************************************/ 01271000
*         /*                                                         */ 01272000
*         /* READ EACH ACTIVE BASE VOLUME RECORD + PROCESS   @Z40LB30*/ 01273000
*         /* THE VOLUME UNTIL THERE ARE NO MORE VOLUME       @Z40LB30*/ 01274000
*         /* RECORDS OR A READ ERROR OCCURS                  @Z40LB30*/ 01275000
*         /*                                                         */ 01276000
*         /***********************************************************/ 01277000
*                                                                  0558 01278000
*         RDERROR=OFF;              /*                       @Z40LB30*/ 01279000
         NI    RDERROR,B'10111111'                                 0558 01280000
*         DO UNTIL VOLPTR=NULLPTR|RDERROR=ON;/*              @Z40LB30*/ 01281000
*                                                                  0559 01282000
@DL00559 DS    0H                                                  0560 01283000
*           /*********************************************************/ 01284000
*           /*                                                       */ 01285000
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/ 01286000
*           /*                                                       */ 01287000
*           /*********************************************************/ 01288000
*                                                                  0560 01289000
*           CALL RDGRPCHN;          /*                       @Z40LB30*/ 01290000
         BAL   @14,RDGRPCHN                                        0560 01291000
*           RESPECIFY                                              0561 01292000
*             RTNREG RSTD;                                         0561 01293000
*           TESTRC=RTNREG;                                         0562 01294000
         LR    TESTRC,RTNREG                                       0562 01295000
*           RESPECIFY                                              0563 01296000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 01297000
*                                                                  0563 01298000
*           /*********************************************************/ 01299000
*           /*                                                       */ 01300000
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/ 01301000
*           /* IF THERE IS A VOLUME TO PROCESS               @Z40LB30*/ 01302000
*           /*                                                       */ 01303000
*           /*********************************************************/ 01304000
*                                                                  0564 01305000
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/ 01306000
         SLR   @02,@02                                             0564 01307000
         CR    TESTRC,@02                                          0564 01308000
         BNE   @RF00564                                            0564 01309000
*             IF VOLPTR^=NULLPTR THEN/*                      @Z40LB30*/ 01310000
         C     @02,VOLPTR                                          0565 01311000
         BE    @RF00565                                            0565 01312000
*               DO;                 /*                       @Z40LB30*/ 01313000
*                                                                  0566 01314000
*                 /***************************************************/ 01315000
*                 /*                                                 */ 01316000
*                 /* CALL CKRECOV TO SEE IF RECOVERY FLAGS   @Z40LB26*/ 01317000
*                 /* ARE ON IN THE RECORD. SAVE THE RETURN   @Z40LB30*/ 01318000
*                 /* CODE                                    @Z40LB30*/ 01319000
*                 /*                                                 */ 01320000
*                 /***************************************************/ 01321000
*                                                                  0567 01322000
*                 CALL CKRECOV;     /*                       @Z40LB30*/ 01323000
         BAL   @14,CKRECOV                                         0567 01324000
*                 RESPECIFY                                        0568 01325000
*                   RTNREG RSTD;                                   0568 01326000
*                 TESTRC=RTNREG;                                   0569 01327000
         LR    TESTRC,RTNREG                                       0569 01328000
*                 RESPECIFY                                        0570 01329000
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/ 01330000
*                                                                  0570 01331000
*                 /***************************************************/ 01332000
*                 /*                                                 */ 01333000
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/ 01334000
*                 /* SET THE CONDITION CODE TO INDICATE      @Z40LB26*/ 01335000
*                 /* A VOLUME WAS NOT PROCESSED              @Z40LB30*/ 01336000
*                 /*                                                 */ 01337000
*                 /***************************************************/ 01338000
*                                                                  0571 01339000
*                 IF TESTRC>LASTCC00 THEN/*                  @Z40LB30*/ 01340000
         LTR   TESTRC,TESTRC                                       0571 01341000
         BNP   @RF00571                                            0571 01342000
*                   CC01=LASTCC12;  /*                       @Z40LB30*/ 01343000
*                                                                  0572 01344000
         LA    CC01,12                                             0572 01345000
*                 /***************************************************/ 01346000
*                 /*                                                 */ 01347000
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/ 01348000
*                 /* PROCESS IT.                             @Z40LB30*/ 01349000
*                 /*                                                 */ 01350000
*                 /***************************************************/ 01351000
*                                                                  0573 01352000
*                 ELSE              /*                       @Z40LB30*/ 01353000
*                   DO;             /*                       @Z40LB26*/ 01354000
*                                                                  0573 01355000
         B     @RC00571                                            0573 01356000
@RF00571 DS    0H                                                  0574 01357000
*                     /***********************************************/ 01358000
*                     /*                                             */ 01359000
*                     /* CALL PROCVOL TO PROCESS THE         @Z40LB30*/ 01360000
*                     /* VOLUME. SAVE THE RETURN CODE.       @Z40LB30*/ 01361000
*                     /* SET THE RETURN CODE IN THE          @Z40LB30*/ 01362000
*                     /* INTERNAL CONDITION CODE AREA IF     @Z40LB30*/ 01363000
*                     /* IT IS HIGHER THAN CURRENT ONE       @Z40LB30*/ 01364000
*                     /*                                             */ 01365000
*                     /***********************************************/ 01366000
*                                                                  0574 01367000
*                     CALL PROCVOL; /*                       @Z40LB26*/ 01368000
         BAL   @14,PROCVOL                                         0574 01369000
*                     RESPECIFY                                    0575 01370000
*                       RTNREG RSTD;                               0575 01371000
*                     TESTRC=RTNREG;                               0576 01372000
         LR    TESTRC,RTNREG                                       0576 01373000
*                     RESPECIFY                                    0577 01374000
*                       RTNREG UNRSTD;/*                     @Z40LB26*/ 01375000
*                     CC01=MAX(CC01,TESTRC);/*               @Z40LB26*/ 01376000
*                                                                  0578 01377000
         CR    CC01,TESTRC                                         0578 01378000
         BNL   *+6                                                      01379000
         LR    CC01,TESTRC                                         0578 01380000
*                     /***********************************************/ 01381000
*                     /*                                             */ 01382000
*                     /* IF THE RETURN CODE INDICATES A      @Z40LB30*/ 01383000
*                     /* VOLUME WAS PROCESSED, SET           @Z40LB30*/ 01384000
*                     /* INDICATOR                           @Z40LB30*/ 01385000
*                     /*                                             */ 01386000
*                     /***********************************************/ 01387000
*                                                                  0579 01388000
*                     IF TESTRC<LASTCC12 THEN/*              @Z40LB30*/ 01389000
         C     TESTRC,@CF00035                                     0579 01390000
         BNL   @RF00579                                            0579 01391000
*                       ONEDONE=ON; /*                       @Z40LB26*/ 01392000
         OI    ONEDONE,B'10000000'                                 0580 01393000
*                   END;            /*                       @Z40LB26*/ 01394000
*               END;                /*                       @Z40LB30*/ 01395000
*                                                                  0582 01396000
*           /*********************************************************/ 01397000
*           /*                                                       */ 01398000
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP     @Z40LB30*/ 01399000
*           /*                                                       */ 01400000
*           /*********************************************************/ 01401000
*                                                                  0583 01402000
*             ELSE                                                 0583 01403000
*               ;                   /*                       @Z40LB30*/ 01404000
*                                                                  0583 01405000
@RF00565 DS    0H                                                  0584 01406000
*           /*********************************************************/ 01407000
*           /*                                                       */ 01408000
*           /* IF AN ERROR OCCURRED READING A VOLUME RECORD  @Z40LB30*/ 01409000
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/ 01410000
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/ 01411000
*           /*                                                       */ 01412000
*           /*********************************************************/ 01413000
*                                                                  0584 01414000
*           ELSE                    /*                       @Z40LB30*/ 01415000
*             DO;                   /*                       @Z40LB30*/ 01416000
         B     @RC00564                                            0584 01417000
@RF00564 DS    0H                                                  0585 01418000
*               RDERROR=ON;         /*                       @Z40LB30*/ 01419000
         OI    RDERROR,B'01000000'                                 0585 01420000
*               CC01=LASTCC12;      /*                       @Z40LB30*/ 01421000
         LA    CC01,12                                             0586 01422000
*             END;                  /*                       @Z40LB30*/ 01423000
*         END;                      /*                       @Z40LB30*/ 01424000
@RC00564 DS    0H                                                  0588 01425000
@DE00559 L     @15,VOLPTR                                          0588 01426000
         LTR   @15,@15                                             0588 01427000
         BZ    @DC00559                                            0588 01428000
         TM    RDERROR,B'01000000'                                 0588 01429000
         BNO   @DL00559                                            0588 01430000
@DC00559 DS    0H                                                  0589 01431000
*       END;                        /*                       @Z40LB30*/ 01432000
*                                                                  0589 01433000
*     /***************************************************************/ 01434000
*     /*                                                             */ 01435000
*     /* IF AN ERROR OCCURRED READING A GROUP RECORD, CALL   @Z40LB30*/ 01436000
*     /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT         @Z40LB30*/ 01437000
*     /* MESSAGE IDC2079I TO INDICATE THE GROUP NAME.        @Z40LB30*/ 01438000
*     /* THEN SET THE CONDITION CODE TO INDICATE A SEVERE    @Z40LB30*/ 01439000
*     /* ERROR                                               @Z40LB30*/ 01440000
*     /*                                                             */ 01441000
*     /***************************************************************/ 01442000
*                                                                  0590 01443000
*     ELSE                          /*                       @Z40LB30*/ 01444000
*       DO;                         /*                       @Z40LB30*/ 01445000
         B     @RC00555                                            0590 01446000
@RF00555 DS    0H                                                  0591 01447000
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/ 01448000
         LA    @04,VVICODE                                         0591 01449000
         ST    @04,@AL00001                                        0591 01450000
         LA    @01,@AL00001                                        0591 01451000
         BAL   @14,SSCMSG                                          0591 01452000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 01453000
         XC    DARGAREA(76),DARGAREA                               0592 01454000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 01455000
         L     @15,DDSTRU                                          0593 01456000
         MVC   DARGSMOD(3,@15),@CC01475                            0593 01457000
*         DARGSENT=MSG2079I;        /*                       @Z40LB30*/ 01458000
         MVI   DARGSENT(@15),X'1B'                                 0594 01459000
*         DARGDBP=ADDR(GRPVAL(INDEX));/*                     @Z40LB30*/ 01460000
         LH    @14,INDEX                                           0595 01461000
         MH    @14,@CH00037                                        0595 01462000
         L     @07,@PC00001+4                                      0595 01463000
         L     @01,FDTPTR+4(,@07)                                  0595 01464000
         AL    @01,@CF01782                                        0595 01465000
         LA    @14,GRPVAL-3(@14,@01)                               0595 01466000
         ST    @14,DARGDBP(,@15)                                   0595 01467000
*         DARGILP=LENGTH(GRPVAL(INDEX));/*                   @Z40LB30*/ 01468000
         MVC   DARGILP(2,@15),@CH00182                             0596 01469000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 01470000
         L     @15,@PC00001                                        0597 01471000
         ST    @15,@AL00001                                        0597 01472000
         LA    @14,@CF00117                                        0597 01473000
         ST    @14,@AL00001+4                                      0597 01474000
         LA    @14,DDSTRU                                          0597 01475000
         ST    @14,@AL00001+8                                      0597 01476000
         MVI   @AL00001+8,X'80'                                    0597 01477000
         L     @15,GDTPRT(,@15)                                    0597 01478000
         LA    @01,@AL00001                                        0597 01479000
         BALR  @14,@15                                             0597 01480000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 01481000
         LA    CC01,12                                             0598 01482000
*       END;                        /*                       @Z40LB30*/ 01483000
*   END;                            /*                       @Z40LB30*/ 01484000
@RC00555 LA    @15,1                                               0600 01485000
         AH    @15,INDEX                                           0600 01486000
@DE00548 STH   @15,INDEX                                           0600 01487000
         L     @14,@PC00001+4                                      0600 01488000
         L     @14,FDTPTR+4(,@14)                                  0600 01489000
         CH    @15,GRPCNT(,@14)                                    0600 01490000
         BNH   @DL00548                                            0600 01491000
*                                                                  0601 01492000
*   /*****************************************************************/ 01493000
*   /*                                                               */ 01494000
*   /* IF THE CONDITION CODE INDICATES A SEVERE ERROR THAT   @Z40LB30*/ 01495000
*   /* PREVENTED A VOLUME FROM BEING PROCESSED, CHECK IF     @Z40LB30*/ 01496000
*   /* AT LEAST ONE VOLUME WAS PROCESSED, OR IF AT LEAST     @Z40LB26*/ 01497000
*   /* ONE EMPTY GROUP WAS PROCESSED. IF SO, LOWER           @Z40LB26*/ 01498000
*   /* THE FINAL CONDITION CODE.                             @Z40LB30*/ 01499000
*   /*                                                               */ 01500000
*   /*****************************************************************/ 01501000
*                                                                  0601 01502000
*   IF CC01=LASTCC12&(ONEDONE=ON|EMPTYGRP=ON) THEN/*         @Z40LB26*/ 01503000
         C     CC01,@CF00035                                       0601 01504000
         BNE   @RF00601                                            0601 01505000
         TM    ONEDONE,B'10001000'                                 0601 01506000
         BZ    @RF00601                                            0601 01507000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 01508000
*                                                                  0602 01509000
         LA    CC01,8                                              0602 01510000
*   /*****************************************************************/ 01511000
*   /*                                                               */ 01512000
*   /* RETURN TO THE CALLER                                  @Z40LB30*/ 01513000
*   /*                                                               */ 01514000
*   /*****************************************************************/ 01515000
*                                                                  0603 01516000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01517000
@RF00601 LR    @15,CC01                                            0603 01518000
@EL00003 DS    0H                                                  0603 01519000
@EF00003 DS    0H                                                  0603 01520000
@ER00003 L     @14,@SA00003                                        0603 01521000
         BR    @14                                                 0603 01522000
*   END SPECGRP;                    /*                       @Z40LB30*/ 01523000
*                                                                  0605 01524000
*/********************************************************   @Z40LB30*/ 01525000
*/*                                                          @Z40LB30*/ 01526000
*/* PROCEDURE - NONGRPD                                      @Z40LB30*/ 01527000
*/*                                                          @Z40LB30*/ 01528000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/ 01529000
*/*           READ EACH ACTIVE NON-GROUPED VOLUME RECORD.    @Z40LB30*/ 01530000
*/*           FOR EACH ACTIVE NON-GROUPED VOLUME, CALL A     @Z40LB30*/ 01531000
*/*           PROCEDURE TO SEE IF THE RECORD HAS ANY         @Z40LB26*/ 01532000
*/*           RECOVERY FLAGS ON. CALL ANOTHER PROCEDURE TO   @Z40LB26*/ 01533000
*/*           PROCESS THE VOLUME.  ISSUE MESSAGE IDC0102I IF @Z40LB26*/ 01534000
*/*           THERE ARE NO ACTIVE NON-GROUPED VOLUMES.       @Z40LB26*/ 01535000
*/*           ISSUE MESSAGE IDC2103I IF THE NON-GROUPED      @Z40LB26*/ 01536000
*/*           RECORD CHAIN IS BROKEN.  ISSUE MESSAGE         @Z40LB26*/ 01537000
*/*           IDC2109I IF AN ERROR OCCURS READING AND        @Z40LB26*/ 01538000
*/*           NO MORE VOLUMES CAN BE PROCESSED.              @Z40LB26*/ 01539000
*/*                                                          @Z40LB30*/ 01540000
*/* INPUT - NONE                                             @Z40LB30*/ 01541000
*/*                                                          @Z40LB30*/ 01542000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 01543000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 01544000
*/*                           CLOSING VTOC                   @Z40LB30*/ 01545000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 01546000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 01547000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 01548000
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/ 01549000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 01550000
*/*                                                          @Z40LB30*/ 01551000
*/*********************************************************  @Z40LB30*/ 01552000
*                                                                  0605 01553000
*NONGRPD:                                                          0605 01554000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 01555000
NONGRPD  ST    @14,@SA00004                                        0605 01556000
*                                                                  0606 01557000
*   /*****************************************************************/ 01558000
*   /*                                                               */ 01559000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 01560000
*   /*                                                               */ 01561000
*   /*****************************************************************/ 01562000
*                                                                  0606 01563000
*   OLDERID2=NEWERID2;                                             0606 01564000
         L     @02,@PC00001                                        0606 01565000
         L     @15,GDTTR2(,@02)                                    0606 01566000
         MVC   @TS00001(95),NEWERID2(@15)                          0606 01567000
         MVC   OLDERID2(95,@15),@TS00001                           0606 01568000
*   NEWID2='LDNG';                  /*                       @Z40LB30*/ 01569000
*                                                                  0607 01570000
         MVC   NEWID2(4,@15),@CC01602                              0607 01571000
*   /*****************************************************************/ 01572000
*   /*                                                               */ 01573000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 01574000
*   /*                                                               */ 01575000
*   /*****************************************************************/ 01576000
*                                                                  0608 01577000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 01578000
*                                                                  0608 01579000
         SLR   CC01,CC01                                           0608 01580000
*   /*****************************************************************/ 01581000
*   /*                                                               */ 01582000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ THE ACTIVE   @Z40LB30*/ 01583000
*   /* NON-GROUPED VOLUME RECORDS                            @Z40LB30*/ 01584000
*   /*                                                               */ 01585000
*   /*****************************************************************/ 01586000
*                                                                  0609 01587000
*   VOLRVVI=''B;                    /*                       @Z40LB30*/ 01588000
         XC    VOLRVVI(68),VOLRVVI                                 0609 01589000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/ 01590000
         LA    @15,VOLRVVI                                         0610 01591000
         ST    @15,RVVIPTR                                         0610 01592000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 01593000
         LH    @14,RVVLEN                                          0611 01594000
         ST    @14,RVVLNGTH(,@15)                                  0611 01595000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 01596000
         MVI   RVVCODE(@15),X'87'                                  0612 01597000
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/ 01598000
         MVC   RVVBUFLN(2,@15),@CH01761                            0613 01599000
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 01600000
         LA    @14,VOLREC                                          0614 01601000
         ST    @14,RVVRTBUF(,@15)                                  0614 01602000
*   RVVRDCH=ON;                     /* READ CHAIN            @Z40LB30*/ 01603000
         OI    RVVRDCH(@15),B'00100000'                            0615 01604000
*   RVVBVRCD=ON;                    /* BASE VOLUME RECORDS   @Z40LB30*/ 01605000
         OI    RVVBVRCD(@15),B'10000000'                           0616 01606000
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/ 01607000
         OI    RVVACTV(@15),B'00000100'                            0617 01608000
*   RVVNGVOL=ON;                    /* NON-GROUPED CHAIN     @Z40LB30*/ 01609000
*                                                                  0618 01610000
         OI    RVVNGVOL(@15),B'01000000'                           0618 01611000
*   /*****************************************************************/ 01612000
*   /*                                                               */ 01613000
*   /* ISSUE USSC MACRO TO READ FIRST ACTIVE NON-GROUPED     @Z40LB30*/ 01614000
*   /* VOLUME. SAVE THE RETURN CODE.                         @Z40LB30*/ 01615000
*   /*                                                               */ 01616000
*   /*****************************************************************/ 01617000
*                                                                  0619 01618000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/ 01619000
         ST    @02,@AL00001                                        0619 01620000
         LA    @15,VVIC                                            0619 01621000
         ST    @15,@AL00001+4                                      0619 01622000
         LA    @15,RVVIPTR                                         0619 01623000
         ST    @15,@AL00001+8                                      0619 01624000
         LA    @15,VVICODE                                         0619 01625000
         ST    @15,@AL00001+12                                     0619 01626000
         MVI   @AL00001+12,X'80'                                   0619 01627000
         L     @15,GDTSSC(,@02)                                    0619 01628000
         LA    @01,@AL00001                                        0619 01629000
         BALR  @14,@15                                             0619 01630000
*   RESPECIFY                                                      0620 01631000
*     RTNREG RSTD;                                                 0620 01632000
*   TESTRC=RTNREG;                                                 0621 01633000
         LR    TESTRC,RTNREG                                       0621 01634000
*   RESPECIFY                                                      0622 01635000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 01636000
*                                                                  0622 01637000
*   /*****************************************************************/ 01638000
*   /*                                                               */ 01639000
*   /* IF THERE ARE NO NON-GROUPED VOLUMES OR NO ACTIVE NON- @Z40LB30*/ 01640000
*   /* GROUPED VOLUMES, ISSUE MESSAGE IDC0102I.              @Z40LB30*/ 01641000
*   /*                                                               */ 01642000
*   /*****************************************************************/ 01643000
*                                                                  0623 01644000
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/ 01645000
         LTR   TESTRC,TESTRC                                       0623 01646000
         BZ    @RF00623                                            0623 01647000
*     IF VVICODE=NORECORD|VVICODE=NOACTIVE THEN/*            @Z40LB30*/ 01648000
         L     @05,VVICODE                                         0624 01649000
         C     @05,@CF01517                                        0624 01650000
         BE    @RT00624                                            0624 01651000
         C     @05,@CF01519                                        0624 01652000
         BNE   @RF00624                                            0624 01653000
@RT00624 DS    0H                                                  0625 01654000
*       DO;                         /*                       @Z40LB30*/ 01655000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 01656000
         XC    DARGAREA(76),DARGAREA                               0626 01657000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 01658000
         L     @05,DDSTRU                                          0627 01659000
         MVC   DARGSMOD(3,@05),@CC01475                            0627 01660000
*         DARGSENT=MSG0102I;        /*                       @Z40LB30*/ 01661000
         MVI   DARGSENT(@05),X'3A'                                 0628 01662000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 01663000
         L     @05,@PC00001                                        0629 01664000
         ST    @05,@AL00001                                        0629 01665000
         LA    @15,@CF00117                                        0629 01666000
         ST    @15,@AL00001+4                                      0629 01667000
         LA    @15,DDSTRU                                          0629 01668000
         ST    @15,@AL00001+8                                      0629 01669000
         MVI   @AL00001+8,X'80'                                    0629 01670000
         L     @15,GDTPRT(,@05)                                    0629 01671000
         LA    @01,@AL00001                                        0629 01672000
         BALR  @14,@15                                             0629 01673000
*       END;                        /*                       @Z40LB30*/ 01674000
*                                                                  0630 01675000
*   /*****************************************************************/ 01676000
*   /*                                                               */ 01677000
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/ 01678000
*   /* REASON CODE AND SET AN INDICATOR.                     @Z40LB30*/ 01679000
*   /*                                                               */ 01680000
*   /*****************************************************************/ 01681000
*                                                                  0631 01682000
*     ELSE                          /*                       @Z40LB30*/ 01683000
*       DO;                         /*                       @Z40LB30*/ 01684000
         B     @RC00624                                            0631 01685000
@RF00624 DS    0H                                                  0632 01686000
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/ 01687000
         LA    @05,VVICODE                                         0632 01688000
         ST    @05,@AL00001                                        0632 01689000
         LA    @01,@AL00001                                        0632 01690000
         BAL   @14,SSCMSG                                          0632 01691000
*         RDERROR=ON;               /*                       @Z40LB30*/ 01692000
         OI    RDERROR,B'01000000'                                 0633 01693000
*       END;                        /*                       @Z40LB30*/ 01694000
*                                                                  0635 01695000
*   /*****************************************************************/ 01696000
*   /*                                                               */ 01697000
*   /* IF A RECORD WAS RETURNED, PROCESS AND READ ALL THE    @Z40LB30*/ 01698000
*   /* ACTIVE NON-GROUPED VOLUMES UNTIL A READ ERROR OCCURS  @Z40LB30*/ 01699000
*   /* OR END OF FILE.                                       @Z40LB30*/ 01700000
*   /*                                                               */ 01701000
*   /*****************************************************************/ 01702000
*                                                                  0635 01703000
*   ELSE                            /*                       @Z40LB30*/ 01704000
*     DO WHILE RDERROR=OFF&EOFILE=OFF;/*                     @Z40LB30*/ 01705000
*                                                                  0635 01706000
         B     @RC00623                                            0635 01707000
@RF00623 B     @DE00635                                            0635 01708000
@DL00635 DS    0H                                                  0636 01709000
*       /*************************************************************/ 01710000
*       /*                                                           */ 01711000
*       /* CALL CKRECOV TO SEE IF RECOVERY FLAGS ARE ON.     @Z40LB26*/ 01712000
*       /* SAVE THE RETURN CODE.                             @Z40LB26*/ 01713000
*       /*                                                           */ 01714000
*       /*************************************************************/ 01715000
*                                                                  0636 01716000
*       CALL CKRECOV;               /*                       @Z40LB30*/ 01717000
         BAL   @14,CKRECOV                                         0636 01718000
*       RESPECIFY                                                  0637 01719000
*         RTNREG RSTD;                                             0637 01720000
*       TESTRC=RTNREG;                                             0638 01721000
         LR    TESTRC,RTNREG                                       0638 01722000
*       RESPECIFY                                                  0639 01723000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 01724000
*                                                                  0639 01725000
*       /*************************************************************/ 01726000
*       /*                                                           */ 01727000
*       /* IF AN ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/ 01728000
*       /*                                                           */ 01729000
*       /*************************************************************/ 01730000
*                                                                  0640 01731000
*       IF TESTRC>LASTCC00 THEN     /*                       @Z40LB30*/ 01732000
         LTR   TESTRC,TESTRC                                       0640 01733000
         BNP   @RF00640                                            0640 01734000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 01735000
*                                                                  0641 01736000
         LA    CC01,12                                             0641 01737000
*       /*************************************************************/ 01738000
*       /*                                                           */ 01739000
*       /* IF THE RECORD CAN BE PROCESSED CALL PROCVOL TO    @Z40LB30*/ 01740000
*       /* PROCESS THE VOLUME. SAVE THE RETURN CODE.         @Z40LB30*/ 01741000
*       /*                                                           */ 01742000
*       /*************************************************************/ 01743000
*                                                                  0642 01744000
*       ELSE                        /*                       @Z40LB26*/ 01745000
*         DO;                       /*                       @Z40LB30*/ 01746000
         B     @RC00640                                            0642 01747000
@RF00640 DS    0H                                                  0643 01748000
*           CALL PROCVOL;           /*                       @Z40LB30*/ 01749000
         BAL   @14,PROCVOL                                         0643 01750000
*           RESPECIFY                                              0644 01751000
*             RTNREG RSTD;                                         0644 01752000
*           TESTRC=RTNREG;                                         0645 01753000
         LR    TESTRC,RTNREG                                       0645 01754000
*           RESPECIFY                                              0646 01755000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 01756000
*                                                                  0646 01757000
*           /*********************************************************/ 01758000
*           /*                                                       */ 01759000
*           /* SET THE CONDITION CODE TO THE HIGHEST VALUE   @Z40LB30*/ 01760000
*           /*                                                       */ 01761000
*           /*********************************************************/ 01762000
*                                                                  0647 01763000
*           CC01=MAX(CC01,TESTRC);  /*                       @Z40LB30*/ 01764000
*                                                                  0647 01765000
         CR    CC01,TESTRC                                         0647 01766000
         BNL   *+6                                                      01767000
         LR    CC01,TESTRC                                         0647 01768000
*           /*********************************************************/ 01769000
*           /*                                                       */ 01770000
*           /* IF THE RETURN CODE INDICATES A VOLUME WAS     @Z40LB30*/ 01771000
*           /* PROCESSED, SET AN INDICATOR.                  @Z40LB30*/ 01772000
*           /*                                                       */ 01773000
*           /*********************************************************/ 01774000
*                                                                  0648 01775000
*           IF TESTRC<LASTCC12 THEN /*                       @Z40LB30*/ 01776000
         C     TESTRC,@CF00035                                     0648 01777000
         BNL   @RF00648                                            0648 01778000
*             ONEDONE=ON;           /*                       @Z40LB30*/ 01779000
         OI    ONEDONE,B'10000000'                                 0649 01780000
*         END;                      /*                       @Z40LB30*/ 01781000
*                                                                  0650 01782000
@RF00648 DS    0H                                                  0651 01783000
*       /*************************************************************/ 01784000
*       /*                                                           */ 01785000
*       /* IF THE CURRENT RECORD WAS NOT THE LAST, ISSUE     @Z40LB30*/ 01786000
*       /* USSC TO READ THE NEXT RECORD. FIRST SET THE       @Z40LB30*/ 01787000
*       /* NEW VOLUME SERIAL IN THE IEZRVVI ARGUMENT LIST.   @Z40LB30*/ 01788000
*       /*                                                           */ 01789000
*       /*************************************************************/ 01790000
*                                                                  0651 01791000
*       IF BASLAST^=ON THEN         /*                       @Z40LB30*/ 01792000
@RC00640 TM    BASLAST(BASEVPTR),B'00001000'                       0651 01793000
         BO    @RF00651                                            0651 01794000
*         DO;                       /*                       @Z40LB30*/ 01795000
*           RVVSVOL=ON;             /*                       @Z40LB30*/ 01796000
         L     @02,RVVIPTR                                         0653 01797000
         OI    RVVSVOL(@02),B'00000001'                            0653 01798000
*           RVVOLUME=BASNEXTV;      /*                       @Z40LB30*/ 01799000
         MVC   RVVOLUME(6,@02),BASNEXTV(BASEVPTR)                  0654 01800000
*           CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*    @Z40LB30*/ 01801000
         L     @02,@PC00001                                        0655 01802000
         ST    @02,@AL00001                                        0655 01803000
         LA    @15,VVIC                                            0655 01804000
         ST    @15,@AL00001+4                                      0655 01805000
         LA    @15,RVVIPTR                                         0655 01806000
         ST    @15,@AL00001+8                                      0655 01807000
         LA    @15,VVICODE                                         0655 01808000
         ST    @15,@AL00001+12                                     0655 01809000
         MVI   @AL00001+12,X'80'                                   0655 01810000
         L     @15,GDTSSC(,@02)                                    0655 01811000
         LA    @01,@AL00001                                        0655 01812000
         BALR  @14,@15                                             0655 01813000
*           RESPECIFY                                              0656 01814000
*             RTNREG RSTD;                                         0656 01815000
*           TESTRC=RTNREG;                                         0657 01816000
         LR    TESTRC,RTNREG                                       0657 01817000
*           RESPECIFY                                              0658 01818000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 01819000
*                                                                  0658 01820000
*           /*********************************************************/ 01821000
*           /*                                                       */ 01822000
*           /* IF NO ACTIVE VOLUMES LEFT, SET END OF FILE    @Z40LB30*/ 01823000
*           /*                                                       */ 01824000
*           /*********************************************************/ 01825000
*                                                                  0659 01826000
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/ 01827000
         LTR   TESTRC,TESTRC                                       0659 01828000
         BZ    @RF00659                                            0659 01829000
*             IF VVICODE=NOACTIVE THEN/*                     @Z40LB30*/ 01830000
         CLC   VVICODE(4),@CF01519                                 0660 01831000
         BNE   @RF00660                                            0660 01832000
*               EOFILE=ON;          /*                       @Z40LB30*/ 01833000
*                                                                  0661 01834000
         OI    EOFILE,B'00100000'                                  0661 01835000
*           /*********************************************************/ 01836000
*           /*                                                       */ 01837000
*           /* IF THE NEXT VOLUME IN THE CHAIN COULD NOT     @Z40LB30*/ 01838000
*           /* BE FOUND OR IF IT WAS FOUND TO BE A GROUPED   @Z40LB30*/ 01839000
*           /* VOLUME, ISSUE MESSAGE IDC2103I.               @Z40LB30*/ 01840000
*           /*                                                       */ 01841000
*           /*********************************************************/ 01842000
*                                                                  0662 01843000
*             ELSE                  /*                       @Z40LB30*/ 01844000
*               IF VVICODE=NORECORD|VVICODE=WRONGCHN/*       @Z40LB30*/ 01845000
*                 THEN              /*                       @Z40LB30*/ 01846000
         B     @RC00660                                            0662 01847000
@RF00660 L     @15,VVICODE                                         0662 01848000
         C     @15,@CF01517                                        0662 01849000
         BE    @RT00662                                            0662 01850000
         C     @15,@CF01521                                        0662 01851000
         BNE   @RF00662                                            0662 01852000
@RT00662 DS    0H                                                  0663 01853000
*                 DO;               /*                       @Z40LB30*/ 01854000
*                   RDERROR=ON;     /*                       @Z40LB30*/ 01855000
         OI    RDERROR,B'01000000'                                 0664 01856000
*                   DARGAREA=''B;   /*                       @Z40LB30*/ 01857000
         XC    DARGAREA(76),DARGAREA                               0665 01858000
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/ 01859000
         L     @15,DDSTRU                                          0666 01860000
         MVC   DARGSMOD(3,@15),@CC01475                            0666 01861000
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/ 01862000
         MVI   DARGSENT(@15),X'3B'                                 0667 01863000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/ 01864000
         L     @15,@PC00001                                        0668 01865000
         ST    @15,@AL00001                                        0668 01866000
         LA    @14,@CF00117                                        0668 01867000
         ST    @14,@AL00001+4                                      0668 01868000
         LA    @14,DDSTRU                                          0668 01869000
         ST    @14,@AL00001+8                                      0668 01870000
         MVI   @AL00001+8,X'80'                                    0668 01871000
         L     @15,GDTPRT(,@15)                                    0668 01872000
         LA    @01,@AL00001                                        0668 01873000
         BALR  @14,@15                                             0668 01874000
*                 END;              /*                       @Z40LB30*/ 01875000
*                                                                  0669 01876000
*           /*********************************************************/ 01877000
*           /*                                                       */ 01878000
*           /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG        @Z40LB30*/ 01879000
*           /* TO PRINT THE REASON CODE                      @Z40LB26*/ 01880000
*           /*                                                       */ 01881000
*           /*********************************************************/ 01882000
*                                                                  0670 01883000
*               ELSE                /*                       @Z40LB30*/ 01884000
*                 DO;               /*                       @Z40LB30*/ 01885000
         B     @RC00662                                            0670 01886000
@RF00662 DS    0H                                                  0671 01887000
*                   RDERROR=ON;     /*                       @Z40LB30*/ 01888000
         OI    RDERROR,B'01000000'                                 0671 01889000
*                   CALL SSCMSG(VVICODE);/*                  @Z40LB30*/ 01890000
         LA    @15,VVICODE                                         0672 01891000
         ST    @15,@AL00001                                        0672 01892000
         LA    @01,@AL00001                                        0672 01893000
         BAL   @14,SSCMSG                                          0672 01894000
*                 END;              /*                       @Z40LB30*/ 01895000
*                                                                  0673 01896000
*           /*********************************************************/ 01897000
*           /*                                                       */ 01898000
*           /* IF NO ERRORS OCCURRED, NOTHING TO DO          @Z40LB30*/ 01899000
*           /*                                                       */ 01900000
*           /*********************************************************/ 01901000
*                                                                  0674 01902000
*           ELSE                                                   0674 01903000
*             ;                     /*                       @Z40LB30*/ 01904000
@RF00659 DS    0H                                                  0675 01905000
*         END;                      /*                       @Z40LB30*/ 01906000
*                                                                  0675 01907000
*       /*************************************************************/ 01908000
*       /*                                                           */ 01909000
*       /* IF THE CURRENT RECORD IS THE LAST, SET THE        @Z40LB30*/ 01910000
*       /* END-OF-FILE INDICATOR.                            @Z40LB30*/ 01911000
*       /*                                                           */ 01912000
*       /*************************************************************/ 01913000
*                                                                  0676 01914000
*       ELSE                        /*                       @Z40LB30*/ 01915000
*         EOFILE=ON;                /*                       @Z40LB30*/ 01916000
         B     @RC00651                                            0676 01917000
@RF00651 OI    EOFILE,B'00100000'                                  0676 01918000
*     END;                          /*                       @Z40LB30*/ 01919000
@RC00651 DS    0H                                                  0677 01920000
@DE00635 TM    RDERROR,B'01100000'                                 0677 01921000
         BZ    @DL00635                                            0677 01922000
*                                                                  0678 01923000
*   /*****************************************************************/ 01924000
*   /*                                                               */ 01925000
*   /* IF A READ ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/ 01926000
*   /* AND ISSUE SECONDARY MESSAGE IDC2109I TO SAY NO MORE   @Z40LB30*/ 01927000
*   /* VOLUMES CAN BE PROCESSED.                             @Z40LB30*/ 01928000
*   /*                                                               */ 01929000
*   /*****************************************************************/ 01930000
*                                                                  0678 01931000
*   IF RDERROR=ON THEN              /*                       @Z40LB30*/ 01932000
@RC00623 TM    RDERROR,B'01000000'                                 0678 01933000
         BNO   @RF00678                                            0678 01934000
*     DO;                           /*                       @Z40LB30*/ 01935000
*       CC01=LASTCC12;              /*                       @Z40LB30*/ 01936000
         LA    CC01,12                                             0680 01937000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 01938000
         XC    DARGAREA(76),DARGAREA                               0681 01939000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 01940000
         L     @05,DDSTRU                                          0682 01941000
         MVC   DARGSMOD(3,@05),@CC01475                            0682 01942000
*       DARGSENT=MSG2109I;          /*                       @Z40LB30*/ 01943000
         MVI   DARGSENT(@05),X'41'                                 0683 01944000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 01945000
         L     @05,@PC00001                                        0684 01946000
         ST    @05,@AL00001                                        0684 01947000
         LA    @15,@CF00117                                        0684 01948000
         ST    @15,@AL00001+4                                      0684 01949000
         LA    @15,DDSTRU                                          0684 01950000
         ST    @15,@AL00001+8                                      0684 01951000
         MVI   @AL00001+8,X'80'                                    0684 01952000
         L     @15,GDTPRT(,@05)                                    0684 01953000
         LA    @01,@AL00001                                        0684 01954000
         BALR  @14,@15                                             0684 01955000
*     END;                          /*                       @Z40LB30*/ 01956000
*                                                                  0686 01957000
*   /*****************************************************************/ 01958000
*   /*                                                               */ 01959000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 01960000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 01961000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/ 01962000
*   /* THE FINAL CONDITION CODE.                             @Z40LB30*/ 01963000
*   /*                                                               */ 01964000
*   /*****************************************************************/ 01965000
*                                                                  0686 01966000
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/ 01967000
@RF00678 C     CC01,@CF00035                                       0686 01968000
         BNE   @RF00686                                            0686 01969000
         TM    ONEDONE,B'10000000'                                 0686 01970000
         BNO   @RF00686                                            0686 01971000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 01972000
*                                                                  0687 01973000
         LA    CC01,8                                              0687 01974000
*   /*****************************************************************/ 01975000
*   /*                                                               */ 01976000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 01977000
*   /*                                                               */ 01978000
*   /*****************************************************************/ 01979000
*                                                                  0688 01980000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01981000
@RF00686 LR    @15,CC01                                            0688 01982000
@EL00004 DS    0H                                                  0688 01983000
@EF00004 DS    0H                                                  0688 01984000
@ER00004 L     @14,@SA00004                                        0688 01985000
         BR    @14                                                 0688 01986000
*   END NONGRPD;                    /*                       @Z40LB30*/ 01987000
*                                                                  0690 01988000
*/*********************************************************  @Z40LB30*/ 01989000
*/*                                                          @Z40LB30*/ 01990000
*/* PROCEDURE - ALLGRPS                                      @Z40LB30*/ 01991000
*/*                                                          @Z40LB30*/ 01992000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/ 01993000
*/*           READ EACH GROUP RECORD IN THE INVENTORY.  THEN @Z40LB30*/ 01994000
*/*           CALL A PROCEDURE TO READ EACH ACTIVE BASE      @Z40LB30*/ 01995000
*/*           VOLUME IN THE GROUP.  FOR EACH VOLUME, CALL    @Z40LB30*/ 01996000
*/*           PROCEDURES TO CHECK IF THE VOLUME              @Z40LB26*/ 01997000
*/*           HAS A RECOVERY FLAG ON IN THE VOLUME RECORD    @Z40LB26*/ 01998000
*/*           AND TO PROCESS THE VOLUME.  ISSUE MESSAGE      @Z40LB26*/ 01999000
*/*           IDC2111I IF AN ERROR OCCURS AND THE REMAINING  @Z40LB26*/ 02000000
*/*           GROUPS CANNOT BE PROCESSED                     @Z40LB26*/ 02001000
*/*                                                          @Z40LB30*/ 02002000
*/* INPUT - NONE                                             @Z40LB30*/ 02003000
*/*                                                          @Z40LB30*/ 02004000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 02005000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 02006000
*/*                           CLOSING VTOC                   @Z40LB30*/ 02007000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 02008000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 02009000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 02010000
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/ 02011000
*/*                           TO ERRORS                      @Z40LB30*/ 02012000
*/*                                                          @Z40LB30*/ 02013000
*/*********************************************************  @Z40LB30*/ 02014000
*                                                                  0690 02015000
*ALLGRPS:                                                          0690 02016000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 02017000
ALLGRPS  ST    @14,@SA00005                                        0690 02018000
*                                                                  0691 02019000
*   /*****************************************************************/ 02020000
*   /*                                                               */ 02021000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 02022000
*   /*                                                               */ 02023000
*   /*****************************************************************/ 02024000
*                                                                  0691 02025000
*   OLDERID2=NEWERID2;                                             0691 02026000
         L     @15,@PC00001                                        0691 02027000
         L     @15,GDTTR2(,@15)                                    0691 02028000
         MVC   @TS00001(95),NEWERID2(@15)                          0691 02029000
         MVC   OLDERID2(95,@15),@TS00001                           0691 02030000
*   NEWID2='LDAG';                  /*                       @Z40LB30*/ 02031000
*                                                                  0692 02032000
         MVC   NEWID2(4,@15),@CC01606                              0692 02033000
*   /*****************************************************************/ 02034000
*   /*                                                               */ 02035000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 02036000
*   /*                                                               */ 02037000
*   /*****************************************************************/ 02038000
*                                                                  0693 02039000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 02040000
*                                                                  0693 02041000
         SLR   @15,@15                                             0693 02042000
         LR    CC01,@15                                            0693 02043000
*   /*****************************************************************/ 02044000
*   /*                                                               */ 02045000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ EACH GROUP   @Z40LB30*/ 02046000
*   /* RECORD                                                @Z40LB30*/ 02047000
*   /*                                                               */ 02048000
*   /*****************************************************************/ 02049000
*                                                                  0694 02050000
*   GRPRVVI=''B;                    /*                       @Z40LB30*/ 02051000
         XC    GRPRVVI(68),GRPRVVI                                 0694 02052000
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/ 02053000
         LA    @14,GRPRVVI                                         0695 02054000
         ST    @14,RVVIPTR                                         0695 02055000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 02056000
         LH    @07,RVVLEN                                          0696 02057000
         ST    @07,RVVLNGTH(,@14)                                  0696 02058000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 02059000
         MVI   RVVCODE(@14),X'87'                                  0697 02060000
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/ 02061000
         MVC   RVVBUFLN(2,@14),@CH01762                            0698 02062000
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 02063000
         LA    @07,GRPREC                                          0699 02064000
         ST    @07,RVVRTBUF(,@14)                                  0699 02065000
*   RVVRDNR=ON;                     /* READ NEXT             @Z40LB30*/ 02066000
         OI    RVVRDNR(@14),B'01000000'                            0700 02067000
*   RVVGRPRC=ON;                    /* GROUP RECORD          @Z40LB30*/ 02068000
         OI    RVVGRPRC(@14),B'01000000'                           0701 02069000
*                                                                  0702 02070000
*   /*****************************************************************/ 02071000
*   /*                                                               */ 02072000
*   /* LOOP THROUGH ALL THE GROUPS UNTIL NO MORE GROUPS CAN  @Z40LB30*/ 02073000
*   /* BE READ DUE TO ERROR OR BECAUSE THERE ARE NO MORE.    @Z40LB30*/ 02074000
*   /*                                                               */ 02075000
*   /*****************************************************************/ 02076000
*                                                                  0702 02077000
*   VVICODE=0;                      /*                       @Z40LB30*/ 02078000
         ST    @15,VVICODE                                         0702 02079000
*   DO UNTIL VVICODE^=0;            /*                       @Z40LB30*/ 02080000
*                                                                  0703 02081000
@DL00703 DS    0H                                                  0704 02082000
*     /***************************************************************/ 02083000
*     /*                                                             */ 02084000
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD.            @Z40LB30*/ 02085000
*     /* SAVE THE RETURN CODE.                               @Z40LB30*/ 02086000
*     /*                                                             */ 02087000
*     /***************************************************************/ 02088000
*                                                                  0704 02089000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/ 02090000
         L     @02,@PC00001                                        0704 02091000
         ST    @02,@AL00001                                        0704 02092000
         LA    @15,VVIC                                            0704 02093000
         ST    @15,@AL00001+4                                      0704 02094000
         LA    @15,RVVIPTR                                         0704 02095000
         ST    @15,@AL00001+8                                      0704 02096000
         LA    @15,VVICODE                                         0704 02097000
         ST    @15,@AL00001+12                                     0704 02098000
         MVI   @AL00001+12,X'80'                                   0704 02099000
         L     @15,GDTSSC(,@02)                                    0704 02100000
         LA    @01,@AL00001                                        0704 02101000
         BALR  @14,@15                                             0704 02102000
*     RESPECIFY                                                    0705 02103000
*       RTNREG RSTD;                                               0705 02104000
*     TESTRC=RTNREG;                                               0706 02105000
         LR    TESTRC,RTNREG                                       0706 02106000
*     RESPECIFY                                                    0707 02107000
*       RTNREG UNRSTD;              /*                       @Z40LB30*/ 02108000
*                                                                  0707 02109000
*     /***************************************************************/ 02110000
*     /*                                                             */ 02111000
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/ 02112000
*     /*                                                             */ 02113000
*     /***************************************************************/ 02114000
*                                                                  0708 02115000
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/ 02116000
         SLR   @02,@02                                             0708 02117000
         CR    TESTRC,@02                                          0708 02118000
         BNE   @RF00708                                            0708 02119000
*       DO;                         /*                       @Z40LB30*/ 02120000
*                                                                  0709 02121000
*         /***********************************************************/ 02122000
*         /*                                                         */ 02123000
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO    @Z40LB30*/ 02124000
*         /* ZERO TO PASS TO RDGRPCHN PROCEDURE.             @Z40LB30*/ 02125000
*         /*                                                         */ 02126000
*         /***********************************************************/ 02127000
*                                                                  0710 02128000
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/ 02129000
*                                                                  0710 02130000
         ST    @02,VOLPTR                                          0710 02131000
*         /***********************************************************/ 02132000
*         /*                                                         */ 02133000
*         /* READ AND PROCESS ALL ACTIVE BASE VOLUME RECORDS @Z40LB30*/ 02134000
*         /* UNTIL THERE ARE NO MORE OR A READ ERROR OCCURS. @Z40LB30*/ 02135000
*         /*                                                         */ 02136000
*         /***********************************************************/ 02137000
*                                                                  0711 02138000
*         RDERROR=OFF;              /*                       @Z40LB30*/ 02139000
         NI    RDERROR,B'10111111'                                 0711 02140000
*         DO UNTIL VOLPTR=NULLPTR|RDERROR=ON;/*              @Z40LB30*/ 02141000
*                                                                  0712 02142000
@DL00712 DS    0H                                                  0713 02143000
*           /*********************************************************/ 02144000
*           /*                                                       */ 02145000
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/ 02146000
*           /* SAVE THE RETURN CODE.                         @Z40LB30*/ 02147000
*           /*                                                       */ 02148000
*           /*********************************************************/ 02149000
*                                                                  0713 02150000
*           CALL RDGRPCHN;          /*                       @Z40LB30*/ 02151000
         BAL   @14,RDGRPCHN                                        0713 02152000
*           RESPECIFY                                              0714 02153000
*             RTNREG RSTD;                                         0714 02154000
*           TESTRC=RTNREG;                                         0715 02155000
         LR    TESTRC,RTNREG                                       0715 02156000
*           RESPECIFY                                              0716 02157000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 02158000
*                                                                  0716 02159000
*           /*********************************************************/ 02160000
*           /*                                                       */ 02161000
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/ 02162000
*           /* IF THERE IS A VOLUME TO PROCESS.              @Z40LB30*/ 02163000
*           /*                                                       */ 02164000
*           /*********************************************************/ 02165000
*                                                                  0717 02166000
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/ 02167000
         SLR   @02,@02                                             0717 02168000
         CR    TESTRC,@02                                          0717 02169000
         BNE   @RF00717                                            0717 02170000
*             IF VOLPTR^=NULLPTR    /*                       @Z40LB30*/ 02171000
*               THEN                /*                       @Z40LB30*/ 02172000
*                                                                  0718 02173000
         C     @02,VOLPTR                                          0718 02174000
         BE    @RF00718                                            0718 02175000
*               /*****************************************************/ 02176000
*               /*                                                   */ 02177000
*               /* PROCESS THE VOLUME                        @Z40LB30*/ 02178000
*               /*                                                   */ 02179000
*               /*****************************************************/ 02180000
*                                                                  0719 02181000
*               DO;                 /*                       @Z40LB30*/ 02182000
*                                                                  0719 02183000
*                 /***************************************************/ 02184000
*                 /*                                                 */ 02185000
*                 /* CALL CKRECOV TO SEE IF ANY RECOVERY     @Z40LB26*/ 02186000
*                 /* FLAGS ARE ON. SAVE THE RETURN CODE.     @Z40LB30*/ 02187000
*                 /*                                                 */ 02188000
*                 /***************************************************/ 02189000
*                                                                  0720 02190000
*                 CALL CKRECOV;     /*                       @Z40LB30*/ 02191000
         BAL   @14,CKRECOV                                         0720 02192000
*                 RESPECIFY                                        0721 02193000
*                   RTNREG RSTD;                                   0721 02194000
*                 TESTRC=RTNREG;                                   0722 02195000
         LR    TESTRC,RTNREG                                       0722 02196000
*                 RESPECIFY                                        0723 02197000
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/ 02198000
*                                                                  0723 02199000
*                 /***************************************************/ 02200000
*                 /*                                                 */ 02201000
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/ 02202000
*                 /* (>4), SET THE CONDITION CODE TO         @Z40LB30*/ 02203000
*                 /* INDICATE A VOLUME COULD NOT BE          @Z40LB30*/ 02204000
*                 /* PROCESSED.                              @Z40LB30*/ 02205000
*                 /*                                                 */ 02206000
*                 /***************************************************/ 02207000
*                                                                  0724 02208000
*                 IF TESTRC>LASTCC00 THEN/*                  @Z40LB30*/ 02209000
         LTR   TESTRC,TESTRC                                       0724 02210000
         BNP   @RF00724                                            0724 02211000
*                   CC01=LASTCC12;  /*                       @Z40LB30*/ 02212000
*                                                                  0725 02213000
         LA    CC01,12                                             0725 02214000
*                 /***************************************************/ 02215000
*                 /*                                                 */ 02216000
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/ 02217000
*                 /* PROCESS IT.                             @Z40LB30*/ 02218000
*                 /*                                                 */ 02219000
*                 /***************************************************/ 02220000
*                                                                  0726 02221000
*                 ELSE              /*                       @Z40LB30*/ 02222000
*                   DO;             /*                       @Z40LB30*/ 02223000
*                                                                  0726 02224000
         B     @RC00724                                            0726 02225000
@RF00724 DS    0H                                                  0727 02226000
*                     /***********************************************/ 02227000
*                     /*                                             */ 02228000
*                     /* CALL PROCVOL TO PROCESS THE         @Z40LB30*/ 02229000
*                     /* VOLUME. SAVE THE RETURN             @Z40LB30*/ 02230000
*                     /* CODE. ACCUMULATE THE LARGEST        @Z40LB30*/ 02231000
*                     /* RETURN CODE IN THE INTERNAL         @Z40LB30*/ 02232000
*                     /* CONDITION CODE AREA.                @Z40LB30*/ 02233000
*                     /*                                             */ 02234000
*                     /***********************************************/ 02235000
*                                                                  0727 02236000
*                     CALL PROCVOL; /*                       @Z40LB26*/ 02237000
         BAL   @14,PROCVOL                                         0727 02238000
*                     RESPECIFY                                    0728 02239000
*                       RTNREG RSTD;                               0728 02240000
*                     TESTRC=RTNREG;                               0729 02241000
         LR    TESTRC,RTNREG                                       0729 02242000
*                     RESPECIFY                                    0730 02243000
*                       RTNREG UNRSTD;/*                     @Z40LB26*/ 02244000
*                     CC01=MAX(CC01,TESTRC);/*               @Z40LB26*/ 02245000
*                                                                  0731 02246000
         CR    CC01,TESTRC                                         0731 02247000
         BNL   *+6                                                      02248000
         LR    CC01,TESTRC                                         0731 02249000
*                     /***********************************************/ 02250000
*                     /*                                             */ 02251000
*                     /* IF THE RETURN CODE INDICATES        @Z40LB30*/ 02252000
*                     /* A VOLUME WAS PROCESSED, SET         @Z40LB30*/ 02253000
*                     /* AN INDICATOR.                       @Z40LB30*/ 02254000
*                     /*                                             */ 02255000
*                     /***********************************************/ 02256000
*                                                                  0732 02257000
*                     IF TESTRC<LASTCC12 THEN/*              @Z40LB30*/ 02258000
         C     TESTRC,@CF00035                                     0732 02259000
         BNL   @RF00732                                            0732 02260000
*                       ONEDONE=ON; /*                       @Z40LB30*/ 02261000
         OI    ONEDONE,B'10000000'                                 0733 02262000
*                   END;            /*                       @Z40LB26*/ 02263000
*               END;                /*                       @Z40LB30*/ 02264000
*                                                                  0735 02265000
*           /*********************************************************/ 02266000
*           /*                                                       */ 02267000
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP.    @Z40LB30*/ 02268000
*           /*                                                       */ 02269000
*           /*********************************************************/ 02270000
*                                                                  0736 02271000
*             ELSE                                                 0736 02272000
*               ;                   /*                       @Z40LB30*/ 02273000
*                                                                  0736 02274000
@RF00718 DS    0H                                                  0737 02275000
*           /*********************************************************/ 02276000
*           /*                                                       */ 02277000
*           /* IF THERE WAS AN ERROR READING A VOLUME RECORD @Z40LB30*/ 02278000
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/ 02279000
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/ 02280000
*           /*                                                       */ 02281000
*           /*********************************************************/ 02282000
*                                                                  0737 02283000
*           ELSE                    /*                       @Z40LB30*/ 02284000
*             DO;                   /*                       @Z40LB30*/ 02285000
         B     @RC00717                                            0737 02286000
@RF00717 DS    0H                                                  0738 02287000
*               RDERROR=ON;         /*                       @Z40LB30*/ 02288000
         OI    RDERROR,B'01000000'                                 0738 02289000
*               CC01=LASTCC12;      /*                       @Z40LB30*/ 02290000
         LA    CC01,12                                             0739 02291000
*             END;                  /*                       @Z40LB30*/ 02292000
*         END;                      /*                       @Z40LB30*/ 02293000
*                                                                  0741 02294000
@RC00717 DS    0H                                                  0741 02295000
@DE00712 L     @15,VOLPTR                                          0741 02296000
         LTR   @15,@15                                             0741 02297000
         BZ    @DC00712                                            0741 02298000
         TM    RDERROR,B'01000000'                                 0741 02299000
         BNO   @DL00712                                            0741 02300000
@DC00712 DS    0H                                                  0742 02301000
*         /***********************************************************/ 02302000
*         /*                                                         */ 02303000
*         /* RESET THE POINTER TO THE IEZRVVI ARGUMENT LIST. @Z40LB30*/ 02304000
*         /* INCREMENT GROUP NAME IN IEZRVVI ARGUMENT LIST   @Z40LB30*/ 02305000
*         /* SO THAT NEXT GROUP RECORD IS READ.              @Z40LB30*/ 02306000
*         /*                                                         */ 02307000
*         /***********************************************************/ 02308000
*                                                                  0742 02309000
*         RVVIPTR=ADDR(GRPRVVI);    /*                       @Z40LB30*/ 02310000
         LA    @15,GRPRVVI                                         0742 02311000
         ST    @15,RVVIPTR                                         0742 02312000
*         RVVGROUP=GROVVGRP;        /*                       @Z40LB30*/ 02313000
         L     @14,GROUPPTR                                        0743 02314000
         MVC   RVVGROUP(8,@15),GROVVGRP(@14)                       0743 02315000
*         RVVSGRP=ON;               /*                       @Z40LB30*/ 02316000
         OI    RVVSGRP(@15),B'10000000'                            0744 02317000
*       END;                        /*                       @Z40LB30*/ 02318000
*   END;                            /*                       @Z40LB30*/ 02319000
@RF00708 DS    0H                                                  0746 02320000
@DE00703 L     @15,VVICODE                                         0746 02321000
         LTR   @15,@15                                             0746 02322000
         BZ    @DL00703                                            0746 02323000
*                                                                  0747 02324000
*   /*****************************************************************/ 02325000
*   /*                                                               */ 02326000
*   /* IF THERE WAS AN ERROR READING A GROUP RECORD, CALL    @Z40LB30*/ 02327000
*   /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT MESSAGE   @Z40LB30*/ 02328000
*   /* IDC2111I TO SAY NO MORE GROUPS COULD BE PROCESSED.    @Z40LB30*/ 02329000
*   /* THEN SET CONDITION CODE TO INDICATE A SEVERE ERROR.   @Z40LB30*/ 02330000
*   /*                                                               */ 02331000
*   /*****************************************************************/ 02332000
*                                                                  0747 02333000
*   IF VVICODE^=NORECORD THEN       /*                       @Z40LB30*/ 02334000
         C     @15,@CF01517                                        0747 02335000
         BE    @RF00747                                            0747 02336000
*     DO;                           /*                       @Z40LB30*/ 02337000
*       CALL SSCMSG(VVICODE);       /*                       @Z40LB30*/ 02338000
         LA    @15,VVICODE                                         0749 02339000
         ST    @15,@AL00001                                        0749 02340000
         LA    @01,@AL00001                                        0749 02341000
         BAL   @14,SSCMSG                                          0749 02342000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 02343000
         XC    DARGAREA(76),DARGAREA                               0750 02344000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 02345000
         L     @05,DDSTRU                                          0751 02346000
         MVC   DARGSMOD(3,@05),@CC01475                            0751 02347000
*       DARGSENT=MSG2111I;          /*                       @Z40LB30*/ 02348000
         MVI   DARGSENT(@05),X'43'                                 0752 02349000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 02350000
         L     @05,@PC00001                                        0753 02351000
         ST    @05,@AL00001                                        0753 02352000
         LA    @15,@CF00117                                        0753 02353000
         ST    @15,@AL00001+4                                      0753 02354000
         LA    @15,DDSTRU                                          0753 02355000
         ST    @15,@AL00001+8                                      0753 02356000
         MVI   @AL00001+8,X'80'                                    0753 02357000
         L     @15,GDTPRT(,@05)                                    0753 02358000
         LA    @01,@AL00001                                        0753 02359000
         BALR  @14,@15                                             0753 02360000
*       CC01=LASTCC12;              /*                       @Z40LB30*/ 02361000
         LA    CC01,12                                             0754 02362000
*     END;                          /*                       @Z40LB30*/ 02363000
*                                                                  0756 02364000
*   /*****************************************************************/ 02365000
*   /*                                                               */ 02366000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 02367000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 02368000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED, OR AT LEAST     @Z40LB26*/ 02369000
*   /* ONE EMPTY GROUP WAS PROCESSED. IF SO, LOWER THE       @Z40LB26*/ 02370000
*   /* FINAL CONDITION CODE.                                 @Z40LB26*/ 02371000
*   /*                                                               */ 02372000
*   /*****************************************************************/ 02373000
*                                                                  0756 02374000
*   IF CC01=LASTCC12&(ONEDONE=ON|EMPTYGRP=ON) THEN/*         @Z40LB26*/ 02375000
@RF00747 C     CC01,@CF00035                                       0756 02376000
         BNE   @RF00756                                            0756 02377000
         TM    ONEDONE,B'10001000'                                 0756 02378000
         BZ    @RF00756                                            0756 02379000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 02380000
*                                                                  0757 02381000
         LA    CC01,8                                              0757 02382000
*   /*****************************************************************/ 02383000
*   /*                                                               */ 02384000
*   /* RETURN TO CALLER.                                     @Z40LB30*/ 02385000
*   /*                                                               */ 02386000
*   /*****************************************************************/ 02387000
*                                                                  0758 02388000
*   RETURN CODE(CC01);              /*                       @Z40LB26*/ 02389000
@RF00756 LR    @15,CC01                                            0758 02390000
@EL00005 DS    0H                                                  0758 02391000
@EF00005 DS    0H                                                  0758 02392000
@ER00005 L     @14,@SA00005                                        0758 02393000
         BR    @14                                                 0758 02394000
*   END ALLGRPS;                    /*                       @Z40LB30*/ 02395000
*                                                                  0760 02396000
*/********************************************************   @Z40LB30*/ 02397000
*/*                                                          @Z40LB30*/ 02398000
*/* PROCEDURE - ALLVOLS                                      @Z40LB30*/ 02399000
*/*                                                          @Z40LB30*/ 02400000
*/* FUNCTION - INTERFACE WITH THE MSVC PROGRAM TO READ EACH  @Z40LB30*/ 02401000
*/*           ACTIVE BASE VOLUME RECORD IN THE INVENTORY.    @Z40LB30*/ 02402000
*/*           THEN CALL A PROCEDURE TO CHECK IF THE          @Z40LB26*/ 02403000
*/*           VOLUME IS TO BE EXCLUDED OR IF THE RECORD      @Z40LB26*/ 02404000
*/*           HAS ANY RECOVERY FLAGS ON.  THEN CALL A        @Z40LB30*/ 02405000
*/*           PROCEDURE TO PROCESS THE VOLUME.  ISSUE        @Z40LB30*/ 02406000
*/*           MESSAGE IDC0104I IF THERE ARE NO ACTIVE        @Z40LB30*/ 02407000
*/*           VOLUMES IN THE INVENTORY AND MESSAGE           @Z40LB30*/ 02408000
*/*           IDC2109I IF AN ERROR OCCURS AND NO MORE        @Z40LB30*/ 02409000
*/*           VOLUMES CAN BE PROCESSED.                      @Z40LB30*/ 02410000
*/*                                                          @Z40LB30*/ 02411000
*/* INPUT - NONE                                             @Z40LB30*/ 02412000
*/*                                                          @Z40LB30*/ 02413000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/ 02414000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 02415000
*/*                           CLOSING VTOC                   @Z40LB30*/ 02416000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 02417000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 02418000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 02419000
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/ 02420000
*/*                           TO ERRORS                      @Z40LB30*/ 02421000
*/*                                                          @Z40LB30*/ 02422000
*/********************************************************   @Z40LB30*/ 02423000
*                                                                  0760 02424000
*ALLVOLS:                                                          0760 02425000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 02426000
ALLVOLS  ST    @14,@SA00006                                        0760 02427000
*                                                                  0761 02428000
*   /*****************************************************************/ 02429000
*   /*                                                               */ 02430000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 02431000
*   /*                                                               */ 02432000
*   /*****************************************************************/ 02433000
*                                                                  0761 02434000
*   OLDERID2=NEWERID2;                                             0761 02435000
         L     @02,@PC00001                                        0761 02436000
         L     @15,GDTTR2(,@02)                                    0761 02437000
         MVC   @TS00001(95),NEWERID2(@15)                          0761 02438000
         MVC   OLDERID2(95,@15),@TS00001                           0761 02439000
*   NEWID2='LDAV';                  /*                       @Z40LB30*/ 02440000
*                                                                  0762 02441000
         MVC   NEWID2(4,@15),@CC01610                              0762 02442000
*   /*****************************************************************/ 02443000
*   /*                                                               */ 02444000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 02445000
*   /* SET MSVC REASON CODE TO 0                             @Z40LB30*/ 02446000
*   /*                                                               */ 02447000
*   /*****************************************************************/ 02448000
*                                                                  0763 02449000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 02450000
         SLR   @15,@15                                             0763 02451000
         LR    CC01,@15                                            0763 02452000
*   VVICODE=0;                      /*                       @Z40LB30*/ 02453000
*                                                                  0764 02454000
         ST    @15,VVICODE                                         0764 02455000
*   /*****************************************************************/ 02456000
*   /*                                                               */ 02457000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ AN ACTIVE    @Z40LB30*/ 02458000
*   /* BASE VOLUME RECORD.                                   @Z40LB30*/ 02459000
*   /*                                                               */ 02460000
*   /*****************************************************************/ 02461000
*                                                                  0765 02462000
*   VOLRVVI=''B;                    /*                       @Z40LB30*/ 02463000
         XC    VOLRVVI(68),VOLRVVI                                 0765 02464000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/ 02465000
         LA    @15,VOLRVVI                                         0766 02466000
         ST    @15,RVVIPTR                                         0766 02467000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 02468000
         LH    @14,RVVLEN                                          0767 02469000
         ST    @14,RVVLNGTH(,@15)                                  0767 02470000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 02471000
         MVI   RVVCODE(@15),X'87'                                  0768 02472000
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/ 02473000
         MVC   RVVBUFLN(2,@15),@CH01761                            0769 02474000
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 02475000
         LA    @14,VOLREC                                          0770 02476000
         ST    @14,RVVRTBUF(,@15)                                  0770 02477000
*   RVVRDNR=ON;                     /* READ NEXT RECORDS     @Z40LB30*/ 02478000
         OI    RVVRDNR(@15),B'01000000'                            0771 02479000
*   RVVBVRCD=ON;                    /* BASE RECORDS ONLY     @Z40LB30*/ 02480000
         OI    RVVBVRCD(@15),B'10000000'                           0772 02481000
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/ 02482000
*                                                                  0773 02483000
         OI    RVVACTV(@15),B'00000100'                            0773 02484000
*   /*****************************************************************/ 02485000
*   /*                                                               */ 02486000
*   /* ISSUE USSC MACRO TO READ FIRST RECORD.                @Z40LB30*/ 02487000
*   /* SAVE THE RETURN CODE.                                 @Z40LB30*/ 02488000
*   /*                                                               */ 02489000
*   /*****************************************************************/ 02490000
*                                                                  0774 02491000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/ 02492000
         ST    @02,@AL00001                                        0774 02493000
         LA    @15,VVIC                                            0774 02494000
         ST    @15,@AL00001+4                                      0774 02495000
         LA    @15,RVVIPTR                                         0774 02496000
         ST    @15,@AL00001+8                                      0774 02497000
         LA    @15,VVICODE                                         0774 02498000
         ST    @15,@AL00001+12                                     0774 02499000
         MVI   @AL00001+12,X'80'                                   0774 02500000
         L     @15,GDTSSC(,@02)                                    0774 02501000
         LA    @01,@AL00001                                        0774 02502000
         BALR  @14,@15                                             0774 02503000
*   RESPECIFY                                                      0775 02504000
*     RTNREG RSTD;                                                 0775 02505000
*   TESTRC=RTNREG;                                                 0776 02506000
         LR    TESTRC,RTNREG                                       0776 02507000
*   RESPECIFY                                                      0777 02508000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 02509000
*                                                                  0778 02510000
*   /*****************************************************************/ 02511000
*   /*                                                               */ 02512000
*   /* IF THE FIRST RECORD WAS READ SUCCESSFULLY, START A    @Z40LB30*/ 02513000
*   /* LOOP TO PROCESS THE VOLUME AND THEN READ THE NEXT     @Z40LB30*/ 02514000
*   /* VOLUME RECORD. END THE LOOP WHEN THERE ARE NO MORE    @Z40LB30*/ 02515000
*   /* ACTIVE BASE VOLUME RECORDS THAT CAN BE READ FROM THE  @Z40LB30*/ 02516000
*   /* INVENTORY.                                            @Z40LB30*/ 02517000
*   /*                                                               */ 02518000
*   /*****************************************************************/ 02519000
*                                                                  0778 02520000
*   IF TESTRC=0 THEN                /*                       @Z40LB30*/ 02521000
         LTR   TESTRC,TESTRC                                       0778 02522000
         BNZ   @RF00778                                            0778 02523000
*     DO WHILE VVICODE=0;           /*                       @Z40LB30*/ 02524000
*                                                                  0779 02525000
         B     @DE00779                                            0779 02526000
@DL00779 DS    0H                                                  0780 02527000
*       /*************************************************************/ 02528000
*       /*                                                           */ 02529000
*       /* CALL CKRECOV TO SEE IF A RECOVERY FLAG IS         @Z40LB26*/ 02530000
*       /* ON IN THE VOLUME RECORD. SAVE THE RETURN CODE.    @Z40LB30*/ 02531000
*       /*                                                           */ 02532000
*       /*************************************************************/ 02533000
*                                                                  0780 02534000
*       CALL CKRECOV;               /*                       @Z40LB30*/ 02535000
         BAL   @14,CKRECOV                                         0780 02536000
*       RESPECIFY                                                  0781 02537000
*         RTNREG RSTD;                                             0781 02538000
*       TESTRC=RTNREG;                                             0782 02539000
         LR    TESTRC,RTNREG                                       0782 02540000
*       RESPECIFY                                                  0783 02541000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 02542000
*                                                                  0783 02543000
*       /*************************************************************/ 02544000
*       /*                                                           */ 02545000
*       /* IF THE RETURN CODE INDICATES AN ERROR, SET        @Z40LB30*/ 02546000
*       /* THE CONDITION CODE TO INDICATE A SEVERE ERROR     @Z40LB30*/ 02547000
*       /* THAT PREVENTED A VOLUME BEING PROCESSED.          @Z40LB30*/ 02548000
*       /*                                                           */ 02549000
*       /*************************************************************/ 02550000
*                                                                  0784 02551000
*       IF TESTRC>LASTCC00 THEN     /*                       @Z40LB30*/ 02552000
         LTR   TESTRC,TESTRC                                       0784 02553000
         BNP   @RF00784                                            0784 02554000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 02555000
*                                                                  0785 02556000
         LA    CC01,12                                             0785 02557000
*       /*************************************************************/ 02558000
*       /*                                                           */ 02559000
*       /* IF THE VOLUME CAN BE PROCESSED, PROCESS IT.       @Z40LB30*/ 02560000
*       /*                                                           */ 02561000
*       /*************************************************************/ 02562000
*                                                                  0786 02563000
*       ELSE                        /*                       @Z40LB30*/ 02564000
*         DO;                       /*                       @Z40LB30*/ 02565000
*                                                                  0786 02566000
         B     @RC00784                                            0786 02567000
@RF00784 DS    0H                                                  0787 02568000
*           /*********************************************************/ 02569000
*           /*                                                       */ 02570000
*           /* CALL PROCVOL TO PROCESS THE VOLUME. SAVE      @Z40LB30*/ 02571000
*           /* THE RETURN CODE. ACCUMULATE THE HIGHEST       @Z40LB30*/ 02572000
*           /* RETURN CODE IN THE INTERNAL CONDITION         @Z40LB30*/ 02573000
*           /* CODE AREA.                                    @Z40LB30*/ 02574000
*           /*                                                       */ 02575000
*           /*********************************************************/ 02576000
*                                                                  0787 02577000
*           CALL PROCVOL;           /*                       @Z40LB30*/ 02578000
         BAL   @14,PROCVOL                                         0787 02579000
*           RESPECIFY                                              0788 02580000
*             RTNREG RSTD;                                         0788 02581000
*           TESTRC=RTNREG;                                         0789 02582000
         LR    TESTRC,RTNREG                                       0789 02583000
*           RESPECIFY                                              0790 02584000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 02585000
*           CC01=MAX(CC01,TESTRC);  /*                       @Z40LB30*/ 02586000
*                                                                  0791 02587000
         CR    CC01,TESTRC                                         0791 02588000
         BNL   *+6                                                      02589000
         LR    CC01,TESTRC                                         0791 02590000
*           /*********************************************************/ 02591000
*           /*                                                       */ 02592000
*           /* IF THE RETURN CODE INDICATES THE VOLUME       @Z40LB30*/ 02593000
*           /* WAS PROCESSED, SET AN INDICATOR.              @Z40LB30*/ 02594000
*           /*                                                       */ 02595000
*           /*********************************************************/ 02596000
*                                                                  0792 02597000
*           IF TESTRC<LASTCC12 THEN /*                       @Z40LB30*/ 02598000
         C     TESTRC,@CF00035                                     0792 02599000
         BNL   @RF00792                                            0792 02600000
*             ONEDONE=ON;           /*                       @Z40LB30*/ 02601000
         OI    ONEDONE,B'10000000'                                 0793 02602000
*         END;                      /*                       @Z40LB30*/ 02603000
*                                                                  0794 02604000
@RF00792 DS    0H                                                  0795 02605000
*       /*************************************************************/ 02606000
*       /*                                                           */ 02607000
*       /* SET THE VOLUME SERIAL IN THE IEZRVVI ARGUMENT     @Z40LB30*/ 02608000
*       /* LIST TO THE SERIAL IN THE CURRENT BASE VOLUME     @Z40LB30*/ 02609000
*       /* RECORD IN PREPARATION FOR READING THE NEXT        @Z40LB30*/ 02610000
*       /* RECORD.                                           @Z40LB30*/ 02611000
*       /*                                                           */ 02612000
*       /*************************************************************/ 02613000
*                                                                  0795 02614000
*       RVVOLUME=BASSERNO;          /*                       @Z40LB30*/ 02615000
@RC00784 L     @02,RVVIPTR                                         0795 02616000
         MVC   RVVOLUME(6,@02),BASSERNO(BASEVPTR)                  0795 02617000
*       RVVSVOL=ON;                 /*                       @Z40LB30*/ 02618000
*                                                                  0796 02619000
         OI    RVVSVOL(@02),B'00000001'                            0796 02620000
*       /*************************************************************/ 02621000
*       /*                                                           */ 02622000
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/ 02623000
*       /* RETURN CODE.                                      @Z40LB30*/ 02624000
*       /*                                                           */ 02625000
*       /*************************************************************/ 02626000
*                                                                  0797 02627000
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*        @Z40LB30*/ 02628000
         L     @02,@PC00001                                        0797 02629000
         ST    @02,@AL00001                                        0797 02630000
         LA    @15,VVIC                                            0797 02631000
         ST    @15,@AL00001+4                                      0797 02632000
         LA    @15,RVVIPTR                                         0797 02633000
         ST    @15,@AL00001+8                                      0797 02634000
         LA    @15,VVICODE                                         0797 02635000
         ST    @15,@AL00001+12                                     0797 02636000
         MVI   @AL00001+12,X'80'                                   0797 02637000
         L     @15,GDTSSC(,@02)                                    0797 02638000
         LA    @01,@AL00001                                        0797 02639000
         BALR  @14,@15                                             0797 02640000
*       RESPECIFY                                                  0798 02641000
*         RTNREG RSTD;                                             0798 02642000
*       TESTRC=RTNREG;                                             0799 02643000
         LR    TESTRC,RTNREG                                       0799 02644000
*       RESPECIFY                                                  0800 02645000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 02646000
*                                                                  0800 02647000
*       /*************************************************************/ 02648000
*       /*                                                           */ 02649000
*       /* IF THE RETURN CODE INDICATES AN ERROR OCCURRED,   @Z40LB30*/ 02650000
*       /* CALL THE SSCMSG PROCEDURE TO PRINT THE REASON     @Z40LB30*/ 02651000
*       /* CODE AND THEN PRINT MESSAGE IDC2109I TO SAY NO    @Z40LB30*/ 02652000
*       /* MORE VOLUMES COULD BE PROCESSED.                  @Z40LB30*/ 02653000
*       /*                                                           */ 02654000
*       /*************************************************************/ 02655000
*                                                                  0801 02656000
*       IF TESTRC^=0&VVICODE^=NORECORD&/*                    @Z40LB30*/ 02657000
*           VVICODE^=NOACTIVE THEN  /*                       @Z40LB30*/ 02658000
         LTR   TESTRC,TESTRC                                       0801 02659000
         BZ    @RF00801                                            0801 02660000
         L     @02,VVICODE                                         0801 02661000
         C     @02,@CF01517                                        0801 02662000
         BE    @RF00801                                            0801 02663000
         C     @02,@CF01519                                        0801 02664000
         BE    @RF00801                                            0801 02665000
*         DO;                       /*                       @Z40LB30*/ 02666000
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/ 02667000
         LA    @04,VVICODE                                         0803 02668000
         ST    @04,@AL00001                                        0803 02669000
         LA    @01,@AL00001                                        0803 02670000
         BAL   @14,SSCMSG                                          0803 02671000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 02672000
         XC    DARGAREA(76),DARGAREA                               0804 02673000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 02674000
         L     @15,DDSTRU                                          0805 02675000
         MVC   DARGSMOD(3,@15),@CC01475                            0805 02676000
*           DARGSENT=MSG2109I;      /*                       @Z40LB30*/ 02677000
         MVI   DARGSENT(@15),X'41'                                 0806 02678000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 02679000
*                                                                  0807 02680000
         L     @15,@PC00001                                        0807 02681000
         ST    @15,@AL00001                                        0807 02682000
         LA    @14,@CF00117                                        0807 02683000
         ST    @14,@AL00001+4                                      0807 02684000
         LA    @14,DDSTRU                                          0807 02685000
         ST    @14,@AL00001+8                                      0807 02686000
         MVI   @AL00001+8,X'80'                                    0807 02687000
         L     @15,GDTPRT(,@15)                                    0807 02688000
         LA    @01,@AL00001                                        0807 02689000
         BALR  @14,@15                                             0807 02690000
*           /*********************************************************/ 02691000
*           /*                                                       */ 02692000
*           /* SET THE INTERNAL CONDITION CODE.              @Z40LB30*/ 02693000
*           /*                                                       */ 02694000
*           /*********************************************************/ 02695000
*                                                                  0808 02696000
*           CC01=LASTCC12;          /*                       @Z40LB30*/ 02697000
         LA    CC01,12                                             0808 02698000
*         END;                      /*                       @Z40LB30*/ 02699000
*     END;                          /*                       @Z40LB30*/ 02700000
@RF00801 DS    0H                                                  0810 02701000
@DE00779 L     @15,VVICODE                                         0810 02702000
         LTR   @15,@15                                             0810 02703000
         BZ    @DL00779                                            0810 02704000
*                                                                  0811 02705000
*   /*****************************************************************/ 02706000
*   /*                                                               */ 02707000
*   /* IF A RECORD WAS NOT RETURNED BY THE FIRST READ,       @Z40LB30*/ 02708000
*   /* DETERMINE IF IT WAS AN ERROR OR IF THERE ARE NO       @Z40LB30*/ 02709000
*   /* ACTIVE VOLUME RECORDS IN THE INVENTORY.               @Z40LB30*/ 02710000
*   /*                                                               */ 02711000
*   /*****************************************************************/ 02712000
*                                                                  0811 02713000
*   ELSE                            /*                       @Z40LB30*/ 02714000
*                                                                  0811 02715000
*     /***************************************************************/ 02716000
*     /*                                                             */ 02717000
*     /* IF THE RETURN CODE INDICATES NO ACTIVE VOLUME       @Z40LB30*/ 02718000
*     /* RECORDS, PRINT MESSAGE IDC0104I.                    @Z40LB30*/ 02719000
*     /*                                                             */ 02720000
*     /***************************************************************/ 02721000
*                                                                  0811 02722000
*     IF VVICODE=NORECORD|VVICODE=NOACTIVE THEN/*            @Z40LB30*/ 02723000
         B     @RC00778                                            0811 02724000
@RF00778 L     @05,VVICODE                                         0811 02725000
         C     @05,@CF01517                                        0811 02726000
         BE    @RT00811                                            0811 02727000
         C     @05,@CF01519                                        0811 02728000
         BNE   @RF00811                                            0811 02729000
@RT00811 DS    0H                                                  0812 02730000
*       DO;                         /*                       @Z40LB30*/ 02731000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 02732000
         XC    DARGAREA(76),DARGAREA                               0813 02733000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 02734000
         L     @05,DDSTRU                                          0814 02735000
         MVC   DARGSMOD(3,@05),@CC01475                            0814 02736000
*         DARGSENT=MSG0104I;        /*                       @Z40LB30*/ 02737000
         MVI   DARGSENT(@05),X'3C'                                 0815 02738000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 02739000
         L     @05,@PC00001                                        0816 02740000
         ST    @05,@AL00001                                        0816 02741000
         LA    @15,@CF00117                                        0816 02742000
         ST    @15,@AL00001+4                                      0816 02743000
         LA    @15,DDSTRU                                          0816 02744000
         ST    @15,@AL00001+8                                      0816 02745000
         MVI   @AL00001+8,X'80'                                    0816 02746000
         L     @15,GDTPRT(,@05)                                    0816 02747000
         LA    @01,@AL00001                                        0816 02748000
         BALR  @14,@15                                             0816 02749000
*       END;                        /*                       @Z40LB30*/ 02750000
*                                                                  0817 02751000
*   /*****************************************************************/ 02752000
*   /*                                                               */ 02753000
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/ 02754000
*   /* REASON CODE AND PRINT MESSAGE IDC2109I TO SAY NO      @Z40LB30*/ 02755000
*   /* MORE VOLUMES CAN BE PROCESSED.                        @Z40LB30*/ 02756000
*   /*                                                               */ 02757000
*   /*****************************************************************/ 02758000
*                                                                  0818 02759000
*     ELSE                          /*                       @Z40LB30*/ 02760000
*       DO;                         /*                       @Z40LB30*/ 02761000
         B     @RC00811                                            0818 02762000
@RF00811 DS    0H                                                  0819 02763000
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/ 02764000
         LA    @15,VVICODE                                         0819 02765000
         ST    @15,@AL00001                                        0819 02766000
         LA    @01,@AL00001                                        0819 02767000
         BAL   @14,SSCMSG                                          0819 02768000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 02769000
         XC    DARGAREA(76),DARGAREA                               0820 02770000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 02771000
         L     @05,DDSTRU                                          0821 02772000
         MVC   DARGSMOD(3,@05),@CC01475                            0821 02773000
*         DARGSENT=MSG2109I;        /*                       @Z40LB30*/ 02774000
         MVI   DARGSENT(@05),X'41'                                 0822 02775000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 02776000
*                                                                  0823 02777000
         L     @05,@PC00001                                        0823 02778000
         ST    @05,@AL00001                                        0823 02779000
         LA    @15,@CF00117                                        0823 02780000
         ST    @15,@AL00001+4                                      0823 02781000
         LA    @15,DDSTRU                                          0823 02782000
         ST    @15,@AL00001+8                                      0823 02783000
         MVI   @AL00001+8,X'80'                                    0823 02784000
         L     @15,GDTPRT(,@05)                                    0823 02785000
         LA    @01,@AL00001                                        0823 02786000
         BALR  @14,@15                                             0823 02787000
*         /***********************************************************/ 02788000
*         /*                                                         */ 02789000
*         /* SET THE INTERNAL CONDITION CODE TO INDICATE NO  @Z40LB30*/ 02790000
*         /* VOLUMES PROCESSED.                              @Z40LB30*/ 02791000
*         /*                                                         */ 02792000
*         /***********************************************************/ 02793000
*                                                                  0824 02794000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 02795000
         LA    CC01,12                                             0824 02796000
*       END;                        /*                       @Z40LB30*/ 02797000
*                                                                  0826 02798000
*   /*****************************************************************/ 02799000
*   /*                                                               */ 02800000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 02801000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 02802000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF AT LEAST     @Z40LB30*/ 02803000
*   /* ONE VOLUME WAS PROCESSED, LOWER THE FINAL CONDITION   @Z40LB30*/ 02804000
*   /* CODE.                                                 @Z40LB30*/ 02805000
*   /*                                                               */ 02806000
*   /*****************************************************************/ 02807000
*                                                                  0826 02808000
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/ 02809000
@RC00811 DS    0H                                                  0826 02810000
@RC00778 C     CC01,@CF00035                                       0826 02811000
         BNE   @RF00826                                            0826 02812000
         TM    ONEDONE,B'10000000'                                 0826 02813000
         BNO   @RF00826                                            0826 02814000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 02815000
*                                                                  0827 02816000
         LA    CC01,8                                              0827 02817000
*   /*****************************************************************/ 02818000
*   /*                                                               */ 02819000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 02820000
*   /*                                                               */ 02821000
*   /*****************************************************************/ 02822000
*                                                                  0828 02823000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 02824000
@RF00826 LR    @15,CC01                                            0828 02825000
@EL00006 DS    0H                                                  0828 02826000
@EF00006 DS    0H                                                  0828 02827000
@ER00006 L     @14,@SA00006                                        0828 02828000
         BR    @14                                                 0828 02829000
*   END ALLVOLS;                    /*                       @Z40LB30*/ 02830000
*                                                                  0830 02831000
*/********************************************************** @Z40LB30*/ 02832000
*/*                                                          @Z40LB30*/ 02833000
*/* PROCEDURE - RDGRPCHN                                     @Z40LB30*/ 02834000
*/*                                                          @Z40LB30*/ 02835000
*/* FUNCTION - READ THE NEXT ACTIVE AND, OPTIONALLY, GENERAL @Z40LB30*/ 02836000
*/*           USE VOLUME RECORD IN A SPECIFIC GROUP.  IF     @Z40LB30*/ 02837000
*/*           THERE ARE NO ACTIVE AND, OPTIONALLY, GENERAL-  @Z40LB30*/ 02838000
*/*           USE VOLUMES IN THE GROUP, ISSUE MESSAGE        @Z40LB30*/ 02839000
*/*           IDC0105I OR MESSAGE IDC0106I.  IF A CHAIN      @Z40LB30*/ 02840000
*/*           ERROR OCCURS, ISSUE MESSAGE IDC2103I.  IF      @Z40LB30*/ 02841000
*/*           ANY READ ERROR OCCURS, ISSUE MESSAGE IDC2110I. @Z40LB30*/ 02842000
*/*                                                          @Z40LB30*/ 02843000
*/* INPUT - GROUP RECORD. POINTER TO BASE VOLUME RECORD      @Z40LB30*/ 02844000
*/*         (VOLPTR) SET WITH 0 IF NO VOLUME RECORDS HAVE    @Z40LB30*/ 02845000
*/*         BEEN READ YET OR SET WITH THE ADDRESS OF THE     @Z40LB30*/ 02846000
*/*         LAST VOLUME RECORD READ. FUNTION DEFINITION      @Z40LB30*/ 02847000
*/*         TABLE.                                           @Z40LB30*/ 02848000
*/*                                                          @Z40LB30*/ 02849000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/ 02850000
*/*                        4, AN ERROR OCCURRED              @Z40LB30*/ 02851000
*/*                                                          @Z40LB30*/ 02852000
*/*          POINTER TO VOLUME RECORD SET WITH 0 IF NO MORE  @Z40LB30*/ 02853000
*/*          RECORDS ARE IN THE GROUP OR SET WITH ADDRESS    @Z40LB30*/ 02854000
*/*          OF VOLUME RECORD JUST READ                      @Z40LB30*/ 02855000
*/*                                                          @Z40LB30*/ 02856000
*/********************************************************** @Z40LB30*/ 02857000
*                                                                  0830 02858000
*RDGRPCHN:                                                         0830 02859000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 02860000
RDGRPCHN ST    @14,@SA00007                                        0830 02861000
*                                                                  0831 02862000
*   /*****************************************************************/ 02863000
*   /*                                                               */ 02864000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE.    @Z40LB30*/ 02865000
*   /*                                                               */ 02866000
*   /*****************************************************************/ 02867000
*                                                                  0831 02868000
*   OLDERID2=NEWERID2;                                             0831 02869000
         L     @06,@PC00001                                        0831 02870000
         L     @15,GDTTR2(,@06)                                    0831 02871000
         MVC   @TS00001(95),NEWERID2(@15)                          0831 02872000
         MVC   OLDERID2(95,@15),@TS00001                           0831 02873000
*   NEWID2='LDRG';                  /*                       @Z40LB30*/ 02874000
*                                                                  0832 02875000
         MVC   NEWID2(4,@15),@CC01614                              0832 02876000
*   /*****************************************************************/ 02877000
*   /*                                                               */ 02878000
*   /* SET CONDITION CODE TO ZERO AND INITIALIZE INDICATOR   @Z40LB30*/ 02879000
*   /*                                                               */ 02880000
*   /*****************************************************************/ 02881000
*                                                                  0833 02882000
*   CC02=0;                         /*                       @Z40LB30*/ 02883000
         SLR   @15,@15                                             0833 02884000
         LR    CC02,@15                                            0833 02885000
*   NOVOLS=OFF;                     /*                       @Z40LB30*/ 02886000
         NI    NOVOLS,B'11101111'                                  0834 02887000
*                                                                  0835 02888000
*   /*****************************************************************/ 02889000
*   /*                                                               */ 02890000
*   /* IF NO BASE VOLUME RECORDS HAVE BEEN READ YET FOR      @Z40LB30*/ 02891000
*   /* THIS GROUP, CHECK FOR NO VOLUMES IN THE GROUP AND     @Z40LB30*/ 02892000
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST.                 @Z40LB30*/ 02893000
*   /*                                                               */ 02894000
*   /*****************************************************************/ 02895000
*                                                                  0835 02896000
*   IF VOLPTR=NULLPTR THEN          /*                       @Z40LB30*/ 02897000
         C     @15,VOLPTR                                          0835 02898000
         BNE   @RF00835                                            0835 02899000
*     DO;                           /*                       @Z40LB30*/ 02900000
*                                                                  0836 02901000
*       /*************************************************************/ 02902000
*       /*                                                           */ 02903000
*       /* IF GENERAL WAS SPECIFIED, BUT THERE ARE NO        @Z40LB30*/ 02904000
*       /* ACTIVE GENERAL VOLUMES IN THE GROUP, ISSUE        @Z40LB30*/ 02905000
*       /* MESSAGE IDC0106I.                                 @Z40LB30*/ 02906000
*       /*                                                           */ 02907000
*       /*************************************************************/ 02908000
*                                                                  0837 02909000
*       IF ADDR(GENER)^=NULLPTR&GRONGEN=0 THEN/*             @Z40LB30*/ 02910000
         L     @14,@PC00001+4                                      0837 02911000
         C     @15,FDTPTR+76(,@14)                                 0837 02912000
         BE    @RF00837                                            0837 02913000
         L     @14,GROUPPTR                                        0837 02914000
         CH    @15,GRONGEN(,@14)                                   0837 02915000
         BNE   @RF00837                                            0837 02916000
*         DO;                       /*                       @Z40LB30*/ 02917000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 02918000
         XC    DARGAREA(76),DARGAREA                               0839 02919000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 02920000
         L     @15,DDSTRU                                          0840 02921000
         MVC   DARGSMOD(3,@15),@CC01475                            0840 02922000
*           DARGSENT=MSG0106I;      /*                       @Z40LB30*/ 02923000
         MVI   DARGSENT(@15),X'3E'                                 0841 02924000
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB26*/ 02925000
         LA    @14,GROVVGRP(,@14)                                  0842 02926000
         ST    @14,DARGDBP(,@15)                                   0842 02927000
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB26*/ 02928000
         MVC   DARGILP(2,@15),@CH00182                             0843 02929000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 02930000
         ST    @06,@AL00001                                        0844 02931000
         LA    @15,@CF00117                                        0844 02932000
         ST    @15,@AL00001+4                                      0844 02933000
         LA    @15,DDSTRU                                          0844 02934000
         ST    @15,@AL00001+8                                      0844 02935000
         MVI   @AL00001+8,X'80'                                    0844 02936000
         L     @15,GDTPRT(,@06)                                    0844 02937000
         LA    @01,@AL00001                                        0844 02938000
         BALR  @14,@15                                             0844 02939000
*           NOVOLS=ON;              /*                       @Z40LB30*/ 02940000
         OI    NOVOLS,B'00010000'                                  0845 02941000
*         END;                      /*                       @Z40LB30*/ 02942000
*                                                                  0846 02943000
*       /*************************************************************/ 02944000
*       /*                                                           */ 02945000
*       /* IF GENERAL WAS NOT SPECIFIED, BUT THERE ARE NO    @Z40LB30*/ 02946000
*       /* ACTIVE GENERAL OR RESTRICTED VOLUMES IN THE GROUP @Z40LB30*/ 02947000
*       /* ISSUE MESSAGE IDC0105I.                           @Z40LB30*/ 02948000
*       /*                                                           */ 02949000
*       /*************************************************************/ 02950000
*                                                                  0847 02951000
*       IF ADDR(GENER)=NULLPTR&GRONGEN=0&/*                  @Z40LB30*/ 02952000
*           GRONRSTD=0 THEN         /*                       @Z40LB30*/ 02953000
@RF00837 SLR   @06,@06                                             0847 02954000
         L     @15,@PC00001+4                                      0847 02955000
         C     @06,FDTPTR+76(,@15)                                 0847 02956000
         BNE   @RF00847                                            0847 02957000
         L     @15,GROUPPTR                                        0847 02958000
         CH    @06,GRONGEN(,@15)                                   0847 02959000
         BNE   @RF00847                                            0847 02960000
         CH    @06,GRONRSTD(,@15)                                  0847 02961000
         BNE   @RF00847                                            0847 02962000
*         DO;                       /*                       @Z40LB30*/ 02963000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 02964000
         XC    DARGAREA(76),DARGAREA                               0849 02965000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 02966000
         L     @06,DDSTRU                                          0850 02967000
         MVC   DARGSMOD(3,@06),@CC01475                            0850 02968000
*           DARGSENT=MSG0105I;      /*                       @Z40LB30*/ 02969000
         MVI   DARGSENT(@06),X'3D'                                 0851 02970000
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB26*/ 02971000
         LA    @15,GROVVGRP(,@15)                                  0852 02972000
         ST    @15,DARGDBP(,@06)                                   0852 02973000
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB26*/ 02974000
         MVC   DARGILP(2,@06),@CH00182                             0853 02975000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 02976000
         L     @06,@PC00001                                        0854 02977000
         ST    @06,@AL00001                                        0854 02978000
         LA    @15,@CF00117                                        0854 02979000
         ST    @15,@AL00001+4                                      0854 02980000
         LA    @15,DDSTRU                                          0854 02981000
         ST    @15,@AL00001+8                                      0854 02982000
         MVI   @AL00001+8,X'80'                                    0854 02983000
         L     @15,GDTPRT(,@06)                                    0854 02984000
         LA    @01,@AL00001                                        0854 02985000
         BALR  @14,@15                                             0854 02986000
*           NOVOLS=ON;              /*                       @Z40LB30*/ 02987000
         OI    NOVOLS,B'00010000'                                  0855 02988000
*         END;                      /*                       @Z40LB30*/ 02989000
*                                                                  0856 02990000
*       /*************************************************************/ 02991000
*       /*                                                           */ 02992000
*       /* IF THERE ARE SOME VOLUMES IN THE GROUP, SET       @Z40LB30*/ 02993000
*       /* FIELDS IN THE IEZRVVI ARGUMENT LIST TO READ       @Z40LB30*/ 02994000
*       /* VOLUME RECORDS IN THE GROUP.                      @Z40LB30*/ 02995000
*       /*                                                           */ 02996000
*       /*************************************************************/ 02997000
*                                                                  0857 02998000
*       IF NOVOLS=OFF THEN          /*                       @Z40LB30*/ 02999000
@RF00847 TM    NOVOLS,B'00010000'                                  0857 03000000
         BNZ   @RF00857                                            0857 03001000
*         DO;                       /*                       @Z40LB30*/ 03002000
*           VOLRVVI=''B;            /*                       @Z40LB30*/ 03003000
         XC    VOLRVVI(68),VOLRVVI                                 0859 03004000
*           RVVIPTR=ADDR(VOLRVVI);  /*                       @Z40LB30*/ 03005000
         LA    @06,VOLRVVI                                         0860 03006000
         ST    @06,RVVIPTR                                         0860 03007000
*           RVVLNGTH=RVVLEN;        /*                       @Z40LB30*/ 03008000
         LH    @15,RVVLEN                                          0861 03009000
         ST    @15,RVVLNGTH(,@06)                                  0861 03010000
*           RVVCODE=RVVOP;          /*                       @Z40LB30*/ 03011000
         MVI   RVVCODE(@06),X'87'                                  0862 03012000
*           RVVGROUP=GROVVGRP;      /* GROUP NAME            @Z40LB26*/ 03013000
         L     @15,GROUPPTR                                        0863 03014000
         MVC   RVVGROUP(8,@06),GROVVGRP(@15)                       0863 03015000
*           RVVSVOL=ON;             /* VOLUME SPECIFIED      @Z40LB26*/ 03016000
         OI    RVVSVOL(@06),B'00000001'                            0864 03017000
*           RVVOLUME=GROFSN;        /* FIRST VOL IN CHAIN    @Z40LB26*/ 03018000
         MVC   RVVOLUME(6,@06),GROFSN(@15)                         0865 03019000
*           RVVBUFLN=LENGTH(VOLREC);/*                       @Z40LB30*/ 03020000
         MVC   RVVBUFLN(2,@06),@CH01761                            0866 03021000
*           RVVRTBUF=ADDR(VOLREC);  /* ADDRESS OF BUFFER     @Z40LB30*/ 03022000
         LA    @15,VOLREC                                          0867 03023000
         ST    @15,RVVRTBUF(,@06)                                  0867 03024000
*           RVVRDCH=ON;             /* READ CHAIN            @Z40LB30*/ 03025000
         OI    RVVRDCH(@06),B'00100000'                            0868 03026000
*           RVVBVRCD=ON;            /* BASE VOLUME           @Z40LB30*/ 03027000
         OI    RVVBVRCD(@06),B'10000000'                           0869 03028000
*           RVVGPVOL=ON;            /* GROUPED CHAIN         @Z40LB30*/ 03029000
         OI    RVVGPVOL(@06),B'10000000'                           0870 03030000
*           RVVACTV=ON;             /* ONLY ACTIVE VOLUMES   @Z40LB30*/ 03031000
         OI    RVVACTV(@06),B'00000100'                            0871 03032000
*           RVVSGRP=ON;             /* GROUP NAME SPECIFIED  @Z40LB30*/ 03033000
*                                                                  0872 03034000
         OI    RVVSGRP(@06),B'10000000'                            0872 03035000
*           /*********************************************************/ 03036000
*           /*                                                       */ 03037000
*           /* IF ONLY GENERAL VOLUMES REQUESTED ON THE      @Z40LB30*/ 03038000
*           /* COMMAND, SPECIFY THAT.                        @Z40LB30*/ 03039000
*           /*                                                       */ 03040000
*           /*********************************************************/ 03041000
*                                                                  0873 03042000
*           IF ADDR(GENER)^=NULLPTR THEN/*                   @Z40LB30*/ 03043000
         L     @15,@PC00001+4                                      0873 03044000
         L     @15,FDTPTR+76(,@15)                                 0873 03045000
         LTR   @15,@15                                             0873 03046000
         BZ    @RF00873                                            0873 03047000
*             RVVGSVOL=ON;          /*                       @Z40LB30*/ 03048000
         OI    RVVGSVOL(@06),B'00100000'                           0874 03049000
*         END;                      /*                       @Z40LB30*/ 03050000
*                                                                  0875 03051000
@RF00873 DS    0H                                                  0876 03052000
*       /*************************************************************/ 03053000
*       /*                                                           */ 03054000
*       /* IF THERE ARE NO VOLUMES TO BE PROCESSED IN THIS   @Z40LB26*/ 03055000
*       /* GROUP, SET AN INDICATOR SO THE FINAL CONDITION    @Z40LB26*/ 03056000
*       /* CODE CAN BE SET TO REFLECT ONE GROUP WAS          @Z40LB26*/ 03057000
*       /* PROCESSED.                                        @Z40LB26*/ 03058000
*       /*                                                           */ 03059000
*       /*************************************************************/ 03060000
*                                                                  0876 03061000
*       IF NOVOLS=ON THEN           /*                       @Z40LB26*/ 03062000
@RF00857 TM    NOVOLS,B'00010000'                                  0876 03063000
         BNO   @RF00876                                            0876 03064000
*         EMPTYGRP=ON;              /*                       @Z40LB26*/ 03065000
         OI    EMPTYGRP,B'00001000'                                0877 03066000
*     END;                          /*                       @Z40LB30*/ 03067000
*                                                                  0879 03068000
*   /*****************************************************************/ 03069000
*   /*                                                               */ 03070000
*   /* IF A BASE VOLUME RECORD IN THIS GROUP HAS BEEN READ   @Z40LB30*/ 03071000
*   /* PREVIOUSLY, CHECK IF THERE ARE ANY MORE VOLUMES IN    @Z40LB30*/ 03072000
*   /* THE GROUP.                                            @Z40LB30*/ 03073000
*   /*                                                               */ 03074000
*   /*****************************************************************/ 03075000
*                                                                  0879 03076000
*   ELSE                            /*                       @Z40LB30*/ 03077000
*                                                                  0879 03078000
*     /***************************************************************/ 03079000
*     /*                                                             */ 03080000
*     /* NO MORE VOLUMES                                     @Z40LB30*/ 03081000
*     /*                                                             */ 03082000
*     /***************************************************************/ 03083000
*                                                                  0879 03084000
*     IF BASLAST=ON THEN            /*                       @Z40LB30*/ 03085000
*                                                                  0879 03086000
         B     @RC00835                                            0879 03087000
@RF00835 TM    BASLAST(BASEVPTR),B'00001000'                       0879 03088000
         BNO   @RF00879                                            0879 03089000
*       /*************************************************************/ 03090000
*       /*                                                           */ 03091000
*       /* SET INDICATOR AND ZERO OUT THE POINTER TO THE     @Z40LB30*/ 03092000
*       /* VOLUME RECORD.                                    @Z40LB30*/ 03093000
*       /*                                                           */ 03094000
*       /*************************************************************/ 03095000
*                                                                  0880 03096000
*       DO;                         /*                       @Z40LB30*/ 03097000
*         NOVOLS=ON;                /*                       @Z40LB30*/ 03098000
         OI    NOVOLS,B'00010000'                                  0881 03099000
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/ 03100000
         SLR   @06,@06                                             0882 03101000
         ST    @06,VOLPTR                                          0882 03102000
*       END;                        /*                       @Z40LB30*/ 03103000
*                                                                  0883 03104000
*   /*****************************************************************/ 03105000
*   /*                                                               */ 03106000
*   /* MORE VOLUMES                                          @Z40LB30*/ 03107000
*   /*                                                               */ 03108000
*   /*****************************************************************/ 03109000
*                                                                  0884 03110000
*     ELSE                          /*                       @Z40LB30*/ 03111000
*                                                                  0884 03112000
*       /*************************************************************/ 03113000
*       /*                                                           */ 03114000
*       /* PUT THE NEXT VOLUME SERIAL INTO THE IEZRVVI       @Z40LB30*/ 03115000
*       /* ARGUMENT LIST                                     @Z40LB30*/ 03116000
*       /*                                                           */ 03117000
*       /*************************************************************/ 03118000
*                                                                  0884 03119000
*       DO;                         /*                       @Z40LB30*/ 03120000
         B     @RC00879                                            0884 03121000
@RF00879 DS    0H                                                  0885 03122000
*         RVVIPTR=ADDR(VOLRVVI);    /*                       @Z40LB30*/ 03123000
         LA    @06,VOLRVVI                                         0885 03124000
         ST    @06,RVVIPTR                                         0885 03125000
*         RVVOLUME=BASNEXTV;        /*                       @Z40LB30*/ 03126000
         MVC   RVVOLUME(6,@06),BASNEXTV(BASEVPTR)                  0886 03127000
*       END;                        /*                       @Z40LB30*/ 03128000
*                                                                  0888 03129000
*   /*****************************************************************/ 03130000
*   /*                                                               */ 03131000
*   /* IF THERE ARE MORE VOLUMES IN THE GROUP, READ ONE.     @Z40LB30*/ 03132000
*   /*                                                               */ 03133000
*   /*****************************************************************/ 03134000
*                                                                  0888 03135000
*   IF NOVOLS=OFF THEN              /*                       @Z40LB30*/ 03136000
@RC00879 DS    0H                                                  0888 03137000
@RC00835 TM    NOVOLS,B'00010000'                                  0888 03138000
         BNZ   @RF00888                                            0888 03139000
*     DO;                           /*                       @Z40LB30*/ 03140000
*                                                                  0889 03141000
*       /*************************************************************/ 03142000
*       /*                                                           */ 03143000
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/ 03144000
*       /* RETURN CODE.                                      @Z40LB30*/ 03145000
*       /*                                                           */ 03146000
*       /*************************************************************/ 03147000
*                                                                  0890 03148000
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE2);/*       @Z40LB30*/ 03149000
         L     @06,@PC00001                                        0890 03150000
         ST    @06,@AL00001                                        0890 03151000
         LA    @02,VVIC                                            0890 03152000
         ST    @02,@AL00001+4                                      0890 03153000
         LA    @02,RVVIPTR                                         0890 03154000
         ST    @02,@AL00001+8                                      0890 03155000
         LA    @02,VVICODE2                                        0890 03156000
         ST    @02,@AL00001+12                                     0890 03157000
         MVI   @AL00001+12,X'80'                                   0890 03158000
         L     @15,GDTSSC(,@06)                                    0890 03159000
         LA    @01,@AL00001                                        0890 03160000
         BALR  @14,@15                                             0890 03161000
*       RESPECIFY                                                  0891 03162000
*         RTNREG RSTD;                                             0891 03163000
*       TESTRC=RTNREG;                                             0892 03164000
         LR    TESTRC,RTNREG                                       0892 03165000
*       RESPECIFY                                                  0893 03166000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 03167000
*                                                                  0893 03168000
*       /*************************************************************/ 03169000
*       /*                                                           */ 03170000
*       /* IF NO ERROR, PUT ADDRESS OF RECORD IN POINTER     @Z40LB30*/ 03171000
*       /* AREA FOR CALLER.                                  @Z40LB30*/ 03172000
*       /*                                                           */ 03173000
*       /*************************************************************/ 03174000
*                                                                  0894 03175000
*       IF TESTRC=0 THEN            /*                       @Z40LB30*/ 03176000
         LTR   TESTRC,TESTRC                                       0894 03177000
         BNZ   @RF00894                                            0894 03178000
*         VOLPTR=ADDR(VOLREC);      /*                       @Z40LB30*/ 03179000
         LA    @06,VOLREC                                          0895 03180000
         ST    @06,VOLPTR                                          0895 03181000
*                                                                  0896 03182000
*       /*************************************************************/ 03183000
*       /*                                                           */ 03184000
*       /* IF NO RECORD WAS READ, CHECK FOR ERRORS.          @Z40LB30*/ 03185000
*       /*                                                           */ 03186000
*       /*************************************************************/ 03187000
*                                                                  0896 03188000
*       ELSE                        /*                       @Z40LB30*/ 03189000
*         DO;                       /*                       @Z40LB30*/ 03190000
*                                                                  0896 03191000
         B     @RC00894                                            0896 03192000
@RF00894 DS    0H                                                  0897 03193000
*           /*********************************************************/ 03194000
*           /*                                                       */ 03195000
*           /* SET VOLUME RECORD POINTER TO ZERO.            @Z40LB30*/ 03196000
*           /*                                                       */ 03197000
*           /*********************************************************/ 03198000
*                                                                  0897 03199000
*           VOLPTR=NULLPTR;         /*                       @Z40LB30*/ 03200000
*                                                                  0897 03201000
         SLR   @06,@06                                             0897 03202000
         ST    @06,VOLPTR                                          0897 03203000
*           /*********************************************************/ 03204000
*           /*                                                       */ 03205000
*           /* IF A REAL ERROR OCCURRED, PROCESS IT.         @Z40LB30*/ 03206000
*           /* NO MORE ACTIVE VOLUMES IS NOT AN ERROR.       @Z40LB30*/ 03207000
*           /*                                                       */ 03208000
*           /*********************************************************/ 03209000
*                                                                  0898 03210000
*           IF VVICODE2^=NOACTIVE THEN/*                     @Z40LB30*/ 03211000
         L     @06,VVICODE2                                        0898 03212000
         C     @06,@CF01519                                        0898 03213000
         BE    @RF00898                                            0898 03214000
*             DO;                   /*                       @Z40LB30*/ 03215000
*                                                                  0899 03216000
*               /*****************************************************/ 03217000
*               /*                                                   */ 03218000
*               /* IF CHAINING ERROR, ISSUE MESSAGE IDC2103I @Z40LB30*/ 03219000
*               /*                                                   */ 03220000
*               /*****************************************************/ 03221000
*                                                                  0900 03222000
*               IF VVICODE2=NORECORD|VVICODE2=WRONGCHN/*     @Z40LB30*/ 03223000
*                 THEN              /*                       @Z40LB30*/ 03224000
         C     @06,@CF01517                                        0900 03225000
         BE    @RT00900                                            0900 03226000
         C     @06,@CF01521                                        0900 03227000
         BNE   @RF00900                                            0900 03228000
@RT00900 DS    0H                                                  0901 03229000
*                 DO;               /*                       @Z40LB30*/ 03230000
*                   DARGAREA=''B;   /*                       @Z40LB30*/ 03231000
         XC    DARGAREA(76),DARGAREA                               0902 03232000
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/ 03233000
         L     @15,DDSTRU                                          0903 03234000
         MVC   DARGSMOD(3,@15),@CC01475                            0903 03235000
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/ 03236000
         MVI   DARGSENT(@15),X'3B'                                 0904 03237000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/ 03238000
         L     @15,@PC00001                                        0905 03239000
         ST    @15,@AL00001                                        0905 03240000
         LA    @14,@CF00117                                        0905 03241000
         ST    @14,@AL00001+4                                      0905 03242000
         LA    @14,DDSTRU                                          0905 03243000
         ST    @14,@AL00001+8                                      0905 03244000
         MVI   @AL00001+8,X'80'                                    0905 03245000
         L     @15,GDTPRT(,@15)                                    0905 03246000
         LA    @01,@AL00001                                        0905 03247000
         BALR  @14,@15                                             0905 03248000
*                 END;              /*                       @Z40LB30*/ 03249000
*                                                                  0906 03250000
*               /*****************************************************/ 03251000
*               /*                                                   */ 03252000
*               /* IF ANOTHER ERROR, CALL SSCMSG TO PRINT    @Z40LB30*/ 03253000
*               /* REASON CODE.                              @Z40LB30*/ 03254000
*               /*                                                   */ 03255000
*               /*****************************************************/ 03256000
*                                                                  0907 03257000
*               ELSE                /*                       @Z40LB30*/ 03258000
*                 CALL SSCMSG(VVICODE2);/*                   @Z40LB30*/ 03259000
*                                                                  0907 03260000
         B     @RC00900                                            0907 03261000
@RF00900 LA    @15,VVICODE2                                        0907 03262000
         ST    @15,@AL00001                                        0907 03263000
         LA    @01,@AL00001                                        0907 03264000
         BAL   @14,SSCMSG                                          0907 03265000
*               /*****************************************************/ 03266000
*               /*                                                   */ 03267000
*               /* FOLLOW WITH MESSAGE IDC2110I TO SAY NO    @Z40LB30*/ 03268000
*               /* MORE VOLUMES IN THE GROUP CAN BE          @Z40LB30*/ 03269000
*               /* PROCESSED.                                @Z40LB30*/ 03270000
*               /*                                                   */ 03271000
*               /*****************************************************/ 03272000
*                                                                  0908 03273000
*               DARGAREA=''B;       /*                       @Z40LB30*/ 03274000
@RC00900 XC    DARGAREA(76),DARGAREA                               0908 03275000
*               DARGSMOD=CM0MSG;    /*                       @Z40LB30*/ 03276000
         L     @06,DDSTRU                                          0909 03277000
         MVC   DARGSMOD(3,@06),@CC01475                            0909 03278000
*               DARGSENT=MSG2110I;  /*                       @Z40LB30*/ 03279000
         MVI   DARGSENT(@06),X'42'                                 0910 03280000
*               DARGDBP=ADDR(GROVVGRP);/*                    @Z40LB26*/ 03281000
         L     @01,GROUPPTR                                        0911 03282000
         LA    @15,GROVVGRP(,@01)                                  0911 03283000
         ST    @15,DARGDBP(,@06)                                   0911 03284000
*               DARGILP=LENGTH(GROVVGRP);/*                  @Z40LB26*/ 03285000
         MVC   DARGILP(2,@06),@CH00182                             0912 03286000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/ 03287000
*                                                                  0913 03288000
         L     @06,@PC00001                                        0913 03289000
         ST    @06,@AL00001                                        0913 03290000
         LA    @15,@CF00117                                        0913 03291000
         ST    @15,@AL00001+4                                      0913 03292000
         LA    @15,DDSTRU                                          0913 03293000
         ST    @15,@AL00001+8                                      0913 03294000
         MVI   @AL00001+8,X'80'                                    0913 03295000
         L     @15,GDTPRT(,@06)                                    0913 03296000
         LA    @01,@AL00001                                        0913 03297000
         BALR  @14,@15                                             0913 03298000
*               /*****************************************************/ 03299000
*               /*                                                   */ 03300000
*               /* SET CONDITION CODE                        @Z40LB30*/ 03301000
*               /*                                                   */ 03302000
*               /*****************************************************/ 03303000
*                                                                  0914 03304000
*               CC02=4;             /*                       @Z40LB30*/ 03305000
         LA    CC02,4                                              0914 03306000
*             END;                  /*                       @Z40LB30*/ 03307000
*         END;                      /*                       @Z40LB30*/ 03308000
@RF00898 DS    0H                                                  0917 03309000
*     END;                          /*                       @Z40LB30*/ 03310000
*                                                                  0917 03311000
@RC00894 DS    0H                                                  0918 03312000
*   /*****************************************************************/ 03313000
*   /*                                                               */ 03314000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 03315000
*   /*                                                               */ 03316000
*   /*****************************************************************/ 03317000
*                                                                  0918 03318000
*   RETURN CODE(CC02);              /*                       @Z40LB30*/ 03319000
@RF00888 LR    @15,CC02                                            0918 03320000
@EL00007 DS    0H                                                  0918 03321000
@EF00007 DS    0H                                                  0918 03322000
@ER00007 L     @14,@SA00007                                        0918 03323000
         BR    @14                                                 0918 03324000
*   END RDGRPCHN;                   /*                       @Z40LB30*/ 03325000
*                                                                  0920 03326000
*/*********************************************************  @Z40LB26*/ 03327000
*/*                                                          @Z40LB26*/ 03328000
*/* PROCEDURE - CKRECOV                                      @Z40LB26*/ 03329000
*/*                                                          @Z40LB26*/ 03330000
*/* FUNCTION -  CHECKS EACH BASE VOLUME RECORD READ FROM THE @Z40LB26*/ 03331000
*/*             MSVI TO SEE IF ANY OF THE RECOVERY FLAGS ARE @Z40LB26*/ 03332000
*/*             ON.  IF ANY ARE ON, THE VOLUME CANNOT BE     @Z40LB26*/ 03333000
*/*             PROCESSED.  MESSAGES ISSUED IF RECOVERY      @Z40LB26*/ 03334000
*/*             FLAGS ARE ON INCLUDE IDC2095I, IDC2096I,     @Z40LB26*/ 03335000
*/*             IDC2097I AND IDC2108I.                       @Z40LB26*/ 03336000
*/*                                                          @Z40LB26*/ 03337000
*/* INPUT - BASE VOLUME RECORD FROM THE MSVI.                @Z40LB26*/ 03338000
*/*                                                          @Z40LB26*/ 03339000
*/* OUTPUT - REGISTER 15 - 0, VOLUME OK TO USE               @Z40LB26*/ 03340000
*/*                       12, VOLUME IS NOT USABLE           @Z40LB26*/ 03341000
*/*                                                          @Z40LB26*/ 03342000
*/*********************************************************  @Z40LB26*/ 03343000
*                                                                  0920 03344000
*CKRECOV:                                                          0920 03345000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 03346000
CKRECOV  ST    @14,@SA00008                                        0920 03347000
*                                                                  0921 03348000
*   /*****************************************************************/ 03349000
*   /*                                                               */ 03350000
*   /* ESTABLISH A TRACE POINT                               @Z40LB26*/ 03351000
*   /*                                                               */ 03352000
*   /*****************************************************************/ 03353000
*                                                                  0921 03354000
*   OLDERID2=NEWERID2;                                             0921 03355000
         L     @06,@PC00001                                        0921 03356000
         L     @15,GDTTR2(,@06)                                    0921 03357000
         MVC   @TS00001(95),NEWERID2(@15)                          0921 03358000
         MVC   OLDERID2(95,@15),@TS00001                           0921 03359000
*   NEWID2='LDCK';                  /*                       @Z40LB26*/ 03360000
*                                                                  0922 03361000
         MVC   NEWID2(4,@15),@CC01618                              0922 03362000
*   /*****************************************************************/ 03363000
*   /*                                                               */ 03364000
*   /* INITIALIZE INTERNAL CONDITION CODE                    @Z40LB26*/ 03365000
*   /*                                                               */ 03366000
*   /*****************************************************************/ 03367000
*                                                                  0923 03368000
*   CC02=LASTCC00;                  /*                       @Z40LB26*/ 03369000
*                                                                  0923 03370000
         SLR   CC02,CC02                                           0923 03371000
*   /*****************************************************************/ 03372000
*   /*                                                               */ 03373000
*   /* CHECK BASE VOLUME RECORD TO SEE IF ANY RECOVERY       @Z40LB26*/ 03374000
*   /* FLAGS ARE ON.                                         @Z40LB26*/ 03375000
*   /* IF VOLUME WAS INCOMPLETELY RENAMED, ISSUE MESSAGE     @Z40LB26*/ 03376000
*   /* IDC2095I AND SET CONDITION CODE.                      @Z40LB26*/ 03377000
*   /*                                                               */ 03378000
*   /*****************************************************************/ 03379000
*                                                                  0924 03380000
*   IF BASVSMIS=ON THEN             /*                       @Z40LB26*/ 03381000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0924 03382000
         BNO   @RF00924                                            0924 03383000
*     DO;                           /*                       @Z40LB26*/ 03384000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 03385000
         XC    DARGAREA(76),DARGAREA                               0926 03386000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/ 03387000
         L     @15,DDSTRU                                          0927 03388000
         MVC   DARGSMOD(3,@15),@CC01475                            0927 03389000
*       DARGSENT=MSG2095I;          /*                       @Z40LB26*/ 03390000
         MVI   DARGSENT(@15),X'09'                                 0928 03391000
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/ 03392000
         LA    @14,BASSERNO(,BASEVPTR)                             0929 03393000
         ST    @14,DARGDBP(,@15)                                   0929 03394000
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/ 03395000
         MVC   DARGILP(2,@15),@CH00159                             0930 03396000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 03397000
         ST    @06,@AL00001                                        0931 03398000
         LA    @15,@CF00117                                        0931 03399000
         ST    @15,@AL00001+4                                      0931 03400000
         LA    @15,DDSTRU                                          0931 03401000
         ST    @15,@AL00001+8                                      0931 03402000
         MVI   @AL00001+8,X'80'                                    0931 03403000
         L     @15,GDTPRT(,@06)                                    0931 03404000
         LA    @01,@AL00001                                        0931 03405000
         BALR  @14,@15                                             0931 03406000
*       CC02=LASTCC12;              /*                       @Z40LB26*/ 03407000
         LA    CC02,12                                             0932 03408000
*     END;                          /*                       @Z40LB26*/ 03409000
*                                                                  0933 03410000
*   /*****************************************************************/ 03411000
*   /*                                                               */ 03412000
*   /* IF VOLUME WAS INCOMPLETELY COPIED, ISSUE MESSAGE      @Z40LB26*/ 03413000
*   /* IDC2096I AND SET CONDITION CODE                       @Z40LB26*/ 03414000
*   /*                                                               */ 03415000
*   /*****************************************************************/ 03416000
*                                                                  0934 03417000
*   IF BASIVCPY=ON THEN             /*                       @Z40LB26*/ 03418000
@RF00924 TM    BASIVCPY(BASEVPTR),B'01000000'                      0934 03419000
         BNO   @RF00934                                            0934 03420000
*     DO;                           /*                       @Z40LB26*/ 03421000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 03422000
         XC    DARGAREA(76),DARGAREA                               0936 03423000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/ 03424000
         L     @06,DDSTRU                                          0937 03425000
         MVC   DARGSMOD(3,@06),@CC01475                            0937 03426000
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/ 03427000
         LA    @15,BASSERNO(,BASEVPTR)                             0938 03428000
         ST    @15,DARGDBP(,@06)                                   0938 03429000
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/ 03430000
         MVC   DARGILP(2,@06),@CH00159                             0939 03431000
*       DARGSENT=MSG2096I;          /*                       @Z40LB26*/ 03432000
         MVI   DARGSENT(@06),X'06'                                 0940 03433000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 03434000
         L     @06,@PC00001                                        0941 03435000
         ST    @06,@AL00001                                        0941 03436000
         LA    @15,@CF00117                                        0941 03437000
         ST    @15,@AL00001+4                                      0941 03438000
         LA    @15,DDSTRU                                          0941 03439000
         ST    @15,@AL00001+8                                      0941 03440000
         MVI   @AL00001+8,X'80'                                    0941 03441000
         L     @15,GDTPRT(,@06)                                    0941 03442000
         LA    @01,@AL00001                                        0941 03443000
         BALR  @14,@15                                             0941 03444000
*       CC02=LASTCC12;              /*                       @Z40LB26*/ 03445000
         LA    CC02,12                                             0942 03446000
*     END;                          /*                       @Z40LB26*/ 03447000
*                                                                  0943 03448000
*   /*****************************************************************/ 03449000
*   /*                                                               */ 03450000
*   /* IF BASE VOLUME RECORD HAS THE INCOMPLETE CREATE FLAG  @Z40LB26*/ 03451000
*   /* ON, ISSUE MESSAGE IDC2097I AND SET THE CONDITION CODE.@Z40LB26*/ 03452000
*   /*                                                               */ 03453000
*   /*****************************************************************/ 03454000
*                                                                  0944 03455000
*   IF BASIVCRE=ON THEN             /*                       @Z40LB26*/ 03456000
@RF00934 TM    BASIVCRE(BASEVPTR),B'10000000'                      0944 03457000
         BNO   @RF00944                                            0944 03458000
*     DO;                           /*                       @Z40LB26*/ 03459000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 03460000
         XC    DARGAREA(76),DARGAREA                               0946 03461000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/ 03462000
         L     @06,DDSTRU                                          0947 03463000
         MVC   DARGSMOD(3,@06),@CC01475                            0947 03464000
*       DARGSENT=MSG2097I;          /*                       @Z40LB26*/ 03465000
         MVI   DARGSENT(@06),X'03'                                 0948 03466000
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/ 03467000
         LA    @15,BASSERNO(,BASEVPTR)                             0949 03468000
         ST    @15,DARGDBP(,@06)                                   0949 03469000
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/ 03470000
         MVC   DARGILP(2,@06),@CH00159                             0950 03471000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 03472000
         L     @06,@PC00001                                        0951 03473000
         ST    @06,@AL00001                                        0951 03474000
         LA    @15,@CF00117                                        0951 03475000
         ST    @15,@AL00001+4                                      0951 03476000
         LA    @15,DDSTRU                                          0951 03477000
         ST    @15,@AL00001+8                                      0951 03478000
         MVI   @AL00001+8,X'80'                                    0951 03479000
         L     @15,GDTPRT(,@06)                                    0951 03480000
         LA    @01,@AL00001                                        0951 03481000
         BALR  @14,@15                                             0951 03482000
*       CC02=LASTCC12;              /*                       @Z40LB26*/ 03483000
         LA    CC02,12                                             0952 03484000
*     END;                          /*                       @Z40LB26*/ 03485000
*                                                                  0953 03486000
*   /*****************************************************************/ 03487000
*   /*                                                               */ 03488000
*   /* CHECK TO SEE IF ANY OF THE RECOVERY FLAGS WERE FOUND  @Z40LB26*/ 03489000
*   /* TO BE ON. IF ANY WERE ON, ISSUE SECONDARY MESSAGE     @Z40LB26*/ 03490000
*   /* IDC2108I TO INDICATE THE VOLUME WAS NOT PROCESSED     @Z40LB26*/ 03491000
*   /*                                                               */ 03492000
*   /*****************************************************************/ 03493000
*                                                                  0954 03494000
*   IF CC02^=LASTCC00 THEN          /*                       @Z40LB26*/ 03495000
@RF00944 LTR   CC02,CC02                                           0954 03496000
         BZ    @RF00954                                            0954 03497000
*     DO;                           /*                       @Z40LB26*/ 03498000
*       DARGSENT=MSG2108I;          /*                       @Z40LB26*/ 03499000
         L     @06,DDSTRU                                          0956 03500000
         MVI   DARGSENT(@06),X'40'                                 0956 03501000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 03502000
         L     @06,@PC00001                                        0957 03503000
         ST    @06,@AL00001                                        0957 03504000
         LA    @15,@CF00117                                        0957 03505000
         ST    @15,@AL00001+4                                      0957 03506000
         LA    @15,DDSTRU                                          0957 03507000
         ST    @15,@AL00001+8                                      0957 03508000
         MVI   @AL00001+8,X'80'                                    0957 03509000
         L     @15,GDTPRT(,@06)                                    0957 03510000
         LA    @01,@AL00001                                        0957 03511000
         BALR  @14,@15                                             0957 03512000
*     END;                          /*                       @Z40LB26*/ 03513000
*                                                                  0958 03514000
*   /*****************************************************************/ 03515000
*   /*                                                               */ 03516000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 03517000
*   /*                                                               */ 03518000
*   /*****************************************************************/ 03519000
*                                                                  0959 03520000
*   RETURN CODE(CC02);              /*                       @Z40LB26*/ 03521000
@RF00954 LR    @15,CC02                                            0959 03522000
@EL00008 DS    0H                                                  0959 03523000
@EF00008 DS    0H                                                  0959 03524000
@ER00008 L     @14,@SA00008                                        0959 03525000
         BR    @14                                                 0959 03526000
*   END CKRECOV;                    /*                       @Z40LB26*/ 03527000
*                                                                  0961 03528000
*/********************************************************** @Z40LB26*/ 03529000
*/*                                                          @Z40LB26*/ 03530000
*/* PROCEDURE - SELECTOR                                     @Z40LB26*/ 03531000
*/*                                                          @Z40LB26*/ 03532000
*/* FUNCTION -  CONTROLS SELECTION OF DATA SETS FOR LISTING  @Z40LB26*/ 03533000
*/*             ON A PARTICULAR VOLUME.  IF THERE ARE NO     @Z40LB26*/ 03534000
*/*             DATA SETS ELIGIBLE FOR SELECTION ON VOLUME,  @Z40LB26*/ 03535000
*/*             ISSUE PRIMARY MESSAGE IDC0107I.  IF THE      @Z40LB26*/ 03536000
*/*             VOLUME CANNOT BE PROCESSED, ISSUE SECONDARY  @Z40LB26*/ 03537000
*/*             MESSAGE IDC2108I.                            @Z40LB26*/ 03538000
*/*                                                          @Z40LB26*/ 03539000
*/* INPUT - BASE VOLUME RECORD, DDNAME FOR THE VOLUME,       @Z40LB26*/ 03540000
*/*         RE-FORMATED CREATION AND EXPIRATION DATES        @Z40LB26*/ 03541000
*/*         IF SPECIFIED, FUNCTIONAL DATA TABLE, AND         @Z40LB26*/ 03542000
*/*         UCB ADDRESS FOR EITHER A UNIQUE DD CARD TO BE    @Z40LB26*/ 03543000
*/*         USED OR FOR THE FILE PARAMETER DD                @Z40LB26*/ 03544000
*/*                                                          @Z40LB26*/ 03545000
*/* OUTPUT - REGISTER 15 = 0, NO ERROR                       @Z40LB26*/ 03546000
*/*                        4, VTOC CLOSE ERROR               @Z40LB26*/ 03547000
*/*                        8, AN ERROR OCCURRED, BUT THE     @Z40LB26*/ 03548000
*/*                           LIST OF ELIGIBLE DATA SETS     @Z40LB26*/ 03549000
*/*                           IS TO BE PROCESSED             @Z40LB26*/ 03550000
*/*                       12, NO LIST OF ELIGIBLE DATA SETS  @Z40LB26*/ 03551000
*/*                           RETURNED DUE TO ERROR          @Z40LB26*/ 03552000
*/*                                                          @Z40LB26*/ 03553000
*/*          LISTADDR SET TO 0 IF NO LIST OF DATA SETS       @Z40LB26*/ 03554000
*/*                   SET TO ADDRESS OF LIST OF DATA SETS    @Z40LB26*/ 03555000
*/*                                                          @Z40LB26*/ 03556000
*/********************************************************** @Z40LB26*/ 03557000
*                                                                  0961 03558000
*SELECTOR:                                                         0961 03559000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 03560000
SELECTOR ST    @14,@SA00009                                        0961 03561000
*                                                                  0962 03562000
*   /*****************************************************************/ 03563000
*   /*                                                               */ 03564000
*   /* ESTABLISH A TRACE POINT                               @Z40LB26*/ 03565000
*   /*                                                               */ 03566000
*   /*****************************************************************/ 03567000
*                                                                  0962 03568000
*   OLDERID2=NEWERID2;                                             0962 03569000
         L     @07,@PC00001                                        0962 03570000
         L     @07,GDTTR2(,@07)                                    0962 03571000
         MVC   @TS00001(95),NEWERID2(@07)                          0962 03572000
         MVC   OLDERID2(95,@07),@TS00001                           0962 03573000
*   NEWID2='LDSL';                  /*                       @Z40LB26*/ 03574000
*                                                                  0963 03575000
         MVC   NEWID2(4,@07),@CC01623                              0963 03576000
*   /*****************************************************************/ 03577000
*   /*                                                               */ 03578000
*   /* ZERO INTERNAL CONDITION CODE                          @Z40LB26*/ 03579000
*   /*                                                               */ 03580000
*   /*****************************************************************/ 03581000
*                                                                  0964 03582000
*   CC03=LASTCC00;                  /*                       @Z40LB26*/ 03583000
         SLR   @15,@15                                             0964 03584000
         LR    CC03,@15                                            0964 03585000
*                                                                  0965 03586000
*   /*****************************************************************/ 03587000
*   /*                                                               */ 03588000
*   /* CHECK TO SEE IF ARGUMENT LIST IS ALREADY SET UP FOR   @Z40LB26*/ 03589000
*   /* IDCVS03 AND INITIALIZE IT IF IT HASN'T ALREADY BEEN.  @Z40LB26*/ 03590000
*   /*                                                               */ 03591000
*   /*****************************************************************/ 03592000
*                                                                  0965 03593000
*   IF INITVS3=OFF THEN             /*                       @Z40LB26*/ 03594000
         TM    INITVS3,B'01000000'                                 0965 03595000
         BNZ   @RF00965                                            0965 03596000
*     DO;                           /*                       @Z40LB26*/ 03597000
*       INITVS3=ON;                 /*                       @Z40LB26*/ 03598000
         OI    INITVS3,B'01000000'                                 0967 03599000
*       VS3AGL=''B;                 /* CLEAR IT              @Z40LB26*/ 03600000
         LA    @07,AREAVS3                                         0968 03601000
         XC    VS3AGL(59,@07),VS3AGL(@07)                          0968 03602000
*       VS3LISTP=ADDR(LISTADDR);    /* ADDR OF LIST PTR      @Z40LB26*/ 03603000
         LA    @14,LISTADDR                                        0969 03604000
         ST    @14,VS3LISTP(,@07)                                  0969 03605000
*       VS3POOL=POOLID;             /* STORAGE POOL ID       @Z40LB26*/ 03606000
         MVC   VS3POOL(4,@07),@CC01511                             0970 03607000
*       VS3DEV=DEV3330V;            /* VIRTUAL DEVICE TYPE   @Z40LB26*/ 03608000
*                                                                  0971 03609000
         MVC   VS3DEV(4,@07),@CB01515                              0971 03610000
*       /*************************************************************/ 03611000
*       /*                                                           */ 03612000
*       /* CHECK TO SEE IF LEVEL PARAMETER WAS SPECIFIED     @Z40LB26*/ 03613000
*       /*                                                           */ 03614000
*       /*************************************************************/ 03615000
*                                                                  0972 03616000
*       IF ADDR(LEVEL)^=NULLPTR THEN/*                       @Z40LB26*/ 03617000
         L     @14,@PC00001+4                                      0972 03618000
         L     @14,FDTPTR+20(,@14)                                 0972 03619000
         CR    @14,@15                                             0972 03620000
         BE    @RF00972                                            0972 03621000
*         DO;                       /*                       @Z40LB26*/ 03622000
*                                                                  0973 03623000
*           /*********************************************************/ 03624000
*           /*                                                       */ 03625000
*           /* INITIALIZE VALUES FROM FDT                    @Z40LB26*/ 03626000
*           /*                                                       */ 03627000
*           /*********************************************************/ 03628000
*                                                                  0974 03629000
*           VS3LEVP=ADDR(LEVELVAL); /*                       @Z40LB26*/ 03630000
         LA    @15,LEVELVAL(,@14)                                  0974 03631000
         ST    @15,VS3LEVP(,@07)                                   0974 03632000
*           VS3LEVLN=LEVELLEN;      /*                       @Z40LB26*/ 03633000
         SLR   @15,@15                                             0975 03634000
         IC    @15,LEVELLEN(,@14)                                  0975 03635000
         STH   @15,VS3LEVLN(,@07)                                  0975 03636000
*           VS3AST=LEVELPOS;        /*                       @Z40LB26*/ 03637000
         SLR   @15,@15                                             0976 03638000
         IC    @15,LEVELPOS(,@14)                                  0976 03639000
         STH   @15,VS3AST(,@07)                                    0976 03640000
*         END;                      /*                       @Z40LB26*/ 03641000
*                                                                  0977 03642000
*       /*************************************************************/ 03643000
*       /*                                                           */ 03644000
*       /* CHECK TO SEE IF EXPIRATION OR CREATION DATES      @Z40LB26*/ 03645000
*       /* WERE SPECIFIED. IF SPECIFIED, SET IN VS3AGL.      @Z40LB26*/ 03646000
*       /*                                                           */ 03647000
*       /*************************************************************/ 03648000
*                                                                  0978 03649000
*       IF ADDR(EXPDT)^=NULLPTR|ADDR(EXPIR)^=NULLPTR/*       @Z40LB26*/ 03650000
*         THEN                      /*                       @Z40LB26*/ 03651000
@RF00972 SLR   @07,@07                                             0978 03652000
         L     @15,@PC00001+4                                      0978 03653000
         C     @07,FDTPTR+28(,@15)                                 0978 03654000
         BNE   @RT00978                                            0978 03655000
         C     @07,FDTPTR+32(,@15)                                 0978 03656000
         BE    @RF00978                                            0978 03657000
@RT00978 DS    0H                                                  0979 03658000
*         VS3EXPIR=ADDR(EXPDATE);   /*                       @Z40LB26*/ 03659000
         LA    @07,AREAVS3                                         0979 03660000
         LA    @15,EXPDATE                                         0979 03661000
         ST    @15,VS3EXPIR(,@07)                                  0979 03662000
*       IF ADDR(CREDT)^=NULLPTR|ADDR(CREAT)^=NULLPTR/*       @Z40LB26*/ 03663000
*         THEN                      /*                       @Z40LB26*/ 03664000
@RF00978 SLR   @07,@07                                             0980 03665000
         L     @15,@PC00001+4                                      0980 03666000
         C     @07,FDTPTR+36(,@15)                                 0980 03667000
         BNE   @RT00980                                            0980 03668000
         C     @07,FDTPTR+40(,@15)                                 0980 03669000
         BE    @RF00980                                            0980 03670000
@RT00980 DS    0H                                                  0981 03671000
*         VS3CREAT=ADDR(CREDATE);   /*                       @Z40LB26*/ 03672000
*                                                                  0981 03673000
         LA    @07,AREAVS3                                         0981 03674000
         LA    @15,CREDATE                                         0981 03675000
         ST    @15,VS3CREAT(,@07)                                  0981 03676000
*       /*************************************************************/ 03677000
*       /*                                                           */ 03678000
*       /* SET UP TYPE OF REPORT DESIRED                     @Z40LB26*/ 03679000
*       /*                                                           */ 03680000
*       /*************************************************************/ 03681000
*                                                                  0982 03682000
*       IF ADDR(STAT)^=NULLPTR THEN /*                       @Z40LB26*/ 03683000
@RF00980 L     @07,@PC00001+4                                      0982 03684000
         L     @07,FDTPTR+52(,@07)                                 0982 03685000
         LTR   @07,@07                                             0982 03686000
         BZ    @RF00982                                            0982 03687000
*         VS3STAT=ON;               /*                       @Z40LB26*/ 03688000
         LA    @07,AREAVS3                                         0983 03689000
         OI    VS3STAT(@07),B'10000000'                            0983 03690000
*       ELSE                        /*                       @Z40LB26*/ 03691000
*         VS3USAGE=ON;              /*                       @Z40LB26*/ 03692000
*                                                                  0984 03693000
         B     @RC00982                                            0984 03694000
@RF00982 LA    @07,AREAVS3                                         0984 03695000
         OI    VS3USAGE(@07),B'01000000'                           0984 03696000
*       /*************************************************************/ 03697000
*       /*                                                           */ 03698000
*       /* CHECK IF UNCATALOGED SPECIFIED                    @Z40LB26*/ 03699000
*       /*                                                           */ 03700000
*       /*************************************************************/ 03701000
*                                                                  0985 03702000
*       IF ADDR(UNCAT)^=NULLPTR THEN/*                       @Z40LB26*/ 03703000
@RC00982 L     @07,@PC00001+4                                      0985 03704000
         L     @07,FDTPTR+24(,@07)                                 0985 03705000
         LTR   @07,@07                                             0985 03706000
         BZ    @RF00985                                            0985 03707000
*         VS3UNCAT=ON;              /*                       @Z40LB26*/ 03708000
         LA    @07,AREAVS3                                         0986 03709000
         OI    VS3UNCAT(@07),B'00010000'                           0986 03710000
*     END;                          /*                       @Z40LB26*/ 03711000
*                                                                  0987 03712000
@RF00985 DS    0H                                                  0988 03713000
*   /*****************************************************************/ 03714000
*   /*                                                               */ 03715000
*   /* SET UP FIELDS IN VS03 PARAMETER LIST THAT CHANGE      @Z40LB26*/ 03716000
*   /*                                                               */ 03717000
*   /*****************************************************************/ 03718000
*                                                                  0988 03719000
*   VS3VOL=BASSERNO;                /* VOLUME ID             @Z40LB26*/ 03720000
@RF00965 LA    @07,AREAVS3                                         0988 03721000
         MVC   VS3VOL(6,@07),BASSERNO(BASEVPTR)                    0988 03722000
*   VS3DD=DDNAME;                   /* DDNAME OF DEVICE      @Z40LB26*/ 03723000
         MVC   VS3DD(8,@07),DDNAME                                 0989 03724000
*   LISTADDR=NULLPTR;               /* ZERO ADDRESS OF LIST  @Z40LB26*/ 03725000
*                                                                  0990 03726000
         SLR   @15,@15                                             0990 03727000
         ST    @15,LISTADDR                                        0990 03728000
*   /*****************************************************************/ 03729000
*   /*                                                               */ 03730000
*   /* IF THE UCB ADDRESS WAS RETURNED BY UMSSUNIT SELECTDD  @Z40LB26*/ 03731000
*   /* FUNCTION, SET IT IN THE VS3AGL. IF NOT AND THE FILE   @Z40LB26*/ 03732000
*   /* PARAMETER WAS SPECIFIED, SET THAT UCB ADDRESS IN THE  @Z40LB26*/ 03733000
*   /* VS3AGL. IF THE FILE PARAMETER WAS NOT SPECIFIED       @Z40LB26*/ 03734000
*   /* EITHER, SET THE UCB ADDRESS IN VS3AGL TO ZERO.        @Z40LB26*/ 03735000
*   /*                                                               */ 03736000
*   /*****************************************************************/ 03737000
*                                                                  0991 03738000
*   IF ADDRUCB^=NULLPTR THEN        /*                       @Z40LB26*/ 03739000
         L     @14,ADDRUCB                                         0991 03740000
         CR    @14,@15                                             0991 03741000
         BE    @RF00991                                            0991 03742000
*     VS3UCBP=ADDRUCB;              /*                       @Z40LB26*/ 03743000
         ST    @14,VS3UCBP(,@07)                                   0992 03744000
*   ELSE                            /*                       @Z40LB26*/ 03745000
*     IF ADDR(FILE)^=NULLPTR THEN   /*                       @Z40LB26*/ 03746000
         B     @RC00991                                            0993 03747000
@RF00991 L     @07,@PC00001+4                                      0993 03748000
         L     @07,FDTPTR+44(,@07)                                 0993 03749000
         LTR   @07,@07                                             0993 03750000
         BZ    @RF00993                                            0993 03751000
*       VS3UCBP=FILEUCB;            /*                       @Z40LB26*/ 03752000
         LA    @07,AREAVS3                                         0994 03753000
         L     @15,FILEUCB                                         0994 03754000
         ST    @15,VS3UCBP(,@07)                                   0994 03755000
*     ELSE                          /*                       @Z40LB26*/ 03756000
*       VS3UCBP=NULLPTR;            /*                       @Z40LB26*/ 03757000
*                                                                  0995 03758000
         B     @RC00993                                            0995 03759000
@RF00993 LA    @07,AREAVS3                                         0995 03760000
         SLR   @15,@15                                             0995 03761000
         ST    @15,VS3UCBP(,@07)                                   0995 03762000
*   /*****************************************************************/ 03763000
*   /*                                                               */ 03764000
*   /* CALL IDCVS03 TO SELECT DATA SETS. SAVE THE RETURN     @Z40LB26*/ 03765000
*   /* CODE.                                                 @Z40LB26*/ 03766000
*   /*                                                               */ 03767000
*   /*****************************************************************/ 03768000
*                                                                  0996 03769000
*   CALL IDCSACL0(GDTTBL,'IDCVS03 ',SELECTDS,VS3AGL);/*      @Z40LB26*/ 03770000
@RC00993 DS    0H                                                  0996 03771000
@RC00991 L     @07,@PC00001                                        0996 03772000
         ST    @07,@AL00001                                        0996 03773000
         LA    @02,@CC01624                                        0996 03774000
         ST    @02,@AL00001+4                                      0996 03775000
         LA    @02,SELECTDS                                        0996 03776000
         ST    @02,@AL00001+8                                      0996 03777000
         LA    @02,AREAVS3                                         0996 03778000
         ST    @02,@AL00001+12                                     0996 03779000
         MVI   @AL00001+12,X'80'                                   0996 03780000
         L     @15,GDTCAL(,@07)                                    0996 03781000
         LA    @01,@AL00001                                        0996 03782000
         BALR  @14,@15                                             0996 03783000
*   RESPECIFY                                                      0997 03784000
*     RTNREG RSTD;                                                 0997 03785000
*   TESTRC=RTNREG;                                                 0998 03786000
         LR    TESTRC,RTNREG                                       0998 03787000
*   RESPECIFY                                                      0999 03788000
*     RTNREG UNRSTD;                /*                       @Z40LB26*/ 03789000
*                                                                  0999 03790000
*   /*****************************************************************/ 03791000
*   /*                                                               */ 03792000
*   /* IF SOME ERRORS OCCURRED IN IDCVS03, SET THE INTERNAL  @Z40LB26*/ 03793000
*   /* CONDITION CODE APPROPRIATELY.                         @Z40LB26*/ 03794000
*   /*                                                               */ 03795000
*   /*****************************************************************/ 03796000
*                                                                  1000 03797000
*   IF TESTRC^=0 THEN               /*                       @Z40LB26*/ 03798000
         LTR   TESTRC,TESTRC                                       1000 03799000
         BZ    @RF01000                                            1000 03800000
*     DO;                           /*                       @Z40LB26*/ 03801000
*       IF TESTRC=LASTCC12 THEN     /* VTOC CLOSE ERROR      @Z40LB26*/ 03802000
         C     TESTRC,@CF00035                                     1002 03803000
         BNE   @RF01002                                            1002 03804000
*         CC03=LASTCC04;            /*                       @Z40LB26*/ 03805000
         LA    CC03,4                                              1003 03806000
*       ELSE                        /*                       @Z40LB26*/ 03807000
*         IF TESTRC=LASTCC08 THEN   /*                       @Z40LB26*/ 03808000
         B     @RC01002                                            1004 03809000
@RF01002 LA    @02,8                                               1004 03810000
         CR    TESTRC,@02                                          1004 03811000
         BNE   @RF01004                                            1004 03812000
*           CC03=LASTCC08;          /*                       @Z40LB26*/ 03813000
         LR    CC03,@02                                            1005 03814000
*         ELSE                      /* RETURN OF 4, MAJOR    @Z40LB26   03815000
*                                      ERROR                 @Z40LB26*/ 03816000
*           DO;                     /*                       @Z40LB26*/ 03817000
         B     @RC01004                                            1006 03818000
@RF01004 DS    0H                                                  1007 03819000
*             CC03=LASTCC12;        /*                       @Z40LB26*/ 03820000
*                                                                  1007 03821000
         LA    CC03,12                                             1007 03822000
*             /*******************************************************/ 03823000
*             /*                                                     */ 03824000
*             /* ISSUE SECONDARY MESSAGE, UNABLE TO          @Z40LB26*/ 03825000
*             /* PROCESS VOLUME.                             @Z40LB26*/ 03826000
*             /*                                                     */ 03827000
*             /*******************************************************/ 03828000
*                                                                  1008 03829000
*             DARGAREA=''B;         /*                       @Z40LB26*/ 03830000
         XC    DARGAREA(76),DARGAREA                               1008 03831000
*             DARGSMOD=CM0MSG;      /*                       @Z40LB26*/ 03832000
         L     @07,DDSTRU                                          1009 03833000
         MVC   DARGSMOD(3,@07),@CC01475                            1009 03834000
*             DARGSENT=MSG2108I;    /*                       @Z40LB26*/ 03835000
         MVI   DARGSENT(@07),X'40'                                 1010 03836000
*             DARGDBP=ADDR(BASSERNO);/*                      @Z40LB26*/ 03837000
         LA    @15,BASSERNO(,BASEVPTR)                             1011 03838000
         ST    @15,DARGDBP(,@07)                                   1011 03839000
*             DARGILP=LENGTH(BASSERNO);/*                    @Z40LB26*/ 03840000
         MVC   DARGILP(2,@07),@CH00159                             1012 03841000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB26*/ 03842000
*                                                                  1013 03843000
         L     @07,@PC00001                                        1013 03844000
         ST    @07,@AL00001                                        1013 03845000
         LA    @15,@CF00117                                        1013 03846000
         ST    @15,@AL00001+4                                      1013 03847000
         LA    @15,DDSTRU                                          1013 03848000
         ST    @15,@AL00001+8                                      1013 03849000
         MVI   @AL00001+8,X'80'                                    1013 03850000
         L     @15,GDTPRT(,@07)                                    1013 03851000
         LA    @01,@AL00001                                        1013 03852000
         BALR  @14,@15                                             1013 03853000
*             /*******************************************************/ 03854000
*             /*                                                     */ 03855000
*             /* FREE SECOND PCT BEFORE ISSUING NEXT UESTA   @ZM01118*/ 03856000
*             /*                                                     */ 03857000
*             /*******************************************************/ 03858000
*                                                                  1014 03859000
*             CALL AMSTP044(GDTTBL,PRINTIT);/*               @ZM01118*/ 03860000
         L     @07,@PC00001                                        1014 03861000
         ST    @07,@AL00001                                        1014 03862000
         LA    @15,PRINTIT                                         1014 03863000
         ST    @15,@AL00001+4                                      1014 03864000
         MVI   @AL00001+4,X'80'                                    1014 03865000
         L     @15,GDTRES(,@07)                                    1014 03866000
         LA    @01,@AL00001                                        1014 03867000
         BALR  @14,@15                                             1014 03868000
*           END;                    /*                       @Z40LB26*/ 03869000
*     END;                          /*                       @Z40LB26*/ 03870000
*                                                                  1016 03871000
*   /*****************************************************************/ 03872000
*   /*                                                               */ 03873000
*   /* IF GOOD RETURN CODE FROM IDCVS03, CHECK TO SEE IF ANY @Z40LB26*/ 03874000
*   /* DATA SETS RETURNED. IF NONE ELIGIBLE, ISSUE MESSAGE.  @Z40LB26*/ 03875000
*   /*                                                               */ 03876000
*   /*****************************************************************/ 03877000
*                                                                  1017 03878000
*   ELSE                            /*                       @Z40LB26*/ 03879000
*     IF VSDELEM=0 THEN             /*                       @Z40LB26*/ 03880000
         B     @RC01000                                            1017 03881000
@RF01000 L     @07,LISTADDR                                        1017 03882000
         L     @07,VSDELEM(,@07)                                   1017 03883000
         LTR   @07,@07                                             1017 03884000
         BNZ   @RF01017                                            1017 03885000
*       DO;                         /*                       @Z40LB26*/ 03886000
*         DARGAREA=''B;             /*                       @Z40LB26*/ 03887000
         XC    DARGAREA(76),DARGAREA                               1019 03888000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB26*/ 03889000
         L     @07,DDSTRU                                          1020 03890000
         MVC   DARGSMOD(3,@07),@CC01475                            1020 03891000
*         DARGSENT=MSG0107I;        /*                       @Z40LB26*/ 03892000
         MVI   DARGSENT(@07),X'3F'                                 1021 03893000
*         DARGDBP=ADDR(BASSERNO);   /*                       @Z40LB26*/ 03894000
         LA    @15,BASSERNO(,BASEVPTR)                             1022 03895000
         ST    @15,DARGDBP(,@07)                                   1022 03896000
*         DARGILP=LENGTH(BASSERNO); /*                       @Z40LB26*/ 03897000
         MVC   DARGILP(2,@07),@CH00159                             1023 03898000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB26*/ 03899000
         L     @07,@PC00001                                        1024 03900000
         ST    @07,@AL00001                                        1024 03901000
         LA    @15,@CF00117                                        1024 03902000
         ST    @15,@AL00001+4                                      1024 03903000
         LA    @15,DDSTRU                                          1024 03904000
         ST    @15,@AL00001+8                                      1024 03905000
         MVI   @AL00001+8,X'80'                                    1024 03906000
         L     @15,GDTPRT(,@07)                                    1024 03907000
         LA    @01,@AL00001                                        1024 03908000
         BALR  @14,@15                                             1024 03909000
*       END;                        /*                       @Z40LB26*/ 03910000
*                                                                  1025 03911000
*   /*****************************************************************/ 03912000
*   /*                                                               */ 03913000
*   /* IF THERE IS A DATA SET LIST, SORT IT.                 @Z40LB26*/ 03914000
*   /*                                                               */ 03915000
*   /*****************************************************************/ 03916000
*                                                                  1026 03917000
*   IF CC03<LASTCC12&VSDELEM^=0 THEN/*                       @Z40LB26*/ 03918000
@RF01017 DS    0H                                                  1026 03919000
@RC01000 C     CC03,@CF00035                                       1026 03920000
         BNL   @RF01026                                            1026 03921000
         L     @07,LISTADDR                                        1026 03922000
         L     @15,VSDELEM(,@07)                                   1026 03923000
         LTR   @15,@15                                             1026 03924000
         BZ    @RF01026                                            1026 03925000
*     DO;                           /*                       @Z40LB26*/ 03926000
*                                                                  1027 03927000
*       /*************************************************************/ 03928000
*       /*                                                           */ 03929000
*       /* SET UP PARAMETER LIST FOR SORT                    @Z40LB26*/ 03930000
*       /*                                                           */ 03931000
*       /*************************************************************/ 03932000
*                                                                  1028 03933000
*       SRTAGL=''B;                 /*                       @Z40LB26*/ 03934000
         LA    @14,SORTAREA                                        1028 03935000
         XC    SRTAGL(32,@14),SRTAGL(@14)                          1028 03936000
*       SRTADDR=ADDR(VSDARRAY(1));  /*                       @Z40LB26*/ 03937000
         LA    @03,VSDARRAY(,@07)                                  1029 03938000
         ST    @03,SRTADDR(,@14)                                   1029 03939000
*       SRTNUM=VSDELEM;             /*                       @Z40LB26*/ 03940000
         ST    @15,SRTNUM(,@14)                                    1030 03941000
*       SRTPOSIT=ADDR(VSDDSN(1))-ADDR(VSDARRAY(1))+1;/*      @Z40LB26*/ 03942000
         LA    @07,VSDDSN(,@07)                                    1031 03943000
         SLR   @07,@03                                             1031 03944000
         AL    @07,@CF00222                                        1031 03945000
         ST    @07,SRTPOSIT(,@14)                                  1031 03946000
*       SRTFLDLN=LENGTH(VSDDSN(1)); /*                       @Z40LB26*/ 03947000
         MVC   SRTFLDLN(4,@14),@CF00849                            1032 03948000
*       SRTWORKP=ADDR(SORTWORK);    /*                       @Z40LB26*/ 03949000
         LA    @07,SORTWORK                                        1033 03950000
         ST    @07,SRTWORKP(,@14)                                  1033 03951000
*       SRTLEN=LENGTH(VSDARRAY(1)); /*                       @Z40LB26*/ 03952000
         MVC   SRTLEN(4,@14),@CF01764                              1034 03953000
*       CALL SORT(SRTAGL);          /*                       @Z40LB26*/ 03954000
         ST    @14,@AL00001                                        1035 03955000
         LA    @01,@AL00001                                        1035 03956000
         BAL   @14,SORT                                            1035 03957000
*     END;                          /*                       @Z40LB26*/ 03958000
*                                                                  1037 03959000
*   /*****************************************************************/ 03960000
*   /*                                                               */ 03961000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 03962000
*   /*                                                               */ 03963000
*   /*****************************************************************/ 03964000
*                                                                  1037 03965000
*   RETURN CODE(CC03);              /*                       @Z40LB26*/ 03966000
@RF01026 LR    @15,CC03                                            1037 03967000
@EL00009 DS    0H                                                  1037 03968000
@EF00009 DS    0H                                                  1037 03969000
@ER00009 L     @14,@SA00009                                        1037 03970000
         BR    @14                                                 1037 03971000
*   END SELECTOR;                   /*                       @Z40LB26*/ 03972000
*                                                                  1039 03973000
*/********************************************************************/ 03974000
*/*                                                                  */ 03975000
*/* PROCEDURE NAME - SORT  (ACCESS METHOD SERVICES)          @Z40LB37*/ 03976000
*/*                                                          @Z40LB37*/ 03977000
*/* FUNCTION - THIS COMMON INCLUDED PROCEDURE PROVIDES THE   @Z40LB37*/ 03978000
*/*            CALLER WITH THE BASIC FUNCTION OF SORTING     @Z40LB37*/ 03979000
*/*            A CONTIGUOUS AREA OF STORAGE OF ANY LENGTH,   @Z40LB37*/ 03980000
*/*            OR ELEMENT (RECORD) SIZE.   IT ALLOWS         @Z40LB37*/ 03981000
*/*            CHARACTER FIELDS TO BE SORTED PER USER CALL,  @Z40LB37*/ 03982000
*/*            ANYWHERE WITHIN AN ELEMENT (RECORD) FOR ANY   @Z40LB37*/ 03983000
*/*            LENGTH EQUAL TO OR SMALLER THAN AN ELEMENTS   @Z40LB37*/ 03984000
*/*            SIZE.  THE ELEMENT SIZE CANNOT CHANGE BETWEEN @Z40LB37*/ 03985000
*/*            CALLS TO THE SORT PROCEDURE.  (THIS IS A      @Z40LB37*/ 03986000
*/*            COMPILE TIME VARIABLE.)                       @Z40LB37*/ 03987000
*/*                                                          @Z40LB37*/ 03988000
*/* ENTRY POINT - SORT                                       @Z40LB37*/ 03989000
*/*                                                          @Z40LB37*/ 03990000
*/*      LINKAGE - 'CALL SORT (SRTAGL)'                      @Z40LB37*/ 03991000
*/*                '%SRTLABEL = 'WORK AREA''                 @Z40LB37*/ 03992000
*/*                '%INCLUDE SYSLIB(IDCDF54)'                @Z40LB37*/ 03993000
*/*                                                          @Z40LB37*/ 03994000
*/* INPUT  - ADDRESS OF ARGUMENT LIST (SRTAGL)               @Z40LB37*/ 03995000
*/*                                                          @Z40LB37*/ 03996000
*/* OUTPUT - A RETURN CODE IN REGISTER 15                    @Z40LB37*/ 03997000
*/*                                                          @Z40LB37*/ 03998000
*/*          (0) - SORT SUCCESSFUL                           @Z40LB37*/ 03999000
*/*                                                          @Z40LB37*/ 04000000
*/* EXIT NORMAL - RETURNS TO CALLER WITH CONDITION           @Z40LB37*/ 04001000
*/*               CODE ZERO                                  @Z40LB37*/ 04002000
*/*                                                          @Z40LB37*/ 04003000
*/* EXIT ERROR  - NONE                                       @Z40LB37*/ 04004000
*/*                                                          @Z40LB37*/ 04005000
*/* CHANGE ACTIVITY - NONE                                   @Z40LB37*/ 04006000
*/*                                                                  */ 04007000
*/********************************************************************/ 04008000
*                                                                  1039 04009000
*SORT:                              /* AMS SORT ROUTINE      @Z40LB37*/ 04010000
*   PROCEDURE(SRTARG);              /* SORT ARGUMENT LIST    @Z40LB37*/ 04011000
SORT     STM   @14,@12,@SA00010                                    1039 04012000
         MVC   @PC00010(4),0(@01)                                  1039 04013000
*                                                                  1040 04014000
*   /*****************************************************************/ 04015000
*   /*                                                               */ 04016000
*   /* DECLARATIONS FOR THE SORT ROUTINE.                    @Z40LB37*/ 04017000
*   /*                                                               */ 04018000
*   /*****************************************************************/ 04019000
*                                                                  1040 04020000
*   DCL                                                            1040 04021000
*     1 SRTSTOR(*) BASED(SRTPTR),   /* INPUT STORAGE DCL     @Z40LB37*/ 04022000
*      2 SRTELEM CHAR(LENGTH(SORTWORK));/* FOR MOVING ONE ELEMENT  1040 04023000
*                                                            @Z40LB37*/ 04024000
*   DCL                                                            1041 04025000
*     SRTSAVE CHAR(LENGTH(SORTWORK))/* PASSED ELEMENT        @Z40LB37*/ 04026000
*         BASED(SRTWPTR);           /* SAVE AREA             @Z40LB37*/ 04027000
*   DCL                                                            1042 04028000
*    (SRTPTR,                                                      1042 04029000
*     SRTWPTR) PTR(31);             /* SORT AREA PTRS        @Z40LB37*/ 04030000
*   DCL                                                            1043 04031000
*     SRTLN FIXED(31);              /* SORT ELEMENT LENGTH   @Z40LB37*/ 04032000
*   DCL                                                            1044 04033000
*    (SRTBEG,                                                      1044 04034000
*     SRTEND) FIXED(31);            /* SORT FIELD DCLS       @Z40LB37*/ 04035000
*   DCL                                                            1045 04036000
*    (SRTSTOP,                                                     1045 04037000
*     SRTMOVE) BIT(1);              /* SORT SWITCHES         @Z40LB37*/ 04038000
*   DCL                                                            1046 04039000
*     SRTON BIT(1) CONSTANT('1'B);  /* SWITCH ON CONSTANT    @Z40LB37*/ 04040000
*   DCL                                                            1047 04041000
*     SRTOFF BIT(1) CONSTANT('0'B); /* SWITCH OFF CONSTANT   @Z40LB37*/ 04042000
*   DCL                                                            1048 04043000
*    (SRTMAXCT,                                                    1048 04044000
*     SRTI,                                                        1048 04045000
*     SRTJ) FIXED(31);              /* SORT COUNTER DCLS     @Z40LB37*/ 04046000
*   DCL                                                            1049 04047000
*     SRTRC FIXED(15) CONSTANT(0);  /* SORT RETURN CODE AREA @Z40LB37*/ 04048000
*                                                                  1050 04049000
*   /*****************************************************************/ 04050000
*   /*                                                               */ 04051000
*   /* RESPECIFY SRTAGL ON PASSED ADDRESS, ISSUE UTRACE      @Z40LB37*/ 04052000
*   /* AND UDUMP MACROS, AND INITIALIZE LOCAL COUNTERS AND   @Z40LB37*/ 04053000
*   /* LENGTH FIELDS.                                        @Z40LB37*/ 04054000
*   /*                                                               */ 04055000
*   /*****************************************************************/ 04056000
*                                                                  1050 04057000
*   RFY                                                            1050 04058000
*     SRTAGL BASED(ADDR(SRTARG));   /*                       @Z40LB37*/ 04059000
*   OLDERID2=NEWERID2;                                             1051 04060000
         L     @15,@PC00001                                        1051 04061000
         L     @14,GDTTR2(,@15)                                    1051 04062000
         MVC   @TS00001(95),NEWERID2(@14)                          1051 04063000
         MVC   OLDERID2(95,@14),@TS00001                           1051 04064000
*   NEWID2='SORT';                  /*                       @Z40LB37*/ 04065000
         MVC   NEWID2(4,@14),@CC01649                              1052 04066000
*   IF GDTDBG=NULLPTR THEN                                         1053 04067000
         L     @15,GDTDBG(,@15)                                    1053 04068000
         LTR   @15,@15                                             1053 04069000
         BZ    @RT01053                                            1053 04070000
*     ;                                                            1054 04071000
*   ELSE                                                           1055 04072000
*     CALL IDCDB010(GDTTBL,'SOTI'); /*                       @Z40LB37*/ 04073000
         L     @15,@PC00001                                        1055 04074000
         ST    @15,@AL00001                                        1055 04075000
         LA    @14,@CC01650                                        1055 04076000
         ST    @14,@AL00001+4                                      1055 04077000
         MVI   @AL00001+4,X'80'                                    1055 04078000
         L     @15,GDTDBG(,@15)                                    1055 04079000
         LA    @01,@AL00001                                        1055 04080000
         BALR  @14,@15                                             1055 04081000
*   SRTHEAD='SRTAGL  ';             /*                       @Z40LB37*/ 04082000
@RT01053 L     @05,@PC00010                                        1056 04083000
         MVC   SRTHEAD(8,@05),@CC01651                             1056 04084000
*   SRTWPTR=SRTWORKP;               /*                       @Z40LB37*/ 04085000
         L     SRTWPTR,SRTWORKP(,@05)                              1057 04086000
*   SRTPTR=SRTADDR;                 /*                       @Z40LB37*/ 04087000
         L     SRTPTR,SRTADDR(,@05)                                1058 04088000
*   SRTLN=SRTLEN;                   /*                       @Z40LB37*/ 04089000
         L     SRTLN,SRTLEN(,@05)                                  1059 04090000
*   SRTMAXCT=SRTNUM;                /*                       @Z40LB37*/ 04091000
         L     @02,SRTNUM(,@05)                                    1060 04092000
         ST    @02,SRTMAXCT                                        1060 04093000
*   SRTBEG=SRTPOSIT;                /*                       @Z40LB37*/ 04094000
         L     @02,SRTPOSIT(,@05)                                  1061 04095000
         LR    SRTBEG,@02                                          1061 04096000
*   SRTEND=SRTPOSIT+(SRTFLDLN-1);   /*                       @Z40LB37*/ 04097000
         L     SRTEND,SRTFLDLN(,@05)                               1062 04098000
         BCTR  SRTEND,0                                            1062 04099000
         ALR   @02,SRTEND                                          1062 04100000
         LR    SRTEND,@02                                          1062 04101000
*   SRTSTOP=SRTOFF;                 /*                       @Z40LB37*/ 04102000
         NI    SRTSTOP,B'01111111'                                 1063 04103000
*   SRTMOVE=SRTOFF;                 /*                       @Z40LB37*/ 04104000
         NI    SRTMOVE,B'01111111'                                 1064 04105000
*                                                                  1065 04106000
*   /*****************************************************************/ 04107000
*   /*                                                               */ 04108000
*   /* EXECUTE THE SORT LOOP USING THE MAXIMUM ELEMENTS      @Z40LB37*/ 04109000
*   /* MINUS ONE FOR THE SRTI COUNTER AND DECREMENTING THE   @Z40LB37*/ 04110000
*   /* THE SRTI COUNTER BY ONE EACH PASS. THE SRTJ COUNTER   @Z40LB37*/ 04111000
*   /* IS USED TO COUNT THE ELEMENTS THRU EACH PASS AND IN-  @Z40LB37*/ 04112000
*   /* CREMENT THE SRTJ COUNTER BY ONE AFTER EACH ELEMENT    @Z40LB37*/ 04113000
*   /* IS COMPARED. THE SRTSTOP SWITCH IS USED TO TERM-      @Z40LB37*/ 04114000
*   /* INATE THE SORT IF NO INTERCHANGE OF ELEMENTS TAKES    @Z40LB37*/ 04115000
*   /* PLACE.                                                @Z40LB37*/ 04116000
*   /*                                                               */ 04117000
*   /*****************************************************************/ 04118000
*                                                                  1065 04119000
*SRTLOOP:                                                          1065 04120000
*   DO SRTI=SRTMAXCT-1 TO 1 BY-1 WHILE SRTSTOP=SRTOFF;/*     @Z40LB37*/ 04121000
SRTLOOP  L     SRTI,SRTMAXCT                                       1065 04122000
         BCTR  SRTI,0                                              1065 04123000
         B     @DE01065                                            1065 04124000
@DL01065 TM    SRTSTOP,B'10000000'                                 1065 04125000
         BNZ   @DC01065                                            1065 04126000
*     DO SRTJ=1 TO SRTI;            /*                       @Z40LB37*/ 04127000
*                                                                  1066 04128000
         LA    SRTJ,1                                              1066 04129000
         B     @DE01066                                            1066 04130000
@DL01066 DS    0H                                                  1067 04131000
*       /*************************************************************/ 04132000
*       /*                                                           */ 04133000
*       /* COMPARE THE TWO ELEMENTS TO SEE IF AN INTER-      @Z40LB37*/ 04134000
*       /* CHANGE SHOULD TAKE PLACE, USING THE PASSED SORT   @Z40LB37*/ 04135000
*       /* FIELDS AS A SUBSTRING, IF SO INTERCHANGE THEM.    @Z40LB37*/ 04136000
*       /*                                                           */ 04137000
*       /*************************************************************/ 04138000
*                                                                  1067 04139000
*       IF SRTELEM(SRTJ,SRTBEG:SRTEND)>SRTELEM(SRTJ+1,SRTBEG:SRTEND)    04140000
*         THEN                                                     1067 04141000
         LR    @15,SRTJ                                            1067 04142000
         MH    @15,@CH01764                                        1067 04143000
         LR    @14,SRTBEG                                          1067 04144000
         ALR   @14,@15                                             1067 04145000
         LR    @01,SRTEND                                          1067 04146000
         SLR   @01,SRTBEG                                          1067 04147000
         ST    @14,@TF00001                                        1067 04148000
         ALR   @14,SRTPTR                                          1067 04149000
         AL    @14,@CF01787                                        1067 04150000
         ST    @15,@TF00002                                        1067 04151000
         LR    @15,SRTPTR                                          1067 04152000
         AL    @15,@TF00001                                        1067 04153000
         AL    @15,@CF01653                                        1067 04154000
         EX    @01,@SC01788                                        1067 04155000
         BNH   @RF01067                                            1067 04156000
*         DO;                       /*                       @Z40LB37*/ 04157000
*           SRTMOVE=SRTON;          /*                       @Z40LB37*/ 04158000
         OI    SRTMOVE,B'10000000'                                 1069 04159000
*           SRTSAVE=SRTELEM(SRTJ);  /*                       @Z40LB37*/ 04160000
         LR    @01,SRTPTR                                          1070 04161000
         AL    @01,@TF00002                                        1070 04162000
         AL    @01,@CF01790                                        1070 04163000
         MVC   SRTSAVE(80,SRTWPTR),SRTELEM(@01)                    1070 04164000
*           SRTELEM(SRTJ)=SRTELEM(SRTJ+1);/*                 @Z40LB37*/ 04165000
         LR    @01,SRTPTR                                          1071 04166000
         AL    @01,@TF00002                                        1071 04167000
         AL    @01,@CF01790                                        1071 04168000
         LR    @15,SRTPTR                                          1071 04169000
         AL    @15,@TF00002                                        1071 04170000
         MVC   SRTELEM(80,@01),SRTELEM(@15)                        1071 04171000
*           SRTELEM(SRTJ+1)=SRTSAVE;/*                       @Z40LB37*/ 04172000
         LR    @01,SRTPTR                                          1072 04173000
         AL    @01,@TF00002                                        1072 04174000
         MVC   SRTELEM(80,@01),SRTSAVE(SRTWPTR)                    1072 04175000
*         END;                      /*                       @Z40LB37*/ 04176000
*     END;                          /*                       @Z40LB37*/ 04177000
*                                                                  1074 04178000
@RF01067 AL    SRTJ,@CF00222                                       1074 04179000
@DE01066 CR    SRTJ,SRTI                                           1074 04180000
         BNH   @DL01066                                            1074 04181000
*     /***************************************************************/ 04182000
*     /*                                                             */ 04183000
*     /* IF AN ELEMENT WAS INTERCHANGED THEN TURN SRTMOVE    @Z40LB37*/ 04184000
*     /* SWITCH OFF. IF NO INTERCHANGE WAS MADE TURN SORT    @Z40LB37*/ 04185000
*     /* STOP SWITCH TO ON.                                  @Z40LB37*/ 04186000
*     /*                                                             */ 04187000
*     /***************************************************************/ 04188000
*                                                                  1075 04189000
*     IF SRTMOVE=SRTON THEN                                        1075 04190000
         TM    SRTMOVE,B'10000000'                                 1075 04191000
         BNO   @RF01075                                            1075 04192000
*       SRTMOVE=SRTOFF;             /*                       @Z40LB37*/ 04193000
         NI    SRTMOVE,B'01111111'                                 1076 04194000
*     ELSE                                                         1077 04195000
*       SRTSTOP=SRTON;              /*                       @Z40LB37*/ 04196000
         B     @RC01075                                            1077 04197000
@RF01075 OI    SRTSTOP,B'10000000'                                 1077 04198000
*   END SRTLOOP;                    /* END OF SRTLOOP TO SORT INTO AN   04199000
*                                      ASCENDING SEQUENCE    @Z40LB37*/ 04200000
@RC01075 BCTR  SRTI,0                                              1078 04201000
@DE01065 LTR   SRTI,SRTI                                           1078 04202000
         BP    @DL01065                                            1078 04203000
@DC01065 DS    0H                                                  1079 04204000
*   IF GDTDBG=NULLPTR THEN                                         1079 04205000
         L     @15,@PC00001                                        1079 04206000
         L     @15,GDTDBG(,@15)                                    1079 04207000
         LTR   @15,@15                                             1079 04208000
         BZ    @RT01079                                            1079 04209000
*     ;                                                            1080 04210000
*   ELSE                                                           1081 04211000
*     CALL IDCDB010(GDTTBL,'SOTO'); /* UDUMP EXIT            @Z40LB37*/ 04212000
         L     @15,@PC00001                                        1081 04213000
         ST    @15,@AL00001                                        1081 04214000
         LA    @14,@CC01655                                        1081 04215000
         ST    @14,@AL00001+4                                      1081 04216000
         MVI   @AL00001+4,X'80'                                    1081 04217000
         L     @15,GDTDBG(,@15)                                    1081 04218000
         LA    @01,@AL00001                                        1081 04219000
         BALR  @14,@15                                             1081 04220000
*   RETURN CODE(SRTRC);             /* RETURN TO MAIN ROUTINE      1082 04221000
*                                                            @Z40LB37*/ 04222000
@RT01079 SLR   @15,@15                                             1082 04223000
         L     @14,@SA00010                                        1082 04224000
         LM    @00,@12,@SA00010+8                                  1082 04225000
         BR    @14                                                 1082 04226000
*   END SORT;                       /* END OF AMS SORT ROUTINE - SORT   04227000
*                                                            @Z40LB37*/ 04228000
*                                                                  1084 04229000
*/********************************************************** @Z40LB26*/ 04230000
*/*                                                          @Z40LB26*/ 04231000
*/* PROCEDURE - PROCVOL                                      @Z40LB26*/ 04232000
*/*                                                          @Z40LB26*/ 04233000
*/* FUNCTION -  RECEIVES CONTROL WHEN AN ELIGIBLE BASE       @Z40LB26*/ 04234000
*/*             VOLUME RECORD HAS BEEN READ FROM THE MSVI.   @Z40LB26*/ 04235000
*/*             IT CALLS ROUTINES TO ALLOCATE A UNIT AND TO  @Z40LB26*/ 04236000
*/*             SELECT ELIGIBLE DATA SETS TO BE LISTED.  IT  @Z40LB26*/ 04237000
*/*             THEN CALLS ROUTINES TO PRINT THE REPORT AND  @Z40LB26*/ 04238000
*/*             SUMMARY INFORMATION.  ROUTINE CALLS          @Z40LB26*/ 04239000
*/*             ALLOCATE, SELECTOR, GRPHDR, VOLHDR, STATRPT, @Z40LB26*/ 04240000
*/*             USAGERPT.                                    @Z40LB26*/ 04241000
*/*                                                          @Z40LB26*/ 04242000
*/* INPUT - BASE VOLUME RECORD, FUNCTIONAL DATA TABLE,       @Z40LB26*/ 04243000
*/*         VS3AGL.                                          @Z40LB26*/ 04244000
*/*                                                          @Z40LB26*/ 04245000
*/* OUTPUT - REGISTER 15 = 0, ENTIRE VOLUME PROCESSED        @Z40LB26*/ 04246000
*/*                           SUCCESSFULLY                   @Z40LB26*/ 04247000
*/*                        4, VOLUME DEALLOCATION OR VTOC    @Z40LB26*/ 04248000
*/*                           CLOSE FAILURE                  @Z40LB26*/ 04249000
*/*                        8, ONE OR MORE DATA SETS COULD    @Z40LB26*/ 04250000
*/*                           NOT BE PROCESSED               @Z40LB26*/ 04251000
*/*                       12, VOLUME COULD NOT BE PROCESSED  @Z40LB26*/ 04252000
*/*                           DUE TO ERRORS                  @Z40LB26*/ 04253000
*/*                                                          @Z40LB26*/ 04254000
*/********************************************************** @Z40LB26*/ 04255000
*                                                                  1084 04256000
*PROCVOL:                                                          1084 04257000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 04258000
PROCVOL  ST    @14,@SA00011                                        1084 04259000
*                                                                  1085 04260000
*   /*****************************************************************/ 04261000
*   /*                                                               */ 04262000
*   /* SET UP TRACE POINT AT START OF PROCEDURE              @Z40LB26*/ 04263000
*   /*                                                               */ 04264000
*   /*****************************************************************/ 04265000
*                                                                  1085 04266000
*   OLDERID2=NEWERID2;                                             1085 04267000
         L     @06,@PC00001                                        1085 04268000
         L     @06,GDTTR2(,@06)                                    1085 04269000
         MVC   @TS00001(95),NEWERID2(@06)                          1085 04270000
         MVC   OLDERID2(95,@06),@TS00001                           1085 04271000
*   NEWID2='LDPV';                  /*                       @Z40LB26*/ 04272000
*                                                                  1086 04273000
         MVC   NEWID2(4,@06),@CC01659                              1086 04274000
*   /*****************************************************************/ 04275000
*   /*                                                               */ 04276000
*   /* INITIALIZE INTERNAL CONDITION CODE TO 0               @Z40LB26*/ 04277000
*   /*                                                               */ 04278000
*   /*****************************************************************/ 04279000
*                                                                  1087 04280000
*   CC02=LASTCC00;                  /*                       @Z40LB26*/ 04281000
*                                                                  1087 04282000
         SLR   CC02,CC02                                           1087 04283000
*   /*****************************************************************/ 04284000
*   /*                                                               */ 04285000
*   /* CALL ALLOCATE PROCEDURE TO GET A UNIT TO MOUNT        @Z40LB26*/ 04286000
*   /* VOLUME ON OR UNIT VOLUME IS MOUNTED ON.               @Z40LB26*/ 04287000
*   /*                                                               */ 04288000
*   /*****************************************************************/ 04289000
*                                                                  1088 04290000
*   CALL ALLOCATE;                  /*                       @Z40LB26*/ 04291000
         BAL   @14,ALLOCATE                                        1088 04292000
*   RESPECIFY                                                      1089 04293000
*     RTNREG RSTD;                                                 1089 04294000
*   TESTRC=RTNREG;                                                 1090 04295000
         LR    TESTRC,RTNREG                                       1090 04296000
*   RESPECIFY                                                      1091 04297000
*     RTNREG UNRSTD;                /*                       @Z40LB26*/ 04298000
*   CC02=TESTRC;                    /*                       @Z40LB26*/ 04299000
*                                                                  1092 04300000
         LR    CC02,TESTRC                                         1092 04301000
*   /*****************************************************************/ 04302000
*   /*                                                               */ 04303000
*   /* IF ALLOCATE WAS SUCCESSFUL, CONTINUE                  @Z40LB26*/ 04304000
*   /*                                                               */ 04305000
*   /*****************************************************************/ 04306000
*                                                                  1093 04307000
*   IF CC02=LASTCC00 THEN           /*                       @Z40LB26*/ 04308000
         SLR   @06,@06                                             1093 04309000
         CR    CC02,@06                                            1093 04310000
         BNE   @RF01093                                            1093 04311000
*     DO;                           /*                       @Z40LB26*/ 04312000
*                                                                  1094 04313000
*       /*************************************************************/ 04314000
*       /*                                                           */ 04315000
*       /* CHECK IF NOT PROCESSING BY GROUPS                 @Z40LB26*/ 04316000
*       /*                                                           */ 04317000
*       /*************************************************************/ 04318000
*                                                                  1095 04319000
*       IF ADDR(AGRP)=NULLPTR&ADDR(GRP)=NULLPTR/*            @Z40LB26*/ 04320000
*         THEN                      /*                       @Z40LB26*/ 04321000
*                                                                  1095 04322000
         L     @07,@PC00001+4                                      1095 04323000
         C     @06,FDTPTR+12(,@07)                                 1095 04324000
         BNE   @RF01095                                            1095 04325000
         C     @06,FDTPTR+4(,@07)                                  1095 04326000
         BNE   @RF01095                                            1095 04327000
*         /***********************************************************/ 04328000
*         /*                                                         */ 04329000
*         /* CALL ROUTINE TO PUT OUT VOLUME HEADER           @Z40LB26*/ 04330000
*         /*                                                         */ 04331000
*         /***********************************************************/ 04332000
*                                                                  1096 04333000
*         CALL VOLHDR;              /*                       @Z40LB26*/ 04334000
*                                                                  1096 04335000
         BAL   @14,VOLHDR                                          1096 04336000
*       /*************************************************************/ 04337000
*       /*                                                           */ 04338000
*       /* CALL ROUTINE TO PUT OUT GROUP HEADER              @Z40LB26*/ 04339000
*       /*                                                           */ 04340000
*       /*************************************************************/ 04341000
*                                                                  1097 04342000
*       ELSE                        /*                       @Z40LB26*/ 04343000
*         CALL GRPHDR;              /*                       @Z40LB26*/ 04344000
*                                                                  1097 04345000
         B     @RC01095                                            1097 04346000
@RF01095 BAL   @14,GRPHDR                                          1097 04347000
*       /*************************************************************/ 04348000
*       /*                                                           */ 04349000
*       /* CALL SELECTOR TO SELECT ELIGIBLE DATA SETS        @Z40LB26*/ 04350000
*       /* SAVE RETURN CODE.                                 @Z40LB26*/ 04351000
*       /*                                                           */ 04352000
*       /*************************************************************/ 04353000
*                                                                  1098 04354000
*       CALL SELECTOR;              /*                       @Z40LB26*/ 04355000
@RC01095 BAL   @14,SELECTOR                                        1098 04356000
*       RESPECIFY                                                  1099 04357000
*         RTNREG RSTD;                                             1099 04358000
*       TESTRC=RTNREG;                                             1100 04359000
         LR    TESTRC,RTNREG                                       1100 04360000
*       RESPECIFY                                                  1101 04361000
*         RTNREG UNRSTD;            /*                       @Z40LB26*/ 04362000
*       CC02=TESTRC;                /*                       @Z40LB26*/ 04363000
*                                                                  1102 04364000
         LR    CC02,TESTRC                                         1102 04365000
*       /*************************************************************/ 04366000
*       /*                                                           */ 04367000
*       /* TEST RETURN CODE TO SEE IF LIST OF DATA SETS      @Z40LB26*/ 04368000
*       /* RETURNED.                                         @Z40LB26*/ 04369000
*       /*                                                           */ 04370000
*       /*************************************************************/ 04371000
*                                                                  1103 04372000
*       IF CC02<LASTCC12 THEN       /*                       @Z40LB26*/ 04373000
         C     CC02,@CF00035                                       1103 04374000
         BNL   @RF01103                                            1103 04375000
*         DO;                       /*                       @Z40LB26*/ 04376000
*                                                                  1104 04377000
*           /*********************************************************/ 04378000
*           /*                                                       */ 04379000
*           /* CHECK TO SEE IF DOING USAGE OR STATUS REPORT  @Z40LB26*/ 04380000
*           /*                                                       */ 04381000
*           /*********************************************************/ 04382000
*                                                                  1105 04383000
*           IF ADDR(USAGE)^=NULLPTR THEN/*                   @Z40LB26*/ 04384000
*                                                                  1105 04385000
         L     @06,@PC00001+4                                      1105 04386000
         L     @06,FDTPTR+56(,@06)                                 1105 04387000
         LTR   @06,@06                                             1105 04388000
         BZ    @RF01105                                            1105 04389000
*             /*******************************************************/ 04390000
*             /*                                                     */ 04391000
*             /* CALL ROUTINE TO PRINT USAGE REPORT          @Z40LB26*/ 04392000
*             /*                                                     */ 04393000
*             /*******************************************************/ 04394000
*                                                                  1106 04395000
*             CALL USAGERPT;        /*                       @Z40LB26*/ 04396000
         BAL   @14,USAGERPT                                        1106 04397000
*           IF ADDR(STAT)^=NULLPTR THEN/*                    @Z40LB26*/ 04398000
*                                                                  1107 04399000
@RF01105 L     @06,@PC00001+4                                      1107 04400000
         L     @06,FDTPTR+52(,@06)                                 1107 04401000
         LTR   @06,@06                                             1107 04402000
         BZ    @RF01107                                            1107 04403000
*             /*******************************************************/ 04404000
*             /*                                                     */ 04405000
*             /* CALL ROUTINE TO PRINT STATUS REPORT         @Z40LB26*/ 04406000
*             /*                                                     */ 04407000
*             /*******************************************************/ 04408000
*                                                                  1108 04409000
*             CALL STATRPT;         /*                       @Z40LB26*/ 04410000
         BAL   @14,STATRPT                                         1108 04411000
*         END;                      /*                       @Z40LB26*/ 04412000
*                                                                  1109 04413000
@RF01107 DS    0H                                                  1110 04414000
*       /*************************************************************/ 04415000
*       /*                                                           */ 04416000
*       /* IF SELECTOR CAUSED STORAGE TO BE OBTAINED, ISSUE  @Z40LB26*/ 04417000
*       /* UFPOOL MACRO TO FREE IT.                          @Z40LB26*/ 04418000
*       /*                                                           */ 04419000
*       /*************************************************************/ 04420000
*                                                                  1110 04421000
*       IF LISTADDR^=NULLPTR THEN   /*                       @Z40LB26*/ 04422000
@RF01103 L     @06,LISTADDR                                        1110 04423000
         LTR   @06,@06                                             1110 04424000
         BZ    @RF01110                                            1110 04425000
*         CALL IDCSAFP0(GDTTBL,POOLID);/*                    @Z40LB26*/ 04426000
*                                                                  1111 04427000
         L     @06,@PC00001                                        1111 04428000
         ST    @06,@AL00001                                        1111 04429000
         LA    @15,@CC01511                                        1111 04430000
         ST    @15,@AL00001+4                                      1111 04431000
         MVI   @AL00001+4,X'80'                                    1111 04432000
         L     @15,GDTFPL(,@06)                                    1111 04433000
         LA    @01,@AL00001                                        1111 04434000
         BALR  @14,@15                                             1111 04435000
*       /*************************************************************/ 04436000
*       /*                                                           */ 04437000
*       /* IF ALLOCATE ROUTINE USED DYNAMIC ALLOCATION,      @Z40LB26*/ 04438000
*       /* ISSUE UDEALLOC MACRO TO DEALLOCATE IT. SAVE       @Z40LB26*/ 04439000
*       /* THE RETURN CODE.                                  @Z40LB26*/ 04440000
*       /*                                                           */ 04441000
*       /*************************************************************/ 04442000
*                                                                  1112 04443000
*       IF ALOCFLG=ON THEN          /*                       @Z40LB26*/ 04444000
@RF01110 TM    ALOCFLG,B'10000000'                                 1112 04445000
         BNO   @RF01112                                            1112 04446000
*         DO;                       /*                       @Z40LB26*/ 04447000
*           CALL IDCSADL0(GDTTBL,ALLAGL);/*                  @Z40LB26*/ 04448000
         L     @06,@PC00001                                        1114 04449000
         ST    @06,@AL00001                                        1114 04450000
         LA    @02,ALOCAREA                                        1114 04451000
         ST    @02,@AL00001+4                                      1114 04452000
         MVI   @AL00001+4,X'80'                                    1114 04453000
         L     @15,GDTDLC(,@06)                                    1114 04454000
         LA    @01,@AL00001                                        1114 04455000
         BALR  @14,@15                                             1114 04456000
*           RESPECIFY                                              1115 04457000
*             RTNREG RSTD;                                         1115 04458000
*           TESTRC=RTNREG;                                         1116 04459000
         LR    TESTRC,RTNREG                                       1116 04460000
*           RESPECIFY                                              1117 04461000
*             RTNREG UNRSTD;        /*                       @Z40LB26*/ 04462000
*                                                                  1117 04463000
*           /*********************************************************/ 04464000
*           /*                                                       */ 04465000
*           /* IF UDEALLOC FAILED, SET THE INTERNAL CONDI-   @Z40LB26*/ 04466000
*           /* TION CODE.                                    @Z40LB26*/ 04467000
*           /*                                                       */ 04468000
*           /*********************************************************/ 04469000
*                                                                  1118 04470000
*           IF TESTRC^=0 THEN       /*                       @Z40LB26*/ 04471000
         LTR   TESTRC,TESTRC                                       1118 04472000
         BZ    @RF01118                                            1118 04473000
*             CC02=MAX(LASTCC04,CC02);/*                     @Z40LB26*/ 04474000
         LA    @06,4                                               1119 04475000
         CR    CC02,@06                                            1119 04476000
         BNL   *+6                                                      04477000
         LR    CC02,@06                                            1119 04478000
*         END;                      /*                       @Z40LB26*/ 04479000
@RF01118 DS    0H                                                  1121 04480000
*     END;                          /*                       @Z40LB26*/ 04481000
@RF01112 DS    0H                                                  1122 04482000
*                                                                  1122 04483000
*   /*****************************************************************/ 04484000
*   /*                                                               */ 04485000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 04486000
*   /*                                                               */ 04487000
*   /*****************************************************************/ 04488000
*                                                                  1122 04489000
*   RETURN CODE(CC02);              /*                       @Z40LB26*/ 04490000
@RF01093 LR    @15,CC02                                            1122 04491000
@EL00011 DS    0H                                                  1122 04492000
@EF00011 DS    0H                                                  1122 04493000
@ER00011 L     @14,@SA00011                                        1122 04494000
         BR    @14                                                 1122 04495000
*   END PROCVOL;                    /*                       @Z40LB26*/ 04496000
*                                                                  1124 04497000
*/********************************************************** @Z40LB26*/ 04498000
*/*                                                          @Z40LB26*/ 04499000
*/* PROCEDURE - ALLOCATE                                     @Z40LB26*/ 04500000
*/*                                                          @Z40LB26*/ 04501000
*/* FUNCTION - DETERMINE THE DD TO USE TO MOUNT THE VOLUME   @Z40LB26*/ 04502000
*/*            ON.  CHECK THE DD TO DETERMINE IF THE UNIT IS @Z40LB26*/ 04503000
*/*            VIRTUAL.  DYNAMICALLY ALLOCATE THE VOLUME IF  @Z40LB26*/ 04504000
*/*            NECESSARY.  ISSUE MESSAGE IDC2108I IF THE     @Z40LB26*/ 04505000
*/*            VOLUME CAN NOT BE PROCESSED.                  @Z40LB26*/ 04506000
*/*                                                          @Z40LB26*/ 04507000
*/* INPUT - INVENTORY BASE RECORD                            @Z40LB26*/ 04508000
*/*                                                          @Z40LB26*/ 04509000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB26*/ 04510000
*/*                       12, EITHER THE UNIT ALLOCATED TO   @Z40LB26*/ 04511000
*/*                           THE VOLUME IS NOT VIRTUAL OR   @Z40LB26*/ 04512000
*/*                           DYNAMIC ALLOCATION FAILED      @Z40LB26*/ 04513000
*/*                                                          @Z40LB26*/ 04514000
*/*         ALOCFLAG SET ON IF VOLUME WAS DYNAMICALLY        @Z40LB26*/ 04515000
*/*          ALLOCATED, OTHERWISE, SET OFF.                  @Z40LB26*/ 04516000
*/*          DDNAME FIELD SET WITH DD NAME IF RETURN CODE    @Z40LB26*/ 04517000
*/*          IS 0.                                           @Z40LB26*/ 04518000
*/*                                                          @Z40LB26*/ 04519000
*/*         ADDRUCB SET WITH 0 OR SET TO ADDRESS OF THE      @Z40LB26*/ 04520000
*/*         UCB SELECTED FOR USE                             @Z40LB26*/ 04521000
*/*                                                          @Z40LB26*/ 04522000
*/********************************************************** @Z40LB26*/ 04523000
*                                                                  1124 04524000
*ALLOCATE:                                                         1124 04525000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB26*/ 04526000
ALLOCATE ST    @14,@SA00012                                        1124 04527000
*                                                                  1125 04528000
*   /*****************************************************************/ 04529000
*   /*                                                               */ 04530000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB26*/ 04531000
*   /*                                                               */ 04532000
*   /*****************************************************************/ 04533000
*                                                                  1125 04534000
*   OLDERID2=NEWERID2;                                             1125 04535000
         L     @07,@PC00001                                        1125 04536000
         L     @02,GDTTR2(,@07)                                    1125 04537000
         MVC   @TS00001(95),NEWERID2(@02)                          1125 04538000
         MVC   OLDERID2(95,@02),@TS00001                           1125 04539000
*   NEWID2='LDAL';                  /*                       @Z40LB26*/ 04540000
*                                                                  1126 04541000
         MVC   NEWID2(4,@02),@CC01668                              1126 04542000
*   /*****************************************************************/ 04543000
*   /*                                                               */ 04544000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB26*/ 04545000
*   /*                                                               */ 04546000
*   /*****************************************************************/ 04547000
*                                                                  1127 04548000
*   CC03=LASTCC00;                  /*                       @Z40LB26*/ 04549000
*                                                                  1127 04550000
         SLR   @02,@02                                             1127 04551000
         LR    CC03,@02                                            1127 04552000
*   /*****************************************************************/ 04553000
*   /*                                                               */ 04554000
*   /* SET FLAG TO INDICATE NO DYNAMIC ALLOCATION            @Z40LB26*/ 04555000
*   /*                                                               */ 04556000
*   /*****************************************************************/ 04557000
*                                                                  1128 04558000
*   ALOCFLG=OFF;                    /*                       @Z40LB26*/ 04559000
*                                                                  1128 04560000
         NI    ALOCFLG,B'01111111'                                 1128 04561000
*   /*****************************************************************/ 04562000
*   /*                                                               */ 04563000
*   /* ISSUE UMSSUNIT MACRO TO DETERMINE IF THE VOLUME IS    @Z40LB26*/ 04564000
*   /* MOUNTED. SAVE THE RETURN CODE.                        @Z40LB26*/ 04565000
*   /*                                                               */ 04566000
*   /*****************************************************************/ 04567000
*                                                                  1129 04568000
*   RESPECIFY                                                      1129 04569000
*     SELAGL BASED(ADDR(SLTAREA));  /*                       @Z40LB26*/ 04570000
*   SELAGL=''B;                     /* SET TO ZERO           @Z40LB26*/ 04571000
         LA    @15,SLTAREA                                         1130 04572000
         XC    SELAGL(23,@15),SELAGL(@15)                          1130 04573000
*   SELUCBP=ADDR(ADDRUCB);          /* UCB TO BE RETURNED    @Z40LB26*/ 04574000
         LA    @14,ADDRUCB                                         1131 04575000
         ST    @14,SELUCBP(,@15)                                   1131 04576000
*   ADDRUCB=NULLPTR;                /*                       @Z40LB26*/ 04577000
         ST    @02,ADDRUCB                                         1132 04578000
*   SELDDNP=ADDR(DDNAME);           /* DD TO BE RETURNED     @Z40LB26*/ 04579000
         LA    @02,DDNAME                                          1133 04580000
         ST    @02,SELDDNP(,@15)                                   1133 04581000
*   SELVOL=BASSERNO;                /* VOLUME SERIAL         @Z40LB26*/ 04582000
         MVC   SELVOL(6,@15),BASSERNO(BASEVPTR)                    1134 04583000
*   CALL IDCSA060(GDTTBL,SELECTDD,SELAGL);/*                 @Z40LB26*/ 04584000
         ST    @07,@AL00001                                        1135 04585000
         LA    @02,SELECTDD                                        1135 04586000
         ST    @02,@AL00001+4                                      1135 04587000
         ST    @15,@AL00001+8                                      1135 04588000
         MVI   @AL00001+8,X'80'                                    1135 04589000
         L     @15,GDTUNT(,@07)                                    1135 04590000
         LA    @01,@AL00001                                        1135 04591000
         BALR  @14,@15                                             1135 04592000
*   RESPECIFY                                                      1136 04593000
*     RTNREG RSTD;                                                 1136 04594000
*   TESTRC=RTNREG;                                                 1137 04595000
         LR    TESTRC,RTNREG                                       1137 04596000
*   RESPECIFY                                                      1138 04597000
*     RTNREG UNRSTD;                /*                       @Z40LB26*/ 04598000
*                                                                  1138 04599000
*   /*****************************************************************/ 04600000
*   /*                                                               */ 04601000
*   /* IF A DD WAS FOUND BY UMSSUNIT, ISSUE UMSSUNIT MACRO   @Z40LB26*/ 04602000
*   /* TO CHECK THAT THE UNIT IS VIRTUAL. SAVE THE RETURN    @Z40LB26*/ 04603000
*   /* CODE.                                                 @Z40LB26*/ 04604000
*   /*                                                               */ 04605000
*   /*****************************************************************/ 04606000
*                                                                  1139 04607000
*   IF TESTRC=0 THEN                /*                       @Z40LB26*/ 04608000
         LTR   TESTRC,TESTRC                                       1139 04609000
         BNZ   @RF01139                                            1139 04610000
*     DO;                           /*                       @Z40LB26*/ 04611000
*       RESPECIFY                                                  1141 04612000
*         CKAGL BASED(ADDR(CHKAREA));/*                      @Z40LB26*/ 04613000
*       CKAGL=''B;                  /*                       @Z40LB26*/ 04614000
         LA    @07,CHKAREA                                         1142 04615000
         XC    CKAGL(29,@07),CKAGL(@07)                            1142 04616000
*       CKUCBPTR=ADDR(ADDRUCB);     /*                       @Z40LB26*/ 04617000
         LA    @02,ADDRUCB                                         1143 04618000
         ST    @02,CKUCBPTR(,@07)                                  1143 04619000
*       CKDDNAME=DDNAME;            /*                       @Z40LB26*/ 04620000
         MVC   CKDDNAME(8,@07),DDNAME                              1144 04621000
*       CKTESTVT=ON;                /*                       @Z40LB26*/ 04622000
         OI    CKTESTVT(@07),B'10000000'                           1145 04623000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB26*/ 04624000
         L     @02,@PC00001                                        1146 04625000
         ST    @02,@AL00001                                        1146 04626000
         LA    @15,CHECK                                           1146 04627000
         ST    @15,@AL00001+4                                      1146 04628000
         ST    @07,@AL00001+8                                      1146 04629000
         MVI   @AL00001+8,X'80'                                    1146 04630000
         L     @15,GDTUNT(,@02)                                    1146 04631000
         LA    @01,@AL00001                                        1146 04632000
         BALR  @14,@15                                             1146 04633000
*       RESPECIFY                                                  1147 04634000
*         RTNREG RSTD;                                             1147 04635000
*       TESTRC=RTNREG;                                             1148 04636000
         LR    TESTRC,RTNREG                                       1148 04637000
*       RESPECIFY                                                  1149 04638000
*         RTNREG UNRSTD;            /*                       @Z40LB26*/ 04639000
*                                                                  1149 04640000
*       /*************************************************************/ 04641000
*       /*                                                           */ 04642000
*       /* IF AN ERROR WAS FOUND, SET THE INTERNAL           @Z40LB26*/ 04643000
*       /* CONDITION CODE.                                   @Z40LB26*/ 04644000
*       /*                                                           */ 04645000
*       /*************************************************************/ 04646000
*                                                                  1150 04647000
*       IF TESTRC^=0 THEN           /*                       @Z40LB26*/ 04648000
         LTR   TESTRC,TESTRC                                       1150 04649000
         BZ    @RF01150                                            1150 04650000
*         CC03=LASTCC12;            /*                       @Z40LB26*/ 04651000
         LA    CC03,12                                             1151 04652000
*     END;                          /*                       @Z40LB26*/ 04653000
*                                                                  1153 04654000
*   /*****************************************************************/ 04655000
*   /*                                                               */ 04656000
*   /* IF NO DD WAS FOUND, CONTINUE                          @Z40LB26*/ 04657000
*   /*                                                               */ 04658000
*   /*****************************************************************/ 04659000
*                                                                  1153 04660000
*   ELSE                            /*                       @Z40LB26*/ 04661000
*     DO;                           /*                       @Z40LB26*/ 04662000
*                                                                  1153 04663000
         B     @RC01139                                            1153 04664000
@RF01139 DS    0H                                                  1154 04665000
*       /*************************************************************/ 04666000
*       /*                                                           */ 04667000
*       /* IF THE FILE PARAMETER WAS SPECIFIED ON THE        @Z40LB26*/ 04668000
*       /* COMMAND, RETURN IT TO THE CALLER.                 @Z40LB26*/ 04669000
*       /*                                                           */ 04670000
*       /*************************************************************/ 04671000
*                                                                  1154 04672000
*       IF ADDR(FILE)^=NULLPTR THEN /*                       @Z40LB26*/ 04673000
         L     @07,@PC00001+4                                      1154 04674000
         L     @07,FDTPTR+44(,@07)                                 1154 04675000
         LTR   @07,@07                                             1154 04676000
         BZ    @RF01154                                            1154 04677000
*         DDNAME=FILEVAL;           /*                       @Z40LB26*/ 04678000
*                                                                  1155 04679000
         MVC   DDNAME(8),FILEVAL(@07)                              1155 04680000
*       /*************************************************************/ 04681000
*       /*                                                           */ 04682000
*       /* IF THE FILE PARAMETER WAS NOT SPECIFIED, ISSUE    @Z40LB26*/ 04683000
*       /* THE UALLOC MACRO TO DYNAMICALLY ALLOCATE A UNIT.  @Z40LB26*/ 04684000
*       /* SAVE THE RETURN CODE.                             @Z40LB26*/ 04685000
*       /*                                                           */ 04686000
*       /*************************************************************/ 04687000
*                                                                  1156 04688000
*       ELSE                        /*                       @Z40LB26*/ 04689000
*         DO;                       /*                       @Z40LB26*/ 04690000
         B     @RC01154                                            1156 04691000
@RF01154 DS    0H                                                  1157 04692000
*           RESPECIFY                                              1157 04693000
*             ALLAGL BASED(ADDR(ALOCAREA));/*                @Z40LB26*/ 04694000
*           ALLAGL=''B;             /*                       @Z40LB26*/ 04695000
         LA    @07,ALOCAREA                                        1158 04696000
         XC    ALLAGL(31,@07),ALLAGL(@07)                          1158 04697000
*           UNITCNT=1;              /*                       @Z40LB26*/ 04698000
         LA    @02,1                                               1159 04699000
         STH   @02,UNITCNT                                         1159 04700000
*           UNITLNG=LENGTH(V3330);  /*                       @Z40LB26*/ 04701000
         MVC   UNITLNG(2),@CH00298                                 1160 04702000
*           UNITNAME=V3330;         /* UNIT TYPE             @Z40LB26*/ 04703000
         MVI   UNITNAME+5,C' '                                     1161 04704000
         MVC   UNITNAME+6(2),UNITNAME+5                            1161 04705000
         MVC   UNITNAME(5),@CC01513                                1161 04706000
*           VOLCOUNT=1;             /*                       @Z40LB26*/ 04707000
         STH   @02,VOLCOUNT                                        1162 04708000
*           VOLLNG=LENGTH(BASSERNO);/*                       @Z40LB26*/ 04709000
         MVC   VOLLNG(2),@CH00159                                  1163 04710000
*           VOLNAME=BASSERNO;       /* VOLUME SERIAL         @Z40LB26*/ 04711000
         MVC   VOLNAME(6),BASSERNO(BASEVPTR)                       1164 04712000
*           ALLULP=ADDR(UNITLIST);  /* UNIT TYPE LIST        @Z40LB26*/ 04713000
         LA    @02,UNITLIST                                        1165 04714000
         ST    @02,ALLULP(,@07)                                    1165 04715000
*           ALLVLP=ADDR(VOLLIST);   /* VOLUME SERIAL LIST    @Z40LB26*/ 04716000
         LA    @02,VOLLIST                                         1166 04717000
         ST    @02,ALLVLP(,@07)                                    1166 04718000
*           ALLOPTVL=ON;            /* VOLUME ALLOCATION     @Z40LB26*/ 04719000
*           ALLOPTPV=ON;            /* PRIVATE               @Z40LB26*/ 04720000
         OI    ALLOPTVL(@07),B'10100000'                           1168 04721000
*           ALOCFLG=ON;             /* INDICATES DYNAMIC     @Z40LB26   04722000
*                                      ALLOCATION WAS DONE   @Z40LB26*/ 04723000
         OI    ALOCFLG,B'10000000'                                 1169 04724000
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Z40LB26*/ 04725000
         L     @02,@PC00001                                        1170 04726000
         ST    @02,@AL00001                                        1170 04727000
         ST    @07,@AL00001+4                                      1170 04728000
         MVI   @AL00001+4,X'80'                                    1170 04729000
         L     @15,GDTALC(,@02)                                    1170 04730000
         LA    @01,@AL00001                                        1170 04731000
         BALR  @14,@15                                             1170 04732000
*           RESPECIFY                                              1171 04733000
*             RTNREG RSTD;                                         1171 04734000
*           TESTRC=RTNREG;                                         1172 04735000
         LR    TESTRC,RTNREG                                       1172 04736000
*           RESPECIFY                                              1173 04737000
*             RTNREG UNRSTD;        /*                       @Z40LB26*/ 04738000
*                                                                  1173 04739000
*           /*********************************************************/ 04740000
*           /*                                                       */ 04741000
*           /* IF AN ERROR OCCURRED, SET THE CONDITION CODE  @Z40LB26*/ 04742000
*           /* OTHERWISE, RETURN DDNAME.                     @Z40LB26*/ 04743000
*           /*                                                       */ 04744000
*           /*********************************************************/ 04745000
*                                                                  1174 04746000
*           IF TESTRC^=0 THEN       /*                       @Z40LB26*/ 04747000
         LTR   TESTRC,TESTRC                                       1174 04748000
         BZ    @RF01174                                            1174 04749000
*             CC03=LASTCC12;        /*                       @Z40LB26*/ 04750000
         LA    CC03,12                                             1175 04751000
*           ELSE                    /*                       @Z40LB26*/ 04752000
*             DDNAME=ALLDDN;        /*                       @Z40LB26*/ 04753000
         B     @RC01174                                            1176 04754000
@RF01174 LA    @07,ALOCAREA                                        1176 04755000
         MVC   DDNAME(8),ALLDDN(@07)                               1176 04756000
*         END;                      /*                       @Z40LB26*/ 04757000
@RC01174 DS    0H                                                  1178 04758000
*     END;                          /*                       @Z40LB26*/ 04759000
@RC01154 DS    0H                                                  1179 04760000
*                                                                  1179 04761000
*   /*****************************************************************/ 04762000
*   /*                                                               */ 04763000
*   /* IF AN ERROR OCCURRED, ISSUE MESSAGE IDC2108I TO SAY   @Z40LB26*/ 04764000
*   /* THE VOLUME WAS NOT PROCESSED.                         @Z40LB26*/ 04765000
*   /*                                                               */ 04766000
*   /*****************************************************************/ 04767000
*                                                                  1179 04768000
*   IF CC03=LASTCC12 THEN           /*                       @Z40LB26*/ 04769000
@RC01139 C     CC03,@CF00035                                       1179 04770000
         BNE   @RF01179                                            1179 04771000
*     DO;                           /*                       @Z40LB26*/ 04772000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 04773000
         XC    DARGAREA(76),DARGAREA                               1181 04774000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB26*/ 04775000
         L     @07,DDSTRU                                          1182 04776000
         MVC   DARGSMOD(3,@07),@CC01475                            1182 04777000
*       DARGSENT=MSG2108I;          /*                       @Z40LB26*/ 04778000
         MVI   DARGSENT(@07),X'40'                                 1183 04779000
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB26*/ 04780000
         LA    @15,BASSERNO(,BASEVPTR)                             1184 04781000
         ST    @15,DARGDBP(,@07)                                   1184 04782000
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB26*/ 04783000
         MVC   DARGILP(2,@07),@CH00159                             1185 04784000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB26*/ 04785000
         L     @07,@PC00001                                        1186 04786000
         ST    @07,@AL00001                                        1186 04787000
         LA    @15,@CF00117                                        1186 04788000
         ST    @15,@AL00001+4                                      1186 04789000
         LA    @15,DDSTRU                                          1186 04790000
         ST    @15,@AL00001+8                                      1186 04791000
         MVI   @AL00001+8,X'80'                                    1186 04792000
         L     @15,GDTPRT(,@07)                                    1186 04793000
         LA    @01,@AL00001                                        1186 04794000
         BALR  @14,@15                                             1186 04795000
*     END;                          /*                       @Z40LB26*/ 04796000
*                                                                  1187 04797000
*   /*****************************************************************/ 04798000
*   /*                                                               */ 04799000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 04800000
*   /*                                                               */ 04801000
*   /*****************************************************************/ 04802000
*                                                                  1188 04803000
*   RETURN CODE(CC03);              /*                       @Z40LB26*/ 04804000
@RF01179 LR    @15,CC03                                            1188 04805000
@EL00012 DS    0H                                                  1188 04806000
@EF00012 DS    0H                                                  1188 04807000
@ER00012 L     @14,@SA00012                                        1188 04808000
         BR    @14                                                 1188 04809000
*   END ALLOCATE;                   /*                       @Z40LB26*/ 04810000
*                                                                  1190 04811000
*/********************************************************** @Z40LB26*/ 04812000
*/*                                                          @Z40LB26*/ 04813000
*/* PROCEDURE - GRPHDR                                       @Z40LB26*/ 04814000
*/*                                                          @Z40LB26*/ 04815000
*/* FUNCTION -  RECEIVES CONTROL WHEN A NEW VOLUME IS BEING  @Z40LB26*/ 04816000
*/*             PROCESSED.  IT WILL ESTABLISH A SUB-TITLE    @Z40LB26*/ 04817000
*/*             LINE FOR BOTH USAGE AND STATUS REPORTS BY    @Z40LB26*/ 04818000
*/*             GROUP AND WILL INSERT THE CURRENT GROUP      @Z40LB26*/ 04819000
*/*             NAME AND VOLUME NAME IN THE SUB-TITLE LINE.  @Z40LB26*/ 04820000
*/*             WHEN A NEW GROUP IS BEING PROCESSED, IT WILL @Z40LB26*/ 04821000
*/*             PRINT OUT THE GROUP OWNER AND OWNER ADDRESS  @Z40LB26*/ 04822000
*/*             AS DATA LINES.                               @Z40LB26*/ 04823000
*/*                                                          @Z40LB26*/ 04824000
*/* INPUT - FUNCTION DATA TABLE, GROUP RECORD, BASE VOLUME   @Z40LB26*/ 04825000
*/*         RECORD, OLD GROUP NAME.                          @Z40LB26*/ 04826000
*/*                                                          @Z40LB26*/ 04827000
*/* OUTPUT - REGISTER 15 = 0 SUCCESSFUL                      @Z40LB26*/ 04828000
*/*                                                          @Z40LB26*/ 04829000
*/********************************************************** @Z40LB26*/ 04830000
*                                                                  1190 04831000
*GRPHDR:                                                           1190 04832000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 04833000
GRPHDR   ST    @14,@SA00013                                        1190 04834000
*                                                                  1191 04835000
*   /*****************************************************************/ 04836000
*   /*                                                               */ 04837000
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/ 04838000
*   /*                                                               */ 04839000
*   /*****************************************************************/ 04840000
*                                                                  1191 04841000
*   OLDERID2=NEWERID2;                                             1191 04842000
         L     @07,@PC00001                                        1191 04843000
         L     @15,GDTTR2(,@07)                                    1191 04844000
         MVC   @TS00001(95),NEWERID2(@15)                          1191 04845000
         MVC   OLDERID2(95,@15),@TS00001                           1191 04846000
*   NEWID2='LDGH';                  /*                       @Z40LB26*/ 04847000
*                                                                  1192 04848000
         MVC   NEWID2(4,@15),@CC01678                              1192 04849000
*   /*****************************************************************/ 04850000
*   /*                                                               */ 04851000
*   /* SET CONDITION CODE                                    @Z40LB26*/ 04852000
*   /*                                                               */ 04853000
*   /*****************************************************************/ 04854000
*                                                                  1193 04855000
*   CC03=LASTCC00;                  /*                       @Z40LB26*/ 04856000
*                                                                  1193 04857000
         SLR   @15,@15                                             1193 04858000
         LR    CC03,@15                                            1193 04859000
*   /*****************************************************************/ 04860000
*   /*                                                               */ 04861000
*   /* CHECK TO SEE IF IT IS A USAGE OR STATUS REPORT.       @Z40LB26*/ 04862000
*   /* READ IN SUB-TITLE LINE ONLY ON FIRST CALL.            @Z40LB26*/ 04863000
*   /*                                                               */ 04864000
*   /*****************************************************************/ 04865000
*                                                                  1194 04866000
*   IF ADDR(USAGE)^=NULLPTR THEN    /*                       @Z40LB26*/ 04867000
         L     @14,@PC00001+4                                      1194 04868000
         C     @15,FDTPTR+56(,@14)                                 1194 04869000
         BE    @RF01194                                            1194 04870000
*     DO;                           /*                       @Z40LB26*/ 04871000
*                                                                  1195 04872000
*       /*************************************************************/ 04873000
*       /*                                                           */ 04874000
*       /* CHECK IF FIRST CALL FOR USAGE                     @Z40LB26*/ 04875000
*       /*                                                           */ 04876000
*       /*************************************************************/ 04877000
*                                                                  1196 04878000
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/ 04879000
         TM    NOINITSW,B'00100000'                                1196 04880000
         BNZ   @RF01196                                            1196 04881000
*         DO;                       /*                       @Z40LB26*/ 04882000
*                                                                  1197 04883000
*           /*********************************************************/ 04884000
*           /*                                                       */ 04885000
*           /* READ IN SUB-TITLE LINE                        @Z40LB26*/ 04886000
*           /*                                                       */ 04887000
*           /*********************************************************/ 04888000
*                                                                  1198 04889000
*           DARGAREA=''B;           /*                       @Z40LB26*/ 04890000
         XC    DARGAREA(76),DARGAREA                               1198 04891000
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/ 04892000
         L     @15,DDSTRU                                          1199 04893000
         MVC   DARGSMOD(3,@15),@CC01477                            1199 04894000
*           DARGSENT=GVUSEID;       /*                       @Z40LB26*/ 04895000
         MVI   DARGSENT(@15),X'02'                                 1200 04896000
*           DARGRETP=ADDR(STGRPUSE);/*                       @Z40LB26*/ 04897000
         LA    @14,STGRPUSE                                        1201 04898000
         ST    @14,DARGRETP(,@15)                                  1201 04899000
*           DARGRETL=LENGTH(STGRPUSE);/*                     @Z40LB26*/ 04900000
         MVC   DARGRETL(2,@15),@CH01473                            1202 04901000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/ 04902000
         ST    @07,@AL00001                                        1203 04903000
         LA    @15,@CF00117                                        1203 04904000
         ST    @15,@AL00001+4                                      1203 04905000
         LA    @15,DDSTRU                                          1203 04906000
         ST    @15,@AL00001+8                                      1203 04907000
         MVI   @AL00001+8,X'80'                                    1203 04908000
         L     @15,GDTPRT(,@07)                                    1203 04909000
         LA    @01,@AL00001                                        1203 04910000
         BALR  @14,@15                                             1203 04911000
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/ 04912000
         OI    NOINITSW,B'00100000'                                1204 04913000
*         END;                      /*                       @Z40LB26*/ 04914000
*                                                                  1205 04915000
*       /*************************************************************/ 04916000
*       /*                                                           */ 04917000
*       /* ISSUE UESTA TO ESTABLISH THIS AS A SUB-TITLE      @Z40LB26*/ 04918000
*       /* AFTER INSERTING THE VOLUME SERIAL AND GROUP       @Z40LB26*/ 04919000
*       /* NAME.                                             @Z40LB26*/ 04920000
*       /*                                                           */ 04921000
*       /*************************************************************/ 04922000
*                                                                  1206 04923000
*       PCARG=''B;                  /*                       @Z40LB26*/ 04924000
@RF01196 XC    PCARG(33),PCARG                                     1206 04925000
*       PCSTLP=ADDR(STGRPUSE);      /*                       @Z40LB26*/ 04926000
         LA    @07,STGRPUSE                                        1207 04927000
         ST    @07,PCSTLP                                          1207 04928000
*       PCSTLC=1;                   /*                       @Z40LB26*/ 04929000
         MVC   PCSTLC(2),@CH00222                                  1208 04930000
*       GVOLUSE=BASSERNO;           /*                       @Z40LB26*/ 04931000
         MVC   GVOLUSE(6),BASSERNO(BASEVPTR)                       1209 04932000
*       GRPUSE=GROVVGRP;            /*                       @Z40LB26*/ 04933000
         L     @07,GROUPPTR                                        1210 04934000
         MVC   GRPUSE(8),GROVVGRP(@07)                             1210 04935000
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/ 04936000
         L     @07,@PC00001                                        1211 04937000
         ST    @07,@AL00001                                        1211 04938000
         LA    @15,PRINTIT                                         1211 04939000
         ST    @15,@AL00001+4                                      1211 04940000
         LA    @15,PCARG                                           1211 04941000
         ST    @15,@AL00001+8                                      1211 04942000
         L     @15,GDTESA(,@07)                                    1211 04943000
         LA    @01,@AL00001                                        1211 04944000
         BALR  @14,@15                                             1211 04945000
*     END;                          /*                       @Z40LB26*/ 04946000
*                                                                  1212 04947000
*   /*****************************************************************/ 04948000
*   /*                                                               */ 04949000
*   /* STATUS REPORT WAS REQUESTED. READ                     @Z40LB26*/ 04950000
*   /* THE SUB-TITLE LINE ONLY ON THE FIRST CALL             @Z40LB26*/ 04951000
*   /*                                                               */ 04952000
*   /*****************************************************************/ 04953000
*                                                                  1213 04954000
*   ELSE                            /*                       @Z40LB26*/ 04955000
*     DO;                           /*                       @Z40LB26*/ 04956000
*                                                                  1213 04957000
         B     @RC01194                                            1213 04958000
@RF01194 DS    0H                                                  1214 04959000
*       /*************************************************************/ 04960000
*       /*                                                           */ 04961000
*       /* CHECK IF FIRST CALL FOR STATUS                    @Z40LB26*/ 04962000
*       /*                                                           */ 04963000
*       /*************************************************************/ 04964000
*                                                                  1214 04965000
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/ 04966000
         TM    NOINITSW,B'00100000'                                1214 04967000
         BNZ   @RF01214                                            1214 04968000
*         DO;                       /*                       @Z40LB26*/ 04969000
*                                                                  1215 04970000
*           /*********************************************************/ 04971000
*           /*                                                       */ 04972000
*           /* READ IN SUB-TITLE LINE                        @Z40LB26*/ 04973000
*           /*                                                       */ 04974000
*           /*********************************************************/ 04975000
*                                                                  1216 04976000
*           DARGAREA=''B;           /*                       @Z40LB26*/ 04977000
         XC    DARGAREA(76),DARGAREA                               1216 04978000
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/ 04979000
         L     @07,DDSTRU                                          1217 04980000
         MVC   DARGSMOD(3,@07),@CC01477                            1217 04981000
*           DARGSENT=GVSTATID;      /*                       @Z40LB26*/ 04982000
         MVI   DARGSENT(@07),X'04'                                 1218 04983000
*           DARGRETP=ADDR(STGRPSTA);/*                       @Z40LB26*/ 04984000
         LA    @15,STGRPSTA                                        1219 04985000
         ST    @15,DARGRETP(,@07)                                  1219 04986000
*           DARGRETL=LENGTH(STGRPSTA);/*                     @Z40LB26*/ 04987000
         MVC   DARGRETL(2,@07),@CH01473                            1220 04988000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/ 04989000
         L     @07,@PC00001                                        1221 04990000
         ST    @07,@AL00001                                        1221 04991000
         LA    @15,@CF00117                                        1221 04992000
         ST    @15,@AL00001+4                                      1221 04993000
         LA    @15,DDSTRU                                          1221 04994000
         ST    @15,@AL00001+8                                      1221 04995000
         MVI   @AL00001+8,X'80'                                    1221 04996000
         L     @15,GDTPRT(,@07)                                    1221 04997000
         LA    @01,@AL00001                                        1221 04998000
         BALR  @14,@15                                             1221 04999000
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/ 05000000
         OI    NOINITSW,B'00100000'                                1222 05001000
*         END;                      /*                       @Z40LB26*/ 05002000
*                                                                  1223 05003000
*       /*************************************************************/ 05004000
*       /*                                                           */ 05005000
*       /* ISSUE UESTA MACRO TO ESTABLISH THIS AS            @Z40LB26*/ 05006000
*       /* A SUB-TITLE AFTER INSERTING THE VOLUME SERIAL     @Z40LB26*/ 05007000
*       /* AND GROUP NAME.                                   @Z40LB26*/ 05008000
*       /*                                                           */ 05009000
*       /*************************************************************/ 05010000
*                                                                  1224 05011000
*       PCARG=''B;                  /*                       @Z40LB26*/ 05012000
@RF01214 XC    PCARG(33),PCARG                                     1224 05013000
*       PCSTLP=ADDR(STGRPSTA);      /*                       @Z40LB26*/ 05014000
         LA    @07,STGRPSTA                                        1225 05015000
         ST    @07,PCSTLP                                          1225 05016000
*       PCSTLC=1;                   /*                       @Z40LB26*/ 05017000
         MVC   PCSTLC(2),@CH00222                                  1226 05018000
*       GVOLSTAT=BASSERNO;          /*                       @Z40LB26*/ 05019000
         MVC   GVOLSTAT(6),BASSERNO(BASEVPTR)                      1227 05020000
*       GRPSTAT=GROVVGRP;           /*                       @Z40LB26*/ 05021000
         L     @07,GROUPPTR                                        1228 05022000
         MVC   GRPSTAT(8),GROVVGRP(@07)                            1228 05023000
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/ 05024000
         L     @07,@PC00001                                        1229 05025000
         ST    @07,@AL00001                                        1229 05026000
         LA    @15,PRINTIT                                         1229 05027000
         ST    @15,@AL00001+4                                      1229 05028000
         LA    @15,PCARG                                           1229 05029000
         ST    @15,@AL00001+8                                      1229 05030000
         L     @15,GDTESA(,@07)                                    1229 05031000
         LA    @01,@AL00001                                        1229 05032000
         BALR  @14,@15                                             1229 05033000
*     END;                          /*                       @Z40LB26*/ 05034000
*                                                                  1230 05035000
*   /*****************************************************************/ 05036000
*   /*                                                               */ 05037000
*   /* CHECK TO SEE IF GROUP NAME HAS CHANGED. IF CHANGED,   @Z40LB26*/ 05038000
*   /* PUT OUT GROUP OWNER AND OWNER ADDRESS AS DATA LINES.  @Z40LB26*/ 05039000
*   /*                                                               */ 05040000
*   /*****************************************************************/ 05041000
*                                                                  1231 05042000
*   IF OLDGROUP^=GROVVGRP THEN      /*                       @Z40LB26*/ 05043000
@RC01194 L     @07,GROUPPTR                                        1231 05044000
         CLC   OLDGROUP(8),GROVVGRP(@07)                           1231 05045000
         BE    @RF01231                                            1231 05046000
*     DO;                           /*                       @Z40LB26*/ 05047000
*       DARGAREA=''B;               /*                       @Z40LB26*/ 05048000
         XC    DARGAREA(76),DARGAREA                               1233 05049000
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/ 05050000
         L     @15,DDSTRU                                          1234 05051000
         MVC   DARGSMOD(3,@15),@CC01477                            1234 05052000
*       DARGSENT=GRPOWNER;          /*                       @Z40LB26*/ 05053000
         MVI   DARGSENT(@15),X'05'                                 1235 05054000
*       DARGCNT=2;                  /*                       @Z40LB26*/ 05055000
         MVC   DARGCNT(2,@15),@CH00156                             1236 05056000
*       DARGINS(1)=10;              /*                       @Z40LB26*/ 05057000
         LA    @14,10                                              1237 05058000
         STH   @14,DARGINS(,@15)                                   1237 05059000
*       DARGINL(1)=LENGTH(GROOWNER);/*                       @Z40LB26*/ 05060000
         STH   @14,DARGINL(,@15)                                   1238 05061000
*       DARGDTM(1)=ADDR(GROOWNER);  /*                       @Z40LB26*/ 05062000
         LA    @14,GROOWNER(,@07)                                  1239 05063000
         ST    @14,DARGDTM(,@15)                                   1239 05064000
*       DARGINS(2)=20;              /*                       @Z40LB26*/ 05065000
         MVC   DARGINS+8(2,@15),@CH00279                           1240 05066000
*       DARGINL(2)=LENGTH(GROADDR); /*                       @Z40LB26*/ 05067000
         MVC   DARGINL+8(2,@15),@CH01278                           1241 05068000
*       DARGDTM(2)=ADDR(GROADDR);   /*                       @Z40LB26*/ 05069000
         LA    @07,GROADDR(,@07)                                   1242 05070000
         ST    @07,DARGDTM+8(,@15)                                 1242 05071000
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/ 05072000
         L     @07,@PC00001                                        1243 05073000
         ST    @07,@AL00001                                        1243 05074000
         LA    @15,PRINTIT                                         1243 05075000
         ST    @15,@AL00001+4                                      1243 05076000
         LA    @15,DDSTRU                                          1243 05077000
         ST    @15,@AL00001+8                                      1243 05078000
         MVI   @AL00001+8,X'80'                                    1243 05079000
         L     @15,GDTPRT(,@07)                                    1243 05080000
         LA    @01,@AL00001                                        1243 05081000
         BALR  @14,@15                                             1243 05082000
*       OLDGROUP=GROVVGRP;          /*                       @Z40LB26*/ 05083000
         L     @07,GROUPPTR                                        1244 05084000
         MVC   OLDGROUP(8),GROVVGRP(@07)                           1244 05085000
*     END;                          /*                       @Z40LB26*/ 05086000
*                                                                  1245 05087000
*   /*****************************************************************/ 05088000
*   /*                                                               */ 05089000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 05090000
*   /*                                                               */ 05091000
*   /*****************************************************************/ 05092000
*                                                                  1246 05093000
*   RETURN CODE(CC03);              /*                       @Z40LB26*/ 05094000
@RF01231 LR    @15,CC03                                            1246 05095000
@EL00013 DS    0H                                                  1246 05096000
@EF00013 DS    0H                                                  1246 05097000
@ER00013 L     @14,@SA00013                                        1246 05098000
         BR    @14                                                 1246 05099000
*   END GRPHDR;                     /*                       @Z40LB26*/ 05100000
*                                                                  1248 05101000
*/********************************************************** @Z40LB26*/ 05102000
*/*                                                          @Z40LB26*/ 05103000
*/* PROCEDURE - VOLHDR                                       @Z40LB26*/ 05104000
*/*                                                          @Z40LB26*/ 05105000
*/* FUNCTION -  WILL INITIALLY READ IN THE SUB-TITLE LINE    @Z40LB26*/ 05106000
*/*             FROM THE STATIC TEXT AND THEN EACH TIME THE  @Z40LB26*/ 05107000
*/*             VOLUME BEING PROCESSED CHANGES IT WILL       @Z40LB26*/ 05108000
*/*             UPDATE THE SUB-TITLE LINE.  IT WILL HANDLE   @Z40LB26*/ 05109000
*/*             SUB-TITLE LINES FOR BOTH USAGE AND STATUS    @Z40LB26*/ 05110000
*/*             REPORTS.                                     @Z40LB26*/ 05111000
*/*                                                          @Z40LB26*/ 05112000
*/* INPUT - FUNCTION DATA TABLE, BASE VOLUME RECORD,         @Z40LB26*/ 05113000
*/*         STATIC TEXT MODULE.                              @Z40LB26*/ 05114000
*/*                                                          @Z40LB26*/ 05115000
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/ 05116000
*/*                                                          @Z40LB26*/ 05117000
*/********************************************************** @Z40LB26*/ 05118000
*                                                                  1248 05119000
*VOLHDR:                                                           1248 05120000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 05121000
VOLHDR   ST    @14,@SA00014                                        1248 05122000
*                                                                  1249 05123000
*   /*****************************************************************/ 05124000
*   /*                                                               */ 05125000
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/ 05126000
*   /*                                                               */ 05127000
*   /*****************************************************************/ 05128000
*                                                                  1249 05129000
*   OLDERID2=NEWERID2;                                             1249 05130000
         L     @07,@PC00001                                        1249 05131000
         L     @15,GDTTR2(,@07)                                    1249 05132000
         MVC   @TS00001(95),NEWERID2(@15)                          1249 05133000
         MVC   OLDERID2(95,@15),@TS00001                           1249 05134000
*   NEWID2='LDVH';                  /*                       @Z40LB26*/ 05135000
*                                                                  1250 05136000
         MVC   NEWID2(4,@15),@CC01682                              1250 05137000
*   /*****************************************************************/ 05138000
*   /*                                                               */ 05139000
*   /* SET CONDITION CODE                                    @Z40LB26*/ 05140000
*   /*                                                               */ 05141000
*   /*****************************************************************/ 05142000
*                                                                  1251 05143000
*   CC03=LASTCC00;                  /*                       @Z40LB26*/ 05144000
*                                                                  1251 05145000
         SLR   @15,@15                                             1251 05146000
         LR    CC03,@15                                            1251 05147000
*   /*****************************************************************/ 05148000
*   /*                                                               */ 05149000
*   /* CHECK TO SEE IF A USAGE OR STATUS REPORT WAS          @Z40LB26*/ 05150000
*   /* REQUESTED. READ IN SUB-TITLE LINE IF IT HASN'T        @Z40LB26*/ 05151000
*   /* BEEN DONE PREVIOUSLY.                                 @Z40LB26*/ 05152000
*   /*                                                               */ 05153000
*   /*****************************************************************/ 05154000
*                                                                  1252 05155000
*   IF ADDR(USAGE)^=NULLPTR THEN    /*                       @Z40LB26*/ 05156000
         L     @14,@PC00001+4                                      1252 05157000
         C     @15,FDTPTR+56(,@14)                                 1252 05158000
         BE    @RF01252                                            1252 05159000
*     DO;                           /*                       @Z40LB26*/ 05160000
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/ 05161000
         TM    NOINITSW,B'00100000'                                1254 05162000
         BNZ   @RF01254                                            1254 05163000
*         DO;                       /*                       @Z40LB26*/ 05164000
*                                                                  1255 05165000
*           /*********************************************************/ 05166000
*           /*                                                       */ 05167000
*           /* READ IN SUB-TITLE LINE                        @Z40LB26*/ 05168000
*           /*                                                       */ 05169000
*           /*********************************************************/ 05170000
*                                                                  1256 05171000
*           DARGAREA=''B;           /*                       @Z40LB26*/ 05172000
         XC    DARGAREA(76),DARGAREA                               1256 05173000
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/ 05174000
         L     @15,DDSTRU                                          1257 05175000
         MVC   DARGSMOD(3,@15),@CC01477                            1257 05176000
*           DARGSENT=VOLUSEID;      /*                       @Z40LB26*/ 05177000
         MVI   DARGSENT(@15),X'01'                                 1258 05178000
*           DARGRETP=ADDR(STVOLUSE);/*                       @Z40LB26*/ 05179000
         LA    @14,STVOLUSE                                        1259 05180000
         ST    @14,DARGRETP(,@15)                                  1259 05181000
*           DARGRETL=LENGTH(STVOLUSE);/*                     @Z40LB26*/ 05182000
         MVC   DARGRETL(2,@15),@CH01473                            1260 05183000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/ 05184000
         ST    @07,@AL00001                                        1261 05185000
         LA    @15,@CF00117                                        1261 05186000
         ST    @15,@AL00001+4                                      1261 05187000
         LA    @15,DDSTRU                                          1261 05188000
         ST    @15,@AL00001+8                                      1261 05189000
         MVI   @AL00001+8,X'80'                                    1261 05190000
         L     @15,GDTPRT(,@07)                                    1261 05191000
         LA    @01,@AL00001                                        1261 05192000
         BALR  @14,@15                                             1261 05193000
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/ 05194000
         OI    NOINITSW,B'00100000'                                1262 05195000
*         END;                      /*                       @Z40LB26*/ 05196000
*                                                                  1263 05197000
*       /*************************************************************/ 05198000
*       /*                                                           */ 05199000
*       /* ISSUE THE UESTA TO ESTABLISH SUB-TITLE LINE       @Z40LB26*/ 05200000
*       /* AFTER INSERTING THE VOLUME SERIAL.                @Z40LB26*/ 05201000
*       /*                                                           */ 05202000
*       /*************************************************************/ 05203000
*                                                                  1264 05204000
*       PCARG=''B;                  /*                       @Z40LB26*/ 05205000
@RF01254 XC    PCARG(33),PCARG                                     1264 05206000
*       PCSTLP=ADDR(STVOLUSE);      /*                       @Z40LB26*/ 05207000
         LA    @07,STVOLUSE                                        1265 05208000
         ST    @07,PCSTLP                                          1265 05209000
*       PCSTLC=1;                   /*                       @Z40LB26*/ 05210000
         MVC   PCSTLC(2),@CH00222                                  1266 05211000
*       VOLUSE=BASSERNO;            /*                       @Z40LB26*/ 05212000
         MVC   VOLUSE(6),BASSERNO(BASEVPTR)                        1267 05213000
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/ 05214000
         L     @07,@PC00001                                        1268 05215000
         ST    @07,@AL00001                                        1268 05216000
         LA    @15,PRINTIT                                         1268 05217000
         ST    @15,@AL00001+4                                      1268 05218000
         LA    @15,PCARG                                           1268 05219000
         ST    @15,@AL00001+8                                      1268 05220000
         L     @15,GDTESA(,@07)                                    1268 05221000
         LA    @01,@AL00001                                        1268 05222000
         BALR  @14,@15                                             1268 05223000
*     END;                          /*                       @Z40LB26*/ 05224000
*                                                                  1270 05225000
*   /*****************************************************************/ 05226000
*   /*                                                               */ 05227000
*   /* IF STATUS TYPE REPORT, SET UP SUB-TITLE LINE FOR      @Z40LB26*/ 05228000
*   /* STATUS REPORT BY VOLUME.                              @Z40LB26*/ 05229000
*   /*                                                               */ 05230000
*   /*****************************************************************/ 05231000
*                                                                  1270 05232000
*   ELSE                            /*                       @Z40LB26*/ 05233000
*     DO;                           /*                       @Z40LB26*/ 05234000
         B     @RC01252                                            1270 05235000
@RF01252 DS    0H                                                  1271 05236000
*       IF NOINITSW=OFF THEN        /*                       @Z40LB26*/ 05237000
         TM    NOINITSW,B'00100000'                                1271 05238000
         BNZ   @RF01271                                            1271 05239000
*         DO;                       /*                       @Z40LB26*/ 05240000
*           DARGAREA=''B;           /*                       @Z40LB26*/ 05241000
         XC    DARGAREA(76),DARGAREA                               1273 05242000
*           DARGSMOD=LD01TXT;       /*                       @Z40LB26*/ 05243000
         L     @07,DDSTRU                                          1274 05244000
         MVC   DARGSMOD(3,@07),@CC01477                            1274 05245000
*           DARGSENT=VOLSTAID;      /*                       @Z40LB26*/ 05246000
         MVI   DARGSENT(@07),X'03'                                 1275 05247000
*           DARGRETP=ADDR(STVOLSTA);/*                       @Z40LB26*/ 05248000
         LA    @15,STVOLSTA                                        1276 05249000
         ST    @15,DARGRETP(,@07)                                  1276 05250000
*           DARGRETL=LENGTH(STVOLSTA);/*                     @Z40LB26*/ 05251000
         MVC   DARGRETL(2,@07),@CH01473                            1277 05252000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB26*/ 05253000
         L     @07,@PC00001                                        1278 05254000
         ST    @07,@AL00001                                        1278 05255000
         LA    @15,@CF00117                                        1278 05256000
         ST    @15,@AL00001+4                                      1278 05257000
         LA    @15,DDSTRU                                          1278 05258000
         ST    @15,@AL00001+8                                      1278 05259000
         MVI   @AL00001+8,X'80'                                    1278 05260000
         L     @15,GDTPRT(,@07)                                    1278 05261000
         LA    @01,@AL00001                                        1278 05262000
         BALR  @14,@15                                             1278 05263000
*           NOINITSW=ON;            /* INDIC SUB READ IN     @Z40LB26*/ 05264000
         OI    NOINITSW,B'00100000'                                1279 05265000
*         END;                      /*                       @Z40LB26*/ 05266000
*                                                                  1280 05267000
*       /*************************************************************/ 05268000
*       /*                                                           */ 05269000
*       /* ISSUE UESTA MACRO TO SET UP THE LINE JUST         @Z40LB26*/ 05270000
*       /* READ AS A SUB-TITLE LINE AFTER INSERTING THE      @Z40LB26*/ 05271000
*       /* VOLUME SERIAL                                     @Z40LB26*/ 05272000
*       /*                                                           */ 05273000
*       /*************************************************************/ 05274000
*                                                                  1281 05275000
*       PCARG=''B;                  /*                       @Z40LB26*/ 05276000
@RF01271 XC    PCARG(33),PCARG                                     1281 05277000
*       PCSTLP=ADDR(STVOLSTA);      /*                       @Z40LB26*/ 05278000
         LA    @07,STVOLSTA                                        1282 05279000
         ST    @07,PCSTLP                                          1282 05280000
*       PCSTLC=1;                   /*                       @Z40LB26*/ 05281000
         MVC   PCSTLC(2),@CH00222                                  1283 05282000
*       VOLSTAT=BASSERNO;           /*                       @Z40LB26*/ 05283000
         MVC   VOLSTAT(6),BASSERNO(BASEVPTR)                       1284 05284000
*       CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*               @Z40LB26*/ 05285000
         L     @07,@PC00001                                        1285 05286000
         ST    @07,@AL00001                                        1285 05287000
         LA    @15,PRINTIT                                         1285 05288000
         ST    @15,@AL00001+4                                      1285 05289000
         LA    @15,PCARG                                           1285 05290000
         ST    @15,@AL00001+8                                      1285 05291000
         L     @15,GDTESA(,@07)                                    1285 05292000
         LA    @01,@AL00001                                        1285 05293000
         BALR  @14,@15                                             1285 05294000
*     END;                          /*                       @Z40LB26*/ 05295000
*                                                                  1286 05296000
*   /*****************************************************************/ 05297000
*   /*                                                               */ 05298000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 05299000
*   /*                                                               */ 05300000
*   /*****************************************************************/ 05301000
*                                                                  1287 05302000
*   RETURN CODE(CC03);              /*                       @Z40LB26*/ 05303000
@RC01252 LR    @15,CC03                                            1287 05304000
@EL00014 DS    0H                                                  1287 05305000
@EF00014 DS    0H                                                  1287 05306000
@ER00014 L     @14,@SA00014                                        1287 05307000
         BR    @14                                                 1287 05308000
*   END VOLHDR;                     /*                       @Z40LB26*/ 05309000
*                                                                  1289 05310000
*/********************************************************** @Z40LB26*/ 05311000
*/*                                                          @Z40LB26*/ 05312000
*/* PROCEDURE - STATRPT                                      @Z40LB26*/ 05313000
*/*                                                          @Z40LB26*/ 05314000
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN BODY OF A     @Z40LB26*/ 05315000
*/*             STATUS REPORT IS TO BE PRODUCED. IT CONVERTS @Z40LB26*/ 05316000
*/*             FIELDS THAT CANNOT BE CONVERTED BY THE TEXT  @Z40LB26*/ 05317000
*/*             PROCESSOR.  FINALLY IT CALLS THE STATSUM     @Z40LB26*/ 05318000
*/*             PROCEDURE TO PRINT THE SUMMARY INFORMATION.  @Z40LB26*/ 05319000
*/*                                                          @Z40LB26*/ 05320000
*/* INPUT - SORTED LIST OF DATA SETS (VSDBLOCK)              @Z40LB26*/ 05321000
*/*                                                          @Z40LB26*/ 05322000
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/ 05323000
*/*                                                          @Z40LB26*/ 05324000
*/*********************************************************  @Z40LB26*/ 05325000
*                                                                  1289 05326000
*STATRPT:                                                          1289 05327000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 05328000
STATRPT  ST    @14,@SA00015                                        1289 05329000
*                                                                  1290 05330000
*   /*****************************************************************/ 05331000
*   /*                                                               */ 05332000
*   /* ESTABLISH A TRACE POINT                               @Z40LB26*/ 05333000
*   /*                                                               */ 05334000
*   /*****************************************************************/ 05335000
*                                                                  1290 05336000
*   OLDERID2=NEWERID2;                                             1290 05337000
         L     @15,@PC00001                                        1290 05338000
         L     @15,GDTTR2(,@15)                                    1290 05339000
         MVC   @TS00001(95),NEWERID2(@15)                          1290 05340000
         MVC   OLDERID2(95,@15),@TS00001                           1290 05341000
*   NEWID2='LDSR';                  /*                       @Z40LB26*/ 05342000
*                                                                  1291 05343000
         MVC   NEWID2(4,@15),@CC01686                              1291 05344000
*   /*****************************************************************/ 05345000
*   /*                                                               */ 05346000
*   /* SET INITIAL CONDITION CODE                            @Z40LB26*/ 05347000
*   /*                                                               */ 05348000
*   /*****************************************************************/ 05349000
*                                                                  1292 05350000
*   CC03=LASTCC00;                  /*                       @Z40LB26*/ 05351000
*                                                                  1292 05352000
         SLR   CC03,CC03                                           1292 05353000
*   /*****************************************************************/ 05354000
*   /*                                                               */ 05355000
*   /* SEE IF THERE ARE ANY DATA SETS IN THE LIST. PROCESS   @Z40LB26*/ 05356000
*   /* THEM IF THERE ARE SOME                                @Z40LB26*/ 05357000
*   /*                                                               */ 05358000
*   /*****************************************************************/ 05359000
*                                                                  1293 05360000
*   DO ELEMENT=1 TO VSDELEM;        /*                       @Z40LB26*/ 05361000
*                                                                  1293 05362000
         LA    ELEMENT,1                                           1293 05363000
         B     @DE01293                                            1293 05364000
@DL01293 DS    0H                                                  1294 05365000
*     /***************************************************************/ 05366000
*     /*                                                             */ 05367000
*     /* IF THE CREATION DATE IN THE VTOC WAS HIGHER THAN    @Z40LB26*/ 05368000
*     /* IN THE VSAM CATALOG, SET UP TO PRINT A '-V' AFTER   @Z40LB26*/ 05369000
*     /* THE DATE. IF THE CREATION DATE IN THE VSAM          @Z40LB26*/ 05370000
*     /* CATALOG WAS HIGHER, SET UP TO PRINT A '-C'          @Z40LB26*/ 05371000
*     /* AFTER THE DATE. IF BOTH DATES WERE EQUAL, SET       @Z40LB26*/ 05372000
*     /* UP TO PRINT BLANKS AFTER THE DATE                   @Z40LB26*/ 05373000
*     /*                                                             */ 05374000
*     /***************************************************************/ 05375000
*                                                                  1294 05376000
*     IF VSDVTOCC=ON&VSDVSAMC=OFF   /*                       @Z40LB26*/ 05377000
*       THEN                        /*                       @Z40LB26*/ 05378000
         LR    @03,ELEMENT                                         1294 05379000
         MH    @03,@CH01764                                        1294 05380000
         L     @01,LISTADDR                                        1294 05381000
         AL    @01,@CF01791                                        1294 05382000
         LA    @03,VSDVARY-64(@03,@01)                             1294 05383000
         TM    VSDVTOCC(@03),B'10000000'                           1294 05384000
         BNO   @RF01294                                            1294 05385000
         TM    VSDVSAMC(@03),B'00100000'                           1294 05386000
         BNZ   @RF01294                                            1294 05387000
*       VSDCRE=DASHV;               /*                       @Z40LB26*/ 05388000
         MVC   VSDCRE(2,@03),DASHV                                 1295 05389000
*     ELSE                          /*                       @Z40LB26*/ 05390000
*       DO;                         /*                       @Z40LB26*/ 05391000
         B     @RC01294                                            1296 05392000
@RF01294 DS    0H                                                  1297 05393000
*         IF VSDVSAMC=ON&VSDVTOCC=OFF/*                      @Z40LB26*/ 05394000
*           THEN                    /*                       @Z40LB26*/ 05395000
         LR    @03,ELEMENT                                         1297 05396000
         MH    @03,@CH01764                                        1297 05397000
         L     @01,LISTADDR                                        1297 05398000
         AL    @01,@CF01791                                        1297 05399000
         LA    @03,VSDVARY-64(@03,@01)                             1297 05400000
         TM    VSDVSAMC(@03),B'00100000'                           1297 05401000
         BNO   @RF01297                                            1297 05402000
         TM    VSDVTOCC(@03),B'10000000'                           1297 05403000
         BNZ   @RF01297                                            1297 05404000
*           VSDCRE=DASHC;           /*                       @Z40LB26*/ 05405000
         MVC   VSDCRE(2,@03),DASHC                                 1298 05406000
*         ELSE                      /*                       @Z40LB26*/ 05407000
*           VSDCRE=BLANK;           /*                       @Z40LB26*/ 05408000
         B     @RC01297                                            1299 05409000
@RF01297 LR    @03,ELEMENT                                         1299 05410000
         MH    @03,@CH01764                                        1299 05411000
         L     @01,LISTADDR                                        1299 05412000
         AL    @01,@CF01791                                        1299 05413000
         LA    @03,VSDVARY-64(@03,@01)                             1299 05414000
         MVI   VSDCRE+1(@03),C' '                                  1299 05415000
         MVI   VSDCRE(@03),C' '                                    1299 05416000
*       END;                        /*                       @Z40LB26*/ 05417000
*                                                                  1300 05418000
@RC01297 DS    0H                                                  1301 05419000
*     /***************************************************************/ 05420000
*     /*                                                             */ 05421000
*     /* IF THE EXPIRATION DATE IN THE VTOC WAS HIGHER THAN  @Z40LB26*/ 05422000
*     /* THAT IN THE VSAM CATALOG, SET UP TO PRINT A "-V"    @Z40LB26*/ 05423000
*     /* AFTER THE DATE. IF THE EXPIRATION DATE IN THE       @Z40LB26*/ 05424000
*     /* VSAM CATALOG WAS HIGHER THAN THAT IN THE VTOC       @Z40LB26*/ 05425000
*     /* SET UP TO PRINT A "-C" AFTER THE DATE. IF BOTH      @Z40LB26*/ 05426000
*     /* EXPIRATION DATES ARE EQUAL, SET UP TO PRINT         @Z40LB26*/ 05427000
*     /* BLANKS AFTER THE DATE.                              @Z40LB26*/ 05428000
*     /*                                                             */ 05429000
*     /***************************************************************/ 05430000
*                                                                  1301 05431000
*     IF VSDVTOCE=ON&VSDVSAME=OFF   /*                       @Z40LB26*/ 05432000
*       THEN                        /*                       @Z40LB26*/ 05433000
@RC01294 LR    @03,ELEMENT                                         1301 05434000
         MH    @03,@CH01764                                        1301 05435000
         L     @01,LISTADDR                                        1301 05436000
         AL    @01,@CF01791                                        1301 05437000
         LA    @03,VSDVARY-64(@03,@01)                             1301 05438000
         TM    VSDVTOCE(@03),B'01000000'                           1301 05439000
         BNO   @RF01301                                            1301 05440000
         TM    VSDVSAME(@03),B'00010000'                           1301 05441000
         BNZ   @RF01301                                            1301 05442000
*       VSDEXP=DASHV;               /*                       @Z40LB26*/ 05443000
         MVC   VSDEXP(2,@03),DASHV                                 1302 05444000
*     ELSE                          /*                       @Z40LB26*/ 05445000
*       DO;                         /*                       @Z40LB26*/ 05446000
         B     @RC01301                                            1303 05447000
@RF01301 DS    0H                                                  1304 05448000
*         IF VSDVSAME=ON&VSDVTOCE=OFF/*                      @Z40LB26*/ 05449000
*           THEN                    /*                       @Z40LB26*/ 05450000
         LR    @03,ELEMENT                                         1304 05451000
         MH    @03,@CH01764                                        1304 05452000
         L     @01,LISTADDR                                        1304 05453000
         AL    @01,@CF01791                                        1304 05454000
         LA    @03,VSDVARY-64(@03,@01)                             1304 05455000
         TM    VSDVSAME(@03),B'00010000'                           1304 05456000
         BNO   @RF01304                                            1304 05457000
         TM    VSDVTOCE(@03),B'01000000'                           1304 05458000
         BNZ   @RF01304                                            1304 05459000
*           VSDEXP=DASHC;           /*                       @Z40LB26*/ 05460000
         MVC   VSDEXP(2,@03),DASHC                                 1305 05461000
*         ELSE                      /*                       @Z40LB26*/ 05462000
*           VSDEXP=BLANK;           /*                       @Z40LB26*/ 05463000
         B     @RC01304                                            1306 05464000
@RF01304 LR    @03,ELEMENT                                         1306 05465000
         MH    @03,@CH01764                                        1306 05466000
         L     @01,LISTADDR                                        1306 05467000
         AL    @01,@CF01791                                        1306 05468000
         LA    @03,VSDVARY-64(@03,@01)                             1306 05469000
         MVI   VSDEXP+1(@03),C' '                                  1306 05470000
         MVI   VSDEXP(@03),C' '                                    1306 05471000
*       END;                        /*                       @Z40LB26*/ 05472000
*                                                                  1307 05473000
@RC01304 DS    0H                                                  1308 05474000
*     /***************************************************************/ 05475000
*     /*                                                             */ 05476000
*     /* SET UP THE CATALOG FIELD FOR THE TEXT PROCESSOR.    @Z40LB26*/ 05477000
*     /* IF THE DATA SET IS CATALOGED, SET UP TO PRINT       @Z40LB26*/ 05478000
*     /* BLANKS. IF THE DATA SET IS NOT CATALOGED,           @Z40LB26*/ 05479000
*     /* SET UP TO PRINT 'NO'. IF AN ERROR OCCURRED          @Z40LB26*/ 05480000
*     /* LOCATING THE DATA SET IN THE CATALOG, SET UP TO     @Z40LB26*/ 05481000
*     /* PRINT 'ERR'. IF THE DATA SET IS CATALOGED           @Z40LB26*/ 05482000
*     /* ON MORE THAN ONE VOLUME, SET UP TO PRINT            @Z40LB26*/ 05483000
*     /* THE NUMBER OF VOLUMES.                              @Z40LB26*/ 05484000
*     /*                                                             */ 05485000
*     /***************************************************************/ 05486000
*                                                                  1308 05487000
*     IF VSDCATLG=ON&VSDERROR=OFF   /*                       @Z40LB26*/ 05488000
*         &VSDVOLCT(ELEMENT)<=1 THEN/*                       @Z40LB26*/ 05489000
@RC01301 L     @03,LISTADDR                                        1308 05490000
         LR    @15,ELEMENT                                         1308 05491000
         MH    @15,@CH01764                                        1308 05492000
         LA    @01,0(@15,@03)                                      1308 05493000
         AL    @01,@CF01791                                        1308 05494000
         TM    VSDCATLG(@01),B'00001000'                           1308 05495000
         BNO   @RF01308                                            1308 05496000
         TM    VSDERROR(@01),B'00010000'                           1308 05497000
         BNZ   @RF01308                                            1308 05498000
         AL    @03,@CF01792                                        1308 05499000
         L     @03,VSDVOLCT-16(@15,@03)                            1308 05500000
         C     @03,@CF00222                                        1308 05501000
         BH    @RF01308                                            1308 05502000
*       VSDCAT=BLANK;               /*                       @Z40LB26*/ 05503000
         MVI   VSDCAT+1(@01),C' '                                  1309 05504000
         MVI   VSDCAT+2(@01),C' '                                  1309 05505000
         MVI   VSDCAT(@01),C' '                                    1309 05506000
*     ELSE                          /*                       @Z40LB26*/ 05507000
*       DO;                         /*                       @Z40LB26*/ 05508000
         B     @RC01308                                            1310 05509000
@RF01308 DS    0H                                                  1311 05510000
*         IF VSDCATLG=OFF&VSDERROR=OFF/*                     @Z40LB26*/ 05511000
*           THEN                    /*                       @Z40LB26*/ 05512000
         LR    @03,ELEMENT                                         1311 05513000
         MH    @03,@CH01764                                        1311 05514000
         L     @01,LISTADDR                                        1311 05515000
         AL    @01,@CF01791                                        1311 05516000
         LA    @03,VSDVARY-64(@03,@01)                             1311 05517000
         TM    VSDCATLG(@03),B'00001000'                           1311 05518000
         BNZ   @RF01311                                            1311 05519000
         TM    VSDERROR(@03),B'00010000'                           1311 05520000
         BNZ   @RF01311                                            1311 05521000
*           VSDCAT=NOCAT;           /*                       @Z40LB26*/ 05522000
         MVC   VSDCAT(3,@03),NOCAT                                 1312 05523000
*         ELSE                      /*                       @Z40LB26*/ 05524000
*           IF VSDERROR=ON THEN     /*                       @Z40LB26*/ 05525000
         B     @RC01311                                            1313 05526000
@RF01311 LR    @03,ELEMENT                                         1313 05527000
         MH    @03,@CH01764                                        1313 05528000
         L     @01,LISTADDR                                        1313 05529000
         AL    @01,@CF01791                                        1313 05530000
         LA    @03,VSDVARY-64(@03,@01)                             1313 05531000
         TM    VSDERROR(@03),B'00010000'                           1313 05532000
         BNO   @RF01313                                            1313 05533000
*             VSDCAT=ERROR;         /*                       @Z40LB26*/ 05534000
         MVC   VSDCAT(3,@03),ERROR                                 1314 05535000
*           ELSE                    /*                       @Z40LB26*/ 05536000
*             IF VSDVOLCT(ELEMENT)>1 THEN/*                  @Z40LB26*/ 05537000
         B     @RC01313                                            1315 05538000
@RF01313 LA    @03,1                                               1315 05539000
         L     @15,LISTADDR                                        1315 05540000
         LR    @14,ELEMENT                                         1315 05541000
         MH    @14,@CH01764                                        1315 05542000
         LA    @01,0(@14,@15)                                      1315 05543000
         AL    @01,@CF01792                                        1315 05544000
         L     @01,VSDVOLCT-16(,@01)                               1315 05545000
         CR    @01,@03                                             1315 05546000
         BNH   @RF01315                                            1315 05547000
*               DO;                 /*                       @Z40LB26*/ 05548000
*                                                                  1316 05549000
*                 /***************************************************/ 05550000
*                 /*                                                 */ 05551000
*                 /* CONVERT MULTI-VOLUME COUNT TO DECIMAL   @Z40LB26*/ 05552000
*                 /*                                                 */ 05553000
*                 /***************************************************/ 05554000
*                                                                  1317 05555000
*                 CVD(VSDVOLCT(ELEMENT),HOLD4CHR);/*         @Z40LB26*/ 05556000
*                                                                  1317 05557000
         CVD   @01,@TS00001                                        1317 05558000
         MVC   HOLD4CHR(4),@TS00001+4                              1317 05559000
*                 /***************************************************/ 05560000
*                 /*                                                 */ 05561000
*                 /* UNPACK                                  @Z40LB26*/ 05562000
*                 /*                                                 */ 05563000
*                 /***************************************************/ 05564000
*                                                                  1318 05565000
*                 UNPK(VSDCAT,HOLD4CHR);/*                   @Z40LB26*/ 05566000
*                                                                  1318 05567000
         AL    @15,@CF01791                                        1318 05568000
         LA    @15,VSDVARY-64(@14,@15)                             1318 05569000
         UNPK  VSDCAT(3,@15),HOLD4CHR(4)                           1318 05570000
*                 /***************************************************/ 05571000
*                 /*                                                 */ 05572000
*                 /* GET RID OF SIGN IN THIRD BYTE SO IT     @Z40LB26*/ 05573000
*                 /* WILL PRINT                              @Z40LB26*/ 05574000
*                 /*                                                 */ 05575000
*                 /***************************************************/ 05576000
*                                                                  1319 05577000
*                 VSDCAT(3)=VSDCAT(3)|ORIT;/*                @Z40LB26*/ 05578000
*                                                                  1319 05579000
         OI    VSDCAT+2(@15),C'0'                                  1319 05580000
*                 /***************************************************/ 05581000
*                 /*                                                 */ 05582000
*                 /* SUPPRESS LEADING ZEROES                 @Z40LB26*/ 05583000
*                 /*                                                 */ 05584000
*                 /***************************************************/ 05585000
*                                                                  1320 05586000
*                 DO SUPCNT=1 TO 2 WHILE/*                   @Z40LB26*/ 05587000
*                       VSDCAT(SUPCNT)=CHARZERO;/*           @Z40LB26*/ 05588000
         LA    @15,1                                               1320 05589000
         LR    SUPCNT,@15                                          1320 05590000
@DL01320 LR    @15,ELEMENT                                         1320 05591000
         MH    @15,@CH01764                                        1320 05592000
         L     @01,LISTADDR                                        1320 05593000
         AL    @01,@CF01791                                        1320 05594000
         LA    @15,VSDVARY-64(@15,@01)                             1320 05595000
         LR    @14,@15                                             1320 05596000
         ALR   @14,SUPCNT                                          1320 05597000
         CLI   VSDCAT-1(@14),C'0'                                  1320 05598000
         BNE   @DC01320                                            1320 05599000
*                   VSDCAT(SUPCNT)=BLANK;/*                  @Z40LB26*/ 05600000
         ALR   @15,SUPCNT                                          1321 05601000
         MVI   VSDCAT-1(@15),C' '                                  1321 05602000
*                 END;              /*                       @Z40LB26*/ 05603000
         AL    SUPCNT,@CF00222                                     1322 05604000
         C     SUPCNT,@CF00156                                     1322 05605000
         BNH   @DL01320                                            1322 05606000
@DC01320 DS    0H                                                  1323 05607000
*               END;                /*                       @Z40LB26*/ 05608000
*       END;                        /*                       @Z40LB26*/ 05609000
*                                                                  1324 05610000
@RF01315 DS    0H                                                  1324 05611000
@RC01313 DS    0H                                                  1324 05612000
@RC01311 DS    0H                                                  1325 05613000
*     /***************************************************************/ 05614000
*     /*                                                             */ 05615000
*     /* SET UP PROTECTION SECTION OF DATA LINE              @Z40LB26*/ 05616000
*     /* WITH EITHER 'R/W' FOR READ|WRITE, 'W' FOR WRITE,    @Z40LB26*/ 05617000
*     /* 'RACF' FOR RACF,'RF,R' FOR BOTH RACF AND READ/WRITE,        */ 05618000
*     /*                                                     @G24LB31*/ 05619000
*     /* 'RF,W' FOR BOTH RACF AND WRITE,                     @G24LB31*/ 05620000
*     /* OR BLANKS FOR NO PROTECTION.                        @Z40LB26*/ 05621000
*     /*                                                             */ 05622000
*     /***************************************************************/ 05623000
*                                                                  1325 05624000
*     IF VSDPROT=ON THEN            /*                       @Z40LB26*/ 05625000
@RC01308 LR    @03,ELEMENT                                         1325 05626000
         MH    @03,@CH01764                                        1325 05627000
         L     @01,LISTADDR                                        1325 05628000
         AL    @01,@CF01791                                        1325 05629000
         LA    @03,VSDVARY-64(@03,@01)                             1325 05630000
         TM    VSDPROT(@03),B'00100000'                            1325 05631000
         BNO   @RF01325                                            1325 05632000
*       DO;                         /*                       @Z40LB26*/ 05633000
*         IF VSDRACF=ON THEN        /*                       @G24LB31*/ 05634000
         TM    VSDRACF(@03),B'00001000'                            1327 05635000
         BNO   @RF01327                                            1327 05636000
*           DO;                     /*                       @G24LB31*/ 05637000
*             IF VSDPWR=ON THEN     /*                       @G24LB31*/ 05638000
         TM    VSDPWR(@03),B'10000000'                             1329 05639000
         BNO   @RF01329                                            1329 05640000
*               VSDPRTC=PROTRFR;    /*                       @G24LB31*/ 05641000
         MVC   VSDPRTC(4,@03),PROTRFR                              1330 05642000
*             ELSE                  /*                       @G24LB31*/ 05643000
*               IF VSDPWW=ON THEN   /*                       @G24LB31*/ 05644000
         B     @RC01329                                            1331 05645000
@RF01329 LR    @03,ELEMENT                                         1331 05646000
         MH    @03,@CH01764                                        1331 05647000
         L     @01,LISTADDR                                        1331 05648000
         AL    @01,@CF01791                                        1331 05649000
         LA    @03,VSDVARY-64(@03,@01)                             1331 05650000
         TM    VSDPWW(@03),B'01000000'                             1331 05651000
         BNO   @RF01331                                            1331 05652000
*                 VSDPRTC=PROTRFW;  /*                       @G24LB31*/ 05653000
         MVC   VSDPRTC(4,@03),PROTRFW                              1332 05654000
*               ELSE                /*                       @G24LB31*/ 05655000
*                 VSDPRTC=PROTRACF; /*                       @G24LB31*/ 05656000
         B     @RC01331                                            1333 05657000
@RF01331 LR    @03,ELEMENT                                         1333 05658000
         MH    @03,@CH01764                                        1333 05659000
         L     @01,LISTADDR                                        1333 05660000
         AL    @01,@CF01791                                        1333 05661000
         LA    @03,VSDVARY-64(@03,@01)                             1333 05662000
         MVC   VSDPRTC(4,@03),PROTRACF                             1333 05663000
*           END;                    /*                       @G24LB31*/ 05664000
*         ELSE                      /*                       @G24LB31*/ 05665000
*           IF VSDPWR=ON THEN       /*                       @Z40LB26*/ 05666000
         B     @RC01327                                            1335 05667000
@RF01327 LR    @03,ELEMENT                                         1335 05668000
         MH    @03,@CH01764                                        1335 05669000
         L     @01,LISTADDR                                        1335 05670000
         AL    @01,@CF01791                                        1335 05671000
         LA    @03,VSDVARY-64(@03,@01)                             1335 05672000
         TM    VSDPWR(@03),B'10000000'                             1335 05673000
         BNO   @RF01335                                            1335 05674000
*             VSDPRTC=RDWRITE;      /*                       @Z40LB26*/ 05675000
         MVC   VSDPRTC(4,@03),RDWRITE                              1336 05676000
*           ELSE                    /*                       @Z40LB26*/ 05677000
*             DO;                   /*                       @Z40LB26*/ 05678000
         B     @RC01335                                            1337 05679000
@RF01335 DS    0H                                                  1338 05680000
*               IF VSDPWW=ON THEN   /*                       @Z40LB26*/ 05681000
         LR    @03,ELEMENT                                         1338 05682000
         MH    @03,@CH01764                                        1338 05683000
         L     @01,LISTADDR                                        1338 05684000
         AL    @01,@CF01791                                        1338 05685000
         LA    @03,VSDVARY-64(@03,@01)                             1338 05686000
         TM    VSDPWW(@03),B'01000000'                             1338 05687000
         BNO   @RF01338                                            1338 05688000
*                 VSDPRTC=WRITE;    /*                       @Z40LB26*/ 05689000
         MVC   VSDPRTC(4,@03),WRITE                                1339 05690000
*               ELSE                /*                       @Z40LB26*/ 05691000
*                 VSDPRTC=BLANK;    /*                       @Z40LB26*/ 05692000
         B     @RC01338                                            1340 05693000
@RF01338 LR    @03,ELEMENT                                         1340 05694000
         MH    @03,@CH01764                                        1340 05695000
         L     @01,LISTADDR                                        1340 05696000
         AL    @01,@CF01791                                        1340 05697000
         LA    @03,VSDVARY-64(@03,@01)                             1340 05698000
         MVI   VSDPRTC+1(@03),C' '                                 1340 05699000
         MVC   VSDPRTC+2(2,@03),VSDPRTC+1(@03)                     1340 05700000
         MVI   VSDPRTC(@03),C' '                                   1340 05701000
*             END;                  /*                       @Z40LB26*/ 05702000
*       END;                        /*                       @Z40LB26*/ 05703000
*     ELSE                          /*                       @Z40LB26*/ 05704000
*       VSDPRTC=BLANK;              /*                       @Z40LB26*/ 05705000
         B     @RC01325                                            1343 05706000
@RF01325 LR    @03,ELEMENT                                         1343 05707000
         MH    @03,@CH01764                                        1343 05708000
         L     @01,LISTADDR                                        1343 05709000
         AL    @01,@CF01791                                        1343 05710000
         LA    @03,VSDVARY-64(@03,@01)                             1343 05711000
         MVI   VSDPRTC+1(@03),C' '                                 1343 05712000
         MVC   VSDPRTC+2(2,@03),VSDPRTC+1(@03)                     1343 05713000
         MVI   VSDPRTC(@03),C' '                                   1343 05714000
*   END;                            /*                       @Z40LB26*/ 05715000
@RC01325 AL    ELEMENT,@CF00222                                    1344 05716000
@DE01293 L     @03,LISTADDR                                        1344 05717000
         C     ELEMENT,VSDELEM(,@03)                               1344 05718000
         BNH   @DL01293                                            1344 05719000
*                                                                  1345 05720000
*   /*****************************************************************/ 05721000
*   /*                                                               */ 05722000
*   /* ISSUE UPRINT WITH REPLICATION OPTION TO PRINT OUT     @Z40LB26*/ 05723000
*   /* THE ENTIRE MAIN BODY OF THE STATUS REPORT FOR ONE     @Z40LB26*/ 05724000
*   /* VOLUME IF THERE ARE ANY DATA SETS TO REPORT ON.       @Z40LB26*/ 05725000
*   /*                                                               */ 05726000
*   /*****************************************************************/ 05727000
*                                                                  1345 05728000
*   IF VSDELEM>0 THEN               /*                       @Z40LB26*/ 05729000
         L     @15,LISTADDR                                        1345 05730000
         L     @14,VSDELEM(,@15)                                   1345 05731000
         LTR   @14,@14                                             1345 05732000
         BNP   @RF01345                                            1345 05733000
*     DO;                           /*                       @Z40LB26*/ 05734000
*       DARGLIST=''B;               /*                       @Z40LB26*/ 05735000
         L     @03,DDSTRU                                          1347 05736000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1347 05737000
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/ 05738000
         MVC   DARGSMOD(3,@03),@CC01477                            1348 05739000
*       DARGSENT=MAINSTAT;          /*                       @Z40LB26*/ 05740000
         MVI   DARGSENT(@03),X'07'                                 1349 05741000
*       DARGDBP=ADDR(VSDARRAY(1));  /*                       @Z40LB26*/ 05742000
         LA    @02,VSDARRAY(,@15)                                  1350 05743000
         ST    @02,DARGDBP(,@03)                                   1350 05744000
*       DARGILP=VSDELEM*LENGTH(VSDARRAY(1));/*               @Z40LB26*/ 05745000
         LR    @15,@14                                             1351 05746000
         MH    @15,@CH01764                                        1351 05747000
         STH   @15,DARGILP(,@03)                                   1351 05748000
*       DARGCNT=1;                  /*                       @Z40LB26*/ 05749000
         MVC   DARGCNT(2,@03),@CH00222                             1352 05750000
*       DARGREP(1)=10;              /*                       @Z40LB26*/ 05751000
         MVC   DARGREP(2,@03),@CH00037                             1353 05752000
*       DARGPCT(1)=VSDELEM;         /*                       @Z40LB26*/ 05753000
         STH   @14,DARGPCT(,@03)                                   1354 05754000
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/ 05755000
         L     @15,@PC00001                                        1355 05756000
         ST    @15,@AL00001                                        1355 05757000
         LA    @14,PRINTIT                                         1355 05758000
         ST    @14,@AL00001+4                                      1355 05759000
         LA    @14,DDSTRU                                          1355 05760000
         ST    @14,@AL00001+8                                      1355 05761000
         MVI   @AL00001+8,X'80'                                    1355 05762000
         L     @15,GDTPRT(,@15)                                    1355 05763000
         LA    @01,@AL00001                                        1355 05764000
         BALR  @14,@15                                             1355 05765000
*     END;                          /*                       @Z40LB26*/ 05766000
*                                                                  1356 05767000
*   /*****************************************************************/ 05768000
*   /*                                                               */ 05769000
*   /* CALL ROUTINE TO PRINT OUT THE SUMMARY INFORMATION     @Z40LB26*/ 05770000
*   /* FOR A STATUS REPORT ON ONE VOLUME                     @Z40LB26*/ 05771000
*   /*                                                               */ 05772000
*   /*****************************************************************/ 05773000
*                                                                  1357 05774000
*   CALL STATSUM;                   /*                       @Z40LB26*/ 05775000
@RF01345 BAL   @14,STATSUM                                         1357 05776000
*   RETURN CODE(CC03);              /*                       @Z40LB26*/ 05777000
         LR    @15,CC03                                            1358 05778000
@EL00015 DS    0H                                                  1358 05779000
@EF00015 DS    0H                                                  1358 05780000
@ER00015 L     @14,@SA00015                                        1358 05781000
         BR    @14                                                 1358 05782000
*   END STATRPT;                    /*                       @Z40LB26*/ 05783000
*                                                                  1360 05784000
*/*********************************************************  @Z40LB26*/ 05785000
*/*                                                          @Z40LB26*/ 05786000
*/* PROCEDURE - USAGERPT                                     @Z40LB26*/ 05787000
*/*                                                          @Z40LB26*/ 05788000
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN BODY OF A     @Z40LB26*/ 05789000
*/*             USAGE REPORT IS TO BE PRODUCED.  IT ALSO     @Z40LB26*/ 05790000
*/*             KEEPS TRACK OF THE TOTAL TRACKS ALLOCATED    @Z40LB26*/ 05791000
*/*             TO THE DATA SETS LISTED ON THE REPORT.  IT   @Z40LB26*/ 05792000
*/*             CONVERTS FIELDS THAT CANNOT BE CONVERTED     @Z40LB26*/ 05793000
*/*             BY THE TEXT PROCESSOR.  IT THEN CALLS        @Z40LB26*/ 05794000
*/*             USAGESUM ROUTINE TO PRINT THE SUMMARY        @Z40LB26*/ 05795000
*/*             INFORMATION.                                 @Z40LB26*/ 05796000
*/*                                                          @Z40LB26*/ 05797000
*/*                                                          @Z40LB26*/ 05798000
*/* INPUT - SORTED LIST OF DATA SETS                         @Z40LB26*/ 05799000
*/*                                                          @Z40LB26*/ 05800000
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/ 05801000
*/*                                                          @Z40LB26*/ 05802000
*/*********************************************************  @Z40LB26*/ 05803000
*                                                                  1360 05804000
*USAGERPT:                                                         1360 05805000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 05806000
USAGERPT ST    @14,@SA00016                                        1360 05807000
*                                                                  1361 05808000
*   /*****************************************************************/ 05809000
*   /*                                                               */ 05810000
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/ 05811000
*   /*                                                               */ 05812000
*   /*****************************************************************/ 05813000
*                                                                  1361 05814000
*   OLDERID2=NEWERID2;                                             1361 05815000
         L     @15,@PC00001                                        1361 05816000
         L     @15,GDTTR2(,@15)                                    1361 05817000
         MVC   @TS00001(95),NEWERID2(@15)                          1361 05818000
         MVC   OLDERID2(95,@15),@TS00001                           1361 05819000
*   NEWID2='LDUR';                  /*                       @Z40LB26*/ 05820000
*                                                                  1362 05821000
         MVC   NEWID2(4,@15),@CC01693                              1362 05822000
*   /*****************************************************************/ 05823000
*   /*                                                               */ 05824000
*   /* SET CONDITION CODE INITIALLY                          @Z40LB26*/ 05825000
*   /*                                                               */ 05826000
*   /*****************************************************************/ 05827000
*                                                                  1363 05828000
*   CC03=LASTCC00;                  /*                       @Z40LB26*/ 05829000
*                                                                  1363 05830000
         SLR   @15,@15                                             1363 05831000
         LR    CC03,@15                                            1363 05832000
*   /*****************************************************************/ 05833000
*   /*                                                               */ 05834000
*   /* ZERO TOTAL TRACKS                                     @Z40LB26*/ 05835000
*   /*                                                               */ 05836000
*   /*****************************************************************/ 05837000
*                                                                  1364 05838000
*   TOTALTRK=0;                     /*                       @Z40LB26*/ 05839000
*                                                                  1364 05840000
         STH   @15,TOTALTRK                                        1364 05841000
*   /*****************************************************************/ 05842000
*   /*                                                               */ 05843000
*   /* SEE IF THERE ARE ANY DATA SETS IN THE LIST            @Z40LB26*/ 05844000
*   /* TO BE PROCESSED. LOOP THEM IF THERE ARE.              @Z40LB26*/ 05845000
*   /*                                                               */ 05846000
*   /*****************************************************************/ 05847000
*                                                                  1365 05848000
*   DO ELEMENT=1 TO VSDELEM;        /*                       @Z40LB26*/ 05849000
*                                                                  1365 05850000
         LA    ELEMENT,1                                           1365 05851000
         B     @DE01365                                            1365 05852000
@DL01365 DS    0H                                                  1366 05853000
*     /***************************************************************/ 05854000
*     /*                                                             */ 05855000
*     /* CONVERT OR SET UP FIELDS THAT CANNOT BE HANDLED     @Z40LB26*/ 05856000
*     /* BY THE TEXT PROCESSOR                               @Z40LB26*/ 05857000
*     /* SET UP THE DATA SET ORGANIZATION                    @Z40LB26*/ 05858000
*     /*                                                             */ 05859000
*     /***************************************************************/ 05860000
*                                                                  1366 05861000
*     IF VSDOPO=ON THEN             /*                       @Z40LB26*/ 05862000
         LR    @03,ELEMENT                                         1366 05863000
         MH    @03,@CH01764                                        1366 05864000
         L     @01,LISTADDR                                        1366 05865000
         AL    @01,@CF01791                                        1366 05866000
         LA    @03,VSDVARY-64(@03,@01)                             1366 05867000
         TM    VSDOPO(@03),B'10000000'                             1366 05868000
         BNO   @RF01366                                            1366 05869000
*       VSDDSORG=PARTORG;           /*                       @Z40LB26*/ 05870000
         MVC   VSDDSORG(3,@03),PARTORG                             1367 05871000
*     ELSE                          /*                       @Z40LB26*/ 05872000
*       IF VSDOPS=ON THEN           /*                       @Z40LB26*/ 05873000
         B     @RC01366                                            1368 05874000
@RF01366 LR    @03,ELEMENT                                         1368 05875000
         MH    @03,@CH01764                                        1368 05876000
         L     @01,LISTADDR                                        1368 05877000
         AL    @01,@CF01791                                        1368 05878000
         LA    @03,VSDVARY-64(@03,@01)                             1368 05879000
         TM    VSDOPS(@03),B'01000000'                             1368 05880000
         BNO   @RF01368                                            1368 05881000
*         VSDDSORG=PHYSEQ;          /*                       @Z40LB26*/ 05882000
         MVC   VSDDSORG(3,@03),PHYSEQ                              1369 05883000
*       ELSE                        /*                       @Z40LB26*/ 05884000
*         IF VSDOUN=ON THEN         /*                       @Z40LB26*/ 05885000
         B     @RC01368                                            1370 05886000
@RF01368 LR    @03,ELEMENT                                         1370 05887000
         MH    @03,@CH01764                                        1370 05888000
         L     @01,LISTADDR                                        1370 05889000
         AL    @01,@CF01791                                        1370 05890000
         LA    @03,VSDVARY-64(@03,@01)                             1370 05891000
         TM    VSDOUN(@03),B'00100000'                             1370 05892000
         BNO   @RF01370                                            1370 05893000
*           VSDDSORG=UNKN;          /*                       @Z40LB26*/ 05894000
         MVC   VSDDSORG(3,@03),UNKN                                1371 05895000
*         ELSE                      /*                       @Z40LB26*/ 05896000
*           IF VSDODA=ON THEN       /*                       @Z40LB26*/ 05897000
         B     @RC01370                                            1372 05898000
@RF01370 LR    @03,ELEMENT                                         1372 05899000
         MH    @03,@CH01764                                        1372 05900000
         L     @01,LISTADDR                                        1372 05901000
         AL    @01,@CF01791                                        1372 05902000
         LA    @03,VSDVARY-64(@03,@01)                             1372 05903000
         TM    VSDODA(@03),B'00010000'                             1372 05904000
         BNO   @RF01372                                            1372 05905000
*             VSDDSORG=DIRACC;      /*                       @Z40LB26*/ 05906000
         MVC   VSDDSORG(3,@03),DIRACC                              1373 05907000
*           ELSE                    /*                       @Z40LB26*/ 05908000
*             IF VSDOIS=ON THEN     /*                       @Z40LB26*/ 05909000
         B     @RC01372                                            1374 05910000
@RF01372 LR    @03,ELEMENT                                         1374 05911000
         MH    @03,@CH01764                                        1374 05912000
         L     @01,LISTADDR                                        1374 05913000
         AL    @01,@CF01791                                        1374 05914000
         LA    @03,VSDVARY-64(@03,@01)                             1374 05915000
         TM    VSDOIS(@03),B'00001000'                             1374 05916000
         BNO   @RF01374                                            1374 05917000
*               VSDDSORG=INDSEQ;    /*                       @Z40LB26*/ 05918000
*                                                                  1375 05919000
         MVC   VSDDSORG(3,@03),INDSEQ                              1375 05920000
*     /***************************************************************/ 05921000
*     /*                                                             */ 05922000
*     /* FOR ALL DATA SET ORGANIZATIONS EXCEPT UNKNOWN,      @Z40LB26*/ 05923000
*     /* CHECK IF THE DATA SET IS UNMOVEABLE + SET UP        @Z40LB26*/ 05924000
*     /* TO PRINT A "U" IF IT IS.                            @Z40LB26*/ 05925000
*     /*                                                             */ 05926000
*     /***************************************************************/ 05927000
*                                                                  1376 05928000
*     IF VSDOUN=OFF&VSDOU=ON THEN   /*                       @Z40LB26*/ 05929000
@RF01374 DS    0H                                                  1376 05930000
@RC01372 DS    0H                                                  1376 05931000
@RC01370 DS    0H                                                  1376 05932000
@RC01368 DS    0H                                                  1376 05933000
@RC01366 LR    @03,ELEMENT                                         1376 05934000
         MH    @03,@CH01764                                        1376 05935000
         L     @01,LISTADDR                                        1376 05936000
         AL    @01,@CF01791                                        1376 05937000
         LA    @03,VSDVARY-64(@03,@01)                             1376 05938000
         TM    VSDOU(@03),B'00000100'                              1376 05939000
         BNO   @RF01376                                            1376 05940000
         TM    VSDOUN(@03),B'00100000'                             1376 05941000
         BNZ   @RF01376                                            1376 05942000
*       VSDDSOR3=UNMOVE;            /*                       @Z40LB26*/ 05943000
*                                                                  1377 05944000
         MVC   VSDDSOR3(1,@03),UNMOVE                              1377 05945000
*     /***************************************************************/ 05946000
*     /*                                                             */ 05947000
*     /* SET UP ALLOCATION UNIT                              @Z40LB26*/ 05948000
*     /*                                                             */ 05949000
*     /***************************************************************/ 05950000
*                                                                  1378 05951000
*     IF VSDACYL=ON THEN            /*                       @Z40LB26*/ 05952000
@RF01376 LR    @03,ELEMENT                                         1378 05953000
         MH    @03,@CH01764                                        1378 05954000
         L     @01,LISTADDR                                        1378 05955000
         AL    @01,@CF01791                                        1378 05956000
         LA    @03,VSDVARY-64(@03,@01)                             1378 05957000
         TM    VSDACYL(@03),B'10000000'                            1378 05958000
         BNO   @RF01378                                            1378 05959000
*       VSDALLC=CYLINDER;           /*                       @Z40LB26*/ 05960000
         MVC   VSDALLC(5,@03),CYLINDER                             1379 05961000
*     ELSE                          /*                       @Z40LB26*/ 05962000
*       IF VSDATRK=ON THEN          /*                       @Z40LB26*/ 05963000
         B     @RC01378                                            1380 05964000
@RF01378 LR    @03,ELEMENT                                         1380 05965000
         MH    @03,@CH01764                                        1380 05966000
         L     @01,LISTADDR                                        1380 05967000
         AL    @01,@CF01791                                        1380 05968000
         LA    @03,VSDVARY-64(@03,@01)                             1380 05969000
         TM    VSDATRK(@03),B'01000000'                            1380 05970000
         BNO   @RF01380                                            1380 05971000
*         VSDALLC=TRACK;            /*                       @Z40LB26*/ 05972000
         MVC   VSDALLC(5,@03),TRACK                                1381 05973000
*       ELSE                        /*                       @Z40LB26*/ 05974000
*         IF VSDABLK=ON THEN        /*                       @Z40LB26*/ 05975000
         B     @RC01380                                            1382 05976000
@RF01380 LR    @03,ELEMENT                                         1382 05977000
         MH    @03,@CH01764                                        1382 05978000
         L     @01,LISTADDR                                        1382 05979000
         AL    @01,@CF01791                                        1382 05980000
         LA    @03,VSDVARY-64(@03,@01)                             1382 05981000
         TM    VSDABLK(@03),B'00100000'                            1382 05982000
         BNO   @RF01382                                            1382 05983000
*           VSDALLC=BLOCK;          /*                       @Z40LB26*/ 05984000
         MVC   VSDALLC(5,@03),BLOCK                                1383 05985000
*         ELSE                      /*                       @Z40LB26*/ 05986000
*           IF VSDABSTR=ON THEN     /*                       @Z40LB26*/ 05987000
         B     @RC01382                                            1384 05988000
@RF01382 LR    @03,ELEMENT                                         1384 05989000
         MH    @03,@CH01764                                        1384 05990000
         L     @01,LISTADDR                                        1384 05991000
         AL    @01,@CF01791                                        1384 05992000
         LA    @03,VSDVARY-64(@03,@01)                             1384 05993000
         TM    VSDABSTR(@03),B'00010000'                           1384 05994000
         BNO   @RF01384                                            1384 05995000
*             VSDALLC=ABSOLUTE;     /*                       @Z40LB26*/ 05996000
*                                                                  1385 05997000
         MVC   VSDALLC(5,@03),ABSOLUTE                             1385 05998000
*     /***************************************************************/ 05999000
*     /*                                                             */ 06000000
*     /* CHECK SECONDARY ALLOCATION. IF MORE THAN 9999       @Z40LB26*/ 06001000
*     /* INSERT BLANKS.                                      @Z40LB26*/ 06002000
*     /*                                                             */ 06003000
*     /***************************************************************/ 06004000
*                                                                  1386 06005000
*     IF VSDSECAL>MAXALLOC THEN     /*                       @Z40LB26*/ 06006000
@RF01384 DS    0H                                                  1386 06007000
@RC01382 DS    0H                                                  1386 06008000
@RC01380 DS    0H                                                  1386 06009000
@RC01378 LR    @03,ELEMENT                                         1386 06010000
         MH    @03,@CH01764                                        1386 06011000
         L     @01,LISTADDR                                        1386 06012000
         AL    @01,@CF01791                                        1386 06013000
         LA    @03,VSDVARY-64(@03,@01)                             1386 06014000
         L     @15,VSDSECAL(,@03)                                  1386 06015000
         C     @15,@CF01408                                        1386 06016000
         BNH   @RF01386                                            1386 06017000
*       VSDSCAL=BLANK;              /*                       @Z40LB26*/ 06018000
         MVI   VSDSCAL+1(@03),C' '                                 1387 06019000
         MVC   VSDSCAL+2(2,@03),VSDSCAL+1(@03)                     1387 06020000
         MVI   VSDSCAL(@03),C' '                                   1387 06021000
*     ELSE                          /*                       @Z40LB26*/ 06022000
*       DO;                         /*                       @Z40LB26*/ 06023000
*                                                                  1388 06024000
         B     @RC01386                                            1388 06025000
@RF01386 DS    0H                                                  1389 06026000
*         /***********************************************************/ 06027000
*         /*                                                         */ 06028000
*         /* CONVERT FIELD TO DECIMAL                        @Z40LB26*/ 06029000
*         /*                                                         */ 06030000
*         /***********************************************************/ 06031000
*                                                                  1389 06032000
*         CVD(VSDSECAL,HOLD4CHR);   /*                       @Z40LB26*/ 06033000
*                                                                  1389 06034000
         LR    @03,ELEMENT                                         1389 06035000
         MH    @03,@CH01764                                        1389 06036000
         L     @01,LISTADDR                                        1389 06037000
         AL    @01,@CF01791                                        1389 06038000
         LA    @03,VSDVARY-64(@03,@01)                             1389 06039000
         L     @15,VSDSECAL(,@03)                                  1389 06040000
         CVD   @15,@TS00001                                        1389 06041000
         MVC   HOLD4CHR(4),@TS00001+4                              1389 06042000
*         /***********************************************************/ 06043000
*         /*                                                         */ 06044000
*         /* UNPACK                                          @Z40LB26*/ 06045000
*         /*                                                         */ 06046000
*         /***********************************************************/ 06047000
*                                                                  1390 06048000
*         UNPK(VSDSCAL,HOLD4CHR);   /*                       @Z40LB26*/ 06049000
*                                                                  1390 06050000
         UNPK  VSDSCAL(4,@03),HOLD4CHR(4)                          1390 06051000
*         /***********************************************************/ 06052000
*         /*                                                         */ 06053000
*         /* GET RID OF SIGN IN FOURTH BYTE SO IT            @Z40LB26*/ 06054000
*         /* WILL PRINT                                      @Z40LB26*/ 06055000
*         /*                                                         */ 06056000
*         /***********************************************************/ 06057000
*                                                                  1391 06058000
*         VSDSCAL(4)=VSDSCAL(4)|ORIT;/*                      @Z40LB26*/ 06059000
*                                                                  1391 06060000
         OI    VSDSCAL+3(@03),C'0'                                 1391 06061000
*         /***********************************************************/ 06062000
*         /*                                                         */ 06063000
*         /* SUPPRESS LEADING ZEROES                         @Z40LB26*/ 06064000
*         /*                                                         */ 06065000
*         /***********************************************************/ 06066000
*                                                                  1392 06067000
*         DO SUPCNT=1 TO 3 WHILE    /*                       @Z40LB26*/ 06068000
*               VSDSCAL(SUPCNT)=CHARZERO;/*                  @Z40LB26*/ 06069000
         LA    SUPCNT,1                                            1392 06070000
@DL01392 LR    @15,ELEMENT                                         1392 06071000
         MH    @15,@CH01764                                        1392 06072000
         L     @01,LISTADDR                                        1392 06073000
         AL    @01,@CF01791                                        1392 06074000
         LA    @15,VSDVARY-64(@15,@01)                             1392 06075000
         LR    @14,@15                                             1392 06076000
         ALR   @14,SUPCNT                                          1392 06077000
         CLI   VSDSCAL-1(@14),C'0'                                 1392 06078000
         BNE   @DC01392                                            1392 06079000
*           VSDSCAL(SUPCNT)=BLANK;  /*                       @Z40LB26*/ 06080000
         ALR   @15,SUPCNT                                          1393 06081000
         MVI   VSDSCAL-1(@15),C' '                                 1393 06082000
*         END;                      /*                       @Z40LB26*/ 06083000
         AL    SUPCNT,@CF00222                                     1394 06084000
         C     SUPCNT,@CF00165                                     1394 06085000
         BNH   @DL01392                                            1394 06086000
@DC01392 DS    0H                                                  1395 06087000
*       END;                        /*                       @Z40LB26*/ 06088000
*                                                                  1395 06089000
*     /***************************************************************/ 06090000
*     /*                                                             */ 06091000
*     /* TAKE CARE OF FREE TRACKS CONVERSION. IF FREE        @Z40LB26*/ 06092000
*     /* TRACKS COULD NOT BE CALCULATED, SET UP TO PRINT     @Z40LB26*/ 06093000
*     /* BLANKS.                                             @Z40LB26*/ 06094000
*     /*                                                             */ 06095000
*     /***************************************************************/ 06096000
*                                                                  1396 06097000
*     IF VSDCALFR=ON THEN           /*                       @Z40LB26*/ 06098000
@RC01386 LR    @03,ELEMENT                                         1396 06099000
         MH    @03,@CH01764                                        1396 06100000
         L     @01,LISTADDR                                        1396 06101000
         AL    @01,@CF01791                                        1396 06102000
         LA    @03,VSDVARY-64(@03,@01)                             1396 06103000
         TM    VSDCALFR(@03),B'10000000'                           1396 06104000
         BNO   @RF01396                                            1396 06105000
*       VSDFREE=BLANK;              /*                       @Z40LB26*/ 06106000
         MVI   VSDFREE+1(@03),C' '                                 1397 06107000
         MVC   VSDFREE+2(2,@03),VSDFREE+1(@03)                     1397 06108000
         MVI   VSDFREE(@03),C' '                                   1397 06109000
*     ELSE                          /*                       @Z40LB26*/ 06110000
*       DO;                         /*                       @Z40LB26*/ 06111000
*                                                                  1398 06112000
         B     @RC01396                                            1398 06113000
@RF01396 DS    0H                                                  1399 06114000
*         /***********************************************************/ 06115000
*         /*                                                         */ 06116000
*         /* CONVERT FIELD TO DECIMAL                        @Z40LB26*/ 06117000
*         /*                                                         */ 06118000
*         /***********************************************************/ 06119000
*                                                                  1399 06120000
*         CVD(VSDFTRK,HOLD4CHR);    /*                       @Z40LB26*/ 06121000
*                                                                  1399 06122000
         LR    @03,ELEMENT                                         1399 06123000
         MH    @03,@CH01764                                        1399 06124000
         L     @01,LISTADDR                                        1399 06125000
         AL    @01,@CF01791                                        1399 06126000
         LA    @03,VSDVARY-64(@03,@01)                             1399 06127000
         LH    @15,VSDFTRK(,@03)                                   1399 06128000
         CVD   @15,@TS00001                                        1399 06129000
         MVC   HOLD4CHR(4),@TS00001+4                              1399 06130000
*         /***********************************************************/ 06131000
*         /*                                                         */ 06132000
*         /* UNPACK                                          @Z40LB26*/ 06133000
*         /*                                                         */ 06134000
*         /***********************************************************/ 06135000
*                                                                  1400 06136000
*         UNPK(VSDFREE,HOLD4CHR);   /*                       @Z40LB26*/ 06137000
*                                                                  1400 06138000
         UNPK  VSDFREE(4,@03),HOLD4CHR(4)                          1400 06139000
*         /***********************************************************/ 06140000
*         /*                                                         */ 06141000
*         /* GET RID OF SIGN IN FOURTH BYTE SO IT            @Z40LB26*/ 06142000
*         /* WILL PRINT                                      @Z40LB26*/ 06143000
*         /*                                                         */ 06144000
*         /***********************************************************/ 06145000
*                                                                  1401 06146000
*         VSDFREE(4)=VSDFREE(4)|ORIT;/*                      @Z40LB26*/ 06147000
*                                                                  1401 06148000
         OI    VSDFREE+3(@03),C'0'                                 1401 06149000
*         /***********************************************************/ 06150000
*         /*                                                         */ 06151000
*         /* SUPPRESS LEADING ZEROES                         @Z40LB26*/ 06152000
*         /*                                                         */ 06153000
*         /***********************************************************/ 06154000
*                                                                  1402 06155000
*         DO SUPCNT=1 TO 3 WHILE    /*                       @Z40LB26*/ 06156000
*               VSDFREE(SUPCNT)=CHARZERO;/*                  @Z40LB26*/ 06157000
         LA    SUPCNT,1                                            1402 06158000
@DL01402 LR    @15,ELEMENT                                         1402 06159000
         MH    @15,@CH01764                                        1402 06160000
         L     @01,LISTADDR                                        1402 06161000
         AL    @01,@CF01791                                        1402 06162000
         LA    @15,VSDVARY-64(@15,@01)                             1402 06163000
         LR    @14,@15                                             1402 06164000
         ALR   @14,SUPCNT                                          1402 06165000
         CLI   VSDFREE-1(@14),C'0'                                 1402 06166000
         BNE   @DC01402                                            1402 06167000
*           VSDFREE(SUPCNT)=BLANK;  /*                       @Z40LB26*/ 06168000
         ALR   @15,SUPCNT                                          1403 06169000
         MVI   VSDFREE-1(@15),C' '                                 1403 06170000
*         END;                      /*                       @Z40LB26*/ 06171000
         AL    SUPCNT,@CF00222                                     1404 06172000
         C     SUPCNT,@CF00165                                     1404 06173000
         BNH   @DL01402                                            1404 06174000
@DC01402 DS    0H                                                  1405 06175000
*       END;                        /*                       @Z40LB26*/ 06176000
*                                                                  1405 06177000
*     /***************************************************************/ 06178000
*     /*                                                             */ 06179000
*     /* KEEP A RUNNING TOTAL OF THE TOTAL TRACKS ALLOCATED  @Z40LB26*/ 06180000
*     /* TO DATA SETS LISTED                                 @Z40LB26*/ 06181000
*     /*                                                             */ 06182000
*     /***************************************************************/ 06183000
*                                                                  1406 06184000
*     TOTALTRK=TOTALTRK+VSDTRKS;    /*                       @Z40LB26*/ 06185000
@RC01396 LR    @03,ELEMENT                                         1406 06186000
         MH    @03,@CH01764                                        1406 06187000
         L     @01,LISTADDR                                        1406 06188000
         AL    @01,@CF01791                                        1406 06189000
         LA    @03,VSDVARY-64(@03,@01)                             1406 06190000
         LH    @15,TOTALTRK                                        1406 06191000
         AH    @15,VSDTRKS(,@03)                                   1406 06192000
         STH   @15,TOTALTRK                                        1406 06193000
*   END;                            /*                       @Z40LB26*/ 06194000
*                                                                  1407 06195000
         AL    ELEMENT,@CF00222                                    1407 06196000
@DE01365 L     @03,LISTADDR                                        1407 06197000
         C     ELEMENT,VSDELEM(,@03)                               1407 06198000
         BNH   @DL01365                                            1407 06199000
*   /*****************************************************************/ 06200000
*   /*                                                               */ 06201000
*   /* ISSUE UPRINT WITH REPLICATION OPTION TO PRINT MAIN    @Z40LB26*/ 06202000
*   /* BODY OF REPORT FOR ONE VOLUME IF THERE ARE ANY DATA   @Z40LB26*/ 06203000
*   /* SETS TO REPORT ON.                                    @Z40LB26*/ 06204000
*   /*                                                               */ 06205000
*   /*****************************************************************/ 06206000
*                                                                  1408 06207000
*   IF VSDELEM>0 THEN               /*                       @Z40LB26*/ 06208000
         L     @15,LISTADDR                                        1408 06209000
         L     @14,VSDELEM(,@15)                                   1408 06210000
         LTR   @14,@14                                             1408 06211000
         BNP   @RF01408                                            1408 06212000
*     DO;                           /*                       @Z40LB26*/ 06213000
*       DARGLIST=''B;               /*                       @Z40LB26*/ 06214000
         L     @03,DDSTRU                                          1410 06215000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1410 06216000
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/ 06217000
         MVC   DARGSMOD(3,@03),@CC01477                            1411 06218000
*       DARGSENT=MAINUSE;           /*                       @Z40LB26*/ 06219000
         MVI   DARGSENT(@03),X'06'                                 1412 06220000
*       DARGDBP=ADDR(VSDARRAY(1));  /*                       @Z40LB26*/ 06221000
         LA    @02,VSDARRAY(,@15)                                  1413 06222000
         ST    @02,DARGDBP(,@03)                                   1413 06223000
*       DARGILP=VSDELEM*LENGTH(VSDARRAY);/*                  @Z40LB26*/ 06224000
         LR    @15,@14                                             1414 06225000
         MH    @15,@CH01764                                        1414 06226000
         STH   @15,DARGILP(,@03)                                   1414 06227000
*       DARGCNT=1;                  /*                       @Z40LB26*/ 06228000
         MVC   DARGCNT(2,@03),@CH00222                             1415 06229000
*       DARGREP(1)=10;              /*                       @Z40LB26*/ 06230000
         MVC   DARGREP(2,@03),@CH00037                             1416 06231000
*       DARGPCT(1)=VSDELEM;         /*                       @Z40LB26*/ 06232000
         STH   @14,DARGPCT(,@03)                                   1417 06233000
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/ 06234000
         L     @15,@PC00001                                        1418 06235000
         ST    @15,@AL00001                                        1418 06236000
         LA    @14,PRINTIT                                         1418 06237000
         ST    @14,@AL00001+4                                      1418 06238000
         LA    @14,DDSTRU                                          1418 06239000
         ST    @14,@AL00001+8                                      1418 06240000
         MVI   @AL00001+8,X'80'                                    1418 06241000
         L     @15,GDTPRT(,@15)                                    1418 06242000
         LA    @01,@AL00001                                        1418 06243000
         BALR  @14,@15                                             1418 06244000
*     END;                          /*                       @Z40LB26*/ 06245000
*                                                                  1419 06246000
*   /*****************************************************************/ 06247000
*   /*                                                               */ 06248000
*   /* CALL ROUTINE TO PRINT OUT THE SUMMARY INFORMATION     @Z40LB26*/ 06249000
*   /* FOR A USAGE REPORT ON ONE VOLUME                      @Z40LB26*/ 06250000
*   /*                                                               */ 06251000
*   /*****************************************************************/ 06252000
*                                                                  1420 06253000
*   CALL USAGESUM;                  /*                       @Z40LB26*/ 06254000
@RF01408 BAL   @14,USAGESUM                                        1420 06255000
*   RETURN CODE(CC03);              /*                       @Z40LB26*/ 06256000
         LR    @15,CC03                                            1421 06257000
@EL00016 DS    0H                                                  1421 06258000
@EF00016 DS    0H                                                  1421 06259000
@ER00016 L     @14,@SA00016                                        1421 06260000
         BR    @14                                                 1421 06261000
*   END USAGERPT;                   /*                       @Z40LB26*/ 06262000
*                                                                  1423 06263000
*/*********************************************************  @Z40LB26*/ 06264000
*/*                                                          @Z40LB26*/ 06265000
*/* PROCEDURE - STATSUM                                      @Z40LB26*/ 06266000
*/*                                                          @Z40LB26*/ 06267000
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN SECTION OF A  @Z40LB26*/ 06268000
*/*             STATUS REPORT HAS BEEN MADE FOR A VOLUME.    @Z40LB26*/ 06269000
*/*             THIS PROCEDURE PRINTS THE SUMMARY INFORMA-   @Z40LB26*/ 06270000
*/*             TION FOR A PARTICULAR VOLUME ON A STATUS     @Z40LB26*/ 06271000
*/*             REPORT.                                      @Z40LB26*/ 06272000
*/*                                                          @Z40LB26*/ 06273000
*/* INPUT - TOTAL NUMBER OF DATA SETS FIELD IN VSDBLOCK.     @Z40LB26*/ 06274000
*/*                                                          @Z40LB26*/ 06275000
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/ 06276000
*/*                                                          @Z40LB26*/ 06277000
*/*********************************************************  @Z40LB26*/ 06278000
*                                                                  1423 06279000
*STATSUM:                                                          1423 06280000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 06281000
STATSUM  ST    @14,@SA00017                                        1423 06282000
*                                                                  1424 06283000
*   /*****************************************************************/ 06284000
*   /*                                                               */ 06285000
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/ 06286000
*   /*                                                               */ 06287000
*   /*****************************************************************/ 06288000
*                                                                  1424 06289000
*   OLDERID2=NEWERID2;                                             1424 06290000
         L     @03,@PC00001                                        1424 06291000
         L     @15,GDTTR2(,@03)                                    1424 06292000
         MVC   @TS00001(95),NEWERID2(@15)                          1424 06293000
         MVC   OLDERID2(95,@15),@TS00001                           1424 06294000
*   NEWID2='LDSS';                  /*                       @Z40LB26*/ 06295000
*                                                                  1425 06296000
         MVC   NEWID2(4,@15),@CC01698                              1425 06297000
*   /*****************************************************************/ 06298000
*   /*                                                               */ 06299000
*   /* SET CONDITION CODE                                    @Z40LB26*/ 06300000
*   /*                                                               */ 06301000
*   /*****************************************************************/ 06302000
*                                                                  1426 06303000
*   CC04=LASTCC00;                  /*                       @Z40LB26*/ 06304000
*                                                                  1426 06305000
         SLR   CC04,CC04                                           1426 06306000
*   /*****************************************************************/ 06307000
*   /*                                                               */ 06308000
*   /* SET UP DARGLIST TO PRINT SUMMARY LINE                 @Z40LB26*/ 06309000
*   /*                                                               */ 06310000
*   /*****************************************************************/ 06311000
*                                                                  1427 06312000
*   DARGLIST=''B;                   /*                       @Z40LB26*/ 06313000
         L     @15,DDSTRU                                          1427 06314000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1427 06315000
*   DARGSMOD=LD01TXT;               /*                       @Z40LB26*/ 06316000
         MVC   DARGSMOD(3,@15),@CC01477                            1428 06317000
*   DARGSENT=STASUM;                /*                       @Z40LB26*/ 06318000
         MVI   DARGSENT(@15),X'09'                                 1429 06319000
*   DARGDBP=ADDR(VSDELEM);          /*                       @Z40LB26*/ 06320000
         L     @14,LISTADDR                                        1430 06321000
         ST    @14,DARGDBP(,@15)                                   1430 06322000
*   DARGILP=LENGTH(VSDELEM);        /*                       @Z40LB26*/ 06323000
*                                                                  1431 06324000
         MVC   DARGILP(2,@15),@CH00043                             1431 06325000
*   /*****************************************************************/ 06326000
*   /*                                                               */ 06327000
*   /* PRINT OUT SUMMARY LINE                                @Z40LB26*/ 06328000
*   /*                                                               */ 06329000
*   /*****************************************************************/ 06330000
*                                                                  1432 06331000
*   CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*                  @Z40LB26*/ 06332000
*                                                                  1432 06333000
         ST    @03,@AL00001                                        1432 06334000
         LA    @15,PRINTIT                                         1432 06335000
         ST    @15,@AL00001+4                                      1432 06336000
         LA    @15,DDSTRU                                          1432 06337000
         ST    @15,@AL00001+8                                      1432 06338000
         MVI   @AL00001+8,X'80'                                    1432 06339000
         L     @15,GDTPRT(,@03)                                    1432 06340000
         LA    @01,@AL00001                                        1432 06341000
         BALR  @14,@15                                             1432 06342000
*   /*****************************************************************/ 06343000
*   /*                                                               */ 06344000
*   /* ISSUE URESET TO GET RID OF OLD SUB-TITLE AND          @Z40LB26*/ 06345000
*   /* HEADER LINES                                          @Z40LB26*/ 06346000
*   /*                                                               */ 06347000
*   /*****************************************************************/ 06348000
*                                                                  1433 06349000
*   CALL AMSTP044(GDTTBL,PRINTIT);  /*                       @Z40LB26*/ 06350000
*                                                                  1433 06351000
         L     @03,@PC00001                                        1433 06352000
         ST    @03,@AL00001                                        1433 06353000
         LA    @15,PRINTIT                                         1433 06354000
         ST    @15,@AL00001+4                                      1433 06355000
         MVI   @AL00001+4,X'80'                                    1433 06356000
         L     @15,GDTRES(,@03)                                    1433 06357000
         LA    @01,@AL00001                                        1433 06358000
         BALR  @14,@15                                             1433 06359000
*   /*****************************************************************/ 06360000
*   /*                                                               */ 06361000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 06362000
*   /*                                                               */ 06363000
*   /*****************************************************************/ 06364000
*                                                                  1434 06365000
*   RETURN CODE(CC04);              /*                       @Z40LB26*/ 06366000
         LR    @15,CC04                                            1434 06367000
@EL00017 DS    0H                                                  1434 06368000
@EF00017 DS    0H                                                  1434 06369000
@ER00017 L     @14,@SA00017                                        1434 06370000
         BR    @14                                                 1434 06371000
*   END STATSUM;                    /*                       @Z40LB26*/ 06372000
*                                                                  1436 06373000
*/*********************************************************  @Z40LB26*/ 06374000
*/*                                                          @Z40LB26*/ 06375000
*/* PROCEDURE - USAGESUM                                     @Z40LB26*/ 06376000
*/*                                                          @Z40LB26*/ 06377000
*/* FUNCTION -  RECEIVES CONTROL WHEN THE MAIN SECTION OF A  @Z40LB26*/ 06378000
*/*             USAGE REPORT HAS BEEN MADE FOR A VOLUME.     @Z40LB26*/ 06379000
*/*             THIS PROCEDURE PRINTS THE SUMMARY INFOR-     @Z40LB26*/ 06380000
*/*             TION FOR A PARTICULAR VOLUME ON A SPACE      @Z40LB26*/ 06381000
*/*             USAGE REPORT                                 @Z40LB26*/ 06382000
*/*                                                          @Z40LB26*/ 06383000
*/* INPUT - TOTAL TRACKS FOR LISTED DATA SETS(TOTALTRK).     @Z40LB26*/ 06384000
*/*         DATA SET LIST(VSDBLOCK)                          @Z40LB26*/ 06385000
*/*                                                          @Z40LB26*/ 06386000
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/ 06387000
*/*                                                          @Z40LB26*/ 06388000
*/********************************************************** @Z40LB26*/ 06389000
*                                                                  1436 06390000
*USAGESUM:                                                         1436 06391000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 06392000
USAGESUM ST    @14,@SA00018                                        1436 06393000
*                                                                  1437 06394000
*   /*****************************************************************/ 06395000
*   /*                                                               */ 06396000
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/ 06397000
*   /*                                                               */ 06398000
*   /*****************************************************************/ 06399000
*                                                                  1437 06400000
*   OLDERID2=NEWERID2;                                             1437 06401000
         L     @03,@PC00001                                        1437 06402000
         L     @03,GDTTR2(,@03)                                    1437 06403000
         MVC   @TS00001(95),NEWERID2(@03)                          1437 06404000
         MVC   OLDERID2(95,@03),@TS00001                           1437 06405000
*   NEWID2='LDUS';                  /*                       @Z40LB26*/ 06406000
*                                                                  1438 06407000
         MVC   NEWID2(4,@03),@CC01702                              1438 06408000
*   /*****************************************************************/ 06409000
*   /*                                                               */ 06410000
*   /* SET CONDITION CODE                                    @Z40LB26*/ 06411000
*   /*                                                               */ 06412000
*   /*****************************************************************/ 06413000
*                                                                  1439 06414000
*   CC04=LASTCC00;                  /*                       @Z40LB26*/ 06415000
*                                                                  1439 06416000
         SLR   CC04,CC04                                           1439 06417000
*   /*****************************************************************/ 06418000
*   /*                                                               */ 06419000
*   /* SUPPRESS LEADING ZEROES IN THE ALREADY CONVERTED      @Z40LB26*/ 06420000
*   /* INFORMATION.                                          @Z40LB26*/ 06421000
*   /* TOTAL FREE CYLINDERS ON VOLUME                        @Z40LB26*/ 06422000
*   /*                                                               */ 06423000
*   /*****************************************************************/ 06424000
*                                                                  1440 06425000
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/ 06426000
*         VSDFRCYL(SUPCNT)=CHARZERO;/*                       @Z40LB26*/ 06427000
         LA    SUPCNT,1                                            1440 06428000
@DL01440 L     @01,LISTADDR                                        1440 06429000
         L     @15,VSDSPACE(,@01)                                  1440 06430000
         LR    @14,@15                                             1440 06431000
         ALR   @14,SUPCNT                                          1440 06432000
         CLI   VSDFRCYL-1(@14),C'0'                                1440 06433000
         BNE   @DC01440                                            1440 06434000
*     VSDFRCYL(SUPCNT)=BLANK;       /*                       @Z40LB26*/ 06435000
         ALR   @15,SUPCNT                                          1441 06436000
         MVI   VSDFRCYL-1(@15),C' '                                1441 06437000
*   END;                            /*                       @Z40LB26*/ 06438000
*                                                                  1442 06439000
         AL    SUPCNT,@CF00222                                     1442 06440000
         C     SUPCNT,@CF00165                                     1442 06441000
         BNH   @DL01440                                            1442 06442000
@DC01440 DS    0H                                                  1443 06443000
*   /*****************************************************************/ 06444000
*   /*                                                               */ 06445000
*   /* FREE TRACKS                                           @Z40LB26*/ 06446000
*   /*                                                               */ 06447000
*   /*****************************************************************/ 06448000
*                                                                  1443 06449000
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/ 06450000
*         VSDFRTRK(SUPCNT)=CHARZERO;/*                       @Z40LB26*/ 06451000
         LA    SUPCNT,1                                            1443 06452000
@DL01443 L     @01,LISTADDR                                        1443 06453000
         L     @15,VSDSPACE(,@01)                                  1443 06454000
         LR    @14,@15                                             1443 06455000
         ALR   @14,SUPCNT                                          1443 06456000
         CLI   VSDFRTRK-1(@14),C'0'                                1443 06457000
         BNE   @DC01443                                            1443 06458000
*     VSDFRTRK(SUPCNT)=BLANK;       /*                       @Z40LB26*/ 06459000
         ALR   @15,SUPCNT                                          1444 06460000
         MVI   VSDFRTRK-1(@15),C' '                                1444 06461000
*   END;                            /*                       @Z40LB26*/ 06462000
*                                                                  1445 06463000
         AL    SUPCNT,@CF00222                                     1445 06464000
         C     SUPCNT,@CF00165                                     1445 06465000
         BNH   @DL01443                                            1445 06466000
@DC01443 DS    0H                                                  1446 06467000
*   /*****************************************************************/ 06468000
*   /*                                                               */ 06469000
*   /* FREE EXTENTS                                          @Z40LB26*/ 06470000
*   /*                                                               */ 06471000
*   /*****************************************************************/ 06472000
*                                                                  1446 06473000
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/ 06474000
*         VSDFREXT(SUPCNT)=CHARZERO;/*                       @Z40LB26*/ 06475000
         LA    SUPCNT,1                                            1446 06476000
@DL01446 L     @01,LISTADDR                                        1446 06477000
         L     @15,VSDSPACE(,@01)                                  1446 06478000
         LR    @14,@15                                             1446 06479000
         ALR   @14,SUPCNT                                          1446 06480000
         CLI   VSDFREXT-1(@14),C'0'                                1446 06481000
         BNE   @DC01446                                            1446 06482000
*     VSDFREXT(SUPCNT)=BLANK;       /*                       @Z40LB26*/ 06483000
         ALR   @15,SUPCNT                                          1447 06484000
         MVI   VSDFREXT-1(@15),C' '                                1447 06485000
*   END;                            /*                       @Z40LB26*/ 06486000
*                                                                  1448 06487000
         AL    SUPCNT,@CF00222                                     1448 06488000
         C     SUPCNT,@CF00165                                     1448 06489000
         BNH   @DL01446                                            1448 06490000
@DC01446 DS    0H                                                  1449 06491000
*   /*****************************************************************/ 06492000
*   /*                                                               */ 06493000
*   /* LARGEST FREE EXTENT                                   @Z40LB26*/ 06494000
*   /*                                                               */ 06495000
*   /*****************************************************************/ 06496000
*                                                                  1449 06497000
*   DO SUPCNT=1 TO 3 WHILE          /*                       @Z40LB26*/ 06498000
*         VSDFRCCL(SUPCNT)=CHARZERO;/*                       @Z40LB26*/ 06499000
         LA    SUPCNT,1                                            1449 06500000
@DL01449 L     @01,LISTADDR                                        1449 06501000
         L     @15,VSDSPACE(,@01)                                  1449 06502000
         LR    @14,@15                                             1449 06503000
         ALR   @14,SUPCNT                                          1449 06504000
         CLI   VSDFRCCL-1(@14),C'0'                                1449 06505000
         BNE   @DC01449                                            1449 06506000
*     VSDFRCCL(SUPCNT)=BLANK;       /*                       @Z40LB26*/ 06507000
         ALR   @15,SUPCNT                                          1450 06508000
         MVI   VSDFRCCL-1(@15),C' '                                1450 06509000
*   END;                            /*                       @Z40LB26*/ 06510000
*                                                                  1451 06511000
         AL    SUPCNT,@CF00222                                     1451 06512000
         C     SUPCNT,@CF00165                                     1451 06513000
         BNH   @DL01449                                            1451 06514000
@DC01449 DS    0H                                                  1452 06515000
*   /*****************************************************************/ 06516000
*   /*                                                               */ 06517000
*   /* BUILD DARGLIST FOR PRINTING SUMMARY LINES             @Z40LB26*/ 06518000
*   /*                                                               */ 06519000
*   /*****************************************************************/ 06520000
*                                                                  1452 06521000
*   DARGLIST=''B;                   /*                       @Z40LB26*/ 06522000
         L     @03,DDSTRU                                          1452 06523000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1452 06524000
*   DARGSMOD=LD01TXT;               /*                       @Z40LB26*/ 06525000
         MVC   DARGSMOD(3,@03),@CC01477                            1453 06526000
*   DARGSENT=USESUM;                /*                       @Z40LB26*/ 06527000
         MVI   DARGSENT(@03),X'08'                                 1454 06528000
*   DARGCNT=7;                      /*                       @Z40LB26*/ 06529000
*                                                                  1455 06530000
         MVC   DARGCNT(2,@03),@CH00519                             1455 06531000
*   /*****************************************************************/ 06532000
*   /*                                                               */ 06533000
*   /* BUILD INSERT LISTS                                    @Z40LB26*/ 06534000
*   /*                                                               */ 06535000
*   /*****************************************************************/ 06536000
*                                                                  1456 06537000
*   DARGINS(1)=10;                  /*                       @Z40LB26*/ 06538000
         MVC   DARGINS(2,@03),@CH00037                             1456 06539000
*   DARGINL(1)=LENGTH(TOTALTRK);    /*                       @Z40LB26*/ 06540000
         MVC   DARGINL(2,@03),@CH00156                             1457 06541000
*   DARGDTM(1)=ADDR(TOTALTRK);      /*                       @Z40LB26*/ 06542000
         LA    @15,TOTALTRK                                        1458 06543000
         ST    @15,DARGDTM(,@03)                                   1458 06544000
*   DARGINS(2)=20;                  /*                       @Z40LB26*/ 06545000
         MVC   DARGINS+8(2,@03),@CH00279                           1459 06546000
*   DARGINL(2)=LENGTH(VSDVTOCS);    /*                       @Z40LB26*/ 06547000
         LA    @15,4                                               1460 06548000
         STH   @15,DARGINL+8(,@03)                                 1460 06549000
*   DARGDTM(2)=ADDR(VSDVTOCS);      /*                       @Z40LB26*/ 06550000
         L     @14,LISTADDR                                        1461 06551000
         LA    @01,VSDVTOCS(,@14)                                  1461 06552000
         ST    @01,DARGDTM+8(,@03)                                 1461 06553000
*   DARGINS(3)=30;                  /*                       @Z40LB26*/ 06554000
         MVC   DARGINS+16(2,@03),@CH01278                          1462 06555000
*   DARGINL(3)=LENGTH(VSDFMT0);     /*                       @Z40LB26*/ 06556000
         STH   @15,DARGINL+16(,@03)                                1463 06557000
*   DARGDTM(3)=ADDR(VSDFMT0);       /*                       @Z40LB26*/ 06558000
         LA    @01,VSDFMT0(,@14)                                   1464 06559000
         ST    @01,DARGDTM+16(,@03)                                1464 06560000
*   DARGINS(4)=40;                  /*                       @Z40LB26*/ 06561000
         MVC   DARGINS+24(2,@03),@CH01703                          1465 06562000
*   DARGINL(4)=LENGTH(VSDFRCYL);    /*                       @Z40LB26*/ 06563000
         STH   @15,DARGINL+24(,@03)                                1466 06564000
*   DARGDTM(4)=ADDR(VSDFRCYL);      /*                       @Z40LB26*/ 06565000
         L     @14,VSDSPACE(,@14)                                  1467 06566000
         LA    @01,VSDFRCYL(,@14)                                  1467 06567000
         ST    @01,DARGDTM+24(,@03)                                1467 06568000
*   DARGINS(5)=50;                  /*                       @Z40LB26*/ 06569000
         MVC   DARGINS+32(2,@03),@CH01448                          1468 06570000
*   DARGINL(5)=LENGTH(VSDFRTRK);    /*                       @Z40LB26*/ 06571000
         STH   @15,DARGINL+32(,@03)                                1469 06572000
*   DARGDTM(5)=ADDR(VSDFRTRK);      /*                       @Z40LB26*/ 06573000
         LA    @01,VSDFRTRK(,@14)                                  1470 06574000
         ST    @01,DARGDTM+32(,@03)                                1470 06575000
*   DARGINS(6)=60;                  /*                       @Z40LB26*/ 06576000
         MVC   DARGINS+40(2,@03),@CH01464                          1471 06577000
*   DARGINL(6)=LENGTH(VSDFREXT);    /*                       @Z40LB26*/ 06578000
         STH   @15,DARGINL+40(,@03)                                1472 06579000
*   DARGDTM(6)=ADDR(VSDFREXT);      /*                       @Z40LB26*/ 06580000
         LA    @01,VSDFREXT(,@14)                                  1473 06581000
         ST    @01,DARGDTM+40(,@03)                                1473 06582000
*   DARGINS(7)=70;                  /*                       @Z40LB26*/ 06583000
         MVC   DARGINS+48(2,@03),@CH01704                          1474 06584000
*   DARGINL(7)=LENGTH(VSDFRCCL);    /*                       @Z40LB26*/ 06585000
         STH   @15,DARGINL+48(,@03)                                1475 06586000
*   DARGDTM(7)=ADDR(VSDFRCCL);      /*                       @Z40LB26*/ 06587000
*                                                                  1476 06588000
         LA    @15,VSDFRCCL(,@14)                                  1476 06589000
         ST    @15,DARGDTM+48(,@03)                                1476 06590000
*   /*****************************************************************/ 06591000
*   /*                                                               */ 06592000
*   /* ISSUE UPRINT FOR ENTIRE SUMMARY                       @Z40LB26*/ 06593000
*   /*                                                               */ 06594000
*   /*****************************************************************/ 06595000
*                                                                  1477 06596000
*   CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*                  @Z40LB26*/ 06597000
*                                                                  1477 06598000
         L     @03,@PC00001                                        1477 06599000
         ST    @03,@AL00001                                        1477 06600000
         LA    @15,PRINTIT                                         1477 06601000
         ST    @15,@AL00001+4                                      1477 06602000
         LA    @15,DDSTRU                                          1477 06603000
         ST    @15,@AL00001+8                                      1477 06604000
         MVI   @AL00001+8,X'80'                                    1477 06605000
         L     @15,GDTPRT(,@03)                                    1477 06606000
         LA    @01,@AL00001                                        1477 06607000
         BALR  @14,@15                                             1477 06608000
*   /*****************************************************************/ 06609000
*   /*                                                               */ 06610000
*   /* ISSUE URESET TO GET RID OF OLD SUB-TITLE AND          @Z40LB26*/ 06611000
*   /* HEADER LINES                                          @Z40LB26*/ 06612000
*   /*                                                               */ 06613000
*   /*****************************************************************/ 06614000
*                                                                  1478 06615000
*   CALL AMSTP044(GDTTBL,PRINTIT);  /*                       @Z40LB26*/ 06616000
*                                                                  1478 06617000
         L     @03,@PC00001                                        1478 06618000
         ST    @03,@AL00001                                        1478 06619000
         LA    @15,PRINTIT                                         1478 06620000
         ST    @15,@AL00001+4                                      1478 06621000
         MVI   @AL00001+4,X'80'                                    1478 06622000
         L     @15,GDTRES(,@03)                                    1478 06623000
         LA    @01,@AL00001                                        1478 06624000
         BALR  @14,@15                                             1478 06625000
*   /*****************************************************************/ 06626000
*   /*                                                               */ 06627000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 06628000
*   /*                                                               */ 06629000
*   /*****************************************************************/ 06630000
*                                                                  1479 06631000
*   RETURN CODE(CC04);              /*                       @Z40LB26*/ 06632000
         LR    @15,CC04                                            1479 06633000
@EL00018 DS    0H                                                  1479 06634000
@EF00018 DS    0H                                                  1479 06635000
@ER00018 L     @14,@SA00018                                        1479 06636000
         BR    @14                                                 1479 06637000
*   END USAGESUM;                   /*                       @Z40LB26*/ 06638000
*                                                                  1481 06639000
*/*********************************************************  @Z40LB26*/ 06640000
*/*                                                          @Z40LB26*/ 06641000
*/* PROCEDURE - LEGENDS                                      @Z40LB26*/ 06642000
*/*                                                          @Z40LB26*/ 06643000
*/* FUNCTION -  RECEIVES CONTROL WHEN A USAGE OR STATUS      @Z40LB26*/ 06644000
*/*             REPORT IS COMPLETED AND A LEGEND WAS         @Z40LB26*/ 06645000
*/*             REQUESTED.  IT PRINTS EITHER A STATUS OR     @Z40LB26*/ 06646000
*/*             USAGE LEGEND, DEPENDING ON THE TYPE OF       @Z40LB26*/ 06647000
*/*             REPORT ASKED FOR.                            @Z40LB26*/ 06648000
*/*                                                          @Z40LB26*/ 06649000
*/* OUTPUT - REGISTER 15 = 0, SUCCESSFUL                     @Z40LB26*/ 06650000
*/*                                                          @Z40LB26*/ 06651000
*/*********************************************************  @Z40LB26*/ 06652000
*                                                                  1481 06653000
*LEGENDS:                                                          1481 06654000
*   PROC OPTIONS(SAVE(14));         /*                       @Z40LB26*/ 06655000
LEGENDS  ST    @14,@SA00019                                        1481 06656000
*                                                                  1482 06657000
*   /*****************************************************************/ 06658000
*   /*                                                               */ 06659000
*   /* ESTABLISH TRACE POINT                                 @Z40LB26*/ 06660000
*   /*                                                               */ 06661000
*   /*****************************************************************/ 06662000
*                                                                  1482 06663000
*   OLDERID2=NEWERID2;                                             1482 06664000
         L     @05,@PC00001                                        1482 06665000
         L     @15,GDTTR2(,@05)                                    1482 06666000
         MVC   @TS00001(95),NEWERID2(@15)                          1482 06667000
         MVC   OLDERID2(95,@15),@TS00001                           1482 06668000
*   NEWID2='LDLG';                  /*                       @Z40LB26*/ 06669000
*                                                                  1483 06670000
         MVC   NEWID2(4,@15),@CC01708                              1483 06671000
*   /*****************************************************************/ 06672000
*   /*                                                               */ 06673000
*   /* SET CONDITION CODE                                    @Z40LB26*/ 06674000
*   /*                                                               */ 06675000
*   /*****************************************************************/ 06676000
*                                                                  1484 06677000
*   CC01=LASTCC00;                  /*                       @Z40LB26*/ 06678000
*                                                                  1484 06679000
         SLR   @15,@15                                             1484 06680000
         LR    CC01,@15                                            1484 06681000
*   /*****************************************************************/ 06682000
*   /*                                                               */ 06683000
*   /* SEE IF NEED TO CLEAR OLD SUB-TITLE LINE               @Z40LB26*/ 06684000
*   /*                                                               */ 06685000
*   /*****************************************************************/ 06686000
*                                                                  1485 06687000
*   IF LASTCOND^=LASTCC00 THEN      /*                       @Z40LB26*/ 06688000
         L     @14,@PC00001+8                                      1485 06689000
         CH    @15,LASTCOND(,@14)                                  1485 06690000
         BE    @RF01485                                            1485 06691000
*     CALL AMSTP044(GDTTBL,PRINTIT);/*                       @Z40LB26*/ 06692000
*                                                                  1486 06693000
         ST    @05,@AL00001                                        1486 06694000
         LA    @15,PRINTIT                                         1486 06695000
         ST    @15,@AL00001+4                                      1486 06696000
         MVI   @AL00001+4,X'80'                                    1486 06697000
         L     @15,GDTRES(,@05)                                    1486 06698000
         LA    @01,@AL00001                                        1486 06699000
         BALR  @14,@15                                             1486 06700000
*   /*****************************************************************/ 06701000
*   /*                                                               */ 06702000
*   /* ISSUE UPRINT TO READ IN LEGENDS LINE AS A             @Z40LB26*/ 06703000
*   /* SUB-TITLE                                             @Z40LB26*/ 06704000
*   /*                                                               */ 06705000
*   /*****************************************************************/ 06706000
*                                                                  1487 06707000
*   DARGAREA=''B;                   /*                       @Z40LB26*/ 06708000
@RF01485 XC    DARGAREA(76),DARGAREA                               1487 06709000
*   DARGSMOD=LD01TXT;               /*                       @Z40LB26*/ 06710000
         L     @05,DDSTRU                                          1488 06711000
         MVC   DARGSMOD(3,@05),@CC01477                            1488 06712000
*   DARGSENT=LGNDID;                /*                       @Z40LB26*/ 06713000
         MVI   DARGSENT(@05),X'0D'                                 1489 06714000
*   DARGRETP=ADDR(STLGND);          /*                       @Z40LB26*/ 06715000
         LA    @15,STLGND                                          1490 06716000
         ST    @15,DARGRETP(,@05)                                  1490 06717000
*   DARGRETL=LENGTH(STLGND);        /*                       @Z40LB26*/ 06718000
         MVC   DARGRETL(2,@05),@CH01473                            1491 06719000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB26*/ 06720000
*                                                                  1492 06721000
         L     @05,@PC00001                                        1492 06722000
         ST    @05,@AL00001                                        1492 06723000
         LA    @15,@CF00117                                        1492 06724000
         ST    @15,@AL00001+4                                      1492 06725000
         LA    @15,DDSTRU                                          1492 06726000
         ST    @15,@AL00001+8                                      1492 06727000
         MVI   @AL00001+8,X'80'                                    1492 06728000
         L     @15,GDTPRT(,@05)                                    1492 06729000
         LA    @01,@AL00001                                        1492 06730000
         BALR  @14,@15                                             1492 06731000
*   /*****************************************************************/ 06732000
*   /*                                                               */ 06733000
*   /* ISSUE UESTA TO ESTABLISH THE SUB-TITLE LINE           @Z40LB26*/ 06734000
*   /* FOR LEGEND.                                           @Z40LB26*/ 06735000
*   /*                                                               */ 06736000
*   /*****************************************************************/ 06737000
*                                                                  1493 06738000
*   PCARG=''B;                      /*                       @Z40LB26*/ 06739000
         XC    PCARG(33),PCARG                                     1493 06740000
*   PCSTLP=ADDR(STLGND);            /*                       @Z40LB26*/ 06741000
         LA    @05,STLGND                                          1494 06742000
         ST    @05,PCSTLP                                          1494 06743000
*   PCSTLC=1;                       /*                       @Z40LB26*/ 06744000
         MVC   PCSTLC(2),@CH00222                                  1495 06745000
*   CALL AMSTP042(GDTTBL,PRINTIT,PCARG);/*                   @Z40LB26*/ 06746000
*                                                                  1496 06747000
         L     @05,@PC00001                                        1496 06748000
         ST    @05,@AL00001                                        1496 06749000
         LA    @15,PRINTIT                                         1496 06750000
         ST    @15,@AL00001+4                                      1496 06751000
         LA    @15,PCARG                                           1496 06752000
         ST    @15,@AL00001+8                                      1496 06753000
         L     @15,GDTESA(,@05)                                    1496 06754000
         LA    @01,@AL00001                                        1496 06755000
         BALR  @14,@15                                             1496 06756000
*   /*****************************************************************/ 06757000
*   /*                                                               */ 06758000
*   /* CHECK TO SEE IF USAGE REPORT                          @Z40LB26*/ 06759000
*   /*                                                               */ 06760000
*   /*****************************************************************/ 06761000
*                                                                  1497 06762000
*   IF ADDR(USAGE)^=NULLPTR THEN    /*                       @Z40LB26*/ 06763000
         L     @05,@PC00001+4                                      1497 06764000
         L     @05,FDTPTR+56(,@05)                                 1497 06765000
         LTR   @05,@05                                             1497 06766000
         BZ    @RF01497                                            1497 06767000
*     DO;                           /*                       @Z40LB26*/ 06768000
*                                                                  1498 06769000
*       /*************************************************************/ 06770000
*       /*                                                           */ 06771000
*       /* ISSUE UPRINT FOR USAGE LEGEND                     @Z40LB26*/ 06772000
*       /*                                                           */ 06773000
*       /*************************************************************/ 06774000
*                                                                  1499 06775000
*       DARGLIST=''B;               /*                       @Z40LB26*/ 06776000
         L     @05,DDSTRU                                          1499 06777000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1499 06778000
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/ 06779000
         MVC   DARGSMOD(3,@05),@CC01477                            1500 06780000
*       DARGSENT=USELGND;           /*                       @Z40LB26*/ 06781000
*                                                                  1501 06782000
         MVI   DARGSENT(@05),X'0B'                                 1501 06783000
*       /*************************************************************/ 06784000
*       /*                                                           */ 06785000
*       /* PRINT LEGEND                                      @Z40LB26*/ 06786000
*       /*                                                           */ 06787000
*       /*************************************************************/ 06788000
*                                                                  1502 06789000
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/ 06790000
         L     @05,@PC00001                                        1502 06791000
         ST    @05,@AL00001                                        1502 06792000
         LA    @15,PRINTIT                                         1502 06793000
         ST    @15,@AL00001+4                                      1502 06794000
         LA    @15,DDSTRU                                          1502 06795000
         ST    @15,@AL00001+8                                      1502 06796000
         MVI   @AL00001+8,X'80'                                    1502 06797000
         L     @15,GDTPRT(,@05)                                    1502 06798000
         LA    @01,@AL00001                                        1502 06799000
         BALR  @14,@15                                             1502 06800000
*     END;                          /*                       @Z40LB26*/ 06801000
*                                                                  1503 06802000
*   /*****************************************************************/ 06803000
*   /*                                                               */ 06804000
*   /* CHECK IF STATUS REPORT SUMMARY                        @Z40LB26*/ 06805000
*   /*                                                               */ 06806000
*   /*****************************************************************/ 06807000
*                                                                  1504 06808000
*   ELSE                            /*                       @Z40LB26*/ 06809000
*     DO;                           /*                       @Z40LB26*/ 06810000
*                                                                  1504 06811000
         B     @RC01497                                            1504 06812000
@RF01497 DS    0H                                                  1505 06813000
*       /*************************************************************/ 06814000
*       /*                                                           */ 06815000
*       /* PRINT OF STATUS LEGEND                            @Z40LB26*/ 06816000
*       /*                                                           */ 06817000
*       /*************************************************************/ 06818000
*                                                                  1505 06819000
*       DARGLIST=''B;               /*                       @Z40LB26*/ 06820000
         L     @05,DDSTRU                                          1505 06821000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1505 06822000
*       DARGSMOD=LD01TXT;           /*                       @Z40LB26*/ 06823000
         MVC   DARGSMOD(3,@05),@CC01477                            1506 06824000
*       DARGSENT=STATLGND;          /*                       @Z40LB26*/ 06825000
         MVI   DARGSENT(@05),X'0A'                                 1507 06826000
*       CALL AMSTP011(GDTTBL,PRINTIT,DDSTRU);/*              @Z40LB26*/ 06827000
         L     @05,@PC00001                                        1508 06828000
         ST    @05,@AL00001                                        1508 06829000
         LA    @15,PRINTIT                                         1508 06830000
         ST    @15,@AL00001+4                                      1508 06831000
         LA    @15,DDSTRU                                          1508 06832000
         ST    @15,@AL00001+8                                      1508 06833000
         MVI   @AL00001+8,X'80'                                    1508 06834000
         L     @15,GDTPRT(,@05)                                    1508 06835000
         LA    @01,@AL00001                                        1508 06836000
         BALR  @14,@15                                             1508 06837000
*     END;                          /*                       @Z40LB26*/ 06838000
*                                                                  1509 06839000
*   /*****************************************************************/ 06840000
*   /*                                                               */ 06841000
*   /* ISSUE A URESET MACRO TO CAUSE A PAGE EJECT TO BE      @Z40LB26*/ 06842000
*   /* CONSISTENT WITH THE FORMAT PRINTED WHEN NO LEGEND     @Z40LB26*/ 06843000
*   /* WAS ASKED FOR.                                        @Z40LB26*/ 06844000
*   /*                                                               */ 06845000
*   /*****************************************************************/ 06846000
*                                                                  1510 06847000
*   CALL AMSTP044(GDTTBL,PRINTIT);  /*                       @Z40LB26*/ 06848000
*                                                                  1510 06849000
@RC01497 L     @05,@PC00001                                        1510 06850000
         ST    @05,@AL00001                                        1510 06851000
         LA    @15,PRINTIT                                         1510 06852000
         ST    @15,@AL00001+4                                      1510 06853000
         MVI   @AL00001+4,X'80'                                    1510 06854000
         L     @15,GDTRES(,@05)                                    1510 06855000
         LA    @01,@AL00001                                        1510 06856000
         BALR  @14,@15                                             1510 06857000
*   /*****************************************************************/ 06858000
*   /*                                                               */ 06859000
*   /* RETURN TO CALLER                                      @Z40LB26*/ 06860000
*   /*                                                               */ 06861000
*   /*****************************************************************/ 06862000
*                                                                  1511 06863000
*   RETURN CODE(CC01);              /*                       @Z40LB26*/ 06864000
         LR    @15,CC01                                            1511 06865000
@EL00019 DS    0H                                                  1511 06866000
@EF00019 DS    0H                                                  1511 06867000
@ER00019 L     @14,@SA00019                                        1511 06868000
         BR    @14                                                 1511 06869000
*   END LEGENDS;                    /*                       @Z40LB26*/ 06870000
*                                                                  1513 06871000
*/********************************************************************/ 06872000
*/*                                                          @Z40LB35*/ 06873000
*/* PROCEDURE NAME - DATES  (ACCESS METHOD SERVICES)         @Z40LB35*/ 06874000
*/*                                                          @Z40LB35*/ 06875000
*/* FUNCTION - THIS COMMON INCLUDED PROCEDURE PROVIDES       @Z40LB35*/ 06876000
*/*            THE AMS SERVICES WITH THE BASIC FUNCTION OF   @Z40LB35*/ 06877000
*/*            CONVERTING A ONE VALUE DATE SUCH AS 99999 TO  @Z40LB35*/ 06878000
*/*            '00 99 0999' OR OBTAINING THE CURRENT DATE AND@Z40LB35*/ 06879000
*/*            ADJUSTING IT BY EITHER ADDING OR SUBTRACTING  @Z40LB35*/ 06880000
*/*            DAYS TO THAT DATE.  THE DATE WILL BE ADJUSTED @Z40LB35*/ 06881000
*/*            FOR ANY LEAP YEARS.  THE DATE WILL ALSO BE    @Z40LB35*/ 06882000
*/*            ADJUSTED TO FIT WITHIN THE RANGE 0 TO 99999.  @Z40LB35*/ 06883000
*/*                                                          @Z40LB35*/ 06884000
*/* ENTRY POINT - DATES                                      @Z40LB35*/ 06885000
*/*                                                          @Z40LB35*/ 06886000
*/*      LINKAGE - 'CALL DATES (DATESAGL)'                   @Z40LB35*/ 06887000
*/*                '%INCLUDE SYSLIB(IDCDF55)'                @Z40LB35*/ 06888000
*/*                                                          @Z40LB35*/ 06889000
*/* INPUT  - ADDRESS OF ARGUMENT LIST (DATESAGL)             @Z40LB35*/ 06890000
*/*                                                          @Z40LB35*/ 06891000
*/* OUTPUT - A RETURN CODE IN REGISTER 15                    @Z40LB35*/ 06892000
*/*          (0) - DATES SUCCESSFUL                          @Z40LB35*/ 06893000
*/*                                                          @Z40LB35*/ 06894000
*/*        - A CONVERTED DATE (00 YY DDDD) IN BINARY         @Z40LB35*/ 06895000
*/*                                                          @Z40LB35*/ 06896000
*/* EXIT NORMAL - RETURNS TO CALLER WITH CONDITION           @Z40LB35*/ 06897000
*/*               CODE ZERO                                  @Z40LB35*/ 06898000
*/*                                                          @Z40LB35*/ 06899000
*/* EXIT ERROR  - NONE                                       @Z40LB35*/ 06900000
*/*                                                          @Z40LB35*/ 06901000
*/* CHANGE ACTIVITY - NONE                                   @Z40LB35*/ 06902000
*/*                                                          @Z40LB35*/ 06903000
*/********************************************************************/ 06904000
*                                                                  1513 06905000
*DATES:                                                            1513 06906000
*   PROC;                           /*                       @Z40LB35*/ 06907000
*                                                                  1513 06908000
DATES    STM   @14,@12,@SA00020                                    1513 06909000
*   /*****************************************************************/ 06910000
*   /*                                                               */ 06911000
*   /* DECLARATION FOR DATES PROCEDURE                       @Z40LB35*/ 06912000
*   /*                                                               */ 06913000
*   /*****************************************************************/ 06914000
*                                                                  1514 06915000
*   DCL                                                            1514 06916000
*     TIMEVAR CHAR(8);              /* TIME VARIABLE - UTIME @Z40LB35   06917000
*                                      USED IN UTIME CALL    @Z40LB35*/ 06918000
*   DCL                                                            1515 06919000
*     1 DATEVAR CHAR(4),            /* DATE VARIABLE - UTIME @Z40LB35*/ 06920000
*      2 * CHAR(1),                 /* FILLER - RESERVED     @Z40LB35*/ 06921000
*      2 DATEPACK CHAR(3);          /* DATE RETURN - PACKED  @Z40LB35   06922000
*                                      DECIMAL FORMAT        @Z40LB35*/ 06923000
*                                                                  1515 06924000
*   /*****************************************************************/ 06925000
*   /*                                                               */ 06926000
*   /* THE FOLLOWING STRUCTURE IS THE DATE RETURNED          @Z40LB35*/ 06927000
*   /*                                                               */ 06928000
*   /*****************************************************************/ 06929000
*                                                                  1516 06930000
*   DCL                                                            1516 06931000
*     1 CONVDATE BDY(WORD) BASED(DATRETRN),                        1516 06932000
*      2 CONVYEAR FIXED(15),        /* YEAR - RANGE 0 - 99   @Z40LB35*/ 06933000
*      2 CONVDAYS FIXED(15);        /* DAYS - RANGE 0 - 999  @Z40LB35*/ 06934000
*                                                                  1516 06935000
*   /*****************************************************************/ 06936000
*   /*                                                               */ 06937000
*   /* THE FOLLOWING DECLARES ARE INTERNAL FIELDS            @Z40LB35*/ 06938000
*   /*                                                               */ 06939000
*   /*****************************************************************/ 06940000
*                                                                  1517 06941000
*   DCL                                                            1517 06942000
*     DATEBIN FIXED(31);            /* USED TO UNPACK DATE   @Z40LB35*/ 06943000
*   DCL                                                            1518 06944000
*     QUITSW BIT(1);                /* USED TO CONTROL LOOPS @Z40LB35*/ 06945000
*   DCL                                                            1519 06946000
*     ADJDAYS FIXED(31);            /* USED TO ADJUST DAYS   @Z40LB35*/ 06947000
*                                                                  1519 06948000
*   /*****************************************************************/ 06949000
*   /*                                                               */ 06950000
*   /* THE FOLLOWING ARE STATIC CONSTANTS                    @Z40LB35*/ 06951000
*   /*                                                               */ 06952000
*   /*****************************************************************/ 06953000
*                                                                  1520 06954000
*   DCL                                                            1520 06955000
*     REGYEAR FIXED(15) INIT(365);  /*                       @Z40LB35   06956000
*                                      NUM DAYS IN REG YEAR  @Z40LB35*/ 06957000
*   DCL                                                            1521 06958000
*     LEAPYEAR FIXED(15) INIT(366); /*                       @Z40LB35   06959000
*                                      NUM DAYS IN LEAP YEAR @Z40LB35*/ 06960000
*   DCL                                                            1522 06961000
*     MAXYEAR FIXED(15) INIT(99);   /*                       @Z40LB35   06962000
*                                      HIGHEST YEAR          @Z40LB35*/ 06963000
*   DCL                                                            1523 06964000
*     MAXDAYS FIXED(15) INIT(999);  /*                       @Z40LB35   06965000
*                                      HIGHEST DAYS          @Z40LB35*/ 06966000
*   DCL                                                            1524 06967000
*     MINYEAR FIXED(15) INIT(0);    /*                       @Z40LB35   06968000
*                                      LOWEST YEAR           @Z40LB35*/ 06969000
*   DCL                                                            1525 06970000
*     MINDAYS FIXED(15) INIT(0);    /*                       @Z40LB35   06971000
*                                      LOWEST DAYS           @Z40LB35*/ 06972000
*   DCL                                                            1526 06973000
*     NOREMAIN FIXED(15) INIT(0);   /*                       @Z40LB35   06974000
*                                      NO REMAINDER AFTER DIV      1526 06975000
*                                                            @Z40LB35*/ 06976000
*                                                                  1527 06977000
*   /*****************************************************************/ 06978000
*   /*                                                               */ 06979000
*   /* THIS IS THE START OF THIS PROCEDURE                   @Z40LB35*/ 06980000
*   /* HERE INITIALIZATION TAKES PLACE.                      @Z40LB35*/ 06981000
*   /* THE PARM LIST HEADER IS INITIALIZED,                  @Z40LB35*/ 06982000
*   /* THE TRACE POINT 'DTST' IS RECORDED, AND               @Z40LB35*/ 06983000
*   /* THE DATE IS SET TO ZERO.                              @Z40LB35*/ 06984000
*   /*                                                               */ 06985000
*   /*****************************************************************/ 06986000
*                                                                  1527 06987000
*   OLDERID2=NEWERID2;                                             1527 06988000
         L     @15,@PC00001                                        1527 06989000
         L     @14,GDTTR2(,@15)                                    1527 06990000
         MVC   @TS00001(95),NEWERID2(@14)                          1527 06991000
         MVC   OLDERID2(95,@14),@TS00001                           1527 06992000
*   NEWID2='DTST';                  /*                       @Z40LB35*/ 06993000
         MVC   NEWID2(4,@14),@CC01733                              1528 06994000
*   DATHEAD='DATESAGL';             /*                       @Z40LB35*/ 06995000
         LA    @14,DTSAREA                                         1529 06996000
         MVC   DATHEAD(8,@14),@CC01734                             1529 06997000
*   CONVDATE=0;                     /*                       @Z40LB35*/ 06998000
*                                                                  1530 06999000
         L     @01,DATRETRN(,@14)                                  1530 07000000
         SLR   @00,@00                                             1530 07001000
         ST    @00,CONVDATE(,@01)                                  1530 07002000
*   /*****************************************************************/ 07003000
*   /*                                                               */ 07004000
*   /* DETERMINE IF CALLER WANTS THE CURRENT DATE            @Z40LB35*/ 07005000
*   /* ADJUSTED WITH DAYS ADD OR SUBTRACTED.                 @Z40LB35*/ 07006000
*   /*                                                               */ 07007000
*   /*****************************************************************/ 07008000
*                                                                  1531 07009000
*   IF DATDAYOP=ON THEN                                            1531 07010000
         TM    DATDAYOP(@14),B'00010000'                           1531 07011000
         BNO   @RF01531                                            1531 07012000
*     DO;                           /*                       @Z40LB35*/ 07013000
*                                                                  1532 07014000
*       /*************************************************************/ 07015000
*       /*                                                           */ 07016000
*       /* IF CALLER WANTS TO ADJUST CURRENT DATE,           @Z40LB35*/ 07017000
*       /* ISSUE UTIME TO RETRIEVE CURRENT DATE,             @Z40LB35*/ 07018000
*       /* CONVERT THE DATE FROM PACKED DECIMAL TO           @Z40LB35*/ 07019000
*       /* BINARY, AND SEPARATE THE YEARS FROM THE           @Z40LB35*/ 07020000
*       /* DAYS.                                             @Z40LB35*/ 07021000
*       /*                                                           */ 07022000
*       /*************************************************************/ 07023000
*                                                                  1533 07024000
*       ADJDAYS=DATDAYS;            /*                       @Z40LB35*/ 07025000
         L     ADJDAYS,DATDAYS(,@14)                               1533 07026000
*       CALL IDCSATI0(GDTTBL,TIMEVAR,DATEVAR);/*             @Z40LB35*/ 07027000
         ST    @15,@AL00001                                        1534 07028000
         LA    @14,TIMEVAR                                         1534 07029000
         ST    @14,@AL00001+4                                      1534 07030000
         LA    @14,DATEVAR                                         1534 07031000
         ST    @14,@AL00001+8                                      1534 07032000
         MVI   @AL00001+8,X'80'                                    1534 07033000
         L     @15,GDTTIM(,@15)                                    1534 07034000
         LA    @01,@AL00001                                        1534 07035000
         BALR  @14,@15                                             1534 07036000
*       CVB(DATEBIN,DATEPACK);      /*                       @Z40LB35*/ 07037000
         XC    @TS00001(8),@TS00001                                1535 07038000
         MVC   @TS00001+5(3),DATEPACK                              1535 07039000
         CVB   DATEBIN,@TS00001                                    1535 07040000
*       CONVYEAR=DATEBIN/1000;      /*                       @Z40LB35*/ 07041000
         LA    @15,DTSAREA                                         1536 07042000
         L     @14,DATRETRN(,@15)                                  1536 07043000
         LA    @07,1000                                            1536 07044000
         LR    @00,DATEBIN                                         1536 07045000
         SRDA  @00,32                                              1536 07046000
         DR    @00,@07                                             1536 07047000
         STH   @01,CONVYEAR(,@14)                                  1536 07048000
*       CONVDAYS=DATEBIN-(CONVYEAR*1000);/*                  @Z40LB35*/ 07049000
*                                                                  1537 07050000
         MR    @00,@07                                             1537 07051000
         LCR   @01,@01                                             1537 07052000
         ALR   @01,DATEBIN                                         1537 07053000
         STH   @01,CONVDAYS(,@14)                                  1537 07054000
*       /*************************************************************/ 07055000
*       /*                                                           */ 07056000
*       /* INITIALIZE QUITSW OFF FOR LOOP CONTROL            @Z40LB35*/ 07057000
*       /*                                                           */ 07058000
*       /*************************************************************/ 07059000
*                                                                  1538 07060000
*       QUITSW=OFF;                 /*                       @Z40LB35*/ 07061000
*                                                                  1538 07062000
         NI    QUITSW,B'01111111'                                  1538 07063000
*       /*************************************************************/ 07064000
*       /*                                                           */ 07065000
*       /* DETERMINE IF CALLER WANTS DAYS ADDED TO           @Z40LB35*/ 07066000
*       /* CURRENT DATE.                                     @Z40LB35*/ 07067000
*       /*                                                           */ 07068000
*       /*************************************************************/ 07069000
*                                                                  1539 07070000
*       IF DATADD=ON THEN                                          1539 07071000
*                                                                  1539 07072000
         TM    DATADD(@15),B'10000000'                             1539 07073000
         BNO   @RF01539                                            1539 07074000
*         /***********************************************************/ 07075000
*         /*                                                         */ 07076000
*         /* IF CALLER WANTS DAYS ADDED, LOOP THOUGH         @Z40LB35*/ 07077000
*         /* THE FOLLOWING DO LOOP UNTIL QUITSW IS SET       @Z40LB35*/ 07078000
*         /*                                                         */ 07079000
*         /***********************************************************/ 07080000
*                                                                  1540 07081000
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/ 07082000
*                                                                  1540 07083000
         B     @DE01540                                            1540 07084000
@DL01540 DS    0H                                                  1541 07085000
*           /*********************************************************/ 07086000
*           /*                                                       */ 07087000
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/ 07088000
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/ 07089000
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/ 07090000
*           /*                                                       */ 07091000
*           /*********************************************************/ 07092000
*                                                                  1541 07093000
*           IF CONVYEAR//4=NOREMAIN THEN                           1541 07094000
*                                                                  1541 07095000
         LA    @03,DTSAREA                                         1541 07096000
         L     @03,DATRETRN(,@03)                                  1541 07097000
         LH    @15,CONVYEAR(,@03)                                  1541 07098000
         LR    @00,@15                                             1541 07099000
         SRDA  @00,32                                              1541 07100000
         D     @00,@CF00043                                        1541 07101000
         CH    @00,NOREMAIN                                        1541 07102000
         BNE   @RF01541                                            1541 07103000
*             /*******************************************************/ 07104000
*             /*                                                     */ 07105000
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/ 07106000
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */ 07107000
*             /*                                             @Z40LB35*/ 07108000
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/ 07109000
*             /*                                                     */ 07110000
*             /*******************************************************/ 07111000
*                                                                  1542 07112000
*             IF(ADJDAYS+CONVDAYS)>LEAPYEAR THEN                   1542 07113000
*                                                                  1542 07114000
         LH    @14,LEAPYEAR                                        1542 07115000
         LR    @07,ADJDAYS                                         1542 07116000
         AH    @07,CONVDAYS(,@03)                                  1542 07117000
         CR    @07,@14                                             1542 07118000
         BNH   @RF01542                                            1542 07119000
*               /*****************************************************/ 07120000
*               /*                                                   */ 07121000
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/ 07122000
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/ 07123000
*               /*                                                   */ 07124000
*               /*****************************************************/ 07125000
*                                                                  1543 07126000
*               DO;                 /*                       @Z40LB35*/ 07127000
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/ 07128000
         SLR   ADJDAYS,@14                                         1544 07129000
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/ 07130000
         AL    @15,@CF00222                                        1545 07131000
         STH   @15,CONVYEAR(,@03)                                  1545 07132000
*               END;                /*                       @Z40LB35*/ 07133000
*             ELSE                                                 1547 07134000
*                                                                  1547 07135000
*               /*****************************************************/ 07136000
*               /*                                                   */ 07137000
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/ 07138000
*               /* OF DO LOOP                                @Z40LB35*/ 07139000
*               /*                                                   */ 07140000
*               /*****************************************************/ 07141000
*                                                                  1547 07142000
*               DO;                 /*                       @Z40LB35*/ 07143000
         B     @RC01542                                            1547 07144000
@RF01542 DS    0H                                                  1548 07145000
*                 CONVDAYS=ADJDAYS+CONVDAYS;/*               @Z40LB35*/ 07146000
         LA    @03,DTSAREA                                         1548 07147000
         L     @03,DATRETRN(,@03)                                  1548 07148000
         LR    @15,ADJDAYS                                         1548 07149000
         AH    @15,CONVDAYS(,@03)                                  1548 07150000
         STH   @15,CONVDAYS(,@03)                                  1548 07151000
*                 QUITSW=ON;        /*                       @Z40LB35*/ 07152000
         OI    QUITSW,B'10000000'                                  1549 07153000
*               END;                /*                       @Z40LB35*/ 07154000
*           ELSE                                                   1551 07155000
*                                                                  1551 07156000
*             /*******************************************************/ 07157000
*             /*                                                     */ 07158000
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/ 07159000
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */ 07160000
*             /*                                             @Z40LB35*/ 07161000
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/ 07162000
*             /*                                                     */ 07163000
*             /*******************************************************/ 07164000
*                                                                  1551 07165000
*             IF(ADJDAYS+CONVDAYS)>REGYEAR THEN                    1551 07166000
*                                                                  1551 07167000
         B     @RC01541                                            1551 07168000
@RF01541 LH    @03,REGYEAR                                         1551 07169000
         LA    @15,DTSAREA                                         1551 07170000
         L     @15,DATRETRN(,@15)                                  1551 07171000
         LR    @14,ADJDAYS                                         1551 07172000
         AH    @14,CONVDAYS(,@15)                                  1551 07173000
         CR    @14,@03                                             1551 07174000
         BNH   @RF01551                                            1551 07175000
*               /*****************************************************/ 07176000
*               /*                                                   */ 07177000
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/ 07178000
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/ 07179000
*               /*                                                   */ 07180000
*               /*****************************************************/ 07181000
*                                                                  1552 07182000
*               DO;                 /*                       @Z40LB35*/ 07183000
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/ 07184000
         SLR   ADJDAYS,@03                                         1553 07185000
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/ 07186000
         LA    @03,1                                               1554 07187000
         AH    @03,CONVYEAR(,@15)                                  1554 07188000
         STH   @03,CONVYEAR(,@15)                                  1554 07189000
*               END;                /*                       @Z40LB35*/ 07190000
*             ELSE                                                 1556 07191000
*                                                                  1556 07192000
*               /*****************************************************/ 07193000
*               /*                                                   */ 07194000
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/ 07195000
*               /* OF DO LOOP                                @Z40LB35*/ 07196000
*               /*                                                   */ 07197000
*               /*****************************************************/ 07198000
*                                                                  1556 07199000
*               DO;                 /*                       @Z40LB35*/ 07200000
         B     @RC01551                                            1556 07201000
@RF01551 DS    0H                                                  1557 07202000
*                 CONVDAYS=CONVDAYS+ADJDAYS;/*               @Z40LB35*/ 07203000
         LA    @03,DTSAREA                                         1557 07204000
         L     @03,DATRETRN(,@03)                                  1557 07205000
         LR    @15,ADJDAYS                                         1557 07206000
         AH    @15,CONVDAYS(,@03)                                  1557 07207000
         STH   @15,CONVDAYS(,@03)                                  1557 07208000
*                 QUITSW=ON;        /*                       @Z40LB35*/ 07209000
         OI    QUITSW,B'10000000'                                  1558 07210000
*               END;                /*                       @Z40LB35*/ 07211000
*         END;                      /*                       @Z40LB35*/ 07212000
@RC01551 DS    0H                                                  1560 07213000
@RC01541 DS    0H                                                  1560 07214000
@DE01540 TM    QUITSW,B'10000000'                                  1560 07215000
         BZ    @DL01540                                            1560 07216000
*                                                                  1561 07217000
*       /*************************************************************/ 07218000
*       /*                                                           */ 07219000
*       /* IF DAYS ARE TO BE SUBTRACTED FROM CURRENT,        @Z40LB35*/ 07220000
*       /* DO THE FOLLOWING DO GROUP                         @Z40LB35*/ 07221000
*       /*                                                           */ 07222000
*       /*************************************************************/ 07223000
*                                                                  1561 07224000
*       ELSE                                                       1561 07225000
*                                                                  1561 07226000
*         /***********************************************************/ 07227000
*         /*                                                         */ 07228000
*         /* DO THE FOLLOWING WHILE THE QUITSW IS NOT SET    @Z40LB35*/ 07229000
*         /*                                                         */ 07230000
*         /***********************************************************/ 07231000
*                                                                  1561 07232000
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/ 07233000
*                                                                  1561 07234000
         B     @RC01539                                            1561 07235000
@RF01539 B     @DE01561                                            1561 07236000
@DL01561 DS    0H                                                  1562 07237000
*           /*********************************************************/ 07238000
*           /*                                                       */ 07239000
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/ 07240000
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/ 07241000
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/ 07242000
*           /*                                                       */ 07243000
*           /*********************************************************/ 07244000
*                                                                  1562 07245000
*           IF(CONVYEAR-1)//4=NOREMAIN THEN                        1562 07246000
*                                                                  1562 07247000
         LA    @03,DTSAREA                                         1562 07248000
         L     @03,DATRETRN(,@03)                                  1562 07249000
         LH    @15,CONVYEAR(,@03)                                  1562 07250000
         BCTR  @15,0                                               1562 07251000
         LR    @00,@15                                             1562 07252000
         SRDA  @00,32                                              1562 07253000
         D     @00,@CF00043                                        1562 07254000
         CH    @00,NOREMAIN                                        1562 07255000
         BNE   @RF01562                                            1562 07256000
*             /*******************************************************/ 07257000
*             /*                                                     */ 07258000
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/ 07259000
*             /*                                                     */ 07260000
*             /*******************************************************/ 07261000
*                                                                  1563 07262000
*             IF ADJDAYS>=LEAPYEAR THEN                            1563 07263000
*                                                                  1563 07264000
         LH    @14,LEAPYEAR                                        1563 07265000
         CR    ADJDAYS,@14                                         1563 07266000
         BL    @RF01563                                            1563 07267000
*               /*****************************************************/ 07268000
*               /*                                                   */ 07269000
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/ 07270000
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/ 07271000
*               /*                                                   */ 07272000
*               /*****************************************************/ 07273000
*                                                                  1564 07274000
*               DO;                 /*                       @Z40LB35*/ 07275000
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/ 07276000
         SLR   ADJDAYS,@14                                         1565 07277000
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/ 07278000
         STH   @15,CONVYEAR(,@03)                                  1566 07279000
*               END;                /*                       @Z40LB35*/ 07280000
*             ELSE                                                 1568 07281000
*                                                                  1568 07282000
*               /*****************************************************/ 07283000
*               /*                                                   */ 07284000
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/ 07285000
*               /*                                                   */ 07286000
*               /*****************************************************/ 07287000
*                                                                  1568 07288000
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1568 07289000
*                                                                  1568 07290000
         B     @RC01563                                            1568 07291000
@RF01563 LA    @03,DTSAREA                                         1568 07292000
         L     @03,DATRETRN(,@03)                                  1568 07293000
         LH    @15,CONVDAYS(,@03)                                  1568 07294000
         LR    @14,@15                                             1568 07295000
         SLR   @14,ADJDAYS                                         1568 07296000
         LTR   @14,@14                                             1568 07297000
         BP    @RF01568                                            1568 07298000
*                 /***************************************************/ 07299000
*                 /*                                                 */ 07300000
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/ 07301000
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */ 07302000
*                 /*                                         @Z40LB35*/ 07303000
*                 /*                                                 */ 07304000
*                 /***************************************************/ 07305000
*                                                                  1569 07306000
*                 DO;               /*                       @Z40LB35*/ 07307000
*                   CONVDAYS=CONVDAYS+LEAPYEAR-ADJDAYS;            1570 07308000
         AH    @15,LEAPYEAR                                        1570 07309000
         SLR   @15,ADJDAYS                                         1570 07310000
         STH   @15,CONVDAYS(,@03)                                  1570 07311000
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/ 07312000
         LH    @15,CONVYEAR(,@03)                                  1571 07313000
         BCTR  @15,0                                               1571 07314000
         STH   @15,CONVYEAR(,@03)                                  1571 07315000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 07316000
         OI    QUITSW,B'10000000'                                  1572 07317000
*                 END;              /*                       @Z40LB35*/ 07318000
*               ELSE                                               1574 07319000
*                                                                  1574 07320000
*                 /***************************************************/ 07321000
*                 /*                                                 */ 07322000
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */ 07323000
*                 /*                                         @Z40LB35*/ 07324000
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/ 07325000
*                 /*                                                 */ 07326000
*                 /***************************************************/ 07327000
*                                                                  1574 07328000
*                 DO;               /*                       @Z40LB35*/ 07329000
         B     @RC01568                                            1574 07330000
@RF01568 DS    0H                                                  1575 07331000
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/ 07332000
         LA    @03,DTSAREA                                         1575 07333000
         L     @03,DATRETRN(,@03)                                  1575 07334000
         LH    @15,CONVDAYS(,@03)                                  1575 07335000
         SLR   @15,ADJDAYS                                         1575 07336000
         STH   @15,CONVDAYS(,@03)                                  1575 07337000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 07338000
         OI    QUITSW,B'10000000'                                  1576 07339000
*                 END;              /*                       @Z40LB35*/ 07340000
*                                                                  1577 07341000
*           /*********************************************************/ 07342000
*           /*                                                       */ 07343000
*           /* ELSE THIS IS A NORMAL YEAR(NON-LEAP YEAR)     @Z40LB35*/ 07344000
*           /*                                                       */ 07345000
*           /*********************************************************/ 07346000
*                                                                  1578 07347000
*           ELSE                                                   1578 07348000
*                                                                  1578 07349000
*             /*******************************************************/ 07350000
*             /*                                                     */ 07351000
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/ 07352000
*             /*                                                     */ 07353000
*             /*******************************************************/ 07354000
*                                                                  1578 07355000
*             IF ADJDAYS>=REGYEAR THEN                             1578 07356000
*                                                                  1578 07357000
         B     @RC01562                                            1578 07358000
@RF01562 LH    @03,REGYEAR                                         1578 07359000
         CR    ADJDAYS,@03                                         1578 07360000
         BL    @RF01578                                            1578 07361000
*               /*****************************************************/ 07362000
*               /*                                                   */ 07363000
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/ 07364000
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/ 07365000
*               /*                                                   */ 07366000
*               /*****************************************************/ 07367000
*                                                                  1579 07368000
*               DO;                 /*                       @Z40LB35*/ 07369000
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/ 07370000
         SLR   ADJDAYS,@03                                         1580 07371000
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/ 07372000
         LA    @03,DTSAREA                                         1581 07373000
         L     @03,DATRETRN(,@03)                                  1581 07374000
         LH    @15,CONVYEAR(,@03)                                  1581 07375000
         BCTR  @15,0                                               1581 07376000
         STH   @15,CONVYEAR(,@03)                                  1581 07377000
*               END;                /*                       @Z40LB35*/ 07378000
*             ELSE                                                 1583 07379000
*                                                                  1583 07380000
*               /*****************************************************/ 07381000
*               /*                                                   */ 07382000
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/ 07383000
*               /*                                                   */ 07384000
*               /*****************************************************/ 07385000
*                                                                  1583 07386000
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1583 07387000
*                                                                  1583 07388000
         B     @RC01578                                            1583 07389000
@RF01578 LA    @03,DTSAREA                                         1583 07390000
         L     @03,DATRETRN(,@03)                                  1583 07391000
         LH    @15,CONVDAYS(,@03)                                  1583 07392000
         LR    @14,@15                                             1583 07393000
         SLR   @14,ADJDAYS                                         1583 07394000
         LTR   @14,@14                                             1583 07395000
         BP    @RF01583                                            1583 07396000
*                 /***************************************************/ 07397000
*                 /*                                                 */ 07398000
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/ 07399000
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */ 07400000
*                 /*                                         @Z40LB35*/ 07401000
*                 /*                                                 */ 07402000
*                 /***************************************************/ 07403000
*                                                                  1584 07404000
*                 DO;               /*                       @Z40LB35*/ 07405000
*                   CONVDAYS=CONVDAYS+REGYEAR-ADJDAYS;             1585 07406000
         AH    @15,REGYEAR                                         1585 07407000
         SLR   @15,ADJDAYS                                         1585 07408000
         STH   @15,CONVDAYS(,@03)                                  1585 07409000
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/ 07410000
         LH    @15,CONVYEAR(,@03)                                  1586 07411000
         BCTR  @15,0                                               1586 07412000
         STH   @15,CONVYEAR(,@03)                                  1586 07413000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 07414000
         OI    QUITSW,B'10000000'                                  1587 07415000
*                 END;              /*                       @Z40LB35*/ 07416000
*               ELSE                                               1589 07417000
*                                                                  1589 07418000
*                 /***************************************************/ 07419000
*                 /*                                                 */ 07420000
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */ 07421000
*                 /*                                         @Z40LB35*/ 07422000
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/ 07423000
*                 /*                                                 */ 07424000
*                 /***************************************************/ 07425000
*                                                                  1589 07426000
*                 DO;               /*                       @Z40LB35*/ 07427000
         B     @RC01583                                            1589 07428000
@RF01583 DS    0H                                                  1590 07429000
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/ 07430000
         LA    @03,DTSAREA                                         1590 07431000
         L     @03,DATRETRN(,@03)                                  1590 07432000
         LH    @15,CONVDAYS(,@03)                                  1590 07433000
         SLR   @15,ADJDAYS                                         1590 07434000
         STH   @15,CONVDAYS(,@03)                                  1590 07435000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 07436000
         OI    QUITSW,B'10000000'                                  1591 07437000
*                 END;              /*                       @Z40LB35*/ 07438000
*         END;                      /*                       @Z40LB35*/ 07439000
@RC01583 DS    0H                                                  1593 07440000
@RC01578 DS    0H                                                  1593 07441000
@RC01562 DS    0H                                                  1593 07442000
@DE01561 TM    QUITSW,B'10000000'                                  1593 07443000
         BZ    @DL01561                                            1593 07444000
*     END;                          /*                       @Z40LB35*/ 07445000
@RC01539 DS    0H                                                  1595 07446000
*                                                                  1595 07447000
*   /*****************************************************************/ 07448000
*   /*                                                               */ 07449000
*   /* DETERMINE IF THE CALLER WANTS THE DATE                @Z40LB35*/ 07450000
*   /* CONVERTED                                             @Z40LB35*/ 07451000
*   /*                                                               */ 07452000
*   /*****************************************************************/ 07453000
*                                                                  1595 07454000
*   IF DATDTEOP=ON THEN                                            1595 07455000
*                                                                  1595 07456000
@RF01531 LA    @15,DTSAREA                                         1595 07457000
         TM    DATDTEOP(@15),B'00100000'                           1595 07458000
         BNO   @RF01595                                            1595 07459000
*     /***************************************************************/ 07460000
*     /*                                                             */ 07461000
*     /* IF CALLER WANTS DATE CONVERTED, CONVERT THE         @Z40LB35*/ 07462000
*     /* DATE BY SEPARATING THE YEARS FROM THE DAYS          @Z40LB35*/ 07463000
*     /*                                                             */ 07464000
*     /***************************************************************/ 07465000
*                                                                  1596 07466000
*     DO;                           /*                       @Z40LB35*/ 07467000
*       CONVYEAR=DATDATE/1000;      /*                       @Z40LB35*/ 07468000
         L     @14,DATRETRN(,@15)                                  1597 07469000
         LA    @07,1000                                            1597 07470000
         L     @15,DATDATE(,@15)                                   1597 07471000
         LR    @00,@15                                             1597 07472000
         SRDA  @00,32                                              1597 07473000
         DR    @00,@07                                             1597 07474000
         STH   @01,CONVYEAR(,@14)                                  1597 07475000
*       CONVDAYS=DATDATE-(CONVYEAR*1000);/*                  @Z40LB35*/ 07476000
         MR    @00,@07                                             1598 07477000
         SLR   @15,@01                                             1598 07478000
         STH   @15,CONVDAYS(,@14)                                  1598 07479000
*     END;                          /*                       @Z40LB35*/ 07480000
*                                                                  1599 07481000
*   /*****************************************************************/ 07482000
*   /*                                                               */ 07483000
*   /* HERE THE DETERMINATION WILL BE MADE TO SEE            @Z40LB35*/ 07484000
*   /* IF THE LIMITS ARE VIOLATED                            @Z40LB35*/ 07485000
*   /* IF SO, FORCE THE DATE TO FALL WITHIN THE              @Z40LB35*/ 07486000
*   /* LIMITS (0 99999)                                      @Z40LB35*/ 07487000
*   /*                                                               */ 07488000
*   /*****************************************************************/ 07489000
*                                                                  1600 07490000
*   IF CONVYEAR>MAXYEAR THEN                                       1600 07491000
@RF01595 LH    @15,MAXYEAR                                         1600 07492000
         LA    @14,DTSAREA                                         1600 07493000
         L     @14,DATRETRN(,@14)                                  1600 07494000
         CH    @15,CONVYEAR(,@14)                                  1600 07495000
         BNL   @RF01600                                            1600 07496000
*     DO;                           /*                       @Z40LB35*/ 07497000
*       CONVYEAR=MAXYEAR;           /*                       @Z40LB35*/ 07498000
         STH   @15,CONVYEAR(,@14)                                  1602 07499000
*       CONVDAYS=MAXDAYS;           /*                       @Z40LB35*/ 07500000
         LH    @15,MAXDAYS                                         1603 07501000
         STH   @15,CONVDAYS(,@14)                                  1603 07502000
*     END;                          /*                       @Z40LB35*/ 07503000
*   ELSE                                                           1605 07504000
*     IF CONVYEAR<MINYEAR|CONVDAYS<MINDAYS THEN                    1605 07505000
         B     @RC01600                                            1605 07506000
@RF01600 LA    @15,DTSAREA                                         1605 07507000
         L     @15,DATRETRN(,@15)                                  1605 07508000
         LH    @14,CONVYEAR(,@15)                                  1605 07509000
         CH    @14,MINYEAR                                         1605 07510000
         BL    @RT01605                                            1605 07511000
         LH    @15,CONVDAYS(,@15)                                  1605 07512000
         CH    @15,MINDAYS                                         1605 07513000
         BNL   @RF01605                                            1605 07514000
@RT01605 DS    0H                                                  1606 07515000
*       DO;                         /*                       @Z40LB35*/ 07516000
*         CONVYEAR=MINYEAR;         /*                       @Z40LB35*/ 07517000
         LA    @15,DTSAREA                                         1607 07518000
         L     @15,DATRETRN(,@15)                                  1607 07519000
         LH    @14,MINYEAR                                         1607 07520000
         STH   @14,CONVYEAR(,@15)                                  1607 07521000
*         CONVDAYS=MINDAYS;         /*                       @Z40LB35*/ 07522000
         LH    @14,MINDAYS                                         1608 07523000
         STH   @14,CONVDAYS(,@15)                                  1608 07524000
*       END;                        /*                       @Z40LB35*/ 07525000
*                                                                  1609 07526000
*   /*****************************************************************/ 07527000
*   /*                                                               */ 07528000
*   /* RETURN TO CALLER WITH RETURN CODE ZERO                @Z40LB35*/ 07529000
*   /*                                                               */ 07530000
*   /*****************************************************************/ 07531000
*                                                                  1610 07532000
*   IF GDTDBG=NULLPTR THEN                                         1610 07533000
@RF01605 DS    0H                                                  1610 07534000
@RC01600 L     @15,@PC00001                                        1610 07535000
         L     @15,GDTDBG(,@15)                                    1610 07536000
         LTR   @15,@15                                             1610 07537000
         BZ    @RT01610                                            1610 07538000
*     ;                                                            1611 07539000
*   ELSE                                                           1612 07540000
*     CALL IDCDB010(GDTTBL,'DTND'); /*                       @Z40LB35*/ 07541000
         L     @15,@PC00001                                        1612 07542000
         ST    @15,@AL00001                                        1612 07543000
         LA    @14,@CC01737                                        1612 07544000
         ST    @14,@AL00001+4                                      1612 07545000
         MVI   @AL00001+4,X'80'                                    1612 07546000
         L     @15,GDTDBG(,@15)                                    1612 07547000
         LA    @01,@AL00001                                        1612 07548000
         BALR  @14,@15                                             1612 07549000
*   RETURN CODE(0);                 /*                       @Z40LB35*/ 07550000
@RT01610 SLR   @15,@15                                             1613 07551000
         L     @14,@SA00020                                        1613 07552000
         LM    @00,@12,@SA00020+8                                  1613 07553000
         BR    @14                                                 1613 07554000
*   END DATES;                      /*                       @Z40LB35*/ 07555000
*                                                                  1615 07556000
*/***********************************************************@Y30LB39*/ 07557000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07558000
*/*                                                          @Y30LB39*/ 07559000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07560000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07561000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07562000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07563000
*/*                                                          @Y30LB39*/ 07564000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07565000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07566000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07567000
*/*                                                          @Y30LB39*/ 07568000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07569000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07570000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07571000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07572000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07573000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07574000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07575000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07576000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07577000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07578000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07579000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07580000
*/*                                                          @Y30LB39*/ 07581000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07582000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07583000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07584000
*/*                                                          @Y30LB39*/ 07585000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07586000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07587000
*/*                                                          @Y30LB39*/ 07588000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07589000
*/*                                                          @Y30LB39*/ 07590000
*/***********************************************************@Y30LB39*/ 07591000
*                                                                  1615 07592000
*                                   /*                       @Y30LB39*/ 07593000
*SSCMSG:                                                           1615 07594000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07595000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07596000
*                                                            @Y30LB39*/ 07597000
SSCMSG   STM   @14,@12,@SA00021                                    1615 07598000
         MVC   @PC00021(8),0(@01)                                  1615 07599000
*                                   /*                       @Y30LB39*/ 07600000
*                                                                  1616 07601000
*   /*****************************************************************/ 07602000
*   /*                                                               */ 07603000
*   /*                                                       @Y30LB39*/ 07604000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07605000
*   /*                                                       @Y30LB39*/ 07606000
*   /*                                                               */ 07607000
*   /*****************************************************************/ 07608000
*                                                                  1616 07609000
*                                   /*                       @Y30LB39   07610000
*                                                            @Y30LB39*/ 07611000
*                                                                  1616 07612000
*   /*****************************************************************/ 07613000
*   /*                                                               */ 07614000
*   /*                                                       @Y30LB39*/ 07615000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07616000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07617000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07618000
*   /*                                                       @Y30LB39*/ 07619000
*   /*                                                               */ 07620000
*   /*****************************************************************/ 07621000
*                                                                  1616 07622000
*                                   /*                       @Y30LB39*/ 07623000
*   DCL                                                            1616 07624000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07625000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07626000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07627000
*   DCL                                                            1617 07628000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07629000
*                                                            @Y30LB39   07630000
*                                                            @Y30LB39*/ 07631000
*                                                                  1617 07632000
*   /*****************************************************************/ 07633000
*   /*                                                               */ 07634000
*   /*                                                       @Y30LB39*/ 07635000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07636000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07637000
*   /*                                                       @Y30LB39*/ 07638000
*   /*                                                               */ 07639000
*   /*****************************************************************/ 07640000
*                                                                  1618 07641000
*                                   /*                       @Y30LB39*/ 07642000
*   DCL                                                            1618 07643000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07644000
*   DCL                                                            1619 07645000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07646000
*                                                            @Y30LB39*/ 07647000
*                                                                  1619 07648000
*   /*****************************************************************/ 07649000
*   /*                                                               */ 07650000
*   /*                                                       @Y30LB39*/ 07651000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07652000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07653000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07654000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07655000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07656000
*   /*                                                       @Y30LB39*/ 07657000
*   /*                                                               */ 07658000
*   /*****************************************************************/ 07659000
*                                                                  1620 07660000
*                                   /*                       @Y30LB39*/ 07661000
*   DECLARE                                                        1620 07662000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07663000
*                                                            @Y30LB39*/ 07664000
*                                                                  1620 07665000
*   /*****************************************************************/ 07666000
*   /*                                                               */ 07667000
*   /*                                                       @Y30LB39*/ 07668000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07669000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07670000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07671000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07672000
*   /*                                                       @Y30LB39*/ 07673000
*   /*                                                               */ 07674000
*   /*****************************************************************/ 07675000
*                                                                  1621 07676000
*                                   /*                       @Y30LB39*/ 07677000
*   DECLARE                                                        1621 07678000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07679000
*                                                            @Y30LB39*/ 07680000
*                                                                  1621 07681000
*   /*****************************************************************/ 07682000
*   /*                                                               */ 07683000
*   /*                                                       @Y30LB39*/ 07684000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07685000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07686000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07687000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07688000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07689000
*   /*                                                       @Y30LB39*/ 07690000
*   /*                                                               */ 07691000
*   /*****************************************************************/ 07692000
*                                                                  1622 07693000
*                                   /*                       @Y30LB39*/ 07694000
*   DECLARE                                                        1622 07695000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07696000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07697000
*                                                            @Y30LB39*/ 07698000
*                                                                  1622 07699000
*   /*****************************************************************/ 07700000
*   /*                                                               */ 07701000
*   /*                                                       @Y30LB39*/ 07702000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07703000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07704000
*   /*                                                       @Y30LB39*/ 07705000
*   /*                                                               */ 07706000
*   /*****************************************************************/ 07707000
*                                                                  1623 07708000
*                                   /*                       @Y30LB39*/ 07709000
*   DECLARE                                                        1623 07710000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07711000
*                                                            @Y30LB39*/ 07712000
*                                                                  1623 07713000
*   /*****************************************************************/ 07714000
*   /*                                                               */ 07715000
*   /*                                                       @Y30LB39*/ 07716000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07717000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07718000
*   /*                                                       @Y30LB39*/ 07719000
*   /*                                                               */ 07720000
*   /*****************************************************************/ 07721000
*                                                                  1624 07722000
*                                   /*                       @Y30LB39*/ 07723000
*   DECLARE                                                        1624 07724000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07725000
*                                                            @Y30LB39*/ 07726000
*                                   /*                       @Y30LB39*/ 07727000
*                                                                  1625 07728000
*   /*****************************************************************/ 07729000
*   /*                                                               */ 07730000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07731000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07732000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07733000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07734000
*   /*                                                       @Y30LB39*/ 07735000
*   /*                                                               */ 07736000
*   /*****************************************************************/ 07737000
*                                                                  1625 07738000
*                                   /*                       @Y30LB39*/ 07739000
*   OLDERID2=NEWERID2;                                             1625 07740000
         L     @15,@PC00001                                        1625 07741000
         L     @14,GDTTR2(,@15)                                    1625 07742000
         MVC   @TS00001(95),NEWERID2(@14)                          1625 07743000
         MVC   OLDERID2(95,@14),@TS00001                           1625 07744000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07745000
*                                                            @Y30LB39*/ 07746000
*                                                                  1626 07747000
         MVC   NEWID2(4,@14),@CC01757                              1626 07748000
*   /*****************************************************************/ 07749000
*   /*                                                               */ 07750000
*   /*                                                       @Y30LB39*/ 07751000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 07752000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 07753000
*   /*                                                       @Y30LB39*/ 07754000
*   /*                                                               */ 07755000
*   /*****************************************************************/ 07756000
*                                                                  1627 07757000
*                                   /*                       @Y30LB39*/ 07758000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   07759000
*                                                            @Y30LB39*/ 07760000
*                                                                  1627 07761000
         LA    @14,SSDRGLT                                         1627 07762000
         ST    @14,SSDLPTR                                         1627 07763000
*   /*****************************************************************/ 07764000
*   /*                                                               */ 07765000
*   /*                                                       @Y30LB39*/ 07766000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 07767000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 07768000
*   /*                                                       @Y30LB39*/ 07769000
*   /*                                                               */ 07770000
*   /*****************************************************************/ 07771000
*                                                                  1628 07772000
*                                   /*                       @Y30LB39*/ 07773000
*   IF SSRCODE>0 THEN                                              1628 07774000
         L     @07,@PC00021                                        1628 07775000
         L     @07,SSRCODE(,@07)                                   1628 07776000
         LTR   @07,@07                                             1628 07777000
         BNP   @RF01628                                            1628 07778000
*     DO;                           /*                       @Y30LB39   07779000
*                                                            @Y30LB39*/ 07780000
*                                                                  1629 07781000
*       /*************************************************************/ 07782000
*       /*                                                           */ 07783000
*       /*                                                   @Y30LB39*/ 07784000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 07785000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 07786000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 07787000
*       /* CODES.                                            @Y30LB39*/ 07788000
*       /*                                                   @Y30LB39*/ 07789000
*       /*                                                           */ 07790000
*       /*************************************************************/ 07791000
*                                                                  1630 07792000
*                                   /*                       @Y30LB39*/ 07793000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07794000
         XC    SSDRGLT(20),SSDRGLT                                 1630 07795000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 07796000
         LA    @03,SSINXLST                                        1631 07797000
         ST    @03,DARGRETP(,@14)                                  1631 07798000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07799000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1632 07800000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 07801000
         MVI   DARGSENT(@14),X'01'                                 1633 07802000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   07803000
*                                                            @Y30LB39*/ 07804000
*                                                                  1634 07805000
         MVC   DARGRETL(2,@14),@CH01766                            1634 07806000
*       /*************************************************************/ 07807000
*       /*                                                           */ 07808000
*       /*                                                   @Y30LB39*/ 07809000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 07810000
*       /* ARRAY.                                            @Y30LB39*/ 07811000
*       /*                                                   @Y30LB39*/ 07812000
*       /*                                                           */ 07813000
*       /*************************************************************/ 07814000
*                                                                  1635 07815000
*                                   /*                       @Y30LB39*/ 07816000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   07817000
*                                                            @Y30LB39*/ 07818000
*                                                                  1635 07819000
         ST    @15,@AL00001                                        1635 07820000
         LA    @03,@CF00117                                        1635 07821000
         ST    @03,@AL00001+4                                      1635 07822000
         LA    @03,SSDLPTR                                         1635 07823000
         ST    @03,@AL00001+8                                      1635 07824000
         MVI   @AL00001+8,X'80'                                    1635 07825000
         L     @15,GDTPRT(,@15)                                    1635 07826000
         LA    @01,@AL00001                                        1635 07827000
         BALR  @14,@15                                             1635 07828000
*       /*************************************************************/ 07829000
*       /*                                                           */ 07830000
*       /*                                                   @Y30LB39*/ 07831000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 07832000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 07833000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 07834000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 07835000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 07836000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 07837000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 07838000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 07839000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 07840000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 07841000
*       /* REASON CODE.                                      @Y30LB39*/ 07842000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 07843000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 07844000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 07845000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 07846000
*       /*                                                   @Y30LB39*/ 07847000
*       /*                                                           */ 07848000
*       /*************************************************************/ 07849000
*                                                                  1636 07850000
*                                   /*                       @Y30LB39*/ 07851000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 07852000
         LA    ENTRYNUM,1                                          1636 07853000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1637 07854000
@DL01637 DS    0H                                                  1638 07855000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 07856000
         AL    ENTRYNUM,@CF00222                                   1638 07857000
*       END;                        /*                       @Y30LB39   07858000
*                                                            @Y30LB39*/ 07859000
*                                                                  1639 07860000
@DE01637 L     @03,@PC00021                                        1639 07861000
         LR    @15,ENTRYNUM                                        1639 07862000
         ALR   @15,@15                                             1639 07863000
         LH    @15,SSARRAY-2(@15)                                  1639 07864000
         CH    @15,SSRHALF(,@03)                                   1639 07865000
         BE    @DC01637                                            1639 07866000
         SLR   @14,@14                                             1639 07867000
         CR    @15,@14                                             1639 07868000
         BNE   @DL01637                                            1639 07869000
@DC01637 DS    0H                                                  1640 07870000
*       /*************************************************************/ 07871000
*       /*                                                           */ 07872000
*       /*                                                   @Y30LB39*/ 07873000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 07874000
*       /*                                                   @Y30LB39*/ 07875000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 07876000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 07877000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 07878000
*       /* CODE OR                                           @Y30LB39*/ 07879000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 07880000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 07881000
*       /*                                                   @Y30LB39*/ 07882000
*       /*                                                           */ 07883000
*       /*************************************************************/ 07884000
*                                                                  1640 07885000
*                                   /*                       @Y30LB39*/ 07886000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07887000
         XC    SSDRGLT(20),SSDRGLT                                 1640 07888000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07889000
         L     @07,SSDLPTR                                         1641 07890000
         MVC   DARGSMOD(3,@07),SSMODSS0                            1641 07891000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 07892000
         STC   ENTRYNUM,DARGSENT(,@07)                             1642 07893000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 07894000
         CR    @15,@14                                             1643 07895000
         BNE   @RF01643                                            1643 07896000
*         DO;                       /*                       @Y30LB39*/ 07897000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 07898000
         ST    @03,DARGDBP(,@07)                                   1645 07899000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 07900000
         MVC   DARGILP(2,@07),@CH00043                             1646 07901000
*         END;                      /*                       @Y30LB39*/ 07902000
*     END;                          /*                       @Y30LB39*/ 07903000
*                                   /*                       @Y30LB39*/ 07904000
*                                                                  1649 07905000
*   /*****************************************************************/ 07906000
*   /*                                                               */ 07907000
*   /*                                                       @Y30LB39*/ 07908000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 07909000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 07910000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 07911000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 07912000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 07913000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 07914000
*   /* POST CODE.                                            @Y30LB39*/ 07915000
*   /*                                                       @Y30LB39*/ 07916000
*   /*                                                               */ 07917000
*   /*****************************************************************/ 07918000
*                                                                  1649 07919000
*                                   /*                       @Y30LB39*/ 07920000
*   ELSE                            /*                       @Y30LB39*/ 07921000
*     DO;                           /*                       @Y30LB39*/ 07922000
         B     @RC01628                                            1649 07923000
@RF01628 DS    0H                                                  1650 07924000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07925000
         XC    SSDRGLT(20),SSDRGLT                                 1650 07926000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 07927000
         L     @15,SSDLPTR                                         1651 07928000
         MVC   DARGSMOD(3,@15),SSMODCM0                            1651 07929000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 07930000
         MVC   DARGSENT(1,@15),SSMSGNUM                            1652 07931000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 07932000
         L     @14,@PC00021+4                                      1653 07933000
         ST    @14,DARGDBP(,@15)                                   1653 07934000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 07935000
         MVC   DARGILP(2,@15),@CH00222                             1654 07936000
*     END;                          /*                       @Y30LB39   07937000
*                                                            @Y30LB39*/ 07938000
*                                                                  1655 07939000
*   /*****************************************************************/ 07940000
*   /*                                                               */ 07941000
*   /*                                                       @Y30LB39*/ 07942000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 07943000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 07944000
*   /*                                                       @Y30LB39*/ 07945000
*   /*                                                               */ 07946000
*   /*****************************************************************/ 07947000
*                                                                  1656 07948000
*                                   /*                       @Y30LB39*/ 07949000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   07950000
*                                                            @Y30LB39*/ 07951000
*                                                                  1656 07952000
@RC01628 L     @15,@PC00001                                        1656 07953000
         ST    @15,@AL00001                                        1656 07954000
         LA    @14,@CF00117                                        1656 07955000
         ST    @14,@AL00001+4                                      1656 07956000
         LA    @14,SSDLPTR                                         1656 07957000
         ST    @14,@AL00001+8                                      1656 07958000
         MVI   @AL00001+8,X'80'                                    1656 07959000
         L     @15,GDTPRT(,@15)                                    1656 07960000
         LA    @01,@AL00001                                        1656 07961000
         BALR  @14,@15                                             1656 07962000
*   /*****************************************************************/ 07963000
*   /*                                                               */ 07964000
*   /*                                                       @Y30LB39*/ 07965000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 07966000
*   /*                                                       @Y30LB39*/ 07967000
*   /*                                                               */ 07968000
*   /*****************************************************************/ 07969000
*                                                                  1657 07970000
*                                   /*                       @Y30LB39   07971000
*                                                            @Y30LB39*/ 07972000
*   RETURN CODE(0);                 /*                       @Y30LB39   07973000
*                                                            @Y30LB39*/ 07974000
         SLR   @15,@15                                             1657 07975000
         L     @14,@SA00021                                        1657 07976000
         LM    @00,@12,@SA00021+8                                  1657 07977000
         BR    @14                                                 1657 07978000
*   END SSCMSG;                     /*                       @Y30LB39*/ 07979000
*   END IDCLD01                     /*                       @Z40LB26*/ 07980000
*                                                                  1659 07981000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07982000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 07983000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 07984000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 07985000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 07986000
*/*%INCLUDE SYSLIB  (IDCCSLD )                                       */ 07987000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 07988000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 07989000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 07990000
*/*%INCLUDE SYSLIB  (IDCDF54 )                                       */ 07991000
*/*%INCLUDE SYSLIB  (IDCDF55 )                                       */ 07992000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 07993000
*                                                                  1659 07994000
*       ;                                                          1659 07995000
@DATA    DS    0H                                                       07996000
@CH00298 DC    H'5'                                                     07997000
@CH00159 DC    H'6'                                                     07998000
@CH00519 DC    H'7'                                                     07999000
@CH00182 DC    H'8'                                                     08000000
@CH00037 DC    H'10'                                                    08001000
@CH00279 DC    H'20'                                                    08002000
@CH01278 DC    H'30'                                                    08003000
@CH01703 DC    H'40'                                                    08004000
@CH01448 DC    H'50'                                                    08005000
@CH01464 DC    H'60'                                                    08006000
@CH01501 DC    H'66'                                                    08007000
@CH01704 DC    H'70'                                                    08008000
@CH01766 DC    H'120'                                                   08009000
@CH01473 DC    H'121'                                                   08010000
@CH01762 DC    H'164'                                                   08011000
@CH01761 DC    H'224'                                                   08012000
@SC01788 CLC   SRTELEM(0,@14),SRTELEM(@15)                              08013000
@DATD    DSECT                                                          08014000
         DS    0F                                                       08015000
@SA00001 DS    18F                                                      08016000
@PC00001 DS    3F                                                       08017000
@SA00020 DS    15F                                                      08018000
@SA00002 DS    1F                                                       08019000
@SA00003 DS    1F                                                       08020000
@SA00004 DS    1F                                                       08021000
@SA00005 DS    1F                                                       08022000
@SA00006 DS    1F                                                       08023000
@SA00019 DS    1F                                                       08024000
@SA00008 DS    1F                                                       08025000
@SA00011 DS    1F                                                       08026000
@SA00021 DS    15F                                                      08027000
@PC00021 DS    2F                                                       08028000
@SA00007 DS    1F                                                       08029000
@SA00009 DS    1F                                                       08030000
@SA00010 DS    15F                                                      08031000
@PC00010 DS    1F                                                       08032000
@SA00012 DS    1F                                                       08033000
@SA00014 DS    1F                                                       08034000
@SA00013 DS    1F                                                       08035000
@SA00016 DS    1F                                                       08036000
@SA00015 DS    1F                                                       08037000
@SA00017 DS    1F                                                       08038000
@SA00018 DS    1F                                                       08039000
@AL00001 DS    4A                                                       08040000
@TF00001 DS    F                                                        08041000
@TF00002 DS    F                                                        08042000
IDCLD01  CSECT                                                          08043000
         DS    0F                                                       08044000
@CF00117 DC    F'0'                                                     08045000
@CF00222 DC    F'1'                                                     08046000
@CH00222 EQU   @CF00222+2                                               08047000
@CF00156 DC    F'2'                                                     08048000
@CH00156 EQU   @CF00156+2                                               08049000
@CF00165 DC    F'3'                                                     08050000
@CF00043 DC    F'4'                                                     08051000
@CH00043 EQU   @CF00043+2                                               08052000
@CF00035 DC    F'12'                                                    08053000
@CH00035 EQU   @CF00035+2                                               08054000
@CF00849 DC    F'44'                                                    08055000
@CF01764 DC    F'80'                                                    08056000
@CH01764 EQU   @CF01764+2                                               08057000
@CF01408 DC    F'9999'                                                  08058000
@CF01787 DC    F'-81'                                                   08059000
@CF01790 DC    F'-80'                                                   08060000
@CF01792 DC    F'-64'                                                   08061000
@CF01791 DC    F'-16'                                                   08062000
@CF01782 DC    F'-7'                                                    08063000
@CF01781 DC    F'-5'                                                    08064000
@CF01653 DC    F'-1'                                                    08065000
@CF01517 DC    XL4'0208'                                                08066000
@CF01519 DC    XL4'0223'                                                08067000
@CF01521 DC    XL4'0224'                                                08068000
@DATD    DSECT                                                          08069000
         DS    0D                                                       08070000
LISTSCAN DS    A                                                        08071000
IOCSPTR  DS    A                                                        08072000
DDSTRU   DS    A                                                        08073000
FSADDR   DS    A                                                        08074000
ERCNVADR DS    A                                                        08075000
DMPINDEX DS    A                                                        08076000
CCMSGPTR DS    A                                                        08077000
CMMSGPTR DS    A                                                        08078000
CTMSGPTR DS    A                                                        08079000
RVVIPTR  DS    A                                                        08080000
GROUPPTR DS    A                                                        08081000
PRINTIT  DS    A                                                        08082000
LISTADDR DS    A                                                        08083000
EXPDATE  DS    F                                                        08084000
CREDATE  DS    F                                                        08085000
ADDRUCB  DS    A                                                        08086000
FILEUCB  DS    A                                                        08087000
VVICODE  DS    F                                                        08088000
VVICODE2 DS    F                                                        08089000
VOLPTR   DS    A                                                        08090000
SRTMAXCT DS    F                                                        08091000
SSDLPTR  DS    A                                                        08092000
LISTPTR  DS    A                                                        08093000
TOTALTRK DS    H                                                        08094000
INDEX    DS    H                                                        08095000
SETRC    DS    H                                                        08096000
LISTLN   DS    FL1                                                      08097000
         DS    0D                                                       08098000
@TS00001 DS    CL95                                                     08099000
         DS    CL1                                                      08100000
PCARG    DS    CL33                                                     08101000
         ORG   PCARG                                                    08102000
PCMTLP   DS    AL4                                                      08103000
PCSTLP   DS    AL4                                                      08104000
PCFLP    DS    AL4                                                      08105000
PCPCP    DS    AL4                                                      08106000
PCPNL    DS    FL2                                                      08107000
PCPTL    DS    FL2                                                      08108000
PCPDL    DS    FL2                                                      08109000
PCMTLC   DS    FL2                                                      08110000
PCSTLC   DS    FL2                                                      08111000
PCFLC    DS    FL2                                                      08112000
PCLW     DS    FL2                                                      08113000
PCPD     DS    FL2                                                      08114000
PCDSC    DS    AL1                                                      08115000
         ORG   PCARG+33                                                 08116000
VOLREC   DS    CL224                                                    08117000
GRPREC   DS    CL164                                                    08118000
         DS    CL3                                                      08119000
ALOCAREA DS    CL31                                                     08120000
         DS    CL1                                                      08121000
DARGAREA DS    CL76                                                     08122000
SLTAREA  DS    CL23                                                     08123000
         DS    CL1                                                      08124000
CHKAREA  DS    CL29                                                     08125000
         DS    CL3                                                      08126000
DTSAREA  DS    CL21                                                     08127000
         DS    CL3                                                      08128000
VOLRVVI  DS    CL68                                                     08129000
GRPRVVI  DS    CL68                                                     08130000
OPNAREA  DS    BL48                                                     08131000
SORTAREA DS    CL32                                                     08132000
AREAVS3  DS    CL59                                                     08133000
         DS    CL1                                                      08134000
PCRST    DS    CL8                                                      08135000
         ORG   PCRST                                                    08136000
PCRSST   DS    CL2                                                      08137000
PCRSTLC  DS    FL2                                                      08138000
PCRSTLP  DS    AL4                                                      08139000
         ORG   PCRST+8                                                  08140000
COMFLAGS DS    CL1                                                      08141000
         ORG   COMFLAGS                                                 08142000
ONEDONE  DS    BL1                                                      08143000
RDERROR  EQU   COMFLAGS+0                                               08144000
EOFILE   EQU   COMFLAGS+0                                               08145000
NOVOLS   EQU   COMFLAGS+0                                               08146000
EMPTYGRP EQU   COMFLAGS+0                                               08147000
@NM00107 EQU   COMFLAGS+0                                               08148000
         ORG   COMFLAGS+1                                               08149000
INTERFLG DS    BL1                                                      08150000
         ORG   INTERFLG                                                 08151000
ALOCFLG  DS    BL1                                                      08152000
INITVS3  EQU   INTERFLG+0                                               08153000
NOINITSW EQU   INTERFLG+0                                               08154000
@NM00108 EQU   INTERFLG+0                                               08155000
         ORG   INTERFLG+1                                               08156000
SORTWORK DS    CL80                                                     08157000
HOLD4CHR DS    CL4                                                      08158000
OLDGROUP DS    CL8                                                      08159000
DDNAME   DS    CL8                                                      08160000
UNITLIST DS    CL12                                                     08161000
         ORG   UNITLIST                                                 08162000
UNITCNT  DS    FL2                                                      08163000
UNITLNG  DS    FL2                                                      08164000
UNITNAME DS    CL8                                                      08165000
         ORG   UNITLIST+12                                              08166000
VOLLIST  DS    CL10                                                     08167000
         ORG   VOLLIST                                                  08168000
VOLCOUNT DS    FL2                                                      08169000
VOLLNG   DS    FL2                                                      08170000
VOLNAME  DS    CL6                                                      08171000
         ORG   VOLLIST+10                                               08172000
STGRPUSE DS    CL121                                                    08173000
         ORG   STGRPUSE                                                 08174000
CARCONT1 DS    CL1                                                      08175000
@NM00109 DS    CL46                                                     08176000
GRPUSE   DS    CL8                                                      08177000
@NM00110 DS    CL10                                                     08178000
GVOLUSE  DS    CL6                                                      08179000
FILL1    DS    CL50                                                     08180000
         ORG   STGRPUSE+121                                             08181000
         DS    CL3                                                      08182000
STGRPSTA DS    CL121                                                    08183000
         ORG   STGRPSTA                                                 08184000
CARCONT2 DS    CL1                                                      08185000
@NM00111 DS    CL43                                                     08186000
GRPSTAT  DS    CL8                                                      08187000
@NM00112 DS    CL10                                                     08188000
GVOLSTAT DS    CL6                                                      08189000
FILL2    DS    CL53                                                     08190000
         ORG   STGRPSTA+121                                             08191000
         DS    CL3                                                      08192000
STVOLUSE DS    CL121                                                    08193000
         ORG   STVOLUSE                                                 08194000
CARCONT3 DS    CL1                                                      08195000
@NM00113 DS    CL54                                                     08196000
VOLUSE   DS    CL6                                                      08197000
FILL3    DS    CL60                                                     08198000
         ORG   STVOLUSE+121                                             08199000
         DS    CL3                                                      08200000
STVOLSTA DS    CL121                                                    08201000
         ORG   STVOLSTA                                                 08202000
CARCONT4 DS    CL1                                                      08203000
@NM00114 DS    CL52                                                     08204000
VOLSTAT  DS    CL6                                                      08205000
FILL4    DS    CL62                                                     08206000
         ORG   STVOLSTA+121                                             08207000
STLGND   DS    CL121                                                    08208000
         DS    CL2                                                      08209000
PRINTCON DS    CL66                                                     08210000
         ORG   PRINTCON                                                 08211000
DASHV    DS    CL2                                                      08212000
DASHC    DS    CL2                                                      08213000
RDWRITE  DS    CL4                                                      08214000
WRITE    DS    CL4                                                      08215000
NOCAT    DS    CL3                                                      08216000
ERROR    DS    CL3                                                      08217000
PARTORG  DS    CL3                                                      08218000
PHYSEQ   DS    CL3                                                      08219000
UNKN     DS    CL3                                                      08220000
DIRACC   DS    CL3                                                      08221000
INDSEQ   DS    CL3                                                      08222000
UNMOVE   DS    CL1                                                      08223000
CYLINDER DS    CL5                                                      08224000
TRACK    DS    CL5                                                      08225000
BLOCK    DS    CL5                                                      08226000
ABSOLUTE DS    CL5                                                      08227000
PROTRACF DS    CL4                                                      08228000
PROTRFR  DS    CL4                                                      08229000
PROTRFW  DS    CL4                                                      08230000
         ORG   PRINTCON+66                                              08231000
SRTSTOP  DS    BL1                                                      08232000
SRTMOVE  DS    BL1                                                      08233000
TIMEVAR  DS    CL8                                                      08234000
DATEVAR  DS    CL4                                                      08235000
         ORG   DATEVAR                                                  08236000
@NM00118 DS    CL1                                                      08237000
DATEPACK DS    CL3                                                      08238000
         ORG   DATEVAR+4                                                08239000
QUITSW   DS    BL1                                                      08240000
SSDRGLT  DS    CL20                                                     08241000
         DS    CL3                                                      08242000
SSINXLST DS    CL120                                                    08243000
         ORG   SSINXLST                                                 08244000
SSARRAY  DS    60H                                                      08245000
         ORG   SSINXLST+120                                             08246000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08247000
@ENDDATD EQU   *                                                        08248000
IDCLD01  CSECT                                                          08249000
         DS    0F                                                       08250000
@SIZDATD DC    AL1(0)                                                   08251000
         DC    AL3(@ENDDATD-@DATD)                                      08252000
         DS    0D                                                       08253000
RVVLEN   DC    AL2(68)                                                  08254000
REGYEAR  DC    H'365'                                                   08255000
LEAPYEAR DC    H'366'                                                   08256000
MAXYEAR  DC    H'99'                                                    08257000
MAXDAYS  DC    H'999'                                                   08258000
MINYEAR  DC    H'0'                                                     08259000
MINDAYS  DC    H'0'                                                     08260000
NOREMAIN DC    H'0'                                                     08261000
SSMSGNUM DC    AL1(56)                                                  08262000
@CC01624 DC    C'IDCVS03 '                                              08263000
@CC01651 DC    C'SRTAGL  '                                              08264000
@CC01734 DC    C'DATESAGL'                                              08265000
@CC01513 DC    C'3330V'                                                 08266000
@CC01376 DC    C'LD01'                                                  08267000
@CC01511 DC    C'LD00'                                                  08268000
@CC01564 DC    C'LDST'                                                  08269000
@CC01586 DC    C'LDED'                                                  08270000
@CC01590 DC    C'LDSV'                                                  08271000
@CC01597 DC    C'LDSG'                                                  08272000
@CC01602 DC    C'LDNG'                                                  08273000
@CC01606 DC    C'LDAG'                                                  08274000
@CC01610 DC    C'LDAV'                                                  08275000
@CC01614 DC    C'LDRG'                                                  08276000
@CC01618 DC    C'LDCK'                                                  08277000
@CC01623 DC    C'LDSL'                                                  08278000
@CC01649 DC    C'SORT'                                                  08279000
@CC01650 DC    C'SOTI'                                                  08280000
@CC01655 DC    C'SOTO'                                                  08281000
@CC01659 DC    C'LDPV'                                                  08282000
@CC01668 DC    C'LDAL'                                                  08283000
@CC01678 DC    C'LDGH'                                                  08284000
@CC01682 DC    C'LDVH'                                                  08285000
@CC01686 DC    C'LDSR'                                                  08286000
@CC01693 DC    C'LDUR'                                                  08287000
@CC01698 DC    C'LDSS'                                                  08288000
@CC01702 DC    C'LDUS'                                                  08289000
@CC01708 DC    C'LDLG'                                                  08290000
@CC01733 DC    C'DTST'                                                  08291000
@CC01737 DC    C'DTND'                                                  08292000
@CC01757 DC    C'SSAA'                                                  08293000
@CC01475 DC    C'CM0'                                                   08294000
@CC01477 EQU   @CC01376                                                 08295000
@CC01479 DC    C'UV0'                                                   08296000
@CC01523 DC    C'ST'                                                    08297000
@CB01515 DC    X'30582009'                                              08298000
ALL      DC    CL3'ALL'                                                 08299000
FORMAT   DC    CL4'FORM'                                                08300000
HSECOND  DC    CL4'HSEC'                                                08301000
CLOCK    DC    CL4'KLOK'                                                08302000
SETZERO  DC    CL4'ZERO'                                                08303000
SETBLANK DC    CL4'BLNK'                                                08304000
NOSET    DC    CL4'NSET'                                                08305000
OVERRIDE DC    CL4'OVRD'                                                08306000
ACQUIRE  DC    CL8'ACQUIRE '                                            08307000
RELINQ   DC    CL8'RELINQ  '                                            08308000
MOUNT    DC    CL8'MOUNT   '                                            08309000
DEMOUNT  DC    CL8'DEMOUNT '                                            08310000
DEFINE   DC    CL8'DEFINE  '                                            08311000
MOVE     DC    CL8'MOVE    '                                            08312000
TRACEQ   DC    CL8'TRACEQ  '                                            08313000
COPYTABL DC    CL8'COPYTABL'                                            08314000
COPYCRTG DC    CL8'COPYCRTG'                                            08315000
COPYVOL  DC    CL8'COPYVOL '                                            08316000
VVIC     DC    CL8'VVIC    '                                            08317000
TUNE     DC    CL8'TUNE    '                                            08318000
NAMES    DC    CL4'NAME'                                                08319000
UNIT     DC    CL4'UNIT'                                                08320000
SHR      DC    CL4'SHR '                                                08321000
EXCL     DC    CL4'EXCL'                                                08322000
NOWAIT   DC    CL4'NWAI'                                                08323000
WAIT     DC    CL4'WAIT'                                                08324000
SECCHECK DC    CL8'SECCHECK'                                            08325000
SCRVTOC  DC    CL8'SCRVTOC '                                            08326000
GETVTOC  DC    CL8'GETVTOC '                                            08327000
PUTVTOC  DC    CL8'PUTVTOC '                                            08328000
RECATLG  DC    CL8'RECATLG '                                            08329000
INITVOL  DC    CL8'INITVOL '                                            08330000
CHECK    DC    CL8'CHECK   '                                            08331000
POSTUCB  DC    CL8'POSTUCB '                                            08332000
GET      DC    CL8'GET     '                                            08333000
PUT      DC    CL8'PUT     '                                            08334000
CLOSE    DC    CL8'CLOSE   '                                            08335000
OPEN     DC    CL8'OPEN    '                                            08336000
RVOPENR  DC    CL8'OPENR   '                                            08337000
RVRDCNT  DC    CL8'READCNT '                                            08338000
RVREADKD DC    CL8'READKD  '                                            08339000
RVSPACCR DC    CL8'SPACCR  '                                            08340000
RVFWRITE DC    CL8'FWRITE  '                                            08341000
RVWRITER DC    CL8'WRITEREC'                                            08342000
PUTLABEL DC    CL8'PUTLABEL'                                            08343000
GETLABEL DC    CL8'GETLABEL'                                            08344000
CANCEL   DC    CL8'CANCEL  '                                            08345000
SET      DC    CL8'SET     '                                            08346000
SELECTX  DC    CL8'SELECTX '                                            08347000
CHANGEX  DC    CL8'CHANGEX '                                            08348000
SELECTDD DC    CL8'SELECTDD'                                            08349000
SELECTDS DC    CL8'SELECTDS'                                            08350000
TBLREST  DC    CL8'TBLREST '                                            08351000
NULLIFYC DC    CL8'NULLIFYC'                                            08352000
RDMSC    DC    CL8'RDMSC   '                                            08353000
RDMSCTBL DC    CL8'RDMSCTBL'                                            08354000
RDCARTLB DC    CL8'RDCARTLB'                                            08355000
AUDITCEL DC    CL8'AUDITCEL'                                            08356000
RDSTGAD  DC    CL8'RDSTGAD '                                            08357000
MODIFYC  DC    CL8'MODIFYC '                                            08358000
MODID    DC    CL4'LD01'                                                08359000
FIXAREA  DS    CL600                                                    08360000
         ORG   FIXAREA                                                  08361000
@NM00115 DC    250X'00'                                                 08362000
@NM00116 DC    250X'00'                                                 08363000
@NM00117 DC    100X'00'                                                 08364000
         ORG   FIXAREA+600                                              08365000
SSMODSS0 DC    CL3'SS0'                                                 08366000
SSMODCM0 DC    CL3'CM0'                                                 08367000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08368000
@01      EQU   01                                                       08369000
@02      EQU   02                                                       08370000
@03      EQU   03                                                       08371000
@04      EQU   04                                                       08372000
@05      EQU   05                                                       08373000
@06      EQU   06                                                       08374000
@07      EQU   07                                                       08375000
@08      EQU   08                                                       08376000
@09      EQU   09                                                       08377000
@10      EQU   10                                                       08378000
@11      EQU   11                                                       08379000
@12      EQU   12                                                       08380000
@13      EQU   13                                                       08381000
@14      EQU   14                                                       08382000
@15      EQU   15                                                       08383000
ENTRYNUM EQU   @02                                                      08384000
ADJDAYS  EQU   @02                                                      08385000
DATEBIN  EQU   @03                                                      08386000
SRTJ     EQU   @02                                                      08387000
SRTI     EQU   @05                                                      08388000
SRTEND   EQU   @07                                                      08389000
SRTBEG   EQU   @04                                                      08390000
SRTLN    EQU   @02                                                      08391000
SRTWPTR  EQU   @06                                                      08392000
SRTPTR   EQU   @03                                                      08393000
CC04     EQU   @02                                                      08394000
CC03     EQU   @06                                                      08395000
CC02     EQU   @07                                                      08396000
CC01     EQU   @04                                                      08397000
SUPCNT   EQU   @03                                                      08398000
BASEVPTR EQU   @05                                                      08399000
ELEMENT  EQU   @02                                                      08400000
OPNPTR   EQU   @04                                                      08401000
TESTRC   EQU   @03                                                      08402000
RTNREG   EQU   @15                                                      08403000
REG0     EQU   @00                                                      08404000
REG1     EQU   @01                                                      08405000
REG10    EQU   @10                                                      08406000
REG11    EQU   @11                                                      08407000
REG12    EQU   @12                                                      08408000
REG13    EQU   @13                                                      08409000
REG14    EQU   @14                                                      08410000
REG15    EQU   @15                                                      08411000
REG2     EQU   @02                                                      08412000
REG3     EQU   @03                                                      08413000
REG4     EQU   @04                                                      08414000
REG5     EQU   @05                                                      08415000
REG6     EQU   @06                                                      08416000
REG7     EQU   @07                                                      08417000
REG8     EQU   @08                                                      08418000
REG9     EQU   @09                                                      08419000
IDCSACL0 EQU   0                                                        08420000
IDCSAEP0 EQU   0                                                        08421000
IDCSAFP0 EQU   0                                                        08422000
IDCSATI0 EQU   0                                                        08423000
IDCSAAL0 EQU   0                                                        08424000
IDCSADL0 EQU   0                                                        08425000
IDCSASS0 EQU   0                                                        08426000
IDCSA060 EQU   0                                                        08427000
TRACE1   EQU   0                                                        08428000
OLDERID1 EQU   TRACE1                                                   08429000
TRACE2   EQU   0                                                        08430000
OLDERID2 EQU   TRACE2                                                   08431000
NEWID2   EQU   TRACE2+95                                                08432000
NEWERID2 EQU   5                                                        08433000
CIRAGL   EQU   0                                                        08434000
CIRTYPE  EQU   CIRAGL                                                   08435000
ALLAGL   EQU   0                                                        08436000
ALLDDN   EQU   ALLAGL+4                                                 08437000
ALLULP   EQU   ALLAGL+12                                                08438000
ALLVLP   EQU   ALLAGL+16                                                08439000
ALLSTS   EQU   ALLAGL+24                                                08440000
ALLDSP   EQU   ALLAGL+25                                                08441000
ALLORG   EQU   ALLAGL+26                                                08442000
ALLOPT   EQU   ALLAGL+28                                                08443000
ALLOPTVL EQU   ALLOPT                                                   08444000
ALLOPTPV EQU   ALLOPT                                                   08445000
RACFAGL  EQU   0                                                        08446000
RACFFLG1 EQU   RACFAGL                                                  08447000
RACFFLG2 EQU   RACFAGL+1                                                08448000
RACFFLG3 EQU   RACFAGL+2                                                08449000
RACFFLG4 EQU   RACFAGL+3                                                08450000
UNITABL  EQU   0                                                        08451000
UNITADR  EQU   UNITABL+4                                                08452000
@NM00017 EQU   UNITADR                                                  08453000
UNITSTAT EQU   UNITABL+6                                                08454000
IDCIOOP0 EQU   0                                                        08455000
IDCIOCL0 EQU   0                                                        08456000
IOCSTR   EQU   0                                                        08457000
IOCDSO   EQU   IOCSTR+16                                                08458000
IOCRFM   EQU   IOCSTR+17                                                08459000
IOCMAC   EQU   IOCSTR+18                                                08460000
IOCMAC2  EQU   IOCSTR+19                                                08461000
IOCCHP   EQU   IOCSTR+20                                                08462000
IOCMSG   EQU   IOCSTR+21                                                08463000
IOCRBA   EQU   IOCSTR+40                                                08464000
IOCTTR   EQU   IOCRBA                                                   08465000
IOCMEM   EQU   IOCSTR+44                                                08466000
IOCNWM   EQU   IOCSTR+48                                                08467000
IOCREL   EQU   IOCSTR+60                                                08468000
OPNAGL   EQU   0                                                        08469000
OPNOPT   EQU   OPNAGL                                                   08470000
OPNOPTOT EQU   OPNOPT                                                   08471000
OPNRFM   EQU   OPNAGL+1                                                 08472000
OPNTYP   EQU   OPNAGL+2                                                 08473000
OPNMOD   EQU   OPNAGL+3                                                 08474000
OPNMODAC EQU   OPNMOD                                                   08475000
OPNIOC   EQU   OPNAGL+4                                                 08476000
OPNDDN   EQU   OPNAGL+8                                                 08477000
OPNDSN   EQU   OPNAGL+16                                                08478000
OPNDEV   EQU   OPNAGL+24                                                08479000
OPNDSO   EQU   OPNAGL+41                                                08480000
OPNOPT2  EQU   OPNAGL+42                                                08481000
IOINFOPT EQU   0                                                        08482000
UVOLLIST EQU   0                                                        08483000
UVOLENT  EQU   UVOLLIST+2                                               08484000
AMSTP011 EQU   0                                                        08485000
AMSTP042 EQU   0                                                        08486000
AMSTP044 EQU   0                                                        08487000
DARGLIST EQU   0                                                        08488000
DARGDBP  EQU   DARGLIST                                                 08489000
DARGRETP EQU   DARGLIST+4                                               08490000
DARGSTID EQU   DARGLIST+8                                               08491000
DARGSMOD EQU   DARGSTID                                                 08492000
DARGSENT EQU   DARGSTID+3                                               08493000
DARGILP  EQU   DARGLIST+12                                              08494000
DARGCNT  EQU   DARGLIST+14                                              08495000
DARGRETL EQU   DARGLIST+16                                              08496000
DARGARY  EQU   DARGLIST+20                                              08497000
DARGINS  EQU   DARGARY                                                  08498000
DARGREP  EQU   DARGINS                                                  08499000
DARGINL  EQU   DARGARY+2                                                08500000
DARGPCT  EQU   DARGINL                                                  08501000
DARGDTM  EQU   DARGARY+4                                                08502000
FMTLIST  EQU   0                                                        08503000
FMTFLGS  EQU   FMTLIST                                                  08504000
FMTSPF   EQU   FMTLIST+2                                                08505000
FMTRFNO  EQU   FMTSPF                                                   08506000
FMTILEN  EQU   FMTRFNO                                                  08507000
FMTIOFF  EQU   FMTLIST+4                                                08508000
FMTTRBC  EQU   FMTIOFF                                                  08509000
FMTSTO   EQU   FMTTRBC                                                  08510000
FMTOCOL  EQU   FMTLIST+6                                                08511000
FMTCNVF  EQU   FMTLIST+10                                               08512000
ERCNVTAB EQU   0                                                        08513000
ERTYPE   EQU   ERCNVTAB                                                 08514000
EROPER   EQU   ERCNVTAB+1                                               08515000
EROSOPER EQU   ERCNVTAB+2                                               08516000
ERCATRC  EQU   ERCNVTAB+16                                              08517000
ERCPLPT  EQU   ERCNVTAB+20                                              08518000
IDCDB010 EQU   0                                                        08519000
DMPITM   EQU   0                                                        08520000
DMPARY   EQU   0                                                        08521000
CCMSG    EQU   0                                                        08522000
CMMSG    EQU   0                                                        08523000
CMVOLFLG EQU   CMMSG+6                                                  08524000
CTMSG    EQU   0                                                        08525000
CTARRAY  EQU   CTMSG+4                                                  08526000
MDAGL    EQU   0                                                        08527000
MDFLAGS  EQU   MDAGL+30                                                 08528000
MDVTOC   EQU   MDAGL+32                                                 08529000
PUAGL    EQU   0                                                        08530000
CKAGL    EQU   0                                                        08531000
CKUCBPTR EQU   CKAGL+8                                                  08532000
CKDDNAME EQU   CKAGL+12                                                 08533000
CKFLAGS  EQU   CKAGL+28                                                 08534000
CKTESTVT EQU   CKFLAGS                                                  08535000
CKDMTABL EQU   CKFLAGS                                                  08536000
EXCLAGL  EQU   0                                                        08537000
EXCLFLAG EQU   EXCLAGL+22                                               08538000
EXOARG   EQU   0                                                        08539000
EXOPT    EQU   EXOARG+32                                                08540000
EXFLG    EQU   EXOARG+33                                                08541000
EXGARG   EQU   0                                                        08542000
EXWRARG  EQU   0                                                        08543000
EXRWCHR  EQU   EXWRARG+26                                               08544000
EXSPACE  EQU   EXWRARG+36                                               08545000
EXPARG   EQU   0                                                        08546000
EXPDATA  EQU   EXPARG+12                                                08547000
EXPDATAB EQU   0                                                        08548000
EXPARRAY EQU   EXPDATAB+4                                               08549000
VS2AGL   EQU   0                                                        08550000
VSLABOPT EQU   VS2AGL+28                                                08551000
VS2MSG   EQU   VS2AGL+35                                                08552000
VS2RESOP EQU   VS2AGL+36                                                08553000
VS1AGL   EQU   0                                                        08554000
VSSECOPT EQU   VS1AGL+68                                                08555000
VSVTOPT  EQU   VS1AGL+69                                                08556000
VSCATOPT EQU   VS1AGL+70                                                08557000
VSRETURN EQU   VS1AGL+71                                                08558000
VSMSG    EQU   VS1AGL+72                                                08559000
VSRESOPT EQU   VS1AGL+73                                                08560000
RCTAGL   EQU   0                                                        08561000
RCTOPT   EQU   RCTAGL+8                                                 08562000
STAEPARM EQU   0                                                        08563000
STARCVY  EQU   STAEPARM+52                                              08564000
STARETRY EQU   STAEPARM+53                                              08565000
VOLLABEL EQU   0                                                        08566000
SV82LIST EQU   0                                                        08567000
@NM00074 EQU   SV82LIST+4                                               08568000
SV82DCBP EQU   @NM00074                                                 08569000
@NM00075 EQU   SV82LIST+12                                              08570000
SV82WRKP EQU   @NM00075                                                 08571000
SRTAGL   EQU   0                                                        08572000
SRTHEAD  EQU   SRTAGL                                                   08573000
SRTADDR  EQU   SRTAGL+8                                                 08574000
SRTNUM   EQU   SRTAGL+12                                                08575000
SRTLEN   EQU   SRTAGL+16                                                08576000
SRTPOSIT EQU   SRTAGL+20                                                08577000
SRTFLDLN EQU   SRTAGL+24                                                08578000
SRTWORKP EQU   SRTAGL+28                                                08579000
LCTINFO  EQU   0                                                        08580000
LCTFLAGS EQU   LCTINFO+32                                               08581000
UCTAGL   EQU   0                                                        08582000
UCTFLAGS EQU   UCTAGL+68                                                08583000
SELAGL   EQU   0                                                        08584000
SELUCBP  EQU   SELAGL+8                                                 08585000
SELDDNP  EQU   SELAGL+12                                                08586000
SELVOL   EQU   SELAGL+16                                                08587000
SELFLAGS EQU   SELAGL+22                                                08588000
DATESAGL EQU   0                                                        08589000
DATHEAD  EQU   DATESAGL                                                 08590000
DATDATE  EQU   DATESAGL+8                                               08591000
DATDAYS  EQU   DATESAGL+12                                              08592000
DATRETRN EQU   DATESAGL+16                                              08593000
DATESOPT EQU   DATESAGL+20                                              08594000
DATADD   EQU   DATESOPT                                                 08595000
DATSUB   EQU   DATESOPT                                                 08596000
DATDTEOP EQU   DATESOPT                                                 08597000
DATDAYOP EQU   DATESOPT                                                 08598000
VS3AGL   EQU   0                                                        08599000
VS3LISTP EQU   VS3AGL+8                                                 08600000
VS3LEVP  EQU   VS3AGL+16                                                08601000
VS3LEVLN EQU   VS3AGL+20                                                08602000
VS3AST   EQU   VS3AGL+22                                                08603000
VS3EXPIR EQU   VS3AGL+24                                                08604000
VS3CREAT EQU   VS3AGL+28                                                08605000
VS3UCBP  EQU   VS3AGL+32                                                08606000
VS3DEV   EQU   VS3AGL+36                                                08607000
VS3POOL  EQU   VS3AGL+40                                                08608000
VS3VOL   EQU   VS3AGL+44                                                08609000
VS3DD    EQU   VS3AGL+50                                                08610000
VS3FLAGS EQU   VS3AGL+58                                                08611000
VS3STAT  EQU   VS3FLAGS                                                 08612000
VS3USAGE EQU   VS3FLAGS                                                 08613000
VS3UNCAT EQU   VS3FLAGS                                                 08614000
VSDVTOC  EQU   0                                                        08615000
VSDFRCYL EQU   VSDVTOC+6                                                08616000
VSDFRTRK EQU   VSDVTOC+11                                               08617000
VSDFREXT EQU   VSDVTOC+16                                               08618000
VSDFRCCL EQU   VSDVTOC+21                                               08619000
VSDSTAT  EQU   0                                                        08620000
VSDSFLG1 EQU   VSDSTAT+16                                               08621000
VSDVTOCC EQU   VSDSFLG1                                                 08622000
VSDVTOCE EQU   VSDSFLG1                                                 08623000
VSDVSAMC EQU   VSDSFLG1                                                 08624000
VSDVSAME EQU   VSDSFLG1                                                 08625000
VSDCATLG EQU   VSDSFLG1                                                 08626000
VSDFLG2  EQU   VSDSTAT+17                                               08627000
VSDPWR   EQU   VSDFLG2                                                  08628000
VSDPWW   EQU   VSDFLG2                                                  08629000
VSDPROT  EQU   VSDFLG2                                                  08630000
VSDERROR EQU   VSDFLG2                                                  08631000
VSDRACF  EQU   VSDFLG2                                                  08632000
VSDCRE   EQU   VSDSTAT+18                                               08633000
VSDEXP   EQU   VSDSTAT+20                                               08634000
VSDCAT   EQU   VSDSTAT+22                                               08635000
VSDPRTC  EQU   VSDSTAT+25                                               08636000
VSDSCR   EQU   0                                                        08637000
VSDSCRFL EQU   VSDSCR+4                                                 08638000
VSDUSAGE EQU   0                                                        08639000
VSDTRKS  EQU   VSDUSAGE                                                 08640000
VSDFTRK  EQU   VSDUSAGE+2                                               08641000
VSDSECAL EQU   VSDUSAGE+4                                               08642000
VSDDORG  EQU   VSDUSAGE+9                                               08643000
VSDOPO   EQU   VSDDORG                                                  08644000
VSDOPS   EQU   VSDDORG                                                  08645000
VSDOUN   EQU   VSDDORG                                                  08646000
VSDODA   EQU   VSDDORG                                                  08647000
VSDOIS   EQU   VSDDORG                                                  08648000
VSDOU    EQU   VSDDORG                                                  08649000
VSDALLOC EQU   VSDUSAGE+10                                              08650000
VSDACYL  EQU   VSDALLOC                                                 08651000
VSDATRK  EQU   VSDALLOC                                                 08652000
VSDABLK  EQU   VSDALLOC                                                 08653000
VSDABSTR EQU   VSDALLOC                                                 08654000
VSDUSEF  EQU   VSDUSAGE+11                                              08655000
VSDCALFR EQU   VSDUSEF                                                  08656000
VSDSCAL  EQU   VSDUSAGE+12                                              08657000
VSDDSORG EQU   VSDUSAGE+16                                              08658000
VSDDSOR3 EQU   VSDDSORG+2                                               08659000
VSDALLC  EQU   VSDUSAGE+19                                              08660000
VSDFREE  EQU   VSDUSAGE+24                                              08661000
VSDBLOCK EQU   0                                                        08662000
VSDELEM  EQU   VSDBLOCK                                                 08663000
VSDVTOCS EQU   VSDBLOCK+4                                               08664000
VSDFMT0  EQU   VSDBLOCK+8                                               08665000
VSDSPACE EQU   VSDBLOCK+12                                              08666000
VSDARRAY EQU   VSDBLOCK+16                                              08667000
VSDVOLCT EQU   VSDARRAY                                                 08668000
VSDDSN   EQU   VSDARRAY+4                                               08669000
VSDVARY  EQU   VSDARRAY+48                                              08670000
VOL      EQU   0                                                        08671000
VOLCNT   EQU   VOL                                                      08672000
@NM00094 EQU   VOL+2                                                    08673000
VOLVAL   EQU   @NM00094+1                                               08674000
GRP      EQU   0                                                        08675000
GRPCNT   EQU   GRP                                                      08676000
@NM00095 EQU   GRP+2                                                    08677000
GRPVAL   EQU   @NM00095+1                                               08678000
AVOL     EQU   0                                                        08679000
AGRP     EQU   0                                                        08680000
NGRPD    EQU   0                                                        08681000
GENER    EQU   0                                                        08682000
LEVEL    EQU   0                                                        08683000
LEVELPOS EQU   LEVEL+9                                                  08684000
LEVELFLG EQU   LEVEL+10                                                 08685000
LEVELLEN EQU   LEVEL+20                                                 08686000
LEVELVAL EQU   LEVEL+21                                                 08687000
UNCAT    EQU   0                                                        08688000
EXPDT    EQU   0                                                        08689000
EXPDTVAL EQU   EXPDT                                                    08690000
EXPIR    EQU   0                                                        08691000
EXPIRVAL EQU   EXPIR                                                    08692000
CREDT    EQU   0                                                        08693000
CREDTVAL EQU   CREDT                                                    08694000
CREAT    EQU   0                                                        08695000
CREATVAL EQU   CREAT                                                    08696000
FILE     EQU   0                                                        08697000
FILEVAL  EQU   FILE+1                                                   08698000
STAT     EQU   0                                                        08699000
USAGE    EQU   0                                                        08700000
LGND     EQU   0                                                        08701000
OFILE    EQU   0                                                        08702000
OFILEVAL EQU   OFILE+1                                                  08703000
ODS      EQU   0                                                        08704000
ODSFLG   EQU   ODS+10                                                   08705000
ODSVAL   EQU   ODS+21                                                   08706000
RVVI     EQU   0                                                        08707000
RVVLNGTH EQU   RVVI                                                     08708000
RVVOPCOD EQU   RVVI+4                                                   08709000
RVVCODE  EQU   RVVOPCOD                                                 08710000
RVVOLUME EQU   RVVI+8                                                   08711000
RVVGROUP EQU   RVVI+14                                                  08712000
RVVBUFLN EQU   RVVI+30                                                  08713000
RVVRTBUF EQU   RVVI+32                                                  08714000
RVVFLAGA EQU   RVVI+58                                                  08715000
RVVRMODE EQU   RVVFLAGA                                                 08716000
RVVRDR   EQU   RVVRMODE                                                 08717000
RVVRDNR  EQU   RVVRMODE                                                 08718000
RVVRDCH  EQU   RVVRMODE                                                 08719000
RVVCHAIN EQU   RVVFLAGA+1                                               08720000
RVVGPVOL EQU   RVVCHAIN                                                 08721000
RVVNGVOL EQU   RVVCHAIN                                                 08722000
RVVRDRCD EQU   RVVFLAGA+2                                               08723000
RVVBVRCD EQU   RVVRDRCD                                                 08724000
RVVGRPRC EQU   RVVRDRCD                                                 08725000
RVVRTEST EQU   RVVFLAGA+3                                               08726000
RVVGSVOL EQU   RVVRTEST                                                 08727000
RVVACTV  EQU   RVVRTEST                                                 08728000
RVVCPYTP EQU   RVVFLAGA+4                                               08729000
RVVSPEC  EQU   RVVFLAGA+5                                               08730000
RVVSGRP  EQU   RVVSPEC                                                  08731000
RVVSVOL  EQU   RVVSPEC                                                  08732000
GROUP    EQU   0                                                        08733000
GRONAME  EQU   GROUP                                                    08734000
GROVVGRP EQU   GRONAME+3                                                08735000
GROID    EQU   GRONAME+11                                               08736000
GROFLAGA EQU   GROUP+13                                                 08737000
GROTYPE  EQU   GROFLAGA                                                 08738000
GROFSN   EQU   GROUP+17                                                 08739000
GRONGEN  EQU   GROUP+30                                                 08740000
GRONRSTD EQU   GROUP+32                                                 08741000
GROERRTS EQU   GROUP+56                                                 08742000
GROOWNER EQU   GROUP+96                                                 08743000
GROADDR  EQU   GROUP+106                                                08744000
BASEV    EQU   0                                                        08745000
BASNAME  EQU   BASEV                                                    08746000
BASSERNO EQU   BASNAME+5                                                08747000
BASID    EQU   BASNAME+11                                               08748000
BASFLAGA EQU   BASEV+14                                                 08749000
BASTYPE  EQU   BASFLAGA                                                 08750000
BASLAST  EQU   BASFLAGA+3                                               08751000
BASRCVYF EQU   BASEV+20                                                 08752000
BASSATIA EQU   BASRCVYF                                                 08753000
BASIVCRE EQU   BASSATIA                                                 08754000
BASIVCPY EQU   BASSATIA                                                 08755000
BASVSMIS EQU   BASSATIA                                                 08756000
BASMISCF EQU   BASRCVYF+2                                               08757000
BASLIB1  EQU   BASEV+36                                                 08758000
BASLID1  EQU   BASLIB1                                                  08759000
BASLIB2  EQU   BASEV+49                                                 08760000
BASLID2  EQU   BASLIB2                                                  08761000
BASNEXTV EQU   BASEV+56                                                 08762000
BASKLCPY EQU   BASEV+76                                                 08763000
BASCOPID EQU   BASKLCPY+11                                              08764000
SRTSTOR  EQU   0                                                        08765000
SRTELEM  EQU   SRTSTOR                                                  08766000
SRTSAVE  EQU   0                                                        08767000
CONVDATE EQU   0                                                        08768000
CONVYEAR EQU   CONVDATE                                                 08769000
CONVDAYS EQU   CONVDATE+2                                               08770000
AMSTP041 EQU   0                                                        08771000
AMSTP043 EQU   0                                                        08772000
DMPTRM   EQU   0                                                        08773000
IDCIOCO0 EQU   0                                                        08774000
IDCIOGT0 EQU   0                                                        08775000
IDCIOIT0 EQU   0                                                        08776000
IDCIOPO0 EQU   0                                                        08777000
IDCIOPT0 EQU   0                                                        08778000
IDCIOSI0 EQU   0                                                        08779000
IDCIOST0 EQU   0                                                        08780000
IDCIOTM0 EQU   0                                                        08781000
IDCIOVY0 EQU   0                                                        08782000
IDCIO050 EQU   0                                                        08783000
IDCSACA0 EQU   0                                                        08784000
IDCSACR0 EQU   0                                                        08785000
IDCSADE0 EQU   0                                                        08786000
IDCSADQ0 EQU   0                                                        08787000
IDCSAFS0 EQU   0                                                        08788000
IDCSAGP0 EQU   0                                                        08789000
IDCSAGS0 EQU   0                                                        08790000
IDCSAID0 EQU   0                                                        08791000
IDCSALC0 EQU   0                                                        08792000
IDCSALD0 EQU   0                                                        08793000
IDCSALK0 EQU   0                                                        08794000
IDCSANQ0 EQU   0                                                        08795000
IDCSAPR0 EQU   0                                                        08796000
IDCSAPT0 EQU   0                                                        08797000
IDCSAQL0 EQU   0                                                        08798000
IDCSARC0 EQU   0                                                        08799000
IDCSARK0 EQU   0                                                        08800000
IDCSARV0 EQU   0                                                        08801000
IDCSASC0 EQU   0                                                        08802000
IDCSASI0 EQU   0                                                        08803000
IDCSASN0 EQU   0                                                        08804000
IDCSAST0 EQU   0                                                        08805000
IDCSAUC0 EQU   0                                                        08806000
IDCSAWO0 EQU   0                                                        08807000
IDCST010 EQU   0                                                        08808000
IDCTPER0 EQU   0                                                        08809000
LISTTEST EQU   0                                                        08810000
NEWERID1 EQU   5                                                        08811000
NLGND    EQU   0                                                        08812000
RPT      EQU   0                                                        08813000
GDTTBL   EQU   0                                                        08814000
GDTTR1   EQU   GDTTBL+8                                                 08815000
GDTTR2   EQU   GDTTBL+12                                                08816000
GDTDBG   EQU   GDTTBL+40                                                08817000
GDTSTC   EQU   GDTTBL+44                                                08818000
GDTPRT   EQU   GDTTBL+48                                                08819000
GDTESS   EQU   GDTTBL+52                                                08820000
GDTESA   EQU   GDTTBL+56                                                08821000
GDTRST   EQU   GDTTBL+60                                                08822000
GDTRES   EQU   GDTTBL+64                                                08823000
GDTCAL   EQU   GDTTBL+68                                                08824000
GDTGSP   EQU   GDTTBL+72                                                08825000
GDTFSP   EQU   GDTTBL+76                                                08826000
GDTGPL   EQU   GDTTBL+80                                                08827000
GDTFPL   EQU   GDTTBL+84                                                08828000
GDTLOD   EQU   GDTTBL+88                                                08829000
GDTDEL   EQU   GDTTBL+92                                                08830000
GDTPRL   EQU   GDTTBL+96                                                08831000
GDTEPL   EQU   GDTTBL+100                                               08832000
GDTTIM   EQU   GDTTBL+104                                               08833000
GDTIIO   EQU   GDTTBL+108                                               08834000
GDTTIO   EQU   GDTTBL+112                                               08835000
GDTOPN   EQU   GDTTBL+124                                               08836000
GDTCLS   EQU   GDTTBL+128                                               08837000
GDTGET   EQU   GDTTBL+132                                               08838000
GDTPUT   EQU   GDTTBL+136                                               08839000
GDTPOS   EQU   GDTTBL+140                                               08840000
GDTCPY   EQU   GDTTBL+144                                               08841000
GDTCAT   EQU   GDTTBL+148                                               08842000
GDTSNP   EQU   GDTTBL+164                                               08843000
GDTVFY   EQU   GDTTBL+172                                               08844000
GDTUID   EQU   GDTTBL+192                                               08845000
GDTPMT   EQU   GDTTBL+196                                               08846000
GDTCIR   EQU   GDTTBL+200                                               08847000
GDTLNK   EQU   GDTTBL+204                                               08848000
GDTALC   EQU   GDTTBL+208                                               08849000
GDTDLC   EQU   GDTTBL+212                                               08850000
GDTQAL   EQU   GDTTBL+216                                               08851000
GDTSTW   EQU   GDTTBL+220                                               08852000
GDTSSC   EQU   GDTTBL+224                                               08853000
GDTENQ   EQU   GDTTBL+228                                               08854000
GDTRSV   EQU   GDTTBL+232                                               08855000
GDTDEQ   EQU   GDTTBL+236                                               08856000
GDTSFO   EQU   GDTTBL+240                                               08857000
GDTWTO   EQU   GDTTBL+244                                               08858000
GDTSCR   EQU   GDTTBL+248                                               08859000
GDTUNT   EQU   GDTTBL+252                                               08860000
GDTRCT   EQU   GDTTBL+256                                               08861000
GDTIFO   EQU   GDTTBL+260                                               08862000
GDTEXP   EQU   GDTTBL+264                                               08863000
GDTSTA   EQU   GDTTBL+268                                               08864000
GDTERR   EQU   GDTTBL+272                                               08865000
GDTUNC   EQU   GDTTBL+276                                               08866000
GDTLOC   EQU   GDTTBL+280                                               08867000
GDTRCK   EQU   GDTTBL+284                                               08868000
FDTTBL   EQU   0                                                        08869000
FDTPTR   EQU   FDTTBL+8                                                 08870000
LASTCOND EQU   0                                                        08871000
SRTARG   EQU   0                                                        08872000
SSRCODE  EQU   0                                                        08873000
SSRHALF  EQU   SSRCODE+2                                                08874000
SSECBCD  EQU   0                                                        08875000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08876000
@NM00119 EQU   SSRCODE                                                  08877000
FDTVERB  EQU   FDTTBL                                                   08878000
GDTECT   EQU   GDTTBL+188                                               08879000
GDTPSB   EQU   GDTTBL+184                                               08880000
GDTUPT   EQU   GDTTBL+180                                               08881000
GDTCMB   EQU   GDTTBL+176                                               08882000
GDTSPR   EQU   GDTTBL+168                                               08883000
@NM00001 EQU   GDTTBL+160                                               08884000
GDTABH   EQU   GDTTBL+156                                               08885000
GDTABT   EQU   GDTTBL+152                                               08886000
GDTTOH   EQU   GDTTBL+120                                               08887000
GDTRIP   EQU   GDTTBL+116                                               08888000
GDTIOH   EQU   GDTTBL+36                                                08889000
GDTSAH   EQU   GDTTBL+32                                                08890000
GDTTPH   EQU   GDTTBL+28                                                08891000
GDTRIH   EQU   GDTTBL+24                                                08892000
GDTSTH   EQU   GDTTBL+20                                                08893000
GDTDBH   EQU   GDTTBL+16                                                08894000
GDTPRM   EQU   GDTTBL+4                                                 08895000
GDTHDR   EQU   GDTTBL                                                   08896000
@NM00106 EQU   BASEV+192                                                08897000
BASXPDT2 EQU   BASEV+188                                                08898000
BASGROUP EQU   BASEV+180                                                08899000
BASRECOV EQU   BASEV+174                                                08900000
BASDEST  EQU   BASEV+144                                                08901000
BASOWNER EQU   BASEV+134                                                08902000
BASDESCR EQU   BASEV+104                                                08903000
BASDTREM EQU   BASEV+100                                                08904000
BASEXPDT EQU   BASEV+96                                                 08905000
BASDLMTD EQU   BASEV+92                                                 08906000
BASRES6  EQU   BASEV+89                                                 08907000
BASCOPNO EQU   BASCOPID+1                                               08908000
BASCOPBK EQU   BASCOPID                                                 08909000
BASCOPSN EQU   BASKLCPY+5                                               08910000
BASCOPV  EQU   BASKLCPY                                                 08911000
BASFREXT EQU   BASEV+72                                                 08912000
BASLEXT  EQU   BASEV+70                                                 08913000
BASFRESP EQU   BASEV+68                                                 08914000
@NM00105 EQU   BASEV+65                                                 08915000
BASBKLMT EQU   BASEV+64                                                 08916000
BASNBKUP EQU   BASEV+63                                                 08917000
BASNCOPY EQU   BASEV+62                                                 08918000
BASPREV  EQU   BASEV+50                                                 08919000
BAS2BIT2 EQU   BASLID2                                                  08920000
BAS2BIT1 EQU   BASLID2                                                  08921000
BASRES5  EQU   BASLIB2                                                  08922000
BASCSN2  EQU   BASEV+37                                                 08923000
BAS1BIT2 EQU   BASLID1                                                  08924000
BAS1BIT1 EQU   BASLID1                                                  08925000
BASRES4  EQU   BASLIB1                                                  08926000
BASCSN1  EQU   BASEV+24                                                 08927000
BASRES3  EQU   BASMISCF                                                 08928000
BASHOLD  EQU   BASMISCF                                                 08929000
BASRES8  EQU   BASSATIA                                                 08930000
BASCPUID EQU   BASEV+18                                                 08931000
@NM00104 EQU   BASFLAGA+3                                               08932000
BASFIRST EQU   BASFLAGA+3                                               08933000
BASREASS EQU   BASFLAGA+3                                               08934000
BASRONLY EQU   BASFLAGA+3                                               08935000
BASDAERA EQU   BASFLAGA+3                                               08936000
BASEXCL  EQU   BASFLAGA+2                                               08937000
BASBIND  EQU   BASFLAGA+2                                               08938000
BASINAC  EQU   BASFLAGA+2                                               08939000
BASRSTD  EQU   BASFLAGA+2                                               08940000
BASGENUS EQU   BASFLAGA+2                                               08941000
BASGRPV  EQU   BASFLAGA+2                                               08942000
BASNOCPY EQU   BASFLAGA+2                                               08943000
BASDLSF  EQU   BASFLAGA+2                                               08944000
BASRES2  EQU   BASTYPE                                                  08945000
BASBASVR EQU   BASTYPE                                                  08946000
BASRES1  EQU   BASTYPE                                                  08947000
BASRES7  EQU   BASEV+13                                                 08948000
BASZERO  EQU   BASID+1                                                  08949000
BASBLANK EQU   BASID                                                    08950000
BASEVKEY EQU   BASNAME                                                  08951000
@NM00103 EQU   GROUP+136                                                08952000
GRORESSP EQU   GROUP+95                                                 08953000
GROCONUS EQU   GROUP+94                                                 08954000
GRODESCR EQU   GROUP+64                                                 08955000
GROERRTM EQU   GROERRTS+4                                               08956000
GROERRDT EQU   GROERRTS                                                 08957000
GRORETPD EQU   GROUP+52                                                 08958000
GROFREXT EQU   GROUP+48                                                 08959000
GROFRESP EQU   GROUP+44                                                 08960000
GROSTRSH EQU   GROUP+40                                                 08961000
GROSSPD  EQU   GROUP+38                                                 08962000
GROPSPD  EQU   GROUP+36                                                 08963000
GRONINAC EQU   GROUP+34                                                 08964000
GROPCENT EQU   GROUP+29                                                 08965000
GROLSN   EQU   GROUP+23                                                 08966000
@NM00102 EQU   GROFLAGA+2                                               08967000
GROMSG1  EQU   GROFLAGA+2                                               08968000
GRORETN  EQU   GROFLAGA+2                                               08969000
GRORLSE  EQU   GROFLAGA+2                                               08970000
GRORONLY EQU   GROFLAGA+2                                               08971000
GRODAERA EQU   GROFLAGA+2                                               08972000
GROEXCL  EQU   GROFLAGA+2                                               08973000
GROBIND  EQU   GROFLAGA+2                                               08974000
GRORES1  EQU   GROTYPE                                                  08975000
GROGVR   EQU   GROTYPE                                                  08976000
GROZERO  EQU   GROID+1                                                  08977000
GROBLANK EQU   GROID                                                    08978000
GROG     EQU   GRONAME                                                  08979000
@NM00101 EQU   RVVI+64                                                  08980000
RVVSDUP  EQU   RVVSPEC                                                  08981000
RVVSCPY  EQU   RVVSPEC                                                  08982000
RVVSCSN  EQU   RVVSPEC                                                  08983000
RVVSSEQ  EQU   RVVSPEC                                                  08984000
RVVSDTE  EQU   RVVSPEC                                                  08985000
RVVSEXP  EQU   RVVSPEC                                                  08986000
@NM00100 EQU   RVVCPYTP                                                 08987000
RVVCPLHD EQU   RVVCPYTP                                                 08988000
RVVLCOPY EQU   RVVCPYTP                                                 08989000
RVVOBKUP EQU   RVVCPYTP                                                 08990000
RVVLBKUP EQU   RVVCPYTP                                                 08991000
RVVBPLHD EQU   RVVRTEST                                                 08992000
RVVDVOL  EQU   RVVRTEST                                                 08993000
RVVINACT EQU   RVVRTEST                                                 08994000
RVVRSTD  EQU   RVVRTEST                                                 08995000
RVVTHOLD EQU   RVVRTEST                                                 08996000
RVVEXPDT EQU   RVVRTEST                                                 08997000
RVVALL   EQU   RVVRDRCD                                                 08998000
RVVCPURC EQU   RVVRDRCD                                                 08999000
RVVCIRCD EQU   RVVRDRCD                                                 09000000
RVVRUNKN EQU   RVVRDRCD                                                 09001000
RVVDUPRC EQU   RVVRDRCD                                                 09002000
RVVCPYRC EQU   RVVRDRCD                                                 09003000
@NM00099 EQU   RVVCHAIN                                                 09004000
@NM00098 EQU   RVVRMODE                                                 09005000
RVVDUPID EQU   RVVI+57                                                  09006000
RVVCPYID EQU   RVVI+56                                                  09007000
RVVRDCSN EQU   RVVI+44                                                  09008000
RVVRDSEQ EQU   RVVI+43                                                  09009000
RVVBLNK1 EQU   RVVI+42                                                  09010000
RVVCDATE EQU   RVVI+38                                                  09011000
RVVEXPIR EQU   RVVI+36                                                  09012000
@NM00097 EQU   RVVI+28                                                  09013000
RVVAREA  EQU   RVVI+24                                                  09014000
RVVARLN  EQU   RVVI+22                                                  09015000
@NM00096 EQU   RVVOPCOD+1                                               09016000
ODSLEN   EQU   ODS+20                                                   09017000
ODSMEM   EQU   ODS+12                                                   09018000
ODSMLN   EQU   ODS+11                                                   09019000
ODSFUQ   EQU   ODSFLG                                                   09020000
ODSPOS   EQU   ODS+9                                                    09021000
ODSPAS   EQU   ODS+1                                                    09022000
ODSPLN   EQU   ODS                                                      09023000
OFILELEN EQU   OFILE                                                    09024000
FILELEN  EQU   FILE                                                     09025000
LEVELMEM EQU   LEVEL+12                                                 09026000
LEVELMLN EQU   LEVEL+11                                                 09027000
LEVELFUQ EQU   LEVELFLG                                                 09028000
LEVELPAS EQU   LEVEL+1                                                  09029000
LEVELPLN EQU   LEVEL                                                    09030000
GRPLEN   EQU   @NM00095                                                 09031000
VOLLEN   EQU   @NM00094                                                 09032000
@NM00093 EQU   VSDDSORG                                                 09033000
@NM00092 EQU   VSDUSEF                                                  09034000
@NM00091 EQU   VSDALLOC                                                 09035000
@NM00090 EQU   VSDDORG                                                  09036000
VSDEXTS  EQU   VSDUSAGE+8                                               09037000
@NM00089 EQU   VSDSCR+5                                                 09038000
@NM00088 EQU   VSDSCRFL                                                 09039000
VSDVSAM  EQU   VSDSCRFL                                                 09040000
VSDCATLC EQU   VSDSCRFL                                                 09041000
VSDACBPT EQU   VSDSCR                                                   09042000
@NM00087 EQU   VSDSTAT+29                                               09043000
@NM00086 EQU   VSDFLG2                                                  09044000
@NM00085 EQU   VSDSFLG1                                                 09045000
VSDCVSAM EQU   VSDSFLG1                                                 09046000
VSDOWNER EQU   VSDSTAT+8                                                09047000
VSDEXPIR EQU   VSDSTAT+4                                                09048000
VSDCREAT EQU   VSDSTAT                                                  09049000
@NM00084 EQU   VSDVTOC+20                                               09050000
@NM00083 EQU   VSDVTOC+15                                               09051000
@NM00082 EQU   VSDVTOC+10                                               09052000
@NM00081 EQU   VSDVTOC                                                  09053000
@NM00080 EQU   VS3FLAGS                                                 09054000
VS3SYSNM EQU   VS3FLAGS                                                 09055000
VS3SCR   EQU   VS3FLAGS                                                 09056000
VS3EXDSP EQU   VS3AGL+12                                                09057000
VS3HEAD  EQU   VS3AGL                                                   09058000
@NM00079 EQU   DATESOPT                                                 09059000
@NM00078 EQU   SELFLAGS                                                 09060000
SELHEAD  EQU   SELAGL                                                   09061000
@NM00077 EQU   UCTFLAGS                                                 09062000
UCTVSCAT EQU   UCTFLAGS                                                 09063000
UCTDD    EQU   UCTAGL+60                                                09064000
UCTVOLP  EQU   UCTAGL+56                                                09065000
UCTACBP  EQU   UCTAGL+52                                                09066000
UCTDSN   EQU   UCTAGL+8                                                 09067000
UCTHEAD  EQU   UCTAGL                                                   09068000
@NM00076 EQU   LCTFLAGS                                                 09069000
LCTVSCAT EQU   LCTFLAGS                                                 09070000
LCTOWNER EQU   LCTINFO+24                                               09071000
LCTEXPIR EQU   LCTINFO+20                                               09072000
LCTCREAT EQU   LCTINFO+16                                               09073000
LCTACBP  EQU   LCTINFO+12                                               09074000
LCTMULVC EQU   LCTINFO+8                                                09075000
LCTHEAD  EQU   LCTINFO                                                  09076000
SV82DEBP EQU   SV82WRKP                                                 09077000
SV82TTRP EQU   SV82LIST+8                                               09078000
SV82VOLP EQU   SV82DCBP                                                 09079000
SV82UCBP EQU   SV82LIST+1                                               09080000
SV82CODE EQU   SV82LIST                                                 09081000
VOLRESV3 EQU   VOLLABEL+55                                              09082000
VOLOWNER EQU   VOLLABEL+45                                              09083000
VOLRESV1 EQU   VOLLABEL+20                                              09084000
VOLVTOC  EQU   VOLLABEL+15                                              09085000
VOLSECTY EQU   VOLLABEL+14                                              09086000
VOLSERNO EQU   VOLLABEL+8                                               09087000
VOLNO    EQU   VOLLABEL+7                                               09088000
VOLLABI  EQU   VOLLABEL+4                                               09089000
VOLKEY   EQU   VOLLABEL                                                 09090000
STAVTTR  EQU   STAEPARM+54                                              09091000
@NM00073 EQU   STARETRY                                                 09092000
STAVTOC  EQU   STARETRY                                                 09093000
STAOFF   EQU   STARETRY                                                 09094000
STAIO05  EQU   STARETRY                                                 09095000
@NM00072 EQU   STARCVY                                                  09096000
STACLEAR EQU   STARCVY                                                  09097000
STAVPOST EQU   STARCVY                                                  09098000
STAVENQ  EQU   STARCVY                                                  09099000
STAVDMNT EQU   STARCVY                                                  09100000
STAVMNT  EQU   STARCVY                                                  09101000
STATCB   EQU   STAEPARM+48                                              09102000
STARTADD EQU   STAEPARM+44                                              09103000
STAEXSAV EQU   STAEPARM+40                                              09104000
STARTSAV EQU   STAEPARM+36                                              09105000
STARTTR  EQU   STAEPARM+32                                              09106000
@NM00071 EQU   STAEPARM+30                                              09107000
STARVOL  EQU   STAEPARM+24                                              09108000
STARUCB  EQU   STAEPARM+20                                              09109000
@NM00070 EQU   STAEPARM+18                                              09110000
STAVVOL  EQU   STAEPARM+12                                              09111000
STAVUCB  EQU   STAEPARM+8                                               09112000
STAHEAD  EQU   STAEPARM                                                 09113000
RCTDSET  EQU   RCTAGL+32                                                09114000
RCTNVOL  EQU   RCTAGL+26                                                09115000
RCTOVOL  EQU   RCTAGL+20                                                09116000
RCTNDEV  EQU   RCTAGL+16                                                09117000
RCTODEV  EQU   RCTAGL+12                                                09118000
@NM00069 EQU   RCTAGL+10                                                09119000
@NM00068 EQU   RCTOPT                                                   09120000
RCTVOL   EQU   RCTOPT                                                   09121000
RCTDEV   EQU   RCTOPT                                                   09122000
RCTHEAD  EQU   RCTAGL                                                   09123000
@NM00067 EQU   VSRESOPT                                                 09124000
VSREAL   EQU   VSRESOPT                                                 09125000
VSRES    EQU   VSRESOPT                                                 09126000
@NM00066 EQU   VSMSG                                                    09127000
VSTOV    EQU   VSMSG                                                    09128000
VSFROMV  EQU   VSMSG                                                    09129000
@NM00065 EQU   VSRETURN                                                 09130000
VSUCAT   EQU   VSRETURN                                                 09131000
VSVSAM   EQU   VSRETURN                                                 09132000
@NM00064 EQU   VSCATOPT                                                 09133000
VSLIST   EQU   VSCATOPT                                                 09134000
VSSERIAL EQU   VSCATOPT                                                 09135000
VSDEVICE EQU   VSCATOPT                                                 09136000
@NM00063 EQU   VSVTOPT                                                  09137000
VSVSFLAG EQU   VSVTOPT                                                  09138000
VSALTTRK EQU   VSVTOPT                                                  09139000
VSTIME   EQU   VSVTOPT                                                  09140000
VSUCMAST EQU   VSSECOPT                                                 09141000
VSOPCAT  EQU   VSSECOPT                                                 09142000
VSUCTEST EQU   VSSECOPT                                                 09143000
VSWRITE  EQU   VSSECOPT                                                 09144000
VSREAD   EQU   VSSECOPT                                                 09145000
VSNONONV EQU   VSSECOPT                                                 09146000
VSMASTER EQU   VSSECOPT                                                 09147000
VSNOVSAM EQU   VSSECOPT                                                 09148000
VSODEVP  EQU   VS1AGL+64                                                09149000
VSOSERP  EQU   VS1AGL+60                                                09150000
VSDEVP   EQU   VS1AGL+56                                                09151000
VSSERP   EQU   VS1AGL+52                                                09152000
VSPFILEP EQU   VS1AGL+48                                                09153000
VSPSWDP  EQU   VS1AGL+44                                                09154000
VSCATDDP EQU   VS1AGL+40                                                09155000
VSACBP   EQU   VS1AGL+36                                                09156000
VSCATP   EQU   VS1AGL+32                                                09157000
VSNXTATP EQU   VS1AGL+28                                                09158000
VSNUMATP EQU   VS1AGL+24                                                09159000
VSIOP    EQU   VS1AGL+20                                                09160000
VSFILEP  EQU   VS1AGL+16                                                09161000
VSVOLP   EQU   VS1AGL+12                                                09162000
VSUCBP   EQU   VS1AGL+8                                                 09163000
VSHEAD   EQU   VS1AGL                                                   09164000
VSVTOCPT EQU   VS2AGL+48                                                09165000
@NM00062 EQU   VS2AGL+45                                                09166000
VSDDNAME EQU   VS2AGL+37                                                09167000
@NM00061 EQU   VS2RESOP                                                 09168000
VS2REAL  EQU   VS2RESOP                                                 09169000
VS2RES   EQU   VS2RESOP                                                 09170000
@NM00060 EQU   VS2MSG                                                   09171000
VS2TOV   EQU   VS2MSG                                                   09172000
VSVOLUME EQU   VS2AGL+29                                                09173000
@NM00059 EQU   VSLABOPT                                                 09174000
VSNOVTOC EQU   VSLABOPT                                                 09175000
VSVOLSER EQU   VSLABOPT                                                 09176000
VSOWNER  EQU   VSLABOPT                                                 09177000
VSIOBKPT EQU   VS2AGL+24                                                09178000
VSVOLPTR EQU   VS2AGL+20                                                09179000
VSOWNPTR EQU   VS2AGL+16                                                09180000
VSVTOCSZ EQU   VS2AGL+12                                                09181000
VSUCBPTR EQU   VS2AGL+8                                                 09182000
VS2HEAD  EQU   VS2AGL                                                   09183000
EXPDATAL EQU   EXPARRAY+6                                               09184000
@NM00058 EQU   EXPARRAY+5                                               09185000
EXPKEYLN EQU   EXPARRAY+4                                               09186000
EXPDATAP EQU   EXPARRAY                                                 09187000
EXPRECNO EQU   EXPDATAB                                                 09188000
EXPCCHHR EQU   EXPARG+16                                                09189000
EXPCTLBK EQU   EXPARG+8                                                 09190000
EXPHEAD  EQU   EXPARG                                                   09191000
EXRWFUN  EQU   EXWRARG+46                                               09192000
@NM00057 EQU   EXSPACE+8                                                09193000
@NM00056 EQU   EXSPACE+6                                                09194000
@NM00055 EQU   EXSPACE+4                                                09195000
@NM00054 EQU   EXSPACE+1                                                09196000
@NM00053 EQU   EXSPACE                                                  09197000
EXRWKDLN EQU   EXWRARG+32                                               09198000
@NM00052 EQU   EXWRARG+31                                               09199000
EXRECNUM EQU   EXRWCHR+4                                                09200000
EXHH     EQU   EXRWCHR+2                                                09201000
EXCC     EQU   EXRWCHR                                                  09202000
EXCCWCNT EQU   EXWRARG+24                                               09203000
EXLOCPTR EQU   EXWRARG+20                                               09204000
EXRWDARE EQU   EXWRARG+16                                               09205000
EXRWIOAR EQU   EXWRARG+12                                               09206000
EXRWCTBL EQU   EXWRARG+8                                                09207000
EXRWRES  EQU   EXWRARG                                                  09208000
EXGDATAL EQU   EXGARG+30                                                09209000
@NM00051 EQU   EXGARG+29                                                09210000
EXGKEYLN EQU   EXGARG+28                                                09211000
EXGDATAP EQU   EXGARG+24                                                09212000
EXGRECNO EQU   EXGARG+20                                                09213000
EXGCCHH2 EQU   EXGARG+16                                                09214000
EXGCCHH1 EQU   EXGARG+12                                                09215000
EXGCTLBK EQU   EXGARG+8                                                 09216000
EXGHEAD  EQU   EXGARG                                                   09217000
EXOVTH   EQU   EXFLG                                                    09218000
EXORVT   EQU   EXFLG                                                    09219000
EXORDS   EQU   EXFLG                                                    09220000
EXOSPK   EQU   EXFLG                                                    09221000
EXORVS   EQU   EXFLG                                                    09222000
@NM00050 EQU   EXFLG                                                    09223000
EXOREAD  EQU   EXFLG                                                    09224000
@NM00049 EQU   EXOPT                                                    09225000
EXOREP   EQU   EXOPT                                                    09226000
EXOVTOC  EQU   EXOPT                                                    09227000
EXONEW   EQU   EXOPT                                                    09228000
EXOPASS  EQU   EXOPT                                                    09229000
EXOLAB   EQU   EXOPT                                                    09230000
EXOTAB   EQU   EXOPT                                                    09231000
EXOCTLBK EQU   EXOARG+28                                                09232000
EXOEXT   EQU   EXOARG+24                                                09233000
EXOUCB   EQU   EXOARG+20                                                09234000
EXOVSN   EQU   EXOARG+16                                                09235000
EXODSN   EQU   EXOARG+12                                                09236000
EXODDN   EQU   EXOARG+8                                                 09237000
EXOHEAD  EQU   EXOARG                                                   09238000
@NM00048 EQU   EXCLFLAG                                                 09239000
EXCLMNT  EQU   EXCLFLAG                                                 09240000
EXCLVOL  EQU   EXCLAGL+16                                               09241000
EXCLDDP  EQU   EXCLAGL+12                                               09242000
EXCLUCBP EQU   EXCLAGL+8                                                09243000
EXCLHEAD EQU   EXCLAGL                                                  09244000
@NM00047 EQU   CKFLAGS                                                  09245000
CKRETTYP EQU   CKFLAGS                                                  09246000
CKLABELP EQU   CKAGL+24                                                 09247000
CKDATYPE EQU   CKAGL+20                                                 09248000
CKHEAD   EQU   CKAGL                                                    09249000
PULABELP EQU   PUAGL+16                                                 09250000
PUTTRPTR EQU   PUAGL+12                                                 09251000
PUUCBPTR EQU   PUAGL+8                                                  09252000
PUHEAD   EQU   PUAGL                                                    09253000
MDR      EQU   MDVTOC+4                                                 09254000
MDHH     EQU   MDVTOC+2                                                 09255000
MDCC     EQU   MDVTOC                                                   09256000
@NM00046 EQU   MDAGL+31                                                 09257000
MDVTOCTR EQU   MDFLAGS                                                  09258000
MDFORCE  EQU   MDFLAGS                                                  09259000
MDDEQ    EQU   MDFLAGS                                                  09260000
MDENQ    EQU   MDFLAGS                                                  09261000
MDWAIT   EQU   MDFLAGS                                                  09262000
MDPOST   EQU   MDFLAGS                                                  09263000
MDCLEAR  EQU   MDFLAGS                                                  09264000
MDNEWVOL EQU   MDFLAGS                                                  09265000
MDLABEL  EQU   MDAGL+24                                                 09266000
MDPUAGL  EQU   MDAGL+20                                                 09267000
MDDDNAME EQU   MDAGL+12                                                 09268000
MDUCBPTR EQU   MDAGL+8                                                  09269000
MDHEAD   EQU   MDAGL                                                    09270000
CTTBLRR  EQU   CTARRAY+3                                                09271000
CTTBLHH  EQU   CTARRAY+2                                                09272000
CTTBLCC  EQU   CTARRAY+1                                                09273000
CTTBLID  EQU   CTARRAY                                                  09274000
CTREALH  EQU   CTMSG+3                                                  09275000
CTREALCC EQU   CTMSG+1                                                  09276000
@NM00045 EQU   CTMSG                                                    09277000
CMCSN2   EQU   CMMSG+28                                                 09278000
CMCSN1   EQU   CMMSG+16                                                 09279000
CMNUMCRT EQU   CMMSG+15                                                 09280000
@NM00044 EQU   CMMSG+14                                                 09281000
CMNEWVOL EQU   CMMSG+8                                                  09282000
@NM00043 EQU   CMMSG+7                                                  09283000
@NM00042 EQU   CMVOLFLG                                                 09284000
CMRONLY  EQU   CMVOLFLG                                                 09285000
CMBIND   EQU   CMVOLFLG                                                 09286000
CMSCRCRT EQU   CMVOLFLG                                                 09287000
CMEXCL   EQU   CMVOLFLG                                                 09288000
CMDERAS  EQU   CMVOLFLG                                                 09289000
CMSCRVOL EQU   CMVOLFLG                                                 09290000
CMCECART EQU   CMVOLFLG                                                 09291000
CMOLDVOL EQU   CMMSG                                                    09292000
CCOLDCSN EQU   CCMSG+24                                                 09293000
CCNEWCSN EQU   CCMSG+12                                                 09294000
@NM00041 EQU   CCMSG+10                                                 09295000
CCVOL    EQU   CCMSG+4                                                  09296000
@NM00040 EQU   CCMSG+2                                                  09297000
CCEJCODE EQU   CCMSG+1                                                  09298000
CCPSTCDE EQU   CCMSG                                                    09299000
@NM00039 EQU   DMPARY+15                                                09300000
DMPARYTP EQU   DMPARY+14                                                09301000
DMPARYEX EQU   DMPARY+12                                                09302000
DMPARYIC EQU   DMPARY+10                                                09303000
DMPARYSZ EQU   DMPARY+8                                                 09304000
DMPARYNM EQU   DMPARY                                                   09305000
@NM00038 EQU   DMPITM+15                                                09306000
DMPITMTP EQU   DMPITM+14                                                09307000
DMPITMLN EQU   DMPITM+12                                                09308000
DMPITMPT EQU   DMPITM+8                                                 09309000
DMPITMNM EQU   DMPITM                                                   09310000
@NM00037 EQU   ERCNVTAB+24                                              09311000
ERDARBPT EQU   ERCPLPT                                                  09312000
ERDYNRC  EQU   ERCATRC                                                  09313000
ERDSNM   EQU   ERCNVTAB+12                                              09314000
@NM00036 EQU   ERCNVTAB+4                                               09315000
@NM00035 EQU   ERCNVTAB+3                                               09316000
@NM00034 EQU   EROSOPER                                                 09317000
EROSUCDX EQU   EROSOPER                                                 09318000
EROSCATL EQU   EROSOPER                                                 09319000
@NM00033 EQU   EROPER                                                   09320000
ERCATAL  EQU   EROPER                                                   09321000
ERCATDL  EQU   EROPER                                                   09322000
ERCATDE  EQU   EROPER                                                   09323000
ERCATLC  EQU   EROPER                                                   09324000
@NM00032 EQU   ERTYPE                                                   09325000
ERDYNAL  EQU   ERTYPE                                                   09326000
EROSCAT  EQU   ERTYPE                                                   09327000
ERCATLG  EQU   ERTYPE                                                   09328000
@NM00031 EQU   FMTCNVF+1                                                09329000
FMTAR    EQU   FMTCNVF+1                                                09330000
FMTBS    EQU   FMTCNVF+1                                                09331000
FMTSS    EQU   FMTCNVF+1                                                09332000
FMTAL    EQU   FMTCNVF+1                                                09333000
FMTZS    EQU   FMTCNVF+1                                                09334000
@NM00030 EQU   FMTCNVF                                                  09335000
FMTPU    EQU   FMTCNVF                                                  09336000
FMTBD    EQU   FMTCNVF                                                  09337000
FMTBHD   EQU   FMTCNVF                                                  09338000
FMTBHA   EQU   FMTCNVF                                                  09339000
FMTBH    EQU   FMTCNVF                                                  09340000
FMTOLEN  EQU   FMTLIST+8                                                09341000
FMTRIO   EQU   FMTOCOL                                                  09342000
FMTSPT   EQU   FMTSTO                                                   09343000
FMTSTL   EQU   FMTILEN                                                  09344000
@NM00029 EQU   FMTFLGS+1                                                09345000
FMTSMSG  EQU   FMTFLGS+1                                                09346000
FMTHDF   EQU   FMTFLGS                                                  09347000
FMTDFF   EQU   FMTFLGS                                                  09348000
FMTSTF   EQU   FMTFLGS                                                  09349000
FMTREPF  EQU   FMTFLGS                                                  09350000
FMTBDF   EQU   FMTFLGS                                                  09351000
FMTIDF   EQU   FMTFLGS                                                  09352000
FMTSCF   EQU   FMTFLGS                                                  09353000
FMTEOLF  EQU   FMTFLGS                                                  09354000
@NM00028 EQU   DARGLIST+19                                              09355000
DARGIND  EQU   DARGLIST+18                                              09356000
UVOLVOL  EQU   UVOLENT+4                                                09357000
UVOLDEV  EQU   UVOLENT                                                  09358000
UVOLCNT  EQU   UVOLLIST                                                 09359000
@NM00027 EQU   IOINFOPT                                                 09360000
IOINFLUB EQU   IOINFOPT                                                 09361000
IOINFTMS EQU   IOINFOPT                                                 09362000
IOINFSUP EQU   IOINFOPT                                                 09363000
IOINFDSN EQU   IOINFOPT                                                 09364000
IOINFVOL EQU   IOINFOPT                                                 09365000
IOINFDVT EQU   IOINFOPT                                                 09366000
OPNVOL   EQU   OPNAGL+44                                                09367000
OPNSTRNO EQU   OPNAGL+43                                                09368000
@NM00026 EQU   OPNOPT2                                                  09369000
OPNOPTJM EQU   OPNOPT2                                                  09370000
@NM00025 EQU   OPNOPT2                                                  09371000
OPNOPTAS EQU   OPNOPT2                                                  09372000
@NM00024 EQU   OPNDSO                                                   09373000
OPNDSOPO EQU   OPNDSO                                                   09374000
OPNDSOIS EQU   OPNDSO                                                   09375000
OPNDSOPS EQU   OPNDSO                                                   09376000
OPNDSOAM EQU   OPNDSO                                                   09377000
OPNKYL   EQU   OPNAGL+40                                                09378000
OPNBLK   EQU   OPNAGL+36                                                09379000
OPNREC   EQU   OPNAGL+32                                                09380000
OPNDEVIX EQU   OPNDEV+4                                                 09381000
OPNDEVDT EQU   OPNDEV                                                   09382000
OPNCBP   EQU   OPNAGL+20                                                09383000
OPNPWA   EQU   OPNAGL+12                                                09384000
OPNMODRP EQU   OPNMOD                                                   09385000
OPNMODUB EQU   OPNMOD                                                   09386000
OPNMODRS EQU   OPNMOD                                                   09387000
OPNMODAX EQU   OPNMOD                                                   09388000
OPNMODRR EQU   OPNMOD                                                   09389000
OPNMODRC EQU   OPNMOD                                                   09390000
OPNMODPD EQU   OPNMOD                                                   09391000
OPNTYPSY EQU   OPNTYP                                                   09392000
OPNTYPRV EQU   OPNTYP                                                   09393000
OPNTYPEX EQU   OPNTYP                                                   09394000
OPNTYPRA EQU   OPNTYP                                                   09395000
OPNTYPXM EQU   OPNTYP                                                   09396000
OPNTYPCI EQU   OPNTYP                                                   09397000
OPNTYPSO EQU   OPNTYP                                                   09398000
OPNTYPSI EQU   OPNTYP                                                   09399000
@NM00023 EQU   OPNRFM                                                   09400000
OPNRFMBK EQU   OPNRFM                                                   09401000
OPNRFMSF EQU   OPNRFM                                                   09402000
OPNRFMUN EQU   OPNRFM                                                   09403000
OPNRFMVR EQU   OPNRFM                                                   09404000
OPNRFMFX EQU   OPNRFM                                                   09405000
OPNOPTSK EQU   OPNOPT                                                   09406000
OPNOPTDR EQU   OPNOPT                                                   09407000
OPNOPTCR EQU   OPNOPT                                                   09408000
OPNOPTKS EQU   OPNOPT                                                   09409000
OPNOPTBK EQU   OPNOPT                                                   09410000
OPNOPTUP EQU   OPNOPT                                                   09411000
OPNOPTIN EQU   OPNOPT                                                   09412000
IOCEXT   EQU   IOCSTR+64                                                09413000
IOCTSML  EQU   IOCREL+2                                                 09414000
IOCTPML  EQU   IOCREL                                                   09415000
IOCWORK  EQU   IOCSTR+56                                                09416000
IOCRRN   EQU   IOCSTR+52                                                09417000
IOCPNM   EQU   IOCNWM+2                                                 09418000
IOCPTL   EQU   IOCNWM                                                   09419000
IOCKYA   EQU   IOCMEM                                                   09420000
IOCVRC   EQU   IOCTTR                                                   09421000
IOCCBP   EQU   IOCSTR+36                                                09422000
IOCDSN   EQU   IOCSTR+32                                                09423000
IOCHURBA EQU   IOCSTR+28                                                09424000
IOCVOLSR EQU   IOCSTR+22                                                09425000
@NM00022 EQU   IOCMSG                                                   09426000
IOCMSGSM EQU   IOCMSG                                                   09427000
IOCMSGAE EQU   IOCMSG                                                   09428000
IOCMSGCE EQU   IOCMSG                                                   09429000
IOCMSGOE EQU   IOCMSG                                                   09430000
IOCMSGOP EQU   IOCMSG                                                   09431000
IOCCHPKG EQU   IOCMSG                                                   09432000
IOCCHPKE EQU   IOCMSG                                                   09433000
IOCCHPNU EQU   IOCCHP                                                   09434000
IOCCHPUP EQU   IOCCHP                                                   09435000
IOCCHPBK EQU   IOCCHP                                                   09436000
IOCCHPCR EQU   IOCCHP                                                   09437000
IOCCHPKS EQU   IOCCHP                                                   09438000
IOCCHPSK EQU   IOCCHP                                                   09439000
IOCCHPDR EQU   IOCCHP                                                   09440000
IOCCHPSQ EQU   IOCCHP                                                   09441000
IOCMACNT EQU   IOCMAC2                                                  09442000
IOCMACER EQU   IOCMAC2                                                  09443000
IOCMACPA EQU   IOCMAC2                                                  09444000
IOCMACEN EQU   IOCMAC2                                                  09445000
IOCMACCP EQU   IOCMAC2                                                  09446000
IOCMACRR EQU   IOCMAC2                                                  09447000
IOCMACAS EQU   IOCMAC2                                                  09448000
IOCMACSK EQU   IOCMAC2                                                  09449000
@NM00021 EQU   IOCMAC                                                   09450000
IOCMACCC EQU   IOCMAC                                                   09451000
IOCMACDR EQU   IOCMAC                                                   09452000
IOCMACBK EQU   IOCMAC                                                   09453000
IOCMACCR EQU   IOCMAC                                                   09454000
IOCMACUP EQU   IOCMAC                                                   09455000
IOCMACOT EQU   IOCMAC                                                   09456000
IOCMACIN EQU   IOCMAC                                                   09457000
@NM00020 EQU   IOCRFM                                                   09458000
IOCRFMBK EQU   IOCRFM                                                   09459000
IOCRFMSF EQU   IOCRFM                                                   09460000
IOCRFMUN EQU   IOCRFM                                                   09461000
IOCRFMVR EQU   IOCRFM                                                   09462000
IOCRFMFX EQU   IOCRFM                                                   09463000
@NM00019 EQU   IOCDSO                                                   09464000
IOCDSOPO EQU   IOCDSO                                                   09465000
IOCDSOIS EQU   IOCDSO                                                   09466000
IOCDSOPS EQU   IOCDSO                                                   09467000
IOCDSOAM EQU   IOCDSO                                                   09468000
IOCRKP   EQU   IOCSTR+13                                                09469000
IOCKYL   EQU   IOCSTR+12                                                09470000
IOCTRN   EQU   IOCSTR+8                                                 09471000
IOCDLN   EQU   IOCSTR+4                                                 09472000
IOCDAD   EQU   IOCSTR                                                   09473000
UNITVTOC EQU   UNITABL+7                                                09474000
@NM00018 EQU   UNITSTAT                                                 09475000
UNITUSHR EQU   UNITSTAT                                                 09476000
UNITXSHR EQU   UNITSTAT                                                 09477000
UNITISHR EQU   UNITSTAT                                                 09478000
UNITUA   EQU   @NM00017+1                                               09479000
UNITCHA  EQU   @NM00017                                                 09480000
UNITUCB  EQU   UNITABL                                                  09481000
RACFVOLS EQU   RACFAGL+16                                               09482000
RACFCLN  EQU   RACFAGL+12                                               09483000
RACFPROF EQU   RACFAGL+8                                                09484000
RACFENT  EQU   RACFAGL+4                                                09485000
@NM00016 EQU   RACFFLG4                                                 09486000
@NM00015 EQU   RACFFLG3                                                 09487000
RACFPRF  EQU   RACFFLG3                                                 09488000
@NM00014 EQU   RACFFLG3                                                 09489000
@NM00013 EQU   RACFFLG2                                                 09490000
RACFTRD  EQU   RACFFLG2                                                 09491000
RACFTUPD EQU   RACFFLG2                                                 09492000
RACFTCTL EQU   RACFFLG2                                                 09493000
@NM00012 EQU   RACFFLG2                                                 09494000
RACFTALT EQU   RACFFLG2                                                 09495000
RACFCSA  EQU   RACFFLG1                                                 09496000
RACFLOGN EQU   RACFFLG1                                                 09497000
RACFLOGF EQU   RACFFLG1                                                 09498000
@NM00011 EQU   RACFFLG1                                                 09499000
RACFDSTV EQU   RACFFLG1                                                 09500000
@NM00010 EQU   RACFFLG1                                                 09501000
ALLUNCNT EQU   ALLAGL+30                                                09502000
ALLVLCNT EQU   ALLAGL+29                                                09503000
@NM00009 EQU   ALLOPT                                                   09504000
ALLOPTUN EQU   ALLOPT                                                   09505000
ALLOPTDS EQU   ALLOPT                                                   09506000
@NM00008 EQU   ALLORG+1                                                 09507000
ALLORGVS EQU   ALLORG+1                                                 09508000
@NM00007 EQU   ALLORG+1                                                 09509000
ALLORGGS EQU   ALLORG+1                                                 09510000
ALLORGUN EQU   ALLORG                                                   09511000
ALLORGPO EQU   ALLORG                                                   09512000
ALLORGMQ EQU   ALLORG                                                   09513000
ALLORGCQ EQU   ALLORG                                                   09514000
ALLORGCX EQU   ALLORG                                                   09515000
ALLORGDA EQU   ALLORG                                                   09516000
ALLORGPS EQU   ALLORG                                                   09517000
ALLORGIS EQU   ALLORG                                                   09518000
ALLDSPUN EQU   ALLDSP                                                   09519000
ALLDSPCG EQU   ALLDSP                                                   09520000
ALLDSPDE EQU   ALLDSP                                                   09521000
ALLDSPKP EQU   ALLDSP                                                   09522000
@NM00006 EQU   ALLDSP                                                   09523000
ALLSTSOD EQU   ALLSTS                                                   09524000
ALLSTSMD EQU   ALLSTS                                                   09525000
ALLSTSNW EQU   ALLSTS                                                   09526000
ALLSTSSR EQU   ALLSTS                                                   09527000
@NM00005 EQU   ALLSTS                                                   09528000
ALLPWD   EQU   ALLAGL+20                                                09529000
ALLDSN   EQU   ALLAGL                                                   09530000
CIRPID   EQU   CIRAGL+28                                                09531000
CIRPWD   EQU   CIRAGL+24                                                09532000
CIRCAT   EQU   CIRAGL+20                                                09533000
CIRWKP   EQU   CIRAGL+16                                                09534000
CIRTLR   EQU   CIRAGL+12                                                09535000
CIRHDR   EQU   CIRAGL+8                                                 09536000
CIRTLN   EQU   CIRAGL+6                                                 09537000
CIRHLN   EQU   CIRAGL+4                                                 09538000
@NM00004 EQU   CIRAGL+1                                                 09539000
@NM00003 EQU   CIRTYPE                                                  09540000
CIRTYPAQ EQU   CIRTYPE                                                  09541000
CIRTYP1Q EQU   CIRTYPE                                                  09542000
NEWID1   EQU   TRACE1+95                                                09543000
CALLID   EQU   OLDERID1+90                                              09544000
@NM00002 EQU   OLDERID1                                                 09545000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09546000
@RF00497 EQU   @RC00490                                                 09547000
@RF00504 EQU   @RC00490                                                 09548000
@RC00565 EQU   @RC00564                                                 09549000
@RC00624 EQU   @RC00623                                                 09550000
@RC00659 EQU   @RC00651                                                 09551000
@RC00718 EQU   @RC00717                                                 09552000
@RF00876 EQU   @RC00835                                                 09553000
@RC01004 EQU   @RC01000                                                 09554000
@RC01002 EQU   @RC01000                                                 09555000
@RF01150 EQU   @RC01139                                                 09556000
@RC01335 EQU   @RC01325                                                 09557000
@RC01327 EQU   @RC01325                                                 09558000
@RC01338 EQU   @RC01325                                                 09559000
@RC01542 EQU   @RC01541                                                 09560000
@RC01568 EQU   @RC01562                                                 09561000
@RC01563 EQU   @RC01562                                                 09562000
@RF01643 EQU   @RC01628                                                 09563000
@PB00021 EQU   @EL00001                                                 09564000
@RC00571 EQU   @RC00565                                                 09565000
@RF00579 EQU   @RC00565                                                 09566000
@RC00662 EQU   @RC00659                                                 09567000
@RC00660 EQU   @RC00659                                                 09568000
@RC00724 EQU   @RC00718                                                 09569000
@RF00732 EQU   @RC00718                                                 09570000
@RC01331 EQU   @RC01327                                                 09571000
@RC01329 EQU   @RC01327                                                 09572000
@PB00020 EQU   @PB00021                                                 09573000
@PB00019 EQU   @PB00020                                                 09574000
@PB00018 EQU   @PB00019                                                 09575000
@PB00017 EQU   @PB00018                                                 09576000
@PB00016 EQU   @PB00017                                                 09577000
@PB00015 EQU   @PB00016                                                 09578000
@PB00014 EQU   @PB00015                                                 09579000
@PB00013 EQU   @PB00014                                                 09580000
@PB00012 EQU   @PB00013                                                 09581000
@PB00011 EQU   @PB00012                                                 09582000
@PB00010 EQU   @PB00011                                                 09583000
@PB00009 EQU   @PB00010                                                 09584000
@PB00008 EQU   @PB00009                                                 09585000
@PB00007 EQU   @PB00008                                                 09586000
@PB00006 EQU   @PB00007                                                 09587000
@PB00005 EQU   @PB00006                                                 09588000
@PB00004 EQU   @PB00005                                                 09589000
@PB00003 EQU   @PB00004                                                 09590000
@PB00002 EQU   @PB00003                                                 09591000
@ENDDATA EQU   *                                                        09592000
         END   IDCLD01,(C'PLS1829',0603,76306)                          09593000
