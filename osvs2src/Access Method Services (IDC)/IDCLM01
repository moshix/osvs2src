         TITLE '**************** IDCLM01: LISTMSF FSR **************** *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCLM01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCLM01   76.301'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @08,0                                               0002 00021000
@PSTART  LA    @09,4095(,@08)                                      0002 00022000
         LA    @10,4095(,@09)                                      0002 00023000
         LA    @12,4095(,@10)                                      0002 00024000
         USING @PSTART,@08                                         0002 00025000
         USING @PSTART+4095,@09                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @11,@01                                             0002 00031000
         USING @DATD,@11                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @11,8(,@13)                                         0002 00035000
         LR    @13,@11                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0331 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* THIS IS THE MAIN ROUTINE FOR THE LISTMSF FSR ROUTINE. IT OPENS*/ 00041000
*   /* THE OUTPUT DATA SET IF REQUESTED, AND CALLS SUBPROCEDURES THAT*/ 00042000
*   /* PRODUCE THE REPORTS AND SUMMARIES. OPENWORK OPENS THE WORK    */ 00043000
*   /* DATA SET. MSFLOOK COPIES THE MSC TABLES AND MAKES SURE THAT   */ 00044000
*   /* THE REQUESTED MSF EXISTS. RPTSEL PRINTS THE REPORTS. THIS     */ 00045000
*   /* ROUTINE CLOSES THE OUTPUT DATA SET AND WORK DATA SET AND      */ 00046000
*   /* PRINTS THE FINAL COMPLETION MESSAGE BEFORE RETURNING TO THE   */ 00047000
*   /* AMS EXECUTIVE                                         @Y30LB38*/ 00048000
*   /*                                                               */ 00049000
*   /*****************************************************************/ 00050000
*                                                                  0331 00051000
*   IF GDTDBG=NULLPTR THEN                                         0331 00052000
         L     @04,@PC00001                                        0331 00053000
         L     @04,GDTDBG(,@04)                                    0331 00054000
         LTR   @04,@04                                             0331 00055000
         BZ    @RT00331                                            0331 00056000
*     ;                                                            0332 00057000
*   ELSE                                                           0333 00058000
*     CALL IDCDB010(GDTTBL,'LMAA'); /*                       @Y30LB38*/ 00059000
         L     @04,@PC00001                                        0333 00060000
         ST    @04,@AL00001                                        0333 00061000
         LA    @15,@CC01496                                        0333 00062000
         ST    @15,@AL00001+4                                      0333 00063000
         MVI   @AL00001+4,X'80'                                    0333 00064000
         L     @15,GDTDBG(,@04)                                    0333 00065000
         LA    @01,@AL00001                                        0333 00066000
         BALR  @14,@15                                             0333 00067000
*   OLDERID2=NEWERID2;                                             0334 00068000
@RT00331 L     @02,@PC00001                                        0334 00069000
         L     @15,GDTTR2(,@02)                                    0334 00070000
         MVC   @TS00001(95),NEWERID2(@15)                          0334 00071000
         MVC   OLDERID2(95,@15),@TS00001                           0334 00072000
*   NEWID2='LMAA';                  /*                       @Y30LB38*/ 00073000
*                                                                  0335 00074000
         MVC   NEWID2(4,@15),@CC01496                              0335 00075000
*   /*****************************************************************/ 00076000
*   /*                                                               */ 00077000
*   /* INITIALIZE PARAMETER LIST AND POINTERS                @Y30LB38*/ 00078000
*   /*                                                               */ 00079000
*   /*****************************************************************/ 00080000
*                                                                  0336 00081000
*   RESPECIFY                                                      0336 00082000
*     CKAGL BASED(CKPTR);           /*                       @Y30LB38*/ 00083000
*   DDSTRU=ADDR(PRINTAB);           /*                       @Y30LB38*/ 00084000
         LA    @15,PRINTAB                                         0337 00085000
         ST    @15,DDSTRU                                          0337 00086000
*   BUFFCNTR=''B;                   /*                       @Y30LB38*/ 00087000
         SLR   @15,@15                                             0338 00088000
         LR    BUFFCNTR,@15                                        0338 00089000
*   ENTCNTR=''B;                    /*                       @Y30LB38*/ 00090000
         ST    @15,ENTCNTR                                         0339 00091000
*   LINCNTR=''B;                    /*                       @Y30LB38*/ 00092000
         ST    @15,LINCNTR                                         0340 00093000
*   FLAGS=''B;                      /*                       @Y30LB38*/ 00094000
         MVI   FLAGS,X'00'                                         0341 00095000
*   PRINTAB=''B;                    /*                       @Y30LB38*/ 00096000
         XC    PRINTAB(84),PRINTAB                                 0342 00097000
*   INTTBL=''B;                     /*                       @Y30LB38*/ 00098000
         XC    INTTBL(159),INTTBL                                  0343 00099000
*   OPNPTR=ADDR(OPENLIST);          /*                       @Y30LB38*/ 00100000
         LA    OPNPTR,OPENLIST                                     0344 00101000
*   OPNAGL=''B;                     /*                       @Y30LB38*/ 00102000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0345 00103000
*   PRINTME=''B;                    /*                       @Y30LB38*/ 00104000
         ST    @15,PRINTME                                         0346 00105000
*   IOCSPTR=''B;                    /*                       @Y30LB38*/ 00106000
         ST    @15,IOCSPTR                                         0347 00107000
*   WORKPTR=''B;                    /*                       @Y30LB38*/ 00108000
         ST    @15,WORKPTR                                         0348 00109000
*   EXOPTR=ADDR(EXOLIST);           /*                       @Y30LB38*/ 00110000
         LA    EXOPTR,EXOLIST                                      0349 00111000
*   RESPECIFY                                                      0350 00112000
*     EXOARG BASED(EXOPTR);         /*                       @Y30LB38*/ 00113000
*   EXOARG=''B;                     /*                       @Y30LB38*/ 00114000
         XC    EXOARG(34,EXOPTR),EXOARG(EXOPTR)                    0351 00115000
*   ALLOCPTR=ADDR(ALOCLIST);        /*                       @Y30LB38*/ 00116000
         LA    @15,ALOCLIST                                        0352 00117000
         ST    @15,ALLOCPTR                                        0352 00118000
*   RESPECIFY                                                      0353 00119000
*     ALLAGL BASED(ALLOCPTR);       /*                       @Y30LB38*/ 00120000
*   ALLAGL=''B;                     /*                       @Y30LB38*/ 00121000
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0354 00122000
*   CKPTR=ADDR(UCBLIST);            /*                       @Y30LB38*/ 00123000
         LA    @15,UCBLIST                                         0355 00124000
         ST    @15,CKPTR                                           0355 00125000
*   CKAGL=''B;                      /*                       @Y30LB38*/ 00126000
         XC    CKAGL(29,@15),CKAGL(@15)                            0356 00127000
*   ACQPTR=ADDR(ACQLISTT);          /*                       @Y30LB38*/ 00128000
         LA    @15,ACQLISTT                                        0357 00129000
         ST    @15,ACQPTR                                          0357 00130000
*   ACQLIST=''B;                    /*                       @Y30LB38*/ 00131000
         XC    ACQLIST(96,@15),ACQLIST(@15)                        0358 00132000
*   COTPTR=ADDR(COTLISTT);          /*                       @Y30LB38*/ 00133000
         LA    @15,COTLISTT                                        0359 00134000
         ST    @15,COTPTR                                          0359 00135000
*   COTBLIST=''B;                   /*                       @Y30LB38*/ 00136000
         XC    COTBLIST(24,@15),COTBLIST(@15)                      0360 00137000
*   RESPECIFY                                                      0361 00138000
*     EXGARG BASED(EXGPTR);         /*                       @Y30LB38*/ 00139000
*   EXGPTR=ADDR(EXGARG1);           /*                       @Y30LB38*/ 00140000
         LA    @15,EXGARG1                                         0362 00141000
         ST    @15,EXGPTR                                          0362 00142000
*   EXGARG=''B;                     /*                       @Y30LB38*/ 00143000
*                                                                  0363 00144000
         XC    EXGARG(32,@15),EXGARG(@15)                          0363 00145000
*   /*****************************************************************/ 00146000
*   /*                                                               */ 00147000
*   /* ISSUE THE UGSPACE TO GET 16K OF CORE TO BE USED AS    @Y30LB38*/ 00148000
*   /* WORK AREAS. 3800 WILL BE USED FOR SORTBLK, 3800 BYTES WILL BE */ 00149000
*   /* USED FOR PRINTBUF AND THE REMAINDER WILL BE USED FOR TRKBUFF. */ 00150000
*   /*                                                       @Y30LB38*/ 00151000
*   /*                                                               */ 00152000
*   /*****************************************************************/ 00153000
*                                                                  0364 00154000
*   CORESIZE=LENGTH(SORTBLK)+PRINTLEN+LENGTH(TRKBUFF);/*     @ZM00727*/ 00155000
         MVC   CORESIZE(4),@CF01820                                0364 00156000
*   CALL IDCSAGS0(GDTTBL,CORESIZE,RTNAREA);/*                @Y30LB38*/ 00157000
         ST    @02,@AL00001                                        0365 00158000
         LA    @15,CORESIZE                                        0365 00159000
         ST    @15,@AL00001+4                                      0365 00160000
         LA    @15,RTNAREA                                         0365 00161000
         ST    @15,@AL00001+8                                      0365 00162000
         MVI   @AL00001+8,X'80'                                    0365 00163000
         L     @15,GDTGSP(,@02)                                    0365 00164000
         LA    @01,@AL00001                                        0365 00165000
         BALR  @14,@15                                             0365 00166000
*   RESPECIFY                                                      0366 00167000
*     RTNREG RSTD;                                                 0366 00168000
*   TESTRC=RTNREG;                                                 0367 00169000
         LR    TESTRC,RTNREG                                       0367 00170000
*   RESPECIFY                                                      0368 00171000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 00172000
*   IF TESTRC^=0 THEN                                              0369 00173000
         LTR   TESTRC,TESTRC                                       0369 00174000
         BZ    @RF00369                                            0369 00175000
*     LASTCOND=LASTCC12;            /*                       @ZM00717*/ 00176000
*                                                                  0370 00177000
         L     @15,@PC00001+8                                      0370 00178000
         MVC   LASTCOND(2,@15),@CH00567                            0370 00179000
*   /*****************************************************************/ 00180000
*   /*                                                               */ 00181000
*   /* IF STORAGE WAS NOT OBTAINED SUCCESSFULLY, SET         @ZM00717*/ 00182000
*   /* LASTCOND TO 12 - IF SUCCESSFUL, SET POINTERS TO THE   @ZM00717*/ 00183000
*   /* STORAGE AREAS.                                        @ZM00717*/ 00184000
*   /*                                                               */ 00185000
*   /*****************************************************************/ 00186000
*                                                                  0371 00187000
*   ELSE                                                           0371 00188000
*     DO;                           /*                       @ZM00717*/ 00189000
         B     @RC00369                                            0371 00190000
@RF00369 DS    0H                                                  0372 00191000
*       GOTCORE=ON;                 /*                       @Y30LB38*/ 00192000
         OI    GOTCORE,B'01000000'                                 0372 00193000
*       SORTPTR=RTNAREA;            /*                       @Y30LB38*/ 00194000
         L     @15,RTNAREA                                         0373 00195000
         ST    @15,SORTPTR                                         0373 00196000
*       PRINTPTR=RTNAREA+LENGTH(SORTBLK);/*                  @ZM00717*/ 00197000
         LA    PRINTPTR,3800                                       0374 00198000
         ALR   PRINTPTR,@15                                        0374 00199000
*       TRKPTR=RTNAREA+LENGTH(SORTBLK)+PRINTLEN;/*           @ZM00717*/ 00200000
         AL    @15,@CF01818                                        0375 00201000
         ST    @15,TRKPTR                                          0375 00202000
*     END;                          /*                       @Y30LB38*/ 00203000
*                                                                  0377 00204000
*   /*****************************************************************/ 00205000
*   /*                                                               */ 00206000
*   /* TEST IF THE USER SPECIFIED A DDNAME OR DSNAME TO      @Y30LB38*/ 00207000
*   /* BE USED AS THE OUTPUT DATA SET. IF YES, ISSUE THE UOPEN MACRO.*/ 00208000
*   /* IF NO, USE SYSPRINT AS DEFAULT                        @Y30LB38*/ 00209000
*   /*                                                               */ 00210000
*   /*****************************************************************/ 00211000
*                                                                  0377 00212000
*   IF LASTCOND=LASTCC00&(ADDR(OFILE)^=NULLPTR|ADDR(ODS)^=NULLPTR) THEN 00213000
@RC00369 SLR   @15,@15                                             0377 00214000
         L     @14,@PC00001+8                                      0377 00215000
         CH    @15,LASTCOND(,@14)                                  0377 00216000
         BNE   @RF00377                                            0377 00217000
         L     @14,@PC00001+4                                      0377 00218000
         C     @15,FDTPTR+32(,@14)                                 0377 00219000
         BNE   @RT00377                                            0377 00220000
         C     @15,FDTPTR+36(,@14)                                 0377 00221000
         BE    @RF00377                                            0377 00222000
@RT00377 DS    0H                                                  0378 00223000
*     DO;                           /*                       @Y30LB38*/ 00224000
*       IF ADDR(ODS)^=NULLPTR THEN                                 0379 00225000
         L     @15,@PC00001+4                                      0379 00226000
         L     @15,FDTPTR+36(,@15)                                 0379 00227000
         LTR   @15,@15                                             0379 00228000
         BZ    @RF00379                                            0379 00229000
*         OPNDSN=ADDR(ODSVAL);      /*                       @Y30LB38*/ 00230000
         LA    @15,ODSVAL(,@15)                                    0380 00231000
         ST    @15,OPNDSN(,OPNPTR)                                 0380 00232000
*       ELSE                                                       0381 00233000
*         OPNDDN=ADDR(OFILEVAL);    /*                       @Y30LB38*/ 00234000
         B     @RC00379                                            0381 00235000
@RF00379 L     @15,@PC00001+4                                      0381 00236000
         L     @01,FDTPTR+32(,@15)                                 0381 00237000
         LA    @15,OFILEVAL(,@01)                                  0381 00238000
         ST    @15,OPNDDN(,OPNPTR)                                 0381 00239000
*       OPNOPTOT=ON;                /*                       @Y30LB38*/ 00240000
@RC00379 OI    OPNOPTOT(OPNPTR),B'01000000'                        0382 00241000
*       OPNMODAC=ON;                /*                       @Y30LB38*/ 00242000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0383 00243000
*       OPNIOC=ADDR(IOCSPTR);       /*                       @Y30LB38*/ 00244000
         LA    @02,IOCSPTR                                         0384 00245000
         ST    @02,OPNIOC(,OPNPTR)                                 0384 00246000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Y30LB38*/ 00247000
         L     @02,@PC00001                                        0385 00248000
         ST    @02,@AL00001                                        0385 00249000
         ST    OPNPTR,@AL00001+4                                   0385 00250000
         MVI   @AL00001+4,X'80'                                    0385 00251000
         L     @15,GDTOPN(,@02)                                    0385 00252000
         LA    @01,@AL00001                                        0385 00253000
         BALR  @14,@15                                             0385 00254000
*       RESPECIFY                                                  0386 00255000
*         RTNREG RSTD;                                             0386 00256000
*       TESTRC=RTNREG;                                             0387 00257000
         LR    TESTRC,RTNREG                                       0387 00258000
*       RESPECIFY                                                  0388 00259000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00260000
*       IF TESTRC=0 THEN                                           0389 00261000
         LTR   TESTRC,TESTRC                                       0389 00262000
         BNZ   @RF00389                                            0389 00263000
*         PRINTME=IOCSPTR;          /*                       @Y30LB38*/ 00264000
         L     @06,IOCSPTR                                         0390 00265000
         ST    @06,PRINTME                                         0390 00266000
*       ELSE                                                       0391 00267000
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/ 00268000
         B     @RC00389                                            0391 00269000
@RF00389 L     @06,@PC00001+8                                      0391 00270000
         MVC   LASTCOND(2,@06),@CH00567                            0391 00271000
*     END;                          /*                       @Y30LB38*/ 00272000
@RC00389 DS    0H                                                  0393 00273000
*                                                                  0393 00274000
*   /*****************************************************************/ 00275000
*   /*                                                               */ 00276000
*   /* IF LASTCOND = 0 CALL OPENWORK TO OPEN THE WORK        @Y30LB38*/ 00277000
*   /* DATA SET                                              @Y30LB38*/ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0393 00281000
*   IF LASTCOND=LASTCC00 THEN                                      0393 00282000
@RF00377 L     @06,@PC00001+8                                      0393 00283000
         LH    @06,LASTCOND(,@06)                                  0393 00284000
         LTR   @06,@06                                             0393 00285000
         BNZ   @RF00393                                            0393 00286000
*     DO;                           /*                       @Y30LB38*/ 00287000
*       CALL OPENWORK;              /*                       @Y30LB38*/ 00288000
         BAL   @14,OPENWORK                                        0395 00289000
*       RESPECIFY                                                  0396 00290000
*         RTNREG RSTD;                                             0396 00291000
*       TESTRC=RTNREG;                                             0397 00292000
         LR    TESTRC,RTNREG                                       0397 00293000
*       RESPECIFY                                                  0398 00294000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00295000
*       IF TESTRC=LASTCC12 THEN                                    0399 00296000
         LA    @02,12                                              0399 00297000
         CR    TESTRC,@02                                          0399 00298000
         BNE   @RF00399                                            0399 00299000
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/ 00300000
         L     @03,@PC00001+8                                      0400 00301000
         STH   @02,LASTCOND(,@03)                                  0400 00302000
*     END;                          /*                       @Y30LB38*/ 00303000
@RF00399 DS    0H                                                  0402 00304000
*                                                                  0402 00305000
*   /*****************************************************************/ 00306000
*   /*                                                               */ 00307000
*   /* IF SUCCESSFUL, CALL MSFLOOK TO COPY THE MSC TABLES    @ZM00717*/ 00308000
*   /* AND CHECK THE REQUESTED MSF.                          @ZM00717*/ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0402 00312000
*   IF LASTCOND=LASTCC00 THEN                                      0402 00313000
@RF00393 L     @15,@PC00001+8                                      0402 00314000
         LH    @15,LASTCOND(,@15)                                  0402 00315000
         LTR   @15,@15                                             0402 00316000
         BNZ   @RF00402                                            0402 00317000
*     DO;                           /*                       @Y30LB38*/ 00318000
*       CALL MSFLOOK;               /*                       @Y30LB38*/ 00319000
         BAL   @14,MSFLOOK                                         0404 00320000
*       RESPECIFY                                                  0405 00321000
*         RTNREG RSTD;                                             0405 00322000
*       TESTRC=RTNREG;                                             0406 00323000
         LR    TESTRC,RTNREG                                       0406 00324000
*       RESPECIFY                                                  0407 00325000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00326000
*       IF TESTRC=LASTCC12 THEN                                    0408 00327000
         LA    @02,12                                              0408 00328000
         CR    TESTRC,@02                                          0408 00329000
         BNE   @RF00408                                            0408 00330000
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/ 00331000
         L     @03,@PC00001+8                                      0409 00332000
         STH   @02,LASTCOND(,@03)                                  0409 00333000
*     END;                          /*                       @Y30LB38*/ 00334000
@RF00408 DS    0H                                                  0411 00335000
*                                                                  0411 00336000
*   /*****************************************************************/ 00337000
*   /*                                                               */ 00338000
*   /* IF SUCCESSFUL, CALL RPTSEL TO PRODUCE THE REPORTS     @ZM00717*/ 00339000
*   /* AND SUMARIES.                                         @ZM00717*/ 00340000
*   /*                                                               */ 00341000
*   /*****************************************************************/ 00342000
*                                                                  0411 00343000
*   IF LASTCOND=LASTCC00 THEN                                      0411 00344000
@RF00402 L     @15,@PC00001+8                                      0411 00345000
         LH    @15,LASTCOND(,@15)                                  0411 00346000
         LTR   @15,@15                                             0411 00347000
         BNZ   @RF00411                                            0411 00348000
*     DO;                           /*                       @Y30LB38*/ 00349000
*       CALL RPTSEL;                /*                       @Y30LB38*/ 00350000
         BAL   @14,RPTSEL                                          0413 00351000
*       RESPECIFY                                                  0414 00352000
*         RTNREG RSTD;                                             0414 00353000
*       TESTRC=RTNREG;                                             0415 00354000
         LR    TESTRC,RTNREG                                       0415 00355000
*       RESPECIFY                                                  0416 00356000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00357000
*       LASTCOND=TESTRC;            /*                       @Y30LB38*/ 00358000
         L     @02,@PC00001+8                                      0417 00359000
         STH   TESTRC,LASTCOND(,@02)                               0417 00360000
*     END;                          /*                       @Y30LB38*/ 00361000
*                                                                  0419 00362000
*   /*****************************************************************/ 00363000
*   /*                                                               */ 00364000
*   /* IF ACQSW = ON ISSUE THE USSC MACRO WITH THE           @ZA14727*/ 00365000
*   /* RELINQ OPTION TO RELINQUISH THE DATA SET SPACE SPECIFY THE    */ 00366000
*   /* UNBIND OPTION.                                        @ZA14727*/ 00367000
*   /*                                                               */ 00368000
*   /*****************************************************************/ 00369000
*                                                                  0419 00370000
*   IF ACQSW=ON THEN                                               0419 00371000
@RF00411 TM    ACQSW,B'00010000'                                   0419 00372000
         BNO   @RF00419                                            0419 00373000
*     DO;                           /*                       @ZA14727*/ 00374000
*       ACQLIST=ACQLIST&&ACQLIST;   /*                       @ZA14727*/ 00375000
         L     @02,ACQPTR                                          0421 00376000
         XC    ACQLIST(96,@02),ACQLIST(@02)                        0421 00377000
*       ARLL=LENGTH(ACQLIST);       /*                       @ZA14727*/ 00378000
         MVC   ARLL(4,@02),@CF01822                                0422 00379000
*       AROP=RELOPCOD;              /*                       @ZA14727*/ 00380000
         MVI   AROP(@02),X'04'                                     0423 00381000
*       ARBDUBD=ON;                 /*                       @ZA14727*/ 00382000
         OI    ARBDUBD(@02),B'10000000'                            0424 00383000
*       ARNMEXT=ONE;                /*                       @ZA14727*/ 00384000
         MVI   ARNMEXT(@02),X'01'                                  0425 00385000
*       ARVOL=VOLAREA(ONE);         /*                       @ZA14727*/ 00386000
         MVC   ARVOL(6,@02),VOLAREA                                0426 00387000
*       AREXT(1,1:2)=SCYL;          /*                       @ZA14727*/ 00388000
         MVC   AREXT(2,@02),SCYL                                   0427 00389000
*       AREXT(1,3:4)=ECYL;          /*                       @ZA14727*/ 00390000
         MVC   AREXT+2(2,@02),ECYL                                 0428 00391000
*       CALL IDCSASS0(GDTTBL,RELINQ,ACQPTR,REASONCD);/*      @ZA14727*/ 00392000
         L     @02,@PC00001                                        0429 00393000
         ST    @02,@AL00001                                        0429 00394000
         LA    @15,RELINQ                                          0429 00395000
         ST    @15,@AL00001+4                                      0429 00396000
         LA    @15,ACQPTR                                          0429 00397000
         ST    @15,@AL00001+8                                      0429 00398000
         LA    @15,REASONCD                                        0429 00399000
         ST    @15,@AL00001+12                                     0429 00400000
         MVI   @AL00001+12,X'80'                                   0429 00401000
         L     @15,GDTSSC(,@02)                                    0429 00402000
         LA    @01,@AL00001                                        0429 00403000
         BALR  @14,@15                                             0429 00404000
*       RESPECIFY                                                  0430 00405000
*         RTNREG RSTD;                                             0430 00406000
*       TESTRC=RTNREG;                                             0431 00407000
         LR    TESTRC,RTNREG                                       0431 00408000
*       RESPECIFY                                                  0432 00409000
*         RTNREG UNRSTD;            /*                       @ZA14727*/ 00410000
*       IF TESTRC^=0 THEN                                          0433 00411000
         LTR   TESTRC,TESTRC                                       0433 00412000
         BZ    @RF00433                                            0433 00413000
*         DO;                       /*                       @ZA14727*/ 00414000
*                                                                  0434 00415000
*           /*********************************************************/ 00416000
*           /*                                                       */ 00417000
*           /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE     @ZA14727*/ 00418000
*           /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.       */ 00419000
*           /*                                               @ZA14727*/ 00420000
*           /*                                                       */ 00421000
*           /*********************************************************/ 00422000
*                                                                  0435 00423000
*           CALL SSCMSG(REASONCD);  /*                       @ZA14727*/ 00424000
         LA    @15,REASONCD                                        0435 00425000
         ST    @15,@AL00001                                        0435 00426000
         LA    @01,@AL00001                                        0435 00427000
         BAL   @14,SSCMSG                                          0435 00428000
*           LASTCOND=LASTCC04;      /*                       @ZA14727*/ 00429000
         L     @15,@PC00001+8                                      0436 00430000
         MVC   LASTCOND(2,@15),@CH00043                            0436 00431000
*         END;                      /*                       @ZA14727*/ 00432000
*       ELSE                        /*                       @ZA14727*/ 00433000
*         ACQSW=OFF;                /*                       @ZA14727*/ 00434000
         B     @RC00433                                            0438 00435000
@RF00433 NI    ACQSW,B'11101111'                                   0438 00436000
*     END;                          /*                       @ZA14727*/ 00437000
*                                                                  0439 00438000
@RC00433 DS    0H                                                  0440 00439000
*   /*****************************************************************/ 00440000
*   /*                                                               */ 00441000
*   /* IF WORKPTR IS ^= 0 THEN THE WORK DATA SET WAS OPENED  #Y30LB38*/ 00442000
*   /* AND MUST BE CLOSED VIA UEXCP.                         @ZM00717*/ 00443000
*   /*                                                               */ 00444000
*   /*****************************************************************/ 00445000
*                                                                  0440 00446000
*   IF WORKPTR^=NULLPTR THEN                                       0440 00447000
@RF00419 L     @15,WORKPTR                                         0440 00448000
         LTR   @15,@15                                             0440 00449000
         BZ    @RF00440                                            0440 00450000
*     DO;                           /*                       @Y30LB38*/ 00451000
*       CALL IDCIO050(GDTTBL,CLOSE,WORKPTR);/*               @Y30LB38*/ 00452000
         L     @02,@PC00001                                        0442 00453000
         ST    @02,@AL00001                                        0442 00454000
         LA    @15,CLOSE                                           0442 00455000
         ST    @15,@AL00001+4                                      0442 00456000
         LA    @15,WORKPTR                                         0442 00457000
         ST    @15,@AL00001+8                                      0442 00458000
         MVI   @AL00001+8,X'80'                                    0442 00459000
         L     @15,GDTEXP(,@02)                                    0442 00460000
         LA    @01,@AL00001                                        0442 00461000
         BALR  @14,@15                                             0442 00462000
*       RESPECIFY                                                  0443 00463000
*         RTNREG RSTD;                                             0443 00464000
*       TESTRC=RTNREG;                                             0444 00465000
         LR    TESTRC,RTNREG                                       0444 00466000
*       RESPECIFY                                                  0445 00467000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00468000
*       IF TESTRC^=0 THEN                                          0446 00469000
         LTR   TESTRC,TESTRC                                       0446 00470000
         BZ    @RF00446                                            0446 00471000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB38*/ 00472000
         L     @15,@PC00001+8                                      0447 00473000
         LH    @14,LASTCOND(,@15)                                  0447 00474000
         LA    @07,4                                               0447 00475000
         CR    @14,@07                                             0447 00476000
         BNL   *+6                                                      00477000
         LR    @14,@07                                             0447 00478000
         STH   @14,LASTCOND(,@15)                                  0447 00479000
*     END;                          /*                       @Y30LB38*/ 00480000
@RF00446 DS    0H                                                  0449 00481000
*                                                                  0449 00482000
*   /*****************************************************************/ 00483000
*   /*                                                               */ 00484000
*   /* IF THE WDS PARAMETER WAS SPECIFIED AND A DDNAME       @ZM00717*/ 00485000
*   /* IS PRESENT FROM THE UALLOC MACRO THEN THE UDEALLOC MACRO WILL */ 00486000
*   /* BE ISSUED TO DE-ALLOCATE THE DATA SET.                @Y30LB38*/ 00487000
*   /*                                                               */ 00488000
*   /*****************************************************************/ 00489000
*                                                                  0449 00490000
*   IF ADDR(WDS)^=NULLPTR&ALLDDN^=LMZERO THEN                      0449 00491000
@RF00440 L     @15,@PC00001+4                                      0449 00492000
         L     @15,FDTPTR+4(,@15)                                  0449 00493000
         LTR   @15,@15                                             0449 00494000
         BZ    @RF00449                                            0449 00495000
         L     @15,ALLOCPTR                                        0449 00496000
         CLC   ALLDDN(8,@15),LMZERO                                0449 00497000
         BE    @RF00449                                            0449 00498000
*     DO;                           /*                       @Y30LB38*/ 00499000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Y30LB38*/ 00500000
         L     @02,@PC00001                                        0451 00501000
         ST    @02,@AL00001                                        0451 00502000
         ST    @15,@AL00001+4                                      0451 00503000
         MVI   @AL00001+4,X'80'                                    0451 00504000
         L     @15,GDTDLC(,@02)                                    0451 00505000
         LA    @01,@AL00001                                        0451 00506000
         BALR  @14,@15                                             0451 00507000
*       RESPECIFY                                                  0452 00508000
*         RTNREG RSTD;                                             0452 00509000
*       TESTRC=RTNREG;                                             0453 00510000
         LR    TESTRC,RTNREG                                       0453 00511000
*       RESPECIFY                                                  0454 00512000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00513000
*       IF TESTRC^=0 THEN                                          0455 00514000
         LTR   TESTRC,TESTRC                                       0455 00515000
         BZ    @RF00455                                            0455 00516000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB38*/ 00517000
         L     @15,@PC00001+8                                      0456 00518000
         LH    @14,LASTCOND(,@15)                                  0456 00519000
         LA    @07,4                                               0456 00520000
         CR    @14,@07                                             0456 00521000
         BNL   *+6                                                      00522000
         LR    @14,@07                                             0456 00523000
         STH   @14,LASTCOND(,@15)                                  0456 00524000
*     END;                          /*                       @Y30LB38*/ 00525000
*                                                                  0457 00526000
@RF00455 DS    0H                                                  0458 00527000
*   /*****************************************************************/ 00528000
*   /*                                                               */ 00529000
*   /* TEST GOTCORE SWITCH AND IF ON, INDICATING WORK CORE   @Y30LB38*/ 00530000
*   /* WAS OBTAINED, FREE THE 16K OF CORE. THE ADDRESS OF THE START  */ 00531000
*   /* OF THE WORK CORE WILL BE IN SORTPTR.                  @Y30LB38*/ 00532000
*   /*                                                               */ 00533000
*   /*****************************************************************/ 00534000
*                                                                  0458 00535000
*   IF GOTCORE=ON THEN                                             0458 00536000
@RF00449 TM    GOTCORE,B'01000000'                                 0458 00537000
         BNO   @RF00458                                            0458 00538000
*     DO;                           /*                       @ZM00717*/ 00539000
*       CALL IDCSAFS0(GDTTBL,SORTPTR);/*                     @Y30LB38*/ 00540000
         L     @15,@PC00001                                        0460 00541000
         ST    @15,@AL00001                                        0460 00542000
         LA    @14,SORTPTR                                         0460 00543000
         ST    @14,@AL00001+4                                      0460 00544000
         L     @15,GDTFSP(,@15)                                    0460 00545000
         LA    @01,@AL00001                                        0460 00546000
         BALR  @14,@15                                             0460 00547000
*                                                                  0461 00548000
*       /*************************************************************/ 00549000
*       /*                                                           */ 00550000
*       /* BUILD PARAMETER LIST FOR UPRINT MACRO. IF THE     @Y30LB38*/ 00551000
*       /* CONDITION CODE IS = 12 THEN MESSAGE IDC3003I IS PRINTED.  */ 00552000
*       /* OTHERWISE, MESSAGE IDC0001I IS PRINTED.           @Y30LB38*/ 00553000
*       /*                                                           */ 00554000
*       /*************************************************************/ 00555000
*                                                                  0461 00556000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 00557000
         XC    PRINTAB(84),PRINTAB                                 0461 00558000
*       DARGSMOD=UNIVMSG;           /*                       @Y30LB38*/ 00559000
         L     @15,DDSTRU                                          0462 00560000
         MVC   DARGSMOD(3,@15),@CC01481                            0462 00561000
*       DARGDBP=ADDR(LASTCOND);     /*                       @Y30LB38*/ 00562000
         L     @14,@PC00001+8                                      0463 00563000
         ST    @14,DARGDBP(,@15)                                   0463 00564000
*       DARGILP=LENGTH(LASTCOND);   /*                       @Y30LB38*/ 00565000
         MVC   DARGILP(2,@15),@CH00154                             0464 00566000
*       IF LASTCOND=LASTCC12 THEN   /*                       @Y30LB38*/ 00567000
         CLC   LASTCOND(2,@14),@CH00567                            0465 00568000
         BNE   @RF00465                                            0465 00569000
*         DARGSENT=MSG3003I;        /*                       @Y30LB38*/ 00570000
         MVI   DARGSENT(@15),X'03'                                 0466 00571000
*       ELSE                        /*                       @Y30LB38*/ 00572000
*         DARGSENT=MSG0001I;        /*                       @Y30LB38*/ 00573000
         B     @RC00465                                            0467 00574000
@RF00465 L     @01,DDSTRU                                          0467 00575000
         MVI   DARGSENT(@01),X'01'                                 0467 00576000
*     END;                          /*                       @ZM00717*/ 00577000
*                                                                  0468 00578000
*   /*****************************************************************/ 00579000
*   /*                                                               */ 00580000
*   /* IF GOTCORE SWITCH IS OFF, INDICATING FUNCTION ENDED   @ZM00717*/ 00581000
*   /* BECAUSE OF INSUFFICIENT STORAGE, ISSUE MESSAGE        @ZM00717*/ 00582000
*   /* IDC3004I WITHOUT ANY INSERTS                          @ZM00717*/ 00583000
*   /*                                                               */ 00584000
*   /*****************************************************************/ 00585000
*                                                                  0469 00586000
*   ELSE                                                           0469 00587000
*     DO;                           /*                       @ZM00717*/ 00588000
         B     @RC00458                                            0469 00589000
@RF00458 DS    0H                                                  0470 00590000
*       PRINTAB=''B;                /*                       @ZM00717*/ 00591000
         XC    PRINTAB(84),PRINTAB                                 0470 00592000
*       DARGSMOD=UNIVMSG;           /*                       @ZM00717*/ 00593000
         L     @15,DDSTRU                                          0471 00594000
         MVC   DARGSMOD(3,@15),@CC01481                            0471 00595000
*       DARGSENT=MSG3004I;          /*                       @ZM00717*/ 00596000
         MVI   DARGSENT(@15),X'04'                                 0472 00597000
*     END;                          /*                       @ZM00717*/ 00598000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB38*/ 00599000
@RC00458 L     @15,@PC00001                                        0474 00600000
         ST    @15,@AL00001                                        0474 00601000
         LA    @14,@CF00116                                        0474 00602000
         ST    @14,@AL00001+4                                      0474 00603000
         LA    @14,DDSTRU                                          0474 00604000
         ST    @14,@AL00001+8                                      0474 00605000
         MVI   @AL00001+8,X'80'                                    0474 00606000
         L     @15,GDTPRT(,@15)                                    0474 00607000
         LA    @01,@AL00001                                        0474 00608000
         BALR  @14,@15                                             0474 00609000
*                                                                  0475 00610000
*   /*****************************************************************/ 00611000
*   /*                                                               */ 00612000
*   /* IF PRINTME IS ^= 0 THEN THE OUTPUT DATA SET WAS       @ZM00727*/ 00613000
*   /* OPENED AND MUST BE CLOSED.                            @ZM00727*/ 00614000
*   /*                                                               */ 00615000
*   /*****************************************************************/ 00616000
*                                                                  0475 00617000
*   IF PRINTME^=NULLPTR THEN                                       0475 00618000
         L     @15,PRINTME                                         0475 00619000
         LTR   @15,@15                                             0475 00620000
         BZ    @RF00475                                            0475 00621000
*     DO;                           /*                       @ZM00727*/ 00622000
*       CALL IDCIOCL0(GDTTBL,IOCSPTR);/*                     @ZM00727*/ 00623000
         L     @02,@PC00001                                        0477 00624000
         ST    @02,@AL00001                                        0477 00625000
         LA    @15,IOCSPTR                                         0477 00626000
         ST    @15,@AL00001+4                                      0477 00627000
         MVI   @AL00001+4,X'80'                                    0477 00628000
         L     @15,GDTCLS(,@02)                                    0477 00629000
         LA    @01,@AL00001                                        0477 00630000
         BALR  @14,@15                                             0477 00631000
*       RESPECIFY                                                  0478 00632000
*         RTNREG RSTD;                                             0478 00633000
*       TESTRC=RTNREG;                                             0479 00634000
         LR    TESTRC,RTNREG                                       0479 00635000
*       RESPECIFY                                                  0480 00636000
*         RTNREG UNRSTD;            /*                       @ZM00727*/ 00637000
*       IF TESTRC^=0 THEN                                          0481 00638000
         LTR   TESTRC,TESTRC                                       0481 00639000
         BZ    @RF00481                                            0481 00640000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @ZM00727*/ 00641000
         L     @15,@PC00001+8                                      0482 00642000
         LH    @14,LASTCOND(,@15)                                  0482 00643000
         LA    @07,4                                               0482 00644000
         CR    @14,@07                                             0482 00645000
         BNL   *+6                                                      00646000
         LR    @14,@07                                             0482 00647000
         STH   @14,LASTCOND(,@15)                                  0482 00648000
*     END;                          /*                       @ZM00727*/ 00649000
@RF00481 DS    0H                                                  0484 00650000
*                                                                  0484 00651000
*   /*****************************************************************/ 00652000
*   /*                                                               */ 00653000
*   /* SET UP FOR A FULL REGION DUMP AND RETURN TO AMS       #Y30LB38*/ 00654000
*   /*                                                               */ 00655000
*   /*****************************************************************/ 00656000
*                                                                  0484 00657000
*   IF GDTDBG=NULLPTR THEN                                         0484 00658000
@RF00475 L     @15,@PC00001                                        0484 00659000
         L     @15,GDTDBG(,@15)                                    0484 00660000
         LTR   @15,@15                                             0484 00661000
         BZ    @RT00484                                            0484 00662000
*     ;                                                            0485 00663000
*   ELSE                                                           0486 00664000
*     CALL IDCDB010(GDTTBL,'LMAZ'); /*                       #Y30LB38*/ 00665000
         L     @15,@PC00001                                        0486 00666000
         ST    @15,@AL00001                                        0486 00667000
         LA    @14,@CC01507                                        0486 00668000
         ST    @14,@AL00001+4                                      0486 00669000
         MVI   @AL00001+4,X'80'                                    0486 00670000
         L     @15,GDTDBG(,@15)                                    0486 00671000
         LA    @01,@AL00001                                        0486 00672000
         BALR  @14,@15                                             0486 00673000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0487 00674000
*                                                                  0487 00675000
@RT00484 L     @15,@PC00001                                        0487 00676000
         ST    @15,@AL00001                                        0487 00677000
         LA    @14,MODID                                           0487 00678000
         ST    @14,@AL00001+4                                      0487 00679000
         L     @14,@PC00001+8                                      0487 00680000
         ST    @14,@AL00001+8                                      0487 00681000
         MVI   @AL00001+8,X'80'                                    0487 00682000
         L     @15,GDTEPL(,@15)                                    0487 00683000
         LA    @01,@AL00001                                        0487 00684000
         BALR  @14,@15                                             0487 00685000
*   /*****************************************************************/ 00686000
*   /*                                                               */ 00687000
*   /*                                                       @Y30LB38*/ 00688000
*   /*                                                               */ 00689000
*   /*****************************************************************/ 00690000
*                                                                  0488 00691000
*                                                                  0488 00692000
*/********************************************************************/ 00693000
*/*                                                          @Y30LB38*/ 00694000
*/*     PROCEDURE NAME - OPENWORK                            @Y30LB38*/ 00695000
*/*                                                          @Y30LB38*/ 00696000
*/*     FUNCTION - THIS ROUTINE OPENS THE WORK DATA SET      @Y30LB38*/ 00697000
*/*                AND BINDS ITS SPACE AFTER MAKING SURE     @Y30LB38*/ 00698000
*/*                THAT IT IS A VIRTUAL VOLUME.              @Y30LB38*/ 00699000
*/*                                                          @Y30LB38*/ 00700000
*/*     INPUT - FUNCTION DEFINITION TABLE                    @Y30LB38*/ 00701000
*/*                                                          @Y30LB38*/ 00702000
*/*     OUTPUT - INTTBL INITIALIZED WITH THE WORK VOLUME     @Y30LB38*/ 00703000
*/*                SERIAL NUMBER AND WITH THE START AND      @Y30LB38*/ 00704000
*/*                END CYLINDER ADDRESSES AND A RETURN CODE  @Y30LB38*/ 00705000
*/*                0 = SUCCESSFUL COMPLETION                 @Y30LB38*/ 00706000
*/*                12 = UNSUCCESSFUL COMPLETION              @Y30LB38*/ 00707000
*/*                                                          @Y30LB38*/ 00708000
*/********************************************************************/ 00709000
*                                                                  0488 00710000
*OPENWORK:                                                         0488 00711000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 00712000
*                                                                  0488 00713000
@EL00001 L     @13,4(,@13)                                         0488 00714000
@EF00001 L     @00,@SIZDATD                                        0488 00715000
         LR    @01,@11                                             0488 00716000
         FREEMAIN R,LV=(0),A=(1)                                        00717000
@ER00001 LM    @14,@12,12(@13)                                     0488 00718000
         BR    @14                                                 0488 00719000
OPENWORK DS    0H                                                  0489 00720000
*   /*****************************************************************/ 00721000
*   /*                                                               */ 00722000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0489 00726000
*   DCL                                                            0489 00727000
*     OPENCODE FIXED(15);           /* OPENWORK RET CODE     @Y30LB38*/ 00728000
*   DCL                                                            0490 00729000
*     IOINFO CHAR(LENGTH(IOINFOPT));/* UIOINFO FLAGS         @Y30LB38*/ 00730000
*   DCL                                                            0491 00731000
*     VOLSRPTR PTR(31);             /* PTR TO VOLSER'S       @Y30LB38   00732000
*                                      FROM UIONFO MACRO     @Y30LB38*/ 00733000
*                                                                  0491 00734000
*   /*****************************************************************/ 00735000
*   /*                                                               */ 00736000
*   /* DECLARE WORK AREA STRUCTURE FOR RETURN OF VOLUME      @Y30LB38*/ 00737000
*   /* SERIAL NUMBERS FROM UIOINFO MACRO                     @Y30LB38*/ 00738000
*   /*                                                               */ 00739000
*   /*****************************************************************/ 00740000
*                                                                  0492 00741000
*   DCL                                                            0492 00742000
*     1 INFOAREA BDY(WORD),                                        0492 00743000
*      2 WORKLEN FIXED(15),         /* WORK AREA LENGTH      @ZM00727*/ 00744000
*      2 RETNLEN FIXED(15),         /* DATA RETURNED LEN     @ZM00727*/ 00745000
*      2 TYPE FIXED(15),            /* DATA TYPE             @Y30LB38*/ 00746000
*      2 DATALEN FIXED(15),         /* DATA LENGTH           @Y30LB38*/ 00747000
*      2 VOLAREA(5) CHAR(6);        /* VOLUME SER NUMBERS    @Y30LB38*/ 00748000
*                                                                  0492 00749000
*   /*****************************************************************/ 00750000
*   /*                                                               */ 00751000
*   /* DECLARE UNIT LIST FOR UALLOC MACRO                    @Y30LB38*/ 00752000
*   /*                                                               */ 00753000
*   /*****************************************************************/ 00754000
*                                                                  0493 00755000
*   DCL                                                            0493 00756000
*     1 UNITLIST,                   /*                       @Y30LB38*/ 00757000
*       3 COUNT FIXED(15),          /* COUNT FIELD           @Y30LB38*/ 00758000
*       3 DEVLEN FIXED(15),         /*                       @Y30LB38*/ 00759000
*       3 DEVTYPE CHAR(8);          /*                       @Y30LB38*/ 00760000
*   DCL                                                            0494 00761000
*     UNITCON CHAR(5) CONSTANT('SDG00');/*                   @Y30LB38*/ 00762000
*   DCL                                                            0495 00763000
*     ACQOPCOD FIXED(8) CONSTANT(2);/* ACQUIRE OP CODE       @ZM00717*/ 00764000
*   DCL                                                            0496 00765000
*     DDNAME CHAR(8);               /* DDNAME WORK AREA      @Y30LB38*/ 00766000
*   DCL                                                            0497 00767000
*     UCBPTR PTR(31);               /* UCB PTR               @Y30LB38*/ 00768000
*                                                                  0498 00769000
*   /*****************************************************************/ 00770000
*   /*                                                               */ 00771000
*   /* SAVE RETURN ADDRESS                                   @Y30LB38*/ 00772000
*   /*                                                               */ 00773000
*   /*****************************************************************/ 00774000
*                                                                  0498 00775000
*   RETADDR1=REG14;                 /*                       @Y30LB38*/ 00776000
         ST    REG14,RETADDR1                                      0498 00777000
*   OLDERID2=NEWERID2;                                             0499 00778000
         L     @15,@PC00001                                        0499 00779000
         L     @14,GDTTR2(,@15)                                    0499 00780000
         MVC   @TS00001(95),NEWERID2(@14)                          0499 00781000
         MVC   OLDERID2(95,@14),@TS00001                           0499 00782000
*   NEWID2='LMBA';                  /*                       @Y30LB38*/ 00783000
*                                                                  0500 00784000
         MVC   NEWID2(4,@14),@CC01528                              0500 00785000
*   /*****************************************************************/ 00786000
*   /*                                                               */ 00787000
*   /* INITIALIZE POINTERS TO ARGUMENT LISTS AND AREAS       @ZM00717*/ 00788000
*   /* TO ZERO.                                              @ZM00717*/ 00789000
*   /*                                                               */ 00790000
*   /*****************************************************************/ 00791000
*                                                                  0501 00792000
*   OPENCODE=''B;                   /*                       @Y30LB38*/ 00793000
         SLR   @14,@14                                             0501 00794000
         LR    OPENCODE,@14                                        0501 00795000
*   VOLSRPTR=ADDR(INFOAREA);        /*                       @Y30LB38*/ 00796000
         LA    @03,INFOAREA                                        0502 00797000
         ST    @03,VOLSRPTR                                        0502 00798000
*   WORKLEN=LENGTH(INFOAREA);       /*                       @Y30LB38*/ 00799000
         MVC   WORKLEN(2),@CH01823                                 0503 00800000
*   UCBPTR=''B;                     /*                       @Y30LB38*/ 00801000
         ST    @14,UCBPTR                                          0504 00802000
*   RESPECIFY                                                      0505 00803000
*     IOINFOPT BASED(ADDR(IOINFO)); /*                       @Y30LB38*/ 00804000
*   IOINFOPT=''B;                   /*                       @Y30LB38*/ 00805000
*                                                                  0506 00806000
         LA    @14,IOINFO                                          0506 00807000
         MVI   IOINFOPT(@14),X'00'                                 0506 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* CHECK TO SEE IF THE WDS PARAMETER IS SPECIFIED.       @Y30LB38*/ 00811000
*   /* THIS PARM INDICATES THAT A DSN WAS GIVEN AND THE UALLOC MACRO */ 00812000
*   /* IS ISSUED TO OBTAIN A DDNAME FOR THE DSNAME. IF NOT SPECIFIED,*/ 00813000
*   /* USE THE DDNAME FROM THE WFILE PARM.                   @Y30LB38*/ 00814000
*   /*                                                               */ 00815000
*   /*****************************************************************/ 00816000
*                                                                  0507 00817000
*   IF ADDR(WDS)^=NULLPTR THEN                                     0507 00818000
         L     @14,@PC00001+4                                      0507 00819000
         L     @14,FDTPTR+4(,@14)                                  0507 00820000
         LTR   @14,@14                                             0507 00821000
         BZ    @RF00507                                            0507 00822000
*     DO;                           /*                       @Y30LB38*/ 00823000
*       ALLDSN=ADDR(WDSVAL);        /*                       @Y30LB38*/ 00824000
         L     @02,ALLOCPTR                                        0509 00825000
         LA    @14,WDSVAL(,@14)                                    0509 00826000
         ST    @14,ALLDSN(,@02)                                    0509 00827000
*       ALLSTSOD=ON;                /*                       @Y30LB38*/ 00828000
         OI    ALLSTSOD(@02),B'00000001'                           0510 00829000
*       ALLDSPKP=ON;                /*                       @Y30LB38*/ 00830000
         OI    ALLDSPKP(@02),B'00001000'                           0511 00831000
*       ALLOPTDS=ON;                /*                       @Y30LB38*/ 00832000
*                                                                  0512 00833000
         OI    ALLOPTDS(@02),B'01000000'                           0512 00834000
*       /*************************************************************/ 00835000
*       /*                                                           */ 00836000
*       /* SET UP THE UNIT LIST TO ALLOCATE THE DATA SET     @ZM00717*/ 00837000
*       /* ON A UNIT IN STAGING DRIVE GROUP ZERO             @ZM00717*/ 00838000
*       /*                                                           */ 00839000
*       /*************************************************************/ 00840000
*                                                                  0513 00841000
*       ALLULP=ADDR(UNITLIST);      /*                       @Y30LB38*/ 00842000
         LA    @14,UNITLIST                                        0513 00843000
         ST    @14,ALLULP(,@02)                                    0513 00844000
*       COUNT=ONE;                  /*                       @Y30LB38*/ 00845000
         MVC   COUNT(2),@CH00220                                   0514 00846000
*       DEVLEN=LENGTH(UNITCON);     /*                       @Y30LB38*/ 00847000
         MVC   DEVLEN(2),@CH00287                                  0515 00848000
*       DEVTYPE=UNITCON;            /*                       @Y30LB38*/ 00849000
         MVI   DEVTYPE+5,C' '                                      0516 00850000
         MVC   DEVTYPE+6(2),DEVTYPE+5                              0516 00851000
         MVC   DEVTYPE(5),@CC01524                                 0516 00852000
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/*                      @Y30LB38*/ 00853000
         ST    @15,@AL00001                                        0517 00854000
         ST    @02,@AL00001+4                                      0517 00855000
         MVI   @AL00001+4,X'80'                                    0517 00856000
         L     @15,GDTALC(,@15)                                    0517 00857000
         LA    @01,@AL00001                                        0517 00858000
         BALR  @14,@15                                             0517 00859000
*       RESPECIFY                                                  0518 00860000
*         RTNREG RSTD;                                             0518 00861000
*       TESTRC=RTNREG;                                             0519 00862000
         LR    TESTRC,RTNREG                                       0519 00863000
*       RESPECIFY                                                  0520 00864000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00865000
*       IF TESTRC^=0 THEN                                          0521 00866000
         LTR   TESTRC,TESTRC                                       0521 00867000
         BZ    @RF00521                                            0521 00868000
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/ 00869000
         LA    OPENCODE,12                                         0522 00870000
*       ELSE                                                       0523 00871000
*         DDNAME=ALLDDN;            /*                       @Y30LB38*/ 00872000
         B     @RC00521                                            0523 00873000
@RF00521 L     @01,ALLOCPTR                                        0523 00874000
         MVC   DDNAME(8),ALLDDN(@01)                               0523 00875000
*     END;                          /*                       @Y30LB38*/ 00876000
*   ELSE                                                           0525 00877000
*     DDNAME=WFILEVAL;              /*                       @Y30LB38*/ 00878000
         B     @RC00507                                            0525 00879000
@RF00507 L     @15,@PC00001+4                                      0525 00880000
         L     @01,FDTPTR(,@15)                                    0525 00881000
         MVC   DDNAME(8),WFILEVAL(@01)                             0525 00882000
*                                                                  0526 00883000
*   /*****************************************************************/ 00884000
*   /*                                                               */ 00885000
*   /* IF OPENCODE = 0 THEN ISSUE THE UIOINFO MACRO TO       @Y30LB38*/ 00886000
*   /* RETREIVE THE VOLSER FROM THE JFCB. USE THE DDNAME PLACED IN   */ 00887000
*   /* THE DDNAME FIELD.                                     @Y30LB38*/ 00888000
*   /*                                                               */ 00889000
*   /*****************************************************************/ 00890000
*                                                                  0526 00891000
*   IF OPENCODE=LASTCC00 THEN                                      0526 00892000
@RC00507 LTR   OPENCODE,OPENCODE                                   0526 00893000
         BNZ   @RF00526                                            0526 00894000
*     DO;                           /*                       @Y30LB38*/ 00895000
*       WORKLEN=LENGTH(INFOAREA);   /*                       @ZM00717*/ 00896000
         MVC   WORKLEN(2),@CH01823                                 0528 00897000
*       IOINFVOL=ON;                /*                       @Y30LB38*/ 00898000
         LA    @02,IOINFO                                          0529 00899000
         OI    IOINFVOL(@02),B'01000000'                           0529 00900000
*       CALL IDCIOSI0(GDTTBL,IOINFO,VOLSRPTR,DDNAME);/*      @Y30LB38*/ 00901000
         L     @02,@PC00001                                        0530 00902000
         ST    @02,@AL00001                                        0530 00903000
         LA    @15,IOINFO                                          0530 00904000
         ST    @15,@AL00001+4                                      0530 00905000
         LA    @15,VOLSRPTR                                        0530 00906000
         ST    @15,@AL00001+8                                      0530 00907000
         LA    @15,DDNAME                                          0530 00908000
         ST    @15,@AL00001+12                                     0530 00909000
         MVI   @AL00001+12,X'80'                                   0530 00910000
         L     @15,GDTIFO(,@02)                                    0530 00911000
         LA    @01,@AL00001                                        0530 00912000
         BALR  @14,@15                                             0530 00913000
*       RESPECIFY                                                  0531 00914000
*         RTNREG RSTD;                                             0531 00915000
*       TESTRC=RTNREG;                                             0532 00916000
         LR    TESTRC,RTNREG                                       0532 00917000
*       RESPECIFY                                                  0533 00918000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00919000
*       IF TESTRC^=0 THEN                                          0534 00920000
         LTR   TESTRC,TESTRC                                       0534 00921000
         BZ    @RF00534                                            0534 00922000
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/ 00923000
         LA    OPENCODE,12                                         0535 00924000
*       ELSE                                                       0536 00925000
*         WRKVOL=VOLAREA(1);        /*                       @Y30LB38*/ 00926000
         B     @RC00534                                            0536 00927000
@RF00534 MVC   WRKVOL(6),VOLAREA                                   0536 00928000
*     END;                          /*                       @Y30LB38*/ 00929000
@RC00534 DS    0H                                                  0538 00930000
*                                                                  0538 00931000
*   /*****************************************************************/ 00932000
*   /*                                                               */ 00933000
*   /* IF OPENCODE = 0 THEN ISSUE UMSSUNIT MACRO TO CHECK    @Y30LB38*/ 00934000
*   /* THE WORK DATA SET FOR BEING ON A VIRTUAL VOLUME. PRIOR TO     */ 00935000
*   /* ISSUING THE MACRO TEST IF THE DATA SET WAS ALLOCATED          */ 00936000
*   /* DYNAMICALLY. IF YES, PLACE THE VOLSER IN THE CKAGL PARM LIST  */ 00937000
*   /* SO THAT IF AN ERROR OCCURS THE VOLSER WILL BE USED INSTEAD OF */ 00938000
*   /* THE DDNAME                                            @Y30LB38*/ 00939000
*   /*                                                               */ 00940000
*   /*****************************************************************/ 00941000
*                                                                  0538 00942000
*   IF OPENCODE=LASTCC00 THEN                                      0538 00943000
@RF00526 SLR   @15,@15                                             0538 00944000
         CR    OPENCODE,@15                                        0538 00945000
         BNE   @RF00538                                            0538 00946000
*     DO;                           /*                       @Y30LB38*/ 00947000
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Y30LB38*/ 00948000
         L     @14,CKPTR                                           0540 00949000
         LA    @03,UCBPTR                                          0540 00950000
         ST    @03,CKUCBPTR(,@14)                                  0540 00951000
*       CKDDNAME=DDNAME;            /*                       @Y30LB38*/ 00952000
         MVC   CKDDNAME(8,@14),DDNAME                              0541 00953000
*       CKTESTVT=ON;                /*                       @Y30LB38*/ 00954000
         OI    CKTESTVT(@14),B'10000000'                           0542 00955000
*       IF ADDR(WDS)^=NULLPTR THEN  /*                       @Y30LB38*/ 00956000
         L     @03,@PC00001+4                                      0543 00957000
         C     @15,FDTPTR+4(,@03)                                  0543 00958000
         BE    @RF00543                                            0543 00959000
*         CKLABELP=ADDR(VOLAREA(1));/*                       @ZA08852*/ 00960000
         LA    @15,VOLAREA                                         0544 00961000
         ST    @15,CKLABELP(,@14)                                  0544 00962000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB38*/ 00963000
@RF00543 L     @02,@PC00001                                        0545 00964000
         ST    @02,@AL00001                                        0545 00965000
         LA    @15,CHECK                                           0545 00966000
         ST    @15,@AL00001+4                                      0545 00967000
         L     @01,CKPTR                                           0545 00968000
         ST    @01,@AL00001+8                                      0545 00969000
         MVI   @AL00001+8,X'80'                                    0545 00970000
         L     @15,GDTUNT(,@02)                                    0545 00971000
         LA    @01,@AL00001                                        0545 00972000
         BALR  @14,@15                                             0545 00973000
*       RESPECIFY                                                  0546 00974000
*         RTNREG RSTD;                                             0546 00975000
*       TESTRC=RTNREG;                                             0547 00976000
         LR    TESTRC,RTNREG                                       0547 00977000
*       RESPECIFY                                                  0548 00978000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 00979000
*       IF TESTRC^=0 THEN                                          0549 00980000
         LTR   TESTRC,TESTRC                                       0549 00981000
         BZ    @RF00549                                            0549 00982000
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/ 00983000
         LA    OPENCODE,12                                         0550 00984000
*     END;                          /*                       @Y30LB38*/ 00985000
@RF00549 DS    0H                                                  0552 00986000
*                                                                  0552 00987000
*   /*****************************************************************/ 00988000
*   /*                                                               */ 00989000
*   /* IF OPENCODE = 0 THEN ISSUE THE UEXCP MACRO TO OPEN    @Y30LB38*/ 00990000
*   /* THE WORK DATA SET. UPON RETURN FROM SUCCESSFUL OPEN OF THE    */ 00991000
*   /* DATA SET THE BEGINING AND ENDING ADDRESS MUST BE ON A CYLINDER*/ 00992000
*   /* BOUNDARY. IF NOT, THE BEG CYLINDER ADDR IS ROUNDED UP AND THE */ 00993000
*   /* END CYL IS ROUNDED DOWN.                              @Y30LB38*/ 00994000
*   /*                                                               */ 00995000
*   /*****************************************************************/ 00996000
*                                                                  0552 00997000
*   IF OPENCODE=LASTCC00 THEN                                      0552 00998000
@RF00538 LTR   OPENCODE,OPENCODE                                   0552 00999000
         BNZ   @RF00552                                            0552 01000000
*     DO;                           /*                       @Y30LB38*/ 01001000
*       EXODDN=ADDR(DDNAME);        /*                       @Y30LB38*/ 01002000
         LA    @02,DDNAME                                          0554 01003000
         ST    @02,EXODDN(,EXOPTR)                                 0554 01004000
*       EXOEXT=ADDR(EXTADR);        /*                       @Y30LB38*/ 01005000
         LA    @02,EXTADR                                          0555 01006000
         ST    @02,EXOEXT(,EXOPTR)                                 0555 01007000
*       EXOCTLBK=ADDR(WORKPTR);     /*                       @Y30LB38*/ 01008000
         LA    @02,WORKPTR                                         0556 01009000
         ST    @02,EXOCTLBK(,EXOPTR)                               0556 01010000
*       EXOTAB=ON;                  /*                       @Y30LB38*/ 01011000
         OI    EXOTAB(EXOPTR),B'10000000'                          0557 01012000
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                 @Y30LB38*/ 01013000
         L     @02,@PC00001                                        0558 01014000
         ST    @02,@AL00001                                        0558 01015000
         LA    @15,OPEN                                            0558 01016000
         ST    @15,@AL00001+4                                      0558 01017000
         ST    EXOPTR,@AL00001+8                                   0558 01018000
         MVI   @AL00001+8,X'80'                                    0558 01019000
         L     @15,GDTEXP(,@02)                                    0558 01020000
         LA    @01,@AL00001                                        0558 01021000
         BALR  @14,@15                                             0558 01022000
*       RESPECIFY                                                  0559 01023000
*         RTNREG RSTD;                                             0559 01024000
*       TESTRC=RTNREG;                                             0560 01025000
         LR    TESTRC,RTNREG                                       0560 01026000
*       RESPECIFY                                                  0561 01027000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 01028000
*       IF TESTRC=0 THEN                                           0562 01029000
         LTR   TESTRC,TESTRC                                       0562 01030000
         BNZ   @RF00562                                            0562 01031000
*         DO;                       /*                       @Y30LB38*/ 01032000
*           IF STRK^=CHARZERO(1:2) THEN                            0564 01033000
         CLC   STRK(2),CHARZERO                                    0564 01034000
         BE    @RF00564                                            0564 01035000
*             SCYL=SCYL+ONE;        /*                       @Y30LB38*/ 01036000
         LA    @07,1                                               0565 01037000
         SLR   @15,@15                                             0565 01038000
         ICM   @15,3,SCYL                                          0565 01039000
         ALR   @07,@15                                             0565 01040000
         STCM  @07,3,SCYL                                          0565 01041000
*           IF ETRK^=CHARZERO(1:2) THEN                            0566 01042000
@RF00564 CLC   ETRK(2),CHARZERO                                    0566 01043000
         BE    @RF00566                                            0566 01044000
*             ECYL=ECYL-ONE;        /*                       @Y30LB38*/ 01045000
         LH    @07,ECYL                                            0567 01046000
         N     @07,@CF01843                                        0567 01047000
         BCTR  @07,0                                               0567 01048000
         STH   @07,ECYL                                            0567 01049000
*         END;                      /*                       @Y30LB38*/ 01050000
*       ELSE                                                       0569 01051000
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/ 01052000
         B     @RC00562                                            0569 01053000
@RF00562 LA    OPENCODE,12                                         0569 01054000
*     END;                          /*                       @Y30LB38*/ 01055000
@RC00562 DS    0H                                                  0571 01056000
*                                                                  0571 01057000
*   /*****************************************************************/ 01058000
*   /*                                                               */ 01059000
*   /* IF OPENCODE = 0 ISSUE THE USSC MACRO WITH THE         @ZA14727*/ 01060000
*   /* ACQUIRE OPTION TO ACQUIRE THE DATA SET SPACE AND ALSO SPECIFY */ 01061000
*   /* THE BIND OPTION.                                      @Y30LB38*/ 01062000
*   /*                                                               */ 01063000
*   /*****************************************************************/ 01064000
*                                                                  0571 01065000
*   IF OPENCODE=LASTCC00 THEN                                      0571 01066000
@RF00552 SLR   @07,@07                                             0571 01067000
         CR    OPENCODE,@07                                        0571 01068000
         BNE   @RF00571                                            0571 01069000
*     DO;                           /*                       @Y30LB38*/ 01070000
*       ARLL=LENGTH(ACQLIST);       /*                       @Y30LB38*/ 01071000
         L     @15,ACQPTR                                          0573 01072000
         MVC   ARLL(4,@15),@CF01822                                0573 01073000
*       AROP=ACQOPCOD;              /*                       @ZM00717*/ 01074000
         MVI   AROP(@15),X'02'                                     0574 01075000
*       ARBDUBD=ON;                 /*                       @Y30LB38*/ 01076000
*       ARINH=ON;                   /*                       @Y30LB38*/ 01077000
         OI    ARBDUBD(@15),B'10100000'                            0576 01078000
*       ARNMEXT=ONE;                /*                       @Y30LB38*/ 01079000
         MVI   ARNMEXT(@15),X'01'                                  0577 01080000
*       ARVOL=VOLAREA(ONE);         /*                       @Y30LB38*/ 01081000
         MVC   ARVOL(6,@15),VOLAREA                                0578 01082000
*       AREXT(1,1:2)=SCYL;          /*                       @Y30LB38*/ 01083000
         MVC   AREXT(2,@15),SCYL                                   0579 01084000
*       AREXT(1,3:4)=ECYL;          /*                       @Y30LB38*/ 01085000
*                                                                  0580 01086000
         MVC   AREXT+2(2,@15),ECYL                                 0580 01087000
*       /*************************************************************/ 01088000
*       /*                                                           */ 01089000
*       /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF    @Y30LB38*/ 01090000
*       /* USSC PARM LIST                                    @Y30LB38*/ 01091000
*       /*                                                           */ 01092000
*       /*************************************************************/ 01093000
*                                                                  0581 01094000
*       IF GDTDBG=NULLPTR THEN                                     0581 01095000
         L     @15,@PC00001                                        0581 01096000
         C     @07,GDTDBG(,@15)                                    0581 01097000
         BE    @RT00581                                            0581 01098000
*         ;                                                        0582 01099000
*       ELSE                                                       0583 01100000
*         DO;                                                      0583 01101000
*           DMPINDEX=ADDR(DMPSTG);  /*                       @Y30LB38*/ 01102000
         LA    DMPINDEX,DMPSTG                                     0584 01103000
*           DMPITMNM='ACQLIST';                                    0585 01104000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0585 01105000
         MVC   DMPITMNM(7,DMPINDEX),@CC01531                       0585 01106000
*           DMPITMPT=ADDR(ACQLIST);                                0586 01107000
         L     @07,ACQPTR                                          0586 01108000
         ST    @07,DMPITMPT(,DMPINDEX)                             0586 01109000
*           DMPITMLN=LENGTH(ACQLIST);                              0587 01110000
         MVC   DMPITMLN(2,DMPINDEX),@CH01822                       0587 01111000
*           DMPITMTP='H';                                          0588 01112000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0588 01113000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0589 01114000
         AL    DMPINDEX,@CF00475                                   0589 01115000
*           DMPTRM=DMPTRMVL;                                       0590 01116000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0590 01117000
*         END;                      /*                       @Y30LB38*/ 01118000
*       IF GDTDBG=NULLPTR THEN                                     0592 01119000
@RT00581 L     @07,@PC00001                                        0592 01120000
         L     @07,GDTDBG(,@07)                                    0592 01121000
         LTR   @07,@07                                             0592 01122000
         BZ    @RT00592                                            0592 01123000
*         ;                                                        0593 01124000
*       ELSE                                                       0594 01125000
*         CALL IDCDB010(GDTTBL,'LMBF',ADDR(DMPSTG));/*       @Y30LB38*/ 01126000
         L     @07,@PC00001                                        0594 01127000
         ST    @07,@AL00001                                        0594 01128000
         LA    @15,@CC01533                                        0594 01129000
         ST    @15,@AL00001+4                                      0594 01130000
         LA    @15,DMPSTG                                          0594 01131000
         ST    @15,@AFTEMPS                                        0594 01132000
         LA    @15,@AFTEMPS                                        0594 01133000
         ST    @15,@AL00001+8                                      0594 01134000
         MVI   @AL00001+8,X'80'                                    0594 01135000
         L     @15,GDTDBG(,@07)                                    0594 01136000
         LA    @01,@AL00001                                        0594 01137000
         BALR  @14,@15                                             0594 01138000
*       CALL IDCSASS0(GDTTBL,ACQUIRE,ACQPTR,REASONCD);/*     @Y30LB38*/ 01139000
@RT00592 L     @07,@PC00001                                        0595 01140000
         ST    @07,@AL00001                                        0595 01141000
         LA    @02,ACQUIRE                                         0595 01142000
         ST    @02,@AL00001+4                                      0595 01143000
         LA    @02,ACQPTR                                          0595 01144000
         ST    @02,@AL00001+8                                      0595 01145000
         LA    @02,REASONCD                                        0595 01146000
         ST    @02,@AL00001+12                                     0595 01147000
         MVI   @AL00001+12,X'80'                                   0595 01148000
         L     @15,GDTSSC(,@07)                                    0595 01149000
         LA    @01,@AL00001                                        0595 01150000
         BALR  @14,@15                                             0595 01151000
*       RESPECIFY                                                  0596 01152000
*         RTNREG RSTD;                                             0596 01153000
*       TESTRC=RTNREG;                                             0597 01154000
         LR    TESTRC,RTNREG                                       0597 01155000
*       RESPECIFY                                                  0598 01156000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 01157000
*       IF TESTRC^=0 THEN                                          0599 01158000
         LTR   TESTRC,TESTRC                                       0599 01159000
         BZ    @RF00599                                            0599 01160000
*         DO;                       /*                       @ZA14727*/ 01161000
*                                                                  0600 01162000
*           /*********************************************************/ 01163000
*           /*                                                       */ 01164000
*           /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE     @Y30LB38*/ 01165000
*           /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.       */ 01166000
*           /*                                               @Y30LB38*/ 01167000
*           /*                                                       */ 01168000
*           /*********************************************************/ 01169000
*                                                                  0601 01170000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB38*/ 01171000
         LA    @15,REASONCD                                        0601 01172000
         ST    @15,@AL00001                                        0601 01173000
         LA    @01,@AL00001                                        0601 01174000
         BAL   @14,SSCMSG                                          0601 01175000
*           OPENCODE=LASTCC12;      /*                       @Y30LB38*/ 01176000
         LA    OPENCODE,12                                         0602 01177000
*         END;                      /*                       @Y30LB38*/ 01178000
*       ELSE                        /*                       @ZA14727*/ 01179000
*         ACQSW=ON;                 /*                       @ZA14727*/ 01180000
         B     @RC00599                                            0604 01181000
@RF00599 OI    ACQSW,B'00010000'                                   0604 01182000
*     END;                          /*                       @Y30LB38*/ 01183000
*                                                                  0605 01184000
@RC00599 DS    0H                                                  0606 01185000
*   /*****************************************************************/ 01186000
*   /*                                                               */ 01187000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 01188000
*   /*                                                               */ 01189000
*   /*****************************************************************/ 01190000
*                                                                  0606 01191000
*   REG14=RETADDR1;                 /*                       @Y30LB38*/ 01192000
@RF00571 L     REG14,RETADDR1                                      0606 01193000
*   RETURN CODE(OPENCODE);          /*                       @Y30LB38*/ 01194000
         LR    @15,OPENCODE                                        0607 01195000
@EL00002 DS    0H                                                  0607 01196000
@EF00002 DS    0H                                                  0607 01197000
@ER00002 BR    @14                                                 0607 01198000
*   END OPENWORK;                   /*                       @Y30LB38*/ 01199000
*                                                                  0609 01200000
*/********************************************************************/ 01201000
*/*                                                          @Y30LB38*/ 01202000
*/*     PROCEDURE NAME - RPTSEL                              @Y30LB38*/ 01203000
*/*                                                          @Y30LB38*/ 01204000
*/*     FUNCTION - THIS ROUTINE INVESTIGATES THE FDTTBL FOR  @Y30LB38*/ 01205000
*/*                THE REPORTS REQUESTED, UPDATES FIELDS IN  @Y30LB38*/ 01206000
*/*                THE INTTBL TO INDICATE THE REPORT PARMS   @Y30LB38*/ 01207000
*/*                AND CALLS THE REPORT PROCESSOR AND/OR     @Y30LB38*/ 01208000
*/*                SUMMARIZER TO PRODUCE EACH REPORT         @Y30LB38*/ 01209000
*/*                OR TO COUNT THE NUMBER OF EACH TYPE OF    @Y30LB38*/ 01210000
*/*                ENTRY IF SUMARY IS SPECIFIED.  THE        @Y30LB38*/ 01211000
*/*                SUMARIZER IS CALLED TO PRINT THE SUMARY   @Y30LB38*/ 01212000
*/*                REPORT.  THE                              @Y30LB38*/ 01213000
*/*                CONDITION CODE AREA IS SET TO HEX 7FFF    @ZM00717*/ 01214000
*/*                AT ENTRY TO INDICATE THAT NO REPORT HAS   @Y30LB38*/ 01215000
*/*                BEEN PRODUCED OR ATTEMPTED.  IF A REPORT  @Y30LB38*/ 01216000
*/*                FAILS, ITS SUMMARY COUNTER IS SET TO HEX  @Y30LB38*/ 01217000
*/*                7FFFFFFF SO THAT THE SUMARY ROUTINE WILL  @ZM00717*/ 01218000
*/*                KNOW OF THE FAILURE.                      @Y30LB38*/ 01219000
*/*                                                          @Y30LB38*/ 01220000
*/*     INPUT - FUNCTION DEFINITION TABLE AND WORK AREA      @Y30LB38*/ 01221000
*/*            CALLED SORTBLK.                               @Y30LB38*/ 01222000
*/*                                                          @Y30LB38*/ 01223000
*/*     OUTPUT - SORTBLK, UPDATED INTTBL AND RETURN CODE     @Y30LB38*/ 01224000
*/*              0 = NO ERRORS                               @Y30LB38*/ 01225000
*/*              8 = AT LEAST ONE REPORT RAN, BUT AT LEAST   @Y30LB38*/ 01226000
*/*                  ONE FAILED                              @Y30LB38*/ 01227000
*/*              12 = NO REPORTS RAN                         @Y30LB38*/ 01228000
*/*                                                          @Y30LB38*/ 01229000
*/********************************************************************/ 01230000
*                                                                  0609 01231000
*RPTSEL:                                                           0609 01232000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 01233000
*                                                                  0609 01234000
RPTSEL   DS    0H                                                  0610 01235000
*   /*****************************************************************/ 01236000
*   /*                                                               */ 01237000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 01238000
*   /*                                                               */ 01239000
*   /*****************************************************************/ 01240000
*                                                                  0610 01241000
*   DCL                                                            0610 01242000
*     RPTCODE FIXED(15);            /* RPTSEL RETURN CODE    @Y30LB38*/ 01243000
*   DCL                                                            0611 01244000
*     NOREPT FIXED(15) INIT('7FFF'X)/* NO REPTS PRINTED      @ZM00717*/ 01245000
*         STATIC;                   /*                       @ZM00717*/ 01246000
*                                                                  0611 01247000
*   /*****************************************************************/ 01248000
*   /*                                                               */ 01249000
*   /* DECLARE VALUES TO BE PUT IN INTTBL FOR TRAN VOLUME    @ZM00717*/ 01250000
*   /*                                                               */ 01251000
*   /*****************************************************************/ 01252000
*                                                                  0612 01253000
*   DCL                                                            0612 01254000
*     TRBLKITM FIXED(31) CONSTANT(84);/* ENTRIES PER BLOCK   @Y30LB38*/ 01255000
*   DCL                                                            0613 01256000
*     TRITMLEN FIXED(8) CONSTANT(24);/* ENTRY LENGTH         @Y30LB38*/ 01257000
*   DCL                                                            0614 01258000
*     TRSRTLEN FIXED(8) CONSTANT(6);/* SORT KEY LENGTH       @Y30LB38*/ 01259000
*   DCL                                                            0615 01260000
*     TRENTLIM FIXED(8) CONSTANT(2);/* ENTRIES PER LINE      @Y30LB38*/ 01261000
*   DCL                                                            0616 01262000
*     TRBUFLIM FIXED(8) CONSTANT(108);/* ENTRIES PER BUFFER  @Y30LB38*/ 01263000
*                                                                  0616 01264000
*   /*****************************************************************/ 01265000
*   /*                                                               */ 01266000
*   /* DECLARE VALUES TO BE PUT IN INTTBL FOR VOL INVENTORY  @Y30LB38*/ 01267000
*   /*                                                               */ 01268000
*   /*****************************************************************/ 01269000
*                                                                  0617 01270000
*   DCL                                                            0617 01271000
*     VIBLKITM FIXED(31) CONSTANT(166);/* ENTRIES PER BLOCK  @Y30LB38*/ 01272000
*   DCL                                                            0618 01273000
*     VIITMLEN FIXED(8) CONSTANT(12);/* ENTRY LENGTH         @Y30LB38*/ 01274000
*   DCL                                                            0619 01275000
*     VISRTLEN FIXED(8) CONSTANT(6);/* SORT KEY LENGTH       @Y30LB38*/ 01276000
*   DCL                                                            0620 01277000
*     VIENTLIM FIXED(8) CONSTANT(3);/* ENTRIES PER LINE      @Y30LB38*/ 01278000
*   DCL                                                            0621 01279000
*     VIBUFLIM FIXED(8) CONSTANT(162);/* ENTRIES PER BUFFER  @Y30LB38*/ 01280000
*                                                                  0621 01281000
*   /*****************************************************************/ 01282000
*   /*                                                               */ 01283000
*   /* DECLARE VALUES TO BE PUT IN INTTBL FOR SCRATCH CART   @Y30LB38*/ 01284000
*   /*                                                               */ 01285000
*   /*****************************************************************/ 01286000
*                                                                  0622 01287000
*   DCL                                                            0622 01288000
*     SCBLKITM FIXED(31) CONSTANT(142);/* ENTRIES PER BLOCK  @Y30LB38*/ 01289000
*   DCL                                                            0623 01290000
*     SCITMLEN FIXED(8) CONSTANT(14);/* ENTRY LENGTH         @Y30LB38*/ 01291000
*   DCL                                                            0624 01292000
*     SCSRTLEN FIXED(8) CONSTANT(12);/* SORT KEY LENGTH      @Y30LB38*/ 01293000
*   DCL                                                            0625 01294000
*     SCENTLIM FIXED(8) CONSTANT(4);/* ENTRIES PER LINE      @Y30LB38*/ 01295000
*   DCL                                                            0626 01296000
*     SCBUFLIM FIXED(8) CONSTANT(216);/* ENTRIES PER BUFFER  @Y30LB38*/ 01297000
*                                                                  0627 01298000
*   /*****************************************************************/ 01299000
*   /*                                                               */ 01300000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 01301000
*   /*                                                               */ 01302000
*   /*****************************************************************/ 01303000
*                                                                  0627 01304000
*   RETADDR1=REG14;                 /*                       @Y30LB38*/ 01305000
         ST    REG14,RETADDR1                                      0627 01306000
*   OLDERID2=NEWERID2;                                             0628 01307000
         L     @15,@PC00001                                        0628 01308000
         L     @15,GDTTR2(,@15)                                    0628 01309000
         MVC   @TS00001(95),NEWERID2(@15)                          0628 01310000
         MVC   OLDERID2(95,@15),@TS00001                           0628 01311000
*   NEWID2='LMCA';                  /*                       @Y30LB38*/ 01312000
         MVC   NEWID2(4,@15),@CC01561                              0629 01313000
*   SORTENT=''B;                    /*                       @Y30LB38*/ 01314000
         SLR   @15,@15                                             0630 01315000
         L     @14,SORTPTR                                         0630 01316000
         ST    @15,SORTENT(,@14)                                   0630 01317000
*   SORTCNT=''B;                    /*                       @Y30LB38*/ 01318000
*                                                                  0631 01319000
         STH   @15,SORTCNT(,@14)                                   0631 01320000
*   /*****************************************************************/ 01321000
*   /*                                                               */ 01322000
*   /* THE CONDITION CODE FOR THIS ROUTINE IS INITIALIZED    @Y30LB38*/ 01323000
*   /* TO '7FFF'X TO INDICATE THAT NO REPORTS HAVE BEEN PRODUCED OR  */ 01324000
*   /* ATTEMPTED YET.                                        @Y30LB38*/ 01325000
*   /*                                                               */ 01326000
*   /*****************************************************************/ 01327000
*                                                                  0632 01328000
*   RPTCODE=NOREPT;                 /*                       @Y30LB38*/ 01329000
         LH    @15,NOREPT                                          0632 01330000
         STH   @15,RPTCODE                                         0632 01331000
*                                                                  0633 01332000
*   /*****************************************************************/ 01333000
*   /*                                                               */ 01334000
*   /* IF THE NMNT, SUM OR ALL KEYWORDS WERE SPECIFIED IN THE FDTTBL,*/ 01335000
*   /* INITIALIZE THE INTTBL FIELDS AND CALL THE REPORT PROCESSOR FOR*/ 01336000
*   /* TRANSIENT VOLUME REPORT.                              @Y30LB38*/ 01337000
*   /*                                                               */ 01338000
*   /*****************************************************************/ 01339000
*                                                                  0633 01340000
*   IF ADDR(NMNT)^=NULLPTR|ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR THEN  01341000
         SLR   @15,@15                                             0633 01342000
         L     @14,@PC00001+4                                      0633 01343000
         C     @15,FDTPTR+12(,@14)                                 0633 01344000
         BNE   @RT00633                                            0633 01345000
         C     @15,FDTPTR+20(,@14)                                 0633 01346000
         BNE   @RT00633                                            0633 01347000
         C     @15,FDTPTR+24(,@14)                                 0633 01348000
         BE    @RF00633                                            0633 01349000
@RT00633 DS    0H                                                  0634 01350000
*     DO;                           /*                       @Y30LB38*/ 01351000
*       TBLID=TRANID;               /*                       @Y30LB38*/ 01352000
         MVI   TBLID,X'02'                                         0635 01353000
*       BLKITEMS=TRBLKITM;          /*                       @Y30LB38*/ 01354000
         MVC   BLKITEMS(4),@CF01541                                0636 01355000
*       ITEMLEN=TRITMLEN;           /*                       @Y30LB38*/ 01356000
         MVI   ITEMLEN,X'18'                                       0637 01357000
*       KEYLEN=TRSRTLEN;            /*                       @ZA08859*/ 01358000
         MVI   KEYLEN,X'06'                                        0638 01359000
*       ENTYLIM=TRENTLIM;           /*                       @Y30LB38*/ 01360000
         MVI   ENTYLIM,X'02'                                       0639 01361000
*       BUFFLIM=TRBUFLIM;           /*                       @Y30LB38*/ 01362000
         MVI   BUFFLIM,X'6C'                                       0640 01363000
*       CALL RPTPROC;               /*                       @Y30LB38*/ 01364000
         BAL   @14,RPTPROC                                         0641 01365000
*       RESPECIFY                                                  0642 01366000
*         RTNREG RSTD;                                             0642 01367000
*       TESTRC=RTNREG;                                             0643 01368000
         LR    TESTRC,RTNREG                                       0643 01369000
*       RESPECIFY                                                  0644 01370000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 01371000
*       RPTCODE=TESTRC;             /*                       @Y30LB38*/ 01372000
*                                                                  0645 01373000
         STH   TESTRC,RPTCODE                                      0645 01374000
*       /*************************************************************/ 01375000
*       /*                                                           */ 01376000
*       /* IF THE CONDITION CODE = 12 AND NMNT OR ALL ARE    @ZM00717*/ 01377000
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */ 01378000
*       /* IDC2821I TO INDICATE REPORT NOT PRODUCED.         @Y30LB38*/ 01379000
*       /*                                                           */ 01380000
*       /*************************************************************/ 01381000
*                                                                  0646 01382000
*       IF TESTRC=LASTCC12&(ADDR(NMNT)^=NULLPTR|ADDR(AL)^=NULLPTR) THEN 01383000
         C     TESTRC,@CF00567                                     0646 01384000
         BNE   @RF00646                                            0646 01385000
         SLR   @02,@02                                             0646 01386000
         L     @15,@PC00001+4                                      0646 01387000
         C     @02,FDTPTR+12(,@15)                                 0646 01388000
         BNE   @RT00646                                            0646 01389000
         C     @02,FDTPTR+24(,@15)                                 0646 01390000
         BE    @RF00646                                            0646 01391000
@RT00646 DS    0H                                                  0647 01392000
*         DO;                       /*                       @Y30LB38*/ 01393000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 01394000
         XC    PRINTAB(84),PRINTAB                                 0648 01395000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 01396000
         L     @02,DDSTRU                                          0649 01397000
         MVC   DARGSMOD(3,@02),@CC01483                            0649 01398000
*           DARGSENT=MS2821I4;      /*                       @Y30LB38*/ 01399000
         MVI   DARGSENT(@02),X'04'                                 0650 01400000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 01401000
         L     @02,@PC00001                                        0651 01402000
         ST    @02,@AL00001                                        0651 01403000
         LA    @15,@CF00116                                        0651 01404000
         ST    @15,@AL00001+4                                      0651 01405000
         LA    @15,DDSTRU                                          0651 01406000
         ST    @15,@AL00001+8                                      0651 01407000
         MVI   @AL00001+8,X'80'                                    0651 01408000
         L     @15,GDTPRT(,@02)                                    0651 01409000
         LA    @01,@AL00001                                        0651 01410000
         BALR  @14,@15                                             0651 01411000
*         END;                      /*                       @Y30LB38*/ 01412000
*                                                                  0652 01413000
*       /*************************************************************/ 01414000
*       /*                                                           */ 01415000
*       /* IF THE CONDITION CODE = 12 AND SUM OR ALL IS      @ZM00717*/ 01416000
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */ 01417000
*       /* IDC2823I TO INDICATE THE SUMMARY COUNT COULD NOT BE       */ 01418000
*       /* CALCULATED.                                       @Y30LB38*/ 01419000
*       /*                                                           */ 01420000
*       /*************************************************************/ 01421000
*                                                                  0653 01422000
*       IF TESTRC=LASTCC12&(ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR)     01423000
*         THEN                                                     0653 01424000
@RF00646 C     TESTRC,@CF00567                                     0653 01425000
         BNE   @RF00653                                            0653 01426000
         SLR   @02,@02                                             0653 01427000
         L     @15,@PC00001+4                                      0653 01428000
         C     @02,FDTPTR+20(,@15)                                 0653 01429000
         BNE   @RT00653                                            0653 01430000
         C     @02,FDTPTR+24(,@15)                                 0653 01431000
         BE    @RF00653                                            0653 01432000
@RT00653 DS    0H                                                  0654 01433000
*         DO;                       /*                       @Y30LB38*/ 01434000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 01435000
         XC    PRINTAB(84),PRINTAB                                 0655 01436000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 01437000
         L     @15,DDSTRU                                          0656 01438000
         MVC   DARGSMOD(3,@15),@CC01483                            0656 01439000
*           DARGSENT=M2823I24;      /*                       @Y30LB38*/ 01440000
         MVI   DARGSENT(@15),X'18'                                 0657 01441000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 01442000
         L     @15,@PC00001                                        0658 01443000
         ST    @15,@AL00001                                        0658 01444000
         LA    @14,@CF00116                                        0658 01445000
         ST    @14,@AL00001+4                                      0658 01446000
         LA    @14,DDSTRU                                          0658 01447000
         ST    @14,@AL00001+8                                      0658 01448000
         MVI   @AL00001+8,X'80'                                    0658 01449000
         L     @15,GDTPRT(,@15)                                    0658 01450000
         LA    @01,@AL00001                                        0658 01451000
         BALR  @14,@15                                             0658 01452000
*           TVCNTR=CNTRVAL;         /*                       @Y30LB38*/ 01453000
         L     @15,CNTRVAL                                         0659 01454000
         ST    @15,TVCNTR                                          0659 01455000
*         END;                      /*                       @Y30LB38*/ 01456000
*                                                                  0660 01457000
*       /*************************************************************/ 01458000
*       /*                                                           */ 01459000
*       /* ISSUE THE URESET MACRO TO CLEAR DATA FROM PREVIOUS        */ 01460000
*       /*                                                   @Y30LB38*/ 01461000
*       /* UESTA.                                            @Y30LB38*/ 01462000
*       /*                                                           */ 01463000
*       /*************************************************************/ 01464000
*                                                                  0661 01465000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB38*/ 01466000
@RF00653 L     @15,@PC00001                                        0661 01467000
         ST    @15,@AL00001                                        0661 01468000
         LA    @14,PRINTME                                         0661 01469000
         ST    @14,@AL00001+4                                      0661 01470000
         MVI   @AL00001+4,X'80'                                    0661 01471000
         L     @15,GDTRES(,@15)                                    0661 01472000
         LA    @01,@AL00001                                        0661 01473000
         BALR  @14,@15                                             0661 01474000
*     END;                          /*                       @Y30LB38*/ 01475000
*                                                                  0663 01476000
*   /*****************************************************************/ 01477000
*   /*                                                               */ 01478000
*   /* IF THE MNT, SUM OR ALL KEYWORDS WERE SPECIFIED IN THE @Y30LB38*/ 01479000
*   /* FDTTBL, INITIALIZE THE INTTBL FIELDS AND CALL THE REPORT      */ 01480000
*   /* PROCESSOR FOR VOLUME INVENTORY REPORT.                @Y30LB38*/ 01481000
*   /*                                                               */ 01482000
*   /*****************************************************************/ 01483000
*                                                                  0663 01484000
*   IF ADDR(MNT)^=NULLPTR|ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR THEN   01485000
@RF00633 SLR   @15,@15                                             0663 01486000
         L     @14,@PC00001+4                                      0663 01487000
         C     @15,FDTPTR+8(,@14)                                  0663 01488000
         BNE   @RT00663                                            0663 01489000
         C     @15,FDTPTR+20(,@14)                                 0663 01490000
         BNE   @RT00663                                            0663 01491000
         C     @15,FDTPTR+24(,@14)                                 0663 01492000
         BE    @RF00663                                            0663 01493000
@RT00663 DS    0H                                                  0664 01494000
*     DO;                           /*                       @Y30LB38*/ 01495000
*       TBLID=VOLINVID;             /*                       @Y30LB38*/ 01496000
         MVI   TBLID,X'03'                                         0665 01497000
*       BLKITEMS=VIBLKITM;          /*                       @Y30LB38*/ 01498000
         MVC   BLKITEMS(4),@CF01548                                0666 01499000
*       ITEMLEN=VIITMLEN;           /*                       @Y30LB38*/ 01500000
         MVI   ITEMLEN,X'0C'                                       0667 01501000
*       KEYLEN=VISRTLEN;            /*                       @ZA08859*/ 01502000
         MVI   KEYLEN,X'06'                                        0668 01503000
*       ENTYLIM=VIENTLIM;           /*                       @Y30LB38*/ 01504000
         MVI   ENTYLIM,X'03'                                       0669 01505000
*       BUFFLIM=VIBUFLIM;           /*                       @Y30LB38*/ 01506000
         MVI   BUFFLIM,X'A2'                                       0670 01507000
*       LASTRK=''B;                 /*                       @Y30LB38*/ 01508000
         XC    LASTRK(5),LASTRK                                    0671 01509000
*       CALL RPTPROC;               /*                       @Y30LB38*/ 01510000
         BAL   @14,RPTPROC                                         0672 01511000
*       RESPECIFY                                                  0673 01512000
*         RTNREG RSTD;                                             0673 01513000
*       TESTRC=RTNREG;                                             0674 01514000
         LR    TESTRC,RTNREG                                       0674 01515000
*       RESPECIFY                                                  0675 01516000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 01517000
*       RPTCODE=TESTRC;             /*                       @Y30LB38*/ 01518000
*                                                                  0676 01519000
         STH   TESTRC,RPTCODE                                      0676 01520000
*       /*************************************************************/ 01521000
*       /*                                                           */ 01522000
*       /* IF THE CONDITION CODE IS SET TO THE INITIAL VALUE,        */ 01523000
*       /*                                                   @Y30LB38*/ 01524000
*       /* INDICATING THAT NO REPORTS HAVE BEEN ATTEMPTED, SET       */ 01525000
*       /* CONDITION CODE TO THE RETURN CODE. IF NOT EQUAL TO THE    */ 01526000
*       /* INITIAL VALUE, AND THE CONDITION CODE IS NOT EQUAL TO THE */ 01527000
*       /* RETURN CODE, INDICATING THAT ONE OF THE REPORTS RAN, SET  */ 01528000
*       /* THE CONDITION CODE TO 8.                          @Y30LB38*/ 01529000
*       /*                                                           */ 01530000
*       /*************************************************************/ 01531000
*                                                                  0677 01532000
*       IF RPTCODE=NOREPT THEN                                     0677 01533000
         LH    @02,RPTCODE                                         0677 01534000
         CH    @02,NOREPT                                          0677 01535000
         BNE   @RF00677                                            0677 01536000
*         RPTCODE=TESTRC;           /*                       @Y30LB38*/ 01537000
         STH   TESTRC,RPTCODE                                      0678 01538000
*       ELSE                                                       0679 01539000
*         IF RPTCODE^=TESTRC THEN                                  0679 01540000
         B     @RC00677                                            0679 01541000
@RF00677 CH    TESTRC,RPTCODE                                      0679 01542000
         BE    @RF00679                                            0679 01543000
*           RPTCODE=LASTCC08;       /*                       @Y30LB38*/ 01544000
*                                                                  0680 01545000
         MVC   RPTCODE(2),@CH00180                                 0680 01546000
*       /*************************************************************/ 01547000
*       /*                                                           */ 01548000
*       /* IF THE CONDITION CODE = 12 AND MNT OR ALL IS      @ZM00717*/ 01549000
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */ 01550000
*       /* IDC2821I TO INDICATE REPORT NOT PRODUCED.         @Y30LB38*/ 01551000
*       /*                                                           */ 01552000
*       /*************************************************************/ 01553000
*                                                                  0681 01554000
*       IF TESTRC=LASTCC12&(ADDR(MNT)^=NULLPTR|ADDR(AL)^=NULLPTR) THEN  01555000
@RF00679 DS    0H                                                  0681 01556000
@RC00677 C     TESTRC,@CF00567                                     0681 01557000
         BNE   @RF00681                                            0681 01558000
         SLR   @02,@02                                             0681 01559000
         L     @15,@PC00001+4                                      0681 01560000
         C     @02,FDTPTR+8(,@15)                                  0681 01561000
         BNE   @RT00681                                            0681 01562000
         C     @02,FDTPTR+24(,@15)                                 0681 01563000
         BE    @RF00681                                            0681 01564000
@RT00681 DS    0H                                                  0682 01565000
*         DO;                       /*                       @Y30LB38*/ 01566000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 01567000
         XC    PRINTAB(84),PRINTAB                                 0683 01568000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 01569000
         L     @02,DDSTRU                                          0684 01570000
         MVC   DARGSMOD(3,@02),@CC01483                            0684 01571000
*           DARGSENT=MS2821I3;      /*                       @Y30LB38*/ 01572000
         MVI   DARGSENT(@02),X'03'                                 0685 01573000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 01574000
         L     @02,@PC00001                                        0686 01575000
         ST    @02,@AL00001                                        0686 01576000
         LA    @15,@CF00116                                        0686 01577000
         ST    @15,@AL00001+4                                      0686 01578000
         LA    @15,DDSTRU                                          0686 01579000
         ST    @15,@AL00001+8                                      0686 01580000
         MVI   @AL00001+8,X'80'                                    0686 01581000
         L     @15,GDTPRT(,@02)                                    0686 01582000
         LA    @01,@AL00001                                        0686 01583000
         BALR  @14,@15                                             0686 01584000
*         END;                      /*                       @Y30LB38*/ 01585000
*                                                                  0687 01586000
*       /*************************************************************/ 01587000
*       /*                                                           */ 01588000
*       /* IF THE CONDITION CODE = 12 AND SUM OR ALL ARE     @Y30LB38*/ 01589000
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */ 01590000
*       /* IDC2823I TO INDICATE THE SUMMARY COUNT COULD NOT BE       */ 01591000
*       /* CALCULATED.                                       @Y30LB38*/ 01592000
*       /*                                                           */ 01593000
*       /*************************************************************/ 01594000
*                                                                  0688 01595000
*       IF TESTRC=LASTCC12&(ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR)     01596000
*         THEN                                                     0688 01597000
@RF00681 C     TESTRC,@CF00567                                     0688 01598000
         BNE   @RF00688                                            0688 01599000
         SLR   @02,@02                                             0688 01600000
         L     @15,@PC00001+4                                      0688 01601000
         C     @02,FDTPTR+20(,@15)                                 0688 01602000
         BNE   @RT00688                                            0688 01603000
         C     @02,FDTPTR+24(,@15)                                 0688 01604000
         BE    @RF00688                                            0688 01605000
@RT00688 DS    0H                                                  0689 01606000
*         DO;                       /*                       @Y30LB38*/ 01607000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 01608000
         XC    PRINTAB(84),PRINTAB                                 0690 01609000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 01610000
         L     @15,DDSTRU                                          0691 01611000
         MVC   DARGSMOD(3,@15),@CC01483                            0691 01612000
*           DARGSENT=M2823I23;      /*                       @Y30LB38*/ 01613000
         MVI   DARGSENT(@15),X'17'                                 0692 01614000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 01615000
         L     @15,@PC00001                                        0693 01616000
         ST    @15,@AL00001                                        0693 01617000
         LA    @14,@CF00116                                        0693 01618000
         ST    @14,@AL00001+4                                      0693 01619000
         LA    @14,DDSTRU                                          0693 01620000
         ST    @14,@AL00001+8                                      0693 01621000
         MVI   @AL00001+8,X'80'                                    0693 01622000
         L     @15,GDTPRT(,@15)                                    0693 01623000
         LA    @01,@AL00001                                        0693 01624000
         BALR  @14,@15                                             0693 01625000
*           VICNTR=CNTRVAL;         /*                       @Y30LB38*/ 01626000
         L     @15,CNTRVAL                                         0694 01627000
         ST    @15,VICNTR                                          0694 01628000
*         END;                      /*                       @Y30LB38*/ 01629000
*                                                                  0695 01630000
*       /*************************************************************/ 01631000
*       /*                                                           */ 01632000
*       /* ISSUE THE URESET MACRO TO CLEAR DATA FROM PREVIOUS        */ 01633000
*       /*                                                   @Y30LB38*/ 01634000
*       /* UESTA.                                            @Y30LB38*/ 01635000
*       /*                                                           */ 01636000
*       /*************************************************************/ 01637000
*                                                                  0696 01638000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB38*/ 01639000
@RF00688 L     @15,@PC00001                                        0696 01640000
         ST    @15,@AL00001                                        0696 01641000
         LA    @14,PRINTME                                         0696 01642000
         ST    @14,@AL00001+4                                      0696 01643000
         MVI   @AL00001+4,X'80'                                    0696 01644000
         L     @15,GDTRES(,@15)                                    0696 01645000
         LA    @01,@AL00001                                        0696 01646000
         BALR  @14,@15                                             0696 01647000
*     END;                          /*                       @Y30LB38*/ 01648000
*                                                                  0698 01649000
*   /*****************************************************************/ 01650000
*   /*                                                               */ 01651000
*   /* IF THE CART, SUM OR ALL KEYWORDS WERE SPECIFIED IN THE FDTTBL,*/ 01652000
*   /* INITIALIZE THE INTTBL FIELDS AND CALL THE REPORT PROCESSOR FOR*/ 01653000
*   /* SCRATCH CARTRIDGE REPORT.                             @Y30LB38*/ 01654000
*   /*                                                               */ 01655000
*   /*****************************************************************/ 01656000
*                                                                  0698 01657000
*   IF ADDR(CART)^=NULLPTR|ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR THEN  01658000
@RF00663 SLR   @15,@15                                             0698 01659000
         L     @14,@PC00001+4                                      0698 01660000
         C     @15,FDTPTR+16(,@14)                                 0698 01661000
         BNE   @RT00698                                            0698 01662000
         C     @15,FDTPTR+20(,@14)                                 0698 01663000
         BNE   @RT00698                                            0698 01664000
         C     @15,FDTPTR+24(,@14)                                 0698 01665000
         BE    @RF00698                                            0698 01666000
@RT00698 DS    0H                                                  0699 01667000
*     DO;                           /*                       @Y30LB38*/ 01668000
*       TBLID=CARTID;               /*                       @Y30LB38*/ 01669000
         MVI   TBLID,X'04'                                         0700 01670000
*       BLKITEMS=SCBLKITM;          /*                       @Y30LB38*/ 01671000
         MVC   BLKITEMS(4),@CF01555                                0701 01672000
*       ITEMLEN=SCITMLEN;           /*                       @Y30LB38*/ 01673000
         MVI   ITEMLEN,X'0E'                                       0702 01674000
*       KEYLEN=SCSRTLEN;            /*                       @ZA08859*/ 01675000
         MVI   KEYLEN,X'0C'                                        0703 01676000
*       ENTYLIM=SCENTLIM;           /*                       @Y30LB38*/ 01677000
         MVI   ENTYLIM,X'04'                                       0704 01678000
*       BUFFLIM=SCBUFLIM;           /*                       @Y30LB38*/ 01679000
         MVI   BUFFLIM,X'D8'                                       0705 01680000
*       LASTRK=''B;                 /*                       @Y30LB38*/ 01681000
         XC    LASTRK(5),LASTRK                                    0706 01682000
*       CALL RPTPROC;               /*                       @Y30LB38*/ 01683000
         BAL   @14,RPTPROC                                         0707 01684000
*       RESPECIFY                                                  0708 01685000
*         RTNREG RSTD;                                             0708 01686000
*       TESTRC=RTNREG;                                             0709 01687000
         LR    TESTRC,RTNREG                                       0709 01688000
*       RESPECIFY                                                  0710 01689000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 01690000
*                                                                  0710 01691000
*       /*************************************************************/ 01692000
*       /*                                                           */ 01693000
*       /* IF THE CONDITION CODE IS SET TO THE INITIAL VALUE,        */ 01694000
*       /*                                                   @Y30LB38*/ 01695000
*       /* INDICATING THAT NO REPORTS HAVE BEEN ATTEMPTED, SET       */ 01696000
*       /* CONDITION CODE TO THE RETURN CODE. IF NOT EQUAL TO THE    */ 01697000
*       /* INITIAL VALUE, AND THE CONDITION CODE IS NOT EQUAL TO THE */ 01698000
*       /* RETURN CODE, INDICATING THAT ONE OF THE REPORTS RAN, SET  */ 01699000
*       /* THE CONDITION CODE TO 8.                          @Y30LB38*/ 01700000
*       /*                                                           */ 01701000
*       /*************************************************************/ 01702000
*                                                                  0711 01703000
*       IF RPTCODE=NOREPT THEN                                     0711 01704000
         CLC   RPTCODE(2),NOREPT                                   0711 01705000
         BNE   @RF00711                                            0711 01706000
*         RPTCODE=TESTRC;           /*                       @Y30LB38*/ 01707000
         STH   TESTRC,RPTCODE                                      0712 01708000
*       ELSE                                                       0713 01709000
*         IF RPTCODE^=TESTRC THEN                                  0713 01710000
         B     @RC00711                                            0713 01711000
@RF00711 CH    TESTRC,RPTCODE                                      0713 01712000
         BE    @RF00713                                            0713 01713000
*           RPTCODE=LASTCC08;       /*                       @Y30LB38*/ 01714000
*                                                                  0714 01715000
         MVC   RPTCODE(2),@CH00180                                 0714 01716000
*       /*************************************************************/ 01717000
*       /*                                                           */ 01718000
*       /* IF THE CONDITION CODE = 12 AND CART AND ALL ARE   @Y30LB38*/ 01719000
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */ 01720000
*       /* IDC2821I TO INDICATE REPORT NOT PRODUCED.         @Y30LB38*/ 01721000
*       /*                                                           */ 01722000
*       /*************************************************************/ 01723000
*                                                                  0715 01724000
*       IF TESTRC=LASTCC12&(ADDR(CART)^=NULLPTR|ADDR(AL)^=NULLPTR) THEN 01725000
@RF00713 DS    0H                                                  0715 01726000
@RC00711 C     TESTRC,@CF00567                                     0715 01727000
         BNE   @RF00715                                            0715 01728000
         SLR   @02,@02                                             0715 01729000
         L     @15,@PC00001+4                                      0715 01730000
         C     @02,FDTPTR+16(,@15)                                 0715 01731000
         BNE   @RT00715                                            0715 01732000
         C     @02,FDTPTR+24(,@15)                                 0715 01733000
         BE    @RF00715                                            0715 01734000
@RT00715 DS    0H                                                  0716 01735000
*         DO;                       /*                       @Y30LB38*/ 01736000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 01737000
         XC    PRINTAB(84),PRINTAB                                 0717 01738000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 01739000
         L     @02,DDSTRU                                          0718 01740000
         MVC   DARGSMOD(3,@02),@CC01483                            0718 01741000
*           DARGSENT=MS2821I2;      /*                       @Y30LB38*/ 01742000
         MVI   DARGSENT(@02),X'02'                                 0719 01743000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 01744000
         L     @02,@PC00001                                        0720 01745000
         ST    @02,@AL00001                                        0720 01746000
         LA    @15,@CF00116                                        0720 01747000
         ST    @15,@AL00001+4                                      0720 01748000
         LA    @15,DDSTRU                                          0720 01749000
         ST    @15,@AL00001+8                                      0720 01750000
         MVI   @AL00001+8,X'80'                                    0720 01751000
         L     @15,GDTPRT(,@02)                                    0720 01752000
         LA    @01,@AL00001                                        0720 01753000
         BALR  @14,@15                                             0720 01754000
*         END;                      /*                       @Y30LB38*/ 01755000
*                                                                  0721 01756000
*       /*************************************************************/ 01757000
*       /*                                                           */ 01758000
*       /* IF THE CONDITION CODE = 12 AND SUM OR ALL ARE     @Y30LB38*/ 01759000
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */ 01760000
*       /* IDC2823I TO INDICATE THE SUMMARY COUNT COULD NOT BE       */ 01761000
*       /* CALCULATED.                                       @Y30LB38*/ 01762000
*       /*                                                           */ 01763000
*       /*************************************************************/ 01764000
*                                                                  0722 01765000
*       IF TESTRC=LASTCC12&(ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR)     01766000
*         THEN                                                     0722 01767000
@RF00715 C     TESTRC,@CF00567                                     0722 01768000
         BNE   @RF00722                                            0722 01769000
         SLR   @02,@02                                             0722 01770000
         L     @15,@PC00001+4                                      0722 01771000
         C     @02,FDTPTR+20(,@15)                                 0722 01772000
         BNE   @RT00722                                            0722 01773000
         C     @02,FDTPTR+24(,@15)                                 0722 01774000
         BE    @RF00722                                            0722 01775000
@RT00722 DS    0H                                                  0723 01776000
*         DO;                       /*                       @Y30LB38*/ 01777000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 01778000
         XC    PRINTAB(84),PRINTAB                                 0724 01779000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 01780000
         L     @15,DDSTRU                                          0725 01781000
         MVC   DARGSMOD(3,@15),@CC01483                            0725 01782000
*           DARGSENT=M2823I22;      /*                       @Y30LB38*/ 01783000
         MVI   DARGSENT(@15),X'16'                                 0726 01784000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 01785000
         L     @15,@PC00001                                        0727 01786000
         ST    @15,@AL00001                                        0727 01787000
         LA    @14,@CF00116                                        0727 01788000
         ST    @14,@AL00001+4                                      0727 01789000
         LA    @14,DDSTRU                                          0727 01790000
         ST    @14,@AL00001+8                                      0727 01791000
         MVI   @AL00001+8,X'80'                                    0727 01792000
         L     @15,GDTPRT(,@15)                                    0727 01793000
         LA    @01,@AL00001                                        0727 01794000
         BALR  @14,@15                                             0727 01795000
*           SCCNTR=CNTRVAL;         /*                       @Y30LB38*/ 01796000
         L     @15,CNTRVAL                                         0728 01797000
         ST    @15,SCCNTR                                          0728 01798000
*         END;                      /*                       @Y30LB38*/ 01799000
*                                                                  0729 01800000
*       /*************************************************************/ 01801000
*       /*                                                           */ 01802000
*       /* ISSUE THE URESET MACRO TO CLEAR DATA FROM PREVIOUS        */ 01803000
*       /*                                                   @Y30LB38*/ 01804000
*       /* UESTA.                                            @Y30LB38*/ 01805000
*       /*                                                           */ 01806000
*       /*************************************************************/ 01807000
*                                                                  0730 01808000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB38*/ 01809000
@RF00722 L     @15,@PC00001                                        0730 01810000
         ST    @15,@AL00001                                        0730 01811000
         LA    @14,PRINTME                                         0730 01812000
         ST    @14,@AL00001+4                                      0730 01813000
         MVI   @AL00001+4,X'80'                                    0730 01814000
         L     @15,GDTRES(,@15)                                    0730 01815000
         LA    @01,@AL00001                                        0730 01816000
         BALR  @14,@15                                             0730 01817000
*     END;                          /*                       @Y30LB38*/ 01818000
*                                                                  0731 01819000
*   /*****************************************************************/ 01820000
*   /*                                                               */ 01821000
*   /* TEST IF SUM OR ALL KEYWORDS WERE SPECIFIED IN THE     @Y30LB38*/ 01822000
*   /* FDTTBL. IF YES, INITIALIZE INTTBL FIELD AND CALL THE SUMARY   */ 01823000
*   /* ROUTINE TO COUNT THE EMPTY CELLS IN THE MSF.          @Y30LB38*/ 01824000
*   /*                                                               */ 01825000
*   /*****************************************************************/ 01826000
*                                                                  0732 01827000
*   IF ADDR(SUMRY)^=NULLPTR|ADDR(AL)^=NULLPTR THEN                 0732 01828000
@RF00698 SLR   @15,@15                                             0732 01829000
         L     @14,@PC00001+4                                      0732 01830000
         C     @15,FDTPTR+20(,@14)                                 0732 01831000
         BNE   @RT00732                                            0732 01832000
         C     @15,FDTPTR+24(,@14)                                 0732 01833000
         BE    @RF00732                                            0732 01834000
@RT00732 DS    0H                                                  0733 01835000
*     DO;                           /*                       @Y30LB38*/ 01836000
*       TBLID=CELLID;               /*                       @Y30LB38*/ 01837000
         MVI   TBLID,X'01'                                         0734 01838000
*       LASTRK=''B;                 /*                       @Y30LB38*/ 01839000
         XC    LASTRK(5),LASTRK                                    0735 01840000
*       CALL SUMARY;                /*                       @Y30LB38*/ 01841000
         BAL   @14,SUMARY                                          0736 01842000
*       RESPECIFY                                                  0737 01843000
*         RTNREG RSTD;                                             0737 01844000
*       TESTRC=RTNREG;                                             0738 01845000
         LR    TESTRC,RTNREG                                       0738 01846000
*       RESPECIFY                                                  0739 01847000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 01848000
*                                                                  0739 01849000
*       /*************************************************************/ 01850000
*       /*                                                           */ 01851000
*       /* IF THE CONDITION CODE IS SET TO THE INITIAL VALUE,        */ 01852000
*       /*                                                   @Y30LB38*/ 01853000
*       /* INDICATING THAT NO REPORTS HAVE BEEN ATTEMPTED, SET       */ 01854000
*       /* CONDITION CODE TO THE RETURN CODE. IF NOT EQUAL TO THE    */ 01855000
*       /* INITIAL VALUE, AND THE CONDITION CODE IS NOT EQUAL TO THE */ 01856000
*       /* RETURN CODE, INDICATING THAT ONE OF THE REPORTS RAN, SET  */ 01857000
*       /* THE CONDITION CODE TO 8.                          @Y30LB38*/ 01858000
*       /*                                                           */ 01859000
*       /*************************************************************/ 01860000
*                                                                  0740 01861000
*       IF RPTCODE=NOREPT THEN                                     0740 01862000
         CLC   RPTCODE(2),NOREPT                                   0740 01863000
         BNE   @RF00740                                            0740 01864000
*         RPTCODE=TESTRC;           /*                       @Y30LB38*/ 01865000
         STH   TESTRC,RPTCODE                                      0741 01866000
*       ELSE                                                       0742 01867000
*         IF RPTCODE^=TESTRC THEN                                  0742 01868000
         B     @RC00740                                            0742 01869000
@RF00740 CH    TESTRC,RPTCODE                                      0742 01870000
         BE    @RF00742                                            0742 01871000
*           RPTCODE=LASTCC08;       /*                       @Y30LB38*/ 01872000
         MVC   RPTCODE(2),@CH00180                                 0743 01873000
*     END;                          /*                       @Y30LB38*/ 01874000
*                                                                  0744 01875000
@RF00742 DS    0H                                                  0744 01876000
@RC00740 DS    0H                                                  0745 01877000
*   /*****************************************************************/ 01878000
*   /*                                                               */ 01879000
*   /* RESTORE RETURN ADDRESS AND RETURN                     @Y30LB38*/ 01880000
*   /*                                                               */ 01881000
*   /*****************************************************************/ 01882000
*                                                                  0745 01883000
*   REG14=RETADDR1;                 /*                       @Y30LB38*/ 01884000
@RF00732 L     REG14,RETADDR1                                      0745 01885000
*   RETURN CODE(RPTCODE);           /*                       @Y30LB38*/ 01886000
         LH    @15,RPTCODE                                         0746 01887000
@EL00003 DS    0H                                                  0746 01888000
@EF00003 DS    0H                                                  0746 01889000
@ER00003 BR    @14                                                 0746 01890000
*   END RPTSEL;                     /*                       @Y30LB38*/ 01891000
*                                                                  0748 01892000
*/********************************************************************/ 01893000
*/*                                                          @Y30LB38*/ 01894000
*/*     PROCEDURE NAME - RPTPROC                             @Y30LB38*/ 01895000
*/*                                                          @Y30LB38*/ 01896000
*/*     FUNCTION - THIS ROUTINE PROCESSES  TRACKS OF A TABLE @Y30LB38*/ 01897000
*/*                AND PRINTS A REPORT.  IT CALLS THE        @Y30LB38*/ 01898000
*/*                READING ROUTINE TO READ A TRACK AND THEN  @Y30LB38*/ 01899000
*/*                CALLS THE BLOCK PROCESSOR TO PROCESS THE  @Y30LB38*/ 01900000
*/*                BLOCKS ON THE TRACK.  WHEN THE TABLE IS   @Y30LB38*/ 01901000
*/*                PROCESSED, IT CALLS THE REPORT PRINTER    @Y30LB38*/ 01902000
*/*                TO PRINT THE REPORT.                      @Y30LB38*/ 01903000
*/*                                                          @Y30LB38*/ 01904000
*/*     INPUT - WORK AREA CALLED SORTBLK                     @Y30LB38*/ 01905000
*/*                                                          @Y30LB38*/ 01906000
*/*     OUTPUT - SORTBLK AND RETURN CODE                     @Y30LB38*/ 01907000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 01908000
*/*              12 = UNSUCCESSFUL COMPLETION                @Y30LB38*/ 01909000
*/*                                                          @Y30LB38*/ 01910000
*/********************************************************************/ 01911000
*                                                                  0748 01912000
*RPTPROC:                                                          0748 01913000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 01914000
*                                                                  0748 01915000
RPTPROC  DS    0H                                                  0749 01916000
*   /*****************************************************************/ 01917000
*   /*                                                               */ 01918000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 01919000
*   /*                                                               */ 01920000
*   /*****************************************************************/ 01921000
*                                                                  0749 01922000
*   DCL                                                            0749 01923000
*     RPTCCODE FIXED(15);           /* RPTPROC RETURN CODE   @Y30LB38*/ 01924000
*                                                                  0750 01925000
*   /*****************************************************************/ 01926000
*   /*                                                               */ 01927000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 01928000
*   /*                                                               */ 01929000
*   /*****************************************************************/ 01930000
*                                                                  0750 01931000
*   RETADDR2=REG14;                 /*                       @Y30LB38*/ 01932000
         ST    REG14,RETADDR2                                      0750 01933000
*   OLDERID2=NEWERID2;                                             0751 01934000
         L     @07,@PC00001                                        0751 01935000
         L     @07,GDTTR2(,@07)                                    0751 01936000
         MVC   @TS00001(95),NEWERID2(@07)                          0751 01937000
         MVC   OLDERID2(95,@07),@TS00001                           0751 01938000
*   NEWID2='LMDA';                  /*                       @Y30LB38*/ 01939000
         MVC   NEWID2(4,@07),@CC01568                              0752 01940000
*   RPTCCODE=''B;                   /*                       @Y30LB38*/ 01941000
*                                                                  0753 01942000
         SLR   RPTCCODE,RPTCCODE                                   0753 01943000
*   /*****************************************************************/ 01944000
*   /*                                                               */ 01945000
*   /* SET UP A DO WHILE LOOP TO CALL THE TRACK READER AND   @Y30LB38*/ 01946000
*   /* THE BLOCK PROCESSOR. CONTINUE IN THE LOOP UNTIL NON-ZERO      */ 01947000
*   /* RETURN CODE IS RETURNED BY ONE OF THE ROUTINES INDICATING AN  */ 01948000
*   /* ERROR OR THE END OF THE DATA                          @Y30LB38*/ 01949000
*   /*                                                               */ 01950000
*   /*****************************************************************/ 01951000
*                                                                  0754 01952000
*   DO WHILE RPTCCODE=LASTCC00;     /*                       @Y30LB38*/ 01953000
         B     @DE00754                                            0754 01954000
@DL00754 DS    0H                                                  0755 01955000
*     CALL TRKRDR;                  /*                       @Y30LB38*/ 01956000
         BAL   @14,TRKRDR                                          0755 01957000
*     RESPECIFY                                                    0756 01958000
*       RTNREG RSTD;                                               0756 01959000
*     TESTRC=RTNREG;                                               0757 01960000
         LR    TESTRC,RTNREG                                       0757 01961000
*     RESPECIFY                                                    0758 01962000
*       RTNREG UNRSTD;              /*                       @Y30LB38*/ 01963000
*     RPTCCODE=TESTRC;              /*                       @Y30LB38*/ 01964000
         LR    RPTCCODE,TESTRC                                     0759 01965000
*     IF RPTCCODE^=LASTCC12 THEN                                   0760 01966000
         C     RPTCCODE,@CF00567                                   0760 01967000
         BE    @RF00760                                            0760 01968000
*       DO;                         /*                       @Y30LB38*/ 01969000
*                                                                  0761 01970000
*         /***********************************************************/ 01971000
*         /*                                                         */ 01972000
*         /* CALL BLKPROC TO PROCESS THE ENTRIES IN A BLOCK  @Y30LB38*/ 01973000
*         /*                                                         */ 01974000
*         /***********************************************************/ 01975000
*                                                                  0762 01976000
*         CALL BLKPROC;             /*                       @Y30LB38*/ 01977000
         BAL   @14,BLKPROC                                         0762 01978000
*         RESPECIFY                                                0763 01979000
*           RTNREG RSTD;                                           0763 01980000
*         TESTRC=RTNREG;                                           0764 01981000
         LR    TESTRC,RTNREG                                       0764 01982000
*         RESPECIFY                                                0765 01983000
*           RTNREG UNRSTD;          /*                       @Y30LB38*/ 01984000
*         RPTCCODE=TESTRC;          /*                       @Y30LB38*/ 01985000
         LR    RPTCCODE,TESTRC                                     0766 01986000
*       END;                        /*                       @Y30LB38*/ 01987000
*   END;                            /*                       @Y30LB38*/ 01988000
*                                                                  0768 01989000
@RF00760 DS    0H                                                  0768 01990000
@DE00754 SLR   @07,@07                                             0768 01991000
         CR    RPTCCODE,@07                                        0768 01992000
         BE    @DL00754                                            0768 01993000
*   /*****************************************************************/ 01994000
*   /*                                                               */ 01995000
*   /* IF THE CONDITION CODE IS NOT 12 AND THE BEGINNING     @Y30LB38*/ 01996000
*   /* OF SORTBLK IS NOT 0, THE SORTING PROCESS IS NOT FINISHED. CALL*/ 01997000
*   /* MRGDATA TO FINISH.                                    @Y30LB38*/ 01998000
*   /*                                                               */ 01999000
*   /*****************************************************************/ 02000000
*                                                                  0769 02001000
*   IF RPTCCODE^=LASTCC12&SORTENT^=ZERO THEN                       0769 02002000
         C     RPTCCODE,@CF00567                                   0769 02003000
         BE    @RF00769                                            0769 02004000
         L     @01,SORTPTR                                         0769 02005000
         C     @07,SORTENT(,@01)                                   0769 02006000
         BE    @RF00769                                            0769 02007000
*     DO;                           /*                       @Y30LB38*/ 02008000
*       CALL MRGDATA;               /*                       @Y30LB38*/ 02009000
         BAL   @14,MRGDATA                                         0771 02010000
*       RESPECIFY                                                  0772 02011000
*         RTNREG RSTD;                                             0772 02012000
*       TESTRC=RTNREG;                                             0773 02013000
         LR    TESTRC,RTNREG                                       0773 02014000
*       RESPECIFY                                                  0774 02015000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 02016000
*       RPTCCODE=TESTRC;            /*                       @Y30LB38*/ 02017000
         LR    RPTCCODE,TESTRC                                     0775 02018000
*     END;                          /*                       @Y30LB38*/ 02019000
*                                                                  0776 02020000
*   /*****************************************************************/ 02021000
*   /*                                                               */ 02022000
*   /* IF THE CONDITION CODE IS NOT 12, CALL HEADSET         @Y30LB38*/ 02023000
*   /* TO ESTABLISH REPORT SUBTITLE LINES.                   @Y30LB38*/ 02024000
*   /*                                                               */ 02025000
*   /*****************************************************************/ 02026000
*                                                                  0777 02027000
*   IF RPTCCODE^=LASTCC12 THEN                                     0777 02028000
@RF00769 C     RPTCCODE,@CF00567                                   0777 02029000
         BE    @RF00777                                            0777 02030000
*     DO;                           /*                       @Y30LB38*/ 02031000
*                                                                  0778 02032000
*       /*************************************************************/ 02033000
*       /*                                                           */ 02034000
*       /* IF VOLUME INVENTORY, TRANSIENT VOLUME, SCRATCH    @Y30LB38*/ 02035000
*       /* CARTRIDGE OR ALL ARE SPECIFIED, CALL HEADSET TO PRINT OUT */ 02036000
*       /* THE SUBTITLE LINES.                               @Y30LB38*/ 02037000
*       /*                                                           */ 02038000
*       /*************************************************************/ 02039000
*                                                                  0779 02040000
*       IF ADDR(AL)^=NULLPTR|ADDR(MNT)^=NULLPTR|ADDR(NMNT)^=NULLPTR|    02041000
*           ADDR(CART)^=NULLPTR THEN                               0779 02042000
         SLR   @07,@07                                             0779 02043000
         L     @15,@PC00001+4                                      0779 02044000
         C     @07,FDTPTR+24(,@15)                                 0779 02045000
         BNE   @RT00779                                            0779 02046000
         C     @07,FDTPTR+8(,@15)                                  0779 02047000
         BNE   @RT00779                                            0779 02048000
         C     @07,FDTPTR+12(,@15)                                 0779 02049000
         BNE   @RT00779                                            0779 02050000
         C     @07,FDTPTR+16(,@15)                                 0779 02051000
         BE    @RF00779                                            0779 02052000
@RT00779 DS    0H                                                  0780 02053000
*         CALL HEADSET;             /*                       @Y30LB38*/ 02054000
*                                                                  0780 02055000
         BAL   @14,HEADSET                                         0780 02056000
*       /*************************************************************/ 02057000
*       /*                                                           */ 02058000
*       /* CALL RPTPRNTR TO PRINT THE REPORT                 @Y30LB38*/ 02059000
*       /*                                                           */ 02060000
*       /*************************************************************/ 02061000
*                                                                  0781 02062000
*       CALL RPTPRNTR;              /*                       @Y30LB38*/ 02063000
@RF00779 BAL   @14,RPTPRNTR                                        0781 02064000
*       LASTRK=CHARZERO;            /*                       @Y30LB38*/ 02065000
         MVC   LASTRK(5),CHARZERO                                  0782 02066000
*     END;                          /*                       @Y30LB38*/ 02067000
*                                                                  0783 02068000
*   /*****************************************************************/ 02069000
*   /*                                                               */ 02070000
*   /* IF AN ERROR HAS NOT OCCURED, SET RETURN CODE TO 0     @Y30LB38*/ 02071000
*   /*                                                               */ 02072000
*   /*****************************************************************/ 02073000
*                                                                  0784 02074000
*   IF RPTCCODE^=LASTCC12 THEN                                     0784 02075000
@RF00777 C     RPTCCODE,@CF00567                                   0784 02076000
         BE    @RF00784                                            0784 02077000
*     RPTCCODE=LASTCC00;            /*                       @Y30LB38*/ 02078000
         SLR   RPTCCODE,RPTCCODE                                   0785 02079000
*   REG14=RETADDR2;                 /*                       @Y30LB38*/ 02080000
@RF00784 L     REG14,RETADDR2                                      0786 02081000
*   RETURN CODE(RPTCCODE);          /*                       @Y30LB38*/ 02082000
         LR    @15,RPTCCODE                                        0787 02083000
@EL00004 DS    0H                                                  0787 02084000
@EF00004 DS    0H                                                  0787 02085000
@ER00004 BR    @14                                                 0787 02086000
*   END RPTPROC;                    /*                       @Y30LB38*/ 02087000
*                                                                  0789 02088000
*/********************************************************************/ 02089000
*/*                                                          @Y30LB38*/ 02090000
*/*     PROCEDURE NAME - MSFLOOK                             @Y30LB38*/ 02091000
*/*                                                          @Y30LB38*/ 02092000
*/*     FUNCTION - THIS ROUTINE COPIES THE MSC TABLES TO     @Y30LB38*/ 02093000
*/*                THE WORK DATA SET AND INSPECTS THE        @Y30LB38*/ 02094000
*/*                CONFIGURATION TABLE TO SEE IF THE         @Y30LB38*/ 02095000
*/*                REQUESTED MSF EXISTS                      @Y30LB38*/ 02096000
*/*                                                          @Y30LB38*/ 02097000
*/*     INPUT - FDTTBL AND WORK AREA CALLED INTTBL           @Y30LB38*/ 02098000
*/*                                                          @Y30LB38*/ 02099000
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Y30LB38*/ 02100000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 02101000
*/*              12 = UNSUCCESSFUL COMPLETION                @Y30LB38*/ 02102000
*/*                                                          @Y30LB38*/ 02103000
*/********************************************************************/ 02104000
*                                                                  0789 02105000
*MSFLOOK:                                                          0789 02106000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 02107000
*                                                                  0789 02108000
MSFLOOK  DS    0H                                                  0790 02109000
*   /*****************************************************************/ 02110000
*   /*                                                               */ 02111000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 02112000
*   /*                                                               */ 02113000
*   /*****************************************************************/ 02114000
*                                                                  0790 02115000
*   DCL                                                            0790 02116000
*     MSFCODE FIXED(15);            /* MSFLOOK RETURN CODE   @Y30LB38*/ 02117000
*   DCL                                                            0791 02118000
*     ECB CHAR(1);                  /* ECB CODE FROM USSC    @Y30LB38*/ 02119000
*   DCL                                                            0792 02120000
*     CARTWORK FIXED(8);            /* COMPUTED TRACK ADDR   @Y30LB38*/ 02121000
*   DCL                                                            0793 02122000
*     CYLWORK FIXED(15);            /* COMPUTED CYL          @Y30LB38*/ 02123000
*   DCL                                                            0794 02124000
*     ECBLEN FIXED(31) CONSTANT(4); /* LENGTH OF ECB         @Y30LB38*/ 02125000
*   DCL                                                            0795 02126000
*     CONFIGNM FIXED(15) CONSTANT(16);/* NUMBER OF 8 BYTE    @Y30LB38   02127000
*                                      ENTRIES IN CONFIG     @Y30LB38   02128000
*                                      RECORD                @Y30LB38*/ 02129000
*                                                                  0795 02130000
*   /*****************************************************************/ 02131000
*   /*                                                               */ 02132000
*   /* DECLARE INDEXES FOR THE TABLE ENTRIES IN THE          @Y30LB38*/ 02133000
*   /* MESSAGE RETURNED FROM USSC.                           @Y30LB38*/ 02134000
*   /*                                                               */ 02135000
*   /*****************************************************************/ 02136000
*                                                                  0796 02137000
*   DCL                                                            0796 02138000
*     CELINDEX FIXED(8) CONSTANT(9);/* CELL MAP INDEX        @Y30LB38*/ 02139000
*   DCL                                                            0797 02140000
*     TRNINDEX FIXED(8) CONSTANT(5);/* TRAN VOL INDEX        @Y30LB38*/ 02141000
*   DCL                                                            0798 02142000
*     VOLINDEX FIXED(8) CONSTANT(4);/* VOL INV INDEX         @Y30LB38*/ 02143000
*   DCL                                                            0799 02144000
*     SCTINDEX FIXED(8) CONSTANT(3);/* SCRATCH CART INDEX    @Y30LB38*/ 02145000
*   DCL                                                            0800 02146000
*     CONINDEX FIXED(8) CONSTANT(7);/* CONFIG MAP INDEX      @Y30LB38*/ 02147000
*                                                                  0801 02148000
*   /*****************************************************************/ 02149000
*   /*                                                               */ 02150000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 02151000
*   /*                                                               */ 02152000
*   /*****************************************************************/ 02153000
*                                                                  0801 02154000
*   RETADDR1=REG14;                 /*                       @Y30LB38*/ 02155000
         ST    REG14,RETADDR1                                      0801 02156000
*   OLDERID2=NEWERID2;                                             0802 02157000
         L     @07,@PC00001                                        0802 02158000
         L     @15,GDTTR2(,@07)                                    0802 02159000
         MVC   @TS00001(95),NEWERID2(@15)                          0802 02160000
         MVC   OLDERID2(95,@15),@TS00001                           0802 02161000
*   NEWID2='LMEA';                  /*                       @Y30LB38*/ 02162000
         MVC   NEWID2(4,@15),@CC01588                              0803 02163000
*   MSFCODE=''B;                    /*                       @Y30LB38*/ 02164000
*                                                                  0804 02165000
         SLR   MSFCODE,MSFCODE                                     0804 02166000
*   /*****************************************************************/ 02167000
*   /*                                                               */ 02168000
*   /* INITIALIZE THE COPY TABLE PARM LIST FOR THE COPY      @Y30LB38*/ 02169000
*   /* TABLE FUNCTION OF THE USSC MACRO.                     @Y30LB38*/ 02170000
*   /*                                                               */ 02171000
*   /*****************************************************************/ 02172000
*                                                                  0805 02173000
*   COTBTID='80'X;                  /*                       @Y30LB38*/ 02174000
         L     @15,COTPTR                                          0805 02175000
         NI    COTBTID(@15),B'10001111'                            0805 02176000
         OI    COTBTID(@15),B'10000000'                            0805 02177000
*   COTBEXTS(1:2)=SCYL;             /*                       @Y30LB38*/ 02178000
         MVC   COTBEXTS(2,@15),SCYL                                0806 02179000
*   COTBEXTS(3:4)=ECYL;             /*                       @Y30LB38*/ 02180000
         MVC   COTBEXTS+2(2,@15),ECYL                              0807 02181000
*   COTBVOL=WRKVOL;                 /*                       @Y30LB38*/ 02182000
*                                                                  0808 02183000
         MVC   COTBVOL(6,@15),WRKVOL                               0808 02184000
*   /*****************************************************************/ 02185000
*   /*                                                               */ 02186000
*   /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        @Y30LB38*/ 02187000
*   /* USSC PARM LIST                                        @Y30LB38*/ 02188000
*   /*                                                               */ 02189000
*   /*****************************************************************/ 02190000
*                                                                  0809 02191000
*   IF GDTDBG=NULLPTR THEN                                         0809 02192000
         L     @07,GDTDBG(,@07)                                    0809 02193000
         LTR   @07,@07                                             0809 02194000
         BZ    @RT00809                                            0809 02195000
*     ;                                                            0810 02196000
*   ELSE                                                           0811 02197000
*     DO;                                                          0811 02198000
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Y30LB38*/ 02199000
         LA    DMPINDEX,DMPSTG                                     0812 02200000
*       DMPITMNM='COTBLIST';                                       0813 02201000
         MVC   DMPITMNM(8,DMPINDEX),@CC01590                       0813 02202000
*       DMPITMPT=ADDR(COTBLIST);                                   0814 02203000
         L     @07,COTPTR                                          0814 02204000
         ST    @07,DMPITMPT(,DMPINDEX)                             0814 02205000
*       DMPITMLN=LENGTH(COTBLIST);                                 0815 02206000
         MVC   DMPITMLN(2,DMPINDEX),@CH00311                       0815 02207000
*       DMPITMTP='H';                                              0816 02208000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0816 02209000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0817 02210000
         AL    DMPINDEX,@CF00475                                   0817 02211000
*       DMPTRM=DMPTRMVL;                                           0818 02212000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0818 02213000
*     END;                          /*                       @Y30LB38*/ 02214000
*   IF GDTDBG=NULLPTR THEN                                         0820 02215000
@RT00809 L     @07,@PC00001                                        0820 02216000
         L     @07,GDTDBG(,@07)                                    0820 02217000
         LTR   @07,@07                                             0820 02218000
         BZ    @RT00820                                            0820 02219000
*     ;                                                            0821 02220000
*   ELSE                                                           0822 02221000
*     CALL IDCDB010(GDTTBL,'LMEB',ADDR(DMPSTG));/*           @Y30LB38*/ 02222000
*                                                                  0822 02223000
         L     @07,@PC00001                                        0822 02224000
         ST    @07,@AL00001                                        0822 02225000
         LA    @15,@CC01591                                        0822 02226000
         ST    @15,@AL00001+4                                      0822 02227000
         LA    @15,DMPSTG                                          0822 02228000
         ST    @15,@AFTEMPS+4                                      0822 02229000
         LA    @15,@AFTEMPS+4                                      0822 02230000
         ST    @15,@AL00001+8                                      0822 02231000
         MVI   @AL00001+8,X'80'                                    0822 02232000
         L     @15,GDTDBG(,@07)                                    0822 02233000
         LA    @01,@AL00001                                        0822 02234000
         BALR  @14,@15                                             0822 02235000
*   /*****************************************************************/ 02236000
*   /*                                                               */ 02237000
*   /* ISSUE THE COPY TABLE OPTION OF THE USSC MACRO TO      @Y30LB38*/ 02238000
*   /* COPY THE DSM TABLES TO THE WORK DATA SET FOR GENERATING THE   */ 02239000
*   /* REPORT(S) REQUIRED.                                   @Y30LB38*/ 02240000
*   /*                                                               */ 02241000
*   /*****************************************************************/ 02242000
*                                                                  0823 02243000
*   CALL IDCSASS0(GDTTBL,COPYTABL,COTPTR,REASONCD,ECB,CTMSGPTR);/* 0823 02244000
*                                                            @Y30LB38*/ 02245000
@RT00820 L     @07,@PC00001                                        0823 02246000
         ST    @07,@AL00001                                        0823 02247000
         LA    @02,COPYTABL                                        0823 02248000
         ST    @02,@AL00001+4                                      0823 02249000
         LA    @02,COTPTR                                          0823 02250000
         ST    @02,@AL00001+8                                      0823 02251000
         LA    @02,REASONCD                                        0823 02252000
         ST    @02,@AL00001+12                                     0823 02253000
         LA    @02,ECB                                             0823 02254000
         ST    @02,@AL00001+16                                     0823 02255000
         LA    @02,CTMSGPTR                                        0823 02256000
         ST    @02,@AL00001+20                                     0823 02257000
         MVI   @AL00001+20,X'80'                                   0823 02258000
         L     @15,GDTSSC(,@07)                                    0823 02259000
         LA    @01,@AL00001                                        0823 02260000
         BALR  @14,@15                                             0823 02261000
*   RESPECIFY                                                      0824 02262000
*     RTNREG RSTD;                                                 0824 02263000
*   TESTRC=RTNREG;                                                 0825 02264000
         LR    TESTRC,RTNREG                                       0825 02265000
*   RESPECIFY                                                      0826 02266000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 02267000
*                                                                  0826 02268000
*   /*****************************************************************/ 02269000
*   /*                                                               */ 02270000
*   /* TEST THE RETURN CODE FROM USSC. IF THE RETURN         @Y30LB38*/ 02271000
*   /* CODE IS 04 CALL SSCMSG TO PRINT OUT MESSAGE TO EXPLAIN THE    */ 02272000
*   /* ERROR. IF THE RETURN CODE IS 04 OR 08 ISSUE THE UPRINT MACRO  */ 02273000
*   /* TO PRINT MESSAGE IDC3820I INDICATING THE TABLES COULD NOT BE  */ 02274000
*   /* COPIED.                                               @Y30LB38*/ 02275000
*   /*                                                               */ 02276000
*   /*****************************************************************/ 02277000
*                                                                  0827 02278000
*   IF TESTRC=4 THEN                                               0827 02279000
         C     TESTRC,@CF00043                                     0827 02280000
         BNE   @RF00827                                            0827 02281000
*     CALL SSCMSG(REASONCD,ECB);    /*                       @ZM01071*/ 02282000
         LA    @07,REASONCD                                        0828 02283000
         ST    @07,@AL00001                                        0828 02284000
         LA    @07,ECB                                             0828 02285000
         ST    @07,@AL00001+4                                      0828 02286000
         LA    @01,@AL00001                                        0828 02287000
         BAL   @14,SSCMSG                                          0828 02288000
*   IF TESTRC=4|TESTRC=8 THEN                                      0829 02289000
@RF00827 C     TESTRC,@CF00043                                     0829 02290000
         BE    @RT00829                                            0829 02291000
         C     TESTRC,@CF00180                                     0829 02292000
         BNE   @RF00829                                            0829 02293000
@RT00829 DS    0H                                                  0830 02294000
*     DO;                           /*                       @Y30LB38*/ 02295000
*       MSFCODE=LASTCC12;           /*                       @Y30LB38*/ 02296000
         LA    MSFCODE,12                                          0831 02297000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 02298000
         XC    PRINTAB(84),PRINTAB                                 0832 02299000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 02300000
         L     @07,DDSTRU                                          0833 02301000
         MVC   DARGSMOD(3,@07),@CC01483                            0833 02302000
*       DARGSENT=MSG3820I;          /*                       @Y30LB38*/ 02303000
         MVI   DARGSENT(@07),X'01'                                 0834 02304000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/ 02305000
         L     @07,@PC00001                                        0835 02306000
         ST    @07,@AL00001                                        0835 02307000
         LA    @15,@CF00116                                        0835 02308000
         ST    @15,@AL00001+4                                      0835 02309000
         LA    @15,DDSTRU                                          0835 02310000
         ST    @15,@AL00001+8                                      0835 02311000
         MVI   @AL00001+8,X'80'                                    0835 02312000
         L     @15,GDTPRT(,@07)                                    0835 02313000
         LA    @01,@AL00001                                        0835 02314000
         BALR  @14,@15                                             0835 02315000
*     END;                          /*                       @Y30LB38*/ 02316000
*                                                                  0836 02317000
*   /*****************************************************************/ 02318000
*   /*                                                               */ 02319000
*   /* THE RETURN CODE FROM USSC IS 0. RETREIVE THE          @Y30LB38*/ 02320000
*   /* TRACK ADDRESS FROM THE MESSAGE AREA AND PLACE THEM IN THE     */ 02321000
*   /* INTTBL WORK AREA.                                     @Y30LB38*/ 02322000
*   /*                                                               */ 02323000
*   /*****************************************************************/ 02324000
*                                                                  0837 02325000
*   ELSE                                                           0837 02326000
*     DO;                           /*                       @Y30LB38*/ 02327000
         B     @RC00829                                            0837 02328000
@RF00829 DS    0H                                                  0838 02329000
*       CTMSGPTR=CTMSGPTR+ECBLEN;   /*                       @Y30LB38*/ 02330000
*                                                                  0838 02331000
         LA    @07,4                                               0838 02332000
         AL    @07,CTMSGPTR                                        0838 02333000
         ST    @07,CTMSGPTR                                        0838 02334000
*       /*************************************************************/ 02335000
*       /*                                                           */ 02336000
*       /* RETREIVE THE TRACK ADDRESS FOR THE CELL MAP       @Y30LB38*/ 02337000
*       /*                                                           */ 02338000
*       /*************************************************************/ 02339000
*                                                                  0839 02340000
*       MAPCC=CTTBLCC(CELINDEX);    /*                       @Y30LB38*/ 02341000
         MVC   MAPCC(1),CTTBLCC+32(@07)                            0839 02342000
*       MAPHH=CTTBLHH(CELINDEX);    /*                       @Y30LB38*/ 02343000
         MVC   MAPHH(1),CTTBLHH+32(@07)                            0840 02344000
*       MAPRR=CTTBLRR(CELINDEX);    /*                       @Y30LB38*/ 02345000
*                                                                  0841 02346000
         MVC   MAPRR(1),CTTBLRR+32(@07)                            0841 02347000
*       /*************************************************************/ 02348000
*       /*                                                           */ 02349000
*       /* RETREIVE THE TRACK ADDRESS FOR THE TRANSIENT      @Y30LB38*/ 02350000
*       /* VOLUME RECORD                                     @Y30LB38*/ 02351000
*       /*                                                           */ 02352000
*       /*************************************************************/ 02353000
*                                                                  0842 02354000
*       TRANCC=CTTBLCC(TRNINDEX);   /*                       @Y30LB38*/ 02355000
         MVC   TRANCC(1),CTTBLCC+16(@07)                           0842 02356000
*       TRANHH=CTTBLHH(TRNINDEX);   /*                       @Y30LB38*/ 02357000
         MVC   TRANHH(1),CTTBLHH+16(@07)                           0843 02358000
*       TRANRR=CTTBLRR(TRNINDEX);   /*                       @Y30LB38*/ 02359000
*                                                                  0844 02360000
         MVC   TRANRR(1),CTTBLRR+16(@07)                           0844 02361000
*       /*************************************************************/ 02362000
*       /*                                                           */ 02363000
*       /* RETREIVE THE TRACK ADDRESS FOR THE VOLUME         @Y30LB38*/ 02364000
*       /* INVENTORY RECORD                                  @Y30LB38*/ 02365000
*       /*                                                           */ 02366000
*       /*************************************************************/ 02367000
*                                                                  0845 02368000
*       VOLCC=CTTBLCC(VOLINDEX);    /*                       @Y30LB38*/ 02369000
         MVC   VOLCC(1),CTTBLCC+12(@07)                            0845 02370000
*       VOLHH=CTTBLHH(VOLINDEX);    /*                       @Y30LB38*/ 02371000
         MVC   VOLHH(1),CTTBLHH+12(@07)                            0846 02372000
*       VOLRR=CTTBLRR(VOLINDEX);    /*                       @Y30LB38*/ 02373000
*                                                                  0847 02374000
         MVC   VOLRR(1),CTTBLRR+12(@07)                            0847 02375000
*       /*************************************************************/ 02376000
*       /*                                                           */ 02377000
*       /* RETREIVE THE TRACK ADDRESS FOR THE SCRATCH        @Y30LB38*/ 02378000
*       /* CARTRIDGE RECORD                                  @Y30LB38*/ 02379000
*       /*                                                           */ 02380000
*       /*************************************************************/ 02381000
*                                                                  0848 02382000
*       CARTCC=CTTBLCC(SCTINDEX);   /*                       @Y30LB38*/ 02383000
*                                                                  0848 02384000
         SLR   @03,@03                                             0848 02385000
         IC    @03,CTTBLCC+8(,@07)                                 0848 02386000
         STC   @03,CARTCC                                          0848 02387000
*       /*************************************************************/ 02388000
*       /*                                                           */ 02389000
*       /* THE SCRATCH CARTRIDGE TRACK ADDRESS MUST BE       @Y30LB38*/ 02390000
*       /* INCREASED BY THE MSF NUMBER (MSFVAL). IF THIS INCREASES   */ 02391000
*       /* THE TRACK NUMBER ABOVE 19 THE CYLINDER NUMBER MUST BE     */ 02392000
*       /* INCREASED.                                        @Y30LB38*/ 02393000
*       /*                                                           */ 02394000
*       /*************************************************************/ 02395000
*                                                                  0849 02396000
*       CARTWORK=CTTBLHH(SCTINDEX)+MSFVAL;/*                 @Y30LB38*/ 02397000
         L     @15,@PC00001+4                                      0849 02398000
         L     @01,FDTPTR+28(,@15)                                 0849 02399000
         SLR   CARTWORK,CARTWORK                                   0849 02400000
         IC    CARTWORK,CTTBLHH+8(,@07)                            0849 02401000
         AL    CARTWORK,MSFVAL(,@01)                               0849 02402000
*       IF CARTWORK>CYLEND THEN                                    0850 02403000
         LA    @07,18                                              0850 02404000
         CR    CARTWORK,@07                                        0850 02405000
         BNH   @RF00850                                            0850 02406000
*         DO;                       /*                       @Y30LB38*/ 02407000
*           CARTCC=CTTBLCC(SCTINDEX)+ONE;/*                  @Y30LB38*/ 02408000
         AL    @03,@CF00220                                        0852 02409000
         STC   @03,CARTCC                                          0852 02410000
*           CARTWORK=CARTWORK-CYLEND;/*                      @Y30LB38*/ 02411000
         SLR   CARTWORK,@07                                        0853 02412000
*         END;                      /*                       @Y30LB38*/ 02413000
*       CARTHH=CARTWORK;            /*                       @Y30LB38*/ 02414000
@RF00850 STC   CARTWORK,CARTHH                                     0855 02415000
*       CARTRR=CTTBLRR(SCTINDEX);   /*                       @Y30LB38*/ 02416000
*                                                                  0856 02417000
         L     @07,CTMSGPTR                                        0856 02418000
         MVC   CARTRR(1),CTTBLRR+8(@07)                            0856 02419000
*       /*************************************************************/ 02420000
*       /*                                                           */ 02421000
*       /* RETREIVE THE TRACK ADDRESS FOR THE CONFIGURATION  @Y30LB38*/ 02422000
*       /* MAP RECORD                                        @Y30LB38*/ 02423000
*       /*                                                           */ 02424000
*       /*************************************************************/ 02425000
*                                                                  0857 02426000
*       CONCC=CTTBLCC(CONINDEX);    /*                       @Y30LB38*/ 02427000
         MVC   CONCC(1),CTTBLCC+24(@07)                            0857 02428000
*       CONHH=CTTBLHH(CONINDEX);    /*                       @Y30LB38*/ 02429000
         MVC   CONHH(1),CTTBLHH+24(@07)                            0858 02430000
*       CONRR=CTTBLRR(CONINDEX);    /*                       @Y30LB38*/ 02431000
*                                                                  0859 02432000
         MVC   CONRR(1),CTTBLRR+24(@07)                            0859 02433000
*       /*************************************************************/ 02434000
*       /*                                                           */ 02435000
*       /* COMPUTE THE CYLINDER DIFFERENCE (ADDRDIF) FROM THE        */ 02436000
*       /*                                                   @Y30LB38*/ 02437000
*       /* ORIGINAL VOLUME TO THE WORK DATA SET VOLUME. THIS IS DONE */ 02438000
*       /* BY SUBTRACTING THE FIRST CYLINDER VALUE OF THE FIRST ENTRY*/ 02439000
*       /* FROM THE FEILD CTREALCC.                          @Y30LB38*/ 02440000
*       /*                                                           */ 02441000
*       /*************************************************************/ 02442000
*                                                                  0860 02443000
*       CYLWORK=CTREALCC-CTTBLCC(ONE);/*                     @Y30LB38*/ 02444000
         SLR   CYLWORK,CYLWORK                                     0860 02445000
         ICM   CYLWORK,3,CTREALCC(@07)                             0860 02446000
         SLR   @03,@03                                             0860 02447000
         IC    @03,CTTBLCC(,@07)                                   0860 02448000
         SLR   CYLWORK,@03                                         0860 02449000
*       ADDRDIF=CYLWORK;            /*                       @Y30LB38*/ 02450000
*                                                                  0861 02451000
         STH   CYLWORK,ADDRDIF                                     0861 02452000
*       /*************************************************************/ 02453000
*       /*                                                           */ 02454000
*       /* RESET THE MESSAGE POINTER TO POINT TO THE ECB AND @Y30LB38*/ 02455000
*       /* ISSUE THE UFSPACE MACRO TO FREE UP THE MESSAGE AREA.      */ 02456000
*       /*                                                   @Y30LB38*/ 02457000
*       /*                                                           */ 02458000
*       /*************************************************************/ 02459000
*                                                                  0862 02460000
*       CTMSGPTR=CTMSGPTR-ECBLEN;   /*                       @Y30LB38*/ 02461000
         SL    @07,@CF00043                                        0862 02462000
         ST    @07,CTMSGPTR                                        0862 02463000
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/*                    @Y30LB38*/ 02464000
         L     @07,@PC00001                                        0863 02465000
         ST    @07,@AL00001                                        0863 02466000
         LA    @15,CTMSGPTR                                        0863 02467000
         ST    @15,@AL00001+4                                      0863 02468000
         L     @15,GDTFSP(,@07)                                    0863 02469000
         LA    @01,@AL00001                                        0863 02470000
         BALR  @14,@15                                             0863 02471000
*       LASTRK=''B;                 /*                       @Y30LB38*/ 02472000
         XC    LASTRK(5),LASTRK                                    0864 02473000
*     END;                          /*                       @Y30LB38*/ 02474000
*                                                                  0865 02475000
*   /*****************************************************************/ 02476000
*   /*                                                               */ 02477000
*   /* IF THE CONDITION IS NOT 12 AND THE USER SPECIFIED     @Y30LB38*/ 02478000
*   /* A MSF NUMBER OTHER THAN ZERO, SET THE TBLID FIELD IN INTTBL   */ 02479000
*   /* AND CALL TRKRDR TO READ THE CONFIGURATION TABLE.      @Y30LB38*/ 02480000
*   /*                                                               */ 02481000
*   /*****************************************************************/ 02482000
*                                                                  0866 02483000
*   IF MSFCODE^=LASTCC12&MSFVAL^=ZERO THEN                         0866 02484000
@RC00829 C     MSFCODE,@CF00567                                    0866 02485000
         BE    @RF00866                                            0866 02486000
         L     @07,@PC00001+4                                      0866 02487000
         L     @07,FDTPTR+28(,@07)                                 0866 02488000
         L     @07,MSFVAL(,@07)                                    0866 02489000
         LTR   @07,@07                                             0866 02490000
         BZ    @RF00866                                            0866 02491000
*     DO;                           /*                       @Y30LB38*/ 02492000
*       TBLID=CONFIGID;             /*                       @Y30LB38*/ 02493000
         MVI   TBLID,X'05'                                         0868 02494000
*       CALL TRKRDR;                /*                       @Y30LB38*/ 02495000
         BAL   @14,TRKRDR                                          0869 02496000
*       RESPECIFY                                                  0870 02497000
*         RTNREG RSTD;                                             0870 02498000
*       TESTRC=RTNREG;                                             0871 02499000
         LR    TESTRC,RTNREG                                       0871 02500000
*       RESPECIFY                                                  0872 02501000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 02502000
*       IF TESTRC=LASTCC12 THEN                                    0873 02503000
         LA    @07,12                                              0873 02504000
         CR    TESTRC,@07                                          0873 02505000
         BNE   @RF00873                                            0873 02506000
*         MSFCODE=LASTCC12;         /*                       @Y30LB38*/ 02507000
         LR    MSFCODE,@07                                         0874 02508000
*       LASTRK=''B;                 /*                       @Y30LB38*/ 02509000
@RF00873 XC    LASTRK(5),LASTRK                                    0875 02510000
*     END;                          /*                       @Y30LB38*/ 02511000
*                                                                  0876 02512000
*   /*****************************************************************/ 02513000
*   /*                                                               */ 02514000
*   /* IF THE CONDITION CODE IS NOT = 12, CHECK THE          @Y30LB38*/ 02515000
*   /* CONFIGURATION TABLE ENTRIES TO VERIFY THAT THE SPECIFIED MSF  */ 02516000
*   /* IS PRESENT.                                           @Y30LB38*/ 02517000
*   /*                                                               */ 02518000
*   /*****************************************************************/ 02519000
*                                                                  0877 02520000
*   BADMSF=ON;                      /*                       @Y30LB38*/ 02521000
@RF00866 OI    BADMSF,B'10000000'                                  0877 02522000
*   IF MSFCODE^=LASTCC12&MSFVAL^=ZERO THEN                         0878 02523000
         C     MSFCODE,@CF00567                                    0878 02524000
         BE    @RF00878                                            0878 02525000
         L     @07,@PC00001+4                                      0878 02526000
         L     @07,FDTPTR+28(,@07)                                 0878 02527000
         L     @07,MSFVAL(,@07)                                    0878 02528000
         LTR   @07,@07                                             0878 02529000
         BZ    @RF00878                                            0878 02530000
*     DO;                           /*                       @Y30LB38*/ 02531000
*       CONFPTR=TRKPTR;             /*                       @Y30LB38*/ 02532000
         L     CONFPTR,TRKPTR                                      0880 02533000
*       DO I=1 BY 1 TO CONFIGNM WHILE BADMSF=ON;/*           @Y30LB38*/ 02534000
         LA    I,1                                                 0881 02535000
@DL00881 TM    BADMSF,B'10000000'                                  0881 02536000
         BNO   @DC00881                                            0881 02537000
*         IF DATASTGR(I)=OFF THEN                                  0882 02538000
         LR    @03,I                                               0882 02539000
         SLA   @03,3                                               0882 02540000
         ST    @03,@TF00001                                        0882 02541000
         ALR   @03,CONFPTR                                         0882 02542000
         TM    DATASTGR-8(@03),B'10000000'                         0882 02543000
         BNZ   @RF00882                                            0882 02544000
*           DO;                     /*                       @Y30LB38*/ 02545000
*             IF MSF1(I)=ON THEN                                   0884 02546000
         LR    @03,CONFPTR                                         0884 02547000
         AL    @03,@TF00001                                        0884 02548000
         TM    MSF1-8(@03),B'00000100'                             0884 02549000
         BNO   @RF00884                                            0884 02550000
*               IF MSFVAL=ONE THEN                                 0885 02551000
         L     @03,@PC00001+4                                      0885 02552000
         L     @03,FDTPTR+28(,@03)                                 0885 02553000
         CLC   MSFVAL(4,@03),@CF00220                              0885 02554000
         BNE   @RF00885                                            0885 02555000
*                 BADMSF=OFF;       /*                       @Y30LB38*/ 02556000
         NI    BADMSF,B'01111111'                                  0886 02557000
*           END;                    /*                       @Y30LB38*/ 02558000
@RF00885 DS    0H                                                  0887 02559000
@RF00884 DS    0H                                                  0888 02560000
*       END;                        /*                       @Y30LB38*/ 02561000
*                                                                  0888 02562000
@RF00882 AL    I,@CF00220                                          0888 02563000
         C     I,@CF00475                                          0888 02564000
         BNH   @DL00881                                            0888 02565000
@DC00881 DS    0H                                                  0889 02566000
*       /*************************************************************/ 02567000
*       /*                                                           */ 02568000
*       /* IF THE SPECIFIED MSF WAS NOT FOUND, WORKFLG1 WILL @Y30LB38*/ 02569000
*       /* BE ON. IF SO, ISSUE UPRINT AND PRINT MESSAGE IDC3822I     */ 02570000
*       /* INDICATING THE MSF IS NOT IN THE SYSTEM AND SET THE RETURN*/ 02571000
*       /* CODE = 12.                                        @Y30LB38*/ 02572000
*       /*                                                           */ 02573000
*       /*************************************************************/ 02574000
*                                                                  0889 02575000
*       IF BADMSF=ON THEN                                          0889 02576000
         TM    BADMSF,B'10000000'                                  0889 02577000
         BNO   @RF00889                                            0889 02578000
*         DO;                       /*                       @Y30LB38*/ 02579000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 02580000
         XC    PRINTAB(84),PRINTAB                                 0891 02581000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 02582000
         L     @07,DDSTRU                                          0892 02583000
         MVC   DARGSMOD(3,@07),@CC01483                            0892 02584000
*           DARGSENT=MSG3822I;      /*                       @Y30LB38*/ 02585000
         MVI   DARGSENT(@07),X'06'                                 0893 02586000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/ 02587000
         L     @07,@PC00001                                        0894 02588000
         ST    @07,@AL00001                                        0894 02589000
         LA    @15,@CF00116                                        0894 02590000
         ST    @15,@AL00001+4                                      0894 02591000
         LA    @15,DDSTRU                                          0894 02592000
         ST    @15,@AL00001+8                                      0894 02593000
         MVI   @AL00001+8,X'80'                                    0894 02594000
         L     @15,GDTPRT(,@07)                                    0894 02595000
         LA    @01,@AL00001                                        0894 02596000
         BALR  @14,@15                                             0894 02597000
*           MSFCODE=LASTCC12;       /*                       @Y30LB38*/ 02598000
         LA    MSFCODE,12                                          0895 02599000
*         END;                      /*                       @Y30LB38*/ 02600000
*     END;                          /*                       @Y30LB38*/ 02601000
*                                                                  0897 02602000
@RF00889 DS    0H                                                  0898 02603000
*   /*****************************************************************/ 02604000
*   /*                                                               */ 02605000
*   /* RESTORE RETURN CODE AND RETURN TO CALLER              @Y30LB38*/ 02606000
*   /*                                                               */ 02607000
*   /*****************************************************************/ 02608000
*                                                                  0898 02609000
*   REG14=RETADDR1;                 /*                       @Y30LB38*/ 02610000
@RF00878 L     REG14,RETADDR1                                      0898 02611000
*   RETURN CODE(MSFCODE);           /*                       @Y30LB38*/ 02612000
         LR    @15,MSFCODE                                         0899 02613000
@EL00005 DS    0H                                                  0899 02614000
@EF00005 DS    0H                                                  0899 02615000
@ER00005 BR    @14                                                 0899 02616000
*   END MSFLOOK;                    /*                       @Y30LB38*/ 02617000
*                                                                  0901 02618000
*/********************************************************************/ 02619000
*/*                                                          @Y30LB38*/ 02620000
*/*     PROCEDURE NAME - TRKRDR                              @Y30LB38*/ 02621000
*/*                                                          @Y30LB38*/ 02622000
*/*     FUNCTION - THIS ROUTINE READS A TRACK FROM THE       @Y30LB38*/ 02623000
*/*                WORK DATA SET INTO THE TRACK BUFFER       @Y30LB38*/ 02624000
*/*                AREA TRKBUFF                              @Y30LB38*/ 02625000
*/*                                                          @Y30LB38*/ 02626000
*/*     INPUT - WORK AREAS CALLED INTTBL AND TRKBUFF         @Y30LB38*/ 02627000
*/*                                                          @Y30LB38*/ 02628000
*/*     OUTPUT - INTTBL, TRKBUFF AND RETURN CODE             @Y30LB38*/ 02629000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 02630000
*/*              12 = UNSUCCESSFUL COMPLETION                @Y30LB38*/ 02631000
*/*                                                          @Y30LB38*/ 02632000
*/********************************************************************/ 02633000
*                                                                  0901 02634000
*TRKRDR:                                                           0901 02635000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 02636000
*                                                                  0901 02637000
TRKRDR   DS    0H                                                  0902 02638000
*   /*****************************************************************/ 02639000
*   /*                                                               */ 02640000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 02641000
*   /*                                                               */ 02642000
*   /*****************************************************************/ 02643000
*                                                                  0902 02644000
*   DCL                                                            0902 02645000
*     TRKCODE FIXED(15);            /* MSFLOOK RETURN CODE   @Y30LB38*/ 02646000
*                                                                  0902 02647000
*   /*****************************************************************/ 02648000
*   /*                                                               */ 02649000
*   /* DECLARE STRUCTURE FOR SEEK ADDRESS                    @Y30LB38*/ 02650000
*   /*                                                               */ 02651000
*   /*****************************************************************/ 02652000
*                                                                  0903 02653000
*   DCL                                                            0903 02654000
*     1 CCHHR,                                                     0903 02655000
*      2 CC FIXED(15),                                             0903 02656000
*      2 HH FIXED(15),                                             0903 02657000
*      2 RR FIXED(8);               /*                       @Y30LB38*/ 02658000
*   DCL                                                            0904 02659000
*     TRKADDR(5) CHAR(5) BASED(ADDR(INTTRKS));/*             @ZM00717*/ 02660000
*                                                                  0905 02661000
*   /*****************************************************************/ 02662000
*   /*                                                               */ 02663000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 02664000
*   /*                                                               */ 02665000
*   /*****************************************************************/ 02666000
*                                                                  0905 02667000
*   RETADDR3=REG14;                 /*                       @Y30LB38*/ 02668000
         ST    REG14,RETADDR3                                      0905 02669000
*   OLDERID2=NEWERID2;                                             0906 02670000
         L     @15,@PC00001                                        0906 02671000
         L     @15,GDTTR2(,@15)                                    0906 02672000
         MVC   @TS00001(95),NEWERID2(@15)                          0906 02673000
         MVC   OLDERID2(95,@15),@TS00001                           0906 02674000
*   NEWID2='LMFA';                  /*                       @Y30LB38*/ 02675000
         MVC   NEWID2(4,@15),@CC01601                              0907 02676000
*   TRKCODE=''B;                    /*                       @Y30LB38*/ 02677000
*                                                                  0908 02678000
         SLR   TRKCODE,TRKCODE                                     0908 02679000
*   /*****************************************************************/ 02680000
*   /*                                                               */ 02681000
*   /* TEST IF THE LASTRK FIELD IN INTTBL = 0. IF YES,       @Y30LB38*/ 02682000
*   /* THIS INDICATES A NEW REPORT IS BEING STARTED SO PICK UP THE   */ 02683000
*   /* BEGINNING ADDRESS OF THE TABLE FROM THE ADDRESSES RETURNED BY */ 02684000
*   /* COPY TABLE.                                           @Y30LB38*/ 02685000
*   /*                                                               */ 02686000
*   /*****************************************************************/ 02687000
*                                                                  0909 02688000
*   IF LASTRK=CHARZERO THEN                                        0909 02689000
         CLC   LASTRK(5),CHARZERO                                  0909 02690000
         BNE   @RF00909                                            0909 02691000
*     DO;                           /*                       @Y30LB38*/ 02692000
*       LASTRK=TRKADDR(TBLID);      /*                       @Y30LB38*/ 02693000
         SLR   @15,@15                                             0911 02694000
         IC    @15,TBLID                                           0911 02695000
         MH    @15,@CH00287                                        0911 02696000
         LA    @14,INTTRKS                                         0911 02697000
         ALR   @14,@15                                             0911 02698000
         AL    @14,@CF01847                                        0911 02699000
         MVC   LASTRK(5),TRKADDR(@14)                              0911 02700000
*     END;                          /*                       @Y30LB38*/ 02701000
*                                                                  0912 02702000
*   /*****************************************************************/ 02703000
*   /*                                                               */ 02704000
*   /* TEST IF THE NEXT-TRACK POINTER IN THE FIRST BLOCK     @Y30LB38*/ 02705000
*   /* IN TRKBUFF = 0. IF YES, THIS INDICATES A VOLUME INVENTORY HASH*/ 02706000
*   /* AREA AND THE LASTRK FIELD IS INCREASED BY ONE AND THE CYL     */ 02707000
*   /* ADDRESS IS INCREASED IF NECESSARY. IF NOT THE HASH AREA, PICK */ 02708000
*   /* UP THE NEXT TRACK POINTER IN THE FIRST BLOCK IN THE TRACK.    */ 02709000
*   /*                                                       @Y30LB38*/ 02710000
*   /*                                                               */ 02711000
*   /*****************************************************************/ 02712000
*                                                                  0913 02713000
*   ELSE                                                           0913 02714000
*     DO;                           /*                       @Y30LB38*/ 02715000
         B     @RC00909                                            0913 02716000
@RF00909 DS    0H                                                  0914 02717000
*       BLOCKPTR=TRKPTR;            /*                       @Y30LB38*/ 02718000
         L     @15,TRKPTR                                          0914 02719000
         ST    @15,BLOCKPTR                                        0914 02720000
*       IF TRACKPTR=CHARZERO(1:4) THEN                             0915 02721000
         CLC   TRACKPTR(4,@15),CHARZERO                            0915 02722000
         BNE   @RF00915                                            0915 02723000
*         DO;                       /*                       @Y30LB38*/ 02724000
*           WORK2=H;                /*                       @Y30LB38*/ 02725000
         SLR   WORK2,WORK2                                         0917 02726000
         ICM   WORK2,3,H                                           0917 02727000
*           WORK2=WORK2+ONE;        /*                       @Y30LB38*/ 02728000
         LA    @03,1                                               0918 02729000
         ALR   WORK2,@03                                           0918 02730000
*           IF WORK2>CYLEND THEN                                   0919 02731000
         C     WORK2,@CF01463                                      0919 02732000
         BNH   @RF00919                                            0919 02733000
*             DO;                   /*                       @Y30LB38*/ 02734000
*               WORK1=C;            /*                       @Y30LB38*/ 02735000
         SLR   @02,@02                                             0921 02736000
         ICM   @02,3,C                                             0921 02737000
         ST    @02,WORK1                                           0921 02738000
*               C=WORK1+ONE;        /*                       @Y30LB38*/ 02739000
         ALR   @02,@03                                             0922 02740000
         STCM  @02,3,C                                             0922 02741000
*               H=CHARZERO;         /*                       @ZM00981*/ 02742000
         MVC   H(2),CHARZERO                                       0923 02743000
*             END;                  /*                       @Y30LB38*/ 02744000
*           ELSE                                                   0925 02745000
*             H=WORK2;              /*                       @Y30LB38*/ 02746000
         B     @RC00919                                            0925 02747000
@RF00919 STCM  WORK2,3,H                                           0925 02748000
*         END;                      /*                       @Y30LB38*/ 02749000
*       ELSE                                                       0927 02750000
*         DO;                       /*                       @Y30LB38*/ 02751000
         B     @RC00915                                            0927 02752000
@RF00915 DS    0H                                                  0928 02753000
*           LASTRK=''B;             /*                       @Y30LB38*/ 02754000
         XC    LASTRK(5),LASTRK                                    0928 02755000
*           C=CYL;                  /*                       @Y30LB38*/ 02756000
         L     @15,BLOCKPTR                                        0929 02757000
         SLR   @14,@14                                             0929 02758000
         IC    @14,CYL(,@15)                                       0929 02759000
         STCM  @14,3,C                                             0929 02760000
*           H=HEAD;                 /*                       @Y30LB38*/ 02761000
         SLR   @14,@14                                             0930 02762000
         IC    @14,HEAD(,@15)                                      0930 02763000
         STCM  @14,3,H                                             0930 02764000
*           R=ONE;                  /*                       @Y30LB38*/ 02765000
         MVI   R,X'01'                                             0931 02766000
*         END;                      /*                       @Y30LB38*/ 02767000
*     END;                          /*                       @Y30LB38*/ 02768000
*                                                                  0933 02769000
@RC00915 DS    0H                                                  0934 02770000
*   /*****************************************************************/ 02771000
*   /*                                                               */ 02772000
*   /* PREPARE THE UEXCP ARGUMENT LIST (EXGARG) AND          @Y30LB38*/ 02773000
*   /* ISSUE THE UEXCP MACRO TO READ IN ONE TRACK OF DATA. FOR THE   */ 02774000
*   /* CONFIGURATION MAP THIS WILL BE ONLY ONE RECORD AND FOR THE    */ 02775000
*   /* CELL MAP IT WILL BE 10 RECORDS. FOR ALL THE REST, IT WILL BE  */ 02776000
*   /* 32 RECORDS.                                           @Y30LB38*/ 02777000
*   /*                                                               */ 02778000
*   /*****************************************************************/ 02779000
*                                                                  0934 02780000
*   EXGCTLBK=WORKPTR;               /*                       @Y30LB38*/ 02781000
@RC00909 L     @15,EXGPTR                                          0934 02782000
         L     @14,WORKPTR                                         0934 02783000
         ST    @14,EXGCTLBK(,@15)                                  0934 02784000
*   CCHHR=LASTRK;                   /*                       @Y30LB38*/ 02785000
         MVC   CCHHR(5),LASTRK                                     0935 02786000
*   CC=C+ADDRDIF;                   /*                       @Y30LB38*/ 02787000
         SLR   @14,@14                                             0936 02788000
         ICM   @14,3,C                                             0936 02789000
         LH    @03,ADDRDIF                                         0936 02790000
         N     @03,@CF01843                                        0936 02791000
         ALR   @14,@03                                             0936 02792000
         STH   @14,CC                                              0936 02793000
*   EXGCCHH1=ADDR(CCHHR);           /*                       @Y30LB38*/ 02794000
         LA    @14,CCHHR                                           0937 02795000
         ST    @14,EXGCCHH1(,@15)                                  0937 02796000
*   EXGCCHH2=ADDR(LASTRK);          /*                       @Y30LB38*/ 02797000
         LA    @14,LASTRK                                          0938 02798000
         ST    @14,EXGCCHH2(,@15)                                  0938 02799000
*   IF TBLID^=CELLID|TBLID^=CONFIGID THEN                          0939 02800000
         CLI   TBLID,1                                             0939 02801000
         BNE   @RT00939                                            0939 02802000
         CLI   TBLID,5                                             0939 02803000
         BE    @RF00939                                            0939 02804000
@RT00939 DS    0H                                                  0940 02805000
*     EXGRECNO=32;                  /*                       @Y30LB38*/ 02806000
         L     @01,EXGPTR                                          0940 02807000
         MVC   EXGRECNO(4,@01),@CF00222                            0940 02808000
*   ELSE                                                           0941 02809000
*     DO;                           /*                       @Y30LB38*/ 02810000
         B     @RC00939                                            0941 02811000
@RF00939 DS    0H                                                  0942 02812000
*       IF TBLID=CELLID THEN                                       0942 02813000
         CLI   TBLID,1                                             0942 02814000
         BNE   @RF00942                                            0942 02815000
*         EXGRECNO=TEN;             /*                       @Y30LB38*/ 02816000
         L     @01,EXGPTR                                          0943 02817000
         MVC   EXGRECNO(4,@01),@CF00445                            0943 02818000
*       ELSE                                                       0944 02819000
*         EXGRECNO=ONE;             /*                       @Y30LB38*/ 02820000
         B     @RC00942                                            0944 02821000
@RF00942 L     @01,EXGPTR                                          0944 02822000
         MVC   EXGRECNO(4,@01),@CF00220                            0944 02823000
*     END;                          /*                       @Y30LB38*/ 02824000
@RC00942 DS    0H                                                  0946 02825000
*   EXGDATAP=ADDR(TRKBUFF);         /*                       @Y30LB38*/ 02826000
@RC00939 L     @02,EXGPTR                                          0946 02827000
         L     @15,TRKPTR                                          0946 02828000
         ST    @15,EXGDATAP(,@02)                                  0946 02829000
*   EXGDATAL=RECSIZE;               /*                       @Y30LB38*/ 02830000
*                                                                  0947 02831000
         MVC   EXGDATAL(2,@02),@CH01464                            0947 02832000
*   /*****************************************************************/ 02833000
*   /*                                                               */ 02834000
*   /* ISSUE THE UEXCP MACRO TO READ IN A TRACK OF DATA      @Y30LB38*/ 02835000
*   /*                                                               */ 02836000
*   /*****************************************************************/ 02837000
*                                                                  0948 02838000
*   CALL IDCIO050(GDTTBL,GET,EXGARG);/*                      @Y30LB38*/ 02839000
         L     @15,@PC00001                                        0948 02840000
         ST    @15,@AL00001                                        0948 02841000
         LA    @14,GET                                             0948 02842000
         ST    @14,@AL00001+4                                      0948 02843000
         ST    @02,@AL00001+8                                      0948 02844000
         MVI   @AL00001+8,X'80'                                    0948 02845000
         L     @15,GDTEXP(,@15)                                    0948 02846000
         LA    @01,@AL00001                                        0948 02847000
         BALR  @14,@15                                             0948 02848000
*   RESPECIFY                                                      0949 02849000
*     RTNREG RSTD;                                                 0949 02850000
*   TESTRC=RTNREG;                                                 0950 02851000
         LR    TESTRC,RTNREG                                       0950 02852000
*   RESPECIFY                                                      0951 02853000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 02854000
*   IF TESTRC^=0 THEN                                              0952 02855000
         LTR   TESTRC,TESTRC                                       0952 02856000
         BZ    @RF00952                                            0952 02857000
*     TRKCODE=LASTCC12;             /*                       @Y30LB38*/ 02858000
*                                                                  0953 02859000
         LA    TRKCODE,12                                          0953 02860000
*   /*****************************************************************/ 02861000
*   /*                                                               */ 02862000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 02863000
*   /*                                                               */ 02864000
*   /*****************************************************************/ 02865000
*                                                                  0954 02866000
*   REG14=RETADDR3;                 /*                       @Y30LB38*/ 02867000
@RF00952 L     REG14,RETADDR3                                      0954 02868000
*   RETURN CODE(TRKCODE);           /*                       @Y30LB38*/ 02869000
         LR    @15,TRKCODE                                         0955 02870000
@EL00006 DS    0H                                                  0955 02871000
@EF00006 DS    0H                                                  0955 02872000
@ER00006 BR    @14                                                 0955 02873000
*   END TRKRDR;                     /*                       @Y30LB38*/ 02874000
*                                                                  0957 02875000
*/********************************************************************/ 02876000
*/*                                                          @Y30LB38*/ 02877000
*/*     PROCEDURE NAME - BLKPROC                             @Y30LB38*/ 02878000
*/*                                                          @Y30LB38*/ 02879000
*/*     FUNCTION - THIS ROUTINE SELECTS BLOCKS FROM TRACKS   @Y30LB38*/ 02880000
*/*                AND PASSES THEM TO SUBORDINATE ROUTINES   @Y30LB38*/ 02881000
*/*                TO PROCESS THE BLOCKS.  IT MAKES SURE     @Y30LB38*/ 02882000
*/*                THAT THE BLOCKS ARE ACTIVE.   IT ALSO     @Y30LB38*/ 02883000
*/*                TESTS FOR THE END-OF-TABLE CONDITIONS     @Y30LB38*/ 02884000
*/*                AND SETS THE CONDITION CODE ACCORDINGLY.  @Y30LB38*/ 02885000
*/*                                                          @Y30LB38*/ 02886000
*/*     INPUT - WORK AREA CALLED TRKBUFF AND THE INTTBL      @Y30LB38*/ 02887000
*/*                                                          @Y30LB38*/ 02888000
*/*     OUTPUT - SORTBLK AND RETURN CODE                     @Y30LB38*/ 02889000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 02890000
*/*              8 = END OF TABLE FOUND                      @Y30LB38*/ 02891000
*/*              12 = NO CORE FOR ENTRY SORTING              @Y30LB38*/ 02892000
*/*                                                          @Y30LB38*/ 02893000
*/********************************************************************/ 02894000
*                                                                  0957 02895000
*BLKPROC:                                                          0957 02896000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 02897000
*                                                                  0957 02898000
BLKPROC  DS    0H                                                  0958 02899000
*   /*****************************************************************/ 02900000
*   /*                                                               */ 02901000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 02902000
*   /*                                                               */ 02903000
*   /*****************************************************************/ 02904000
*                                                                  0958 02905000
*   DCL                                                            0958 02906000
*     BLKCODE FIXED(15);            /* BLKPROC RETURN CODE@Y30LB38   */ 02907000
*   DCL                                                            0959 02908000
*     BLKLENTH FIXED(31) CONSTANT(264);/* LEN OF REC BLK     @Y30LB38*/ 02909000
*   DCL                                                            0960 02910000
*     RECNUM FIXED(15) CONSTANT(32);/* NUM RECS PER TRK      @Y30LB38*/ 02911000
*                                                                  0961 02912000
*   /*****************************************************************/ 02913000
*   /*                                                               */ 02914000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 02915000
*   /*                                                               */ 02916000
*   /*****************************************************************/ 02917000
*                                                                  0961 02918000
*   RETADDR3=REG14;                 /*                       @Y30LB38*/ 02919000
         ST    REG14,RETADDR3                                      0961 02920000
*   OLDERID2=NEWERID2;                                             0962 02921000
         L     @15,@PC00001                                        0962 02922000
         L     @15,GDTTR2(,@15)                                    0962 02923000
         MVC   @TS00001(95),NEWERID2(@15)                          0962 02924000
         MVC   OLDERID2(95,@15),@TS00001                           0962 02925000
*   NEWID2='LMGA';                  /*                       @Y30LB38*/ 02926000
         MVC   NEWID2(4,@15),@CC01608                              0963 02927000
*   BLKCODE=''B;                    /*                       @Y30LB38*/ 02928000
         SLR   @15,@15                                             0964 02929000
         LR    BLKCODE,@15                                         0964 02930000
*   I=''B;                          /*                       @Y30LB38*/ 02931000
         LR    I,@15                                               0965 02932000
*   BLOCKPTR=TRKPTR;                /*                       @Y30LB38*/ 02933000
*                                                                  0966 02934000
         L     @07,TRKPTR                                          0966 02935000
         ST    @07,BLOCKPTR                                        0966 02936000
*   /*****************************************************************/ 02937000
*   /*                                                               */ 02938000
*   /* SET UP DO LOOP TO LOOP THROUGH ALL 32 BLOCKS ON       @Y30LB38*/ 02939000
*   /* A TRACK OR UNTIL THE CONDITION IS NON-ZERO INDICATING A SHORT */ 02940000
*   /* TRACK OF END OF TABLE.                                @Y30LB38*/ 02941000
*   /*                                                               */ 02942000
*   /*****************************************************************/ 02943000
*                                                                  0967 02944000
*   DO I=1 BY 1 TO RECNUM WHILE BLKCODE=ZERO;/*              @Y30LB38*/ 02945000
*                                                                  0967 02946000
         LA    I,1                                                 0967 02947000
@DL00967 LTR   BLKCODE,BLKCODE                                     0967 02948000
         BNZ   @DC00967                                            0967 02949000
*     /***************************************************************/ 02950000
*     /*                                                             */ 02951000
*     /* IF THE NUMENT FIELD IS NON-ZERO INDICATING THAT     @Y30LB38*/ 02952000
*     /* THERE ARE ACTIVE ENTRIES IN THE RECORD, CALL ITMEPROC TO    */ 02953000
*     /* PROCESS THE RECORD BLOCK.                           @Y30LB38*/ 02954000
*     /*                                                             */ 02955000
*     /***************************************************************/ 02956000
*                                                                  0968 02957000
*     IF NUMENT^=ZERO THEN                                         0968 02958000
         L     @01,BLOCKPTR                                        0968 02959000
         CLI   NUMENT(@01),0                                       0968 02960000
         BE    @RF00968                                            0968 02961000
*       DO;                         /*                       @Y30LB38*/ 02962000
*         CALL ITEMPROC;            /*                       @Y30LB38*/ 02963000
         BAL   @14,ITEMPROC                                        0970 02964000
*         RESPECIFY                                                0971 02965000
*           RTNREG RSTD;                                           0971 02966000
*         TESTRC=RTNREG;                                           0972 02967000
         LR    TESTRC,RTNREG                                       0972 02968000
*         RESPECIFY                                                0973 02969000
*           RTNREG UNRSTD;          /*                       @Y30LB38*/ 02970000
*         BLKCODE=TESTRC;           /*                       @Y30LB38*/ 02971000
         LR    BLKCODE,TESTRC                                      0974 02972000
*       END;                        /*                       @Y30LB38*/ 02973000
*                                                                  0975 02974000
*     /***************************************************************/ 02975000
*     /*                                                             */ 02976000
*     /* IF THE RETURN CODE FROM ITEMPROC = 0 CONTINUE       @Y30LB38*/ 02977000
*     /*                                                             */ 02978000
*     /***************************************************************/ 02979000
*                                                                  0976 02980000
*     IF BLKCODE=LASTCC00 THEN                                     0976 02981000
@RF00968 LTR   BLKCODE,BLKCODE                                     0976 02982000
         BNZ   @RF00976                                            0976 02983000
*       DO;                         /*                       @Y30LB38*/ 02984000
*                                                                  0977 02985000
*         /***********************************************************/ 02986000
*         /*                                                         */ 02987000
*         /* TEST THE CONTROL FLAGS TO DETERMINE IF END OF TRACK     */ 02988000
*         /*                                                 @Y30LB38*/ 02989000
*         /* OR END OF TABLE. IF END OF TRACK SET BLKCODE = 4. IF END*/ 02990000
*         /* OF TABLE, WET BLOCK CODE = 8. FOR THE VOLUME INVENTORY  */ 02991000
*         /* TABLE, THE OVERFLOW BIT WILL BE ON FOR THE END OF TRACK */ 02992000
*         /* OR THE END OF THE TABLE. THE FOLLOWING TESTS DETERMINE  */ 02993000
*         /* WHICH CONDITION IS TRUE.                        @Y30LB38*/ 02994000
*         /*                                                         */ 02995000
*         /***********************************************************/ 02996000
*                                                                  0978 02997000
*         IF TBLID=VOLINVID&OVERFLOW=ON THEN                       0978 02998000
         CLI   TBLID,3                                             0978 02999000
         BNE   @RF00978                                            0978 03000000
         L     @15,BLOCKPTR                                        0978 03001000
         TM    OVERFLOW(@15),B'00000001'                           0978 03002000
         BNO   @RF00978                                            0978 03003000
*           DO;                     /*                       @Y30LB38*/ 03004000
*             IF BLKUSED=OFF THEN                                  0980 03005000
         TM    BLKUSED(@15),B'00001000'                            0980 03006000
         BNZ   @RF00980                                            0980 03007000
*               BLKCODE=LASTCC08;   /*                       @Y30LB38*/ 03008000
         LA    BLKCODE,8                                           0981 03009000
*             IF LASTABLK=ON THEN                                  0982 03010000
@RF00980 L     @01,BLOCKPTR                                        0982 03011000
         TM    LASTABLK(@01),B'01000000'                           0982 03012000
         BNO   @RF00982                                            0982 03013000
*               BLKCODE=LASTCC04;   /*                       @Y30LB38*/ 03014000
         LA    BLKCODE,4                                           0983 03015000
*             IF LASTABLK=ON&LASTTRK=ON THEN                       0984 03016000
@RF00982 L     @01,BLOCKPTR                                        0984 03017000
         TM    LASTABLK(@01),B'01010000'                           0984 03018000
         BNO   @RF00984                                            0984 03019000
*               BLKCODE=LASTCC08;   /*                       @Y30LB38*/ 03020000
         LA    BLKCODE,8                                           0985 03021000
*           END;                    /*                       @Y30LB38*/ 03022000
*                                                                  0986 03023000
@RF00984 DS    0H                                                  0987 03024000
*         /***********************************************************/ 03025000
*         /*                                                         */ 03026000
*         /* THE TABLE BEING PROCESSED IS NOT THE VOLUME INVENTORY SO*/ 03027000
*         /* TEST FOR THE END OF TRACK OR THE END OF THE TABLE AND   */ 03028000
*         /* SET THE BLKCODE ACCORDINGLY.                    @Y30LB38*/ 03029000
*         /*                                                         */ 03030000
*         /***********************************************************/ 03031000
*                                                                  0987 03032000
*         IF TBLID^=VOLINVID&(NUMENT=ZERO|LASTABLK=ON) THEN        0987 03033000
@RF00978 CLI   TBLID,3                                             0987 03034000
         BE    @RF00987                                            0987 03035000
         L     @15,BLOCKPTR                                        0987 03036000
         CLI   NUMENT(@15),0                                       0987 03037000
         BE    @RT00987                                            0987 03038000
         TM    LASTABLK(@15),B'01000000'                           0987 03039000
         BNO   @RF00987                                            0987 03040000
@RT00987 DS    0H                                                  0988 03041000
*           DO;                     /*                       @Y30LB38*/ 03042000
*             BLKCODE=LASTCC04;     /*                       @Y30LB38*/ 03043000
         LA    BLKCODE,4                                           0989 03044000
*             IF LASTTRK=ON THEN                                   0990 03045000
         L     @01,BLOCKPTR                                        0990 03046000
         TM    LASTTRK(@01),B'00010000'                            0990 03047000
         BNO   @RF00990                                            0990 03048000
*               BLKCODE=LASTCC08;   /*                       @Y30LB38*/ 03049000
         LA    BLKCODE,8                                           0991 03050000
*           END;                    /*                       @Y30LB38*/ 03051000
@RF00990 DS    0H                                                  0993 03052000
*         BLOCKPTR=BLOCKPTR+BLKLENTH;/*                      @Y30LB38*/ 03053000
@RF00987 LA    @15,264                                             0993 03054000
         AL    @15,BLOCKPTR                                        0993 03055000
         ST    @15,BLOCKPTR                                        0993 03056000
*       END;                        /*                       @Y30LB38*/ 03057000
*   END;                            /*                       @Y30LB38*/ 03058000
*                                                                  0995 03059000
@RF00976 AL    I,@CF00220                                          0995 03060000
         C     I,@CF00222                                          0995 03061000
         BNH   @DL00967                                            0995 03062000
@DC00967 DS    0H                                                  0996 03063000
*   /*****************************************************************/ 03064000
*   /*                                                               */ 03065000
*   /* SET RETURN CODE AND RESTORE RETURN ADDRESS AND        @Y30LB38*/ 03066000
*   /* AND RETURN TO CALLER WITH ZERO RETURN CODE OR END OF TABLE    */ 03067000
*   /* RETURN CODE OR AN ERROR RETURN CODE.                  @Y30LB38*/ 03068000
*   /*                                                               */ 03069000
*   /*****************************************************************/ 03070000
*                                                                  0996 03071000
*   IF BLKCODE=LASTCC04 THEN                                       0996 03072000
         C     BLKCODE,@CF00043                                    0996 03073000
         BNE   @RF00996                                            0996 03074000
*     BLKCODE=LASTCC00;             /*                       @Y30LB38*/ 03075000
         SLR   BLKCODE,BLKCODE                                     0997 03076000
*   REG14=RETADDR3;                 /*                       @Y30LB38*/ 03077000
@RF00996 L     REG14,RETADDR3                                      0998 03078000
*   RETURN CODE(BLKCODE);           /*                       @Y30LB38*/ 03079000
         LR    @15,BLKCODE                                         0999 03080000
@EL00007 DS    0H                                                  0999 03081000
@EF00007 DS    0H                                                  0999 03082000
@ER00007 BR    @14                                                 0999 03083000
*   END BLKPROC;                    /*                       @Y30LB38*/ 03084000
*                                                                  1001 03085000
*/********************************************************************/ 03086000
*/*                                                          @Y30LB38*/ 03087000
*/*     PROCEDURE NAME - ITEMPROC                            @Y30LB38*/ 03088000
*/*                                                          @Y30LB38*/ 03089000
*/*     FUNCTION - THIS ROUTINE PASSES THE ENTRIES FROM A    @Y30LB38*/ 03090000
*/*                BLOCK TO ROUTINES THAT PLACE THE ENTRIES  @Y30LB38*/ 03091000
*/*                IN SORTED SEQUENCE.  THE INPUT IS A       @Y30LB38*/ 03092000
*/*                POINTER TO THE BEGINNING OF THE BLOCK TO  @Y30LB38*/ 03093000
*/*                BE PROCESSED.                             @Y30LB38*/ 03094000
*/*                                                          @Y30LB38*/ 03095000
*/*     INPUT - WORK AREAS CALLED TRKBUFF, INTTBL AND THE    @Y30LB38*/ 03096000
*/*             FDTTBL                                       @Y30LB38*/ 03097000
*/*                                                          @Y30LB38*/ 03098000
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Y30LB38*/ 03099000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 03100000
*/*              12 = NO CORE FOR MERGE                      @Y30LB38*/ 03101000
*/*                                                          @Y30LB38*/ 03102000
*/********************************************************************/ 03103000
*                                                                  1001 03104000
*ITEMPROC:                                                         1001 03105000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 03106000
*                                                                  1001 03107000
ITEMPROC DS    0H                                                  1002 03108000
*   /*****************************************************************/ 03109000
*   /*                                                               */ 03110000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 03111000
*   /*                                                               */ 03112000
*   /*****************************************************************/ 03113000
*                                                                  1002 03114000
*   DCL                                                            1002 03115000
*     ITEMCODE FIXED(15);           /* ITEMPROC RETN CODE    @Y30LB38*/ 03116000
*                                                                  1003 03117000
*   /*****************************************************************/ 03118000
*   /*                                                               */ 03119000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 03120000
*   /*                                                               */ 03121000
*   /*****************************************************************/ 03122000
*                                                                  1003 03123000
*   RETADDR4=REG14;                 /*                       @Y30LB38*/ 03124000
         ST    REG14,RETADDR4                                      1003 03125000
*   OLDERID2=NEWERID2;                                             1004 03126000
         L     @15,@PC00001                                        1004 03127000
         L     @15,GDTTR2(,@15)                                    1004 03128000
         MVC   @TS00001(95),NEWERID2(@15)                          1004 03129000
         MVC   OLDERID2(95,@15),@TS00001                           1004 03130000
*   NEWID2='LMHA';                  /*                       @Y30LB38*/ 03131000
         MVC   NEWID2(4,@15),@CC01614                              1005 03132000
*   ITEMCODE=''B;                   /*                       @Y30LB38*/ 03133000
*                                                                  1006 03134000
         SLR   ITEMCODE,ITEMCODE                                   1006 03135000
*   /*****************************************************************/ 03136000
*   /*                                                               */ 03137000
*   /* SET ADDRESS TO FIRST ENTRY IN BLOCK. SET UP A         @Y30LB38*/ 03138000
*   /* DO LOOP TO PROCESS THE CORRECT NUMBER OF ENTRIES (NUMENT) PER */ 03139000
*   /* BLOCK. INCREASE THE ENTRY POINTER BY THE ENTRY LENGTH(ENTLEN).*/ 03140000
*   /*                                                       @Y30LB38*/ 03141000
*   /*                                                               */ 03142000
*   /*****************************************************************/ 03143000
*                                                                  1007 03144000
*   ENTPTR=ADDR(ENTRYY);            /*                       @Y30LB38*/ 03145000
         L     @01,BLOCKPTR                                        1007 03146000
         LA    @15,ENTRYY(,@01)                                    1007 03147000
         ST    @15,ENTPTR                                          1007 03148000
*   DO I6=1 BY 1 TO NUMENT;         /*                       @Y30LB38*/ 03149000
*                                                                  1008 03150000
         LA    @15,1                                               1008 03151000
         STH   @15,I6                                              1008 03152000
         B     @DE01008                                            1008 03153000
@DL01008 DS    0H                                                  1009 03154000
*     /***************************************************************/ 03155000
*     /*                                                             */ 03156000
*     /* TEST IF THIS IS A VOLUME INVENTORY ENTRY. IF YES,   @Y30LB38*/ 03157000
*     /* TEST IF THE MSF NUMBER IN THE FDTTBL IS THE SAME AS THE MSF */ 03158000
*     /* NUMBER IN THE ENTRY. IF YES, INCREASE VICNTR COUNTER IN THE */ 03159000
*     /* INTTBL PARM LIST. IF MNT OR ALL ARE SPECIFIED IN THE FDTTBL */ 03160000
*     /* CALL THE ITEMFMTR ROUTINE.                          @Y30LB38*/ 03161000
*     /*                                                             */ 03162000
*     /***************************************************************/ 03163000
*                                                                  1009 03164000
*     IF TBLID=VOLINVID THEN                                       1009 03165000
         CLI   TBLID,3                                             1009 03166000
         BNE   @RF01009                                            1009 03167000
*       DO;                         /*                       @Y30LB38*/ 03168000
*                                                                  1010 03169000
*         /***********************************************************/ 03170000
*         /*                                                         */ 03171000
*         /* THE MSF NUMBER IN RECORD IS A 2 BIT FIELD. TEST @Y30LB38*/ 03172000
*         /* EACH BIT TO SEE IF THE MSF NUMBER = 0 OR 1.     @Y30LB38*/ 03173000
*         /*                                                         */ 03174000
*         /***********************************************************/ 03175000
*                                                                  1011 03176000
*         IF(V1L2=ON&MSFVAL=ONE)|(V1L2=OFF&MSFVAL=ZERO) THEN       1011 03177000
         L     @01,ENTPTR                                          1011 03178000
         TM    V1L2(@01),B'01000000'                               1011 03179000
         BNO   @GL00034                                            1011 03180000
         L     @15,@PC00001+4                                      1011 03181000
         L     @01,FDTPTR+28(,@15)                                 1011 03182000
         CLC   MSFVAL(4,@01),@CF00220                              1011 03183000
         BE    @RT01011                                            1011 03184000
@GL00034 L     @01,ENTPTR                                          1011 03185000
         TM    V1L2(@01),B'01000000'                               1011 03186000
         BNZ   @RF01011                                            1011 03187000
         L     @15,@PC00001+4                                      1011 03188000
         L     @01,FDTPTR+28(,@15)                                 1011 03189000
         L     @15,MSFVAL(,@01)                                    1011 03190000
         LTR   @15,@15                                             1011 03191000
         BNZ   @RF01011                                            1011 03192000
@RT01011 DS    0H                                                  1012 03193000
*           DO;                     /*                       @Y30LB38*/ 03194000
*             VICNTR=VICNTR+ONE;    /*                       @Y30LB38*/ 03195000
*                                                                  1013 03196000
         LA    @15,1                                               1013 03197000
         AL    @15,VICNTR                                          1013 03198000
         ST    @15,VICNTR                                          1013 03199000
*             /*******************************************************/ 03200000
*             /*                                                     */ 03201000
*             /* THIS TEST IS TO ELIMINATE THE CALL TO ITEMFMTR IF   */ 03202000
*             /*                                             @Y30LB38*/ 03203000
*             /* THE SUMMARY ONLY KEYWORD IS SPECIFIED. OTHERWISE,   */ 03204000
*             /* CALL ITEMFMTR TO PLACE THE DATA FROM TRKBUFF INTO   */ 03205000
*             /* THE FIELD IN INTTBL CALLED NEWENT.          @Y30LB38*/ 03206000
*             /*                                                     */ 03207000
*             /*******************************************************/ 03208000
*                                                                  1014 03209000
*             IF ADDR(MNT)^=NULLPTR|ADDR(AL)^=NULLPTR THEN         1014 03210000
         SLR   @15,@15                                             1014 03211000
         L     @14,@PC00001+4                                      1014 03212000
         C     @15,FDTPTR+8(,@14)                                  1014 03213000
         BNE   @RT01014                                            1014 03214000
         C     @15,FDTPTR+24(,@14)                                 1014 03215000
         BE    @RF01014                                            1014 03216000
@RT01014 DS    0H                                                  1015 03217000
*               DO;                 /*                       @Y30LB38*/ 03218000
*                 CALL ITEMFMTR;    /*                       @Y30LB38*/ 03219000
         BAL   @14,ITEMFMTR                                        1016 03220000
*                 RESPECIFY                                        1017 03221000
*                   RTNREG RSTD;                                   1017 03222000
*                 TESTRC=RTNREG;                                   1018 03223000
         LR    TESTRC,RTNREG                                       1018 03224000
*                 RESPECIFY                                        1019 03225000
*                   RTNREG UNRSTD;  /*                       @Y30LB38*/ 03226000
*                 ITEMCODE=TESTRC;  /*                       @Y30LB38*/ 03227000
         LR    ITEMCODE,TESTRC                                     1020 03228000
*               END;                /*                       @Y30LB38*/ 03229000
*           END;                    /*                       @Y30LB38*/ 03230000
@RF01014 DS    0H                                                  1023 03231000
*       END;                        /*                       @Y30LB38*/ 03232000
*                                                                  1023 03233000
@RF01011 DS    0H                                                  1024 03234000
*     /***************************************************************/ 03235000
*     /*                                                             */ 03236000
*     /* TEST IF THIS IS A TRANSIENT VOLUME ENTRY. IF YES,   @Y30LB38*/ 03237000
*     /* TEST IF THE MSF NUMBER IN THE FDTTBL IS THE SAME AS THE MSF */ 03238000
*     /* NUMBER IN THE ENTRY. IF YES, INCREASE TVCNTR COUNTER IN THE */ 03239000
*     /* INTTBL PARM LIST. IF NMNT OR ALL ARE SPECIFIED IN THE FDTTBL*/ 03240000
*     /* CALL THE ITEMFMTR ROUTINE.                          @Y30LB38*/ 03241000
*     /*                                                             */ 03242000
*     /***************************************************************/ 03243000
*                                                                  1024 03244000
*     IF TBLID=TRANID THEN                                         1024 03245000
@RF01009 CLI   TBLID,2                                             1024 03246000
         BNE   @RF01024                                            1024 03247000
*       DO;                         /*                       @Y30LB38*/ 03248000
*                                                                  1025 03249000
*         /***********************************************************/ 03250000
*         /*                                                         */ 03251000
*         /* THE MSF NUMBER IN RECORD IS A 2 BIT FIELD. TEST @Y30LB38*/ 03252000
*         /* EACH BIT TO SEE IF THE MSF NUMBER = 0 OR 1.     @Y30LB38*/ 03253000
*         /*                                                         */ 03254000
*         /***********************************************************/ 03255000
*                                                                  1026 03256000
*         IF(T1L2=ON&MSFVAL=ONE)|(T1L2=OFF&MSFVAL=ZERO) THEN       1026 03257000
         L     @01,ENTPTR                                          1026 03258000
         TM    T1L2(@01),B'01000000'                               1026 03259000
         BNO   @GL00038                                            1026 03260000
         L     @15,@PC00001+4                                      1026 03261000
         L     @01,FDTPTR+28(,@15)                                 1026 03262000
         CLC   MSFVAL(4,@01),@CF00220                              1026 03263000
         BE    @RT01026                                            1026 03264000
@GL00038 L     @01,ENTPTR                                          1026 03265000
         TM    T1L2(@01),B'01000000'                               1026 03266000
         BNZ   @RF01026                                            1026 03267000
         L     @15,@PC00001+4                                      1026 03268000
         L     @01,FDTPTR+28(,@15)                                 1026 03269000
         L     @15,MSFVAL(,@01)                                    1026 03270000
         LTR   @15,@15                                             1026 03271000
         BNZ   @RF01026                                            1026 03272000
@RT01026 DS    0H                                                  1027 03273000
*           DO;                     /*                       @Y30LB38*/ 03274000
*             TVCNTR=TVCNTR+ONE;    /*                       @Y30LB38*/ 03275000
*                                                                  1028 03276000
         LA    @15,1                                               1028 03277000
         AL    @15,TVCNTR                                          1028 03278000
         ST    @15,TVCNTR                                          1028 03279000
*             /*******************************************************/ 03280000
*             /*                                                     */ 03281000
*             /* THIS TEST IS TO ELIMINATE THE CALL TO ITEMFMTR IF   */ 03282000
*             /*                                             @Y30LB38*/ 03283000
*             /* THE SUMMARY ONLY KEYWORD IS SPECIFIED. OTHERWISE,   */ 03284000
*             /* CALL ITEMFMTR TO PLACE THE DATA FROM TRKBUFF INTO   */ 03285000
*             /* THE FIELD IN INTTBL CALLED NEWENT.          @Y30LB38*/ 03286000
*             /*                                                     */ 03287000
*             /*******************************************************/ 03288000
*                                                                  1029 03289000
*             IF ADDR(NMNT)^=NULLPTR|ADDR(AL)^=NULLPTR THEN        1029 03290000
         SLR   @15,@15                                             1029 03291000
         L     @14,@PC00001+4                                      1029 03292000
         C     @15,FDTPTR+12(,@14)                                 1029 03293000
         BNE   @RT01029                                            1029 03294000
         C     @15,FDTPTR+24(,@14)                                 1029 03295000
         BE    @RF01029                                            1029 03296000
@RT01029 DS    0H                                                  1030 03297000
*               DO;                 /*                       @Y30LB38*/ 03298000
*                 CALL ITEMFMTR;    /*                       @Y30LB38*/ 03299000
         BAL   @14,ITEMFMTR                                        1031 03300000
*                 RESPECIFY                                        1032 03301000
*                   RTNREG RSTD;                                   1032 03302000
*                 TESTRC=RTNREG;                                   1033 03303000
         LR    TESTRC,RTNREG                                       1033 03304000
*                 RESPECIFY                                        1034 03305000
*                   RTNREG UNRSTD;  /*                       @Y30LB38*/ 03306000
*                 ITEMCODE=TESTRC;  /*                       @Y30LB38*/ 03307000
         LR    ITEMCODE,TESTRC                                     1035 03308000
*               END;                /*                       @Y30LB38*/ 03309000
*           END;                    /*                       @Y30LB38*/ 03310000
@RF01029 DS    0H                                                  1038 03311000
*       END;                        /*                       @Y30LB38*/ 03312000
*                                                                  1038 03313000
@RF01026 DS    0H                                                  1039 03314000
*     /***************************************************************/ 03315000
*     /*                                                             */ 03316000
*     /* IF THE ENTRY IS A SCRATCH CARTRIDGE LIST ADD 1 TO   @Y30LB38*/ 03317000
*     /* THE SCCNTR COUNTER IN THE INTTBL PARM LIST. IF CART OR ALL  */ 03318000
*     /* ARE SPECIFIED IN THE FDTTBL, CALL THE ITEMFMTR ROUTINE.     */ 03319000
*     /*                                                     @Y30LB38*/ 03320000
*     /*                                                             */ 03321000
*     /***************************************************************/ 03322000
*                                                                  1039 03323000
*     IF TBLID=CARTID THEN                                         1039 03324000
@RF01024 CLI   TBLID,4                                             1039 03325000
         BNE   @RF01039                                            1039 03326000
*       DO;                         /*                       @Y30LB38*/ 03327000
*         SCCNTR=SCCNTR+ONE;        /*                       @Y30LB38*/ 03328000
*                                                                  1041 03329000
         LA    @15,1                                               1041 03330000
         AL    @15,SCCNTR                                          1041 03331000
         ST    @15,SCCNTR                                          1041 03332000
*         /***********************************************************/ 03333000
*         /*                                                         */ 03334000
*         /* THIS TEST IS TO ELIMINATE THE CALL TO ITEMFMTR IF       */ 03335000
*         /*                                                 @Y30LB38*/ 03336000
*         /* THE SUMMARY ONLY KEYWORD IS SPECIFIED. OTHERWISE, CALL  */ 03337000
*         /* ITEMFMTR TO PLACE THE DATA FROM TRKBUFF INTO THE FIELD  */ 03338000
*         /* IN INTTBL CALLED NEWENT.                        @Y30LB38*/ 03339000
*         /*                                                         */ 03340000
*         /***********************************************************/ 03341000
*                                                                  1042 03342000
*         IF ADDR(CART)^=NULLPTR|ADDR(AL)^=NULLPTR THEN            1042 03343000
         SLR   @15,@15                                             1042 03344000
         L     @14,@PC00001+4                                      1042 03345000
         C     @15,FDTPTR+16(,@14)                                 1042 03346000
         BNE   @RT01042                                            1042 03347000
         C     @15,FDTPTR+24(,@14)                                 1042 03348000
         BE    @RF01042                                            1042 03349000
@RT01042 DS    0H                                                  1043 03350000
*           DO;                     /*                       @Y30LB38*/ 03351000
*             CALL ITEMFMTR;        /*                       @Y30LB38*/ 03352000
         BAL   @14,ITEMFMTR                                        1044 03353000
*             RESPECIFY                                            1045 03354000
*               RTNREG RSTD;                                       1045 03355000
*             TESTRC=RTNREG;                                       1046 03356000
         LR    TESTRC,RTNREG                                       1046 03357000
*             RESPECIFY                                            1047 03358000
*               RTNREG UNRSTD;      /*                       @Y30LB38*/ 03359000
*             ITEMCODE=TESTRC;      /*                       @Y30LB38*/ 03360000
         LR    ITEMCODE,TESTRC                                     1048 03361000
*           END;                    /*                       @Y30LB38*/ 03362000
*       END;                        /*                       @Y30LB38*/ 03363000
@RF01042 DS    0H                                                  1051 03364000
*     ENTPTR=ENTPTR+ENTLEN;         /*                       @Y30LB38*/ 03365000
@RF01039 L     @01,BLOCKPTR                                        1051 03366000
         SLR   @00,@00                                             1051 03367000
         IC    @00,ENTLEN(,@01)                                    1051 03368000
         AL    @00,ENTPTR                                          1051 03369000
         ST    @00,ENTPTR                                          1051 03370000
*   END;                            /*                       @Y30LB38*/ 03371000
*                                                                  1052 03372000
         LA    @15,1                                               1052 03373000
         AH    @15,I6                                              1052 03374000
         STH   @15,I6                                              1052 03375000
@DE01008 L     @14,BLOCKPTR                                        1052 03376000
         SLR   @03,@03                                             1052 03377000
         IC    @03,NUMENT(,@14)                                    1052 03378000
         CR    @15,@03                                             1052 03379000
         BNH   @DL01008                                            1052 03380000
*   /*****************************************************************/ 03381000
*   /*                                                               */ 03382000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 03383000
*   /*                                                               */ 03384000
*   /*****************************************************************/ 03385000
*                                                                  1053 03386000
*   REG14=RETADDR4;                 /*                       @Y30LB38*/ 03387000
         L     REG14,RETADDR4                                      1053 03388000
*   RETURN CODE(ITEMCODE);          /*                       @Y30LB38*/ 03389000
         LR    @15,ITEMCODE                                        1054 03390000
@EL00008 DS    0H                                                  1054 03391000
@EF00008 DS    0H                                                  1054 03392000
@ER00008 BR    @14                                                 1054 03393000
*   END ITEMPROC;                   /*                       @Y30LB38*/ 03394000
*                                                                  1056 03395000
*/********************************************************************/ 03396000
*/*                                                          @Y30LB38*/ 03397000
*/*     PROCEDURE NAME - ITEMFMTR                            @Y30LB38*/ 03398000
*/*                                                          @Y30LB38*/ 03399000
*/*     FUNCTION - THIS ROUTINE REFORMATS A BLOCK ENTRY      @Y30LB38*/ 03400000
*/*                AND CALLS ON SUBPROCEDURES TO SORT IT     @Y30LB38*/ 03401000
*/*                INTO THE CORE BLOCKS.                     @Y30LB38*/ 03402000
*/*                                                          @Y30LB38*/ 03403000
*/*     INPUT - WORK AREA CALLED TRKBUFF AND THE INTTBL      @Y30LB38*/ 03404000
*/*                                                          @Y30LB38*/ 03405000
*/*     OUTPUT - REFORMATED ENTRY PLACED IN NEWENT AND       @Y30LB38*/ 03406000
*/*              RETURN CODE                                 @Y30LB38*/ 03407000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 03408000
*/*              12 = NO CORE FOR ENTRY MERGE                @Y30LB38*/ 03409000
*/*                                                          @Y30LB38*/ 03410000
*/********************************************************************/ 03411000
*                                                                  1056 03412000
*ITEMFMTR:                                                         1056 03413000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 03414000
*                                                                  1056 03415000
ITEMFMTR DS    0H                                                  1057 03416000
*   /*****************************************************************/ 03417000
*   /*                                                               */ 03418000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 03419000
*   /*                                                               */ 03420000
*   /*****************************************************************/ 03421000
*                                                                  1057 03422000
*   DCL                                                            1057 03423000
*     FMTRCODE FIXED(15);           /* ITEMFMTR RETN CODE    @Y30LB38*/ 03424000
*                                                                  1057 03425000
*   /*****************************************************************/ 03426000
*   /*                                                               */ 03427000
*   /* DECLARE DSECT FOR MAPPING THE TRANSIENT VOLUME        @Y30LB38*/ 03428000
*   /* DATA IN THE FIELD NEWENT.                             @Y30LB38*/ 03429000
*   /*                                                               */ 03430000
*   /*****************************************************************/ 03431000
*                                                                  1058 03432000
*   DCL                                                            1058 03433000
*     1 TVNEWENT DEF(NEWENT),       /*                       @Y30LB38*/ 03434000
*       3 TVVOLSN CHAR(6),          /* VOL SER NUMBER        @Y30LB38*/ 03435000
*       3 TVCARTSN CHAR(12),        /* CART SER NUMBER       @Y30LB38*/ 03436000
*       3 TVCART1 CHAR(2),          /* CART 1 LOCATION       @Y30LB38*/ 03437000
*       3 TVCART2 CHAR(2),          /* CART 2 LOCATION       @Y30LB38*/ 03438000
*       3 TVFLAGS CHAR(1),          /* ATTRIBUTE FLAGS       @Y30LB38*/ 03439000
*       3 * CHAR(1);                /*                       @Y30LB38*/ 03440000
*                                                                  1058 03441000
*   /*****************************************************************/ 03442000
*   /*                                                               */ 03443000
*   /* DECLARE DSECT FOR MAPPING THE SCRATCH CARTRIDGE       @Y30LB38*/ 03444000
*   /* DATA IN THE FIELD NEWENT.                             @Y30LB38*/ 03445000
*   /*                                                               */ 03446000
*   /*****************************************************************/ 03447000
*                                                                  1059 03448000
*   DCL                                                            1059 03449000
*     1 SCNEWENT DEF(NEWENT),       /*                       @Y30LB38*/ 03450000
*       3 SCCARTSN CHAR(12),        /* CART SER NUMBER       @Y30LB38*/ 03451000
*       3 SCCART1 CHAR(2),          /* CART LOCATION         @Y30LB38*/ 03452000
*       3 * CHAR(10);               /*                       @Y30LB38*/ 03453000
*                                                                  1060 03454000
*   /*****************************************************************/ 03455000
*   /*                                                               */ 03456000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 03457000
*   /*                                                               */ 03458000
*   /*****************************************************************/ 03459000
*                                                                  1060 03460000
*   RETADDR5=REG14;                 /*                       @Y30LB38*/ 03461000
         ST    REG14,RETADDR5                                      1060 03462000
*   OLDERID2=NEWERID2;                                             1061 03463000
         L     @15,@PC00001                                        1061 03464000
         L     @15,GDTTR2(,@15)                                    1061 03465000
         MVC   @TS00001(95),NEWERID2(@15)                          1061 03466000
         MVC   OLDERID2(95,@15),@TS00001                           1061 03467000
*   NEWID2='LMIA';                  /*                       @Y30LB38*/ 03468000
         MVC   NEWID2(4,@15),@CC01631                              1062 03469000
*   FMTRCODE=''B;                   /*                       @Y30LB38*/ 03470000
*                                                                  1063 03471000
         SLR   FMTRCODE,FMTRCODE                                   1063 03472000
*   /*****************************************************************/ 03473000
*   /*                                                               */ 03474000
*   /* IF THE TBLID FIELD INDICATES A VOLUME INVENTORY       @Y30LB38*/ 03475000
*   /* ENTRY, MOVE THE ENTIRE ENTRY INTO THE NEWENT FIELD IN INTTBL  */ 03476000
*   /* PARM LIST.                                            @Y30LB38*/ 03477000
*   /*                                                               */ 03478000
*   /*****************************************************************/ 03479000
*                                                                  1064 03480000
*   IF TBLID=VOLINVID THEN                                         1064 03481000
         CLI   TBLID,3                                             1064 03482000
         BNE   @RF01064                                            1064 03483000
*     NEWENT=INVENTRY;              /*                       @Y30LB38*/ 03484000
*                                                                  1065 03485000
         MVI   NEWENT+12,C' '                                      1065 03486000
         MVC   NEWENT+13(11),NEWENT+12                             1065 03487000
         L     @06,ENTPTR                                          1065 03488000
         MVC   NEWENT(12),INVENTRY(@06)                            1065 03489000
*   /*****************************************************************/ 03490000
*   /*                                                               */ 03491000
*   /* IF THE TBLID FIELD INDICATES A TRANSIENT VOLUME       @Y30LB38*/ 03492000
*   /* ENTRY, MOVE THE VOLID, THE CARTRIDGE SERIAL NUMBER THE CELL   */ 03493000
*   /* LOCATIONS AND THE ATTRIBUTE FLAGS INTO THE NEWENT FIELD IN    */ 03494000
*   /* INTTBL PARM LIST.                                     @Y30LB38*/ 03495000
*   /*                                                               */ 03496000
*   /*****************************************************************/ 03497000
*                                                                  1066 03498000
*   IF TBLID=TRANID THEN                                           1066 03499000
@RF01064 CLI   TBLID,2                                             1066 03500000
         BNE   @RF01066                                            1066 03501000
*     DO;                           /*                       @Y30LB38*/ 03502000
*       TVVOLSN=TVOLSER;            /*                       @Y30LB38*/ 03503000
         L     @06,ENTPTR                                          1068 03504000
         MVC   TVVOLSN(6),TVOLSER(@06)                             1068 03505000
*       TVCARTSN=TCARSNUM;          /*                       @Y30LB38*/ 03506000
         MVC   TVCARTSN(12),TCARSNUM(@06)                          1069 03507000
*       TVCART1=TCARTONE;           /*                       @Y30LB38*/ 03508000
         MVC   TVCART1(2),TCARTONE(@06)                            1070 03509000
*       TVCART2=TCARTTWO;           /*                       @Y30LB38*/ 03510000
         MVC   TVCART2(2),TCARTTWO(@06)                            1071 03511000
*       TVFLAGS=TVOLFLGS;           /*                       @Y30LB38*/ 03512000
         MVC   TVFLAGS(1),TVOLFLGS(@06)                            1072 03513000
*     END;                          /*                       @Y30LB38*/ 03514000
*                                                                  1073 03515000
*   /*****************************************************************/ 03516000
*   /*                                                               */ 03517000
*   /* IF THE TBLID FIELD INDICATES A SCRATCH CARTRIDGE      @Y30LB38*/ 03518000
*   /* LIST ENTRY, MOVE THE CARTRIDGE SERIAL NUMBER AND THE CELL     */ 03519000
*   /* LOCATION INTO THE NEWENT FIELD IN INTTBL PARM LIST.   @Y30LB38*/ 03520000
*   /*                                                               */ 03521000
*   /*****************************************************************/ 03522000
*                                                                  1074 03523000
*   IF TBLID=CARTID THEN                                           1074 03524000
@RF01066 CLI   TBLID,4                                             1074 03525000
         BNE   @RF01074                                            1074 03526000
*     DO;                           /*                       @Y30LB38*/ 03527000
*       SCCARTSN=SCARTNUM;          /*                       @Y30LB38*/ 03528000
         L     @06,ENTPTR                                          1076 03529000
         MVC   SCCARTSN(12),SCARTNUM(@06)                          1076 03530000
*       SCCART1=SCARTONE;           /*                       @Y30LB38*/ 03531000
         MVC   SCCART1(2),SCARTONE(@06)                            1077 03532000
*     END;                          /*                       @Y30LB38*/ 03533000
*                                                                  1078 03534000
*   /*****************************************************************/ 03535000
*   /*                                                               */ 03536000
*   /* CALL SORTDATA TO SORT THE ENTRIES IN THE SORTBLK      @Y30LB38*/ 03537000
*   /*                                                               */ 03538000
*   /*****************************************************************/ 03539000
*                                                                  1079 03540000
*   CALL SORTDATA;                  /*                       @Y30LB38*/ 03541000
@RF01074 BAL   @14,SORTDATA                                        1079 03542000
*   RESPECIFY                                                      1080 03543000
*     RTNREG RSTD;                                                 1080 03544000
*   TESTRC=RTNREG;                                                 1081 03545000
         LR    TESTRC,RTNREG                                       1081 03546000
*   RESPECIFY                                                      1082 03547000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 03548000
*   FMTRCODE=TESTRC;                /*                       @Y30LB38*/ 03549000
*                                                                  1083 03550000
         LR    FMTRCODE,TESTRC                                     1083 03551000
*   /*****************************************************************/ 03552000
*   /*                                                               */ 03553000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 03554000
*   /*                                                               */ 03555000
*   /*****************************************************************/ 03556000
*                                                                  1084 03557000
*   REG14=RETADDR5;                 /*                       @Y30LB38*/ 03558000
         L     REG14,RETADDR5                                      1084 03559000
*   RETURN CODE(FMTRCODE);          /*                       @Y30LB38*/ 03560000
         LR    @15,FMTRCODE                                        1085 03561000
@EL00009 DS    0H                                                  1085 03562000
@EF00009 DS    0H                                                  1085 03563000
@ER00009 BR    @14                                                 1085 03564000
*   END ITEMFMTR;                   /*                       @Y30LB38*/ 03565000
*                                                                  1087 03566000
*/********************************************************************/ 03567000
*/*                                                          @Y30LB38*/ 03568000
*/*     PROCEDURE NAME - SORTDATA                            @Y30LB38*/ 03569000
*/*                                                          @Y30LB38*/ 03570000
*/*     FUNCTION - THIS ROUTINE PLACES AN ENTRY FROM         @Y30LB38*/ 03571000
*/*                NEWENT IN INTTBL INTO SORTBLK.  IF THE    @Y30LB38*/ 03572000
*/*                CORE CHAIN IS FULL, IT CALLS THE DATA     @Y30LB38*/ 03573000
*/*                MERGER TO MERGE THE BLOCKS WITH THE MERGE @Y30LB38*/ 03574000
*/*                BLOCKS ALREADY CREATED.                   @Y30LB38*/ 03575000
*/*                                                          @Y30LB38*/ 03576000
*/*     INPUT - WORK AREA CALLED SORTBLK AND INTTBL          @Y30LB38*/ 03577000
*/*                                                          @Y30LB38*/ 03578000
*/*     OUTPUT - SORTED ENTRIES IN SORTBLK AND RETURN CODE   @Y30LB38*/ 03579000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 03580000
*/*              12 = NO CORE FOR ENTRY MERGE                @Y30LB38*/ 03581000
*/*                                                          @Y30LB38*/ 03582000
*/********************************************************************/ 03583000
*                                                                  1087 03584000
*SORTDATA:                                                         1087 03585000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 03586000
*                                                                  1087 03587000
SORTDATA DS    0H                                                  1088 03588000
*   /*****************************************************************/ 03589000
*   /*                                                               */ 03590000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 03591000
*   /*                                                               */ 03592000
*   /*****************************************************************/ 03593000
*                                                                  1088 03594000
*   DCL                                                            1088 03595000
*     SORTCODE FIXED(15);           /* SORTDATA RETURN CODE@Y30LB38  */ 03596000
*   DCL                                                            1089 03597000
*     NEWFPTR PTR(31);              /* PTR TO NEXT ENTRY     @Y30LB38*/ 03598000
*   DCL                                                            1090 03599000
*     NEWBPTR PTR(31);              /* PTR TO PREVIOUS ENT@Y30LB38   */ 03600000
*   DCL                                                            1091 03601000
*     NEWPTR PTR(31);               /* PTR TO NEW ENTRY      @Y30LB38*/ 03602000
*                                                                  1092 03603000
*   /*****************************************************************/ 03604000
*   /*                                                               */ 03605000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 03606000
*   /*                                                               */ 03607000
*   /*****************************************************************/ 03608000
*                                                                  1092 03609000
*   RETADDR6=REG14;                 /*                       @Y30LB38*/ 03610000
         ST    REG14,RETADDR6                                      1092 03611000
*   OLDERID2=NEWERID2;                                             1093 03612000
         L     @02,@PC00001                                        1093 03613000
         L     @02,GDTTR2(,@02)                                    1093 03614000
         MVC   @TS00001(95),NEWERID2(@02)                          1093 03615000
         MVC   OLDERID2(95,@02),@TS00001                           1093 03616000
*   NEWID2='LMJA';                  /*                       @Y30LB38*/ 03617000
         MVC   NEWID2(4,@02),@CC01640                              1094 03618000
*   SORTCODE=''B;                   /*                       @Y30LB38*/ 03619000
*                                                                  1095 03620000
         SLR   @02,@02                                             1095 03621000
         STH   @02,SORTCODE                                        1095 03622000
*   /*****************************************************************/ 03623000
*   /*                                                               */ 03624000
*   /* GET POINTER TO LOWEST ENTRY IN THE SORTBLK AND THE    @Y30LB38*/ 03625000
*   /* LENGTH OF AN ENTRY                                    @Y30LB38*/ 03626000
*   /*                                                               */ 03627000
*   /*****************************************************************/ 03628000
*                                                                  1096 03629000
*   CURPTR=SORTENT;                 /*                       @Y30LB38*/ 03630000
         L     @15,SORTPTR                                         1096 03631000
         L     CURPTR,SORTENT(,@15)                                1096 03632000
*   NEWPTR=ADDR(SORTUNIT)+SORTCNT*(ITEMLEN+LENGTH(SORTPTRS));      1097 03633000
*                                                                  1097 03634000
         LA    NEWPTR,SORTUNIT(,@15)                               1097 03635000
         LH    @02,SORTCNT(,@15)                                   1097 03636000
         LA    @14,8                                               1097 03637000
         SLR   @01,@01                                             1097 03638000
         IC    @01,ITEMLEN                                         1097 03639000
         ALR   @14,@01                                             1097 03640000
         LR    @01,@14                                             1097 03641000
         MR    @00,@02                                             1097 03642000
         ALR   NEWPTR,@01                                          1097 03643000
*   /*****************************************************************/ 03644000
*   /*                                                               */ 03645000
*   /* BEFORE COMPARING THE NEW ENTRY WITH THE NEW ENTRIES   @Y30LB38*/ 03646000
*   /* IN THE SORTBLK, CHECK IF THIS IS THE FIRST ENTRY      @Y30LB38*/ 03647000
*   /*                                                               */ 03648000
*   /*****************************************************************/ 03649000
*                                                                  1098 03650000
*   IF SORTCNT=ZERO THEN                                           1098 03651000
         SLR   @14,@14                                             1098 03652000
         CR    @02,@14                                             1098 03653000
         BNE   @RF01098                                            1098 03654000
*     DO;                           /*                       @Y30LB38*/ 03655000
*                                                                  1099 03656000
*       /*************************************************************/ 03657000
*       /*                                                           */ 03658000
*       /* SET THE NEW FORWARD AND BACKWARD POINTERS TO 0. SET       */ 03659000
*       /*                                                   @Y30LB38*/ 03660000
*       /* SORTENT TO THE ADDRESS OF THE NEW ENTRY           @Y30LB38*/ 03661000
*       /*                                                           */ 03662000
*       /*************************************************************/ 03663000
*                                                                  1100 03664000
*       NEWFPTR=NULLPTR;            /*                       @Y30LB38*/ 03665000
         ST    @14,NEWFPTR                                         1100 03666000
*       NEWBPTR=NULLPTR;            /*                       @Y30LB38*/ 03667000
         LR    NEWBPTR,@14                                         1101 03668000
*       SORTENT=NEWPTR;             /*                       @Y30LB38*/ 03669000
         ST    NEWPTR,SORTENT(,@15)                                1102 03670000
*     END;                          /*                       @Y30LB38*/ 03671000
*   ELSE                                                           1104 03672000
*     DO;                           /*                       @Y30LB38*/ 03673000
*                                                                  1104 03674000
         B     @RC01098                                            1104 03675000
@RF01098 DS    0H                                                  1105 03676000
*       /*************************************************************/ 03677000
*       /*                                                           */ 03678000
*       /* IF THIS WILL NOT BE THE FIRST ENTRY, COMPARE WITH @Y30LB38*/ 03679000
*       /* EACH ENTRY IN THE SORTBLK WITH THE NEW ENTRY UNTIL ALL THE*/ 03680000
*       /* ENTRIES HAVE BEEN COMPARED OR THE NEW ENTRY IS LOWER THAN */ 03681000
*       /* THE SORTBLK ENTRY.                                @Y30LB38*/ 03682000
*       /*                                                           */ 03683000
*       /*************************************************************/ 03684000
*                                                                  1105 03685000
*       DO I8=ONE BY ONE TO SORTCNT WHILE SRTITEM(1:KEYLEN)<=NEWENT(1:  03686000
*             KEYLEN);              /*                       @ZA08859*/ 03687000
         LA    I8,1                                                1105 03688000
         B     @DE01105                                            1105 03689000
@DL01105 SLR   @15,@15                                             1105 03690000
         IC    @15,KEYLEN                                          1105 03691000
         BCTR  @15,0                                               1105 03692000
         EX    @15,@SC01848                                        1105 03693000
         BH    @DC01105                                            1105 03694000
*         IF SRTFPTR>NULLPTR THEN                                  1106 03695000
*                                                                  1106 03696000
         L     @15,SRTFPTR(,CURPTR)                                1106 03697000
         LTR   @15,@15                                             1106 03698000
         BNP   @RF01106                                            1106 03699000
*           /*********************************************************/ 03700000
*           /*                                                       */ 03701000
*           /* SET CURRENT POINTER TO THE NEXT LOWEST ENTRY  @Y30LB38*/ 03702000
*           /* UNLESS LAST ENTRY ALREADY.                    @Y30LB38*/ 03703000
*           /*                                                       */ 03704000
*           /*********************************************************/ 03705000
*                                                                  1107 03706000
*           CURPTR=SRTFPTR;         /*                       @Y30LB38*/ 03707000
         LR    CURPTR,@15                                          1107 03708000
*       END;                        /*                       @Y30LB38*/ 03709000
*                                                                  1108 03710000
@RF01106 AL    I8,@CF00220                                         1108 03711000
@DE01105 L     @01,SORTPTR                                         1108 03712000
         CH    I8,SORTCNT(,@01)                                    1108 03713000
         BNH   @DL01105                                            1108 03714000
@DC01105 DS    0H                                                  1109 03715000
*       /*************************************************************/ 03716000
*       /*                                                           */ 03717000
*       /* IF ALL THE ENTRIES IN SORTBLK HAVE BEEN PROCESSED,        */ 03718000
*       /*                                                   @Y30LB38*/ 03719000
*       /* NEW ENTRY IS GREATER THAN ALL THE ENTRIES IN THE BLOCK AND*/ 03720000
*       /* MUST BE PLACED AT THE END.                        @Y30LB38*/ 03721000
*       /*                                                           */ 03722000
*       /*************************************************************/ 03723000
*                                                                  1109 03724000
*       IF I8>SORTCNT THEN                                         1109 03725000
         L     @01,SORTPTR                                         1109 03726000
         CH    I8,SORTCNT(,@01)                                    1109 03727000
         BNH   @RF01109                                            1109 03728000
*         DO;                       /*                       @Y30LB38*/ 03729000
*                                                                  1110 03730000
*           /*********************************************************/ 03731000
*           /*                                                       */ 03732000
*           /* SET THE NEW FORWARD POINTER TO 0 AND THE BACKWARD     */ 03733000
*           /*                                               @Y30LB38*/ 03734000
*           /* POINTER TO THE LAST ENTRY LOOKED AT IN SORTBLK.       */ 03735000
*           /*                                               @Y30LB38*/ 03736000
*           /*                                                       */ 03737000
*           /*********************************************************/ 03738000
*                                                                  1111 03739000
*           NEWFPTR=NULLPTR;        /*                       @Y30LB38*/ 03740000
         SLR   @15,@15                                             1111 03741000
         ST    @15,NEWFPTR                                         1111 03742000
*           NEWBPTR=CURPTR;         /*                       @Y30LB38*/ 03743000
         LR    NEWBPTR,CURPTR                                      1112 03744000
*           SRTFPTR=NEWPTR;         /*                       @Y30LB38*/ 03745000
         ST    NEWPTR,SRTFPTR(,CURPTR)                             1113 03746000
*         END;                      /*                       @Y30LB38*/ 03747000
*                                                                  1114 03748000
*       /*************************************************************/ 03749000
*       /*                                                           */ 03750000
*       /* IF THE NEW ENTRY WILL BE THE LOWEST ONE IN SORTBLK        */ 03751000
*       /*                                                   @Y30LB38*/ 03752000
*       /* CURRENT PTR POINTS TO THE NEXT HIGHER ENTRY.      @Y30LB38*/ 03753000
*       /*                                                           */ 03754000
*       /*************************************************************/ 03755000
*                                                                  1115 03756000
*       ELSE                                                       1115 03757000
*         DO;                       /*                       @Y30LB38*/ 03758000
         B     @RC01109                                            1115 03759000
@RF01109 DS    0H                                                  1116 03760000
*           NEWFPTR=CURPTR;         /*                       @Y30LB38*/ 03761000
         ST    CURPTR,NEWFPTR                                      1116 03762000
*           NEWBPTR=SRTBPTR;        /*                       @Y30LB38*/ 03763000
*                                                                  1117 03764000
         L     NEWBPTR,SRTBPTR(,CURPTR)                            1117 03765000
*           /*********************************************************/ 03766000
*           /*                                                       */ 03767000
*           /* IF THE NEW ENTRY IS THE LOWEST ENTRY IN THE SORTBLK,  */ 03768000
*           /*                                               @Y30LB38*/ 03769000
*           /* THE POINTER IN THE SORTBLK POINTS AT THE NEW ENTRY    */ 03770000
*           /*                                               @Y30LB38*/ 03771000
*           /*                                                       */ 03772000
*           /*********************************************************/ 03773000
*                                                                  1118 03774000
*           IF NEWBPTR=NULLPTR THEN                                1118 03775000
         LTR   NEWBPTR,NEWBPTR                                     1118 03776000
         BNZ   @RF01118                                            1118 03777000
*             SORTENT=NEWPTR;       /*                       @Y30LB38*/ 03778000
         L     @01,SORTPTR                                         1119 03779000
         ST    NEWPTR,SORTENT(,@01)                                1119 03780000
*           ELSE                                                   1120 03781000
*             SRTBPTR->SRTFPTR=NEWPTR;/*                     @Y30LB38*/ 03782000
         B     @RC01118                                            1120 03783000
@RF01118 L     @01,SRTBPTR(,CURPTR)                                1120 03784000
         ST    NEWPTR,SRTFPTR(,@01)                                1120 03785000
*           SRTBPTR=NEWPTR;         /*                       @Y30LB38*/ 03786000
@RC01118 ST    NEWPTR,SRTBPTR(,CURPTR)                             1121 03787000
*         END;                      /*                       @Y30LB38*/ 03788000
*     END;                          /*                       @Y30LB38*/ 03789000
*                                                                  1123 03790000
@RC01109 DS    0H                                                  1124 03791000
*   /*****************************************************************/ 03792000
*   /*                                                               */ 03793000
*   /* MOVE THE NEW ENTRY INTO THE SORTBLK                   @Y30LB38*/ 03794000
*   /*                                                               */ 03795000
*   /*****************************************************************/ 03796000
*                                                                  1124 03797000
*   CURPTR=NEWPTR;                  /*                       @Y30LB38*/ 03798000
@RC01098 LR    CURPTR,NEWPTR                                       1124 03799000
*   SRTFPTR=NEWFPTR;                /*                       @Y30LB38*/ 03800000
         L     @06,NEWFPTR                                         1125 03801000
         ST    @06,SRTFPTR(,CURPTR)                                1125 03802000
*   SRTBPTR=NEWBPTR;                /*                       @Y30LB38*/ 03803000
         ST    NEWBPTR,SRTBPTR(,CURPTR)                            1126 03804000
*   SRTITEM(1:ITEMLEN)=NEWENT;      /*                       @Y30LB38*/ 03805000
*                                                                  1127 03806000
         SLR   @06,@06                                             1127 03807000
         IC    @06,ITEMLEN                                         1127 03808000
         BCTR  @06,0                                               1127 03809000
         EX    @06,@SM01850                                        1127 03810000
*   /*****************************************************************/ 03811000
*   /*                                                               */ 03812000
*   /* INCREMENT THE SORT COUNT                              @Y30LB38*/ 03813000
*   /*                                                               */ 03814000
*   /*****************************************************************/ 03815000
*                                                                  1128 03816000
*   SORTCNT=SORTCNT+ONE;            /*                       @Y30LB38*/ 03817000
*                                                                  1128 03818000
         L     @06,SORTPTR                                         1128 03819000
         LA    @15,1                                               1128 03820000
         AH    @15,SORTCNT(,@06)                                   1128 03821000
         STH   @15,SORTCNT(,@06)                                   1128 03822000
*   /*****************************************************************/ 03823000
*   /*                                                               */ 03824000
*   /* TEST IF THE SORTBLK IS FULL. THIS IS DONE BY          @Y30LB38*/ 03825000
*   /* TESTING THE SORTCNT FIELD AND THE BLKITEMS FIELD. IF YES, CALL*/ 03826000
*   /* MRGDATA TO MERGE THE BLOCKS.                          @Y30LB38*/ 03827000
*   /*                                                               */ 03828000
*   /*****************************************************************/ 03829000
*                                                                  1129 03830000
*   IF SORTCNT=BLKITEMS THEN                                       1129 03831000
         C     @15,BLKITEMS                                        1129 03832000
         BNE   @RF01129                                            1129 03833000
*     DO;                           /*                       @Y30LB38*/ 03834000
*       CALL MRGDATA;               /*                       @Y30LB38*/ 03835000
         BAL   @14,MRGDATA                                         1131 03836000
*       RESPECIFY                                                  1132 03837000
*         RTNREG RSTD;                                             1132 03838000
*       TESTRC=RTNREG;                                             1133 03839000
         LR    TESTRC,RTNREG                                       1133 03840000
*       RESPECIFY                                                  1134 03841000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 03842000
*       SORTCODE=TESTRC;            /*                       @Y30LB38*/ 03843000
         STH   TESTRC,SORTCODE                                     1135 03844000
*     END;                          /*                       @Y30LB38*/ 03845000
*                                                                  1136 03846000
*   /*****************************************************************/ 03847000
*   /*                                                               */ 03848000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 03849000
*   /*                                                               */ 03850000
*   /*****************************************************************/ 03851000
*                                                                  1137 03852000
*   REG14=RETADDR6;                 /*                       @Y30LB38*/ 03853000
@RF01129 L     REG14,RETADDR6                                      1137 03854000
*   RETURN CODE(SORTCODE);          /*                       @Y30LB38*/ 03855000
         LH    @15,SORTCODE                                        1138 03856000
@EL00010 DS    0H                                                  1138 03857000
@EF00010 DS    0H                                                  1138 03858000
@ER00010 BR    @14                                                 1138 03859000
*   END SORTDATA;                   /*                       @Y30LB38*/ 03860000
*                                                                  1140 03861000
*/********************************************************************/ 03862000
*/*                                                          @Y30LB38*/ 03863000
*/*     PROCEDURE NAME - MRGDATA                             @Y30LB38*/ 03864000
*/*                                                          @Y30LB38*/ 03865000
*/*     FUNCTION - THIS ROUTINE ESTABLISHES POINTERS TO      @Y30LB38*/ 03866000
*/*                MERGE BLOCKS THAT ARE TO BE USED AS THE   @Y30LB38*/ 03867000
*/*                INPUT AND OUTPUT BLOCKS FOR THE MERGE     @Y30LB38*/ 03868000
*/*                THAT IS PERFORMED IN MRGLOOP ROUTINE.  IT @Y30LB38*/ 03869000
*/*                USES UGPOOL, UFPOOL AND UFSPACE TO GET    @Y30LB38*/ 03870000
*/*                THE OUTPUT BLOCK AND FREE THE INPUT MERGE @Y30LB38*/ 03871000
*/*                BLOCK.  THIS ROUTINE COVERS THE CONDITIONS@Y30LB38*/ 03872000
*/*                WHERE THE SORTBLK IS THE ONLY INPUT TO    @Y30LB38*/ 03873000
*/*                THE MERGE PROCESS AND WHERE THE SORTBLK   @Y30LB38*/ 03874000
*/*                AND ANOTHER MERGE BLOCK ARE INPUT TO THE  @Y30LB38*/ 03875000
*/*                MERGE PROCESS.                            @Y30LB38*/ 03876000
*/*                                                          @Y30LB38*/ 03877000
*/*     INPUT - WORK AREA CALLED INTTBL                      @Y30LB38*/ 03878000
*/*                                                          @Y30LB38*/ 03879000
*/*     OUTPUT - ENTRY PLACED IN MRGBLK AND                  @Y30LB38*/ 03880000
*/*              RETURN CODE                                 @Y30LB38*/ 03881000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 03882000
*/*              12 = NO CORE FOR ENTRY MERGE                @Y30LB38*/ 03883000
*/*                                                          @Y30LB38*/ 03884000
*/********************************************************************/ 03885000
*                                                                  1140 03886000
*MRGDATA:                                                          1140 03887000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 03888000
*                                                                  1140 03889000
MRGDATA  DS    0H                                                  1141 03890000
*   /*****************************************************************/ 03891000
*   /*                                                               */ 03892000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 03893000
*   /*                                                               */ 03894000
*   /*****************************************************************/ 03895000
*                                                                  1141 03896000
*   DCL                                                            1141 03897000
*     MRGCODE FIXED(15);            /* MRGDATA RETURN CODE   @Y30LB38*/ 03898000
*   DCL                                                            1142 03899000
*     MRGADDR PTR(31);              /* MERGE BLK ADDRESS     @Y30LB38*/ 03900000
*   DCL                                                            1143 03901000
*     MRGCNTR FIXED(31);            /* MERGE COUNT           @Y30LB38*/ 03902000
*   DCL                                                            1144 03903000
*     MRGPOOL FIXED(31);            /* SIZE OF MRG POOL      @Y30LB38*/ 03904000
*   DCL                                                            1145 03905000
*     BLKSIZE FIXED(31) CONSTANT(2048);/* SIZE OF MRGBLK     @Y30LB38*/ 03906000
*                                                                  1146 03907000
*   /*****************************************************************/ 03908000
*   /*                                                               */ 03909000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 03910000
*   /*                                                               */ 03911000
*   /*****************************************************************/ 03912000
*                                                                  1146 03913000
*   RETADDR7=REG14;                 /*                       @Y30LB38*/ 03914000
         ST    REG14,RETADDR7                                      1146 03915000
*   OLDERID2=NEWERID2;                                             1147 03916000
         L     @06,@PC00001                                        1147 03917000
         L     @06,GDTTR2(,@06)                                    1147 03918000
         MVC   @TS00001(95),NEWERID2(@06)                          1147 03919000
         MVC   OLDERID2(95,@06),@TS00001                           1147 03920000
*   NEWID2='LMKA';                  /*                       @Y30LB38*/ 03921000
         MVC   NEWID2(4,@06),@CC01650                              1148 03922000
*   MRGCODE=''B;                    /*                       @Y30LB38*/ 03923000
         SLR   @06,@06                                             1149 03924000
         STH   @06,MRGCODE                                         1149 03925000
*   MRGADDR=''B;                    /*                       @Y30LB38*/ 03926000
         ST    @06,MRGADDR                                         1150 03927000
*   MRGCNTR=''B;                    /*                       @Y30LB38*/ 03928000
*                                                                  1151 03929000
         ST    @06,MRGCNTR                                         1151 03930000
*   /*****************************************************************/ 03931000
*   /*                                                               */ 03932000
*   /* LOOP THROUGH THE 7 MRGBLK ADDRESSES TO DETERMINE      @Y30LB38*/ 03933000
*   /* IF THERE IS ONE THAT CONTAINS ZERO. IF YES, ISSUE THE UGPOOL  */ 03934000
*   /* MACRO TO OBTAIN A 2K BLOCK OF CORE.                   @Y30LB38*/ 03935000
*   /*                                                               */ 03936000
*   /*****************************************************************/ 03937000
*                                                                  1152 03938000
*   DO I7=1 BY 1 TO 7 WHILE MRGBLKS(I7)^=NULLPTR;/*          @Y30LB38*/ 03939000
         LA    @06,1                                               1152 03940000
         STH   @06,I7                                              1152 03941000
@DL01152 LR    @15,@06                                             1152 03942000
         SLA   @15,2                                               1152 03943000
         L     @15,MRGBLKS-4(@15)                                  1152 03944000
         LTR   @15,@15                                             1152 03945000
         BZ    @DC01152                                            1152 03946000
*   END;                            /*                       @Y30LB38*/ 03947000
         AL    @06,@CF00220                                        1153 03948000
         STH   @06,I7                                              1153 03949000
         C     @06,@CF00659                                        1153 03950000
         BNH   @DL01152                                            1153 03951000
@DC01152 DS    0H                                                  1154 03952000
*   IF MRGBLKS(I7)=NULLPTR THEN                                    1154 03953000
         LH    @06,I7                                              1154 03954000
         LR    @15,@06                                             1154 03955000
         SLA   @15,2                                               1154 03956000
         L     @15,MRGBLKS-4(@15)                                  1154 03957000
         LTR   @15,@15                                             1154 03958000
         BNZ   @RF01154                                            1154 03959000
*     DO;                           /*                       @Y30LB38*/ 03960000
*       I9=I7;                      /*                       @ZM00717*/ 03961000
         STH   @06,I9                                              1156 03962000
*       MRGPOOL=BLKSIZE;            /*                       @Y30LB38*/ 03963000
         MVC   MRGPOOL(4),@CF01649                                 1157 03964000
*       CALL IDCSAGP0(GDTTBL,MRGPOOL,RTNAREA,'LM01');/*      @Y30LB38*/ 03965000
         L     @06,@PC00001                                        1158 03966000
         ST    @06,@AL00001                                        1158 03967000
         LA    @02,MRGPOOL                                         1158 03968000
         ST    @02,@AL00001+4                                      1158 03969000
         LA    @02,RTNAREA                                         1158 03970000
         ST    @02,@AL00001+8                                      1158 03971000
         LA    @02,@CC01491                                        1158 03972000
         ST    @02,@AL00001+12                                     1158 03973000
         MVI   @AL00001+12,X'80'                                   1158 03974000
         L     @15,GDTGPL(,@06)                                    1158 03975000
         LA    @01,@AL00001                                        1158 03976000
         BALR  @14,@15                                             1158 03977000
*       RESPECIFY                                                  1159 03978000
*         RTNREG RSTD;                                             1159 03979000
*       TESTRC=RTNREG;                                             1160 03980000
         LR    TESTRC,RTNREG                                       1160 03981000
*       RESPECIFY                                                  1161 03982000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 03983000
*                                                                  1161 03984000
*       /*************************************************************/ 03985000
*       /*                                                           */ 03986000
*       /* IF THE RETURN CODE FROM UGPOOL IS ^= 0 SET THE    @Y30LB38*/ 03987000
*       /* CONDITION CODE = 12.                              @Y30LB38*/ 03988000
*       /*                                                           */ 03989000
*       /*************************************************************/ 03990000
*                                                                  1162 03991000
*       IF TESTRC^=0 THEN                                          1162 03992000
         LTR   TESTRC,TESTRC                                       1162 03993000
         BZ    @RF01162                                            1162 03994000
*         MRGCODE=LASTCC12;         /*                       @Y30LB38*/ 03995000
         MVC   MRGCODE(2),@CH00567                                 1163 03996000
*       ELSE                                                       1164 03997000
*         DO;                       /*                       @Y30LB38*/ 03998000
         B     @RC01162                                            1164 03999000
@RF01162 DS    0H                                                  1165 04000000
*           MRGBLKS(I7)=RTNAREA;    /*                       @Y30LB38*/ 04001000
         L     @06,RTNAREA                                         1165 04002000
         LH    @15,I7                                              1165 04003000
         SLA   @15,2                                               1165 04004000
         ST    @06,MRGBLKS-4(@15)                                  1165 04005000
*           MRGADDR=RTNAREA;        /*                       @Y30LB38*/ 04006000
*                                                                  1166 04007000
         ST    @06,MRGADDR                                         1166 04008000
*           /*********************************************************/ 04009000
*           /*                                                       */ 04010000
*           /* SELECT A MERGE COUNT FIELD AND PLACE THE ADDRESS      */ 04011000
*           /*                                               @Y30LB38*/ 04012000
*           /* IN MRGCNTR. MRGADDR AND MRGCNTR ARE PASSED AS         */ 04013000
*           /* PARAMETERS TO MRGLOOP. MRGLOOP TAKES THE ENTRIES FROM */ 04014000
*           /* SORTBLK AND PLACES THEM IN THE MERGE BLOCK.   @Y30LB38*/ 04015000
*           /*                                                       */ 04016000
*           /*********************************************************/ 04017000
*                                                                  1167 04018000
*           CALL MRGLOOP(I7,MRGCNTR,MRGADDR);/*              @Y30LB38*/ 04019000
         LA    @06,I7                                              1167 04020000
         ST    @06,@AL00001                                        1167 04021000
         LA    @06,MRGCNTR                                         1167 04022000
         ST    @06,@AL00001+4                                      1167 04023000
         LA    @06,MRGADDR                                         1167 04024000
         ST    @06,@AL00001+8                                      1167 04025000
         LA    @01,@AL00001                                        1167 04026000
         BAL   @14,MRGLOOP                                         1167 04027000
*           MRGCOUNT(I7)=MRGCNTR;   /*                       @Y30LB38*/ 04028000
         LH    @06,I7                                              1168 04029000
         SLA   @06,2                                               1168 04030000
         L     @15,MRGCNTR                                         1168 04031000
         ST    @15,MRGCOUNT-4(@06)                                 1168 04032000
*         END;                      /*                       @Y30LB38*/ 04033000
*     END;                          /*                       @Y30LB38*/ 04034000
*                                                                  1170 04035000
*   /*****************************************************************/ 04036000
*   /*                                                               */ 04037000
*   /* ALL THE MRGBLK ENTRIES WERE USED. IF ALL BLOCKS       @ZM00717*/ 04038000
*   /* ARE EQUALLY FILLED, USE THE FIRST BLOCK, OTHERWISE USE THE    */ 04039000
*   /* NEXT MERGE BLOCK. THE SORTCNT FIELD IN SORTBLK IS ADDED TO THE*/ 04040000
*   /* MRGCNT FIELD. THIS VALUE IS MULTIPLIED BY THE ITEMLEN FIELD TO*/ 04041000
*   /* GET A LENGTH FOR THE NEW MERG BLOCK. THIS LENGTH IS PASSED TO */ 04042000
*   /* THE UGPOOL MACRO TO OBTAIN THE CORE. THE ADDRESS OF THE CORE  */ 04043000
*   /* RETURNED AND THE ADDRESS OF THE MRGCNT FIELD ARE PASSED TO    */ 04044000
*   /* MRGLOOP WHICH REMOVES THE ENTRIES FROM SORTBLK AND PLACES THEM*/ 04045000
*   /* IN THE NEW BLOCK.                                     @Y30LB38*/ 04046000
*   /*                                                               */ 04047000
*   /*****************************************************************/ 04048000
*                                                                  1171 04049000
*   ELSE                                                           1171 04050000
*     DO;                           /*                       @Y30LB38*/ 04051000
         B     @RC01154                                            1171 04052000
@RF01154 DS    0H                                                  1172 04053000
*       IF I9=7 THEN                                               1172 04054000
         CLC   I9(2),@CH00659                                      1172 04055000
         BNE   @RF01172                                            1172 04056000
*         I9=1;                     /*                       @ZM00717*/ 04057000
         MVC   I9(2),@CH00220                                      1173 04058000
*       ELSE                                                       1174 04059000
*         I9=I9+1;                  /*                       @ZM00717*/ 04060000
         B     @RC01172                                            1174 04061000
@RF01172 LA    @06,1                                               1174 04062000
         AH    @06,I9                                              1174 04063000
         STH   @06,I9                                              1174 04064000
*       MRGPOOL=(MRGCOUNT(I9)+SORTCNT)*ITEMLEN;/*            @ZM00717*/ 04065000
@RC01172 LH    @06,I9                                              1175 04066000
         SLA   @06,2                                               1175 04067000
         L     @02,SORTPTR                                         1175 04068000
         LH    @01,SORTCNT(,@02)                                   1175 04069000
         AL    @01,MRGCOUNT-4(@06)                                 1175 04070000
         SLR   @06,@06                                             1175 04071000
         IC    @06,ITEMLEN                                         1175 04072000
         MR    @00,@06                                             1175 04073000
         ST    @01,MRGPOOL                                         1175 04074000
*       CALL IDCSAGP0(GDTTBL,MRGPOOL,RTNAREA,'LM01');/*      @Y30LB38*/ 04075000
         L     @06,@PC00001                                        1176 04076000
         ST    @06,@AL00001                                        1176 04077000
         LA    @02,MRGPOOL                                         1176 04078000
         ST    @02,@AL00001+4                                      1176 04079000
         LA    @02,RTNAREA                                         1176 04080000
         ST    @02,@AL00001+8                                      1176 04081000
         LA    @02,@CC01491                                        1176 04082000
         ST    @02,@AL00001+12                                     1176 04083000
         MVI   @AL00001+12,X'80'                                   1176 04084000
         L     @15,GDTGPL(,@06)                                    1176 04085000
         LA    @01,@AL00001                                        1176 04086000
         BALR  @14,@15                                             1176 04087000
*       RESPECIFY                                                  1177 04088000
*         RTNREG RSTD;                                             1177 04089000
*       TESTRC=RTNREG;                                             1178 04090000
         LR    TESTRC,RTNREG                                       1178 04091000
*       RESPECIFY                                                  1179 04092000
*         RTNREG UNRSTD;            /*                       @Y30LB38*/ 04093000
*       IF TESTRC^=0 THEN                                          1180 04094000
         LTR   TESTRC,TESTRC                                       1180 04095000
         BZ    @RF01180                                            1180 04096000
*         MRGCODE=LASTCC12;         /*                       @Y30LB38*/ 04097000
         MVC   MRGCODE(2),@CH00567                                 1181 04098000
*       WORK1=RTNAREA;              /*                       @Y30LB38*/ 04099000
@RF01180 L     @06,RTNAREA                                         1182 04100000
         ST    @06,WORK1                                           1182 04101000
*       MRGADDR=RTNAREA;            /*                       @Y30LB38*/ 04102000
         ST    @06,MRGADDR                                         1183 04103000
*       IF MRGCODE^=LASTCC12 THEN                                  1184 04104000
         CLC   MRGCODE(2),@CH00567                                 1184 04105000
         BE    @RF01184                                            1184 04106000
*         CALL MRGLOOP(I9,MRGCNTR,MRGADDR);/*                @Y30LB38*/ 04107000
*                                                                  1185 04108000
         LA    @06,I9                                              1185 04109000
         ST    @06,@AL00001                                        1185 04110000
         LA    @06,MRGCNTR                                         1185 04111000
         ST    @06,@AL00001+4                                      1185 04112000
         LA    @06,MRGADDR                                         1185 04113000
         ST    @06,@AL00001+8                                      1185 04114000
         LA    @01,@AL00001                                        1185 04115000
         BAL   @14,MRGLOOP                                         1185 04116000
*       /*************************************************************/ 04117000
*       /*                                                           */ 04118000
*       /* IF STORAGE WAS OBTAINED, PUT THE NEW MRGBLK       @ZM00727*/ 04119000
*       /* ADDRESS OBTAINED ABOVE IN THE APPROPRIATE MRGBLK AND THE  */ 04120000
*       /* NEW COUNT IN THE APPROPRIATE MRGCNT FIELD. ISSUE THE      */ 04121000
*       /* UFSPACE MACRO TO FREE THE OLD MRGBLK THAT WAS REPLACED BY */ 04122000
*       /* THE ABOVE.                                        @Y30LB38*/ 04123000
*       /*                                                           */ 04124000
*       /*************************************************************/ 04125000
*                                                                  1186 04126000
*       IF MRGCODE^=LASTCC12 THEN                                  1186 04127000
@RF01184 CLC   MRGCODE(2),@CH00567                                 1186 04128000
         BE    @RF01186                                            1186 04129000
*         DO;                       /*                       @Y30LB38*/ 04130000
*           RTNAREA=MRGBLKS(I9);    /*                       @Y30BL38*/ 04131000
         LH    @06,I9                                              1188 04132000
         SLA   @06,2                                               1188 04133000
         L     @15,MRGBLKS-4(@06)                                  1188 04134000
         ST    @15,RTNAREA                                         1188 04135000
*           MRGBLKS(I9)=WORK1;      /*                       @Y30LB38*/ 04136000
         L     @15,WORK1                                           1189 04137000
         ST    @15,MRGBLKS-4(@06)                                  1189 04138000
*           MRGCOUNT(I9)=MRGCNTR;   /*                       @Y30BL38*/ 04139000
         L     @15,MRGCNTR                                         1190 04140000
         ST    @15,MRGCOUNT-4(@06)                                 1190 04141000
*           CALL IDCSAFS0(GDTTBL,RTNAREA);/*                 @Y30LB38*/ 04142000
         L     @06,@PC00001                                        1191 04143000
         ST    @06,@AL00001                                        1191 04144000
         LA    @15,RTNAREA                                         1191 04145000
         ST    @15,@AL00001+4                                      1191 04146000
         L     @15,GDTFSP(,@06)                                    1191 04147000
         LA    @01,@AL00001                                        1191 04148000
         BALR  @14,@15                                             1191 04149000
*         END;                      /*                       @Y30LB38*/ 04150000
*     END;                          /*                       @Y30LB38*/ 04151000
*                                                                  1193 04152000
@RF01186 DS    0H                                                  1194 04153000
*   /*****************************************************************/ 04154000
*   /*                                                               */ 04155000
*   /* IF NO STORAGE WAS OBTAINED, ISSUE THE UFPOOL MACRO    @ZM00717*/ 04156000
*   /* TO FREE ALL THE CORE OBTAINED, ZERO THE MRGBLK AND    @ZM00717*/ 04157000
*   /* MRGCNT FIELDS AND ISSUE THE UPRINT MACRO TO PRINT     @ZM00717*/ 04158000
*   /* MESSAGE IDC2011I.                                     @ZM00717*/ 04159000
*   /*                                                               */ 04160000
*   /*****************************************************************/ 04161000
*                                                                  1194 04162000
*   IF MRGCODE=LASTCC12 THEN                                       1194 04163000
@RC01154 CLC   MRGCODE(2),@CH00567                                 1194 04164000
         BNE   @RF01194                                            1194 04165000
*     DO;                           /*                       @Y30LB38*/ 04166000
*       CALL IDCSAFP0(GDTTBL,'LM01',ALL);/*                  @Y30LB38*/ 04167000
         MVC   @AL00001+4(8),@AL01196                              1196 04168000
         L     @06,@PC00001                                        1196 04169000
         ST    @06,@AL00001                                        1196 04170000
         L     @15,GDTFPL(,@06)                                    1196 04171000
         LA    @01,@AL00001                                        1196 04172000
         BALR  @14,@15                                             1196 04173000
*       DO I7=ONE BY ONE TO SEVEN;  /*                       @Y30LB38*/ 04174000
         LA    @06,1                                               1197 04175000
         STH   @06,I7                                              1197 04176000
@DL01197 DS    0H                                                  1198 04177000
*         MRGBLKS(I7)=''B;          /*                       @Y30LB38*/ 04178000
         LR    @15,@06                                             1198 04179000
         SLA   @15,2                                               1198 04180000
         SLR   @14,@14                                             1198 04181000
         ST    @14,MRGBLKS-4(@15)                                  1198 04182000
*       END;                        /*                       @Y30LB38*/ 04183000
         AL    @06,@CF00220                                        1199 04184000
         STH   @06,I7                                              1199 04185000
         C     @06,@CF00659                                        1199 04186000
         BNH   @DL01197                                            1199 04187000
*       DO I7=ONE BY ONE TO SEVEN;  /*                       @Y30LB38*/ 04188000
         LA    @06,1                                               1200 04189000
         STH   @06,I7                                              1200 04190000
@DL01200 DS    0H                                                  1201 04191000
*         MRGCOUNT(I7)=''B;         /*                       @Y30LB38*/ 04192000
         LR    @15,@06                                             1201 04193000
         SLA   @15,2                                               1201 04194000
         SLR   @14,@14                                             1201 04195000
         ST    @14,MRGCOUNT-4(@15)                                 1201 04196000
*       END;                        /*                       @Y30LB38*/ 04197000
         AL    @06,@CF00220                                        1202 04198000
         STH   @06,I7                                              1202 04199000
         C     @06,@CF00659                                        1202 04200000
         BNH   @DL01200                                            1202 04201000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 04202000
         XC    PRINTAB(84),PRINTAB                                 1203 04203000
*       DARGSMOD=UNIVMSG;           /*                       @Y30LB38*/ 04204000
         L     @06,DDSTRU                                          1204 04205000
         MVC   DARGSMOD(3,@06),@CC01481                            1204 04206000
*       DARGSENT=MSG2011I;          /*                       @Y30LB38*/ 04207000
         MVI   DARGSENT(@06),X'0C'                                 1205 04208000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/ 04209000
         L     @06,@PC00001                                        1206 04210000
         ST    @06,@AL00001                                        1206 04211000
         LA    @15,@CF00116                                        1206 04212000
         ST    @15,@AL00001+4                                      1206 04213000
         LA    @15,DDSTRU                                          1206 04214000
         ST    @15,@AL00001+8                                      1206 04215000
         MVI   @AL00001+8,X'80'                                    1206 04216000
         L     @15,GDTPRT(,@06)                                    1206 04217000
         LA    @01,@AL00001                                        1206 04218000
         BALR  @14,@15                                             1206 04219000
*     END;                          /*                       @Y30LB38*/ 04220000
*                                                                  1207 04221000
*   /*****************************************************************/ 04222000
*   /*                                                               */ 04223000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 04224000
*   /*                                                               */ 04225000
*   /*****************************************************************/ 04226000
*                                                                  1208 04227000
*   REG14=RETADDR7;                 /*                       @Y30LB38*/ 04228000
@RF01194 L     REG14,RETADDR7                                      1208 04229000
*   RETURN CODE(MRGCODE);           /*                       @Y30LB38*/ 04230000
         LH    @15,MRGCODE                                         1209 04231000
@EL00011 DS    0H                                                  1209 04232000
@EF00011 DS    0H                                                  1209 04233000
@ER00011 BR    @14                                                 1209 04234000
*   END MRGDATA;                    /*                       @Y30LB38*/ 04235000
*                                                                  1211 04236000
*/********************************************************************/ 04237000
*/*                                                          @Y30LB38*/ 04238000
*/*     PROCEDURE NAME - HEADSET                             @Y30LB38*/ 04239000
*/*                                                          @Y30LB38*/ 04240000
*/*     FUNCTION - THIS ROUTINE ESTABLISHES THE SUBTITLE     @Y30LB38*/ 04241000
*/*                LINES FOR THE REPORT AND PLACES THE       @Y30LB38*/ 04242000
*/*                CONSTANTS USED FOR REPORTING IN A BUFFER  @Y30LB38*/ 04243000
*/*                                                          @Y30LB38*/ 04244000
*/*     INPUT - WORK AREA CALLED INTTBL AND THE FDTTBL       @Y30LB38*/ 04245000
*/*                                                          @Y30LB38*/ 04246000
*/*     OUTPUT - COMPLETED TITLE BUFFER AND A 0 RETURN CODE  @Y30LB38*/ 04247000
*/*                                                          @Y30LB38*/ 04248000
*/********************************************************************/ 04249000
*                                                                  1211 04250000
*HEADSET:                                                          1211 04251000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 04252000
*                                                                  1211 04253000
HEADSET  DS    0H                                                  1212 04254000
*   /*****************************************************************/ 04255000
*   /*                                                               */ 04256000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 04257000
*   /*                                                               */ 04258000
*   /*****************************************************************/ 04259000
*                                                                  1212 04260000
*   DCL                                                            1212 04261000
*     HEADCODE FIXED(15);           /* HEADSET RETURN CODE   @Y30LB38*/ 04262000
*   DCL                                                            1213 04263000
*     LMO16 FIXED(8) CONSTANT(16);  /* LMO STID 16           @Y30LB38*/ 04264000
*   DCL                                                            1214 04265000
*     LMO17 FIXED(8) CONSTANT(17);  /* LMO STID 17           @Y30LB38*/ 04266000
*   DCL                                                            1215 04267000
*     LMO18 FIXED(8) CONSTANT(18);  /* LMO STID 18           @Y30LB38*/ 04268000
*   DCL                                                            1216 04269000
*     LMO19 FIXED(8) CONSTANT(19);  /* LMO STID 19           @Y30LB38*/ 04270000
*   DCL                                                            1217 04271000
*     LMO26 FIXED(8) CONSTANT(26);  /* LMO STID 26           @Y30LB38*/ 04272000
*   DCL                                                            1218 04273000
*     LMO27 FIXED(8) CONSTANT(27);  /* LMO STID 27           @Y30LB38*/ 04274000
*   DCL                                                            1219 04275000
*     LMO28 FIXED(8) CONSTANT(28);  /* LMO STID 28           @Y30LB38*/ 04276000
*                                                                  1219 04277000
*   /*****************************************************************/ 04278000
*   /*                                                               */ 04279000
*   /* DECLARE PCARG LIST FOR THE UESTA MACRO                @Y30LB38*/ 04280000
*   /*                                                               */ 04281000
*   /*****************************************************************/ 04282000
*                                                                  1220 04283000
*   DCL                                                            1220 04284000
*     1 PCARG,                                                     1220 04285000
*      2 PCMTLP PTR(31),            /* MAIN TITLE LINE PTR   @Y30LB38*/ 04286000
*      2 PCSTLP PTR(31),            /* SUB-TITLE LINE PTR    @Y30LB38*/ 04287000
*      2 PCFLP PTR(31),             /* FOOTING LINE PTR      @Y30LB38*/ 04288000
*      2 PCPCP PTR(31),             /*                       @Y30LB38*/ 04289000
*      2 PCPNL FIXED(15),           /* PAGE NO LOCATION      @Y30LB38*/ 04290000
*      2 PCPTL FIXED(15),           /* TIME LOCATION         @Y30LB38*/ 04291000
*      2 PCPDL FIXED(15),           /* DATE LOCATION         @Y30LB38*/ 04292000
*      2 PCMTLC FIXED(15),          /* MAIN TITLE LINE CNT   @Y30LB38*/ 04293000
*      2 PCSTLC FIXED(15),          /* SUB-TITLE LINE CNT    @Y30LB38*/ 04294000
*      2 PCFLC FIXED(15),           /* FOOTING LINE CNT      @Y30LB38*/ 04295000
*      2 PCLW FIXED(15),            /* LINE WIDTH            @Y30LB38*/ 04296000
*      2 PCPD FIXED(15),            /* PAGE DEPTH            @Y30LB38*/ 04297000
*      2 PCDSC PTR(8);              /* DEFAULT SPACE VAL     @Y30LB38*/ 04298000
*                                                                  1221 04299000
*   /*****************************************************************/ 04300000
*   /*                                                               */ 04301000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 04302000
*   /*                                                               */ 04303000
*   /*****************************************************************/ 04304000
*                                                                  1221 04305000
*   RETADDR3=REG14;                 /*                       @Y30LB38*/ 04306000
         ST    REG14,RETADDR3                                      1221 04307000
*   OLDERID2=NEWERID2;                                             1222 04308000
         L     @07,@PC00001                                        1222 04309000
         L     @02,GDTTR2(,@07)                                    1222 04310000
         MVC   @TS00001(95),NEWERID2(@02)                          1222 04311000
         MVC   OLDERID2(95,@02),@TS00001                           1222 04312000
*   NEWID2='LMLA';                  /*                       @Y30LB38*/ 04313000
         MVC   NEWID2(4,@02),@CC01681                              1223 04314000
*   HEADCODE=''B;                   /*                       @Y30LB38*/ 04315000
         SLR   HEADCODE,HEADCODE                                   1224 04316000
*   PCARG=''B;                      /*                       @Y30LB38*/ 04317000
*                                                                  1225 04318000
         XC    PCARG(33),PCARG                                     1225 04319000
*   /*****************************************************************/ 04320000
*   /*                                                               */ 04321000
*   /* TEST IF THIS IS THE FIRST TIME THROUGH. IF YES,       @Y30LB38*/ 04322000
*   /* ISSUE THE UPRINT MACRO TO READ IN THE CONSTANTS INTO THE      */ 04323000
*   /* PRNTCONS WORK AREA.                                   @Y30LB38*/ 04324000
*   /*                                                               */ 04325000
*   /*****************************************************************/ 04326000
*                                                                  1226 04327000
*   IF FIRSTTIM=OFF THEN                                           1226 04328000
         TM    FIRSTTIM,B'00100000'                                1226 04329000
         BNZ   @RF01226                                            1226 04330000
*     DO;                           /*                       @Y30LB38*/ 04331000
*       FIRSTTIM=ON;                /*                       @Y30LB38*/ 04332000
         OI    FIRSTTIM,B'00100000'                                1228 04333000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 04334000
         XC    PRINTAB(84),PRINTAB                                 1229 04335000
*       DARGRETP=ADDR(PRNTCONS);    /*                       @Y30LB38*/ 04336000
         L     @15,DDSTRU                                          1230 04337000
         LA    @14,PRNTCONS                                        1230 04338000
         ST    @14,DARGRETP(,@15)                                  1230 04339000
*       DARGRETL=LENGTH(PRNTCONS);  /*                       @Y30LB38*/ 04340000
         MVC   DARGRETL(2,@15),@CH00043                            1231 04341000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 04342000
         MVC   DARGSMOD(3,@15),@CC01483                            1232 04343000
*       DARGSENT=LMO16;             /*                       @Y30LB38*/ 04344000
         MVI   DARGSENT(@15),X'10'                                 1233 04345000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/ 04346000
         ST    @07,@AL00001                                        1234 04347000
         LA    @15,@CF00116                                        1234 04348000
         ST    @15,@AL00001+4                                      1234 04349000
         LA    @15,DDSTRU                                          1234 04350000
         ST    @15,@AL00001+8                                      1234 04351000
         MVI   @AL00001+8,X'80'                                    1234 04352000
         L     @15,GDTPRT(,@07)                                    1234 04353000
         LA    @01,@AL00001                                        1234 04354000
         BALR  @14,@15                                             1234 04355000
*     END;                          /*                       @Y30LB38*/ 04356000
*                                                                  1235 04357000
*   /*****************************************************************/ 04358000
*   /*                                                               */ 04359000
*   /* ISSUE THE UPRINT MACRO TO READ FIRST SUBTITLE INTO    @Y30LB38*/ 04360000
*   /* TITLBUFF. THE TABLID WILL DETERMINE WHICH SUBTITLE IS READ IN.*/ 04361000
*   /*                                                       @Y30LB38*/ 04362000
*   /*                                                               */ 04363000
*   /*****************************************************************/ 04364000
*                                                                  1236 04365000
*   PRINTAB=''B;                    /*                       @Y30LB38*/ 04366000
@RF01226 XC    PRINTAB(84),PRINTAB                                 1236 04367000
*   DARGRETP=ADDR(TITLBUFF);        /*                       @Y30LB38*/ 04368000
         L     @07,DDSTRU                                          1237 04369000
         LA    @15,TITLBUFF                                        1237 04370000
         ST    @15,DARGRETP(,@07)                                  1237 04371000
*   DARGRETL=LENGTH(TITLBUFF);      /*                       @Y30LB38*/ 04372000
         MVC   DARGRETL(2,@07),@CH01410                            1238 04373000
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/ 04374000
         MVC   DARGSMOD(3,@07),@CC01483                            1239 04375000
*   DARGDBP=ADDR(MSFVAL);           /*                       @Y30LB38*/ 04376000
         L     @15,@PC00001+4                                      1240 04377000
         L     @15,FDTPTR+28(,@15)                                 1240 04378000
         ST    @15,DARGDBP(,@07)                                   1240 04379000
*   DARGILP=LENGTH(MSFVAL);         /*                       @Y30LB38*/ 04380000
         MVC   DARGILP(2,@07),@CH00043                             1241 04381000
*   IF TBLID=TRANID THEN            /*                       @Y30LB38*/ 04382000
         CLI   TBLID,2                                             1242 04383000
         BNE   @RF01242                                            1242 04384000
*     DARGSENT=LMO18;               /*                       @Y30LB38*/ 04385000
         MVI   DARGSENT(@07),X'12'                                 1243 04386000
*   IF TBLID=VOLINVID THEN          /*                       @Y30LB38*/ 04387000
@RF01242 CLI   TBLID,3                                             1244 04388000
         BNE   @RF01244                                            1244 04389000
*     DARGSENT=LMO17;               /*                       @Y30LB38*/ 04390000
         L     @07,DDSTRU                                          1245 04391000
         MVI   DARGSENT(@07),X'11'                                 1245 04392000
*   IF TBLID=CARTID THEN            /*                       @Y30LB38*/ 04393000
@RF01244 CLI   TBLID,4                                             1246 04394000
         BNE   @RF01246                                            1246 04395000
*     DARGSENT=LMO19;               /*                       @Y30LB38*/ 04396000
         L     @07,DDSTRU                                          1247 04397000
         MVI   DARGSENT(@07),X'13'                                 1247 04398000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB38*/ 04399000
*                                                                  1248 04400000
@RF01246 L     @07,@PC00001                                        1248 04401000
         ST    @07,@AL00001                                        1248 04402000
         LA    @15,@CF00116                                        1248 04403000
         ST    @15,@AL00001+4                                      1248 04404000
         LA    @15,DDSTRU                                          1248 04405000
         ST    @15,@AL00001+8                                      1248 04406000
         MVI   @AL00001+8,X'80'                                    1248 04407000
         L     @15,GDTPRT(,@07)                                    1248 04408000
         LA    @01,@AL00001                                        1248 04409000
         BALR  @14,@15                                             1248 04410000
*   /*****************************************************************/ 04411000
*   /*                                                               */ 04412000
*   /* ISSUE THE UPRINT MACRO TO READ COLUMN TITLES INTO     @Y30LB38*/ 04413000
*   /* TITLBUFF. THE TABLID WILL DETERMINE WHICH SUBTITLE IS READ IN.*/ 04414000
*   /*                                                       @Y30LB38*/ 04415000
*   /*                                                               */ 04416000
*   /*****************************************************************/ 04417000
*                                                                  1249 04418000
*   PRINTAB=''B;                    /*                       @Y30LB38*/ 04419000
         XC    PRINTAB(84),PRINTAB                                 1249 04420000
*   DARGRETP=ADDR(TITLBUFF)+121;    /*                       @Y30LB38*/ 04421000
         L     @07,DDSTRU                                          1250 04422000
         LA    @15,TITLBUFF                                        1250 04423000
         AL    @15,@CF01682                                        1250 04424000
         ST    @15,DARGRETP(,@07)                                  1250 04425000
*   DARGRETL=LENGTH(TITLBUFF)-121;  /*                       @Y30LB38*/ 04426000
         MVC   DARGRETL(2,@07),@CH01824                            1251 04427000
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/ 04428000
         MVC   DARGSMOD(3,@07),@CC01483                            1252 04429000
*   IF TBLID=TRANID THEN            /*                       @Y30LB38*/ 04430000
         CLI   TBLID,2                                             1253 04431000
         BNE   @RF01253                                            1253 04432000
*     DARGSENT=LMO27;               /*                       @Y30LB38*/ 04433000
         MVI   DARGSENT(@07),X'1B'                                 1254 04434000
*   IF TBLID=VOLINVID THEN          /*                       @Y30LB38*/ 04435000
@RF01253 CLI   TBLID,3                                             1255 04436000
         BNE   @RF01255                                            1255 04437000
*     DARGSENT=LMO26;               /*                       @Y30LB38*/ 04438000
         L     @07,DDSTRU                                          1256 04439000
         MVI   DARGSENT(@07),X'1A'                                 1256 04440000
*   IF TBLID=CARTID THEN            /*                       @Y30LB38*/ 04441000
@RF01255 CLI   TBLID,4                                             1257 04442000
         BNE   @RF01257                                            1257 04443000
*     DARGSENT=LMO28;               /*                       @Y30LB38*/ 04444000
         L     @07,DDSTRU                                          1258 04445000
         MVI   DARGSENT(@07),X'1C'                                 1258 04446000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB38*/ 04447000
*                                                                  1259 04448000
@RF01257 L     @07,@PC00001                                        1259 04449000
         ST    @07,@AL00001                                        1259 04450000
         LA    @15,@CF00116                                        1259 04451000
         ST    @15,@AL00001+4                                      1259 04452000
         LA    @15,DDSTRU                                          1259 04453000
         ST    @15,@AL00001+8                                      1259 04454000
         MVI   @AL00001+8,X'80'                                    1259 04455000
         L     @15,GDTPRT(,@07)                                    1259 04456000
         LA    @01,@AL00001                                        1259 04457000
         BALR  @14,@15                                             1259 04458000
*   /*****************************************************************/ 04459000
*   /*                                                               */ 04460000
*   /* SET UP THE PARM LIST FOR UESTA MACRO                  #Y30LB38*/ 04461000
*   /*                                                               */ 04462000
*   /*****************************************************************/ 04463000
*                                                                  1260 04464000
*   PCSTLP=ADDR(TITLBUFF);          /*                       @Y30LB38*/ 04465000
*                                                                  1260 04466000
         LA    @07,TITLBUFF                                        1260 04467000
         ST    @07,PCSTLP                                          1260 04468000
*   /*****************************************************************/ 04469000
*   /*                                                               */ 04470000
*   /* IF THE TABLE IS A SCRATCH CARTRIDGE LIST, SET THE     @Y30LB38*/ 04471000
*   /* LINE COUNT(PCSTLC) = 2. OTHERWISE, SET IT = 3.        @Y30LB38*/ 04472000
*   /*                                                               */ 04473000
*   /*****************************************************************/ 04474000
*                                                                  1261 04475000
*   IF TBLID=CARTID THEN                                           1261 04476000
         CLI   TBLID,4                                             1261 04477000
         BNE   @RF01261                                            1261 04478000
*     PCSTLC=TWO;                   /*                       @Y30LB38*/ 04479000
         MVC   PCSTLC(2),@CH00154                                  1262 04480000
*   ELSE                                                           1263 04481000
*     PCSTLC=THREE;                 /*                       @Y30LB38*/ 04482000
*                                                                  1263 04483000
         B     @RC01261                                            1263 04484000
@RF01261 MVC   PCSTLC(2),@CH00163                                  1263 04485000
*   /*****************************************************************/ 04486000
*   /*                                                               */ 04487000
*   /* ISSUE THE UESTA MACRO TO ESTABLISH THE SUBTITLES      @Y30LB38*/ 04488000
*   /*                                                               */ 04489000
*   /*****************************************************************/ 04490000
*                                                                  1264 04491000
*   CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*                   @Y30LB38*/ 04492000
*                                                                  1264 04493000
@RC01261 L     @07,@PC00001                                        1264 04494000
         ST    @07,@AL00001                                        1264 04495000
         LA    @15,PRINTME                                         1264 04496000
         ST    @15,@AL00001+4                                      1264 04497000
         LA    @15,PCARG                                           1264 04498000
         ST    @15,@AL00001+8                                      1264 04499000
         L     @15,GDTESA(,@07)                                    1264 04500000
         LA    @01,@AL00001                                        1264 04501000
         BALR  @14,@15                                             1264 04502000
*   /*****************************************************************/ 04503000
*   /*                                                               */ 04504000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 04505000
*   /*                                                               */ 04506000
*   /*****************************************************************/ 04507000
*                                                                  1265 04508000
*   REG14=RETADDR3;                 /*                       @Y30LB38*/ 04509000
         L     REG14,RETADDR3                                      1265 04510000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 04511000
         SLR   @15,@15                                             1266 04512000
@EL00012 DS    0H                                                  1266 04513000
@EF00012 DS    0H                                                  1266 04514000
@ER00012 BR    @14                                                 1266 04515000
*   END HEADSET;                    /*                       @Y30LB38*/ 04516000
*                                                                  1268 04517000
*/********************************************************************/ 04518000
*/*                                                          @Y30LB38*/ 04519000
*/*     PROCEDURE NAME - RPTPRNTR                            @Y30LB38*/ 04520000
*/*                                                          @Y30LB38*/ 04521000
*/*     FUNCTION - THIS ROUTINE SELECTS, FROM ONE OF THE     @Y30LB38*/ 04522000
*/*                SEVEN MERGE BLOCKS, THE LOWEST VALUE      @Y30LB38*/ 04523000
*/*                ENTRY IN THE BLOCKS, ONE AT A TIME, AND   @Y30LB38*/ 04524000
*/*                PASSES EACH ONE TO SUBROUTINES THAT       @Y30LB38*/ 04525000
*/*                FORMAT PRINT BUFFERS FOR A COMPLETE PAGE, @Y30LB38*/ 04526000
*/*                AND PRINT THE PAGE.  IN THE INTTBL,       @Y30LB38*/ 04527000
*/*                KEYLEN IS USED FOR THE COMPARES AND       @ZA08859*/ 04528000
*/*                ITEMLEN IS USED FOR THE ENTRY LENGTH.     @Y30LB38*/ 04529000
*/*                                                          @Y30LB38*/ 04530000
*/*     INPUT - WORK AREA CALLED INTTBL                      @Y30LB38*/ 04531000
*/*                                                          @Y30LB38*/ 04532000
*/*     OUTPUT - UPDATED INTTBL AND A 0 RETURN CODE          @Y30LB38*/ 04533000
*/*                                                          @Y30LB38*/ 04534000
*/********************************************************************/ 04535000
*                                                                  1268 04536000
*RPTPRNTR:                                                         1268 04537000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 04538000
*                                                                  1268 04539000
RPTPRNTR DS    0H                                                  1269 04540000
*   /*****************************************************************/ 04541000
*   /*                                                               */ 04542000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 04543000
*   /*                                                               */ 04544000
*   /*****************************************************************/ 04545000
*                                                                  1269 04546000
*   DCL                                                            1269 04547000
*     LMO09 FIXED(8) CONSTANT(09);  /* LMO STID 09           @Y30LB38*/ 04548000
*   DCL                                                            1270 04549000
*     LMO10 FIXED(8) CONSTANT(10);  /* LMO STID 10           @Y30LB38*/ 04550000
*   DCL                                                            1271 04551000
*     LMO11 FIXED(8) CONSTANT(11);  /* LMO STID 11           @Y30LB38*/ 04552000
*                                                                  1272 04553000
*   /*****************************************************************/ 04554000
*   /*                                                               */ 04555000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 04556000
*   /*                                                               */ 04557000
*   /*****************************************************************/ 04558000
*                                                                  1272 04559000
*   RETADDR3=REG14;                 /*                       @Y30LB38*/ 04560000
         ST    REG14,RETADDR3                                      1272 04561000
*   OLDERID2=NEWERID2;                                             1273 04562000
         L     @07,@PC00001                                        1273 04563000
         L     @07,GDTTR2(,@07)                                    1273 04564000
         MVC   @TS00001(95),NEWERID2(@07)                          1273 04565000
         MVC   OLDERID2(95,@07),@TS00001                           1273 04566000
*   NEWID2='LMMA';                  /*                       @Y30LB38*/ 04567000
*                                                                  1274 04568000
         MVC   NEWID2(4,@07),@CC01690                              1274 04569000
*   /*****************************************************************/ 04570000
*   /*                                                               */ 04571000
*   /* SET UP DO LOOPS TO PROCESS ALL THE MRGBLK ENTRIES.    @Y30LB38*/ 04572000
*   /* THE FIELD NEWENT IS SET TO 12 FF'S AND IS USED AS A CONTROL   */ 04573000
*   /* FOR SORTING. WHEN NEWENT IS LEFT SET TO ALL FF'S, THE REPORT  */ 04574000
*   /* LOOP IS FINISHED AND UFPOOL IS ISSUED TO FREE ALL THE MRGBLKS.*/ 04575000
*   /*                                                       @Y30LB38*/ 04576000
*   /*                                                               */ 04577000
*   /*****************************************************************/ 04578000
*                                                                  1275 04579000
*   DO WHILE NEWENT(1:12)^=STARTVAL;/*                       @Y30LB38*/ 04580000
*                                                                  1275 04581000
         B     @DE01275                                            1275 04582000
@DL01275 DS    0H                                                  1276 04583000
*     /***************************************************************/ 04584000
*     /*                                                             */ 04585000
*     /* START WITH 12 FF'S                                  @ZM00717*/ 04586000
*     /*                                                             */ 04587000
*     /***************************************************************/ 04588000
*                                                                  1276 04589000
*     NEWENT(1:12)=STARTVAL;        /*                       @Y30LB38*/ 04590000
*                                                                  1276 04591000
         MVC   NEWENT(12),STARTVAL                                 1276 04592000
*     /***************************************************************/ 04593000
*     /*                                                             */ 04594000
*     /* SET UP A DO LOOP TO SEARCH THROUGH ALL THE MRGBLK   @Y30LB38*/ 04595000
*     /* ENTRIES TO FIND THE LOWEST ONE. PLACE THIS VALUE IN THE     */ 04596000
*     /* FIELD NEWENT AND CALL RTPFMTR TO PLACE THE VALUE IN THE     */ 04597000
*     /* PRINT BUFFER.                                       @Y30LB38*/ 04598000
*     /*                                                             */ 04599000
*     /***************************************************************/ 04600000
*                                                                  1277 04601000
*     DO I=1 BY 1 TO 7;             /*                       @Y30LB38*/ 04602000
         LA    I,1                                                 1277 04603000
@DL01277 DS    0H                                                  1278 04604000
*       MGENTPTR=MRGBLKS(I);        /*                       @Y30LB38*/ 04605000
         LR    @15,I                                               1278 04606000
         SLA   @15,2                                               1278 04607000
         L     MGENTPTR,MRGBLKS-4(@15)                             1278 04608000
*       IF MRGCOUNT(I)^=ZERO&NEWENT(1:KEYLEN)=>MGENTPTR->BLKENT(1: 1279 04609000
*           KEYLEN) THEN            /*                       @ZA08859*/ 04610000
         L     @02,MRGCOUNT-4(@15)                                 1279 04611000
         LTR   @02,@02                                             1279 04612000
         BZ    @RF01279                                            1279 04613000
         SLR   @02,@02                                             1279 04614000
         IC    @02,KEYLEN                                          1279 04615000
         BCTR  @02,0                                               1279 04616000
         EX    @02,@SC01853                                        1279 04617000
         BL    @RF01279                                            1279 04618000
*         DO;                       /*                       @Y30LB38*/ 04619000
*           I2=I;                   /*                       @Y30LB38*/ 04620000
         STH   I,I2                                                1281 04621000
*           NEWENT(1:ITEMLEN)=MGENTPTR->BLKENT(1:ITEMLEN);/* @Y30LB38*/ 04622000
         SLR   @02,@02                                             1282 04623000
         IC    @02,ITEMLEN                                         1282 04624000
         BCTR  @02,0                                               1282 04625000
         EX    @02,@SM01855                                        1282 04626000
*         END;                      /*                       @Y30LB38*/ 04627000
*     END;                          /*                       @Y30LB38*/ 04628000
*                                                                  1284 04629000
@RF01279 AL    I,@CF00220                                          1284 04630000
         C     I,@CF00659                                          1284 04631000
         BNH   @DL01277                                            1284 04632000
*     /***************************************************************/ 04633000
*     /*                                                             */ 04634000
*     /* THE NEW ENTRY HAS BEEN PLACED IN NEWENT. CALL       @Y30LB38*/ 04635000
*     /* RPTFMTR TO PLACE THE ENTRY IN NEWENT IN THE PRINT BUFFERAND */ 04636000
*     /* ISSUE THE UPRINT MACRO WHEN THE BUFFER IS FULL.     @Y30LB38*/ 04637000
*     /*                                                             */ 04638000
*     /***************************************************************/ 04639000
*                                                                  1285 04640000
*     CALL RPTFMTR;                 /*                       @Y30LB38*/ 04641000
*                                                                  1285 04642000
         BAL   @14,RPTFMTR                                         1285 04643000
*     /***************************************************************/ 04644000
*     /*                                                             */ 04645000
*     /* IF NEWENT IS ALL FF'S THE REPORT IS DONE. ISSUE     @Y30LB38*/ 04646000
*     /* THE UFPOOL MACRO TO FREE ALL THE MRGBLK'S AND ZERO THE      */ 04647000
*     /* MRGBLK AND MRGCNT FIELDS IN INTTBL.                 @Y30LB38*/ 04648000
*     /*                                                             */ 04649000
*     /***************************************************************/ 04650000
*                                                                  1286 04651000
*     IF NEWENT(1:12)=STARTVAL THEN                                1286 04652000
         CLC   NEWENT(12),STARTVAL                                 1286 04653000
         BNE   @RF01286                                            1286 04654000
*       DO;                         /*                       @Y30LB38*/ 04655000
*         CALL IDCSAFP0(GDTTBL,'LM01',ALL);/*                @Y30LB38*/ 04656000
         MVC   @AL00001+4(8),@AL01288                              1288 04657000
         L     @07,@PC00001                                        1288 04658000
         ST    @07,@AL00001                                        1288 04659000
         L     @15,GDTFPL(,@07)                                    1288 04660000
         LA    @01,@AL00001                                        1288 04661000
         BALR  @14,@15                                             1288 04662000
*         DO I=ONE BY ONE TO SEVEN; /*                       @Y30LB38*/ 04663000
         LA    I,1                                                 1289 04664000
@DL01289 DS    0H                                                  1290 04665000
*           MRGBLKS(I)=''B;         /*                       @Y30LB38*/ 04666000
         LR    @15,I                                               1290 04667000
         SLA   @15,2                                               1290 04668000
         SLR   @14,@14                                             1290 04669000
         ST    @14,MRGBLKS-4(@15)                                  1290 04670000
*         END;                      /*                       @Y30LB38*/ 04671000
         AL    I,@CF00220                                          1291 04672000
         C     I,@CF00659                                          1291 04673000
         BNH   @DL01289                                            1291 04674000
*         DO I=ONE BY ONE TO SEVEN; /*                       @Y30LB38*/ 04675000
         LA    I,1                                                 1292 04676000
@DL01292 DS    0H                                                  1293 04677000
*           MRGCOUNT(I)=''B;        /*                       @Y30LB38*/ 04678000
         LR    @15,I                                               1293 04679000
         SLA   @15,2                                               1293 04680000
         SLR   @14,@14                                             1293 04681000
         ST    @14,MRGCOUNT-4(@15)                                 1293 04682000
*         END;                      /*                       @Y30LB38*/ 04683000
         AL    I,@CF00220                                          1294 04684000
         C     I,@CF00659                                          1294 04685000
         BNH   @DL01292                                            1294 04686000
*       END;                        /*                       @Y30LB38*/ 04687000
*                                                                  1295 04688000
*     /***************************************************************/ 04689000
*     /*                                                             */ 04690000
*     /* THE REPORT IS NOT FINISHED SO, INCREMENT THE MRGBLK @Y30LB38*/ 04691000
*     /* POINTER BY THE LENGTH IN ITEMLEN AND SUBTRACT ONE FROM THE  */ 04692000
*     /* MRGCNT FIELD.                                       @Y30LB38*/ 04693000
*     /*                                                             */ 04694000
*     /***************************************************************/ 04695000
*                                                                  1296 04696000
*     ELSE                                                         1296 04697000
*       DO;                         /*                       @Y30LB38*/ 04698000
         B     @RC01286                                            1296 04699000
@RF01286 DS    0H                                                  1297 04700000
*         MRGBLKS(I2)=MRGBLKS(I2)+ITEMLEN;/*                 @Y30LB38*/ 04701000
         LH    @07,I2                                              1297 04702000
         SLA   @07,2                                               1297 04703000
         SLR   @15,@15                                             1297 04704000
         IC    @15,ITEMLEN                                         1297 04705000
         AL    @15,MRGBLKS-4(@07)                                  1297 04706000
         ST    @15,MRGBLKS-4(@07)                                  1297 04707000
*         MRGCOUNT(I2)=MRGCOUNT(I2)-ONE;/*                   @Y30LB38*/ 04708000
         L     @15,MRGCOUNT-4(@07)                                 1298 04709000
         BCTR  @15,0                                               1298 04710000
         ST    @15,MRGCOUNT-4(@07)                                 1298 04711000
*       END;                        /*                       @Y30LB38*/ 04712000
*   END;                            /*                       @Y30LB38*/ 04713000
*                                                                  1300 04714000
@RC01286 DS    0H                                                  1300 04715000
@DE01275 CLC   NEWENT(12),STARTVAL                                 1300 04716000
         BNE   @DL01275                                            1300 04717000
*   /*****************************************************************/ 04718000
*   /*                                                               */ 04719000
*   /* ISSUE THE UPRINT MACRO TO PRINT THE TOTAL LINES       @Y30LB38*/ 04720000
*   /* AFTER EACH REPORT. IF THE TBLID IS VOLUME INVENTORY USE STID  */ 04721000
*   /* LMO10, IF THE TBLID IS TRANSIENT VOLUME USE STID LMO09        */ 04722000
*   /* OTHERWISE USE STID LMO11.                             @Y30LB38*/ 04723000
*   /* THE TOTALS WILL NOT BE PRINTED IF THE SUMARY          @Y30LB38*/ 04724000
*   /* KEYWORD ONLY IS SPECIFIED.                            @Y30LB38*/ 04725000
*   /*                                                               */ 04726000
*   /*****************************************************************/ 04727000
*                                                                  1301 04728000
*   PRINTAB=''B;                    /*                       @Y30LB38*/ 04729000
         XC    PRINTAB(84),PRINTAB                                 1301 04730000
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/ 04731000
         L     @07,DDSTRU                                          1302 04732000
         MVC   DARGSMOD(3,@07),@CC01483                            1302 04733000
*   IF TBLID=VOLINVID&(ADDR(MNT)^=NULLPTR|ADDR(AL)^=NULLPTR) THEN  1303 04734000
         CLI   TBLID,3                                             1303 04735000
         BNE   @RF01303                                            1303 04736000
         SLR   @07,@07                                             1303 04737000
         L     @15,@PC00001+4                                      1303 04738000
         C     @07,FDTPTR+8(,@15)                                  1303 04739000
         BNE   @RT01303                                            1303 04740000
         C     @07,FDTPTR+24(,@15)                                 1303 04741000
         BE    @RF01303                                            1303 04742000
@RT01303 DS    0H                                                  1304 04743000
*     DO;                           /*                       @Y30LB38*/ 04744000
*       DARGDBP=ADDR(VICNTR);       /*                       @Y30LB38*/ 04745000
         L     @07,DDSTRU                                          1305 04746000
         LA    @15,VICNTR                                          1305 04747000
         ST    @15,DARGDBP(,@07)                                   1305 04748000
*       DARGSENT=LMO10;             /*                       @Y30LB38*/ 04749000
         MVI   DARGSENT(@07),X'0A'                                 1306 04750000
*       DARGILP=LENGTH(VICNTR);     /*                       @Y30LB38*/ 04751000
         MVC   DARGILP(2,@07),@CH00043                             1307 04752000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 04753000
         L     @07,@PC00001                                        1308 04754000
         ST    @07,@AL00001                                        1308 04755000
         LA    @15,PRINTME                                         1308 04756000
         ST    @15,@AL00001+4                                      1308 04757000
         LA    @15,DDSTRU                                          1308 04758000
         ST    @15,@AL00001+8                                      1308 04759000
         MVI   @AL00001+8,X'80'                                    1308 04760000
         L     @15,GDTPRT(,@07)                                    1308 04761000
         LA    @01,@AL00001                                        1308 04762000
         BALR  @14,@15                                             1308 04763000
*     END;                          /*                       @Y30LB38*/ 04764000
*   IF TBLID=TRANID&(ADDR(NMNT)^=NULLPTR|ADDR(AL)^=NULLPTR) THEN   1310 04765000
@RF01303 CLI   TBLID,2                                             1310 04766000
         BNE   @RF01310                                            1310 04767000
         SLR   @07,@07                                             1310 04768000
         L     @15,@PC00001+4                                      1310 04769000
         C     @07,FDTPTR+12(,@15)                                 1310 04770000
         BNE   @RT01310                                            1310 04771000
         C     @07,FDTPTR+24(,@15)                                 1310 04772000
         BE    @RF01310                                            1310 04773000
@RT01310 DS    0H                                                  1311 04774000
*     DO;                           /*                       @Y30LB38*/ 04775000
*       DARGDBP=ADDR(TVCNTR);       /*                       @Y30LB38*/ 04776000
         L     @07,DDSTRU                                          1312 04777000
         LA    @15,TVCNTR                                          1312 04778000
         ST    @15,DARGDBP(,@07)                                   1312 04779000
*       DARGSENT=LMO09;             /*                       @Y30LB38*/ 04780000
         MVI   DARGSENT(@07),X'09'                                 1313 04781000
*       DARGILP=LENGTH(TVCNTR);     /*                       @Y30LB38*/ 04782000
         MVC   DARGILP(2,@07),@CH00043                             1314 04783000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 04784000
         L     @07,@PC00001                                        1315 04785000
         ST    @07,@AL00001                                        1315 04786000
         LA    @15,PRINTME                                         1315 04787000
         ST    @15,@AL00001+4                                      1315 04788000
         LA    @15,DDSTRU                                          1315 04789000
         ST    @15,@AL00001+8                                      1315 04790000
         MVI   @AL00001+8,X'80'                                    1315 04791000
         L     @15,GDTPRT(,@07)                                    1315 04792000
         LA    @01,@AL00001                                        1315 04793000
         BALR  @14,@15                                             1315 04794000
*     END;                          /*                       @Y30LB38*/ 04795000
*   IF TBLID=CARTID&(ADDR(CART)^=NULLPTR|ADDR(AL)^=NULLPTR) THEN   1317 04796000
@RF01310 CLI   TBLID,4                                             1317 04797000
         BNE   @RF01317                                            1317 04798000
         SLR   @07,@07                                             1317 04799000
         L     @15,@PC00001+4                                      1317 04800000
         C     @07,FDTPTR+16(,@15)                                 1317 04801000
         BNE   @RT01317                                            1317 04802000
         C     @07,FDTPTR+24(,@15)                                 1317 04803000
         BE    @RF01317                                            1317 04804000
@RT01317 DS    0H                                                  1318 04805000
*     DO;                           /*                       @Y30LB38*/ 04806000
*       DARGDBP=ADDR(SCCNTR);       /*                       @Y30LB38*/ 04807000
         L     @07,DDSTRU                                          1319 04808000
         LA    @15,SCCNTR                                          1319 04809000
         ST    @15,DARGDBP(,@07)                                   1319 04810000
*       DARGSENT=LMO11;             /*                       @Y30LB38*/ 04811000
         MVI   DARGSENT(@07),X'0B'                                 1320 04812000
*       DARGILP=LENGTH(SCCNTR);     /*                       @Y30LB38*/ 04813000
         MVC   DARGILP(2,@07),@CH00043                             1321 04814000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 04815000
         L     @07,@PC00001                                        1322 04816000
         ST    @07,@AL00001                                        1322 04817000
         LA    @15,PRINTME                                         1322 04818000
         ST    @15,@AL00001+4                                      1322 04819000
         LA    @15,DDSTRU                                          1322 04820000
         ST    @15,@AL00001+8                                      1322 04821000
         MVI   @AL00001+8,X'80'                                    1322 04822000
         L     @15,GDTPRT(,@07)                                    1322 04823000
         LA    @01,@AL00001                                        1322 04824000
         BALR  @14,@15                                             1322 04825000
*     END;                          /*                       @Y30LB38*/ 04826000
*   REG14=RETADDR3;                 /*                       @Y30LB38*/ 04827000
@RF01317 L     REG14,RETADDR3                                      1324 04828000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 04829000
         SLR   @15,@15                                             1325 04830000
@EL00013 DS    0H                                                  1325 04831000
@EF00013 DS    0H                                                  1325 04832000
@ER00013 BR    @14                                                 1325 04833000
*   END RPTPRNTR;                   /*                       @Y30LB38*/ 04834000
*                                                                  1327 04835000
*/********************************************************************/ 04836000
*/*                                                          @Y30LB38*/ 04837000
*/*     PROCEDURE NAME - RPTFMTR                             @Y30LB38*/ 04838000
*/*                                                          @Y30LB38*/ 04839000
*/*     FUNCTION - THIS ROUTINE PLACES AN ENTRY, PASSED IN   @Y30LB38*/ 04840000
*/*                THE FIELD NEWENT, INTO THE PRINT BUFFER.  @Y30LB38*/ 04841000
*/*                THE PRINT BUFFER IS LARGE ENOUGH TO       @Y30LB38*/ 04842000
*/*                CONTAIN ENOUGH ENTRIES TO FILL THE        @Y30LB38*/ 04843000
*/*                LARGEST REPORT PAGE.  THE ENTRY MUST BE   @Y30LB38*/ 04844000
*/*                FORMATTED INTO AN ENTRY LOCATION IN THE   @Y30LB38*/ 04845000
*/*                PRINT BUFFER ACCORDING TO THE TBLID.      @Y30LB38*/ 04846000
*/*                WHEN THE PRINT BUFFER IS FULL, THE        @Y30LB38*/ 04847000
*/*                ROUTINE ISSUES UPRINT TO PRINT A PAGE.    @Y30LB38*/ 04848000
*/*                IF THE INPUT ENTRY IS FF'S, THE BUFFER    @Y30LB38*/ 04849000
*/*                MUST BE FILLED WITH BLANKS TO COMPLETE    @Y30LB38*/ 04850000
*/*                THE LAST LINE.                            @Y30LB38*/ 04851000
*/*                                                          @Y30LB38*/ 04852000
*/*     INPUT - WORK AREA CALLED INTTBL                      @Y30LB38*/ 04853000
*/*                                                          @Y30LB38*/ 04854000
*/*     OUTPUT - PRINTED REPORT AND A 0 RETURN CODE          @Y30LB38*/ 04855000
*/*                                                          @Y30LB38*/ 04856000
*/********************************************************************/ 04857000
*                                                                  1327 04858000
*RPTFMTR:                                                          1327 04859000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 04860000
*                                                                  1327 04861000
RPTFMTR  DS    0H                                                  1328 04862000
*   /*****************************************************************/ 04863000
*   /*                                                               */ 04864000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 04865000
*   /*                                                               */ 04866000
*   /*****************************************************************/ 04867000
*                                                                  1328 04868000
*   DCL                                                            1328 04869000
*     MRGEPTR PTR(31);              /* BASED ENTRY PTR       @Y30LB38*/ 04870000
*   DCL                                                            1329 04871000
*     LMO13 FIXED(8) CONSTANT(13);  /* LMO STID 13           @Y30LB38*/ 04872000
*   DCL                                                            1330 04873000
*     LMO14 FIXED(8) CONSTANT(14);  /* LMO STID 14           @Y30LB38*/ 04874000
*   DCL                                                            1331 04875000
*     LMO15 FIXED(8) CONSTANT(15);  /* LMO STID 15           @Y30LB38*/ 04876000
*                                                                  1331 04877000
*   /*****************************************************************/ 04878000
*   /*                                                               */ 04879000
*   /* DECLARE DSECT TO MAP VOLUME INVENTORY ENTRY IN THE    @Y30LB38*/ 04880000
*   /* MERGE BLOCK.                                          @Y30LB38*/ 04881000
*   /*                                                               */ 04882000
*   /*****************************************************************/ 04883000
*                                                                  1332 04884000
*   DCL                                                            1332 04885000
*     1 VIBLKENT CHAR(12) BASED(MRGEPTR),/*                  @Y30LB38*/ 04886000
*       3 VIBLKSN CHAR(6),          /* VOL SER NUM           @Y30LB38*/ 04887000
*       3 VIVLKFLG BIT(8),          /* ATTRIBUTE FLAGS       @Y30LB38*/ 04888000
*         5 * BIT(2),                                              1332 04889000
*         5 VIBLKSV BIT(1),         /* SECURE VOLUME FLAG    @Y30LB38*/ 04890000
*         5 VIBLKEV BIT(1),         /* EXCLUSIV VOLUME       @Y30LB38*/ 04891000
*         5 * BIT(1),                                              1332 04892000
*         5 VIBLKBND BIT(1),        /* BOUND VOLUME          @Y30LB38*/ 04893000
*         5 VIBLKWI BIT(1),         /* WRITE INHIBIT         @Y30LB38*/ 04894000
*         5 * BIT(1),               /* UNUSED                @ZM00986*/ 04895000
*       3 * CHAR(1),                /* UNUSED                @ZM00986*/ 04896000
*       3 * BIT(16),                /* ADDR OF CART ONE      @Y30LB38*/ 04897000
*         5 VIBLKONE BIT(8),                                       1332 04898000
*           7 VIBLKMS1 BIT(2),      /* MSF NUMBER            @Y30LB38*/ 04899000
*           7 VIBLKZ1 BIT(1),       /* CELL LOCATION         @Y30LB38*/ 04900000
*           7 VIBLKY1 BIT(5),       /*                       @Y30LB38*/ 04901000
*         5 VIBLKX1 BIT(8),         /*                       @Y30LB38*/ 04902000
*       3 * BIT(16),                /* ADDR OF CART TWO      @Y30LB38*/ 04903000
*         5 VIBLKTWO BIT(8),                                       1332 04904000
*           7 VIBLKMS2 BIT(2),      /* MSF NUMBER            @Y30LB38*/ 04905000
*           7 VIBLKZ2 BIT(1),       /* CELL LOCATION         @Y30LB38*/ 04906000
*           7 VIBLKY2 BIT(5),       /*                       @Y30LB38*/ 04907000
*         5 VIBLKX2 BIT(8);         /*                       @Y30LB38*/ 04908000
*                                                                  1332 04909000
*   /*****************************************************************/ 04910000
*   /*                                                               */ 04911000
*   /* DECLARE DSECT TO MAP TRANSIENT VOLUME ENTRY IN THE    @Y30LB38*/ 04912000
*   /* MERGE BLOCK.                                          @Y30LB38*/ 04913000
*   /*                                                               */ 04914000
*   /*****************************************************************/ 04915000
*                                                                  1333 04916000
*   DCL                                                            1333 04917000
*     1 TVBLKENT CHAR(23) BASED(MRGEPTR),/*                  @Y30LB38*/ 04918000
*       3 TVBLKSN CHAR(6),          /* VOL SER NUM           @Y30LB38*/ 04919000
*       3 TVBLKCS CHAR(12),         /* CARTRIDGE SER NUM     @Y30LB38*/ 04920000
*       3 * BIT(16),                /* ADDR OF CART ONE      @Y30LB38*/ 04921000
*         5 TVBLKONE BIT(8),                                       1333 04922000
*           7 TVBLKMS1 BIT(2),      /* MSF NUMBER            @Y30LB38*/ 04923000
*           7 TVBLKZ1 BIT(1),       /* CELL LOCATION         @Y30LB38*/ 04924000
*           7 TVBLKY1 BIT(5),       /*                       @Y30LB38*/ 04925000
*         5 TVBLKX1 BIT(8),         /*                       @Y30LB38*/ 04926000
*       3 * BIT(16),                /* ADDR OF CART TWO      @Y30LB38*/ 04927000
*         5 TVBLKTWO BIT(8),                                       1333 04928000
*           7 TVBLKMS2 BIT(2),      /* MSF NUMBER            @Y30LB38*/ 04929000
*           7 TVBLKZ2 BIT(1),       /* CELL LOCATION         @Y30LB38*/ 04930000
*           7 TVBLKY2 BIT(5),       /*                       @Y30LB38*/ 04931000
*         5 TVBLKX2 BIT(8),         /*                       @Y30LB38*/ 04932000
*       3 TVVLKFLG BIT(8),          /* ATTRIBUTE FLAGS       @Y30LB38*/ 04933000
*         5 * BIT(2),                                              1333 04934000
*         5 TVBLKSV BIT(1),         /* SECURE VOLUME FLAG    @Y30LB38*/ 04935000
*         5 TVBLKEV BIT(1),         /* EXCLUSIV VOLUME       @Y30LB38*/ 04936000
*         5 * BIT(1),                                              1333 04937000
*         5 TVBLKBND BIT(1),        /* BOUND VOLUME          @Y30LB38*/ 04938000
*         5 TVBLKWI BIT(1);         /* WRITE INHIBIT         @Y30LB38*/ 04939000
*                                                                  1333 04940000
*   /*****************************************************************/ 04941000
*   /*                                                               */ 04942000
*   /* DECLARE DSECT TO MAP SCRATCH CARTRIDGE LIST ENTRY     @Y30LB38*/ 04943000
*   /* IN THE MERGE BLOCK.                                   @Y30LB38*/ 04944000
*   /*                                                               */ 04945000
*   /*****************************************************************/ 04946000
*                                                                  1334 04947000
*   DCL                                                            1334 04948000
*     1 SCBLKENT CHAR(14) BASED(MRGEPTR),                          1334 04949000
*       3 SCBLKCS CHAR(12),         /* CARTRIDGE SER NUM     @Y30LB38*/ 04950000
*       3 * BIT(16),                /* ADDR OF CART ONE      @Y30LB38*/ 04951000
*         5 SCBLKONE BIT(8),                                       1334 04952000
*           7 SCBLKMS1 BIT(2),      /* MSF NUMBER            @Y30LB38*/ 04953000
*           7 SCBLKZ1 BIT(1),       /* CELL LOCATION         @Y30LB38*/ 04954000
*           7 SCBLKY1 BIT(5),       /*                       @Y30LB38*/ 04955000
*         5 SCBLKX1 BIT(8);         /*                       @Y30LB38*/ 04956000
*                                                                  1335 04957000
*   /*****************************************************************/ 04958000
*   /*                                                               */ 04959000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 04960000
*   /*                                                               */ 04961000
*   /*****************************************************************/ 04962000
*                                                                  1335 04963000
*   RETADDR4=REG14;                 /*                       @Y30LB38*/ 04964000
         ST    REG14,RETADDR4                                      1335 04965000
*   OLDERID2=NEWERID2;                                             1336 04966000
         L     @07,@PC00001                                        1336 04967000
         L     @07,GDTTR2(,@07)                                    1336 04968000
         MVC   @TS00001(95),NEWERID2(@07)                          1336 04969000
         MVC   OLDERID2(95,@07),@TS00001                           1336 04970000
*   NEWID2='LMNA';                  /*                       @Y30LB38*/ 04971000
*                                                                  1337 04972000
         MVC   NEWID2(4,@07),@CC01753                              1337 04973000
*   /*****************************************************************/ 04974000
*   /*                                                               */ 04975000
*   /* IF THE NEWENT FIELD DOES NOT CONTAIN FF'S AND THE     @Y30LB38*/ 04976000
*   /* TBLID = VOLUME INVENTORY,PLACE THE NEWENT FIELDS IN THE PRINT */ 04977000
*   /* BUFFER. THE ATTRIBUTE FLAGS AND THE CELL LOCATION FIELDS MUST */ 04978000
*   /* BE REFORMATED TO ONE BYTE FIELDS IN THE BUFFER.       @Y30LB38*/ 04979000
*   /*                                                               */ 04980000
*   /*****************************************************************/ 04981000
*                                                                  1338 04982000
*   IF NEWENT(1:12)^=STARTVAL&TBLID=VOLINVID THEN                  1338 04983000
         CLC   NEWENT(12),STARTVAL                                 1338 04984000
         BE    @RF01338                                            1338 04985000
         CLI   TBLID,3                                             1338 04986000
         BNE   @RF01338                                            1338 04987000
*     DO;                           /*                       @Y30LB38*/ 04988000
*       BUFFCNTR=BUFFCNTR+ONE;      /*                       @Y30LB38*/ 04989000
         LA    @07,1                                               1340 04990000
         ALR   BUFFCNTR,@07                                        1340 04991000
*       ENTCNTR=ENTCNTR+ONE;        /*                       @Y30LB38*/ 04992000
         AL    @07,ENTCNTR                                         1341 04993000
         ST    @07,ENTCNTR                                         1341 04994000
*       MRGEPTR=ADDR(NEWENT);       /*                       @Y30LB38*/ 04995000
         LA    MRGEPTR,NEWENT                                      1342 04996000
*       VIPRTBF(BUFFCNTR)=' ';      /*                       @Y30LB38*/ 04997000
*                                                                  1343 04998000
         LR    @07,BUFFCNTR                                        1343 04999000
         SLA   @07,4                                               1343 05000000
         ST    @07,@TF00001                                        1343 05001000
         ALR   @07,PRINTPTR                                        1343 05002000
         AL    @07,@CF01857                                        1343 05003000
         MVI   VIPRTBF+1(@07),C' '                                 1343 05004000
         MVC   VIPRTBF+2(14,@07),VIPRTBF+1(@07)                    1343 05005000
         MVI   VIPRTBF(@07),C' '                                   1343 05006000
*       /*************************************************************/ 05007000
*       /*                                                           */ 05008000
*       /* PUT VOLUME SERIAL NUMBER IN BUFFER                @Y30LB38*/ 05009000
*       /*                                                           */ 05010000
*       /*************************************************************/ 05011000
*                                                                  1344 05012000
*       VIPRTSN(BUFFCNTR)=VIBLKSN;  /*                       @Y30LB38*/ 05013000
*                                                                  1344 05014000
         LR    @07,PRINTPTR                                        1344 05015000
         AL    @07,@TF00001                                        1344 05016000
         AL    @07,@CF01857                                        1344 05017000
         MVC   VIPRTSN(6,@07),VIBLKSN(MRGEPTR)                     1344 05018000
*       /*************************************************************/ 05019000
*       /*                                                           */ 05020000
*       /* TRANSLATE THE ATTRIBUTE FLAGS AND PUT VALUES      @Y30LB38*/ 05021000
*       /* IN BUFFER.                                        @Y30LB38*/ 05022000
*       /*                                                           */ 05023000
*       /*************************************************************/ 05024000
*                                                                  1345 05025000
*       IF VIBLKBND=ON THEN                                        1345 05026000
         TM    VIBLKBND(MRGEPTR),B'00000100'                       1345 05027000
         BNO   @RF01345                                            1345 05028000
*         VIPRTB(BUFFCNTR)=PRINTB;  /*                       @Y30LB38*/ 05029000
         LR    @07,PRINTPTR                                        1346 05030000
         AL    @07,@TF00001                                        1346 05031000
         AL    @07,@CF01858                                        1346 05032000
         MVC   VIPRTB-6(1,@07),PRINTB                              1346 05033000
*       IF VIBLKWI=ON THEN                                         1347 05034000
@RF01345 TM    VIBLKWI(MRGEPTR),B'00000010'                        1347 05035000
         BNO   @RF01347                                            1347 05036000
*         VIPRTR(BUFFCNTR)=PRINTR;  /*                       @Y30LB38*/ 05037000
         LR    @07,BUFFCNTR                                        1348 05038000
         SLA   @07,4                                               1348 05039000
         ALR   @07,PRINTPTR                                        1348 05040000
         AL    @07,@CF01859                                        1348 05041000
         MVC   VIPRTR-7(1,@07),PRINTR                              1348 05042000
*       IF VIBLKSV=ON THEN                                         1349 05043000
@RF01347 TM    VIBLKSV(MRGEPTR),B'00100000'                        1349 05044000
         BNO   @RF01349                                            1349 05045000
*         VIPRTD(BUFFCNTR)=PRINTD;  /*                       @Y30LB38*/ 05046000
         LR    @07,BUFFCNTR                                        1350 05047000
         SLA   @07,4                                               1350 05048000
         ALR   @07,PRINTPTR                                        1350 05049000
         AL    @07,@CF01860                                        1350 05050000
         MVC   VIPRTD-8(1,@07),PRINTD                              1350 05051000
*       IF VIBLKEV=ON THEN                                         1351 05052000
@RF01349 TM    VIBLKEV(MRGEPTR),B'00010000'                        1351 05053000
         BNO   @RF01351                                            1351 05054000
*         VIPRTE(BUFFCNTR)=PRINTE;  /*                       @Y30LB38*/ 05055000
*                                                                  1352 05056000
         LR    @07,BUFFCNTR                                        1352 05057000
         SLA   @07,4                                               1352 05058000
         ALR   @07,PRINTPTR                                        1352 05059000
         AL    @07,@CF01861                                        1352 05060000
         MVC   VIPRTE-9(1,@07),PRINTE                              1352 05061000
*       /*************************************************************/ 05062000
*       /*                                                           */ 05063000
*       /* TRANSLATE THE CELL LOCATION FOR THE FIRST CART    @Y30LB38*/ 05064000
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/ 05065000
*       /*                                                           */ 05066000
*       /*************************************************************/ 05067000
*                                                                  1353 05068000
*       VIPRTX1(BUFFCNTR)=VIBLKX1;  /*                       @Y30LB38*/ 05069000
@RF01351 LR    @07,BUFFCNTR                                        1353 05070000
         SLA   @07,4                                               1353 05071000
         SLR   @03,@03                                             1353 05072000
         IC    @03,VIBLKX1(,MRGEPTR)                               1353 05073000
         LR    @01,PRINTPTR                                        1353 05074000
         AL    @01,@CF01862                                        1353 05075000
         STC   @03,VIPRTX1-10(@07,@01)                             1353 05076000
*       VIPRTY1(BUFFCNTR)=VIBLKONE; /*                       @Y30LB38*/ 05077000
         SLR   @03,@03                                             1354 05078000
         IC    @03,VIBLKONE(,MRGEPTR)                              1354 05079000
         LR    @01,PRINTPTR                                        1354 05080000
         AL    @01,@CF01847                                        1354 05081000
         STC   @03,VIPRTY1-11(@07,@01)                             1354 05082000
*       VIBIT11(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05083000
*       VIBIT12(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05084000
         ST    @07,@TF00001                                        1356 05085000
         ALR   @07,PRINTPTR                                        1356 05086000
         AL    @07,@CF01847                                        1356 05087000
         NI    VIBIT11-11(@07),B'00111111'                         1356 05088000
*       VIPRT1(BUFFCNTR)=''B;       /*                       @Y30LB38*/ 05089000
         SLR   @07,@07                                             1357 05090000
         L     @03,@TF00001                                        1357 05091000
         AL    @03,@CF01863                                        1357 05092000
         STC   @07,VIPRT1-12(@03,PRINTPTR)                         1357 05093000
*       IF VIBLKZ1=ON THEN                                         1358 05094000
         TM    VIBLKZ1(MRGEPTR),B'00100000'                        1358 05095000
         BNO   @RF01358                                            1358 05096000
*         VIPRTZ1(BUFFCNTR)=ON;     /*                       @Y30LB38*/ 05097000
         LR    @07,PRINTPTR                                        1359 05098000
         AL    @07,@TF00001                                        1359 05099000
         AL    @07,@CF01863                                        1359 05100000
         OI    VIPRTZ1-12(@07),B'00000001'                         1359 05101000
*       VIBIT13(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05102000
*                                                                  1360 05103000
@RF01358 LR    @07,BUFFCNTR                                        1360 05104000
         SLA   @07,4                                               1360 05105000
         ST    @07,@TF00001                                        1360 05106000
         ALR   @07,PRINTPTR                                        1360 05107000
         AL    @07,@CF01847                                        1360 05108000
         NI    VIBIT13-11(@07),B'11011111'                         1360 05109000
*       /*************************************************************/ 05110000
*       /*                                                           */ 05111000
*       /* TRANSLATE THE CELL LOCATION FOR THE SECOND CART   @Y30LB38*/ 05112000
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/ 05113000
*       /*                                                           */ 05114000
*       /*************************************************************/ 05115000
*                                                                  1361 05116000
*       VIPRTX2(BUFFCNTR)=VIBLKX2;  /*                       @Y30LB38*/ 05117000
         SLR   @07,@07                                             1361 05118000
         IC    @07,VIBLKX2(,MRGEPTR)                               1361 05119000
         L     @03,@TF00001                                        1361 05120000
         AL    @03,@CF01865                                        1361 05121000
         STC   @07,VIPRTX2-13(@03,PRINTPTR)                        1361 05122000
*       VIPRTY2(BUFFCNTR)=VIBLKTWO; /*                       @Y30LB38*/ 05123000
         SLR   @07,@07                                             1362 05124000
         IC    @07,VIBLKTWO(,MRGEPTR)                              1362 05125000
         L     @03,@TF00001                                        1362 05126000
         AL    @03,@CF01866                                        1362 05127000
         STC   @07,VIPRTY2-14(@03,PRINTPTR)                        1362 05128000
*       VIBIT21(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05129000
*       VIBIT22(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05130000
         LR    @07,PRINTPTR                                        1364 05131000
         AL    @07,@TF00001                                        1364 05132000
         AL    @07,@CF01866                                        1364 05133000
         NI    VIBIT21-14(@07),B'00111111'                         1364 05134000
*       VIPRT2(BUFFCNTR)=''B;       /*                       @Y30LB38*/ 05135000
         SLR   @07,@07                                             1365 05136000
         L     @03,@TF00001                                        1365 05137000
         AL    @03,@CF01867                                        1365 05138000
         STC   @07,VIPRT2-15(@03,PRINTPTR)                         1365 05139000
*       IF VIBLKZ2=ON THEN                                         1366 05140000
         TM    VIBLKZ2(MRGEPTR),B'00100000'                        1366 05141000
         BNO   @RF01366                                            1366 05142000
*         VIPRTZ2(BUFFCNTR)=ON;     /*                       @Y30LB38*/ 05143000
         LR    @07,PRINTPTR                                        1367 05144000
         AL    @07,@TF00001                                        1367 05145000
         AL    @07,@CF01867                                        1367 05146000
         OI    VIPRTZ2-15(@07),B'00000001'                         1367 05147000
*       VIBIT23(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05148000
@RF01366 LR    @07,BUFFCNTR                                        1368 05149000
         SLA   @07,4                                               1368 05150000
         ALR   @07,PRINTPTR                                        1368 05151000
         AL    @07,@CF01866                                        1368 05152000
         NI    VIBIT23-14(@07),B'11011111'                         1368 05153000
*     END;                          /*                       @Y30LB38*/ 05154000
*                                                                  1369 05155000
*   /*****************************************************************/ 05156000
*   /*                                                               */ 05157000
*   /* IF THE NEWENT FIELD DOES NOT CONTAIN FF'S AND THE     @Y30LB38*/ 05158000
*   /* TBLID = TRANSIENT VOLUME,PLACE THE NEWENT FIELDS IN THE PRINT */ 05159000
*   /* BUFFER. THE ATTRIBUTE FLAGS AND THE CELL LOCATION FIELDS MUST */ 05160000
*   /* BE REFORMATED TO ONE BYTE FIELDS IN THE BUFFER.       @Y30LB38*/ 05161000
*   /*                                                               */ 05162000
*   /*****************************************************************/ 05163000
*                                                                  1370 05164000
*   IF NEWENT(1:12)^=STARTVAL&TBLID=TRANID THEN                    1370 05165000
@RF01338 CLC   NEWENT(12),STARTVAL                                 1370 05166000
         BE    @RF01370                                            1370 05167000
         CLI   TBLID,2                                             1370 05168000
         BNE   @RF01370                                            1370 05169000
*     DO;                           /*                       @Y30LB38*/ 05170000
*       BUFFCNTR=BUFFCNTR+ONE;      /*                       @Y30LB38*/ 05171000
         LA    @07,1                                               1372 05172000
         ALR   BUFFCNTR,@07                                        1372 05173000
*       ENTCNTR=ENTCNTR+ONE;        /*                       @Y30LB38*/ 05174000
         AL    @07,ENTCNTR                                         1373 05175000
         ST    @07,ENTCNTR                                         1373 05176000
*       MRGEPTR=ADDR(NEWENT);       /*                       @Y30LB38*/ 05177000
         LA    MRGEPTR,NEWENT                                      1374 05178000
*       TVPRTBF(BUFFCNTR)=' ';      /*                       @Y30LB38*/ 05179000
*                                                                  1375 05180000
         LR    @07,BUFFCNTR                                        1375 05181000
         MH    @07,@CH01312                                        1375 05182000
         ST    @07,@TF00001                                        1375 05183000
         ALR   @07,PRINTPTR                                        1375 05184000
         AL    @07,@CF01868                                        1375 05185000
         MVI   TVPRTBF+1(@07),C' '                                 1375 05186000
         MVC   TVPRTBF+2(26,@07),TVPRTBF+1(@07)                    1375 05187000
         MVI   TVPRTBF(@07),C' '                                   1375 05188000
*       /*************************************************************/ 05189000
*       /*                                                           */ 05190000
*       /* PUT VOLUME SERIAL NUMBER IN BUFFER                @Y30LB38*/ 05191000
*       /*                                                           */ 05192000
*       /*************************************************************/ 05193000
*                                                                  1376 05194000
*       TVPRTSN(BUFFCNTR)=TVBLKSN;  /*                       @Y30LB38*/ 05195000
*                                                                  1376 05196000
         LR    @07,PRINTPTR                                        1376 05197000
         AL    @07,@TF00001                                        1376 05198000
         AL    @07,@CF01868                                        1376 05199000
         MVC   TVPRTSN(6,@07),TVBLKSN(MRGEPTR)                     1376 05200000
*       /*************************************************************/ 05201000
*       /*                                                           */ 05202000
*       /* PUT THE CARTRIDGE SERIAL NUMBER IN THE BUFFER     @Y30LB38*/ 05203000
*       /*                                                           */ 05204000
*       /*************************************************************/ 05205000
*                                                                  1377 05206000
*       TVPRTCS(BUFFCNTR)=TVBLKCS;  /*                       @Y30LB38*/ 05207000
*                                                                  1377 05208000
         LR    @07,PRINTPTR                                        1377 05209000
         AL    @07,@TF00001                                        1377 05210000
         AL    @07,@CF01869                                        1377 05211000
         MVC   TVPRTCS-6(12,@07),TVBLKCS(MRGEPTR)                  1377 05212000
*       /*************************************************************/ 05213000
*       /*                                                           */ 05214000
*       /* TRANSLATE THE ATTRIBUTE FLAGS AND PUT VALUES      @Y30LB38*/ 05215000
*       /* IN BUFFER.                                        @Y30LB38*/ 05216000
*       /*                                                           */ 05217000
*       /*************************************************************/ 05218000
*                                                                  1378 05219000
*       IF TVBLKBND=ON THEN                                        1378 05220000
         TM    TVBLKBND(MRGEPTR),B'00000100'                       1378 05221000
         BNO   @RF01378                                            1378 05222000
*         TVPRTB(BUFFCNTR)=PRINTB;  /*                       @Y30LB38*/ 05223000
         LR    @07,PRINTPTR                                        1379 05224000
         AL    @07,@TF00001                                        1379 05225000
         AL    @07,@CF01858                                        1379 05226000
         MVC   TVPRTB-18(1,@07),PRINTB                             1379 05227000
*       IF TVBLKWI=ON THEN                                         1380 05228000
@RF01378 TM    TVBLKWI(MRGEPTR),B'00000010'                        1380 05229000
         BNO   @RF01380                                            1380 05230000
*         TVPRTR(BUFFCNTR)=PRINTR;  /*                       @Y30LB38*/ 05231000
         LR    @07,BUFFCNTR                                        1381 05232000
         MH    @07,@CH01312                                        1381 05233000
         ALR   @07,PRINTPTR                                        1381 05234000
         AL    @07,@CF01859                                        1381 05235000
         MVC   TVPRTR-19(1,@07),PRINTR                             1381 05236000
*       IF TVBLKSV=ON THEN                                         1382 05237000
@RF01380 TM    TVBLKSV(MRGEPTR),B'00100000'                        1382 05238000
         BNO   @RF01382                                            1382 05239000
*         TVPRTD(BUFFCNTR)=PRINTD;  /*                       @Y30LB38*/ 05240000
         LR    @07,BUFFCNTR                                        1383 05241000
         MH    @07,@CH01312                                        1383 05242000
         ALR   @07,PRINTPTR                                        1383 05243000
         AL    @07,@CF01860                                        1383 05244000
         MVC   TVPRTD-20(1,@07),PRINTD                             1383 05245000
*       IF TVBLKEV=ON THEN                                         1384 05246000
@RF01382 TM    TVBLKEV(MRGEPTR),B'00010000'                        1384 05247000
         BNO   @RF01384                                            1384 05248000
*         TVPRTE(BUFFCNTR)=PRINTE;  /*                       @Y30LB38*/ 05249000
*                                                                  1385 05250000
         LR    @07,BUFFCNTR                                        1385 05251000
         MH    @07,@CH01312                                        1385 05252000
         ALR   @07,PRINTPTR                                        1385 05253000
         AL    @07,@CF01861                                        1385 05254000
         MVC   TVPRTE-21(1,@07),PRINTE                             1385 05255000
*       /*************************************************************/ 05256000
*       /*                                                           */ 05257000
*       /* TRANSLATE THE CELL LOCATION FOR THE FIRST CART    @Y30LB38*/ 05258000
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/ 05259000
*       /*                                                           */ 05260000
*       /*************************************************************/ 05261000
*                                                                  1386 05262000
*       TVPRTX1(BUFFCNTR)=TVBLKX1;  /*                       @Y30LB38*/ 05263000
@RF01384 LR    @07,BUFFCNTR                                        1386 05264000
         MH    @07,@CH01312                                        1386 05265000
         ST    @07,@TF00001                                        1386 05266000
         ALR   @07,PRINTPTR                                        1386 05267000
         AL    @07,@CF01862                                        1386 05268000
         MVC   TVPRTX1-22(1,@07),TVBLKX1(MRGEPTR)                  1386 05269000
*       TVPRTY1(BUFFCNTR)=TVBLKONE; /*                       @Y30LB38*/ 05270000
         LR    @07,PRINTPTR                                        1387 05271000
         AL    @07,@TF00001                                        1387 05272000
         AL    @07,@CF01847                                        1387 05273000
         MVC   TVPRTY1-23(1,@07),TVBLKONE(MRGEPTR)                 1387 05274000
*       TVBIT11(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05275000
*       TVBIT12(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05276000
         LR    @07,PRINTPTR                                        1389 05277000
         AL    @07,@TF00001                                        1389 05278000
         AL    @07,@CF01847                                        1389 05279000
         NI    TVBIT11-23(@07),B'00111111'                         1389 05280000
*       TVPRT1(BUFFCNTR)=''B;       /*                       @Y30LB38*/ 05281000
         LR    @07,PRINTPTR                                        1390 05282000
         AL    @07,@TF00001                                        1390 05283000
         AL    @07,@CF01863                                        1390 05284000
         MVI   TVPRT1-24(@07),X'00'                                1390 05285000
*       IF TVBLKZ1=ON THEN                                         1391 05286000
         TM    TVBLKZ1(MRGEPTR),B'00100000'                        1391 05287000
         BNO   @RF01391                                            1391 05288000
*         TVPRTZ1(BUFFCNTR)=ON;     /*                       @Y30LB38*/ 05289000
         LR    @07,PRINTPTR                                        1392 05290000
         AL    @07,@TF00001                                        1392 05291000
         AL    @07,@CF01863                                        1392 05292000
         OI    TVPRTZ1-24(@07),B'00000001'                         1392 05293000
*       TVBIT13(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05294000
*                                                                  1393 05295000
@RF01391 LR    @07,BUFFCNTR                                        1393 05296000
         MH    @07,@CH01312                                        1393 05297000
         ST    @07,@TF00001                                        1393 05298000
         ALR   @07,PRINTPTR                                        1393 05299000
         AL    @07,@CF01847                                        1393 05300000
         NI    TVBIT13-23(@07),B'11011111'                         1393 05301000
*       /*************************************************************/ 05302000
*       /*                                                           */ 05303000
*       /* TRANSLATE THE CELL LOCATION FOR THE SECOND CART   @Y30LB38*/ 05304000
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/ 05305000
*       /*                                                           */ 05306000
*       /*************************************************************/ 05307000
*                                                                  1394 05308000
*       TVPRTX2(BUFFCNTR)=TVBLKX2;  /*                       @Y30LB38*/ 05309000
         LR    @07,PRINTPTR                                        1394 05310000
         AL    @07,@TF00001                                        1394 05311000
         AL    @07,@CF01865                                        1394 05312000
         MVC   TVPRTX2-25(1,@07),TVBLKX2(MRGEPTR)                  1394 05313000
*       TVPRTY2(BUFFCNTR)=TVBLKTWO; /*                       @Y30LB38*/ 05314000
         LR    @07,PRINTPTR                                        1395 05315000
         AL    @07,@TF00001                                        1395 05316000
         AL    @07,@CF01866                                        1395 05317000
         MVC   TVPRTY2-26(1,@07),TVBLKTWO(MRGEPTR)                 1395 05318000
*       TVBIT21(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05319000
*       TVBIT22(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05320000
         LR    @07,PRINTPTR                                        1397 05321000
         AL    @07,@TF00001                                        1397 05322000
         AL    @07,@CF01866                                        1397 05323000
         NI    TVBIT21-26(@07),B'00111111'                         1397 05324000
*       TVPRT2(BUFFCNTR)=''B;       /*                       @Y30LB38*/ 05325000
         LR    @07,PRINTPTR                                        1398 05326000
         AL    @07,@TF00001                                        1398 05327000
         AL    @07,@CF01867                                        1398 05328000
         MVI   TVPRT2-27(@07),X'00'                                1398 05329000
*       IF TVBLKZ2=ON THEN                                         1399 05330000
         TM    TVBLKZ2(MRGEPTR),B'00100000'                        1399 05331000
         BNO   @RF01399                                            1399 05332000
*         TVPRTZ2(BUFFCNTR)=ON;     /*                       @Y30LB38*/ 05333000
         LR    @07,PRINTPTR                                        1400 05334000
         AL    @07,@TF00001                                        1400 05335000
         AL    @07,@CF01867                                        1400 05336000
         OI    TVPRTZ2-27(@07),B'00000001'                         1400 05337000
*       TVBIT23(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05338000
@RF01399 LR    @07,BUFFCNTR                                        1401 05339000
         MH    @07,@CH01312                                        1401 05340000
         ALR   @07,PRINTPTR                                        1401 05341000
         AL    @07,@CF01866                                        1401 05342000
         NI    TVBIT23-26(@07),B'11011111'                         1401 05343000
*     END;                          /*                       @Y30LB38*/ 05344000
*                                                                  1402 05345000
*   /*****************************************************************/ 05346000
*   /*                                                               */ 05347000
*   /* IF THE NEWENT FIELD DOES NOT CONTAIN FF'S AND THE     @Y30LB38*/ 05348000
*   /* TBLID = SCRATCH CARTRIDGE,PLACE THE NEWENT FIELDS IN THE PRINT*/ 05349000
*   /* BUFFER. THE CELL LOCATION FIELDS MUST BE REFORMATED TO ONE    */ 05350000
*   /* BYTE FIELDS IN THE BUFFER.                            @Y30LB38*/ 05351000
*   /*                                                               */ 05352000
*   /*****************************************************************/ 05353000
*                                                                  1403 05354000
*   IF NEWENT(1:12)^=STARTVAL&TBLID=CARTID THEN                    1403 05355000
@RF01370 CLC   NEWENT(12),STARTVAL                                 1403 05356000
         BE    @RF01403                                            1403 05357000
         CLI   TBLID,4                                             1403 05358000
         BNE   @RF01403                                            1403 05359000
*     DO;                           /*                       @Y30LB38*/ 05360000
*       BUFFCNTR=BUFFCNTR+ONE;      /*                       @Y30LB38*/ 05361000
         LA    @07,1                                               1405 05362000
         ALR   BUFFCNTR,@07                                        1405 05363000
*       ENTCNTR=ENTCNTR+ONE;        /*                       @Y30LB38*/ 05364000
         AL    @07,ENTCNTR                                         1406 05365000
         ST    @07,ENTCNTR                                         1406 05366000
*       MRGEPTR=ADDR(NEWENT);       /*                       @Y30LB38*/ 05367000
         LA    MRGEPTR,NEWENT                                      1407 05368000
*       SCPRTBF(BUFFCNTR)=' ';      /*                       @Y30LB38*/ 05369000
*                                                                  1408 05370000
         LR    @07,BUFFCNTR                                        1408 05371000
         MH    @07,@CH00229                                        1408 05372000
         ST    @07,@TF00001                                        1408 05373000
         ALR   @07,PRINTPTR                                        1408 05374000
         AL    @07,@CF01870                                        1408 05375000
         MVI   SCPRTBF+1(@07),C' '                                 1408 05376000
         MVC   SCPRTBF+2(13,@07),SCPRTBF+1(@07)                    1408 05377000
         MVI   SCPRTBF(@07),C' '                                   1408 05378000
*       /*************************************************************/ 05379000
*       /*                                                           */ 05380000
*       /* PUT THE CARTRIDGE SERIAL NUMBER IN THE BUFFER     @Y30LB38*/ 05381000
*       /*                                                           */ 05382000
*       /*************************************************************/ 05383000
*                                                                  1409 05384000
*       SCPRTCS(BUFFCNTR)=SCBLKCS;  /*                       @Y30LB38*/ 05385000
*                                                                  1409 05386000
         LR    @07,PRINTPTR                                        1409 05387000
         AL    @07,@TF00001                                        1409 05388000
         AL    @07,@CF01870                                        1409 05389000
         MVC   SCPRTCS(12,@07),SCBLKCS(MRGEPTR)                    1409 05390000
*       /*************************************************************/ 05391000
*       /*                                                           */ 05392000
*       /* TRANSLATE THE CELL LOCATION FOR THE FIRST CART    @Y30LB38*/ 05393000
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/ 05394000
*       /*                                                           */ 05395000
*       /*************************************************************/ 05396000
*                                                                  1410 05397000
*       SCPRTX1(BUFFCNTR)=SCBLKX1;  /*                       @Y30LB38*/ 05398000
         SLR   @07,@07                                             1410 05399000
         IC    @07,SCBLKX1(,MRGEPTR)                               1410 05400000
         L     @03,@TF00001                                        1410 05401000
         AL    @03,@CF01865                                        1410 05402000
         STC   @07,SCPRTX1-12(@03,PRINTPTR)                        1410 05403000
*       SCPRTY1(BUFFCNTR)=SCBLKONE; /*                       @Y30LB38*/ 05404000
         SLR   @07,@07                                             1411 05405000
         IC    @07,SCBLKONE(,MRGEPTR)                              1411 05406000
         L     @03,@TF00001                                        1411 05407000
         AL    @03,@CF01866                                        1411 05408000
         STC   @07,SCPRTY1-13(@03,PRINTPTR)                        1411 05409000
*       SCBIT11(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05410000
*       SCBIT12(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05411000
         LR    @07,PRINTPTR                                        1413 05412000
         AL    @07,@TF00001                                        1413 05413000
         AL    @07,@CF01866                                        1413 05414000
         NI    SCBIT11-13(@07),B'00111111'                         1413 05415000
*       SCPRT1(BUFFCNTR)=''B;       /*                       @Y30LB38*/ 05416000
         SLR   @07,@07                                             1414 05417000
         L     @03,@TF00001                                        1414 05418000
         AL    @03,@CF01867                                        1414 05419000
         STC   @07,SCPRT1-14(@03,PRINTPTR)                         1414 05420000
*       IF SCBLKZ1=ON THEN                                         1415 05421000
         TM    SCBLKZ1(MRGEPTR),B'00100000'                        1415 05422000
         BNO   @RF01415                                            1415 05423000
*         SCPRTZ1(BUFFCNTR)=ON;     /*                       @Y30LB38*/ 05424000
         LR    @07,PRINTPTR                                        1416 05425000
         AL    @07,@TF00001                                        1416 05426000
         AL    @07,@CF01867                                        1416 05427000
         OI    SCPRTZ1-14(@07),B'00000001'                         1416 05428000
*       SCBIT13(BUFFCNTR)=OFF;      /*                       @Y30LB38*/ 05429000
@RF01415 LR    @07,BUFFCNTR                                        1417 05430000
         MH    @07,@CH00229                                        1417 05431000
         ALR   @07,PRINTPTR                                        1417 05432000
         AL    @07,@CF01866                                        1417 05433000
         NI    SCBIT13-13(@07),B'11011111'                         1417 05434000
*     END;                          /*                       @Y30LB38*/ 05435000
*                                                                  1418 05436000
*   /*****************************************************************/ 05437000
*   /*                                                               */ 05438000
*   /* IF NEWENT = FF'S, AND THE LINCNTR IS NOT EQUAL TO     @Y30LB38*/ 05439000
*   /* ZERO AND ENTCNTR IS NOT EQUAL TO ZERO, THEN THE REPORT IS     */ 05440000
*   /* FINISHED, BUT THE PRINT BUFFER IS NOT FULL. IF THE LINCNTR IS */ 05441000
*   /* NOT ZERO, PUT IT INTO THE PRINT PARMAMETER LIST AND ISSUE THE */ 05442000
*   /* UPRINT MACRO TO FINISH PRINTING THE PRINT BUFFER. IF THE      */ 05443000
*   /* LINCNTR IS ZERO AND ENTCNTR IS NOT, CALL LASTLINR TO PRINT THE*/ 05444000
*   /* LAST LINE                                             @YM02873*/ 05445000
*   /*                                                               */ 05446000
*   /*****************************************************************/ 05447000
*                                                                  1419 05448000
*   IF NEWENT(1:12)=STARTVAL&(LINCNTR^=ZERO|ENTCNTR>ZERO) THEN     1419 05449000
@RF01403 CLC   NEWENT(12),STARTVAL                                 1419 05450000
         BNE   @RF01419                                            1419 05451000
         SLR   @07,@07                                             1419 05452000
         C     @07,LINCNTR                                         1419 05453000
         BNE   @RT01419                                            1419 05454000
         C     @07,ENTCNTR                                         1419 05455000
         BNL   @RF01419                                            1419 05456000
@RT01419 DS    0H                                                  1420 05457000
*     DO;                           /*                       @YM02873*/ 05458000
*       IF LINCNTR^=ZERO THEN                                      1421 05459000
         L     @07,LINCNTR                                         1421 05460000
         LTR   @07,@07                                             1421 05461000
         BZ    @RF01421                                            1421 05462000
*         DO;                       /*                       @Y30LB38*/ 05463000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 05464000
         XC    PRINTAB(84),PRINTAB                                 1423 05465000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 05466000
         L     @15,DDSTRU                                          1424 05467000
         MVC   DARGSMOD(3,@15),@CC01483                            1424 05468000
*           DARGCNT=ONE;            /*                       @Y30LB38*/ 05469000
         LA    @14,1                                               1425 05470000
         STH   @14,DARGCNT(,@15)                                   1425 05471000
*           DARGPCT(DARGCNT)=LINCNTR;/*                      @ZM00727*/ 05472000
         LR    @03,@14                                             1426 05473000
         SLA   @03,3                                               1426 05474000
         STH   @07,DARGPCT-8(@03,@15)                              1426 05475000
*           DARGREP(DARGCNT)=ONE;   /*                       @ZM00727*/ 05476000
         STH   @14,DARGREP-8(@03,@15)                              1427 05477000
*           IF TBLID=TRANID THEN                                   1428 05478000
         CLI   TBLID,2                                             1428 05479000
         BNE   @RF01428                                            1428 05480000
*             DO;                   /*                       @Y30LB38*/ 05481000
*               DARGSENT=LMO14;     /*                       @Y30LB38*/ 05482000
         MVI   DARGSENT(@15),X'0E'                                 1430 05483000
*               DARGDBP=ADDR(TVPRTBF(ONE));/*                @Y30LB38*/ 05484000
         ST    PRINTPTR,DARGDBP(,@15)                              1431 05485000
*               DARGILP=PRINTLEN;   /*                       @Y30LB38*/ 05486000
         MVC   DARGILP(2,@15),@CH01448                             1432 05487000
*             END;                  /*                       @Y30LB38*/ 05488000
*           IF TBLID=VOLINVID THEN                                 1434 05489000
@RF01428 CLI   TBLID,3                                             1434 05490000
         BNE   @RF01434                                            1434 05491000
*             DO;                   /*                       @Y30LB38*/ 05492000
*               DARGSENT=LMO13;     /*                       @Y30LB38*/ 05493000
         L     @07,DDSTRU                                          1436 05494000
         MVI   DARGSENT(@07),X'0D'                                 1436 05495000
*               DARGDBP=ADDR(VIPRTBF(ONE));/*                @Y30LB38*/ 05496000
         ST    PRINTPTR,DARGDBP(,@07)                              1437 05497000
*               DARGILP=PRINTLEN;   /*                       @Y30LB38*/ 05498000
         MVC   DARGILP(2,@07),@CH01448                             1438 05499000
*             END;                  /*                       @Y30LB38*/ 05500000
*           IF TBLID=CARTID THEN                                   1440 05501000
@RF01434 CLI   TBLID,4                                             1440 05502000
         BNE   @RF01440                                            1440 05503000
*             DO;                   /*                       @Y30LB38*/ 05504000
*               DARGSENT=LMO15;     /*                       @Y30LB38*/ 05505000
         L     @07,DDSTRU                                          1442 05506000
         MVI   DARGSENT(@07),X'0F'                                 1442 05507000
*               DARGDBP=ADDR(SCPRTBF(ONE));/*                @Y30LB38*/ 05508000
         ST    PRINTPTR,DARGDBP(,@07)                              1443 05509000
*               DARGILP=PRINTLEN;   /*                       @Y30LB38*/ 05510000
         MVC   DARGILP(2,@07),@CH01448                             1444 05511000
*             END;                  /*                       @Y30LB38*/ 05512000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/ 05513000
@RF01440 L     @07,@PC00001                                        1446 05514000
         ST    @07,@AL00001                                        1446 05515000
         LA    @15,PRINTME                                         1446 05516000
         ST    @15,@AL00001+4                                      1446 05517000
         LA    @15,DDSTRU                                          1446 05518000
         ST    @15,@AL00001+8                                      1446 05519000
         MVI   @AL00001+8,X'80'                                    1446 05520000
         L     @15,GDTPRT(,@07)                                    1446 05521000
         LA    @01,@AL00001                                        1446 05522000
         BALR  @14,@15                                             1446 05523000
*         END;                      /*                       @Y30LB38*/ 05524000
*                                                                  1447 05525000
*       /*************************************************************/ 05526000
*       /*                                                           */ 05527000
*       /* IF THE ENTCNTR IS NOT ZERO THIS INDICATES THAT    @Y30LB38*/ 05528000
*       /* A PARTIAL LINE STILL NEEDS TO BE PRINTED. CALL LASTLINR TO*/ 05529000
*       /* PRINT THE PARTIAL LINE.                           @Y30LB38*/ 05530000
*       /*                                                           */ 05531000
*       /*************************************************************/ 05532000
*                                                                  1448 05533000
*       IF ENTCNTR^=ZERO THEN                                      1448 05534000
@RF01421 L     @07,ENTCNTR                                         1448 05535000
         LTR   @07,@07                                             1448 05536000
         BZ    @RF01448                                            1448 05537000
*         CALL LASTLINR;            /*                       @Y30LB38*/ 05538000
*                                                                  1449 05539000
         BAL   @14,LASTLINR                                        1449 05540000
*       /*************************************************************/ 05541000
*       /*                                                           */ 05542000
*       /* SET THE COUNTERS TO ZERO FOR THE NEXT REPORT.     @Y30LB38*/ 05543000
*       /*                                                           */ 05544000
*       /*************************************************************/ 05545000
*                                                                  1450 05546000
*       LINCNTR=ZERO;               /*                       @Y30LB38*/ 05547000
@RF01448 SLR   @07,@07                                             1450 05548000
         ST    @07,LINCNTR                                         1450 05549000
*       BUFFCNTR=ZERO;              /*                       @Y30LB38*/ 05550000
         LR    BUFFCNTR,@07                                        1451 05551000
*       ENTCNTR=ZERO;               /*                       @Y30LB38*/ 05552000
         ST    @07,ENTCNTR                                         1452 05553000
*     END;                          /*                       @Y30LB38*/ 05554000
*                                                                  1453 05555000
*   /*****************************************************************/ 05556000
*   /*                                                               */ 05557000
*   /* IF NEWENT IS NOT FF'S CHECK IF ENTCNTR = ENTYLIM,     @YM01344*/ 05558000
*   /* THE LINE IS FULL, SO SET ENTCNTR TO 0 AND INCREMENT LINCNTR.  */ 05559000
*   /*                                                       @Y30LB38*/ 05560000
*   /*                                                               */ 05561000
*   /*****************************************************************/ 05562000
*                                                                  1454 05563000
*   ELSE                                                           1454 05564000
*     DO;                           /*                       @Y30LB38*/ 05565000
         B     @RC01419                                            1454 05566000
@RF01419 DS    0H                                                  1455 05567000
*       IF NEWENT(1:12)^=STARTVAL THEN                             1455 05568000
         CLC   NEWENT(12),STARTVAL                                 1455 05569000
         BE    @RF01455                                            1455 05570000
*         DO;                       /*                       @Y30LB38*/ 05571000
*           IF ENTCNTR=ENTYLIM THEN                                1457 05572000
         L     @07,ENTCNTR                                         1457 05573000
         SLR   @15,@15                                             1457 05574000
         IC    @15,ENTYLIM                                         1457 05575000
         CR    @07,@15                                             1457 05576000
         BNE   @RF01457                                            1457 05577000
*             DO;                   /*                       @Y30LB38*/ 05578000
*               ENTCNTR=ZERO;       /*                       @Y30LB38*/ 05579000
         SLR   @07,@07                                             1459 05580000
         ST    @07,ENTCNTR                                         1459 05581000
*               LINCNTR=LINCNTR+ONE;/*                       @Y30LB38*/ 05582000
         LA    @07,1                                               1460 05583000
         AL    @07,LINCNTR                                         1460 05584000
         ST    @07,LINCNTR                                         1460 05585000
*             END;                  /*                       @Y30LB38*/ 05586000
*                                                                  1461 05587000
*           /*********************************************************/ 05588000
*           /*                                                       */ 05589000
*           /* IF BUFFCNTR = BUFFLIM THEN THE BUFFER IS FULL.        */ 05590000
*           /*                                               @Y30LB38*/ 05591000
*           /* SET ENTCNTR, LINCNTR AND BUFFCNTR = 0 AND ISSUE UPRINT*/ 05592000
*           /* TO PRINT THE BUFFER.                          @Y30LB38*/ 05593000
*           /*                                                       */ 05594000
*           /*********************************************************/ 05595000
*                                                                  1462 05596000
*           IF BUFFCNTR=BUFFLIM THEN                               1462 05597000
@RF01457 SLR   @07,@07                                             1462 05598000
         IC    @07,BUFFLIM                                         1462 05599000
         CR    BUFFCNTR,@07                                        1462 05600000
         BNE   @RF01462                                            1462 05601000
*             DO;                   /*                       @Y30LB38*/ 05602000
*               LINCNTR=ZERO;       /*                       @Y30LB38*/ 05603000
         SLR   @15,@15                                             1464 05604000
         ST    @15,LINCNTR                                         1464 05605000
*               ENTCNTR=ZERO;       /*                       @Y30LB38*/ 05606000
         ST    @15,ENTCNTR                                         1465 05607000
*               BUFFCNTR=ZERO;      /*                       @Y30LB38*/ 05608000
         LR    BUFFCNTR,@15                                        1466 05609000
*               PRINTAB=''B;        /*                       @Y30LB38*/ 05610000
         XC    PRINTAB(84),PRINTAB                                 1467 05611000
*               DARGSMOD=LMOVMSG;   /*                       @Y30LB38*/ 05612000
         L     @15,DDSTRU                                          1468 05613000
         MVC   DARGSMOD(3,@15),@CC01483                            1468 05614000
*               DARGCNT=ONE;        /*                       @Y30LB38*/ 05615000
         LA    @14,1                                               1469 05616000
         STH   @14,DARGCNT(,@15)                                   1469 05617000
*               DARGREP(DARGCNT)=ONE;/*                      @ZM00727*/ 05618000
         LR    @03,@14                                             1470 05619000
         SLA   @03,3                                               1470 05620000
         STH   @14,DARGREP-8(@03,@15)                              1470 05621000
*               DARGPCT(DARGCNT)=BUFFLIM/ENTYLIM;/*          @ZM00727*/ 05622000
         LR    @01,@07                                             1471 05623000
         SLR   @00,@00                                             1471 05624000
         SLR   @07,@07                                             1471 05625000
         IC    @07,ENTYLIM                                         1471 05626000
         DR    @00,@07                                             1471 05627000
         STH   @01,DARGPCT-8(@03,@15)                              1471 05628000
*               IF TBLID=TRANID THEN                               1472 05629000
         CLI   TBLID,2                                             1472 05630000
         BNE   @RF01472                                            1472 05631000
*                 DO;               /*                       @Y30LB38*/ 05632000
*                   DARGDBP=ADDR(TVPRTBF(ONE));/*            @Y30LB38*/ 05633000
         ST    PRINTPTR,DARGDBP(,@15)                              1474 05634000
*                   DARGILP=PRINTLEN;/*                      @Y30LB38*/ 05635000
         MVC   DARGILP(2,@15),@CH01448                             1475 05636000
*                   DARGSENT=LMO14; /*                       @Y30LB38*/ 05637000
         MVI   DARGSENT(@15),X'0E'                                 1476 05638000
*                 END;              /*                       @Y30LB38*/ 05639000
*               IF TBLID=VOLINVID THEN                             1478 05640000
@RF01472 CLI   TBLID,3                                             1478 05641000
         BNE   @RF01478                                            1478 05642000
*                 DO;               /*                       @Y30LB38*/ 05643000
*                   DARGDBP=ADDR(VIPRTBF(ONE));/*            @Y30LB38*/ 05644000
         L     @07,DDSTRU                                          1480 05645000
         ST    PRINTPTR,DARGDBP(,@07)                              1480 05646000
*                   DARGILP=PRINTLEN;/*                      @Y30LB38*/ 05647000
         MVC   DARGILP(2,@07),@CH01448                             1481 05648000
*                   DARGSENT=LMO13; /*                       @Y30LB38*/ 05649000
         MVI   DARGSENT(@07),X'0D'                                 1482 05650000
*                 END;              /*                       @Y30LB38*/ 05651000
*               IF TBLID=CARTID THEN                               1484 05652000
@RF01478 CLI   TBLID,4                                             1484 05653000
         BNE   @RF01484                                            1484 05654000
*                 DO;               /*                       @Y30LB38*/ 05655000
*                   DARGDBP=ADDR(SCPRTBF(ONE));/*            @Y30LB38*/ 05656000
         L     @07,DDSTRU                                          1486 05657000
         ST    PRINTPTR,DARGDBP(,@07)                              1486 05658000
*                   DARGILP=PRINTLEN;/*                      @Y30LB38*/ 05659000
         MVC   DARGILP(2,@07),@CH01448                             1487 05660000
*                   DARGSENT=LMO15; /*                       @Y30LB38*/ 05661000
         MVI   DARGSENT(@07),X'0F'                                 1488 05662000
*                 END;              /*                       @Y30LB38*/ 05663000
*               CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*      @Y30LB38*/ 05664000
@RF01484 L     @07,@PC00001                                        1490 05665000
         ST    @07,@AL00001                                        1490 05666000
         LA    @15,PRINTME                                         1490 05667000
         ST    @15,@AL00001+4                                      1490 05668000
         LA    @15,DDSTRU                                          1490 05669000
         ST    @15,@AL00001+8                                      1490 05670000
         MVI   @AL00001+8,X'80'                                    1490 05671000
         L     @15,GDTPRT(,@07)                                    1490 05672000
         LA    @01,@AL00001                                        1490 05673000
         BALR  @14,@15                                             1490 05674000
*             END;                  /*                       @Y30LB38*/ 05675000
*         END;                      /*                       @Y30LB38*/ 05676000
@RF01462 DS    0H                                                  1493 05677000
*     END;                          /*                       @Y30LB38*/ 05678000
*                                                                  1493 05679000
@RF01455 DS    0H                                                  1494 05680000
*   /*****************************************************************/ 05681000
*   /*                                                               */ 05682000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 05683000
*   /*                                                               */ 05684000
*   /*****************************************************************/ 05685000
*                                                                  1494 05686000
*   REG14=RETADDR4;                 /*                       @Y30LB38*/ 05687000
@RC01419 L     REG14,RETADDR4                                      1494 05688000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 05689000
         SLR   @15,@15                                             1495 05690000
@EL00014 DS    0H                                                  1495 05691000
@EF00014 DS    0H                                                  1495 05692000
@ER00014 BR    @14                                                 1495 05693000
*   END RPTFMTR;                    /*                       @Y30LB38*/ 05694000
*                                                                  1497 05695000
*/********************************************************************/ 05696000
*/*                                                          @Y30LB38*/ 05697000
*/*     PROCEDURE NAME - SUMARY                              @Y30LB38*/ 05698000
*/*                                                          @Y30LB38*/ 05699000
*/*     FUNCTION - THIS ROUTINE COUNTS THE EMPTY CELLS IN A  @Y30LB38*/ 05700000
*/*                MSF AND PRINTS THE SUMMARY INFORMATION    @ZM00717*/ 05701000
*/*                CONTAINED IN THE INTTBL                   @Y30LB38*/ 05702000
*/*                                                          @Y30LB38*/ 05703000
*/*     INPUT - WORK AREA CALLED TRKBUFF, INTTBL  AND THE    @Y30LB38*/ 05704000
*/*             FDTTBL                                       @Y30LB38*/ 05705000
*/*                                                          @Y30LB38*/ 05706000
*/*     OUTPUT - PRINTED REPORT AND A RETURN CODE            @Y30LB38*/ 05707000
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/ 05708000
*/*              12 = CELL MAP COULD NOT BE RETREIVED        @Y30LB38*/ 05709000
*/*                                                          @Y30LB38*/ 05710000
*/********************************************************************/ 05711000
*                                                                  1497 05712000
*SUMARY:                                                           1497 05713000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 05714000
*                                                                  1497 05715000
SUMARY   DS    0H                                                  1498 05716000
*   /*****************************************************************/ 05717000
*   /*                                                               */ 05718000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 05719000
*   /*                                                               */ 05720000
*   /*****************************************************************/ 05721000
*                                                                  1498 05722000
*   DCL                                                            1498 05723000
*     TRKWORD CHAR(256) BASED(TRKPTR);/* DATA FROM TRKBUFF   @Y30LB38*/ 05724000
*   DCL                                                            1499 05725000
*     1 TESTBYTE BIT(8),            /* BYTE FOR BIT SCAN     @Y30LB38*/ 05726000
*       3 BIT1 BIT(1),              /*                       @Y30LB38*/ 05727000
*       3 BIT2 BIT(1),              /*                       @Y30LB38*/ 05728000
*       3 BIT3 BIT(1),              /*                       @Y30LB38*/ 05729000
*       3 BIT4 BIT(1),              /*                       @Y30LB38*/ 05730000
*       3 BIT5 BIT(1),              /*                       @Y30LB38*/ 05731000
*       3 BIT6 BIT(1),              /*                       @Y30LB38*/ 05732000
*       3 BIT7 BIT(1),              /*                       @Y30LB38*/ 05733000
*       3 BIT8 BIT(1);              /*                       @Y30LB38*/ 05734000
*   DCL                                                            1500 05735000
*     SUMRCODE FIXED(15);           /* SUMARY RETURN CODE    @Y30LB38*/ 05736000
*   DCL                                                            1501 05737000
*     LMO08 FIXED(8) CONSTANT(08);  /*                       @Y30LB38*/ 05738000
*   DCL                                                            1502 05739000
*     LMO12 FIXED(8) CONSTANT(12);  /*                       @Y30LB38*/ 05740000
*   DCL                                                            1503 05741000
*     CELLREC FIXED(15) CONSTANT(256);/* NUMBER OF BYTES     @Y30LB38   05742000
*                                      PER CELL MAP REC      @Y30LB38*/ 05743000
*                                                                  1504 05744000
*   /*****************************************************************/ 05745000
*   /*                                                               */ 05746000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 05747000
*   /*                                                               */ 05748000
*   /*****************************************************************/ 05749000
*                                                                  1504 05750000
*   RETADDR4=REG14;                 /*                       @Y30LB38*/ 05751000
         ST    REG14,RETADDR4                                      1504 05752000
*   OLDERID2=NEWERID2;                                             1505 05753000
         L     @05,@PC00001                                        1505 05754000
         L     @05,GDTTR2(,@05)                                    1505 05755000
         MVC   @TS00001(95),NEWERID2(@05)                          1505 05756000
         MVC   OLDERID2(95,@05),@TS00001                           1505 05757000
*   NEWID2='LMOA';                  /*                       @Y30LB38*/ 05758000
         MVC   NEWID2(4,@05),@CC01773                              1506 05759000
*   SUMRCODE=''B;                   /*                       @Y30LB38*/ 05760000
*                                                                  1507 05761000
         SLR   SUMRCODE,SUMRCODE                                   1507 05762000
*   /*****************************************************************/ 05763000
*   /*                                                               */ 05764000
*   /* CALL TRKRDR TO READ IN THE CELL MAP TRACK. IF THE     @Y30LB38*/ 05765000
*   /* RETURN CODE IS 12, ISSUE THE UPRINT MACRO AND PRINT MESSAGE   */ 05766000
*   /* IDC2823I TO INDICATE THE SUMARY REPORT COULD NOT BE PRODUCED  */ 05767000
*   /* AND SET THE CONDITION CODE = 12.                      @Y30LB38*/ 05768000
*   /*                                                               */ 05769000
*   /*****************************************************************/ 05770000
*                                                                  1508 05771000
*   CALL TRKRDR;                    /*                       @Y30LB38*/ 05772000
         BAL   @14,TRKRDR                                          1508 05773000
*   RESPECIFY                                                      1509 05774000
*     RTNREG RSTD;                                                 1509 05775000
*   TESTRC=RTNREG;                                                 1510 05776000
         LR    TESTRC,RTNREG                                       1510 05777000
*   RESPECIFY                                                      1511 05778000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 05779000
*   SUMRCODE=TESTRC;                /*                       @Y30LB38*/ 05780000
         LR    SUMRCODE,TESTRC                                     1512 05781000
*   IF SUMRCODE=LASTCC12 THEN                                      1513 05782000
         C     SUMRCODE,@CF00567                                   1513 05783000
         BNE   @RF01513                                            1513 05784000
*     DO;                           /*                       @Y30LB38*/ 05785000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 05786000
         XC    PRINTAB(84),PRINTAB                                 1515 05787000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 05788000
         L     @05,DDSTRU                                          1516 05789000
         MVC   DARGSMOD(3,@05),@CC01483                            1516 05790000
*       DARGSENT=M2823I25;          /*                       @Y30LB38*/ 05791000
         MVI   DARGSENT(@05),X'19'                                 1517 05792000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/ 05793000
         L     @05,@PC00001                                        1518 05794000
         ST    @05,@AL00001                                        1518 05795000
         LA    @15,@CF00116                                        1518 05796000
         ST    @15,@AL00001+4                                      1518 05797000
         LA    @15,DDSTRU                                          1518 05798000
         ST    @15,@AL00001+8                                      1518 05799000
         MVI   @AL00001+8,X'80'                                    1518 05800000
         L     @15,GDTPRT(,@05)                                    1518 05801000
         LA    @01,@AL00001                                        1518 05802000
         BALR  @14,@15                                             1518 05803000
*     END;                          /*                       @Y30LB38*/ 05804000
*                                                                  1519 05805000
*   /*****************************************************************/ 05806000
*   /*                                                               */ 05807000
*   /* IF THE CONDITION CODE IS NOT 12, SET UP THE TRACK     @Y30LB38*/ 05808000
*   /* POINTER TO POINT TO THE BEGINNING BLOCK IN THE CELL MAP.      */ 05809000
*   /*                                                       @Y30LB38*/ 05810000
*   /*                                                               */ 05811000
*   /*****************************************************************/ 05812000
*                                                                  1520 05813000
*   IF SUMRCODE^=LASTCC12 THEN      /*                       @Y30LB38*/ 05814000
@RF01513 C     SUMRCODE,@CF00567                                   1520 05815000
         BE    @RF01520                                            1520 05816000
*     DO;                           /*                       @Y30LB38*/ 05817000
*                                                                  1521 05818000
*       /*************************************************************/ 05819000
*       /*                                                           */ 05820000
*       /* THE FIRST FIVE RECORDS IN THE TRACK DESCRIBE MSF 0.       */ 05821000
*       /*                                                   @Y30LB38*/ 05822000
*       /* THE NEXT FIVE DESCRIBE MSF 1. THE FIRST RECORD OF THE FIVE*/ 05823000
*       /* IS IRRELEVANT TO THE EMPTY CELL COUNT AND THEREFORE IS NOT*/ 05824000
*       /* SCANNED. IF THE MSF = 0, INCREMENT PAST THE FIRST RECORD. */ 05825000
*       /* IF THE MSF = 1, INCREMENT PAST THE FIRST 6 RECORDS.       */ 05826000
*       /*                                                   @Y30LB38*/ 05827000
*       /*                                                           */ 05828000
*       /*************************************************************/ 05829000
*                                                                  1522 05830000
*       WORK3=TRKPTR;               /*                       @Y30LB38*/ 05831000
         L     @05,TRKPTR                                          1522 05832000
         ST    @05,WORK3                                           1522 05833000
*       IF MSFVAL=ZERO THEN                                        1523 05834000
         L     @15,@PC00001+4                                      1523 05835000
         L     @01,FDTPTR+28(,@15)                                 1523 05836000
         L     @15,MSFVAL(,@01)                                    1523 05837000
         LTR   @15,@15                                             1523 05838000
         BNZ   @RF01523                                            1523 05839000
*         TRKPTR=TRKPTR+RECSIZE;    /*                       @Y30LB38*/ 05840000
         AL    @05,@CF01464                                        1524 05841000
         ST    @05,TRKPTR                                          1524 05842000
*       ELSE                                                       1525 05843000
*         TRKPTR=TRKPTR+(SIX*RECSIZE);/*                     @Y30LB38*/ 05844000
*                                                                  1525 05845000
         B     @RC01523                                            1525 05846000
@RF01523 LA    @05,1584                                            1525 05847000
         AL    @05,TRKPTR                                          1525 05848000
         ST    @05,TRKPTR                                          1525 05849000
*       /*************************************************************/ 05850000
*       /*                                                           */ 05851000
*       /* SET UP 2 DO LOOPS TO SCAN ALL THE BITS IN THE FOUR        */ 05852000
*       /*                                                   @Y30LB38*/ 05853000
*       /* CELL MAP RECORDS. THE FIRST LOOP IS FOR A RECORD AND THE  */ 05854000
*       /* INNER LOOP SCANS ALL THE BITS WITHIN THAT RECORD. @Y30LB38*/ 05855000
*       /*                                                           */ 05856000
*       /*************************************************************/ 05857000
*                                                                  1526 05858000
*       DO I3=1 BY 1 TO 4;          /*                       @Y30LB38*/ 05859000
@RC01523 LA    I3,1                                                1526 05860000
@DL01526 DS    0H                                                  1527 05861000
*         TRKPTR=TRKPTR+LENGTH(PREFIX);/*                    @Y30LB38*/ 05862000
         LA    @05,8                                               1527 05863000
         AL    @05,TRKPTR                                          1527 05864000
         ST    @05,TRKPTR                                          1527 05865000
*         DO I4=1 BY 1 TO CELLREC;  /*                       @Y30LB38*/ 05866000
         LA    I4,1                                                1528 05867000
@DL01528 DS    0H                                                  1529 05868000
*           TESTBYTE=TRKWORD(I4);   /*                       @Y30LB38*/ 05869000
         L     @05,TRKPTR                                          1529 05870000
         ALR   @05,I4                                              1529 05871000
         AL    @05,@CF01867                                        1529 05872000
         MVC   TESTBYTE(1),TRKWORD(@05)                            1529 05873000
*           IF BIT1=ON THEN                                        1530 05874000
         TM    BIT1,B'10000000'                                    1530 05875000
         BNO   @RF01530                                            1530 05876000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05877000
         LA    @05,1                                               1531 05878000
         AL    @05,ECCNTR                                          1531 05879000
         ST    @05,ECCNTR                                          1531 05880000
*           IF BIT2=ON THEN                                        1532 05881000
@RF01530 TM    BIT2,B'01000000'                                    1532 05882000
         BNO   @RF01532                                            1532 05883000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05884000
         LA    @05,1                                               1533 05885000
         AL    @05,ECCNTR                                          1533 05886000
         ST    @05,ECCNTR                                          1533 05887000
*           IF BIT3=ON THEN                                        1534 05888000
@RF01532 TM    BIT3,B'00100000'                                    1534 05889000
         BNO   @RF01534                                            1534 05890000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05891000
         LA    @05,1                                               1535 05892000
         AL    @05,ECCNTR                                          1535 05893000
         ST    @05,ECCNTR                                          1535 05894000
*           IF BIT4=ON THEN                                        1536 05895000
@RF01534 TM    BIT4,B'00010000'                                    1536 05896000
         BNO   @RF01536                                            1536 05897000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05898000
         LA    @05,1                                               1537 05899000
         AL    @05,ECCNTR                                          1537 05900000
         ST    @05,ECCNTR                                          1537 05901000
*           IF BIT5=ON THEN                                        1538 05902000
@RF01536 TM    BIT5,B'00001000'                                    1538 05903000
         BNO   @RF01538                                            1538 05904000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05905000
         LA    @05,1                                               1539 05906000
         AL    @05,ECCNTR                                          1539 05907000
         ST    @05,ECCNTR                                          1539 05908000
*           IF BIT6=ON THEN                                        1540 05909000
@RF01538 TM    BIT6,B'00000100'                                    1540 05910000
         BNO   @RF01540                                            1540 05911000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05912000
         LA    @05,1                                               1541 05913000
         AL    @05,ECCNTR                                          1541 05914000
         ST    @05,ECCNTR                                          1541 05915000
*           IF BIT7=ON THEN                                        1542 05916000
@RF01540 TM    BIT7,B'00000010'                                    1542 05917000
         BNO   @RF01542                                            1542 05918000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05919000
         LA    @05,1                                               1543 05920000
         AL    @05,ECCNTR                                          1543 05921000
         ST    @05,ECCNTR                                          1543 05922000
*           IF BIT8=ON THEN                                        1544 05923000
@RF01542 TM    BIT8,B'00000001'                                    1544 05924000
         BNO   @RF01544                                            1544 05925000
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/ 05926000
         LA    @05,1                                               1545 05927000
         AL    @05,ECCNTR                                          1545 05928000
         ST    @05,ECCNTR                                          1545 05929000
*         END;                      /*                       @Y30LB38*/ 05930000
@RF01544 AL    I4,@CF00220                                         1546 05931000
         C     I4,@CF01285                                         1546 05932000
         BNH   @DL01528                                            1546 05933000
*         TRKPTR=TRKPTR+CELLREC;    /*                       @Y30LB38*/ 05934000
         LA    @05,256                                             1547 05935000
         AL    @05,TRKPTR                                          1547 05936000
         ST    @05,TRKPTR                                          1547 05937000
*       END;                        /*                       @Y30LB38*/ 05938000
         AL    I3,@CF00220                                         1548 05939000
         C     I3,@CF00043                                         1548 05940000
         BNH   @DL01526                                            1548 05941000
*     END;                          /*                       @Y30LB38*/ 05942000
*                                                                  1549 05943000
*   /*****************************************************************/ 05944000
*   /*                                                               */ 05945000
*   /* RESTORE TRKPTR TO POINT TO START OF TRKBUFF           @Y30LB38*/ 05946000
*   /*                                                               */ 05947000
*   /*****************************************************************/ 05948000
*                                                                  1550 05949000
*   TRKPTR=WORK3;                   /*                       @Y30LB38*/ 05950000
*                                                                  1550 05951000
@RF01520 L     @05,WORK3                                           1550 05952000
         ST    @05,TRKPTR                                          1550 05953000
*   /*****************************************************************/ 05954000
*   /*                                                               */ 05955000
*   /* ISSUE THE UPRINT MACRO TO PRINT THE SUMMARY TITLE     @Y30LB38*/ 05956000
*   /* AND GO TO THE NEXT PAGE.                              @Y30LB38*/ 05957000
*   /*                                                               */ 05958000
*   /*****************************************************************/ 05959000
*                                                                  1551 05960000
*   PRINTAB=''B;                    /*                       @Y30LB38*/ 05961000
         XC    PRINTAB(84),PRINTAB                                 1551 05962000
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/ 05963000
         L     @05,DDSTRU                                          1552 05964000
         MVC   DARGSMOD(3,@05),@CC01483                            1552 05965000
*   DARGSENT=LMO08;                 /*                       @Y30LB38*/ 05966000
         MVI   DARGSENT(@05),X'08'                                 1553 05967000
*   DARGDBP=ADDR(MSFVAL);           /*                       @YM02897*/ 05968000
         L     @15,@PC00001+4                                      1554 05969000
         L     @15,FDTPTR+28(,@15)                                 1554 05970000
         ST    @15,DARGDBP(,@05)                                   1554 05971000
*   DARGILP=LENGTH(MSFVAL);         /*                       @YM02897*/ 05972000
         MVC   DARGILP(2,@05),@CH00043                             1555 05973000
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Y30LB38*/ 05974000
*                                                                  1556 05975000
         L     @05,@PC00001                                        1556 05976000
         ST    @05,@AL00001                                        1556 05977000
         LA    @15,PRINTME                                         1556 05978000
         ST    @15,@AL00001+4                                      1556 05979000
         LA    @15,DDSTRU                                          1556 05980000
         ST    @15,@AL00001+8                                      1556 05981000
         MVI   @AL00001+8,X'80'                                    1556 05982000
         L     @15,GDTPRT(,@05)                                    1556 05983000
         LA    @01,@AL00001                                        1556 05984000
         BALR  @14,@15                                             1556 05985000
*   /*****************************************************************/ 05986000
*   /*                                                               */ 05987000
*   /* IF TVCNTR IS NOT FF'S PRINT TRANSIENT VOLUME TOTALS.  @Y30LB38*/ 05988000
*   /* IF VICNTR IS NOT FF'S PRINT VOLUME INVENTORY TOTALS. IF SCCNTR*/ 05989000
*   /* IS NOT FF'S PRINT SCRATCH CARTRIDGE TOTALS.           @Y30LB38*/ 05990000
*   /*                                                               */ 05991000
*   /*****************************************************************/ 05992000
*                                                                  1557 05993000
*   IF TVCNTR^=CNTRVAL THEN                                        1557 05994000
         CLC   TVCNTR(4),CNTRVAL                                   1557 05995000
         BE    @RF01557                                            1557 05996000
*     DO;                           /*                       @Y30LB38*/ 05997000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 05998000
         XC    PRINTAB(84),PRINTAB                                 1559 05999000
*       DARGSENT=LMO09;             /*                       @Y30LB38*/ 06000000
         L     @05,DDSTRU                                          1560 06001000
         MVI   DARGSENT(@05),X'09'                                 1560 06002000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 06003000
         MVC   DARGSMOD(3,@05),@CC01483                            1561 06004000
*       DARGDBP=ADDR(TVCNTR);       /*                       @Y30LB38*/ 06005000
         LA    @15,TVCNTR                                          1562 06006000
         ST    @15,DARGDBP(,@05)                                   1562 06007000
*       DARGILP=LENGTH(TVCNTR);     /*                       @Y30LB38*/ 06008000
         MVC   DARGILP(2,@05),@CH00043                             1563 06009000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 06010000
         L     @05,@PC00001                                        1564 06011000
         ST    @05,@AL00001                                        1564 06012000
         LA    @15,PRINTME                                         1564 06013000
         ST    @15,@AL00001+4                                      1564 06014000
         LA    @15,DDSTRU                                          1564 06015000
         ST    @15,@AL00001+8                                      1564 06016000
         MVI   @AL00001+8,X'80'                                    1564 06017000
         L     @15,GDTPRT(,@05)                                    1564 06018000
         LA    @01,@AL00001                                        1564 06019000
         BALR  @14,@15                                             1564 06020000
*     END;                          /*                       @Y30LB38*/ 06021000
*   IF VICNTR^=CNTRVAL THEN                                        1566 06022000
@RF01557 CLC   VICNTR(4),CNTRVAL                                   1566 06023000
         BE    @RF01566                                            1566 06024000
*     DO;                           /*                       @Y30LB38*/ 06025000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 06026000
         XC    PRINTAB(84),PRINTAB                                 1568 06027000
*       DARGSENT=LMO10;             /*                       @Y30LB38*/ 06028000
         L     @05,DDSTRU                                          1569 06029000
         MVI   DARGSENT(@05),X'0A'                                 1569 06030000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 06031000
         MVC   DARGSMOD(3,@05),@CC01483                            1570 06032000
*       DARGDBP=ADDR(VICNTR);       /*                       @Y30LB38*/ 06033000
         LA    @15,VICNTR                                          1571 06034000
         ST    @15,DARGDBP(,@05)                                   1571 06035000
*       DARGILP=LENGTH(VICNTR);     /*                       @Y30LB38*/ 06036000
         MVC   DARGILP(2,@05),@CH00043                             1572 06037000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 06038000
         L     @05,@PC00001                                        1573 06039000
         ST    @05,@AL00001                                        1573 06040000
         LA    @15,PRINTME                                         1573 06041000
         ST    @15,@AL00001+4                                      1573 06042000
         LA    @15,DDSTRU                                          1573 06043000
         ST    @15,@AL00001+8                                      1573 06044000
         MVI   @AL00001+8,X'80'                                    1573 06045000
         L     @15,GDTPRT(,@05)                                    1573 06046000
         LA    @01,@AL00001                                        1573 06047000
         BALR  @14,@15                                             1573 06048000
*     END;                          /*                       @Y30LB38*/ 06049000
*   IF SCCNTR^=CNTRVAL THEN                                        1575 06050000
@RF01566 CLC   SCCNTR(4),CNTRVAL                                   1575 06051000
         BE    @RF01575                                            1575 06052000
*     DO;                           /*                       @Y30LB38*/ 06053000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 06054000
         XC    PRINTAB(84),PRINTAB                                 1577 06055000
*       DARGSENT=LMO11;             /*                       @Y30LB38*/ 06056000
         L     @05,DDSTRU                                          1578 06057000
         MVI   DARGSENT(@05),X'0B'                                 1578 06058000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 06059000
         MVC   DARGSMOD(3,@05),@CC01483                            1579 06060000
*       DARGDBP=ADDR(SCCNTR);       /*                       @Y30LB38*/ 06061000
         LA    @15,SCCNTR                                          1580 06062000
         ST    @15,DARGDBP(,@05)                                   1580 06063000
*       DARGILP=LENGTH(SCCNTR);     /*                       @Y30LB38*/ 06064000
         MVC   DARGILP(2,@05),@CH00043                             1581 06065000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 06066000
         L     @05,@PC00001                                        1582 06067000
         ST    @05,@AL00001                                        1582 06068000
         LA    @15,PRINTME                                         1582 06069000
         ST    @15,@AL00001+4                                      1582 06070000
         LA    @15,DDSTRU                                          1582 06071000
         ST    @15,@AL00001+8                                      1582 06072000
         MVI   @AL00001+8,X'80'                                    1582 06073000
         L     @15,GDTPRT(,@05)                                    1582 06074000
         LA    @01,@AL00001                                        1582 06075000
         BALR  @14,@15                                             1582 06076000
*     END;                          /*                       @Y30LB38*/ 06077000
*                                                                  1583 06078000
*   /*****************************************************************/ 06079000
*   /*                                                               */ 06080000
*   /* IF THE CONDITION CODE IS NOT 12 PRINT THE EMPTY       @Y30LB38*/ 06081000
*   /* CELL TOTALS.                                          @Y30LB38*/ 06082000
*   /*                                                               */ 06083000
*   /*****************************************************************/ 06084000
*                                                                  1584 06085000
*   IF SUMRCODE^=LASTCC12 THEN                                     1584 06086000
@RF01575 C     SUMRCODE,@CF00567                                   1584 06087000
         BE    @RF01584                                            1584 06088000
*     DO;                           /*                       @Y30LB38*/ 06089000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 06090000
         XC    PRINTAB(84),PRINTAB                                 1586 06091000
*       DARGSENT=LMO12;             /*                       @Y30LB38*/ 06092000
         L     @05,DDSTRU                                          1587 06093000
         MVI   DARGSENT(@05),X'0C'                                 1587 06094000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 06095000
         MVC   DARGSMOD(3,@05),@CC01483                            1588 06096000
*       DARGDBP=ADDR(ECCNTR);       /*                       @Y30LB38*/ 06097000
         LA    @15,ECCNTR                                          1589 06098000
         ST    @15,DARGDBP(,@05)                                   1589 06099000
*       DARGILP=LENGTH(ECCNTR);     /*                       @Y30LB38*/ 06100000
         MVC   DARGILP(2,@05),@CH00043                             1590 06101000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 06102000
         L     @05,@PC00001                                        1591 06103000
         ST    @05,@AL00001                                        1591 06104000
         LA    @15,PRINTME                                         1591 06105000
         ST    @15,@AL00001+4                                      1591 06106000
         LA    @15,DDSTRU                                          1591 06107000
         ST    @15,@AL00001+8                                      1591 06108000
         MVI   @AL00001+8,X'80'                                    1591 06109000
         L     @15,GDTPRT(,@05)                                    1591 06110000
         LA    @01,@AL00001                                        1591 06111000
         BALR  @14,@15                                             1591 06112000
*     END;                          /*                       @Y30LB38*/ 06113000
*                                                                  1592 06114000
*   /*****************************************************************/ 06115000
*   /*                                                               */ 06116000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 06117000
*   /*                                                               */ 06118000
*   /*****************************************************************/ 06119000
*                                                                  1593 06120000
*   REG14=RETADDR4;                 /*                       @Y30LB38*/ 06121000
@RF01584 L     REG14,RETADDR4                                      1593 06122000
*   RETURN CODE(SUMRCODE);          /*                       @Y30LB38*/ 06123000
         LR    @15,SUMRCODE                                        1594 06124000
@EL00015 DS    0H                                                  1594 06125000
@EF00015 DS    0H                                                  1594 06126000
@ER00015 BR    @14                                                 1594 06127000
*   END SUMARY;                     /*                       @Y30LB38*/ 06128000
*                                                                  1596 06129000
*/********************************************************************/ 06130000
*/*                                                          @Y30LB38*/ 06131000
*/*     PROCEDURE NAME - MRGLOOP                             @Y30LB38*/ 06132000
*/*                                                          @Y30LB38*/ 06133000
*/*     FUNCTION - THIS ROUTINE MERGES AN INPUT MERGE        @Y30LB38*/ 06134000
*/*                BLOCK(SOMETIMES EMPTY) WITH THE SORTBLK,  @Y30LB38*/ 06135000
*/*                INTO AN OUTPUT MERGE BLOCK.               @Y30LB38*/ 06136000
*/*                                                          @Y30LB38*/ 06137000
*/*     INPUT - SORTBLK, INTTBL AND THE FOLLOWING PARAMETERS:@Y30LB38*/ 06138000
*/*              ARG1 = INDEX NUMBER FROM 1 TO 7 TO LOCATE   @Y30LB38*/ 06139000
*/*                     THE INPUT MERGEBLK AND MRGCNT        @Y30LB38*/ 06140000
*/*              ARG2 = COUNTER FOR OUTPUT MERGE BLOCK       @Y30LB38*/ 06141000
*/*              ARG3 = ADDRESS OF OUTPUT MERGE BLOCK        @Y30LB38*/ 06142000
*/*                                                          @Y30LB38*/ 06143000
*/*     OUTPUT - OUTPUT MERGE BLOCK, NUMBER OF ENTRIES       @Y30LB38*/ 06144000
*/*              PLACED IN THE OUTPUT MERGE BLOCK AND A ZERO @Y30LB38*/ 06145000
*/*              RETURN CODE                                 @Y30LB38*/ 06146000
*/*                                                          @Y30LB38*/ 06147000
*/********************************************************************/ 06148000
*                                                                  1596 06149000
*MRGLOOP:                                                          1596 06150000
*   PROCEDURE(BLKINDEX,MRGCNTRR,MRGBLKAD) OPTIONS(NOSAVE,NOSAVEAREA);   06151000
MRGLOOP  MVC   @PC00016(12),0(@01)                                 1596 06152000
*                                   /*                       @Y30LB38*/ 06153000
*                                                                  1597 06154000
*   /*****************************************************************/ 06155000
*   /*                                                               */ 06156000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 06157000
*   /*                                                               */ 06158000
*   /*****************************************************************/ 06159000
*                                                                  1597 06160000
*   DCL                                                            1597 06161000
*     BLKINDEX FIXED(15);           /* BLOCK INDEX           @Y30LB38*/ 06162000
*   DCL                                                            1598 06163000
*     MRGCNTRR PTR(31);             /* MRGBLK CNTR           @Y30LB38*/ 06164000
*   DCL                                                            1599 06165000
*     MRGBLKAD PTR(31);             /* ADDR OF MRG BLK       @Y30LB38*/ 06166000
*   DCL                                                            1600 06167000
*     SORTENTP PTR(31);             /*                       @Y30LB38*/ 06168000
*   DCL                                                            1601 06169000
*     MRGLCODE FIXED(15);           /* MRGLOOP RETURN CODE@Y30LB38   */ 06170000
*                                                                  1602 06171000
*   /*****************************************************************/ 06172000
*   /*                                                               */ 06173000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 06174000
*   /*                                                               */ 06175000
*   /*****************************************************************/ 06176000
*                                                                  1602 06177000
*   RETADDR8=REG14;                 /*                       @Y30LB38*/ 06178000
         ST    REG14,RETADDR8                                      1602 06179000
*   OLDERID2=NEWERID2;                                             1603 06180000
         L     @02,@PC00001                                        1603 06181000
         L     @02,GDTTR2(,@02)                                    1603 06182000
         MVC   @TS00001(95),NEWERID2(@02)                          1603 06183000
         MVC   OLDERID2(95,@02),@TS00001                           1603 06184000
*   NEWID2='LMLP';                  /*                       @Y30LB38*/ 06185000
         MVC   NEWID2(4,@02),@CC01785                              1604 06186000
*   MRGLCODE=''B;                   /*                       @Y30LB38*/ 06187000
*                                                                  1605 06188000
         SLR   MRGLCODE,MRGLCODE                                   1605 06189000
*   /*****************************************************************/ 06190000
*   /*                                                               */ 06191000
*   /* INITIALIZE A POINTER TO THE LOWEST VALUED ENTRY       @ZM00717*/ 06192000
*   /* IN THE SORT BLOCK                                     @ZM00717*/ 06193000
*   /*                                                               */ 06194000
*   /*****************************************************************/ 06195000
*                                                                  1606 06196000
*   SORTENTP=SORTENT;               /*                       @Y30LB38*/ 06197000
         L     @02,SORTPTR                                         1606 06198000
         L     SORTENTP,SORTENT(,@02)                              1606 06199000
*   RESPECIFY                                                      1607 06200000
*     SRTENTRY BASED(SORTENTP);     /*                       @Y30LB38*/ 06201000
*                                                                  1607 06202000
*   /*****************************************************************/ 06203000
*   /*                                                               */ 06204000
*   /* INITIALIZE A POINTER TO THE FIRST ENTRY IN THE        @ZM00717*/ 06205000
*   /* INPUT MERGE BLOCK                                     @ZM00717*/ 06206000
*   /*                                                               */ 06207000
*   /*****************************************************************/ 06208000
*                                                                  1608 06209000
*   MGENTPTR=MRGBLKS(BLKINDEX);     /*                       @Y30LB38*/ 06210000
*                                                                  1608 06211000
         L     @15,@PC00016                                        1608 06212000
         LH    @15,BLKINDEX(,@15)                                  1608 06213000
         SLA   @15,2                                               1608 06214000
         L     MGENTPTR,MRGBLKS-4(@15)                             1608 06215000
*   /*****************************************************************/ 06216000
*   /*                                                               */ 06217000
*   /* THIS ROUTINE HANDLES THREE CONDITIONS OF MERGING.     @Y30LB38*/ 06218000
*   /* IF BOTH THE INPUT MERGE BLOCK AND THE SORTBLK HAVE ENTRIES,   */ 06219000
*   /* THEN THE LOWEST ENTRY FROM ONE OF THE BLOCKS IS PLACED IN THE */ 06220000
*   /* OUTPUT MERGE BLOCK. WHEN ONE OF THE BLOCKS NO LONGER HAVE ANY */ 06221000
*   /* ENTRIES TO PROCESS THEN ANY REMAINING ENTRIES FROM THE OTHER  */ 06222000
*   /* BLOCK ARE PLACED IN THE OUTPUT MERGE BLOCK BY ONE OF THE LOOPS*/ 06223000
*   /* BELOW WHICH HANDLE A NULL SORTBLK AND NON-NULL INPUT MERGE    */ 06224000
*   /* BLOCK OR A NULL INPUT MERGE BLOCK AND A NON-NULL SORTBLK.     */ 06225000
*   /*                                                       @Y30LB38*/ 06226000
*   /*                                                               */ 06227000
*   /*****************************************************************/ 06228000
*                                                                  1609 06229000
*   IF SORTCNT^=ZERO&MRGCOUNT(BLKINDEX)^=ZERO THEN                 1609 06230000
         SLR   @14,@14                                             1609 06231000
         CH    @14,SORTCNT(,@02)                                   1609 06232000
         BE    @RF01609                                            1609 06233000
         C     @14,MRGCOUNT-4(@15)                                 1609 06234000
         BE    @RF01609                                            1609 06235000
*     DO;                           /*                       @Y30LB38*/ 06236000
*       DO WHILE SORTCNT^=ZERO&MRGCOUNT(BLKINDEX)^=ZERO;/*   @Y30LB38*/ 06237000
*                                                                  1611 06238000
         B     @DE01611                                            1611 06239000
@DL01611 DS    0H                                                  1612 06240000
*         /***********************************************************/ 06241000
*         /*                                                         */ 06242000
*         /* IF THE ENTRY FROM THE SORTBLK IS LOWER, PLACE   @Y30LB38*/ 06243000
*         /* IT IN THE OUTPUT MERGE BLOCK.                   @Y30LB38*/ 06244000
*         /*                                                         */ 06245000
*         /***********************************************************/ 06246000
*                                                                  1612 06247000
*         IF SRTITEM(1:KEYLEN)<MGENTPTR->BLKENT(1:KEYLEN) THEN     1612 06248000
         SLR   @02,@02                                             1612 06249000
         IC    @02,KEYLEN                                          1612 06250000
         BCTR  @02,0                                               1612 06251000
         EX    @02,@SC01871                                        1612 06252000
         BNL   @RF01612                                            1612 06253000
*           DO;                     /*                       @ZA08859*/ 06254000
*             MRGBLKAD->BLKENT(1:ITEMLEN)=SRTITEM(1:ITEMLEN);/*    1614 06255000
*                                                            @Y30LB38*/ 06256000
*                                                                  1614 06257000
         L     @02,@PC00016+8                                      1614 06258000
         L     @15,MRGBLKAD(,@02)                                  1614 06259000
         SLR   @14,@14                                             1614 06260000
         IC    @14,ITEMLEN                                         1614 06261000
         LR    @01,@14                                             1614 06262000
         BCTR  @01,0                                               1614 06263000
         EX    @01,@SM01873                                        1614 06264000
*             /*******************************************************/ 06265000
*             /*                                                     */ 06266000
*             /* SUBTRACT ONE FROM THE COUNT OF ENTRIES      @ZM00717*/ 06267000
*             /* REMAINING IN THE INPUT SORT BLOCK           @ZM00717*/ 06268000
*             /*                                                     */ 06269000
*             /*******************************************************/ 06270000
*                                                                  1615 06271000
*             SORTCNT=SORTCNT-ONE;  /*                       @Y30LB38*/ 06272000
*                                                                  1615 06273000
         L     @01,SORTPTR                                         1615 06274000
         LH    @00,SORTCNT(,@01)                                   1615 06275000
         BCTR  @00,0                                               1615 06276000
         STH   @00,SORTCNT(,@01)                                   1615 06277000
*             /*******************************************************/ 06278000
*             /*                                                     */ 06279000
*             /* ADD TO COUNT OF ENTRIES IN THE OUTPUT MERGE @ZM00717*/ 06280000
*             /* BLOCK                                       @ZM00717*/ 06281000
*             /*                                                     */ 06282000
*             /*******************************************************/ 06283000
*                                                                  1616 06284000
*             MRGCNTRR=MRGCNTRR+ONE;/*                       @Y30LB38*/ 06285000
         L     @01,@PC00016+4                                      1616 06286000
         LA    @00,1                                               1616 06287000
         AL    @00,MRGCNTRR(,@01)                                  1616 06288000
         ST    @00,MRGCNTRR(,@01)                                  1616 06289000
*             SORTENTP=SRTFPTR;     /*                       @Y30LB38*/ 06290000
         L     SORTENTP,SRTFPTR(,SORTENTP)                         1617 06291000
*             MRGBLKAD=MRGBLKAD+ITEMLEN;/*                   @Y30LB38*/ 06292000
         ALR   @15,@14                                             1618 06293000
         ST    @15,MRGBLKAD(,@02)                                  1618 06294000
*           END;                    /*                       @Y30LB38*/ 06295000
*         ELSE                                                     1620 06296000
*                                                                  1620 06297000
*           /*********************************************************/ 06298000
*           /*                                                       */ 06299000
*           /* THE ENTRY FROM THE INPUT MRGBLK IS LOWER, SO  @Y30LB38*/ 06300000
*           /* PLACE IT IN THE OUTPUT MRGBLK.                @Y30LB38*/ 06301000
*           /*                                                       */ 06302000
*           /*********************************************************/ 06303000
*                                                                  1620 06304000
*           DO;                     /*                       @Y30LB38*/ 06305000
         B     @RC01612                                            1620 06306000
@RF01612 DS    0H                                                  1621 06307000
*             MRGBLKAD->BLKENT(1:ITEMLEN)=MGENTPTR->BLKENT(1:ITEMLEN);  06308000
         L     @02,@PC00016+8                                      1621 06309000
         L     @15,MRGBLKAD(,@02)                                  1621 06310000
         SLR   @14,@14                                             1621 06311000
         IC    @14,ITEMLEN                                         1621 06312000
         LR    @01,@14                                             1621 06313000
         BCTR  @01,0                                               1621 06314000
         EX    @01,@SM01875                                        1621 06315000
*             MRGCOUNT(BLKINDEX)=MRGCOUNT(BLKINDEX)-ONE;/*   @Y30LB38*/ 06316000
         L     @01,@PC00016                                        1622 06317000
         LH    @01,BLKINDEX(,@01)                                  1622 06318000
         SLA   @01,2                                               1622 06319000
         L     @00,MRGCOUNT-4(@01)                                 1622 06320000
         BCTR  @00,0                                               1622 06321000
         ST    @00,MRGCOUNT-4(@01)                                 1622 06322000
*             MRGCNTRR=MRGCNTRR+ONE;/*                       @Y30LB38*/ 06323000
         L     @01,@PC00016+4                                      1623 06324000
         LA    @00,1                                               1623 06325000
         AL    @00,MRGCNTRR(,@01)                                  1623 06326000
         ST    @00,MRGCNTRR(,@01)                                  1623 06327000
*             MRGBLKAD=MRGBLKAD+ITEMLEN;/*                   @Y30LB38*/ 06328000
         ALR   @15,@14                                             1624 06329000
         ST    @15,MRGBLKAD(,@02)                                  1624 06330000
*             MGENTPTR=MGENTPTR+ITEMLEN;/*                   @Y30LB38*/ 06331000
         ALR   MGENTPTR,@14                                        1625 06332000
*           END;                    /*                       @Y30LB38*/ 06333000
*       END;                        /*                       @Y30LB38*/ 06334000
@RC01612 DS    0H                                                  1627 06335000
@DE01611 SLR   @02,@02                                             1627 06336000
         L     @01,SORTPTR                                         1627 06337000
         CH    @02,SORTCNT(,@01)                                   1627 06338000
         BE    @DC01611                                            1627 06339000
         L     @15,@PC00016                                        1627 06340000
         LH    @15,BLKINDEX(,@15)                                  1627 06341000
         SLA   @15,2                                               1627 06342000
         C     @02,MRGCOUNT-4(@15)                                 1627 06343000
         BNE   @DL01611                                            1627 06344000
@DC01611 DS    0H                                                  1628 06345000
*     END;                          /*                       @Y30LB38*/ 06346000
*                                                                  1628 06347000
*   /*****************************************************************/ 06348000
*   /*                                                               */ 06349000
*   /* NEXT TEST IF THE SORTBLK ENTRY COUNT IS NON-ZERO      @Y30LB38*/ 06350000
*   /* AND THE INPUT MRGBLK IS ZERO. IF SO MOVE ONLY THE ENTRIES FROM*/ 06351000
*   /* THE SORTBLK INTO THE OUTPUT MRGBLK.                   @Y30LB38*/ 06352000
*   /*                                                               */ 06353000
*   /*****************************************************************/ 06354000
*                                                                  1629 06355000
*   IF SORTCNT^=ZERO&MRGCOUNT(BLKINDEX)=ZERO THEN                  1629 06356000
@RF01609 SLR   @02,@02                                             1629 06357000
         L     @01,SORTPTR                                         1629 06358000
         CH    @02,SORTCNT(,@01)                                   1629 06359000
         BE    @RF01629                                            1629 06360000
         L     @15,@PC00016                                        1629 06361000
         LH    @15,BLKINDEX(,@15)                                  1629 06362000
         SLA   @15,2                                               1629 06363000
         C     @02,MRGCOUNT-4(@15)                                 1629 06364000
         BNE   @RF01629                                            1629 06365000
*     DO;                           /*                       @Y30LB38*/ 06366000
*       DO WHILE SORTCNT^=ZERO;     /*                       @Y30LB38*/ 06367000
         B     @DE01631                                            1631 06368000
@DL01631 DS    0H                                                  1632 06369000
*         MRGBLKAD->BLKENT(1:ITEMLEN)=SRTITEM(1:ITEMLEN);/*  @Y30LB38*/ 06370000
         L     @02,@PC00016+8                                      1632 06371000
         L     @15,MRGBLKAD(,@02)                                  1632 06372000
         SLR   @14,@14                                             1632 06373000
         IC    @14,ITEMLEN                                         1632 06374000
         LR    @01,@14                                             1632 06375000
         BCTR  @01,0                                               1632 06376000
         EX    @01,@SM01873                                        1632 06377000
*         SORTCNT=SORTCNT-ONE;      /*                       @Y30LB38*/ 06378000
         L     @01,SORTPTR                                         1633 06379000
         LH    @00,SORTCNT(,@01)                                   1633 06380000
         BCTR  @00,0                                               1633 06381000
         STH   @00,SORTCNT(,@01)                                   1633 06382000
*         MRGCNTRR=MRGCNTRR+ONE;    /*                       @Y30LB38*/ 06383000
         L     @01,@PC00016+4                                      1634 06384000
         LA    @00,1                                               1634 06385000
         AL    @00,MRGCNTRR(,@01)                                  1634 06386000
         ST    @00,MRGCNTRR(,@01)                                  1634 06387000
*         MRGBLKAD=MRGBLKAD+ITEMLEN;/*                       @Y30LB38*/ 06388000
         ALR   @15,@14                                             1635 06389000
         ST    @15,MRGBLKAD(,@02)                                  1635 06390000
*         SORTENTP=SRTFPTR;         /*                       @Y30LB38*/ 06391000
         L     SORTENTP,SRTFPTR(,SORTENTP)                         1636 06392000
*       END;                        /*                       @Y30LB38*/ 06393000
@DE01631 L     @02,SORTPTR                                         1637 06394000
         LH    @02,SORTCNT(,@02)                                   1637 06395000
         LTR   @02,@02                                             1637 06396000
         BNZ   @DL01631                                            1637 06397000
*     END;                          /*                       @Y30LB38*/ 06398000
*                                                                  1638 06399000
*   /*****************************************************************/ 06400000
*   /*                                                               */ 06401000
*   /* TEST IF THE SORTBLK COUNT = ZERO AND THE INPUT        @Y30LB38*/ 06402000
*   /* MRGBLK IS NON-ZERO. IF YES, MOVE ONLY THE MRGBLK ENTRIES TO   */ 06403000
*   /* THE OUTPUT MRGBLK.                                    @Y30LB38*/ 06404000
*   /*                                                               */ 06405000
*   /*****************************************************************/ 06406000
*                                                                  1639 06407000
*   IF SORTCNT=ZERO&MRGCOUNT(BLKINDEX)^=ZERO THEN                  1639 06408000
@RF01629 SLR   @06,@06                                             1639 06409000
         L     @02,SORTPTR                                         1639 06410000
         CH    @06,SORTCNT(,@02)                                   1639 06411000
         BNE   @RF01639                                            1639 06412000
         L     @02,@PC00016                                        1639 06413000
         LH    @02,BLKINDEX(,@02)                                  1639 06414000
         SLA   @02,2                                               1639 06415000
         C     @06,MRGCOUNT-4(@02)                                 1639 06416000
         BE    @RF01639                                            1639 06417000
*     DO;                           /*                       @Y30LB38*/ 06418000
*       DO WHILE MRGCOUNT(BLKINDEX)^=ZERO;/*                 @Y30LB38*/ 06419000
         B     @DE01641                                            1641 06420000
@DL01641 DS    0H                                                  1642 06421000
*         MRGBLKAD->BLKENT(1:ITEMLEN)=MGENTPTR->BLKENT1(1:ITEMLEN);/*   06422000
*                                                            @Y30LB38*/ 06423000
         L     @06,@PC00016+8                                      1642 06424000
         L     @02,MRGBLKAD(,@06)                                  1642 06425000
         SLR   @15,@15                                             1642 06426000
         IC    @15,ITEMLEN                                         1642 06427000
         LR    @14,@15                                             1642 06428000
         BCTR  @14,0                                               1642 06429000
         EX    @14,@SM01877                                        1642 06430000
*         MRGCNTRR=MRGCNTRR+ONE;    /*                       @Y30LB38*/ 06431000
         L     @14,@PC00016+4                                      1643 06432000
         LA    @01,1                                               1643 06433000
         AL    @01,MRGCNTRR(,@14)                                  1643 06434000
         ST    @01,MRGCNTRR(,@14)                                  1643 06435000
*         MRGCOUNT(BLKINDEX)=MRGCOUNT(BLKINDEX)-ONE;/*       @Y30LB38*/ 06436000
         L     @14,@PC00016                                        1644 06437000
         LH    @14,BLKINDEX(,@14)                                  1644 06438000
         SLA   @14,2                                               1644 06439000
         L     @01,MRGCOUNT-4(@14)                                 1644 06440000
         BCTR  @01,0                                               1644 06441000
         ST    @01,MRGCOUNT-4(@14)                                 1644 06442000
*         MRGBLKAD=MRGBLKAD+ITEMLEN;/*                       @Y30LB38*/ 06443000
         ALR   @02,@15                                             1645 06444000
         ST    @02,MRGBLKAD(,@06)                                  1645 06445000
*         MGENTPTR=MGENTPTR+ITEMLEN;/*                       @Y30LB38*/ 06446000
         ALR   MGENTPTR,@15                                        1646 06447000
*       END;                        /*                       @Y30LB38*/ 06448000
@DE01641 L     @06,@PC00016                                        1647 06449000
         LH    @06,BLKINDEX(,@06)                                  1647 06450000
         SLA   @06,2                                               1647 06451000
         L     @06,MRGCOUNT-4(@06)                                 1647 06452000
         LTR   @06,@06                                             1647 06453000
         BNZ   @DL01641                                            1647 06454000
*     END;                          /*                       @Y30LB38*/ 06455000
*   RESPECIFY                                                      1649 06456000
*     SRTENTRY BASED(CURPTR);       /*                       @Y30LB38*/ 06457000
*                                                                  1649 06458000
@RF01639 DS    0H                                                  1650 06459000
*   /*****************************************************************/ 06460000
*   /*                                                               */ 06461000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 06462000
*   /*                                                               */ 06463000
*   /*****************************************************************/ 06464000
*                                                                  1650 06465000
*   REG14=RETADDR8;                 /*                       @Y30LB38*/ 06466000
         L     REG14,RETADDR8                                      1650 06467000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 06468000
         SLR   @15,@15                                             1651 06469000
@EL00016 DS    0H                                                  1651 06470000
@EF00016 DS    0H                                                  1651 06471000
@ER00016 BR    @14                                                 1651 06472000
*   END MRGLOOP;                    /*                       @Y30LB38*/ 06473000
*                                                                  1653 06474000
*/********************************************************************/ 06475000
*/*                                                          @Y30LB38*/ 06476000
*/*     PROCEDURE NAME - LASTLINR                            @Y30LB38*/ 06477000
*/*                                                          @Y30LB38*/ 06478000
*/*     FUNCTION - THIS ROUTINE IS CALLED BY RPTFMTR TO      @Y30LB38*/ 06479000
*/*                PRINT THE LAST LINE OF THE REPORT WHEN    @Y30LB38*/ 06480000
*/*                THAT LINE IS NOT COMPLETELY FULL.  IF THE @Y30LB38*/ 06481000
*/*                VOLUME INVENTORY IS BEING PROCESSED, YOU  @Y30LB38*/ 06482000
*/*                HAVE TO PRINT A LINE CONTAINING AT LEAST  @Y30LB38*/ 06483000
*/*                ONE ENTRY, BUT IT MAY CONTAIN TWO, BUT    @Y30LB38*/ 06484000
*/*                NEVER THREE.  IF THE SCRATCH CARTRIDGE    @Y30LB38*/ 06485000
*/*                REPORT IS BEING PRODUCED, YOU HAVE TO     @Y30LB38*/ 06486000
*/*                PRINT AT LEAST ONE ENTRY, MAYBE TWO OR    @Y30LB38*/ 06487000
*/*                THREE, BUT NEVER FOUR.  IF THE TRANSIENT  @Y30LB38*/ 06488000
*/*                VOLUME TABLE IS BEING PRODUCED, YOU HAVE  @Y30LB38*/ 06489000
*/*                TO PRINT ALWAYS ONE ENTRY.                @Y30LB38*/ 06490000
*/*                                                          @Y30LB38*/ 06491000
*/*     INPUT - WORK AREA CALLED INTTBL, BUFFCNTR  WITH THE  @Y30LB38*/ 06492000
*/*             NUMBER OF ENTRIES IN THE PRINT BUFFER        @Y30LB38*/ 06493000
*/*             AND ENTCNTR WITH THE NUMBER OF ENTRIES PER   @Y30LB38*/ 06494000
*/*             LINE                                         @Y30LB38*/ 06495000
*/*                                                          @Y30LB38*/ 06496000
*/*     OUTPUT - REPORT LINE AND ZERO RETURN CODE            @Y30LB38*/ 06497000
*/*                                                          @Y30LB38*/ 06498000
*/********************************************************************/ 06499000
*                                                                  1653 06500000
*LASTLINR:                                                         1653 06501000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/ 06502000
*                                                                  1653 06503000
LASTLINR DS    0H                                                  1654 06504000
*   /*****************************************************************/ 06505000
*   /*                                                               */ 06506000
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/ 06507000
*   /*                                                               */ 06508000
*   /*****************************************************************/ 06509000
*                                                                  1654 06510000
*   DCL                                                            1654 06511000
*     LMO05 FIXED(8) CONSTANT(5);   /* LMO STID 05           @Y30LB38*/ 06512000
*   DCL                                                            1655 06513000
*     LMO20 FIXED(8) CONSTANT(20);  /* LMO STID 20           @Y30LB38*/ 06514000
*   DCL                                                            1656 06515000
*     LMO21 FIXED(8) CONSTANT(21);  /* LMO STID 21           @Y30LB38*/ 06516000
*                                                                  1657 06517000
*   /*****************************************************************/ 06518000
*   /*                                                               */ 06519000
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/ 06520000
*   /*                                                               */ 06521000
*   /*****************************************************************/ 06522000
*                                                                  1657 06523000
*   RETADDR5=REG14;                 /*                       @Y30LB38*/ 06524000
         ST    REG14,RETADDR5                                      1657 06525000
*   OLDERID2=NEWERID2;                                             1658 06526000
         L     @07,@PC00001                                        1658 06527000
         L     @15,GDTTR2(,@07)                                    1658 06528000
         MVC   @TS00001(95),NEWERID2(@15)                          1658 06529000
         MVC   OLDERID2(95,@15),@TS00001                           1658 06530000
*   NEWID2='LMPA';                  /*                       @Y30LB38*/ 06531000
*                                                                  1659 06532000
         MVC   NEWID2(4,@15),@CC01795                              1659 06533000
*   /*****************************************************************/ 06534000
*   /*                                                               */ 06535000
*   /* IF THE TBLID INDICATES A TRANSIENT VOLUME ENTRY,      @Y30LB38*/ 06536000
*   /* ISSUE THE UPRINT MACRO TO PRINT THE LAST LINE OF THE REPORT.  */ 06537000
*   /*                                                       @Y30LB38*/ 06538000
*   /*                                                               */ 06539000
*   /*****************************************************************/ 06540000
*                                                                  1660 06541000
*   IF TBLID=TRANID THEN                                           1660 06542000
         CLI   TBLID,2                                             1660 06543000
         BNE   @RF01660                                            1660 06544000
*     DO;                           /*                       @Y30LB38*/ 06545000
*       PRINTAB=''B;                /*                       @Y30LB38*/ 06546000
         XC    PRINTAB(84),PRINTAB                                 1662 06547000
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/ 06548000
         L     @15,DDSTRU                                          1663 06549000
         MVC   DARGSMOD(3,@15),@CC01483                            1663 06550000
*       DARGSENT=LMO05;             /*                       @Y30LB38*/ 06551000
         MVI   DARGSENT(@15),X'05'                                 1664 06552000
*       DARGDBP=ADDR(TVPRTBF(BUFFCNTR));/*                   @Y30LB38*/ 06553000
         LA    @14,28                                              1665 06554000
         LR    @01,BUFFCNTR                                        1665 06555000
         MR    @00,@14                                             1665 06556000
         AL    @01,@CF01868                                        1665 06557000
         LA    @03,TVPRTBF(@01,PRINTPTR)                           1665 06558000
         ST    @03,DARGDBP(,@15)                                   1665 06559000
*       DARGILP=LENGTH(TVPRTBF(BUFFCNTR));/*                 @Y30LB38*/ 06560000
         STH   @14,DARGILP(,@15)                                   1666 06561000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/ 06562000
         ST    @07,@AL00001                                        1667 06563000
         LA    @15,PRINTME                                         1667 06564000
         ST    @15,@AL00001+4                                      1667 06565000
         LA    @15,DDSTRU                                          1667 06566000
         ST    @15,@AL00001+8                                      1667 06567000
         MVI   @AL00001+8,X'80'                                    1667 06568000
         L     @15,GDTPRT(,@07)                                    1667 06569000
         LA    @01,@AL00001                                        1667 06570000
         BALR  @14,@15                                             1667 06571000
*     END;                          /*                       @Y30LB38*/ 06572000
*                                                                  1668 06573000
*   /*****************************************************************/ 06574000
*   /*                                                               */ 06575000
*   /* IF THE TBLID INDICATES A VOLUME INVENTORY ENTRY,      @Y30LB38*/ 06576000
*   /* ISSUE THE UPRINT MACRO TO PRINT THE LAST LINE OF THE REPORT.  */ 06577000
*   /* THE INDEX INTO THE PRINT BUFFER IS A FIELD CALLED BUFFCNTR    */ 06578000
*   /* USED AS A SUBSCRIPT.                                  @Y30LB38*/ 06579000
*   /*                                                               */ 06580000
*   /*****************************************************************/ 06581000
*                                                                  1669 06582000
*   IF TBLID=VOLINVID THEN                                         1669 06583000
@RF01660 CLI   TBLID,3                                             1669 06584000
         BNE   @RF01669                                            1669 06585000
*     DO;                           /*                       @Y30LB38*/ 06586000
*                                                                  1670 06587000
*       /*************************************************************/ 06588000
*       /*                                                           */ 06589000
*       /* IF THE NUMBER OF ENTRIES = 1, SET THE POINTER TO THE      */ 06590000
*       /*                                                   @Y30LB38*/ 06591000
*       /* LAST ENTRY IN THE BUFFER AND ISSUE THE UPRINT MACRO TO    */ 06592000
*       /* PRINT THE LAST LINE OF THE REPORT. IF THE NUMBER OF       */ 06593000
*       /* ENTRIES = 2 SET THE DATA BLOCK POINTER TO THE NEXT TO THE */ 06594000
*       /* LAST ENTRY AND SET UP THE PARAMETER LIST UP FOR 8 INSERTS.*/ 06595000
*       /* EACH INSERT WILL BE A FIELD IN THE LAST ENTRY.    @Y30LB38*/ 06596000
*       /*                                                           */ 06597000
*       /*************************************************************/ 06598000
*                                                                  1671 06599000
*       IF ENTCNTR=ONE THEN                                        1671 06600000
         CLC   ENTCNTR(4),@CF00220                                 1671 06601000
         BNE   @RF01671                                            1671 06602000
*         DO;                       /*                       @Y30LB38*/ 06603000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 06604000
         XC    PRINTAB(84),PRINTAB                                 1673 06605000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 06606000
         L     @07,DDSTRU                                          1674 06607000
         MVC   DARGSMOD(3,@07),@CC01483                            1674 06608000
*           DARGSENT=LMO20;         /*                       @Y30LB38*/ 06609000
         MVI   DARGSENT(@07),X'14'                                 1675 06610000
*           DARGDBP=ADDR(VIPRTBF(BUFFCNTR));/*               @Y30LB38*/ 06611000
         LR    @15,BUFFCNTR                                        1676 06612000
         SLA   @15,4                                               1676 06613000
         AL    @15,@CF01857                                        1676 06614000
         LA    @15,VIPRTBF(@15,PRINTPTR)                           1676 06615000
         ST    @15,DARGDBP(,@07)                                   1676 06616000
*           DARGILP=LENGTH(VIPRTBF(BUFFCNTR));/*             @Y30LB38*/ 06617000
         MVC   DARGILP(2,@07),@CH00475                             1677 06618000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/ 06619000
         L     @07,@PC00001                                        1678 06620000
         ST    @07,@AL00001                                        1678 06621000
         LA    @15,PRINTME                                         1678 06622000
         ST    @15,@AL00001+4                                      1678 06623000
         LA    @15,DDSTRU                                          1678 06624000
         ST    @15,@AL00001+8                                      1678 06625000
         MVI   @AL00001+8,X'80'                                    1678 06626000
         L     @15,GDTPRT(,@07)                                    1678 06627000
         LA    @01,@AL00001                                        1678 06628000
         BALR  @14,@15                                             1678 06629000
*         END;                      /*                       @Y30LB38*/ 06630000
*       IF ENTCNTR=TWO THEN                                        1680 06631000
@RF01671 LA    @07,2                                               1680 06632000
         C     @07,ENTCNTR                                         1680 06633000
         BNE   @RF01680                                            1680 06634000
*         DO;                       /*                       @Y30LB38*/ 06635000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 06636000
         XC    PRINTAB(84),PRINTAB                                 1682 06637000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 06638000
         L     @15,DDSTRU                                          1683 06639000
         MVC   DARGSMOD(3,@15),@CC01483                            1683 06640000
*           DARGSENT=LMO20;         /*                       @Y30LB38*/ 06641000
         MVI   DARGSENT(@15),X'14'                                 1684 06642000
*           DARGDBP=ADDR(VIPRTBF(BUFFCNTR-ONE));/*           @Y30LB38*/ 06643000
         LR    @14,BUFFCNTR                                        1685 06644000
         SLA   @14,4                                               1685 06645000
         LR    @01,PRINTPTR                                        1685 06646000
         AL    @01,@CF01879                                        1685 06647000
         LA    @03,VIPRTBF(@14,@01)                                1685 06648000
         ST    @03,DARGDBP(,@15)                                   1685 06649000
*           DARGILP=LENGTH(VIPRTBF(ONE));/*                  @Y30LB38*/ 06650000
         MVC   DARGILP(2,@15),@CH00475                             1686 06651000
*           DARGCNT=EIGHT;          /*                       @Y30LB38*/ 06652000
*                                                                  1687 06653000
         LA    @03,8                                               1687 06654000
         STH   @03,DARGCNT(,@15)                                   1687 06655000
*           /*********************************************************/ 06656000
*           /*                                                       */ 06657000
*           /* SETUP THE MESSAGE FOR 8 INSERTS. THE FIRST WILL       */ 06658000
*           /*                                               @Y30LB38*/ 06659000
*           /* BE THE VOLUME SERIAL NUMBER. NEXT WILL BE THE         */ 06660000
*           /* ATTRIBUTES AND LAST WILL BE 3 BYTES OF CELL LOCATION. */ 06661000
*           /*                                                       */ 06662000
*           /*********************************************************/ 06663000
*                                                                  1688 06664000
*           DARGINS(1)=ONE;         /*                       @Y30LB38*/ 06665000
         LA    @02,1                                               1688 06666000
         STH   @02,DARGINS(,@15)                                   1688 06667000
*           DARGINL(1)=LENGTH(VIPRTSN(BUFFCNTR));/*          @Y30LB38*/ 06668000
         LA    @01,6                                               1689 06669000
         STH   @01,DARGINL(,@15)                                   1689 06670000
*           DARGDTM(1)=ADDR(VIPRTSN(BUFFCNTR));/*            @Y30LB38*/ 06671000
         LR    @07,PRINTPTR                                        1690 06672000
         AL    @07,@CF01857                                        1690 06673000
         LA    @07,VIPRTSN(@14,@07)                                1690 06674000
         ST    @07,DARGDTM(,@15)                                   1690 06675000
*           DARGINS(2)=TWO;         /*                       @Y30LB38*/ 06676000
         LA    @07,2                                               1691 06677000
         STH   @07,DARGINS+8(,@15)                                 1691 06678000
*           DARGDTM(2)=ADDR(VIPRTATR(BUFFCNTR));/*           @Y30LB38*/ 06679000
         LR    @07,PRINTPTR                                        1692 06680000
         AL    @07,@CF01858                                        1692 06681000
         LA    @07,VIPRTATR-6(@14,@07)                             1692 06682000
         ST    @07,DARGDTM+8(,@15)                                 1692 06683000
*           DARGINL(2)=LENGTH(VIPRTATR(BUFFCNTR));/*         @Y30LB38*/ 06684000
*                                                                  1693 06685000
         LA    @07,4                                               1693 06686000
         STH   @07,DARGINL+8(,@15)                                 1693 06687000
*           /*********************************************************/ 06688000
*           /*                                                       */ 06689000
*           /* PUT CELL LOCATIONS IN MESSAGE                 @Y30LB38*/ 06690000
*           /*                                                       */ 06691000
*           /*********************************************************/ 06692000
*                                                                  1694 06693000
*           DARGINS(3)=THREE;       /*                       @Y30LB38*/ 06694000
         MVC   DARGINS+16(2,@15),@CH00163                          1694 06695000
*           DARGINL(3)=LENGTH(VIPRTX1(BUFFCNTR));/*          @Y30LB38*/ 06696000
         STH   @02,DARGINL+16(,@15)                                1695 06697000
*           DARGDTM(3)=ADDR(VIPRTX1(BUFFCNTR));/*            @Y30LB38*/ 06698000
         LR    @07,PRINTPTR                                        1696 06699000
         AL    @07,@CF01862                                        1696 06700000
         LA    @07,VIPRTX1-10(@14,@07)                             1696 06701000
         ST    @07,DARGDTM+16(,@15)                                1696 06702000
*           DARGINS(4)=FOUR;        /*                       @Y30LB38*/ 06703000
         LA    @07,4                                               1697 06704000
         STH   @07,DARGINS+24(,@15)                                1697 06705000
*           DARGINL(4)=LENGTH(VIPRTY1(BUFFCNTR));/*          @Y30LB38*/ 06706000
         STH   @02,DARGINL+24(,@15)                                1698 06707000
*           DARGDTM(4)=ADDR(VIPRTY1(BUFFCNTR));/*            @Y30LB38*/ 06708000
         LR    @07,PRINTPTR                                        1699 06709000
         AL    @07,@CF01847                                        1699 06710000
         LA    @07,VIPRTY1-11(@14,@07)                             1699 06711000
         ST    @07,DARGDTM+24(,@15)                                1699 06712000
*           DARGINS(5)=FIVE;        /*                       @Y30LB38*/ 06713000
         MVC   DARGINS+32(2,@15),@CH00287                          1700 06714000
*           DARGINL(5)=LENGTH(VIPRT1(BUFFCNTR));/*           @Y30LB38*/ 06715000
         STH   @02,DARGINL+32(,@15)                                1701 06716000
*           DARGDTM(5)=ADDR(VIPRTZ1(BUFFCNTR));/*            @Y30LB38*/ 06717000
         LR    @07,PRINTPTR                                        1702 06718000
         AL    @07,@CF01863                                        1702 06719000
         LA    @07,VIPRTZ1-12(@14,@07)                             1702 06720000
         ST    @07,DARGDTM+32(,@15)                                1702 06721000
*           DARGINS(6)=SIX;         /*                       @Y30LB38*/ 06722000
         STH   @01,DARGINS+40(,@15)                                1703 06723000
*           DARGINL(6)=LENGTH(VIPRTX2(BUFFCNTR));/*          @Y30LB38*/ 06724000
         STH   @02,DARGINL+40(,@15)                                1704 06725000
*           DARGDTM(6)=ADDR(VIPRTX2(BUFFCNTR));/*            @Y30LB38*/ 06726000
         LR    @07,PRINTPTR                                        1705 06727000
         AL    @07,@CF01865                                        1705 06728000
         LA    @07,VIPRTX2-13(@14,@07)                             1705 06729000
         ST    @07,DARGDTM+40(,@15)                                1705 06730000
*           DARGINS(7)=SEVEN;       /*                       @Y30LB38*/ 06731000
         MVC   DARGINS+48(2,@15),@CH00659                          1706 06732000
*           DARGINL(7)=LENGTH(VIPRTY2(BUFFCNTR));/*          @Y30LB38*/ 06733000
         STH   @02,DARGINL+48(,@15)                                1707 06734000
*           DARGDTM(7)=ADDR(VIPRTY2(BUFFCNTR));/*            @Y30LB38*/ 06735000
         LR    @07,PRINTPTR                                        1708 06736000
         AL    @07,@CF01866                                        1708 06737000
         LA    @07,VIPRTY2-14(@14,@07)                             1708 06738000
         ST    @07,DARGDTM+48(,@15)                                1708 06739000
*           DARGINS(8)=EIGHT;       /*                       @Y30LB38*/ 06740000
         STH   @03,DARGINS+56(,@15)                                1709 06741000
*           DARGINL(8)=LENGTH(VIPRT2(BUFFCNTR));/*           @Y30LB38*/ 06742000
         STH   @02,DARGINL+56(,@15)                                1710 06743000
*           DARGDTM(8)=ADDR(VIPRTZ2(BUFFCNTR));/*            @Y30LB38*/ 06744000
         AL    @14,@CF01867                                        1711 06745000
         LA    @07,VIPRTZ2-15(@14,PRINTPTR)                        1711 06746000
         ST    @07,DARGDTM+56(,@15)                                1711 06747000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/ 06748000
         L     @07,@PC00001                                        1712 06749000
         ST    @07,@AL00001                                        1712 06750000
         LA    @15,PRINTME                                         1712 06751000
         ST    @15,@AL00001+4                                      1712 06752000
         LA    @15,DDSTRU                                          1712 06753000
         ST    @15,@AL00001+8                                      1712 06754000
         MVI   @AL00001+8,X'80'                                    1712 06755000
         L     @15,GDTPRT(,@07)                                    1712 06756000
         LA    @01,@AL00001                                        1712 06757000
         BALR  @14,@15                                             1712 06758000
*         END;                      /*                       @Y30LB38*/ 06759000
*     END;                          /*                       @Y30LB38*/ 06760000
*                                                                  1714 06761000
@RF01680 DS    0H                                                  1715 06762000
*   /*****************************************************************/ 06763000
*   /*                                                               */ 06764000
*   /* IF THE TBLID INDICATES A SCRATCH CARTRIDGE ENTRY,     @Y30LB38*/ 06765000
*   /* ISSUE THE UPRINT MACRO TO PRINT THE LAST LINE OF THE REPORT.  */ 06766000
*   /* THE INDEX INTO THE PRINT BUFFER IS A FIELD CALLED BUFFCNTR    */ 06767000
*   /* USED AS A SUBSCRIPT. THE LENGTH OF A SCRATCH CARTRIDGE ENTRY  */ 06768000
*   /* IS 15.                                                @Y30LB38*/ 06769000
*   /*                                                               */ 06770000
*   /*****************************************************************/ 06771000
*                                                                  1715 06772000
*   IF TBLID=CARTID THEN                                           1715 06773000
@RF01669 CLI   TBLID,4                                             1715 06774000
         BNE   @RF01715                                            1715 06775000
*     DO;                           /*                       @Y30LB38*/ 06776000
*                                                                  1716 06777000
*       /*************************************************************/ 06778000
*       /*                                                           */ 06779000
*       /* IF THE NUMBER OF ENTRIES = 1, SET THE POINTER TO THE      */ 06780000
*       /*                                                   @Y30LB38*/ 06781000
*       /* LAST ENTRY IN THE BUFFER AND ISSUE THE UPRINT MACRO TO    */ 06782000
*       /* PRINT THE LAST LINE OF THE REPORT. IF THE NUMBER OF       */ 06783000
*       /* ENTRIES = 2 SET THE DATA BLOCK POINTER TO THE NEXT TO THE */ 06784000
*       /* LAST ENTRY AND SET UP THE PARAMETER LIST UP FOR 4 INSERTS.*/ 06785000
*       /* EACH INSERT WILL BE A FIELD IN THE LAST ENTRY.    @Y30LB38*/ 06786000
*       /*                                                           */ 06787000
*       /*************************************************************/ 06788000
*                                                                  1717 06789000
*       IF ENTCNTR=ONE THEN                                        1717 06790000
         CLC   ENTCNTR(4),@CF00220                                 1717 06791000
         BNE   @RF01717                                            1717 06792000
*         DO;                       /*                       @Y30LB38*/ 06793000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 06794000
         XC    PRINTAB(84),PRINTAB                                 1719 06795000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 06796000
         L     @07,DDSTRU                                          1720 06797000
         MVC   DARGSMOD(3,@07),@CC01483                            1720 06798000
*           DARGSENT=LMO21;         /*                       @Y30LB38*/ 06799000
         MVI   DARGSENT(@07),X'15'                                 1721 06800000
*           DARGDBP=ADDR(SCPRTBF(BUFFCNTR));/*               @Y30LB38*/ 06801000
         LA    @15,15                                              1722 06802000
         LR    @01,BUFFCNTR                                        1722 06803000
         MR    @00,@15                                             1722 06804000
         AL    @01,@CF01870                                        1722 06805000
         LA    @14,SCPRTBF(@01,PRINTPTR)                           1722 06806000
         ST    @14,DARGDBP(,@07)                                   1722 06807000
*           DARGILP=LENGTH(SCPRTBF(BUFFCNTR));/*             @Y30LB38*/ 06808000
         STH   @15,DARGILP(,@07)                                   1723 06809000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/ 06810000
         L     @07,@PC00001                                        1724 06811000
         ST    @07,@AL00001                                        1724 06812000
         LA    @15,PRINTME                                         1724 06813000
         ST    @15,@AL00001+4                                      1724 06814000
         LA    @15,DDSTRU                                          1724 06815000
         ST    @15,@AL00001+8                                      1724 06816000
         MVI   @AL00001+8,X'80'                                    1724 06817000
         L     @15,GDTPRT(,@07)                                    1724 06818000
         LA    @01,@AL00001                                        1724 06819000
         BALR  @14,@15                                             1724 06820000
*         END;                      /*                       @Y30LB38*/ 06821000
*       IF ENTCNTR=TWO THEN                                        1726 06822000
@RF01717 LA    @07,2                                               1726 06823000
         C     @07,ENTCNTR                                         1726 06824000
         BNE   @RF01726                                            1726 06825000
*         DO;                       /*                       @Y30LB38*/ 06826000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 06827000
         XC    PRINTAB(84),PRINTAB                                 1728 06828000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 06829000
         L     @15,DDSTRU                                          1729 06830000
         MVC   DARGSMOD(3,@15),@CC01483                            1729 06831000
*           DARGSENT=LMO21;         /*                       @Y30LB38*/ 06832000
         MVI   DARGSENT(@15),X'15'                                 1730 06833000
*           DARGDBP=ADDR(SCPRTBF(BUFFCNTR-ONE));/*           @Y30LB38*/ 06834000
         LA    @14,15                                              1731 06835000
         LR    @01,BUFFCNTR                                        1731 06836000
         MR    @00,@14                                             1731 06837000
         LR    @03,PRINTPTR                                        1731 06838000
         AL    @03,@CF01880                                        1731 06839000
         LA    @00,SCPRTBF(@01,@03)                                1731 06840000
         ST    @00,DARGDBP(,@15)                                   1731 06841000
*           DARGILP=LENGTH(SCPRTBF(BUFFCNTR-ONE));/*         @Y30LB38*/ 06842000
         STH   @14,DARGILP(,@15)                                   1732 06843000
*           DARGCNT=FOUR;           /*                       @Y30LB38*/ 06844000
         LA    @14,4                                               1733 06845000
         STH   @14,DARGCNT(,@15)                                   1733 06846000
*           DARGINS(1)=ONE;         /*                       @Y30LB38*/ 06847000
         LA    @03,1                                               1734 06848000
         STH   @03,DARGINS(,@15)                                   1734 06849000
*           DARGINL(1)=LENGTH(SCPRTCS(BUFFCNTR));/*          @Y30LB38*/ 06850000
         MVC   DARGINL(2,@15),@CH00567                             1735 06851000
*           DARGDTM(1)=ADDR(SCPRTCS(BUFFCNTR));/*            @Y30LB38*/ 06852000
         LR    @02,PRINTPTR                                        1736 06853000
         AL    @02,@CF01870                                        1736 06854000
         LA    @00,SCPRTCS(@01,@02)                                1736 06855000
         ST    @00,DARGDTM(,@15)                                   1736 06856000
*           DARGINS(2)=TWO;         /*                       @Y30LB38*/ 06857000
         STH   @07,DARGINS+8(,@15)                                 1737 06858000
*           DARGINL(2)=LENGTH(SCPRTX1(BUFFCNTR));/*          @Y30LB38*/ 06859000
         STH   @03,DARGINL+8(,@15)                                 1738 06860000
*           DARGDTM(2)=ADDR(SCPRTX1(BUFFCNTR));/*            @Y30LB38*/ 06861000
         LR    @07,PRINTPTR                                        1739 06862000
         AL    @07,@CF01865                                        1739 06863000
         LA    @07,SCPRTX1-12(@01,@07)                             1739 06864000
         ST    @07,DARGDTM+8(,@15)                                 1739 06865000
*           DARGINS(3)=THREE;       /*                       @Y30LB38*/ 06866000
         MVC   DARGINS+16(2,@15),@CH00163                          1740 06867000
*           DARGINL(3)=LENGTH(SCPRTY1(BUFFCNTR));/*          @Y30LB38*/ 06868000
         STH   @03,DARGINL+16(,@15)                                1741 06869000
*           DARGDTM(3)=ADDR(SCPRTY1(BUFFCNTR));/*            @Y30LB38*/ 06870000
         LR    @07,PRINTPTR                                        1742 06871000
         AL    @07,@CF01866                                        1742 06872000
         LA    @07,SCPRTY1-13(@01,@07)                             1742 06873000
         ST    @07,DARGDTM+16(,@15)                                1742 06874000
*           DARGINS(4)=FOUR;        /*                       @Y30LB38*/ 06875000
         STH   @14,DARGINS+24(,@15)                                1743 06876000
*           DARGINL(4)=LENGTH(SCPRT1(BUFFCNTR));/*           @Y30LB38*/ 06877000
         STH   @03,DARGINL+24(,@15)                                1744 06878000
*           DARGDTM(4)=ADDR(SCPRTZ1(BUFFCNTR));/*            @Y30LB38*/ 06879000
         AL    @01,@CF01867                                        1745 06880000
         LA    @07,SCPRTZ1-14(@01,PRINTPTR)                        1745 06881000
         ST    @07,DARGDTM+24(,@15)                                1745 06882000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/ 06883000
         L     @07,@PC00001                                        1746 06884000
         ST    @07,@AL00001                                        1746 06885000
         LA    @15,PRINTME                                         1746 06886000
         ST    @15,@AL00001+4                                      1746 06887000
         LA    @15,DDSTRU                                          1746 06888000
         ST    @15,@AL00001+8                                      1746 06889000
         MVI   @AL00001+8,X'80'                                    1746 06890000
         L     @15,GDTPRT(,@07)                                    1746 06891000
         LA    @01,@AL00001                                        1746 06892000
         BALR  @14,@15                                             1746 06893000
*         END;                      /*                       @Y30LB38*/ 06894000
*                                                                  1747 06895000
*       /*************************************************************/ 06896000
*       /*                                                           */ 06897000
*       /* IF THE NUMBER OF ENTRIES = 3, SET THE DATA BLOCK  @Y30LB38*/ 06898000
*       /* POINTER TO THE FIRST OF THE THREE ENTRIES IN THE PRINT    */ 06899000
*       /* BUFFER. SET UP FOR 8 INSERTS WITH FOUR FIELDS BEING IN THE*/ 06900000
*       /* NEXT TO LAST ENTRY AND FOUR FROM THE LAST ENTRY.  @Y30LB38*/ 06901000
*       /*                                                           */ 06902000
*       /*************************************************************/ 06903000
*                                                                  1748 06904000
*       IF ENTCNTR=THREE THEN                                      1748 06905000
@RF01726 LA    @07,3                                               1748 06906000
         C     @07,ENTCNTR                                         1748 06907000
         BNE   @RF01748                                            1748 06908000
*         DO;                       /*                       @Y30LB38*/ 06909000
*           PRINTAB=''B;            /*                       @Y30LB38*/ 06910000
         XC    PRINTAB(84),PRINTAB                                 1750 06911000
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/ 06912000
         L     @15,DDSTRU                                          1751 06913000
         MVC   DARGSMOD(3,@15),@CC01483                            1751 06914000
*           DARGSENT=LMO21;         /*                       @Y30LB38*/ 06915000
         MVI   DARGSENT(@15),X'15'                                 1752 06916000
*           DARGDBP=ADDR(SCPRTBF(BUFFCNTR-TWO));/*           @Y30LB38*/ 06917000
         LA    @14,15                                              1753 06918000
         LR    @01,BUFFCNTR                                        1753 06919000
         MR    @00,@14                                             1753 06920000
         LR    @03,PRINTPTR                                        1753 06921000
         AL    @03,@CF01881                                        1753 06922000
         LA    @00,SCPRTBF(@01,@03)                                1753 06923000
         ST    @00,DARGDBP(,@15)                                   1753 06924000
*           DARGILP=LENGTH(SCPRTBF(BUFFCNTR-TWO));/*         @Y30LB38*/ 06925000
         STH   @14,DARGILP(,@15)                                   1754 06926000
*           DARGCNT=EIGHT;          /*                       @Y30LB38*/ 06927000
*                                                                  1755 06928000
         LA    @14,8                                               1755 06929000
         STH   @14,DARGCNT(,@15)                                   1755 06930000
*           /*********************************************************/ 06931000
*           /*                                                       */ 06932000
*           /* SET UP THE MESSAGE FOR 3 INSERTS. USE THE LAST        */ 06933000
*           /*                                               @Y30LB38*/ 06934000
*           /* 3 FIELDS OF THE LAST ENTRY IN THE PRINT BUFFER.       */ 06935000
*           /*                                               @Y30LB38*/ 06936000
*           /*                                                       */ 06937000
*           /*********************************************************/ 06938000
*                                                                  1756 06939000
*           DARGINS(1)=ONE;         /*                       @Y30LB38*/ 06940000
         LA    @03,1                                               1756 06941000
         STH   @03,DARGINS(,@15)                                   1756 06942000
*           DARGINL(1)=LENGTH(SCPRTCS(BUFFCNTR-ONE));/*      @Y30LB38*/ 06943000
         LA    @02,12                                              1757 06944000
         STH   @02,DARGINL(,@15)                                   1757 06945000
*           DARGDTM(1)=ADDR(SCPRTCS(BUFFCNTR-ONE));/*        @Y30LB38*/ 06946000
         LR    @07,PRINTPTR                                        1758 06947000
         AL    @07,@CF01880                                        1758 06948000
         LA    @07,SCPRTCS(@01,@07)                                1758 06949000
         ST    @07,DARGDTM(,@15)                                   1758 06950000
*           DARGINS(2)=TWO;         /*                       @Y30LB38*/ 06951000
         MVC   DARGINS+8(2,@15),@CH00154                           1759 06952000
*           DARGINL(2)=LENGTH(SCPRTX1(BUFFCNTR-ONE));/*      @Y30LB38*/ 06953000
         STH   @03,DARGINL+8(,@15)                                 1760 06954000
*           DARGDTM(2)=ADDR(SCPRTX1(BUFFCNTR-ONE));/*        @Y30LB38*/ 06955000
         LR    @07,PRINTPTR                                        1761 06956000
         AL    @07,@CF01882                                        1761 06957000
         LA    @07,SCPRTX1-12(@01,@07)                             1761 06958000
         ST    @07,DARGDTM+8(,@15)                                 1761 06959000
*           DARGINS(3)=THREE;       /*                       @Y30LB38*/ 06960000
         LA    @07,3                                               1762 06961000
         STH   @07,DARGINS+16(,@15)                                1762 06962000
*           DARGINL(3)=LENGTH(SCPRTY1(BUFFCNTR-ONE));/*      @Y30LB38*/ 06963000
         STH   @03,DARGINL+16(,@15)                                1763 06964000
*           DARGDTM(3)=ADDR(SCPRTY1(BUFFCNTR-ONE));/*        @Y30LB38*/ 06965000
         LR    @07,PRINTPTR                                        1764 06966000
         AL    @07,@CF01883                                        1764 06967000
         LA    @07,SCPRTY1-13(@01,@07)                             1764 06968000
         ST    @07,DARGDTM+16(,@15)                                1764 06969000
*           DARGINS(4)=FOUR;        /*                       @Y30LB38*/ 06970000
         MVC   DARGINS+24(2,@15),@CH00043                          1765 06971000
*           DARGINL(4)=LENGTH(SCPRT1(BUFFCNTR-ONE));/*       @Y30LB38*/ 06972000
         STH   @03,DARGINL+24(,@15)                                1766 06973000
*           DARGDTM(4)=ADDR(SCPRTZ1(BUFFCNTR-ONE));/*        @Y30LB38*/ 06974000
         LR    @07,PRINTPTR                                        1767 06975000
         AL    @07,@CF01857                                        1767 06976000
         LA    @07,SCPRTZ1-14(@01,@07)                             1767 06977000
         ST    @07,DARGDTM+24(,@15)                                1767 06978000
*           DARGINS(5)=FIVE;        /*                       @Y30LB38*/ 06979000
         MVC   DARGINS+32(2,@15),@CH00287                          1768 06980000
*           DARGINL(5)=LENGTH(SCPRTCS(BUFFCNTR));/*          @Y30LB38*/ 06981000
         STH   @02,DARGINL+32(,@15)                                1769 06982000
*           DARGDTM(5)=ADDR(SCPRTCS(BUFFCNTR));/*            @Y30LB38*/ 06983000
         LR    @07,PRINTPTR                                        1770 06984000
         AL    @07,@CF01870                                        1770 06985000
         LA    @07,SCPRTCS(@01,@07)                                1770 06986000
         ST    @07,DARGDTM+32(,@15)                                1770 06987000
*           DARGINS(6)=SIX;         /*                       @Y30LB38*/ 06988000
         MVC   DARGINS+40(2,@15),@CH00157                          1771 06989000
*           DARGINL(6)=LENGTH(SCPRTX1(BUFFCNTR));/*          @Y30LB38*/ 06990000
         STH   @03,DARGINL+40(,@15)                                1772 06991000
*           DARGDTM(6)=ADDR(SCPRTX1(BUFFCNTR));/*            @Y30LB38*/ 06992000
         LR    @07,PRINTPTR                                        1773 06993000
         AL    @07,@CF01865                                        1773 06994000
         LA    @07,SCPRTX1-12(@01,@07)                             1773 06995000
         ST    @07,DARGDTM+40(,@15)                                1773 06996000
*           DARGINS(7)=SEVEN;       /*                       @Y30LB38*/ 06997000
         MVC   DARGINS+48(2,@15),@CH00659                          1774 06998000
*           DARGINL(7)=LENGTH(SCPRTY1(BUFFCNTR));/*          @Y30LB38*/ 06999000
         STH   @03,DARGINL+48(,@15)                                1775 07000000
*           DARGDTM(7)=ADDR(SCPRTY1(BUFFCNTR));/*            @Y30LB38*/ 07001000
         LR    @07,PRINTPTR                                        1776 07002000
         AL    @07,@CF01866                                        1776 07003000
         LA    @07,SCPRTY1-13(@01,@07)                             1776 07004000
         ST    @07,DARGDTM+48(,@15)                                1776 07005000
*           DARGINS(8)=EIGHT;       /*                       @Y30LB38*/ 07006000
         STH   @14,DARGINS+56(,@15)                                1777 07007000
*           DARGINL(8)=LENGTH(SCPRT1(BUFFCNTR));/*           @Y30LB38*/ 07008000
         STH   @03,DARGINL+56(,@15)                                1778 07009000
*           DARGDTM(8)=ADDR(SCPRTZ1(BUFFCNTR));/*            @Y30LB38*/ 07010000
         AL    @01,@CF01867                                        1779 07011000
         LA    @07,SCPRTZ1-14(@01,PRINTPTR)                        1779 07012000
         ST    @07,DARGDTM+56(,@15)                                1779 07013000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/ 07014000
         L     @07,@PC00001                                        1780 07015000
         ST    @07,@AL00001                                        1780 07016000
         LA    @04,PRINTME                                         1780 07017000
         ST    @04,@AL00001+4                                      1780 07018000
         LA    @04,DDSTRU                                          1780 07019000
         ST    @04,@AL00001+8                                      1780 07020000
         MVI   @AL00001+8,X'80'                                    1780 07021000
         L     @15,GDTPRT(,@07)                                    1780 07022000
         LA    @01,@AL00001                                        1780 07023000
         BALR  @14,@15                                             1780 07024000
*         END;                      /*                       @Y30LB38*/ 07025000
*     END;                          /*                       @Y30LB38*/ 07026000
*                                                                  1782 07027000
@RF01748 DS    0H                                                  1783 07028000
*   /*****************************************************************/ 07029000
*   /*                                                               */ 07030000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 07031000
*   /*                                                               */ 07032000
*   /*****************************************************************/ 07033000
*                                                                  1783 07034000
*   REG14=RETADDR5;                 /*                       @Y30LB38*/ 07035000
@RF01715 L     REG14,RETADDR5                                      1783 07036000
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/ 07037000
         SLR   @15,@15                                             1784 07038000
@EL00017 DS    0H                                                  1784 07039000
@EF00017 DS    0H                                                  1784 07040000
@ER00017 BR    @14                                                 1784 07041000
*   END LASTLINR;                   /*                       @Y30LB38*/ 07042000
*                                                                  1786 07043000
*/***********************************************************@Y30LB39*/ 07044000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07045000
*/*                                                          @Y30LB39*/ 07046000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07047000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07048000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07049000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07050000
*/*                                                          @Y30LB39*/ 07051000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07052000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07053000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07054000
*/*                                                          @Y30LB39*/ 07055000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07056000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07057000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07058000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07059000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07060000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07061000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07062000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07063000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07064000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07065000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07066000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07067000
*/*                                                          @Y30LB39*/ 07068000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07069000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07070000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07071000
*/*                                                          @Y30LB39*/ 07072000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07073000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07074000
*/*                                                          @Y30LB39*/ 07075000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07076000
*/*                                                          @Y30LB39*/ 07077000
*/***********************************************************@Y30LB39*/ 07078000
*                                                                  1786 07079000
*                                   /*                       @Y30LB39*/ 07080000
*SSCMSG:                                                           1786 07081000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07082000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07083000
*                                                            @Y30LB39*/ 07084000
SSCMSG   STM   @14,@12,@SA00018                                    1786 07085000
         MVC   @PC00018(8),0(@01)                                  1786 07086000
*                                   /*                       @Y30LB39*/ 07087000
*                                                                  1787 07088000
*   /*****************************************************************/ 07089000
*   /*                                                               */ 07090000
*   /*                                                       @Y30LB39*/ 07091000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07092000
*   /*                                                       @Y30LB39*/ 07093000
*   /*                                                               */ 07094000
*   /*****************************************************************/ 07095000
*                                                                  1787 07096000
*                                   /*                       @Y30LB39   07097000
*                                                            @Y30LB39*/ 07098000
*                                                                  1787 07099000
*   /*****************************************************************/ 07100000
*   /*                                                               */ 07101000
*   /*                                                       @Y30LB39*/ 07102000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07103000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07104000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07105000
*   /*                                                       @Y30LB39*/ 07106000
*   /*                                                               */ 07107000
*   /*****************************************************************/ 07108000
*                                                                  1787 07109000
*                                   /*                       @Y30LB39*/ 07110000
*   DCL                                                            1787 07111000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07112000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07113000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07114000
*   DCL                                                            1788 07115000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07116000
*                                                            @Y30LB39   07117000
*                                                            @Y30LB39*/ 07118000
*                                                                  1788 07119000
*   /*****************************************************************/ 07120000
*   /*                                                               */ 07121000
*   /*                                                       @Y30LB39*/ 07122000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07123000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07124000
*   /*                                                       @Y30LB39*/ 07125000
*   /*                                                               */ 07126000
*   /*****************************************************************/ 07127000
*                                                                  1789 07128000
*                                   /*                       @Y30LB39*/ 07129000
*   DCL                                                            1789 07130000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07131000
*   DCL                                                            1790 07132000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07133000
*                                                            @Y30LB39*/ 07134000
*                                                                  1790 07135000
*   /*****************************************************************/ 07136000
*   /*                                                               */ 07137000
*   /*                                                       @Y30LB39*/ 07138000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07139000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07140000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07141000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07142000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07143000
*   /*                                                       @Y30LB39*/ 07144000
*   /*                                                               */ 07145000
*   /*****************************************************************/ 07146000
*                                                                  1791 07147000
*                                   /*                       @Y30LB39*/ 07148000
*   DECLARE                                                        1791 07149000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07150000
*                                                            @Y30LB39*/ 07151000
*                                                                  1791 07152000
*   /*****************************************************************/ 07153000
*   /*                                                               */ 07154000
*   /*                                                       @Y30LB39*/ 07155000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07156000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07157000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07158000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07159000
*   /*                                                       @Y30LB39*/ 07160000
*   /*                                                               */ 07161000
*   /*****************************************************************/ 07162000
*                                                                  1792 07163000
*                                   /*                       @Y30LB39*/ 07164000
*   DECLARE                                                        1792 07165000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07166000
*                                                            @Y30LB39*/ 07167000
*                                                                  1792 07168000
*   /*****************************************************************/ 07169000
*   /*                                                               */ 07170000
*   /*                                                       @Y30LB39*/ 07171000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07172000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07173000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07174000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07175000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07176000
*   /*                                                       @Y30LB39*/ 07177000
*   /*                                                               */ 07178000
*   /*****************************************************************/ 07179000
*                                                                  1793 07180000
*                                   /*                       @Y30LB39*/ 07181000
*   DECLARE                                                        1793 07182000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07183000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07184000
*                                                            @Y30LB39*/ 07185000
*                                                                  1793 07186000
*   /*****************************************************************/ 07187000
*   /*                                                               */ 07188000
*   /*                                                       @Y30LB39*/ 07189000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07190000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07191000
*   /*                                                       @Y30LB39*/ 07192000
*   /*                                                               */ 07193000
*   /*****************************************************************/ 07194000
*                                                                  1794 07195000
*                                   /*                       @Y30LB39*/ 07196000
*   DECLARE                                                        1794 07197000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07198000
*                                                            @Y30LB39*/ 07199000
*                                                                  1794 07200000
*   /*****************************************************************/ 07201000
*   /*                                                               */ 07202000
*   /*                                                       @Y30LB39*/ 07203000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07204000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07205000
*   /*                                                       @Y30LB39*/ 07206000
*   /*                                                               */ 07207000
*   /*****************************************************************/ 07208000
*                                                                  1795 07209000
*                                   /*                       @Y30LB39*/ 07210000
*   DECLARE                                                        1795 07211000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07212000
*                                                            @Y30LB39*/ 07213000
*                                   /*                       @Y30LB39*/ 07214000
*                                                                  1796 07215000
*   /*****************************************************************/ 07216000
*   /*                                                               */ 07217000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07218000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07219000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07220000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07221000
*   /*                                                       @Y30LB39*/ 07222000
*   /*                                                               */ 07223000
*   /*****************************************************************/ 07224000
*                                                                  1796 07225000
*                                   /*                       @Y30LB39*/ 07226000
*   OLDERID2=NEWERID2;                                             1796 07227000
         L     @15,@PC00001                                        1796 07228000
         L     @14,GDTTR2(,@15)                                    1796 07229000
         MVC   @TS00001(95),NEWERID2(@14)                          1796 07230000
         MVC   OLDERID2(95,@14),@TS00001                           1796 07231000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07232000
*                                                            @Y30LB39*/ 07233000
*                                                                  1797 07234000
         MVC   NEWID2(4,@14),@CC01817                              1797 07235000
*   /*****************************************************************/ 07236000
*   /*                                                               */ 07237000
*   /*                                                       @Y30LB39*/ 07238000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 07239000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 07240000
*   /*                                                       @Y30LB39*/ 07241000
*   /*                                                               */ 07242000
*   /*****************************************************************/ 07243000
*                                                                  1798 07244000
*                                   /*                       @Y30LB39*/ 07245000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   07246000
*                                                            @Y30LB39*/ 07247000
*                                                                  1798 07248000
         LA    @14,SSDRGLT                                         1798 07249000
         ST    @14,SSDLPTR                                         1798 07250000
*   /*****************************************************************/ 07251000
*   /*                                                               */ 07252000
*   /*                                                       @Y30LB39*/ 07253000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 07254000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 07255000
*   /*                                                       @Y30LB39*/ 07256000
*   /*                                                               */ 07257000
*   /*****************************************************************/ 07258000
*                                                                  1799 07259000
*                                   /*                       @Y30LB39*/ 07260000
*   IF SSRCODE>0 THEN                                              1799 07261000
         L     @07,@PC00018                                        1799 07262000
         L     @07,SSRCODE(,@07)                                   1799 07263000
         LTR   @07,@07                                             1799 07264000
         BNP   @RF01799                                            1799 07265000
*     DO;                           /*                       @Y30LB39   07266000
*                                                            @Y30LB39*/ 07267000
*                                                                  1800 07268000
*       /*************************************************************/ 07269000
*       /*                                                           */ 07270000
*       /*                                                   @Y30LB39*/ 07271000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 07272000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 07273000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 07274000
*       /* CODES.                                            @Y30LB39*/ 07275000
*       /*                                                   @Y30LB39*/ 07276000
*       /*                                                           */ 07277000
*       /*************************************************************/ 07278000
*                                                                  1801 07279000
*                                   /*                       @Y30LB39*/ 07280000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07281000
         XC    SSDRGLT(20),SSDRGLT                                 1801 07282000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 07283000
         LA    @03,SSINXLST                                        1802 07284000
         ST    @03,DARGRETP(,@14)                                  1802 07285000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07286000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1803 07287000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 07288000
         MVI   DARGSENT(@14),X'01'                                 1804 07289000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   07290000
*                                                            @Y30LB39*/ 07291000
*                                                                  1805 07292000
         MVC   DARGRETL(2,@14),@CH01830                            1805 07293000
*       /*************************************************************/ 07294000
*       /*                                                           */ 07295000
*       /*                                                   @Y30LB39*/ 07296000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 07297000
*       /* ARRAY.                                            @Y30LB39*/ 07298000
*       /*                                                   @Y30LB39*/ 07299000
*       /*                                                           */ 07300000
*       /*************************************************************/ 07301000
*                                                                  1806 07302000
*                                   /*                       @Y30LB39*/ 07303000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   07304000
*                                                            @Y30LB39*/ 07305000
*                                                                  1806 07306000
         ST    @15,@AL00001                                        1806 07307000
         LA    @03,@CF00116                                        1806 07308000
         ST    @03,@AL00001+4                                      1806 07309000
         LA    @03,SSDLPTR                                         1806 07310000
         ST    @03,@AL00001+8                                      1806 07311000
         MVI   @AL00001+8,X'80'                                    1806 07312000
         L     @15,GDTPRT(,@15)                                    1806 07313000
         LA    @01,@AL00001                                        1806 07314000
         BALR  @14,@15                                             1806 07315000
*       /*************************************************************/ 07316000
*       /*                                                           */ 07317000
*       /*                                                   @Y30LB39*/ 07318000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 07319000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 07320000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 07321000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 07322000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 07323000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 07324000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 07325000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 07326000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 07327000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 07328000
*       /* REASON CODE.                                      @Y30LB39*/ 07329000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 07330000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 07331000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 07332000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 07333000
*       /*                                                   @Y30LB39*/ 07334000
*       /*                                                           */ 07335000
*       /*************************************************************/ 07336000
*                                                                  1807 07337000
*                                   /*                       @Y30LB39*/ 07338000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 07339000
         LA    ENTRYNUM,1                                          1807 07340000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1808 07341000
@DL01808 DS    0H                                                  1809 07342000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 07343000
         AL    ENTRYNUM,@CF00220                                   1809 07344000
*       END;                        /*                       @Y30LB39   07345000
*                                                            @Y30LB39*/ 07346000
*                                                                  1810 07347000
@DE01808 L     @03,@PC00018                                        1810 07348000
         LR    @15,ENTRYNUM                                        1810 07349000
         ALR   @15,@15                                             1810 07350000
         LH    @15,SSARRAY-2(@15)                                  1810 07351000
         CH    @15,SSRHALF(,@03)                                   1810 07352000
         BE    @DC01808                                            1810 07353000
         SLR   @14,@14                                             1810 07354000
         CR    @15,@14                                             1810 07355000
         BNE   @DL01808                                            1810 07356000
@DC01808 DS    0H                                                  1811 07357000
*       /*************************************************************/ 07358000
*       /*                                                           */ 07359000
*       /*                                                   @Y30LB39*/ 07360000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 07361000
*       /*                                                   @Y30LB39*/ 07362000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 07363000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 07364000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 07365000
*       /* CODE OR                                           @Y30LB39*/ 07366000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 07367000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 07368000
*       /*                                                   @Y30LB39*/ 07369000
*       /*                                                           */ 07370000
*       /*************************************************************/ 07371000
*                                                                  1811 07372000
*                                   /*                       @Y30LB39*/ 07373000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07374000
         XC    SSDRGLT(20),SSDRGLT                                 1811 07375000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07376000
         L     @07,SSDLPTR                                         1812 07377000
         MVC   DARGSMOD(3,@07),SSMODSS0                            1812 07378000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 07379000
         STC   ENTRYNUM,DARGSENT(,@07)                             1813 07380000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 07381000
         CR    @15,@14                                             1814 07382000
         BNE   @RF01814                                            1814 07383000
*         DO;                       /*                       @Y30LB39*/ 07384000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 07385000
         ST    @03,DARGDBP(,@07)                                   1816 07386000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 07387000
         MVC   DARGILP(2,@07),@CH00043                             1817 07388000
*         END;                      /*                       @Y30LB39*/ 07389000
*     END;                          /*                       @Y30LB39*/ 07390000
*                                   /*                       @Y30LB39*/ 07391000
*                                                                  1820 07392000
*   /*****************************************************************/ 07393000
*   /*                                                               */ 07394000
*   /*                                                       @Y30LB39*/ 07395000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 07396000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 07397000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 07398000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 07399000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 07400000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 07401000
*   /* POST CODE.                                            @Y30LB39*/ 07402000
*   /*                                                       @Y30LB39*/ 07403000
*   /*                                                               */ 07404000
*   /*****************************************************************/ 07405000
*                                                                  1820 07406000
*                                   /*                       @Y30LB39*/ 07407000
*   ELSE                            /*                       @Y30LB39*/ 07408000
*     DO;                           /*                       @Y30LB39*/ 07409000
         B     @RC01799                                            1820 07410000
@RF01799 DS    0H                                                  1821 07411000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07412000
         XC    SSDRGLT(20),SSDRGLT                                 1821 07413000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 07414000
         L     @15,SSDLPTR                                         1822 07415000
         MVC   DARGSMOD(3,@15),SSMODCM0                            1822 07416000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 07417000
         MVC   DARGSENT(1,@15),SSMSGNUM                            1823 07418000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 07419000
         L     @14,@PC00018+4                                      1824 07420000
         ST    @14,DARGDBP(,@15)                                   1824 07421000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 07422000
         MVC   DARGILP(2,@15),@CH00220                             1825 07423000
*     END;                          /*                       @Y30LB39   07424000
*                                                            @Y30LB39*/ 07425000
*                                                                  1826 07426000
*   /*****************************************************************/ 07427000
*   /*                                                               */ 07428000
*   /*                                                       @Y30LB39*/ 07429000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 07430000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 07431000
*   /*                                                       @Y30LB39*/ 07432000
*   /*                                                               */ 07433000
*   /*****************************************************************/ 07434000
*                                                                  1827 07435000
*                                   /*                       @Y30LB39*/ 07436000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   07437000
*                                                            @Y30LB39*/ 07438000
*                                                                  1827 07439000
@RC01799 L     @15,@PC00001                                        1827 07440000
         ST    @15,@AL00001                                        1827 07441000
         LA    @14,@CF00116                                        1827 07442000
         ST    @14,@AL00001+4                                      1827 07443000
         LA    @14,SSDLPTR                                         1827 07444000
         ST    @14,@AL00001+8                                      1827 07445000
         MVI   @AL00001+8,X'80'                                    1827 07446000
         L     @15,GDTPRT(,@15)                                    1827 07447000
         LA    @01,@AL00001                                        1827 07448000
         BALR  @14,@15                                             1827 07449000
*   /*****************************************************************/ 07450000
*   /*                                                               */ 07451000
*   /*                                                       @Y30LB39*/ 07452000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 07453000
*   /*                                                       @Y30LB39*/ 07454000
*   /*                                                               */ 07455000
*   /*****************************************************************/ 07456000
*                                                                  1828 07457000
*                                   /*                       @Y30LB39   07458000
*                                                            @Y30LB39*/ 07459000
*   RETURN CODE(0);                 /*                       @Y30LB39   07460000
*                                                            @Y30LB39*/ 07461000
         SLR   @15,@15                                             1828 07462000
         L     @14,@SA00018                                        1828 07463000
         LM    @00,@12,@SA00018+8                                  1828 07464000
         BR    @14                                                 1828 07465000
*   END SSCMSG;                     /*                       @Y30LB39*/ 07466000
*   END IDCLM01                     /*                       @Y30LB38*/ 07467000
*                                                                  1830 07468000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07469000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 07470000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 07471000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 07472000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 07473000
*/*%INCLUDE SYSLIB  (IDCCSLM )                                       */ 07474000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 07475000
*                                                                  1830 07476000
*       ;                                                          1830 07477000
@DATA    DS    0H                                                       07478000
@CH00154 DC    H'2'                                                     07479000
@CH00163 DC    H'3'                                                     07480000
@CH00287 DC    H'5'                                                     07481000
@CH00157 DC    H'6'                                                     07482000
@CH00229 DC    H'15'                                                    07483000
@CH00311 DC    H'24'                                                    07484000
@CH01312 DC    H'28'                                                    07485000
@CH01823 DC    H'38'                                                    07486000
@CH01830 DC    H'120'                                                   07487000
@CH01824 DC    H'242'                                                   07488000
@CH01410 DC    H'363'                                                   07489000
@CH01448 DC    H'3800'                                                  07490000
@SC01848 CLC   SRTITEM(0,CURPTR),NEWENT                                 07491000
@SM01850 MVC   SRTITEM(0,CURPTR),NEWENT                                 07492000
@SC01853 CLC   NEWENT(0),BLKENT(MGENTPTR)                               07493000
@SM01855 MVC   NEWENT(0),BLKENT(MGENTPTR)                               07494000
@SC01871 CLC   SRTITEM(0,SORTENTP),BLKENT(MGENTPTR)                     07495000
@SM01873 MVC   BLKENT(0,@15),SRTITEM(SORTENTP)                          07496000
@SM01875 MVC   BLKENT(0,@15),BLKENT(MGENTPTR)                           07497000
@SM01877 MVC   BLKENT(0,@02),BLKENT1(MGENTPTR)                          07498000
         DS    0F                                                       07499000
@AL01196 EQU   *                       LIST WITH   2 ARGUMENT(S)        07500000
@AL01288 DC    A(@CC01491)             LIST WITH   2 ARGUMENT(S)        07501000
         DC    AL1(X'80')                                               07502000
         DC    AL3(ALL)                                                 07503000
@DATD    DSECT                                                          07504000
         DS    0F                                                       07505000
@SA00001 DS    18F                                                      07506000
@PC00001 DS    3F                                                       07507000
@SA00018 DS    15F                                                      07508000
@PC00018 DS    2F                                                       07509000
@PC00016 DS    3F                                                       07510000
@AL00001 DS    6A                                                       07511000
@TF00001 DS    F                                                        07512000
@AFTEMPS DS    2F                                                       07513000
IDCLM01  CSECT                                                          07514000
         DS    0F                                                       07515000
@CF00116 DC    F'0'                                                     07516000
@CF00220 DC    F'1'                                                     07517000
@CH00220 EQU   @CF00220+2                                               07518000
@CF00043 DC    F'4'                                                     07519000
@CH00043 EQU   @CF00043+2                                               07520000
@CF00659 DC    F'7'                                                     07521000
@CH00659 EQU   @CF00659+2                                               07522000
@CF00180 DC    F'8'                                                     07523000
@CH00180 EQU   @CF00180+2                                               07524000
@CF00445 DC    F'10'                                                    07525000
@CF00567 DC    F'12'                                                    07526000
@CH00567 EQU   @CF00567+2                                               07527000
@CF00475 DC    F'16'                                                    07528000
@CH00475 EQU   @CF00475+2                                               07529000
@CF01463 DC    F'18'                                                    07530000
@CF00222 DC    F'32'                                                    07531000
@CF01541 DC    F'84'                                                    07532000
@CF01822 DC    F'96'                                                    07533000
@CH01822 EQU   @CF01822+2                                               07534000
@CF01682 DC    F'121'                                                   07535000
@CF01555 DC    F'142'                                                   07536000
@CF01548 DC    F'166'                                                   07537000
@CF01285 DC    F'256'                                                   07538000
@CF01464 DC    F'264'                                                   07539000
@CH01464 EQU   @CF01464+2                                               07540000
@CF01649 DC    F'2048'                                                  07541000
@CF01818 DC    F'7600'                                                  07542000
@CF01820 DC    F'16048'                                                 07543000
@CF01881 DC    F'-45'                                                   07544000
@CF01879 DC    F'-32'                                                   07545000
@CF01880 DC    F'-30'                                                   07546000
@CF01868 DC    F'-28'                                                   07547000
@CF01869 DC    F'-22'                                                   07548000
@CF01882 DC    F'-18'                                                   07549000
@CF01883 DC    F'-17'                                                   07550000
@CF01857 DC    F'-16'                                                   07551000
@CF01870 DC    F'-15'                                                   07552000
@CF01858 DC    F'-10'                                                   07553000
@CF01859 DC    F'-9'                                                    07554000
@CF01860 DC    F'-8'                                                    07555000
@CF01861 DC    F'-7'                                                    07556000
@CF01862 DC    F'-6'                                                    07557000
@CF01847 DC    F'-5'                                                    07558000
@CF01863 DC    F'-4'                                                    07559000
@CF01865 DC    F'-3'                                                    07560000
@CF01866 DC    F'-2'                                                    07561000
@CF01867 DC    F'-1'                                                    07562000
@CF01843 DC    XL4'0000FFFF'                                            07563000
@DATD    DSECT                                                          07564000
         DS    0D                                                       07565000
LISTSCAN DS    A                                                        07566000
IOCSPTR  DS    A                                                        07567000
DDSTRU   DS    A                                                        07568000
FSADDR   DS    A                                                        07569000
ERCNVADR DS    A                                                        07570000
CCMSGPTR DS    A                                                        07571000
CMMSGPTR DS    A                                                        07572000
CTMSGPTR DS    A                                                        07573000
ELEMENT  DS    F                                                        07574000
COTPTR   DS    A                                                        07575000
ACQPTR   DS    A                                                        07576000
RETADDR1 DS    A                                                        07577000
RETADDR2 DS    A                                                        07578000
RETADDR3 DS    A                                                        07579000
RETADDR4 DS    A                                                        07580000
RETADDR5 DS    A                                                        07581000
RETADDR6 DS    A                                                        07582000
RETADDR7 DS    A                                                        07583000
RETADDR8 DS    A                                                        07584000
PRINTME  DS    A                                                        07585000
TRKPTR   DS    A                                                        07586000
CKPTR    DS    A                                                        07587000
WORKPTR  DS    A                                                        07588000
ALLOCPTR DS    A                                                        07589000
BLOCKPTR DS    A                                                        07590000
ENTPTR   DS    A                                                        07591000
SORTPTR  DS    A                                                        07592000
EXGPTR   DS    A                                                        07593000
REASONCD DS    F                                                        07594000
WORK1    DS    F                                                        07595000
WORK3    DS    F                                                        07596000
ENTCNTR  DS    F                                                        07597000
LINCNTR  DS    F                                                        07598000
CORESIZE DS    F                                                        07599000
RTNAREA  DS    A                                                        07600000
VOLSRPTR DS    A                                                        07601000
UCBPTR   DS    A                                                        07602000
NEWFPTR  DS    A                                                        07603000
MRGADDR  DS    A                                                        07604000
MRGCNTR  DS    F                                                        07605000
MRGPOOL  DS    F                                                        07606000
SSDLPTR  DS    A                                                        07607000
LISTPTR  DS    A                                                        07608000
I2       DS    H                                                        07609000
I6       DS    H                                                        07610000
I7       DS    H                                                        07611000
I9       DS    H                                                        07612000
RPTCODE  DS    H                                                        07613000
SORTCODE DS    H                                                        07614000
MRGCODE  DS    H                                                        07615000
SETRC    DS    H                                                        07616000
LISTLN   DS    FL1                                                      07617000
@TS00001 DS    CL95                                                     07618000
PRINTAB  DS    CL84                                                     07619000
FLAGS    DS    BL1                                                      07620000
         ORG   FLAGS                                                    07621000
BADMSF   DS    BL1                                                      07622000
GOTCORE  EQU   FLAGS+0                                                  07623000
FIRSTTIM EQU   FLAGS+0                                                  07624000
ACQSW    EQU   FLAGS+0                                                  07625000
@NM00098 EQU   FLAGS+0                                                  07626000
         ORG   FLAGS+1                                                  07627000
         DS    CL3                                                      07628000
INTTBL   DS    CL159                                                    07629000
         ORG   INTTBL                                                   07630000
TBLNAME  DS    CL6                                                      07631000
TBLID    DS    FL1                                                      07632000
EXTADR   DS    CL10                                                     07633000
         ORG   EXTADR                                                   07634000
SBDY     DS    CL5                                                      07635000
         ORG   SBDY                                                     07636000
SCYL     DS    CL2                                                      07637000
STRK     DS    CL2                                                      07638000
SREC     DS    CL1                                                      07639000
         ORG   EXTADR+5                                                 07640000
EBDY     DS    CL5                                                      07641000
         ORG   EBDY                                                     07642000
ECYL     DS    CL2                                                      07643000
ETRK     DS    CL2                                                      07644000
EREC     DS    CL1                                                      07645000
         ORG   INTTBL+17                                                07646000
WRKVOL   DS    CL6                                                      07647000
LASTRK   DS    CL5                                                      07648000
         ORG   LASTRK                                                   07649000
C        DS    CL2                                                      07650000
H        DS    CL2                                                      07651000
R        DS    CL1                                                      07652000
         ORG   INTTBL+28                                                07653000
MRGBLKS  DS    7A                                                       07654000
MRGCOUNT DS    7A                                                       07655000
SCCNTR   DS    FL4                                                      07656000
VICNTR   DS    FL4                                                      07657000
TVCNTR   DS    FL4                                                      07658000
ECCNTR   DS    FL4                                                      07659000
BLKITEMS DS    FL4                                                      07660000
KEYLEN   DS    FL1                                                      07661000
ITEMLEN  DS    FL1                                                      07662000
ADDRDIF  DS    CL2                                                      07663000
ENTYLIM  DS    FL1                                                      07664000
BUFFLIM  DS    FL1                                                      07665000
INTTRKS  DS    CL25                                                     07666000
         ORG   INTTRKS                                                  07667000
MAPADDR  DS    CL5                                                      07668000
         ORG   MAPADDR                                                  07669000
@NM00124 DS    CL1                                                      07670000
MAPCC    DS    FL1                                                      07671000
@NM00125 DS    CL1                                                      07672000
MAPHH    DS    FL1                                                      07673000
MAPRR    DS    FL1                                                      07674000
         ORG   INTTRKS+5                                                07675000
TRANADDR DS    CL5                                                      07676000
         ORG   TRANADDR                                                 07677000
@NM00126 DS    CL1                                                      07678000
TRANCC   DS    FL1                                                      07679000
@NM00127 DS    CL1                                                      07680000
TRANHH   DS    FL1                                                      07681000
TRANRR   DS    FL1                                                      07682000
         ORG   INTTRKS+10                                               07683000
VOLIADDR DS    CL5                                                      07684000
         ORG   VOLIADDR                                                 07685000
@NM00128 DS    CL1                                                      07686000
VOLCC    DS    FL1                                                      07687000
@NM00129 DS    CL1                                                      07688000
VOLHH    DS    FL1                                                      07689000
VOLRR    DS    FL1                                                      07690000
         ORG   INTTRKS+15                                               07691000
CARTADDR DS    CL5                                                      07692000
         ORG   CARTADDR                                                 07693000
@NM00130 DS    CL1                                                      07694000
CARTCC   DS    FL1                                                      07695000
@NM00131 DS    CL1                                                      07696000
CARTHH   DS    FL1                                                      07697000
CARTRR   DS    FL1                                                      07698000
         ORG   INTTRKS+20                                               07699000
CONFADDR DS    CL5                                                      07700000
         ORG   CONFADDR                                                 07701000
@NM00132 DS    CL1                                                      07702000
CONCC    DS    FL1                                                      07703000
@NM00133 DS    CL1                                                      07704000
CONHH    DS    FL1                                                      07705000
CONRR    DS    FL1                                                      07706000
         ORG   INTTBL+135                                               07707000
NEWENT   DS    CL24                                                     07708000
         ORG   INTTBL+159                                               07709000
TITLBUFF DS    CL363                                                    07710000
OPENLIST DS    CL384                                                    07711000
UCBLIST  DS    CL29                                                     07712000
EXOLIST  DS    CL34                                                     07713000
ALOCLIST DS    CL31                                                     07714000
ACQLISTT DS    CL96                                                     07715000
COTLISTT DS    CL24                                                     07716000
EXGARG1  DS    CL32                                                     07717000
DMPSTG   DS    CL17                                                     07718000
PRNTCONS DS    CL4                                                      07719000
         ORG   PRNTCONS                                                 07720000
PRINTB   DS    CL1                                                      07721000
PRINTR   DS    CL1                                                      07722000
PRINTD   DS    CL1                                                      07723000
PRINTE   DS    CL1                                                      07724000
         ORG   PRNTCONS+4                                               07725000
IOINFO   DS    CL1                                                      07726000
         DS    CL2                                                      07727000
INFOAREA DS    CL38                                                     07728000
         ORG   INFOAREA                                                 07729000
WORKLEN  DS    FL2                                                      07730000
RETNLEN  DS    FL2                                                      07731000
TYPE     DS    FL2                                                      07732000
DATALEN  DS    FL2                                                      07733000
VOLAREA  DS    5CL6                                                     07734000
         ORG   INFOAREA+38                                              07735000
UNITLIST DS    CL12                                                     07736000
         ORG   UNITLIST                                                 07737000
COUNT    DS    FL2                                                      07738000
DEVLEN   DS    FL2                                                      07739000
DEVTYPE  DS    CL8                                                      07740000
         ORG   UNITLIST+12                                              07741000
DDNAME   DS    CL8                                                      07742000
ECB      DS    CL1                                                      07743000
         DS    CL1                                                      07744000
CCHHR    DS    CL5                                                      07745000
         ORG   CCHHR                                                    07746000
CC       DS    FL2                                                      07747000
HH       DS    FL2                                                      07748000
RR       DS    FL1                                                      07749000
         ORG   CCHHR+5                                                  07750000
         DS    CL3                                                      07751000
PCARG    DS    CL33                                                     07752000
         ORG   PCARG                                                    07753000
PCMTLP   DS    AL4                                                      07754000
PCSTLP   DS    AL4                                                      07755000
PCFLP    DS    AL4                                                      07756000
PCPCP    DS    AL4                                                      07757000
PCPNL    DS    FL2                                                      07758000
PCPTL    DS    FL2                                                      07759000
PCPDL    DS    FL2                                                      07760000
PCMTLC   DS    FL2                                                      07761000
PCSTLC   DS    FL2                                                      07762000
PCFLC    DS    FL2                                                      07763000
PCLW     DS    FL2                                                      07764000
PCPD     DS    FL2                                                      07765000
PCDSC    DS    AL1                                                      07766000
         ORG   PCARG+33                                                 07767000
TESTBYTE DS    BL1                                                      07768000
         ORG   TESTBYTE                                                 07769000
BIT1     DS    BL1                                                      07770000
BIT2     EQU   TESTBYTE+0                                               07771000
BIT3     EQU   TESTBYTE+0                                               07772000
BIT4     EQU   TESTBYTE+0                                               07773000
BIT5     EQU   TESTBYTE+0                                               07774000
BIT6     EQU   TESTBYTE+0                                               07775000
BIT7     EQU   TESTBYTE+0                                               07776000
BIT8     EQU   TESTBYTE+0                                               07777000
         ORG   TESTBYTE+1                                               07778000
SSDRGLT  DS    CL20                                                     07779000
         DS    CL2                                                      07780000
SSINXLST DS    CL120                                                    07781000
         ORG   SSINXLST                                                 07782000
SSARRAY  DS    60H                                                      07783000
         ORG   SSINXLST+120                                             07784000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07785000
@ENDDATD EQU   *                                                        07786000
IDCLM01  CSECT                                                          07787000
         DS    0F                                                       07788000
@SIZDATD DC    AL1(0)                                                   07789000
         DC    AL3(@ENDDATD-@DATD)                                      07790000
         DS    0D                                                       07791000
CNTRVAL  DC    XL4'7FFFFFFF'                                            07792000
NOREPT   DC    XL2'7FFF'                                                07793000
SSMSGNUM DC    AL1(56)                                                  07794000
@CC01590 DC    C'COTBLIST'                                              07795000
@CC01531 DC    C'ACQLIST'                                               07796000
@CC01524 DC    C'SDG00'                                                 07797000
@CC01491 DC    C'LM01'                                                  07798000
@CC01496 DC    C'LMAA'                                                  07799000
@CC01507 DC    C'LMAZ'                                                  07800000
@CC01528 DC    C'LMBA'                                                  07801000
@CC01533 DC    C'LMBF'                                                  07802000
@CC01561 DC    C'LMCA'                                                  07803000
@CC01568 DC    C'LMDA'                                                  07804000
@CC01588 DC    C'LMEA'                                                  07805000
@CC01591 DC    C'LMEB'                                                  07806000
@CC01601 DC    C'LMFA'                                                  07807000
@CC01608 DC    C'LMGA'                                                  07808000
@CC01614 DC    C'LMHA'                                                  07809000
@CC01631 DC    C'LMIA'                                                  07810000
@CC01640 DC    C'LMJA'                                                  07811000
@CC01650 DC    C'LMKA'                                                  07812000
@CC01681 DC    C'LMLA'                                                  07813000
@CC01690 DC    C'LMMA'                                                  07814000
@CC01753 DC    C'LMNA'                                                  07815000
@CC01773 DC    C'LMOA'                                                  07816000
@CC01785 DC    C'LMLP'                                                  07817000
@CC01795 DC    C'LMPA'                                                  07818000
@CC01817 DC    C'SSAA'                                                  07819000
@CC01481 DC    C'UV0'                                                   07820000
@CC01483 EQU   @CC01491                                                 07821000
ALL      DC    CL3'ALL'                                                 07822000
FORMAT   DC    CL4'FORM'                                                07823000
HSECOND  DC    CL4'HSEC'                                                07824000
CLOCK    DC    CL4'KLOK'                                                07825000
SETZERO  DC    CL4'ZERO'                                                07826000
SETBLANK DC    CL4'BLNK'                                                07827000
NOSET    DC    CL4'NSET'                                                07828000
OVERRIDE DC    CL4'OVRD'                                                07829000
ACQUIRE  DC    CL8'ACQUIRE '                                            07830000
RELINQ   DC    CL8'RELINQ  '                                            07831000
MOUNT    DC    CL8'MOUNT   '                                            07832000
DEMOUNT  DC    CL8'DEMOUNT '                                            07833000
DEFINE   DC    CL8'DEFINE  '                                            07834000
MOVE     DC    CL8'MOVE    '                                            07835000
TRACEQ   DC    CL8'TRACEQ  '                                            07836000
COPYTABL DC    CL8'COPYTABL'                                            07837000
COPYCRTG DC    CL8'COPYCRTG'                                            07838000
COPYVOL  DC    CL8'COPYVOL '                                            07839000
VVIC     DC    CL8'VVIC    '                                            07840000
TUNE     DC    CL8'TUNE    '                                            07841000
NAMES    DC    CL4'NAME'                                                07842000
UNIT     DC    CL4'UNIT'                                                07843000
SHR      DC    CL4'SHR '                                                07844000
EXCL     DC    CL4'EXCL'                                                07845000
NOWAIT   DC    CL4'NWAI'                                                07846000
WAIT     DC    CL4'WAIT'                                                07847000
SECCHECK DC    CL8'SECCHECK'                                            07848000
SCRVTOC  DC    CL8'SCRVTOC '                                            07849000
GETVTOC  DC    CL8'GETVTOC '                                            07850000
PUTVTOC  DC    CL8'PUTVTOC '                                            07851000
RECATLG  DC    CL8'RECATLG '                                            07852000
INITVOL  DC    CL8'INITVOL '                                            07853000
CHECK    DC    CL8'CHECK   '                                            07854000
POSTUCB  DC    CL8'POSTUCB '                                            07855000
GET      DC    CL8'GET     '                                            07856000
PUT      DC    CL8'PUT     '                                            07857000
CLOSE    DC    CL8'CLOSE   '                                            07858000
OPEN     DC    CL8'OPEN    '                                            07859000
RVOPENR  DC    CL8'OPENR   '                                            07860000
RVRDCNT  DC    CL8'READCNT '                                            07861000
RVREADKD DC    CL8'READKD  '                                            07862000
RVSPACCR DC    CL8'SPACCR  '                                            07863000
RVFWRITE DC    CL8'FWRITE  '                                            07864000
RVWRITER DC    CL8'WRITEREC'                                            07865000
PUTLABEL DC    CL8'PUTLABEL'                                            07866000
GETLABEL DC    CL8'GETLABEL'                                            07867000
CANCEL   DC    CL8'CANCEL  '                                            07868000
SET      DC    CL8'SET     '                                            07869000
SELECTX  DC    CL8'SELECTX '                                            07870000
CHANGEX  DC    CL8'CHANGEX '                                            07871000
SELECTDD DC    CL8'SELECTDD'                                            07872000
SELECTDS DC    CL8'SELECTDS'                                            07873000
TBLREST  DC    CL8'TBLREST '                                            07874000
NULLIFYC DC    CL8'NULLIFYC'                                            07875000
RDMSC    DC    CL8'RDMSC   '                                            07876000
RDMSCTBL DC    CL8'RDMSCTBL'                                            07877000
RDCARTLB DC    CL8'RDCARTLB'                                            07878000
AUDITCEL DC    CL8'AUDITCEL'                                            07879000
RDSTGAD  DC    CL8'RDSTGAD '                                            07880000
CHARZERO DC    X'0000000000'                                            07881000
LMZERO   DC    CL8'00000000'                                            07882000
STARTVAL DC    X'FFFFFFFFFFFFFFFFFFFFFFFF'                              07883000
MODID    DC    CL4'LM01'                                                07884000
FIXAREA  DS    CL650                                                    07885000
         ORG   FIXAREA                                                  07886000
@NM00134 DC    650X'00'                                                 07887000
         ORG   FIXAREA+650                                              07888000
SSMODSS0 DC    CL3'SS0'                                                 07889000
SSMODCM0 DC    CL3'CM0'                                                 07890000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07891000
@01      EQU   01                                                       07892000
@02      EQU   02                                                       07893000
@03      EQU   03                                                       07894000
@04      EQU   04                                                       07895000
@05      EQU   05                                                       07896000
@06      EQU   06                                                       07897000
@07      EQU   07                                                       07898000
@08      EQU   08                                                       07899000
@09      EQU   09                                                       07900000
@10      EQU   10                                                       07901000
@11      EQU   11                                                       07902000
@12      EQU   12                                                       07903000
@13      EQU   13                                                       07904000
@14      EQU   14                                                       07905000
@15      EQU   15                                                       07906000
ENTRYNUM EQU   @02                                                      07907000
MRGLCODE EQU   @03                                                      07908000
SORTENTP EQU   @06                                                      07909000
SUMRCODE EQU   @04                                                      07910000
MRGEPTR  EQU   @02                                                      07911000
HEADCODE EQU   @03                                                      07912000
NEWPTR   EQU   @06                                                      07913000
NEWBPTR  EQU   @02                                                      07914000
FMTRCODE EQU   @06                                                      07915000
ITEMCODE EQU   @06                                                      07916000
BLKCODE  EQU   @06                                                      07917000
TRKCODE  EQU   @07                                                      07918000
CYLWORK  EQU   @02                                                      07919000
CARTWORK EQU   @02                                                      07920000
MSFCODE  EQU   @06                                                      07921000
RPTCCODE EQU   @06                                                      07922000
OPENCODE EQU   @06                                                      07923000
MGENTPTR EQU   @03                                                      07924000
BUFFCNTR EQU   @04                                                      07925000
WORK2    EQU   @02                                                      07926000
I8       EQU   @02                                                      07927000
I4       EQU   @02                                                      07928000
I3       EQU   @03                                                      07929000
I        EQU   @07                                                      07930000
CURPTR   EQU   @03                                                      07931000
PRINTPTR EQU   @05                                                      07932000
CONFPTR  EQU   @02                                                      07933000
EXOPTR   EQU   @07                                                      07934000
DMPINDEX EQU   @02                                                      07935000
OPNPTR   EQU   @06                                                      07936000
TESTRC   EQU   @03                                                      07937000
REG8     EQU   @08                                                      07938000
REG9     EQU   @09                                                      07939000
REG10    EQU   @10                                                      07940000
REG12    EQU   @12                                                      07941000
RTNREG   EQU   @15                                                      07942000
REG14    EQU   @14                                                      07943000
ARR1     EQU   @01                                                      07944000
COTBR1   EQU   @01                                                      07945000
REG0     EQU   @00                                                      07946000
REG1     EQU   @01                                                      07947000
REG11    EQU   @11                                                      07948000
REG13    EQU   @13                                                      07949000
REG15    EQU   @15                                                      07950000
REG2     EQU   @02                                                      07951000
REG3     EQU   @03                                                      07952000
REG4     EQU   @04                                                      07953000
REG5     EQU   @05                                                      07954000
REG6     EQU   @06                                                      07955000
REG7     EQU   @07                                                      07956000
IDCSAEP0 EQU   0                                                        07957000
IDCSAGS0 EQU   0                                                        07958000
IDCSAFS0 EQU   0                                                        07959000
IDCSAGP0 EQU   0                                                        07960000
IDCSAFP0 EQU   0                                                        07961000
IDCSAAL0 EQU   0                                                        07962000
IDCSADL0 EQU   0                                                        07963000
IDCSASS0 EQU   0                                                        07964000
IDCSA060 EQU   0                                                        07965000
TRACE1   EQU   0                                                        07966000
OLDERID1 EQU   TRACE1                                                   07967000
TRACE2   EQU   0                                                        07968000
OLDERID2 EQU   TRACE2                                                   07969000
NEWID2   EQU   TRACE2+95                                                07970000
NEWERID2 EQU   5                                                        07971000
CIRAGL   EQU   0                                                        07972000
CIRTYPE  EQU   CIRAGL                                                   07973000
ALLAGL   EQU   0                                                        07974000
ALLDSN   EQU   ALLAGL                                                   07975000
ALLDDN   EQU   ALLAGL+4                                                 07976000
ALLULP   EQU   ALLAGL+12                                                07977000
ALLSTS   EQU   ALLAGL+24                                                07978000
ALLSTSOD EQU   ALLSTS                                                   07979000
ALLDSP   EQU   ALLAGL+25                                                07980000
ALLDSPKP EQU   ALLDSP                                                   07981000
ALLORG   EQU   ALLAGL+26                                                07982000
ALLOPT   EQU   ALLAGL+28                                                07983000
ALLOPTDS EQU   ALLOPT                                                   07984000
UNITABL  EQU   0                                                        07985000
UNITADR  EQU   UNITABL+4                                                07986000
@NM00010 EQU   UNITADR                                                  07987000
UNITSTAT EQU   UNITABL+6                                                07988000
IDCIOOP0 EQU   0                                                        07989000
IDCIOCL0 EQU   0                                                        07990000
IDCIOSI0 EQU   0                                                        07991000
IDCIO050 EQU   0                                                        07992000
IOCSTR   EQU   0                                                        07993000
IOCDSO   EQU   IOCSTR+16                                                07994000
IOCRFM   EQU   IOCSTR+17                                                07995000
IOCMAC   EQU   IOCSTR+18                                                07996000
IOCMAC2  EQU   IOCSTR+19                                                07997000
IOCCHP   EQU   IOCSTR+20                                                07998000
IOCMSG   EQU   IOCSTR+21                                                07999000
IOCRBA   EQU   IOCSTR+40                                                08000000
IOCTTR   EQU   IOCRBA                                                   08001000
IOCMEM   EQU   IOCSTR+44                                                08002000
IOCNWM   EQU   IOCSTR+48                                                08003000
OPNAGL   EQU   0                                                        08004000
OPNOPT   EQU   OPNAGL                                                   08005000
OPNOPTOT EQU   OPNOPT                                                   08006000
OPNRFM   EQU   OPNAGL+1                                                 08007000
OPNTYP   EQU   OPNAGL+2                                                 08008000
OPNMOD   EQU   OPNAGL+3                                                 08009000
OPNMODAC EQU   OPNMOD                                                   08010000
OPNIOC   EQU   OPNAGL+4                                                 08011000
OPNDDN   EQU   OPNAGL+8                                                 08012000
OPNDSN   EQU   OPNAGL+16                                                08013000
OPNDEV   EQU   OPNAGL+24                                                08014000
OPNDSO   EQU   OPNAGL+41                                                08015000
OPNOPT2  EQU   OPNAGL+42                                                08016000
IOINFOPT EQU   0                                                        08017000
IOINFVOL EQU   IOINFOPT                                                 08018000
UVOLLIST EQU   0                                                        08019000
UVOLENT  EQU   UVOLLIST+2                                               08020000
AMSTP011 EQU   0                                                        08021000
AMSTP042 EQU   0                                                        08022000
AMSTP044 EQU   0                                                        08023000
DARGLIST EQU   0                                                        08024000
DARGDBP  EQU   DARGLIST                                                 08025000
DARGRETP EQU   DARGLIST+4                                               08026000
DARGSTID EQU   DARGLIST+8                                               08027000
DARGSMOD EQU   DARGSTID                                                 08028000
DARGSENT EQU   DARGSTID+3                                               08029000
DARGILP  EQU   DARGLIST+12                                              08030000
DARGCNT  EQU   DARGLIST+14                                              08031000
DARGRETL EQU   DARGLIST+16                                              08032000
DARGARY  EQU   DARGLIST+20                                              08033000
DARGINS  EQU   DARGARY                                                  08034000
DARGREP  EQU   DARGINS                                                  08035000
DARGINL  EQU   DARGARY+2                                                08036000
DARGPCT  EQU   DARGINL                                                  08037000
DARGDTM  EQU   DARGARY+4                                                08038000
FMTLIST  EQU   0                                                        08039000
FMTFLGS  EQU   FMTLIST                                                  08040000
FMTSPF   EQU   FMTLIST+2                                                08041000
FMTRFNO  EQU   FMTSPF                                                   08042000
FMTILEN  EQU   FMTRFNO                                                  08043000
FMTIOFF  EQU   FMTLIST+4                                                08044000
FMTTRBC  EQU   FMTIOFF                                                  08045000
FMTSTO   EQU   FMTTRBC                                                  08046000
FMTOCOL  EQU   FMTLIST+6                                                08047000
FMTCNVF  EQU   FMTLIST+10                                               08048000
ERCNVTAB EQU   0                                                        08049000
ERTYPE   EQU   ERCNVTAB                                                 08050000
EROPER   EQU   ERCNVTAB+1                                               08051000
EROSOPER EQU   ERCNVTAB+2                                               08052000
IDCDB010 EQU   0                                                        08053000
DMPITM   EQU   0                                                        08054000
DMPITMNM EQU   DMPITM                                                   08055000
DMPITMPT EQU   DMPITM+8                                                 08056000
DMPITMLN EQU   DMPITM+12                                                08057000
DMPITMTP EQU   DMPITM+14                                                08058000
DMPARY   EQU   0                                                        08059000
DMPTRM   EQU   0                                                        08060000
CCMSG    EQU   0                                                        08061000
CMMSG    EQU   0                                                        08062000
CMVOLFLG EQU   CMMSG+6                                                  08063000
CTMSG    EQU   0                                                        08064000
CTREALCC EQU   CTMSG+1                                                  08065000
CTARRAY  EQU   CTMSG+4                                                  08066000
CTTBLCC  EQU   CTARRAY+1                                                08067000
CTTBLHH  EQU   CTARRAY+2                                                08068000
CTTBLRR  EQU   CTARRAY+3                                                08069000
MDAGL    EQU   0                                                        08070000
MDFLAGS  EQU   MDAGL+30                                                 08071000
MDVTOC   EQU   MDAGL+32                                                 08072000
PUAGL    EQU   0                                                        08073000
CKAGL    EQU   0                                                        08074000
CKUCBPTR EQU   CKAGL+8                                                  08075000
CKDDNAME EQU   CKAGL+12                                                 08076000
CKLABELP EQU   CKAGL+24                                                 08077000
CKFLAGS  EQU   CKAGL+28                                                 08078000
CKTESTVT EQU   CKFLAGS                                                  08079000
EXCLAGL  EQU   0                                                        08080000
EXCLFLAG EQU   EXCLAGL+22                                               08081000
EXOARG   EQU   0                                                        08082000
EXODDN   EQU   EXOARG+8                                                 08083000
EXOEXT   EQU   EXOARG+24                                                08084000
EXOCTLBK EQU   EXOARG+28                                                08085000
EXOPT    EQU   EXOARG+32                                                08086000
EXOTAB   EQU   EXOPT                                                    08087000
EXFLG    EQU   EXOARG+33                                                08088000
EXGARG   EQU   0                                                        08089000
EXGCTLBK EQU   EXGARG+8                                                 08090000
EXGCCHH1 EQU   EXGARG+12                                                08091000
EXGCCHH2 EQU   EXGARG+16                                                08092000
EXGRECNO EQU   EXGARG+20                                                08093000
EXGDATAP EQU   EXGARG+24                                                08094000
EXGDATAL EQU   EXGARG+30                                                08095000
EXWRARG  EQU   0                                                        08096000
EXRWCHR  EQU   EXWRARG+26                                               08097000
EXSPACE  EQU   EXWRARG+36                                               08098000
EXPARG   EQU   0                                                        08099000
EXPDATA  EQU   EXPARG+12                                                08100000
EXPDATAB EQU   0                                                        08101000
EXPARRAY EQU   EXPDATAB+4                                               08102000
VS2AGL   EQU   0                                                        08103000
VSLABOPT EQU   VS2AGL+28                                                08104000
VS2MSG   EQU   VS2AGL+35                                                08105000
VS2RESOP EQU   VS2AGL+36                                                08106000
VS1AGL   EQU   0                                                        08107000
VSSECOPT EQU   VS1AGL+68                                                08108000
VSVTOPT  EQU   VS1AGL+69                                                08109000
VSCATOPT EQU   VS1AGL+70                                                08110000
VSRETURN EQU   VS1AGL+71                                                08111000
VSMSG    EQU   VS1AGL+72                                                08112000
VSRESOPT EQU   VS1AGL+73                                                08113000
RCTAGL   EQU   0                                                        08114000
RCTOPT   EQU   RCTAGL+8                                                 08115000
STAEPARM EQU   0                                                        08116000
STARCVY  EQU   STAEPARM+52                                              08117000
STARETRY EQU   STAEPARM+53                                              08118000
VOLLABEL EQU   0                                                        08119000
SV82LIST EQU   0                                                        08120000
@NM00072 EQU   SV82LIST+4                                               08121000
SV82DCBP EQU   @NM00072                                                 08122000
@NM00073 EQU   SV82LIST+12                                              08123000
SV82WRKP EQU   @NM00073                                                 08124000
SRTAGL   EQU   0                                                        08125000
LCTINFO  EQU   0                                                        08126000
LCTFLAGS EQU   LCTINFO+32                                               08127000
UCTAGL   EQU   0                                                        08128000
UCTFLAGS EQU   UCTAGL+68                                                08129000
SELAGL   EQU   0                                                        08130000
SELFLAGS EQU   SELAGL+22                                                08131000
DATESAGL EQU   0                                                        08132000
DATESOPT EQU   DATESAGL+20                                              08133000
VS3AGL   EQU   0                                                        08134000
VS3FLAGS EQU   VS3AGL+58                                                08135000
VSDVTOC  EQU   0                                                        08136000
VSDSTAT  EQU   0                                                        08137000
VSDSFLG1 EQU   VSDSTAT+16                                               08138000
VSDFLG2  EQU   VSDSTAT+17                                               08139000
VSDSCR   EQU   0                                                        08140000
VSDSCRFL EQU   VSDSCR+4                                                 08141000
VSDUSAGE EQU   0                                                        08142000
VSDDORG  EQU   VSDUSAGE+9                                               08143000
VSDALLOC EQU   VSDUSAGE+10                                              08144000
VSDUSEF  EQU   VSDUSAGE+11                                              08145000
VSDDSORG EQU   VSDUSAGE+16                                              08146000
VSDBLOCK EQU   0                                                        08147000
VSDSPACE EQU   VSDBLOCK+12                                              08148000
VSDARRAY EQU   VSDBLOCK+16                                              08149000
VSDVARY  EQU   VSDARRAY+48                                              08150000
WFILE    EQU   0                                                        08151000
WFILEVAL EQU   WFILE+1                                                  08152000
WDS      EQU   0                                                        08153000
WDSFLG   EQU   WDS+10                                                   08154000
WDSVAL   EQU   WDS+21                                                   08155000
MNT      EQU   0                                                        08156000
NMNT     EQU   0                                                        08157000
CART     EQU   0                                                        08158000
SUMRY    EQU   0                                                        08159000
AL       EQU   0                                                        08160000
MSF      EQU   0                                                        08161000
MSFVAL   EQU   MSF                                                      08162000
OFILE    EQU   0                                                        08163000
OFILEVAL EQU   OFILE+1                                                  08164000
ODS      EQU   0                                                        08165000
ODSFLG   EQU   ODS+10                                                   08166000
ODSVAL   EQU   ODS+21                                                   08167000
COTBLIST EQU   0                                                        08168000
COTBFLG  EQU   COTBLIST+6                                               08169000
COTBTID  EQU   COTBFLG                                                  08170000
COTBEXTS EQU   COTBLIST+8                                               08171000
COTBVOL  EQU   COTBLIST+12                                              08172000
ACQLIST  EQU   0                                                        08173000
ARLL     EQU   ACQLIST                                                  08174000
AROP     EQU   ACQLIST+4                                                08175000
ARFLG    EQU   ACQLIST+6                                                08176000
ARBDUBD  EQU   ARFLG                                                    08177000
ARINH    EQU   ARFLG                                                    08178000
ARNMEXT  EQU   ACQLIST+7                                                08179000
ARVOL    EQU   ACQLIST+8                                                08180000
AREXT    EQU   ACQLIST+28                                               08181000
BLKENT   EQU   0                                                        08182000
BLKENT1  EQU   0                                                        08183000
BLKTBL   EQU   0                                                        08184000
PREFIX   EQU   BLKTBL                                                   08185000
VOLCNTL  EQU   BLKTBL+8                                                 08186000
@NM00099 EQU   VOLCNTL                                                  08187000
LASTABLK EQU   @NM00099                                                 08188000
LASTTRK  EQU   @NM00099                                                 08189000
BLKUSED  EQU   @NM00099                                                 08190000
OVERFLOW EQU   @NM00099                                                 08191000
ENTLEN   EQU   VOLCNTL+1                                                08192000
NUMENT   EQU   VOLCNTL+3                                                08193000
TRACKPTR EQU   VOLCNTL+4                                                08194000
CYL      EQU   TRACKPTR+1                                               08195000
HEAD     EQU   TRACKPTR+2                                               08196000
ENTRYY   EQU   BLKTBL+16                                                08197000
INVENTRY EQU   0                                                        08198000
VVOLFLGS EQU   INVENTRY+6                                               08199000
VCARTONE EQU   INVENTRY+8                                               08200000
V1L2     EQU   VCARTONE                                                 08201000
VCARTTWO EQU   INVENTRY+10                                              08202000
TRKBUFF  EQU   0                                                        08203000
TRANENT  EQU   0                                                        08204000
TCARTONE EQU   TRANENT                                                  08205000
T1L2     EQU   TCARTONE                                                 08206000
TCARTTWO EQU   TRANENT+2                                                08207000
TCARSNUM EQU   TRANENT+4                                                08208000
TVOLSER  EQU   TRANENT+16                                               08209000
TVOLFLGS EQU   TRANENT+22                                               08210000
SCRENT   EQU   0                                                        08211000
SCARTNUM EQU   SCRENT+4                                                 08212000
SCARTONE EQU   SCRENT+16                                                08213000
CONMAP   EQU   0                                                        08214000
CONENT   EQU   CONMAP+8                                                 08215000
CNTLBYTE EQU   CONENT                                                   08216000
DATASTGR EQU   CNTLBYTE                                                 08217000
MSF1     EQU   CNTLBYTE                                                 08218000
VIPRTBF  EQU   0                                                        08219000
VIPRTSN  EQU   VIPRTBF                                                  08220000
VIPRTATR EQU   VIPRTBF+6                                                08221000
VIPRTB   EQU   VIPRTATR                                                 08222000
VIPRTR   EQU   VIPRTATR+1                                               08223000
VIPRTD   EQU   VIPRTATR+2                                               08224000
VIPRTE   EQU   VIPRTATR+3                                               08225000
VIPRTX1  EQU   VIPRTBF+10                                               08226000
VIPRTY1  EQU   VIPRTBF+11                                               08227000
VIBIT11  EQU   VIPRTY1                                                  08228000
VIBIT12  EQU   VIPRTY1                                                  08229000
VIBIT13  EQU   VIPRTY1                                                  08230000
VIPRT1   EQU   VIPRTBF+12                                               08231000
VIPRTZ1  EQU   VIPRT1                                                   08232000
VIPRTX2  EQU   VIPRTBF+13                                               08233000
VIPRTY2  EQU   VIPRTBF+14                                               08234000
VIBIT21  EQU   VIPRTY2                                                  08235000
VIBIT22  EQU   VIPRTY2                                                  08236000
VIBIT23  EQU   VIPRTY2                                                  08237000
VIPRT2   EQU   VIPRTBF+15                                               08238000
VIPRTZ2  EQU   VIPRT2                                                   08239000
TVPRTBF  EQU   0                                                        08240000
TVPRTSN  EQU   TVPRTBF                                                  08241000
TVPRTCS  EQU   TVPRTBF+6                                                08242000
TVPRTB   EQU   TVPRTBF+18                                               08243000
TVPRTR   EQU   TVPRTBF+19                                               08244000
TVPRTD   EQU   TVPRTBF+20                                               08245000
TVPRTE   EQU   TVPRTBF+21                                               08246000
TVPRTX1  EQU   TVPRTBF+22                                               08247000
TVPRTY1  EQU   TVPRTBF+23                                               08248000
TVBIT11  EQU   TVPRTY1                                                  08249000
TVBIT12  EQU   TVPRTY1                                                  08250000
TVBIT13  EQU   TVPRTY1                                                  08251000
TVPRT1   EQU   TVPRTBF+24                                               08252000
TVPRTZ1  EQU   TVPRT1                                                   08253000
TVPRTX2  EQU   TVPRTBF+25                                               08254000
TVPRTY2  EQU   TVPRTBF+26                                               08255000
TVBIT21  EQU   TVPRTY2                                                  08256000
TVBIT22  EQU   TVPRTY2                                                  08257000
TVBIT23  EQU   TVPRTY2                                                  08258000
TVPRT2   EQU   TVPRTBF+27                                               08259000
TVPRTZ2  EQU   TVPRT2                                                   08260000
SCPRTBF  EQU   0                                                        08261000
SCPRTCS  EQU   SCPRTBF                                                  08262000
SCPRTX1  EQU   SCPRTBF+12                                               08263000
SCPRTY1  EQU   SCPRTBF+13                                               08264000
SCBIT11  EQU   SCPRTY1                                                  08265000
SCBIT12  EQU   SCPRTY1                                                  08266000
SCBIT13  EQU   SCPRTY1                                                  08267000
SCPRT1   EQU   SCPRTBF+14                                               08268000
SCPRTZ1  EQU   SCPRT1                                                   08269000
SORTBLK  EQU   0                                                        08270000
SORTENT  EQU   SORTBLK                                                  08271000
SORTCNT  EQU   SORTBLK+4                                                08272000
SORTUNIT EQU   SORTBLK+6                                                08273000
SRTENTRY EQU   0                                                        08274000
SORTPTRS EQU   SRTENTRY                                                 08275000
SRTFPTR  EQU   SORTPTRS                                                 08276000
SRTBPTR  EQU   SORTPTRS+4                                               08277000
SRTITEM  EQU   SRTENTRY+8                                               08278000
TRKADDR  EQU   0                                                        08279000
VIBLKENT EQU   0                                                        08280000
VIBLKSN  EQU   VIBLKENT                                                 08281000
VIVLKFLG EQU   VIBLKENT+6                                               08282000
VIBLKSV  EQU   VIVLKFLG                                                 08283000
VIBLKEV  EQU   VIVLKFLG                                                 08284000
VIBLKBND EQU   VIVLKFLG                                                 08285000
VIBLKWI  EQU   VIVLKFLG                                                 08286000
@NM00141 EQU   VIBLKENT+8                                               08287000
VIBLKONE EQU   @NM00141                                                 08288000
VIBLKZ1  EQU   VIBLKONE                                                 08289000
VIBLKX1  EQU   @NM00141+1                                               08290000
@NM00142 EQU   VIBLKENT+10                                              08291000
VIBLKTWO EQU   @NM00142                                                 08292000
VIBLKZ2  EQU   VIBLKTWO                                                 08293000
VIBLKX2  EQU   @NM00142+1                                               08294000
TVBLKENT EQU   0                                                        08295000
TVBLKSN  EQU   TVBLKENT                                                 08296000
TVBLKCS  EQU   TVBLKENT+6                                               08297000
@NM00143 EQU   TVBLKENT+18                                              08298000
TVBLKONE EQU   @NM00143                                                 08299000
TVBLKZ1  EQU   TVBLKONE                                                 08300000
TVBLKX1  EQU   @NM00143+1                                               08301000
@NM00144 EQU   TVBLKENT+20                                              08302000
TVBLKTWO EQU   @NM00144                                                 08303000
TVBLKZ2  EQU   TVBLKTWO                                                 08304000
TVBLKX2  EQU   @NM00144+1                                               08305000
TVVLKFLG EQU   TVBLKENT+22                                              08306000
TVBLKSV  EQU   TVVLKFLG                                                 08307000
TVBLKEV  EQU   TVVLKFLG                                                 08308000
TVBLKBND EQU   TVVLKFLG                                                 08309000
TVBLKWI  EQU   TVVLKFLG                                                 08310000
SCBLKENT EQU   0                                                        08311000
SCBLKCS  EQU   SCBLKENT                                                 08312000
@NM00147 EQU   SCBLKENT+12                                              08313000
SCBLKONE EQU   @NM00147                                                 08314000
SCBLKZ1  EQU   SCBLKONE                                                 08315000
SCBLKX1  EQU   @NM00147+1                                               08316000
TRKWORD  EQU   0                                                        08317000
AMSTP041 EQU   0                                                        08318000
AMSTP043 EQU   0                                                        08319000
IDCIOCO0 EQU   0                                                        08320000
IDCIOGT0 EQU   0                                                        08321000
IDCIOIT0 EQU   0                                                        08322000
IDCIOPO0 EQU   0                                                        08323000
IDCIOPT0 EQU   0                                                        08324000
IDCIOST0 EQU   0                                                        08325000
IDCIOTM0 EQU   0                                                        08326000
IDCIOVY0 EQU   0                                                        08327000
IDCSACA0 EQU   0                                                        08328000
IDCSACL0 EQU   0                                                        08329000
IDCSACR0 EQU   0                                                        08330000
IDCSADE0 EQU   0                                                        08331000
IDCSADQ0 EQU   0                                                        08332000
IDCSAID0 EQU   0                                                        08333000
IDCSALC0 EQU   0                                                        08334000
IDCSALD0 EQU   0                                                        08335000
IDCSALK0 EQU   0                                                        08336000
IDCSANQ0 EQU   0                                                        08337000
IDCSAPR0 EQU   0                                                        08338000
IDCSAPT0 EQU   0                                                        08339000
IDCSAQL0 EQU   0                                                        08340000
IDCSARC0 EQU   0                                                        08341000
IDCSARV0 EQU   0                                                        08342000
IDCSASC0 EQU   0                                                        08343000
IDCSASI0 EQU   0                                                        08344000
IDCSASN0 EQU   0                                                        08345000
IDCSAST0 EQU   0                                                        08346000
IDCSATI0 EQU   0                                                        08347000
IDCSAUC0 EQU   0                                                        08348000
IDCSAWO0 EQU   0                                                        08349000
IDCST010 EQU   0                                                        08350000
IDCTPER0 EQU   0                                                        08351000
LISTTEST EQU   0                                                        08352000
NEWERID1 EQU   5                                                        08353000
GDTTBL   EQU   0                                                        08354000
GDTTR1   EQU   GDTTBL+8                                                 08355000
GDTTR2   EQU   GDTTBL+12                                                08356000
GDTDBG   EQU   GDTTBL+40                                                08357000
GDTSTC   EQU   GDTTBL+44                                                08358000
GDTPRT   EQU   GDTTBL+48                                                08359000
GDTESS   EQU   GDTTBL+52                                                08360000
GDTESA   EQU   GDTTBL+56                                                08361000
GDTRST   EQU   GDTTBL+60                                                08362000
GDTRES   EQU   GDTTBL+64                                                08363000
GDTCAL   EQU   GDTTBL+68                                                08364000
GDTGSP   EQU   GDTTBL+72                                                08365000
GDTFSP   EQU   GDTTBL+76                                                08366000
GDTGPL   EQU   GDTTBL+80                                                08367000
GDTFPL   EQU   GDTTBL+84                                                08368000
GDTLOD   EQU   GDTTBL+88                                                08369000
GDTDEL   EQU   GDTTBL+92                                                08370000
GDTPRL   EQU   GDTTBL+96                                                08371000
GDTEPL   EQU   GDTTBL+100                                               08372000
GDTTIM   EQU   GDTTBL+104                                               08373000
GDTIIO   EQU   GDTTBL+108                                               08374000
GDTTIO   EQU   GDTTBL+112                                               08375000
GDTOPN   EQU   GDTTBL+124                                               08376000
GDTCLS   EQU   GDTTBL+128                                               08377000
GDTGET   EQU   GDTTBL+132                                               08378000
GDTPUT   EQU   GDTTBL+136                                               08379000
GDTPOS   EQU   GDTTBL+140                                               08380000
GDTCPY   EQU   GDTTBL+144                                               08381000
GDTCAT   EQU   GDTTBL+148                                               08382000
GDTSNP   EQU   GDTTBL+164                                               08383000
GDTVFY   EQU   GDTTBL+172                                               08384000
GDTUID   EQU   GDTTBL+192                                               08385000
GDTPMT   EQU   GDTTBL+196                                               08386000
GDTCIR   EQU   GDTTBL+200                                               08387000
GDTLNK   EQU   GDTTBL+204                                               08388000
GDTALC   EQU   GDTTBL+208                                               08389000
GDTDLC   EQU   GDTTBL+212                                               08390000
GDTQAL   EQU   GDTTBL+216                                               08391000
GDTSTW   EQU   GDTTBL+220                                               08392000
GDTSSC   EQU   GDTTBL+224                                               08393000
GDTENQ   EQU   GDTTBL+228                                               08394000
GDTRSV   EQU   GDTTBL+232                                               08395000
GDTDEQ   EQU   GDTTBL+236                                               08396000
GDTSFO   EQU   GDTTBL+240                                               08397000
GDTWTO   EQU   GDTTBL+244                                               08398000
GDTSCR   EQU   GDTTBL+248                                               08399000
GDTUNT   EQU   GDTTBL+252                                               08400000
GDTRCT   EQU   GDTTBL+256                                               08401000
GDTIFO   EQU   GDTTBL+260                                               08402000
GDTEXP   EQU   GDTTBL+264                                               08403000
GDTSTA   EQU   GDTTBL+268                                               08404000
GDTERR   EQU   GDTTBL+272                                               08405000
GDTUNC   EQU   GDTTBL+276                                               08406000
GDTLOC   EQU   GDTTBL+280                                               08407000
FDTTBL   EQU   0                                                        08408000
FDTPTR   EQU   FDTTBL+8                                                 08409000
LASTCOND EQU   0                                                        08410000
BLKINDEX EQU   0                                                        08411000
MRGCNTRR EQU   0                                                        08412000
MRGBLKAD EQU   0                                                        08413000
SSRCODE  EQU   0                                                        08414000
SSRHALF  EQU   SSRCODE+2                                                08415000
SSECBCD  EQU   0                                                        08416000
TVNEWENT EQU   NEWENT                                                   08417000
TVVOLSN  EQU   TVNEWENT                                                 08418000
TVCARTSN EQU   TVNEWENT+6                                               08419000
TVCART1  EQU   TVNEWENT+18                                              08420000
TVCART2  EQU   TVNEWENT+20                                              08421000
TVFLAGS  EQU   TVNEWENT+22                                              08422000
SCNEWENT EQU   NEWENT                                                   08423000
SCCARTSN EQU   SCNEWENT                                                 08424000
SCCART1  EQU   SCNEWENT+12                                              08425000
*                                      START UNREFERENCED COMPONENTS    08426000
@NM00136 EQU   SCNEWENT+14                                              08427000
@NM00135 EQU   TVNEWENT+23                                              08428000
@NM00148 EQU   SSRCODE                                                  08429000
FDTVERB  EQU   FDTTBL                                                   08430000
GDTECT   EQU   GDTTBL+188                                               08431000
GDTPSB   EQU   GDTTBL+184                                               08432000
GDTUPT   EQU   GDTTBL+180                                               08433000
GDTCMB   EQU   GDTTBL+176                                               08434000
GDTSPR   EQU   GDTTBL+168                                               08435000
@NM00001 EQU   GDTTBL+160                                               08436000
GDTABH   EQU   GDTTBL+156                                               08437000
GDTABT   EQU   GDTTBL+152                                               08438000
GDTTOH   EQU   GDTTBL+120                                               08439000
GDTRIP   EQU   GDTTBL+116                                               08440000
GDTIOH   EQU   GDTTBL+36                                                08441000
GDTSAH   EQU   GDTTBL+32                                                08442000
GDTTPH   EQU   GDTTBL+28                                                08443000
GDTRIH   EQU   GDTTBL+24                                                08444000
GDTSTH   EQU   GDTTBL+20                                                08445000
GDTDBH   EQU   GDTTBL+16                                                08446000
GDTPRM   EQU   GDTTBL+4                                                 08447000
GDTHDR   EQU   GDTTBL                                                   08448000
SCBLKY1  EQU   SCBLKONE                                                 08449000
SCBLKMS1 EQU   SCBLKONE                                                 08450000
@NM00146 EQU   TVVLKFLG                                                 08451000
@NM00145 EQU   TVVLKFLG                                                 08452000
TVBLKY2  EQU   TVBLKTWO                                                 08453000
TVBLKMS2 EQU   TVBLKTWO                                                 08454000
TVBLKY1  EQU   TVBLKONE                                                 08455000
TVBLKMS1 EQU   TVBLKONE                                                 08456000
VIBLKY2  EQU   VIBLKTWO                                                 08457000
VIBLKMS2 EQU   VIBLKTWO                                                 08458000
VIBLKY1  EQU   VIBLKONE                                                 08459000
VIBLKMS1 EQU   VIBLKONE                                                 08460000
@NM00140 EQU   VIBLKENT+7                                               08461000
@NM00139 EQU   VIVLKFLG                                                 08462000
@NM00138 EQU   VIVLKFLG                                                 08463000
@NM00137 EQU   VIVLKFLG                                                 08464000
@NM00123 EQU   SCPRT1                                                   08465000
@NM00122 EQU   SCPRTY1                                                  08466000
@NM00121 EQU   TVPRT2                                                   08467000
@NM00120 EQU   TVPRTY2                                                  08468000
@NM00119 EQU   TVPRT1                                                   08469000
@NM00118 EQU   TVPRTY1                                                  08470000
@NM00117 EQU   VIPRT2                                                   08471000
@NM00116 EQU   VIPRTY2                                                  08472000
@NM00115 EQU   VIPRT1                                                   08473000
@NM00114 EQU   VIPRTY1                                                  08474000
@NM00113 EQU   CONMAP+136                                               08475000
@NM00112 EQU   CONENT+1                                                 08476000
MSF3     EQU   CNTLBYTE                                                 08477000
MSF2     EQU   CNTLBYTE                                                 08478000
MSF0     EQU   CNTLBYTE                                                 08479000
@NM00111 EQU   CNTLBYTE                                                 08480000
CPREFIX  EQU   CONMAP                                                   08481000
@NM00110 EQU   SCRENT+18                                                08482000
S1X      EQU   SCARTONE+1                                               08483000
S1Y      EQU   SCARTONE                                                 08484000
S1Z      EQU   SCARTONE                                                 08485000
S1L2     EQU   SCARTONE                                                 08486000
S1L1     EQU   SCARTONE                                                 08487000
@NM00109 EQU   SCRENT                                                   08488000
@NM00108 EQU   TRANENT+23                                               08489000
@NM00107 EQU   TVOLFLGS                                                 08490000
TWRITINH EQU   TVOLFLGS                                                 08491000
TBNDVOL  EQU   TVOLFLGS                                                 08492000
@NM00106 EQU   TVOLFLGS                                                 08493000
TEXCVOL  EQU   TVOLFLGS                                                 08494000
TSECRVOL EQU   TVOLFLGS                                                 08495000
@NM00105 EQU   TVOLFLGS                                                 08496000
T2X      EQU   TCARTTWO+1                                               08497000
T2Y      EQU   TCARTTWO                                                 08498000
T2Z      EQU   TCARTTWO                                                 08499000
T2L2     EQU   TCARTTWO                                                 08500000
T2L1     EQU   TCARTTWO                                                 08501000
T1X      EQU   TCARTONE+1                                               08502000
T1Y      EQU   TCARTONE                                                 08503000
T1Z      EQU   TCARTONE                                                 08504000
T1L1     EQU   TCARTONE                                                 08505000
V2X      EQU   VCARTTWO+1                                               08506000
V2Y      EQU   VCARTTWO                                                 08507000
V2Z      EQU   VCARTTWO                                                 08508000
V2L2     EQU   VCARTTWO                                                 08509000
V2L1     EQU   VCARTTWO                                                 08510000
V1X      EQU   VCARTONE+1                                               08511000
V1Y      EQU   VCARTONE                                                 08512000
V1Z      EQU   VCARTONE                                                 08513000
V1L1     EQU   VCARTONE                                                 08514000
@NM00104 EQU   INVENTRY+7                                               08515000
@NM00103 EQU   VVOLFLGS                                                 08516000
VWRITINH EQU   VVOLFLGS                                                 08517000
VBNDVOL  EQU   VVOLFLGS                                                 08518000
@NM00102 EQU   VVOLFLGS                                                 08519000
VEXCVOL  EQU   VVOLFLGS                                                 08520000
VSECRVOL EQU   VVOLFLGS                                                 08521000
@NM00101 EQU   VVOLFLGS                                                 08522000
VOLID    EQU   INVENTRY                                                 08523000
REC      EQU   TRACKPTR+3                                               08524000
@NM00100 EQU   TRACKPTR                                                 08525000
MAXENT   EQU   VOLCNTL+2                                                08526000
HASHARA2 EQU   @NM00099                                                 08527000
HASHARA1 EQU   @NM00099                                                 08528000
TRKEND   EQU   @NM00099                                                 08529000
LASTBLK  EQU   @NM00099                                                 08530000
ARNEDB   EQU   ACQLIST+92                                               08531000
@NM00097 EQU   AREXT                                                    08532000
ARCOMPC  EQU   ACQLIST+26                                               08533000
@NM00096 EQU   ACQLIST+25                                               08534000
ARHOST   EQU   ACQLIST+20                                               08535000
ARECB    EQU   ACQLIST+16                                               08536000
ARASID   EQU   ACQLIST+14                                               08537000
@NM00095 EQU   ARFLG                                                    08538000
ARDRES   EQU   ARFLG                                                    08539000
@NM00094 EQU   ACQLIST+5                                                08540000
COTBECB  EQU   COTBLIST+20                                              08541000
COTBASID EQU   COTBLIST+18                                              08542000
@NM00093 EQU   COTBFLG+1                                                08543000
COTBTRI  EQU   COTBFLG+1                                                08544000
COTBTRA  EQU   COTBFLG+1                                                08545000
COTBTRY  EQU   COTBFLG+1                                                08546000
COTBTRX  EQU   COTBFLG+1                                                08547000
@NM00092 EQU   COTBFLG                                                  08548000
@NM00091 EQU   COTBLIST+5                                               08549000
COTBOP   EQU   COTBLIST+4                                               08550000
COTBLL   EQU   COTBLIST                                                 08551000
ODSLEN   EQU   ODS+20                                                   08552000
ODSMEM   EQU   ODS+12                                                   08553000
ODSMLN   EQU   ODS+11                                                   08554000
ODSFUQ   EQU   ODSFLG                                                   08555000
ODSPOS   EQU   ODS+9                                                    08556000
ODSPAS   EQU   ODS+1                                                    08557000
ODSPLN   EQU   ODS                                                      08558000
OFILELEN EQU   OFILE                                                    08559000
WDSLEN   EQU   WDS+20                                                   08560000
WDSMEM   EQU   WDS+12                                                   08561000
WDSMLN   EQU   WDS+11                                                   08562000
WDSFUQ   EQU   WDSFLG                                                   08563000
WDSPOS   EQU   WDS+9                                                    08564000
WDSPAS   EQU   WDS+1                                                    08565000
WDSPLN   EQU   WDS                                                      08566000
WFILELEN EQU   WFILE                                                    08567000
VSDDSN   EQU   VSDARRAY+4                                               08568000
VSDVOLCT EQU   VSDARRAY                                                 08569000
VSDFMT0  EQU   VSDBLOCK+8                                               08570000
VSDVTOCS EQU   VSDBLOCK+4                                               08571000
VSDELEM  EQU   VSDBLOCK                                                 08572000
VSDFREE  EQU   VSDUSAGE+24                                              08573000
VSDALLC  EQU   VSDUSAGE+19                                              08574000
VSDDSOR3 EQU   VSDDSORG+2                                               08575000
@NM00090 EQU   VSDDSORG                                                 08576000
VSDSCAL  EQU   VSDUSAGE+12                                              08577000
@NM00089 EQU   VSDUSEF                                                  08578000
VSDCALFR EQU   VSDUSEF                                                  08579000
@NM00088 EQU   VSDALLOC                                                 08580000
VSDABSTR EQU   VSDALLOC                                                 08581000
VSDABLK  EQU   VSDALLOC                                                 08582000
VSDATRK  EQU   VSDALLOC                                                 08583000
VSDACYL  EQU   VSDALLOC                                                 08584000
@NM00087 EQU   VSDDORG                                                  08585000
VSDOU    EQU   VSDDORG                                                  08586000
VSDOIS   EQU   VSDDORG                                                  08587000
VSDODA   EQU   VSDDORG                                                  08588000
VSDOUN   EQU   VSDDORG                                                  08589000
VSDOPS   EQU   VSDDORG                                                  08590000
VSDOPO   EQU   VSDDORG                                                  08591000
VSDEXTS  EQU   VSDUSAGE+8                                               08592000
VSDSECAL EQU   VSDUSAGE+4                                               08593000
VSDFTRK  EQU   VSDUSAGE+2                                               08594000
VSDTRKS  EQU   VSDUSAGE                                                 08595000
@NM00086 EQU   VSDSCR+5                                                 08596000
@NM00085 EQU   VSDSCRFL                                                 08597000
VSDVSAM  EQU   VSDSCRFL                                                 08598000
VSDCATLC EQU   VSDSCRFL                                                 08599000
VSDACBPT EQU   VSDSCR                                                   08600000
VSDPRTC  EQU   VSDSTAT+25                                               08601000
VSDCAT   EQU   VSDSTAT+22                                               08602000
VSDEXP   EQU   VSDSTAT+20                                               08603000
VSDCRE   EQU   VSDSTAT+18                                               08604000
@NM00084 EQU   VSDFLG2                                                  08605000
VSDERROR EQU   VSDFLG2                                                  08606000
VSDPROT  EQU   VSDFLG2                                                  08607000
VSDPWW   EQU   VSDFLG2                                                  08608000
VSDPWR   EQU   VSDFLG2                                                  08609000
@NM00083 EQU   VSDSFLG1                                                 08610000
VSDCVSAM EQU   VSDSFLG1                                                 08611000
VSDCATLG EQU   VSDSFLG1                                                 08612000
VSDVSAME EQU   VSDSFLG1                                                 08613000
VSDVSAMC EQU   VSDSFLG1                                                 08614000
VSDVTOCE EQU   VSDSFLG1                                                 08615000
VSDVTOCC EQU   VSDSFLG1                                                 08616000
VSDOWNER EQU   VSDSTAT+8                                                08617000
VSDEXPIR EQU   VSDSTAT+4                                                08618000
VSDCREAT EQU   VSDSTAT                                                  08619000
VSDFRCCL EQU   VSDVTOC+21                                               08620000
@NM00082 EQU   VSDVTOC+20                                               08621000
VSDFREXT EQU   VSDVTOC+16                                               08622000
@NM00081 EQU   VSDVTOC+15                                               08623000
VSDFRTRK EQU   VSDVTOC+11                                               08624000
@NM00080 EQU   VSDVTOC+10                                               08625000
VSDFRCYL EQU   VSDVTOC+6                                                08626000
@NM00079 EQU   VSDVTOC                                                  08627000
@NM00078 EQU   VS3FLAGS                                                 08628000
VS3SYSNM EQU   VS3FLAGS                                                 08629000
VS3UNCAT EQU   VS3FLAGS                                                 08630000
VS3SCR   EQU   VS3FLAGS                                                 08631000
VS3USAGE EQU   VS3FLAGS                                                 08632000
VS3STAT  EQU   VS3FLAGS                                                 08633000
VS3DD    EQU   VS3AGL+50                                                08634000
VS3VOL   EQU   VS3AGL+44                                                08635000
VS3POOL  EQU   VS3AGL+40                                                08636000
VS3DEV   EQU   VS3AGL+36                                                08637000
VS3UCBP  EQU   VS3AGL+32                                                08638000
VS3CREAT EQU   VS3AGL+28                                                08639000
VS3EXPIR EQU   VS3AGL+24                                                08640000
VS3AST   EQU   VS3AGL+22                                                08641000
VS3LEVLN EQU   VS3AGL+20                                                08642000
VS3LEVP  EQU   VS3AGL+16                                                08643000
VS3EXDSP EQU   VS3AGL+12                                                08644000
VS3LISTP EQU   VS3AGL+8                                                 08645000
VS3HEAD  EQU   VS3AGL                                                   08646000
@NM00077 EQU   DATESOPT                                                 08647000
DATDAYOP EQU   DATESOPT                                                 08648000
DATDTEOP EQU   DATESOPT                                                 08649000
DATSUB   EQU   DATESOPT                                                 08650000
DATADD   EQU   DATESOPT                                                 08651000
DATRETRN EQU   DATESAGL+16                                              08652000
DATDAYS  EQU   DATESAGL+12                                              08653000
DATDATE  EQU   DATESAGL+8                                               08654000
DATHEAD  EQU   DATESAGL                                                 08655000
@NM00076 EQU   SELFLAGS                                                 08656000
SELVOL   EQU   SELAGL+16                                                08657000
SELDDNP  EQU   SELAGL+12                                                08658000
SELUCBP  EQU   SELAGL+8                                                 08659000
SELHEAD  EQU   SELAGL                                                   08660000
@NM00075 EQU   UCTFLAGS                                                 08661000
UCTVSCAT EQU   UCTFLAGS                                                 08662000
UCTDD    EQU   UCTAGL+60                                                08663000
UCTVOLP  EQU   UCTAGL+56                                                08664000
UCTACBP  EQU   UCTAGL+52                                                08665000
UCTDSN   EQU   UCTAGL+8                                                 08666000
UCTHEAD  EQU   UCTAGL                                                   08667000
@NM00074 EQU   LCTFLAGS                                                 08668000
LCTVSCAT EQU   LCTFLAGS                                                 08669000
LCTOWNER EQU   LCTINFO+24                                               08670000
LCTEXPIR EQU   LCTINFO+20                                               08671000
LCTCREAT EQU   LCTINFO+16                                               08672000
LCTACBP  EQU   LCTINFO+12                                               08673000
LCTMULVC EQU   LCTINFO+8                                                08674000
LCTHEAD  EQU   LCTINFO                                                  08675000
SRTWORKP EQU   SRTAGL+28                                                08676000
SRTFLDLN EQU   SRTAGL+24                                                08677000
SRTPOSIT EQU   SRTAGL+20                                                08678000
SRTLEN   EQU   SRTAGL+16                                                08679000
SRTNUM   EQU   SRTAGL+12                                                08680000
SRTADDR  EQU   SRTAGL+8                                                 08681000
SRTHEAD  EQU   SRTAGL                                                   08682000
SV82DEBP EQU   SV82WRKP                                                 08683000
SV82TTRP EQU   SV82LIST+8                                               08684000
SV82VOLP EQU   SV82DCBP                                                 08685000
SV82UCBP EQU   SV82LIST+1                                               08686000
SV82CODE EQU   SV82LIST                                                 08687000
VOLRESV3 EQU   VOLLABEL+55                                              08688000
VOLOWNER EQU   VOLLABEL+45                                              08689000
VOLRESV1 EQU   VOLLABEL+20                                              08690000
VOLVTOC  EQU   VOLLABEL+15                                              08691000
VOLSECTY EQU   VOLLABEL+14                                              08692000
VOLSERNO EQU   VOLLABEL+8                                               08693000
VOLNO    EQU   VOLLABEL+7                                               08694000
VOLLABI  EQU   VOLLABEL+4                                               08695000
VOLKEY   EQU   VOLLABEL                                                 08696000
STAVTTR  EQU   STAEPARM+54                                              08697000
@NM00071 EQU   STARETRY                                                 08698000
STAVTOC  EQU   STARETRY                                                 08699000
STAOFF   EQU   STARETRY                                                 08700000
STAIO05  EQU   STARETRY                                                 08701000
@NM00070 EQU   STARCVY                                                  08702000
STACLEAR EQU   STARCVY                                                  08703000
STAVPOST EQU   STARCVY                                                  08704000
STAVENQ  EQU   STARCVY                                                  08705000
STAVDMNT EQU   STARCVY                                                  08706000
STAVMNT  EQU   STARCVY                                                  08707000
STATCB   EQU   STAEPARM+48                                              08708000
STARTADD EQU   STAEPARM+44                                              08709000
STAEXSAV EQU   STAEPARM+40                                              08710000
STARTSAV EQU   STAEPARM+36                                              08711000
STARTTR  EQU   STAEPARM+32                                              08712000
@NM00069 EQU   STAEPARM+30                                              08713000
STARVOL  EQU   STAEPARM+24                                              08714000
STARUCB  EQU   STAEPARM+20                                              08715000
@NM00068 EQU   STAEPARM+18                                              08716000
STAVVOL  EQU   STAEPARM+12                                              08717000
STAVUCB  EQU   STAEPARM+8                                               08718000
STAHEAD  EQU   STAEPARM                                                 08719000
RCTDSET  EQU   RCTAGL+32                                                08720000
RCTNVOL  EQU   RCTAGL+26                                                08721000
RCTOVOL  EQU   RCTAGL+20                                                08722000
RCTNDEV  EQU   RCTAGL+16                                                08723000
RCTODEV  EQU   RCTAGL+12                                                08724000
@NM00067 EQU   RCTAGL+10                                                08725000
@NM00066 EQU   RCTOPT                                                   08726000
RCTVOL   EQU   RCTOPT                                                   08727000
RCTDEV   EQU   RCTOPT                                                   08728000
RCTHEAD  EQU   RCTAGL                                                   08729000
@NM00065 EQU   VSRESOPT                                                 08730000
VSREAL   EQU   VSRESOPT                                                 08731000
VSRES    EQU   VSRESOPT                                                 08732000
@NM00064 EQU   VSMSG                                                    08733000
VSTOV    EQU   VSMSG                                                    08734000
VSFROMV  EQU   VSMSG                                                    08735000
@NM00063 EQU   VSRETURN                                                 08736000
VSUCAT   EQU   VSRETURN                                                 08737000
VSVSAM   EQU   VSRETURN                                                 08738000
@NM00062 EQU   VSCATOPT                                                 08739000
VSLIST   EQU   VSCATOPT                                                 08740000
VSSERIAL EQU   VSCATOPT                                                 08741000
VSDEVICE EQU   VSCATOPT                                                 08742000
@NM00061 EQU   VSVTOPT                                                  08743000
VSVSFLAG EQU   VSVTOPT                                                  08744000
VSALTTRK EQU   VSVTOPT                                                  08745000
VSTIME   EQU   VSVTOPT                                                  08746000
VSUCMAST EQU   VSSECOPT                                                 08747000
VSOPCAT  EQU   VSSECOPT                                                 08748000
VSUCTEST EQU   VSSECOPT                                                 08749000
VSWRITE  EQU   VSSECOPT                                                 08750000
VSREAD   EQU   VSSECOPT                                                 08751000
VSNONONV EQU   VSSECOPT                                                 08752000
VSMASTER EQU   VSSECOPT                                                 08753000
VSNOVSAM EQU   VSSECOPT                                                 08754000
VSODEVP  EQU   VS1AGL+64                                                08755000
VSOSERP  EQU   VS1AGL+60                                                08756000
VSDEVP   EQU   VS1AGL+56                                                08757000
VSSERP   EQU   VS1AGL+52                                                08758000
VSPFILEP EQU   VS1AGL+48                                                08759000
VSPSWDP  EQU   VS1AGL+44                                                08760000
VSCATDDP EQU   VS1AGL+40                                                08761000
VSACBP   EQU   VS1AGL+36                                                08762000
VSCATP   EQU   VS1AGL+32                                                08763000
VSNXTATP EQU   VS1AGL+28                                                08764000
VSNUMATP EQU   VS1AGL+24                                                08765000
VSIOP    EQU   VS1AGL+20                                                08766000
VSFILEP  EQU   VS1AGL+16                                                08767000
VSVOLP   EQU   VS1AGL+12                                                08768000
VSUCBP   EQU   VS1AGL+8                                                 08769000
VSHEAD   EQU   VS1AGL                                                   08770000
VSVTOCPT EQU   VS2AGL+48                                                08771000
@NM00060 EQU   VS2AGL+45                                                08772000
VSDDNAME EQU   VS2AGL+37                                                08773000
@NM00059 EQU   VS2RESOP                                                 08774000
VS2REAL  EQU   VS2RESOP                                                 08775000
VS2RES   EQU   VS2RESOP                                                 08776000
@NM00058 EQU   VS2MSG                                                   08777000
VS2TOV   EQU   VS2MSG                                                   08778000
VSVOLUME EQU   VS2AGL+29                                                08779000
@NM00057 EQU   VSLABOPT                                                 08780000
VSNOVTOC EQU   VSLABOPT                                                 08781000
VSVOLSER EQU   VSLABOPT                                                 08782000
VSOWNER  EQU   VSLABOPT                                                 08783000
VSIOBKPT EQU   VS2AGL+24                                                08784000
VSVOLPTR EQU   VS2AGL+20                                                08785000
VSOWNPTR EQU   VS2AGL+16                                                08786000
VSVTOCSZ EQU   VS2AGL+12                                                08787000
VSUCBPTR EQU   VS2AGL+8                                                 08788000
VS2HEAD  EQU   VS2AGL                                                   08789000
EXPDATAL EQU   EXPARRAY+6                                               08790000
@NM00056 EQU   EXPARRAY+5                                               08791000
EXPKEYLN EQU   EXPARRAY+4                                               08792000
EXPDATAP EQU   EXPARRAY                                                 08793000
EXPRECNO EQU   EXPDATAB                                                 08794000
EXPCCHHR EQU   EXPARG+16                                                08795000
EXPCTLBK EQU   EXPARG+8                                                 08796000
EXPHEAD  EQU   EXPARG                                                   08797000
EXRWFUN  EQU   EXWRARG+46                                               08798000
@NM00055 EQU   EXSPACE+8                                                08799000
@NM00054 EQU   EXSPACE+6                                                08800000
@NM00053 EQU   EXSPACE+4                                                08801000
@NM00052 EQU   EXSPACE+1                                                08802000
@NM00051 EQU   EXSPACE                                                  08803000
EXRWKDLN EQU   EXWRARG+32                                               08804000
@NM00050 EQU   EXWRARG+31                                               08805000
EXRECNUM EQU   EXRWCHR+4                                                08806000
EXHH     EQU   EXRWCHR+2                                                08807000
EXCC     EQU   EXRWCHR                                                  08808000
EXCCWCNT EQU   EXWRARG+24                                               08809000
EXLOCPTR EQU   EXWRARG+20                                               08810000
EXRWDARE EQU   EXWRARG+16                                               08811000
EXRWIOAR EQU   EXWRARG+12                                               08812000
EXRWCTBL EQU   EXWRARG+8                                                08813000
EXRWRES  EQU   EXWRARG                                                  08814000
@NM00049 EQU   EXGARG+29                                                08815000
EXGKEYLN EQU   EXGARG+28                                                08816000
EXGHEAD  EQU   EXGARG                                                   08817000
EXOVTH   EQU   EXFLG                                                    08818000
EXORVT   EQU   EXFLG                                                    08819000
EXORDS   EQU   EXFLG                                                    08820000
EXOSPK   EQU   EXFLG                                                    08821000
EXORVS   EQU   EXFLG                                                    08822000
@NM00048 EQU   EXFLG                                                    08823000
EXOREAD  EQU   EXFLG                                                    08824000
@NM00047 EQU   EXOPT                                                    08825000
EXOREP   EQU   EXOPT                                                    08826000
EXOVTOC  EQU   EXOPT                                                    08827000
EXONEW   EQU   EXOPT                                                    08828000
EXOPASS  EQU   EXOPT                                                    08829000
EXOLAB   EQU   EXOPT                                                    08830000
EXOUCB   EQU   EXOARG+20                                                08831000
EXOVSN   EQU   EXOARG+16                                                08832000
EXODSN   EQU   EXOARG+12                                                08833000
EXOHEAD  EQU   EXOARG                                                   08834000
@NM00046 EQU   EXCLFLAG                                                 08835000
EXCLMNT  EQU   EXCLFLAG                                                 08836000
EXCLVOL  EQU   EXCLAGL+16                                               08837000
EXCLDDP  EQU   EXCLAGL+12                                               08838000
EXCLUCBP EQU   EXCLAGL+8                                                08839000
EXCLHEAD EQU   EXCLAGL                                                  08840000
@NM00045 EQU   CKFLAGS                                                  08841000
CKDMTABL EQU   CKFLAGS                                                  08842000
CKRETTYP EQU   CKFLAGS                                                  08843000
CKDATYPE EQU   CKAGL+20                                                 08844000
CKHEAD   EQU   CKAGL                                                    08845000
PULABELP EQU   PUAGL+16                                                 08846000
PUTTRPTR EQU   PUAGL+12                                                 08847000
PUUCBPTR EQU   PUAGL+8                                                  08848000
PUHEAD   EQU   PUAGL                                                    08849000
MDR      EQU   MDVTOC+4                                                 08850000
MDHH     EQU   MDVTOC+2                                                 08851000
MDCC     EQU   MDVTOC                                                   08852000
@NM00044 EQU   MDAGL+31                                                 08853000
MDVTOCTR EQU   MDFLAGS                                                  08854000
MDFORCE  EQU   MDFLAGS                                                  08855000
MDDEQ    EQU   MDFLAGS                                                  08856000
MDENQ    EQU   MDFLAGS                                                  08857000
MDWAIT   EQU   MDFLAGS                                                  08858000
MDPOST   EQU   MDFLAGS                                                  08859000
MDCLEAR  EQU   MDFLAGS                                                  08860000
MDNEWVOL EQU   MDFLAGS                                                  08861000
MDLABEL  EQU   MDAGL+24                                                 08862000
MDPUAGL  EQU   MDAGL+20                                                 08863000
MDDDNAME EQU   MDAGL+12                                                 08864000
MDUCBPTR EQU   MDAGL+8                                                  08865000
MDHEAD   EQU   MDAGL                                                    08866000
CTTBLID  EQU   CTARRAY                                                  08867000
CTREALH  EQU   CTMSG+3                                                  08868000
@NM00043 EQU   CTMSG                                                    08869000
CMCSN2   EQU   CMMSG+28                                                 08870000
CMCSN1   EQU   CMMSG+16                                                 08871000
CMNUMCRT EQU   CMMSG+15                                                 08872000
@NM00042 EQU   CMMSG+14                                                 08873000
CMNEWVOL EQU   CMMSG+8                                                  08874000
@NM00041 EQU   CMMSG+7                                                  08875000
@NM00040 EQU   CMVOLFLG                                                 08876000
CMRONLY  EQU   CMVOLFLG                                                 08877000
CMBIND   EQU   CMVOLFLG                                                 08878000
CMSCRCRT EQU   CMVOLFLG                                                 08879000
CMEXCL   EQU   CMVOLFLG                                                 08880000
CMDERAS  EQU   CMVOLFLG                                                 08881000
CMSCRVOL EQU   CMVOLFLG                                                 08882000
CMCECART EQU   CMVOLFLG                                                 08883000
CMOLDVOL EQU   CMMSG                                                    08884000
CCOLDCSN EQU   CCMSG+24                                                 08885000
CCNEWCSN EQU   CCMSG+12                                                 08886000
@NM00039 EQU   CCMSG+10                                                 08887000
CCVOL    EQU   CCMSG+4                                                  08888000
@NM00038 EQU   CCMSG+2                                                  08889000
CCEJCODE EQU   CCMSG+1                                                  08890000
CCPSTCDE EQU   CCMSG                                                    08891000
@NM00037 EQU   DMPARY+15                                                08892000
DMPARYTP EQU   DMPARY+14                                                08893000
DMPARYEX EQU   DMPARY+12                                                08894000
DMPARYIC EQU   DMPARY+10                                                08895000
DMPARYSZ EQU   DMPARY+8                                                 08896000
DMPARYNM EQU   DMPARY                                                   08897000
@NM00036 EQU   DMPITM+15                                                08898000
@NM00035 EQU   ERCNVTAB+24                                              08899000
ERCPLPT  EQU   ERCNVTAB+20                                              08900000
ERCATRC  EQU   ERCNVTAB+16                                              08901000
ERDSNM   EQU   ERCNVTAB+12                                              08902000
@NM00034 EQU   ERCNVTAB+4                                               08903000
@NM00033 EQU   ERCNVTAB+3                                               08904000
@NM00032 EQU   EROSOPER                                                 08905000
EROSUCDX EQU   EROSOPER                                                 08906000
EROSCATL EQU   EROSOPER                                                 08907000
@NM00031 EQU   EROPER                                                   08908000
ERCATAL  EQU   EROPER                                                   08909000
ERCATDL  EQU   EROPER                                                   08910000
ERCATDE  EQU   EROPER                                                   08911000
ERCATLC  EQU   EROPER                                                   08912000
@NM00030 EQU   ERTYPE                                                   08913000
EROSCAT  EQU   ERTYPE                                                   08914000
ERCATLG  EQU   ERTYPE                                                   08915000
@NM00029 EQU   FMTCNVF+1                                                08916000
FMTAR    EQU   FMTCNVF+1                                                08917000
FMTBS    EQU   FMTCNVF+1                                                08918000
FMTSS    EQU   FMTCNVF+1                                                08919000
FMTAL    EQU   FMTCNVF+1                                                08920000
FMTZS    EQU   FMTCNVF+1                                                08921000
@NM00028 EQU   FMTCNVF                                                  08922000
FMTPU    EQU   FMTCNVF                                                  08923000
FMTBD    EQU   FMTCNVF                                                  08924000
FMTBHD   EQU   FMTCNVF                                                  08925000
FMTBHA   EQU   FMTCNVF                                                  08926000
FMTBH    EQU   FMTCNVF                                                  08927000
FMTOLEN  EQU   FMTLIST+8                                                08928000
FMTRIO   EQU   FMTOCOL                                                  08929000
FMTSPT   EQU   FMTSTO                                                   08930000
FMTSTL   EQU   FMTILEN                                                  08931000
@NM00027 EQU   FMTFLGS+1                                                08932000
FMTHDF   EQU   FMTFLGS                                                  08933000
FMTDFF   EQU   FMTFLGS                                                  08934000
FMTSTF   EQU   FMTFLGS                                                  08935000
FMTREPF  EQU   FMTFLGS                                                  08936000
FMTBDF   EQU   FMTFLGS                                                  08937000
FMTIDF   EQU   FMTFLGS                                                  08938000
FMTSCF   EQU   FMTFLGS                                                  08939000
FMTEOLF  EQU   FMTFLGS                                                  08940000
@NM00026 EQU   DARGLIST+19                                              08941000
DARGIND  EQU   DARGLIST+18                                              08942000
UVOLVOL  EQU   UVOLENT+4                                                08943000
UVOLDEV  EQU   UVOLENT                                                  08944000
UVOLCNT  EQU   UVOLLIST                                                 08945000
@NM00025 EQU   IOINFOPT                                                 08946000
IOINFTMS EQU   IOINFOPT                                                 08947000
IOINFSUP EQU   IOINFOPT                                                 08948000
IOINFDSN EQU   IOINFOPT                                                 08949000
IOINFDVT EQU   IOINFOPT                                                 08950000
OPNVOL   EQU   OPNAGL+44                                                08951000
@NM00024 EQU   OPNAGL+43                                                08952000
@NM00023 EQU   OPNOPT2                                                  08953000
OPNOPTJM EQU   OPNOPT2                                                  08954000
@NM00022 EQU   OPNOPT2                                                  08955000
OPNOPTAS EQU   OPNOPT2                                                  08956000
@NM00021 EQU   OPNDSO                                                   08957000
OPNDSOPO EQU   OPNDSO                                                   08958000
OPNDSOIS EQU   OPNDSO                                                   08959000
OPNDSOPS EQU   OPNDSO                                                   08960000
OPNDSOAM EQU   OPNDSO                                                   08961000
OPNKYL   EQU   OPNAGL+40                                                08962000
OPNBLK   EQU   OPNAGL+36                                                08963000
OPNREC   EQU   OPNAGL+32                                                08964000
OPNDEVIX EQU   OPNDEV+4                                                 08965000
OPNDEVDT EQU   OPNDEV                                                   08966000
OPNCBP   EQU   OPNAGL+20                                                08967000
OPNPWA   EQU   OPNAGL+12                                                08968000
OPNMODRP EQU   OPNMOD                                                   08969000
OPNMODUB EQU   OPNMOD                                                   08970000
OPNMODRS EQU   OPNMOD                                                   08971000
OPNMODAX EQU   OPNMOD                                                   08972000
OPNMODRR EQU   OPNMOD                                                   08973000
OPNMODRC EQU   OPNMOD                                                   08974000
OPNMODPD EQU   OPNMOD                                                   08975000
@NM00020 EQU   OPNTYP                                                   08976000
OPNTYPRV EQU   OPNTYP                                                   08977000
OPNTYPEX EQU   OPNTYP                                                   08978000
OPNTYPRA EQU   OPNTYP                                                   08979000
OPNTYPXM EQU   OPNTYP                                                   08980000
OPNTYPCI EQU   OPNTYP                                                   08981000
OPNTYPSO EQU   OPNTYP                                                   08982000
OPNTYPSI EQU   OPNTYP                                                   08983000
@NM00019 EQU   OPNRFM                                                   08984000
OPNRFMBK EQU   OPNRFM                                                   08985000
OPNRFMSF EQU   OPNRFM                                                   08986000
OPNRFMUN EQU   OPNRFM                                                   08987000
OPNRFMVR EQU   OPNRFM                                                   08988000
OPNRFMFX EQU   OPNRFM                                                   08989000
OPNOPTSK EQU   OPNOPT                                                   08990000
OPNOPTDR EQU   OPNOPT                                                   08991000
OPNOPTCR EQU   OPNOPT                                                   08992000
OPNOPTKS EQU   OPNOPT                                                   08993000
OPNOPTBK EQU   OPNOPT                                                   08994000
OPNOPTUP EQU   OPNOPT                                                   08995000
OPNOPTIN EQU   OPNOPT                                                   08996000
IOCEXT   EQU   IOCSTR+64                                                08997000
IOCREL   EQU   IOCSTR+60                                                08998000
IOCWORK  EQU   IOCSTR+56                                                08999000
IOCRRN   EQU   IOCSTR+52                                                09000000
IOCPNM   EQU   IOCNWM+2                                                 09001000
IOCPTL   EQU   IOCNWM                                                   09002000
IOCKYA   EQU   IOCMEM                                                   09003000
IOCVRC   EQU   IOCTTR                                                   09004000
IOCCBP   EQU   IOCSTR+36                                                09005000
IOCDSN   EQU   IOCSTR+32                                                09006000
IOCHURBA EQU   IOCSTR+28                                                09007000
IOCVOLSR EQU   IOCSTR+22                                                09008000
@NM00018 EQU   IOCMSG                                                   09009000
IOCMSGAE EQU   IOCMSG                                                   09010000
IOCMSGCE EQU   IOCMSG                                                   09011000
IOCMSGOE EQU   IOCMSG                                                   09012000
IOCMSGOP EQU   IOCMSG                                                   09013000
@NM00017 EQU   IOCMSG                                                   09014000
IOCCHPSY EQU   IOCCHP                                                   09015000
IOCCHPAS EQU   IOCCHP                                                   09016000
IOCCHPBK EQU   IOCCHP                                                   09017000
IOCCHPCR EQU   IOCCHP                                                   09018000
IOCCHPKS EQU   IOCCHP                                                   09019000
IOCCHPSK EQU   IOCCHP                                                   09020000
IOCCHPDR EQU   IOCCHP                                                   09021000
IOCCHPSQ EQU   IOCCHP                                                   09022000
@NM00016 EQU   IOCMAC2                                                  09023000
IOCMACPA EQU   IOCMAC2                                                  09024000
@NM00015 EQU   IOCMAC2                                                  09025000
IOCMACCP EQU   IOCMAC2                                                  09026000
IOCMACRR EQU   IOCMAC2                                                  09027000
IOCMACAS EQU   IOCMAC2                                                  09028000
IOCMACSK EQU   IOCMAC2                                                  09029000
@NM00014 EQU   IOCMAC                                                   09030000
IOCMACCC EQU   IOCMAC                                                   09031000
IOCMACDR EQU   IOCMAC                                                   09032000
IOCMACBK EQU   IOCMAC                                                   09033000
IOCMACCR EQU   IOCMAC                                                   09034000
IOCMACUP EQU   IOCMAC                                                   09035000
IOCMACOT EQU   IOCMAC                                                   09036000
IOCMACIN EQU   IOCMAC                                                   09037000
@NM00013 EQU   IOCRFM                                                   09038000
IOCRFMBK EQU   IOCRFM                                                   09039000
IOCRFMSF EQU   IOCRFM                                                   09040000
IOCRFMUN EQU   IOCRFM                                                   09041000
IOCRFMVR EQU   IOCRFM                                                   09042000
IOCRFMFX EQU   IOCRFM                                                   09043000
@NM00012 EQU   IOCDSO                                                   09044000
IOCDSOPO EQU   IOCDSO                                                   09045000
IOCDSOIS EQU   IOCDSO                                                   09046000
IOCDSOPS EQU   IOCDSO                                                   09047000
IOCDSOAM EQU   IOCDSO                                                   09048000
IOCRKP   EQU   IOCSTR+13                                                09049000
IOCKYL   EQU   IOCSTR+12                                                09050000
IOCTRN   EQU   IOCSTR+8                                                 09051000
IOCDLN   EQU   IOCSTR+4                                                 09052000
IOCDAD   EQU   IOCSTR                                                   09053000
UNITVTOC EQU   UNITABL+7                                                09054000
@NM00011 EQU   UNITSTAT                                                 09055000
UNITUSHR EQU   UNITSTAT                                                 09056000
UNITXSHR EQU   UNITSTAT                                                 09057000
UNITISHR EQU   UNITSTAT                                                 09058000
UNITUA   EQU   @NM00010+1                                               09059000
UNITCHA  EQU   @NM00010                                                 09060000
UNITUCB  EQU   UNITABL                                                  09061000
ALLUNCNT EQU   ALLAGL+30                                                09062000
ALLVLCNT EQU   ALLAGL+29                                                09063000
@NM00009 EQU   ALLOPT                                                   09064000
ALLOPTUN EQU   ALLOPT                                                   09065000
ALLOPTPV EQU   ALLOPT                                                   09066000
ALLOPTVL EQU   ALLOPT                                                   09067000
@NM00008 EQU   ALLORG+1                                                 09068000
ALLORGVS EQU   ALLORG+1                                                 09069000
@NM00007 EQU   ALLORG+1                                                 09070000
ALLORGGS EQU   ALLORG+1                                                 09071000
ALLORGUN EQU   ALLORG                                                   09072000
ALLORGPO EQU   ALLORG                                                   09073000
ALLORGMQ EQU   ALLORG                                                   09074000
ALLORGCQ EQU   ALLORG                                                   09075000
ALLORGCX EQU   ALLORG                                                   09076000
ALLORGDA EQU   ALLORG                                                   09077000
ALLORGPS EQU   ALLORG                                                   09078000
ALLORGIS EQU   ALLORG                                                   09079000
ALLDSPUN EQU   ALLDSP                                                   09080000
ALLDSPCG EQU   ALLDSP                                                   09081000
ALLDSPDE EQU   ALLDSP                                                   09082000
@NM00006 EQU   ALLDSP                                                   09083000
ALLSTSMD EQU   ALLSTS                                                   09084000
ALLSTSNW EQU   ALLSTS                                                   09085000
ALLSTSSR EQU   ALLSTS                                                   09086000
@NM00005 EQU   ALLSTS                                                   09087000
ALLPWD   EQU   ALLAGL+20                                                09088000
ALLVLP   EQU   ALLAGL+16                                                09089000
CIRPID   EQU   CIRAGL+28                                                09090000
CIRPWD   EQU   CIRAGL+24                                                09091000
CIRCAT   EQU   CIRAGL+20                                                09092000
CIRWKP   EQU   CIRAGL+16                                                09093000
CIRTLR   EQU   CIRAGL+12                                                09094000
CIRHDR   EQU   CIRAGL+8                                                 09095000
CIRTLN   EQU   CIRAGL+6                                                 09096000
CIRHLN   EQU   CIRAGL+4                                                 09097000
@NM00004 EQU   CIRAGL+1                                                 09098000
@NM00003 EQU   CIRTYPE                                                  09099000
CIRTYPAQ EQU   CIRTYPE                                                  09100000
CIRTYP1Q EQU   CIRTYPE                                                  09101000
NEWID1   EQU   TRACE1+95                                                09102000
CALLID   EQU   OLDERID1+90                                              09103000
@NM00002 EQU   OLDERID1                                                 09104000
*                                      END UNREFERENCED COMPONENTS      09105000
@RC00465 EQU   @RC00458                                                 09106000
@RC00521 EQU   @RC00507                                                 09107000
@RF00566 EQU   @RC00562                                                 09108000
@RC00919 EQU   @RC00915                                                 09109000
@RC01162 EQU   @RC01154                                                 09110000
@RF01814 EQU   @RC01799                                                 09111000
@PB00018 EQU   @EL00001                                                 09112000
@PB00017 EQU   @PB00018                                                 09113000
@PB00016 EQU   @PB00017                                                 09114000
@PB00015 EQU   @PB00016                                                 09115000
@PB00014 EQU   @PB00015                                                 09116000
@PB00013 EQU   @PB00014                                                 09117000
@PB00012 EQU   @PB00013                                                 09118000
@PB00011 EQU   @PB00012                                                 09119000
@PB00010 EQU   @PB00011                                                 09120000
@PB00009 EQU   @PB00010                                                 09121000
@PB00008 EQU   @PB00009                                                 09122000
@PB00007 EQU   @PB00008                                                 09123000
@PB00006 EQU   @PB00007                                                 09124000
@PB00005 EQU   @PB00006                                                 09125000
@PB00004 EQU   @PB00005                                                 09126000
@PB00003 EQU   @PB00004                                                 09127000
@PB00002 EQU   @PB00003                                                 09128000
@ENDDATA EQU   *                                                        09129000
         END   IDCLM01,(C'PLS2102',0603,76301)                          09130000
