         TITLE '************** IDCLR01: IDCAMS LISTCRA ROUTINE *********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCLR01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCLR01   78.073'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         LA    @08,4095(,@09)                                      0002 00025000
         LA    @07,4095(,@08)                                      0002 00026000
         USING @PSTART,@12                                         0002 00027000
         USING @PSTART+4095,@11                                    0002 00028000
         USING @PSTART+8190,@10                                    0002 00029000
         USING @PSTART+12285,@09                                   0002 00030000
         USING @PSTART+16380,@08                                   0002 00031000
         USING @PSTART+20475,@07                                   0002 00032000
         L     @00,@SIZDATD                                        0002 00033000
         GETMAIN  R,LV=(0)                                              00034000
         LR    @06,@01                                             0002 00035000
         LA    @05,4095(,@06)                                      0002 00036000
         USING @DATD,@06                                           0002 00037000
         USING @DATD+4095,@05                                      0002 00038000
         ST    @13,@SA00001+4                                      0002 00039000
         LM    @00,@01,20(@13)                                     0002 00040000
         ST    @06,8(,@13)                                         0002 00041000
         LR    @13,@06                                             0002 00042000
         MVC   @PC00001(12),0(@01)                                 0002 00043000
* /*******************************************************************/ 00044000
* /* PROCEDURE NAME - AATOPLR, TOP SEGMENT SKELETON OF WHOLE         */ 00045000
* /* FUNCTION -                                                      */ 00046000
* /*  IF ASKED FOR COMPARE OPEN THE CATALOG AS A DATASET,            */ 00047000
* /*  LOOP THRU ALL CRAS SPECIFIED IN INFILE:                        */ 00048000
* /*    OPEN CRA AND BUILD A CRACI VS. CATCI & ENTYPE TABLE,         */ 00049000
* /*    IF SEQUENTIALDUMP PRINT RECORDS AS THE TABLE IS BUILT        */ 00050000
* /*    TO AVOID DOUBLE I/O,                                         */ 00051000
* /*    IF NOT SEQUENTIALDUMP,                                       */ 00052000
* /*      PRINT (AND OPTIONALLY COMPARE) VOLUME RECORD WITH ALL      */ 00053000
* /*      ITS EXTENSION RECORDS AND F4DSCB INFO,                     */ 00054000
* /*      INITIALIZE SORT TO ALPHABETIZE VSAM ENTRIES (CLUSTER       */ 00055000
* /*      AND ALTERNATE INDEX)  AND IF SORT WORKED PRINT             */ 00056000
* /*      (COMPARE) THEM IN ALPHA ORDER WITH ALL OF THEIR            */ 00057000
* /*      ASSOCIATED RECORDS  AND USE SORT AGAIN ON ALL              */ 00058000
* /*      OTHER ENTRIES (NONVSAM, GDG BASE, AND USERCATPTR)          */ 00059000
* /*      AND IF SORT WORKED PRINT (COMPARE) THEM,                   */ 00060000
* /*      PASS THRU TABLE PRINTING EVERYTHING NOT YET PRINTED,       */ 00061000
* /*    CLOSE THE CRA AND PRINT A COMPLETION MESSAGE,                */ 00062000
* /*  CLEANUP EVERYTHING AND PRINT OVERALL COMPLETION MESSAGE        */ 00063000
* /* INPUTS -                                                        */ 00064000
* /*   FDT (PARSED USER LISTCRA COMMAND PARAMETERS)                  */ 00065000
* /*   CRAS AND CATALOG (OPTIONAL)                                   */ 00066000
* /* OUTPUTS -                                                       */ 00067000
* /*   CRA LISTING PER USER SPECIFIED OPTIONS                        */ 00068000
* /*******************************************************************/ 00069000
*                                                                  0172 00070000
* OLDERID2 = NEWERID2;                                             0172 00071000
         L     @04,@PC00001                                        0172 00072000
         L     @15,GDTTR2(,@04)                                    0172 00073000
         MVC   @TS00001(95),NEWERID2(@15)                          0172 00074000
         MVC   OLDERID2(95,@15),@TS00001                           0172 00075000
* NEWID2 = 'LRAA' ;                                                0173 00076000
         MVC   NEWID2(4,@15),@CC01157                              0173 00077000
* IF GDTDBG = NULLPTR                                              0174 00078000
*   THEN;                                                          0174 00079000
         L     @04,GDTDBG(,@04)                                    0174 00080000
         LTR   @04,@04                                             0174 00081000
         BZ    @RT00174                                            0174 00082000
*   ELSE                                                           0176 00083000
*     CALL IDCDB010 (GDTTBL,'LRAA') ;                              0176 00084000
*                                                                  0176 00085000
         L     @04,@PC00001                                        0176 00086000
         ST    @04,@AL00001                                        0176 00087000
         LA    @15,@CC01157                                        0176 00088000
         ST    @15,@AL00001+4                                      0176 00089000
         MVI   @AL00001+4,X'80'                                    0176 00090000
         L     @15,GDTDBG(,@04)                                    0176 00091000
         LA    @01,@AL00001                                        0176 00092000
         BALR  @14,@15                                             0176 00093000
* CALL INITLZE ;                   /* DO GENERAL INITIALIZE          */ 00094000
*                                                                  0177 00095000
@RT00174 BAL   @14,INITLZE                                         0177 00096000
* IF ADDR(CMPR) ^= '0'B                                            0178 00097000
*   THEN                                                           0178 00098000
*                                                                  0178 00099000
         L     @02,@PC00001+4                                      0178 00100000
         L     @02,FDTPTR+4(,@02)                                  0178 00101000
         LTR   @02,@02                                             0178 00102000
         BZ    @RF00178                                            0178 00103000
*     CALL CATOPEN ;               /* OPEN THE CATALOG               */ 00104000
*                                                                  0179 00105000
         BAL   @14,CATOPEN                                         0179 00106000
* DO CRACNT = 1 TO IFILECNT ;      /*************** CRA LOOP         */ 00107000
*                                                                  0180 00108000
@RF00178 LA    @02,1                                               0180 00109000
         B     @DE00180                                            0180 00110000
@DL00180 DS    0H                                                  0181 00111000
*   CALL CRAOPEN ;                 /* OPEN ONE OF THE CRAS           */ 00112000
         BAL   @14,CRAOPEN                                         0181 00113000
*                                  /* PRINT DONE HERE IF SEQDUMP     */ 00114000
*   IF     SDUMPSW ^= ON                                           0182 00115000
*      & CRAOPNSW = ON                                             0182 00116000
*      & FMUCTTP ^= '0'B           /* FMUCTTP (PTR) NOT 0 IF CTT     */ 00117000
*     THEN                         /* WAS BUILT OK                   */ 00118000
         TM    SDUMPSW,B'00000010'                                 0182 00119000
         BO    @RF00182                                            0182 00120000
         TM    CRAOPNSW,B'00010000'                                0182 00121000
         BNO   @RF00182                                            0182 00122000
         L     @02,FMUCTTP                                         0182 00123000
         LTR   @02,@02                                             0182 00124000
         BZ    @RF00182                                            0182 00125000
*       DO ;                                                       0183 00126000
*                                                                  0183 00127000
*         CALL PRTVOL ;            /* PRINT THE VOLUME SET           */ 00128000
*                                                                  0184 00129000
         BAL   @14,PRTVOL                                          0184 00130000
*         ENTYPARG(1) = CATRCTYP($CLUS) ;                          0185 00131000
         LA    @02,5                                               0185 00132000
         SLR   @01,@01                                             0185 00133000
         IC    @01,$CLUS                                           0185 00134000
         MR    @00,@02                                             0185 00135000
         LA    @15,CATRCTYP-5(@01)                                 0185 00136000
         MVC   ENTYPARG(1),0(@15)                                  0185 00137000
*         ENTYPARG(2) = CATRCTYP($AIX) ;                           0186 00138000
*                                                                  0186 00139000
         LR    @01,@02                                             0186 00140000
         SLR   @02,@02                                             0186 00141000
         IC    @02,$AIX                                            0186 00142000
         MR    @00,@02                                             0186 00143000
         LA    @02,CATRCTYP-5(@01)                                 0186 00144000
         MVC   ENTYPARG+1(1),0(@02)                                0186 00145000
*         CALL INTSORT (2,ENTYPARG); /*INIT SORT TABLE (VSAM)        */ 00146000
*                                                                  0187 00147000
         LA    @02,@CF00158                                        0187 00148000
         ST    @02,@AL00001                                        0187 00149000
         LA    @02,ENTYPARG                                        0187 00150000
         ST    @02,@AL00001+4                                      0187 00151000
         LA    @01,@AL00001                                        0187 00152000
         BAL   @14,INTSORT                                         0187 00153000
*         IF SORTOKSW = YES                                        0188 00154000
*           THEN                                                   0188 00155000
         TM    SORTOKSW,B'00000001'                                0188 00156000
         BNO   @RF00188                                            0188 00157000
*             DO ;                                                 0189 00158000
*                                                                  0189 00159000
*               CALL MEMSORT ;     /* SORT VSAM ENTRIES              */ 00160000
*                                                                  0190 00161000
         BAL   @14,MEMSORT                                         0190 00162000
*               CALL DOVSAM ;      /* PRINT (COMPARE) VSAMS          */ 00163000
*                                                                  0191 00164000
         BAL   @14,DOVSAM                                          0191 00165000
*               ENTYPARG(1) = CATRCTYP($NONV) ;                    0192 00166000
         LA    @02,5                                               0192 00167000
         SLR   @01,@01                                             0192 00168000
         IC    @01,$NONV                                           0192 00169000
         MR    @00,@02                                             0192 00170000
         LA    @15,CATRCTYP-5(@01)                                 0192 00171000
         MVC   ENTYPARG(1),0(@15)                                  0192 00172000
*               ENTYPARG(2) = CATRCTYP($GDGB) ;                    0193 00173000
         SLR   @01,@01                                             0193 00174000
         IC    @01,$GDGB                                           0193 00175000
         MR    @00,@02                                             0193 00176000
         LA    @15,CATRCTYP-5(@01)                                 0193 00177000
         MVC   ENTYPARG+1(1),0(@15)                                0193 00178000
*               ENTYPARG(3) = CATRCTYP($UCAT) ;                    0194 00179000
*                                                                  0194 00180000
         LR    @01,@02                                             0194 00181000
         SLR   @02,@02                                             0194 00182000
         IC    @02,$UCAT                                           0194 00183000
         MR    @00,@02                                             0194 00184000
         LA    @02,CATRCTYP-5(@01)                                 0194 00185000
         MVC   ENTYPARG+2(1),0(@02)                                0194 00186000
*               CALL INTSORT (3,ENTYPARG) ; /* SORTTBL OTHER         */ 00187000
*                                                                  0195 00188000
         LA    @02,@CF00166                                        0195 00189000
         ST    @02,@AL00001                                        0195 00190000
         LA    @02,ENTYPARG                                        0195 00191000
         ST    @02,@AL00001+4                                      0195 00192000
         LA    @01,@AL00001                                        0195 00193000
         BAL   @14,INTSORT                                         0195 00194000
*               IF SORTOKSW = YES                                  0196 00195000
*                 THEN                                             0196 00196000
         TM    SORTOKSW,B'00000001'                                0196 00197000
         BNO   @RF00196                                            0196 00198000
*                   DO ;                                           0197 00199000
*                                                                  0197 00200000
*                     CALL MEMSORT;/* SORT OTHER ENTRIES             */ 00201000
*                                                                  0198 00202000
         BAL   @14,MEMSORT                                         0198 00203000
*                     CALL DOOTHR; /* PRINT (COMPARE) OTHER          */ 00204000
*                                                                  0199 00205000
         BAL   @14,DOOTHR                                          0199 00206000
*                   END ;                                          0200 00207000
*             END ;                                                0201 00208000
*                                                                  0201 00209000
@RF00196 DS    0H                                                  0202 00210000
*         CALL PRTFIFO ;           /* PRINT ALL NOT PRINTED          */ 00211000
*                                                                  0202 00212000
@RF00188 BAL   @14,PRTFIFO                                         0202 00213000
*       END ;                                                      0203 00214000
*   IF CRAOPNSW = ON                                               0204 00215000
*                                                                  0204 00216000
*     THEN CALL CLENCRA ;          /* CLEAN UP CRA STUFF             */ 00217000
*                                                                  0204 00218000
@RF00182 TM    CRAOPNSW,B'00010000'                                0204 00219000
         BNO   @RF00204                                            0204 00220000
         BAL   @14,CLENCRA                                         0205 00221000
* END ;                                                            0206 00222000
*                                                                  0206 00223000
@RF00204 LA    @02,1                                               0206 00224000
         L     @15,CRACNT-1                                        0206 00225000
         LA    @15,0(,@15)                                         0206 00226000
         ALR   @02,@15                                             0206 00227000
@DE00180 STCM  @02,7,CRACNT                                        0206 00228000
         L     @15,@PC00001+4                                      0206 00229000
         L     @01,FDTPTR(,@15)                                    0206 00230000
         CH    @02,IFILECNT(,@01)                                  0206 00231000
         BNH   @DL00180                                            0206 00232000
* CALL CLEANUP ;                                                   0207 00233000
*                                                                  0207 00234000
         BAL   @14,CLEANUP                                         0207 00235000
* LASTCC = LRLASTCC ;                                              0208 00236000
*                                                                  0208 00237000
         L     @04,@PC00001+8                                      0208 00238000
         LH    @15,LRLASTCC                                        0208 00239000
         STH   @15,LASTCC(,@04)                                    0208 00240000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                            0209 00241000
         L     @15,@PC00001                                        0209 00242000
         ST    @15,@AL00001                                        0209 00243000
         LA    @14,MODID                                           0209 00244000
         ST    @14,@AL00001+4                                      0209 00245000
         ST    @04,@AL00001+8                                      0209 00246000
         MVI   @AL00001+8,X'80'                                    0209 00247000
         L     @15,GDTEPL(,@15)                                    0209 00248000
         LA    @01,@AL00001                                        0209 00249000
         BALR  @14,@15                                             0209 00250000
* /*******************************************************************/ 00251000
* /* PROCEDURE NAME - ADDASOC, ADD AN ASSOC TO ASSOCTBL              */ 00252000
* /* FUNCTION -                                                      */ 00253000
* /*   FOR THE RECORD IDENTIFIED BY CIFRGET CALL INITASOC TO         */ 00254000
* /*   BUILD AN ASSOCTB2,                                            */ 00255000
* /*   SEARCH IT FOR THE ASSOCIATION DESIRED AND IF FOUND            */ 00256000
* /*   ADD IT AND ITS CI TO THE ASSOCTBL ADDING ALSO ANOTHER         */ 00257000
* /*   TABLE TO THE CHAIN IF THE LAST ONE WAS FULL                   */ 00258000
* /* INPUTS -                                                        */ 00259000
* /*   ASOCDSRD (ASSOCIATION DESIRED TO BE ADDED)                    */ 00260000
* /*   CIFRGET (IDENTIFIES RECORD  ASSOCIATION MAY BE IN)            */ 00261000
* /* OUTPUTS -                                                       */ 00262000
* /*   ENTRY ADDED TO THE ASSOCTBL IF FOUND IN THE RECORD            */ 00263000
* /* CALLS -                                                         */ 00264000
* /*   INTASOC, UGPOOL, ERROR                                        */ 00265000
* /*******************************************************************/ 00266000
*                                                                  0210 00267000
*ADDASOC: PROCEDURE (ASOCDSRD) ;                                   0210 00268000
@EL00001 L     @13,4(,@13)                                         0210 00269000
@EF00001 L     @00,@SIZDATD                                        0210 00270000
         LR    @01,@06                                             0210 00271000
         FREEMAIN R,LV=(0),A=(1)                                        00272000
@ER00001 LM    @14,@12,12(@13)                                     0210 00273000
         BR    @14                                                 0210 00274000
ADDASOC  STM   @14,@12,@SA00002                                    0210 00275000
         MVC   @PC00002(4),0(@01)                                  0210 00276000
* OLDERID2 = NEWERID2;                                             0211 00277000
         L     @15,@PC00001                                        0211 00278000
         L     @14,GDTTR2(,@15)                                    0211 00279000
         MVC   @TS00001(95),NEWERID2(@14)                          0211 00280000
         MVC   OLDERID2(95,@14),@TS00001                           0211 00281000
* NEWID2 = 'LRAD' ;                                                0212 00282000
         MVC   NEWID2(4,@14),@CC01175                              0212 00283000
* IF GDTDBG = NULLPTR                                              0213 00284000
*   THEN;                                                          0213 00285000
         L     @15,GDTDBG(,@15)                                    0213 00286000
         LTR   @15,@15                                             0213 00287000
         BZ    @RT00213                                            0213 00288000
*   ELSE                                                           0215 00289000
*     CALL IDCDB010 (GDTTBL,'LRAD') ;                              0215 00290000
*                                                                  0215 00291000
         L     @15,@PC00001                                        0215 00292000
         ST    @15,@AL00001                                        0215 00293000
         LA    @14,@CC01175                                        0215 00294000
         ST    @14,@AL00001+4                                      0215 00295000
         MVI   @AL00001+4,X'80'                                    0215 00296000
         L     @15,GDTDBG(,@15)                                    0215 00297000
         LA    @01,@AL00001                                        0215 00298000
         BALR  @14,@15                                             0215 00299000
* DCL ASOCDSRD CHAR(1) ;           /* ASSOCIATION DESIRED            */ 00300000
*                                                                  0216 00301000
@RT00213 DS    0H                                                  0217 00302000
* ADPTRSAV = ATRA2PTR ;            /* SAVE PTR TO CURNT ASOC         */ 00303000
         L     @15,ATRA2PTR                                        0217 00304000
         ST    @15,ADPTRSAV                                        0217 00305000
* ATRA2PTR = A2PTR ;                                               0218 00306000
*                                                                  0218 00307000
         L     @15,A2PTR                                           0218 00308000
         ST    @15,ATRA2PTR                                        0218 00309000
* CALL INTASOC(1) ;                /* BUILD ASSOCTB2 THEN            */ 00310000
*                                                                  0219 00311000
         LA    @01,@AL00219                                        0219 00312000
         BAL   @14,INTASOC                                         0219 00313000
* /*******************************************************************/ 00314000
* /* LOOP: LOOK FOR DESIRED ASSOCIATION TYPE                         */ 00315000
* /*******************************************************************/ 00316000
*                                                                  0220 00317000
* DO A2SLOT = 1 TO NBRATS                                          0220 00318000
*    WHILE (A2ENTYP(A2SLOT) ^= ASOCDSRD                            0220 00319000
*       & A2CRACI(A2SLOT) ^= '0'B                                  0220 00320000
*       & LASTATSW ^= ON) ;                                        0220 00321000
         LA    A2SLOT,1                                            0220 00322000
@DL00220 L     @04,ATRA2PTR                                        0220 00323000
         LR    @02,A2SLOT                                          0220 00324000
         SLA   @02,2                                               0220 00325000
         L     @15,@PC00002                                        0220 00326000
         ST    @02,@TF00001                                        0220 00327000
         ALR   @02,@04                                             0220 00328000
         CLC   A2ENTYP-4(1,@02),ASOCDSRD(@15)                      0220 00329000
         BE    @DC00220                                            0220 00330000
         L     @02,@TF00001                                        0220 00331000
         L     @02,A2CRACI-5(@02,@04)                              0220 00332000
         LA    @02,0(,@02)                                         0220 00333000
         LTR   @02,@02                                             0220 00334000
         BZ    @DC00220                                            0220 00335000
         TM    LASTATSW,B'00100000'                                0220 00336000
         BO    @DC00220                                            0220 00337000
*   IF A2SLOT = NBRATS             /* IF END OF TABLE                */ 00338000
*     THEN                                                         0221 00339000
         C     A2SLOT,@CF00038                                     0221 00340000
         BNE   @RF00221                                            0221 00341000
*       IF A2NXTTBL ^= '0'B        /* AND IS ANOTHER ONE             */ 00342000
*         THEN                                                     0222 00343000
         L     @04,A2NXTTBL(,@04)                                  0222 00344000
         LTR   @04,@04                                             0222 00345000
         BZ    @RF00222                                            0222 00346000
*           DO ;                                                   0223 00347000
*             ATRA2PTR = A2NXTTBL; /* BUMP TO NEXT TABLE             */ 00348000
         ST    @04,ATRA2PTR                                        0224 00349000
*             A2SLOT = 0 ;         /* TO SEARCH IT ALSO              */ 00350000
         SLR   A2SLOT,A2SLOT                                       0225 00351000
*           END ;                                                  0226 00352000
*         ELSE LASTATSW = ON ;                                     0227 00353000
         B     @RC00222                                            0227 00354000
@RF00222 OI    LASTATSW,B'00100000'                                0227 00355000
* END ;                                                            0228 00356000
@RC00222 DS    0H                                                  0228 00357000
@RF00221 AL    A2SLOT,@CF00222                                     0228 00358000
         C     A2SLOT,@CF00038                                     0228 00359000
         BNH   @DL00220                                            0228 00360000
@DC00220 DS    0H                                                  0229 00361000
*  LASTATSW = OFF ;                                                0229 00362000
         NI    LASTATSW,B'11011111'                                0229 00363000
* IF A2ENTYP(A2SLOT) = ASOCDSRD    /* IF ASSOCIATION DESIRED         */ 00364000
*   THEN                           /* WAS FOUND SET UP TO            */ 00365000
         L     @04,ATRA2PTR                                        0230 00366000
         LR    @02,A2SLOT                                          0230 00367000
         SLA   @02,2                                               0230 00368000
         L     @15,@PC00002                                        0230 00369000
         ALR   @02,@04                                             0230 00370000
         CLC   A2ENTYP-4(1,@02),ASOCDSRD(@15)                      0230 00371000
         BNE   @RF00230                                            0230 00372000
*     DO ;                         /* ADD IT TO THE ASSOCTBL         */ 00373000
*       A2PTRSAV = ATRA2PTR ;                                      0232 00374000
         L     @02,ATRA2PTR                                        0232 00375000
         ST    @02,A2PTRSAV                                        0232 00376000
*       ATRA2PTR = ATPTR ;         /* SAVE PTR TO CURNT ASO2         */ 00377000
         L     @02,ATPTR                                           0233 00378000
         ST    @02,ATRA2PTR                                        0233 00379000
*       ADATSLOT = 1 ;             /* FIND LAST SLOT TO INSRT        */ 00380000
*                                                                  0234 00381000
         LA    ADATSLOT,1                                          0234 00382000
*       /*************************************************************/ 00383000
*       /* LOOP: LOOK FOR NEXT EMPTY SLOT IN ASSOCIATION TABL        */ 00384000
*       /*************************************************************/ 00385000
*                                                                  0235 00386000
*       DO UNTIL (ATCRACI(ADATSLOT) = '0'B                         0235 00387000
*              | LASTATSW = ON) ;                                  0235 00388000
@DL00235 DS    0H                                                  0236 00389000
*         IF ADATSLOT = NBRATS     /*IF AT END OF TABLE              */ 00390000
*           THEN                                                   0236 00391000
         CL    ADATSLOT,@CF00038                                   0236 00392000
         BNE   @RF00236                                            0236 00393000
*             IF ATNXTTBL ^= '0'B  /* AND IS ANOTHER ONE             */ 00394000
*               THEN                                               0237 00395000
         L     @02,ATRA2PTR                                        0237 00396000
         L     @02,ATNXTTBL(,@02)                                  0237 00397000
         LTR   @02,@02                                             0237 00398000
         BZ    @RF00237                                            0237 00399000
*                 DO ;                                             0238 00400000
*                   ATRA2PTR = ATNXTTBL ;    /* BUMP TO NEXT         */ 00401000
         ST    @02,ATRA2PTR                                        0239 00402000
*                   ADATSLOT = 0 ;                                 0240 00403000
         SLR   ADATSLOT,ADATSLOT                                   0240 00404000
*                 END ;                                            0241 00405000
*               ELSE LASTATSW = ON ;         /* LAST ONE FULL        */ 00406000
         B     @RC00237                                            0242 00407000
@RF00237 OI    LASTATSW,B'00100000'                                0242 00408000
*         ADATSLOT = ADATSLOT + 1 ;                                0243 00409000
@RC00237 DS    0H                                                  0243 00410000
@RF00236 LA    ADATSLOT,1(,ADATSLOT)                               0243 00411000
*       END ;                                                      0244 00412000
@DE00235 LR    @02,ADATSLOT                                        0244 00413000
         SLL   @02,2                                               0244 00414000
         L     @01,ATRA2PTR                                        0244 00415000
         L     @02,ATCRACI-5(@02,@01)                              0244 00416000
         LA    @02,0(,@02)                                         0244 00417000
         LTR   @02,@02                                             0244 00418000
         BZ    @DC00235                                            0244 00419000
         TM    LASTATSW,B'00100000'                                0244 00420000
         BNO   @DL00235                                            0244 00421000
@DC00235 DS    0H                                                  0245 00422000
*       IF LASTATSW = ON                                           0245 00423000
*         THEN                     /* LAST TABLE WAS FULL SO         */ 00424000
         TM    LASTATSW,B'00100000'                                0245 00425000
         BNO   @RF00245                                            0245 00426000
*           DO ;                   /* MUST ADD ANOTHER TO            */ 00427000
*             LASTATSW = OFF ;     /* THE CHAIN OF TABLES            */ 00428000
*                                                                  0247 00429000
         NI    LASTATSW,B'11011111'                                0247 00430000
*             CALL IDCSAGP0 (GDTTBL,ATLEN,ATPTRNXT,MODID,SETZERO) ;     00431000
*                                                                  0248 00432000
         MVC   @AL00001+4(16),@AL00248                             0248 00433000
         L     @02,@PC00001                                        0248 00434000
         ST    @02,@AL00001                                        0248 00435000
         LA    @15,ATPTRNXT                                        0248 00436000
         ST    @15,@AL00001+8                                      0248 00437000
         L     @15,GDTGPL(,@02)                                    0248 00438000
         LA    @01,@AL00001                                        0248 00439000
         BALR  @14,@15                                             0248 00440000
*             RESPECIFY RTNREG RSTD;                               0249 00441000
*             TESTRC = RTNREG;                                     0250 00442000
         STH   RTNREG,TESTRC                                       0250 00443000
*             RESPECIFY RTNREG UNRSTD ;                            0251 00444000
*             IF TESTRC = 0                                        0252 00445000
*               THEN                                               0252 00446000
         LH    @02,TESTRC                                          0252 00447000
         LTR   @02,@02                                             0252 00448000
         BNZ   @RF00252                                            0252 00449000
*                 DO ;                                             0253 00450000
*                   ATPTRNXT -> ATNAME = 'ASOC' ;                  0254 00451000
         L     @02,ATPTRNXT                                        0254 00452000
         MVC   ATNAME(4,@02),@CC01177                              0254 00453000
*                   ATNXTTBL = ATPTRNXT ;                          0255 00454000
         L     @01,ATRA2PTR                                        0255 00455000
         ST    @02,ATNXTTBL(,@01)                                  0255 00456000
*                   ATRA2PTR = ATNXTTBL ;                          0256 00457000
         ST    @02,ATRA2PTR                                        0256 00458000
*                   ADATSLOT = 1 ;                                 0257 00459000
         LA    ADATSLOT,1                                          0257 00460000
*                 END ;                                            0258 00461000
*               ELSE CALL ERROR (NBRETE,$ABORT) ; /* NO MEMRY        */ 00462000
         B     @RC00252                                            0259 00463000
@RF00252 LA    @01,@AL00259                                        0259 00464000
         BAL   @14,ERROR                                           0259 00465000
*           END ;                                                  0260 00466000
@RC00252 DS    0H                                                  0261 00467000
*                                  /* PUT FOUND ASSOC IN TBL         */ 00468000
*       ATASOC(ADATSLOT) = A2PTRSAV -> A2ASOC(A2SLOT) ;            0261 00469000
@RF00245 LR    @02,ADATSLOT                                        0261 00470000
         SLL   @02,2                                               0261 00471000
         L     @01,ATRA2PTR                                        0261 00472000
         ALR   @01,@02                                             0261 00473000
         LR    @02,A2SLOT                                          0261 00474000
         SLA   @02,2                                               0261 00475000
         L     @15,A2PTRSAV                                        0261 00476000
         ALR   @15,@02                                             0261 00477000
         MVC   ATASOC-4(4,@01),A2ASOC-4(@15)                       0261 00478000
*     END ;                                                        0262 00479000
* ATRA2PTR = ADPTRSAV ;                                            0263 00480000
*                                                                  0263 00481000
@RF00230 L     @04,ADPTRSAV                                        0263 00482000
         ST    @04,ATRA2PTR                                        0263 00483000
*END ADDASOC ;                                                     0264 00484000
@EL00002 DS    0H                                                  0264 00485000
@EF00002 DS    0H                                                  0264 00486000
@ER00002 LM    @14,@12,@SA00002                                    0264 00487000
         BR    @14                                                 0264 00488000
* /*******************************************************************/ 00489000
* /* PROCEDURE NAME - BLDVEXT, BUILD THE VEXTTBL                     */ 00490000
* /* FUNCTION -                                                      */ 00491000
* /*   ELIMINATE DUPLICATE EXTENSION POINTERS,                       */ 00492000
* /*   MOVE EXTENSION CI,S INTO THE VEXTTBL,                         */ 00493000
* /*   WHEN VEXTTBL IS FULL GET MEMORY FOR ANOTHER AND CHAIN         */ 00494000
* /*   IT OFF THE PREVIOUS ONE                                       */ 00495000
* /* INPUTS -                                                        */ 00496000
* /*   VEXTTBL TABLE(S)                                              */ 00497000
* /*   CIFRTRNS (CI OF EXTENSION RECORD)                             */ 00498000
* /*   VESLOTB (INCREMENTED HERE FOR LOOP IN INTVEXT)                */ 00499000
* /* OUTPUTS -                                                       */ 00500000
* /*   ENTRY IN VEXTTBL AND MAYBE NEW VEXTTBL ADDED TO CHAIN         */ 00501000
* /* CALLS -                                                         */ 00502000
* /*   UGPOOL, ERROR                                                 */ 00503000
* /*******************************************************************/ 00504000
*                                                                  0265 00505000
*BLDVEXT: PROCEDURE ;                                              0265 00506000
BLDVEXT  STM   @14,@01,@SA00003                                    0265 00507000
         STM   @03,@12,@SA00003+16                                 0265 00508000
* OLDERID2 = NEWERID2;                                             0266 00509000
         L     @04,@PC00001                                        0266 00510000
         L     @03,GDTTR2(,@04)                                    0266 00511000
         MVC   @TS00001(95),NEWERID2(@03)                          0266 00512000
         MVC   OLDERID2(95,@03),@TS00001                           0266 00513000
* NEWID2 = 'LRBL' ;                                                0267 00514000
         MVC   NEWID2(4,@03),@CC01183                              0267 00515000
* IF GDTDBG = NULLPTR                                              0268 00516000
*   THEN;                                                          0268 00517000
         L     @04,GDTDBG(,@04)                                    0268 00518000
         LTR   @04,@04                                             0268 00519000
         BZ    @RT00268                                            0268 00520000
*   ELSE                                                           0270 00521000
*     CALL IDCDB010 (GDTTBL,'LRBL') ;                              0270 00522000
*                                                                  0270 00523000
         L     @04,@PC00001                                        0270 00524000
         ST    @04,@AL00001                                        0270 00525000
         LA    @03,@CC01183                                        0270 00526000
         ST    @03,@AL00001+4                                      0270 00527000
         MVI   @AL00001+4,X'80'                                    0270 00528000
         L     @15,GDTDBG(,@04)                                    0270 00529000
         LA    @01,@AL00001                                        0270 00530000
         BALR  @14,@15                                             0270 00531000
* VEDUPSW = OFF ;                                                  0271 00532000
@RT00268 NI    VEDUPSW,B'01111111'                                 0271 00533000
* VEPTRSAV = VEPTR ;                                               0272 00534000
         L     VEPTRSAV,VEPTR                                      0272 00535000
* VEPTR = VEPTRBEG  ;                                              0273 00536000
*                                                                  0273 00537000
         L     @03,VEPTRBEG                                        0273 00538000
         ST    @03,VEPTR                                           0273 00539000
* /*******************************************************************/ 00540000
* /* LOOP: LOOK THRU EXISTING VERTICAL EXTENSIONS TABLE              */ 00541000
* /*       TO SEE IF THIS EXTENSION CI IS ALREADY THERE              */ 00542000
* /*******************************************************************/ 00543000
*                                                                  0274 00544000
* DO VECKSLOT = 1 TO NBRVES WHILE(VECRACI(VECKSLOT) ^= '0'B) ;     0274 00545000
         LA    VECKSLOT,1                                          0274 00546000
@DL00274 L     @15,VEPTR                                           0274 00547000
         LR    @14,VECKSLOT                                        0274 00548000
         SLA   @14,2                                               0274 00549000
         L     @01,VECRACI-5(@14,@15)                              0274 00550000
         LA    @01,0(,@01)                                         0274 00551000
         LTR   @01,@01                                             0274 00552000
         BZ    @DC00274                                            0274 00553000
*   IF VECRACI(VECKSLOT) = CIFRTRNS                                0275 00554000
*     THEN                                                         0275 00555000
         ALR   @15,@14                                             0275 00556000
         CLC   VECRACI-4(3,@15),CIFRTRNS                           0275 00557000
         BNE   @RF00275                                            0275 00558000
*       DO ;                                                       0276 00559000
*         VEDUPSW = ON ;           /* DUPLICATE FOUND SO             */ 00560000
         OI    VEDUPSW,B'10000000'                                 0277 00561000
*         VECKSLOT = NBRVES + 1 ;  /* GET OUT OF LOOP NOW            */ 00562000
         LA    VECKSLOT,10                                         0278 00563000
*       END ;                                                      0279 00564000
*   IF     VEDUPSW ^= ON                                           0280 00565000
*      & VECKSLOT = NBRVES                                         0280 00566000
*      & VENXTTBL ^= '0'B                                          0280 00567000
*     THEN                         /* BUMP TO NEXT TABLE             */ 00568000
@RF00275 TM    VEDUPSW,B'10000000'                                 0280 00569000
         BO    @RF00280                                            0280 00570000
         C     VECKSLOT,@CF00038                                   0280 00571000
         BNE   @RF00280                                            0280 00572000
         L     @01,VEPTR                                           0280 00573000
         L     @15,VENXTTBL(,@01)                                  0280 00574000
         LTR   @15,@15                                             0280 00575000
         BZ    @RF00280                                            0280 00576000
*       DO ;                                                       0281 00577000
*         VEPTR = VENXTTBL ;                                       0282 00578000
         ST    @15,VEPTR                                           0282 00579000
*         VECKSLOT = 0 ;                                   /*@OZ20928*/ 00580000
         SLR   VECKSLOT,VECKSLOT                                   0283 00581000
*       END ;                                                      0284 00582000
* END ;                                                            0285 00583000
@RF00280 AL    VECKSLOT,@CF00222                                   0285 00584000
         C     VECKSLOT,@CF00038                                   0285 00585000
         BNH   @DL00274                                            0285 00586000
@DC00274 DS    0H                                                  0286 00587000
* VEPTR = VEPTRSAV ;               /* POINT BACK TO RIGHT TBL        */ 00588000
         ST    VEPTRSAV,VEPTR                                      0286 00589000
* IF VEDUPSW ^= ON                                                 0287 00590000
*   THEN                           /* NOT DUPLICATE SO ADD           */ 00591000
         TM    VEDUPSW,B'10000000'                                 0287 00592000
         BO    @RF00287                                            0287 00593000
*     DO ;                         /* THIS CI TO THE VEXTTBL         */ 00594000
*       VESLOTB = VESLOTB + 1 ;                                    0289 00595000
         LA    VESLOTB,1(,VESLOTB)                                 0289 00596000
*       IF VESLOTB > NBRVES                                        0290 00597000
*         THEN                                                     0290 00598000
         C     VESLOTB,@CF00038                                    0290 00599000
         BNH   @RF00290                                            0290 00600000
*           DO ;                   /* NEED ANOTHER VEXTTBL           */ 00601000
*             IF VENXTTBL = '0'B   /* IS ONE ALREDY THERE            */ 00602000
*               THEN                                               0292 00603000
         L     @04,VEPTR                                           0292 00604000
         L     @04,VENXTTBL(,@04)                                  0292 00605000
         LTR   @04,@04                                             0292 00606000
         BNZ   @RF00292                                            0292 00607000
*                 DO ;             /* NO, GET STORAGE FOR ONE        */ 00608000
*                                                                  0293 00609000
*                   CALL IDCSAGP0 (GDTTBL,VELEN,VEPTRNXT,MODID,    0294 00610000
*                           SETZERO) ;  /* ZERO NEXT TBL PTR         */ 00611000
*                                                                  0294 00612000
         MVC   @AL00001+4(16),@AL00294                             0294 00613000
         L     @04,@PC00001                                        0294 00614000
         ST    @04,@AL00001                                        0294 00615000
         LA    @15,VEPTRNXT                                        0294 00616000
         ST    @15,@AL00001+8                                      0294 00617000
         L     @15,GDTGPL(,@04)                                    0294 00618000
         LA    @01,@AL00001                                        0294 00619000
         BALR  @14,@15                                             0294 00620000
*                   RESPECIFY RTNREG RSTD;                         0295 00621000
*                   TESTRC = RTNREG;                               0296 00622000
         STH   RTNREG,TESTRC                                       0296 00623000
*                   RESPECIFY RTNREG UNRSTD ;                      0297 00624000
*                   IF TESTRC = 0                                  0298 00625000
*                     THEN                                         0298 00626000
         LH    @04,TESTRC                                          0298 00627000
         LTR   @04,@04                                             0298 00628000
         BNZ   @RF00298                                            0298 00629000
*                       DO ;                                       0299 00630000
*                         VEPTRNXT->VENAME = 'VEXT' ;              0300 00631000
         L     @04,VEPTRNXT                                        0300 00632000
         MVC   VENAME(4,@04),@CC00733                              0300 00633000
*                         VENXTTBL = VEPTRNXT ;                    0301 00634000
         L     @01,VEPTR                                           0301 00635000
         ST    @04,VENXTTBL(,@01)                                  0301 00636000
*                       END ;                                      0302 00637000
*                     ELSE CALL ERROR (NBRETE,$ABORT);/*NOMEM        */ 00638000
         B     @RC00298                                            0303 00639000
@RF00298 LA    @01,@AL00303                                        0303 00640000
         BAL   @14,ERROR                                           0303 00641000
*                 END ;                                            0304 00642000
@RC00298 DS    0H                                                  0305 00643000
*             VEPTR = VENXTTBL ;   /* BUMP TO NEXT TABLE             */ 00644000
@RF00292 L     @04,VEPTR                                           0305 00645000
         L     @04,VENXTTBL(,@04)                                  0305 00646000
         ST    @04,VEPTR                                           0305 00647000
*             DO VESLOTB = 1 TO NBRVES ;                           0306 00648000
         LA    VESLOTB,1                                           0306 00649000
@DL00306 DS    0H                                                  0307 00650000
*               VEEXT(VESLOTB) = '0'B ;                            0307 00651000
         LR    @04,VESLOTB                                         0307 00652000
         SLA   @04,2                                               0307 00653000
         L     @03,VEPTR                                           0307 00654000
         ALR   @03,@04                                             0307 00655000
         XC    VEEXT-3(3,@03),VEEXT-3(@03)                         0307 00656000
         MVI   VEEXT-4(@03),B'00000000'                            0307 00657000
*             END ;                                                0308 00658000
         AL    VESLOTB,@CF00222                                    0308 00659000
         C     VESLOTB,@CF00038                                    0308 00660000
         BNH   @DL00306                                            0308 00661000
*             VESLOTB = 1 ;        /* TABLE SLOT 1                   */ 00662000
         LA    VESLOTB,1                                           0309 00663000
*           END ;                  /* PUT CI INTO TABLE              */ 00664000
*       VECRACI(VESLOTB) = CIFRTRNS ;                              0311 00665000
@RF00290 LR    @04,VESLOTB                                         0311 00666000
         SLA   @04,2                                               0311 00667000
         L     @03,VEPTR                                           0311 00668000
         ALR   @03,@04                                             0311 00669000
         MVC   VECRACI-4(3,@03),CIFRTRNS                           0311 00670000
*     END ;                                                        0312 00671000
*   ELSE  VEDUPSW = OFF ;                                          0313 00672000
*                                                                  0313 00673000
         B     @RC00287                                            0313 00674000
@RF00287 NI    VEDUPSW,B'01111111'                                 0313 00675000
*END BLDVEXT ;                                                     0314 00676000
@EL00003 DS    0H                                                  0314 00677000
@EF00003 DS    0H                                                  0314 00678000
@ER00003 LM    @14,@01,@SA00003                                    0314 00679000
         LM    @03,@12,@SA00003+16                                 0314 00680000
         BR    @14                                                 0314 00681000
* /*******************************************************************/ 00682000
* /* PROCEDURE NAME - BUFSHUF, BUFFER SHUFFEL TO 'HOME' BUFFR        */ 00683000
* /* FUNCTION -                                                      */ 00684000
* /*   MOVES RECORD FROM LAST BUFFER TO ITS 'HOME' POSITION          */ 00685000
* /*   I.E. BUFFER 1 = CLUSTER OR AIX OR GDG BASE                    */ 00686000
* /*               2 = DATA OR NONVSAM(ALIENS)                       */ 00687000
* /*               3 = INDEX                                         */ 00688000
* /*               4 = CURRENTLY LAST BUFFER MOVED FROM              */ 00689000
* /* INPUTS -                                                        */ 00690000
* /*   ENTYPSAV (IDENTIFIES RECORD TYPE IN LAST BUFFER)              */ 00691000
* /*   RECORD (IN LAST BUFFER POINTED TO BY BUFNO)                   */ 00692000
* /* OUTPUTS -                                                       */ 00693000
* /*   RECORD IN ITS 'HOME' BUFFER                                   */ 00694000
* /* CALLS - NONE                                                    */ 00695000
* /*******************************************************************/ 00696000
*                                                                  0315 00697000
*BUFSHUF: PROCEDURE ;                                              0315 00698000
BUFSHUF  STM   @14,@12,@SA00004                                    0315 00699000
* OLDERID2 = NEWERID2;                                             0316 00700000
         L     @04,@PC00001                                        0316 00701000
         L     @15,GDTTR2(,@04)                                    0316 00702000
         MVC   @TS00001(95),NEWERID2(@15)                          0316 00703000
         MVC   OLDERID2(95,@15),@TS00001                           0316 00704000
* NEWID2 = 'LRBU' ;                                                0317 00705000
         MVC   NEWID2(4,@15),@CC01188                              0317 00706000
* IF GDTDBG = NULLPTR                                              0318 00707000
*   THEN;                                                          0318 00708000
         L     @04,GDTDBG(,@04)                                    0318 00709000
         LTR   @04,@04                                             0318 00710000
         BZ    @RT00318                                            0318 00711000
*   ELSE                                                           0320 00712000
*     CALL IDCDB010 (GDTTBL,'LRBU') ;                              0320 00713000
*                                                                  0320 00714000
         L     @04,@PC00001                                        0320 00715000
         ST    @04,@AL00001                                        0320 00716000
         LA    @15,@CC01188                                        0320 00717000
         ST    @15,@AL00001+4                                      0320 00718000
         MVI   @AL00001+4,X'80'                                    0320 00719000
         L     @15,GDTDBG(,@04)                                    0320 00720000
         LA    @01,@AL00001                                        0320 00721000
         BALR  @14,@15                                             0320 00722000
* IF    ENTYPSAV = CATRCTYP($CLUS)                                 0321 00723000
*    | ENTYPSAV = CATRCTYP($AIX)                                   0321 00724000
*    | ENTYPSAV = CATRCTYP($GDGB)                                  0321 00725000
*   THEN                                                           0321 00726000
@RT00318 LA    @04,5                                               0321 00727000
         SLR   @01,@01                                             0321 00728000
         IC    @01,$CLUS                                           0321 00729000
         MR    @00,@04                                             0321 00730000
         LA    @15,CATRCTYP-5(@01)                                 0321 00731000
         CLC   ENTYPSAV(1),0(@15)                                  0321 00732000
         BE    @RT00321                                            0321 00733000
         SLR   @01,@01                                             0321 00734000
         IC    @01,$AIX                                            0321 00735000
         MR    @00,@04                                             0321 00736000
         LA    @15,CATRCTYP-5(@01)                                 0321 00737000
         CLC   ENTYPSAV(1),0(@15)                                  0321 00738000
         BE    @RT00321                                            0321 00739000
         LR    @01,@04                                             0321 00740000
         SLR   @04,@04                                             0321 00741000
         IC    @04,$GDGB                                           0321 00742000
         MR    @00,@04                                             0321 00743000
         LA    @04,CATRCTYP-5(@01)                                 0321 00744000
         CLC   ENTYPSAV(1),0(@04)                                  0321 00745000
         BNE   @RF00321                                            0321 00746000
@RT00321 DS    0H                                                  0322 00747000
*     DO ;                                                         0322 00748000
*       IOBUF(1,1:256) = IOBUF(BUFNO,1:256) ;                      0323 00749000
         L     @04,IOBFSPTR                                        0323 00750000
         SLR   @15,@15                                             0323 00751000
         IC    @15,BUFNO                                           0323 00752000
         SLA   @15,9                                               0323 00753000
         ST    @15,@TF00001                                        0323 00754000
         ALR   @15,@04                                             0323 00755000
         AL    @15,@CF01464                                        0323 00756000
         MVC   @TS00001(256),IOBUF(@15)                            0323 00757000
         MVC   IOBUF(256,@04),@TS00001                             0323 00758000
*       IOBUF(1,257:508) = IOBUF(BUFNO,257:508) ;                  0324 00759000
         LR    @01,@04                                             0324 00760000
         AL    @01,@TF00001                                        0324 00761000
         AL    @01,@CF01465                                        0324 00762000
         MVC   @TS00001(252),IOBUF(@01)                            0324 00763000
         MVC   IOBUF+256(252,@04),@TS00001                         0324 00764000
*       IOBUFCI(BUFNO) = STENDCI ;                                 0325 00765000
         AL    @04,@TF00001                                        0325 00766000
         AL    @04,@CF01466                                        0325 00767000
         MVC   IOBUFCI-509(3,@04),STENDCI                          0325 00768000
*       BUFNO = 1 ;                                                0326 00769000
         MVI   BUFNO,X'01'                                         0326 00770000
*     END ;                                                        0327 00771000
*   ELSE                                                           0328 00772000
*     IF    ENTYPSAV = CATRCTYP($DATA)                             0328 00773000
*        | ENTYPSAV = CATRCTYP($NONV)                              0328 00774000
*       THEN                                                       0328 00775000
         B     @RC00321                                            0328 00776000
@RF00321 LA    @04,5                                               0328 00777000
         SLR   @01,@01                                             0328 00778000
         IC    @01,$DATA                                           0328 00779000
         MR    @00,@04                                             0328 00780000
         LA    @15,CATRCTYP-5(@01)                                 0328 00781000
         CLC   ENTYPSAV(1),0(@15)                                  0328 00782000
         BE    @RT00328                                            0328 00783000
         LR    @01,@04                                             0328 00784000
         SLR   @04,@04                                             0328 00785000
         IC    @04,$NONV                                           0328 00786000
         MR    @00,@04                                             0328 00787000
         LA    @04,CATRCTYP-5(@01)                                 0328 00788000
         CLC   ENTYPSAV(1),0(@04)                                  0328 00789000
         BNE   @RF00328                                            0328 00790000
@RT00328 DS    0H                                                  0329 00791000
*         DO ;                                                     0329 00792000
*           IOBUF(2,1:256) = IOBUF(BUFNO,1:256) ;                  0330 00793000
         L     @04,IOBFSPTR                                        0330 00794000
         SLR   @15,@15                                             0330 00795000
         IC    @15,BUFNO                                           0330 00796000
         SLA   @15,9                                               0330 00797000
         ST    @15,@TF00001                                        0330 00798000
         ALR   @15,@04                                             0330 00799000
         AL    @15,@CF01464                                        0330 00800000
         MVC   @TS00001(256),IOBUF(@15)                            0330 00801000
         MVC   IOBUF+512(256,@04),@TS00001                         0330 00802000
*           IOBUF(2,257:508) = IOBUF(BUFNO,257:508) ;              0331 00803000
         LR    @01,@04                                             0331 00804000
         AL    @01,@TF00001                                        0331 00805000
         AL    @01,@CF01465                                        0331 00806000
         MVC   @TS00001(252),IOBUF(@01)                            0331 00807000
         MVC   IOBUF+768(252,@04),@TS00001                         0331 00808000
*           IOBUFCI(BUFNO) = STENDCI ;                             0332 00809000
         AL    @04,@TF00001                                        0332 00810000
         AL    @04,@CF01466                                        0332 00811000
         MVC   IOBUFCI-509(3,@04),STENDCI                          0332 00812000
*           BUFNO = 2 ;                                            0333 00813000
         MVI   BUFNO,X'02'                                         0333 00814000
*         END ;                                                    0334 00815000
*       ELSE                                                       0335 00816000
*         IF ENTYPSAV = CATRCTYP($INDX)                            0335 00817000
*           THEN                                                   0335 00818000
         B     @RC00328                                            0335 00819000
@RF00328 SLR   @04,@04                                             0335 00820000
         IC    @04,$INDX                                           0335 00821000
         MH    @04,@CH00042                                        0335 00822000
         LA    @01,CATRCTYP-5(@04)                                 0335 00823000
         CLC   ENTYPSAV(1),0(@01)                                  0335 00824000
         BNE   @RF00335                                            0335 00825000
*             DO ;                                                 0336 00826000
*               IOBUF(3,1:256) = IOBUF(BUFNO,1:256) ;              0337 00827000
         L     @04,IOBFSPTR                                        0337 00828000
         SLR   @15,@15                                             0337 00829000
         IC    @15,BUFNO                                           0337 00830000
         SLA   @15,9                                               0337 00831000
         ST    @15,@TF00001                                        0337 00832000
         ALR   @15,@04                                             0337 00833000
         AL    @15,@CF01464                                        0337 00834000
         MVC   @TS00001(256),IOBUF(@15)                            0337 00835000
         MVC   IOBUF+1024(256,@04),@TS00001                        0337 00836000
*               IOBUF(3,257:508)=IOBUF(BUFNO,257:508) ;            0338 00837000
         LR    @01,@04                                             0338 00838000
         AL    @01,@TF00001                                        0338 00839000
         AL    @01,@CF01465                                        0338 00840000
         MVC   @TS00001(252),IOBUF(@01)                            0338 00841000
         MVC   IOBUF+1280(252,@04),@TS00001                        0338 00842000
*               IOBUFCI(BUFNO) = 'FFFFFF'X ;                       0339 00843000
         AL    @04,@TF00001                                        0339 00844000
         AL    @04,@CF01466                                        0339 00845000
         MVC   IOBUFCI-509(3,@04),@CF00897+1                       0339 00846000
*               BUFNO = 3 ;                                        0340 00847000
         MVI   BUFNO,X'03'                                         0340 00848000
*             END ;                                                0341 00849000
* IOBUFCI(BUFNO) = CIFRGET ;                                       0342 00850000
*                                                                  0342 00851000
@RF00335 DS    0H                                                  0342 00852000
@RC00328 DS    0H                                                  0342 00853000
@RC00321 SLR   @04,@04                                             0342 00854000
         IC    @04,BUFNO                                           0342 00855000
         SLA   @04,9                                               0342 00856000
         L     @01,IOBFSPTR                                        0342 00857000
         ALR   @01,@04                                             0342 00858000
         AL    @01,@CF01466                                        0342 00859000
         MVC   IOBUFCI-509(3,@01),CIFRGET                          0342 00860000
*END BUFSHUF ;                                                     0343 00861000
@EL00004 DS    0H                                                  0343 00862000
@EF00004 DS    0H                                                  0343 00863000
@ER00004 LM    @14,@12,@SA00004                                    0343 00864000
         BR    @14                                                 0343 00865000
* /*******************************************************************/ 00866000
* /* PROCEDURE NAME - CATOPEN                                        */ 00867000
* /* FUNCTION -                                                      */ 00868000
* /*   OPEN THE CATALOG AS A DATA SET, ISSUE A VERIFY FOR IT,        */ 00869000
* /*   USE FIELD MGMT TO GET CATALOG NAME FROM CLUSTER RCD,          */ 00870000
* /*   IF DOS GET VOLSER AND ENQ ON IT OR                            */ 00871000
* /*   IF OS GET UCB AND RESERVE ON SPECIAL NAME(MAJOR) AND          */ 00872000
* /*   CATALOG NAME(MINOR)                                           */ 00873000
* /* INPUTS -                                                        */ 00874000
* /*   CAT PARAMETERS IN THE FDT                                     */ 00875000
* /*   CATALOG                                                       */ 00876000
* /* OUTPUTS -                                                       */ 00877000
* /*   TESTRC                                                        */ 00878000
* /*   CMPR SET TO ZERO TO FORCE NOCOMPARE IF OPEN FAILS             */ 00879000
* /* CALLS -                                                         */ 00880000
* /*   UOPEN, UVERIFY, ONLY), ERROR,                                 */ 00881000
* /*   UENQ (DOS), USYSINFO AND URESERVE (OS)                        */ 00882000
* /*   IDCRC04(ENTNAME)                                              */ 00883000
* /*******************************************************************/ 00884000
*                                                                  0344 00885000
*CATOPEN: PROCEDURE ;                                              0344 00886000
CATOPEN  STM   @14,@12,@SA00005                                    0344 00887000
*   OLDERID2 = NEWERID2;                                           0345 00888000
         L     @02,@PC00001                                        0345 00889000
         L     @15,GDTTR2(,@02)                                    0345 00890000
         MVC   @TS00001(95),NEWERID2(@15)                          0345 00891000
         MVC   OLDERID2(95,@15),@TS00001                           0345 00892000
*   NEWID2 = 'LRCA' ;                                              0346 00893000
         MVC   NEWID2(4,@15),@CC01193                              0346 00894000
*   IF GDTDBG = NULLPTR                                            0347 00895000
*     THEN;                                                        0347 00896000
         L     @02,GDTDBG(,@02)                                    0347 00897000
         LTR   @02,@02                                             0347 00898000
         BZ    @RT00347                                            0347 00899000
*     ELSE                                                         0349 00900000
*       CALL IDCDB010 (GDTTBL,'LRCA') ;                            0349 00901000
*                                                                  0349 00902000
         L     @02,@PC00001                                        0349 00903000
         ST    @02,@AL00001                                        0349 00904000
         LA    @15,@CC01193                                        0349 00905000
         ST    @15,@AL00001+4                                      0349 00906000
         MVI   @AL00001+4,X'80'                                    0349 00907000
         L     @15,GDTDBG(,@02)                                    0349 00908000
         LA    @01,@AL00001                                        0349 00909000
         BALR  @14,@15                                             0349 00910000
*   OPNAGL = '0'B ;                /* SET UP TO DO OPEN              */ 00911000
@RT00347 XC    OPNAGL+1(47,OPNPTR),OPNAGL+1(OPNPTR)                0350 00912000
         MVI   OPNAGL(OPNPTR),B'00000000'                          0350 00913000
*    OPNOPTIN = ON ;            /* ACB - IN                       */    00914000
*    OPNOPTBK = ON ;            /* ACB - CNV (NOT A BLOCK)        */    00915000
*    OPNOPTDR = ON ;            /* ACB - DIR                      */    00916000
         OI    OPNOPTIN(OPNPTR),B'10010010'                        0353 00917000
*    OPNDSOAM = ON ;            /* DSORG - VSAM                   */    00918000
         OI    OPNDSOAM(OPNPTR),B'10000000'                        0354 00919000
*   OPNDDN = ADDR(CATDNVAL) ;      /* CATALOG DNAME                  */ 00920000
         L     @02,@PC00001+4                                      0355 00921000
         L     @01,FDTPTR+28(,@02)                                 0355 00922000
         LA    @15,CATDNVAL(,@01)                                  0355 00923000
         ST    @15,OPNDDN(,OPNPTR)                                 0355 00924000
*   OPNPWA = ADDR(CATNMPAS) ;      /* CATALOG,S PASSWORD             */ 00925000
         L     @02,FDTPTR+24(,@02)                                 0356 00926000
         LA    @02,CATNMPAS(,@02)                                  0356 00927000
         ST    @02,OPNPWA(,OPNPTR)                                 0356 00928000
*   OPNIOC = ADDR(IOCSCAT) ;       /* RETURN ADDR OF IOCS            */ 00929000
*                                                                  0357 00930000
         LA    @02,IOCSCAT                                         0357 00931000
         ST    @02,OPNIOC(,OPNPTR)                                 0357 00932000
*   CALL IDCIOOP0 (GDTTBL,OPNAGL) ;                                0358 00933000
*                                                                  0358 00934000
         L     @02,@PC00001                                        0358 00935000
         ST    @02,@AL00001                                        0358 00936000
         ST    OPNPTR,@AL00001+4                                   0358 00937000
         MVI   @AL00001+4,X'80'                                    0358 00938000
         L     @15,GDTOPN(,@02)                                    0358 00939000
         LA    @01,@AL00001                                        0358 00940000
         BALR  @14,@15                                             0358 00941000
*   RESPECIFY RTNREG RSTD;                                         0359 00942000
*   TESTRC = RTNREG;                                               0360 00943000
         STH   RTNREG,TESTRC                                       0360 00944000
*   RESPECIFY RTNREG UNRSTD ;                                      0361 00945000
*   IF TESTRC = 0                                                  0362 00946000
*     THEN                                                         0362 00947000
         LH    @02,TESTRC                                          0362 00948000
         LTR   @02,@02                                             0362 00949000
         BNZ   @RF00362                                            0362 00950000
*       DO ;                                                       0363 00951000
*         CATNMPAS = '0'B ;        /* MINIMIZ SECURITY EXPOSR        */ 00952000
         L     @02,@PC00001+4                                      0364 00953000
         L     @02,FDTPTR+24(,@02)                                 0364 00954000
         XC    CATNMPAS+1(7,@02),CATNMPAS+1(@02)                   0364 00955000
         MVI   CATNMPAS(@02),B'00000000'                           0364 00956000
*         DO BUFNO = 1 TO NBRBUF ; /* INITIALIZE BUFFER POOL         */ 00957000
         LA    @02,1                                               0365 00958000
         STC   @02,BUFNO                                           0365 00959000
@DL00365 DS    0H                                                  0366 00960000
*           IOCTBPTR -> IOBUFCI(BUFNO) = '7FFFFF'X ;               0366 00961000
         LR    @15,@02                                             0366 00962000
         SLA   @15,9                                               0366 00963000
         L     @01,IOCTBPTR                                        0366 00964000
         ALR   @01,@15                                             0366 00965000
         AL    @01,@CF01466                                        0366 00966000
         MVC   IOBUFCI-509(3,@01),@CF01194+1                       0366 00967000
*         END ;                    /* TO INVALID CI,S                */ 00968000
*                                                                  0367 00969000
         AL    @02,@CF00222                                        0367 00970000
         STC   @02,BUFNO                                           0367 00971000
         C     @02,@CF00047                                        0367 00972000
         BNH   @DL00365                                            0367 00973000
*         CALL IDCIOVY0 (GDTTBL,IOCSCAT);/*                        0368 00974000
*                                     NEVER CLOSED , FIND EOF        */ 00975000
*                                                                  0368 00976000
         L     @02,@PC00001                                        0368 00977000
         ST    @02,@AL00001                                        0368 00978000
         LA    @15,IOCSCAT                                         0368 00979000
         ST    @15,@AL00001+4                                      0368 00980000
         MVI   @AL00001+4,X'80'                                    0368 00981000
         L     @15,GDTVFY(,@02)                                    0368 00982000
         LA    @01,@AL00001                                        0368 00983000
         BALR  @14,@15                                             0368 00984000
*         RESPECIFY RTNREG RSTD;                                   0369 00985000
*         TESTRC = RTNREG;                                         0370 00986000
         STH   RTNREG,TESTRC                                       0370 00987000
*         RESPECIFY RTNREG UNRSTD ;                                0371 00988000
*         IF TESTRC ^= 0                                           0372 00989000
*          THEN                                            /*@OZ05923*/ 00990000
         LH    @02,TESTRC                                          0372 00991000
         LTR   @02,@02                                             0372 00992000
         BZ    @RF00372                                            0372 00993000
*             DO;                                          /*@OZ05923*/ 00994000
*             CALL ERROR (2,$RETURN) ;   /* VERIFY FAILURE   @OZ05923*/ 00995000
         LA    @01,@AL00374                                        0374 00996000
         BAL   @14,ERROR                                           0374 00997000
*             IOCSCAT->IOCMSGOP=ON;     /* SET OPEN BIT      @OZ05923*/ 00998000
         L     @02,IOCSCAT                                         0375 00999000
         OI    IOCMSGOP(@02),B'00100000'                           0375 01000000
*             END;                                         /*@OZ05923*/ 01001000
*         FMU1STIO = ON ;          /* SET FIELD MGMT TO GET          */ 01002000
@RF00372 OI    FMU1STIO,B'10000000'                                0377 01003000
*         FMUBFPTR = IOCTBPTR ;    /* CAT NAME FROM CLUS RCD         */ 01004000
         L     @02,IOCTBPTR                                        0378 01005000
         ST    @02,FMUBFPTR                                        0378 01006000
*         FMUIOCSI = IOCSCAT ;                                     0379 01007000
         L     @02,IOCSCAT                                         0379 01008000
         ST    @02,FMUIOCSI                                        0379 01009000
*         FMUCATIO = ON ;                                          0380 01010000
         OI    FMUCATIO,B'01000000'                                0380 01011000
*         FMPLBCIN = CRACLSCI ;                                    0381 01012000
         L     @02,FMPLAD                                          0381 01013000
         MVC   FMPLBCIN(3,@02),@CF00158+1                          0381 01014000
*         FMFLDNAM = ADDR('ENTNAME ') ;                            0382 01015000
         LA    @15,@CC01195                                        0382 01016000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0382 01017000
*         REG1 = FMPLAD ;                                          0383 01018000
*                                                                  0383 01019000
         LR    REG1,@02                                            0383 01020000
*         CALL IDCRC04 ;                                           0384 01021000
*                                                                  0384 01022000
         L     @15,@CV00793                                        0384 01023000
         BALR  @14,@15                                             0384 01024000
*         IF FMFLENTH ^= 0                                         0385 01025000
*           THEN CATNAME = ENTNAME ;                               0385 01026000
         L     @02,FMFLENTH(,FMFLCUR)                              0385 01027000
         LTR   @02,@02                                             0385 01028000
         BZ    @RF00385                                            0385 01029000
         L     @02,FMFLADDR(,FMFLCUR)                              0386 01030000
         MVC   CATNAME(44),ENTNAME(@02)                            0386 01031000
*           ELSE                                                   0387 01032000
*             DO ;                 /* FAILED, SET DUMMY NAME         */ 01033000
         B     @RC00385                                            0387 01034000
@RF00385 DS    0H                                                  0388 01035000
*               CATNAME = 'NAMEOFFIELDNOTRETURNED' ;               0388 01036000
         MVI   CATNAME+22,C' '                                     0388 01037000
         MVC   CATNAME+23(21),CATNAME+22                           0388 01038000
         MVC   CATNAME(22),@CC01196                                0388 01039000
*               PROCMSG='CATOPEN '; /* PROC NAME FOR INSERT  @OZ09388*/ 01040000
         MVC   PROCMSG(8),@CC01198                                 0389 01041000
*               CALL ERROR (1,$RETURN) ;                           0390 01042000
         LA    @01,@AL00390                                        0390 01043000
         BAL   @14,ERROR                                           0390 01044000
*             END ;                                                0391 01045000
*         FMPLBCIN = CTTBASE + 1 ; /* NO CTT, NO TRANSLATE           */ 01046000
@RC00385 L     @02,FMPLAD                                          0392 01047000
         MVC   FMPLBCIN(3,@02),@CF00038+1                          0392 01048000
*         REG1 = FMPLAD ;          /* GET VOLSER FOR DOS ENQ         */ 01049000
*                                                                  0393 01050000
         LR    REG1,@02                                            0393 01051000
*         CALL IDCRC04 ;                                           0394 01052000
*                                                                  0394 01053000
         L     @15,@CV00793                                        0394 01054000
         BALR  @14,@15                                             0394 01055000
*         IF FMFLENTH ^= 0                                         0395 01056000
*           THEN                                                   0395 01057000
         L     @02,FMFLENTH(,FMFLCUR)                              0395 01058000
         LTR   @02,@02                                             0395 01059000
         BZ    @RF00395                                            0395 01060000
*             DO ;                                                 0396 01061000
*                                                                  0396 01062000
*               CALL IDCSASI0 (GDTTBL,UNIT,RSVUTPTR,CATDNVAL) ;    0397 01063000
*                                                                  0397 01064000
         L     @02,@PC00001                                        0397 01065000
         ST    @02,@AL00001                                        0397 01066000
         LA    @15,UNIT                                            0397 01067000
         ST    @15,@AL00001+4                                      0397 01068000
         LA    @15,RSVUTPTR                                        0397 01069000
         ST    @15,@AL00001+8                                      0397 01070000
         L     @15,@PC00001+4                                      0397 01071000
         L     @01,FDTPTR+28(,@15)                                 0397 01072000
         LA    @15,CATDNVAL(,@01)                                  0397 01073000
         ST    @15,@AL00001+12                                     0397 01074000
         MVI   @AL00001+12,X'80'                                   0397 01075000
         L     @15,GDTSFO(,@02)                                    0397 01076000
         LA    @01,@AL00001                                        0397 01077000
         BALR  @14,@15                                             0397 01078000
*               RESPECIFY RTNREG RSTD;                             0398 01079000
*               TESTRC = RTNREG;                                   0399 01080000
         STH   RTNREG,TESTRC                                       0399 01081000
*               RESPECIFY RTNREG UNRSTD ;                          0400 01082000
*               IF TESTRC = 0                                      0401 01083000
*                 THEN                                             0401 01084000
         LH    @02,TESTRC                                          0401 01085000
         LTR   @02,@02                                             0401 01086000
         BNZ   @RF00401                                            0401 01087000
*                   DO ;                                           0402 01088000
*                     IF CATNAME(21) = ' '                         0403 01089000
*                       THEN CNLEN = 20 ;                          0403 01090000
         CLI   CATNAME+20,C' '                                     0403 01091000
         BNE   @RF00403                                            0403 01092000
         MVI   CNLEN,X'14'                                         0404 01093000
*                       ELSE CNLEN = 44 ;                          0405 01094000
*                                                                  0405 01095000
         B     @RC00403                                            0405 01096000
@RF00403 MVI   CNLEN,X'2C'                                         0405 01097000
*                     CALL IDCSARV0 (GDTTBL,EXCL,WAIT,             0406 01098000
*                               RSVUTPTR -> UNITUCB,               0406 01099000
*                               RSVMJNM,RSVMINM) ;                 0406 01100000
*                                                                  0406 01101000
@RC00403 L     @02,@PC00001                                        0406 01102000
         ST    @02,@AL00001                                        0406 01103000
         LA    @15,EXCL                                            0406 01104000
         ST    @15,@AL00001+4                                      0406 01105000
         LA    @15,WAIT                                            0406 01106000
         ST    @15,@AL00001+8                                      0406 01107000
         L     @01,RSVUTPTR                                        0406 01108000
         ST    @01,@AL00001+12                                     0406 01109000
         LA    @15,RSVMJNM                                         0406 01110000
         ST    @15,@AL00001+16                                     0406 01111000
         LA    @15,RSVMINM                                         0406 01112000
         ST    @15,@AL00001+20                                     0406 01113000
         MVI   @AL00001+20,X'80'                                   0406 01114000
         L     @15,GDTRSV(,@02)                                    0406 01115000
         LA    @01,@AL00001                                        0406 01116000
         BALR  @14,@15                                             0406 01117000
*                     RESPECIFY RTNREG RSTD;                       0407 01118000
*                     TESTRC = RTNREG;                             0408 01119000
         STH   RTNREG,TESTRC                                       0408 01120000
*                     RESPECIFY RTNREG UNRSTD ;                    0409 01121000
*                   END ;                                          0410 01122000
*             END ;                                                0411 01123000
@RF00401 DS    0H                                                  0412 01124000
*         IF FMFLENTH = 0 | TESTRC ^= 0                            0412 01125000
*           THEN CALL ERROR (3,$RETURN) ;    /* NO ENQ DONE          */ 01126000
@RF00395 SLR   @02,@02                                             0412 01127000
         C     @02,FMFLENTH(,FMFLCUR)                              0412 01128000
         BE    @RT00412                                            0412 01129000
         CH    @02,TESTRC                                          0412 01130000
         BE    @RF00412                                            0412 01131000
@RT00412 DS    0H                                                  0413 01132000
         LA    @01,@AL00413                                        0413 01133000
         BAL   @14,ERROR                                           0413 01134000
*         FMU1STIO = OFF ;                                         0414 01135000
@RF00412 NI    FMU1STIO,B'01111111'                                0414 01136000
*         FMUBFPTR = IOCRBPTR ;    /* RESTORE ASSUMED VALUES         */ 01137000
         L     @02,IOCRBPTR                                        0415 01138000
         ST    @02,FMUBFPTR                                        0415 01139000
*         FMUIOCSI = IOCSCRA ;                                     0416 01140000
         L     @02,IOCSCRA                                         0416 01141000
         ST    @02,FMUIOCSI                                        0416 01142000
*         FMUCATIO = OFF ;                                         0417 01143000
         NI    FMUCATIO,B'10111111'                                0417 01144000
*       END ;                                                      0418 01145000
*     ELSE                                                         0419 01146000
*       DO ;                                                       0419 01147000
         B     @RC00362                                            0419 01148000
@RF00362 DS    0H                                                  0420 01149000
*         CMPR = '0'B ;            /*FORCE NOCOMPARE HENCFRTH        */ 01150000
         L     @02,@PC00001+4                                      0420 01151000
         L     @02,FDTPTR+4(,@02)                                  0420 01152000
         SLR   @15,@15                                             0420 01153000
         ST    @15,CMPR(,@02)                                      0420 01154000
*         CMPRSW = OFF ;                                           0421 01155000
         NI    CMPRSW,B'10111111'                                  0421 01156000
*         CALL ERROR (4,$RETURN) ; /* TELL COMPARE IGNORED   */    0422 01157000
         LA    @01,@AL00422                                        0422 01158000
         BAL   @14,ERROR                                           0422 01159000
*       END ;                                                      0423 01160000
*                                                                  0423 01161000
*END CATOPEN ;                                                     0424 01162000
@EL00005 DS    0H                                                  0424 01163000
@EF00005 DS    0H                                                  0424 01164000
@ER00005 LM    @14,@12,@SA00005                                    0424 01165000
         BR    @14                                                 0424 01166000
* /*******************************************************************/ 01167000
* /* PROCEDURE NAME - CKEYRNG, CHECK FOR KEYRANGE                    */ 01168000
* /* FUNCTION -                                                      */ 01169000
* /*   DETERMINE NUMBER OF VOLUME OCCURANCES FOR LATER LOOP,         */ 01170000
* /*   CHECK TO SEE IF DATA OBJECT HAS A KEYRANGE DEFINED            */ 01171000
* /*   AND IF IT DOES SET UP TEXT PROCESSOR TO PRINT HIGHKEY         */ 01172000
* /* INPUTS -                                                        */ 01173000
* /*   CIFRGET (IDENTIFIES THE OBJECT RECORD)                        */ 01174000
* /* OUTPUTS -                                                       */ 01175000
* /*   NBRVOLOC                                                      */ 01176000
* /*   KEYRNGSW                                                      */ 01177000
* /*   A SECOND FMFL HOOKED UP FOR HIKEYV IF NEEDED                  */ 01178000
* /* CALLS -                                                         */ 01179000
* /*   ERROR,                                                        */ 01180000
* /*   IDCRC04(HIKEYV, REPNO)                                        */ 01181000
* /* CALLED BY -                                                     */ 01182000
* /*   PRTOJVL                                                       */ 01183000
* /*******************************************************************/ 01184000
*                                                                  0425 01185000
*CKEYRNG: PROCEDURE ;                                              0425 01186000
CKEYRNG  STM   @14,@02,@SA00006                                    0425 01187000
         STM   @04,@12,@SA00006+20                                 0425 01188000
* OLDERID2 = NEWERID2;                                             0426 01189000
         L     @15,@PC00001                                        0426 01190000
         L     @14,GDTTR2(,@15)                                    0426 01191000
         MVC   @TS00001(95),NEWERID2(@14)                          0426 01192000
         MVC   OLDERID2(95,@14),@TS00001                           0426 01193000
* NEWID2 = 'LRCK' ;                                                0427 01194000
         MVC   NEWID2(4,@14),@CC01203                              0427 01195000
* IF GDTDBG = NULLPTR                                              0428 01196000
*   THEN;                                                          0428 01197000
         L     @15,GDTDBG(,@15)                                    0428 01198000
         LTR   @15,@15                                             0428 01199000
         BZ    @RT00428                                            0428 01200000
*   ELSE                                                           0430 01201000
*     CALL IDCDB010 (GDTTBL,'LRCK') ;                              0430 01202000
*                                                                  0430 01203000
         L     @15,@PC00001                                        0430 01204000
         ST    @15,@AL00001                                        0430 01205000
         LA    @14,@CC01203                                        0430 01206000
         ST    @14,@AL00001+4                                      0430 01207000
         MVI   @AL00001+4,X'80'                                    0430 01208000
         L     @15,GDTDBG(,@15)                                    0430 01209000
         LA    @01,@AL00001                                        0430 01210000
         BALR  @14,@15                                             0430 01211000
* FMPLFLNO = 1 ;                   /* SOMEONE LEFT IT = 2            */ 01212000
@RT00428 L     @15,FMPLAD                                          0431 01213000
         MVI   FMPLFLNO(@15),X'01'                                 0431 01214000
* FMFLDNAM = ADDR('REPNO   ') ;                                    0432 01215000
         LA    @14,@CC01204                                        0432 01216000
         ST    @14,FMFLDNAM(,FMFLCUR)                              0432 01217000
* FMFLGRPC = CTVLOCGC ;                                            0433 01218000
         MVI   FMFLGRPC(FMFLCUR),X'03'                             0433 01219000
* FMPLFMFL(NBRFMFL) -> FMFLGRPC = CTVLOCGC ; /* RELREPNO TOO         */ 01220000
         L     @01,FMPLFMFL+16(,@15)                               0434 01221000
         MVI   FMFLGRPC(@01),X'03'                                 0434 01222000
* FMPLFMFL(NBRFMFL-1) -> FMFLGRPC = CTVLOCGC ;   /* CNTREPNO         */ 01223000
         L     @01,FMPLFMFL+12(,@15)                               0435 01224000
         MVI   FMFLGRPC(@01),X'03'                                 0435 01225000
* REG1 = FMPLAD ;                                                  0436 01226000
*                                                                  0436 01227000
         LR    REG1,@15                                            0436 01228000
* CALL IDCRC04 ;                                                   0437 01229000
*                                                                  0437 01230000
         L     @15,@CV00793                                        0437 01231000
         BALR  @14,@15                                             0437 01232000
* IF FMFLENTH ^= 0                 /* GET NUMBER OCCURANCES          */ 01233000
*   THEN NBRVOLOC = REPNO ;                                        0438 01234000
         L     @15,FMFLENTH(,FMFLCUR)                              0438 01235000
         LTR   @15,@15                                             0438 01236000
         BZ    @RF00438                                            0438 01237000
         L     @01,FMFLADDR(,FMFLCUR)                              0439 01238000
         LH    NBRVOLOC,REPNO(,@01)                                0439 01239000
*   ELSE                                                           0440 01240000
*     DO ;                         /* FIELD MGMT ERROR SO            */ 01241000
         B     @RC00438                                            0440 01242000
@RF00438 DS    0H                                                  0441 01243000
*       NBRVOLOC = 0 ;             /* IGNORE ALL VOLUMES             */ 01244000
         SLR   NBRVOLOC,NBRVOLOC                                   0441 01245000
*       PROCMSG='CKEYRNG ';        /* PROC NAME FOR INSERT   @OZ09388*/ 01246000
         MVC   PROCMSG(8),@CC01205                                 0442 01247000
*       CALL ERROR (27,$RETURN) ;                                  0443 01248000
         LA    @01,@AL00443                                        0443 01249000
         BAL   @14,ERROR                                           0443 01250000
*     END ;                                                        0444 01251000
* FMFLGRPC = '0'B ;                                                0445 01252000
@RC00438 MVI   FMFLGRPC(FMFLCUR),B'00000000'                       0445 01253000
* KEYRNGSW = OFF ;                 /* IGNORE FM ERROR                */ 01254000
         NI    KEYRNGSW,B'10111111'                                0446 01255000
* DARGCNT = 2 ;                    /* OR NO KEYRANGE                 */ 01256000
         L     @02,DDSTRU                                          0447 01257000
         MVC   DARGCNT(2,@02),@CH00158                             0447 01258000
* IF CTTENTYP(CIFRGET-CTTBASE) = CATRCTYP($DATA)                   0448 01259000
*   THEN                           /* DO KEYRANGE CHECK              */ 01260000
         L     @02,CIFRGET-1                                       0448 01261000
         LA    @02,0(,@02)                                         0448 01262000
         SLA   @02,3                                               0448 01263000
         SLR   @15,@15                                             0448 01264000
         IC    @15,$DATA                                           0448 01265000
         MH    @15,@CH00042                                        0448 01266000
         L     @01,CTTPTR                                          0448 01267000
         ALR   @01,@02                                             0448 01268000
         AL    @01,@CF01469                                        0448 01269000
         LA    @02,CATRCTYP-5(@15)                                 0448 01270000
         CLC   CTTENTYP-4(1,@01),0(@02)                            0448 01271000
         BNE   @RF00448                                            0448 01272000
*     DO ;                         /* ONLY IF DATA RECORD            */ 01273000
*       FMFLDNAM = ADDR('HIKEYV  ') ;                              0450 01274000
         LA    @02,@CC01207                                        0450 01275000
         ST    @02,FMFLDNAM(,FMFLCUR)                              0450 01276000
*       REG1 = FMPLAD ;                                            0451 01277000
*                                                                  0451 01278000
         L     REG1,FMPLAD                                         0451 01279000
*       CALL IDCRC04 ;             /* GET KEYRANGE IF ANY            */ 01280000
*                                                                  0452 01281000
         L     @15,@CV00793                                        0452 01282000
         BALR  @14,@15                                             0452 01283000
*       IF FMFLENTH ^= 0 & HIKEYLEN ^= 0                           0453 01284000
*         THEN                     /* THERE ARE KEYRANGES SO         */ 01285000
         SLR   @02,@02                                             0453 01286000
         C     @02,FMFLENTH(,FMFLCUR)                              0453 01287000
         BE    @RF00453                                            0453 01288000
         L     @01,FMFLADDR(,FMFLCUR)                              0453 01289000
         CH    @02,HIKEYLEN(,@01)                                  0453 01290000
         BE    @RF00453                                            0453 01291000
*           DO ;                   /* SET UP FOR PRINTING EM         */ 01292000
*             KEYRNGSW = ON ;                                      0455 01293000
         OI    KEYRNGSW,B'01000000'                                0455 01294000
*             DARGCNT = 3 ;                                        0456 01295000
         L     @02,DDSTRU                                          0456 01296000
         MVC   DARGCNT(2,@02),@CH00166                             0456 01297000
*             DARGINL(3) = LENGTH(VOLHD3) ;                        0457 01298000
         MVC   DARGINL+16(2,@02),@CH00039                          0457 01299000
*             DARGDTM(3) = ADDR(VOLHD3) ;                          0458 01300000
         LA    @15,VOLHD3                                          0458 01301000
         ST    @15,DARGDTM+16(,@02)                                0458 01302000
*             FMPLFLNO = 2 ;                                       0459 01303000
         L     @02,FMPLAD                                          0459 01304000
         MVI   FMPLFLNO(@02),X'02'                                 0459 01305000
*             FMPLFMFL(2) -> FMFLDNAM = ADDR('HIKEYV  ') ;         0460 01306000
         L     @02,FMPLFMFL+4(,@02)                                0460 01307000
         LA    @15,@CC01207                                        0460 01308000
         ST    @15,FMFLDNAM(,@02)                                  0460 01309000
*             FMPLFMFL(2) -> FMFLTCHN = ADDR(FMFLST(5)) ;          0461 01310000
         LA    @15,FMFLST+96                                       0461 01311000
         ST    @15,FMFLTCHN(,@02)                                  0461 01312000
*           END ;                                                  0462 01313000
*         ELSE ;                   /* TREAT ERR AS NO KEYRNG         */ 01314000
@RF00453 DS    0H                                                  0464 01315000
*     END ;                                                        0464 01316000
* FMFLDNAM = ADDR('VOLSER  ') ;                                    0465 01317000
*                                                                  0465 01318000
@RF00448 LA    @02,@CC01208                                        0465 01319000
         ST    @02,FMFLDNAM(,FMFLCUR)                              0465 01320000
*END CKEYRNG ;                                                     0466 01321000
@EL00006 DS    0H                                                  0466 01322000
@EF00006 DS    0H                                                  0466 01323000
@ER00006 LM    @14,@02,@SA00006                                    0466 01324000
         LM    @04,@12,@SA00006+20                                 0466 01325000
         BR    @14                                                 0466 01326000
* /*******************************************************************/ 01327000
* /* PROCEDURE NAME - CLEANUP                                        */ 01328000
* /* FUNCTION -                                                      */ 01329000
* /*   IF COMPARE CLOSE THE CATALOG AND                              */ 01330000
* /*   RELEASE SYSTEM LOCKOUT (UDEQ)                                 */ 01331000
* /*   PRINT THE FUNCTION COMPLETE MESSAGE,                          */ 01332000
* /*   FREE ALL GOTTEN MEMORY                                        */ 01333000
* /* INPUTS -                                                        */ 01334000
* /* OUTPUTS -                                                       */ 01335000
* /* CALLS -                                                         */ 01336000
* /*   UCLOSE, UDEQ, UPRINT, UFPOOL                                  */ 01337000
* /*******************************************************************/ 01338000
*                                                                  0467 01339000
*CLEANUP: PROCEDURE ;                                              0467 01340000
CLEANUP  STM   @14,@12,@SA00007                                    0467 01341000
* OLDERID2 = NEWERID2;                                             0468 01342000
         L     @04,@PC00001                                        0468 01343000
         L     @15,GDTTR2(,@04)                                    0468 01344000
         MVC   @TS00001(95),NEWERID2(@15)                          0468 01345000
         MVC   OLDERID2(95,@15),@TS00001                           0468 01346000
* NEWID2 = 'LRC1' ;                                                0469 01347000
         MVC   NEWID2(4,@15),@CC01212                              0469 01348000
* IF GDTDBG = NULLPTR                                              0470 01349000
*   THEN;                                                          0470 01350000
         L     @04,GDTDBG(,@04)                                    0470 01351000
         LTR   @04,@04                                             0470 01352000
         BZ    @RT00470                                            0470 01353000
*   ELSE                                                           0472 01354000
*     CALL IDCDB010 (GDTTBL,'LRC1') ;                              0472 01355000
*                                                                  0472 01356000
         L     @04,@PC00001                                        0472 01357000
         ST    @04,@AL00001                                        0472 01358000
         LA    @15,@CC01212                                        0472 01359000
         ST    @15,@AL00001+4                                      0472 01360000
         MVI   @AL00001+4,X'80'                                    0472 01361000
         L     @15,GDTDBG(,@04)                                    0472 01362000
         LA    @01,@AL00001                                        0472 01363000
         BALR  @14,@15                                             0472 01364000
* IF CMPRSW = ON                                                   0473 01365000
*   THEN                                                           0473 01366000
@RT00470 TM    CMPRSW,B'01000000'                                  0473 01367000
         BNO   @RF00473                                            0473 01368000
*     DO ;                                                         0474 01369000
*                                                                  0474 01370000
*       CALL IDCIOCL0 (GDTTBL,IOCSCAT) ;                           0475 01371000
*                                                                  0475 01372000
         L     @04,@PC00001                                        0475 01373000
         ST    @04,@AL00001                                        0475 01374000
         LA    @15,IOCSCAT                                         0475 01375000
         ST    @15,@AL00001+4                                      0475 01376000
         MVI   @AL00001+4,X'80'                                    0475 01377000
         L     @15,GDTCLS(,@04)                                    0475 01378000
         LA    @01,@AL00001                                        0475 01379000
         BALR  @14,@15                                             0475 01380000
*       CALL IDCSADQ0 (GDTTBL,RSVMJNM,RSVMINM) ;                   0476 01381000
*                                                                  0476 01382000
         L     @04,@PC00001                                        0476 01383000
         ST    @04,@AL00001                                        0476 01384000
         LA    @15,RSVMJNM                                         0476 01385000
         ST    @15,@AL00001+4                                      0476 01386000
         LA    @15,RSVMINM                                         0476 01387000
         ST    @15,@AL00001+8                                      0476 01388000
         MVI   @AL00001+8,X'80'                                    0476 01389000
         L     @15,GDTDEQ(,@04)                                    0476 01390000
         LA    @01,@AL00001                                        0476 01391000
         BALR  @14,@15                                             0476 01392000
*     END ;                                                        0477 01393000
*                                                                  0477 01394000
* IF IOCSALT ^= NULLPTR                                     /*OZ07569*/ 01395000
*   THEN                                                    /*OZ07569*/ 01396000
*                                                                  0478 01397000
@RF00473 L     @04,IOCSALT                                         0478 01398000
         LTR   @04,@04                                             0478 01399000
         BZ    @RF00478                                            0478 01400000
*       CALL IDCIOCL0 (GDTTBL,IOCSALT) ;                    /*OZ07569*/ 01401000
*                                                                  0479 01402000
         L     @04,@PC00001                                        0479 01403000
         ST    @04,@AL00001                                        0479 01404000
         LA    @15,IOCSALT                                         0479 01405000
         ST    @15,@AL00001+4                                      0479 01406000
         MVI   @AL00001+4,X'80'                                    0479 01407000
         L     @15,GDTCLS(,@04)                                    0479 01408000
         LA    @01,@AL00001                                        0479 01409000
         BALR  @14,@15                                             0479 01410000
* DARGLIST = '0'B ;                                                0480 01411000
@RF00478 L     @04,DDSTRU                                          0480 01412000
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0480 01413000
         MVI   DARGLIST(@04),B'00000000'                           0480 01414000
* DARGSMOD = 'UV0' ;                                               0481 01415000
         MVC   DARGSMOD(3,@04),@CC00777                            0481 01416000
* DARGSENT = 1 ;                                                   0482 01417000
         MVI   DARGSENT(@04),X'01'                                 0482 01418000
* DARGILP = LENGTH(LRLASTCC) ;                                     0483 01419000
         MVC   DARGILP(2,@04),@CH00158                             0483 01420000
* DARGDBP = ADDR(LRLASTCC) ;                                       0484 01421000
*                                                                  0484 01422000
         LA    @15,LRLASTCC                                        0484 01423000
         ST    @15,DARGDBP(,@04)                                   0484 01424000
* CALL AMSTP011 (GDTTBL,0,DDSTRU) ;                                0485 01425000
         L     @04,@PC00001                                        0485 01426000
         ST    @04,@AL00001                                        0485 01427000
         LA    @15,@CF00120                                        0485 01428000
         ST    @15,@AL00001+4                                      0485 01429000
         LA    @15,DDSTRU                                          0485 01430000
         ST    @15,@AL00001+8                                      0485 01431000
         MVI   @AL00001+8,X'80'                                    0485 01432000
         L     @15,GDTPRT(,@04)                                    0485 01433000
         LA    @01,@AL00001                                        0485 01434000
         BALR  @14,@15                                             0485 01435000
*                                                           /*OZ30449*/ 01436000
* CALL IDCSAFP0 (GDTTBL,MODID,ALL) ;                               0486 01437000
*                                                                  0486 01438000
         MVC   @AL00001+4(8),@AL00486                              0486 01439000
         L     @04,@PC00001                                        0486 01440000
         ST    @04,@AL00001                                        0486 01441000
         L     @15,GDTFPL(,@04)                                    0486 01442000
         LA    @01,@AL00001                                        0486 01443000
         BALR  @14,@15                                             0486 01444000
*END CLEANUP ;                                                     0487 01445000
@EL00007 DS    0H                                                  0487 01446000
@EF00007 DS    0H                                                  0487 01447000
@ER00007 LM    @14,@12,@SA00007                                    0487 01448000
         BR    @14                                                 0487 01449000
* /*******************************************************************/ 01450000
* /* PROCEDURE NAME - CLENCRA                                        */ 01451000
* /* FUNCTION -                                                      */ 01452000
* /*   CLOSE THE CRA,                                                */ 01453000
* /*   FREE UP STORAGE OBTAINED FOR THIS CRA ONLY,                   */ 01454000
* /*   PRINT MESSAGES ABOUT NUMBER OF MISCOMPARES AS A               */ 01455000
* /*   COMPLETION MESSAGE                                            */ 01456000
* /* INPUTS -                                                        */ 01457000
* /* OUTPUTS -                                                       */ 01458000
* /* CALLS -                                                         */ 01459000
* /*   UCLOSE, UFPOOL, SUMIT, UPRINT                                 */ 01460000
* /*******************************************************************/ 01461000
*                                                                  0488 01462000
*CLENCRA: PROCEDURE ;                                              0488 01463000
CLENCRA  STM   @14,@12,@SA00008                                    0488 01464000
* OLDERID2 = NEWERID2;                                             0489 01465000
         L     @04,@PC00001                                        0489 01466000
         L     @15,GDTTR2(,@04)                                    0489 01467000
         MVC   @TS00001(95),NEWERID2(@15)                          0489 01468000
         MVC   OLDERID2(95,@15),@TS00001                           0489 01469000
* NEWID2 = 'LRC2' ;                                                0490 01470000
         MVC   NEWID2(4,@15),@CC01216                              0490 01471000
* IF GDTDBG = NULLPTR                                              0491 01472000
*   THEN;                                                          0491 01473000
         L     @04,GDTDBG(,@04)                                    0491 01474000
         LTR   @04,@04                                             0491 01475000
         BZ    @RT00491                                            0491 01476000
*   ELSE                                                           0493 01477000
*     CALL IDCDB010 (GDTTBL,'LRC2') ;                              0493 01478000
*                                                                  0493 01479000
         L     @04,@PC00001                                        0493 01480000
         ST    @04,@AL00001                                        0493 01481000
         LA    @15,@CC01216                                        0493 01482000
         ST    @15,@AL00001+4                                      0493 01483000
         MVI   @AL00001+4,X'80'                                    0493 01484000
         L     @15,GDTDBG(,@04)                                    0493 01485000
         LA    @01,@AL00001                                        0493 01486000
         BALR  @14,@15                                             0493 01487000
* CALL IDCIOCL0 (GDTTBL,IOCSCRA) ;                                 0494 01488000
*                                                                  0494 01489000
@RT00491 L     @04,@PC00001                                        0494 01490000
         ST    @04,@AL00001                                        0494 01491000
         LA    @15,IOCSCRA                                         0494 01492000
         ST    @15,@AL00001+4                                      0494 01493000
         MVI   @AL00001+4,X'80'                                    0494 01494000
         L     @15,GDTCLS(,@04)                                    0494 01495000
         LA    @01,@AL00001                                        0494 01496000
         BALR  @14,@15                                             0494 01497000
* CALL IDCSAFP0 (GDTTBL,MODIDCTT) ;                                0495 01498000
*                                                                  0495 01499000
         L     @04,@PC00001                                        0495 01500000
         ST    @04,@AL00001                                        0495 01501000
         LA    @15,MODIDCTT                                        0495 01502000
         ST    @15,@AL00001+4                                      0495 01503000
         MVI   @AL00001+4,X'80'                                    0495 01504000
         L     @15,GDTFPL(,@04)                                    0495 01505000
         LA    @01,@AL00001                                        0495 01506000
         BALR  @14,@15                                             0495 01507000
* IF SDUMPSW ^= ON                                                 0496 01508000
*                                                                  0496 01509000
*   THEN CALL SUMIT(SMPRINT) ;                                     0496 01510000
*                                                                  0496 01511000
         TM    SDUMPSW,B'00000010'                                 0496 01512000
         BO    @RF00496                                            0496 01513000
         LA    @01,@AL00497                                        0497 01514000
         BAL   @14,SUMIT                                           0497 01515000
* IF CMPRSW = ON                                                   0498 01516000
*   THEN                                                           0498 01517000
@RF00496 TM    CMPRSW,B'01000000'                                  0498 01518000
         BNO   @RF00498                                            0498 01519000
*     DO ;                                                         0499 01520000
*       DARGLIST = '0'B ;                                          0500 01521000
         L     @04,DDSTRU                                          0500 01522000
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0500 01523000
         MVI   DARGLIST(@04),B'00000000'                           0500 01524000
*       DARGSMOD = 'LR1' ;                                         0501 01525000
         MVC   DARGSMOD(3,@04),@CC00775                            0501 01526000
*       DARGSENT = 16 ;                                            0502 01527000
         MVI   DARGSENT(@04),X'10'                                 0502 01528000
*       DARGCNT = 1 ;                                              0503 01529000
         LA    @15,1                                               0503 01530000
         STH   @15,DARGCNT(,@04)                                   0503 01531000
*       DARGINS(1) = 1 ;                                           0504 01532000
         STH   @15,DARGINS(,@04)                                   0504 01533000
*       DARGINL(1) = LENGTH(MCENTCNT) ;                            0505 01534000
         MVC   DARGINL(2,@04),@CH00158                             0505 01535000
*       DARGDTM(1) = ADDR(MCENTCNT) ;                              0506 01536000
         LA    @15,MCENTCNT                                        0506 01537000
         ST    @15,DARGDTM(,@04)                                   0506 01538000
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    0507 01539000
         L     @04,@PC00001                                        0507 01540000
         ST    @04,@AL00001                                        0507 01541000
         LA    @15,IOCSPRT                                         0507 01542000
         ST    @15,@AL00001+4                                      0507 01543000
         LA    @15,DDSTRU                                          0507 01544000
         ST    @15,@AL00001+8                                      0507 01545000
         MVI   @AL00001+8,X'80'                                    0507 01546000
         L     @15,GDTPRT(,@04)                                    0507 01547000
         LA    @01,@AL00001                                        0507 01548000
         BALR  @14,@15                                             0507 01549000
*       DARGSENT = 8 ;                                             0508 01550000
         L     @04,DDSTRU                                          0508 01551000
         MVI   DARGSENT(@04),X'08'                                 0508 01552000
*       DARGINL(1) = LENGTH(MCRCDCNT) ;                            0509 01553000
         MVC   DARGINL(2,@04),@CH00158                             0509 01554000
*       DARGDTM(1) = ADDR(MCRCDCNT) ;                              0510 01555000
         LA    @15,MCRCDCNT                                        0510 01556000
         ST    @15,DARGDTM(,@04)                                   0510 01557000
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    0511 01558000
         L     @04,@PC00001                                        0511 01559000
         ST    @04,@AL00001                                        0511 01560000
         LA    @15,IOCSPRT                                         0511 01561000
         ST    @15,@AL00001+4                                      0511 01562000
         LA    @15,DDSTRU                                          0511 01563000
         ST    @15,@AL00001+8                                      0511 01564000
         MVI   @AL00001+8,X'80'                                    0511 01565000
         L     @15,GDTPRT(,@04)                                    0511 01566000
         LA    @01,@AL00001                                        0511 01567000
         BALR  @14,@15                                             0511 01568000
*       IF MCRCDCNT > 0 & LRLASTCC < 4                             0512 01569000
*         THEN LRLASTCC = 4 ;                                      0512 01570000
         CLC   MCRCDCNT(2),@CH00120                                0512 01571000
         BNH   @RF00512                                            0512 01572000
         LA    @04,4                                               0512 01573000
         CH    @04,LRLASTCC                                        0512 01574000
         BNH   @RF00512                                            0512 01575000
         STH   @04,LRLASTCC                                        0513 01576000
*     END ;                                                        0514 01577000
*                                                                  0514 01578000
*END CLENCRA ;                                                     0515 01579000
@EL00008 DS    0H                                                  0515 01580000
@EF00008 DS    0H                                                  0515 01581000
@ER00008 LM    @14,@12,@SA00008                                    0515 01582000
         BR    @14                                                 0515 01583000
* /*******************************************************************/ 01584000
* /* PROCEDURE NAME - CRAOPEN                                        */ 01585000
* /* FUNCTION -                                                      */ 01586000
* /*   INITIALIZATION INCLUDING BASIC SUBTITLE,                      */ 01587000
* /*   OPEN AND VERIFY A CRA,                                        */ 01588000
* /*   IF COMPARE VERIFY THAT THE OPEN CATALOG IS THE OWNER          */ 01589000
* /*   OF THIS CRA,                                                  */ 01590000
* /*   IF NOT RUNNING UNDER TSO                                      */ 01591000
* /*     INITIALIZE TEXT PROCESSOR SUBTITLE LINE WITH VOLSER,        */ 01592000
* /*   CALL CTTBLD TO GET STORAGE FOR AND BUILD THE CRA TO           */ 01593000
* /*   CATALOG CI TRANSLATE TABLE                                    */ 01594000
* /* INPUTS -                                                        */ 01595000
* /*   DNAME IN THE FDT INFILE LIST                                  */ 01596000
* /*   CRA                                                           */ 01597000
* /* OUTPUTS -                                                       */ 01598000
* /*   CRAOPNSW (NOT ON CAUSES CRA TO BE BYPASSED)                   */ 01599000
* /*   CTT                                                           */ 01600000
* /* CALLS -                                                         */ 01601000
* /*   UESTA, UOPEN, UVERIFY, UREST, CTTBLD, ERROR,                  */ 01602000
* /*   IDCRC04(ENTNAME)                                              */ 01603000
* /*******************************************************************/ 01604000
*                                                                  0516 01605000
*CRAOPEN: PROCEDURE ;                                              0516 01606000
CRAOPEN  STM   @14,@12,@SA00009                                    0516 01607000
*   OLDERID2 = NEWERID2;                                           0517 01608000
         L     @02,@PC00001                                        0517 01609000
         L     @15,GDTTR2(,@02)                                    0517 01610000
         MVC   @TS00001(95),NEWERID2(@15)                          0517 01611000
         MVC   OLDERID2(95,@15),@TS00001                           0517 01612000
*   NEWID2 = 'LRCR' ;                                              0518 01613000
         MVC   NEWID2(4,@15),@CC01221                              0518 01614000
*   IF GDTDBG = NULLPTR                                            0519 01615000
*     THEN;                                                        0519 01616000
         L     @02,GDTDBG(,@02)                                    0519 01617000
         LTR   @02,@02                                             0519 01618000
         BZ    @RT00519                                            0519 01619000
*     ELSE                                                         0521 01620000
*       CALL IDCDB010 (GDTTBL,'LRCR') ;                            0521 01621000
*                                                                  0521 01622000
         L     @02,@PC00001                                        0521 01623000
         ST    @02,@AL00001                                        0521 01624000
         LA    @15,@CC01221                                        0521 01625000
         ST    @15,@AL00001+4                                      0521 01626000
         MVI   @AL00001+4,X'80'                                    0521 01627000
         L     @15,GDTDBG(,@02)                                    0521 01628000
         LA    @01,@AL00001                                        0521 01629000
         BALR  @14,@15                                             0521 01630000
*   CRAOPNSW = OFF ;                                               0522 01631000
@RT00519 NI    CRAOPNSW,B'11101111'                                0522 01632000
*   FMUCTTP = '0'B ;               /* TURN CI TRANSLATE OFF          */ 01633000
         SLR   @02,@02                                             0523 01634000
         ST    @02,FMUCTTP                                         0523 01635000
*                                  /* IN IDCLR02 (PRE CTT)           */ 01636000
*   MCRCDCNT = 0 ;                 /* MISCMPR RECORD COUNT           */ 01637000
         SLR   @02,@02                                             0524 01638000
         STH   @02,MCRCDCNT                                        0524 01639000
*   MCENTCNT = 0 ;                 /* MISCMPR ENTRY COUNT            */ 01640000
         STH   @02,MCENTCNT                                        0525 01641000
*   INDNTCOL = 0 ;                                                 0526 01642000
         MVI   INDNTCOL,X'00'                                      0526 01643000
*   SUBTVLSR = '......' ;          /* VOLSER FOR ERRORS              */ 01644000
         MVC   SUBTVLSR(6),@CC01222                                0527 01645000
*   SUBGROUP = 'VSAM ENTRIES' ;                                    0528 01646000
         MVI   SUBGROUP+12,C' '                                    0528 01647000
         MVC   SUBGROUP+13(3),SUBGROUP+12                          0528 01648000
         MVC   SUBGROUP(12),@CC01223                               0528 01649000
*   IF GDTECT = NULLPTR            /* IF NOT RUNNING UNDER TSO       */ 01650000
*      & SBTSETSW = OFF            /* AND SUBTITLE NOT YET SET       */ 01651000
*                                                                  0529 01652000
*     THEN CALL AMSTP042 (GDTTBL,IOCSPRT,PCARGLST) ;/*             0529 01653000
*                                               SET UP HEADER        */ 01654000
*                                                                  0529 01655000
         L     @15,@PC00001                                        0529 01656000
         C     @02,GDTECT(,@15)                                    0529 01657000
         BNE   @RF00529                                            0529 01658000
         TM    SBTSETSW,B'00000100'                                0529 01659000
         BNZ   @RF00529                                            0529 01660000
         ST    @15,@AL00001                                        0530 01661000
         LA    @02,IOCSPRT                                         0530 01662000
         ST    @02,@AL00001+4                                      0530 01663000
         LA    @02,PCARGLST                                        0530 01664000
         ST    @02,@AL00001+8                                      0530 01665000
         L     @15,GDTESA(,@15)                                    0530 01666000
         LA    @01,@AL00001                                        0530 01667000
         BALR  @14,@15                                             0530 01668000
*   SBTSETSW = ON ;                                                0531 01669000
@RF00529 OI    SBTSETSW,B'00000100'                                0531 01670000
*   IF ADDR(CMPR) ^= '0'B                                          0532 01671000
*     THEN CMPRSW = ON ;                                           0532 01672000
         L     @02,@PC00001+4                                      0532 01673000
         L     @02,FDTPTR+4(,@02)                                  0532 01674000
         LTR   @02,@02                                             0532 01675000
         BZ    @RF00532                                            0532 01676000
         OI    CMPRSW,B'01000000'                                  0533 01677000
*     ELSE CMPRSW = OFF ;                                          0534 01678000
         B     @RC00532                                            0534 01679000
@RF00532 NI    CMPRSW,B'10111111'                                  0534 01680000
*   OPNAGL = '0'B ;                /* SET UP TO DO OPEN              */ 01681000
@RC00532 XC    OPNAGL+1(47,OPNPTR),OPNAGL+1(OPNPTR)                0535 01682000
         MVI   OPNAGL(OPNPTR),B'00000000'                          0535 01683000
*   OPNOPTIN = ON ;                /* ACB - IN                       */ 01684000
*   OPNOPTBK = ON ;                /* ACB - CNV (NOT A BLOCK)        */ 01685000
*   OPNOPTDR = ON ;                /* ACB - DIR                      */ 01686000
         OI    OPNOPTIN(OPNPTR),B'10010010'                        0538 01687000
*   OPNDSOAM = ON ;                /* DSORG - VSAM                   */ 01688000
         OI    OPNDSOAM(OPNPTR),B'10000000'                        0539 01689000
*   OPNTYPRA = ON ;                /* CATALOG RECOVERY AREA          */ 01690000
         OI    OPNTYPRA(OPNPTR),B'00001000'                        0540 01691000
*   OPNDDN = ADDR(IFILEVAL(CRACNT)) ;   /* CRA DNAME                 */ 01692000
         L     @02,CRACNT-1                                        0541 01693000
         LA    @02,0(,@02)                                         0541 01694000
         MH    @02,@CH00037                                        0541 01695000
         L     @15,@PC00001+4                                      0541 01696000
         L     @01,FDTPTR(,@15)                                    0541 01697000
         AL    @01,@CF01473                                        0541 01698000
         LA    @02,IFILEVAL-3(@02,@01)                             0541 01699000
         ST    @02,OPNDDN(,OPNPTR)                                 0541 01700000
*   IF MRPWLEN ^= '0'B                                             0542 01701000
*     THEN OPNPWA = ADDR(MRPWVAL) ;/* MASTER CAT,S PASSWORD          */ 01702000
         L     @02,FDTPTR+32(,@15)                                 0542 01703000
         CLI   MRPWLEN(@02),0                                      0542 01704000
         BE    @RF00542                                            0542 01705000
         LA    @02,MRPWVAL(,@02)                                   0543 01706000
         ST    @02,OPNPWA(,OPNPTR)                                 0543 01707000
*   OPNIOC = ADDR(IOCSCRA) ;       /* RETURN ADDR OF IOCS            */ 01708000
*                                                                  0544 01709000
@RF00542 LA    @02,IOCSCRA                                         0544 01710000
         ST    @02,OPNIOC(,OPNPTR)                                 0544 01711000
*   CALL IDCIOOP0 (GDTTBL,OPNAGL,0) ;/*                            0545 01712000
*                                     3RD PARM REQD BY UOPEN         */ 01713000
*                                                                  0545 01714000
         L     @02,@PC00001                                        0545 01715000
         ST    @02,@AL00001                                        0545 01716000
         ST    OPNPTR,@AL00001+4                                   0545 01717000
         LA    @15,@CF00120                                        0545 01718000
         ST    @15,@AL00001+8                                      0545 01719000
         MVI   @AL00001+8,X'80'                                    0545 01720000
         L     @15,GDTOPN(,@02)                                    0545 01721000
         LA    @01,@AL00001                                        0545 01722000
         BALR  @14,@15                                             0545 01723000
*   RESPECIFY RTNREG RSTD;                                         0546 01724000
*   TESTRC = RTNREG;                                               0547 01725000
         STH   RTNREG,TESTRC                                       0547 01726000
*   RESPECIFY RTNREG UNRSTD ;                                      0548 01727000
*   IF TESTRC = 0                                                  0549 01728000
*     THEN                                                         0549 01729000
         LH    @02,TESTRC                                          0549 01730000
         LTR   @02,@02                                             0549 01731000
         BNZ   @RF00549                                            0549 01732000
*       DO ;                                                       0550 01733000
*         CRAOPNSW = ON ;                                          0551 01734000
         OI    CRAOPNSW,B'00010000'                                0551 01735000
*         DO BUFNO = 1 TO NBRBUF ; /* INITIALIZE BUFFER POOL         */ 01736000
         LA    @02,1                                               0552 01737000
         STC   @02,BUFNO                                           0552 01738000
@DL00552 DS    0H                                                  0553 01739000
*           IOBUFCI(BUFNO) = '7FFFFF'X ;                           0553 01740000
         LR    @15,@02                                             0553 01741000
         SLA   @15,9                                               0553 01742000
         L     @01,IOBFSPTR                                        0553 01743000
         ALR   @01,@15                                             0553 01744000
         AL    @01,@CF01466                                        0553 01745000
         MVC   IOBUFCI-509(3,@01),@CF01194+1                       0553 01746000
*         END ;                    /* TO INVALID CI,S AND SET        */ 01747000
         AL    @02,@CF00222                                        0554 01748000
         STC   @02,BUFNO                                           0554 01749000
         C     @02,@CF00047                                        0554 01750000
         BNH   @DL00552                                            0554 01751000
*         FMU1STIO = ON ;          /* SW FOR LR02 FLDMGMT I/O        */ 01752000
         OI    FMU1STIO,B'10000000'                                0555 01753000
*         FMUIOCSI = IOCSCRA ;                                     0556 01754000
*                                                                  0556 01755000
         L     @02,IOCSCRA                                         0556 01756000
         ST    @02,FMUIOCSI                                        0556 01757000
*         CALL IDCIOVY0 (GDTTBL,IOCSCRA) ;                         0557 01758000
*                                                                  0557 01759000
         L     @02,@PC00001                                        0557 01760000
         ST    @02,@AL00001                                        0557 01761000
         LA    @15,IOCSCRA                                         0557 01762000
         ST    @15,@AL00001+4                                      0557 01763000
         MVI   @AL00001+4,X'80'                                    0557 01764000
         L     @15,GDTVFY(,@02)                                    0557 01765000
         LA    @01,@AL00001                                        0557 01766000
         BALR  @14,@15                                             0557 01767000
*         RESPECIFY RTNREG RSTD;                                   0558 01768000
*         TESTRC = RTNREG;                                         0559 01769000
         STH   RTNREG,TESTRC                                       0559 01770000
*         RESPECIFY RTNREG UNRSTD ;                                0560 01771000
*         IF TESTRC ^= 0                                           0561 01772000
*           THEN                                                   0561 01773000
         LH    @02,TESTRC                                          0561 01774000
         LTR   @02,@02                                             0561 01775000
         BZ    @RF00561                                            0561 01776000
*             DO ;                                                 0562 01777000
*               CALL ERROR (8,$RETURN) ;     /* VERIFY FAILUR        */ 01778000
         LA    @01,@AL00563                                        0563 01779000
         BAL   @14,ERROR                                           0563 01780000
*               TESTRC = 0 ;                                       0564 01781000
         SLR   @02,@02                                             0564 01782000
         STH   @02,TESTRC                                          0564 01783000
*               IOCSCRA->IOCMSGOP=ON; /* SET OPEN BIT ON     @OZ05923*/ 01784000
         L     @02,IOCSCRA                                         0565 01785000
         OI    IOCMSGOP(@02),B'00100000'                           0565 01786000
*             END ;                                                0566 01787000
*         IF CMPRSW = ON                                           0567 01788000
*           THEN                                                   0567 01789000
@RF00561 TM    CMPRSW,B'01000000'                                  0567 01790000
         BNO   @RF00567                                            0567 01791000
*             DO ;                                                 0568 01792000
*               FMPLBCIN = 0 ;     /* ASK OWNING CATALOG,S           */ 01793000
         L     @02,FMPLAD                                          0569 01794000
         SLR   @15,@15                                             0569 01795000
         STCM  @15,7,FMPLBCIN(@02)                                 0569 01796000
*               FMFLDNAM = ADDR       ('ENTNAME ') ;               0570 01797000
         LA    @15,@CC01195                                        0570 01798000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0570 01799000
*               REG1 = FMPLAD ;                                    0571 01800000
*                                                                  0571 01801000
         LR    REG1,@02                                            0571 01802000
*               CALL IDCRC04 ;                                     0572 01803000
*                                                                  0572 01804000
         L     @15,@CV00793                                        0572 01805000
         BALR  @14,@15                                             0572 01806000
*               IF FMFLENTH ^= 0                                   0573 01807000
*                 THEN                                             0573 01808000
         L     @02,FMFLENTH(,FMFLCUR)                              0573 01809000
         LTR   @02,@02                                             0573 01810000
         BZ    @RF00573                                            0573 01811000
*                   IF CATNAME = ENTNAME                           0574 01812000
*                     THEN ;       /* AOK, RIGHT OWNER               */ 01813000
         L     @02,FMFLADDR(,FMFLCUR)                              0574 01814000
         CLC   CATNAME(44),ENTNAME(@02)                            0574 01815000
         BE    @RT00574                                            0574 01816000
*                     ELSE         /* WRONG NAME, DID OPENCAT        */ 01817000
*                                  /* GETNAME FAIL ALSO              */ 01818000
*                       IF CATNAME(1:14) = 'NAMEOFFIELDNOT'        0576 01819000
*                         THEN ;   /* YES, DO THE CMPR ANYWAY        */ 01820000
         CLC   CATNAME(14),@CC01226                                0576 01821000
         BE    @RT00576                                            0576 01822000
*                         ELSE     /* NO, THEN WRONG CATALOG         */ 01823000
*                           DO ;                                   0578 01824000
*                             CATNMCRA = ENTNAME ; /*ERR PRNT        */ 01825000
         L     @02,FMFLADDR(,FMFLCUR)                              0579 01826000
         MVC   CATNMCRA(44),ENTNAME(@02)                           0579 01827000
*                             CALL ERROR (6,$RETURN) ;             0580 01828000
         LA    @01,@AL00580                                        0580 01829000
         BAL   @14,ERROR                                           0580 01830000
*                                  /* CAT DOES NOT OWN CRA           */ 01831000
*                             CMPRSW = OFF ;     /*ABORT CMPR        */ 01832000
         NI    CMPRSW,B'10111111'                                  0581 01833000
*                             CALL ERROR (10,$RETURN) ;            0582 01834000
         LA    @01,@AL00582                                        0582 01835000
         BAL   @14,ERROR                                           0582 01836000
*                           END ;                                  0583 01837000
*                 ELSE                                     /*@OZ09388*/ 01838000
*                   DO;                                    /*@OZ09388*/ 01839000
         B     @RC00573                                            0584 01840000
@RF00573 DS    0H                                                  0585 01841000
*                     PROCMSG='CRAOPEN '; /* NAME FOR INSERT @OZ09388*/ 01842000
         MVC   PROCMSG(8),@CC01228                                 0585 01843000
*                     CALL ERROR (7,$RETURN) ; /*FM CATNAM   @OZ09388*/ 01844000
         LA    @01,@AL00586                                        0586 01845000
         BAL   @14,ERROR                                           0586 01846000
*                   END;                                   /*@OZ09388*/ 01847000
*                                  /* GO ON WITH CMPR ANYWAY         */ 01848000
*             END ;                                                0588 01849000
@RC00573 DS    0H                                                  0589 01850000
*         FMPLBCIN = CTTBASE + 1 ;                                 0589 01851000
@RF00567 L     @02,FMPLAD                                          0589 01852000
         MVC   FMPLBCIN(3,@02),@CF00038+1                          0589 01853000
*         FMFLDNAM = ADDR('ENTNAME ') ;                            0590 01854000
         LA    @15,@CC01195                                        0590 01855000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0590 01856000
*         REG1 = FMPLAD ;          /* GET VOLSER FOR SUBTITLE        */ 01857000
*                                                                  0591 01858000
         LR    REG1,@02                                            0591 01859000
*         CALL IDCRC04 ;                                           0592 01860000
*                                                                  0592 01861000
         L     @15,@CV00793                                        0592 01862000
         BALR  @14,@15                                             0592 01863000
*         IF FMFLENTH ^= 0                                         0593 01864000
*           THEN SUBTVLSR = ENTNAME(1:6) ;                         0593 01865000
         L     @02,FMFLENTH(,FMFLCUR)                              0593 01866000
         LTR   @02,@02                                             0593 01867000
         BZ    @RF00593                                            0593 01868000
         L     @02,FMFLADDR(,FMFLCUR)                              0594 01869000
         MVC   SUBTVLSR(6),ENTNAME(@02)                            0594 01870000
*           ELSE                                           /*@OZ09388*/ 01871000
*               DO;                                        /*@OZ09388*/ 01872000
         B     @RC00593                                            0595 01873000
@RF00593 DS    0H                                                  0596 01874000
*                  PROCMSG='CRAOPEN '; /* PROC NAME FOR MSG  @OZ09388*/ 01875000
         MVC   PROCMSG(8),@CC01228                                 0596 01876000
*                  CALL ERROR (5,$RETURN);                 /*@OZ09388*/ 01877000
         LA    @01,@AL00597                                        0597 01878000
         BAL   @14,ERROR                                           0597 01879000
*               END;                                       /*@OZ09388*/ 01880000
*         IF GDTECT = NULLPTR      /* IF NOT RUNNING UNDER TSO       */ 01881000
*                                                                  0599 01882000
*           THEN CALL AMSTP043 (GDTTBL,IOCSPRT,PCRST) ;/*          0599 01883000
*                                                     CHANGE SUBTITLE*/ 01884000
*                                                                  0599 01885000
@RC00593 L     @02,@PC00001                                        0599 01886000
         L     @15,GDTECT(,@02)                                    0599 01887000
         LTR   @15,@15                                             0599 01888000
         BNZ   @RF00599                                            0599 01889000
         ST    @02,@AL00001                                        0600 01890000
         LA    @15,IOCSPRT                                         0600 01891000
         ST    @15,@AL00001+4                                      0600 01892000
         LA    @15,PCRST                                           0600 01893000
         ST    @15,@AL00001+8                                      0600 01894000
         MVI   @AL00001+8,X'80'                                    0600 01895000
         L     @15,GDTRST(,@02)                                    0600 01896000
         LA    @01,@AL00001                                        0600 01897000
         BALR  @14,@15                                             0600 01898000
*         CALL CTTBLD ;            /****** GO BUILD CTT *****        */ 01899000
*                                                                  0601 01900000
@RF00599 BAL   @14,CTTBLD                                          0601 01901000
*         FMU1STIO = OFF ;                                         0602 01902000
         NI    FMU1STIO,B'01111111'                                0602 01903000
*       END ;                                                      0603 01904000
*     ELSE CALL ERROR (9,$RETURN); /* TESTRC WILL ABORT CRA          */ 01905000
*                                                                  0604 01906000
         B     @RC00549                                            0604 01907000
@RF00549 LA    @01,@AL00604                                        0604 01908000
         BAL   @14,ERROR                                           0604 01909000
*END CRAOPEN ;                                                     0605 01910000
@EL00009 DS    0H                                                  0605 01911000
@EF00009 DS    0H                                                  0605 01912000
@ER00009 LM    @14,@12,@SA00009                                    0605 01913000
         BR    @14                                                 0605 01914000
* /*******************************************************************/ 01915000
* /* PROCEDURE NAME - CTTBLD, CI TRANSLATE TABLE BUILD               */ 01916000
* /* FUNCTION -                                                      */ 01917000
* /*   READ THE CATALOG CONTROL RECORD (CCR) IN THE CRA,             */ 01918000
* /*   GET SIZE OF CRA FROM IT,                                      */ 01919000
* /*   GET STORAGE FOR THE CTT,                                      */ 01920000
* /*   IF SEQUENTIALDUMP CALL GETPRT FOR SELF-DESCRIBING CIS (0-8),  */ 01921000
* /*   SCAN WHOLE CRA BUILDING THE CTT,                              */ 01922000
* /*   IF SEQUENTIALDUMP CALL GETPRT TO PRINT EACH ENTRY ALSO,       */ 01923000
* /*   IF FIELD MGMT RETURNS FF,S OR                                 */ 01924000
* /*   IF GET RECORD CAUSES I/O ERROR SET ENTRY TYPE TO              */ 01925000
* /*   '7F'X AND TURN ITS ALREADY PRINTED SWITCH ON IN CTT           */ 01926000
* /* INPUTS -                                                        */ 01927000
* /*   CRA                                                           */ 01928000
* /* OUTPUTS -                                                       */ 01929000
* /*   CTT WITH CATALOG CI AND ENTRY TYPE FILLED IN                  */ 01930000
* /*   FMUCTTP (POINTER (ZERO CAUSES CRA TO BE BYPASSED))            */ 01931000
* /* CALLS -                                                         */ 01932000
* /*   UGPOOL, GETPRT, ERROR,                                        */ 01933000
* /*   IDCRC04(ENTYPE, ENTIDNO)                                      */ 01934000
* /*******************************************************************/ 01935000
*                                                                  0606 01936000
*CTTBLD: PROCEDURE ;                                               0606 01937000
CTTBLD   STM   @14,@12,@SA00010                                    0606 01938000
* OLDERID2 = NEWERID2;                                             0607 01939000
         L     @15,@PC00001                                        0607 01940000
         L     @14,GDTTR2(,@15)                                    0607 01941000
         MVC   @TS00001(95),NEWERID2(@14)                          0607 01942000
         MVC   OLDERID2(95,@14),@TS00001                           0607 01943000
* NEWID2 = 'LRCT' ;                                                0608 01944000
         MVC   NEWID2(4,@14),@CC01233                              0608 01945000
* IF GDTDBG = NULLPTR                                              0609 01946000
*   THEN;                                                          0609 01947000
         L     @15,GDTDBG(,@15)                                    0609 01948000
         LTR   @15,@15                                             0609 01949000
         BZ    @RT00609                                            0609 01950000
*   ELSE                                                           0611 01951000
*     CALL IDCDB010 (GDTTBL,'LRCT') ;                              0611 01952000
*                                                                  0611 01953000
         L     @15,@PC00001                                        0611 01954000
         ST    @15,@AL00001                                        0611 01955000
         LA    @14,@CC01233                                        0611 01956000
         ST    @14,@AL00001+4                                      0611 01957000
         MVI   @AL00001+4,X'80'                                    0611 01958000
         L     @15,GDTDBG(,@15)                                    0611 01959000
         LA    @01,@AL00001                                        0611 01960000
         BALR  @14,@15                                             0611 01961000
* BUFNO = NBRBUF ;                                                 0612 01962000
@RT00609 MVI   BUFNO,X'04'                                         0612 01963000
* IOBFSPTR = IOCRBPTR ;                                            0613 01964000
         L     @02,IOCRBPTR                                        0613 01965000
         ST    @02,IOBFSPTR                                        0613 01966000
* IOCSPTR = IOCSCRA ;                                              0614 01967000
         L     IOCSPTR,IOCSCRA                                     0614 01968000
* IOCRBA = 3 * CATCISZ ;           /* CCR IS AT CI = 3               */ 01969000
*                                                                  0615 01970000
         MVC   IOCRBA(4,IOCSPTR),@CF01449                          0615 01971000
* CALL IDCIOGT0 (GDTTBL,IOCSCRA) ;                                 0616 01972000
*                                                                  0616 01973000
         L     @02,@PC00001                                        0616 01974000
         ST    @02,@AL00001                                        0616 01975000
         LA    @15,IOCSCRA                                         0616 01976000
         ST    @15,@AL00001+4                                      0616 01977000
         MVI   @AL00001+4,X'80'                                    0616 01978000
         L     @15,GDTGET(,@02)                                    0616 01979000
         LA    @01,@AL00001                                        0616 01980000
         BALR  @14,@15                                             0616 01981000
* RESPECIFY RTNREG RSTD;                                           0617 01982000
* TESTRC = RTNREG;                                                 0618 01983000
         STH   RTNREG,TESTRC                                       0618 01984000
* RESPECIFY RTNREG UNRSTD ;                                        0619 01985000
* IF TESTRC = 0                                                    0620 01986000
*   THEN                                                           0620 01987000
         LH    @02,TESTRC                                          0620 01988000
         LTR   @02,@02                                             0620 01989000
         BNZ   @RF00620                                            0620 01990000
*     DO ;                                                         0621 01991000
*       CTTSLOT = (IOCDAD -> CCRNXTFR) - CTTBASE - 1 ;             0622 01992000
         L     @01,IOCDAD(,IOCSPTR)                                0622 01993000
         SLR   @00,@00                                             0622 01994000
         ICM   @00,7,CCRNXTFR(@01)                                 0622 01995000
         SL    @00,@CF00038                                        0622 01996000
         STH   @00,CTTSLOT                                         0622 01997000
*       CTTLEN = CTTSLOT * LENGTH(CTTENTRY)                        0623 01998000
*                + LENGTH(CTTENTNO) ;                              0623 01999000
*                                                                  0623 02000000
         LA    @01,4                                               0623 02001000
         SLA   @00,3                                               0623 02002000
         ALR   @00,@01                                             0623 02003000
         LR    CTTLEN,@00                                          0623 02004000
*       CALL IDCSAGP0 (GDTTBL,CTTLEN+4,CTTPTR,MODIDCTT,SETZERO) ;  0624 02005000
*                                                                  0624 02006000
         L     @03,@PC00001                                        0624 02007000
         ST    @03,@AL00001                                        0624 02008000
         ALR   @01,CTTLEN                                          0624 02009000
         ST    @01,@AFTEMPS                                        0624 02010000
         LA    @15,@AFTEMPS                                        0624 02011000
         ST    @15,@AL00001+4                                      0624 02012000
         LA    @15,CTTPTR                                          0624 02013000
         ST    @15,@AL00001+8                                      0624 02014000
         LA    @15,MODIDCTT                                        0624 02015000
         ST    @15,@AL00001+12                                     0624 02016000
         LA    @15,SETZERO                                         0624 02017000
         ST    @15,@AL00001+16                                     0624 02018000
         MVI   @AL00001+16,X'80'                                   0624 02019000
         L     @15,GDTGPL(,@03)                                    0624 02020000
         LA    @01,@AL00001                                        0624 02021000
         BALR  @14,@15                                             0624 02022000
*       RESPECIFY RTNREG RSTD;                                     0625 02023000
*       TESTRC = RTNREG;                                           0626 02024000
         STH   RTNREG,TESTRC                                       0626 02025000
*       RESPECIFY RTNREG UNRSTD ;                                  0627 02026000
*       IF TESTRC = 0                                              0628 02027000
*         THEN                                                     0628 02028000
         LH    @15,TESTRC                                          0628 02029000
         SLR   @14,@14                                             0628 02030000
         CR    @15,@14                                             0628 02031000
         BNE   @RF00628                                            0628 02032000
*           DO ;                                                   0629 02033000
*             CTTENTNO = CTTSLOT ;                                 0630 02034000
         LH    @15,CTTSLOT                                         0630 02035000
         N     @15,@CF01475                                        0630 02036000
         L     @01,CTTPTR                                          0630 02037000
         ST    @15,CTTENTNO(,@01)                                  0630 02038000
*             FMU1STIO = ON ;                                      0631 02039000
         OI    FMU1STIO,B'10000000'                                0631 02040000
*             FMPLFLNO = 2 ;                                       0632 02041000
         L     @15,FMPLAD                                          0632 02042000
         MVI   FMPLFLNO(@15),X'02'                                 0632 02043000
*             FMFLDNAM = ADDR('ENTYPE  ') ;                        0633 02044000
         LA    @03,@CC01234                                        0633 02045000
         ST    @03,FMFLDNAM(,FMFLCUR)                              0633 02046000
*             FMPLFMFL(2) -> FMFLDNAM = ADDR('ENTIDNO ') ;         0634 02047000
         L     @01,FMPLFMFL+4(,@15)                                0634 02048000
         LA    @00,@CC01235                                        0634 02049000
         ST    @00,FMFLDNAM(,@01)                                  0634 02050000
*             IF SDUMPSW = ON                                      0635 02051000
*               THEN                                               0635 02052000
         TM    SDUMPSW,B'00000010'                                 0635 02053000
         BNO   @RF00635                                            0635 02054000
*                 DO CTLOOP = 0 TO CTTBASE ;                       0636 02055000
         LR    CTLOOP,@14                                          0636 02056000
@DL00636 DS    0H                                                  0637 02057000
*                   CIFRGET = CTLOOP ;                             0637 02058000
*                                                                  0637 02059000
         STCM  CTLOOP,7,CIFRGET                                    0637 02060000
*                   CALL GETPRT ;  /* PRINT SELF-DESCRIBING          */ 02061000
*                                                                  0638 02062000
         BAL   @14,GETPRT                                          0638 02063000
*                 END ;                                            0639 02064000
*                                                                  0639 02065000
         AL    CTLOOP,@CF00222                                     0639 02066000
         C     CTLOOP,@CF00039                                     0639 02067000
         BNH   @DL00636                                            0639 02068000
*             /*******************************************************/ 02069000
*             /*       LOOP: GET ALL RECORDS OUT OF                  */ 02070000
*             /*       THE CRA AND PUT THEIR TYPE                    */ 02071000
*             /*       AND CATALOG CI IN CTT                         */ 02072000
*             /*******************************************************/ 02073000
*                                                                  0640 02074000
*             DO CTTSLOT = 1 TO CTTENTNO ;                         0640 02075000
@RF00635 LA    @15,1                                               0640 02076000
         B     @DE00640                                            0640 02077000
@DL00640 DS    0H                                                  0641 02078000
*               FMPLBCIN = CTTSLOT + CTTBASE ;                     0641 02079000
         L     @14,FMPLAD                                          0641 02080000
         AL    @15,@CF00039                                        0641 02081000
         STCM  @15,7,FMPLBCIN(@14)                                 0641 02082000
*               REG1 = FMPLAD ;                                    0642 02083000
*                                                                  0642 02084000
         LR    REG1,@14                                            0642 02085000
*               CALL IDCRC04 ;     /* ASK ENTYPE AND CATCI           */ 02086000
*                                                                  0643 02087000
         L     @15,@CV00793                                        0643 02088000
         BALR  @14,@15                                             0643 02089000
*               IF FMFLENTH ^= 0 & ENTYPE ^= 'FF'X                 0644 02090000
*                 THEN                                             0644 02091000
         L     @15,FMFLENTH(,FMFLCUR)                              0644 02092000
         LTR   @15,@15                                             0644 02093000
         BZ    @RF00644                                            0644 02094000
         L     @15,FMFLADDR(,FMFLCUR)                              0644 02095000
         CLI   ENTYPE(@15),X'FF'                                   0644 02096000
         BE    @RF00644                                            0644 02097000
*                   DO ;                                           0645 02098000
*                     CTTENTYP(CTTSLOT) = ENTYPE ;                 0646 02099000
         L     @14,CTTPTR                                          0646 02100000
         LH    @03,CTTSLOT                                         0646 02101000
         N     @03,@CF01475                                        0646 02102000
         LR    @02,@03                                             0646 02103000
         SLA   @02,3                                               0646 02104000
         ST    @02,@TF00001                                        0646 02105000
         ALR   @02,@14                                             0646 02106000
         AL    @02,@CF01476                                        0646 02107000
         MVC   CTTENTYP-4(1,@02),ENTYPE(@15)                       0646 02108000
*                     CTTCATCI(CTTSLOT) = FMPLFMFL(2) ->           0647 02109000
*                       FMFLADDR(1) -> ENTIDNO ;                   0647 02110000
         L     @01,FMPLAD                                          0647 02111000
         L     @01,FMPLFMFL+4(,@01)                                0647 02112000
         L     @01,FMFLADDR(,@01)                                  0647 02113000
         AL    @14,@TF00001                                        0647 02114000
         AL    @14,@CF01466                                        0647 02115000
         MVC   CTTCATCI-5(3,@14),ENTIDNO(@01)                      0647 02116000
*                     IF SDUMPSW = ON                              0648 02117000
*                       THEN                                       0648 02118000
         TM    SDUMPSW,B'00000010'                                 0648 02119000
         BNO   @RF00648                                            0648 02120000
*                         DO ;                                     0649 02121000
*                           PRNTPASW = ON ;                        0650 02122000
         OI    PRNTPASW,B'10000000'                                0650 02123000
*                           CIFRGET = CTTSLOT + CTTBASE ;          0651 02124000
*                                                                  0651 02125000
         LA    @03,8(,@03)                                         0651 02126000
         STCM  @03,7,CIFRGET                                       0651 02127000
*                           CALL GETPRT ;   /* PRINT SEQ DUMP        */ 02128000
*                                                                  0652 02129000
         BAL   @14,GETPRT                                          0652 02130000
*                         END ;                                    0653 02131000
*                   END ;                                          0654 02132000
*                 ELSE                                             0655 02133000
*                   DO ;           /* FIELD MGMT ERROR RETURN        */ 02134000
         B     @RC00644                                            0655 02135000
@RF00644 DS    0H                                                  0656 02136000
*                     PROCMSG='CTTBLD  '; /* NAME FOR INSERT @OZ09388*/ 02137000
         MVC   PROCMSG(8),@CC01237                                 0656 02138000
*                     CALL ERROR (12,$RETURN) ;                    0657 02139000
         LA    @01,@AL00657                                        0657 02140000
         BAL   @14,ERROR                                           0657 02141000
*                     CTTENTYP(CTTSLOT) = '7F'X ;                  0658 02142000
         L     @15,CTTPTR                                          0658 02143000
         LH    @14,CTTSLOT                                         0658 02144000
         N     @14,@CF01475                                        0658 02145000
         SLA   @14,3                                               0658 02146000
         ST    @14,@TF00001                                        0658 02147000
         ALR   @14,@15                                             0658 02148000
         AL    @14,@CF01476                                        0658 02149000
         MVI   CTTENTYP-4(@14),X'7F'                               0658 02150000
*                      CTTPRTD(CTTSLOT) = ON ;                     0659 02151000
         AL    @15,@TF00001                                        0659 02152000
         OI    CTTPRTD-8(@15),B'10000000'                          0659 02153000
*                   END ;                                          0660 02154000
*             END ;                                                0661 02155000
*                                                                  0661 02156000
@RC00644 LA    @15,1                                               0661 02157000
         LH    @14,CTTSLOT                                         0661 02158000
         N     @14,@CF01475                                        0661 02159000
         ALR   @15,@14                                             0661 02160000
@DE00640 STH   @15,CTTSLOT                                         0661 02161000
         L     @14,CTTPTR                                          0661 02162000
         C     @15,CTTENTNO(,@14)                                  0661 02163000
         BNH   @DL00640                                            0661 02164000
*             FMUCTTP = CTTPTR ;   /* SAY BUILT AND TELL IDCLR02     */ 02165000
         L     @15,CTTPTR                                          0662 02166000
         ST    @15,FMUCTTP                                         0662 02167000
*             FMU1STIO = OFF ;     /* TO TRANSLATE CI'S              */ 02168000
         NI    FMU1STIO,B'01111111'                                0663 02169000
*             FMPLFLNO = 1 ;       /* REPLACE ASSUMED VALUE          */ 02170000
         L     @01,FMPLAD                                          0664 02171000
         MVI   FMPLFLNO(@01),X'01'                                 0664 02172000
*           END ;                                                  0665 02173000
*         ELSE CALL ERROR (NBRETE,$RETURN) ; /* GETSPACE FAIL        */ 02174000
         B     @RC00628                                            0666 02175000
@RF00628 LA    @01,@AL00666                                        0666 02176000
         BAL   @14,ERROR                                           0666 02177000
*     END ;                        /* FMUCTTP=0 SAYS SKIP CRA        */ 02178000
*   ELSE CALL ERROR (11,$RETURN) ; /* GET FOR CRA CCR FAILED         */ 02179000
*                                                                  0668 02180000
         B     @RC00620                                            0668 02181000
@RF00620 LA    @01,@AL00668                                        0668 02182000
         BAL   @14,ERROR                                           0668 02183000
*END CTTBLD ;                                                      0669 02184000
@EL00010 DS    0H                                                  0669 02185000
@EF00010 DS    0H                                                  0669 02186000
@ER00010 LM    @14,@12,@SA00010                                    0669 02187000
         BR    @14                                                 0669 02188000
* /*******************************************************************/ 02189000
* /* PROCEDURE NAME - DOOTHR, DO LOOP THRU SORTTBL                   */ 02190000
* /* FUNCTION -                                                      */ 02191000
* /*   FOLLOW STFRWD (FORWARD) PATH THRU SORTTBL FOR CIS,            */ 02192000
* /*     CALL PRTOTHR TO PRINT OTHER THAN VSAM STRUCTURES            */ 02193000
* /*     INCLUDING USERCATALOG POINTER RECORDS,                      */ 02194000
* /*   DELETE THE SORTTBL                                            */ 02195000
* /* INPUTS -                                                        */ 02196000
* /*   SORTTBL (GDGBASE, NONVSAM, USERCAT POINTERS)                  */ 02197000
* /* OUTPUTS -                                                       */ 02198000
* /* CALLS -                                                         */ 02199000
* /*   PRTOTHR, UREST, UFPOOL                                        */ 02200000
* /*******************************************************************/ 02201000
*                                                                  0670 02202000
*DOOTHR: PROCEDURE ;                                               0670 02203000
DOOTHR   STM   @14,@12,@SA00011                                    0670 02204000
* OLDERID2 = NEWERID2;                                             0671 02205000
         L     @15,@PC00001                                        0671 02206000
         L     @14,GDTTR2(,@15)                                    0671 02207000
         MVC   @TS00001(95),NEWERID2(@14)                          0671 02208000
         MVC   OLDERID2(95,@14),@TS00001                           0671 02209000
* NEWID2 = 'LRDO' ;                                                0672 02210000
         MVC   NEWID2(4,@14),@CC01242                              0672 02211000
* IF GDTDBG = NULLPTR                                              0673 02212000
*   THEN;                                                          0673 02213000
         L     @15,GDTDBG(,@15)                                    0673 02214000
         LTR   @15,@15                                             0673 02215000
         BZ    @RT00673                                            0673 02216000
*   ELSE                                                           0675 02217000
*     CALL IDCDB010 (GDTTBL,'LRDO') ;                              0675 02218000
*                                                                  0675 02219000
         L     @15,@PC00001                                        0675 02220000
         ST    @15,@AL00001                                        0675 02221000
         LA    @14,@CC01242                                        0675 02222000
         ST    @14,@AL00001+4                                      0675 02223000
         MVI   @AL00001+4,X'80'                                    0675 02224000
         L     @15,GDTDBG(,@15)                                    0675 02225000
         LA    @01,@AL00001                                        0675 02226000
         BALR  @14,@15                                             0675 02227000
* IF STSLTCNT ^= 0                                                 0676 02228000
*   THEN                                                           0676 02229000
@RT00673 LH    @15,STSLTCNT                                        0676 02230000
         N     @15,@CF01475                                        0676 02231000
         LTR   @15,@15                                             0676 02232000
         BZ    @RF00676                                            0676 02233000
*     DO ;                                                         0677 02234000
*       SUBGROUP = 'OTHER ENTRIES' ;                               0678 02235000
         MVI   SUBGROUP+13,C' '                                    0678 02236000
         MVC   SUBGROUP+14(2),SUBGROUP+13                          0678 02237000
         MVC   SUBGROUP(13),@CC01243                               0678 02238000
*       IF GDTECT = NULLPTR        /* IF NOT RUNNING UNDER TSO       */ 02239000
*                                                                  0679 02240000
*         THEN CALL AMSTP043 (GDTTBL,IOCSPRT,PCRST) ;              0679 02241000
*                                                                  0679 02242000
         L     @15,@PC00001                                        0679 02243000
         L     @14,GDTECT(,@15)                                    0679 02244000
         LTR   @14,@14                                             0679 02245000
         BNZ   @RF00679                                            0679 02246000
         ST    @15,@AL00001                                        0680 02247000
         LA    @14,IOCSPRT                                         0680 02248000
         ST    @14,@AL00001+4                                      0680 02249000
         LA    @14,PCRST                                           0680 02250000
         ST    @14,@AL00001+8                                      0680 02251000
         MVI   @AL00001+8,X'80'                                    0680 02252000
         L     @15,GDTRST(,@15)                                    0680 02253000
         LA    @01,@AL00001                                        0680 02254000
         BALR  @14,@15                                             0680 02255000
*       STSLOT = STFRWD(1) ;                                       0681 02256000
*                                                                  0681 02257000
@RF00679 L     @01,STPTR                                           0681 02258000
         LH    STSLOT,STFRWD(,@01)                                 0681 02259000
         N     STSLOT,@CF01475                                     0681 02260000
*       /*************************************************************/ 02261000
*       /*     LOOP: GO PRINT ALL ENTRIES IN SORTTBL                 */ 02262000
*       /*************************************************************/ 02263000
*                                                                  0682 02264000
*       DO UNTIL (STCRACI(STSLOT) = STENDCI) ;                     0682 02265000
*                                                                  0682 02266000
@DL00682 DS    0H                                                  0683 02267000
*         CALL PRTOTHR ;                                           0683 02268000
*                                                                  0683 02269000
         BAL   @14,PRTOTHR                                         0683 02270000
*         STSLOT = STFRWD(STSLOT) ;                                0684 02271000
         LR    @02,STSLOT                                          0684 02272000
         MH    @02,@CH01068                                        0684 02273000
         L     @01,STPTR                                           0684 02274000
         AL    @01,@CF01476                                        0684 02275000
         LH    @02,STFRWD-52(@02,@01)                              0684 02276000
         N     @02,@CF01475                                        0684 02277000
         LR    STSLOT,@02                                          0684 02278000
*       END ;                                                      0685 02279000
@DE00682 LR    @02,STSLOT                                          0685 02280000
         MH    @02,@CH01068                                        0685 02281000
         L     @01,STPTR                                           0685 02282000
         ALR   @01,@02                                             0685 02283000
         AL    @01,@CF01477                                        0685 02284000
         CLC   STCRACI-45(3,@01),STENDCI                           0685 02285000
         BNE   @DL00682                                            0685 02286000
*     END ;                                                        0686 02287000
* CALL IDCSAFP0 (GDTTBL,MODIDST) ; /* FREE SORTTBL SPACE             */ 02288000
@RF00676 L     @04,@PC00001                                        0687 02289000
         ST    @04,@AL00001                                        0687 02290000
         LA    @15,MODIDST                                         0687 02291000
         ST    @15,@AL00001+4                                      0687 02292000
         MVI   @AL00001+4,X'80'                                    0687 02293000
         L     @15,GDTFPL(,@04)                                    0687 02294000
         LA    @01,@AL00001                                        0687 02295000
         BALR  @14,@15                                             0687 02296000
*END DOOTHR ;                                                      0688 02297000
@EL00011 DS    0H                                                  0688 02298000
@EF00011 DS    0H                                                  0688 02299000
@ER00011 LM    @14,@12,@SA00011                                    0688 02300000
         BR    @14                                                 0688 02301000
* /*******************************************************************/ 02302000
* /* PROCEDURE NAME - DOVSAM, DO LOOP THRU SORTTBL                   */ 02303000
* /* FUNCTION -                                                      */ 02304000
* /*   FOLLOW STFRWD (FORWARD) PATH THRU SORTTBL FOR CIS,            */ 02305000
* /*     CALL PRTVSAM TO PRINT VSAM STRUCTURES,                      */ 02306000
* /*   DELETE THE SORTTBL                                            */ 02307000
* /* INPUTS -                                                        */ 02308000
* /*   SORTTBL (CLUSTER AND AIX RECORDS ONLY)                        */ 02309000
* /* OUTPUTS -                                                       */ 02310000
* /* CALLS -                                                         */ 02311000
* /*   PRTVSAM, UFPOOL                                               */ 02312000
* /*******************************************************************/ 02313000
*                                                                  0689 02314000
*DOVSAM: PROCEDURE ;                                               0689 02315000
DOVSAM   STM   @14,@12,@SA00012                                    0689 02316000
* OLDERID2 = NEWERID2;                                             0690 02317000
         L     @15,@PC00001                                        0690 02318000
         L     @14,GDTTR2(,@15)                                    0690 02319000
         MVC   @TS00001(95),NEWERID2(@14)                          0690 02320000
         MVC   OLDERID2(95,@14),@TS00001                           0690 02321000
* NEWID2 = 'LRDV' ;                                                0691 02322000
         MVC   NEWID2(4,@14),@CC01249                              0691 02323000
* IF GDTDBG = NULLPTR                                              0692 02324000
*   THEN;                                                          0692 02325000
         L     @15,GDTDBG(,@15)                                    0692 02326000
         LTR   @15,@15                                             0692 02327000
         BZ    @RT00692                                            0692 02328000
*   ELSE                                                           0694 02329000
*     CALL IDCDB010 (GDTTBL,'LRDV') ;                              0694 02330000
*                                                                  0694 02331000
         L     @15,@PC00001                                        0694 02332000
         ST    @15,@AL00001                                        0694 02333000
         LA    @14,@CC01249                                        0694 02334000
         ST    @14,@AL00001+4                                      0694 02335000
         MVI   @AL00001+4,X'80'                                    0694 02336000
         L     @15,GDTDBG(,@15)                                    0694 02337000
         LA    @01,@AL00001                                        0694 02338000
         BALR  @14,@15                                             0694 02339000
* IF STSLTCNT ^= 0                                                 0695 02340000
*   THEN                                                           0695 02341000
@RT00692 LH    @15,STSLTCNT                                        0695 02342000
         N     @15,@CF01475                                        0695 02343000
         LTR   @15,@15                                             0695 02344000
         BZ    @RF00695                                            0695 02345000
*     DO ;                                                         0696 02346000
*       STSLOT = STFRWD(1) ;                                       0697 02347000
*                                                                  0697 02348000
         L     @01,STPTR                                           0697 02349000
         LH    STSLOT,STFRWD(,@01)                                 0697 02350000
         N     STSLOT,@CF01475                                     0697 02351000
*       /*************************************************************/ 02352000
*       /*      LOOP: GO PRINT ALL ENTRIES IN SORTTBL                */ 02353000
*       /*************************************************************/ 02354000
*                                                                  0698 02355000
*       DO UNTIL (STCRACI(STSLOT) = STENDCI) ;                     0698 02356000
@DL00698 DS    0H                                                  0699 02357000
*         CALL PRTVSAM ;                                           0699 02358000
         BAL   @14,PRTVSAM                                         0699 02359000
*         STSLOT = STFRWD(STSLOT) ;                                0700 02360000
         LR    @02,STSLOT                                          0700 02361000
         MH    @02,@CH01068                                        0700 02362000
         L     @01,STPTR                                           0700 02363000
         AL    @01,@CF01476                                        0700 02364000
         LH    @02,STFRWD-52(@02,@01)                              0700 02365000
         N     @02,@CF01475                                        0700 02366000
         LR    STSLOT,@02                                          0700 02367000
*       END ;                                                      0701 02368000
@DE00698 LR    @02,STSLOT                                          0701 02369000
         MH    @02,@CH01068                                        0701 02370000
         L     @01,STPTR                                           0701 02371000
         ALR   @01,@02                                             0701 02372000
         AL    @01,@CF01477                                        0701 02373000
         CLC   STCRACI-45(3,@01),STENDCI                           0701 02374000
         BNE   @DL00698                                            0701 02375000
*     END ;                                                        0702 02376000
* CALL IDCSAFP0 (GDTTBL,MODIDST) ; /* FREE SORTTBL SPACE             */ 02377000
*                                                                  0703 02378000
@RF00695 L     @04,@PC00001                                        0703 02379000
         ST    @04,@AL00001                                        0703 02380000
         LA    @15,MODIDST                                         0703 02381000
         ST    @15,@AL00001+4                                      0703 02382000
         MVI   @AL00001+4,X'80'                                    0703 02383000
         L     @15,GDTFPL(,@04)                                    0703 02384000
         LA    @01,@AL00001                                        0703 02385000
         BALR  @14,@15                                             0703 02386000
*END DOVSAM ;                                                      0704 02387000
@EL00012 DS    0H                                                  0704 02388000
@EF00012 DS    0H                                                  0704 02389000
@ER00012 LM    @14,@12,@SA00012                                    0704 02390000
         BR    @14                                                 0704 02391000
* /*******************************************************************/ 02392000
* /* PROCEDURE NAME - ERROR, HANDLE ERRORS                           */ 02393000
* /* FUNCTION -                                                      */ 02394000
* /*   USING ENTRY SUBSCRIPT FOR ERRTBL PASSED                       */ 02395000
* /*   KEEP THE HIGHEST LASTCC,                                      */ 02396000
* /*   IF REQUESTED PRINT THE APPROPRIATE ERROR MESSAGE,             */ 02397000
* /*   IF I/O ERROR TURN THE BIT IN THE IOCS THAT SAYS THE           */ 02398000
* /*   DATA SET IS OPEN BACK ON SO THE ERROR CAN BE IGNORED          */ 02399000
* /*   (I/O ADAPTER SETS NOT OPEN AFTER ERROR)                       */ 02400000
* /*   IF I/O ERROR COUNT IS GREATER THAN THE LIMIT PRINT            */ 02401000
* /*   AN ADDITIONAL TERMINATION MESSAGE,                            */ 02402000
* /*   IF CALLER SET GONOGO TO NONZERO OR I/O ERROR COUNT            */ 02403000
* /*   IS GREATER THAN THE LIMIT ABORT USING UEPIL                   */ 02404000
* /* INPUTS -                                                        */ 02405000
* /*   SUBSCRIPT OF ERROR MESSAGE CONTROL INFO IN ERRTBL             */ 02406000
* /*   GONOGO (INDICATES RETURN OR ABORT)                            */ 02407000
* /*   ERRTBL                                                        */ 02408000
* /* OUTPUTS -                                                       */ 02409000
* /*   LRLASTCC POSSIBLY RAISED                                      */ 02410000
* /*   ERROR MESSAGE(S) AND POSSIBLE ABORT                           */ 02411000
* /* CALLS -                                                         */ 02412000
* /*   UPRINT, UEPIL                                                 */ 02413000
* /*******************************************************************/ 02414000
*                                                                  0705 02415000
*ERROR: PROCEDURE (ETARG,GONOGO) ;                                 0705 02416000
ERROR    STM   @14,@12,@SA00013                                    0705 02417000
         MVC   @PC00013(8),0(@01)                                  0705 02418000
* OLDERID2 = NEWERID2;                                             0706 02419000
         L     @04,@PC00001                                        0706 02420000
         L     @15,GDTTR2(,@04)                                    0706 02421000
         MVC   @TS00001(95),NEWERID2(@15)                          0706 02422000
         MVC   OLDERID2(95,@15),@TS00001                           0706 02423000
* NEWID2 = 'LRER' ;                                                0707 02424000
         MVC   NEWID2(4,@15),@CC01258                              0707 02425000
* IF GDTDBG = NULLPTR                                              0708 02426000
*   THEN;                                                          0708 02427000
         L     @04,GDTDBG(,@04)                                    0708 02428000
         LTR   @04,@04                                             0708 02429000
         BZ    @RT00708                                            0708 02430000
*   ELSE                                                           0710 02431000
*     CALL IDCDB010 (GDTTBL,'LRER') ;                              0710 02432000
*                                                                  0710 02433000
         L     @04,@PC00001                                        0710 02434000
         ST    @04,@AL00001                                        0710 02435000
         LA    @15,@CC01258                                        0710 02436000
         ST    @15,@AL00001+4                                      0710 02437000
         MVI   @AL00001+4,X'80'                                    0710 02438000
         L     @15,GDTDBG(,@04)                                    0710 02439000
         LA    @01,@AL00001                                        0710 02440000
         BALR  @14,@15                                             0710 02441000
* DCL                                                              0711 02442000
*   ETARG           FIXED(31),     /* SUBSCRIPT IN ERRTBL            */ 02443000
*   GONOGO          FIXED(8),      /* NONZERO VALUE = ABORT          */ 02444000
* ENDCLSER CHAR(1);                                                0711 02445000
*                                                                  0711 02446000
@RT00708 DS    0H                                                  0712 02447000
* IF ERRRTNCD(ETARG) > LRLASTCC                                    0712 02448000
*   THEN                                                           0712 02449000
         L     @04,@PC00013                                        0712 02450000
         L     @04,ETARG(,@04)                                     0712 02451000
         MH    @04,@CH00035                                        0712 02452000
         SLR   @15,@15                                             0712 02453000
         IC    @15,ERRRTNCD-12(@04)                                0712 02454000
         CH    @15,LRLASTCC                                        0712 02455000
         BNH   @RF00712                                            0712 02456000
*     LRLASTCC = ERRRTNCD(ETARG) ;                                 0713 02457000
         STH   @15,LRLASTCC                                        0713 02458000
* DDSTRUSV = DDSTRU ;              /* SAVE NORMAL DARGLIST           */ 02459000
@RF00712 L     DDSTRUSV,DDSTRU                                     0714 02460000
* DDSTRU = DDSTRUE ;               /* ADDR, CHANGE TO ERROR          */ 02461000
         L     @04,DDSTRUE                                         0715 02462000
         ST    @04,DDSTRU                                          0715 02463000
* DARGLIST = '0'B ;                                                0716 02464000
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0716 02465000
         MVI   DARGLIST(@04),B'00000000'                           0716 02466000
* DARGSMOD = ERRSTMOD(ETARG) ;                                     0717 02467000
         L     @03,@PC00013                                        0717 02468000
         L     @03,ETARG(,@03)                                     0717 02469000
         MH    @03,@CH00035                                        0717 02470000
         LA    @01,ERRSTMOD-12(@03)                                0717 02471000
         MVC   DARGSMOD(3,@04),0(@01)                              0717 02472000
* DARGSENT = ERRSTENT(ETARG) ;                                     0718 02473000
         SLR   @15,@15                                             0718 02474000
         IC    @15,ERRSTENT-12(@03)                                0718 02475000
         STC   @15,DARGSENT(,@04)                                  0718 02476000
* IF DARGSMOD = 'LR1' & DARGSENT = 1                               0719 02477000
*   THEN                                                           0719 02478000
         CLC   DARGSMOD(3,@04),@CC00775                            0719 02479000
         BNE   @RF00719                                            0719 02480000
         CLI   DARGSENT(@04),1                                     0719 02481000
         BNE   @RF00719                                            0719 02482000
*     DO ;                                                         0720 02483000
*       ERRCNTIO = ERRCNTIO + 1 ;  /* BUMP IO ERR CNT                */ 02484000
         IC    @04,ERRCNTIO                                        0721 02485000
         LA    @04,1(,@04)                                         0721 02486000
         STC   @04,ERRCNTIO                                        0721 02487000
*       IOCSCRA -> IOCMSGOP = ON ; /* SET IOCS TO OPEN               */ 02488000
         L     @04,IOCSCRA                                         0722 02489000
         OI    IOCMSGOP(@04),B'00100000'                           0722 02490000
*     END ;                        /* SO IOERR CAN BE IGNORED        */ 02491000
* IF DARGSMOD = 'LR1' & DARGSENT = 2                               0724 02492000
*   THEN                                                           0724 02493000
@RF00719 L     @04,DDSTRU                                          0724 02494000
         CLC   DARGSMOD(3,@04),@CC00775                            0724 02495000
         BNE   @RF00724                                            0724 02496000
         CLI   DARGSENT(@04),2                                     0724 02497000
         BNE   @RF00724                                            0724 02498000
*     DO ;                                                         0725 02499000
*       ERRCNTIO = ERRCNTIO + 1 ;  /* BUMP IO ERR CNT                */ 02500000
         IC    @04,ERRCNTIO                                        0726 02501000
         LA    @04,1(,@04)                                         0726 02502000
         STC   @04,ERRCNTIO                                        0726 02503000
*       IOCSCAT -> IOCMSGOP = ON ; /* SET IOCS TO OPEN               */ 02504000
         L     @04,IOCSCAT                                         0727 02505000
         OI    IOCMSGOP(@04),B'00100000'                           0727 02506000
*     END ;                        /* SO IOERR CAN BE IGNORED        */ 02507000
* IF DARGSMOD = 'LR1' & ERRILEN(ETARG) ^= 0                        0729 02508000
*   THEN                                                           0729 02509000
@RF00724 L     @04,DDSTRU                                          0729 02510000
         CLC   DARGSMOD(3,@04),@CC00775                            0729 02511000
         BNE   @RF00729                                            0729 02512000
         L     @03,@PC00013                                        0729 02513000
         L     @03,ETARG(,@03)                                     0729 02514000
         MH    @03,@CH00035                                        0729 02515000
         SLR   @15,@15                                             0729 02516000
         IC    @15,ERRILEN-12(@03)                                 0729 02517000
         LTR   @15,@15                                             0729 02518000
         BZ    @RF00729                                            0729 02519000
*     DO ;                         /* ADD INSERT GROUP               */ 02520000
*       DARGCNT = 1 ;                                              0731 02521000
*                                                                  0731 02522000
         LA    @14,1                                               0731 02523000
         STH   @14,DARGCNT(,@04)                                   0731 02524000
*       DARGINS(1) = 1 ;                                           0732 02525000
*                                                                  0732 02526000
         STH   @14,DARGINS(,@04)                                   0732 02527000
*       DARGINL(1) = ERRILEN(ETARG) ;                              0733 02528000
         STH   @15,DARGINL(,@04)                                   0733 02529000
*                                  /* IF ADDR IS CODE USE IT         */ 02530000
*                                  /* TO FIND CI TO INSERT           */ 02531000
*       IF ERRIADDR(ETARG) = 1                                     0734 02532000
*         THEN DARGDTM(1) = ADDR(CATNMCRA) ;                       0734 02533000
         C     @14,ERRIADDR-12(@03)                                0734 02534000
         BNE   @RF00734                                            0734 02535000
         LA    @03,CATNMCRA                                        0735 02536000
         ST    @03,DARGDTM(,@04)                                   0735 02537000
*         ELSE                                                     0736 02538000
*           IF ERRIADDR(ETARG) = 2                                 0736 02539000
*             THEN DARGDTM(1) = ADDR(CATCI) ;                      0736 02540000
         B     @RC00734                                            0736 02541000
@RF00734 L     @04,@PC00013                                        0736 02542000
         L     @04,ETARG(,@04)                                     0736 02543000
         MH    @04,@CH00035                                        0736 02544000
         L     @04,ERRIADDR-12(@04)                                0736 02545000
         C     @04,@CF00158                                        0736 02546000
         BNE   @RF00736                                            0736 02547000
         LA    @04,CATCI                                           0737 02548000
         L     @03,DDSTRU                                          0737 02549000
         ST    @04,DARGDTM(,@03)                                   0737 02550000
*             ELSE                                                 0738 02551000
*               IF ERRIADDR(ETARG) = 3                             0738 02552000
*                 THEN DARGDTM(1) = ADDR(CIFRGET) ;                0738 02553000
*                                                                  0738 02554000
         B     @RC00736                                            0738 02555000
@RF00736 L     @04,@PC00013                                        0738 02556000
         L     @04,ETARG(,@04)                                     0738 02557000
         MH    @04,@CH00035                                        0738 02558000
         L     @04,ERRIADDR-12(@04)                                0738 02559000
         C     @04,@CF00166                                        0738 02560000
         BNE   @RF00738                                            0738 02561000
         LA    @04,CIFRGET                                         0739 02562000
         L     @03,DDSTRU                                          0739 02563000
         ST    @04,DARGDTM(,@03)                                   0739 02564000
*                                  /* NOT CODE SO INSERT             */ 02565000
*                 ELSE             /* FROM TABLE ITSELF              */ 02566000
*                   IF ERRIADDR(ETARG) = 4                         0740 02567000
*                     THEN DARGDTM(1) = ADDR(CIFRTRNS) ;           0740 02568000
         B     @RC00738                                            0740 02569000
@RF00738 L     @04,@PC00013                                        0740 02570000
         L     @04,ETARG(,@04)                                     0740 02571000
         MH    @04,@CH00035                                        0740 02572000
         L     @04,ERRIADDR-12(@04)                                0740 02573000
         C     @04,@CF00047                                        0740 02574000
         BNE   @RF00740                                            0740 02575000
         LA    @04,CIFRTRNS                                        0741 02576000
         L     @03,DDSTRU                                          0741 02577000
         ST    @04,DARGDTM(,@03)                                   0741 02578000
*                                  /* NOT CODE SO INSERT     @OZ09388*/ 02579000
*                     ELSE         /* FROM TABLE ITSELF      @OZ09388*/ 02580000
*                       IF ERRIADDR(ETARG) = 5             /*@OZ09388*/ 02581000
*                          THEN DARGDTM(1)= ADDR(PROCMSG); /*@OZ09388*/ 02582000
         B     @RC00740                                            0742 02583000
@RF00740 L     @04,@PC00013                                        0742 02584000
         L     @04,ETARG(,@04)                                     0742 02585000
         MH    @04,@CH00035                                        0742 02586000
         L     @04,ERRIADDR-12(@04)                                0742 02587000
         C     @04,@CF00042                                        0742 02588000
         BNE   @RF00742                                            0742 02589000
         LA    @04,PROCMSG                                         0743 02590000
         L     @03,DDSTRU                                          0743 02591000
         ST    @04,DARGDTM(,@03)                                   0743 02592000
*                          ELSE DARGDTM(1) = ERRIADDR(ETARG) ;     0744 02593000
         B     @RC00742                                            0744 02594000
@RF00742 L     @04,@PC00013                                        0744 02595000
         L     @04,ETARG(,@04)                                     0744 02596000
         MH    @04,@CH00035                                        0744 02597000
         L     @04,ERRIADDR-12(@04)                                0744 02598000
         L     @03,DDSTRU                                          0744 02599000
         ST    @04,DARGDTM(,@03)                                   0744 02600000
*                                                          /*@OZ09388*/ 02601000
*     END ;                                                        0745 02602000
@RC00742 DS    0H                                                  0745 02603000
@RC00740 DS    0H                                                  0745 02604000
@RC00738 DS    0H                                                  0745 02605000
@RC00736 DS    0H                                                  0745 02606000
@RC00734 DS    0H                                                  0746 02607000
* IF DARGSMOD = 'UV0' & ERRILEN(ETARG) ^= 0                        0746 02608000
*   THEN                                                           0746 02609000
@RF00729 L     @04,DDSTRU                                          0746 02610000
         CLC   DARGSMOD(3,@04),@CC00777                            0746 02611000
         BNE   @RF00746                                            0746 02612000
         L     @03,@PC00013                                        0746 02613000
         L     @03,ETARG(,@03)                                     0746 02614000
         MH    @03,@CH00035                                        0746 02615000
         SLR   @15,@15                                             0746 02616000
         IC    @15,ERRILEN-12(@03)                                 0746 02617000
         LTR   @15,@15                                             0746 02618000
         BZ    @RF00746                                            0746 02619000
*     DO ;                         /* FOR FUTURE USE CNSISTNT        */ 02620000
*       DARGILP = ERRILEN(ETARG) ;                                 0748 02621000
         STH   @15,DARGILP(,@04)                                   0748 02622000
*       DARGDBP = ERRIADDR(ETARG) ;                                0749 02623000
         L     @03,ERRIADDR-12(@03)                                0749 02624000
         ST    @03,DARGDBP(,@04)                                   0749 02625000
*     END ;                                                        0750 02626000
* IF DARGSMOD ^= '   '             /* IF NOT JUST TO SET EC          */ 02627000
*                                                                  0751 02628000
*   THEN CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                   0751 02629000
*                                                                  0751 02630000
@RF00746 L     @04,DDSTRU                                          0751 02631000
         CLC   DARGSMOD(3,@04),@CC00776                            0751 02632000
         BE    @RF00751                                            0751 02633000
         L     @04,@PC00001                                        0752 02634000
         ST    @04,@AL00001                                        0752 02635000
         LA    @03,IOCSPRT                                         0752 02636000
         ST    @03,@AL00001+4                                      0752 02637000
         LA    @03,DDSTRU                                          0752 02638000
         ST    @03,@AL00001+8                                      0752 02639000
         MVI   @AL00001+8,X'80'                                    0752 02640000
         L     @15,GDTPRT(,@04)                                    0752 02641000
         LA    @01,@AL00001                                        0752 02642000
         BALR  @14,@15                                             0752 02643000
* IF ERRCNTIO = ERRLMT                                             0753 02644000
*   THEN                                                           0753 02645000
@RF00751 CLI   ERRCNTIO,50                                         0753 02646000
         BNE   @RF00753                                            0753 02647000
*     DO ;                                                         0754 02648000
*       DARGLIST = '0'B ;                                          0755 02649000
         L     @04,DDSTRU                                          0755 02650000
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0755 02651000
         MVI   DARGLIST(@04),B'00000000'                           0755 02652000
*       DARGSMOD = 'LR1' ;                                         0756 02653000
         MVC   DARGSMOD(3,@04),@CC00775                            0756 02654000
*       DARGSENT = 14 ;                                            0757 02655000
*                                                                  0757 02656000
         MVI   DARGSENT(@04),X'0E'                                 0757 02657000
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    0758 02658000
*                                                                  0758 02659000
         L     @04,@PC00001                                        0758 02660000
         ST    @04,@AL00001                                        0758 02661000
         LA    @03,IOCSPRT                                         0758 02662000
         ST    @03,@AL00001+4                                      0758 02663000
         LA    @03,DDSTRU                                          0758 02664000
         ST    @03,@AL00001+8                                      0758 02665000
         MVI   @AL00001+8,X'80'                                    0758 02666000
         L     @15,GDTPRT(,@04)                                    0758 02667000
         LA    @01,@AL00001                                        0758 02668000
         BALR  @14,@15                                             0758 02669000
*     END ;                                                        0759 02670000
* IF GDTDBG = NULLPTR                                              0760 02671000
*   THEN;                                                          0760 02672000
@RF00753 L     @04,@PC00001                                        0760 02673000
         L     @04,GDTDBG(,@04)                                    0760 02674000
         LTR   @04,@04                                             0760 02675000
         BZ    @RT00760                                            0760 02676000
*   ELSE                                                           0762 02677000
*     CALL IDCDB010 (GDTTBL,'LRZY') ;/*                            0762 02678000
*                                     DUMP ID IF ERROR CALLED        */ 02679000
         L     @04,@PC00001                                        0762 02680000
         ST    @04,@AL00001                                        0762 02681000
         LA    @03,@CC01260                                        0762 02682000
         ST    @03,@AL00001+4                                      0762 02683000
         MVI   @AL00001+4,X'80'                                    0762 02684000
         L     @15,GDTDBG(,@04)                                    0762 02685000
         LA    @01,@AL00001                                        0762 02686000
         BALR  @14,@15                                             0762 02687000
* IF GONOGO ^= 0 | ERRCNTIO = ERRLMT                               0763 02688000
*   THEN                                                           0763 02689000
@RT00760 L     @04,@PC00013+4                                      0763 02690000
         CLI   GONOGO(@04),0                                       0763 02691000
         BNE   @RT00763                                            0763 02692000
         CLI   ERRCNTIO,50                                         0763 02693000
         BNE   @RF00763                                            0763 02694000
@RT00763 DS    0H                                                  0764 02695000
*     DO ;                                                         0764 02696000
*       IF GDTDBG = NULLPTR                                        0765 02697000
*         THEN;                                                    0765 02698000
         L     @04,@PC00001                                        0765 02699000
         L     @04,GDTDBG(,@04)                                    0765 02700000
         LTR   @04,@04                                             0765 02701000
         BZ    @RT00765                                            0765 02702000
*         ELSE                                                     0767 02703000
*           CALL IDCDB010 (GDTTBL,'LRZZ') ;/*                      0767 02704000
*                                     DUMP ID ONLY IF ABORT          */ 02705000
         L     @04,@PC00001                                        0767 02706000
         ST    @04,@AL00001                                        0767 02707000
         LA    @03,@CC01261                                        0767 02708000
         ST    @03,@AL00001+4                                      0767 02709000
         MVI   @AL00001+4,X'80'                                    0767 02710000
         L     @15,GDTDBG(,@04)                                    0767 02711000
         LA    @01,@AL00001                                        0767 02712000
         BALR  @14,@15                                             0767 02713000
*       LASTCC = LASTCC12 ;                                        0768 02714000
*                                                                  0768 02715000
@RT00765 L     @04,@PC00001+8                                      0768 02716000
         MVC   LASTCC(2,@04),@CH00035                              0768 02717000
*         CALL IDCSAEP0(GDTTBL,MODID,LASTCC);         /* ABORT WHOLE FU 02718000
*CTION           */                                                0769 02719000
*                                                                  0769 02720000
         L     @03,@PC00001                                        0769 02721000
         ST    @03,@AL00001                                        0769 02722000
         LA    @15,MODID                                           0769 02723000
         ST    @15,@AL00001+4                                      0769 02724000
         ST    @04,@AL00001+8                                      0769 02725000
         MVI   @AL00001+8,X'80'                                    0769 02726000
         L     @15,GDTEPL(,@03)                                    0769 02727000
         LA    @01,@AL00001                                        0769 02728000
         BALR  @14,@15                                             0769 02729000
*     END ;                                                        0770 02730000
* DDSTRU = DDSTRUSV ;              /* REPLACE ASSUMED VALUE          */ 02731000
*                                                                  0771 02732000
@RF00763 ST    DDSTRUSV,DDSTRU                                     0771 02733000
*END ERROR ;                                                       0772 02734000
@EL00013 DS    0H                                                  0772 02735000
@EF00013 DS    0H                                                  0772 02736000
@ER00013 LM    @14,@12,@SA00013                                    0772 02737000
         BR    @14                                                 0772 02738000
* /*******************************************************************/ 02739000
* /* PROCEDURE NAME - GETPRT, GET AND CALL FOR PRINT RECORD(S        */ 02740000
* /* FUNCTION -                                                      */ 02741000
* /*   GET THE CRA COPY OF THE RECORD,                               */ 02742000
* /*   CALL FIELD MGMT FOR FIELDS LISTED BELOW,                      */ 02743000
* /*   IGNORE FREESPACE RECORDS UNLESS DUMP AND NOCOMPARE,           */ 02744000
* /*   CALL BUFSHUF TO MOVE RECORD TO ITS 'HOME' BUFFER,             */ 02745000
* /*   IF COMPARE SPECIFIED GET THE ORIGINAL CATALOG RECORD,         */ 02746000
* /*   CALL PRTCMP TO DO PRINTING (AND OPTIONAL COMPARING)           */ 02747000
* /* INPUTS -                                                        */ 02748000
* /*   CIFRGET (IDENTIFIES RECORD WANTED)                            */ 02749000
* /*   CRA                                                           */ 02750000
* /*   CATALOG                                                       */ 02751000
* /* OUTPUTS -                                                       */ 02752000
* /* CALLS -                                                         */ 02753000
* /*   UGET, BUFSHUF, PRTCMP, ERROR,                                 */ 02754000
* /*   IDCRC04(ENTNAME, ENTYPE)                                      */ 02755000
* /*******************************************************************/ 02756000
*                                                                  0773 02757000
*GETPRT: PROCEDURE ;                                               0773 02758000
GETPRT   STM   @14,@12,@SA00014                                    0773 02759000
*   OLDERID2 = NEWERID2;                                           0774 02760000
         L     @15,@PC00001                                        0774 02761000
         L     @14,GDTTR2(,@15)                                    0774 02762000
         MVC   @TS00001(95),NEWERID2(@14)                          0774 02763000
         MVC   OLDERID2(95,@14),@TS00001                           0774 02764000
*   NEWID2 = 'LRGE' ;                                              0775 02765000
         MVC   NEWID2(4,@14),@CC01265                              0775 02766000
*   IF GDTDBG = NULLPTR                                            0776 02767000
*     THEN;                                                        0776 02768000
         L     @15,GDTDBG(,@15)                                    0776 02769000
         LTR   @15,@15                                             0776 02770000
         BZ    @RT00776                                            0776 02771000
*     ELSE                                                         0778 02772000
*       CALL IDCDB010 (GDTTBL,'LRGE') ;                            0778 02773000
*                                                                  0778 02774000
         L     @15,@PC00001                                        0778 02775000
         ST    @15,@AL00001                                        0778 02776000
         LA    @14,@CC01265                                        0778 02777000
         ST    @14,@AL00001+4                                      0778 02778000
         MVI   @AL00001+4,X'80'                                    0778 02779000
         L     @15,GDTDBG(,@15)                                    0778 02780000
         LA    @01,@AL00001                                        0778 02781000
         BALR  @14,@15                                             0778 02782000
*   IOBFSPTR = IOCRBPTR ;                                          0779 02783000
@RT00776 L     @15,IOCRBPTR                                        0779 02784000
         ST    @15,IOBFSPTR                                        0779 02785000
*   DO BUFNO = 1 TO NBRBUF         /* SEE IF ALREADY IN BUFF         */ 02786000
*      WHILE (CIFRGET ^= IOBUFCI(BUFNO)) ;                         0780 02787000
         LA    @15,1                                               0780 02788000
         STC   @15,BUFNO                                           0780 02789000
@DL00780 LR    @14,@15                                             0780 02790000
         SLA   @14,9                                               0780 02791000
         L     @01,IOBFSPTR                                        0780 02792000
         ALR   @01,@14                                             0780 02793000
         AL    @01,@CF01466                                        0780 02794000
         CLC   CIFRGET(3),IOBUFCI-509(@01)                         0780 02795000
         BE    @DC00780                                            0780 02796000
*   END ;                                                          0781 02797000
         AL    @15,@CF00222                                        0781 02798000
         STC   @15,BUFNO                                           0781 02799000
         C     @15,@CF00047                                        0781 02800000
         BNH   @DL00780                                            0781 02801000
@DC00780 DS    0H                                                  0782 02802000
*   IF BUFNO ^= NBRBUF + 1                                         0782 02803000
*     THEN TESTRC = 0 ;            /* FOUND-DO NOT DO GET            */ 02804000
         CLI   BUFNO,5                                             0782 02805000
         BE    @RF00782                                            0782 02806000
         SLR   @15,@15                                             0783 02807000
         STH   @15,TESTRC                                          0783 02808000
*     ELSE                         /* NOT FOUND                      */ 02809000
*       DO ;                                                       0784 02810000
         B     @RC00782                                            0784 02811000
@RF00782 DS    0H                                                  0785 02812000
*         BUFNO = NBRBUF ;         /* USE LAST BUFFER                */ 02813000
         MVI   BUFNO,X'04'                                         0785 02814000
*         IOCSPTR = IOCSCRA ;      /* SET UP TO GET CRA RCD          */ 02815000
         L     IOCSPTR,IOCSCRA                                     0786 02816000
*         IOCRBA = CIFRGET * CATCISZ ;                             0787 02817000
*                                                                  0787 02818000
         L     @02,CIFRGET-1                                       0787 02819000
         LA    @02,0(,@02)                                         0787 02820000
         SLA   @02,9                                               0787 02821000
         ST    @02,IOCRBA(,IOCSPTR)                                0787 02822000
*         CALL IDCIOGT0 (GDTTBL,IOCSCRA) ;                         0788 02823000
*                                                                  0788 02824000
         L     @02,@PC00001                                        0788 02825000
         ST    @02,@AL00001                                        0788 02826000
         LA    @15,IOCSCRA                                         0788 02827000
         ST    @15,@AL00001+4                                      0788 02828000
         MVI   @AL00001+4,X'80'                                    0788 02829000
         L     @15,GDTGET(,@02)                                    0788 02830000
         LA    @01,@AL00001                                        0788 02831000
         BALR  @14,@15                                             0788 02832000
*         RESPECIFY RTNREG RSTD;                                   0789 02833000
*         TESTRC = RTNREG;                                         0790 02834000
         STH   RTNREG,TESTRC                                       0790 02835000
*         RESPECIFY RTNREG UNRSTD ;                                0791 02836000
*         IF TESTRC = 0                                            0792 02837000
*           THEN                                                   0792 02838000
         LH    @02,TESTRC                                          0792 02839000
         LTR   @02,@02                                             0792 02840000
         BNZ   @RF00792                                            0792 02841000
*             DO ;                 /* MOVE INTO BUFFER               */ 02842000
*               IOBUF(BUFNO,1:256) = IOBUFDMY(1:256) ;             0794 02843000
         L     @02,IOBFSPTR                                        0794 02844000
         SLR   @15,@15                                             0794 02845000
         IC    @15,BUFNO                                           0794 02846000
         SLA   @15,9                                               0794 02847000
         ST    @15,@TF00001                                        0794 02848000
         ALR   @15,@02                                             0794 02849000
         AL    @15,@CF01464                                        0794 02850000
         L     @14,IOCDAD(,IOCSPTR)                                0794 02851000
         MVC   IOBUF(256,@15),IOBUFDMY(@14)                        0794 02852000
*               IOBUF(BUFNO,257:508) = IOBUFDMY(257:508) ;         0795 02853000
         LR    @01,@02                                             0795 02854000
         AL    @01,@TF00001                                        0795 02855000
         AL    @01,@CF01465                                        0795 02856000
         MVC   IOBUF(252,@01),IOBUFDMY+256(@14)                    0795 02857000
*               IOBUFCI(BUFNO) = CIFRGET ;                         0796 02858000
         AL    @02,@TF00001                                        0796 02859000
         AL    @02,@CF01466                                        0796 02860000
         MVC   IOBUFCI-509(3,@02),CIFRGET                          0796 02861000
*             END ;                /* AND ADD CI FOR SEARCH          */ 02862000
*       END ;                                                      0798 02863000
@RF00792 DS    0H                                                  0799 02864000
*   IF TESTRC = 0                                                  0799 02865000
*     THEN                                                         0799 02866000
@RC00782 LH    @15,TESTRC                                          0799 02867000
         LTR   @15,@15                                             0799 02868000
         BNZ   @RF00799                                            0799 02869000
*       DO ;                                                       0800 02870000
*         IF SDUMPSW ^= ON                                         0801 02871000
*           THEN                                                   0801 02872000
         TM    SDUMPSW,B'00000010'                                 0801 02873000
         BO    @RF00801                                            0801 02874000
*             DO ;                                                 0802 02875000
*               FMPLFLNO = 2 ;     /* SET UP TO GET 2 FIELDS         */ 02876000
         L     @15,FMPLAD                                          0803 02877000
         MVI   FMPLFLNO(@15),X'02'                                 0803 02878000
*               IF CIFRGET > CTTBASE & FMUFRSP ^= ON               0804 02879000
*                 THEN FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;      0804 02880000
         L     @14,CIFRGET-1                                       0804 02881000
         LA    @14,0(,@14)                                         0804 02882000
         C     @14,@CF00039                                        0804 02883000
         BNH   @RF00804                                            0804 02884000
         TM    FMUFRSP,B'00100000'                                 0804 02885000
         BO    @RF00804                                            0804 02886000
         SLA   @14,3                                               0805 02887000
         L     @01,CTTPTR                                          0805 02888000
         ALR   @01,@14                                             0805 02889000
         AL    @01,@CF01478                                        0805 02890000
         MVC   FMPLBCIN(3,@15),CTTCATCI-5(@01)                     0805 02891000
*                 ELSE FMPLBCIN = CIFRGET ;                        0806 02892000
         B     @RC00804                                            0806 02893000
@RF00804 L     @01,FMPLAD                                          0806 02894000
         MVC   FMPLBCIN(3,@01),CIFRGET                             0806 02895000
*               FMFLDNAM = ADDR('ENTNAME ') ;                      0807 02896000
@RC00804 LA    @15,@CC01195                                        0807 02897000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0807 02898000
*               FMPLFMFL(2) -> FMFLDNAM = ADDR('ENTYPE  ') ;       0808 02899000
         L     @15,FMPLAD                                          0808 02900000
         L     @01,FMPLFMFL+4(,@15)                                0808 02901000
         LA    @00,@CC01234                                        0808 02902000
         ST    @00,FMFLDNAM(,@01)                                  0808 02903000
*               REG1 = FMPLAD ;                                    0809 02904000
*                                                                  0809 02905000
         LR    REG1,@15                                            0809 02906000
*               CALL IDCRC04 ;                                     0810 02907000
*                                                                  0810 02908000
         L     @15,@CV00793                                        0810 02909000
         BALR  @14,@15                                             0810 02910000
*               FMPLFLNO = 1 ;                                     0811 02911000
         L     @15,FMPLAD                                          0811 02912000
         MVI   FMPLFLNO(@15),X'01'                                 0811 02913000
*               ENTYPSAV = FMPLFMFL(2) -> FMFLADDR(1) -> ENTYPE ;  0812 02914000
         L     @01,FMPLFMFL+4(,@15)                                0812 02915000
         L     @01,FMFLADDR(,@01)                                  0812 02916000
         MVC   ENTYPSAV(1),ENTYPE(@01)                             0812 02917000
*             END ;                                                0813 02918000
*         IF FMPLFMFL(2) -> FMFLENTH ^= 0 | SDUMPSW = ON           0814 02919000
*           THEN                                                   0814 02920000
@RF00801 L     @01,FMPLAD                                          0814 02921000
         L     @01,FMPLFMFL+4(,@01)                                0814 02922000
         L     @15,FMFLENTH(,@01)                                  0814 02923000
         LTR   @15,@15                                             0814 02924000
         BNZ   @RT00814                                            0814 02925000
         TM    SDUMPSW,B'00000010'                                 0814 02926000
         BNO   @RF00814                                            0814 02927000
@RT00814 DS    0H                                                  0815 02928000
*             IF      SDUMPSW ^= ON                                0815 02929000
*                &  ENTYPSAV = CATRCTYP($FRSP)                     0815 02930000
*                & (DUMPSW = OFF                                   0815 02931000
*                 |  CMPRSW = ON)                                  0815 02932000
*               THEN ;             /* IGNORE FREESPACE RECORD        */ 02933000
         TM    SDUMPSW,B'00000010'                                 0815 02934000
         BO    @RF00815                                            0815 02935000
         SLR   @15,@15                                             0815 02936000
         IC    @15,$FRSP                                           0815 02937000
         MH    @15,@CH00042                                        0815 02938000
         LA    @14,CATRCTYP-5(@15)                                 0815 02939000
         CLC   ENTYPSAV(1),0(@14)                                  0815 02940000
         BNE   @RF00815                                            0815 02941000
         TM    CMPRSW,B'01000000'                                  0815 02942000
         BNZ   @RT00815                                            0815 02943000
         TM    DUMPSW,B'00000100'                                  0815 02944000
         BNO   @RT00815                                            0815 02945000
*               ELSE                                               0817 02946000
*                 DO ;                                             0817 02947000
@RF00815 DS    0H                                                  0818 02948000
*                   IF  SDUMPSW ^= ON & BUFNO = NBRBUF             0818 02949000
*                                       /* IF RCD IN LAST BUF        */ 02950000
*                     THEN CALL BUFSHUF;/* MOVE RCD TO 'HOME'        */ 02951000
         TM    SDUMPSW,B'00000010'                                 0818 02952000
         BO    @RF00818                                            0818 02953000
         CLI   BUFNO,4                                             0818 02954000
         BNE   @RF00818                                            0818 02955000
         BAL   @14,BUFSHUF                                         0819 02956000
*                   TESTRC = 0 ;                                   0820 02957000
@RF00818 SLR   @15,@15                                             0820 02958000
         STH   @15,TESTRC                                          0820 02959000
*                   IF CMPRSW = ON      /* IF COMPARE GET THE        */ 02960000
*                     THEN              /* CATALOG RECORD TOO        */ 02961000
         TM    CMPRSW,B'01000000'                                  0821 02962000
         BNO   @RF00821                                            0821 02963000
*                       DO ;                                       0822 02964000
*                         IOBFSPTR = IOCTBPTR ;                    0823 02965000
         L     @02,IOCTBPTR                                        0823 02966000
         ST    @02,IOBFSPTR                                        0823 02967000
*                         IOCSPTR = IOCSCAT ;                      0824 02968000
         L     IOCSPTR,IOCSCAT                                     0824 02969000
*                         CATCI = CTTCATCI(CIFRGET-CTTBASE) ;      0825 02970000
         L     @15,CIFRGET-1                                       0825 02971000
         LA    @15,0(,@15)                                         0825 02972000
         SLA   @15,3                                               0825 02973000
         L     @01,CTTPTR                                          0825 02974000
         AL    @01,@CF01469                                        0825 02975000
         L     @15,CTTCATCI-5(@15,@01)                             0825 02976000
         LA    @15,0(,@15)                                         0825 02977000
         STCM  @15,7,CATCI                                         0825 02978000
*                         IOCRBA = CATCI * CATCISZ ;               0826 02979000
         SLA   @15,9                                               0826 02980000
         ST    @15,IOCRBA(,IOCSPTR)                                0826 02981000
*                         IF CATCI ^= IOBUFCI(BUFNO)               0827 02982000
*                           THEN        /* NOT ALREADY IN            */ 02983000
         SLR   @15,@15                                             0827 02984000
         IC    @15,BUFNO                                           0827 02985000
         SLA   @15,9                                               0827 02986000
         ALR   @02,@15                                             0827 02987000
         AL    @02,@CF01466                                        0827 02988000
         CLC   CATCI(3),IOBUFCI-509(@02)                           0827 02989000
         BE    @RF00827                                            0827 02990000
*                             DO ;      /* BUFFER SO GET IT          */ 02991000
*                                                                  0828 02992000
*                               CALL IDCIOGT0 (GDTTBL,IOCSCAT) ;   0829 02993000
*                                                                  0829 02994000
         L     @02,@PC00001                                        0829 02995000
         ST    @02,@AL00001                                        0829 02996000
         LA    @15,IOCSCAT                                         0829 02997000
         ST    @15,@AL00001+4                                      0829 02998000
         MVI   @AL00001+4,X'80'                                    0829 02999000
         L     @15,GDTGET(,@02)                                    0829 03000000
         LA    @01,@AL00001                                        0829 03001000
         BALR  @14,@15                                             0829 03002000
*                               RESPECIFY RTNREG RSTD;             0830 03003000
*                               TESTRC = RTNREG;                   0831 03004000
         STH   RTNREG,TESTRC                                       0831 03005000
*                               RESPECIFY RTNREG UNRSTD ;          0832 03006000
*                               IF TESTRC = 0                      0833 03007000
*                                 THEN  /* MOVE TO BUFFER            */ 03008000
         LH    @02,TESTRC                                          0833 03009000
         LTR   @02,@02                                             0833 03010000
         BNZ   @RF00833                                            0833 03011000
*                                   DO ;                           0834 03012000
*                                     IOBUF(BUFNO,1:256) =         0835 03013000
*                                       IOBUFDMY(1:256) ;          0835 03014000
         L     @02,IOBFSPTR                                        0835 03015000
         SLR   @15,@15                                             0835 03016000
         IC    @15,BUFNO                                           0835 03017000
         SLA   @15,9                                               0835 03018000
         ST    @15,@TF00001                                        0835 03019000
         ALR   @15,@02                                             0835 03020000
         AL    @15,@CF01464                                        0835 03021000
         L     @14,IOCDAD(,IOCSPTR)                                0835 03022000
         MVC   IOBUF(256,@15),IOBUFDMY(@14)                        0835 03023000
*                                     IOBUF(BUFNO,257:508) =       0836 03024000
*                                       IOBUFDMY(257:508) ;        0836 03025000
         LR    @01,@02                                             0836 03026000
         AL    @01,@TF00001                                        0836 03027000
         AL    @01,@CF01465                                        0836 03028000
         MVC   IOBUF(252,@01),IOBUFDMY+256(@14)                    0836 03029000
*                                     IOBUFCI(BUFNO) = CATCI ;     0837 03030000
         AL    @02,@TF00001                                        0837 03031000
         AL    @02,@CF01466                                        0837 03032000
         MVC   IOBUFCI-509(3,@02),CATCI                            0837 03033000
*                                   END;     /* AND SET CI           */ 03034000
*                                 ELSE                             0839 03035000
*                                   DO;  /* CAT GET FAILED           */ 03036000
         B     @RC00833                                            0839 03037000
@RF00833 DS    0H                                                  0840 03038000
*                                     CALL ERROR (13,$RETURN) ;    0840 03039000
         LA    @01,@AL00840                                        0840 03040000
         BAL   @14,ERROR                                           0840 03041000
*                                     NOCATRSW = ON ;              0841 03042000
         OI    NOCATRSW,B'00000010'                                0841 03043000
*                                   END ;                          0842 03044000
*                             END ;                                0843 03045000
@RC00833 DS    0H                                                  0844 03046000
*                       END ;                                      0844 03047000
@RF00827 DS    0H                                                  0845 03048000
*                                  /**************************       */ 03049000
*                   CALL PRTCMP ;  /* GO PRINT IT OR THEM            */ 03050000
@RF00821 BAL   @14,PRTCMP                                          0845 03051000
*                                  /**************************       */ 03052000
*                   NOCATRSW = OFF ;                               0846 03053000
         NI    NOCATRSW,B'11111101'                                0846 03054000
*                 END ;                                            0847 03055000
*           ELSE                                           /*@OZ09388*/ 03056000
*             DO;                                          /*@OZ09388*/ 03057000
         B     @RC00814                                            0848 03058000
@RF00814 DS    0H                                                  0849 03059000
*                PROCMSG='GETPRT  '; /* PROC NAME FOR INSERT @OZ09388*/ 03060000
         MVC   PROCMSG(8),@CC01267                                 0849 03061000
*                CALL ERROR(14,$RETURN); /* FLD MGMT ERR RTN @OZ09388*/ 03062000
         LA    @01,@AL00850                                        0850 03063000
         BAL   @14,ERROR                                           0850 03064000
*             END;                                         /*@OZ09388*/ 03065000
*       END ;                                                      0852 03066000
*     ELSE CALL ERROR (15,$RETURN);/* CRA GET FAILED                 */ 03067000
*                                                                  0853 03068000
         B     @RC00799                                            0853 03069000
@RF00799 LA    @01,@AL00853                                        0853 03070000
         BAL   @14,ERROR                                           0853 03071000
*END GETPRT ;                                                      0854 03072000
@EL00014 DS    0H                                                  0854 03073000
@EF00014 DS    0H                                                  0854 03074000
@ER00014 LM    @14,@12,@SA00014                                    0854 03075000
         BR    @14                                                 0854 03076000
* /*******************************************************************/ 03077000
* /* PROCEDURE NAME - INITLZE, INITILIZE LISTCRA FSR                 */ 03078000
* /* FUNCTION -                                                      */ 03079000
* /*   INITIALIZE MISCELLANEOUS,                                     */ 03080000
* /*   SWITCHES,                                                     */ 03081000
* /*   SET UP I/O ADAPTER STUFF,                                     */ 03082000
* /*   SET UP TEXT PROCESSOR STUFF (OS ONLY - INCLUDING OPEN         */ 03083000
* /*   OF ALTERNATE OUTPUT FILE IF OUTFILE WAS SPECIFIED),           */ 03084000
* /*   (OS ONLY - SET UP SYSTEM ADAPTER STUFF),                      */ 03085000
* /*   SET UP FIELD MANAGEMENT STUFF,                                */ 03086000
* /*   GET STORAGE FOR TABLES AND BUFFERS,                           */ 03087000
* /*   INITIALIZE TABLE OF SUMS OF ENTRIES PROCESSED                 */ 03088000
* /* INPUTS -                                                        */ 03089000
* /* OUTPUTS -                                                       */ 03090000
* /* CALLS -                                                         */ 03091000
* /*   UGPOOL, SUMIT, ERROR                                          */ 03092000
* /*******************************************************************/ 03093000
*                                                                  0855 03094000
*INITLZE: PROCEDURE ;                                              0855 03095000
INITLZE  STM   @14,@02,@SA00015                                    0855 03096000
         STM   @05,@12,@SA00015+20                                 0855 03097000
* OLDERID2 = NEWERID2;                                             0856 03098000
         L     @04,@PC00001                                        0856 03099000
         L     @15,GDTTR2(,@04)                                    0856 03100000
         MVC   @TS00001(95),NEWERID2(@15)                          0856 03101000
         MVC   OLDERID2(95,@15),@TS00001                           0856 03102000
* NEWID2 = 'LRIN' ;                                                0857 03103000
         MVC   NEWID2(4,@15),@CC01271                              0857 03104000
* IF GDTDBG = NULLPTR                                              0858 03105000
*   THEN;                                                          0858 03106000
         L     @04,GDTDBG(,@04)                                    0858 03107000
         LTR   @04,@04                                             0858 03108000
         BZ    @RT00858                                            0858 03109000
*   ELSE                                                           0860 03110000
*     CALL IDCDB010 (GDTTBL,'LRIN') ;                              0860 03111000
*                                                                  0860 03112000
         L     @04,@PC00001                                        0860 03113000
         ST    @04,@AL00001                                        0860 03114000
         LA    @15,@CC01271                                        0860 03115000
         ST    @15,@AL00001+4                                      0860 03116000
         MVI   @AL00001+4,X'80'                                    0860 03117000
         L     @15,GDTDBG(,@04)                                    0860 03118000
         LA    @01,@AL00001                                        0860 03119000
         BALR  @14,@15                                             0860 03120000
* LRLASTCC = 0 ;                   /* INITIALIZE NEEDED VALUS        */ 03121000
@RT00858 SLR   @04,@04                                             0861 03122000
         STH   @04,LRLASTCC                                        0861 03123000
* ERRCNTIO = 0 ;                                                   0862 03124000
*                                                                  0862 03125000
         MVI   ERRCNTIO,X'00'                                      0862 03126000
* CALL SUMIT (SMINIT) ;                                            0863 03127000
*                                                                  0863 03128000
         LA    @01,@AL00863                                        0863 03129000
         BAL   @14,SUMIT                                           0863 03130000
* ENQCON = '00' ;                  /* INIT DUE TO REENTRANT          */ 03131000
         MVC   ENQCON(2),@CC01272                                  0864 03132000
* SWNAME = 'SWITCHES' ;            /* I.E. PLS DOES NOT              */ 03133000
         MVC   SWNAME(8),@CC01273                                  0865 03134000
* TIMLENWA = 24 ;                  /* INITIAL STRUCTURES             */ 03135000
         MVC   TIMLENWA(2),@CH00312                                0866 03136000
* TSTPTR = ADDR(TIMSTMPS) ;                                        0867 03137000
         LA    @04,TIMSTMPS                                        0867 03138000
         ST    @04,TSTPTR                                          0867 03139000
* IOCSALT = 0 ;                    /* SET IOCSALT PTR TO 0   @OZ26096*/ 03140000
         SLR   @04,@04                                             0868 03141000
         ST    @04,IOCSALT                                         0868 03142000
* DO MOSLOT = 1 TO 12 ;                                            0869 03143000
         LA    MOSLOT,1                                            0869 03144000
@DL00869 DS    0H                                                  0870 03145000
*   TSTMDTBL(MOSLOT) = TSTMDINT(MOSLOT) ;                          0870 03146000
         SLR   @04,@04                                             0870 03147000
         IC    @04,TSTMDINT-1(MOSLOT)                              0870 03148000
         STC   @04,TSTMDTBL-1(MOSLOT)                              0870 03149000
* END ;                                                            0871 03150000
         AL    MOSLOT,@CF00222                                     0871 03151000
         C     MOSLOT,@CF00035                                     0871 03152000
         BNH   @DL00869                                            0871 03153000
* POOLNM = 'POOL' ;                                                0872 03154000
         MVC   POOLNM(4),@CC01274                                  0872 03155000
* IOBADNAM = 'BUFFADDR' ;                                          0873 03156000
         MVC   IOBADNAM(8),@CC01275                                0873 03157000
* CISNAME = 'CIS' ;                                                0874 03158000
         MVI   CISNAME+3,C' '                                      0874 03159000
         MVC   CISNAME(3),@CC01276                                 0874 03160000
*                                  /*************************        */ 03161000
*                                  /* SET UP SWITCHES                */ 03162000
*                                  /*************************        */ 03163000
* SWITCHES = '0'B ;                /* TURN THEM ALL OFF FIRST        */ 03164000
         XC    SWITCHES+1(3),SWITCHES+1                            0875 03165000
         MVI   SWITCHES,B'00000000'                                0875 03166000
* IF ADDR(DUMP) ^= '0'B                                            0876 03167000
*   THEN                                                           0876 03168000
         L     @04,@PC00001+4                                      0876 03169000
         L     @04,FDTPTR+12(,@04)                                 0876 03170000
         LTR   @04,@04                                             0876 03171000
         BZ    @RF00876                                            0876 03172000
*     DUMPSW = ON ;                                                0877 03173000
         OI    DUMPSW,B'00000100'                                  0877 03174000
* IF ADDR(SDUMP) ^= '0'B                                           0878 03175000
*   THEN                                                           0878 03176000
@RF00876 L     @04,@PC00001+4                                      0878 03177000
         L     @04,FDTPTR+40(,@04)                                 0878 03178000
         LTR   @04,@04                                             0878 03179000
         BZ    @RF00878                                            0878 03180000
*     SDUMPSW = ON ;                                               0879 03181000
         OI    SDUMPSW,B'00000010'                                 0879 03182000
*                                  /*************************        */ 03183000
*                                  /* I/O ADAPTER STUFF              */ 03184000
*                                  /*************************        */ 03185000
* OPNPTR = ADDR(OPNAGLST) ;        /* OPEN ARGUMENT LIST             */ 03186000
@RF00878 LA    OPNPTR,OPNAGLST                                     0880 03187000
* IOINBPTR = ADDR(IOINBYTE) ;      /* IOINFO OPTION BYTE             */ 03188000
         LA    IOINBPTR,IOINBYTE                                   0881 03189000
* IOINBYTE = '0'B ;                                                0882 03190000
         MVI   IOINBYTE,B'00000000'                                0882 03191000
*  IOINBPTR -> IOINFTMS = ON ;                                     0883 03192000
         OI    IOINFTMS(IOINBPTR),B'00001000'                      0883 03193000
*                                  /*************************        */ 03194000
*                                  /* TEXT PROCESSOR STUFF           */ 03195000
*                                  /*************************        */ 03196000
* IOCSPRT = '0'B ;                 /* TELL TO USE SYSTEM PRTN        */ 03197000
         SLR   @04,@04                                             0884 03198000
         ST    @04,IOCSPRT                                         0884 03199000
* IF ADDR(OFILE) ^= '0'B                                           0885 03200000
*   THEN                                                           0885 03201000
         L     @02,@PC00001+4                                      0885 03202000
         L     @02,FDTPTR+36(,@02)                                 0885 03203000
         CR    @02,@04                                             0885 03204000
         BE    @RF00885                                            0885 03205000
*     DO ;                                                         0886 03206000
*       OPNAGL = '0'B ;            /* SET UP TO OPEN                 */ 03207000
         XC    OPNAGL+1(47,OPNPTR),OPNAGL+1(OPNPTR)                0887 03208000
         MVI   OPNAGL(OPNPTR),B'00000000'                          0887 03209000
*        OPNOPTOT = ON ;        /* ALTERNATE PRINT FILE           */    03210000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0888 03211000
*        OPNMODAC = ON ;                                           0889 03212000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0889 03213000
*       OPNDDN = ADDR(OFILEVAL) ;                                  0890 03214000
         LA    @04,OFILEVAL(,@02)                                  0890 03215000
         ST    @04,OPNDDN(,OPNPTR)                                 0890 03216000
*       OPNIOC = ADDR(IOCSALT) ;                                   0891 03217000
         LA    @04,IOCSALT                                         0891 03218000
         ST    @04,OPNIOC(,OPNPTR)                                 0891 03219000
*       CALL IDCIOOP0 (GDTTBL,OPNAGL) ;                            0892 03220000
         L     @04,@PC00001                                        0892 03221000
         ST    @04,@AL00001                                        0892 03222000
         ST    OPNPTR,@AL00001+4                                   0892 03223000
         MVI   @AL00001+4,X'80'                                    0892 03224000
         L     @15,GDTOPN(,@04)                                    0892 03225000
         LA    @01,@AL00001                                        0892 03226000
         BALR  @14,@15                                             0892 03227000
*       RESPECIFY RTNREG RSTD;                                     0893 03228000
*       TESTRC = RTNREG;                                           0894 03229000
         STH   RTNREG,TESTRC                                       0894 03230000
*       RESPECIFY RTNREG UNRSTD ;                                  0895 03231000
*       IF TESTRC = 0                                              0896 03232000
*         THEN IOCSPRT = IOCSALT ;                                 0896 03233000
         LH    @04,TESTRC                                          0896 03234000
         LTR   @04,@04                                             0896 03235000
         BNZ   @RF00896                                            0896 03236000
         L     @04,IOCSALT                                         0897 03237000
         ST    @04,IOCSPRT                                         0897 03238000
*         ELSE                                             /*@OZ07569*/ 03239000
*            DO;                                           /*@OZ07569*/ 03240000
         B     @RC00896                                            0898 03241000
@RF00896 DS    0H                                                  0899 03242000
*              CALL CLEANUP;                               /*@OZ07569*/ 03243000
         BAL   @14,CLEANUP                                         0899 03244000
*              CALL ERROR (31,$ABORT);                     /*@OZ07569*/ 03245000
         LA    @01,@AL00900                                        0900 03246000
         BAL   @14,ERROR                                           0900 03247000
*            END;                                          /*@OZ07569*/ 03248000
*     END ;                                                        0902 03249000
@RC00896 DS    0H                                                  0903 03250000
* DDSTRU = ADDR(DARGLST) ;         /* TEXT PROCESSOR BASE            */ 03251000
@RF00885 LA    @04,DARGLST                                         0903 03252000
         ST    @04,DDSTRU                                          0903 03253000
* DDSTRUE = ADDR(DARGLSTE) ;       /* STRUCTURES, NRML, ERR          */ 03254000
*                                                                  0904 03255000
         LA    @04,DARGLSTE                                        0904 03256000
         ST    @04,DDSTRUE                                         0904 03257000
* DO SUBSLOT = 1 TO LENGTH(SUBTITLE) ;                             0905 03258000
         LA    SUBSLOT,1                                           0905 03259000
@DL00905 DS    0H                                                  0906 03260000
*   SUBTITLE(SUBSLOT) = ' ' ;                                      0906 03261000
         LA    @04,SUBTITLE-1(SUBSLOT)                             0906 03262000
         MVI   0(@04),C' '                                         0906 03263000
* END ;                            /* SET UP SUBTITLE                */ 03264000
         AL    SUBSLOT,@CF00222                                    0907 03265000
         CL    SUBSLOT,@CF01001                                    0907 03266000
         BNH   @DL00905                                            0907 03267000
* SUBTSPCT = '2' ;                                                 0908 03268000
         MVI   SUBTSPCT,C'2'                                       0908 03269000
* SUBT47 = 'LISTING OF CATALOG RECOVERY AREA FOR VOLUME --' ;      0909 03270000
         MVI   SUBT47+46,C' '                                      0909 03271000
         MVC   SUBT47(46),@CC01278                                 0909 03272000
* SUBT4 = ' -- ' ;                                                 0910 03273000
         MVC   SUBT4(4),@CC01282                                   0910 03274000
* PCARGLST = '0'B ;                /* INITIAL PAGE CONTROL           */ 03275000
         XC    PCARGLST+1(33),PCARGLST+1                           0911 03276000
         MVI   PCARGLST,B'00000000'                                0911 03277000
* PCSTLC = 1 ;                                                     0912 03278000
         LA    @02,1                                               0912 03279000
         STH   @02,PCSTLC                                          0912 03280000
* PCSTLP = ADDR(SUBTITLE) ;                                        0913 03281000
         LA    @15,SUBTITLE                                        0913 03282000
         ST    @15,PCSTLP                                          0913 03283000
* PCRSTT = 'ST' ;                  /* MODIFY PAGE CONTROL            */ 03284000
         MVC   PCRSTT(2),@CC01283                                  0914 03285000
* PCRSTLC = 1 ;                                                    0915 03286000
         STH   @02,PCRSTLC                                         0915 03287000
* PCRSTLP = ADDR(SUBTITLE) ;                                       0916 03288000
         ST    @15,PCRSTLP                                         0916 03289000
* RSVUTPTR = ADDR(RSVUTBL) ;                                       0917 03290000
         LA    @02,RSVUTBL                                         0917 03291000
         ST    @02,RSVUTPTR                                        0917 03292000
*                                  /*************************        */ 03293000
*                                  /* SET UP FIELD MANAGEMENT        */ 03294000
*                                  /*************************        */ 03295000
* FMPLAD = ADDR(FMPLST) ;          /* ADDR FLD MGMT PARM LIST        */ 03296000
         LA    @02,FMPLST                                          0918 03297000
         ST    @02,FMPLAD                                          0918 03298000
* FMPLFLNO = 1 ;                   /* SET UP FMPL TO ASSUMED         */ 03299000
         MVI   FMPLFLNO(@02),X'01'                                 0919 03300000
* FMPLGRTN = ADDR(IDCLR02) ;       /* CONFIGURATION                  */ 03301000
         L     @15,@CV00794                                        0920 03302000
         ST    @15,FMPLGRTN(,@02)                                  0920 03303000
* FMPLWKAR = ADDR(JUNK) ;          /* NOTE: CHANGED FIELDS           */ 03304000
         LA    @15,JUNK                                            0921 03305000
         ST    @15,FMPLWKAR(,@02)                                  0921 03306000
* FMPLENTH = 256 ;                 /* MUST BE RESTORED               */ 03307000
         MVC   FMPLENTH(2,@02),@CH00741                            0922 03308000
* FMPLOAR = ADDR(FMWA) ;                                           0923 03309000
         LA    @15,FMWA                                            0923 03310000
         ST    @15,FMPLOAR(,@02)                                   0923 03311000
* FMPLUPTR = ADDR(FMUDATA) ;                                       0924 03312000
*                                                                  0924 03313000
         LA    @15,FMUDATA                                         0924 03314000
         ST    @15,FMPLUPTR(,@02)                                  0924 03315000
* FMFLCUR = ADDR(FMFLST(NBRFMFL)); /* LAST FMFL SET TO BE            */ 03316000
         LA    FMFLCUR,FMFLST+96                                   0925 03317000
* FMFL = '0'B ;                    /* USED AS TEST ON RELREPN        */ 03318000
         XC    FMFL+1(15,FMFLCUR),FMFL+1(FMFLCUR)                  0926 03319000
         MVI   FMFL(FMFLCUR),B'00000000'                           0926 03320000
* FMFLDLNO = 1 ;                   /* TO GET ONLY 1 OCCURANCE        */ 03321000
         MVI   FMFLDLNO(FMFLCUR),X'01'                             0927 03322000
* FMFLTSTC = '20'X ;               /* TEST IS GT                     */ 03323000
         MVI   FMFLTSTC(FMFLCUR),X'20'                             0928 03324000
* FMFLDNAM = ADDR('RELREPNO') ;                                    0929 03325000
         LA    @15,@CC01285                                        0929 03326000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0929 03327000
* FMFLENTH(1) = LENGTH(RELREPNO) ;                                 0930 03328000
         LA    @15,2                                               0930 03329000
         ST    @15,FMFLENTH(,FMFLCUR)                              0930 03330000
* FMFLADDR(1) = ADDR(RELREPNO) ;                                   0931 03331000
         LA    @14,RELREPNO                                        0931 03332000
         ST    @14,FMFLADDR(,FMFLCUR)                              0931 03333000
* FMPLFMFL(NBRFMFL) = FMFLCUR ;                                    0932 03334000
         ST    FMFLCUR,FMPLFMFL+16(,@02)                           0932 03335000
* FMFLTCHN = ADDR(FMFLST(NBRFMFL-1)) ;  /* HOOK THESE TWO UP         */ 03336000
*                                                                  0933 03337000
         LA    @14,FMFLST+72                                       0933 03338000
         ST    @14,FMFLTCHN(,FMFLCUR)                              0933 03339000
* FMFLCUR =ADDR(FMFLST(NBRFMFL-1));/* LAST FMFL -1 SET TO BE         */ 03340000
         LR    FMFLCUR,@14                                         0934 03341000
* FMFL = '0'B ;                    /* USED AS TEST ON CNTREPN        */ 03342000
         XC    FMFL+1(15,FMFLCUR),FMFL+1(FMFLCUR)                  0935 03343000
         MVI   FMFL(FMFLCUR),B'00000000'                           0935 03344000
* FMFLDLNO = 1 ;                   /* RETRIEVE ONLY ONE OCCUR        */ 03345000
         MVI   FMFLDLNO(FMFLCUR),X'01'                             0936 03346000
* FMFLTSTC = '80'X ;               /* TEST IS EQUAL                  */ 03347000
         MVI   FMFLTSTC(FMFLCUR),X'80'                             0937 03348000
* FMFLDNAM = ADDR('CNTREPNO') ;                                    0938 03349000
         LA    @14,@CC01287                                        0938 03350000
         ST    @14,FMFLDNAM(,FMFLCUR)                              0938 03351000
* FMFLENTH(1) = LENGTH(CNTREPNO) ;                                 0939 03352000
         ST    @15,FMFLENTH(,FMFLCUR)                              0939 03353000
* FMFLADDR(1) = ADDR(CNTREPNO) ;                                   0940 03354000
         LA    @15,CNTREPNO                                        0940 03355000
         ST    @15,FMFLADDR(,FMFLCUR)                              0940 03356000
* FMPLFMFL(NBRFMFL-1) = FMFLCUR ;                                  0941 03357000
*                                                                  0941 03358000
         ST    FMFLCUR,FMPLFMFL+12(,@02)                           0941 03359000
* DO FMSLOT = NBRFMFL-2 TO 1 BY -1;/* POINT FMPL AT FIRST            */ 03360000
         LA    FMSLOT,3                                            0942 03361000
@DL00942 DS    0H                                                  0943 03362000
*   FMFLCUR = ADDR(FMFLST(FMSLOT));/* THRU LAST-2 FMFLS AND          */ 03363000
         LR    FMFLCUR,FMSLOT                                      0943 03364000
         MH    FMFLCUR,@CH00312                                    0943 03365000
         LA    FMFLCUR,FMFLST-24(FMFLCUR)                          0943 03366000
*   FMFL = '0'B ;                  /* INITIALIZE THE FMFLS           */ 03367000
         XC    FMFL+1(15,FMFLCUR),FMFL+1(FMFLCUR)                  0944 03368000
         MVI   FMFL(FMFLCUR),B'00000000'                           0944 03369000
*   FMPLFMFL(FMSLOT) = FMFLCUR ;                                   0945 03370000
         LR    @15,FMSLOT                                          0945 03371000
         SLA   @15,2                                               0945 03372000
         L     @01,FMPLAD                                          0945 03373000
         ST    FMFLCUR,FMPLFMFL-4(@15,@01)                         0945 03374000
* END ;                            /* LEAVE POINTED PROPERLY         */ 03375000
*                                                                  0946 03376000
         BCTR  FMSLOT,0                                            0946 03377000
         C     FMSLOT,@CF00222                                     0946 03378000
         BNL   @DL00942                                            0946 03379000
*                                  /* INITIALIZE THE                 */ 03380000
* FMUIOCSP = IOCSPRT ;             /* USER DATA STUFF                */ 03381000
         L     @02,IOCSPRT                                         0947 03382000
         ST    @02,FMUIOCSP                                        0947 03383000
* FMUDARGP = DDSTRUE ;             /* FOR FIELD MGMT I/O             */ 03384000
         L     @02,DDSTRUE                                         0948 03385000
         ST    @02,FMUDARGP                                        0948 03386000
* FMUGDTP = ADDR(GDTTBL) ;         /* ROUTINE TO ASSUMED VALUES      */ 03387000
         L     @02,@PC00001                                        0949 03388000
         ST    @02,FMUGDTP                                         0949 03389000
* FMUCTTP = '0'B ;                                                 0950 03390000
         SLR   @15,@15                                             0950 03391000
         ST    @15,FMUCTTP                                         0950 03392000
* FMUGETMN = ADDR(JUNK2) ;                                         0951 03393000
         LA    @15,JUNK2                                           0951 03394000
         ST    @15,FMUGETMN                                        0951 03395000
* FMUBUFNO = NBRBUF ;                                              0952 03396000
         MVI   FMUBUFNO,X'04'                                      0952 03397000
* FMUFLAGS = '0'B ;                                                0953 03398000
         MVI   FMUFLAGS,B'00000000'                                0953 03399000
* FMULR2CL = 0 ;                                                   0954 03400000
         SLR   @15,@15                                             0954 03401000
         STH   @15,FMULR2CL                                        0954 03402000
*                                  /* FMUBFPTR,FMUIOCSI SET LATER  0955 03403000
* */                                                               0955 03404000
* RELREPNO = 0 ;                                                   0955 03405000
         STH   @15,RELREPNO                                        0955 03406000
* CNTREPNO = 1 ;                                                   0956 03407000
         MVC   CNTREPNO(2),@CH00222                                0956 03408000
*                                                                  0957 03409000
*                                  /*************************        */ 03410000
*                                  /* GET SPACE FOR TABLES:          */ 03411000
*                                  /*************************        */ 03412000
* CALL IDCSAGP0 (GDTTBL,GPLEN1ST,ATRA2PTR,MODID,SETZERO) ;/*       0957 03413000
*                                                      3 TBLS        */ 03414000
         MVC   @AL00001+4(16),@AL00957                             0957 03415000
         ST    @02,@AL00001                                        0957 03416000
         LA    @15,ATRA2PTR                                        0957 03417000
         ST    @15,@AL00001+8                                      0957 03418000
         L     @15,GDTGPL(,@02)                                    0957 03419000
         LA    @01,@AL00001                                        0957 03420000
         BALR  @14,@15                                             0957 03421000
* RESPECIFY RTNREG RSTD;                                           0958 03422000
* TESTRC = RTNREG;                                                 0959 03423000
         STH   RTNREG,TESTRC                                       0959 03424000
* RESPECIFY RTNREG UNRSTD ;                                        0960 03425000
* IF TESTRC = 0                                                    0961 03426000
*   THEN                                                           0961 03427000
         LH    @02,TESTRC                                          0961 03428000
         LTR   @02,@02                                             0961 03429000
         BNZ   @RF00961                                            0961 03430000
*     DO ;                                                         0962 03431000
*       ATPTR = ATRA2PTR ;                   /*** ASSOCTBL **        */ 03432000
         L     @02,ATRA2PTR                                        0963 03433000
         ST    @02,ATPTR                                           0963 03434000
*       ATNAME = 'ASOC' ;                                          0964 03435000
         MVC   ATNAME(4,@02),@CC01177                              0964 03436000
*       A2PTR = ATPTR + LENGTH(ASSOCTBL) ;   /*** ASSOCTB2 **        */ 03437000
         LA    @15,44                                              0965 03438000
         ALR   @02,@15                                             0965 03439000
         ST    @02,A2PTR                                           0965 03440000
*       A2PTR -> A2NAME = 'ASO2' ;                                 0966 03441000
         MVC   A2NAME(4,@02),@CC01289                              0966 03442000
*       VEPTR = A2PTR + LENGTH(ASSOCTB2) ;   /*** VEXTTBL  **        */ 03443000
         ALR   @02,@15                                             0967 03444000
         ST    @02,VEPTR                                           0967 03445000
*       VENAME = 'VEXT' ;                                          0968 03446000
         MVC   VENAME(4,@02),@CC00733                              0968 03447000
*       VEPTRBEG = VEPTR ;                                         0969 03448000
         ST    @02,VEPTRBEG                                        0969 03449000
*     END ;                                                        0970 03450000
* IF TESTRC = 0                                                    0971 03451000
*   THEN                                                           0971 03452000
@RF00961 LH    @02,TESTRC                                          0971 03453000
         LTR   @02,@02                                             0971 03454000
         BNZ   @RF00971                                            0971 03455000
*     DO ;                                   /*** BUFFERS  **        */ 03456000
*       CALL IDCSAGP0 (GDTTBL,IOBFSLEN,IOBFSPTR,MODIDPG,SETZERO) ; 0973 03457000
         MVC   @AL00001+4(16),@AL00973                             0973 03458000
         L     @02,@PC00001                                        0973 03459000
         ST    @02,@AL00001                                        0973 03460000
         LA    @15,IOBFSPTR                                        0973 03461000
         ST    @15,@AL00001+8                                      0973 03462000
         L     @15,GDTGPL(,@02)                                    0973 03463000
         LA    @01,@AL00001                                        0973 03464000
         BALR  @14,@15                                             0973 03465000
*       RESPECIFY RTNREG RSTD;                                     0974 03466000
*       TESTRC = RTNREG;                                           0975 03467000
         STH   RTNREG,TESTRC                                       0975 03468000
*       RESPECIFY RTNREG UNRSTD ;                                  0976 03469000
*     END ;                                                        0977 03470000
* IF TESTRC = 0                                                    0978 03471000
*   THEN                           /* ABOVE STOS -> CRA BUFS         */ 03472000
@RF00971 LH    @02,TESTRC                                          0978 03473000
         LTR   @02,@02                                             0978 03474000
         BNZ   @RF00978                                            0978 03475000
*     DO ;                         /* BELOW STOS -> CAT BUFS         */ 03476000
*       IOCRBPTR = IOBFSPTR ;                                      0980 03477000
         L     @02,IOBFSPTR                                        0980 03478000
         ST    @02,IOCRBPTR                                        0980 03479000
*       FMUBFPTR = IOCRBPTR ;                                      0981 03480000
         ST    @02,FMUBFPTR                                        0981 03481000
*       IOCTBPTR = IOCRBPTR + NBRBUF * CATCISZ ;                   0982 03482000
         AL    @02,@CF01451                                        0982 03483000
         ST    @02,IOCTBPTR                                        0982 03484000
*     END ;                                                        0983 03485000
* IF TESTRC ^= 0                                                   0984 03486000
*   THEN CALL ERROR (NBRETE,$ABORT) ;   /* MEMORY TOO SMALL          */ 03487000
*                                                                  0984 03488000
@RF00978 LH    @02,TESTRC                                          0984 03489000
         LTR   @02,@02                                             0984 03490000
         BZ    @RF00984                                            0984 03491000
         LA    @01,@AL00985                                        0985 03492000
         BAL   @14,ERROR                                           0985 03493000
*END INITLZE ;                                                     0986 03494000
@EL00015 DS    0H                                                  0986 03495000
@EF00015 DS    0H                                                  0986 03496000
@ER00015 LM    @14,@02,@SA00015                                    0986 03497000
         LM    @05,@12,@SA00015+20                                 0986 03498000
         BR    @14                                                 0986 03499000
*                                                                  0987 03500000
* /*******************************************************************/ 03501000
* /* PROCEDURE NAME - INTASOC, INITIALIZ ASSOCTBL OR ASSOCTB2        */ 03502000
* /* FUNCTION -                                                      */ 03503000
* /*   CALL FIELD MANAGEMENT FOR NUMBER OF ASSOCIATIONS,             */ 03504000
* /*   REPEAT TILL ALL ASSOCIATIONS HAVE BEEN OBTAINED,              */ 03505000
* /*     CALL FIELD MGMT ASKING FOR TYPE AND NAME(CI,S)              */ 03506000
* /*     OF AN ASSOCIATION,                                          */ 03507000
* /*     MOVE INTO ASSOCTBL OR ASSOCTB2,                             */ 03508000
* /*     IF ASSOCTB IS FULL BUILD ANOTHER AND CHAIN THEM             */ 03509000
* /* INPUTS -                                                        */ 03510000
* /*   STARTING SLT NUMBER FOR INSERT (SOME ALREADY IN)              */ 03511000
* /*   ATORA2PTR HAS BEEN POINTED TO WHICH TABLE                     */ 03512000
* /*   CIFRGET (IDENTIFIES RECORD ASSOCS ARE TO BE FROM)             */ 03513000
* /* OUTPUTS -                                                       */ 03514000
* /*   ASSOCTBL OR ASSOCTB2                                          */ 03515000
* /* CALLS -                                                         */ 03516000
* /*   UGPOOL, ERROR, TCICTCR,                                       */ 03517000
* /*   IDCRC04(NAMEDS(TYPE & NAME(CATCI)), REPNO)                    */ 03518000
* /*******************************************************************/ 03519000
*                                                                  0987 03520000
*INTASOC: PROCEDURE (STRTSLOT) ;                                   0987 03521000
INTASOC  STM   @14,@12,@SA00016                                    0987 03522000
         MVC   @PC00016(4),0(@01)                                  0987 03523000
* OLDERID2 = NEWERID2;                                             0988 03524000
         L     @15,@PC00001                                        0988 03525000
         L     @14,GDTTR2(,@15)                                    0988 03526000
         MVC   @TS00001(95),NEWERID2(@14)                          0988 03527000
         MVC   OLDERID2(95,@14),@TS00001                           0988 03528000
* NEWID2 = 'LRIA' ;                                                0989 03529000
         MVC   NEWID2(4,@14),@CC01295                              0989 03530000
* IF GDTDBG = NULLPTR                                              0990 03531000
*   THEN;                                                          0990 03532000
         L     @15,GDTDBG(,@15)                                    0990 03533000
         LTR   @15,@15                                             0990 03534000
         BZ    @RT00990                                            0990 03535000
*   ELSE                                                           0992 03536000
*     CALL IDCDB010 (GDTTBL,'LRIA') ;                              0992 03537000
*                                                                  0992 03538000
         L     @15,@PC00001                                        0992 03539000
         ST    @15,@AL00001                                        0992 03540000
         LA    @14,@CC01295                                        0992 03541000
         ST    @14,@AL00001+4                                      0992 03542000
         MVI   @AL00001+4,X'80'                                    0992 03543000
         L     @15,GDTDBG(,@15)                                    0992 03544000
         LA    @01,@AL00001                                        0992 03545000
         BALR  @14,@15                                             0992 03546000
* DCL STRTSLOT FIXED(31) ;         /* STARTING SLOT FOR INSRT        */ 03547000
*                                                                  0993 03548000
@RT00990 DS    0H                                                  0994 03549000
* ATPTRSAV = ATRA2PTR ;            /* SAVE ADDR OF 1ST TABLE         */ 03550000
         L     @15,ATRA2PTR                                        0994 03551000
         ST    @15,ATPTRSAV                                        0994 03552000
* DO UNTIL  ATRA2PTR = 0;          /* LOOP THRU ALL TABLES   @OZ05941*/ 03553000
@DL00995 DS    0H                                                  0996 03554000
*   DO ATSLOTB = 1 TO NBRATS ;     /* ZERO ALL SLOTS IN TABLE        */ 03555000
         LA    ATSLOTB,1                                           0996 03556000
@DL00996 DS    0H                                                  0997 03557000
*     ATASOC(ATSLOTB) = '0'B ;                                     0997 03558000
         LR    @02,ATSLOTB                                         0997 03559000
         SLA   @02,2                                               0997 03560000
         L     @01,ATRA2PTR                                        0997 03561000
         ALR   @01,@02                                             0997 03562000
         XC    ATASOC-3(3,@01),ATASOC-3(@01)                       0997 03563000
         MVI   ATASOC-4(@01),B'00000000'                           0997 03564000
*   END ;                                                          0998 03565000
         AL    ATSLOTB,@CF00222                                    0998 03566000
         C     ATSLOTB,@CF00038                                    0998 03567000
         BNH   @DL00996                                            0998 03568000
*   ATRA2PTR=A2NXTTBL;             /* ADDRESS OF NEXT TABLE  @OZ05941*/ 03569000
         L     @01,ATRA2PTR                                        0999 03570000
         L     @15,A2NXTTBL(,@01)                                  0999 03571000
         ST    @15,ATRA2PTR                                        0999 03572000
* END;                                                     /*@OZ05941*/ 03573000
@DE00995 L     @15,ATRA2PTR                                        1000 03574000
         LTR   @15,@15                                             1000 03575000
         BNZ   @DL00995                                            1000 03576000
* ATRA2PTR=ATPTRSAV;              /* RESET TO ORIGINAL TABLE @OZ05941*/ 03577000
         L     @02,ATPTRSAV                                        1001 03578000
         ST    @02,ATRA2PTR                                        1001 03579000
* ATSLOTB = STRTSLOT - 1 ;                                         1002 03580000
         L     @15,@PC00016                                        1002 03581000
         L     ATSLOTB,STRTSLOT(,@15)                              1002 03582000
         BCTR  ATSLOTB,0                                           1002 03583000
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ; /* SET CI 4 FLD MGMT        */ 03584000
         L     @02,FMPLAD                                          1003 03585000
         L     @15,CIFRGET-1                                       1003 03586000
         LA    @15,0(,@15)                                         1003 03587000
         SLA   @15,3                                               1003 03588000
         L     @01,CTTPTR                                          1003 03589000
         ALR   @01,@15                                             1003 03590000
         AL    @01,@CF01478                                        1003 03591000
         MVC   FMPLBCIN(3,@02),CTTCATCI-5(@01)                     1003 03592000
* FMFLDNAM = ADDR('REPNO   ') ;                                    1004 03593000
         LA    @15,@CC01204                                        1004 03594000
         ST    @15,FMFLDNAM(,FMFLCUR)                              1004 03595000
* FMFLGRPC = CTASOCGC ;                                            1005 03596000
         MVI   FMFLGRPC(FMFLCUR),X'02'                             1005 03597000
* FMPLFMFL(NBRFMFL) -> FMFLGRPC = CTASOCGC ; /* RELREPNO AND         */ 03598000
         L     @01,FMPLFMFL+16(,@02)                               1006 03599000
         MVI   FMFLGRPC(@01),X'02'                                 1006 03600000
* FMPLFMFL(NBRFMFL-1) -> FMFLGRPC = CTASOCGC ;   /* CNTREPNO         */ 03601000
         L     @01,FMPLFMFL+12(,@02)                               1007 03602000
         MVI   FMFLGRPC(@01),X'02'                                 1007 03603000
* REG1 = FMPLAD ;                                                  1008 03604000
*                                                                  1008 03605000
         LR    REG1,@02                                            1008 03606000
* CALL IDCRC04 ;                   /* ASK NUMBER ASSOCIATIONS        */ 03607000
*                                                                  1009 03608000
         L     @15,@CV00793                                        1009 03609000
         BALR  @14,@15                                             1009 03610000
* IF FMFLENTH ^= 0                                                 1010 03611000
*   THEN NBRASOCS = REPNO ;        /* SAVE NBR ASSOCIATIONS          */ 03612000
         L     @02,FMFLENTH(,FMFLCUR)                              1010 03613000
         LTR   @02,@02                                             1010 03614000
         BZ    @RF01010                                            1010 03615000
         L     @02,FMFLADDR(,FMFLCUR)                              1011 03616000
         LH    @02,REPNO(,@02)                                     1011 03617000
         STH   @02,NBRASOCS                                        1011 03618000
*   ELSE                                                           1012 03619000
*     DO ;                         /* ERROR FROM FLD MGMT SO         */ 03620000
         B     @RC01010                                            1012 03621000
@RF01010 DS    0H                                                  1013 03622000
*       NBRASOCS = 0 ;             /* SET TO NO ASSOCIATIONS         */ 03623000
         SLR   @02,@02                                             1013 03624000
         STH   @02,NBRASOCS                                        1013 03625000
*       PROCMSG='INTASOC ';        /* PROC NAME FOR INSERT   @OZ09388*/ 03626000
         MVC   PROCMSG(8),@CC01296                                 1014 03627000
*       CALL ERROR (28,$RETURN) ;                                  1015 03628000
         LA    @01,@AL01015                                        1015 03629000
         BAL   @14,ERROR                                           1015 03630000
*     END ;                                                        1016 03631000
* FMFLDNAM = ADDR('NAMEDS  ') ;                                    1017 03632000
@RC01010 LA    @02,@CC01298                                        1017 03633000
         ST    @02,FMFLDNAM(,FMFLCUR)                              1017 03634000
* FMFLTCHN = ADDR(FMFLST(NBRFMFL));/* GET FLDS ONE AT A TIME         */ 03635000
*                                                                  1018 03636000
         LA    @02,FMFLST+96                                       1018 03637000
         ST    @02,FMFLTCHN(,FMFLCUR)                              1018 03638000
* /*******************************************************************/ 03639000
* /* LOOP: GET ALL OF THE ASSOCIATIONS AND PUT IN TABLE              */ 03640000
* /*******************************************************************/ 03641000
*                                                                  1019 03642000
* DO WHILE (RELREPNO < NBRASOCS) ;                                 1019 03643000
         B     @DE01019                                            1019 03644000
@DL01019 DS    0H                                                  1020 03645000
*   REG1 = FMPLAD ;                                                1020 03646000
*                                                                  1020 03647000
         L     REG1,FMPLAD                                         1020 03648000
*   CALL IDCRC04 ;                 /* ASK TYPE AND ASOC CI           */ 03649000
*                                                                  1021 03650000
         L     @15,@CV00793                                        1021 03651000
         BALR  @14,@15                                             1021 03652000
*   IF FMFLENTH ^= 0                                               1022 03653000
*     THEN                                                         1022 03654000
         SLR   @02,@02                                             1022 03655000
         C     @02,FMFLENTH(,FMFLCUR)                              1022 03656000
         BE    @RF01022                                            1022 03657000
*       DO ;                                                       1023 03658000
*         CIFRTRNS = NAMECI ;                                      1024 03659000
         L     @01,FMFLADDR(,FMFLCUR)                              1024 03660000
         MVC   CIFRTRNS(3),NAMECI(@01)                             1024 03661000
*         LRTEMPCC = 0 ;                                           1025 03662000
*                                                                  1025 03663000
         STH   @02,LRTEMPCC                                        1025 03664000
*         CALL TCICTCR (LRTEMPCC) ;     /* TRANSLATE FROM            */ 03665000
         LA    @02,LRTEMPCC                                        1026 03666000
         ST    @02,@AL00001                                        1026 03667000
         LA    @01,@AL00001                                        1026 03668000
         BAL   @14,TCICTCR                                         1026 03669000
*                                       /* CRA TO CATALOG CI         */ 03670000
*         IF LRTEMPCC = 0                                          1027 03671000
*           THEN                                                   1027 03672000
         LH    @02,LRTEMPCC                                        1027 03673000
         LTR   @02,@02                                             1027 03674000
         BNZ   @RF01027                                            1027 03675000
*             DO ;                                                 1028 03676000
*               ATSLOTB = ATSLOTB+ 1 ;  /* BUMP NEXT TBL SLOT        */ 03677000
         LA    ATSLOTB,1(,ATSLOTB)                                 1029 03678000
*               IF ATSLOTB > NBRATS                                1030 03679000
*                 THEN                                             1030 03680000
         C     ATSLOTB,@CF00038                                    1030 03681000
         BNH   @RF01030                                            1030 03682000
*                   DO ;           /* NEED ANOTHER ASSOCTB           */ 03683000
*                     IF ATNXTTBL = '0'B      /* ALREADY GOT         */ 03684000
*                       THEN                  /* NO, THEN            */ 03685000
         L     @01,ATRA2PTR                                        1032 03686000
         L     @15,ATNXTTBL(,@01)                                  1032 03687000
         LTR   @15,@15                                             1032 03688000
         BNZ   @RF01032                                            1032 03689000
*                         DO ;     /* GO GET SPACE FOR ANOTHR        */ 03690000
*                                                                  1033 03691000
*                           CALL IDCSAGP0 (GDTTBL,ATLEN,ATPTRNXT,  1034 03692000
*                             MODID,SETZERO) ; /*ZERO CHN PTR        */ 03693000
*                                                                  1034 03694000
         MVC   @AL00001+4(16),@AL01034                             1034 03695000
         L     @15,@PC00001                                        1034 03696000
         ST    @15,@AL00001                                        1034 03697000
         LA    @14,ATPTRNXT                                        1034 03698000
         ST    @14,@AL00001+8                                      1034 03699000
         L     @15,GDTGPL(,@15)                                    1034 03700000
         LA    @01,@AL00001                                        1034 03701000
         BALR  @14,@15                                             1034 03702000
*                           RESPECIFY RTNREG RSTD;                 1035 03703000
*                           TESTRC = RTNREG;                       1036 03704000
         STH   RTNREG,TESTRC                                       1036 03705000
*                           RESPECIFY RTNREG UNRSTD ;              1037 03706000
*                           IF TESTRC = 0                          1038 03707000
*                             THEN                                 1038 03708000
         LH    @15,TESTRC                                          1038 03709000
         LTR   @15,@15                                             1038 03710000
         BNZ   @RF01038                                            1038 03711000
*                               DO ;                               1039 03712000
*                                 ATPTRNXT -> ATNAME = 'ASOC' ;    1040 03713000
         L     @15,ATPTRNXT                                        1040 03714000
         MVC   ATNAME(4,@15),@CC01177                              1040 03715000
*                                 ATNXTTBL = ATPTRNXT ;            1041 03716000
         L     @14,ATRA2PTR                                        1041 03717000
         ST    @15,ATNXTTBL(,@14)                                  1041 03718000
*                               END ;                              1042 03719000
*                             ELSE                                 1043 03720000
*                               CALL ERROR (NBRETE,$ABORT) ;       1043 03721000
         B     @RC01038                                            1043 03722000
@RF01038 LA    @01,@AL01043                                        1043 03723000
         BAL   @14,ERROR                                           1043 03724000
*                                       /* NOT ENOUGH MEMORY         */ 03725000
*                         END ;                                    1044 03726000
@RC01038 DS    0H                                                  1045 03727000
*                     ATRA2PTR = ATNXTTBL ; /* BUMP NXT TABLE        */ 03728000
@RF01032 L     @01,ATRA2PTR                                        1045 03729000
         L     @15,ATNXTTBL(,@01)                                  1045 03730000
         ST    @15,ATRA2PTR                                        1045 03731000
*                     DO ATSLOTB = 1 TO NBRATS ;                   1046 03732000
         LA    ATSLOTB,1                                           1046 03733000
@DL01046 DS    0H                                                  1047 03734000
*                       ATASOC(ATSLOTB) = '0'B ;                   1047 03735000
         LR    @02,ATSLOTB                                         1047 03736000
         SLA   @02,2                                               1047 03737000
         L     @01,ATRA2PTR                                        1047 03738000
         ALR   @01,@02                                             1047 03739000
         XC    ATASOC-3(3,@01),ATASOC-3(@01)                       1047 03740000
         MVI   ATASOC-4(@01),B'00000000'                           1047 03741000
*                     END ;                                        1048 03742000
         AL    ATSLOTB,@CF00222                                    1048 03743000
         C     ATSLOTB,@CF00038                                    1048 03744000
         BNH   @DL01046                                            1048 03745000
*                     ATSLOTB = 1 ;     /* 1ST SLOT THEREIN          */ 03746000
         LA    ATSLOTB,1                                           1049 03747000
*                   END ;                                          1050 03748000
*               ATCRACI(ATSLOTB) = CIFRTRNS ;                      1051 03749000
@RF01030 L     @02,ATRA2PTR                                        1051 03750000
         LR    @15,ATSLOTB                                         1051 03751000
         SLA   @15,2                                               1051 03752000
         ST    @15,@TF00001                                        1051 03753000
         ALR   @15,@02                                             1051 03754000
         MVC   ATCRACI-4(3,@15),CIFRTRNS                           1051 03755000
*               ATENTYP(ATSLOTB) = TYPE ;                          1052 03756000
         AL    @02,@TF00001                                        1052 03757000
         L     @01,FMFLADDR(,FMFLCUR)                              1052 03758000
         MVC   ATENTYP-4(1,@02),TYPE(@01)                          1052 03759000
*             END ;                                                1053 03760000
*           ELSE ;                 /* ERROR PRNTED IN TCICTCR        */ 03761000
@RF01027 DS    0H                                                  1055 03762000
*       END ;                                                      1055 03763000
*     ELSE                                                         1056 03764000
*       DO ;                                                       1056 03765000
         B     @RC01022                                            1056 03766000
@RF01022 DS    0H                                                  1057 03767000
*         PROCMSG='INTAOSC ';        /* PROC NAME FOR INSERT @OZ09388*/ 03768000
         MVC   PROCMSG(8),@CC01300                                 1057 03769000
*         CALL ERROR (16,$RETURN) ;  /* FIELD MGMT ERR RETURN        */ 03770000
         LA    @01,@AL01058                                        1058 03771000
         BAL   @14,ERROR                                           1058 03772000
*         RELREPNO = NBRASOCS ;      /* GET OUT OF LOOP              */ 03773000
         LH    @02,NBRASOCS                                        1059 03774000
         STH   @02,RELREPNO                                        1059 03775000
*       END ;                                                      1060 03776000
*   RELREPNO = RELREPNO + 1 ;                                      1061 03777000
@RC01022 LA    @02,1                                               1061 03778000
         LH    @15,RELREPNO                                        1061 03779000
         ALR   @15,@02                                             1061 03780000
         STH   @15,RELREPNO                                        1061 03781000
*   CNTREPNO = CNTREPNO + 1 ;                                      1062 03782000
         AH    @02,CNTREPNO                                        1062 03783000
         STH   @02,CNTREPNO                                        1062 03784000
* END ;                                                            1063 03785000
@DE01019 LH    @02,RELREPNO                                        1063 03786000
         CH    @02,NBRASOCS                                        1063 03787000
         BL    @DL01019                                            1063 03788000
* RELREPNO = 0 ;                   /* RESTORE ASSUMED VALUES         */ 03789000
         SLR   @15,@15                                             1064 03790000
         STH   @15,RELREPNO                                        1064 03791000
* CNTREPNO = 1 ;                                                   1065 03792000
         MVC   CNTREPNO(2),@CH00222                                1065 03793000
* FMFLTCHN = '0'B ;                                                1066 03794000
         SLR   @15,@15                                             1066 03795000
         ST    @15,FMFLTCHN(,FMFLCUR)                              1066 03796000
* FMFLGRPC = '0'B ;                                                1067 03797000
         MVI   FMFLGRPC(FMFLCUR),B'00000000'                       1067 03798000
* ATRA2PTR = ATPTRSAV ;                                            1068 03799000
*                                                                  1068 03800000
         L     @15,ATPTRSAV                                        1068 03801000
         ST    @15,ATRA2PTR                                        1068 03802000
*END INTASOC ;                                                     1069 03803000
@EL00016 DS    0H                                                  1069 03804000
@EF00016 DS    0H                                                  1069 03805000
@ER00016 LM    @14,@12,@SA00016                                    1069 03806000
         BR    @14                                                 1069 03807000
* /*******************************************************************/ 03808000
* /* PROCEDURE NAME - INTSORT, INITIALIZE TABLE FOR SORTING          */ 03809000
* /* FUNCTION -                                                      */ 03810000
* /*   SCAN CTT TABLE COUNTING NUMBER OF ENTRIES OF THE TYPE         */ 03811000
* /*   REQUESTED AND GET STORAGE FOR A SORTTBL,                      */ 03812000
* /*   INITIALIZE THE FIRST TWO ENTRIES (LOWEST/HIGHEST),            */ 03813000
* /*   PASS THRU THE CTT TABLE AGAIN BUILDING THE SORTTBL            */ 03814000
* /* INPUTS -                                                        */ 03815000
* /*   VARIABLE LENGTH LIST OF ENTRY TYPES TO BE IN SORTTBL          */ 03816000
* /*   CTT                                                           */ 03817000
* /* OUTPUTS -                                                       */ 03818000
* /*   SORTTBL WITH STCRACI AND STENTNM FIELDS FILLED IN             */ 03819000
* /*   SORTOKSW                                                      */ 03820000
* /*   STSLTCNT = 0 IF NO ENTRIES FOUND AND NO TABLE BUILT           */ 03821000
* /* CALLS -                                                         */ 03822000
* /*   UGPOOL, ERROR,                                                */ 03823000
* /*   IDCRC04(ENTNAME)                                              */ 03824000
* /*******************************************************************/ 03825000
*                                                                  1070 03826000
*INTSORT: PROCEDURE (NBRCHAR,SRCHCHAR) ;                           1070 03827000
INTSORT  STM   @14,@12,@SA00017                                    1070 03828000
         MVC   @PC00017(8),0(@01)                                  1070 03829000
* OLDERID2 = NEWERID2;                                             1071 03830000
         L     @15,@PC00001                                        1071 03831000
         L     @14,GDTTR2(,@15)                                    1071 03832000
         MVC   @TS00001(95),NEWERID2(@14)                          1071 03833000
         MVC   OLDERID2(95,@14),@TS00001                           1071 03834000
* NEWID2 = 'LRIS' ;                                                1072 03835000
         MVC   NEWID2(4,@14),@CC01308                              1072 03836000
* IF GDTDBG = NULLPTR                                              1073 03837000
*   THEN;                                                          1073 03838000
         L     @15,GDTDBG(,@15)                                    1073 03839000
         LTR   @15,@15                                             1073 03840000
         BZ    @RT01073                                            1073 03841000
*   ELSE                                                           1075 03842000
*     CALL IDCDB010 (GDTTBL,'LRIS') ;                              1075 03843000
*                                                                  1075 03844000
         L     @15,@PC00001                                        1075 03845000
         ST    @15,@AL00001                                        1075 03846000
         LA    @14,@CC01308                                        1075 03847000
         ST    @14,@AL00001+4                                      1075 03848000
         MVI   @AL00001+4,X'80'                                    1075 03849000
         L     @15,GDTDBG(,@15)                                    1075 03850000
         LA    @01,@AL00001                                        1075 03851000
         BALR  @14,@15                                             1075 03852000
* DCL                                                              1076 03853000
*   NBRCHAR         FIXED(31),     /* NUMBER OF SEARCH CHARS         */ 03854000
*   SRCHCHAR  (4)   CHAR(1),       /* SEARCH CHARACTER ARRAY         */ 03855000
* ENDCLSIS CHAR(1) ;                                               1076 03856000
*                                                                  1076 03857000
@RT01073 DS    0H                                                  1077 03858000
* SORTOKSW = ON ;                                                  1077 03859000
         OI    SORTOKSW,B'00000001'                                1077 03860000
* STSLTCNT = 0 ;                                                   1078 03861000
*                                                                  1078 03862000
         SLR   @15,@15                                             1078 03863000
         STH   @15,STSLTCNT                                        1078 03864000
* /*******************************************************************/ 03865000
* /* LOOP: SCAN CTT COUNTING NUMBER OF ENTRIES FOR SORTTBL           */ 03866000
* /*******************************************************************/ 03867000
*                                                                  1079 03868000
* DO CTTSLOT = 1 TO CTTENTNO ;                                     1079 03869000
         LA    @15,1                                               1079 03870000
         B     @DE01079                                            1079 03871000
@DL01079 DS    0H                                                  1080 03872000
*   DO CHARINDX = 1 TO NBRCHAR ;                                   1080 03873000
         LA    @15,1                                               1080 03874000
         B     @DE01080                                            1080 03875000
@DL01080 DS    0H                                                  1081 03876000
*     IF CTTENTYP(CTTSLOT) = SRCHCHAR(CHARINDX)                    1081 03877000
*       THEN                                                       1081 03878000
         LH    @14,CTTSLOT                                         1081 03879000
         N     @14,@CF01475                                        1081 03880000
         SLA   @14,3                                               1081 03881000
         L     @03,@PC00017+4                                      1081 03882000
         L     @01,CTTPTR                                          1081 03883000
         ALR   @01,@14                                             1081 03884000
         AL    @01,@CF01476                                        1081 03885000
         ALR   @03,@15                                             1081 03886000
         BCTR  @03,0                                               1081 03887000
         CLC   CTTENTYP-4(1,@01),SRCHCHAR(@03)                     1081 03888000
         BNE   @RF01081                                            1081 03889000
*         STSLTCNT = STSLTCNT + 1 ;                                1082 03890000
         LH    @01,STSLTCNT                                        1082 03891000
         LA    @01,1(,@01)                                         1082 03892000
         STH   @01,STSLTCNT                                        1082 03893000
*   END ;                                                          1083 03894000
@RF01081 SLR   @15,@15                                             1083 03895000
         IC    @15,CHARINDX                                        1083 03896000
         AL    @15,@CF00222                                        1083 03897000
@DE01080 STC   @15,CHARINDX                                        1083 03898000
         L     @14,@PC00017                                        1083 03899000
         C     @15,NBRCHAR(,@14)                                   1083 03900000
         BNH   @DL01080                                            1083 03901000
* END ;                                                            1084 03902000
         LH    @15,CTTSLOT                                         1084 03903000
         N     @15,@CF01475                                        1084 03904000
         AL    @15,@CF00222                                        1084 03905000
@DE01079 STH   @15,CTTSLOT                                         1084 03906000
         L     @14,CTTPTR                                          1084 03907000
         C     @15,CTTENTNO(,@14)                                  1084 03908000
         BNH   @DL01079                                            1084 03909000
* IF STSLTCNT ^= 0                                                 1085 03910000
*   THEN                                                           1085 03911000
         LH    @15,STSLTCNT                                        1085 03912000
         N     @15,@CF01475                                        1085 03913000
         LTR   @15,@15                                             1085 03914000
         BZ    @RF01085                                            1085 03915000
*     DO ;                         /* GET STORAGE FOR SORTTBL        */ 03916000
*       STSLTCNT = STSLTCNT + 2 ;  /* ADD LOW & HIGH DUMMIES         */ 03917000
         LA    @15,2(,@15)                                         1087 03918000
         STH   @15,STSLTCNT                                        1087 03919000
*       STLEN = STSLTCNT * LENGTH(SORTTBL) ;                       1088 03920000
*                                                                  1088 03921000
         MH    @15,@CH01068                                        1088 03922000
         ST    @15,STLEN                                           1088 03923000
*       CALL IDCSAGP0 (GDTTBL,STLEN,STPTR,MODIDST,SETZERO) ;       1089 03924000
*                                                                  1089 03925000
         L     @15,@PC00001                                        1089 03926000
         ST    @15,@AL00001                                        1089 03927000
         LA    @14,STLEN                                           1089 03928000
         ST    @14,@AL00001+4                                      1089 03929000
         LA    @14,STPTR                                           1089 03930000
         ST    @14,@AL00001+8                                      1089 03931000
         LA    @14,MODIDST                                         1089 03932000
         ST    @14,@AL00001+12                                     1089 03933000
         LA    @14,SETZERO                                         1089 03934000
         ST    @14,@AL00001+16                                     1089 03935000
         MVI   @AL00001+16,X'80'                                   1089 03936000
         L     @15,GDTGPL(,@15)                                    1089 03937000
         LA    @01,@AL00001                                        1089 03938000
         BALR  @14,@15                                             1089 03939000
*       RESPECIFY RTNREG RSTD;                                     1090 03940000
*       TESTRC = RTNREG;                                           1091 03941000
         STH   RTNREG,TESTRC                                       1091 03942000
*       RESPECIFY RTNREG UNRSTD ;                                  1092 03943000
*       IF TESTRC = 0                                              1093 03944000
*         THEN                                                     1093 03945000
         LH    @15,TESTRC                                          1093 03946000
         SLR   @14,@14                                             1093 03947000
         CR    @15,@14                                             1093 03948000
         BNE   @RF01093                                            1093 03949000
*           DO ;                                                   1094 03950000
*             STENTYP(1) = 'FF'X ; /* INITIALIZE FIRST TWO           */ 03951000
         L     @02,STPTR                                           1095 03952000
         MVI   STENTYP(@02),X'FF'                                  1095 03953000
*             STCRACI(1) = '0'B ;  /* ENTRIES OF SORTTBL             */ 03954000
         SLR   @15,@15                                             1096 03955000
         STCM  @15,7,STCRACI(@02)                                  1096 03956000
*             STFLAGS(1) = '0'B ;                                  1097 03957000
         MVI   STFLAGS(@02),B'00000000'                            1097 03958000
*             STFRWD(1)  = 2 ;                                     1098 03959000
         LA    @15,2                                               1098 03960000
         STH   @15,STFRWD(,@02)                                    1098 03961000
*             STBKWD(1)  = 0 ;                                     1099 03962000
         STH   @14,STBKWD(,@02)                                    1099 03963000
*             STENTNM(1) = '0'B ;  /* FIRST IS DUMMY LOWEST          */ 03964000
         XC    STENTNM+1(43,@02),STENTNM+1(@02)                    1100 03965000
         MVI   STENTNM(@02),B'00000000'                            1100 03966000
*             STENTYP(2) = 'FF'X ;                                 1101 03967000
         MVI   STENTYP+56(@02),X'FF'                               1101 03968000
*             STCRACI(2) = STENDCI ;                               1102 03969000
         MVC   STCRACI+56(3,@02),STENDCI                           1102 03970000
*             STFLAGS(2) = '0'B ;                                  1103 03971000
         MVI   STFLAGS+56(@02),B'00000000'                         1103 03972000
*             STFRWD(2)  = 0 ;                                     1104 03973000
         STH   @14,STFRWD+56(,@02)                                 1104 03974000
*             STBKWD(2)  = 1 ;     /* SECOND IS DUMMY HIGHEST        */ 03975000
         LA    @14,1                                               1105 03976000
         STH   @14,STBKWD+56(,@02)                                 1105 03977000
*             STENTNM(2) = 'FFFFFFFFFFFFFFFFFFFF'X ;               1106 03978000
         XC    STENTNM+66(34,@02),STENTNM+66(@02)                  1106 03979000
         MVC   STENTNM+56(10,@02),@CB01310                         1106 03980000
*             STSLOT = 2 ;                                         1107 03981000
         LR    STSLOT,@15                                          1107 03982000
*             FMU1STIO = ON ;                                      1108 03983000
         OI    FMU1STIO,B'10000000'                                1108 03984000
*             FMFLDNAM = ADDR('ENTNAME ') ;                        1109 03985000
         LA    @02,@CC01195                                        1109 03986000
         ST    @02,FMFLDNAM(,FMFLCUR)                              1109 03987000
*             /*******************************************************/ 03988000
*             /* LOOP: SCAN CTT BUILDING SORTTBL WITH NAMES          */ 03989000
*             /*******************************************************/ 03990000
*             DO CTTSLOT = 1 TO CTTENTNO ;                         1110 03991000
         B     @DE01110                                            1110 03992000
@DL01110 DS    0H                                                  1111 03993000
*               DO CHARINDX = 1 TO NBRCHAR ;                       1111 03994000
         LA    @02,1                                               1111 03995000
         B     @DE01111                                            1111 03996000
@DL01111 DS    0H                                                  1112 03997000
*                 IF CTTENTYP(CTTSLOT) = SRCHCHAR(CHARINDX)        1112 03998000
*                   THEN                                           1112 03999000
         L     @15,CTTPTR                                          1112 04000000
         LH    @14,CTTSLOT                                         1112 04001000
         N     @14,@CF01475                                        1112 04002000
         SLA   @14,3                                               1112 04003000
         L     @01,@PC00017+4                                      1112 04004000
         ST    @14,@TF00001                                        1112 04005000
         ALR   @14,@15                                             1112 04006000
         AL    @14,@CF01476                                        1112 04007000
         ALR   @01,@02                                             1112 04008000
         BCTR  @01,0                                               1112 04009000
         CLC   CTTENTYP-4(1,@14),SRCHCHAR(@01)                     1112 04010000
         BNE   @RF01112                                            1112 04011000
*                     DO ;                                         1113 04012000
*                       STSLOT = STSLOT + 1 ;                      1114 04013000
         LA    STSLOT,1(,STSLOT)                                   1114 04014000
*                       STFLAGS(STSLOT) = '0'B ;                   1115 04015000
         L     @02,STPTR                                           1115 04016000
         LR    @14,STSLOT                                          1115 04017000
         MH    @14,@CH01068                                        1115 04018000
         ST    @14,@TF00002                                        1115 04019000
         ALR   @14,@02                                             1115 04020000
         AL    @14,@CF01482                                        1115 04021000
         MVI   STFLAGS-48(@14),B'00000000'                         1115 04022000
*                       STFRWD(STSLOT) = 0 ;                       1116 04023000
         SLR   @14,@14                                             1116 04024000
         L     @01,@TF00002                                        1116 04025000
         AL    @01,@CF01476                                        1116 04026000
         STH   @14,STFRWD-52(@01,@02)                              1116 04027000
*                       STBKWD(STSLOT) = 0 ;                       1117 04028000
         L     @01,@TF00002                                        1117 04029000
         BCTR  @02,0                                               1117 04030000
         BCTR  @02,0                                               1117 04031000
         STH   @14,STBKWD-54(@01,@02)                              1117 04032000
*                       FMPLBCIN = CTTCATCI(CTTSLOT) ;             1118 04033000
         L     @02,FMPLAD                                          1118 04034000
         AL    @15,@TF00001                                        1118 04035000
         AL    @15,@CF01466                                        1118 04036000
         MVC   FMPLBCIN(3,@02),CTTCATCI-5(@15)                     1118 04037000
*                       REG1 = FMPLAD ;                            1119 04038000
*                                                                  1119 04039000
         LR    REG1,@02                                            1119 04040000
*                       CALL IDCRC04 ;      /* GET ENTRYNAME         */ 04041000
*                                                                  1120 04042000
         L     @15,@CV00793                                        1120 04043000
         BALR  @14,@15                                             1120 04044000
*                       IF FMFLENTH ^= 0                           1121 04045000
*                         THEN                                     1121 04046000
         L     @02,FMFLENTH(,FMFLCUR)                              1121 04047000
         LTR   @02,@02                                             1121 04048000
         BZ    @RF01121                                            1121 04049000
*                           DO ;                                   1122 04050000
*                             STENTNM(STSLOT) = ENTNAME ;          1123 04051000
         L     @02,STPTR                                           1123 04052000
         LR    @15,STSLOT                                          1123 04053000
         MH    @15,@CH01068                                        1123 04054000
         ST    @15,@TF00001                                        1123 04055000
         ALR   @15,@02                                             1123 04056000
         AL    @15,@CF01483                                        1123 04057000
         L     @01,FMFLADDR(,FMFLCUR)                              1123 04058000
         MVC   STENTNM(44,@15),ENTNAME(@01)                        1123 04059000
*                             STENTYP(STSLOT) =                    1124 04060000
*                               CTTENTYP(CTTSLOT) ;                1124 04061000
         LR    @01,@02                                             1124 04062000
         AL    @01,@TF00001                                        1124 04063000
         AL    @01,@CF01484                                        1124 04064000
         LH    @15,CTTSLOT                                         1124 04065000
         N     @15,@CF01475                                        1124 04066000
         LR    @14,@15                                             1124 04067000
         SLA   @14,3                                               1124 04068000
         L     @02,CTTPTR                                          1124 04069000
         ALR   @02,@14                                             1124 04070000
         AL    @02,@CF01476                                        1124 04071000
         MVC   STENTYP-44(1,@01),CTTENTYP-4(@02)                   1124 04072000
*                             STCRACI(STSLOT) = CTTSLOT + 8 ;      1125 04073000
         L     @02,STPTR                                           1125 04074000
         AL    @15,@CF00039                                        1125 04075000
         AL    @02,@TF00001                                        1125 04076000
         AL    @02,@CF01477                                        1125 04077000
         STCM  @15,7,STCRACI-45(@02)                               1125 04078000
*                             CHARINDX = NBRCHAR + 1 ;             1126 04079000
         L     @02,@PC00017                                        1126 04080000
         L     @02,NBRCHAR(,@02)                                   1126 04081000
         LA    @02,1(,@02)                                         1126 04082000
         STC   @02,CHARINDX                                        1126 04083000
*                           END ;                                  1127 04084000
*                         ELSE                                     1128 04085000
*                           DO ;                                   1128 04086000
         B     @RC01121                                            1128 04087000
@RF01121 DS    0H                                                  1129 04088000
*                             PROCMSG='INTSORT '; /* PROC    @OZ09388*/ 04089000
         MVC   PROCMSG(8),@CC01312                                 1129 04090000
*                                       /* NAME FOR INSERT   @OZ09388*/ 04091000
*                             CALL ERROR (17,$RETURN) ;            1130 04092000
         LA    @01,@AL01130                                        1130 04093000
         BAL   @14,ERROR                                           1130 04094000
*                             STSLTCNT = STSLTCNT - 1 ;            1131 04095000
         LH    @02,STSLTCNT                                        1131 04096000
         N     @02,@CF01475                                        1131 04097000
         BCTR  @02,0                                               1131 04098000
         STH   @02,STSLTCNT                                        1131 04099000
*                           END ;                                  1132 04100000
*                     END ;                                        1133 04101000
@RC01121 DS    0H                                                  1134 04102000
*               END ;                                              1134 04103000
@RF01112 LA    @02,1                                               1134 04104000
         SLR   @15,@15                                             1134 04105000
         IC    @15,CHARINDX                                        1134 04106000
         ALR   @02,@15                                             1134 04107000
@DE01111 STC   @02,CHARINDX                                        1134 04108000
         L     @15,@PC00017                                        1134 04109000
         C     @02,NBRCHAR(,@15)                                   1134 04110000
         BNH   @DL01111                                            1134 04111000
*             END ;                /* END BUILD SORTTBL LOOP         */ 04112000
         LA    @14,1                                               1135 04113000
         LH    @02,CTTSLOT                                         1135 04114000
         N     @02,@CF01475                                        1135 04115000
         ALR   @14,@02                                             1135 04116000
@DE01110 STH   @14,CTTSLOT                                         1135 04117000
         L     @02,CTTPTR                                          1135 04118000
         C     @14,CTTENTNO(,@02)                                  1135 04119000
         BNH   @DL01110                                            1135 04120000
*           END ;                                                  1136 04121000
*         ELSE                                                     1137 04122000
*           DO ;                                                   1137 04123000
         B     @RC01093                                            1137 04124000
@RF01093 DS    0H                                                  1138 04125000
*             CALL ERROR (18,$RETURN) ; /* NO ROOM FOR TABLE         */ 04126000
         LA    @01,@AL01138                                        1138 04127000
         BAL   @14,ERROR                                           1138 04128000
*             SORTOKSW = OFF ;                                     1139 04129000
         NI    SORTOKSW,B'11111110'                                1139 04130000
*           END ;                                                  1140 04131000
*     END ;                                                        1141 04132000
*                                                                  1141 04133000
* END INTSORT ;                                                    1142 04134000
@EL00017 DS    0H                                                  1142 04135000
@EF00017 DS    0H                                                  1142 04136000
@ER00017 LM    @14,@12,@SA00017                                    1142 04137000
         BR    @14                                                 1142 04138000
* /*******************************************************************/ 04139000
* /* PROCEDURE NAME - INTVEXT, INITIALIZE VEXTTBL                    */ 04140000
* /* FUNCTION -                                                      */ 04141000
* /*   IF HRONLYSW IS ON THEN ONLY RETURN THE HORIZ EXTN CI,         */ 04142000
* /*   CALL FIELD MGMT ASKING FOR $EXTPTRS (EXTENSION CI             */ 04143000
* /*   POINTERS, THE HORIZONTAL ONE BEING THE FIRST),                */ 04144000
* /*   NOTE: RETURN CANNOT EXCEED SIZE OF WORK AREA GIVEN,           */ 04145000
* /*         508-93 = 415/5 = 83*3 = 249+2 = 251 LT 256              */ 04146000
* /*   LOOP THRU ALL DATA RETURNED,                                  */ 04147000
* /*     CALL TCICTCR TO TRANSLATE FROM CATALOG CI TO CRA CI,        */ 04148000
* /*     SET UP CIHOREXT,                                            */ 04149000
* /*     CALL BLDVEXT TO ELIMINATE DUPLICATES AND                    */ 04150000
* /*     MOVE EXTENSION CI,S INTO THE VEXTTBL, AND                   */ 04151000
* /*     IF VEXTTBL IS FULL BUILD ANOTHER AND CHAIN THEM             */ 04152000
* /* INPUTS -                                                        */ 04153000
* /*   HRONLYSW INDICATES ONLY THE HORIZ EXT CI IS WANTED AND        */ 04154000
* /*   DO NOT TOUCH THE CURRENT VEXTTBL PLEASE,                      */ 04155000
* /*   CIFRGET (IDENTIFIES RECORD EXTN CI,S ARE TO BE FROM)          */ 04156000
* /* OUTPUTS -                                                       */ 04157000
* /*   CIHOREXT                                                      */ 04158000
* /*   VEXTTBL                                                       */ 04159000
* /* CALLS -                                                         */ 04160000
* /*   BLDVEXT, TCICTCR, ERROR,                                      */ 04161000
* /*   IDCRC04($EXTPTRS(CATCIS))                                     */ 04162000
* /*******************************************************************/ 04163000
*                                                                  1143 04164000
*INTVEXT: PROCEDURE ;                                              1143 04165000
INTVEXT  STM   @14,@12,@SA00018                                    1143 04166000
* OLDERID2 = NEWERID2;                                             1144 04167000
         L     @15,@PC00001                                        1144 04168000
         L     @14,GDTTR2(,@15)                                    1144 04169000
         MVC   @TS00001(95),NEWERID2(@14)                          1144 04170000
         MVC   OLDERID2(95,@14),@TS00001                           1144 04171000
* NEWID2 = 'LRIV' ;                                                1145 04172000
         MVC   NEWID2(4,@14),@CC01317                              1145 04173000
* IF GDTDBG = NULLPTR                                              1146 04174000
*   THEN;                                                          1146 04175000
         L     @15,GDTDBG(,@15)                                    1146 04176000
         LTR   @15,@15                                             1146 04177000
         BZ    @RT01146                                            1146 04178000
*   ELSE                                                           1148 04179000
*     CALL IDCDB010 (GDTTBL,'LRIV') ;                              1148 04180000
*                                                                  1148 04181000
         L     @15,@PC00001                                        1148 04182000
         ST    @15,@AL00001                                        1148 04183000
         LA    @14,@CC01317                                        1148 04184000
         ST    @14,@AL00001+4                                      1148 04185000
         MVI   @AL00001+4,X'80'                                    1148 04186000
         L     @15,GDTDBG(,@15)                                    1148 04187000
         LA    @01,@AL00001                                        1148 04188000
         BALR  @14,@15                                             1148 04189000
* IF HRONLYSW ^= ON                                                1149 04190000
*   THEN                           /* ZERO OUT VEXTTBL               */ 04191000
@RT01146 TM    HRONLYSW,B'10000000'                                1149 04192000
         BO    @RF01149                                            1149 04193000
*     DO VESLOTB = 1 TO NBRVES ;                                   1150 04194000
         LA    VESLOTB,1                                           1150 04195000
@DL01150 DS    0H                                                  1151 04196000
*       VEEXT(VESLOTB) = '0'B ;                                    1151 04197000
         LR    @03,VESLOTB                                         1151 04198000
         SLA   @03,2                                               1151 04199000
         L     @01,VEPTR                                           1151 04200000
         ALR   @01,@03                                             1151 04201000
         XC    VEEXT-3(3,@01),VEEXT-3(@01)                         1151 04202000
         MVI   VEEXT-4(@01),B'00000000'                            1151 04203000
*     END ;                                                        1152 04204000
         AL    VESLOTB,@CF00222                                    1152 04205000
         C     VESLOTB,@CF00038                                    1152 04206000
         BNH   @DL01150                                            1152 04207000
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ; /* CI FOR FLD MGMT          */ 04208000
@RF01149 L     @15,FMPLAD                                          1153 04209000
         L     @14,CIFRGET-1                                       1153 04210000
         LA    @14,0(,@14)                                         1153 04211000
         SLA   @14,3                                               1153 04212000
         L     @01,CTTPTR                                          1153 04213000
         ALR   @01,@14                                             1153 04214000
         AL    @01,@CF01478                                        1153 04215000
         MVC   FMPLBCIN(3,@15),CTTCATCI-5(@01)                     1153 04216000
* FMFLDNAM = ADDR('$EXTPTRS') ;                                    1154 04217000
         LA    @14,@CC01318                                        1154 04218000
         ST    @14,FMFLDNAM(,FMFLCUR)                              1154 04219000
* FRSTVESW = ON ;                                                  1155 04220000
         OI    FRSTVESW,B'00000001'                                1155 04221000
* CIHOREXT = 0 ;                                                   1156 04222000
         SLR   @14,@14                                             1156 04223000
         STCM  @14,7,CIHOREXT                                      1156 04224000
* REG1 = FMPLAD ;                                                  1157 04225000
*                                                                  1157 04226000
         LR    REG1,@15                                            1157 04227000
* CALL IDCRC04 ;                   /* ASK FOR EXTENSION CI,S         */ 04228000
*                                                                  1158 04229000
         L     @15,@CV00793                                        1158 04230000
         BALR  @14,@15                                             1158 04231000
* IF FMPLRTCD = 0                                                  1159 04232000
*   THEN                                                           1159 04233000
         L     @01,FMPLAD                                          1159 04234000
         CLI   FMPLRTCD(@01),0                                     1159 04235000
         BNE   @RF01159                                            1159 04236000
*     DO ;                                                         1160 04237000
*       NBRFLDS = FMFLENTH(1) / LENGTH($EXTPTRS) ;                 1161 04238000
         L     @00,FMFLENTH(,FMFLCUR)                              1161 04239000
         SRDA  @00,32                                              1161 04240000
         D     @00,@CF00166                                        1161 04241000
         LR    NBRFLDS,@01                                         1161 04242000
*       VESLOTB = 0 ;                                              1162 04243000
*                                                                  1162 04244000
         SLR   VESLOTB,VESLOTB                                     1162 04245000
*       /*************************************************************/ 04246000
*       /* LOOP: LOOK AT ALL ASSOCIATIONS RETURNED AND IF            */ 04247000
*       /*       IF THEY ARE NOT DUPLICATES ADD TO TABLE             */ 04248000
*       /*************************************************************/ 04249000
*                                                                  1163 04250000
*       DO VEFIELD = 1 TO NBRFLDS WHILE (NBRFLDS ^= 0) ;           1163 04251000
         LA    @15,1                                               1163 04252000
         B     @DE01163                                            1163 04253000
@DL01163 SLR   @15,@15                                             1163 04254000
         CLR   NBRFLDS,@15                                         1163 04255000
         BE    @DC01163                                            1163 04256000
*         CIFRTRNS = $EXTPTRS ;                                    1164 04257000
         L     @01,FMFLADDR(,FMFLCUR)                              1164 04258000
         MVC   CIFRTRNS(3),$EXTPTRS(@01)                           1164 04259000
*         LRTEMPCC = 0 ;                                           1165 04260000
*                                                                  1165 04261000
         STH   @15,LRTEMPCC                                        1165 04262000
*         CALL TCICTCR (LRTEMPCC);/* TRANSLATE CAT TO CRA CI         */ 04263000
*                                                                  1166 04264000
         LA    @15,LRTEMPCC                                        1166 04265000
         ST    @15,@AL00001                                        1166 04266000
         LA    @01,@AL00001                                        1166 04267000
         BAL   @14,TCICTCR                                         1166 04268000
*         IF LRTEMPCC = 0                                          1167 04269000
*           THEN                                                   1167 04270000
         LH    @15,LRTEMPCC                                        1167 04271000
         LTR   @15,@15                                             1167 04272000
         BNZ   @RF01167                                            1167 04273000
*             DO ;                                                 1168 04274000
*               IF FRSTVESW = ON   /* 1ST IS HORIZ EXTN CI           */ 04275000
*                 THEN             /* SO STORE 1ST TIME ONLY         */ 04276000
         TM    FRSTVESW,B'00000001'                                1169 04277000
         BNO   @RF01169                                            1169 04278000
*                   DO ;                                           1170 04279000
*                     CIHOREXT = CIFRTRNS ;                        1171 04280000
         MVC   CIHOREXT(3),CIFRTRNS                                1171 04281000
*                     FRSTVESW = OFF ;                             1172 04282000
         NI    FRSTVESW,B'11111110'                                1172 04283000
*                   END ;                                          1173 04284000
*                 ELSE             /* NOT FIRST TIME THRU            */ 04285000
*                   IF HRONLYSW ^= ON                              1174 04286000
*                     THEN                                         1174 04287000
*                                                                  1174 04288000
         B     @RC01169                                            1174 04289000
@RF01169 TM    HRONLYSW,B'10000000'                                1174 04290000
         BO    @RF01174                                            1174 04291000
*                       CALL BLDVEXT ;  /* SEE FUNCTION ABOVE        */ 04292000
*                                                                  1175 04293000
         BAL   @14,BLDVEXT                                         1175 04294000
*                     ELSE                                         1176 04295000
*                       VEFIELD = NBRFLDS + 1;/* EXIT LOOPS          */ 04296000
         B     @RC01174                                            1176 04297000
@RF01174 LA    @01,1(,NBRFLDS)                                     1176 04298000
         STH   @01,VEFIELD                                         1176 04299000
*             END ;                                                1177 04300000
*           ELSE ;                 /* ERROR PRNTD IN TCICTCR         */ 04301000
@RF01167 DS    0H                                                  1179 04302000
*         FMFLADDR(1) = FMFLADDR(1) + LENGTH($EXTPTRS) ;           1179 04303000
@RC01167 LA    @15,3                                               1179 04304000
         AL    @15,FMFLADDR(,FMFLCUR)                              1179 04305000
         ST    @15,FMFLADDR(,FMFLCUR)                              1179 04306000
*       END ;                                                      1180 04307000
         LA    @15,1                                               1180 04308000
         LH    @14,VEFIELD                                         1180 04309000
         N     @14,@CF01475                                        1180 04310000
         ALR   @15,@14                                             1180 04311000
@DE01163 STH   @15,VEFIELD                                         1180 04312000
         CR    @15,NBRFLDS                                         1180 04313000
         BNH   @DL01163                                            1180 04314000
@DC01163 DS    0H                                                  1181 04315000
*     END ;                                                        1181 04316000
*   ELSE                                                           1182 04317000
*     DO;                                                  /*@OZ09388*/ 04318000
         B     @RC01159                                            1182 04319000
@RF01159 DS    0H                                                  1183 04320000
*       PROCMSG='INTVEXT ';   /* PROC NAME FOR INSERT        @OZ09388*/ 04321000
         MVC   PROCMSG(8),@CC01319                                 1183 04322000
*      CALL ERROR (19,$RETURN) ;    /* FIELD MGMT ERR RETURN @OZ09388*/ 04323000
         LA    @01,@AL01184                                        1184 04324000
         BAL   @14,ERROR                                           1184 04325000
*     END;                                                 /*@OZ09388*/ 04326000
* FRSTVESW = OFF ;                                                 1186 04327000
@RC01159 NI    FRSTVESW,B'11111110'                                1186 04328000
* IF HRONLYSW ^= ON                                        /*@OZ20928*/ 04329000
*   THEN VEPTR = VEPTRBEG ;     /* POINT BACK AT 1ST TABLE   @OZ20928*/ 04330000
*                                                                  1187 04331000
         TM    HRONLYSW,B'10000000'                                1187 04332000
         BO    @RF01187                                            1187 04333000
         L     @15,VEPTRBEG                                        1188 04334000
         ST    @15,VEPTR                                           1188 04335000
*END INTVEXT ;                                                     1189 04336000
@EL00018 DS    0H                                                  1189 04337000
@EF00018 DS    0H                                                  1189 04338000
@ER00018 LM    @14,@12,@SA00018                                    1189 04339000
         BR    @14                                                 1189 04340000
* /*******************************************************************/ 04341000
* /* PROCEDURE NAME - MEMSORT, MEMORY SORT                           */ 04342000
* /* FUNCTION -                                                      */ 04343000
* /*   ADD FORWARDS AND BACKWARDS ORDERING CHAINS TO SORTTBL         */ 04344000
* /* INPUTS -                                                        */ 04345000
* /*   SORTTBL (NAMES AND CIS ONLY)                                  */ 04346000
* /* OUTPUTS -                                                       */ 04347000
* /*   SORTTBL (ORDERING SUBSCRIPTS ADDED)                           */ 04348000
* /* CALLS - NONE                                                    */ 04349000
* /*******************************************************************/ 04350000
*                                                                  1190 04351000
*MEMSORT: PROCEDURE ;                                              1190 04352000
MEMSORT  STM   @14,@12,@SA00019                                    1190 04353000
* OLDERID2 = NEWERID2;                                             1191 04354000
         L     @04,@PC00001                                        1191 04355000
         L     @15,GDTTR2(,@04)                                    1191 04356000
         MVC   @TS00001(95),NEWERID2(@15)                          1191 04357000
         MVC   OLDERID2(95,@15),@TS00001                           1191 04358000
* NEWID2 = 'LRME' ;                                                1192 04359000
         MVC   NEWID2(4,@15),@CC01324                              1192 04360000
* IF GDTDBG = NULLPTR                                              1193 04361000
*   THEN;                                                          1193 04362000
         L     @04,GDTDBG(,@04)                                    1193 04363000
         LTR   @04,@04                                             1193 04364000
         BZ    @RT01193                                            1193 04365000
*   ELSE                                                           1195 04366000
*     CALL IDCDB010 (GDTTBL,'LRME') ;                              1195 04367000
*                                                                  1195 04368000
         L     @04,@PC00001                                        1195 04369000
         ST    @04,@AL00001                                        1195 04370000
         LA    @15,@CC01324                                        1195 04371000
         ST    @15,@AL00001+4                                      1195 04372000
         MVI   @AL00001+4,X'80'                                    1195 04373000
         L     @15,GDTDBG(,@04)                                    1195 04374000
         LA    @01,@AL00001                                        1195 04375000
         BALR  @14,@15                                             1195 04376000
* /*******************************************************************/ 04377000
* /* LOOP: PASS THRU ALL ENTRIES IN SORTTBL                          */ 04378000
* /*******************************************************************/ 04379000
*                                                                  1196 04380000
* DO SLOT = 3 TO STSLTCNT ;                                        1196 04381000
@RT01193 LA    SLOT,3                                              1196 04382000
         B     @DE01196                                            1196 04383000
@DL01196 DS    0H                                                  1197 04384000
*   CMPRSLOT = SLOT - 1 ;                                          1197 04385000
         LR    CMPRSLOT,SLOT                                       1197 04386000
         BCTR  CMPRSLOT,0                                          1197 04387000
*   IF STENTNM(SLOT) > STENTNM(CMPRSLOT)                           1198 04388000
*     THEN                                                         1198 04389000
         L     @04,STPTR                                           1198 04390000
         LA    @15,56                                              1198 04391000
         LR    @01,SLOT                                            1198 04392000
         MR    @00,@15                                             1198 04393000
         MR    @14,CMPRSLOT                                        1198 04394000
         ALR   @01,@04                                             1198 04395000
         AL    @01,@CF01483                                        1198 04396000
         ALR   @04,@15                                             1198 04397000
         AL    @04,@CF01483                                        1198 04398000
         CLC   STENTNM(44,@01),STENTNM(@04)                        1198 04399000
         BNH   @RF01198                                            1198 04400000
*       DO ;                                                       1199 04401000
*                                                                  1199 04402000
*         /***********************************************************/ 04403000
*         /* LOOP: GO BACK DOWN FROM HERE TO INSERT POINT            */ 04404000
*         /***********************************************************/ 04405000
*                                                                  1200 04406000
*         DO UNTIL (STENTNM(SLOT) < STENTNM(CMPRSLOT)) ;           1200 04407000
@DL01200 DS    0H                                                  1201 04408000
*           CMPRSLOT = STFRWD(CMPRSLOT) ;                          1201 04409000
         LR    @04,CMPRSLOT                                        1201 04410000
         MH    @04,@CH01068                                        1201 04411000
         L     @01,STPTR                                           1201 04412000
         AL    @01,@CF01476                                        1201 04413000
         LH    @04,STFRWD-52(@04,@01)                              1201 04414000
         N     @04,@CF01475                                        1201 04415000
         LR    CMPRSLOT,@04                                        1201 04416000
*         END ;                                                    1202 04417000
@DE01200 L     @04,STPTR                                           1202 04418000
         LA    @15,56                                              1202 04419000
         LR    @01,SLOT                                            1202 04420000
         MR    @00,@15                                             1202 04421000
         MR    @14,CMPRSLOT                                        1202 04422000
         ALR   @01,@04                                             1202 04423000
         AL    @01,@CF01483                                        1202 04424000
         ST    @15,@TF00001                                        1202 04425000
         ALR   @15,@04                                             1202 04426000
         AL    @15,@CF01483                                        1202 04427000
         CLC   STENTNM(44,@01),STENTNM(@15)                        1202 04428000
         BNL   @DL01200                                            1202 04429000
*         CMPRSLOT = STBKWD(CMPRSLOT) ; /* BACK DOWN TO SAME         */ 04430000
         L     @01,@TF00001                                        1203 04431000
         BCTR  @04,0                                               1203 04432000
         BCTR  @04,0                                               1203 04433000
         LH    @04,STBKWD-54(@01,@04)                              1203 04434000
         N     @04,@CF01475                                        1203 04435000
         LR    CMPRSLOT,@04                                        1203 04436000
*                                       /* POSITION AS BELOW         */ 04437000
*                                       /* SO MOVE WORKS BOTH        */ 04438000
*       END ;                                                      1204 04439000
*     ELSE                                                         1205 04440000
*                                                                  1205 04441000
*       /*************************************************************/ 04442000
*       /* LOOP: GO UP FROM HERE TO INSERT POINT                     */ 04443000
*       /*************************************************************/ 04444000
*                                                                  1205 04445000
*       DO UNTIL (STENTNM(SLOT) > STENTNM(CMPRSLOT)) ;             1205 04446000
         B     @RC01198                                            1205 04447000
@RF01198 DS    0H                                                  1205 04448000
@DL01205 DS    0H                                                  1206 04449000
*         CMPRSLOT = STBKWD(CMPRSLOT) ;                            1206 04450000
         LR    @04,CMPRSLOT                                        1206 04451000
         MH    @04,@CH01068                                        1206 04452000
         L     @01,STPTR                                           1206 04453000
         BCTR  @01,0                                               1206 04454000
         BCTR  @01,0                                               1206 04455000
         LH    @04,STBKWD-54(@04,@01)                              1206 04456000
         N     @04,@CF01475                                        1206 04457000
         LR    CMPRSLOT,@04                                        1206 04458000
*       END ;                                                      1207 04459000
*                                                                  1207 04460000
@DE01205 L     @04,STPTR                                           1207 04461000
         LA    @15,56                                              1207 04462000
         LR    @01,SLOT                                            1207 04463000
         MR    @00,@15                                             1207 04464000
         MR    @14,CMPRSLOT                                        1207 04465000
         ALR   @01,@04                                             1207 04466000
         AL    @01,@CF01483                                        1207 04467000
         ALR   @04,@15                                             1207 04468000
         AL    @04,@CF01483                                        1207 04469000
         CLC   STENTNM(44,@01),STENTNM(@04)                        1207 04470000
         BNH   @DL01205                                            1207 04471000
*   STBKWD(SLOT) = STBKWD(STFRWD(CMPRSLOT)) ;                      1208 04472000
@RC01198 L     @04,STPTR                                           1208 04473000
         LA    @15,56                                              1208 04474000
         LR    @01,SLOT                                            1208 04475000
         MR    @00,@15                                             1208 04476000
         ST    @01,@TF00001                                        1208 04477000
         LR    @01,CMPRSLOT                                        1208 04478000
         MR    @00,@15                                             1208 04479000
         LA    @14,0(@01,@04)                                      1208 04480000
         AL    @14,@CF01476                                        1208 04481000
         ST    @01,@TF00002                                        1208 04482000
         LH    @01,STFRWD-52(,@14)                                 1208 04483000
         N     @01,@CF01475                                        1208 04484000
         MR    @00,@15                                             1208 04485000
         BCTR  @01,0                                               1208 04486000
         BCTR  @01,0                                               1208 04487000
         LH    @14,STBKWD-54(@01,@04)                              1208 04488000
         N     @14,@CF01475                                        1208 04489000
         L     @01,@TF00001                                        1208 04490000
         BCTR  @01,0                                               1208 04491000
         BCTR  @01,0                                               1208 04492000
         STH   @14,STBKWD-54(@01,@04)                              1208 04493000
*   STBKWD(STFRWD(CMPRSLOT)) = SLOT ;   /* SET BACKWARD AND          */ 04494000
         L     @01,@TF00002                                        1209 04495000
         AL    @01,@CF01476                                        1209 04496000
         LH    @01,STFRWD-52(@01,@04)                              1209 04497000
         N     @01,@CF01475                                        1209 04498000
         MR    @14,@01                                             1209 04499000
         BCTR  @15,0                                               1209 04500000
         BCTR  @15,0                                               1209 04501000
         STH   SLOT,STBKWD-54(@15,@04)                             1209 04502000
*   STFRWD(SLOT) = STFRWD(CMPRSLOT) ;   /* FORWARD POINTERS          */ 04503000
         L     @01,@TF00002                                        1210 04504000
         AL    @01,@CF01476                                        1210 04505000
         LH    @15,STFRWD-52(@01,@04)                              1210 04506000
         N     @15,@CF01475                                        1210 04507000
         L     @14,@TF00001                                        1210 04508000
         AL    @14,@CF01476                                        1210 04509000
         STH   @15,STFRWD-52(@14,@04)                              1210 04510000
*   STFRWD(CMPRSLOT) = SLOT ;                                      1211 04511000
         L     @01,@TF00002                                        1211 04512000
         AL    @04,@CF01476                                        1211 04513000
         STH   SLOT,STFRWD-52(@01,@04)                             1211 04514000
* END ;                                                            1212 04515000
*                                                                  1212 04516000
         AL    SLOT,@CF00222                                       1212 04517000
@DE01196 LH    @04,STSLTCNT                                        1212 04518000
         N     @04,@CF01475                                        1212 04519000
         CR    SLOT,@04                                            1212 04520000
         BNH   @DL01196                                            1212 04521000
*END MEMSORT ;                                                     1213 04522000
@EL00019 DS    0H                                                  1213 04523000
@EF00019 DS    0H                                                  1213 04524000
@ER00019 LM    @14,@12,@SA00019                                    1213 04525000
         BR    @14                                                 1213 04526000
* /*******************************************************************/ 04527000
* /* PRODEDURE NAME - PRTAAXV, PRINT ASSOCIATED AIX,S VOLUMES        */ 04528000
* /* FUNCTION -                                                      */ 04529000
* /*   INITIALIZE ASSOCTB2 WITH ASSOCIATIONS FROM THE                */ 04530000
* /*   ASSOCIATED AIX,                                               */ 04531000
* /*   SEARCH IT FOR THE DATA AND INDEX RECORDS AND                  */ 04532000
* /*   CALL PRTOJVL TO PRINT THEIR VOLUMES FOR INFORMATION           */ 04533000
* /*   ONLY (I.E. NO COMPARE OR DUMP)                                */ 04534000
* /* INPUTS -                                                        */ 04535000
* /*   CIFRGET (IDENTIFIES AIX CLUSTER RECORD)                       */ 04536000
* /* OUTPUTS -                                                       */ 04537000
* /* CALLS -                                                         */ 04538000
* /*   INTASOC, PRTOJVL                                              */ 04539000
* /*******************************************************************/ 04540000
*                                                                  1214 04541000
*PRTAAXV: PROCEDURE ;                                              1214 04542000
PRTAAXV  STM   @14,@12,@SA00020                                    1214 04543000
* OLDERID2 = NEWERID2;                                             1215 04544000
         L     @15,@PC00001                                        1215 04545000
         L     @14,GDTTR2(,@15)                                    1215 04546000
         MVC   @TS00001(95),NEWERID2(@14)                          1215 04547000
         MVC   OLDERID2(95,@14),@TS00001                           1215 04548000
* NEWID2 = 'LRPA' ;                                                1216 04549000
         MVC   NEWID2(4,@14),@CC01329                              1216 04550000
* IF GDTDBG = NULLPTR                                              1217 04551000
*   THEN;                                                          1217 04552000
         L     @15,GDTDBG(,@15)                                    1217 04553000
         LTR   @15,@15                                             1217 04554000
         BZ    @RT01217                                            1217 04555000
*   ELSE                                                           1219 04556000
*     CALL IDCDB010 (GDTTBL,'LRPA') ;                              1219 04557000
*                                                                  1219 04558000
         L     @15,@PC00001                                        1219 04559000
         ST    @15,@AL00001                                        1219 04560000
         LA    @14,@CC01329                                        1219 04561000
         ST    @14,@AL00001+4                                      1219 04562000
         MVI   @AL00001+4,X'80'                                    1219 04563000
         L     @15,GDTDBG(,@15)                                    1219 04564000
         LA    @01,@AL00001                                        1219 04565000
         BALR  @14,@15                                             1219 04566000
* AAXVCNT = 0 ;                    /* QUIT LOOKING AFTER TWO         */ 04567000
@RT01217 SLR   AAXVCNT,AAXVCNT                                     1220 04568000
* AAPTRSAV = ATRA2PTR ;                                            1221 04569000
         L     @03,ATRA2PTR                                        1221 04570000
         ST    @03,AAPTRSAV                                        1221 04571000
* CISAVED = CIFRGET ;                                              1222 04572000
         MVC   CISAVED(3),CIFRGET                                  1222 04573000
* IF CMPRSW = ON                   /* SAVE SWITCHES AND SET          */ 04574000
*   THEN SAVESW2 = ON ;            /* TEMPORARILY TO NO DUMP         */ 04575000
         TM    CMPRSW,B'01000000'                                  1223 04576000
         BNO   @RF01223                                            1223 04577000
         OI    SAVESW2,B'00010000'                                 1224 04578000
*   ELSE SAVESW2 = OFF ;           /* AND NO COMPARE                 */ 04579000
         B     @RC01223                                            1225 04580000
@RF01223 NI    SAVESW2,B'11101111'                                 1225 04581000
* IF DUMPSW = ON                                                   1226 04582000
*   THEN SAVESW3 = ON ;                                            1226 04583000
@RC01223 TM    DUMPSW,B'00000100'                                  1226 04584000
         BNO   @RF01226                                            1226 04585000
         OI    SAVESW3,B'00001000'                                 1227 04586000
*   ELSE SAVESW3 = OFF ;                                           1228 04587000
         B     @RC01226                                            1228 04588000
@RF01226 NI    SAVESW3,B'11110111'                                 1228 04589000
* CMPRSW = OFF ;                                                   1229 04590000
@RC01226 DS    0H                                                  1230 04591000
* DUMPSW = OFF ;                                                   1230 04592000
         NI    CMPRSW,B'10111011'                                  1230 04593000
* ATRA2PTR = A2PTR ;                                               1231 04594000
*                                                                  1231 04595000
         L     @03,A2PTR                                           1231 04596000
         ST    @03,ATRA2PTR                                        1231 04597000
* CALL INTASOC(1) ;                /* GO BUILD ASSOCTB2              */ 04598000
*                                                                  1232 04599000
         LA    @01,@AL01232                                        1232 04600000
         BAL   @14,INTASOC                                         1232 04601000
* /*******************************************************************/ 04602000
* /* LOOP: LOOK THRU ASSOCTB2 TILL DATA AND INDEX                    */ 04603000
* /*       ASSOCIATIONS HAVE BEEN FOUND                              */ 04604000
* /*******************************************************************/ 04605000
*                                                                  1233 04606000
* DO A2SLOT = 1 TO NBRATS                                          1233 04607000
*    WHILE (AAXVCNT < 2                                            1233 04608000
*       & LASTATSW ^= ON) ;                                        1233 04609000
         LA    A2SLOT,1                                            1233 04610000
@DL01233 C     AAXVCNT,@CF00158                                    1233 04611000
         BNL   @DC01233                                            1233 04612000
         TM    LASTATSW,B'00100000'                                1233 04613000
         BO    @DC01233                                            1233 04614000
*   IF    A2ENTYP(A2SLOT) = CATRCTYP($DATA)                        1234 04615000
*      | A2ENTYP(A2SLOT) = CATRCTYP($INDX)                         1234 04616000
*     THEN                                                         1234 04617000
         L     @15,ATRA2PTR                                        1234 04618000
         LR    @14,A2SLOT                                          1234 04619000
         SLA   @14,2                                               1234 04620000
         LA    @01,5                                               1234 04621000
         ST    @01,@TF00001                                        1234 04622000
         SLR   @01,@01                                             1234 04623000
         IC    @01,$DATA                                           1234 04624000
         M     @00,@TF00001                                        1234 04625000
         ST    @14,@TF00002                                        1234 04626000
         ALR   @14,@15                                             1234 04627000
         LA    @15,CATRCTYP-5(@01)                                 1234 04628000
         CLC   A2ENTYP-4(1,@14),0(@15)                             1234 04629000
         BE    @RT01234                                            1234 04630000
         L     @15,ATRA2PTR                                        1234 04631000
         SLR   @01,@01                                             1234 04632000
         IC    @01,$INDX                                           1234 04633000
         M     @00,@TF00001                                        1234 04634000
         AL    @15,@TF00002                                        1234 04635000
         LA    @14,CATRCTYP-5(@01)                                 1234 04636000
         CLC   A2ENTYP-4(1,@15),0(@14)                             1234 04637000
         BNE   @RF01234                                            1234 04638000
@RT01234 DS    0H                                                  1235 04639000
*       DO ;                                                       1235 04640000
*         AAXVCNT = AAXVCNT + 1 ;                                  1236 04641000
         LA    AAXVCNT,1(,AAXVCNT)                                 1236 04642000
*         CIFRGET = A2CRACI(A2SLOT) ;                              1237 04643000
*                                                                  1237 04644000
         LR    @15,A2SLOT                                          1237 04645000
         SLA   @15,2                                               1237 04646000
         L     @01,ATRA2PTR                                        1237 04647000
         ALR   @01,@15                                             1237 04648000
         MVC   CIFRGET(3),A2CRACI-4(@01)                           1237 04649000
*         CALL PRTOJVL ;           /* GO PRINT OBJECTS VOLUME        */ 04650000
*                                                                  1238 04651000
         BAL   @14,PRTOJVL                                         1238 04652000
*       END ;                                                      1239 04653000
*     IF A2SLOT = NBRATS                                           1240 04654000
*       THEN                                                       1240 04655000
@RF01234 C     A2SLOT,@CF00038                                     1240 04656000
         BNE   @RF01240                                            1240 04657000
*         IF A2NXTTBL ^= '0'B                                      1241 04658000
*           THEN                                                   1241 04659000
         L     @01,ATRA2PTR                                        1241 04660000
         L     @15,A2NXTTBL(,@01)                                  1241 04661000
         LTR   @15,@15                                             1241 04662000
         BZ    @RF01241                                            1241 04663000
*             DO ;                                                 1242 04664000
*               ATRA2PTR = A2NXTTBL ;   /* BUMP TO NEXT TABLE        */ 04665000
         ST    @15,ATRA2PTR                                        1243 04666000
*               A2SLOT = 0 ;                                       1244 04667000
         SLR   A2SLOT,A2SLOT                                       1244 04668000
*             END ;                                                1245 04669000
*           ELSE LASTATSW = ON ;                                   1246 04670000
         B     @RC01241                                            1246 04671000
@RF01241 OI    LASTATSW,B'00100000'                                1246 04672000
* END ;                                                            1247 04673000
@RC01241 DS    0H                                                  1247 04674000
@RF01240 AL    A2SLOT,@CF00222                                     1247 04675000
         C     A2SLOT,@CF00038                                     1247 04676000
         BNH   @DL01233                                            1247 04677000
@DC01233 DS    0H                                                  1248 04678000
* LASTATSW = OFF ;                                                 1248 04679000
         NI    LASTATSW,B'11011111'                                1248 04680000
* IF SAVESW3 = ON                  /* RESTORE SWITCHES               */ 04681000
*   THEN DUMPSW = ON ;                                             1249 04682000
         TM    SAVESW3,B'00001000'                                 1249 04683000
         BNO   @RF01249                                            1249 04684000
         OI    DUMPSW,B'00000100'                                  1250 04685000
* IF SAVESW2 = ON                                                  1251 04686000
*   THEN CMPRSW = ON ;                                             1251 04687000
@RF01249 TM    SAVESW2,B'00010000'                                 1251 04688000
         BNO   @RF01251                                            1251 04689000
         OI    CMPRSW,B'01000000'                                  1252 04690000
* CIFRGET = CISAVED ;              /* RESTORE OTHER STUFF            */ 04691000
@RF01251 MVC   CIFRGET(3),CISAVED                                  1253 04692000
* ATRA2PTR = AAPTRSAV ;                                            1254 04693000
*                                                                  1254 04694000
         L     @04,AAPTRSAV                                        1254 04695000
         ST    @04,ATRA2PTR                                        1254 04696000
*END PRTAAXV ;                                                     1255 04697000
@EL00020 DS    0H                                                  1255 04698000
@EF00020 DS    0H                                                  1255 04699000
@ER00020 LM    @14,@12,@SA00020                                    1255 04700000
         BR    @14                                                 1255 04701000
* /*******************************************************************/ 04702000
* /* PROCEDURE NAME - PRTCMP, PRINT STUFF FOR RECORD (CMPR)          */ 04703000
* /* FUNCTION -                                                      */ 04704000
* /*   IF NOT SEQUENTIALDUMP BUT IS PRINT PASS                       */ 04705000
* /*   AND NOT EXTENSION RECORD - EXTRACT & PRINT TYPE & NAME,       */ 04706000
* /*   IF NOT SDUMP, PRINT PASS AND NOT DUMP AND DATA, INDEX OR      */ 04707000
* /*   ALIEN - CALL PRTOJVL TO PRINT OBJECT,S VOLUMES,               */ 04708000
* /*   IF COMPARE PASS - COMPARE CRA AND CATALOG RECORDS AND         */ 04709000
* /*   SET MISCOMPARE SWITCH ON AND INCREMENT MISCOMPARED            */ 04710000
* /*   RECORD COUNT IF THERE WAS A MISMATCH,                         */ 04711000
* /*   IF PRINT PASS AND DUMP - CALL PRTDMP TO PRINT THE             */ 04712000
* /*   RECORDS AND UNDERSCORE ALL BYTES THAT MISCOMPARED,            */ 04713000
* /*   IF PRINT PASS - MARK ALL PROCESSED RECORDS IN THE CTT         */ 04714000
* /* INPUTS -                                                        */ 04715000
* /*   INDNTCOL (NUMBER OF COLUMES TO INDENT)                        */ 04716000
* /*   CTT                                                           */ 04717000
* /*   MCRCDCNT                                                      */ 04718000
* /* OUTPUTS -                                                       */ 04719000
* /*   NAME (AND RECORD) PRINTED AS SPECIFIED                        */ 04720000
* /*   CTT (RECORDS MARKED THAT HAVE BEEN PROCESSED)                 */ 04721000
* /*   MCRCDCNT (MISCOMPARED RECORDS COUNT INCREMENTED)              */ 04722000
* /* CALLS -                                                         */ 04723000
* /*   UPRINT, PRTDMP, PRTOJVL,                                      */ 04724000
* /*   IDCRC04($USEDLEN)                                             */ 04725000
* /*******************************************************************/ 04726000
*                                                                  1256 04727000
*PRTCMP: PROCEDURE ;                                               1256 04728000
PRTCMP   STM   @14,@12,@SA00021                                    1256 04729000
* OLDERID2 = NEWERID2;                                             1257 04730000
         L     @15,@PC00001                                        1257 04731000
         L     @14,GDTTR2(,@15)                                    1257 04732000
         MVC   @TS00001(95),NEWERID2(@14)                          1257 04733000
         MVC   OLDERID2(95,@14),@TS00001                           1257 04734000
* NEWID2 = 'LRPC' ;                                                1258 04735000
         MVC   NEWID2(4,@14),@CC01334                              1258 04736000
* IF GDTDBG = NULLPTR                                              1259 04737000
*   THEN;                                                          1259 04738000
         L     @15,GDTDBG(,@15)                                    1259 04739000
         LTR   @15,@15                                             1259 04740000
         BZ    @RT01259                                            1259 04741000
*   ELSE                                                           1261 04742000
*     CALL IDCDB010 (GDTTBL,'LRPC') ;                              1261 04743000
*                                                                  1261 04744000
         L     @15,@PC00001                                        1261 04745000
         ST    @15,@AL00001                                        1261 04746000
         LA    @14,@CC01334                                        1261 04747000
         ST    @14,@AL00001+4                                      1261 04748000
         MVI   @AL00001+4,X'80'                                    1261 04749000
         L     @15,GDTDBG(,@15)                                    1261 04750000
         LA    @01,@AL00001                                        1261 04751000
         BALR  @14,@15                                             1261 04752000
* IF     SDUMPSW ^= ON             /* NO NAMES IF SEQ DUMP           */ 04753000
*    & PRNTPASW = ON               /* AND ALWAYS FOR SOME OF EM      */ 04754000
*    & (ENTYPSAV ^= CATRCTYP($OEXT)                                1262 04755000
*     & ENTYPSAV ^= CATRCTYP($VEXT))                               1262 04756000
*                                  /**************************       */ 04757000
*   THEN                           /* PRINT TYPE AND NAME            */ 04758000
@RT01259 TM    PRNTPASW,B'10000000'                                1262 04759000
         BNO   @RF01262                                            1262 04760000
         TM    SDUMPSW,B'00000010'                                 1262 04761000
         BNZ   @RF01262                                            1262 04762000
         LA    @15,5                                               1262 04763000
         SLR   @01,@01                                             1262 04764000
         IC    @01,$OEXT                                           1262 04765000
         MR    @00,@15                                             1262 04766000
         LA    @14,CATRCTYP-5(@01)                                 1262 04767000
         CLC   ENTYPSAV(1),0(@14)                                  1262 04768000
         BE    @RF01262                                            1262 04769000
         SLR   @03,@03                                             1262 04770000
         IC    @03,$VEXT                                           1262 04771000
         MR    @14,@03                                             1262 04772000
         LA    @14,CATRCTYP-5(@15)                                 1262 04773000
         CLC   ENTYPSAV(1),0(@14)                                  1262 04774000
         BE    @RF01262                                            1262 04775000
*     DO ;                         /**************************       */ 04776000
*       DO TYPESLOT = 1 TO 26      /* FIND INDEX OF RCD TYPE         */ 04777000
*          WHILE (ENTYPSAV ^= CATRCTYP(TYPESLOT)) ;                1264 04778000
         LA    TYPESLOT,1                                          1264 04779000
@DL01264 LR    @03,TYPESLOT                                        1264 04780000
         MH    @03,@CH00042                                        1264 04781000
         LA    @01,CATRCTYP-5(@03)                                 1264 04782000
         CLC   ENTYPSAV(1),0(@01)                                  1264 04783000
         BE    @DC01264                                            1264 04784000
*       END ;                                                      1265 04785000
         AL    TYPESLOT,@CF00222                                   1265 04786000
         C     TYPESLOT,@CF00643                                   1265 04787000
         BNH   @DL01264                                            1265 04788000
@DC01264 DS    0H                                                  1266 04789000
*       DARGLIST = '0'B ;          /* SET UP TO PRINT NAME           */ 04790000
         L     @03,DDSTRU                                          1266 04791000
         XC    DARGLIST+1(19,@03),DARGLIST+1(@03)                  1266 04792000
         MVI   DARGLIST(@03),B'00000000'                           1266 04793000
*       DARGSMOD = 'LR0' ;                                         1267 04794000
         MVC   DARGSMOD(3,@03),@CC01335                            1267 04795000
*       DARGSENT = 1 ;                                             1268 04796000
         MVI   DARGSENT(@03),X'01'                                 1268 04797000
*       DARGIND = INDNTCOL ;                                       1269 04798000
         IC    @15,INDNTCOL                                        1269 04799000
         STC   @15,DARGIND(,@03)                                   1269 04800000
*       DARGCNT = 2 ;                                              1270 04801000
         LA    @15,2                                               1270 04802000
         STH   @15,DARGCNT(,@03)                                   1270 04803000
*       DARGINS(1) = 1 ;                                           1271 04804000
         MVC   DARGINS(2,@03),@CH00222                             1271 04805000
*       DARGINL(1) = 4 ;                                           1272 04806000
         MVC   DARGINL(2,@03),@CH00047                             1272 04807000
*       DARGDTM(1) = ADDR(CATRDESC(TYPESLOT)) ;                    1273 04808000
         LA    @14,5                                               1273 04809000
         LR    @01,TYPESLOT                                        1273 04810000
         MR    @00,@14                                             1273 04811000
         LA    @01,CATRDESC-5(@01)                                 1273 04812000
         ST    @01,DARGDTM(,@03)                                   1273 04813000
*       DARGINS(2) = 2 ;                                           1274 04814000
         STH   @15,DARGINS+8(,@03)                                 1274 04815000
*       DARGINL(2) = 44 ;                                          1275 04816000
         MVC   DARGINL+8(2,@03),@CH00614                           1275 04817000
*       DARGDTM(2) = ADDR(ENTNAME) ;                               1276 04818000
         L     @02,FMFLADDR(,FMFLCUR)                              1276 04819000
         ST    @02,DARGDTM+8(,@03)                                 1276 04820000
*       IF ENTYPSAV = CATRCTYP($VOL)                               1277 04821000
*         THEN ENTNAME(7:44) = ' ';/* CHANGE 00 TO 40                */ 04822000
         LR    @01,@14                                             1277 04823000
         SLR   @03,@03                                             1277 04824000
         IC    @03,$VOL                                            1277 04825000
         MR    @00,@03                                             1277 04826000
         LA    @03,CATRCTYP-5(@01)                                 1277 04827000
         CLC   ENTYPSAV(1),0(@03)                                  1277 04828000
         BNE   @RF01277                                            1277 04829000
         MVI   ENTNAME+7(@02),C' '                                 1278 04830000
         MVC   ENTNAME+8(36,@02),ENTNAME+7(@02)                    1278 04831000
         MVI   ENTNAME+6(@02),C' '                                 1278 04832000
*       IF    ENTYPSAV = CATRCTYP($FRSP)                           1279 04833000
*          | ENTYPSAV = CATRCTYP($CCR)                             1279 04834000
*          | ENTYPSAV = CATRCTYP($UPGD)                            1279 04835000
*         THEN ENTNAME = ' ' ;     /* CHANGE TO ALL 40               */ 04836000
*                                                                  1279 04837000
@RF01277 LA    @15,5                                               1279 04838000
         SLR   @01,@01                                             1279 04839000
         IC    @01,$FRSP                                           1279 04840000
         MR    @00,@15                                             1279 04841000
         LA    @14,CATRCTYP-5(@01)                                 1279 04842000
         CLC   ENTYPSAV(1),0(@14)                                  1279 04843000
         BE    @RT01279                                            1279 04844000
         SLR   @01,@01                                             1279 04845000
         IC    @01,$CCR                                            1279 04846000
         MR    @00,@15                                             1279 04847000
         LA    @14,CATRCTYP-5(@01)                                 1279 04848000
         CLC   ENTYPSAV(1),0(@14)                                  1279 04849000
         BE    @RT01279                                            1279 04850000
         SLR   @03,@03                                             1279 04851000
         IC    @03,$UPGD                                           1279 04852000
         MR    @14,@03                                             1279 04853000
         LA    @14,CATRCTYP-5(@15)                                 1279 04854000
         CLC   ENTYPSAV(1),0(@14)                                  1279 04855000
         BNE   @RF01279                                            1279 04856000
@RT01279 DS    0H                                                  1280 04857000
         L     @01,FMFLADDR(,FMFLCUR)                              1280 04858000
         MVI   ENTNAME+1(@01),C' '                                 1280 04859000
         MVC   ENTNAME+2(42,@01),ENTNAME+1(@01)                    1280 04860000
         MVI   ENTNAME(@01),C' '                                   1280 04861000
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    1281 04862000
*                                                                  1281 04863000
@RF01279 L     @15,@PC00001                                        1281 04864000
         ST    @15,@AL00001                                        1281 04865000
         LA    @14,IOCSPRT                                         1281 04866000
         ST    @14,@AL00001+4                                      1281 04867000
         LA    @14,DDSTRU                                          1281 04868000
         ST    @14,@AL00001+8                                      1281 04869000
         MVI   @AL00001+8,X'80'                                    1281 04870000
         L     @15,GDTPRT(,@15)                                    1281 04871000
         LA    @01,@AL00001                                        1281 04872000
         BALR  @14,@15                                             1281 04873000
*     END ;                                                        1282 04874000
* IF     PRNTPASW = ON             /* FOR THESE CONDITIONS           */ 04875000
*    & DUMPSW ^= ON                /* PRINT ENTRIES VOLUMES          */ 04876000
*    & SDUMPSW ^= ON                                               1283 04877000
*    & CIFRGET > CTTBASE                                           1283 04878000
*    & (ENTYPSAV = CATRCTYP($DATA)                                 1283 04879000
*      | ENTYPSAV = CATRCTYP($INDX)                                1283 04880000
*      | ENTYPSAV = CATRCTYP($NONV)                                1283 04881000
*      | ENTYPSAV = CATRCTYP($UCAT))                               1283 04882000
*   THEN                                                           1283 04883000
*                                                                  1283 04884000
@RF01262 TM    PRNTPASW,B'10000000'                                1283 04885000
         BNO   @RF01283                                            1283 04886000
         TM    DUMPSW,B'00000100'                                  1283 04887000
         BO    @RF01283                                            1283 04888000
         TM    SDUMPSW,B'00000010'                                 1283 04889000
         BO    @RF01283                                            1283 04890000
         CLC   CIFRGET(3),@CF00039+1                               1283 04891000
         BNH   @RF01283                                            1283 04892000
         LA    @15,5                                               1283 04893000
         SLR   @01,@01                                             1283 04894000
         IC    @01,$DATA                                           1283 04895000
         MR    @00,@15                                             1283 04896000
         LA    @14,CATRCTYP-5(@01)                                 1283 04897000
         CLC   ENTYPSAV(1),0(@14)                                  1283 04898000
         BE    @RT01283                                            1283 04899000
         SLR   @01,@01                                             1283 04900000
         IC    @01,$INDX                                           1283 04901000
         MR    @00,@15                                             1283 04902000
         LA    @14,CATRCTYP-5(@01)                                 1283 04903000
         CLC   ENTYPSAV(1),0(@14)                                  1283 04904000
         BE    @RT01283                                            1283 04905000
         SLR   @01,@01                                             1283 04906000
         IC    @01,$NONV                                           1283 04907000
         MR    @00,@15                                             1283 04908000
         LA    @14,CATRCTYP-5(@01)                                 1283 04909000
         CLC   ENTYPSAV(1),0(@14)                                  1283 04910000
         BE    @RT01283                                            1283 04911000
         SLR   @03,@03                                             1283 04912000
         IC    @03,$UCAT                                           1283 04913000
         MR    @14,@03                                             1283 04914000
         LA    @14,CATRCTYP-5(@15)                                 1283 04915000
         CLC   ENTYPSAV(1),0(@14)                                  1283 04916000
         BNE   @RF01283                                            1283 04917000
@RT01283 DS    0H                                                  1284 04918000
*     CALL PRTOJVL ;                                               1284 04919000
*                                                                  1284 04920000
         BAL   @14,PRTOJVL                                         1284 04921000
* IOBFSPTR = IOCRBPTR ;                                            1285 04922000
@RF01283 L     @15,IOCRBPTR                                        1285 04923000
         ST    @15,IOBFSPTR                                        1285 04924000
* IF SDUMPSW = ON                                                  1286 04925000
*   THEN $USEDLEN = CATCISZ - 4 ;  /* FULL RECORD IF SEQ DUMP        */ 04926000
         TM    SDUMPSW,B'00000010'                                 1286 04927000
         BNO   @RF01286                                            1286 04928000
         L     @01,FMFLADDR(,FMFLCUR)                              1287 04929000
         MVC   $USEDLEN(2,@01),@CH01136                            1287 04930000
*   ELSE                                                           1288 04931000
*     IF ENTYPSAV = CATRCTYP($FRSP)                                1288 04932000
*       THEN $USEDLEN = LENFRSP ;                                  1288 04933000
         B     @RC01286                                            1288 04934000
@RF01286 SLR   @15,@15                                             1288 04935000
         IC    @15,$FRSP                                           1288 04936000
         MH    @15,@CH00042                                        1288 04937000
         LA    @14,CATRCTYP-5(@15)                                 1288 04938000
         CLC   ENTYPSAV(1),0(@14)                                  1288 04939000
         BNE   @RF01288                                            1288 04940000
         L     @01,FMFLADDR(,FMFLCUR)                              1289 04941000
         MVC   $USEDLEN(2,@01),@CH00639                            1289 04942000
*       ELSE                                                       1290 04943000
*         IF ENTYPSAV = CATRCTYP($CCR)                             1290 04944000
*           THEN $USEDLEN = LENCCR ;                               1290 04945000
         B     @RC01288                                            1290 04946000
@RF01288 SLR   @15,@15                                             1290 04947000
         IC    @15,$CCR                                            1290 04948000
         MH    @15,@CH00042                                        1290 04949000
         LA    @14,CATRCTYP-5(@15)                                 1290 04950000
         CLC   ENTYPSAV(1),0(@14)                                  1290 04951000
         BNE   @RF01290                                            1290 04952000
         L     @01,FMFLADDR(,FMFLCUR)                              1291 04953000
         MVC   $USEDLEN(2,@01),@CH00637                            1291 04954000
*           ELSE                                                   1292 04955000
*             DO ;                                                 1292 04956000
         B     @RC01290                                            1292 04957000
@RF01290 DS    0H                                                  1293 04958000
*               IF CIFRGET > CTTBASE       /* IS TRANSLATE NEEDED    */ 04959000
*                 THEN FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;      1293 04960000
         L     @15,CIFRGET-1                                       1293 04961000
         LA    @15,0(,@15)                                         1293 04962000
         C     @15,@CF00039                                        1293 04963000
         BNH   @RF01293                                            1293 04964000
         SLA   @15,3                                               1294 04965000
         L     @01,FMPLAD                                          1294 04966000
         L     @14,CTTPTR                                          1294 04967000
         ALR   @14,@15                                             1294 04968000
         AL    @14,@CF01478                                        1294 04969000
         MVC   FMPLBCIN(3,@01),CTTCATCI-5(@14)                     1294 04970000
*                 ELSE FMPLBCIN = CIFRGET ;                        1295 04971000
         B     @RC01293                                            1295 04972000
@RF01293 L     @01,FMPLAD                                          1295 04973000
         MVC   FMPLBCIN(3,@01),CIFRGET                             1295 04974000
*               FMFLDNAM = ADDR('$USEDLEN') ;                      1296 04975000
@RC01293 LA    @15,@CC01336                                        1296 04976000
         ST    @15,FMFLDNAM(,FMFLCUR)                              1296 04977000
*               REG1 = FMPLAD ;                                    1297 04978000
*                                                                  1297 04979000
         L     REG1,FMPLAD                                         1297 04980000
*               CALL IDCRC04 ;     /* ASK FOR USED LENGTH            */ 04981000
*                                                                  1298 04982000
         L     @15,@CV00793                                        1298 04983000
         BALR  @14,@15                                             1298 04984000
*               IF FMFLENTH = 0 | $USEDLEN = 0                     1299 04985000
*                 THEN                                             1299 04986000
         L     @15,FMFLENTH(,FMFLCUR)                              1299 04987000
         LTR   @15,@15                                             1299 04988000
         BZ    @RT01299                                            1299 04989000
         L     @01,FMFLADDR(,FMFLCUR)                              1299 04990000
         LH    @15,$USEDLEN(,@01)                                  1299 04991000
         N     @15,@CF01475                                        1299 04992000
         LTR   @15,@15                                             1299 04993000
         BNZ   @RF01299                                            1299 04994000
@RT01299 DS    0H                                                  1300 04995000
*                   DO ;                                           1300 04996000
*                     PROCMSG='PRTCMP  '; /* NAME FOR INSERT @OZ09388*/ 04997000
         MVC   PROCMSG(8),@CC01337                                 1301 04998000
*                     CALL ERROR (26,$RETURN) ; /* FIELD MGMT        */ 04999000
         LA    @01,@AL01302                                        1302 05000000
         BAL   @14,ERROR                                           1302 05001000
*                     $USEDLEN = 508 ; /* PRINT WHOLE RECORD         */ 05002000
         L     @01,FMFLADDR(,FMFLCUR)                              1303 05003000
         MVC   $USEDLEN(2,@01),@CH01136                            1303 05004000
*                   END ;                                          1304 05005000
*     END ;                                                        1305 05006000
@RF01299 DS    0H                                                  1306 05007000
* CMPRLENL = MIN(256,$USEDLEN) ;                                   1306 05008000
@RC01290 DS    0H                                                  1306 05009000
@RC01288 DS    0H                                                  1306 05010000
@RC01286 LA    @15,256                                             1306 05011000
         L     @01,FMFLADDR(,FMFLCUR)                              1306 05012000
         LH    @14,$USEDLEN(,@01)                                  1306 05013000
         N     @14,@CF01475                                        1306 05014000
         LR    CMPRLENL,@15                                        1306 05015000
         CR    CMPRLENL,@14                                        1306 05016000
         BNH   *+6                                                      05017000
         LR    CMPRLENL,@14                                        1306 05018000
* CMPRLENR = MAX(0,$USEDLEN - 256) ;                               1307 05019000
         SLR   @01,@01                                             1307 05020000
         SLR   @14,@15                                             1307 05021000
         CR    @14,@01                                             1307 05022000
         BNL   *+6                                                      05023000
         LR    @14,@01                                             1307 05024000
         LR    CMPRLENR,@14                                        1307 05025000
* IF CMPRSW = ON & NOCATRSW ^= ON                                  1308 05026000
*   THEN                           /* COMPARE RECORDS                */ 05027000
         TM    CMPRSW,B'01000000'                                  1308 05028000
         BNO   @RF01308                                            1308 05029000
         TM    NOCATRSW,B'00000010'                                1308 05030000
         BO    @RF01308                                            1308 05031000
*     IF    IOBUF(BUFNO,1:CMPRLENL)  ^=                            1309 05032000
*           IOCTBPTR -> IOBUF(BUFNO,1:CMPRLENL)                    1309 05033000
*        | (CMPRLENR ^= 0                                          1309 05034000
*        & IOBUF(BUFNO,257:CMPRLENR)  ^=                           1309 05035000
*            IOCTBPTR -> IOBUF(BUFNO,257:CMPRLENR))                1309 05036000
*       THEN                                                       1309 05037000
         L     @15,IOBFSPTR                                        1309 05038000
         SLR   @14,@14                                             1309 05039000
         IC    @14,BUFNO                                           1309 05040000
         SLA   @14,9                                               1309 05041000
         L     @00,IOCTBPTR                                        1309 05042000
         LR    @01,CMPRLENL                                        1309 05043000
         BCTR  @01,0                                               1309 05044000
         ST    @14,@TF00001                                        1309 05045000
         ALR   @14,@15                                             1309 05046000
         AL    @14,@CF01464                                        1309 05047000
         LR    @15,@00                                             1309 05048000
         AL    @15,@TF00001                                        1309 05049000
         AL    @15,@CF01464                                        1309 05050000
         EX    @01,@SC01487                                        1309 05051000
         BNE   @RT01309                                            1309 05052000
         SLR   @01,@01                                             1309 05053000
         CR    CMPRLENR,@01                                        1309 05054000
         BE    @RF01309                                            1309 05055000
         L     @01,IOBFSPTR                                        1309 05056000
         LR    @15,CMPRLENR                                        1309 05057000
         SL    @15,@CF01189                                        1309 05058000
         AL    @01,@TF00001                                        1309 05059000
         AL    @01,@CF01465                                        1309 05060000
         LR    @14,@00                                             1309 05061000
         AL    @14,@TF00001                                        1309 05062000
         AL    @14,@CF01465                                        1309 05063000
         EX    @15,@SC01489                                        1309 05064000
         BE    @RF01309                                            1309 05065000
@RT01309 DS    0H                                                  1310 05066000
*         DO ;                     /******* MISCOMPARE ***************/ 05067000
*            MSCMPRSW = ON ;                                       1311 05068000
         OI    MSCMPRSW,B'00001000'                                1311 05069000
*            CTTMCSW(CIBASE - CTTBASE) = ON ;                      1312 05070000
         L     @15,CIBASE-1                                        1312 05071000
         LA    @15,0(,@15)                                         1312 05072000
         SLA   @15,3                                               1312 05073000
         L     @01,CTTPTR                                          1312 05074000
         ALR   @01,@15                                             1312 05075000
         AL    @01,@CF01491                                        1312 05076000
         OI    CTTMCSW-8(@01),B'01000000'                          1312 05077000
*           IF CMPRPASW = ON                                       1313 05078000
*             THEN                                                 1313 05079000
         TM    CMPRPASW,B'10000000'                                1313 05080000
         BNO   @RF01313                                            1313 05081000
*               DO ;               /* AVOID COUNTING DOUBLE          */ 05082000
*                 ENTNOSAV = ENTNOCUR ;                            1315 05083000
         LH    @15,ENTNOCUR                                        1315 05084000
         STH   @15,ENTNOSAV                                        1315 05085000
*                 ENTNOCUR = -1 ;                                  1316 05086000
         MVC   ENTNOCUR(2),@CH01288                                1316 05087000
*               END ;                                              1317 05088000
*           IF PRNTPASW = ON                                       1318 05089000
*             THEN MCRCDCNT = MCRCDCNT + 1 ;                       1318 05090000
@RF01313 TM    PRNTPASW,B'10000000'                                1318 05091000
         BNO   @RF01318                                            1318 05092000
         LH    @01,MCRCDCNT                                        1319 05093000
         LA    @01,1(,@01)                                         1319 05094000
         STH   @01,MCRCDCNT                                        1319 05095000
*         END ;                                                    1320 05096000
@RF01318 DS    0H                                                  1321 05097000
* IF    (PRNTPASW = ON             /* ONLY PRINT DUMP UNDER          */ 05098000
*    & DUMPSW = ON)                /* THESE CONDITIONS               */ 05099000
*     | SDUMPSW = ON                                               1321 05100000
*                                                                  1321 05101000
*   THEN CALL PRTDMP ;             /* PRINT DUMP FORMAT              */ 05102000
*                                                                  1321 05103000
@RF01309 DS    0H                                                  1321 05104000
@RF01308 TM    PRNTPASW,B'10000000'                                1321 05105000
         BNO   @GL00043                                            1321 05106000
         TM    DUMPSW,B'00000100'                                  1321 05107000
         BO    @RT01321                                            1321 05108000
@GL00043 TM    SDUMPSW,B'00000010'                                 1321 05109000
         BNO   @RF01321                                            1321 05110000
@RT01321 DS    0H                                                  1322 05111000
         BAL   @14,PRTDMP                                          1322 05112000
* IF PRNTPASW = ON & CIFRGET > CTTBASE                             1323 05113000
*   THEN  CTTPRTD(CIFRGET - CTTBASE) = ON ;                        1323 05114000
*                                                                  1323 05115000
@RF01321 TM    PRNTPASW,B'10000000'                                1323 05116000
         BNO   @RF01323                                            1323 05117000
         L     @15,CIFRGET-1                                       1323 05118000
         LA    @15,0(,@15)                                         1323 05119000
         C     @15,@CF00039                                        1323 05120000
         BNH   @RF01323                                            1323 05121000
         SLA   @15,3                                               1324 05122000
         L     @01,CTTPTR                                          1324 05123000
         ALR   @01,@15                                             1324 05124000
         AL    @01,@CF01491                                        1324 05125000
         OI    CTTPRTD-8(@01),B'10000000'                          1324 05126000
*END PRTCMP ;                                                      1325 05127000
@EL00021 DS    0H                                                  1325 05128000
@EF00021 DS    0H                                                  1325 05129000
@ER00021 LM    @14,@12,@SA00021                                    1325 05130000
         BR    @14                                                 1325 05131000
* /*******************************************************************/ 05132000
* /* PROCEDURE NAME - PRTDMP, PRINT RECORDS IF DUMP SPECIFIED        */ 05133000
* /* FUNCTION -                                                      */ 05134000
* /*   DIVIDING THE RECORD INTO PRINT LINES (UP TO 16),              */ 05135000
* /*     PRINT 32 CHARACTERS OF CRA RECORD IN 8 GROUPS OF 4          */ 05136000
* /*     (HEX) FOLLOWED BY THE 32 (CHAR) (LIKE DUMPS),               */ 05137000
* /*     IF COMPARE CALL PRTDMPC TO PRINT CORRESPONDING              */ 05138000
* /*     CHARACTERS FROM THE CATALOG RECORD AND BUILD AND            */ 05139000
* /*     PRINT THE LINE THAT UNDERSCORES WHICH CHARACTERS            */ 05140000
* /*     MISCOMPARED                                                 */ 05141000
* /* INPUTS -                                                        */ 05142000
* /*   CRA (AND CATALOG) RECORDS IDENTIFIED BY BUFNO, CIFRGET        */ 05143000
* /* OUTPUTS -                                                       */ 05144000
* /*   CRA PART OF 1 TO 48 LINES OF DUMP FORMAT RECORD(S)            */ 05145000
* /* CALLS -                                                         */ 05146000
* /*   UPRINT, PRTDMPC, ERROR                                        */ 05147000
* /*******************************************************************/ 05148000
*                                                                  1326 05149000
*PRTDMP: PROCEDURE ;                                               1326 05150000
PRTDMP   STM   @14,@12,@SA00022                                    1326 05151000
* IF GDTDBG = NULLPTR                                              1327 05152000
*   THEN;                                                          1327 05153000
         L     @15,@PC00001                                        1327 05154000
         L     @15,GDTDBG(,@15)                                    1327 05155000
         LTR   @15,@15                                             1327 05156000
         BZ    @RT01327                                            1327 05157000
*   ELSE                                                           1329 05158000
*     CALL IDCDB010 (GDTTBL,'LRPD') ;                              1329 05159000
         L     @15,@PC00001                                        1329 05160000
         ST    @15,@AL00001                                        1329 05161000
         LA    @14,@CC01344                                        1329 05162000
         ST    @14,@AL00001+4                                      1329 05163000
         MVI   @AL00001+4,X'80'                                    1329 05164000
         L     @15,GDTDBG(,@15)                                    1329 05165000
         LA    @01,@AL00001                                        1329 05166000
         BALR  @14,@15                                             1329 05167000
* OLDERID2 = NEWERID2;                                             1330 05168000
@RT01327 L     @15,@PC00001                                        1330 05169000
         L     @15,GDTTR2(,@15)                                    1330 05170000
         MVC   @TS00001(95),NEWERID2(@15)                          1330 05171000
         MVC   OLDERID2(95,@15),@TS00001                           1330 05172000
* NEWID2 = 'LRPD' ;                                                1331 05173000
*                                                                  1331 05174000
         MVC   NEWID2(4,@15),@CC01344                              1331 05175000
* RQDLINES = MIN(16,$USEDLEN/32 + 1) ;                             1332 05176000
         LA    @15,1                                               1332 05177000
         L     @01,FMFLADDR(,FMFLCUR)                              1332 05178000
         LH    @14,$USEDLEN(,@01)                                  1332 05179000
         N     @14,@CF01475                                        1332 05180000
         SRL   @14,5                                               1332 05181000
         ALR   @14,@15                                             1332 05182000
         LA    @03,16                                              1332 05183000
         CR    @14,@03                                             1332 05184000
         BNH   *+6                                                      05185000
         LR    @14,@03                                             1332 05186000
         STC   @14,RQDLINES                                        1332 05187000
* DARGLIST = '0'B ;                /* SET UP FOR PRINTING            */ 05188000
         L     @14,DDSTRU                                          1333 05189000
         XC    DARGLIST+1(19,@14),DARGLIST+1(@14)                  1333 05190000
         MVI   DARGLIST(@14),B'00000000'                           1333 05191000
* DARGSMOD = 'LR0' ;                                               1334 05192000
         MVC   DARGSMOD(3,@14),@CC01335                            1334 05193000
* DARGCNT = 10 ;                                                   1335 05194000
         MVC   DARGCNT(2,@14),@CH00037                             1335 05195000
* DO DARGSLOT = 1 TO 10 ;          /* INITIALIZE PART OF             */ 05196000
         LR    DARGSLOT,@15                                        1336 05197000
@DL01336 DS    0H                                                  1337 05198000
*   DARGINS(DARGSLOT) = DARGSLOT ; /* PRINT PARAMETER LIST           */ 05199000
         L     @03,DDSTRU                                          1337 05200000
         LR    @15,DARGSLOT                                        1337 05201000
         SLA   @15,3                                               1337 05202000
         STH   DARGSLOT,DARGINS-8(@15,@03)                         1337 05203000
*   DARGINL(DARGSLOT) = 4 ;                                        1338 05204000
         LA    @14,4                                               1338 05205000
         STH   @14,DARGINL-8(@15,@03)                              1338 05206000
* END ;                                                            1339 05207000
         AL    DARGSLOT,@CF00222                                   1339 05208000
         C     DARGSLOT,@CF00037                                   1339 05209000
         BNH   @DL01336                                            1339 05210000
* DARGINL(10) = 32 ;               /* FOR CHAR PART OF LINE          */ 05211000
         L     @15,DDSTRU                                          1340 05212000
         MVC   DARGINL+72(2,@15),@CH00224                          1340 05213000
* DARGSENT = 8 ;                   /* STATIC TEXT ENTRY NBR          */ 05214000
         MVI   DARGSENT(@15),X'08'                                 1341 05215000
* IOBFSPTR = IOCRBPTR ;                                            1342 05216000
         L     @15,IOCRBPTR                                        1342 05217000
         ST    @15,IOBFSPTR                                        1342 05218000
* SAVCRCI = IOBUFCI(BUFNO) ;       /* REMOVE BUFFER SEARCH           */ 05219000
         SLR   @14,@14                                             1343 05220000
         IC    @14,BUFNO                                           1343 05221000
         SLA   @14,9                                               1343 05222000
         ST    @14,@TF00001                                        1343 05223000
         ALR   @14,@15                                             1343 05224000
         AL    @14,@CF01466                                        1343 05225000
         MVC   SAVCRCI(3),IOBUFCI-509(@14)                         1343 05226000
* SAVCTCI = IOCTBPTR -> IOBUFCI(BUFNO) ;       /* ARGUMENTS          */ 05227000
         L     @14,IOCTBPTR                                        1344 05228000
         LR    @01,@14                                             1344 05229000
         AL    @01,@TF00001                                        1344 05230000
         AL    @01,@CF01466                                        1344 05231000
         MVC   SAVCTCI(3),IOBUFCI-509(@01)                         1344 05232000
* IOBUFCI(BUFNO) = 0 ;                                             1345 05233000
         SLR   @03,@03                                             1345 05234000
         AL    @15,@TF00001                                        1345 05235000
         AL    @15,@CF01466                                        1345 05236000
         STCM  @03,7,IOBUFCI-509(@15)                              1345 05237000
* IOCTBPTR -> IOBUFCI(BUFNO) = 0 ;                                 1346 05238000
*                                                                  1346 05239000
         AL    @14,@TF00001                                        1346 05240000
         AL    @14,@CF01466                                        1346 05241000
         STCM  @03,7,IOBUFCI-509(@14)                              1346 05242000
* /******************************************************************/  05243000
* /* LOOP: PRINT RECORD LINE BY LINE                                */  05244000
* /******************************************************************/  05245000
*                                                                  1347 05246000
* DO LINE = 1 TO RQDLINES ;                                        1347 05247000
         LA    @15,1                                               1347 05248000
         B     @DE01347                                            1347 05249000
@DL01347 DS    0H                                                  1348 05250000
*   LINEOFST = (LINE-1) * 32 ;                                     1348 05251000
         BCTR  @15,0                                               1348 05252000
         SLA   @15,5                                               1348 05253000
         STH   @15,LINEOFST                                        1348 05254000
*   IF LINE = 1                                                    1349 05255000
*     THEN                                                         1349 05256000
         CLI   LINE,1                                              1349 05257000
         BNE   @RF01349                                            1349 05258000
*       DO ;                       /* PRT CRA CI ON 1ST LINE         */ 05259000
*         DARGINL(1) = LENGTH(CIFRGET) ;                           1351 05260000
         L     @15,DDSTRU                                          1351 05261000
         MVC   DARGINL(2,@15),@CH00166                             1351 05262000
*         DARGDTM(1) = ADDR(CIFRGET) ;                             1352 05263000
         LA    @14,CIFRGET                                         1352 05264000
         ST    @14,DARGDTM(,@15)                                   1352 05265000
*       END ;                                                      1353 05266000
*     ELSE                                                         1354 05267000
*       DO ;                       /* PRINT OFSET OTHER LINES        */ 05268000
         B     @RC01349                                            1354 05269000
@RF01349 DS    0H                                                  1355 05270000
*         DARGINL(1) = LENGTH(LINEOFST) ;                          1355 05271000
         L     @15,DDSTRU                                          1355 05272000
         MVC   DARGINL(2,@15),@CH00158                             1355 05273000
*         DARGDTM(1) = ADDR(LINEOFST) ;                            1356 05274000
         LA    @14,LINEOFST                                        1356 05275000
         ST    @14,DARGDTM(,@15)                                   1356 05276000
*       END ;                                                      1357 05277000
*   INBFOFST = (LINE*8*4-3)+4-1 ;  /* ALIGN ON (END OF LINE          */ 05278000
@RC01349 SLR   INBFOFST,INBFOFST                                   1358 05279000
         IC    INBFOFST,LINE                                       1358 05280000
         SLA   INBFOFST,5                                          1358 05281000
*                                  /* GROUP) + GROUP LENGTH          */ 05282000
*   /*****************************************************************/ 05283000
*   /* LOOP: THRU THE 8 GROUPS OF HEXIDECIMAL CHARACTERS ON          */ 05284000
*   /*       EACH LINE SETTING THEM UP TO PRINT                      */ 05285000
*   /*****************************************************************/ 05286000
*                                                                  1359 05287000
*   DO GRPCOL = 8 TO 1 BY -1 ;                                     1359 05288000
         LA    GRPCOL,8                                            1359 05289000
@DL01359 DS    0H                                                  1360 05290000
*     INBFOFST = INBFOFST - 4 ;    /* SHIFT LEFT ONE GROUP           */ 05291000
         LA    @15,4                                               1360 05292000
         SLR   INBFOFST,@15                                        1360 05293000
*     DARGINL(GRPCOL+1)=4;                                 /*@OZ05920*/ 05294000
         L     @14,DDSTRU                                          1361 05295000
         LR    @01,GRPCOL                                          1361 05296000
         SLA   @01,3                                               1361 05297000
         STH   @15,DARGINL(@01,@14)                                1361 05298000
*     DARGDTM(GRPCOL+1) = ADDR(IOBUF(BUFNO)) + INBFOFST ;          1362 05299000
         SLR   @15,@15                                             1362 05300000
         IC    @15,BUFNO                                           1362 05301000
         SLA   @15,9                                               1362 05302000
         ST    @01,@TF00001                                        1362 05303000
         L     @01,IOBFSPTR                                        1362 05304000
         AL    @01,@CF01464                                        1362 05305000
         LA    @15,IOBUF(@15,@01)                                  1362 05306000
         ALR   @15,INBFOFST                                        1362 05307000
         L     @01,@TF00001                                        1362 05308000
         ST    @15,DARGDTM(@01,@14)                                1362 05309000
*   END ;                                                          1363 05310000
         BCTR  GRPCOL,0                                            1363 05311000
         C     GRPCOL,@CF00222                                     1363 05312000
         BNL   @DL01359                                            1363 05313000
*   DARGDTM(10) = DARGDTM(2) ;     /* FOR CHARACTER PART DUMP        */ 05314000
*                                                                  1364 05315000
         L     @15,DDSTRU                                          1364 05316000
         L     @14,DARGDTM+8(,@15)                                 1364 05317000
         ST    @14,DARGDTM+72(,@15)                                1364 05318000
*   CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                        1365 05319000
*                                                                  1365 05320000
         L     @15,@PC00001                                        1365 05321000
         ST    @15,@AL00001                                        1365 05322000
         LA    @14,IOCSPRT                                         1365 05323000
         ST    @14,@AL00001+4                                      1365 05324000
         LA    @14,DDSTRU                                          1365 05325000
         ST    @14,@AL00001+8                                      1365 05326000
         MVI   @AL00001+8,X'80'                                    1365 05327000
         L     @15,GDTPRT(,@15)                                    1365 05328000
         LA    @01,@AL00001                                        1365 05329000
         BALR  @14,@15                                             1365 05330000
*   IF CMPRSW = ON & NOCATRSW ^= ON                                1366 05331000
*     THEN                                                         1366 05332000
*                                                                  1366 05333000
         TM    CMPRSW,B'01000000'                                  1366 05334000
         BNO   @RF01366                                            1366 05335000
         TM    NOCATRSW,B'00000010'                                1366 05336000
         BO    @RF01366                                            1366 05337000
*       CALL PRTDMPC ;             /* GO DO CAT & UNDERLINE          */ 05338000
*                                                                  1367 05339000
         BAL   @14,PRTDMPC                                         1367 05340000
*   DARGSENT = 10 ;                                                1368 05341000
@RF01366 L     @01,DDSTRU                                          1368 05342000
         MVI   DARGSENT(@01),X'0A'                                 1368 05343000
* END ;                                                            1369 05344000
         LA    @15,1                                               1369 05345000
         SLR   @14,@14                                             1369 05346000
         IC    @14,LINE                                            1369 05347000
         ALR   @15,@14                                             1369 05348000
@DE01347 STC   @15,LINE                                            1369 05349000
         SLR   @14,@14                                             1369 05350000
         IC    @14,RQDLINES                                        1369 05351000
         CR    @15,@14                                             1369 05352000
         BNH   @DL01347                                            1369 05353000
* IOBUFCI(BUFNO) = SAVCRCI ;                                       1370 05354000
         SLR   @15,@15                                             1370 05355000
         IC    @15,BUFNO                                           1370 05356000
         SLA   @15,9                                               1370 05357000
         L     @01,IOBFSPTR                                        1370 05358000
         ALR   @01,@15                                             1370 05359000
         AL    @01,@CF01466                                        1370 05360000
         MVC   IOBUFCI-509(3,@01),SAVCRCI                          1370 05361000
* IOCTBPTR -> IOBUFCI(BUFNO) = SAVCTCI ;                           1371 05362000
*                                                                  1371 05363000
         L     @01,IOCTBPTR                                        1371 05364000
         ALR   @01,@15                                             1371 05365000
         AL    @01,@CF01466                                        1371 05366000
         MVC   IOBUFCI-509(3,@01),SAVCTCI                          1371 05367000
*END PRTDMP ;                                                      1372 05368000
@EL00022 DS    0H                                                  1372 05369000
@EF00022 DS    0H                                                  1372 05370000
@ER00022 LM    @14,@12,@SA00022                                    1372 05371000
         BR    @14                                                 1372 05372000
* /*******************************************************************/ 05373000
* /* PROCEDURE NAME - PRTDMPC, PRINT DUMP CAT RCDS & CMPR LIN        */ 05374000
* /* FUNCTION -                                                      */ 05375000
* /*   PRINT 32 CHARACTERS OF CATALOG RECORD IN DUMP FORMAT          */ 05376000
* /*   AND LINE UNDERNEATH OF UNDERSCORES OF MISCOMPARING            */ 05377000
* /*   CHARACTERS                                                    */ 05378000
* /* INPUTS -                                                        */ 05379000
* /*   LINE (IDENTIFIES WHICH PRINT LINE (1 TO 16) TO PRINT          */ 05380000
* /* OUTPUTS -                                                       */ 05381000
* /*   CATALOG RECORDS AND UNDERSCORE LINES FOR PRTDMP               */ 05382000
* /* CALLS -                                                         */ 05383000
* /*   UPRINT                                                        */ 05384000
* /*******************************************************************/ 05385000
*                                                                  1373 05386000
*PRTDMPC: PROCEDURE ;                                              1373 05387000
PRTDMPC  STM   @14,@12,@SA00023                                    1373 05388000
* OLDERID2 = NEWERID2;                                             1374 05389000
         L     @04,@PC00001                                        1374 05390000
         L     @15,GDTTR2(,@04)                                    1374 05391000
         MVC   @TS00001(95),NEWERID2(@15)                          1374 05392000
         MVC   OLDERID2(95,@15),@TS00001                           1374 05393000
* NEWID2 = 'LRPE' ;                                                1375 05394000
         MVC   NEWID2(4,@15),@CC01349                              1375 05395000
* IF GDTDBG = NULLPTR                                              1376 05396000
*   THEN;                                                          1376 05397000
         L     @04,GDTDBG(,@04)                                    1376 05398000
         LTR   @04,@04                                             1376 05399000
         BZ    @RT01376                                            1376 05400000
*   ELSE                                                           1378 05401000
*     CALL IDCDB010 (GDTTBL,'LRPE') ;                              1378 05402000
         L     @04,@PC00001                                        1378 05403000
         ST    @04,@AL00001                                        1378 05404000
         LA    @15,@CC01349                                        1378 05405000
         ST    @15,@AL00001+4                                      1378 05406000
         MVI   @AL00001+4,X'80'                                    1378 05407000
         L     @15,GDTDBG(,@04)                                    1378 05408000
         LA    @01,@AL00001                                        1378 05409000
         BALR  @14,@15                                             1378 05410000
* DARGSENT = 9 ;                   /* STATIC TEXT ENTRY NBR          */ 05411000
@RT01376 L     @04,DDSTRU                                          1379 05412000
         MVI   DARGSENT(@04),X'09'                                 1379 05413000
* IOBFSPTR = IOCTBPTR ;                                            1380 05414000
         L     @04,IOCTBPTR                                        1380 05415000
         ST    @04,IOBFSPTR                                        1380 05416000
* MCMPRMRK = ' ' ;                 /* CLEAR LEFT MARGIN MARK         */ 05417000
         MVI   MCMPRMRK,C' '                                       1381 05418000
* DO GRPCOL = 1 TO 8 ;             /* AND ALL UNDERLINES             */ 05419000
         LA    GRPCOL,1                                            1382 05420000
@DL01382 DS    0H                                                  1383 05421000
*   MCMPRARY(GRPCOL) = '        ' ;                                1383 05422000
         LR    @04,GRPCOL                                          1383 05423000
         SLA   @04,3                                               1383 05424000
         LA    @03,MCMPRARY-8(@04)                                 1383 05425000
         MVC   0(8,@03),@CC01350                                   1383 05426000
* END ;                                                            1384 05427000
         AL    GRPCOL,@CF00222                                     1384 05428000
         C     GRPCOL,@CF00039                                     1384 05429000
         BNH   @DL01382                                            1384 05430000
* IF LINE = 1                                                      1385 05431000
*   THEN                                                           1385 05432000
         CLI   LINE,1                                              1385 05433000
         BNE   @RF01385                                            1385 05434000
*     DO ;                         /* IDENTIFY CATALOG RECORD        */ 05435000
*       DARGINL(1) = LENGTH(NCATRCD) ;                             1387 05436000
         L     @04,DDSTRU                                          1387 05437000
         MVC   DARGINL(2,@04),@CH00041                             1387 05438000
*       DARGDTM(1) = ADDR(NCATRCD) ;                               1388 05439000
         LA    @15,NCATRCD                                         1388 05440000
         ST    @15,DARGDTM(,@04)                                   1388 05441000
*     END ;                                                        1389 05442000
*   ELSE                                                           1390 05443000
*     DO ;                                                         1390 05444000
         B     @RC01385                                            1390 05445000
@RF01385 DS    0H                                                  1391 05446000
*       DARGINL(1) = LENGTH(LINEOFST) ;                            1391 05447000
         L     @04,DDSTRU                                          1391 05448000
         MVC   DARGINL(2,@04),@CH00158                             1391 05449000
*       DARGDTM(1) = ADDR(BLANKS6) ;                               1392 05450000
         LA    @15,BLANKS6                                         1392 05451000
         ST    @15,DARGDTM(,@04)                                   1392 05452000
*     END ;                                                        1393 05453000
* INBFOFST = (LINE*8*4-4)+4 ;      /* ALIGN ON (END OF LINE          */ 05454000
@RC01385 SLR   INBFOFST,INBFOFST                                   1394 05455000
         IC    INBFOFST,LINE                                       1394 05456000
         SLA   INBFOFST,5                                          1394 05457000
*                                  /* GROUP) + GROUP LENGTH          */ 05458000
*                                                                  1395 05459000
* /*******************************************************************/ 05460000
* /* LOOP: THRU THE 8 GROUPS OF HEXIDECIMAL CHARACTERS ON            */ 05461000
* /*       EACH LINE SETTING THEM UP TO PRINT                        */ 05462000
* /*******************************************************************/ 05463000
*                                                                  1395 05464000
* DO GRPCOL = 8 TO 1 BY -1 ;                                       1395 05465000
         LA    GRPCOL,8                                            1395 05466000
@DL01395 DS    0H                                                  1396 05467000
*   INBFOFST = INBFOFST - 4 ;      /* SHIFT LEFT 1 GROUP             */ 05468000
         SL    INBFOFST,@CF00047                                   1396 05469000
*   DARGDTM(GRPCOL+1) = ADDR(IOBUF(BUFNO)) + INBFOFST ;            1397 05470000
*                                                                  1397 05471000
         LR    @04,GRPCOL                                          1397 05472000
         SLA   @04,3                                               1397 05473000
         SLR   @15,@15                                             1397 05474000
         IC    @15,BUFNO                                           1397 05475000
         SLA   @15,9                                               1397 05476000
         L     @01,IOBFSPTR                                        1397 05477000
         AL    @01,@CF01464                                        1397 05478000
         LA    @15,IOBUF(@15,@01)                                  1397 05479000
         ALR   @15,INBFOFST                                        1397 05480000
         L     @14,DDSTRU                                          1397 05481000
         ST    @15,DARGDTM(@04,@14)                                1397 05482000
*   /*****************************************************************/ 05483000
*   /* LOOP: CHECK THE 4 CHARACTERS IN EACH GROUP ONE BY ONE         */ 05484000
*   /*       FOR ANY MISCOMPARES                                     */ 05485000
*   /*****************************************************************/ 05486000
*                                                                  1398 05487000
*   DO CMPRCOL = 0 TO 3 ;                                          1398 05488000
         SLR   CMPRCOL,CMPRCOL                                     1398 05489000
@DL01398 DS    0H                                                  1399 05490000
*     MCBFOFST = INBFOFST + CMPRCOL + 1 ; /* USE AS SUBSCRIPT        */ 05491000
         LR    @15,INBFOFST                                        1399 05492000
         ALR   @15,CMPRCOL                                         1399 05493000
         LA    @15,1(,@15)                                         1399 05494000
         STC   @15,MCBFOFST                                        1399 05495000
*     IF IOCRBPTR -> IOBUF(BUFNO,MCBFOFST) ^=                      1400 05496000
*                    IOBUF(BUFNO,MCBFOFST)                         1400 05497000
*       THEN                                                       1400 05498000
         SLR   @14,@14                                             1400 05499000
         IC    @14,BUFNO                                           1400 05500000
         SLA   @14,9                                               1400 05501000
         ALR   @14,@15                                             1400 05502000
         L     @01,IOCRBPTR                                        1400 05503000
         ALR   @01,@14                                             1400 05504000
         AL    @01,@CF01492                                        1400 05505000
         L     @15,IOBFSPTR                                        1400 05506000
         ALR   @15,@14                                             1400 05507000
         AL    @15,@CF01492                                        1400 05508000
         CLC   IOBUF(1,@01),IOBUF(@15)                             1400 05509000
         BE    @RF01400                                            1400 05510000
*         DO ;                                                     1401 05511000
*           MCMPRARY(GRPCOL,CMPRCOL*2+1:CMPRCOL*2+2) = '**' ;      1402 05512000
         LR    @15,GRPCOL                                          1402 05513000
         SLA   @15,3                                               1402 05514000
         LR    @14,CMPRCOL                                         1402 05515000
         ALR   @14,@14                                             1402 05516000
         ALR   @15,@14                                             1402 05517000
         LA    @14,MCMPRARY-8(@15)                                 1402 05518000
         MVC   0(2,@14),@CC01351                                   1402 05519000
*           MCMPRMRK = '*' ;                                       1403 05520000
         MVI   MCMPRMRK,C'*'                                       1403 05521000
*         END ;                                                    1404 05522000
*   END ;                                                          1405 05523000
@RF01400 AL    CMPRCOL,@CF00222                                    1405 05524000
         C     CMPRCOL,@CF00166                                    1405 05525000
         BNH   @DL01398                                            1405 05526000
* END ;                                                            1406 05527000
         BCTR  GRPCOL,0                                            1406 05528000
         C     GRPCOL,@CF00222                                     1406 05529000
         BNL   @DL01395                                            1406 05530000
* DARGDTM(10) = DARGDTM(2) ;       /* FOR THE CHARACTER PART         */ 05531000
         L     @04,DDSTRU                                          1407 05532000
         L     @15,DARGDTM+8(,@04)                                 1407 05533000
         ST    @15,DARGDTM+72(,@04)                                1407 05534000
*                                  /* OF THE DUMP FORMAT             */ 05535000
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1408 05536000
*                                                                  1408 05537000
         L     @04,@PC00001                                        1408 05538000
         ST    @04,@AL00001                                        1408 05539000
         LA    @15,IOCSPRT                                         1408 05540000
         ST    @15,@AL00001+4                                      1408 05541000
         LA    @15,DDSTRU                                          1408 05542000
         ST    @15,@AL00001+8                                      1408 05543000
         MVI   @AL00001+8,X'80'                                    1408 05544000
         L     @15,GDTPRT(,@04)                                    1408 05545000
         LA    @01,@AL00001                                        1408 05546000
         BALR  @14,@15                                             1408 05547000
* DARGCNT = 9 ;                                                    1409 05548000
         L     @04,DDSTRU                                          1409 05549000
         MVC   DARGCNT(2,@04),@CH00038                             1409 05550000
* DARGSENT = 11 ;                                                  1410 05551000
         MVI   DARGSENT(@04),X'0B'                                 1410 05552000
* DARGINL(1) = LENGTH(MCMPRMRK) ;                                  1411 05553000
         LA    @15,1                                               1411 05554000
         STH   @15,DARGINL(,@04)                                   1411 05555000
* DARGDTM(1) = ADDR(MCMPRMRK) ;                                    1412 05556000
         LA    @14,MCMPRMRK                                        1412 05557000
         ST    @14,DARGDTM(,@04)                                   1412 05558000
* DO GRPCOL = 1 TO 8 ;             /* SET UP UNDERLINES TO           */ 05559000
         LR    GRPCOL,@15                                          1413 05560000
@DL01413 DS    0H                                                  1414 05561000
*   DARGINL(GRPCOL+1) = 8 ;        /* PRINT OUT                      */ 05562000
         L     @04,DDSTRU                                          1414 05563000
         LR    @03,GRPCOL                                          1414 05564000
         SLA   @03,3                                               1414 05565000
         LA    @15,8                                               1414 05566000
         STH   @15,DARGINL(@03,@04)                                1414 05567000
*   DARGDTM(GRPCOL+1) = ADDR(MCMPRARY(GRPCOL)) ;                   1415 05568000
         LA    @15,MCMPRARY-8(@03)                                 1415 05569000
         ST    @15,DARGDTM(@03,@04)                                1415 05570000
* END ;                                                            1416 05571000
*                                                                  1416 05572000
         AL    GRPCOL,@CF00222                                     1416 05573000
         C     GRPCOL,@CF00039                                     1416 05574000
         BNH   @DL01413                                            1416 05575000
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1417 05576000
*                                                                  1417 05577000
         L     @04,@PC00001                                        1417 05578000
         ST    @04,@AL00001                                        1417 05579000
         LA    @15,IOCSPRT                                         1417 05580000
         ST    @15,@AL00001+4                                      1417 05581000
         LA    @15,DDSTRU                                          1417 05582000
         ST    @15,@AL00001+8                                      1417 05583000
         MVI   @AL00001+8,X'80'                                    1417 05584000
         L     @15,GDTPRT(,@04)                                    1417 05585000
         LA    @01,@AL00001                                        1417 05586000
         BALR  @14,@15                                             1417 05587000
* DARGCNT = 10 ;                                                   1418 05588000
         L     @04,DDSTRU                                          1418 05589000
         MVC   DARGCNT(2,@04),@CH00037                             1418 05590000
* IOBFSPTR = IOCRBPTR ;            /* RESTORE TO ASSUMED VALU        */ 05591000
*                                                                  1419 05592000
         L     @04,IOCRBPTR                                        1419 05593000
         ST    @04,IOBFSPTR                                        1419 05594000
*END PRTDMPC ;                                                     1420 05595000
@EL00023 DS    0H                                                  1420 05596000
@EF00023 DS    0H                                                  1420 05597000
@ER00023 LM    @14,@12,@SA00023                                    1420 05598000
         BR    @14                                                 1420 05599000
* /*******************************************************************/ 05600000
* /* PROCEDURE NAME - PRTFIFO, PRINT CRA FIRST IN FIRST OUT          */ 05601000
* /* FUNCTION -                                                      */ 05602000
* /*   LOOP THRU CTT,                                                */ 05603000
* /*     IF DUMP START AT CI = 0 AND INCLUDE FREESPACE RCDS,         */ 05604000
* /*     IF NAMES START AT CI = 9 AND SKIP FREESPACE RECORDS,        */ 05605000
* /*     IF RECORD NOT ALREADY PROCESSED GET THE RECORD              */ 05606000
* /*     AND PRINT IT AND ITS STRUCTURE AS SPECIFIED                 */ 05607000
* /* INPUTS -                                                        */ 05608000
* /*   CTT (ALREADY PROCESSED RECORDS (IF ANY) MARKED)               */ 05609000
* /* OUTPUTS -                                                       */ 05610000
* /*   LIST OF CRA RECORDS AND THEIR STRUCTURES IN THE ORDER         */ 05611000
* /*   THEY OCCUR IN IN THE CRA BYPASSING ALREADY PRINTED            */ 05612000
* /* CALLS -                                                         */ 05613000
* /*   UREST, GETPRT, PRTVSAM, PRTOTHR, SUMIT                        */ 05614000
* /*******************************************************************/ 05615000
*                                                                  1421 05616000
*PRTFIFO: PROCEDURE ;                                              1421 05617000
PRTFIFO  STM   @14,@12,@SA00024                                    1421 05618000
*   OLDERID2 = NEWERID2;                                           1422 05619000
         L     @15,@PC00001                                        1422 05620000
         L     @14,GDTTR2(,@15)                                    1422 05621000
         MVC   @TS00001(95),NEWERID2(@14)                          1422 05622000
         MVC   OLDERID2(95,@14),@TS00001                           1422 05623000
*   NEWID2 = 'LRPF' ;                                              1423 05624000
         MVC   NEWID2(4,@14),@CC01356                              1423 05625000
*   IF GDTDBG = NULLPTR                                            1424 05626000
*     THEN;                                                        1424 05627000
         L     @15,GDTDBG(,@15)                                    1424 05628000
         LTR   @15,@15                                             1424 05629000
         BZ    @RT01424                                            1424 05630000
*     ELSE                                                         1426 05631000
*       CALL IDCDB010 (GDTTBL,'LRPF') ;                            1426 05632000
         L     @15,@PC00001                                        1426 05633000
         ST    @15,@AL00001                                        1426 05634000
         LA    @14,@CC01356                                        1426 05635000
         ST    @14,@AL00001+4                                      1426 05636000
         MVI   @AL00001+4,X'80'                                    1426 05637000
         L     @15,GDTDBG(,@15)                                    1426 05638000
         LA    @01,@AL00001                                        1426 05639000
         BALR  @14,@15                                             1426 05640000
*   SUBGROUP = 'UNSORTED ENTRIES' ;     /* RESET PAGE HEADER         */ 05641000
@RT01424 MVC   SUBGROUP(16),@CC01357                               1427 05642000
*   IF GDTECT = NULLPTR                 /* IF NOT RUNNING UNDER TSO  */ 05643000
*                                                                  1428 05644000
*     THEN CALL AMSTP043 (GDTTBL,IOCSPRT,PCRST) ;                  1428 05645000
*                                                                  1428 05646000
         L     @15,@PC00001                                        1428 05647000
         L     @14,GDTECT(,@15)                                    1428 05648000
         LTR   @14,@14                                             1428 05649000
         BNZ   @RF01428                                            1428 05650000
         ST    @15,@AL00001                                        1429 05651000
         LA    @14,IOCSPRT                                         1429 05652000
         ST    @14,@AL00001+4                                      1429 05653000
         LA    @14,PCRST                                           1429 05654000
         ST    @14,@AL00001+8                                      1429 05655000
         MVI   @AL00001+8,X'80'                                    1429 05656000
         L     @15,GDTRST(,@15)                                    1429 05657000
         LA    @01,@AL00001                                        1429 05658000
         BALR  @14,@15                                             1429 05659000
*   INDNTCOL = 0 ;                                                 1430 05660000
@RF01428 MVI   INDNTCOL,X'00'                                      1430 05661000
*    PRNTPASW = ON ;                                               1431 05662000
         OI    PRNTPASW,B'10000000'                                1431 05663000
*   IF DUMPSW = ON & CMPRSW = OFF                                  1432 05664000
*     THEN                                                         1432 05665000
         TM    DUMPSW,B'00000100'                                  1432 05666000
         BNO   @RF01432                                            1432 05667000
         TM    CMPRSW,B'01000000'                                  1432 05668000
         BNZ   @RF01432                                            1432 05669000
*       DO CTLOOP = 0 TO CTTBASE ; /* UNDER THESE CONDITIONS         */ 05670000
         SLR   CTLOOP,CTLOOP                                       1433 05671000
@DL01433 DS    0H                                                  1434 05672000
*         CIFRGET = CTLOOP ;                                       1434 05673000
*                                                                  1434 05674000
         STCM  CTLOOP,7,CIFRGET                                    1434 05675000
*         CALL GETPRT ;            /* GET,PRINT SELF DESCRIBN        */ 05676000
*                                                                  1435 05677000
         BAL   @14,GETPRT                                          1435 05678000
*       END ;                                                      1436 05679000
*                                                                  1436 05680000
         AL    CTLOOP,@CF00222                                     1436 05681000
         C     CTLOOP,@CF00039                                     1436 05682000
         BNH   @DL01433                                            1436 05683000
*   STPTR = ADDR(STDUMMY) ;        /* SET UP DUMMY SORTTBL           */ 05684000
@RF01432 LA    @02,STDUMMY                                         1437 05685000
         ST    @02,STPTR                                           1437 05686000
*   STSLOT = 1 ;                   /* FOR LOWER LEVEL SEGMNTS        */ 05687000
*                                                                  1438 05688000
         LA    @15,1                                               1438 05689000
         LR    STSLOT,@15                                          1438 05690000
*   /*****************************************************************/ 05691000
*   /* LOOP: MAKING A LAST PASS THRU THE CTT FOR UNPRINTED           */ 05692000
*   /*****************************************************************/ 05693000
*                                                                  1439 05694000
*   DO CTTSLOT = 1 TO CTTENTNO ;                                   1439 05695000
         B     @DE01439                                            1439 05696000
@DL01439 DS    0H                                                  1440 05697000
*     ENTYP = CTTENTYP(CTTSLOT) ;                                  1440 05698000
         L     @02,CTTPTR                                          1440 05699000
         SLA   @15,3                                               1440 05700000
         ST    @15,@TF00001                                        1440 05701000
         ALR   @15,@02                                             1440 05702000
         AL    @15,@CF01476                                        1440 05703000
         MVC   ENTYP(1),CTTENTYP-4(@15)                            1440 05704000
*     IF    CTTPRTD(CTTSLOT) = ON       /* BYPASS IF ALREADY         */ 05705000
*        | CMPRSW = ON                  /* PRNTED, COMPARE OR        */ 05706000
*        | (DUMPSW ^= ON                /* DUMP SPECIFIED AND        */ 05707000
*        & (ENTYP = CATRCTYP($FRSP)     /* FREESPACE OR EXTN         */ 05708000
*          | ENTYP = CATRCTYP($OEXT)    /* RECORDS (NOT EVER         */ 05709000
*          | ENTYP = CATRCTYP($VEXT)))  /* MARKED AS PRINTED)        */ 05710000
*       THEN ;                                                     1441 05711000
         AL    @02,@TF00001                                        1441 05712000
         TM    CTTPRTD-8(@02),B'10000000'                          1441 05713000
         BO    @RT01441                                            1441 05714000
         TM    CMPRSW,B'01000000'                                  1441 05715000
         BO    @RT01441                                            1441 05716000
         TM    DUMPSW,B'00000100'                                  1441 05717000
         BO    @RF01441                                            1441 05718000
         LA    @02,5                                               1441 05719000
         SLR   @01,@01                                             1441 05720000
         IC    @01,$FRSP                                           1441 05721000
         MR    @00,@02                                             1441 05722000
         LA    @15,CATRCTYP-5(@01)                                 1441 05723000
         CLC   ENTYP(1),0(@15)                                     1441 05724000
         BE    @RT01441                                            1441 05725000
         SLR   @01,@01                                             1441 05726000
         IC    @01,$OEXT                                           1441 05727000
         MR    @00,@02                                             1441 05728000
         LA    @15,CATRCTYP-5(@01)                                 1441 05729000
         CLC   ENTYP(1),0(@15)                                     1441 05730000
         BE    @RT01441                                            1441 05731000
         LR    @01,@02                                             1441 05732000
         SLR   @02,@02                                             1441 05733000
         IC    @02,$VEXT                                           1441 05734000
         MR    @00,@02                                             1441 05735000
         LA    @02,CATRCTYP-5(@01)                                 1441 05736000
         CLC   ENTYP(1),0(@02)                                     1441 05737000
         BE    @RT01441                                            1441 05738000
*       ELSE                                                       1443 05739000
*         DO ;                                                     1443 05740000
@RF01441 DS    0H                                                  1444 05741000
*           IF     ENTYP ^= CATRCTYP($VEXT)                        1444 05742000
*              & ENTYP ^= CATRCTYP($OEXT)                          1444 05743000
*                                                                  1444 05744000
*             THEN CALL SUMIT (SMACCUM,ENTYP) ;                    1444 05745000
*                                                                  1444 05746000
         LA    @02,5                                               1444 05747000
         SLR   @01,@01                                             1444 05748000
         IC    @01,$VEXT                                           1444 05749000
         MR    @00,@02                                             1444 05750000
         LA    @15,CATRCTYP-5(@01)                                 1444 05751000
         CLC   ENTYP(1),0(@15)                                     1444 05752000
         BE    @RF01444                                            1444 05753000
         LR    @01,@02                                             1444 05754000
         SLR   @02,@02                                             1444 05755000
         IC    @02,$OEXT                                           1444 05756000
         MR    @00,@02                                             1444 05757000
         LA    @02,CATRCTYP-5(@01)                                 1444 05758000
         CLC   ENTYP(1),0(@02)                                     1444 05759000
         BE    @RF01444                                            1444 05760000
         LA    @02,SMACCUM                                         1445 05761000
         ST    @02,@AL00001                                        1445 05762000
         LA    @02,ENTYP                                           1445 05763000
         ST    @02,@AL00001+4                                      1445 05764000
         LA    @01,@AL00001                                        1445 05765000
         BAL   @14,SUMIT                                           1445 05766000
*           STENTYP(1) = ENTYP ;                                   1446 05767000
@RF01444 L     @02,STPTR                                           1446 05768000
         MVC   STENTYP(1,@02),ENTYP                                1446 05769000
*           STCRACI(1) = CTTSLOT + CTTBASE ;                       1447 05770000
         LA    @15,8                                               1447 05771000
         LH    @14,CTTSLOT                                         1447 05772000
         N     @14,@CF01475                                        1447 05773000
         ALR   @15,@14                                             1447 05774000
         STCM  @15,7,STCRACI(@02)                                  1447 05775000
*           IF    ENTYP = CATRCTYP($CLUS)                          1448 05776000
*              | ENTYP = CATRCTYP($AIX)                            1448 05777000
*             THEN                                                 1448 05778000
*                                                                  1448 05779000
         LA    @02,5                                               1448 05780000
         SLR   @01,@01                                             1448 05781000
         IC    @01,$CLUS                                           1448 05782000
         MR    @00,@02                                             1448 05783000
         LA    @15,CATRCTYP-5(@01)                                 1448 05784000
         CLC   ENTYP(1),0(@15)                                     1448 05785000
         BE    @RT01448                                            1448 05786000
         LR    @01,@02                                             1448 05787000
         SLR   @02,@02                                             1448 05788000
         IC    @02,$AIX                                            1448 05789000
         MR    @00,@02                                             1448 05790000
         LA    @02,CATRCTYP-5(@01)                                 1448 05791000
         CLC   ENTYP(1),0(@02)                                     1448 05792000
         BNE   @RF01448                                            1448 05793000
@RT01448 DS    0H                                                  1449 05794000
*               CALL PRTVSAM ;     /* PRINT VSAM STRUCTURE           */ 05795000
*                                                                  1449 05796000
         BAL   @14,PRTVSAM                                         1449 05797000
*             ELSE                                                 1450 05798000
*               IF    ENTYP = CATRCTYP($NONV)                      1450 05799000
*                  | ENTYP = CATRCTYP($GDGB)                       1450 05800000
*                  | ENTYP = CATRCTYP($UCAT)                       1450 05801000
*                 THEN                                             1450 05802000
*                                                                  1450 05803000
         B     @RC01448                                            1450 05804000
@RF01448 LA    @02,5                                               1450 05805000
         SLR   @01,@01                                             1450 05806000
         IC    @01,$NONV                                           1450 05807000
         MR    @00,@02                                             1450 05808000
         LA    @15,CATRCTYP-5(@01)                                 1450 05809000
         CLC   ENTYP(1),0(@15)                                     1450 05810000
         BE    @RT01450                                            1450 05811000
         SLR   @01,@01                                             1450 05812000
         IC    @01,$GDGB                                           1450 05813000
         MR    @00,@02                                             1450 05814000
         LA    @15,CATRCTYP-5(@01)                                 1450 05815000
         CLC   ENTYP(1),0(@15)                                     1450 05816000
         BE    @RT01450                                            1450 05817000
         LR    @01,@02                                             1450 05818000
         SLR   @02,@02                                             1450 05819000
         IC    @02,$UCAT                                           1450 05820000
         MR    @00,@02                                             1450 05821000
         LA    @02,CATRCTYP-5(@01)                                 1450 05822000
         CLC   ENTYP(1),0(@02)                                     1450 05823000
         BNE   @RF01450                                            1450 05824000
@RT01450 DS    0H                                                  1451 05825000
*                   CALL PRTOTHR ; /* PRINT OTHER STRUCTURE          */ 05826000
*                                                                  1451 05827000
         BAL   @14,PRTOTHR                                         1451 05828000
*                 ELSE                                             1452 05829000
*                   DO ;                                           1452 05830000
         B     @RC01450                                            1452 05831000
@RF01450 DS    0H                                                  1453 05832000
*                      PRNTPASW = ON ;                             1453 05833000
         OI    PRNTPASW,B'10000000'                                1453 05834000
*                     CIFRGET = CTTSLOT + CTTBASE ;                1454 05835000
         LH    @02,CTTSLOT                                         1454 05836000
         N     @02,@CF01475                                        1454 05837000
         LA    @02,8(,@02)                                         1454 05838000
         STCM  @02,7,CIFRGET                                       1454 05839000
*                     IF ENTYP = CATRCTYP($FRSP)                   1455 05840000
*                       THEN FMUFRSP = ON ;  /* FREESPACE RCD        */ 05841000
*                                                                  1455 05842000
         SLR   @02,@02                                             1455 05843000
         IC    @02,$FRSP                                           1455 05844000
         MH    @02,@CH00042                                        1455 05845000
         LA    @01,CATRCTYP-5(@02)                                 1455 05846000
         CLC   ENTYP(1),0(@01)                                     1455 05847000
         BNE   @RF01455                                            1455 05848000
         OI    FMUFRSP,B'00100000'                                 1456 05849000
*                     CALL GETPRT; /* PRINT ANY OTHER RECORD         */ 05850000
*                                                                  1457 05851000
@RF01455 BAL   @14,GETPRT                                          1457 05852000
*                     FMUFRSP = OFF ;                              1458 05853000
         NI    FMUFRSP,B'11011111'                                 1458 05854000
*                   END ;                                          1459 05855000
*                   /*************************************************/ 05856000
*                   /* NOTE: MAY CAUSE A DUPLICATE PRINT OF          */ 05857000
*                   /* A RECORD IF CATALOG STRUCTURES ARE            */ 05858000
*                   /* NOT IN ASCENDING CIS                          */ 05859000
*                   /*************************************************/ 05860000
*         END ;                                                    1460 05861000
@RC01450 DS    0H                                                  1460 05862000
@RC01448 DS    0H                                                  1461 05863000
*   END ;                                                          1461 05864000
*                                                                  1461 05865000
@RT01441 LA    @15,1                                               1461 05866000
         LH    @02,CTTSLOT                                         1461 05867000
         N     @02,@CF01475                                        1461 05868000
         ALR   @15,@02                                             1461 05869000
@DE01439 STH   @15,CTTSLOT                                         1461 05870000
         L     @02,CTTPTR                                          1461 05871000
         C     @15,CTTENTNO(,@02)                                  1461 05872000
         BNH   @DL01439                                            1461 05873000
*END PRTFIFO ;                                                     1462 05874000
@EL00024 DS    0H                                                  1462 05875000
@EF00024 DS    0H                                                  1462 05876000
@ER00024 LM    @14,@12,@SA00024                                    1462 05877000
         BR    @14                                                 1462 05878000
* /*******************************************************************/ 05879000
* /* PROCEDURE NAME - PRTMCWD, PRINT MISCOMPARE WORDS                */ 05880000
* /* FUNCTION -                                                      */ 05881000
* /*   INITIALIZE 'MISCOMPARE -' MESSAGE TO 'OTHER',                 */ 05882000
* /*   PASS THRU MCARGTBL COMPARING CRA (AND OPTIONALLY              */ 05883000
* /*   CATALOG) FIELDS NAMED IN THIS TABLE,                          */ 05884000
* /*   AT THE FIRST MISCOMPARE OVERLAY ERROR MESSAGE                 */ 05885000
* /*   SEVERITY WORDS USING POINTER FOR GROUP FROM MCMSGTBL,         */ 05886000
* /*   PRINT THE 'MISCOMPARE- XXXXXXXXXXXXX' MESSAGE                 */ 05887000
* /* INPUTS -                                                        */ 05888000
* /*   PARAMETER OF NUMBER OF GROUPS TO COMPARE IN MCARGTBL          */ 05889000
* /*   (IF ZERO PRINT ONLY 'OTHER')                                  */ 05890000
* /*   3 TABLE ADDRESSES - ARGUMENT GROUPS, MSGPTRS, MSGLENS         */ 05891000
* /*   RECORD THAT MESSAGE IS DESIRED FOR -> BY CIFRGET              */ 05892000
* /*   (USE CI OBTAINED THRU CTT TO GET CATALOG RECORD)              */ 05893000
* /*   CRA                                                           */ 05894000
* /*   CATALOG                                                       */ 05895000
* /* OUTPUTS -                                                       */ 05896000
* /*   MSCMPRSW TURNED OFF                                           */ 05897000
* /*   MISCOMPARE - XXXXX  ERROR MESSAGE                             */ 05898000
* /* CALLS -                                                         */ 05899000
* /*   UGET, UPRINT,                                                 */ 05900000
* /*   IDCRC04(SEE MCARGTBL IN DCLS2 SEGMENT, AND REPNO)             */ 05901000
* /*   ERROR                                                 @OZ09388*/ 05902000
* /*******************************************************************/ 05903000
*                                                                  1463 05904000
*PRTMCWD: PROCEDURE (NBR2CMP,ARGTBL,MSGTBL,MSGLNTBL) ;             1463 05905000
PRTMCWD  STM   @14,@12,@SA00025                                    1463 05906000
         MVC   @PC00025(16),0(@01)                                 1463 05907000
* OLDERID2 = NEWERID2;                                             1464 05908000
         L     @15,@PC00001                                        1464 05909000
         L     @14,GDTTR2(,@15)                                    1464 05910000
         MVC   @TS00001(95),NEWERID2(@14)                          1464 05911000
         MVC   OLDERID2(95,@14),@TS00001                           1464 05912000
* NEWID2 = 'LRPM' ;                                                1465 05913000
         MVC   NEWID2(4,@14),@CC01371                              1465 05914000
* IF GDTDBG = NULLPTR                                              1466 05915000
*   THEN;                                                          1466 05916000
         L     @15,GDTDBG(,@15)                                    1466 05917000
         LTR   @15,@15                                             1466 05918000
         BZ    @RT01466                                            1466 05919000
*   ELSE                                                           1468 05920000
*     CALL IDCDB010 (GDTTBL,'LRPM') ;                              1468 05921000
*                                                                  1468 05922000
         L     @15,@PC00001                                        1468 05923000
         ST    @15,@AL00001                                        1468 05924000
         LA    @14,@CC01371                                        1468 05925000
         ST    @14,@AL00001+4                                      1468 05926000
         MVI   @AL00001+4,X'80'                                    1468 05927000
         L     @15,GDTDBG(,@15)                                    1468 05928000
         LA    @01,@AL00001                                        1468 05929000
         BALR  @14,@15                                             1468 05930000
* DCL                                                              1469 05931000
*   GRPS2CMP        FIXED(31),     /* GROUPS TO CMPR NUMBER          */ 05932000
*   NBR2CMP         FIXED(31),                                     1469 05933000
*   1 ARGTBL  (*)   CHAR(10),                                      1469 05934000
*     2 ARGNAME     CHAR(8),       /* SEE MCARGTBL AND ASOC          */ 05935000
*     2 ARGGRP      FIXED(8),      /* TABLE DECLARATIONS             */ 05936000
*     2 ARGCTGRP    FIXED(8),                                      1469 05937000
*   MSGTBL    (*)   PTR(31),                                       1469 05938000
*   MSGLNTBL  (*)   FIXED(8),                                      1469 05939000
* ENDCLSPM CHAR(1) ;                                               1469 05940000
*                                                                  1469 05941000
@RT01466 DS    0H                                                  1470 05942000
* GRPS2CMP = NBR2CMP ;                                             1470 05943000
         L     @02,@PC00025                                        1470 05944000
         L     @02,NBR2CMP(,@02)                                   1470 05945000
         ST    @02,GRPS2CMP                                        1470 05946000
* MCMSG = 'OTHER' ;                /* INITIALLY = 'OTHER'            */ 05947000
         MVI   MCMSG+5,C' '                                        1471 05948000
         MVC   MCMSG+6(42),MCMSG+5                                 1471 05949000
         MVC   MCMSG(5),@CC01377                                   1471 05950000
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;                           1472 05951000
         L     @02,CIFRGET-1                                       1472 05952000
         LA    @02,0(,@02)                                         1472 05953000
         SLA   @02,3                                               1472 05954000
         L     @01,FMPLAD                                          1472 05955000
         L     @15,CTTPTR                                          1472 05956000
         ALR   @15,@02                                             1472 05957000
         AL    @15,@CF01478                                        1472 05958000
         MVC   FMPLBCIN(3,@01),CTTCATCI-5(@15)                     1472 05959000
* ARGSLOT = 1 ;                                                    1473 05960000
*                                                                  1473 05961000
         LA    ARGSLOT,1                                           1473 05962000
* /*******************************************************************/ 05963000
* /* LOOP: COMPARE AS MANY GROUPS OF FIELDS AS REQUESTED             */ 05964000
* /*******************************************************************/ 05965000
*                                                                  1474 05966000
* DO WHILE (GRPS2CMP >= ARGGRP(ARGSLOT)                            1474 05967000
*       & ARGNAME(ARGSLOT) ^= '$$$$$$$$') ;                        1474 05968000
         B     @DE01474                                            1474 05969000
@DL01474 DS    0H                                                  1475 05970000
*   RELREPNO = 0 ;                                                 1475 05971000
         SLR   @02,@02                                             1475 05972000
         STH   @02,RELREPNO                                        1475 05973000
*   CNTREPNO = 1 ;                                                 1476 05974000
         MVC   CNTREPNO(2),@CH00222                                1476 05975000
*   IF ARGCTGRP(ARGSLOT) ^= 0      /* IF REPEATING GROUPS            */ 05976000
*     THEN                         /* FIND OUT HOW MANY OCCUR        */ 05977000
         LR    @15,ARGSLOT                                         1477 05978000
         MH    @15,@CH00037                                        1477 05979000
         L     @14,@PC00025+4                                      1477 05980000
         BCTR  @14,0                                               1477 05981000
         SLR   @01,@01                                             1477 05982000
         IC    @01,ARGCTGRP-9(@15,@14)                             1477 05983000
         CR    @01,@02                                             1477 05984000
         BE    @RF01477                                            1477 05985000
*       DO ;                       /* IN THE CATALOG RECORD          */ 05986000
*         FMFLDNAM = ADDR('REPNO   ') ;                            1479 05987000
         LA    @02,@CC01204                                        1479 05988000
         ST    @02,FMFLDNAM(,FMFLCUR)                              1479 05989000
*         FMFLGRPC = ARGCTGRP(ARGSLOT) ;                           1480 05990000
         STC   @01,FMFLGRPC(,FMFLCUR)                              1480 05991000
*         FMPLFMFL(NBRFMFL) -> FMFLGRPC = ARGCTGRP(ARGSLOT) ;      1481 05992000
         L     @02,FMPLAD                                          1481 05993000
         L     @15,FMPLFMFL+16(,@02)                               1481 05994000
         STC   @01,FMFLGRPC(,@15)                                  1481 05995000
*         FMPLFMFL(NBRFMFL-1) -> FMFLGRPC = ARGCTGRP(ARGSLOT) ;    1482 05996000
         L     @15,FMPLFMFL+12(,@02)                               1482 05997000
         STC   @01,FMFLGRPC(,@15)                                  1482 05998000
*         REG1 = FMPLAD ;                                          1483 05999000
*                                                                  1483 06000000
         LR    REG1,@02                                            1483 06001000
*         CALL IDCRC04 ;           /* GET NBR OF REPETITIONS         */ 06002000
*                                                                  1484 06003000
         L     @15,@CV00793                                        1484 06004000
         BALR  @14,@15                                             1484 06005000
*         IF FMFLENTH ^= 0                                         1485 06006000
*           THEN                                                   1485 06007000
         L     @02,FMFLENTH(,FMFLCUR)                              1485 06008000
         LTR   @02,@02                                             1485 06009000
         BZ    @RF01485                                            1485 06010000
*             DO ;                                                 1486 06011000
*               NBRMCFMC = REPNO ;                                 1487 06012000
         L     @02,FMFLADDR(,FMFLCUR)                              1487 06013000
         LH    @02,REPNO(,@02)                                     1487 06014000
         STH   @02,NBRMCFMC                                        1487 06015000
*               FMFLTCHN = ADDR(FMFLST(NBRFMFL)) ; /*1ATATIME        */ 06016000
         LA    @02,FMFLST+96                                       1488 06017000
         ST    @02,FMFLTCHN(,FMFLCUR)                              1488 06018000
*             END ;                                                1489 06019000
*           ELSE NBRMCFMC = 1 ;    /* TRY ONE CALL ANYWAY            */ 06020000
         B     @RC01485                                            1490 06021000
@RF01485 MVC   NBRMCFMC(2),@CH00222                                1490 06022000
*       END ;                                                      1491 06023000
*     ELSE NBRMCFMC = 1 ;          /* CALL FIELD MGMT ONCE           */ 06024000
         B     @RC01477                                            1492 06025000
@RF01477 MVC   NBRMCFMC(2),@CH00222                                1492 06026000
*   FMFLDNAM = ADDR(ARGNAME(ARGSLOT)) ;                            1493 06027000
*                                                                  1493 06028000
@RC01477 LR    @02,ARGSLOT                                         1493 06029000
         MH    @02,@CH00037                                        1493 06030000
         L     @15,@PC00025+4                                      1493 06031000
         AL    @15,@CF01493                                        1493 06032000
         LA    @02,ARGNAME(@02,@15)                                1493 06033000
         ST    @02,FMFLDNAM(,FMFLCUR)                              1493 06034000
*   /*****************************************************************/ 06035000
*   /* LOOP: COMPARE ALL THE FIELDS IN THIS GROUP                    */ 06036000
*   /*****************************************************************/ 06037000
*                                                                  1494 06038000
*   DO WHILE (RELREPNO < NBRMCFMC) ;                               1494 06039000
         B     @DE01494                                            1494 06040000
@DL01494 DS    0H                                                  1495 06041000
*     FMPLOAR = ADDR(MCWA) ;       /* CRA FIELD COMPARE AREA         */ 06042000
         L     @02,FMPLAD                                          1495 06043000
         LA    @15,MCWA                                            1495 06044000
         ST    @15,FMPLOAR(,@02)                                   1495 06045000
*     REG1 = FMPLAD ;                                              1496 06046000
*                                                                  1496 06047000
         LR    REG1,@02                                            1496 06048000
*     CALL IDCRC04 ;               /* ASK FOR FIELD FROM CRA         */ 06049000
*                                                                  1497 06050000
         L     @15,@CV00793                                        1497 06051000
         BALR  @14,@15                                             1497 06052000
*     FMPLOAR = ADDR(FMWA) ;       /* NORMAL FM BUFFER (CAT)         */ 06053000
         L     @02,FMPLAD                                          1498 06054000
         LA    @15,FMWA                                            1498 06055000
         ST    @15,FMPLOAR(,@02)                                   1498 06056000
*     IF FMPLRTCD = 0                                              1499 06057000
*       THEN                                                       1499 06058000
         CLI   FMPLRTCD(@02),0                                     1499 06059000
         BNE   @RF01499                                            1499 06060000
*         DO ;                     /* SAVE RETURNS FROM CRA          */ 06061000
*           CRAFLDLN = FMFLENTH(1) ;                               1501 06062000
         L     @15,FMFLENTH(,FMFLCUR)                              1501 06063000
         ST    @15,CRAFLDLN                                        1501 06064000
*           CRAFMRTC = FMPLRTCD ;                                  1502 06065000
         IC    @15,FMPLRTCD(,@02)                                  1502 06066000
         STC   @15,CRAFMRTC                                        1502 06067000
*           FMUBFPTR = IOCTBPTR ;                                  1503 06068000
         L     @15,IOCTBPTR                                        1503 06069000
         ST    @15,FMUBFPTR                                        1503 06070000
*           FMUIOCSI = IOCSCAT ;                                   1504 06071000
         L     @15,IOCSCAT                                         1504 06072000
         ST    @15,FMUIOCSI                                        1504 06073000
*           FMUCATIO = ON ;                                        1505 06074000
         OI    FMUCATIO,B'01000000'                                1505 06075000
*           REG1 = FMPLAD ;                                        1506 06076000
*                                                                  1506 06077000
         LR    REG1,@02                                            1506 06078000
*           CALL IDCRC04 ;         /* ASK FOR FIELDS FROM CAT        */ 06079000
*                                                                  1507 06080000
         L     @15,@CV00793                                        1507 06081000
         BALR  @14,@15                                             1507 06082000
*           FMUBFPTR = IOCRBPTR ;                                  1508 06083000
         L     @02,IOCRBPTR                                        1508 06084000
         ST    @02,FMUBFPTR                                        1508 06085000
*           FMUIOCSI = IOCSCRA ;                                   1509 06086000
         L     @02,IOCSCRA                                         1509 06087000
         ST    @02,FMUIOCSI                                        1509 06088000
*           FMUCATIO = OFF ;                                       1510 06089000
         NI    FMUCATIO,B'10111111'                                1510 06090000
*           CATFLDLN = FMFLENTH(1) ;                               1511 06091000
         L     @02,FMFLENTH(,FMFLCUR)                              1511 06092000
         ST    @02,CATFLDLN                                        1511 06093000
*           IF    FMPLRTCD ^= CRAFMRTC     /* IF ANY MISCMPR         */ 06094000
*              | CATFLDLN ^= CRAFLDLN                              1512 06095000
*              | MCWKAR(1:CRAFLDLN) ^= FMWKAR(1:CRAFLDLN)          1512 06096000
*             THEN                                                 1512 06097000
         L     @01,FMPLAD                                          1512 06098000
         CLC   FMPLRTCD(1,@01),CRAFMRTC                            1512 06099000
         BNE   @RT01512                                            1512 06100000
         L     @15,CRAFLDLN                                        1512 06101000
         CR    @02,@15                                             1512 06102000
         BNE   @RT01512                                            1512 06103000
         BCTR  @15,0                                               1512 06104000
         EX    @15,@SC01494                                        1512 06105000
         BE    @RF01512                                            1512 06106000
@RT01512 DS    0H                                                  1513 06107000
*               DO ;               /* STO SEVERITY WORDS AND         */ 06108000
*                 MCMSG = MSGTBL(ARGGRP(ARGSLOT)) ->               1514 06109000
*                       CHARBASD(1:MSGLNTBL(ARGGRP(ARGSLOT))) ;    1514 06110000
         MVI   MCMSG+1,C' '                                        1514 06111000
         MVC   MCMSG+2(46),MCMSG+1                                 1514 06112000
         LR    @02,ARGSLOT                                         1514 06113000
         MH    @02,@CH00037                                        1514 06114000
         L     @15,@PC00025+4                                      1514 06115000
         BCTR  @15,0                                               1514 06116000
         BCTR  @15,0                                               1514 06117000
         SLR   @14,@14                                             1514 06118000
         IC    @14,ARGGRP-8(@02,@15)                               1514 06119000
         L     @02,@PC00025+12                                     1514 06120000
         BCTR  @02,0                                               1514 06121000
         SLR   @15,@15                                             1514 06122000
         IC    @15,MSGLNTBL(@14,@02)                               1514 06123000
         BCTR  @15,0                                               1514 06124000
         SLA   @14,2                                               1514 06125000
         L     @02,@PC00025+8                                      1514 06126000
         AL    @02,@CF01476                                        1514 06127000
         L     @02,MSGTBL(@14,@02)                                 1514 06128000
         EX    @15,@SM01496                                        1514 06129000
*                 RELREPNO = NBRMCFMC ; /* GET OUT OF LOOPS          */ 06130000
         LH    @02,NBRMCFMC                                        1515 06131000
         STH   @02,RELREPNO                                        1515 06132000
*                 GRPS2CMP = 0 ;                                   1516 06133000
         SLR   @02,@02                                             1516 06134000
         ST    @02,GRPS2CMP                                        1516 06135000
*               END ;                                              1517 06136000
*            RELREPNO = RELREPNO + 1 ;                             1518 06137000
@RF01512 LA    @02,1                                               1518 06138000
         LH    @15,RELREPNO                                        1518 06139000
         ALR   @15,@02                                             1518 06140000
         STH   @15,RELREPNO                                        1518 06141000
*            CNTREPNO = CNTREPNO + 1 ;                             1519 06142000
         AH    @02,CNTREPNO                                        1519 06143000
         STH   @02,CNTREPNO                                        1519 06144000
*         END ;                                                    1520 06145000
*       ELSE                                                       1521 06146000
*         DO ;                     /* FIELD MGMT ERR RETURN          */ 06147000
         B     @RC01499                                            1521 06148000
@RF01499 DS    0H                                                  1522 06149000
*           MCMSG = ' ';           /* NO FIELD TO PRINT      @OZ09388*/ 06150000
         MVI   MCMSG+1,C' '                                        1522 06151000
         MVC   MCMSG+2(46),MCMSG+1                                 1522 06152000
         MVI   MCMSG,C' '                                          1522 06153000
*           FLDMGTER=ON;           /* SET FLD MGT ERR IND ON @OZ09388*/ 06154000
         OI    FLDMGTER,B'01000000'                                1523 06155000
*           RELREPNO = NBRMCFMC ;  /* GET OUT OF LOOPS               */ 06156000
         LH    @02,NBRMCFMC                                        1524 06157000
         STH   @02,RELREPNO                                        1524 06158000
*           GRPS2CMP = 0 ;                                         1525 06159000
         SLR   @02,@02                                             1525 06160000
         ST    @02,GRPS2CMP                                        1525 06161000
*         END ;                                                    1526 06162000
*   END ;                                                          1527 06163000
@RC01499 DS    0H                                                  1527 06164000
@DE01494 LH    @02,RELREPNO                                        1527 06165000
         CH    @02,NBRMCFMC                                        1527 06166000
         BL    @DL01494                                            1527 06167000
*   ARGSLOT = ARGSLOT + 1 ;                                        1528 06168000
         LA    @02,1                                               1528 06169000
         ALR   ARGSLOT,@02                                         1528 06170000
*   FMFLTCHN = '0'B ;              /* RESTORE ASSUMED VALUES         */ 06171000
         SLR   @15,@15                                             1529 06172000
         ST    @15,FMFLTCHN(,FMFLCUR)                              1529 06173000
*   RELREPNO = 0 ;                                                 1530 06174000
         SLR   @15,@15                                             1530 06175000
         STH   @15,RELREPNO                                        1530 06176000
*   CNTREPNO = 1 ;                                                 1531 06177000
         STH   @02,CNTREPNO                                        1531 06178000
*   FMFLGRPC = '0'B ;                                              1532 06179000
         MVI   FMFLGRPC(FMFLCUR),B'00000000'                       1532 06180000
* END ;                                                            1533 06181000
@DE01474 LR    @02,ARGSLOT                                         1533 06182000
         MH    @02,@CH00037                                        1533 06183000
         L     @15,@PC00025+4                                      1533 06184000
         L     @14,GRPS2CMP                                        1533 06185000
         LA    @01,0(@02,@15)                                      1533 06186000
         BCTR  @01,0                                               1533 06187000
         BCTR  @01,0                                               1533 06188000
         SLR   @00,@00                                             1533 06189000
         IC    @00,ARGGRP-8(,@01)                                  1533 06190000
         CR    @14,@00                                             1533 06191000
         BL    @DC01474                                            1533 06192000
         ALR   @15,@02                                             1533 06193000
         AL    @15,@CF01493                                        1533 06194000
         CLC   ARGNAME(8,@15),@CC00816                             1533 06195000
         BNE   @DL01474                                            1533 06196000
@DC01474 DS    0H                                                  1534 06197000
* DARGLIST = '0'B ;                /* SET UP TO PRINT IT             */ 06198000
         L     @15,DDSTRU                                          1534 06199000
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  1534 06200000
         MVI   DARGLIST(@15),B'00000000'                           1534 06201000
* DARGSMOD = 'LR0' ;                                               1535 06202000
         MVC   DARGSMOD(3,@15),@CC01335                            1535 06203000
* DARGSENT = 7 ;                                                   1536 06204000
         MVI   DARGSENT(@15),X'07'                                 1536 06205000
* DARGCNT = 1 ;                                                    1537 06206000
         LA    @14,1                                               1537 06207000
         STH   @14,DARGCNT(,@15)                                   1537 06208000
* DARGINS(1) = 1 ;                                                 1538 06209000
         STH   @14,DARGINS(,@15)                                   1538 06210000
* DARGINL(1) = LENGTH(MCMSG) ;                                     1539 06211000
         MVC   DARGINL(2,@15),@CH00639                             1539 06212000
* DARGDTM(1) = ADDR(MCMSG) ;                                       1540 06213000
*                                                                  1540 06214000
         LA    @14,MCMSG                                           1540 06215000
         ST    @14,DARGDTM(,@15)                                   1540 06216000
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1541 06217000
         L     @15,@PC00001                                        1541 06218000
         ST    @15,@AL00001                                        1541 06219000
         LA    @14,IOCSPRT                                         1541 06220000
         ST    @14,@AL00001+4                                      1541 06221000
         LA    @14,DDSTRU                                          1541 06222000
         ST    @14,@AL00001+8                                      1541 06223000
         MVI   @AL00001+8,X'80'                                    1541 06224000
         L     @15,GDTPRT(,@15)                                    1541 06225000
         LA    @01,@AL00001                                        1541 06226000
         BALR  @14,@15                                             1541 06227000
* IF FLDMGTER=ON             /* WAS THERE A FLD MGT ERR ?    @OZ09388*/ 06228000
*   THEN                                                   /*@OZ09388*/ 06229000
         TM    FLDMGTER,B'01000000'                                1542 06230000
         BNO   @RF01542                                            1542 06231000
*     DO;                                                  /*@OZ09388*/ 06232000
*       CALL ERROR (30,$RETURN); /* SEND FLD MGT ERR MSG     @OZ09388*/ 06233000
         LA    @01,@AL01544                                        1544 06234000
         BAL   @14,ERROR                                           1544 06235000
*       FLDMGTER=OFF;            /* SET FLD MGT ERR IND OFF  @OZ09388*/ 06236000
         NI    FLDMGTER,B'10111111'                                1545 06237000
*     END;                                                 /*@OZ09388*/ 06238000
*ELSE;                    /* NO ERROR - NORMAL EXIT          @OZ09388*/ 06239000
*                                                                  1547 06240000
@RF01542 DS    0H                                                  1548 06241000
* MSCMPRSW = OFF ;                                                 1548 06242000
*                                                                  1548 06243000
         NI    MSCMPRSW,B'11110111'                                1548 06244000
*END PRTMCWD ;                                                     1549 06245000
@EL00025 DS    0H                                                  1549 06246000
@EF00025 DS    0H                                                  1549 06247000
@ER00025 LM    @14,@12,@SA00025                                    1549 06248000
         BR    @14                                                 1549 06249000
* /*******************************************************************/ 06250000
* /* PROCEDURE NAME - PRTOJAL, PRINT OBJECT,S ALIASES                */ 06251000
* /* FUNCTION -                                                      */ 06252000
* /*   LOOP UNTIL NO MORE ALIAS RECORD ASSOCIATIONS,                 */ 06253000
* /*     CALL INTASOC TO BUILD ASSOCTB2 OF ALL ASSOCIATIONS,         */ 06254000
* /*     IF AN ALIAS ASSOC EXISTS GET AND PRINT ITS RECORD,          */ 06255000
* /*     IF PRINT PASS AND MISCOMPARE OCCURED IN IT SO NOTE,         */ 06256000
* /*     ALSO COUNT IT FOR THE ENTRIES PROCESSED SUMMARY             */ 06257000
* /* INPUTS -                                                        */ 06258000
* /*   BASE RECORD IDENTIFIED BY CIFRGET                             */ 06259000
* /* OUTPUTS -                                                       */ 06260000
* /*   ALIAS RECORDS PRINTED AS SPECIFIED                            */ 06261000
* /* CALLS -                                                         */ 06262000
* /*   INTASOC, GETPRT, PRTMCWD, SUMIT                               */ 06263000
* /* NOTES -                                                         */ 06264000
* /*   CATALOG MANAGEMENT HANDLES ALIAS RECORD ASSOCIATIONS          */ 06265000
* /*   DIFFERENT THAN ALL OTHER ASSOCIATIONS, I.E. THE NONVSAM       */ 06266000
* /*   ENTRY POINTS TO THE FIRST ONE ONLY (IF ANY AT ALL)            */ 06267000
* /*   AND THEREAFTER THE RECORDS ARE CHAINED TOGETHER.              */ 06268000
* /*   THERE ARE TWO ALIAS ASSOCIATIONS IN EACH ALIAS ENTRY,         */ 06269000
* /*   THIS PROGRAM USES THE FIRST ALIAS ASSOCIATION WHICH           */ 06270000
* /*   IS THE FORWARD CHAIN.  THE SECOND ALIAS ASSOCIATION           */ 06271000
* /*   (THE BACKWARDS CHAIN) IS NOT USED BY THIS PROGRAM.            */ 06272000
* /*******************************************************************/ 06273000
*                                                                  1550 06274000
*PRTOJAL: PROCEDURE ;                                              1550 06275000
PRTOJAL  STM   @14,@12,@SA00026                                    1550 06276000
*   OLDERID2 = NEWERID2;                                           1551 06277000
         L     @15,@PC00001                                        1551 06278000
         L     @14,GDTTR2(,@15)                                    1551 06279000
         MVC   @TS00001(95),NEWERID2(@14)                          1551 06280000
         MVC   OLDERID2(95,@14),@TS00001                           1551 06281000
*   NEWID2 = 'LRPJ' ;                                              1552 06282000
         MVC   NEWID2(4,@14),@CC01382                              1552 06283000
*   IF GDTDBG = NULLPTR                                            1553 06284000
*     THEN;                                                        1553 06285000
         L     @15,GDTDBG(,@15)                                    1553 06286000
         LTR   @15,@15                                             1553 06287000
         BZ    @RT01553                                            1553 06288000
*     ELSE                                                         1555 06289000
*       CALL IDCDB010 (GDTTBL,'LRPJ') ;                            1555 06290000
*                                                                  1555 06291000
         L     @15,@PC00001                                        1555 06292000
         ST    @15,@AL00001                                        1555 06293000
         LA    @14,@CC01382                                        1555 06294000
         ST    @14,@AL00001+4                                      1555 06295000
         MVI   @AL00001+4,X'80'                                    1555 06296000
         L     @15,GDTDBG(,@15)                                    1555 06297000
         LA    @01,@AL00001                                        1555 06298000
         BALR  @14,@15                                             1555 06299000
*   INDNTCOL = INDNTCOL + 2 ;                                      1556 06300000
@RT01553 IC    @01,INDNTCOL                                        1556 06301000
         LA    @01,2(,@01)                                         1556 06302000
         STC   @01,INDNTCOL                                        1556 06303000
*   ATRA2PTR = A2PTR ;             /* SET TO BUILD ASSOCTB2          */ 06304000
         L     @15,A2PTR                                           1557 06305000
         ST    @15,ATRA2PTR                                        1557 06306000
*   CISAVED = CIFRGET ;                                            1558 06307000
*                                                                  1558 06308000
         MVC   CISAVED(3),CIFRGET                                  1558 06309000
*   /*****************************************************************/ 06310000
*   /* LOOP: GET AND PRINT ALL ALIAS RECORDS                         */ 06311000
*   /*****************************************************************/ 06312000
*                                                                  1559 06313000
*   DO WHILE (NOALIASW = OFF                                       1559 06314000
*         & ^(CMPRPASW = ON        /* GETOUT IF COMPARE PASS         */ 06315000
*             & MSCMPRSW = ON)) ;     /* AND MISCOMPARE ALREADY      */ 06316000
*                                                                  1559 06317000
         B     @DE01559                                            1559 06318000
@DL01559 DS    0H                                                  1560 06319000
*     CALL INTASOC(1) ;            /* BUILD TABLE OF ALL ASOCS       */ 06320000
*                                                                  1560 06321000
         LA    @01,@AL01560                                        1560 06322000
         BAL   @14,INTASOC                                         1560 06323000
*     DO A2SLOT = 1 TO NBRATS      /* SEARCH TABLE FOR ALIAS         */ 06324000
*       WHILE (A2ENTYP(A2SLOT) ^= CATRCTYP($ALIA)                  1561 06325000
*          & A2CRACI(A2SLOT) ^= '0'B) ;    /* OR END OF TABLE        */ 06326000
         LA    A2SLOT,1                                            1561 06327000
@DL01561 L     @02,ATRA2PTR                                        1561 06328000
         LR    @15,A2SLOT                                          1561 06329000
         SLA   @15,2                                               1561 06330000
         SLR   @14,@14                                             1561 06331000
         IC    @14,$ALIA                                           1561 06332000
         MH    @14,@CH00042                                        1561 06333000
         ST    @15,@TF00001                                        1561 06334000
         ALR   @15,@02                                             1561 06335000
         LA    @01,CATRCTYP-5(@14)                                 1561 06336000
         CLC   A2ENTYP-4(1,@15),0(@01)                             1561 06337000
         BE    @DC01561                                            1561 06338000
         L     @01,@TF00001                                        1561 06339000
         L     @02,A2CRACI-5(@01,@02)                              1561 06340000
         LA    @02,0(,@02)                                         1561 06341000
         LTR   @02,@02                                             1561 06342000
         BZ    @DC01561                                            1561 06343000
*     END ;                                                        1562 06344000
         AL    A2SLOT,@CF00222                                     1562 06345000
         C     A2SLOT,@CF00038                                     1562 06346000
         BNH   @DL01561                                            1562 06347000
@DC01561 DS    0H                                                  1563 06348000
*     IF      A2ENTYP(A2SLOT) = CATRCTYP($ALIA)                    1563 06349000
*         & A2CRACI(A2SLOT) ^= '0'B     /* OR END OF ALIASES         */ 06350000
*       THEN                                                       1563 06351000
         L     @02,ATRA2PTR                                        1563 06352000
         LR    @15,A2SLOT                                          1563 06353000
         SLA   @15,2                                               1563 06354000
         SLR   @14,@14                                             1563 06355000
         IC    @14,$ALIA                                           1563 06356000
         MH    @14,@CH00042                                        1563 06357000
         ST    @15,@TF00001                                        1563 06358000
         ALR   @15,@02                                             1563 06359000
         LA    @01,CATRCTYP-5(@14)                                 1563 06360000
         CLC   A2ENTYP-4(1,@15),0(@01)                             1563 06361000
         BNE   @RF01563                                            1563 06362000
         L     @01,@TF00001                                        1563 06363000
         L     @15,A2CRACI-5(@01,@02)                              1563 06364000
         LA    @15,0(,@15)                                         1563 06365000
         LTR   @15,@15                                             1563 06366000
         BZ    @RF01563                                            1563 06367000
*         DO ;                                                     1564 06368000
*           CIFRGET = A2CRACI(A2SLOT) ;                            1565 06369000
*                                                                  1565 06370000
         AL    @02,@TF00001                                        1565 06371000
         MVC   CIFRGET(3),A2CRACI-4(@02)                           1565 06372000
*           CALL GETPRT ;          /* GET (PRINT) ALIAS RCD          */ 06373000
*                                                                  1566 06374000
         BAL   @14,GETPRT                                          1566 06375000
*           IF     PRNTPASW = ON                                   1567 06376000
*              & CMPRSW = ON                                       1567 06377000
*              & CTTMCSW(CIFRGET - CTTBASE) = ON                   1567 06378000
*             THEN                                                 1567 06379000
*                                                                  1567 06380000
         TM    PRNTPASW,B'10000000'                                1567 06381000
         BNO   @RF01567                                            1567 06382000
         TM    CMPRSW,B'01000000'                                  1567 06383000
         BNO   @RF01567                                            1567 06384000
         L     @02,CIFRGET-1                                       1567 06385000
         LA    @02,0(,@02)                                         1567 06386000
         SLA   @02,3                                               1567 06387000
         L     @01,CTTPTR                                          1567 06388000
         ALR   @01,@02                                             1567 06389000
         AL    @01,@CF01491                                        1567 06390000
         TM    CTTMCSW-8(@01),B'01000000'                          1567 06391000
         BNO   @RF01567                                            1567 06392000
*               CALL PRTMCWD(0,    /* NO GROUPS, ONLY 'OTHER'        */ 06393000
*                    MCARGTBL,MCMSGTBL,MCMLNTBL) ;                 1568 06394000
*                                                                  1568 06395000
         LA    @01,@AL01568                                        1568 06396000
         BAL   @14,PRTMCWD                                         1568 06397000
*           ENTNOCUR = ENTNOCUR + 1 ;    /* AVOID COUNTING TWICE     */ 06398000
@RF01567 LH    @02,ENTNOCUR                                        1569 06399000
         LA    @02,1(,@02)                                         1569 06400000
         STH   @02,ENTNOCUR                                        1569 06401000
*           IF   (PRNTPASW = ON & CMPRSW = OFF)                    1570 06402000
*              | ENTNOCUR > ENTNOSAV                               1570 06403000
*                                                                  1570 06404000
*             THEN CALL SUMIT(SMACCUM,ATENTYP(A2SLOT)) ;           1570 06405000
*                                                                  1570 06406000
         TM    PRNTPASW,B'10000000'                                1570 06407000
         BNO   @GL00063                                            1570 06408000
         TM    CMPRSW,B'01000000'                                  1570 06409000
         BZ    @RT01570                                            1570 06410000
@GL00063 LH    @02,ENTNOCUR                                        1570 06411000
         CH    @02,ENTNOSAV                                        1570 06412000
         BNH   @RF01570                                            1570 06413000
@RT01570 DS    0H                                                  1571 06414000
         LA    @02,SMACCUM                                         1571 06415000
         ST    @02,@AL00001                                        1571 06416000
         LR    @02,A2SLOT                                          1571 06417000
         SLA   @02,2                                               1571 06418000
         L     @01,ATRA2PTR                                        1571 06419000
         LA    @02,ATENTYP-4(@02,@01)                              1571 06420000
         ST    @02,@AL00001+4                                      1571 06421000
         LA    @01,@AL00001                                        1571 06422000
         BAL   @14,SUMIT                                           1571 06423000
*         END ;                                                    1572 06424000
*       ELSE                                                       1573 06425000
*         NOALIASW = ON ;          /* NO OR LAST ALIAS SO QUIT       */ 06426000
         B     @RC01563                                            1573 06427000
@RF01563 OI    NOALIASW,B'00000100'                                1573 06428000
*   END ;                                                          1574 06429000
@RC01563 DS    0H                                                  1574 06430000
@DE01559 TM    NOALIASW,B'00000100'                                1574 06431000
         BNZ   @DC01559                                            1574 06432000
         TM    CMPRPASW,B'10000000'                                1574 06433000
         BNO   @DL01559                                            1574 06434000
         TM    MSCMPRSW,B'00001000'                                1574 06435000
         BNO   @DL01559                                            1574 06436000
@DC01559 DS    0H                                                  1575 06437000
*   NOALIASW = OFF ;                                               1575 06438000
         NI    NOALIASW,B'11111011'                                1575 06439000
*   CIFRGET = CISAVED ;                                            1576 06440000
         MVC   CIFRGET(3),CISAVED                                  1576 06441000
*   ATRA2PTR = ATPTR ;             /* RESTORE TO ASUMED STATE        */ 06442000
         L     @04,ATPTR                                           1577 06443000
         ST    @04,ATRA2PTR                                        1577 06444000
*   INDNTCOL = INDNTCOL - 2 ;                                      1578 06445000
*                                                                  1578 06446000
         SLR   @04,@04                                             1578 06447000
         IC    @04,INDNTCOL                                        1578 06448000
         BCTR  @04,0                                               1578 06449000
         BCTR  @04,0                                               1578 06450000
         STC   @04,INDNTCOL                                        1578 06451000
*END PRTOJAL ;                                                     1579 06452000
@EL00026 DS    0H                                                  1579 06453000
@EF00026 DS    0H                                                  1579 06454000
@ER00026 LM    @14,@12,@SA00026                                    1579 06455000
         BR    @14                                                 1579 06456000
* /*******************************************************************/ 06457000
* /* PROCEDURE NAME - PRTOJVL, PRINT OBJECTS VOLUMES                 */ 06458000
* /* FUNCTION -                                                      */ 06459000
* /*   CALL CKEYRNG TO CHECK FOR EXISTANCE OF VSAM DATA              */ 06460000
* /*   OBJECT,S HAVING KEYRANGES AND SETUP TO GET THEM,              */ 06461000
* /*   SET UP AND PRINT VOLUME HEADING LINE ,                        */ 06462000
* /*   PRINT ALL THE OBJECT,S VOLUME SERIAL NUMBERS AND THE          */ 06463000
* /*   HIGH KEYS IF THERE ARE KEYRANGES                              */ 06464000
* /* INPUTS -                                                        */ 06465000
* /*   CIFRGET (IDENTIFIES THE OBJECT RECORD)                        */ 06466000
* /* OUTPUTS -                                                       */ 06467000
* /*   LIST OF VOLUMES ASSOCIATED WITH THE OBJECT                    */ 06468000
* /* CALLS -                                                         */ 06469000
* /*   CKEYRNG, UPRINT, ERROR                                        */ 06470000
* /*   IDCRC04(VOLSER, HIKEYV)                                       */ 06471000
* /*******************************************************************/ 06472000
*                                                                  1580 06473000
*PRTOJVL: PROCEDURE ;                                              1580 06474000
PRTOJVL  STM   @14,@12,@SA00027                                    1580 06475000
* OLDERID2 = NEWERID2;                                             1581 06476000
         L     @15,@PC00001                                        1581 06477000
         L     @14,GDTTR2(,@15)                                    1581 06478000
         MVC   @TS00001(95),NEWERID2(@14)                          1581 06479000
         MVC   OLDERID2(95,@14),@TS00001                           1581 06480000
* NEWID2 = 'LRPK' ;                                                1582 06481000
         MVC   NEWID2(4,@14),@CC01386                              1582 06482000
* IF GDTDBG = NULLPTR                                              1583 06483000
*   THEN;                                                          1583 06484000
         L     @15,GDTDBG(,@15)                                    1583 06485000
         LTR   @15,@15                                             1583 06486000
         BZ    @RT01583                                            1583 06487000
*   ELSE                                                           1585 06488000
*     CALL IDCDB010 (GDTTBL,'LRPK') ;                              1585 06489000
*                                                                  1585 06490000
         L     @15,@PC00001                                        1585 06491000
         ST    @15,@AL00001                                        1585 06492000
         LA    @14,@CC01386                                        1585 06493000
         ST    @14,@AL00001+4                                      1585 06494000
         MVI   @AL00001+4,X'80'                                    1585 06495000
         L     @15,GDTDBG(,@15)                                    1585 06496000
         LA    @01,@AL00001                                        1585 06497000
         BALR  @14,@15                                             1585 06498000
* INDNTCOL = INDNTCOL + 2 ;                                        1586 06499000
@RT01583 LA    @15,2                                               1586 06500000
         SLR   @14,@14                                             1586 06501000
         IC    @14,INDNTCOL                                        1586 06502000
         ALR   @14,@15                                             1586 06503000
         STC   @14,INDNTCOL                                        1586 06504000
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;                           1587 06505000
         L     @03,CTTPTR                                          1587 06506000
         L     @02,CIFRGET-1                                       1587 06507000
         LA    @02,0(,@02)                                         1587 06508000
         SLA   @02,3                                               1587 06509000
         L     @01,FMPLAD                                          1587 06510000
         ST    @02,@TF00001                                        1587 06511000
         ALR   @02,@03                                             1587 06512000
         AL    @02,@CF01478                                        1587 06513000
         MVC   FMPLBCIN(3,@01),CTTCATCI-5(@02)                     1587 06514000
* FMFLTCHN = ADDR(FMFLST(NBRFMFL));/* GET FIELDS ONE AT TIME         */ 06515000
         LA    @02,FMFLST+96                                       1588 06516000
         ST    @02,FMFLTCHN(,FMFLCUR)                              1588 06517000
* DARGLIST = '0'B ;                /* SET UP COMMON PRINT            */ 06518000
         L     @02,DDSTRU                                          1589 06519000
         XC    DARGLIST+1(19,@02),DARGLIST+1(@02)                  1589 06520000
         MVI   DARGLIST(@02),B'00000000'                           1589 06521000
* DARGSMOD = 'LR0' ;               /* STUFF FOR HEADER AND           */ 06522000
         MVC   DARGSMOD(3,@02),@CC01335                            1590 06523000
* DARGIND = INDNTCOL ;             /* VOLUME SERIAL PRINTING         */ 06524000
         STC   @14,DARGIND(,@02)                                   1591 06525000
* DARGINS(1) = 1 ;                                                 1592 06526000
         MVC   DARGINS(2,@02),@CH00222                             1592 06527000
* DARGINS(2) = 2 ;                                                 1593 06528000
         STH   @15,DARGINS+8(,@02)                                 1593 06529000
* DARGINS(3) = 3 ;                                                 1594 06530000
         LA    @15,3                                               1594 06531000
         STH   @15,DARGINS+16(,@02)                                1594 06532000
* VOLHD2 = ' - ' ;                                                 1595 06533000
         MVC   VOLHD2(3),@CC01387                                  1595 06534000
* DARGINL(2) = LENGTH(VOLHD2) ;                                    1596 06535000
         STH   @15,DARGINL+8(,@02)                                 1596 06536000
* DARGDTM(2) = ADDR(VOLHD2) ;                                      1597 06537000
         LA    @15,VOLHD2                                          1597 06538000
         ST    @15,DARGDTM+8(,@02)                                 1597 06539000
* IF CTTENTYP(CIFRGET-CTTBASE) = CATRCTYP($INDX)                   1598 06540000
*   THEN VOLHD1 = 'INDX' ;                                         1598 06541000
         SLR   @02,@02                                             1598 06542000
         IC    @02,$INDX                                           1598 06543000
         MH    @02,@CH00042                                        1598 06544000
         AL    @03,@TF00001                                        1598 06545000
         AL    @03,@CF01469                                        1598 06546000
         LA    @01,CATRCTYP-5(@02)                                 1598 06547000
         CLC   CTTENTYP-4(1,@03),0(@01)                            1598 06548000
         BNE   @RF01598                                            1598 06549000
         MVC   VOLHD1(4),@CC00728                                  1599 06550000
*   ELSE                                                           1600 06551000
*     IF CTTENTYP(CIFRGET-CTTBASE) = CATRCTYP($UCAT)               1600 06552000
*       THEN VOLHD1 = 'UCAT' ;                                     1600 06553000
         B     @RC01598                                            1600 06554000
@RF01598 L     @15,CIFRGET-1                                       1600 06555000
         LA    @15,0(,@15)                                         1600 06556000
         SLA   @15,3                                               1600 06557000
         SLR   @14,@14                                             1600 06558000
         IC    @14,$UCAT                                           1600 06559000
         MH    @14,@CH00042                                        1600 06560000
         L     @01,CTTPTR                                          1600 06561000
         ALR   @01,@15                                             1600 06562000
         AL    @01,@CF01469                                        1600 06563000
         LA    @15,CATRCTYP-5(@14)                                 1600 06564000
         CLC   CTTENTYP-4(1,@01),0(@15)                            1600 06565000
         BNE   @RF01600                                            1600 06566000
         MVC   VOLHD1(4),@CC00731                                  1601 06567000
*       ELSE VOLHD1 = 'DATA' ;                                     1602 06568000
         B     @RC01600                                            1602 06569000
@RF01600 MVC   VOLHD1(4),@CC00723                                  1602 06570000
*                                  /* GO SEE IF IS KEYRANGE          */ 06571000
* CALL CKEYRNG ;                   /* KEYRNGSW SET ON IF IS          */ 06572000
@RC01600 DS    0H                                                  1603 06573000
@RC01598 BAL   @14,CKEYRNG                                         1603 06574000
*                                  /* AND DARGXXX(3) ADDED           */ 06575000
* DARGINL(1) = LENGTH(VOLHD1) ;                                    1604 06576000
         L     @02,DDSTRU                                          1604 06577000
         MVC   DARGINL(2,@02),@CH00047                             1604 06578000
* DARGDTM(1) = ADDR(VOLHD1) ;                                      1605 06579000
         LA    @15,VOLHD1                                          1605 06580000
         ST    @15,DARGDTM(,@02)                                   1605 06581000
* DARGSENT = 2 ;                                                   1606 06582000
*                                                                  1606 06583000
         MVI   DARGSENT(@02),X'02'                                 1606 06584000
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;/*                        1607 06585000
*                                     PRINT THE HEADER               */ 06586000
*                                                                  1607 06587000
         L     @02,@PC00001                                        1607 06588000
         ST    @02,@AL00001                                        1607 06589000
         LA    @15,IOCSPRT                                         1607 06590000
         ST    @15,@AL00001+4                                      1607 06591000
         LA    @15,DDSTRU                                          1607 06592000
         ST    @15,@AL00001+8                                      1607 06593000
         MVI   @AL00001+8,X'80'                                    1607 06594000
         L     @15,GDTPRT(,@02)                                    1607 06595000
         LA    @01,@AL00001                                        1607 06596000
         BALR  @14,@15                                             1607 06597000
* DARGSENT = 3 ;                                                   1608 06598000
         L     @02,DDSTRU                                          1608 06599000
         MVI   DARGSENT(@02),X'03'                                 1608 06600000
* IF KEYRNGSW = OFF                                                1609 06601000
*   THEN VOLHD2 = '   ' ;                                          1609 06602000
         TM    KEYRNGSW,B'01000000'                                1609 06603000
         BNZ   @RF01609                                            1609 06604000
         MVC   VOLHD2(3),@CC00776                                  1610 06605000
* DARGIND = DARGIND + 2 ;                                          1611 06606000
@RF01609 L     @02,DDSTRU                                          1611 06607000
         LA    @15,2                                               1611 06608000
         SLR   @14,@14                                             1611 06609000
         IC    @14,DARGIND(,@02)                                   1611 06610000
         ALR   @15,@14                                             1611 06611000
         STC   @15,DARGIND(,@02)                                   1611 06612000
* DARGINL(1) = 6 ;                                                 1612 06613000
         MVC   DARGINL(2,@02),@CH00041                             1612 06614000
* DARGDTM(1) = ADDR(VOLSER) ;                                      1613 06615000
*                                                                  1613 06616000
         L     @15,FMFLADDR(,FMFLCUR)                              1613 06617000
         ST    @15,DARGDTM(,@02)                                   1613 06618000
* /*******************************************************************/ 06619000
* /* LOOP: PRINTING ALL OF THE VOLUME SERIALS                        */ 06620000
* /*******************************************************************/ 06621000
*                                                                  1614 06622000
* DO WHILE (RELREPNO < NBRVOLOC) ;                                 1614 06623000
         B     @DE01614                                            1614 06624000
@DL01614 DS    0H                                                  1615 06625000
*   FMPLFMFL(2) -> FMFLENTH(1) = 0 ;                               1615 06626000
         L     @02,FMPLAD                                          1615 06627000
         L     @01,FMPLFMFL+4(,@02)                                1615 06628000
         SLR   @00,@00                                             1615 06629000
         ST    @00,FMFLENTH(,@01)                                  1615 06630000
*   REG1 = FMPLAD ;                                                1616 06631000
*                                                                  1616 06632000
         LR    REG1,@02                                            1616 06633000
*   CALL IDCRC04 ;                 /* ASK VOLSER (AND KEYRNG)        */ 06634000
*                                                                  1617 06635000
         L     @15,@CV00793                                        1617 06636000
         BALR  @14,@15                                             1617 06637000
*   IF FMFLENTH ^= 0                                               1618 06638000
*     THEN                                                         1618 06639000
         SLR   @02,@02                                             1618 06640000
         C     @02,FMFLENTH(,FMFLCUR)                              1618 06641000
         BE    @RF01618                                            1618 06642000
*       DO ;                                                       1619 06643000
*         IF FMFLENTH(1) = 0       /* IGNORE ALL DELETED             */ 06644000
*           THEN ;                 /* OCCURANCES                     */ 06645000
         C     @02,FMFLENTH(,FMFLCUR)                              1620 06646000
         BE    @RT01620                                            1620 06647000
*           ELSE                                                   1622 06648000
*             DO ;                                                 1622 06649000
*               IF KEYRNGSW = ON                                   1623 06650000
*                 THEN             /* ADD HIGH KEY PRINT             */ 06651000
         TM    KEYRNGSW,B'01000000'                                1623 06652000
         BNO   @RF01623                                            1623 06653000
*                   DO ;                                           1624 06654000
*                     KEYLEN = FMPLFMFL(2) ->                      1625 06655000
*                              FMFLADDR(1) -> HIKEYLEN ;           1625 06656000
         L     @01,FMPLAD                                          1625 06657000
         L     @01,FMPLFMFL+4(,@01)                                1625 06658000
         L     @15,FMFLADDR(,@01)                                  1625 06659000
         LH    KEYLEN,HIKEYLEN(,@15)                               1625 06660000
*                     DARGINL(3) = MIN(32,KEYLEN) ;                1626 06661000
         L     @14,DDSTRU                                          1626 06662000
         LA    @01,32                                              1626 06663000
         LR    @00,@01                                             1626 06664000
         CR    @00,KEYLEN                                          1626 06665000
         BNH   *+6                                                      06666000
         LR    @00,KEYLEN                                          1626 06667000
         STH   @00,DARGINL+16(,@14)                                1626 06668000
*                     DARGDTM(3) = (FMPLFMFL(2) -> FMFLADDR(1))    1627 06669000
*                                  + LENGTH(HIKEYLEN) ;            1627 06670000
         AL    @15,@CF00158                                        1627 06671000
         ST    @15,DARGDTM+16(,@14)                                1627 06672000
*                     IF KEYLEN > 32                               1628 06673000
*                       THEN       /* NEED TWO LINES FOR KEY         */ 06674000
         CR    KEYLEN,@01                                          1628 06675000
         BNH   @RF01628                                            1628 06676000
*                         DO ;                                     1629 06677000
*                                                                  1629 06678000
*                           CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;     06679000
*                                                                  1630 06680000
         L     @15,@PC00001                                        1630 06681000
         ST    @15,@AL00001                                        1630 06682000
         LA    @14,IOCSPRT                                         1630 06683000
         ST    @14,@AL00001+4                                      1630 06684000
         LA    @14,DDSTRU                                          1630 06685000
         ST    @14,@AL00001+8                                      1630 06686000
         MVI   @AL00001+8,X'80'                                    1630 06687000
         L     @15,GDTPRT(,@15)                                    1630 06688000
         LA    @01,@AL00001                                        1630 06689000
         BALR  @14,@15                                             1630 06690000
*                           DARGDTM(1) = ADDR('      ') ;          1631 06691000
         L     @15,DDSTRU                                          1631 06692000
         LA    @14,@CC00686                                        1631 06693000
         ST    @14,DARGDTM(,@15)                                   1631 06694000
*                           DARGINL(3) = KEYLEN - 32 ;             1632 06695000
         LA    @14,32                                              1632 06696000
         LR    @01,KEYLEN                                          1632 06697000
         SLR   @01,@14                                             1632 06698000
         STH   @01,DARGINL+16(,@15)                                1632 06699000
*                           DARGDTM(3) = DARGDTM(3) + 32 ;         1633 06700000
         AL    @14,DARGDTM+16(,@15)                                1633 06701000
         ST    @14,DARGDTM+16(,@15)                                1633 06702000
*                         END ;                                    1634 06703000
*                   END ;                                          1635 06704000
*                                                                  1635 06705000
@RF01628 DS    0H                                                  1636 06706000
*               CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;            1636 06707000
*                                                                  1636 06708000
@RF01623 L     @02,@PC00001                                        1636 06709000
         ST    @02,@AL00001                                        1636 06710000
         LA    @15,IOCSPRT                                         1636 06711000
         ST    @15,@AL00001+4                                      1636 06712000
         LA    @15,DDSTRU                                          1636 06713000
         ST    @15,@AL00001+8                                      1636 06714000
         MVI   @AL00001+8,X'80'                                    1636 06715000
         L     @15,GDTPRT(,@02)                                    1636 06716000
         LA    @01,@AL00001                                        1636 06717000
         BALR  @14,@15                                             1636 06718000
*             END ;                                                1637 06719000
*         RELREPNO = RELREPNO + 1; /* ASK FOR NEXT ONE               */ 06720000
@RT01620 LA    @02,1                                               1638 06721000
         LH    @15,RELREPNO                                        1638 06722000
         ALR   @15,@02                                             1638 06723000
         STH   @15,RELREPNO                                        1638 06724000
*         CNTREPNO = CNTREPNO + 1 ;                                1639 06725000
         AH    @02,CNTREPNO                                        1639 06726000
         STH   @02,CNTREPNO                                        1639 06727000
*       END ;                                                      1640 06728000
*     ELSE                                                         1641 06729000
*       DO ;                                                       1641 06730000
         B     @RC01618                                            1641 06731000
@RF01618 DS    0H                                                  1642 06732000
*         PROCMSG='PRTOJVL ';    /* PROC NAME FOR INSERT     @OZ09388*/ 06733000
         MVC   PROCMSG(8),@CC01388                                 1642 06734000
*         CALL ERROR (21,$RETURN); /* FLD MGMT ERROR RETURN          */ 06735000
         LA    @01,@AL01643                                        1643 06736000
         BAL   @14,ERROR                                           1643 06737000
*         RELREPNO = NBRVOLOC + 1; /* GET OUT OF LOOP                */ 06738000
         LA    @02,1(,NBRVOLOC)                                    1644 06739000
         STH   @02,RELREPNO                                        1644 06740000
*       END ;                                                      1645 06741000
* END ;                                                            1646 06742000
@RC01618 DS    0H                                                  1646 06743000
@DE01614 CH    NBRVOLOC,RELREPNO                                   1646 06744000
         BH    @DL01614                                            1646 06745000
* RELREPNO = 0 ;                   /* RESTORE ASSUMED VALUES         */ 06746000
         SLR   @15,@15                                             1647 06747000
         STH   @15,RELREPNO                                        1647 06748000
* CNTREPNO = 1 ;                                                   1648 06749000
         MVC   CNTREPNO(2),@CH00222                                1648 06750000
* FMPLFLNO = 1 ;                                                   1649 06751000
         L     @15,FMPLAD                                          1649 06752000
         MVI   FMPLFLNO(@15),X'01'                                 1649 06753000
* FMPLFMFL(2) -> FMFLTCHN = '0'B ;                                 1650 06754000
         SLR   @14,@14                                             1650 06755000
         L     @01,FMPLFMFL+4(,@15)                                1650 06756000
         ST    @14,FMFLTCHN(,@01)                                  1650 06757000
* FMFLTCHN = '0'B ;                                                1651 06758000
         ST    @14,FMFLTCHN(,FMFLCUR)                              1651 06759000
* INDNTCOL = INDNTCOL - 2 ;                                        1652 06760000
*                                                                  1652 06761000
         SLR   @15,@15                                             1652 06762000
         IC    @15,INDNTCOL                                        1652 06763000
         BCTR  @15,0                                               1652 06764000
         BCTR  @15,0                                               1652 06765000
         STC   @15,INDNTCOL                                        1652 06766000
*END PRTOJVL ;                                                     1653 06767000
@EL00027 DS    0H                                                  1653 06768000
@EF00027 DS    0H                                                  1653 06769000
@ER00027 LM    @14,@12,@SA00027                                    1653 06770000
         BR    @14                                                 1653 06771000
* /*******************************************************************/ 06772000
* /* PROCEDURE NAME - PRTOTHR, PRINT OTHER THAN VSAM OBJECTS         */ 06773000
* /* FUNCTION -                                                      */ 06774000
* /*   IF ALREADY MARKED AS GDG MEMBER OR ALREADY PRINTED DO NOTHING,*/ 06775000
* /*   IF COMPARE, PASS TWICE THRU THE FOLLOWING, FIRST              */ 06776000
* /*   WITH NO PRINTING LOOKING FOR ANY MISCOMPARE,                  */ 06777000
* /*   SECOND TIME PRINTING IF THERE WAS ONE,                        */ 06778000
* /*   LOOP THRU HORIZONTAL EXTENSIONS,                              */ 06779000
* /*     GET (AND PRINT) TOP RECORD OF STRUCTURE,                    */ 06780000
* /*     CALL VERTEXT TO HANDLE ANY VERTICAL EXTENSIONS,             */ 06781000
* /*   IF NOT GDG BASE CALL PRTOJAL TO PROCESS ALIASES               */ 06782000
* /*     AND IF COMPARE AND MISCOMPARED PRINT RIGHT WORDS            */ 06783000
* /*     AND BUMP MISCOMPARED ENTRIES COUNT,                         */ 06784000
* /*   IF IS GDG BASE INITIALIZE THE ASSOTBL WITH ALL                */ 06785000
* /*     MEMBER CI,S AND DO THE ABOVE FOR EACH ONE OF                */ 06786000
* /*     THEM AFTER DOING MICOMPARE WORDS FOR BASE ITSELF            */ 06787000
* /* INPUTS -                                                        */ 06788000
* /*   SORTTBL ENTRY IDENTIFIED BY STSLOT                            */ 06789000
* /* OUTPUTS -                                                       */ 06790000
* /*   LISTING OF OTHER THAN VSAM STRUCTURES AS REQUESTED            */ 06791000
* /*   CTTGDGM SWITCHES ON FOR NONVSAM MEMBERS OF GDG SETS           */ 06792000
* /*   MCENTCNT (MISCOMPARED ENTRIES COUNT)                          */ 06793000
* /* CALLS -                                                         */ 06794000
* /*   GETPRT, INTASOC, VERTEXT, PRTMCWD, PRTOJAL, SUMIT             */ 06795000
* /*******************************************************************/ 06796000
*                                                                  1654 06797000
*PRTOTHR: PROCEDURE ;                                              1654 06798000
PRTOTHR  STM   @14,@12,@SA00028                                    1654 06799000
* OLDERID2 = NEWERID2;                                             1655 06800000
         L     @02,@PC00001                                        1655 06801000
         L     @15,GDTTR2(,@02)                                    1655 06802000
         MVC   @TS00001(95),NEWERID2(@15)                          1655 06803000
         MVC   OLDERID2(95,@15),@TS00001                           1655 06804000
* NEWID2 = 'LRPO' ;                                                1656 06805000
         MVC   NEWID2(4,@15),@CC01392                              1656 06806000
* IF GDTDBG = NULLPTR                                              1657 06807000
*   THEN;                                                          1657 06808000
         L     @02,GDTDBG(,@02)                                    1657 06809000
         LTR   @02,@02                                             1657 06810000
         BZ    @RT01657                                            1657 06811000
*   ELSE                                                           1659 06812000
*     CALL IDCDB010 (GDTTBL,'LRPO') ;                              1659 06813000
*                                                                  1659 06814000
         L     @02,@PC00001                                        1659 06815000
         ST    @02,@AL00001                                        1659 06816000
         LA    @15,@CC01392                                        1659 06817000
         ST    @15,@AL00001+4                                      1659 06818000
         MVI   @AL00001+4,X'80'                                    1659 06819000
         L     @15,GDTDBG(,@02)                                    1659 06820000
         LA    @01,@AL00001                                        1659 06821000
         BALR  @14,@15                                             1659 06822000
* CMPRPASW = OFF ;                 /* SET CONTROL SWITCHES           */ 06823000
@RT01657 NI    CMPRPASW,B'01111111'                                1660 06824000
* PRNTPASW = OFF ;                 /* FOR ONE ONLY OR                */ 06825000
         NI    PRNTPASW,B'01111111'                                1661 06826000
* IF CMPRSW = ON                   /* (IF COMPARE) POSSIBLE          */ 06827000
*   THEN                           /* TWO PASSES THRU LOGIC,         */ 06828000
         TM    CMPRSW,B'01000000'                                  1662 06829000
         BNO   @RF01662                                            1662 06830000
*     CMPRPASW = ON ;              /* 1 - LOOK FOR MISCOMPARE        */ 06831000
         OI    CMPRPASW,B'10000000'                                1663 06832000
*   ELSE                           /* 2 - PRINT IF MISCOMPARE        */ 06833000
*     PRNTPASW = ON ;              /* WAS FOUND                      */ 06834000
         B     @RC01662                                            1664 06835000
@RF01662 OI    PRNTPASW,B'10000000'                                1664 06836000
* MSCMPRSW = OFF ;                                                 1665 06837000
@RC01662 NI    MSCMPRSW,B'11110111'                                1665 06838000
* ENTNOCUR = 0 ;                                                   1666 06839000
         SLR   @02,@02                                             1666 06840000
         STH   @02,ENTNOCUR                                        1666 06841000
* ENTNOSAV = 0 ;                                                   1667 06842000
*                                                                  1667 06843000
         STH   @02,ENTNOSAV                                        1667 06844000
* /*******************************************************************/ 06845000
* /* IF NOT ALREADY PROCESSED AS MEMBER OF GDG SET OR ALREADY PRINTED*/ 06846000
* /* PASS THRU TWICE IF COMPARE SO ONLY MISCOMPARES WILL PRINT       */ 06847000
* /*******************************************************************/ 06848000
*                                                                  1668 06849000
* IF CTTGDGM(STCRACI(STSLOT)-CTTBASE) ^= ON THEN                   1668 06850000
         LR    @02,STSLOT                                          1668 06851000
         MH    @02,@CH01068                                        1668 06852000
         L     @01,STPTR                                           1668 06853000
         AL    @01,@CF01484                                        1668 06854000
         L     @02,STCRACI-45(@02,@01)                             1668 06855000
         LA    @02,0(,@02)                                         1668 06856000
         SLA   @02,3                                               1668 06857000
         L     @01,CTTPTR                                          1668 06858000
         ALR   @01,@02                                             1668 06859000
         AL    @01,@CF01491                                        1668 06860000
         TM    CTTGDGM-8(@01),B'00100000'                          1668 06861000
         BO    @RF01668                                            1668 06862000
*   DO WHILE (CTTPRTD(STCRACI(STSLOT)-CTTBASE) ^= ON               1669 06863000
*         & (CMPRPASW = ON | PRNTPASW = ON)) ;                     1669 06864000
         B     @DE01669                                            1669 06865000
@DL01669 DS    0H                                                  1670 06866000
*     INDNTCOL = 0 ;                                               1670 06867000
         MVI   INDNTCOL,X'00'                                      1670 06868000
*     CIFRGET = STCRACI(STSLOT) ;                                  1671 06869000
         L     @02,STPTR                                           1671 06870000
         LR    @15,STSLOT                                          1671 06871000
         MH    @15,@CH01068                                        1671 06872000
         ST    @15,@TF00001                                        1671 06873000
         ALR   @15,@02                                             1671 06874000
         AL    @15,@CF01477                                        1671 06875000
         MVC   CIFRGET(3),STCRACI-45(@15)                          1671 06876000
*     CIBASE = CIFRGET ;                                           1672 06877000
         MVC   CIBASE(3),CIFRGET                                   1672 06878000
*     BASETYPE = STENTYP(STSLOT) ;                                 1673 06879000
*                                                                  1673 06880000
         AL    @02,@TF00001                                        1673 06881000
         AL    @02,@CF01484                                        1673 06882000
         MVC   BASETYPE(1),STENTYP-44(@02)                         1673 06883000
*     /***************************************************************/ 06884000
*     /* LOOP: THRU ALL HORIZONTAL EXTENSION RECORDS (IF ANY)        */ 06885000
*     /***************************************************************/ 06886000
*                                                                  1674 06887000
*     DO WHILE ((CIFRGET ^= '0'B)                                  1674 06888000
*           & (^(CMPRPASW = ON          /* QUIT AFTER FIRST          */ 06889000
*                & MSCMPRSW = ON)));    /* MISCOMPARE                */ 06890000
*                                                                  1674 06891000
         B     @DE01674                                            1674 06892000
@DL01674 DS    0H                                                  1675 06893000
*       CALL GETPRT ;              /* GET (PRINT) TOP RECORD         */ 06894000
*                                                                  1675 06895000
         BAL   @14,GETPRT                                          1675 06896000
*       CALL VERTEXT ;             /* AND ITS VERTICAL EXTNS         */ 06897000
*                                                                  1676 06898000
         BAL   @14,VERTEXT                                         1676 06899000
*     END ;                                                        1677 06900000
@DE01674 L     @02,CIFRGET-1                                       1677 06901000
         LA    @02,0(,@02)                                         1677 06902000
         LTR   @02,@02                                             1677 06903000
         BZ    @DC01674                                            1677 06904000
         TM    CMPRPASW,B'10000000'                                1677 06905000
         BNO   @DL01674                                            1677 06906000
         TM    MSCMPRSW,B'00001000'                                1677 06907000
         BNO   @DL01674                                            1677 06908000
@DC01674 DS    0H                                                  1678 06909000
*     ENTNOCUR = ENTNOCUR + 1 ;    /* AVOID COUNTING TWICE           */ 06910000
         LH    @02,ENTNOCUR                                        1678 06911000
         LA    @02,1(,@02)                                         1678 06912000
         STH   @02,ENTNOCUR                                        1678 06913000
*     IF    (PRNTPASW = ON & CMPRSW = OFF)                         1679 06914000
*         | ENTNOCUR > ENTNOSAV                                    1679 06915000
*                                                                  1679 06916000
*       THEN CALL SUMIT (SMACCUM,BASETYPE) ;                       1679 06917000
*                                                                  1679 06918000
         TM    PRNTPASW,B'10000000'                                1679 06919000
         BNO   @GL00069                                            1679 06920000
         TM    CMPRSW,B'01000000'                                  1679 06921000
         BZ    @RT01679                                            1679 06922000
@GL00069 LH    @02,ENTNOCUR                                        1679 06923000
         CH    @02,ENTNOSAV                                        1679 06924000
         BNH   @RF01679                                            1679 06925000
@RT01679 DS    0H                                                  1680 06926000
         LA    @02,SMACCUM                                         1680 06927000
         ST    @02,@AL00001                                        1680 06928000
         LA    @02,BASETYPE                                        1680 06929000
         ST    @02,@AL00001+4                                      1680 06930000
         LA    @01,@AL00001                                        1680 06931000
         BAL   @14,SUMIT                                           1680 06932000
*     CIFRGET = CIBASE ;                                           1681 06933000
@RF01679 MVC   CIFRGET(3),CIBASE                                   1681 06934000
*     IF ^(CMPRPASW = ON           /* QUIT AFTER 1ST MISCMPR         */ 06935000
*        & MSCMPRSW = ON)                                          1682 06936000
*       THEN                                                       1682 06937000
         TM    CMPRPASW,B'10000000'                                1682 06938000
         BNO   @RT01682                                            1682 06939000
         TM    MSCMPRSW,B'00001000'                                1682 06940000
         BO    @RF01682                                            1682 06941000
@RT01682 DS    0H                                                  1683 06942000
*         DO ;                                                     1683 06943000
*           IF BASETYPE ^= CATRCTYP($GDGB)                         1684 06944000
*             THEN                       /****************************/ 06945000
         SLR   @02,@02                                             1684 06946000
         IC    @02,$GDGB                                           1684 06947000
         MH    @02,@CH00042                                        1684 06948000
         LA    @01,CATRCTYP-5(@02)                                 1684 06949000
         CLC   BASETYPE(1),0(@01)                                  1684 06950000
         BE    @RF01684                                            1684 06951000
*               DO ;                     /* NONVSAM AND UCAT PTRS    */ 06952000
*                 IF     PRNTPASW = ON   /****************************/ 06953000
*                    & CMPRSW = ON                                 1686 06954000
*                    & CTTMCSW(CIFRGET - CTTBASE) = ON             1686 06955000
*                   THEN                                           1686 06956000
         TM    PRNTPASW,B'10000000'                                1686 06957000
         BNO   @RF01686                                            1686 06958000
         TM    CMPRSW,B'01000000'                                  1686 06959000
         BNO   @RF01686                                            1686 06960000
         L     @02,CIFRGET-1                                       1686 06961000
         LA    @02,0(,@02)                                         1686 06962000
         SLA   @02,3                                               1686 06963000
         L     @01,CTTPTR                                          1686 06964000
         ALR   @01,@02                                             1686 06965000
         AL    @01,@CF01491                                        1686 06966000
         TM    CTTMCSW-8(@01),B'01000000'                          1686 06967000
         BNO   @RF01686                                            1686 06968000
*                     DO ;                                         1687 06969000
*                                                                  1687 06970000
*                       CALL PRTMCWD(2, /* ONLY 1ST 2 GROUPS         */ 06971000
*                                  MCARGTBL,MCMSGTBL,MCMLNTBL);    1688 06972000
*                                                                  1688 06973000
         LA    @01,@AL01688                                        1688 06974000
         BAL   @14,PRTMCWD                                         1688 06975000
*                       MCENTCNT = MCENTCNT + 1 ; /* BUMP COUNT      */ 06976000
         LH    @02,MCENTCNT                                        1689 06977000
         LA    @02,1(,@02)                                         1689 06978000
         STH   @02,MCENTCNT                                        1689 06979000
*                     END ;                                        1690 06980000
*                                                                  1690 06981000
*                 CALL PRTOJAL ;   /* GO PRINT ALIASES (IFANY        */ 06982000
*                                                                  1691 06983000
@RF01686 BAL   @14,PRTOJAL                                         1691 06984000
*               END ;                                              1692 06985000
*             ELSE                         /**************************/ 06986000
*               DO ;                       /* HANDLE GDG MEMBERS     */ 06987000
         B     @RC01684                                            1693 06988000
@RF01684 DS    0H                                                  1694 06989000
*                 IF     PRNTPASW = ON     /**************************/ 06990000
*                    & CMPRSW = ON                                 1694 06991000
*                    & CTTMCSW(CIFRGET - CTTBASE) = ON             1694 06992000
*                   THEN                                           1694 06993000
         TM    PRNTPASW,B'10000000'                                1694 06994000
         BNO   @RF01694                                            1694 06995000
         TM    CMPRSW,B'01000000'                                  1694 06996000
         BNO   @RF01694                                            1694 06997000
         L     @02,CIFRGET-1                                       1694 06998000
         LA    @02,0(,@02)                                         1694 06999000
         SLA   @02,3                                               1694 07000000
         L     @01,CTTPTR                                          1694 07001000
         ALR   @01,@02                                             1694 07002000
         AL    @01,@CF01491                                        1694 07003000
         TM    CTTMCSW-8(@01),B'01000000'                          1694 07004000
         BNO   @RF01694                                            1694 07005000
*                     DO ;                                         1695 07006000
*                                                                  1695 07007000
*                       CALL PRTMCWD(1,    /* ONLY 1ST GROUP         */ 07008000
*                                  MCARGTBL,MCMSGTBL,MCMLNTBL);    1696 07009000
*                                                                  1696 07010000
         LA    @01,@AL01696                                        1696 07011000
         BAL   @14,PRTMCWD                                         1696 07012000
*                       MCENTCNT = MCENTCNT + 1 ;                  1697 07013000
         LH    @02,MCENTCNT                                        1697 07014000
         LA    @02,1(,@02)                                         1697 07015000
         STH   @02,MCENTCNT                                        1697 07016000
*                     END ;                                        1698 07017000
*                 INDNTCOL = 2 ;                                   1699 07018000
*                                                                  1699 07019000
@RF01694 MVI   INDNTCOL,X'02'                                      1699 07020000
*                 CALL INTASOC(1) ;                                1700 07021000
*                                                                  1700 07022000
         LA    @01,@AL01700                                        1700 07023000
         BAL   @14,INTASOC                                         1700 07024000
*                 /***************************************************/ 07025000
*                 /* LOOP: THRU GDG MEMBERS                          */ 07026000
*                 /***************************************************/ 07027000
*                                                                  1701 07028000
*                 DO ATSLOT = 1 TO NBRATS                          1701 07029000
*                    WHILE (ATCRACI(ATSLOT) ^= '0'B                1701 07030000
*                       & LASTATSW ^= ON                           1701 07031000
*                       & ^(CMPRPASW = ON                          1701 07032000
*                           & MSCMPRSW = ON)) ;                    1701 07033000
         LA    ATSLOT,1                                            1701 07034000
@DL01701 LR    @15,ATSLOT                                          1701 07035000
         SLA   @15,2                                               1701 07036000
         L     @01,ATRA2PTR                                        1701 07037000
         L     @15,ATCRACI-5(@15,@01)                              1701 07038000
         LA    @15,0(,@15)                                         1701 07039000
         LTR   @15,@15                                             1701 07040000
         BZ    @DC01701                                            1701 07041000
         TM    LASTATSW,B'00100000'                                1701 07042000
         BO    @DC01701                                            1701 07043000
         TM    CMPRPASW,B'10000000'                                1701 07044000
         BNO   @DB01701                                            1701 07045000
         TM    MSCMPRSW,B'00001000'                                1701 07046000
         BO    @DC01701                                            1701 07047000
@DB01701 DS    0H                                                  1702 07048000
*                   CIFRGET = ATCRACI(ATSLOT) ;                    1702 07049000
         LR    @15,ATSLOT                                          1702 07050000
         SLA   @15,2                                               1702 07051000
         L     @01,ATRA2PTR                                        1702 07052000
         ALR   @01,@15                                             1702 07053000
         MVC   CIFRGET(3),ATCRACI-4(@01)                           1702 07054000
*                   CIBASE = CIFRGET ;                             1703 07055000
*                                                                  1703 07056000
         MVC   CIBASE(3),CIFRGET                                   1703 07057000
*                   /************************************************/  07058000
*                   /* LOOP: THRU ANY GDG MEMBER                     */ 07059000
*                   /*       HORIZONTAL EXTENSION RECORDS            */ 07060000
*                   /************************************************/  07061000
*                                                                  1704 07062000
*                   DO WHILE (CIFRGET ^= '0'B                      1704 07063000
*                        & (^(CMPRPASW = ON           /* SEE         */ 07064000
*                             & MSCMPRSW = ON)));     /*ABOVE        */ 07065000
*                                                                  1704 07066000
         B     @DE01704                                            1704 07067000
@DL01704 DS    0H                                                  1705 07068000
*                     CALL GETPRT ;/* GET (PRINT) MEMBER             */ 07069000
*                                                                  1705 07070000
         BAL   @14,GETPRT                                          1705 07071000
*                     CALL VERTEXT;/* HANDLE VERT EXTENSIONS         */ 07072000
*                                                                  1706 07073000
         BAL   @14,VERTEXT                                         1706 07074000
*                   END ;                                          1707 07075000
@DE01704 L     @15,CIFRGET-1                                       1707 07076000
         LA    @15,0(,@15)                                         1707 07077000
         LTR   @15,@15                                             1707 07078000
         BZ    @DC01704                                            1707 07079000
         TM    CMPRPASW,B'10000000'                                1707 07080000
         BNO   @DL01704                                            1707 07081000
         TM    MSCMPRSW,B'00001000'                                1707 07082000
         BNO   @DL01704                                            1707 07083000
@DC01704 DS    0H                                                  1708 07084000
*                   CIFRGET = CIBASE ;                             1708 07085000
         L     @15,CIBASE-1                                        1708 07086000
         LA    @15,0(,@15)                                         1708 07087000
         STCM  @15,7,CIFRGET                                       1708 07088000
*                   CTTGDGM(CIFRGET-CTTBASE) = ON;  /* MARK AS MEMBR */ 07089000
         L     @14,CTTPTR                                          1709 07090000
         SLA   @15,3                                               1709 07091000
         ST    @15,@TF00001                                        1709 07092000
         ALR   @15,@14                                             1709 07093000
         AL    @15,@CF01491                                        1709 07094000
         OI    CTTGDGM-8(@15),B'00100000'                          1709 07095000
*                   IF     PRNTPASW = ON                           1710 07096000
*                      & CMPRSW = ON                               1710 07097000
*                      & CTTMCSW(CIFRGET - CTTBASE) = ON           1710 07098000
*                     THEN                                         1710 07099000
*                                                                  1710 07100000
         TM    PRNTPASW,B'10000000'                                1710 07101000
         BNO   @RF01710                                            1710 07102000
         TM    CMPRSW,B'01000000'                                  1710 07103000
         BNO   @RF01710                                            1710 07104000
         AL    @14,@TF00001                                        1710 07105000
         AL    @14,@CF01491                                        1710 07106000
         TM    CTTMCSW-8(@14),B'01000000'                          1710 07107000
         BNO   @RF01710                                            1710 07108000
*                       CALL PRTMCWD(2,      /*USE 1ST 2 GRPS        */ 07109000
*                                  MCARGTBL,MCMSGTBL,MCMLNTBL);    1711 07110000
*                                                                  1711 07111000
         LA    @01,@AL01711                                        1711 07112000
         BAL   @14,PRTMCWD                                         1711 07113000
*                   CALL PRTOJAL ; /* PRINT ANY ALIASES              */ 07114000
*                                                                  1712 07115000
@RF01710 BAL   @14,PRTOJAL                                         1712 07116000
*                   ENTNOCUR = ENTNOCUR + 1 ;                      1713 07117000
         LH    @01,ENTNOCUR                                        1713 07118000
         LA    @01,1(,@01)                                         1713 07119000
         STH   @01,ENTNOCUR                                        1713 07120000
*                   IF   (PRNTPASW = ON & CMPRSW = OFF)            1714 07121000
*                      | ENTNOCUR > ENTNOSAV                       1714 07122000
*                                                                  1714 07123000
*                     THEN CALL SUMIT(SMACCUM,ATENTYP(ATSLOT));    1714 07124000
*                                                                  1714 07125000
         TM    PRNTPASW,B'10000000'                                1714 07126000
         BNO   @GL00083                                            1714 07127000
         TM    CMPRSW,B'01000000'                                  1714 07128000
         BZ    @RT01714                                            1714 07129000
@GL00083 LH    @15,ENTNOCUR                                        1714 07130000
         CH    @15,ENTNOSAV                                        1714 07131000
         BNH   @RF01714                                            1714 07132000
@RT01714 DS    0H                                                  1715 07133000
         LA    @15,SMACCUM                                         1715 07134000
         ST    @15,@AL00001                                        1715 07135000
         LR    @15,ATSLOT                                          1715 07136000
         SLA   @15,2                                               1715 07137000
         L     @01,ATRA2PTR                                        1715 07138000
         LA    @15,ATENTYP-4(@15,@01)                              1715 07139000
         ST    @15,@AL00001+4                                      1715 07140000
         LA    @01,@AL00001                                        1715 07141000
         BAL   @14,SUMIT                                           1715 07142000
*                   IF ATSLOT = NBRATS                             1716 07143000
*                     THEN                                         1716 07144000
@RF01714 C     ATSLOT,@CF00038                                     1716 07145000
         BNE   @RF01716                                            1716 07146000
*                       IF ATNXTTBL ^= '0'B                        1717 07147000
*                         THEN                                     1717 07148000
         L     @01,ATRA2PTR                                        1717 07149000
         L     @15,ATNXTTBL(,@01)                                  1717 07150000
         LTR   @15,@15                                             1717 07151000
         BZ    @RF01717                                            1717 07152000
*                             DO ;                                 1718 07153000
*                               ATPTR = ATNXTTBL ;  /*BUMP TO        */ 07154000
         ST    @15,ATPTR                                           1719 07155000
*                               ATRA2PTR = ATPTR;          /*@OZ09619*/ 07156000
         ST    @15,ATRA2PTR                                        1720 07157000
*                               ATSLOT = 0 ;   /* NEXT TABLE         */ 07158000
         SLR   ATSLOT,ATSLOT                                       1721 07159000
*                             END ;                                1722 07160000
*                           ELSE                                   1723 07161000
*                             LASTATSW = ON ;                      1723 07162000
         B     @RC01717                                            1723 07163000
@RF01717 OI    LASTATSW,B'00100000'                                1723 07164000
*                 END ;                                            1724 07165000
@RC01717 DS    0H                                                  1724 07166000
@RF01716 AL    ATSLOT,@CF00222                                     1724 07167000
         C     ATSLOT,@CF00038                                     1724 07168000
         BNH   @DL01701                                            1724 07169000
@DC01701 DS    0H                                                  1725 07170000
*                 LASTATSW = OFF ;                                 1725 07171000
         NI    LASTATSW,B'11011111'                                1725 07172000
*               END ;                                              1726 07173000
*         END ;                                                    1727 07174000
@RC01684 DS    0H                                                  1728 07175000
*     PRNTPASW = OFF ;             /* TURN OFF AFTER PRINTING        */ 07176000
@RF01682 NI    PRNTPASW,B'01111111'                                1728 07177000
*     IF CMPRPASW = ON & MSCMPRSW = ON                             1729 07178000
*       THEN PRNTPASW = ON ;       /* PASS THRU AGAIN PRINTIN        */ 07179000
         TM    CMPRPASW,B'10000000'                                1729 07180000
         BNO   @RF01729                                            1729 07181000
         TM    MSCMPRSW,B'00001000'                                1729 07182000
         BNO   @RF01729                                            1729 07183000
         OI    PRNTPASW,B'10000000'                                1730 07184000
*     CMPRPASW = OFF ;                                             1731 07185000
@RF01729 NI    CMPRPASW,B'01111111'                                1731 07186000
*   END ;                          /* END 2ND PASS CONTROL           */ 07187000
*                                                                  1732 07188000
@DE01669 LR    @02,STSLOT                                          1732 07189000
         MH    @02,@CH01068                                        1732 07190000
         L     @01,STPTR                                           1732 07191000
         AL    @01,@CF01484                                        1732 07192000
         L     @02,STCRACI-45(@02,@01)                             1732 07193000
         LA    @02,0(,@02)                                         1732 07194000
         SLA   @02,3                                               1732 07195000
         L     @01,CTTPTR                                          1732 07196000
         ALR   @01,@02                                             1732 07197000
         AL    @01,@CF01491                                        1732 07198000
         TM    CTTPRTD-8(@01),B'10000000'                          1732 07199000
         BO    @DC01669                                            1732 07200000
         TM    CMPRPASW,B'10000000'                                1732 07201000
         BO    @DL01669                                            1732 07202000
         TM    PRNTPASW,B'10000000'                                1732 07203000
         BO    @DL01669                                            1732 07204000
@DC01669 DS    0H                                                  1733 07205000
*END PRTOTHR ;                                                     1733 07206000
@EL00028 DS    0H                                                  1733 07207000
@EF00028 DS    0H                                                  1733 07208000
@ER00028 LM    @14,@12,@SA00028                                    1733 07209000
         BR    @14                                                 1733 07210000
* /*******************************************************************/ 07211000
* /* PROCEDURE NAME - PRTTIME, PRINT VARIOUS TIMESTAMPS              */ 07212000
* /* FUNCTION -                                                      */ 07213000
* /*   CONVERT 64 BIT TIMESTAMP TO 'MO/DA/YR  HR:MN:SC' AND          */ 07214000
* /*   ADD IDENTIFYING WORD AND PRINT THEM                           */ 07215000
* /*   NOTE: BECAUSE PLS CANNOT DO A 64 BIT DIVIDE  AND A            */ 07216000
* /*         FIXED POINT DIVIDE EXCEPTION IS UNDESIREABLE,           */ 07217000
* /*         SHIFT THE TIMESTAMP RIGHT 12 POSITIONS TO GET           */ 07218000
* /*         TO THE MICROSECOND COUNTING BIT THEN DIVIDE BY          */ 07219000
* /*         86,400,000,000 (1,000,000*3600*24) SAME AS              */ 07220000
* /*         (10,546,875*2**13 (SHIFT 13 THEN DIVIDE))               */ 07221000
* /*         TO GET WHOLE DAYS AS QUOTIENT AND PARTS OF              */ 07222000
* /*         DAYS AS DECIMAL REMAINDER) THEN CONVERT THIS            */ 07223000
* /*         BACK TO SECONDS.  1/1/1900 IS THE BASE YEAR AND         */ 07224000
* /*         LEAP YEAR EFFECTS ARE HANDLED TO YEAR 2000              */ 07225000
* /*   CREDITS: AL KULAS FURNISHED MOST OF THE INFORMATION           */ 07226000
* /*            WHICH ALLOWED ME TO WRITE THIS ROUTINE WITH          */ 07227000
* /*            W.J.RICHARDS HELP IN DEBUGGING IT                    */ 07228000
* /* INPUTS -                                                        */ 07229000
* /*   SUBSCRIPT OF TIMESTAMP IDENTIFYING WORD                       */ 07230000
* /*   TIMESTAMP (64 BIT)                                            */ 07231000
* /* OUTPUTS -                                                       */ 07232000
* /*   PRINTED TIMESTAMP LINE                                        */ 07233000
* /* CALLS -                                                         */ 07234000
* /*   UPRINT                                                        */ 07235000
* /*******************************************************************/ 07236000
*PRTTIME: PROCEDURE (TSTID,TSTBIT64) ;                             1734 07237000
PRTTIME  STM   @14,@12,@SA00029                                    1734 07238000
         MVC   @PC00029(8),0(@01)                                  1734 07239000
* OLDERID2 = NEWERID2;                                             1735 07240000
         L     @04,@PC00001                                        1735 07241000
         L     @15,GDTTR2(,@04)                                    1735 07242000
         MVC   @TS00001(95),NEWERID2(@15)                          1735 07243000
         MVC   OLDERID2(95,@15),@TS00001                           1735 07244000
* NEWID2 = 'LRPT' ;                                                1736 07245000
         MVC   NEWID2(4,@15),@CC01402                              1736 07246000
* IF GDTDBG = NULLPTR                                              1737 07247000
*   THEN;                                                          1737 07248000
         L     @04,GDTDBG(,@04)                                    1737 07249000
         LTR   @04,@04                                             1737 07250000
         BZ    @RT01737                                            1737 07251000
*   ELSE                                                           1739 07252000
*     CALL IDCDB010 (GDTTBL,'LRPT') ;                              1739 07253000
*                                                                  1739 07254000
         L     @04,@PC00001                                        1739 07255000
         ST    @04,@AL00001                                        1739 07256000
         LA    @15,@CC01402                                        1739 07257000
         ST    @15,@AL00001+4                                      1739 07258000
         MVI   @AL00001+4,X'80'                                    1739 07259000
         L     @15,GDTDBG(,@04)                                    1739 07260000
         LA    @01,@AL00001                                        1739 07261000
         BALR  @14,@15                                             1739 07262000
* DCL                                                              1740 07263000
*   TSTID           FIXED(31),     /* SUBSCRIPT OF ID WORD           */ 07264000
*   TSTBIT64        CHAR(8),       /* FOR PASSING TO GEN,S           */ 07265000
*   TST64BIT        CHAR(8),       /* THE 64 BIT TIMESTAMP           */ 07266000
*   TSTDAYS         FIXED(31),     /* NBR FULL DAYS TIMESTAMP        */ 07267000
*   TSTPDAY         FIXED(31),     /* PART OF DAY TIMESTAMP          */ 07268000
* ENDCLSTS CHAR(1);                                                1740 07269000
*                                                                  1740 07270000
@RT01737 DS    0H                                                  1741 07271000
* TST64BIT = TSTBIT64 ;            /* FOR PLS AND GEN,S              */ 07272000
         L     @04,@PC00029+4                                      1741 07273000
         MVC   TST64BIT(8),TSTBIT64(@04)                           1741 07274000
* RESPECIFY (REG2,REG3) RESTRICTED ;                               1742 07275000
* GEN (L    REG2,TST64BIT) ;       /* CAN NOT DO 64 BIT              */ 07276000
         L    REG2,TST64BIT                                             07277000
* GEN (L    REG3,TST64BIT+4) ;     /* OPERATIONS IN PL/S             */ 07278000
         L    REG3,TST64BIT+4                                           07279000
* GEN (SRDL REG2,12) ;             /* SHIFT DOWN TO MICROSEC         */ 07280000
         SRDL REG2,12                                                   07281000
* GEN (SRDL REG2,13) ;             /* DIVIDE DOWN TO DAYS AND        */ 07282000
         SRDL REG2,13                                                   07283000
* GEN (D    REG2,=F'10546875') ;   /* PARTS OF DAYS FOR PLS          */ 07284000
         D    REG2,=F'10546875'                                         07285000
* GEN (ST   REG3,TSTDAYS) ;        /* SAVE NUMBER FULL DAYS          */ 07286000
         ST   REG3,TSTDAYS                                              07287000
* GEN (LR   REG3,REG2) ;           /* CHANGE REMAINDER BACK          */ 07288000
         LR   REG3,REG2                                                 07289000
* GEN (M    REG2,=F'86400') ;      /* TO SECONDS                     */ 07290000
         M    REG2,=F'86400'                                            07291000
* GEN (D    REG2,=F'10546875') ;   /* ( * 86400 / 10546875)          */ 07292000
         D    REG2,=F'10546875'                                         07293000
* GEN (ST   REG3,TSTPDAY) ;        /* SAVE PARTS OF DAYS             */ 07294000
         ST   REG3,TSTPDAY                                              07295000
* RESPECIFY (REG2,REG3) UNRESTRICTED ;                             1753 07296000
* TSTHMS(3) = TSTPDAY//60 ;        /* SAVE SECONDS                   */ 07297000
         L     @04,TSTPDAY                                         1754 07298000
         LA    @15,60                                              1754 07299000
         LR    @00,@04                                             1754 07300000
         SRDA  @00,32                                              1754 07301000
         DR    @00,@15                                             1754 07302000
         STH   @00,TSTHMS+4                                        1754 07303000
* TSTPDAY = TSTPDAY/60 ;                                           1755 07304000
         LR    @00,@04                                             1755 07305000
         SRDA  @00,32                                              1755 07306000
         DR    @00,@15                                             1755 07307000
         ST    @01,TSTPDAY                                         1755 07308000
* TSTHMS(2) = TSTPDAY//60 ;        /* SAVE MINUTES                   */ 07309000
         LR    @02,@01                                             1756 07310000
         SRDA  @02,32                                              1756 07311000
         DR    @02,@15                                             1756 07312000
         STH   @02,TSTHMS+2                                        1756 07313000
* TSTHMS(1) = TSTPDAY/60 ;         /* SAVE HOURS                     */ 07314000
         LR    @02,@01                                             1757 07315000
         SRDA  @02,32                                              1757 07316000
         DR    @02,@15                                             1757 07317000
         STH   @03,TSTHMS                                          1757 07318000
*                                  /* TIME ZERO ON 1/1/1900          */ 07319000
* TSTMDY(3) = (TSTDAYS/1461)*4 ;   /* SAVE YEAR ( - 0,1,2,3)         */ 07320000
         L     @04,TSTDAYS                                         1758 07321000
         LA    @15,1461                                            1758 07322000
         LR    @00,@04                                             1758 07323000
         SRDA  @00,32                                              1758 07324000
         DR    @00,@15                                             1758 07325000
         SLA   @01,2                                               1758 07326000
         STH   @01,TSTMDY+4                                        1758 07327000
* TSTDAYS = TSTDAYS//1461 ;        /* 1461 DAYS PER QUADYEAR         */ 07328000
         LR    @00,@04                                             1759 07329000
         SRDA  @00,32                                              1759 07330000
         DR    @00,@15                                             1759 07331000
         ST    @00,TSTDAYS                                         1759 07332000
* IF TSTDAYS <= 366                                                1760 07333000
*   THEN TSTMDTBL(2) = 29 ;        /* 1ST YEAR OF QUAD = LEAP        */ 07334000
         C     @00,@CF01409                                        1760 07335000
         BH    @RF01760                                            1760 07336000
         MVI   TSTMDTBL+1,X'1D'                                    1761 07337000
*   ELSE TSTMDTBL(2) = 28 ;        /* AND FEB. HAS 28 OR 29          */ 07338000
         B     @RC01760                                            1762 07339000
@RF01760 MVI   TSTMDTBL+1,X'1C'                                    1762 07340000
* IF TSTDAYS >= 366                                                1763 07341000
*   THEN                                                           1763 07342000
@RC01760 L     @04,TSTDAYS                                         1763 07343000
         LA    @15,366                                             1763 07344000
         CR    @04,@15                                             1763 07345000
         BL    @RF01763                                            1763 07346000
*     DO ;                                                         1764 07347000
*       TSTMDY(3) = TSTMDY(3) + 1; /* ADD 1ST LEAP YEAR              */ 07348000
         LA    @14,1                                               1765 07349000
         AH    @14,TSTMDY+4                                        1765 07350000
         STH   @14,TSTMDY+4                                        1765 07351000
*       TSTDAYS = TSTDAYS - 366 ;                                  1766 07352000
         SLR   @04,@15                                             1766 07353000
         ST    @04,TSTDAYS                                         1766 07354000
*     END ;                                                        1767 07355000
* DO WHILE (TSTDAYS > 365) ;                                       1768 07356000
@RF01763 B     @DE01768                                            1768 07357000
@DL01768 DS    0H                                                  1769 07358000
*   TSTMDY(3) = TSTMDY(3) + 1 ;    /* ADD OTHER FULL YEARS           */ 07359000
         LA    @04,1                                               1769 07360000
         AH    @04,TSTMDY+4                                        1769 07361000
         STH   @04,TSTMDY+4                                        1769 07362000
*   TSTDAYS = TSTDAYS - 365 ;                                      1770 07363000
         L     @04,TSTDAYS                                         1770 07364000
         SL    @04,@CF01411                                        1770 07365000
         ST    @04,TSTDAYS                                         1770 07366000
* END ;                                                            1771 07367000
@DE01768 L     @04,TSTDAYS                                         1771 07368000
         C     @04,@CF01411                                        1771 07369000
         BH    @DL01768                                            1771 07370000
* TSTDAYS = TSTDAYS + 1 ;          /* ADJUST (1900 NOT LEAP)         */ 07371000
         LA    @15,1                                               1772 07372000
         ALR   @04,@15                                             1772 07373000
         ST    @04,TSTDAYS                                         1772 07374000
* TSTDAYS = TSTDAYS + 1 ;          /* ADJUST FOR ZERO                */ 07375000
         ALR   @04,@15                                             1773 07376000
         ST    @04,TSTDAYS                                         1773 07377000
* DO MOSLOT = 1 TO 12 WHILE (TSTDAYS > TSTMDTBL(MOSLOT)) ;         1774 07378000
         LR    MOSLOT,@15                                          1774 07379000
@DL01774 L     @04,TSTDAYS                                         1774 07380000
         SLR   @03,@03                                             1774 07381000
         IC    @03,TSTMDTBL-1(MOSLOT)                              1774 07382000
         CR    @04,@03                                             1774 07383000
         BNH   @DC01774                                            1774 07384000
*   TSTDAYS = TSTDAYS - TSTMDTBL(MOSLOT) ;                         1775 07385000
         SLR   @04,@03                                             1775 07386000
         ST    @04,TSTDAYS                                         1775 07387000
* END ;                                                            1776 07388000
         AL    MOSLOT,@CF00222                                     1776 07389000
         C     MOSLOT,@CF00035                                     1776 07390000
         BNH   @DL01774                                            1776 07391000
@DC01774 DS    0H                                                  1777 07392000
* TSTMDY(1) = MOSLOT ;             /* SAVE MONTH                     */ 07393000
         STH   MOSLOT,TSTMDY                                       1777 07394000
* TSTMDY(2) = TSTDAYS ;            /* AND FINALLY SAVE DAY           */ 07395000
*                                                                  1778 07396000
         L     @04,TSTDAYS                                         1778 07397000
         STH   @04,TSTMDY+2                                        1778 07398000
* DARGLIST = '0'B ;                /* SET UP TO PRINT IT             */ 07399000
         L     @04,DDSTRU                                          1779 07400000
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  1779 07401000
         MVI   DARGLIST(@04),B'00000000'                           1779 07402000
* DARGSMOD = 'LR0' ;                                               1780 07403000
         MVC   DARGSMOD(3,@04),@CC01335                            1780 07404000
* DARGSENT = 5 ;                                                   1781 07405000
         MVI   DARGSENT(@04),X'05'                                 1781 07406000
* DARGCNT = 7 ;                                                    1782 07407000
         MVC   DARGCNT(2,@04),@CH00040                             1782 07408000
* DARGINS(1) = 1 ;                                                 1783 07409000
         MVC   DARGINS(2,@04),@CH00222                             1783 07410000
* DARGINL(1) = 10 ;                                                1784 07411000
         LA    @15,10                                              1784 07412000
         STH   @15,DARGINL(,@04)                                   1784 07413000
* DARGDTM(1) = ADDR(TSTDESC(TSTID)) ;                              1785 07414000
         L     @14,@PC00029                                        1785 07415000
         ST    @14,@TF00001                                        1785 07416000
         L     @01,@TF00001                                        1785 07417000
         M     @14,TSTID(,@01)                                     1785 07418000
         LA    @15,TSTDESC-10(@15)                                 1785 07419000
         ST    @15,DARGDTM(,@04)                                   1785 07420000
* DO TSTSLOT = 2 TO 4 ;                                            1786 07421000
         LA    TSTSLOT,2                                           1786 07422000
@DL01786 DS    0H                                                  1787 07423000
*   DARGINS(TSTSLOT) = TSTSLOT ;                                   1787 07424000
         L     @04,DDSTRU                                          1787 07425000
         LR    @03,TSTSLOT                                         1787 07426000
         SLA   @03,3                                               1787 07427000
         STH   TSTSLOT,DARGINS-8(@03,@04)                          1787 07428000
*   DARGINL(TSTSLOT) = LENGTH(TSTMDY(TSTSLOT-1)) ;                 1788 07429000
         LA    @15,2                                               1788 07430000
         STH   @15,DARGINL-8(@03,@04)                              1788 07431000
*   DARGDTM(TSTSLOT) = ADDR(TSTMDY(TSTSLOT-1)) ;                   1789 07432000
         LR    @15,TSTSLOT                                         1789 07433000
         ALR   @15,@15                                             1789 07434000
         LA    @15,TSTMDY-4(@15)                                   1789 07435000
         ST    @15,DARGDTM-8(@03,@04)                              1789 07436000
* END ;                                                            1790 07437000
         AL    TSTSLOT,@CF00222                                    1790 07438000
         C     TSTSLOT,@CF00047                                    1790 07439000
         BNH   @DL01786                                            1790 07440000
* DO TSTSLOT = 5 TO 7 ;                                            1791 07441000
         LA    TSTSLOT,5                                           1791 07442000
@DL01791 DS    0H                                                  1792 07443000
*   DARGINS(TSTSLOT) = TSTSLOT ;                                   1792 07444000
         L     @04,DDSTRU                                          1792 07445000
         LR    @03,TSTSLOT                                         1792 07446000
         SLA   @03,3                                               1792 07447000
         STH   TSTSLOT,DARGINS-8(@03,@04)                          1792 07448000
*   DARGINL(TSTSLOT) = LENGTH(TSTHMS(TSTSLOT-4)) ;                 1793 07449000
         LA    @15,2                                               1793 07450000
         STH   @15,DARGINL-8(@03,@04)                              1793 07451000
*   DARGDTM(TSTSLOT) = ADDR(TSTHMS(TSTSLOT-4)) ;                   1794 07452000
         LR    @15,TSTSLOT                                         1794 07453000
         ALR   @15,@15                                             1794 07454000
         LA    @15,TSTHMS-10(@15)                                  1794 07455000
         ST    @15,DARGDTM-8(@03,@04)                              1794 07456000
* END ;                                                            1795 07457000
*                                                                  1795 07458000
         AL    TSTSLOT,@CF00222                                    1795 07459000
         C     TSTSLOT,@CF00040                                    1795 07460000
         BNH   @DL01791                                            1795 07461000
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1796 07462000
*                                                                  1796 07463000
         L     @04,@PC00001                                        1796 07464000
         ST    @04,@AL00001                                        1796 07465000
         LA    @15,IOCSPRT                                         1796 07466000
         ST    @15,@AL00001+4                                      1796 07467000
         LA    @15,DDSTRU                                          1796 07468000
         ST    @15,@AL00001+8                                      1796 07469000
         MVI   @AL00001+8,X'80'                                    1796 07470000
         L     @15,GDTPRT(,@04)                                    1796 07471000
         LA    @01,@AL00001                                        1796 07472000
         BALR  @14,@15                                             1796 07473000
*END PRTTIME ;                                                     1797 07474000
@EL00029 DS    0H                                                  1797 07475000
@EF00029 DS    0H                                                  1797 07476000
@ER00029 LM    @14,@12,@SA00029                                    1797 07477000
         BR    @14                                                 1797 07478000
* /*******************************************************************/ 07479000
* /* PROCEDURE NAME - PRTVOL, PRINT VOLUME RECORD                    */ 07480000
* /* FUNCTION -                                                      */ 07481000
* /*   IF COMPARE, PASS TWICE THRU THE FOLLOWING, FIRST WITH         */ 07482000
* /*   NO PRINTING LOOKING FOR ANY MISCOMPARE, SECOND TIME           */ 07483000
* /*   PRINTING,                                                     */ 07484000
* /*     FOR THE CRA COPY OF THE VOLUME RECORD (CI=9),               */ 07485000
* /*     LOOP THRU HORIZONTAL EXTENSIONS,                            */ 07486000
* /*       GET THE RECORD(S) PRINTING AS SPECIFIED,                  */ 07487000
* /*       CALL VERTEXT TO HANDLE ALL VERTICAL EXTENSIONS,           */ 07488000
* /*     IF CMPR SPECIFIED AND THERE WAS A MISCOMPARE NOTE           */ 07489000
* /*     NAMES OF THE SIGNIFICANT FIELDS THAT MISCOMPARED,           */ 07490000
* /*     BUMP COUNTS OF ENTRIES PROCESSED AND MISCOMPARED,           */ 07491000
* /*   GET THE F4DSCB AND PRINT ALL TIMESTAMPS,                      */ 07492000
* /* INPUTS -                                                        */ 07493000
* /* OUTPUTS -                                                       */ 07494000
* /*   LIST OF VOLUME RECORDS AS REQUESTED                           */ 07495000
* /*   MCENTCNT (MISCOMPARE ENTRY COUNT)                             */ 07496000
* /* CALLS -                                                         */ 07497000
* /*   GETPRT, VERTEXT, PRTMCWD, UIOINFO, ERROR, PRTMCD,             */ 07498000
* /*   SUMIT,                                                        */ 07499000
* /*   IDCRC04(VOLTSTMP)                                             */ 07500000
* /*******************************************************************/ 07501000
*                                                                  1798 07502000
*PRTVOL: PROCEDURE ;                                               1798 07503000
PRTVOL   STM   @14,@12,@SA00030                                    1798 07504000
* IF GDTDBG = NULLPTR                                              1799 07505000
*   THEN;                                                          1799 07506000
         L     @15,@PC00001                                        1799 07507000
         L     @15,GDTDBG(,@15)                                    1799 07508000
         LTR   @15,@15                                             1799 07509000
         BZ    @RT01799                                            1799 07510000
*   ELSE                                                           1801 07511000
*     CALL IDCDB010 (GDTTBL,'LRPW') ;                              1801 07512000
         L     @15,@PC00001                                        1801 07513000
         ST    @15,@AL00001                                        1801 07514000
         LA    @14,@CC01415                                        1801 07515000
         ST    @14,@AL00001+4                                      1801 07516000
         MVI   @AL00001+4,X'80'                                    1801 07517000
         L     @15,GDTDBG(,@15)                                    1801 07518000
         LA    @01,@AL00001                                        1801 07519000
         BALR  @14,@15                                             1801 07520000
* OLDERID2 = NEWERID2;                                             1802 07521000
@RT01799 L     @15,@PC00001                                        1802 07522000
         L     @15,GDTTR2(,@15)                                    1802 07523000
         MVC   @TS00001(95),NEWERID2(@15)                          1802 07524000
         MVC   OLDERID2(95,@15),@TS00001                           1802 07525000
* NEWID2 = 'LRPW' ;                                                1803 07526000
*                                                                  1803 07527000
         MVC   NEWID2(4,@15),@CC01415                              1803 07528000
* CALL SUMIT (SMACCUM,CATRCTYP($VOL)) ;     /* ADD VOLUME TO         */ 07529000
         LA    @15,SMACCUM                                         1804 07530000
         ST    @15,@AL00001                                        1804 07531000
         SLR   @15,@15                                             1804 07532000
         IC    @15,$VOL                                            1804 07533000
         MH    @15,@CH00042                                        1804 07534000
         LA    @15,CATRCTYP-5(@15)                                 1804 07535000
         ST    @15,@AL00001+4                                      1804 07536000
         LA    @01,@AL00001                                        1804 07537000
         BAL   @14,SUMIT                                           1804 07538000
*                             /* ENTRIES PROCESED COUNT TABLE        */ 07539000
* CMPRPASW = OFF ;            /* SET UP CONTROL SWITCHES             */ 07540000
         NI    CMPRPASW,B'01111111'                                1805 07541000
* PRNTPASW = OFF ;            /* MAKING A COMPARE PASS THRU          */ 07542000
         NI    PRNTPASW,B'01111111'                                1806 07543000
* IF CMPRSW = ON              /* LOGIC BEFORE THE ACTUAL             */ 07544000
*   THEN CMPRPASW = ON ;      /* PRINTING PASS IF COMPARE            */ 07545000
         TM    CMPRSW,B'01000000'                                  1807 07546000
         BNO   @RF01807                                            1807 07547000
         OI    CMPRPASW,B'10000000'                                1808 07548000
*   ELSE PRNTPASW = ON ;                                           1809 07549000
         B     @RC01807                                            1809 07550000
@RF01807 OI    PRNTPASW,B'10000000'                                1809 07551000
* BASETYPE = CATRCTYP($VOL) ;                                      1810 07552000
@RC01807 SLR   @15,@15                                             1810 07553000
         IC    @15,$VOL                                            1810 07554000
         MH    @15,@CH00042                                        1810 07555000
         LA    @14,CATRCTYP-5(@15)                                 1810 07556000
         MVC   BASETYPE(1),0(@14)                                  1810 07557000
* CIBASE = CTTBASE + 1 ;           /* FIXED CI LOCA OF VOL RC        */ 07558000
         MVC   CIBASE(3),@CF00038+1                                1811 07559000
* MSCMPRSW = OFF ;                                                 1812 07560000
*                                                                  1812 07561000
         NI    MSCMPRSW,B'11110111'                                1812 07562000
* /*******************************************************************/ 07563000
* /* PASS THRU TWICE IF COMPARE SO ONLY MISCOMPARES                  */ 07564000
* /* WILL PRINT                                                      */ 07565000
* /*******************************************************************/ 07566000
*                                                                  1813 07567000
* DO WHILE (CMPRPASW = ON | PRNTPASW = ON) ;                       1813 07568000
         B     @DE01813                                            1813 07569000
@DL01813 DS    0H                                                  1814 07570000
*   CIFRGET = CIBASE ;                                             1814 07571000
*                                                                  1814 07572000
         MVC   CIFRGET(3),CIBASE                                   1814 07573000
*   /*****************************************************************/ 07574000
*   /* LOOP: THRU ALL HORIZONTAL EXTENSION RECORDS (IF ANY)          */ 07575000
*   /*****************************************************************/ 07576000
*                                                                  1815 07577000
*   DO WHILE ((CIFRGET ^= '0'B)         /* NO MORE HORIZ EXTNS       */ 07578000
*         & (^(CMPRPASW = ON            /* QUIT AFTER FIRST          */ 07579000
*              & MSCMPRSW = ON))) ;     /* MISCOMPARE ALSO           */ 07580000
*                                                                  1815 07581000
         B     @DE01815                                            1815 07582000
@DL01815 DS    0H                                                  1816 07583000
*     CALL GETPRT ;                /* GET (PRINT) BASE RECORD        */ 07584000
*                                                                  1816 07585000
         BAL   @14,GETPRT                                          1816 07586000
*     IF    (PRNTPASW = ON & DUMPSW = OFF)                         1817 07587000
*        | (CMPRPASW = ON & MSCMPRSW = ON)                         1817 07588000
*       THEN CIFRGET = '0'B ;      /* OR GET OUT OF THIS LOOP        */ 07589000
*                                                                  1817 07590000
         TM    PRNTPASW,B'10000000'                                1817 07591000
         BNO   @GL00088                                            1817 07592000
         TM    DUMPSW,B'00000100'                                  1817 07593000
         BZ    @RT01817                                            1817 07594000
@GL00088 TM    CMPRPASW,B'10000000'                                1817 07595000
         BNO   @RF01817                                            1817 07596000
         TM    MSCMPRSW,B'00001000'                                1817 07597000
         BNO   @RF01817                                            1817 07598000
@RT01817 DS    0H                                                  1818 07599000
         SLR   @15,@15                                             1818 07600000
         STCM  @15,7,CIFRGET                                       1818 07601000
*       ELSE CALL VERTEXT ;        /* DO VERTICAL EXTENSIONS         */ 07602000
*                                                                  1819 07603000
         B     @RC01817                                            1819 07604000
@RF01817 BAL   @14,VERTEXT                                         1819 07605000
*   END ;                                                          1820 07606000
@RC01817 DS    0H                                                  1820 07607000
@DE01815 L     @15,CIFRGET-1                                       1820 07608000
         LA    @15,0(,@15)                                         1820 07609000
         LTR   @15,@15                                             1820 07610000
         BZ    @DC01815                                            1820 07611000
         TM    CMPRPASW,B'10000000'                                1820 07612000
         BNO   @DL01815                                            1820 07613000
         TM    MSCMPRSW,B'00001000'                                1820 07614000
         BNO   @DL01815                                            1820 07615000
@DC01815 DS    0H                                                  1821 07616000
*   CIFRGET = CIBASE ;                                             1821 07617000
         MVC   CIFRGET(3),CIBASE                                   1821 07618000
*   IF     PRNTPASW = ON                                           1822 07619000
*      & CMPRSW = ON                                               1822 07620000
*                                                                  1822 07621000
*     THEN CALL PRTMCWD(2,         /* NOTE LEVEL OF MISCMPR          */ 07622000
         TM    PRNTPASW,B'10000000'                                1822 07623000
         BNO   @RF01822                                            1822 07624000
         TM    CMPRSW,B'01000000'                                  1822 07625000
         BNO   @RF01822                                            1822 07626000
*                       MCARGTBV,MCMSGTBV,MCMLNTBV) ;              1823 07627000
*                                                                  1823 07628000
         LA    @01,@AL01823                                        1823 07629000
         BAL   @14,PRTMCWD                                         1823 07630000
*   PRNTPASW = OFF ;               /* TURN OFF AFTER PRINTING        */ 07631000
@RF01822 NI    PRNTPASW,B'01111111'                                1824 07632000
*   IF CMPRPASW = ON & MSCMPRSW = ON                               1825 07633000
*     THEN                         /* MISCOMPARE FOUND SO            */ 07634000
         TM    CMPRPASW,B'10000000'                                1825 07635000
         BNO   @RF01825                                            1825 07636000
         TM    MSCMPRSW,B'00001000'                                1825 07637000
         BNO   @RF01825                                            1825 07638000
*       DO ;                                                       1826 07639000
*         PRNTPASW = ON ;          /* PASS THRU AGAIN PRINTIN        */ 07640000
         OI    PRNTPASW,B'10000000'                                1827 07641000
*         MCENTCNT = MCENTCNT + 1 ;                                1828 07642000
         LH    @01,MCENTCNT                                        1828 07643000
         LA    @01,1(,@01)                                         1828 07644000
         STH   @01,MCENTCNT                                        1828 07645000
*       END ;                                                      1829 07646000
*   CMPRPASW = OFF ;                                               1830 07647000
@RF01825 NI    CMPRPASW,B'01111111'                                1830 07648000
* END ;                                                            1831 07649000
@DE01813 TM    CMPRPASW,B'10000000'                                1831 07650000
         BO    @DL01813                                            1831 07651000
         TM    PRNTPASW,B'10000000'                                1831 07652000
         BO    @DL01813                                            1831 07653000
* FMPLFLNO = 1 ;                                                   1832 07654000
         L     @15,FMPLAD                                          1832 07655000
         MVI   FMPLFLNO(@15),X'01'                                 1832 07656000
* FMFLDNAM = ADDR('VOLTSTMP') ;    /* SET UP FIELD MGMT              */ 07657000
         LA    @14,@CC01416                                        1833 07658000
         ST    @14,FMFLDNAM(,FMFLCUR)                              1833 07659000
* FMPLBCIN = CTTCATCI(1) ;                                         1834 07660000
         L     @14,CTTPTR                                          1834 07661000
         MVC   FMPLBCIN(3,@15),CTTCATCI(@14)                       1834 07662000
* IF CMPRSW = ON                                                   1835 07663000
*   THEN                                                           1835 07664000
         TM    CMPRSW,B'01000000'                                  1835 07665000
         BNO   @RF01835                                            1835 07666000
*     DO ;                                                         1836 07667000
*       FMUBFPTR = IOCTBPTR ;      /* TELL WANT CATALOG FIELD        */ 07668000
         L     @14,IOCTBPTR                                        1837 07669000
         ST    @14,FMUBFPTR                                        1837 07670000
*       FMUIOCSI = IOCSCAT ;                                       1838 07671000
         L     @14,IOCSCAT                                         1838 07672000
         ST    @14,FMUIOCSI                                        1838 07673000
*       FMUCATIO = ON ;                                            1839 07674000
         OI    FMUCATIO,B'01000000'                                1839 07675000
*       REG1 = FMPLAD ;                                            1840 07676000
*                                                                  1840 07677000
         LR    REG1,@15                                            1840 07678000
*       CALL IDCRC04 ;             /* ASK VOL RECORD TIMSTMP         */ 07679000
*                                                                  1841 07680000
         L     @15,@CV00793                                        1841 07681000
         BALR  @14,@15                                             1841 07682000
*       FMUBFPTR = IOCRBPTR ;      /* SET BACK TO ASSUMED VLU        */ 07683000
         L     @15,IOCRBPTR                                        1842 07684000
         ST    @15,FMUBFPTR                                        1842 07685000
*       FMUIOCSI = IOCSCRA ;                                       1843 07686000
         L     @15,IOCSCRA                                         1843 07687000
         ST    @15,FMUIOCSI                                        1843 07688000
*       FMUCATIO = OFF ;                                           1844 07689000
         NI    FMUCATIO,B'10111111'                                1844 07690000
*       IF FMFLENTH ^= 0                                           1845 07691000
*         THEN CALL PRTTIME (1,VOLTSTMP) ;   /* CATVOLRCD            */ 07692000
         L     @15,FMFLENTH(,FMFLCUR)                              1845 07693000
         LTR   @15,@15                                             1845 07694000
         BZ    @RF01845                                            1845 07695000
         LA    @15,@CF00222                                        1846 07696000
         ST    @15,@AL00001                                        1846 07697000
         L     @01,FMFLADDR(,FMFLCUR)                              1846 07698000
         ST    @01,@AL00001+4                                      1846 07699000
         LA    @01,@AL00001                                        1846 07700000
         BAL   @14,PRTTIME                                         1846 07701000
*         ELSE                                                     1847 07702000
*             DO;                                          /*@OZ09388*/ 07703000
         B     @RC01845                                            1847 07704000
@RF01845 DS    0H                                                  1848 07705000
*               PROCMSG='PRTVOL  '; /* PROC NAME FOR MESSAGE @OZ09388*/ 07706000
         MVC   PROCMSG(8),@CC01417                                 1848 07707000
*               CALL ERROR (22,$RETURN);                   /*@OZ09388*/ 07708000
         LA    @01,@AL01849                                        1849 07709000
         BAL   @14,ERROR                                           1849 07710000
*             END;                                         /*@OZ09388*/ 07711000
*     END ;                                                        1851 07712000
@RC01845 DS    0H                                                  1852 07713000
* REG1 = FMPLAD ;                                                  1852 07714000
*                                                                  1852 07715000
@RF01835 L     REG1,FMPLAD                                         1852 07716000
* CALL IDCRC04 ;                   /* ASK VOL RECORD TIMSTMP         */ 07717000
*                                                                  1853 07718000
         L     @15,@CV00793                                        1853 07719000
         BALR  @14,@15                                             1853 07720000
* IF FMFLENTH ^= 0                                                 1854 07721000
*   THEN CALL PRTTIME (2,VOLTSTMP) ;         /* CRAVOLRCD            */ 07722000
         L     @15,FMFLENTH(,FMFLCUR)                              1854 07723000
         LTR   @15,@15                                             1854 07724000
         BZ    @RF01854                                            1854 07725000
         LA    @15,@CF00158                                        1855 07726000
         ST    @15,@AL00001                                        1855 07727000
         L     @01,FMFLADDR(,FMFLCUR)                              1855 07728000
         ST    @01,@AL00001+4                                      1855 07729000
         LA    @01,@AL00001                                        1855 07730000
         BAL   @14,PRTTIME                                         1855 07731000
*   ELSE                                                           1856 07732000
*       DO;                                                /*@OZ09388*/ 07733000
         B     @RC01854                                            1856 07734000
@RF01854 DS    0H                                                  1857 07735000
*          PROCMSG='PRTVOL  '; /* PROC NAME FOR MESSAGE      @OZ09388*/ 07736000
         MVC   PROCMSG(8),@CC01417                                 1857 07737000
*          CALL ERROR (23,$RETURN);                        /*@OZ09388*/ 07738000
         LA    @01,@AL01858                                        1858 07739000
         BAL   @14,ERROR                                           1858 07740000
*       END;                                               /*@OZ09388*/ 07741000
*                                  /* GET F4DSCB TIMESTAMPS          */ 07742000
* CALL IDCIOSI0 (GDTTBL,IOINBYTE,TSTPTR,IFILEVAL(CRACNT)) ;        1860 07743000
*                                                                  1860 07744000
@RC01854 L     @15,@PC00001                                        1860 07745000
         ST    @15,@AL00001                                        1860 07746000
         LA    @14,IOINBYTE                                        1860 07747000
         ST    @14,@AL00001+4                                      1860 07748000
         LA    @14,TSTPTR                                          1860 07749000
         ST    @14,@AL00001+8                                      1860 07750000
         L     @14,CRACNT-1                                        1860 07751000
         LA    @14,0(,@14)                                         1860 07752000
         MH    @14,@CH00037                                        1860 07753000
         L     @03,@PC00001+4                                      1860 07754000
         L     @01,FDTPTR(,@03)                                    1860 07755000
         AL    @01,@CF01473                                        1860 07756000
         LA    @14,IFILEVAL-3(@14,@01)                             1860 07757000
         ST    @14,@AL00001+12                                     1860 07758000
         MVI   @AL00001+12,X'80'                                   1860 07759000
         L     @15,GDTIFO(,@15)                                    1860 07760000
         LA    @01,@AL00001                                        1860 07761000
         BALR  @14,@15                                             1860 07762000
* RESPECIFY RTNREG RSTD;                                           1861 07763000
* TESTRC = RTNREG;                                                 1862 07764000
         STH   RTNREG,TESTRC                                       1862 07765000
* RESPECIFY RTNREG UNRSTD ;                                        1863 07766000
* IF TESTRC = 0                                                    1864 07767000
*   THEN                                                           1864 07768000
         LH    @15,TESTRC                                          1864 07769000
         LTR   @15,@15                                             1864 07770000
         BNZ   @RF01864                                            1864 07771000
*     DO ;                                                         1865 07772000
*       CALL PRTTIME (3,F4TSTVSM) ;          /* F4DSCBVSAM           */ 07773000
         LA    @15,@CF00166                                        1866 07774000
         ST    @15,@AL00001                                        1866 07775000
         LA    @15,F4TSTVSM                                        1866 07776000
         ST    @15,@AL00001+4                                      1866 07777000
         LA    @01,@AL00001                                        1866 07778000
         BAL   @14,PRTTIME                                         1866 07779000
*       CALL PRTTIME (4,F4TSTDMP) ;          /* F4DSCBDUMP           */ 07780000
         LA    @15,@CF00047                                        1867 07781000
         ST    @15,@AL00001                                        1867 07782000
         LA    @15,F4TSTDMP                                        1867 07783000
         ST    @15,@AL00001+4                                      1867 07784000
         LA    @01,@AL00001                                        1867 07785000
         BAL   @14,PRTTIME                                         1867 07786000
*     END ;                                                        1868 07787000
*   ELSE CALL ERROR (24,$RETURN) ;                                 1869 07788000
*                                                                  1869 07789000
         B     @RC01864                                            1869 07790000
@RF01864 LA    @01,@AL01869                                        1869 07791000
         BAL   @14,ERROR                                           1869 07792000
*END PRTVOL ;                                                      1870 07793000
@EL00030 DS    0H                                                  1870 07794000
@EF00030 DS    0H                                                  1870 07795000
@ER00030 LM    @14,@12,@SA00030                                    1870 07796000
         BR    @14                                                 1870 07797000
* /*******************************************************************/ 07798000
* /* PROCEDURE NAME - PRTVSAM, PRINT VSAM STRUCTURES                 */ 07799000
* /* FUNCTION -                                                      */ 07800000
* /*   IF COMPARE, PASS TWICE THRU THE FOLLOWING, FIRST              */ 07801000
* /*   WITH NO PRINTING LOOKING FOR ANY MISCOMPARE,                  */ 07802000
* /*   SECOND TIME PRINTING IF THERE WAS ONE,                        */ 07803000
* /*     LOOP THRU ASSOCTBL (PRINT ALL EXCEPT :                      */ 07804000
* /*     (FOR BASE CLUSTER,S AIX ASSOCIATIONS - NAME ONLY),          */ 07805000
* /*     (FOR BASE AIX,S CLUSTER ASSOCIATION - IGNORE)),             */ 07806000
* /*       LOOP THRU HORIZONTAL EXTENSIONS,                          */ 07807000
* /*         GET THE RECORD(S), PRINTING AS SPECIFIED, AND           */ 07808000
* /*         FIRST TIME INITIALIZE THE ASSOCTBL,                     */ 07809000
* /*         CALL VERTEXT TO HANDLE ANY VERTICAL EXTENSIONS          */ 07810000
* /*       IF DATA RECORD ADD UPGRADE TO ASSOCTBL (IF 1),            */ 07811000
* /*       IF COMPARE AND DATA OR INDEX, NOTE THE NAMES OF           */ 07812000
* /*       SIGNIFICANT ITEMS THAT MISCOMPARED,                       */ 07813000
* /*       IF BASE CLUSTER,S AIX ASSOCIATION CALL PRTAAXV TO         */ 07814000
* /*       ADD AIX,S VOLUMES FOR REFERENCE,                          */ 07815000
* /*       BUMP COUNTS OF NUMBER OF ENTRIES AND MISCOMPARES          */ 07816000
* /* INPUTS -                                                        */ 07817000
* /*   SORTTBL ENTRY IDENTIFIED BY STSLOT                            */ 07818000
* /* OUTPUTS -                                                       */ 07819000
* /*   LISTING OF VSAM STRUCTURES AS REQUESTED                       */ 07820000
* /*   MCENTCNT (MISCOMPARE ENTRIES COUNT)                           */ 07821000
* /* CALLS -                                                         */ 07822000
* /*   GETPRT, INTASOC, VERTEXT, PRTMCWD, PRTAAXV, ADDASOC,          */ 07823000
* /*   SUMIT                                                         */ 07824000
* /*******************************************************************/ 07825000
*                                                                  1871 07826000
* PRTVSAM: PROCEDURE ;                                             1871 07827000
PRTVSAM  STM   @14,@12,@SA00031                                    1871 07828000
*   OLDERID2 = NEWERID2;                                           1872 07829000
         L     @02,@PC00001                                        1872 07830000
         L     @15,GDTTR2(,@02)                                    1872 07831000
         MVC   @TS00001(95),NEWERID2(@15)                          1872 07832000
         MVC   OLDERID2(95,@15),@TS00001                           1872 07833000
*   NEWID2 = 'LRPV' ;                                              1873 07834000
         MVC   NEWID2(4,@15),@CC01421                              1873 07835000
*   IF GDTDBG = NULLPTR                                            1874 07836000
*     THEN;                                                        1874 07837000
         L     @02,GDTDBG(,@02)                                    1874 07838000
         LTR   @02,@02                                             1874 07839000
         BZ    @RT01874                                            1874 07840000
*     ELSE                                                         1876 07841000
*       CALL IDCDB010 (GDTTBL,'LRPV') ;                            1876 07842000
*                                                                  1876 07843000
         L     @02,@PC00001                                        1876 07844000
         ST    @02,@AL00001                                        1876 07845000
         LA    @15,@CC01421                                        1876 07846000
         ST    @15,@AL00001+4                                      1876 07847000
         MVI   @AL00001+4,X'80'                                    1876 07848000
         L     @15,GDTDBG(,@02)                                    1876 07849000
         LA    @01,@AL00001                                        1876 07850000
         BALR  @14,@15                                             1876 07851000
*   CMPRPASW = OFF ;               /* SET CONTROL SWITCHES           */ 07852000
@RT01874 NI    CMPRPASW,B'01111111'                                1877 07853000
*   PRNTPASW = OFF ;               /* FOR ONE ONLY OR                */ 07854000
         NI    PRNTPASW,B'01111111'                                1878 07855000
*   IF CMPRSW = ON                 /* (IF COMPARE) POSSIBLE          */ 07856000
*     THEN                         /* TWO PASSES THRU LOGIC,         */ 07857000
         TM    CMPRSW,B'01000000'                                  1879 07858000
         BNO   @RF01879                                            1879 07859000
*       CMPRPASW = ON ;            /* 1 - LOOK FOR MISCOMPARE        */ 07860000
         OI    CMPRPASW,B'10000000'                                1880 07861000
*     ELSE                         /* 2 - PRINT IF MISCOMPARE        */ 07862000
*       PRNTPASW = ON ;            /* WAS FOUND                      */ 07863000
         B     @RC01879                                            1881 07864000
@RF01879 OI    PRNTPASW,B'10000000'                                1881 07865000
*   MSCMPRSW = OFF ;                                               1882 07866000
@RC01879 NI    MSCMPRSW,B'11110111'                                1882 07867000
*   ENTNOCUR = 0 ;                 /* FOR COUNTING ENTRIES           */ 07868000
         SLR   @02,@02                                             1883 07869000
         STH   @02,ENTNOCUR                                        1883 07870000
*   ENTNOSAV = 0 ;                                                 1884 07871000
*                                                                  1884 07872000
         STH   @02,ENTNOSAV                                        1884 07873000
*   /*****************************************************************/ 07874000
*   /* PASS THRU TWICE IF COMPARE SO ONLY THE MISCOMPARES            */ 07875000
*   /* WILL PRINT                                                    */ 07876000
*   /*****************************************************************/ 07877000
*                                                                  1885 07878000
*   DO WHILE (CMPRPASW = ON | PRNTPASW = ON) ;                     1885 07879000
         B     @DE01885                                            1885 07880000
@DL01885 DS    0H                                                  1886 07881000
*     FRSTIMSW = YES ;                                             1886 07882000
         OI    FRSTIMSW,B'00000010'                                1886 07883000
*     INDNTCOL = 0 ;                                               1887 07884000
         MVI   INDNTCOL,X'00'                                      1887 07885000
*     ATCRACI(1) = STCRACI(STSLOT);/* STO BASE CI AS 1ST ASOC        */ 07886000
         L     @02,ATRA2PTR                                        1888 07887000
         LR    @15,STSLOT                                          1888 07888000
         MH    @15,@CH01068                                        1888 07889000
         L     @01,STPTR                                           1888 07890000
         ALR   @01,@15                                             1888 07891000
         AL    @01,@CF01477                                        1888 07892000
         MVC   ATCRACI(3,@02),STCRACI-45(@01)                      1888 07893000
*     ATENTYP(1) = '0'B ;          /* WITH UNKNOWN TYPES FOR         */ 07894000
         MVI   ATENTYP(@02),B'00000000'                            1889 07895000
*     BASETYPE = '0'B ;            /* ASSOCTBL INITILIZE             */ 07896000
*                                                                  1890 07897000
         MVI   BASETYPE,B'00000000'                                1890 07898000
*     /***************************************************************/ 07899000
*     /* LOOP: THRU ALL ENTRIES IN THE ASSOCTBL INCLUDING            */ 07900000
*     /*       THE FIRST DUMMY ONE (CLUS OR AIX) FOR GETTING         */ 07901000
*     /*       STARTED                                               */ 07902000
*     /***************************************************************/ 07903000
*                                                                  1891 07904000
*     DO ATSLOT = 1 TO NBRATS                                      1891 07905000
*        WHILE (ATCRACI(ATSLOT) ^= '0'B                            1891 07906000
*           & LASTATSW ^= ON                                       1891 07907000
*           & ^(CMPRPASW = ON                                      1891 07908000
*               & MSCMPRSW = ON)) ;                                1891 07909000
         LA    ATSLOT,1                                            1891 07910000
@DL01891 LR    @15,ATSLOT                                          1891 07911000
         SLA   @15,2                                               1891 07912000
         L     @01,ATRA2PTR                                        1891 07913000
         L     @15,ATCRACI-5(@15,@01)                              1891 07914000
         LA    @15,0(,@15)                                         1891 07915000
         LTR   @15,@15                                             1891 07916000
         BZ    @DC01891                                            1891 07917000
         TM    LASTATSW,B'00100000'                                1891 07918000
         BO    @DC01891                                            1891 07919000
         TM    CMPRPASW,B'10000000'                                1891 07920000
         BNO   @DB01891                                            1891 07921000
         TM    MSCMPRSW,B'00001000'                                1891 07922000
         BO    @DC01891                                            1891 07923000
@DB01891 DS    0H                                                  1892 07924000
*       SAVESW1 = OFF ;                                            1892 07925000
         NI    SAVESW1,B'11011111'                                 1892 07926000
*       IF DUMPSW = ON             /* SAVE DUMP SWITCH FOR           */ 07927000
*         THEN SAVESW = ON ;       /* MAY BE TEMP USED BELOW         */ 07928000
         TM    DUMPSW,B'00000100'                                  1893 07929000
         BNO   @RF01893                                            1893 07930000
         OI    SAVESW,B'01000000'                                  1894 07931000
*       ASOCTYP = ATENTYP(ATSLOT) ;                                1895 07932000
@RF01893 LR    @15,ATSLOT                                          1895 07933000
         SLA   @15,2                                               1895 07934000
         L     @01,ATRA2PTR                                        1895 07935000
         ALR   @01,@15                                             1895 07936000
         MVC   ASOCTYP(1),ATENTYP-4(@01)                           1895 07937000
*       IF    (BASETYPE = CATRCTYP($CLUS)    /* IF                   */ 07938000
*          & ASOCTYP = CATRCTYP($AIX))       /* REFERENCE            */ 07939000
*          | (BASETYPE = CATRCTYP($AIX)      /* ONLY                 */ 07940000
*          & ASOCTYP = CATRCTYP($CLUS))      /* PRINTING             */ 07941000
*         THEN                                                     1896 07942000
         LA    @15,5                                               1896 07943000
         SLR   @01,@01                                             1896 07944000
         IC    @01,$CLUS                                           1896 07945000
         MR    @00,@15                                             1896 07946000
         LA    @14,CATRCTYP-5(@01)                                 1896 07947000
         CLC   BASETYPE(1),0(@14)                                  1896 07948000
         BNE   @GL00099                                            1896 07949000
         SLR   @01,@01                                             1896 07950000
         IC    @01,$AIX                                            1896 07951000
         MR    @14,@01                                             1896 07952000
         LA    @14,CATRCTYP-5(@15)                                 1896 07953000
         CLC   ASOCTYP(1),0(@14)                                   1896 07954000
         BE    @RT01896                                            1896 07955000
@GL00099 LA    @15,5                                               1896 07956000
         SLR   @01,@01                                             1896 07957000
         IC    @01,$AIX                                            1896 07958000
         MR    @00,@15                                             1896 07959000
         LA    @14,CATRCTYP-5(@01)                                 1896 07960000
         CLC   BASETYPE(1),0(@14)                                  1896 07961000
         BNE   @RF01896                                            1896 07962000
         SLR   @01,@01                                             1896 07963000
         IC    @01,$CLUS                                           1896 07964000
         MR    @14,@01                                             1896 07965000
         LA    @14,CATRCTYP-5(@15)                                 1896 07966000
         CLC   ASOCTYP(1),0(@14)                                   1896 07967000
         BNE   @RF01896                                            1896 07968000
@RT01896 DS    0H                                                  1897 07969000
*           DO ;                                                   1897 07970000
*             DUMPSW = OFF ;       /* DO NOT DUMP PRINT              */ 07971000
         NI    DUMPSW,B'11111011'                                  1898 07972000
*             NOCNTSW = ON ;       /* OR COUNT THESE ENTRIES         */ 07973000
         OI    NOCNTSW,B'00000001'                                 1899 07974000
*           END ;                                                  1900 07975000
*       CIBASE = ATCRACI(ATSLOT) ;                                 1901 07976000
@RF01896 LR    @15,ATSLOT                                          1901 07977000
         SLA   @15,2                                               1901 07978000
         L     @01,ATRA2PTR                                        1901 07979000
         ALR   @01,@15                                             1901 07980000
         MVC   CIBASE(3),ATCRACI-4(@01)                            1901 07981000
*       CIFRGET = CIBASE ;                                         1902 07982000
*                                                                  1902 07983000
         MVC   CIFRGET(3),CIBASE                                   1902 07984000
*       /*************************************************************/ 07985000
*       /* LOOP: THRU ALL HORIZONTAL EXTENSION RECORDS               */ 07986000
*       /*       (IF ANY)                                            */ 07987000
*       /*************************************************************/ 07988000
*                                                                  1903 07989000
*       DO WHILE ((CIFRGET ^= '0'B)                                1903 07990000
*             & (^(CMPRPASW = ON             /* QUIT AFTER           */ 07991000
*                  & MSCMPRSW = ON))) ;      /* FIRST MSCMPR         */ 07992000
*                                                                  1903 07993000
         B     @DE01903                                            1903 07994000
@DL01903 DS    0H                                                  1904 07995000
*         CALL GETPRT ;            /* GET (PRINT) BASE RECORD        */ 07996000
*                                                                  1904 07997000
         BAL   @14,GETPRT                                          1904 07998000
*         IF FRSTIMSW = YES                                        1905 07999000
*           THEN                                                   1905 08000000
         TM    FRSTIMSW,B'00000010'                                1905 08001000
         BNO   @RF01905                                            1905 08002000
*             DO ;                                                 1906 08003000
*                                                                  1906 08004000
*               CALL INTASOC(2) ;  /* BUILD ASSOCTBL                 */ 08005000
*                                                                  1907 08006000
         LA    @01,@AL01907                                        1907 08007000
         BAL   @14,INTASOC                                         1907 08008000
*               ATENTYP(1) = STENTYP(STSLOT) ;                     1908 08009000
         L     @15,ATRA2PTR                                        1908 08010000
         LR    @14,STSLOT                                          1908 08011000
         MH    @14,@CH01068                                        1908 08012000
         L     @01,STPTR                                           1908 08013000
         ALR   @01,@14                                             1908 08014000
         AL    @01,@CF01484                                        1908 08015000
         MVC   ATENTYP(1,@15),STENTYP-44(@01)                      1908 08016000
*               BASETYPE = ATENTYP(1) ;      /* REAL VALUE           */ 08017000
         MVC   BASETYPE(1),ATENTYP(@15)                            1909 08018000
*             END ;                                                1910 08019000
*         FRSTIMSW = NO ;                                          1911 08020000
*                                                                  1911 08021000
@RF01905 NI    FRSTIMSW,B'11111101'                                1911 08022000
*         CALL VERTEXT ;           /* DO VERTICAL EXTENSIONS         */ 08023000
*                                                                  1912 08024000
         BAL   @14,VERTEXT                                         1912 08025000
*       END ;                                                      1913 08026000
@DE01903 L     @15,CIFRGET-1                                       1913 08027000
         LA    @15,0(,@15)                                         1913 08028000
         LTR   @15,@15                                             1913 08029000
         BZ    @DC01903                                            1913 08030000
         TM    CMPRPASW,B'10000000'                                1913 08031000
         BNO   @DL01903                                            1913 08032000
         TM    MSCMPRSW,B'00001000'                                1913 08033000
         BNO   @DL01903                                            1913 08034000
@DC01903 DS    0H                                                  1914 08035000
*       CIFRGET = CIBASE ;                                         1914 08036000
         MVC   CIFRGET(3),CIBASE                                   1914 08037000
*       IF ASOCTYP = CATRCTYP($DATA)                               1915 08038000
*         THEN                     /* UPGRADE ASSOC IN DATA          */ 08039000
*                                                                  1915 08040000
         LA    @15,5                                               1915 08041000
         SLR   @01,@01                                             1915 08042000
         IC    @01,$DATA                                           1915 08043000
         MR    @00,@15                                             1915 08044000
         LA    @14,CATRCTYP-5(@01)                                 1915 08045000
         CLC   ASOCTYP(1),0(@14)                                   1915 08046000
         BNE   @RF01915                                            1915 08047000
*           CALL ADDASOC(CATRCTYP($UPGD)) ;                        1916 08048000
*                                                                  1916 08049000
         SLR   @01,@01                                             1916 08050000
         IC    @01,$UPGD                                           1916 08051000
         MR    @14,@01                                             1916 08052000
         LA    @15,CATRCTYP-5(@15)                                 1916 08053000
         ST    @15,@AL00001                                        1916 08054000
         LA    @01,@AL00001                                        1916 08055000
         BAL   @14,ADDASOC                                         1916 08056000
*       IF     PRNTPASW = ON       /* SEE IF MISCOMPARE WORDS        */ 08057000
*          & CMPRSW = ON           /* SHOULD BE PRINTED              */ 08058000
*          & CTTMCSW(CIFRGET - CTTBASE) = ON                       1917 08059000
*         THEN                                                     1917 08060000
@RF01915 TM    PRNTPASW,B'10000000'                                1917 08061000
         BNO   @RF01917                                            1917 08062000
         TM    CMPRSW,B'01000000'                                  1917 08063000
         BNO   @RF01917                                            1917 08064000
         L     @15,CIFRGET-1                                       1917 08065000
         LA    @15,0(,@15)                                         1917 08066000
         SLA   @15,3                                               1917 08067000
         L     @01,CTTPTR                                          1917 08068000
         ALR   @01,@15                                             1917 08069000
         AL    @01,@CF01491                                        1917 08070000
         TM    CTTMCSW-8(@01),B'01000000'                          1917 08071000
         BNO   @RF01917                                            1917 08072000
*          IF   (ASOCTYP = CATRCTYP($DATA)                         1918 08073000
*             | ASOCTYP = CATRCTYP($INDX))                         1918 08074000
*                                                                  1918 08075000
*               THEN CALL PRTMCWD  /* USE ALL MISCMPR GROUPS         */ 08076000
         LA    @15,5                                               1918 08077000
         SLR   @01,@01                                             1918 08078000
         IC    @01,$DATA                                           1918 08079000
         MR    @00,@15                                             1918 08080000
         LA    @14,CATRCTYP-5(@01)                                 1918 08081000
         CLC   ASOCTYP(1),0(@14)                                   1918 08082000
         BE    @RT01918                                            1918 08083000
         SLR   @01,@01                                             1918 08084000
         IC    @01,$INDX                                           1918 08085000
         MR    @14,@01                                             1918 08086000
         LA    @14,CATRCTYP-5(@15)                                 1918 08087000
         CLC   ASOCTYP(1),0(@14)                                   1918 08088000
         BNE   @RF01918                                            1918 08089000
@RT01918 DS    0H                                                  1919 08090000
*                         (99,MCARGTBL,MCMSGTBL,MCMLNTBL) ;        1919 08091000
         LA    @01,@AL01919                                        1919 08092000
         BAL   @14,PRTMCWD                                         1919 08093000
*               ELSE CALL PRTMCWD  /* USE ONLY FIRST GROUP           */ 08094000
*                         (1,MCARGTBL,MCMSGTBL,MCMLNTBL) ;         1920 08095000
*                                                                  1920 08096000
         B     @RC01918                                            1920 08097000
@RF01918 LA    @01,@AL01920                                        1920 08098000
         BAL   @14,PRTMCWD                                         1920 08099000
*         ELSE ;                                                   1921 08100000
@RF01917 DS    0H                                                  1922 08101000
*       IF    PRNTPASW = ON                                        1922 08102000
*         & BASETYPE = CATRCTYP($CLUS)                             1922 08103000
*         & ASOCTYP = CATRCTYP($AIX)                               1922 08104000
*                                                                  1922 08105000
*         THEN CALL PRTAAXV ;      /* PRINT AIX VOLUMES INFO         */ 08106000
*                                                                  1922 08107000
@RC01917 TM    PRNTPASW,B'10000000'                                1922 08108000
         BNO   @RF01922                                            1922 08109000
         LA    @15,5                                               1922 08110000
         SLR   @01,@01                                             1922 08111000
         IC    @01,$CLUS                                           1922 08112000
         MR    @00,@15                                             1922 08113000
         LA    @14,CATRCTYP-5(@01)                                 1922 08114000
         CLC   BASETYPE(1),0(@14)                                  1922 08115000
         BNE   @RF01922                                            1922 08116000
         SLR   @01,@01                                             1922 08117000
         IC    @01,$AIX                                            1922 08118000
         MR    @14,@01                                             1922 08119000
         LA    @14,CATRCTYP-5(@15)                                 1922 08120000
         CLC   ASOCTYP(1),0(@14)                                   1922 08121000
         BNE   @RF01922                                            1922 08122000
         BAL   @14,PRTAAXV                                         1923 08123000
*       ENTNOCUR = ENTNOCUR + 1 ;  /* AVOID COUNTING TWICE           */ 08124000
@RF01922 LH    @01,ENTNOCUR                                        1924 08125000
         LA    @01,1(,@01)                                         1924 08126000
         STH   @01,ENTNOCUR                                        1924 08127000
*       IF       NOCNTSW = OFF     /* IF REF ONLY OR 2 PASS          */ 08128000
*          & ((PRNTPASW = ON & CMPRSW = OFF)                       1925 08129000
*             | ENTNOCUR > ENTNOSAV)                               1925 08130000
*                                                                  1925 08131000
*         THEN CALL SUMIT (SMACCUM,ATENTYP(ATSLOT)) ;              1925 08132000
*                                                                  1925 08133000
         TM    NOCNTSW,B'00000001'                                 1925 08134000
         BNZ   @RF01925                                            1925 08135000
         TM    PRNTPASW,B'10000000'                                1925 08136000
         BNO   @GL00110                                            1925 08137000
         TM    CMPRSW,B'01000000'                                  1925 08138000
         BZ    @RT01925                                            1925 08139000
@GL00110 LH    @15,ENTNOCUR                                        1925 08140000
         CH    @15,ENTNOSAV                                        1925 08141000
         BNH   @RF01925                                            1925 08142000
@RT01925 DS    0H                                                  1926 08143000
         LA    @15,SMACCUM                                         1926 08144000
         ST    @15,@AL00001                                        1926 08145000
         LR    @15,ATSLOT                                          1926 08146000
         SLA   @15,2                                               1926 08147000
         L     @01,ATRA2PTR                                        1926 08148000
         LA    @15,ATENTYP-4(@15,@01)                              1926 08149000
         ST    @15,@AL00001+4                                      1926 08150000
         LA    @01,@AL00001                                        1926 08151000
         BAL   @14,SUMIT                                           1926 08152000
*       NOCNTSW = OFF ;                                            1927 08153000
@RF01925 NI    NOCNTSW,B'11111110'                                 1927 08154000
*       IF SAVESW = ON                                             1928 08155000
*         THEN  DUMPSW = ON ;                                      1928 08156000
         TM    SAVESW,B'01000000'                                  1928 08157000
         BNO   @RF01928                                            1928 08158000
         OI    DUMPSW,B'00000100'                                  1929 08159000
*       IF ATSLOT = NBRATS         /* IF AT END OF TABLE             */ 08160000
*         THEN                                                     1930 08161000
@RF01928 C     ATSLOT,@CF00038                                     1930 08162000
         BNE   @RF01930                                            1930 08163000
*           IF ATNXTTBL ^= '0'B    /* AND THERE IS ANOTHER           */ 08164000
*             THEN                                                 1931 08165000
         L     @01,ATRA2PTR                                        1931 08166000
         L     @15,ATNXTTBL(,@01)                                  1931 08167000
         LTR   @15,@15                                             1931 08168000
         BZ    @RF01931                                            1931 08169000
*               DO ;                                               1932 08170000
*                 ATRA2PTR = ATNXTTBL ; /* BUMP TO NEXT TABLE        */ 08171000
         ST    @15,ATRA2PTR                                        1933 08172000
*                 ATSLOT = 0 ;                                     1934 08173000
         SLR   ATSLOT,ATSLOT                                       1934 08174000
*               END ;                                              1935 08175000
*             ELSE LASTATSW = ON ;                                 1936 08176000
         B     @RC01931                                            1936 08177000
@RF01931 OI    LASTATSW,B'00100000'                                1936 08178000
*       INDNTCOL = 2 ;                                             1937 08179000
@RC01931 DS    0H                                                  1937 08180000
@RF01930 MVI   INDNTCOL,X'02'                                      1937 08181000
*     END ;                        /* ASSOCTBL LOOP                  */ 08182000
         AL    ATSLOT,@CF00222                                     1938 08183000
         C     ATSLOT,@CF00038                                     1938 08184000
         BNH   @DL01891                                            1938 08185000
@DC01891 DS    0H                                                  1939 08186000
*     ATRA2PTR = ATPTR ;                                           1939 08187000
         L     @02,ATPTR                                           1939 08188000
         ST    @02,ATRA2PTR                                        1939 08189000
*     LASTATSW = OFF ;                                             1940 08190000
         NI    LASTATSW,B'11011111'                                1940 08191000
*     PRNTPASW = OFF ;             /* TURN OFF AFTER PRINTING        */ 08192000
         NI    PRNTPASW,B'01111111'                                1941 08193000
*     IF CMPRPASW = ON & MSCMPRSW = ON                             1942 08194000
*       THEN                                                       1942 08195000
         TM    CMPRPASW,B'10000000'                                1942 08196000
         BNO   @RF01942                                            1942 08197000
         TM    MSCMPRSW,B'00001000'                                1942 08198000
         BNO   @RF01942                                            1942 08199000
*         DO ;                                                     1943 08200000
*           PRNTPASW = ON ;        /* PASS THRU AGAIN PRINTIN        */ 08201000
         OI    PRNTPASW,B'10000000'                                1944 08202000
*           MCENTCNT = MCENTCNT + 1 ;                              1945 08203000
         LH    @02,MCENTCNT                                        1945 08204000
         LA    @02,1(,@02)                                         1945 08205000
         STH   @02,MCENTCNT                                        1945 08206000
*         END ;                                                    1946 08207000
*     CMPRPASW = OFF ;                                             1947 08208000
@RF01942 NI    CMPRPASW,B'01111111'                                1947 08209000
*   END ;                          /* SECOND PASS CONTROL            */ 08210000
*                                                                  1948 08211000
@DE01885 TM    CMPRPASW,B'10000000'                                1948 08212000
         BO    @DL01885                                            1948 08213000
         TM    PRNTPASW,B'10000000'                                1948 08214000
         BO    @DL01885                                            1948 08215000
*END PRTVSAM ;                                                     1949 08216000
@EL00031 DS    0H                                                  1949 08217000
@EF00031 DS    0H                                                  1949 08218000
@ER00031 LM    @14,@12,@SA00031                                    1949 08219000
         BR    @14                                                 1949 08220000
* /*******************************************************************/ 08221000
* /* PROCEDURE NAME - SUMIT, SUM, PRINT NBR ENTRIES PROCESSED        */ 08222000
* /* FUNCTION -                                                      */ 08223000
* /*   DEPENDING ON CODE RECEIVED IN 1ST PARAMETER,                  */ 08224000
* /*     ACCUMULATE TOTAL NUMBER OF ENTRIES OF THE TYPE              */ 08225000
* /*       SPECIFIED IN THE SECOND PARAMETER IN A TABLE,             */ 08226000
* /*     PRINT ALL ENTRIES IN THE TABLE THAT ARE NON ZERO            */ 08227000
* /*       WITH HEADER AND TOTAL,                                    */ 08228000
* /*     INITIALIZE THE TABLE TO ALL ZERO SUMS                       */ 08229000
* /* INPUTS -                                                        */ 08230000
* /*   FUNCTION, ENTRY TYPE                                          */ 08231000
* /* OUTPUTS -                                                       */ 08232000
* /*   INCREMENTED COUNT FOR ENTRY TYPE SPECIFIED OR                 */ 08233000
* /*   PRINTED TABLE OF COUNT OF EACH ENTRY TYPE PROCESSED           */ 08234000
* /* CALLS -                                                         */ 08235000
* /*   UPRINT                                                        */ 08236000
* /* NOTE - THIS SEGMENT CODED BY WJR                                */ 08237000
* /*******************************************************************/ 08238000
*                                                                  1950 08239000
*SUMIT: PROCEDURE (SUMFUNC, SUMENTYP) ;                            1950 08240000
SUMIT    STM   @14,@12,@SA00032                                    1950 08241000
         MVC   @PC00032(8),0(@01)                                  1950 08242000
* OLDERID2 = NEWERID2;                                             1951 08243000
         L     @04,@PC00001                                        1951 08244000
         L     @15,GDTTR2(,@04)                                    1951 08245000
         MVC   @TS00001(95),NEWERID2(@15)                          1951 08246000
         MVC   OLDERID2(95,@15),@TS00001                           1951 08247000
* NEWID2 = 'LRSM' ;                                                1952 08248000
         MVC   NEWID2(4,@15),@CC01429                              1952 08249000
* IF GDTDBG = NULLPTR                                              1953 08250000
*   THEN;                                                          1953 08251000
         L     @04,GDTDBG(,@04)                                    1953 08252000
         LTR   @04,@04                                             1953 08253000
         BZ    @RT01953                                            1953 08254000
*   ELSE                                                           1955 08255000
*     CALL IDCDB010 (GDTTBL,'LRSM') ;                              1955 08256000
*                                                                  1955 08257000
         L     @04,@PC00001                                        1955 08258000
         ST    @04,@AL00001                                        1955 08259000
         LA    @15,@CC01429                                        1955 08260000
         ST    @15,@AL00001+4                                      1955 08261000
         MVI   @AL00001+4,X'80'                                    1955 08262000
         L     @15,GDTDBG(,@04)                                    1955 08263000
         LA    @01,@AL00001                                        1955 08264000
         BALR  @14,@15                                             1955 08265000
* DCL SUMENTYP CHAR(1) ;                                           1956 08266000
@RT01953 DS    0H                                                  1957 08267000
* DCL SUMFUNC  CHAR(1) ;                                           1957 08268000
* DCL SUMIX    FIXED(15) ;                                         1958 08269000
* DCL SUMS (NBRCTRT) FIXED(31) ;   /* TABLE COUNTS EACH ENTYP        */ 08270000
* DCL SUMSUM   FIXED(31);                                          1960 08271000
*                                                                  1960 08272000
* /*******************************************************************/ 08273000
* /*   ADD 1 TO THE SUM OF ENTRY TYPES                               */ 08274000
* /*******************************************************************/ 08275000
*                                                                  1961 08276000
* IF SUMFUNC = SMACCUM                                             1961 08277000
*   THEN                                                           1961 08278000
         L     @04,@PC00032                                        1961 08279000
         CLC   SUMFUNC(1,@04),SMACCUM                              1961 08280000
         BNE   @RF01961                                            1961 08281000
*     DO SUMIX = 1 TO NBRCTRT ;                                    1962 08282000
         LA    SUMIX,1                                             1962 08283000
@DL01962 DS    0H                                                  1963 08284000
*       IF CATRCTYP(SUMIX) = SUMENTYP                              1963 08285000
*         THEN                                                     1963 08286000
         LR    @04,SUMIX                                           1963 08287000
         MH    @04,@CH00042                                        1963 08288000
         L     @03,@PC00032+4                                      1963 08289000
         LA    @01,CATRCTYP-5(@04)                                 1963 08290000
         CLC   0(1,@01),SUMENTYP(@03)                              1963 08291000
         BNE   @RF01963                                            1963 08292000
*           DO ;                                                   1964 08293000
*             SUMS(SUMIX) = SUMS(SUMIX) + 1 ;                      1965 08294000
         LR    @04,SUMIX                                           1965 08295000
         SLA   @04,2                                               1965 08296000
         LA    @03,1                                               1965 08297000
         AL    @03,SUMS-4(@04)                                     1965 08298000
         ST    @03,SUMS-4(@04)                                     1965 08299000
*             SUMIX = NBRCTRT ;         /* GET OUT OF LOOP          */  08300000
         LA    SUMIX,26                                            1966 08301000
*           END ;                                                  1967 08302000
*     END ;                                                        1968 08303000
*                                                                  1968 08304000
@RF01963 AL    SUMIX,@CF00222                                      1968 08305000
         C     SUMIX,@CF00643                                      1968 08306000
         BNH   @DL01962                                            1968 08307000
* /*******************************************************************/ 08308000
* /*   PRINT THE NON-ZERO,S OF THE TABLE                             */ 08309000
* /*******************************************************************/ 08310000
*                                                                  1969 08311000
* IF SUMFUNC = SMPRINT                                             1969 08312000
*   THEN                                                           1969 08313000
@RF01961 L     @04,@PC00032                                        1969 08314000
         CLC   SUMFUNC(1,@04),SMPRINT                              1969 08315000
         BNE   @RF01969                                            1969 08316000
*     DO ;                                                         1970 08317000
*       SUMSUM = 0 ;                                               1971 08318000
         SLR   @04,@04                                             1971 08319000
         ST    @04,SUMSUM                                          1971 08320000
*       DARGLIST = '0'B ;                                          1972 08321000
         L     @04,DDSTRU                                          1972 08322000
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  1972 08323000
         MVI   DARGLIST(@04),B'00000000'                           1972 08324000
*       DARGSMOD = 'LR0' ;                                         1973 08325000
         MVC   DARGSMOD(3,@04),@CC01335                            1973 08326000
*       DARGSENT = 12 ;            /* PRINT HEADING                  */ 08327000
         MVI   DARGSENT(@04),X'0C'                                 1974 08328000
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    1975 08329000
         L     @04,@PC00001                                        1975 08330000
         ST    @04,@AL00001                                        1975 08331000
         LA    @15,IOCSPRT                                         1975 08332000
         ST    @15,@AL00001+4                                      1975 08333000
         LA    @15,DDSTRU                                          1975 08334000
         ST    @15,@AL00001+8                                      1975 08335000
         MVI   @AL00001+8,X'80'                                    1975 08336000
         L     @15,GDTPRT(,@04)                                    1975 08337000
         LA    @01,@AL00001                                        1975 08338000
         BALR  @14,@15                                             1975 08339000
*       DARGSENT = 13 ;            /* PRINT BODY OF TABLE            */ 08340000
         L     @04,DDSTRU                                          1976 08341000
         MVI   DARGSENT(@04),X'0D'                                 1976 08342000
*       DARGCNT = 2 ;                                              1977 08343000
         LA    @15,2                                               1977 08344000
         STH   @15,DARGCNT(,@04)                                   1977 08345000
*       DARGINS(1) = 1 ;                                           1978 08346000
         LA    @14,1                                               1978 08347000
         STH   @14,DARGINS(,@04)                                   1978 08348000
*       DARGINL(1) = LENGTH(CATRDESC) ;                            1979 08349000
         LA    @03,4                                               1979 08350000
         STH   @03,DARGINL(,@04)                                   1979 08351000
*       DARGINS(2) = 2 ;                                           1980 08352000
         STH   @15,DARGINS+8(,@04)                                 1980 08353000
*       DARGINL(2) = LENGTH(SUMS) ;                                1981 08354000
         STH   @03,DARGINL+8(,@04)                                 1981 08355000
*       DO SUMIX = 1 TO NBRCTRT ;                                  1982 08356000
         LR    SUMIX,@14                                           1982 08357000
@DL01982 DS    0H                                                  1983 08358000
*         IF SUMS(SUMIX) ^= 0                                      1983 08359000
*           THEN                                                   1983 08360000
         LR    @04,SUMIX                                           1983 08361000
         SLA   @04,2                                               1983 08362000
         L     @03,SUMS-4(@04)                                     1983 08363000
         LTR   @03,@03                                             1983 08364000
         BZ    @RF01983                                            1983 08365000
*             DO ;                                                 1984 08366000
*               DARGDTM(1) = ADDR(CATRDESC(SUMIX)) ;               1985 08367000
         L     @03,DDSTRU                                          1985 08368000
         LR    @15,SUMIX                                           1985 08369000
         MH    @15,@CH00042                                        1985 08370000
         LA    @15,CATRDESC-5(@15)                                 1985 08371000
         ST    @15,DARGDTM(,@03)                                   1985 08372000
*               DARGDTM(2) = ADDR(SUMS(SUMIX)) ;                   1986 08373000
         LA    @04,SUMS-4(@04)                                     1986 08374000
         ST    @04,DARGDTM+8(,@03)                                 1986 08375000
*               CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;            1987 08376000
         L     @04,@PC00001                                        1987 08377000
         ST    @04,@AL00001                                        1987 08378000
         LA    @03,IOCSPRT                                         1987 08379000
         ST    @03,@AL00001+4                                      1987 08380000
         LA    @03,DDSTRU                                          1987 08381000
         ST    @03,@AL00001+8                                      1987 08382000
         MVI   @AL00001+8,X'80'                                    1987 08383000
         L     @15,GDTPRT(,@04)                                    1987 08384000
         LA    @01,@AL00001                                        1987 08385000
         BALR  @14,@15                                             1987 08386000
*               SUMSUM = SUMSUM + SUMS(SUMIX) ;                    1988 08387000
         LR    @04,SUMIX                                           1988 08388000
         SLA   @04,2                                               1988 08389000
         L     @03,SUMSUM                                          1988 08390000
         AL    @03,SUMS-4(@04)                                     1988 08391000
         ST    @03,SUMSUM                                          1988 08392000
*               SUMS(SUMIX) = 0 ;                                  1989 08393000
         SLR   @03,@03                                             1989 08394000
         ST    @03,SUMS-4(@04)                                     1989 08395000
*             END ;                                                1990 08396000
*       END ;                                                      1991 08397000
@RF01983 AL    SUMIX,@CF00222                                      1991 08398000
         C     SUMIX,@CF00643                                      1991 08399000
         BNH   @DL01982                                            1991 08400000
*       DARGDTM(1) = ADDR('SUM ') ;     /* PRINT TOTALS              */ 08401000
         L     @04,DDSTRU                                          1992 08402000
         LA    @15,@CC01433                                        1992 08403000
         ST    @15,DARGDTM(,@04)                                   1992 08404000
*       DARGDTM(2) = ADDR(SUMSUM) ;                                1993 08405000
         LA    @15,SUMSUM                                          1993 08406000
         ST    @15,DARGDTM+8(,@04)                                 1993 08407000
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    1994 08408000
         L     @04,@PC00001                                        1994 08409000
         ST    @04,@AL00001                                        1994 08410000
         LA    @15,IOCSPRT                                         1994 08411000
         ST    @15,@AL00001+4                                      1994 08412000
         LA    @15,DDSTRU                                          1994 08413000
         ST    @15,@AL00001+8                                      1994 08414000
         MVI   @AL00001+8,X'80'                                    1994 08415000
         L     @15,GDTPRT(,@04)                                    1994 08416000
         LA    @01,@AL00001                                        1994 08417000
         BALR  @14,@15                                             1994 08418000
*     END ;                                                        1995 08419000
*                                                                  1995 08420000
* /*******************************************************************/ 08421000
* /*   INITIALIZE THE TABLE OF SUMS                                  */ 08422000
* /*******************************************************************/ 08423000
*                                                                  1996 08424000
* IF SUMFUNC = SMINIT                                              1996 08425000
*   THEN                                                           1996 08426000
@RF01969 L     @04,@PC00032                                        1996 08427000
         CLC   SUMFUNC(1,@04),SMINIT                               1996 08428000
         BNE   @RF01996                                            1996 08429000
*     DO SUMIX = 1 TO NBRCTRT ;                                    1997 08430000
         LA    SUMIX,1                                             1997 08431000
@DL01997 DS    0H                                                  1998 08432000
*       SUMS(SUMIX) = 0 ;                                          1998 08433000
         LR    @04,SUMIX                                           1998 08434000
         SLA   @04,2                                               1998 08435000
         SLR   @03,@03                                             1998 08436000
         ST    @03,SUMS-4(@04)                                     1998 08437000
*     END ;                                                        1999 08438000
*                                                                  1999 08439000
         AL    SUMIX,@CF00222                                      1999 08440000
         C     SUMIX,@CF00643                                      1999 08441000
         BNH   @DL01997                                            1999 08442000
*END SUMIT ;                                                       2000 08443000
@EL00032 DS    0H                                                  2000 08444000
@EF00032 DS    0H                                                  2000 08445000
@ER00032 LM    @14,@12,@SA00032                                    2000 08446000
         BR    @14                                                 2000 08447000
* /*******************************************************************/ 08448000
* /* PROCEDURE NAME - TCICTCR, TRANSLATE CI CATALOG TO CRA           */ 08449000
* /* FUNCTION -                                                      */ 08450000
* /*   SEARCH THRU CTT TABLE FOR CATALOG CI GIVEN, SLOT              */ 08451000
* /*   FOUND IN IS THE CRA CI MINUS THE CTT BASE                     */ 08452000
* /* INPUTS -                                                        */ 08453000
* /*   CIFRTRNS (CATALOG CONTROL INTERVAL (CI))                      */ 08454000
* /*   CTT                                                           */ 08455000
* /* OUTPUTS -                                                       */ 08456000
* /*   CIFRTRNS (CRA CI)                                             */ 08457000
* /* CALLS -                                                         */ 08458000
* /*   ERROR                                                         */ 08459000
* /*******************************************************************/ 08460000
*                                                                  2001 08461000
* TCICTCR: PROCEDURE (TRRTNCD) ;                                   2001 08462000
TCICTCR  STM   @14,@12,@SA00033                                    2001 08463000
         MVC   @PC00033(4),0(@01)                                  2001 08464000
*   OLDERID2 = NEWERID2;                                           2002 08465000
         L     @04,@PC00001                                        2002 08466000
         L     @15,GDTTR2(,@04)                                    2002 08467000
         MVC   @TS00001(95),NEWERID2(@15)                          2002 08468000
         MVC   OLDERID2(95,@15),@TS00001                           2002 08469000
*   NEWID2 = 'LRTC' ;                                              2003 08470000
         MVC   NEWID2(4,@15),@CC01439                              2003 08471000
*   IF GDTDBG = NULLPTR                                            2004 08472000
*     THEN;                                                        2004 08473000
         L     @04,GDTDBG(,@04)                                    2004 08474000
         LTR   @04,@04                                             2004 08475000
         BZ    @RT02004                                            2004 08476000
*     ELSE                                                         2006 08477000
*       CALL IDCDB010 (GDTTBL,'LRTC') ;                            2006 08478000
*                                                                  2006 08479000
         L     @04,@PC00001                                        2006 08480000
         ST    @04,@AL00001                                        2006 08481000
         LA    @15,@CC01439                                        2006 08482000
         ST    @15,@AL00001+4                                      2006 08483000
         MVI   @AL00001+4,X'80'                                    2006 08484000
         L     @15,GDTDBG(,@04)                                    2006 08485000
         LA    @01,@AL00001                                        2006 08486000
         BALR  @14,@15                                             2006 08487000
*   DCL TRRTNCD     FIXED(8) ;     /* RETURN CODE TO CALLER          */ 08488000
*                                                                  2007 08489000
@RT02004 DS    0H                                                  2008 08490000
*   IF CIFRTRNS > CTTBASE          /* CI 0-8 NO TRANSLATE            */ 08491000
*     THEN                                                         2008 08492000
         CLC   CIFRTRNS(3),@CF00039+1                              2008 08493000
         BNH   @RF02008                                            2008 08494000
*       DO ;                                                       2009 08495000
*         DO TCISLOT = 1 TO CTTENTNO    /* SEARCH FOR CI             */ 08496000
*                                                                  2010 08497000
*            WHILE (CTTCATCI(TCISLOT) ^= CIFRTRNS); /* IN CTT        */ 08498000
         LA    TCISLOT,1                                           2010 08499000
         B     @DE02010                                            2010 08500000
@DL02010 LR    @04,TCISLOT                                         2010 08501000
         SLL   @04,3                                               2010 08502000
         L     @03,CTTPTR                                          2010 08503000
         ALR   @03,@04                                             2010 08504000
         AL    @03,@CF01466                                        2010 08505000
         CLC   CTTCATCI-5(3,@03),CIFRTRNS                          2010 08506000
         BE    @DC02010                                            2010 08507000
*         END ;                                                    2011 08508000
         AL    TCISLOT,@CF00222                                    2011 08509000
@DE02010 L     @04,CTTPTR                                          2011 08510000
         CL    TCISLOT,CTTENTNO(,@04)                              2011 08511000
         BNH   @DL02010                                            2011 08512000
@DC02010 DS    0H                                                  2012 08513000
*         IF TCISLOT ^= CTTENTNO + 1    /* IF IT WAS FOUND           */ 08514000
*           THEN CIFRTRNS = TCISLOT + CTTBASE ; /* TRANSLATE         */ 08515000
         LA    @04,1                                               2012 08516000
         L     @03,CTTPTR                                          2012 08517000
         AL    @04,CTTENTNO(,@03)                                  2012 08518000
         CLR   TCISLOT,@04                                         2012 08519000
         BE    @RF02012                                            2012 08520000
         LA    @04,8(,TCISLOT)                                     2013 08521000
         STCM  @04,7,CIFRTRNS                                      2013 08522000
*           ELSE                                                   2014 08523000
*             DO ;                                                 2014 08524000
         B     @RC02012                                            2014 08525000
@RF02012 DS    0H                                                  2015 08526000
*               TRRTNCD = 4 ;      /* SET RETURN CODE TO FAIL        */ 08527000
         L     @04,@PC00033                                        2015 08528000
         MVI   TRRTNCD(@04),X'04'                                  2015 08529000
*               CALL ERROR (29,$RETURN) ;                          2016 08530000
         LA    @01,@AL02016                                        2016 08531000
         BAL   @14,ERROR                                           2016 08532000
*             END ;                                                2017 08533000
*       END ;                                                      2018 08534000
*                                                                  2018 08535000
* END TCICTCR ;                                                    2019 08536000
@EL00033 DS    0H                                                  2019 08537000
@EF00033 DS    0H                                                  2019 08538000
@ER00033 LM    @14,@12,@SA00033                                    2019 08539000
         BR    @14                                                 2019 08540000
* /*******************************************************************/ 08541000
* /* PROCEDURE NAME - VERTEXT, VERTICAL EXTENSION HANDLING           */ 08542000
* /* FUNCTION -                                                      */ 08543000
* /*   INITIALIZE VEXTTBL (ALL VERTICAL EXTENSIONS),                 */ 08544000
* /*   LOOP THRU VERTICAL EXTENSIONS (PRIMARY),                      */ 08545000
* /*     GET THE RECORD(S), PRINTING AS SPECIFIED,                   */ 08546000
* /*     LOOP THRU FURTHER VERTICAL EXTENSIONS (USING                */ 08547000
* /*     HORIZONTAL POINTER AS VERTICAL (SECONDARY)),                */ 08548000
* /*       GET RECORD(S), PRINT AS SPECIFIED,                        */ 08549000
* /* INPUTS -                                                        */ 08550000
* /* OUTPUTS -                                                       */ 08551000
* /*   CIFRGET (SET TO HORIZONTAL EXTENSION CI)                      */ 08552000
* /* CALLS -                                                         */ 08553000
* /*   INTVEXT, GETPRT                                               */ 08554000
* /*******************************************************************/ 08555000
*                                                                  2020 08556000
*VERTEXT: PROCEDURE ;                                              2020 08557000
VERTEXT  STM   @14,@12,@SA00034                                    2020 08558000
* OLDERID2 = NEWERID2;                                             2021 08559000
         L     @15,@PC00001                                        2021 08560000
         L     @14,GDTTR2(,@15)                                    2021 08561000
         MVC   @TS00001(95),NEWERID2(@14)                          2021 08562000
         MVC   OLDERID2(95,@14),@TS00001                           2021 08563000
* NEWID2 = 'LRVE' ;                                                2022 08564000
         MVC   NEWID2(4,@14),@CC01443                              2022 08565000
* IF GDTDBG = NULLPTR                                              2023 08566000
*   THEN;                                                          2023 08567000
         L     @15,GDTDBG(,@15)                                    2023 08568000
         LTR   @15,@15                                             2023 08569000
         BZ    @RT02023                                            2023 08570000
*   ELSE                                                           2025 08571000
*     CALL IDCDB010 (GDTTBL,'LRVE') ;                              2025 08572000
*                                                                  2025 08573000
         L     @15,@PC00001                                        2025 08574000
         ST    @15,@AL00001                                        2025 08575000
         LA    @14,@CC01443                                        2025 08576000
         ST    @14,@AL00001+4                                      2025 08577000
         MVI   @AL00001+4,X'80'                                    2025 08578000
         L     @15,GDTDBG(,@15)                                    2025 08579000
         LA    @01,@AL00001                                        2025 08580000
         BALR  @14,@15                                             2025 08581000
* HRONLYSW = OFF ;                                                 2026 08582000
*                                                                  2026 08583000
@RT02023 NI    HRONLYSW,B'01111111'                                2026 08584000
* CALL INTVEXT ;                   /* GO BUILD VEXTTBL               */ 08585000
*                                                                  2027 08586000
         BAL   @14,INTVEXT                                         2027 08587000
* CI1STHE = CIHOREXT ;             /* KEEP FOR HOR EXT LOOP          */ 08588000
         MVC   CI1STHE(3),CIHOREXT                                 2028 08589000
* HRONLYSW = ON ;                                                  2029 08590000
*                                                                  2029 08591000
         OI    HRONLYSW,B'10000000'                                2029 08592000
* /*******************************************************************/ 08593000
* /* LOOP: THRU ALL VERTICAL EXTENSION RECORDS                       */ 08594000
* /*******************************************************************/ 08595000
*                                                                  2030 08596000
* DO VESLOT = 1 TO NBRVES                                          2030 08597000
*    WHILE (VECRACI(VESLOT) ^= '0'B                                2030 08598000
*       & LASTVESW ^= ON                                           2030 08599000
*      & (^(CMPRPASW = ON          /* QUIT AFTER 1ST MISCMPR         */ 08600000
*           & MSCMPRSW = ON))) ;                                   2030 08601000
         LA    VESLOT,1                                            2030 08602000
@DL02030 LR    @03,VESLOT                                          2030 08603000
         SLA   @03,2                                               2030 08604000
         L     @01,VEPTR                                           2030 08605000
         L     @03,VECRACI-5(@03,@01)                              2030 08606000
         LA    @03,0(,@03)                                         2030 08607000
         LTR   @03,@03                                             2030 08608000
         BZ    @DC02030                                            2030 08609000
         TM    LASTVESW,B'00010000'                                2030 08610000
         BO    @DC02030                                            2030 08611000
         TM    CMPRPASW,B'10000000'                                2030 08612000
         BNO   @DB02030                                            2030 08613000
         TM    MSCMPRSW,B'00001000'                                2030 08614000
         BO    @DC02030                                            2030 08615000
@DB02030 DS    0H                                                  2031 08616000
*   CIFRGET = VECRACI(VESLOT) ;                                    2031 08617000
*                                                                  2031 08618000
         LR    @03,VESLOT                                          2031 08619000
         SLA   @03,2                                               2031 08620000
         L     @01,VEPTR                                           2031 08621000
         ALR   @01,@03                                             2031 08622000
         MVC   CIFRGET(3),VECRACI-4(@01)                           2031 08623000
*   CALL GETPRT ;                  /* GET  AND PRINT A RECORD        */ 08624000
*                                                                  2032 08625000
         BAL   @14,GETPRT                                          2032 08626000
*   HRONLYSW = ON ;                                                2033 08627000
*                                                                  2033 08628000
         OI    HRONLYSW,B'10000000'                                2033 08629000
*   CALL INTVEXT ;                 /* GET HORIZ EXTN ONLY            */ 08630000
*                                                                  2034 08631000
         BAL   @14,INTVEXT                                         2034 08632000
*   CIFRGET = CIHOREXT ;                                           2035 08633000
*                                                                  2035 08634000
         MVC   CIFRGET(3),CIHOREXT                                 2035 08635000
*   /*****************************************************************/ 08636000
*   /* LOOP: THRU ALL HORIZONTAL EXTENSION CI,S BEING USED           */ 08637000
*   /*       AS VERTICAL EXTENSION CI,S                              */ 08638000
*   /*****************************************************************/ 08639000
*   DO WHILE (CIHOREXT ^= 0                                        2036 08640000
*        & (^(CMPRPASW = ON        /* QUIT AFTER 1ST MSCMPR          */ 08641000
*             & MSCMPRSW = ON))) ;                                 2036 08642000
*                                                                  2036 08643000
         B     @DE02036                                            2036 08644000
@DL02036 DS    0H                                                  2037 08645000
*     CALL GETPRT ;                                                2037 08646000
*                                                                  2037 08647000
         BAL   @14,GETPRT                                          2037 08648000
*     CALL INTVEXT ;                                               2038 08649000
*                                                                  2038 08650000
         BAL   @14,INTVEXT                                         2038 08651000
*     CIFRGET = CIHOREXT ;                                         2039 08652000
         MVC   CIFRGET(3),CIHOREXT                                 2039 08653000
*   END ;                                                          2040 08654000
@DE02036 L     @03,CIHOREXT-1                                      2040 08655000
         LA    @03,0(,@03)                                         2040 08656000
         LTR   @03,@03                                             2040 08657000
         BZ    @DC02036                                            2040 08658000
         TM    CMPRPASW,B'10000000'                                2040 08659000
         BNO   @DL02036                                            2040 08660000
         TM    MSCMPRSW,B'00001000'                                2040 08661000
         BNO   @DL02036                                            2040 08662000
@DC02036 DS    0H                                                  2041 08663000
*   IF VESLOT = NBRVES                                             2041 08664000
*     THEN                                                         2041 08665000
         C     VESLOT,@CF00038                                     2041 08666000
         BNE   @RF02041                                            2041 08667000
*       IF VENXTTBL ^= '0'B                                        2042 08668000
*         THEN                                                     2042 08669000
         L     @03,VEPTR                                           2042 08670000
         L     @03,VENXTTBL(,@03)                                  2042 08671000
         LTR   @03,@03                                             2042 08672000
         BZ    @RF02042                                            2042 08673000
*           DO ;                                                   2043 08674000
*             VEPTR = VENXTTBL ;   /* BUMP TO NEXT TABLE             */ 08675000
         ST    @03,VEPTR                                           2044 08676000
*             VESLOT = 0 ;                                 /*@OZ20928*/ 08677000
         SLR   VESLOT,VESLOT                                       2045 08678000
*           END ;                                                  2046 08679000
*         ELSE                                                     2047 08680000
*           LASTVESW = ON ;        /* NO MORE TABLES                 */ 08681000
         B     @RC02042                                            2047 08682000
@RF02042 OI    LASTVESW,B'00010000'                                2047 08683000
* END ;                                                            2048 08684000
@RC02042 DS    0H                                                  2048 08685000
@RF02041 AL    VESLOT,@CF00222                                     2048 08686000
         C     VESLOT,@CF00038                                     2048 08687000
         BNH   @DL02030                                            2048 08688000
@DC02030 DS    0H                                                  2049 08689000
*  LASTVESW = OFF ;                                                2049 08690000
         NI    LASTVESW,B'11101111'                                2049 08691000
* CIFRGET = CI1STHE ;                                              2050 08692000
*                                                                  2050 08693000
         MVC   CIFRGET(3),CI1STHE                                  2050 08694000
*END VERTEXT ;                                                     2051 08695000
@EL00034 DS    0H                                                  2051 08696000
@EF00034 DS    0H                                                  2051 08697000
@ER00034 LM    @14,@12,@SA00034                                    2051 08698000
         BR    @14                                                 2051 08699000
*                                                                  2052 08700000
*END IDCLR01                                                       2052 08701000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 08702000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 08703000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 08704000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 08705000
*/*%INCLUDE SYSLIB  (IDCCSLR )                                        * 08706000
*/*%INCLUDE SYSLIB  (IDCDF61 )                                        * 08707000
*;                                                                 2052 08708000
@DATA    DS    0H                                                       08709000
@CH00614 DC    H'44'                                                    08710000
@CH00639 DC    H'48'                                                    08711000
@CH01068 DC    H'56'                                                    08712000
@CH00637 DC    H'105'                                                   08713000
@CH00741 DC    H'256'                                                   08714000
@CH01136 DC    H'508'                                                   08715000
@CH01288 DC    H'-1'                                                    08716000
@SC01487 CLC   IOBUF(0,@14),IOBUF(@15)                                  08717000
@SC01489 CLC   IOBUF(0,@01),IOBUF(@14)                                  08718000
@SC01494 CLC   MCWKAR(0),FMWKAR                                         08719000
@SM01496 MVC   MCMSG(0),CHARBASD(@02)                                   08720000
         DS    0F                                                       08721000
@AL00248 EQU   *                       LIST WITH   4 ARGUMENT(S)        08722000
@AL01034 DC    A(ATLEN)                LIST WITH   4 ARGUMENT(S)        08723000
         DC    A(SMPRINT)                                               08724000
         DC    A(MODID)                                                 08725000
         DC    AL1(X'80')                                               08726000
         DC    AL3(SETZERO)                                             08727000
@AL00259 EQU   *                       LIST WITH   2 ARGUMENT(S)        08728000
@AL00303 EQU   *                       LIST WITH   2 ARGUMENT(S)        08729000
@AL00985 EQU   *                       LIST WITH   2 ARGUMENT(S)        08730000
@AL01043 DC    A(@CF00224)             LIST WITH   2 ARGUMENT(S)        08731000
         DC    A($ABORT)                                                08732000
@AL00294 DC    A(VELEN)                LIST WITH   4 ARGUMENT(S)        08733000
         DC    A(SMINIT)                                                08734000
         DC    A(MODID)                                                 08735000
         DC    AL1(X'80')                                               08736000
         DC    AL3(SETZERO)                                             08737000
@AL00374 DC    A(@CF00158)             LIST WITH   2 ARGUMENT(S)        08738000
         DC    A($RETURN)                                               08739000
@AL00390 DC    A(@CF00222)             LIST WITH   2 ARGUMENT(S)        08740000
         DC    A($RETURN)                                               08741000
@AL00413 DC    A(@CF00166)             LIST WITH   2 ARGUMENT(S)        08742000
         DC    A($RETURN)                                               08743000
@AL00422 DC    A(@CF00047)             LIST WITH   2 ARGUMENT(S)        08744000
         DC    A($RETURN)                                               08745000
@AL00443 DC    A(@CF01206)             LIST WITH   2 ARGUMENT(S)        08746000
         DC    A($RETURN)                                               08747000
@AL00486 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)        08748000
         DC    AL1(X'80')                                               08749000
         DC    AL3(ALL)                                                 08750000
@AL00563 DC    A(@CF00039)             LIST WITH   2 ARGUMENT(S)        08751000
         DC    A($RETURN)                                               08752000
@AL00580 DC    A(@CF00041)             LIST WITH   2 ARGUMENT(S)        08753000
         DC    A($RETURN)                                               08754000
@AL00582 DC    A(@CF00037)             LIST WITH   2 ARGUMENT(S)        08755000
         DC    A($RETURN)                                               08756000
@AL00586 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)        08757000
         DC    A($RETURN)                                               08758000
@AL00597 DC    A(@CF00042)             LIST WITH   2 ARGUMENT(S)        08759000
         DC    A($RETURN)                                               08760000
@AL00604 DC    A(@CF00038)             LIST WITH   2 ARGUMENT(S)        08761000
         DC    A($RETURN)                                               08762000
@AL00657 DC    A(@CF00035)             LIST WITH   2 ARGUMENT(S)        08763000
         DC    A($RETURN)                                               08764000
@AL00666 DC    A(@CF00224)             LIST WITH   2 ARGUMENT(S)        08765000
         DC    A($RETURN)                                               08766000
@AL00668 DC    A(@CF00036)             LIST WITH   2 ARGUMENT(S)        08767000
         DC    A($RETURN)                                               08768000
@AL00840 DC    A(@CF00779)             LIST WITH   2 ARGUMENT(S)        08769000
         DC    A($RETURN)                                               08770000
@AL00850 DC    A(@CF01225)             LIST WITH   2 ARGUMENT(S)        08771000
         DC    A($RETURN)                                               08772000
@AL00853 DC    A(@CF00231)             LIST WITH   2 ARGUMENT(S)        08773000
         DC    A($RETURN)                                               08774000
@AL00900 DC    A(@CF00049)             LIST WITH   2 ARGUMENT(S)        08775000
         DC    A($ABORT)                                                08776000
@AL00957 DC    A(GPLEN1ST)             LIST WITH   4 ARGUMENT(S)        08777000
@AL00497 DC    A(SMPRINT)              LIST WITH   1 ARGUMENT(S)        08778000
         DC    A(MODID)                                                 08779000
         DC    AL1(X'80')                                               08780000
         DC    AL3(SETZERO)                                             08781000
@AL00973 DC    A(IOBFSLEN)             LIST WITH   4 ARGUMENT(S)        08782000
@AL00863 DC    A(SMINIT)               LIST WITH   1 ARGUMENT(S)        08783000
         DC    A(MODIDPG)                                               08784000
         DC    AL1(X'80')                                               08785000
         DC    AL3(SETZERO)                                             08786000
@AL01015 DC    A(@CF01297)             LIST WITH   2 ARGUMENT(S)        08787000
         DC    A($RETURN)                                               08788000
@AL01058 DC    A(@CF00483)             LIST WITH   2 ARGUMENT(S)        08789000
         DC    A($RETURN)                                               08790000
@AL01130 DC    A(@CF00780)             LIST WITH   2 ARGUMENT(S)        08791000
         DC    A($RETURN)                                               08792000
@AL01138 DC    A(@CF00658)             LIST WITH   2 ARGUMENT(S)        08793000
         DC    A($RETURN)                                               08794000
@AL01184 DC    A(@CF01320)             LIST WITH   2 ARGUMENT(S)        08795000
         DC    A($RETURN)                                               08796000
@AL01302 DC    A(@CF00643)             LIST WITH   2 ARGUMENT(S)        08797000
         DC    A($RETURN)                                               08798000
@AL01544 DC    A(@CF00952)             LIST WITH   2 ARGUMENT(S)        08799000
         DC    A($RETURN)                                               08800000
@AL01568 DC    A(@CF00120)             LIST WITH   4 ARGUMENT(S)        08801000
         DC    A(MCARGTBL)                                              08802000
         DC    A(MCMSGTBL)                                              08803000
         DC    A(MCMLNTBL)                                              08804000
@AL01643 DC    A(@CF00660)             LIST WITH   2 ARGUMENT(S)        08805000
         DC    A($RETURN)                                               08806000
@AL01688 EQU   *                       LIST WITH   4 ARGUMENT(S)        08807000
@AL01711 DC    A(@CF00158)             LIST WITH   4 ARGUMENT(S)        08808000
         DC    A(MCARGTBL)                                              08809000
         DC    A(MCMSGTBL)                                              08810000
         DC    A(MCMLNTBL)                                              08811000
@AL01696 EQU   *                       LIST WITH   4 ARGUMENT(S)        08812000
@AL01920 EQU   *                       LIST WITH   4 ARGUMENT(S)        08813000
@AL00219 EQU   *                       LIST WITH   1 ARGUMENT(S)        08814000
@AL01232 EQU   *                       LIST WITH   1 ARGUMENT(S)        08815000
@AL01560 EQU   *                       LIST WITH   1 ARGUMENT(S)        08816000
@AL01700 DC    A(@CF00222)             LIST WITH   1 ARGUMENT(S)        08817000
         DC    A(MCARGTBL)                                              08818000
         DC    A(MCMSGTBL)                                              08819000
         DC    A(MCMLNTBL)                                              08820000
@AL01823 EQU   *                       LIST WITH   4 ARGUMENT(S)        08821000
@AL01907 DC    A(@CF00158)             LIST WITH   1 ARGUMENT(S)        08822000
         DC    A(MCARGTBV)                                              08823000
         DC    A(MCMSGTBV)                                              08824000
         DC    A(MCMLNTBV)                                              08825000
@AL01849 DC    A(@CF00662)             LIST WITH   2 ARGUMENT(S)        08826000
         DC    A($RETURN)                                               08827000
@AL01858 DC    A(@CF00664)             LIST WITH   2 ARGUMENT(S)        08828000
         DC    A($RETURN)                                               08829000
@AL01869 DC    A(@CF00312)             LIST WITH   2 ARGUMENT(S)        08830000
         DC    A($RETURN)                                               08831000
@AL01919 DC    A(@CF00818)             LIST WITH   4 ARGUMENT(S)        08832000
         DC    A(MCARGTBL)                                              08833000
         DC    A(MCMSGTBL)                                              08834000
         DC    A(MCMLNTBL)                                              08835000
@AL02016 DC    A(@CF01410)             LIST WITH   2 ARGUMENT(S)        08836000
         DC    A($RETURN)                                               08837000
@DATD    DSECT                                                          08838000
         DS    0F                                                       08839000
@SA00001 DS    18F                                                      08840000
@PC00001 DS    3F                                                       08841000
@SA00015 DS    13F                                                      08842000
@SA00005 DS    15F                                                      08843000
@SA00009 DS    15F                                                      08844000
@SA00030 DS    15F                                                      08845000
@SA00017 DS    15F                                                      08846000
@PC00017 DS    2F                                                       08847000
@SA00019 DS    15F                                                      08848000
@SA00012 DS    15F                                                      08849000
@SA00011 DS    15F                                                      08850000
@SA00024 DS    15F                                                      08851000
@SA00008 DS    15F                                                      08852000
@SA00007 DS    15F                                                      08853000
@SA00002 DS    15F                                                      08854000
@PC00002 DS    1F                                                       08855000
@SA00016 DS    15F                                                      08856000
@PC00016 DS    1F                                                       08857000
@SA00013 DS    15F                                                      08858000
@PC00013 DS    2F                                                       08859000
@SA00003 DS    14F                                                      08860000
@SA00004 DS    15F                                                      08861000
@SA00006 DS    14F                                                      08862000
@SA00032 DS    15F                                                      08863000
@PC00032 DS    2F                                                       08864000
@SA00010 DS    15F                                                      08865000
@SA00014 DS    15F                                                      08866000
@SA00028 DS    15F                                                      08867000
@SA00031 DS    15F                                                      08868000
@SA00021 DS    15F                                                      08869000
@SA00033 DS    15F                                                      08870000
@PC00033 DS    1F                                                       08871000
@SA00018 DS    15F                                                      08872000
@SA00020 DS    15F                                                      08873000
@SA00027 DS    15F                                                      08874000
@SA00022 DS    15F                                                      08875000
@SA00023 DS    15F                                                      08876000
@SA00025 DS    15F                                                      08877000
@PC00025 DS    4F                                                       08878000
@SA00026 DS    15F                                                      08879000
@SA00034 DS    15F                                                      08880000
@SA00029 DS    15F                                                      08881000
@PC00029 DS    2F                                                       08882000
@AL00001 DS    6A                                                       08883000
@TF00001 DS    F                                                        08884000
@TF00002 DS    F                                                        08885000
@AFTEMPS DS    1F                                                       08886000
IDCLR01  CSECT                                                          08887000
         DS    0F                                                       08888000
@CF00120 DC    F'0'                                                     08889000
@CH00120 EQU   @CF00120+2                                               08890000
@CF00222 DC    F'1'                                                     08891000
@CH00222 EQU   @CF00222+2                                               08892000
@CF00158 DC    F'2'                                                     08893000
@CH00158 EQU   @CF00158+2                                               08894000
@CF00166 DC    F'3'                                                     08895000
@CH00166 EQU   @CF00166+2                                               08896000
@CF00047 DC    F'4'                                                     08897000
@CH00047 EQU   @CF00047+2                                               08898000
@CF00042 DC    F'5'                                                     08899000
@CH00042 EQU   @CF00042+2                                               08900000
@CF00041 DC    F'6'                                                     08901000
@CH00041 EQU   @CF00041+2                                               08902000
@CF00040 DC    F'7'                                                     08903000
@CH00040 EQU   @CF00040+2                                               08904000
@CF00039 DC    F'8'                                                     08905000
@CH00039 EQU   @CF00039+2                                               08906000
@CF00038 DC    F'9'                                                     08907000
@CH00038 EQU   @CF00038+2                                               08908000
@CF00037 DC    F'10'                                                    08909000
@CH00037 EQU   @CF00037+2                                               08910000
@CF00036 DC    F'11'                                                    08911000
@CF00035 DC    F'12'                                                    08912000
@CH00035 EQU   @CF00035+2                                               08913000
@CF00779 DC    F'13'                                                    08914000
@CF01225 DC    F'14'                                                    08915000
@CF00231 DC    F'15'                                                    08916000
@CF00483 DC    F'16'                                                    08917000
@CF00780 DC    F'17'                                                    08918000
@CF00658 DC    F'18'                                                    08919000
@CF01320 DC    F'19'                                                    08920000
@CF00660 DC    F'21'                                                    08921000
@CF00662 DC    F'22'                                                    08922000
@CF00664 DC    F'23'                                                    08923000
@CF00312 DC    F'24'                                                    08924000
@CH00312 EQU   @CF00312+2                                               08925000
@CF00643 DC    F'26'                                                    08926000
@CF01206 DC    F'27'                                                    08927000
@CF01297 DC    F'28'                                                    08928000
@CF01410 DC    F'29'                                                    08929000
@CF00952 DC    F'30'                                                    08930000
@CF00049 DC    F'31'                                                    08931000
@CF00224 DC    F'32'                                                    08932000
@CH00224 EQU   @CF00224+2                                               08933000
@CF00818 DC    F'99'                                                    08934000
@CF01001 DC    F'121'                                                   08935000
@CF01189 DC    F'257'                                                   08936000
@CF01411 DC    F'365'                                                   08937000
@CF01409 DC    F'366'                                                   08938000
@CF01449 DC    F'1536'                                                  08939000
@CF01451 DC    F'2048'                                                  08940000
@CF01492 DC    F'-513'                                                  08941000
@CF01464 DC    F'-512'                                                  08942000
@CF01465 DC    F'-256'                                                  08943000
@CF01469 DC    F'-68'                                                   08944000
@CF01478 DC    F'-67'                                                   08945000
@CF01491 DC    F'-64'                                                   08946000
@CF01483 DC    F'-56'                                                   08947000
@CF01484 DC    F'-12'                                                   08948000
@CF01477 DC    F'-11'                                                   08949000
@CF01493 DC    F'-10'                                                   08950000
@CF01482 DC    F'-8'                                                    08951000
@CF01473 DC    F'-7'                                                    08952000
@CF01476 DC    F'-4'                                                    08953000
@CF01466 DC    F'-3'                                                    08954000
@CF01475 DC    XL4'0000FFFF'                                            08955000
@CF00897 DC    XL4'FFFFFF'                                              08956000
@CF01194 DC    XL4'7FFFFF'                                              08957000
@DATD    DSECT                                                          08958000
         DS    0D                                                       08959000
LISTSCAN DS    A                                                        08960000
DDSTRU   DS    A                                                        08961000
FSADDR   DS    A                                                        08962000
ERCNVADR DS    A                                                        08963000
DMPINDEX DS    A                                                        08964000
AAPTRSAV DS    A                                                        08965000
ADPTRSAV DS    A                                                        08966000
ATPTRNXT DS    A                                                        08967000
ATPTRSAV DS    A                                                        08968000
A2PTRSAV DS    A                                                        08969000
CATFLDLN DS    F                                                        08970000
CRAFLDLN DS    F                                                        08971000
RSVUTPTR DS    A                                                        08972000
TSTPTR   DS    A                                                        08973000
VEPTRBEG DS    A                                                        08974000
VEPTRNXT DS    A                                                        08975000
IOCSALT  DS    A                                                        08976000
IOCSCAT  DS    A                                                        08977000
IOCSCRA  DS    A                                                        08978000
IOCSPRT  DS    A                                                        08979000
DDSTRUE  DS    A                                                        08980000
FMPLAD   DS    A                                                        08981000
STLEN    DS    F                                                        08982000
GRPS2CMP DS    F                                                        08983000
TSTDAYS  DS    F                                                        08984000
TSTPDAY  DS    F                                                        08985000
SUMSUM   DS    F                                                        08986000
LISTPTR  DS    A                                                        08987000
TESTRC   DS    H                                                        08988000
CTTSLOT  DS    H                                                        08989000
ENTNOCUR DS    H                                                        08990000
ENTNOSAV DS    H                                                        08991000
LINEOFST DS    H                                                        08992000
LRLASTCC DS    H                                                        08993000
LRTEMPCC DS    H                                                        08994000
MCENTCNT DS    H                                                        08995000
MCRCDCNT DS    H                                                        08996000
NBRASOCS DS    H                                                        08997000
NBRMCFMC DS    H                                                        08998000
STSLTCNT DS    H                                                        08999000
VEFIELD  DS    H                                                        09000000
CNTREPNO DS    H                                                        09001000
RELREPNO DS    H                                                        09002000
ATFIELD  DS    H                                                        09003000
SETRC    DS    H                                                        09004000
BUFNO    DS    FL1                                                      09005000
         DS    CL2                                                      09006000
CATCI    DS    FL3                                                      09007000
CHARINDX DS    FL1                                                      09008000
CRACNT   DS    FL3                                                      09009000
CRAFMRTC DS    FL1                                                      09010000
ERRCNTIO DS    FL1                                                      09011000
INDNTCOL DS    FL1                                                      09012000
LINE     DS    FL1                                                      09013000
MCBFOFST DS    FL1                                                      09014000
RQDLINES DS    FL1                                                      09015000
         DS    CL3                                                      09016000
SAVCRCI  DS    FL3                                                      09017000
         DS    CL1                                                      09018000
SAVCTCI  DS    FL3                                                      09019000
LISTLN   DS    FL1                                                      09020000
@TS00001 DS    CL256                                                    09021000
ASOCTYP  DS    CL1                                                      09022000
BASETYPE DS    CL1                                                      09023000
CATNMCRA DS    CL44                                                     09024000
         DS    CL1                                                      09025000
CIS      DS    CL32                                                     09026000
         ORG   CIS                                                      09027000
CISNAME  DS    CL4                                                      09028000
         DS    CL1                                                      09029000
CIBASE   DS    FL3                                                      09030000
         DS    CL1                                                      09031000
CIFRGET  DS    FL3                                                      09032000
         DS    CL1                                                      09033000
CIFRTRNS DS    FL3                                                      09034000
         DS    CL1                                                      09035000
CIHOREXT DS    FL3                                                      09036000
         DS    CL1                                                      09037000
CILOOP   DS    FL3                                                      09038000
         DS    CL1                                                      09039000
CISAVED  DS    FL3                                                      09040000
         DS    CL1                                                      09041000
CI1STHE  DS    FL3                                                      09042000
         ORG   CIS+32                                                   09043000
ENQNAME  DS    CL8                                                      09044000
         ORG   ENQNAME                                                  09045000
ENQVLSR  DS    CL6                                                      09046000
ENQCON   DS    CL2                                                      09047000
         ORG   ENQNAME+8                                                09048000
ENTYP    DS    CL1                                                      09049000
ENTYPSAV DS    CL1                                                      09050000
MCMSG    DS    CL48                                                     09051000
MCMPRMRK DS    CL1                                                      09052000
PROCMSG  DS    CL8                                                      09053000
         DS    CL1                                                      09054000
MCWA     DS    CL256                                                    09055000
         ORG   MCWA                                                     09056000
MCWALEN  DS    FL2                                                      09057000
MCWKAR   DS    CL254                                                    09058000
         ORG   MCWA+256                                                 09059000
RSVMINM  DS    CL45                                                     09060000
         ORG   RSVMINM                                                  09061000
CNLEN    DS    FL1                                                      09062000
CATNAME  DS    CL44                                                     09063000
         ORG   RSVMINM+45                                               09064000
         DS    CL3                                                      09065000
RSVUTBL  DS    CL11                                                     09066000
         DS    CL1                                                      09067000
SW       DS    CL12                                                     09068000
         ORG   SW                                                       09069000
SWNAME   DS    CL8                                                      09070000
SWITCHES DS    BL4                                                      09071000
         ORG   SWITCHES                                                 09072000
CMPRPASW DS    BL1                                                      09073000
CMPRSW   EQU   SWITCHES+0                                               09074000
COMERRSW EQU   SWITCHES+0                                               09075000
CRAOPNSW EQU   SWITCHES+0                                               09076000
CTORCRSW EQU   SWITCHES+0                                               09077000
DUMPSW   EQU   SWITCHES+0                                               09078000
FRSTIMSW EQU   SWITCHES+0                                               09079000
FRSTVESW EQU   SWITCHES+0                                               09080000
HRONLYSW DS    BL1                                                      09081000
KEYRNGSW EQU   SWITCHES+1                                               09082000
LASTATSW EQU   SWITCHES+1                                               09083000
LASTVESW EQU   SWITCHES+1                                               09084000
MSCMPRSW EQU   SWITCHES+1                                               09085000
NOALIASW EQU   SWITCHES+1                                               09086000
NOCATRSW EQU   SWITCHES+1                                               09087000
NOCNTSW  EQU   SWITCHES+1                                               09088000
PRNTPASW DS    BL1                                                      09089000
SAVESW   EQU   SWITCHES+2                                               09090000
SAVESW1  EQU   SWITCHES+2                                               09091000
SAVESW2  EQU   SWITCHES+2                                               09092000
SAVESW3  EQU   SWITCHES+2                                               09093000
SBTSETSW EQU   SWITCHES+2                                               09094000
SDUMPSW  EQU   SWITCHES+2                                               09095000
SORTOKSW EQU   SWITCHES+2                                               09096000
VEDUPSW  DS    BL1                                                      09097000
FLDMGTER EQU   SWITCHES+3                                               09098000
         ORG   SW+12                                                    09099000
TIMSTMPS DS    CL24                                                     09100000
         ORG   TIMSTMPS                                                 09101000
TIMLENWA DS    FL2                                                      09102000
@NM00036 DS    FL2                                                      09103000
TIMGROUP DS    CL20                                                     09104000
         ORG   TIMGROUP                                                 09105000
TIMGRPCD DS    FL2                                                      09106000
TIMGRPLN DS    FL2                                                      09107000
F4TSTVSM DS    CL8                                                      09108000
F4TSTDMP DS    CL8                                                      09109000
         ORG   TIMSTMPS+24                                              09110000
VOLHD1   DS    CL4                                                      09111000
VOLHD2   DS    CL3                                                      09112000
         DS    CL1                                                      09113000
OPNAGLST DS    BL48                                                     09114000
IOINBYTE DS    CL1                                                      09115000
         DS    CL3                                                      09116000
DARGLST  DS    CL100                                                    09117000
DARGLSTE DS    CL28                                                     09118000
PCARGLST DS    CL34                                                     09119000
         ORG   PCARGLST                                                 09120000
PCMTLP   DS    AL4                                                      09121000
PCSTLP   DS    AL4                                                      09122000
PCFLP    DS    AL4                                                      09123000
PCPCP    DS    AL4                                                      09124000
PCPNL    DS    FL2                                                      09125000
PCPTL    DS    FL2                                                      09126000
PCPDL    DS    FL2                                                      09127000
PCMTLC   DS    FL2                                                      09128000
PCSTLC   DS    FL2                                                      09129000
PCFLC    DS    FL2                                                      09130000
PCLW     DS    FL2                                                      09131000
PCPD     DS    FL2                                                      09132000
PCDSC    DS    FL2                                                      09133000
         ORG   PCARGLST+34                                              09134000
         DS    CL2                                                      09135000
PCRST    DS    CL8                                                      09136000
         ORG   PCRST                                                    09137000
PCRSTT   DS    CL2                                                      09138000
PCRSTLC  DS    FL2                                                      09139000
PCRSTLP  DS    AL4                                                      09140000
         ORG   PCRST+8                                                  09141000
SUBTITLE DS    CL121                                                    09142000
         ORG   SUBTITLE                                                 09143000
SUBTSPCT DS    CL1                                                      09144000
@NM00037 DS    CL24                                                     09145000
SUBT47   DS    CL47                                                     09146000
SUBTVLSR DS    CL6                                                      09147000
SUBT4    DS    CL4                                                      09148000
SUBGROUP DS    CL16                                                     09149000
@NM00038 DS    CL23                                                     09150000
         ORG   SUBTITLE+121                                             09151000
         DS    CL3                                                      09152000
FMPLST   DS    CL44                                                     09153000
FMUDATA  DS    CL32                                                     09154000
         ORG   FMUDATA                                                  09155000
FMUBFPTR DS    AL4                                                      09156000
FMUIOCSI DS    AL4                                                      09157000
FMUIOCSP DS    AL4                                                      09158000
FMUDARGP DS    AL4                                                      09159000
FMUGDTP  DS    AL4                                                      09160000
FMUCTTP  DS    AL4                                                      09161000
FMUGETMN DS    AL4                                                      09162000
FMUBUFNO DS    AL1                                                      09163000
FMUFLAGS DS    BL1                                                      09164000
         ORG   FMUFLAGS                                                 09165000
FMU1STIO DS    BL1                                                      09166000
FMUCATIO EQU   FMUFLAGS+0                                               09167000
FMUFRSP  EQU   FMUFLAGS+0                                               09168000
         ORG   FMUDATA+30                                               09169000
FMULR2CL DS    FL2                                                      09170000
         ORG   FMUDATA+32                                               09171000
FMWA     DS    CL256                                                    09172000
         ORG   FMWA                                                     09173000
FMWALEN  DS    FL2                                                      09174000
FMWKAR   DS    CL254                                                    09175000
         ORG   FMWA+256                                                 09176000
JUNK     DS    CL256                                                    09177000
JUNK2    DS    CL256                                                    09178000
POOLPTRS DS    CL28                                                     09179000
         ORG   POOLPTRS                                                 09180000
POOLNM   DS    CL4                                                      09181000
ATRA2PTR DS    AL4                                                      09182000
ATPTR    DS    AL4                                                      09183000
A2PTR    DS    AL4                                                      09184000
CTTPTR   DS    AL4                                                      09185000
STPTR    DS    AL4                                                      09186000
VEPTR    DS    AL4                                                      09187000
         ORG   POOLPTRS+28                                              09188000
IOBADDRS DS    CL20                                                     09189000
         ORG   IOBADDRS                                                 09190000
IOBADNAM DS    CL8                                                      09191000
IOBFSPTR DS    AL4                                                      09192000
IOCRBPTR DS    AL4                                                      09193000
IOCTBPTR DS    AL4                                                      09194000
         ORG   IOBADDRS+20                                              09195000
STDUMMY  DS    CL56                                                     09196000
TST64BIT DS    CL8                                                      09197000
ENDCLSER DS    CL1                                                      09198000
ENDCLSFM DS    CL1                                                      09199000
ENDCLSFN DS    CL1                                                      09200000
ENDCLSIO DS    CL1                                                      09201000
ENDCLSIS DS    CL1                                                      09202000
ENDCLSPM DS    CL1                                                      09203000
ENDCLSPO DS    CL1                                                      09204000
ENDCLSP0 DS    CL1                                                      09205000
ENDCLSTP DS    CL1                                                      09206000
ENDCLSTS DS    CL1                                                      09207000
ENDCLS0  DS    CL1                                                      09208000
ENDCLS1  DS    CL1                                                      09209000
ENDCLS2  DS    CL1                                                      09210000
ENDCLS3  DS    CL1                                                      09211000
ENDCLS4  DS    CL1                                                      09212000
ENDCLS5  DS    CL1                                                      09213000
ENDCLS6  DS    CL1                                                      09214000
ENDCLS7  DS    CL1                                                      09215000
ENDCLS8  DS    CL1                                                      09216000
ENDCLS9  DS    CL1                                                      09217000
PATCH    DS    CL1                                                      09218000
ENTYPARG DS    3CL1                                                     09219000
MCMPRARY DS    8CL8                                                     09220000
TSTHMS   DS    3H                                                       09221000
TSTMDTBL DS    12AL1                                                    09222000
TSTMDY   DS    3H                                                       09223000
FMFLST   DS    5CL24                                                    09224000
SUMS     DS    26F                                                      09225000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09226000
@ENDDATD EQU   *                                                        09227000
IDCLR01  CSECT                                                          09228000
         DS    0F                                                       09229000
@SIZDATD DC    AL1(0)                                                   09230000
         DC    AL3(@ENDDATD-@DATD)                                      09231000
@CV00793 DC    V(IDCRC04)                                               09232000
@CV00794 DC    V(IDCLR02)                                               09233000
         DS    0D                                                       09234000
GPLEN1ST DC    AL4(44+44+44)                                            09235000
ATLEN    DC    AL4(44)                                                  09236000
IOBFSLEN DC    AL4(2*4*512)                                             09237000
VELEN    DC    AL4(44)                                                  09238000
A2LEN    DC    AL2(44)                                                  09239000
$NONV    DC    AL1(1)                                                   09240000
$GDGB    DC    AL1(2)                                                   09241000
$CLUS    DC    AL1(3)                                                   09242000
$DATA    DC    AL1(4)                                                   09243000
$OEXT    DC    AL1(5)                                                   09244000
$FRSP    DC    AL1(6)                                                   09245000
$AIX     DC    AL1(7)                                                   09246000
$INDX    DC    AL1(9)                                                   09247000
$CCR     DC    AL1(12)                                                  09248000
$PATH    DC    AL1(18)                                                  09249000
$UCAT    DC    AL1(21)                                                  09250000
$VOL     DC    AL1(22)                                                  09251000
$VEXT    DC    AL1(23)                                                  09252000
$ALIA    DC    AL1(24)                                                  09253000
$UPGD    DC    AL1(25)                                                  09254000
$ABORT   DC    AL1(1)                                                   09255000
$RETURN  DC    AL1(0)                                                   09256000
PRTSPACE DC    AL1(0)                                                   09257000
         DS    CL1                                                      09258000
STENDCI  DC    XL3'FFFFFF'                                              09259000
@CC01278 DC    C'LISTING OF CATALOG RECOVERY AREA FOR VOLUME --'        09260000
@CC01196 DC    C'NAMEOFFIELDNOTRETURNED'                                09261000
@CC01357 DC    C'UNSORTED ENTRIES'                                      09262000
@CC01226 EQU   @CC01196                                                 09263000
@CC01243 DC    C'OTHER ENTRIES'                                         09264000
@CC01223 DC    C'VSAM ENTRIES'                                          09265000
@CC00816 DC    C'$$$$$$$$'                                              09266000
@CC01195 DC    C'ENTNAME '                                              09267000
@CC01198 DC    C'CATOPEN '                                              09268000
@CC01204 DC    C'REPNO   '                                              09269000
@CC01205 DC    C'CKEYRNG '                                              09270000
@CC01207 DC    C'HIKEYV  '                                              09271000
@CC01208 DC    C'VOLSER  '                                              09272000
@CC01228 DC    C'CRAOPEN '                                              09273000
@CC01234 DC    C'ENTYPE  '                                              09274000
@CC01235 DC    C'ENTIDNO '                                              09275000
@CC01237 DC    C'CTTBLD  '                                              09276000
@CC01267 DC    C'GETPRT  '                                              09277000
@CC01273 DC    C'SWITCHES'                                              09278000
@CC01275 DC    C'BUFFADDR'                                              09279000
@CC01285 DC    C'RELREPNO'                                              09280000
@CC01287 DC    C'CNTREPNO'                                              09281000
@CC01296 DC    C'INTASOC '                                              09282000
@CC01298 DC    C'NAMEDS  '                                              09283000
@CC01300 DC    C'INTAOSC '                                              09284000
@CC01312 DC    C'INTSORT '                                              09285000
@CC01318 DC    C'$EXTPTRS'                                              09286000
@CC01319 DC    C'INTVEXT '                                              09287000
@CC01336 DC    C'$USEDLEN'                                              09288000
@CC01337 DC    C'PRTCMP  '                                              09289000
@CC01350 DC    C'        '                                              09290000
@CC01388 DC    C'PRTOJVL '                                              09291000
@CC01416 DC    C'VOLTSTMP'                                              09292000
@CC01417 DC    C'PRTVOL  '                                              09293000
@CC00686 EQU   @CC01350                                                 09294000
@CC01222 DC    C'......'                                                09295000
@CC01377 EQU   @CC01243                                                 09296000
@CC00723 DC    C'DATA'                                                  09297000
@CC00728 DC    C'INDX'                                                  09298000
@CC00731 DC    C'UCAT'                                                  09299000
@CC00733 DC    C'VEXT'                                                  09300000
@CC01157 DC    C'LRAA'                                                  09301000
@CC01175 DC    C'LRAD'                                                  09302000
@CC01177 DC    C'ASOC'                                                  09303000
@CC01183 DC    C'LRBL'                                                  09304000
@CC01188 DC    C'LRBU'                                                  09305000
@CC01193 DC    C'LRCA'                                                  09306000
@CC01203 DC    C'LRCK'                                                  09307000
@CC01212 DC    C'LRC1'                                                  09308000
@CC01216 DC    C'LRC2'                                                  09309000
@CC01221 DC    C'LRCR'                                                  09310000
@CC01233 DC    C'LRCT'                                                  09311000
@CC01242 DC    C'LRDO'                                                  09312000
@CC01249 DC    C'LRDV'                                                  09313000
@CC01258 DC    C'LRER'                                                  09314000
@CC01260 DC    C'LRZY'                                                  09315000
@CC01261 DC    C'LRZZ'                                                  09316000
@CC01265 DC    C'LRGE'                                                  09317000
@CC01271 DC    C'LRIN'                                                  09318000
@CC01274 DC    C'POOL'                                                  09319000
@CC01282 DC    C' -- '                                                  09320000
@CC01289 DC    C'ASO2'                                                  09321000
@CC01295 DC    C'LRIA'                                                  09322000
@CC01308 DC    C'LRIS'                                                  09323000
@CC01317 DC    C'LRIV'                                                  09324000
@CC01324 DC    C'LRME'                                                  09325000
@CC01329 DC    C'LRPA'                                                  09326000
@CC01334 DC    C'LRPC'                                                  09327000
@CC01344 DC    C'LRPD'                                                  09328000
@CC01349 DC    C'LRPE'                                                  09329000
@CC01356 DC    C'LRPF'                                                  09330000
@CC01371 DC    C'LRPM'                                                  09331000
@CC01382 DC    C'LRPJ'                                                  09332000
@CC01386 DC    C'LRPK'                                                  09333000
@CC01392 DC    C'LRPO'                                                  09334000
@CC01402 DC    C'LRPT'                                                  09335000
@CC01415 DC    C'LRPW'                                                  09336000
@CC01421 DC    C'LRPV'                                                  09337000
@CC01429 DC    C'LRSM'                                                  09338000
@CC01433 DC    C'SUM '                                                  09339000
@CC01439 DC    C'LRTC'                                                  09340000
@CC01443 DC    C'LRVE'                                                  09341000
@CC00775 DC    C'LR1'                                                   09342000
@CC00776 EQU   @CC01350                                                 09343000
@CC00777 DC    C'UV0'                                                   09344000
@CC01276 DC    C'CIS'                                                   09345000
@CC01335 DC    C'LR0'                                                   09346000
@CC01387 DC    C' - '                                                   09347000
@CC01272 DC    C'00'                                                    09348000
@CC01283 DC    C'ST'                                                    09349000
@CC01351 DC    C'**'                                                    09350000
@CC00785 EQU   @CC01350                                                 09351000
@CB01310 DC    X'FFFFFFFFFFFFFFFFFFFF'                                  09352000
ALL      DC    CL3'ALL'                                                 09353000
FORMAT   DC    CL4'FORM'                                                09354000
HSECOND  DC    CL4'HSEC'                                                09355000
CLOCK    DC    CL4'KLOK'                                                09356000
SETZERO  DC    CL4'ZERO'                                                09357000
SETBLANK DC    CL4'BLNK'                                                09358000
NOSET    DC    CL4'NSET'                                                09359000
OVERRIDE DC    CL4'OVRD'                                                09360000
ACQUIRE  DC    CL8'ACQUIRE '                                            09361000
RELINQ   DC    CL8'RELINQ  '                                            09362000
MOUNT    DC    CL8'MOUNT   '                                            09363000
DEMOUNT  DC    CL8'DEMOUNT '                                            09364000
DEFINE   DC    CL8'DEFINE  '                                            09365000
MOVE     DC    CL8'MOVE    '                                            09366000
TRACEQ   DC    CL8'TRACEQ  '                                            09367000
COPYTABL DC    CL8'COPYTABL'                                            09368000
COPYCRTG DC    CL8'COPYCRTG'                                            09369000
COPYVOL  DC    CL8'COPYVOL '                                            09370000
VVIC     DC    CL8'VVIC    '                                            09371000
TUNE     DC    CL8'TUNE    '                                            09372000
NAMES    DC    CL4'NAME'                                                09373000
UNIT     DC    CL4'UNIT'                                                09374000
SHR      DC    CL4'SHR '                                                09375000
EXCL     DC    CL4'EXCL'                                                09376000
NOWAIT   DC    CL4'NWAI'                                                09377000
WAIT     DC    CL4'WAIT'                                                09378000
BLANKS6  DC    CL6'      '                                              09379000
         DS    CL1                                                      09380000
FIXAREA  DS    CL1000                                                   09381000
         ORG   FIXAREA                                                  09382000
@NM00035 DC    CL8'FIXAREA'                                             09383000
         ORG   FIXAREA+1000                                             09384000
MMGRP1   DC    CL32'CATALOG ENTRY HAS DIFFERENT NAME'                   09385000
MMGRP2   DC    CL18'VOLUME OR KEYRANGE'                                 09386000
MMGRP3   DC    CL7'EXTENTS'                                             09387000
MMGRP4   DC    CL13'HIGH USED RBA'                                      09388000
MMGRP5   DC    CL10'STATISTICS'                                         09389000
MMGRP99  DC    CL1' '                                                   09390000
MVGRP1   DC    CL18'DATA SPACE EXTENTS'                                 09391000
MVGRP2   DC    CL18'DATA SET DIRECTORY'                                 09392000
MODID    DC    CL4'LR01'                                                09393000
MODIDCTT DC    CL4'LR11'                                                09394000
MODIDPG  DC    CL4'LRPG'                                                09395000
MODIDST  DC    CL4'LR12'                                                09396000
NCATRCD  DC    CL6'CATRCD'                                              09397000
RSVMJNM  DC    CL8'SYSIGGV2'                                            09398000
SMACCUM  DC    CL1'A'                                                   09399000
SMINIT   DC    CL1'I'                                                   09400000
SMPRINT  DC    CL1'P'                                                   09401000
VOLHD3   DC    CL8'HIGH KEY'                                            09402000
CATRCDS  DS    CL5                                                      09403000
         ORG   CATRCDS+0                                                09404000
CATRCTYP DC    CL1'A'                                                   09405000
CATRDESC DC    CL4'NONV'                                                09406000
         ORG   CATRCDS+5                                                09407000
         ORG   CATRCDS+5                                                09408000
         DC    CL1'B'                                                   09409000
         DC    CL4'GDGB'                                                09410000
         ORG   CATRCDS+10                                               09411000
         ORG   CATRCDS+10                                               09412000
         DC    CL1'C'                                                   09413000
         DC    CL4'CLUS'                                                09414000
         ORG   CATRCDS+15                                               09415000
         ORG   CATRCDS+15                                               09416000
         DC    CL1'D'                                                   09417000
         DC    CL4'DATA'                                                09418000
         ORG   CATRCDS+20                                               09419000
         ORG   CATRCDS+20                                               09420000
         DC    CL1'E'                                                   09421000
         DC    CL4'OEXT'                                                09422000
         ORG   CATRCDS+25                                               09423000
         ORG   CATRCDS+25                                               09424000
         DC    CL1'F'                                                   09425000
         DC    CL4'FRSP'                                                09426000
         ORG   CATRCDS+30                                               09427000
         ORG   CATRCDS+30                                               09428000
         DC    CL1'G'                                                   09429000
         DC    CL4'AIX '                                                09430000
         ORG   CATRCDS+35                                               09431000
         ORG   CATRCDS+35                                               09432000
         DC    CL1'H'                                                   09433000
         DC    CL4'    '                                                09434000
         ORG   CATRCDS+40                                               09435000
         ORG   CATRCDS+40                                               09436000
         DC    CL1'I'                                                   09437000
         DC    CL4'INDX'                                                09438000
         ORG   CATRCDS+45                                               09439000
         ORG   CATRCDS+45                                               09440000
         DC    CL1'J'                                                   09441000
         DC    CL4'    '                                                09442000
         ORG   CATRCDS+50                                               09443000
         ORG   CATRCDS+50                                               09444000
         DC    CL1'K'                                                   09445000
         DC    CL4'    '                                                09446000
         ORG   CATRCDS+55                                               09447000
         ORG   CATRCDS+55                                               09448000
         DC    CL1'L'                                                   09449000
         DC    CL4'CCR '                                                09450000
         ORG   CATRCDS+60                                               09451000
         ORG   CATRCDS+60                                               09452000
         DC    CL1'M'                                                   09453000
         DC    CL4'    '                                                09454000
         ORG   CATRCDS+65                                               09455000
         ORG   CATRCDS+65                                               09456000
         DC    CL1'N'                                                   09457000
         DC    CL4'    '                                                09458000
         ORG   CATRCDS+70                                               09459000
         ORG   CATRCDS+70                                               09460000
         DC    CL1'O'                                                   09461000
         DC    CL4'    '                                                09462000
         ORG   CATRCDS+75                                               09463000
         ORG   CATRCDS+75                                               09464000
         DC    CL1'P'                                                   09465000
         DC    CL4'    '                                                09466000
         ORG   CATRCDS+80                                               09467000
         ORG   CATRCDS+80                                               09468000
         DC    CL1'Q'                                                   09469000
         DC    CL4'    '                                                09470000
         ORG   CATRCDS+85                                               09471000
         ORG   CATRCDS+85                                               09472000
         DC    CL1'R'                                                   09473000
         DC    CL4'PATH'                                                09474000
         ORG   CATRCDS+90                                               09475000
         ORG   CATRCDS+90                                               09476000
         DC    CL1'S'                                                   09477000
         DC    CL4'    '                                                09478000
         ORG   CATRCDS+95                                               09479000
         ORG   CATRCDS+95                                               09480000
         DC    CL1'T'                                                   09481000
         DC    CL4'    '                                                09482000
         ORG   CATRCDS+100                                              09483000
         ORG   CATRCDS+100                                              09484000
         DC    CL1'U'                                                   09485000
         DC    CL4'UCAT'                                                09486000
         ORG   CATRCDS+105                                              09487000
         ORG   CATRCDS+105                                              09488000
         DC    CL1'V'                                                   09489000
         DC    CL4'VOL '                                                09490000
         ORG   CATRCDS+110                                              09491000
         ORG   CATRCDS+110                                              09492000
         DC    CL1'W'                                                   09493000
         DC    CL4'VEXT'                                                09494000
         ORG   CATRCDS+115                                              09495000
         ORG   CATRCDS+115                                              09496000
         DC    CL1'X'                                                   09497000
         DC    CL4'ALIA'                                                09498000
         ORG   CATRCDS+120                                              09499000
         ORG   CATRCDS+120                                              09500000
         DC    CL1'Y'                                                   09501000
         DC    CL4'UPGD'                                                09502000
         ORG   CATRCDS+125                                              09503000
         ORG   CATRCDS+125                                              09504000
         DC    CL1'Z'                                                   09505000
         DC    CL4'    '                                                09506000
         ORG   CATRCDS+130                                              09507000
ERRTBL   DS    CL12                                                     09508000
         ORG   ERRTBL+0                                                 09509000
ERRRTNCD DC    AL1(8)                                                   09510000
ERRSTMOD DC    CL3'LR1'                                                 09511000
ERRSTENT DC    AL1(9)                                                   09512000
ERRILEN  DC    AL1(8)                                                   09513000
@NM00034 DS    CL2                                                      09514000
ERRIADDR DC    A(5)                                                     09515000
         ORG   ERRTBL+12                                                09516000
         ORG   ERRTBL+12                                                09517000
         DC    AL1(8)                                                   09518000
         DC    CL3'LR1'                                                 09519000
         DC    AL1(7)                                                   09520000
         DC    AL1(0)                                                   09521000
         DS    CL2                                                      09522000
         DC    AL4(@CC00785)                                            09523000
         ORG   ERRTBL+24                                                09524000
         ORG   ERRTBL+24                                                09525000
         DC    AL1(8)                                                   09526000
         DC    CL3'LR1'                                                 09527000
         DC    AL1(10)                                                  09528000
         DC    AL1(0)                                                   09529000
         DS    CL2                                                      09530000
         DC    AL4(@CC00785)                                            09531000
         ORG   ERRTBL+36                                                09532000
         ORG   ERRTBL+36                                                09533000
         DC    AL1(8)                                                   09534000
         DC    CL3'LR1'                                                 09535000
         DC    AL1(4)                                                   09536000
         DC    AL1(0)                                                   09537000
         DS    CL2                                                      09538000
         DC    AL4(@CC00785)                                            09539000
         ORG   ERRTBL+48                                                09540000
         ORG   ERRTBL+48                                                09541000
         DC    AL1(4)                                                   09542000
         DC    CL3'LR1'                                                 09543000
         DC    AL1(9)                                                   09544000
         DC    AL1(8)                                                   09545000
         DS    CL2                                                      09546000
         DC    A(5)                                                     09547000
         ORG   ERRTBL+60                                                09548000
         ORG   ERRTBL+60                                                09549000
         DC    AL1(8)                                                   09550000
         DC    CL3'LR1'                                                 09551000
         DC    AL1(3)                                                   09552000
         DC    AL1(44)                                                  09553000
         DS    CL2                                                      09554000
         DC    A(1)                                                     09555000
         ORG   ERRTBL+72                                                09556000
         ORG   ERRTBL+72                                                09557000
         DC    AL1(8)                                                   09558000
         DC    CL3'LR1'                                                 09559000
         DC    AL1(9)                                                   09560000
         DC    AL1(8)                                                   09561000
         DS    CL2                                                      09562000
         DC    A(5)                                                     09563000
         ORG   ERRTBL+84                                                09564000
         ORG   ERRTBL+84                                                09565000
         DC    AL1(8)                                                   09566000
         DC    CL3'LR1'                                                 09567000
         DC    AL1(6)                                                   09568000
         DC    AL1(0)                                                   09569000
         DS    CL2                                                      09570000
         DC    AL4(@CC00785)                                            09571000
         ORG   ERRTBL+96                                                09572000
         ORG   ERRTBL+96                                                09573000
         DC    AL1(8)                                                   09574000
         DC    CL3'   '                                                 09575000
         DC    AL1(0)                                                   09576000
         DC    AL1(0)                                                   09577000
         DS    CL2                                                      09578000
         DC    AL4(@CC00785)                                            09579000
         ORG   ERRTBL+108                                               09580000
         ORG   ERRTBL+108                                               09581000
         DC    AL1(0)                                                   09582000
         DC    CL3'LR1'                                                 09583000
         DC    AL1(4)                                                   09584000
         DC    AL1(0)                                                   09585000
         DS    CL2                                                      09586000
         DC    AL4(@CC00785)                                            09587000
         ORG   ERRTBL+120                                               09588000
         ORG   ERRTBL+120                                               09589000
         DC    AL1(12)                                                  09590000
         DC    CL3'LR1'                                                 09591000
         DC    AL1(13)                                                  09592000
         DC    AL1(0)                                                   09593000
         DS    CL2                                                      09594000
         DC    AL4(@CC00785)                                            09595000
         ORG   ERRTBL+132                                               09596000
         ORG   ERRTBL+132                                               09597000
         DC    AL1(4)                                                   09598000
         DC    CL3'LR1'                                                 09599000
         DC    AL1(9)                                                   09600000
         DC    AL1(8)                                                   09601000
         DS    CL2                                                      09602000
         DC    A(5)                                                     09603000
         ORG   ERRTBL+144                                               09604000
         ORG   ERRTBL+144                                               09605000
         DC    AL1(8)                                                   09606000
         DC    CL3'LR1'                                                 09607000
         DC    AL1(2)                                                   09608000
         DC    AL1(3)                                                   09609000
         DS    CL2                                                      09610000
         DC    A(2)                                                     09611000
         ORG   ERRTBL+156                                               09612000
         ORG   ERRTBL+156                                               09613000
         DC    AL1(8)                                                   09614000
         DC    CL3'LR1'                                                 09615000
         DC    AL1(9)                                                   09616000
         DC    AL1(8)                                                   09617000
         DS    CL2                                                      09618000
         DC    A(5)                                                     09619000
         ORG   ERRTBL+168                                               09620000
         ORG   ERRTBL+168                                               09621000
         DC    AL1(8)                                                   09622000
         DC    CL3'LR1'                                                 09623000
         DC    AL1(1)                                                   09624000
         DC    AL1(3)                                                   09625000
         DS    CL2                                                      09626000
         DC    A(3)                                                     09627000
         ORG   ERRTBL+180                                               09628000
         ORG   ERRTBL+180                                               09629000
         DC    AL1(8)                                                   09630000
         DC    CL3'LR1'                                                 09631000
         DC    AL1(9)                                                   09632000
         DC    AL1(8)                                                   09633000
         DS    CL2                                                      09634000
         DC    A(5)                                                     09635000
         ORG   ERRTBL+192                                               09636000
         ORG   ERRTBL+192                                               09637000
         DC    AL1(8)                                                   09638000
         DC    CL3'LR1'                                                 09639000
         DC    AL1(9)                                                   09640000
         DC    AL1(8)                                                   09641000
         DS    CL2                                                      09642000
         DC    A(5)                                                     09643000
         ORG   ERRTBL+204                                               09644000
         ORG   ERRTBL+204                                               09645000
         DC    AL1(4)                                                   09646000
         DC    CL3'LR1'                                                 09647000
         DC    AL1(5)                                                   09648000
         DC    AL1(0)                                                   09649000
         DS    CL2                                                      09650000
         DC    AL4(@CC00785)                                            09651000
         ORG   ERRTBL+216                                               09652000
         ORG   ERRTBL+216                                               09653000
         DC    AL1(8)                                                   09654000
         DC    CL3'LR1'                                                 09655000
         DC    AL1(9)                                                   09656000
         DC    AL1(8)                                                   09657000
         DS    CL2                                                      09658000
         DC    A(5)                                                     09659000
         ORG   ERRTBL+228                                               09660000
         ORG   ERRTBL+228                                               09661000
         DC    AL1(8)                                                   09662000
         DC    CL3'LR1'                                                 09663000
         DC    AL1(9)                                                   09664000
         DC    AL1(8)                                                   09665000
         DS    CL2                                                      09666000
         DC    A(5)                                                     09667000
         ORG   ERRTBL+240                                               09668000
         ORG   ERRTBL+240                                               09669000
         DC    AL1(8)                                                   09670000
         DC    CL3'LR1'                                                 09671000
         DC    AL1(9)                                                   09672000
         DC    AL1(8)                                                   09673000
         DS    CL2                                                      09674000
         DC    A(5)                                                     09675000
         ORG   ERRTBL+252                                               09676000
         ORG   ERRTBL+252                                               09677000
         DC    AL1(8)                                                   09678000
         DC    CL3'LR1'                                                 09679000
         DC    AL1(9)                                                   09680000
         DC    AL1(8)                                                   09681000
         DS    CL2                                                      09682000
         DC    A(5)                                                     09683000
         ORG   ERRTBL+264                                               09684000
         ORG   ERRTBL+264                                               09685000
         DC    AL1(8)                                                   09686000
         DC    CL3'LR1'                                                 09687000
         DC    AL1(9)                                                   09688000
         DC    AL1(8)                                                   09689000
         DS    CL2                                                      09690000
         DC    A(5)                                                     09691000
         ORG   ERRTBL+276                                               09692000
         ORG   ERRTBL+276                                               09693000
         DC    AL1(8)                                                   09694000
         DC    CL3'LR1'                                                 09695000
         DC    AL1(11)                                                  09696000
         DC    AL1(0)                                                   09697000
         DS    CL2                                                      09698000
         DC    AL4(@CC00785)                                            09699000
         ORG   ERRTBL+288                                               09700000
         ORG   ERRTBL+288                                               09701000
         DC    AL1(4)                                                   09702000
         DC    CL3'LR1'                                                 09703000
         DC    AL1(12)                                                  09704000
         DC    AL1(0)                                                   09705000
         DS    CL2                                                      09706000
         DC    AL4(@CC00785)                                            09707000
         ORG   ERRTBL+300                                               09708000
         ORG   ERRTBL+300                                               09709000
         DC    AL1(8)                                                   09710000
         DC    CL3'LR1'                                                 09711000
         DC    AL1(9)                                                   09712000
         DC    AL1(8)                                                   09713000
         DS    CL2                                                      09714000
         DC    A(5)                                                     09715000
         ORG   ERRTBL+312                                               09716000
         ORG   ERRTBL+312                                               09717000
         DC    AL1(8)                                                   09718000
         DC    CL3'LR1'                                                 09719000
         DC    AL1(9)                                                   09720000
         DC    AL1(8)                                                   09721000
         DS    CL2                                                      09722000
         DC    A(5)                                                     09723000
         ORG   ERRTBL+324                                               09724000
         ORG   ERRTBL+324                                               09725000
         DC    AL1(8)                                                   09726000
         DC    CL3'LR1'                                                 09727000
         DC    AL1(9)                                                   09728000
         DC    AL1(8)                                                   09729000
         DS    CL2                                                      09730000
         DC    A(5)                                                     09731000
         ORG   ERRTBL+336                                               09732000
         ORG   ERRTBL+336                                               09733000
         DC    AL1(8)                                                   09734000
         DC    CL3'LR1'                                                 09735000
         DC    AL1(15)                                                  09736000
         DC    AL1(3)                                                   09737000
         DS    CL2                                                      09738000
         DC    A(4)                                                     09739000
         ORG   ERRTBL+348                                               09740000
         ORG   ERRTBL+348                                               09741000
         DC    AL1(4)                                                   09742000
         DC    CL3'LR1'                                                 09743000
         DC    AL1(17)                                                  09744000
         DC    AL1(0)                                                   09745000
         DS    CL2                                                      09746000
         DC    AL4(@CC00785)                                            09747000
         ORG   ERRTBL+360                                               09748000
         ORG   ERRTBL+360                                               09749000
         DC    AL1(16)                                                  09750000
         DC    CL3'UV0'                                                 09751000
         DC    AL1(3)                                                   09752000
         DC    AL1(0)                                                   09753000
         DS    CL2                                                      09754000
         DC    AL4(@CC00785)                                            09755000
         ORG   ERRTBL+372                                               09756000
         ORG   ERRTBL+372                                               09757000
         DC    AL1(16)                                                  09758000
         DC    CL3'UV0'                                                 09759000
         DC    AL1(4)                                                   09760000
         DC    AL1(0)                                                   09761000
         DS    CL2                                                      09762000
         DC    AL4(@CC00785)                                            09763000
         ORG   ERRTBL+384                                               09764000
MCARGTBL DS    CL10                                                     09765000
         ORG   MCARGTBL+0                                               09766000
MAFLDNM  DC    CL8'ENTNAME'                                             09767000
MAGROUP  DC    AL1(1)                                                   09768000
MACTGRPC DC    AL1(0)                                                   09769000
         ORG   MCARGTBL+10                                              09770000
         ORG   MCARGTBL+10                                              09771000
         DC    CL8'ENTYPE'                                              09772000
         DC    AL1(1)                                                   09773000
         DC    AL1(0)                                                   09774000
         ORG   MCARGTBL+20                                              09775000
         ORG   MCARGTBL+20                                              09776000
         DC    CL8'CRADITS'                                             09777000
         DC    AL1(1)                                                   09778000
         DC    AL1(0)                                                   09779000
         ORG   MCARGTBL+30                                              09780000
         ORG   MCARGTBL+30                                              09781000
         DC    CL8'VOLSER'                                              09782000
         DC    AL1(2)                                                   09783000
         DC    AL1(3)                                                   09784000
         ORG   MCARGTBL+40                                              09785000
         ORG   MCARGTBL+40                                              09786000
         DC    CL8'DEVTYP'                                              09787000
         DC    AL1(2)                                                   09788000
         DC    AL1(3)                                                   09789000
         ORG   MCARGTBL+50                                              09790000
         ORG   MCARGTBL+50                                              09791000
         DC    CL8'LOKEYV'                                              09792000
         DC    AL1(2)                                                   09793000
         DC    AL1(3)                                                   09794000
         ORG   MCARGTBL+60                                              09795000
         ORG   MCARGTBL+60                                              09796000
         DC    CL8'HIKEYV'                                              09797000
         DC    AL1(2)                                                   09798000
         DC    AL1(3)                                                   09799000
         ORG   MCARGTBL+70                                              09800000
         ORG   MCARGTBL+70                                              09801000
         DC    CL8'HARBA'                                               09802000
         DC    AL1(3)                                                   09803000
         DC    AL1(3)                                                   09804000
         ORG   MCARGTBL+80                                              09805000
         ORG   MCARGTBL+80                                              09806000
         DC    CL8'EXTENT'                                              09807000
         DC    AL1(3)                                                   09808000
         DC    AL1(3)                                                   09809000
         ORG   MCARGTBL+90                                              09810000
         ORG   MCARGTBL+90                                              09811000
         DC    CL8'HURBA'                                               09812000
         DC    AL1(4)                                                   09813000
         DC    AL1(3)                                                   09814000
         ORG   MCARGTBL+100                                             09815000
         ORG   MCARGTBL+100                                             09816000
         DC    CL8'AMDSBCAT'                                            09817000
         DC    AL1(5)                                                   09818000
         DC    AL1(1)                                                   09819000
         ORG   MCARGTBL+110                                             09820000
         ORG   MCARGTBL+110                                             09821000
         DC    CL8'$$$$$$$$'                                            09822000
         DC    AL1(99)                                                  09823000
         DC    AL1(99)                                                  09824000
         ORG   MCARGTBL+120                                             09825000
MCARGTBV DS    CL10                                                     09826000
         ORG   MCARGTBV+0                                               09827000
MAFLDNMV DC    CL8'$SPCEHDR'                                            09828000
MAGROUPV DC    AL1(1)                                                   09829000
MACTGPCV DC    AL1(6)                                                   09830000
         ORG   MCARGTBV+10                                              09831000
         ORG   MCARGTBV+10                                              09832000
         DC    CL8'DIRECTRY'                                            09833000
         DC    AL1(2)                                                   09834000
         DC    AL1(8)                                                   09835000
         ORG   MCARGTBV+20                                              09836000
         ORG   MCARGTBV+20                                              09837000
         DC    CL8'$$$$$$$$'                                            09838000
         DC    AL1(99)                                                  09839000
         DC    AL1(99)                                                  09840000
         ORG   MCARGTBV+30                                              09841000
         DS    CL2                                                      09842000
MCMSGTBL DC    AL4(MMGRP1)                                              09843000
         DC    AL4(MMGRP2)                                              09844000
         DC    AL4(MMGRP3)                                              09845000
         DC    AL4(MMGRP4)                                              09846000
         DC    AL4(MMGRP5)                                              09847000
         DC    AL4(MMGRP99)                                             09848000
MCMSGTBV DC    AL4(MVGRP1)                                              09849000
         DC    AL4(MVGRP2)                                              09850000
         DC    AL4(MMGRP99)                                             09851000
MCMLNTBL DC    AL1(32)                                                  09852000
         DC    AL1(18)                                                  09853000
         DC    AL1(7)                                                   09854000
         DC    AL1(13)                                                  09855000
         DC    AL1(10)                                                  09856000
         DC    AL1(1)                                                   09857000
MCMLNTBV DC    AL1(18)                                                  09858000
         DC    AL1(18)                                                  09859000
         DC    AL1(1)                                                   09860000
TSTDESC  DC    CL10'CATVOLRCD'                                          09861000
         DC    CL10'CRAVOLRCD'                                          09862000
         DC    CL10'F4DSCBVSAM'                                         09863000
         DC    CL10'F4DSCBDUMP'                                         09864000
TSTMDINT DC    AL1(31)                                                  09865000
         DC    AL1(0)                                                   09866000
         DC    AL1(31)                                                  09867000
         DC    AL1(30)                                                  09868000
         DC    AL1(31)                                                  09869000
         DC    AL1(30)                                                  09870000
         DC    AL1(31)                                                  09871000
         DC    AL1(31)                                                  09872000
         DC    AL1(30)                                                  09873000
         DC    AL1(31)                                                  09874000
         DC    AL1(30)                                                  09875000
         DC    AL1(31)                                                  09876000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       09877000
@01      EQU   01                                                       09878000
@02      EQU   02                                                       09879000
@03      EQU   03                                                       09880000
@04      EQU   04                                                       09881000
@05      EQU   05                                                       09882000
@06      EQU   06                                                       09883000
@07      EQU   07                                                       09884000
@08      EQU   08                                                       09885000
@09      EQU   09                                                       09886000
@10      EQU   10                                                       09887000
@11      EQU   11                                                       09888000
@12      EQU   12                                                       09889000
@13      EQU   13                                                       09890000
@14      EQU   14                                                       09891000
@15      EQU   15                                                       09892000
SUMIX    EQU   @02                                                      09893000
CTTLEN   EQU   @02                                                      09894000
FMFLCUR  EQU   @04                                                      09895000
DDSTRUSV EQU   @02                                                      09896000
IOINBPTR EQU   @02                                                      09897000
VESLOTB  EQU   @02                                                      09898000
VESLOT   EQU   @02                                                      09899000
VEPTRSAV EQU   @04                                                      09900000
VECKSLOT EQU   @03                                                      09901000
TYPESLOT EQU   @02                                                      09902000
TSTSLOT  EQU   @02                                                      09903000
TCISLOT  EQU   @02                                                      09904000
SUBSLOT  EQU   @02                                                      09905000
STSLOT   EQU   @03                                                      09906000
SLOT     EQU   @03                                                      09907000
NBRVOLOC EQU   @03                                                      09908000
NBRFLDS  EQU   @03                                                      09909000
MOSLOT   EQU   @02                                                      09910000
KEYLEN   EQU   @02                                                      09911000
INBFOFST EQU   @03                                                      09912000
GRPCOL   EQU   @02                                                      09913000
FMSLOT   EQU   @02                                                      09914000
DARGSLOT EQU   @02                                                      09915000
CTLOOP   EQU   @02                                                      09916000
CMPRSLOT EQU   @02                                                      09917000
CMPRLENR EQU   @02                                                      09918000
CMPRLENL EQU   @03                                                      09919000
CMPRCOL  EQU   @04                                                      09920000
A2SLOT   EQU   @03                                                      09921000
ATSLOTB  EQU   @03                                                      09922000
ATSLOT   EQU   @02                                                      09923000
ARGSLOT  EQU   @03                                                      09924000
ADATSLOT EQU   @04                                                      09925000
AAXVCNT  EQU   @02                                                      09926000
OPNPTR   EQU   @03                                                      09927000
IOCSPTR  EQU   @03                                                      09928000
RTNREG   EQU   @15                                                      09929000
REG1     EQU   @01                                                      09930000
REG2     EQU   @02                                                      09931000
REG3     EQU   @03                                                      09932000
REG0     EQU   @00                                                      09933000
REG10    EQU   @10                                                      09934000
REG11    EQU   @11                                                      09935000
REG12    EQU   @12                                                      09936000
REG13    EQU   @13                                                      09937000
REG14    EQU   @14                                                      09938000
REG15    EQU   @15                                                      09939000
REG4     EQU   @04                                                      09940000
REG5     EQU   @05                                                      09941000
REG6     EQU   @06                                                      09942000
REG7     EQU   @07                                                      09943000
REG8     EQU   @08                                                      09944000
REG9     EQU   @09                                                      09945000
IDCSAEP0 EQU   0                                                        09946000
IDCSAGP0 EQU   0                                                        09947000
IDCSAFP0 EQU   0                                                        09948000
IDCSARV0 EQU   0                                                        09949000
IDCSADQ0 EQU   0                                                        09950000
IDCSASI0 EQU   0                                                        09951000
TRACE1   EQU   0                                                        09952000
OLDERID1 EQU   TRACE1                                                   09953000
TRACE2   EQU   0                                                        09954000
OLDERID2 EQU   TRACE2                                                   09955000
NEWID2   EQU   TRACE2+95                                                09956000
NEWERID2 EQU   5                                                        09957000
CIRAGL   EQU   0                                                        09958000
CIRTYPE  EQU   CIRAGL                                                   09959000
ALLAGL   EQU   0                                                        09960000
ALLSTS   EQU   ALLAGL+24                                                09961000
ALLDSP   EQU   ALLAGL+25                                                09962000
ALLORG   EQU   ALLAGL+26                                                09963000
ALLOPT   EQU   ALLAGL+28                                                09964000
UNITABL  EQU   0                                                        09965000
UNITUCB  EQU   UNITABL                                                  09966000
UNITADR  EQU   UNITABL+4                                                09967000
@NM00010 EQU   UNITADR                                                  09968000
UNITSTAT EQU   UNITABL+6                                                09969000
IDCIOOP0 EQU   0                                                        09970000
IDCIOCL0 EQU   0                                                        09971000
IDCIOGT0 EQU   0                                                        09972000
IDCIOVY0 EQU   0                                                        09973000
IDCIOSI0 EQU   0                                                        09974000
IOCSTR   EQU   0                                                        09975000
IOCDAD   EQU   IOCSTR                                                   09976000
IOCDSO   EQU   IOCSTR+16                                                09977000
IOCRFM   EQU   IOCSTR+17                                                09978000
IOCMAC   EQU   IOCSTR+18                                                09979000
IOCMAC2  EQU   IOCSTR+19                                                09980000
IOCCHP   EQU   IOCSTR+20                                                09981000
IOCMSG   EQU   IOCSTR+21                                                09982000
IOCMSGOP EQU   IOCMSG                                                   09983000
IOCRBA   EQU   IOCSTR+40                                                09984000
IOCTTR   EQU   IOCRBA                                                   09985000
IOCMEM   EQU   IOCSTR+44                                                09986000
IOCNWM   EQU   IOCSTR+48                                                09987000
IOCREL   EQU   IOCSTR+60                                                09988000
OPNAGL   EQU   0                                                        09989000
OPNOPT   EQU   OPNAGL                                                   09990000
OPNOPTIN EQU   OPNOPT                                                   09991000
OPNOPTOT EQU   OPNOPT                                                   09992000
OPNOPTBK EQU   OPNOPT                                                   09993000
OPNOPTDR EQU   OPNOPT                                                   09994000
OPNRFM   EQU   OPNAGL+1                                                 09995000
OPNTYP   EQU   OPNAGL+2                                                 09996000
OPNTYPRA EQU   OPNTYP                                                   09997000
OPNMOD   EQU   OPNAGL+3                                                 09998000
OPNMODAC EQU   OPNMOD                                                   09999000
OPNIOC   EQU   OPNAGL+4                                                 10000000
OPNDDN   EQU   OPNAGL+8                                                 10001000
OPNPWA   EQU   OPNAGL+12                                                10002000
OPNDEV   EQU   OPNAGL+24                                                10003000
OPNDSO   EQU   OPNAGL+41                                                10004000
OPNDSOAM EQU   OPNDSO                                                   10005000
OPNOPT2  EQU   OPNAGL+42                                                10006000
IOINFOPT EQU   0                                                        10007000
IOINFTMS EQU   IOINFOPT                                                 10008000
UVOLLIST EQU   0                                                        10009000
UVOLENT  EQU   UVOLLIST+2                                               10010000
AMSTP011 EQU   0                                                        10011000
AMSTP042 EQU   0                                                        10012000
AMSTP043 EQU   0                                                        10013000
DARGLIST EQU   0                                                        10014000
DARGDBP  EQU   DARGLIST                                                 10015000
DARGSTID EQU   DARGLIST+8                                               10016000
DARGSMOD EQU   DARGSTID                                                 10017000
DARGSENT EQU   DARGSTID+3                                               10018000
DARGILP  EQU   DARGLIST+12                                              10019000
DARGCNT  EQU   DARGLIST+14                                              10020000
DARGIND  EQU   DARGLIST+18                                              10021000
DARGFLGS EQU   DARGLIST+19                                              10022000
DARGARY  EQU   DARGLIST+20                                              10023000
DARGINS  EQU   DARGARY                                                  10024000
DARGINL  EQU   DARGARY+2                                                10025000
DARGDTM  EQU   DARGARY+4                                                10026000
FMTLIST  EQU   0                                                        10027000
FMTFLGS  EQU   FMTLIST                                                  10028000
FMTSPF   EQU   FMTLIST+2                                                10029000
FMTRFNO  EQU   FMTSPF                                                   10030000
FMTILEN  EQU   FMTRFNO                                                  10031000
FMTIOFF  EQU   FMTLIST+4                                                10032000
FMTTRBC  EQU   FMTIOFF                                                  10033000
FMTSTO   EQU   FMTTRBC                                                  10034000
FMTOCOL  EQU   FMTLIST+6                                                10035000
FMTCNVF  EQU   FMTLIST+10                                               10036000
ERCNVTAB EQU   0                                                        10037000
ERTYPE   EQU   ERCNVTAB                                                 10038000
EROPER   EQU   ERCNVTAB+1                                               10039000
EROSOPER EQU   ERCNVTAB+2                                               10040000
ERCATRC  EQU   ERCNVTAB+16                                              10041000
ERCPLPT  EQU   ERCNVTAB+20                                              10042000
IDCDB010 EQU   0                                                        10043000
DMPITM   EQU   0                                                        10044000
DMPARY   EQU   0                                                        10045000
IFILE    EQU   0                                                        10046000
IFILECNT EQU   IFILE                                                    10047000
@NM00032 EQU   IFILE+2                                                  10048000
IFILEVAL EQU   @NM00032+1                                               10049000
CMPR     EQU   0                                                        10050000
DUMP     EQU   0                                                        10051000
CATNM    EQU   0                                                        10052000
CATNMPAS EQU   CATNM+1                                                  10053000
CATNMFLG EQU   CATNM+10                                                 10054000
CATDN    EQU   0                                                        10055000
CATDNVAL EQU   CATDN+1                                                  10056000
MRPW     EQU   0                                                        10057000
MRPWLEN  EQU   MRPW                                                     10058000
MRPWVAL  EQU   MRPW+1                                                   10059000
OFILE    EQU   0                                                        10060000
OFILEVAL EQU   OFILE+1                                                  10061000
SDUMP    EQU   0                                                        10062000
CCR      EQU   0                                                        10063000
CCRNXTFR EQU   CCR+48                                                   10064000
CHARBASD EQU   0                                                        10065000
FMPL     EQU   0                                                        10066000
FMPLFLNO EQU   FMPL                                                     10067000
FMPLBCIN EQU   FMPL+1                                                   10068000
FMPLGRTN EQU   FMPL+4                                                   10069000
FMPLWKAR EQU   FMPL+8                                                   10070000
FMPLUPTR EQU   FMPL+12                                                  10071000
FMPLRTCD EQU   FMPL+16                                                  10072000
FMPLENTH EQU   FMPL+18                                                  10073000
FMPLOAR  EQU   FMPL+20                                                  10074000
FMPLFMFL EQU   FMPL+24                                                  10075000
FMFL     EQU   0                                                        10076000
FMFLDLNO EQU   FMFL                                                     10077000
FMFLTSTC EQU   FMFL+1                                                   10078000
FMFLGRPC EQU   FMFL+2                                                   10079000
FMFLINDS EQU   FMFL+3                                                   10080000
FMFLDNAM EQU   FMFL+8                                                   10081000
FMFLTCHN EQU   FMFL+12                                                  10082000
FMFLDATA EQU   FMFL+16                                                  10083000
FMFLENTH EQU   FMFLDATA                                                 10084000
FMFLADDR EQU   FMFLDATA+4                                               10085000
$EXTPTRS EQU   0                                                        10086000
$USEDLEN EQU   0                                                        10087000
AMDSBCAT EQU   0                                                        10088000
ENTIDNO  EQU   0                                                        10089000
ENTNAME  EQU   0                                                        10090000
ENTYPE   EQU   0                                                        10091000
HIKEYSET EQU   0                                                        10092000
HIKEYLEN EQU   HIKEYSET                                                 10093000
NAMEDS   EQU   0                                                        10094000
TYPE     EQU   NAMEDS                                                   10095000
NAMECI   EQU   NAMEDS+1                                                 10096000
REPNO    EQU   0                                                        10097000
VOLSER   EQU   0                                                        10098000
VOLTSTMP EQU   0                                                        10099000
ASSOCTBL EQU   0                                                        10100000
ATNAME   EQU   ASSOCTBL                                                 10101000
ATNXTTBL EQU   ASSOCTBL+4                                               10102000
ATASOC   EQU   ASSOCTBL+8                                               10103000
ATENTYP  EQU   ATASOC                                                   10104000
ATCRACI  EQU   ATASOC+1                                                 10105000
ASSOCTB2 EQU   0                                                        10106000
A2NAME   EQU   ASSOCTB2                                                 10107000
A2NXTTBL EQU   ASSOCTB2+4                                               10108000
A2ASOC   EQU   ASSOCTB2+8                                               10109000
A2ENTYP  EQU   A2ASOC                                                   10110000
A2CRACI  EQU   A2ASOC+1                                                 10111000
VEXTTBL  EQU   0                                                        10112000
VENAME   EQU   VEXTTBL                                                  10113000
VENXTTBL EQU   VEXTTBL+4                                                10114000
VEEXT    EQU   VEXTTBL+8                                                10115000
VECRACI  EQU   VEEXT+1                                                  10116000
CTT      EQU   0                                                        10117000
CTTENTNO EQU   CTT                                                      10118000
CTTENTRY EQU   CTT+4                                                    10119000
CTTENTYP EQU   CTTENTRY                                                 10120000
CTTCATCI EQU   CTTENTRY+1                                               10121000
CTTINDS  EQU   CTTENTRY+4                                               10122000
CTTPRTD  EQU   CTTINDS                                                  10123000
CTTMCSW  EQU   CTTINDS                                                  10124000
CTTGDGM  EQU   CTTINDS                                                  10125000
IOBUFS   EQU   0                                                        10126000
IOBUF    EQU   IOBUFS                                                   10127000
IOBUFCI  EQU   IOBUFS+509                                               10128000
IOBUFDMY EQU   0                                                        10129000
SORTTBL  EQU   0                                                        10130000
STENTNM  EQU   SORTTBL                                                  10131000
STENTYP  EQU   SORTTBL+44                                               10132000
STCRACI  EQU   SORTTBL+45                                               10133000
STFLAGS  EQU   SORTTBL+48                                               10134000
STFRWD   EQU   SORTTBL+52                                               10135000
STBKWD   EQU   SORTTBL+54                                               10136000
AMSTP041 EQU   0                                                        10137000
AMSTP044 EQU   0                                                        10138000
CAT      EQU   0                                                        10139000
DEVTYP   EQU   0                                                        10140000
DMPTRM   EQU   0                                                        10141000
EXTENTS  EQU   0                                                        10142000
FMFLCNTR EQU   0                                                        10143000
FMFLNAME EQU   0                                                        10144000
HARBA    EQU   0                                                        10145000
HURBA    EQU   0                                                        10146000
IDCIOCO0 EQU   0                                                        10147000
IDCIOIT0 EQU   0                                                        10148000
IDCIOPO0 EQU   0                                                        10149000
IDCIOPT0 EQU   0                                                        10150000
IDCIOST0 EQU   0                                                        10151000
IDCIOTM0 EQU   0                                                        10152000
IDCIO050 EQU   0                                                        10153000
IDCSAAL0 EQU   0                                                        10154000
IDCSACA0 EQU   0                                                        10155000
IDCSACL0 EQU   0                                                        10156000
IDCSACR0 EQU   0                                                        10157000
IDCSADE0 EQU   0                                                        10158000
IDCSADL0 EQU   0                                                        10159000
IDCSAFS0 EQU   0                                                        10160000
IDCSAGS0 EQU   0                                                        10161000
IDCSAID0 EQU   0                                                        10162000
IDCSALC0 EQU   0                                                        10163000
IDCSALD0 EQU   0                                                        10164000
IDCSALK0 EQU   0                                                        10165000
IDCSANQ0 EQU   0                                                        10166000
IDCSAPR0 EQU   0                                                        10167000
IDCSAPT0 EQU   0                                                        10168000
IDCSAQL0 EQU   0                                                        10169000
IDCSARC0 EQU   0                                                        10170000
IDCSASC0 EQU   0                                                        10171000
IDCSASN0 EQU   0                                                        10172000
IDCSASS0 EQU   0                                                        10173000
IDCSAST0 EQU   0                                                        10174000
IDCSATI0 EQU   0                                                        10175000
IDCSAUC0 EQU   0                                                        10176000
IDCSAWO0 EQU   0                                                        10177000
IDCSA060 EQU   0                                                        10178000
IDCST010 EQU   0                                                        10179000
IDCTPER0 EQU   0                                                        10180000
LISTTEST EQU   0                                                        10181000
LOKEYLEN EQU   0                                                        10182000
LOKEYV   EQU   0                                                        10183000
NAME     EQU   0                                                        10184000
NCMPR    EQU   0                                                        10185000
NEWERID1 EQU   5                                                        10186000
RRNRET   EQU   0                                                        10187000
GDTTBL   EQU   0                                                        10188000
GDTTR1   EQU   GDTTBL+8                                                 10189000
GDTTR2   EQU   GDTTBL+12                                                10190000
GDTDBG   EQU   GDTTBL+40                                                10191000
GDTSTC   EQU   GDTTBL+44                                                10192000
GDTPRT   EQU   GDTTBL+48                                                10193000
GDTESS   EQU   GDTTBL+52                                                10194000
GDTESA   EQU   GDTTBL+56                                                10195000
GDTRST   EQU   GDTTBL+60                                                10196000
GDTRES   EQU   GDTTBL+64                                                10197000
GDTCAL   EQU   GDTTBL+68                                                10198000
GDTGSP   EQU   GDTTBL+72                                                10199000
GDTFSP   EQU   GDTTBL+76                                                10200000
GDTGPL   EQU   GDTTBL+80                                                10201000
GDTFPL   EQU   GDTTBL+84                                                10202000
GDTLOD   EQU   GDTTBL+88                                                10203000
GDTDEL   EQU   GDTTBL+92                                                10204000
GDTPRL   EQU   GDTTBL+96                                                10205000
GDTEPL   EQU   GDTTBL+100                                               10206000
GDTTIM   EQU   GDTTBL+104                                               10207000
GDTIIO   EQU   GDTTBL+108                                               10208000
GDTTIO   EQU   GDTTBL+112                                               10209000
GDTOPN   EQU   GDTTBL+124                                               10210000
GDTCLS   EQU   GDTTBL+128                                               10211000
GDTGET   EQU   GDTTBL+132                                               10212000
GDTPUT   EQU   GDTTBL+136                                               10213000
GDTPOS   EQU   GDTTBL+140                                               10214000
GDTCPY   EQU   GDTTBL+144                                               10215000
GDTCAT   EQU   GDTTBL+148                                               10216000
GDTSNP   EQU   GDTTBL+164                                               10217000
GDTVFY   EQU   GDTTBL+172                                               10218000
GDTECT   EQU   GDTTBL+188                                               10219000
GDTUID   EQU   GDTTBL+192                                               10220000
GDTPMT   EQU   GDTTBL+196                                               10221000
GDTCIR   EQU   GDTTBL+200                                               10222000
GDTLNK   EQU   GDTTBL+204                                               10223000
GDTALC   EQU   GDTTBL+208                                               10224000
GDTDLC   EQU   GDTTBL+212                                               10225000
GDTQAL   EQU   GDTTBL+216                                               10226000
GDTSTW   EQU   GDTTBL+220                                               10227000
GDTSSC   EQU   GDTTBL+224                                               10228000
GDTENQ   EQU   GDTTBL+228                                               10229000
GDTRSV   EQU   GDTTBL+232                                               10230000
GDTDEQ   EQU   GDTTBL+236                                               10231000
GDTSFO   EQU   GDTTBL+240                                               10232000
GDTWTO   EQU   GDTTBL+244                                               10233000
GDTSCR   EQU   GDTTBL+248                                               10234000
GDTUNT   EQU   GDTTBL+252                                               10235000
GDTRCT   EQU   GDTTBL+256                                               10236000
GDTIFO   EQU   GDTTBL+260                                               10237000
GDTEXP   EQU   GDTTBL+264                                               10238000
GDTSTA   EQU   GDTTBL+268                                               10239000
GDTERR   EQU   GDTTBL+272                                               10240000
GDTUNC   EQU   GDTTBL+276                                               10241000
GDTLOC   EQU   GDTTBL+280                                               10242000
FDTTBL   EQU   0                                                        10243000
FDTPTR   EQU   FDTTBL+8                                                 10244000
LASTCC   EQU   0                                                        10245000
ASOCDSRD EQU   0                                                        10246000
ETARG    EQU   0                                                        10247000
GONOGO   EQU   0                                                        10248000
STRTSLOT EQU   0                                                        10249000
NBRCHAR  EQU   0                                                        10250000
SRCHCHAR EQU   0                                                        10251000
NBR2CMP  EQU   0                                                        10252000
ARGTBL   EQU   0                                                        10253000
ARGNAME  EQU   ARGTBL                                                   10254000
ARGGRP   EQU   ARGTBL+8                                                 10255000
ARGCTGRP EQU   ARGTBL+9                                                 10256000
MSGTBL   EQU   0                                                        10257000
MSGLNTBL EQU   0                                                        10258000
TSTID    EQU   0                                                        10259000
TSTBIT64 EQU   0                                                        10260000
SUMFUNC  EQU   0                                                        10261000
SUMENTYP EQU   0                                                        10262000
TRRTNCD  EQU   0                                                        10263000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    10264000
FDTVERB  EQU   FDTTBL                                                   10265000
GDTPSB   EQU   GDTTBL+184                                               10266000
GDTUPT   EQU   GDTTBL+180                                               10267000
GDTCMB   EQU   GDTTBL+176                                               10268000
GDTSPR   EQU   GDTTBL+168                                               10269000
@NM00001 EQU   GDTTBL+160                                               10270000
GDTABH   EQU   GDTTBL+156                                               10271000
GDTABT   EQU   GDTTBL+152                                               10272000
GDTTOH   EQU   GDTTBL+120                                               10273000
GDTRIP   EQU   GDTTBL+116                                               10274000
GDTIOH   EQU   GDTTBL+36                                                10275000
GDTSAH   EQU   GDTTBL+32                                                10276000
GDTTPH   EQU   GDTTBL+28                                                10277000
GDTRIH   EQU   GDTTBL+24                                                10278000
GDTSTH   EQU   GDTTBL+20                                                10279000
GDTDBH   EQU   GDTTBL+16                                                10280000
GDTPRM   EQU   GDTTBL+4                                                 10281000
GDTHDR   EQU   GDTTBL                                                   10282000
@NM00044 EQU   SORTTBL+49                                               10283000
@NM00043 EQU   IOBUFS+508                                               10284000
@NM00042 EQU   CTTENTRY+5                                               10285000
@NM00045 EQU   VEEXT                                                    10286000
HIKEYV   EQU   HIKEYSET+2                                               10287000
STATISTC EQU   AMDSBCAT+56                                              10288000
@NM00041 EQU   AMDSBCAT                                                 10289000
FMFLWKAR EQU   FMFL+4                                                   10290000
FMFLSUCC EQU   FMFLINDS                                                 10291000
@NM00040 EQU   FMFLINDS                                                 10292000
@NM00039 EQU   FMPL+17                                                  10293000
@NM00033 EQU   CCR                                                      10294000
OFILELEN EQU   OFILE                                                    10295000
CATDNLEN EQU   CATDN                                                    10296000
CATNMVAL EQU   CATNM+21                                                 10297000
CATNMLEN EQU   CATNM+20                                                 10298000
CATNMMEM EQU   CATNM+12                                                 10299000
CATNMMLN EQU   CATNM+11                                                 10300000
CATNMFUQ EQU   CATNMFLG                                                 10301000
CATNMPOS EQU   CATNM+9                                                  10302000
CATNMPLN EQU   CATNM                                                    10303000
IFILELEN EQU   @NM00032                                                 10304000
@NM00031 EQU   DMPARY+15                                                10305000
DMPARYTP EQU   DMPARY+14                                                10306000
DMPARYEX EQU   DMPARY+12                                                10307000
DMPARYIC EQU   DMPARY+10                                                10308000
DMPARYSZ EQU   DMPARY+8                                                 10309000
DMPARYNM EQU   DMPARY                                                   10310000
@NM00030 EQU   DMPITM+15                                                10311000
DMPITMTP EQU   DMPITM+14                                                10312000
DMPITMLN EQU   DMPITM+12                                                10313000
DMPITMPT EQU   DMPITM+8                                                 10314000
DMPITMNM EQU   DMPITM                                                   10315000
@NM00029 EQU   ERCNVTAB+24                                              10316000
ERDARBPT EQU   ERCPLPT                                                  10317000
ERDYNRC  EQU   ERCATRC                                                  10318000
ERDSNM   EQU   ERCNVTAB+12                                              10319000
@NM00028 EQU   ERCNVTAB+4                                               10320000
@NM00027 EQU   ERCNVTAB+3                                               10321000
@NM00026 EQU   EROSOPER                                                 10322000
EROSUCDX EQU   EROSOPER                                                 10323000
EROSCATL EQU   EROSOPER                                                 10324000
@NM00025 EQU   EROPER                                                   10325000
ERCATAL  EQU   EROPER                                                   10326000
ERCATDL  EQU   EROPER                                                   10327000
ERCATDE  EQU   EROPER                                                   10328000
ERCATLC  EQU   EROPER                                                   10329000
@NM00024 EQU   ERTYPE                                                   10330000
ERDYNAL  EQU   ERTYPE                                                   10331000
EROSCAT  EQU   ERTYPE                                                   10332000
ERCATLG  EQU   ERTYPE                                                   10333000
@NM00023 EQU   FMTCNVF+1                                                10334000
FMTAR    EQU   FMTCNVF+1                                                10335000
FMTBS    EQU   FMTCNVF+1                                                10336000
FMTSS    EQU   FMTCNVF+1                                                10337000
FMTAL    EQU   FMTCNVF+1                                                10338000
FMTZS    EQU   FMTCNVF+1                                                10339000
@NM00022 EQU   FMTCNVF                                                  10340000
FMTPU    EQU   FMTCNVF                                                  10341000
FMTBD    EQU   FMTCNVF                                                  10342000
FMTBHD   EQU   FMTCNVF                                                  10343000
FMTBHA   EQU   FMTCNVF                                                  10344000
FMTBH    EQU   FMTCNVF                                                  10345000
FMTOLEN  EQU   FMTLIST+8                                                10346000
FMTRIO   EQU   FMTOCOL                                                  10347000
FMTSPT   EQU   FMTSTO                                                   10348000
FMTSTL   EQU   FMTILEN                                                  10349000
@NM00021 EQU   FMTFLGS+1                                                10350000
FMTSMSG  EQU   FMTFLGS+1                                                10351000
FMTHDF   EQU   FMTFLGS                                                  10352000
FMTDFF   EQU   FMTFLGS                                                  10353000
FMTSTF   EQU   FMTFLGS                                                  10354000
FMTREPF  EQU   FMTFLGS                                                  10355000
FMTBDF   EQU   FMTFLGS                                                  10356000
FMTIDF   EQU   FMTFLGS                                                  10357000
FMTSCF   EQU   FMTFLGS                                                  10358000
FMTEOLF  EQU   FMTFLGS                                                  10359000
DARGPCT  EQU   DARGINL                                                  10360000
DARGREP  EQU   DARGINS                                                  10361000
@NM00020 EQU   DARGFLGS                                                 10362000
DARGFULL EQU   DARGFLGS                                                 10363000
DARGRETL EQU   DARGLIST+16                                              10364000
DARGRETP EQU   DARGLIST+4                                               10365000
UVOLVOL  EQU   UVOLENT+4                                                10366000
UVOLDEV  EQU   UVOLENT                                                  10367000
UVOLCNT  EQU   UVOLLIST                                                 10368000
@NM00019 EQU   IOINFOPT                                                 10369000
IOINFLUB EQU   IOINFOPT                                                 10370000
IOINFSUP EQU   IOINFOPT                                                 10371000
IOINFDSN EQU   IOINFOPT                                                 10372000
IOINFVOL EQU   IOINFOPT                                                 10373000
IOINFDVT EQU   IOINFOPT                                                 10374000
OPNVOL   EQU   OPNAGL+44                                                10375000
OPNSTRNO EQU   OPNAGL+43                                                10376000
@NM00018 EQU   OPNOPT2                                                  10377000
OPNOPTJM EQU   OPNOPT2                                                  10378000
OPNOPTNM EQU   OPNOPT2                                                  10379000
OPNOPTAS EQU   OPNOPT2                                                  10380000
@NM00017 EQU   OPNDSO                                                   10381000
OPNDSOPO EQU   OPNDSO                                                   10382000
OPNDSOIS EQU   OPNDSO                                                   10383000
OPNDSOPS EQU   OPNDSO                                                   10384000
OPNKYL   EQU   OPNAGL+40                                                10385000
OPNBLK   EQU   OPNAGL+36                                                10386000
OPNREC   EQU   OPNAGL+32                                                10387000
OPNDEVIX EQU   OPNDEV+4                                                 10388000
OPNDEVDT EQU   OPNDEV                                                   10389000
OPNCBP   EQU   OPNAGL+20                                                10390000
OPNDSN   EQU   OPNAGL+16                                                10391000
OPNMODRP EQU   OPNMOD                                                   10392000
OPNMODUB EQU   OPNMOD                                                   10393000
OPNMODRS EQU   OPNMOD                                                   10394000
OPNMODAX EQU   OPNMOD                                                   10395000
OPNMODRR EQU   OPNMOD                                                   10396000
OPNMODRC EQU   OPNMOD                                                   10397000
OPNMODPD EQU   OPNMOD                                                   10398000
OPNTYPSY EQU   OPNTYP                                                   10399000
OPNTYPRV EQU   OPNTYP                                                   10400000
OPNTYPEX EQU   OPNTYP                                                   10401000
OPNTYPXM EQU   OPNTYP                                                   10402000
OPNTYPCI EQU   OPNTYP                                                   10403000
OPNTYPSO EQU   OPNTYP                                                   10404000
OPNTYPSI EQU   OPNTYP                                                   10405000
@NM00016 EQU   OPNRFM                                                   10406000
OPNRFMBK EQU   OPNRFM                                                   10407000
OPNRFMSF EQU   OPNRFM                                                   10408000
OPNRFMUN EQU   OPNRFM                                                   10409000
OPNRFMVR EQU   OPNRFM                                                   10410000
OPNRFMFX EQU   OPNRFM                                                   10411000
OPNOPTSK EQU   OPNOPT                                                   10412000
OPNOPTCR EQU   OPNOPT                                                   10413000
OPNOPTKS EQU   OPNOPT                                                   10414000
OPNOPTUP EQU   OPNOPT                                                   10415000
IOCEXT   EQU   IOCSTR+64                                                10416000
IOCTSML  EQU   IOCREL+2                                                 10417000
IOCTPML  EQU   IOCREL                                                   10418000
IOCWORK  EQU   IOCSTR+56                                                10419000
IOCRRN   EQU   IOCSTR+52                                                10420000
IOCPNM   EQU   IOCNWM+2                                                 10421000
IOCPTL   EQU   IOCNWM                                                   10422000
IOCKYA   EQU   IOCMEM                                                   10423000
IOCVRC   EQU   IOCTTR                                                   10424000
IOCCBP   EQU   IOCSTR+36                                                10425000
IOCDSN   EQU   IOCSTR+32                                                10426000
IOCHURBA EQU   IOCSTR+28                                                10427000
IOCVOLSR EQU   IOCSTR+22                                                10428000
@NM00015 EQU   IOCMSG                                                   10429000
IOCMSGSM EQU   IOCMSG                                                   10430000
IOCMSGAE EQU   IOCMSG                                                   10431000
IOCMSGCE EQU   IOCMSG                                                   10432000
IOCMSGOE EQU   IOCMSG                                                   10433000
IOCCHPKG EQU   IOCMSG                                                   10434000
IOCCHPKE EQU   IOCMSG                                                   10435000
IOCCHPNU EQU   IOCCHP                                                   10436000
IOCCHPUP EQU   IOCCHP                                                   10437000
IOCCHPBK EQU   IOCCHP                                                   10438000
IOCCHPCR EQU   IOCCHP                                                   10439000
IOCCHPKS EQU   IOCCHP                                                   10440000
IOCCHPSK EQU   IOCCHP                                                   10441000
IOCCHPDR EQU   IOCCHP                                                   10442000
IOCCHPSQ EQU   IOCCHP                                                   10443000
IOCMACNT EQU   IOCMAC2                                                  10444000
IOCMACER EQU   IOCMAC2                                                  10445000
IOCMACPA EQU   IOCMAC2                                                  10446000
IOCMACEN EQU   IOCMAC2                                                  10447000
IOCMACCP EQU   IOCMAC2                                                  10448000
IOCMACRR EQU   IOCMAC2                                                  10449000
IOCMACAS EQU   IOCMAC2                                                  10450000
IOCMACSK EQU   IOCMAC2                                                  10451000
@NM00014 EQU   IOCMAC                                                   10452000
IOCMACCC EQU   IOCMAC                                                   10453000
IOCMACDR EQU   IOCMAC                                                   10454000
IOCMACBK EQU   IOCMAC                                                   10455000
IOCMACCR EQU   IOCMAC                                                   10456000
IOCMACUP EQU   IOCMAC                                                   10457000
IOCMACOT EQU   IOCMAC                                                   10458000
IOCMACIN EQU   IOCMAC                                                   10459000
@NM00013 EQU   IOCRFM                                                   10460000
IOCRFMBK EQU   IOCRFM                                                   10461000
IOCRFMSF EQU   IOCRFM                                                   10462000
IOCRFMUN EQU   IOCRFM                                                   10463000
IOCRFMVR EQU   IOCRFM                                                   10464000
IOCRFMFX EQU   IOCRFM                                                   10465000
@NM00012 EQU   IOCDSO                                                   10466000
IOCDSOPO EQU   IOCDSO                                                   10467000
IOCDSOIS EQU   IOCDSO                                                   10468000
IOCDSOPS EQU   IOCDSO                                                   10469000
IOCDSOAM EQU   IOCDSO                                                   10470000
IOCRKP   EQU   IOCSTR+13                                                10471000
IOCKYL   EQU   IOCSTR+12                                                10472000
IOCTRN   EQU   IOCSTR+8                                                 10473000
IOCDLN   EQU   IOCSTR+4                                                 10474000
UNITVTOC EQU   UNITABL+7                                                10475000
@NM00011 EQU   UNITSTAT                                                 10476000
UNITUSHR EQU   UNITSTAT                                                 10477000
UNITXSHR EQU   UNITSTAT                                                 10478000
UNITISHR EQU   UNITSTAT                                                 10479000
UNITUA   EQU   @NM00010+1                                               10480000
UNITCHA  EQU   @NM00010                                                 10481000
ALLUNCNT EQU   ALLAGL+30                                                10482000
ALLVLCNT EQU   ALLAGL+29                                                10483000
@NM00009 EQU   ALLOPT                                                   10484000
ALLOPTUN EQU   ALLOPT                                                   10485000
ALLOPTPV EQU   ALLOPT                                                   10486000
ALLOPTDS EQU   ALLOPT                                                   10487000
ALLOPTVL EQU   ALLOPT                                                   10488000
@NM00008 EQU   ALLORG+1                                                 10489000
ALLORGVS EQU   ALLORG+1                                                 10490000
@NM00007 EQU   ALLORG+1                                                 10491000
ALLORGGS EQU   ALLORG+1                                                 10492000
ALLORGUN EQU   ALLORG                                                   10493000
ALLORGPO EQU   ALLORG                                                   10494000
ALLORGMQ EQU   ALLORG                                                   10495000
ALLORGCQ EQU   ALLORG                                                   10496000
ALLORGCX EQU   ALLORG                                                   10497000
ALLORGDA EQU   ALLORG                                                   10498000
ALLORGPS EQU   ALLORG                                                   10499000
ALLORGIS EQU   ALLORG                                                   10500000
ALLDSPUN EQU   ALLDSP                                                   10501000
ALLDSPCG EQU   ALLDSP                                                   10502000
ALLDSPDE EQU   ALLDSP                                                   10503000
ALLDSPKP EQU   ALLDSP                                                   10504000
@NM00006 EQU   ALLDSP                                                   10505000
ALLSTSOD EQU   ALLSTS                                                   10506000
ALLSTSMD EQU   ALLSTS                                                   10507000
ALLSTSNW EQU   ALLSTS                                                   10508000
ALLSTSSR EQU   ALLSTS                                                   10509000
@NM00005 EQU   ALLSTS                                                   10510000
ALLPWD   EQU   ALLAGL+20                                                10511000
ALLVLP   EQU   ALLAGL+16                                                10512000
ALLULP   EQU   ALLAGL+12                                                10513000
ALLDDN   EQU   ALLAGL+4                                                 10514000
ALLDSN   EQU   ALLAGL                                                   10515000
CIRPID   EQU   CIRAGL+28                                                10516000
CIRPWD   EQU   CIRAGL+24                                                10517000
CIRCAT   EQU   CIRAGL+20                                                10518000
CIRWKP   EQU   CIRAGL+16                                                10519000
CIRTLR   EQU   CIRAGL+12                                                10520000
CIRHDR   EQU   CIRAGL+8                                                 10521000
CIRTLN   EQU   CIRAGL+6                                                 10522000
CIRHLN   EQU   CIRAGL+4                                                 10523000
@NM00004 EQU   CIRAGL+1                                                 10524000
@NM00003 EQU   CIRTYPE                                                  10525000
CIRTYPAQ EQU   CIRTYPE                                                  10526000
CIRTYP1Q EQU   CIRTYPE                                                  10527000
NEWID1   EQU   TRACE1+95                                                10528000
CALLID   EQU   OLDERID1+90                                              10529000
@NM00002 EQU   OLDERID1                                                 10530000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      10531000
@RC00287 EQU   @EL00003                                                 10532000
@RC00362 EQU   @EL00005                                                 10533000
@RF00498 EQU   @EL00008                                                 10534000
@RF00512 EQU   @EL00008                                                 10535000
@RT00576 EQU   @RC00573                                                 10536000
@RT00574 EQU   @RC00573                                                 10537000
@RC00549 EQU   @EL00009                                                 10538000
@RF00648 EQU   @RC00644                                                 10539000
@RC00620 EQU   @EL00010                                                 10540000
@RC00799 EQU   @EL00014                                                 10541000
@RF00984 EQU   @EL00015                                                 10542000
@RF01085 EQU   @EL00017                                                 10543000
@RC01093 EQU   @EL00017                                                 10544000
@RC01174 EQU   @RC01167                                                 10545000
@RC01169 EQU   @RC01167                                                 10546000
@RF01187 EQU   @EL00018                                                 10547000
@RF01323 EQU   @EL00021                                                 10548000
@RC01485 EQU   @RC01477                                                 10549000
@RF01570 EQU   @RC01563                                                 10550000
@RF01668 EQU   @EL00028                                                 10551000
@RC01864 EQU   @EL00030                                                 10552000
@RC01918 EQU   @RC01917                                                 10553000
@RF01996 EQU   @EL00032                                                 10554000
@RF02008 EQU   @EL00033                                                 10555000
@RC02012 EQU   @EL00033                                                 10556000
@PB00034 EQU   @EL00001                                                 10557000
@RC00628 EQU   @RC00620                                                 10558000
@RC00814 EQU   @RC00799                                                 10559000
@PB00033 EQU   @PB00034                                                 10560000
@RT00815 EQU   @RC00814                                                 10561000
@PB00032 EQU   @PB00033                                                 10562000
@PB00031 EQU   @PB00032                                                 10563000
@PB00030 EQU   @PB00031                                                 10564000
@PB00029 EQU   @PB00030                                                 10565000
@PB00028 EQU   @PB00029                                                 10566000
@PB00027 EQU   @PB00028                                                 10567000
@PB00026 EQU   @PB00027                                                 10568000
@PB00025 EQU   @PB00026                                                 10569000
@PB00024 EQU   @PB00025                                                 10570000
@PB00023 EQU   @PB00024                                                 10571000
@PB00022 EQU   @PB00023                                                 10572000
@PB00021 EQU   @PB00022                                                 10573000
@PB00020 EQU   @PB00021                                                 10574000
@PB00019 EQU   @PB00020                                                 10575000
@PB00018 EQU   @PB00019                                                 10576000
@PB00017 EQU   @PB00018                                                 10577000
@PB00016 EQU   @PB00017                                                 10578000
@PB00015 EQU   @PB00016                                                 10579000
@PB00014 EQU   @PB00015                                                 10580000
@PB00013 EQU   @PB00014                                                 10581000
@PB00012 EQU   @PB00013                                                 10582000
@PB00011 EQU   @PB00012                                                 10583000
@PB00010 EQU   @PB00011                                                 10584000
@PB00009 EQU   @PB00010                                                 10585000
@PB00008 EQU   @PB00009                                                 10586000
@PB00007 EQU   @PB00008                                                 10587000
@PB00006 EQU   @PB00007                                                 10588000
@PB00005 EQU   @PB00006                                                 10589000
@PB00004 EQU   @PB00005                                                 10590000
@PB00003 EQU   @PB00004                                                 10591000
@PB00002 EQU   @PB00003                                                 10592000
@ENDDATA EQU   *                                                        10593000
         END   IDCLR01,(C'PLS1738',0701,78073)                          10594000
