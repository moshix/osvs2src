         TITLE '**************** IDCLV01: LISTMSVI FSR *************** *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCLV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCLV01   77.354'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @08,0                                               0002 00021000
@PSTART  LA    @09,4095(,@08)                                      0002 00022000
         LA    @10,4095(,@09)                                      0002 00023000
         LA    @12,4095(,@10)                                      0002 00024000
         USING @PSTART,@08                                         0002 00025000
         USING @PSTART+4095,@09                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @11,@01                                             0002 00031000
         USING @DATD,@11                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @11,8(,@13)                                         0002 00035000
         LR    @13,@11                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0303 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* THIS IS THE MAIN PROCEDURE.                           @Y30LB33*/ 00041000
*   /* IT OPENS AND CLOSES THE OUTPUT DATA SET               @Y30LB33*/ 00042000
*   /* WHEN REQUESTED BY THE USER.                           @Y30LB33*/ 00043000
*   /* IT INITIALIZES PORTIONS OF MAIN STORAGE. IT           @Y30LB33*/ 00044000
*   /* CALLS ON THE REPORT SELECTER ROUTINE TO PRODUCE       @Y30LB33*/ 00045000
*   /* THE REPORT. IT ISSUES THE FINAL COMPLETION MESSAGE.   @Y30LB33*/ 00046000
*   /* THE EXIT FROM THE PROGRAM IS FROM HERE.               @Y30LB33*/ 00047000
*   /*                                                               */ 00048000
*   /*****************************************************************/ 00049000
*                                                                  0303 00050000
*   OLDERID2=NEWERID2;                                             0303 00051000
         L     @07,@PC00001                                        0303 00052000
         L     @15,GDTTR2(,@07)                                    0303 00053000
         MVC   @TS00001(95),NEWERID2(@15)                          0303 00054000
         MVC   OLDERID2(95,@15),@TS00001                           0303 00055000
*   NEWID2='LVAA';                  /* INITIAL TRACE POINT   @Y30LB33*/ 00056000
         MVC   NEWID2(4,@15),@CC02417                              0304 00057000
*   TESTRC=0;                       /* INITIALIZE CODE HOLD  @Y30LB33*/ 00058000
         SLR   TESTRC,TESTRC                                       0305 00059000
*   IF GDTDBG=NULLPTR THEN                                         0306 00060000
         L     @15,GDTDBG(,@07)                                    0306 00061000
         LTR   @15,@15                                             0306 00062000
         BZ    @RT00306                                            0306 00063000
*     ;                                                            0307 00064000
*   ELSE                                                           0308 00065000
*     CALL IDCDB010(GDTTBL,'LVAA'); /* COMPLETE DUMP         @Y30LB33*/ 00066000
*                                                                  0308 00067000
         L     @15,@PC00001                                        0308 00068000
         ST    @15,@AL00001                                        0308 00069000
         LA    @14,@CC02417                                        0308 00070000
         ST    @14,@AL00001+4                                      0308 00071000
         MVI   @AL00001+4,X'80'                                    0308 00072000
         L     @15,GDTDBG(,@15)                                    0308 00073000
         LA    @01,@AL00001                                        0308 00074000
         BALR  @14,@15                                             0308 00075000
*   /*****************************************************************/ 00076000
*   /*                                                               */ 00077000
*   /* INITIALIZE WORK AREAS AND POINTERS                    @Y30LB33*/ 00078000
*   /*                                                               */ 00079000
*   /*****************************************************************/ 00080000
*                                                                  0309 00081000
*   DUMPADDR=ADDR(DUMPAREA);        /* INITIALIZE THE        @Y30LB33   00082000
*                                      POINTER FOR SYMBOLIC  @Y30LB33   00083000
*                                      DUMPS                 @Y30LB33*/ 00084000
@RT00306 LA    @06,DUMPAREA                                        0309 00085000
         ST    @06,DUMPADDR                                        0309 00086000
*   PRINTME=NULLPTR;                /* CLEAR THE PRINT IOCS  @Y30LB33   00087000
*                                      POINTER               @Y30LB33*/ 00088000
         SLR   @06,@06                                             0310 00089000
         ST    @06,PRINTME                                         0310 00090000
*   SETRC=0;                        /* INITIALIZE RETURN CODE HOLDER    00091000
*                                                            @Y30LB33*/ 00092000
         STH   @06,SETRC                                           0311 00093000
*   SWCHBITS=SWCHBITS&&SWCHBITS;    /*                       @Y30LB33*/ 00094000
         XC    SWCHBITS(1),SWCHBITS                                0312 00095000
*   SUMTBL=SUMTBL&&SUMTBL;          /* CLEAR SUMMARY TABLE   @Y30LB33*/ 00096000
         XC    SUMTBL(48),SUMTBL                                   0313 00097000
*   DDSTRU=ADDR(LVDRGLST);          /* INITIALIZE THE DARGLIST     0314 00098000
*                                                            @Y30LB33   00099000
*                                      POINTER TO POINT AT MY PRINT     00100000
*                                      ARGUMENT LIST AREA    @Y30LB33*/ 00101000
*                                                                  0314 00102000
         LA    @03,LVDRGLST                                        0314 00103000
         ST    @03,DDSTRU                                          0314 00104000
*   /*****************************************************************/ 00105000
*   /*                                                               */ 00106000
*   /* INITIALIZE THE MAPPING MACRO BASES                    @Y30LB33*/ 00107000
*   /*                                                               */ 00108000
*   /*****************************************************************/ 00109000
*                                                                  0315 00110000
*   BASEVPTR=ADDR(VOLRCDBF);        /* BASE VOLUME MAP       @Y30LB33*/ 00111000
         LA    @15,VOLRCDBF                                        0315 00112000
         LR    BASEVPTR,@15                                        0315 00113000
*   BCDVPTR=ADDR(VOLRCDBF);         /* BASE VOLUME AREA      @Y30LB33*/ 00114000
         ST    @15,BCDVPTR                                         0316 00115000
*   DUPVPTR=ADDR(VOLRCDBF);         /* DUPLICATE VOLUME MAP  @Y30LB33*/ 00116000
         ST    @15,DUPVPTR                                         0317 00117000
*   GROUPPTR=ADDR(GRPRCDBF);        /* GROUP RECORD MAP      @Y30LB33*/ 00118000
         LA    GROUPPTR,GRPRCDBF                                   0318 00119000
*   COPYVPTR=ADDR(CPYRCDBF);        /* COPY RECORD MAP       @Y30LB33*/ 00120000
         LA    @03,CPYRCDBF                                        0319 00121000
         ST    @03,COPYVPTR                                        0319 00122000
*                                                                  0320 00123000
*   /*****************************************************************/ 00124000
*   /*                                                               */ 00125000
*   /* TEST THE OUTPUT FILE FDTTBL ENTRIES. IF ONE           @Y30LB33*/ 00126000
*   /* IS DEFINED, BUILD THE OPEN ARGUMENT LIST AND          @Y30LB33*/ 00127000
*   /* OPEN THE DATA SET                                     @Y30LB33*/ 00128000
*   /*                                                               */ 00129000
*   /*****************************************************************/ 00130000
*                                                                  0320 00131000
*   IF ADDR(ODS)>0|ADDR(OFILE)>0 THEN                              0320 00132000
         L     @03,@PC00001+4                                      0320 00133000
         C     @06,FDTPTR+44(,@03)                                 0320 00134000
         BL    @RT00320                                            0320 00135000
         C     @06,FDTPTR+40(,@03)                                 0320 00136000
         BNL   @RF00320                                            0320 00137000
@RT00320 DS    0H                                                  0321 00138000
*     DO;                           /*                       @Y30LB33*/ 00139000
*       LVOPNAGL=LVOPNAGL&&LVOPNAGL;/* NULL ARG LIST         @Y30LB33*/ 00140000
         XC    LVOPNAGL(48),LVOPNAGL                               0322 00141000
*       OPNPTR=ADDR(LVOPNAGL);      /* GET ADDRESS           @Y30LB33*/ 00142000
         LA    OPNPTR,LVOPNAGL                                     0323 00143000
*       OPNOPTOT=ON;                /* OPEN FOR OUTPUT       @Y30LB33*/ 00144000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0324 00145000
*       OPNIOC=ADDR(PRINTME);       /* SET IOCS POINTER      @Y30LB33*/ 00146000
         LA    @06,PRINTME                                         0325 00147000
         ST    @06,OPNIOC(,OPNPTR)                                 0325 00148000
*       OPNMODAC=ON;                /* ASA CARRIAGE CONTROL  @Y30LB33*/ 00149000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0326 00150000
*       IF ADDR(ODS)=0 THEN         /*                       @Y30LB33*/ 00151000
         L     @06,@PC00001+4                                      0327 00152000
         L     @15,FDTPTR+44(,@06)                                 0327 00153000
         LTR   @15,@15                                             0327 00154000
         BNZ   @RF00327                                            0327 00155000
*         OPNDDN=ADDR(OFILEVAL);    /*                       @Y30LB33*/ 00156000
         L     @06,FDTPTR+40(,@06)                                 0328 00157000
         LA    @06,OFILEVAL(,@06)                                  0328 00158000
         ST    @06,OPNDDN(,OPNPTR)                                 0328 00159000
*       ELSE                                                       0329 00160000
*         OPNDSN=ADDR(ODSVAL);      /*                       @Y30LB33*/ 00161000
         B     @RC00327                                            0329 00162000
@RF00327 L     @06,@PC00001+4                                      0329 00163000
         L     @06,FDTPTR+44(,@06)                                 0329 00164000
         LA    @06,ODSVAL(,@06)                                    0329 00165000
         ST    @06,OPNDSN(,OPNPTR)                                 0329 00166000
*       CALL IDCIOOP0(GDTTBL,LVOPNAGL);/*                    @Y30LB33*/ 00167000
@RC00327 L     @03,@PC00001                                        0330 00168000
         ST    @03,@AL00001                                        0330 00169000
         LA    @15,LVOPNAGL                                        0330 00170000
         ST    @15,@AL00001+4                                      0330 00171000
         MVI   @AL00001+4,X'80'                                    0330 00172000
         L     @15,GDTOPN(,@03)                                    0330 00173000
         LA    @01,@AL00001                                        0330 00174000
         BALR  @14,@15                                             0330 00175000
*       RESPECIFY                                                  0331 00176000
*         RTNREG RSTD;                                             0331 00177000
*       TESTRC=RTNREG;                                             0332 00178000
         LR    TESTRC,RTNREG                                       0332 00179000
*       RESPECIFY                                                  0333 00180000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 00181000
*                                                                  0333 00182000
*       /*************************************************************/ 00183000
*       /*                                                           */ 00184000
*       /* IF THE RETURN CODE FROM THE OPEN IS NOT OK,       @Y30LB33*/ 00185000
*       /* THEN SET LASTCOND TO 8                            @Y30LB33*/ 00186000
*       /*                                                           */ 00187000
*       /*************************************************************/ 00188000
*                                                                  0334 00189000
*       IF TESTRC=4 THEN                                           0334 00190000
         C     TESTRC,@CF00043                                     0334 00191000
         BNE   @RF00334                                            0334 00192000
*         LASTCOND=LASTCC08;        /*                       @Y30LB33*/ 00193000
         L     @06,@PC00001+8                                      0335 00194000
         MVC   LASTCOND(2,@06),@CH00035                            0335 00195000
*     END;                          /*                       @Y30LB33*/ 00196000
@RF00334 DS    0H                                                  0337 00197000
*                                                                  0337 00198000
*   /*****************************************************************/ 00199000
*   /*                                                               */ 00200000
*   /* READ IN THE REPORT CONSTANTS FROM THE                 @Y30LB33*/ 00201000
*   /* STATIC TEXT TO RPTCONS SO THEY CAN BE USED IN THE     @Y30LB33*/ 00202000
*   /* REPORTS                                               @Y30LB33*/ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                                  0337 00206000
*   IF LASTCOND=LASTCC00 THEN                                      0337 00207000
@RF00320 L     @06,@PC00001+8                                      0337 00208000
         LH    @06,LASTCOND(,@06)                                  0337 00209000
         LTR   @06,@06                                             0337 00210000
         BNZ   @RF00337                                            0337 00211000
*     DO;                           /*                       @Y30LB33*/ 00212000
*       DARGLIST=DARGLIST&&DARGLIST;/* NULL ARG LIST         @Y30LB33*/ 00213000
         L     @06,DDSTRU                                          0339 00214000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0339 00215000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 00216000
         MVC   DARGSMOD(3,@06),@CC02396                            0340 00217000
*       DARGSENT=MISCTEXT;          /*                       @Y30LB33*/ 00218000
         MVI   DARGSENT(@06),X'05'                                 0341 00219000
*       DARGRETP=ADDR(PRNTCONS);    /*                       @Y30LB33*/ 00220000
         LA    @03,PRNTCONS                                        0342 00221000
         ST    @03,DARGRETP(,@06)                                  0342 00222000
*       DARGRETL=LENGTH(PRNTCONS);  /*                       @Y30LB33*/ 00223000
         MVC   DARGRETL(2,@06),@CH02613                            0343 00224000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 00225000
*                                                                  0344 00226000
         L     @06,@PC00001                                        0344 00227000
         ST    @06,@AL00001                                        0344 00228000
         LA    @03,@CF00117                                        0344 00229000
         ST    @03,@AL00001+4                                      0344 00230000
         LA    @03,DDSTRU                                          0344 00231000
         ST    @03,@AL00001+8                                      0344 00232000
         MVI   @AL00001+8,X'80'                                    0344 00233000
         L     @15,GDTPRT(,@06)                                    0344 00234000
         LA    @01,@AL00001                                        0344 00235000
         BALR  @14,@15                                             0344 00236000
*       /*************************************************************/ 00237000
*       /*                                                           */ 00238000
*       /* READ IN THE MAIN TITLE LINE.                      @Z40LB66*/ 00239000
*       /* NOTE THAT A STATUS TITLE IS ALWAYS USED           @Z40LB66*/ 00240000
*       /* FOR CARTRIDGE REPORTS.                            @Z40LB66*/ 00241000
*       /*                                                           */ 00242000
*       /*************************************************************/ 00243000
*                                                                  0345 00244000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 00245000
         L     @06,DDSTRU                                          0345 00246000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0345 00247000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 00248000
         MVC   DARGSMOD(3,@06),@CC02396                            0346 00249000
*       IF ADDR(STAT)>0|ADDR(ALLC)>0/*                       @Z40LB66*/ 00250000
*           |ADDR(CTGSCNT)>0        /*                       @Z40LB66*/ 00251000
*         THEN                                                     0347 00252000
         SLR   @06,@06                                             0347 00253000
         L     @03,@PC00001+4                                      0347 00254000
         C     @06,FDTPTR+52(,@03)                                 0347 00255000
         BL    @RT00347                                            0347 00256000
         C     @06,FDTPTR+88(,@03)                                 0347 00257000
         BL    @RT00347                                            0347 00258000
         C     @06,FDTPTR+84(,@03)                                 0347 00259000
         BNL   @RF00347                                            0347 00260000
@RT00347 DS    0H                                                  0348 00261000
*         DARGSENT=STATTITL;        /*                       @Z40LB66*/ 00262000
         L     @06,DDSTRU                                          0348 00263000
         MVI   DARGSENT(@06),X'07'                                 0348 00264000
*       ELSE                                                       0349 00265000
*         DARGSENT=USAGTITL;        /*                       @Y30LB33*/ 00266000
         B     @RC00347                                            0349 00267000
@RF00347 L     @06,DDSTRU                                          0349 00268000
         MVI   DARGSENT(@06),X'06'                                 0349 00269000
*       DARGRETP=ADDR(MAINTITL);    /*                       @Y30LB33*/ 00270000
@RC00347 L     @06,DDSTRU                                          0350 00271000
         LA    @03,MAINTITL                                        0350 00272000
         ST    @03,DARGRETP(,@06)                                  0350 00273000
*       DARGRETL=LENGTH(MAINTITL);  /*                       @Y30LB33*/ 00274000
         MVC   DARGRETL(2,@06),@CH02378                            0351 00275000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 00276000
*                                                                  0352 00277000
         L     @06,@PC00001                                        0352 00278000
         ST    @06,@AL00001                                        0352 00279000
         LA    @03,@CF00117                                        0352 00280000
         ST    @03,@AL00001+4                                      0352 00281000
         LA    @03,DDSTRU                                          0352 00282000
         ST    @03,@AL00001+8                                      0352 00283000
         MVI   @AL00001+8,X'80'                                    0352 00284000
         L     @15,GDTPRT(,@06)                                    0352 00285000
         LA    @01,@AL00001                                        0352 00286000
         BALR  @14,@15                                             0352 00287000
*       /*************************************************************/ 00288000
*       /*                                                           */ 00289000
*       /* ESTABLISH THE MAIN TITLE LINE                     @Y30LB33*/ 00290000
*       /*                                                           */ 00291000
*       /*************************************************************/ 00292000
*                                                                  0353 00293000
*       PCARG=PCARG&&PCARG;         /*                       @Y30LB33*/ 00294000
         XC    PCARG(33),PCARG                                     0353 00295000
*       PCMTLP=ADDR(MAINTITL);      /*                       @Y30LB33*/ 00296000
         LA    @06,MAINTITL                                        0354 00297000
         ST    @06,PCMTLP                                          0354 00298000
*       PCMTLC=1;                   /*                       @Y30LB33*/ 00299000
         MVC   PCMTLC(2),@CH00221                                  0355 00300000
*       PCPNL=107;                  /*                       @Y30LB33*/ 00301000
         MVC   PCPNL(2),@CH02418                                   0356 00302000
*       PCPTL=73;                   /*                       @Y30LB33*/ 00303000
         MVC   PCPTL(2),@CH02419                                   0357 00304000
*       PCPDL=89;                   /*                       @Y30LB33*/ 00305000
         MVC   PCPDL(2),@CH02420                                   0358 00306000
*       CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*               @Y30LB33*/ 00307000
         L     @06,@PC00001                                        0359 00308000
         ST    @06,@AL00001                                        0359 00309000
         LA    @03,PRINTME                                         0359 00310000
         ST    @03,@AL00001+4                                      0359 00311000
         LA    @03,PCARG                                           0359 00312000
         ST    @03,@AL00001+8                                      0359 00313000
         L     @15,GDTESA(,@06)                                    0359 00314000
         LA    @01,@AL00001                                        0359 00315000
         BALR  @14,@15                                             0359 00316000
*                                                                  0360 00317000
*       /*************************************************************/ 00318000
*       /*                                                           */ 00319000
*       /* CALL THE REPORT SELECTER TO PRINT THE REPORTS     #Y30LB33*/ 00320000
*       /*                                                           */ 00321000
*       /*************************************************************/ 00322000
*                                                                  0360 00323000
*       CALL SELRPT;                /*                       @Y30LB33*/ 00324000
         BAL   @14,SELRPT                                          0360 00325000
*     END;                          /*                       @Y30LB33*/ 00326000
*                                                                  0361 00327000
*   /*****************************************************************/ 00328000
*   /*                                                               */ 00329000
*   /* RESET THE TITLES AND SUBTITLES                        @Y30LB33*/ 00330000
*   /*                                                               */ 00331000
*   /*****************************************************************/ 00332000
*                                                                  0362 00333000
*   CALL AMSTP044(GDTTBL,PRINTME);  /*                       @Y30LB33*/ 00334000
@RF00337 L     @15,@PC00001                                        0362 00335000
         ST    @15,@AL00001                                        0362 00336000
         LA    @14,PRINTME                                         0362 00337000
         ST    @14,@AL00001+4                                      0362 00338000
         MVI   @AL00001+4,X'80'                                    0362 00339000
         L     @15,GDTRES(,@15)                                    0362 00340000
         LA    @01,@AL00001                                        0362 00341000
         BALR  @14,@15                                             0362 00342000
*                                                                  0363 00343000
*   /*****************************************************************/ 00344000
*   /*                                                               */ 00345000
*   /* IF THERE ARE NO BASE VOLUME RECORDS, DUPLICATE VOLUME RECORDS,*/ 00346000
*   /* PLACE HOLDER OR CARTRIDGE INDEX RECORDS IN THE INVENTORY,     */ 00347000
*   /* PRINT THE APPROPRIATE IDC0832I MSG.                   @ZA11679*/ 00348000
*   /*                                                               */ 00349000
*   /*****************************************************************/ 00350000
*                                                                  0363 00351000
*   IF MAINCTR=0&ADDR(NGRPD)=NULLPTR THEN                          0363 00352000
         SLR   @15,@15                                             0363 00353000
         C     @15,MAINCTR                                         0363 00354000
         BNE   @RF00363                                            0363 00355000
         L     @14,@PC00001+4                                      0363 00356000
         C     @15,FDTPTR+16(,@14)                                 0363 00357000
         BNE   @RF00363                                            0363 00358000
*     DO;                           /*                       @ZA11679*/ 00359000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @ZA11679*/ 00360000
         L     @07,DDSTRU                                          0365 00361000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0365 00362000
*       DARGSMOD=MODLV0;            /*                       @ZA11679*/ 00363000
         MVC   DARGSMOD(3,@07),@CC02396                            0366 00364000
*       IF ADDR(CTGSCNT)>0|ADDR(ALLC)>NULLPTR THEN                 0367 00365000
         C     @15,FDTPTR+84(,@14)                                 0367 00366000
         BL    @RT00367                                            0367 00367000
         C     @15,FDTPTR+88(,@14)                                 0367 00368000
         BNL   @RF00367                                            0367 00369000
@RT00367 DS    0H                                                  0368 00370000
*         DARGSENT=MSG832CI;        /*                       @ZA11679*/ 00371000
         L     @01,DDSTRU                                          0368 00372000
         MVI   DARGSENT(@01),X'2A'                                 0368 00373000
*       ELSE                                                       0369 00374000
*         IF ADDR(DUP)>NULLPTR THEN                                0369 00375000
         B     @RC00367                                            0369 00376000
@RF00367 L     @15,@PC00001+4                                      0369 00377000
         L     @15,FDTPTR+32(,@15)                                 0369 00378000
         LTR   @15,@15                                             0369 00379000
         BNP   @RF00369                                            0369 00380000
*           DARGSENT=MSG832DV;      /*                       @ZA11679*/ 00381000
         L     @01,DDSTRU                                          0370 00382000
         MVI   DARGSENT(@01),X'27'                                 0370 00383000
*         ELSE                                                     0371 00384000
*           IF ADDR(PLHD)>NULLPTR THEN                             0371 00385000
         B     @RC00369                                            0371 00386000
@RF00369 L     @15,@PC00001+4                                      0371 00387000
         L     @15,FDTPTR+92(,@15)                                 0371 00388000
         LTR   @15,@15                                             0371 00389000
         BNP   @RF00371                                            0371 00390000
*             DARGSENT=MSG832PH;    /*                       @ZA11679*/ 00391000
         L     @01,DDSTRU                                          0372 00392000
         MVI   DARGSENT(@01),X'29'                                 0372 00393000
*       IF(ADDR(VOLSCNT)>0|ADDR(ALLV)>NULLPTR)&DARGSENT=0 THEN     0373 00394000
@RF00371 DS    0H                                                  0373 00395000
@RC00369 DS    0H                                                  0373 00396000
@RC00367 SLR   @15,@15                                             0373 00397000
         L     @14,@PC00001+4                                      0373 00398000
         C     @15,FDTPTR(,@14)                                    0373 00399000
         BL    @GL00006                                            0373 00400000
         C     @15,FDTPTR+4(,@14)                                  0373 00401000
         BNL   @RF00373                                            0373 00402000
@GL00006 L     @15,DDSTRU                                          0373 00403000
         CLI   DARGSENT(@15),0                                     0373 00404000
         BNE   @RF00373                                            0373 00405000
*         DARGSENT=MSG832BV;        /*                       @ZA11679*/ 00406000
         MVI   DARGSENT(@15),X'28'                                 0374 00407000
*       IF DARGSENT>0 THEN                                         0375 00408000
@RF00373 L     @01,DDSTRU                                          0375 00409000
         CLI   DARGSENT(@01),0                                     0375 00410000
         BNH   @RF00375                                            0375 00411000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @ZA11679*/ 00412000
         L     @15,@PC00001                                        0376 00413000
         ST    @15,@AL00001                                        0376 00414000
         LA    @14,@CF00117                                        0376 00415000
         ST    @14,@AL00001+4                                      0376 00416000
         LA    @14,DDSTRU                                          0376 00417000
         ST    @14,@AL00001+8                                      0376 00418000
         MVI   @AL00001+8,X'80'                                    0376 00419000
         L     @15,GDTPRT(,@15)                                    0376 00420000
         LA    @01,@AL00001                                        0376 00421000
         BALR  @14,@15                                             0376 00422000
*     END;                          /*                       @ZA11679*/ 00423000
@RF00375 DS    0H                                                  0378 00424000
*                                                                  0378 00425000
*   /*****************************************************************/ 00426000
*   /*                                                               */ 00427000
*   /* IF THE LASTCOND IS 8, THERE WAS AN ERROR,             #Y30LB33*/ 00428000
*   /* SO TEST THE MAINCTR TO SEE IF THERE WERE ANY          #Y30LB33*/ 00429000
*   /* REPORT LINES PRINTED. IF THERE WAS NOT, THEN          #Y30LB33*/ 00430000
*   /* SET THE LASTCOND TO 12 TO INDICATE A COMPLETE         #Y30LB33*/ 00431000
*   /* FAILURE OF THE FUNCTION REQUESTED                     #Y30LB33*/ 00432000
*   /*                                                               */ 00433000
*   /*****************************************************************/ 00434000
*                                                                  0378 00435000
*   IF LASTCOND=LASTCC08&MAINCTR=0 THEN/*                    #Y30LB33*/ 00436000
@RF00363 L     @15,@PC00001+8                                      0378 00437000
         CLC   LASTCOND(2,@15),@CH00035                            0378 00438000
         BNE   @RF00378                                            0378 00439000
         L     @14,MAINCTR                                         0378 00440000
         LTR   @14,@14                                             0378 00441000
         BNZ   @RF00378                                            0378 00442000
*     LASTCOND=LASTCC12;            /*                       #Y30LB33*/ 00443000
         MVC   LASTCOND(2,@15),@CH00038                            0379 00444000
*                                                                  0380 00445000
*   /*****************************************************************/ 00446000
*   /*                                                               */ 00447000
*   /* ISSUE THE FINAL COMPLETION MESSAGE IDC0001I           @Y30LB33*/ 00448000
*   /* OR IDC0003I BASED ON LASTCOND                         @Y30LB33*/ 00449000
*   /*                                                               */ 00450000
*   /*****************************************************************/ 00451000
*                                                                  0380 00452000
*   DARGLIST=DARGLIST&&DARGLIST;    /* NULL ARG LIST         @Y30LB33*/ 00453000
@RF00378 L     @15,DDSTRU                                          0380 00454000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0380 00455000
*   DARGSMOD=MODUNIV;               /*                       @Y30LB33*/ 00456000
         MVC   DARGSMOD(3,@15),@CC02394                            0381 00457000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB33*/ 00458000
         L     @14,@PC00001+8                                      0382 00459000
         ST    @14,DARGDBP(,@15)                                   0382 00460000
*   DARGILP=2;                      /*                       @Y30LB33*/ 00461000
         MVC   DARGILP(2,@15),@CH00156                             0383 00462000
*   IF LASTCOND<LASTCC12 THEN                                      0384 00463000
         LH    @14,LASTCOND(,@14)                                  0384 00464000
         C     @14,@CF00038                                        0384 00465000
         BNL   @RF00384                                            0384 00466000
*     DARGSENT=MSG0001I;            /*                       @Y30LB33*/ 00467000
         MVI   DARGSENT(@15),X'01'                                 0385 00468000
*   ELSE                                                           0386 00469000
*     DARGSENT=MSG3003I;            /*                       @Y30LB33*/ 00470000
         B     @RC00384                                            0386 00471000
@RF00384 L     @01,DDSTRU                                          0386 00472000
         MVI   DARGSENT(@01),X'03'                                 0386 00473000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/ 00474000
@RC00384 L     @15,@PC00001                                        0387 00475000
         ST    @15,@AL00001                                        0387 00476000
         LA    @14,@CF00117                                        0387 00477000
         ST    @14,@AL00001+4                                      0387 00478000
         LA    @14,DDSTRU                                          0387 00479000
         ST    @14,@AL00001+8                                      0387 00480000
         MVI   @AL00001+8,X'80'                                    0387 00481000
         L     @15,GDTPRT(,@15)                                    0387 00482000
         LA    @01,@AL00001                                        0387 00483000
         BALR  @14,@15                                             0387 00484000
*                                                                  0388 00485000
*   /*****************************************************************/ 00486000
*   /*                                                               */ 00487000
*   /* IF THE OUTPUT DATA SET WAS OPENED, CLOSE IT.          @ZM00727*/ 00488000
*   /* IF CLOSE FAILS, SET LASTCOND TO 4                     @ZM00727*/ 00489000
*   /*                                                               */ 00490000
*   /*****************************************************************/ 00491000
*                                                                  0388 00492000
*   IF PRINTME>0 THEN                                              0388 00493000
         L     @15,PRINTME                                         0388 00494000
         LTR   @15,@15                                             0388 00495000
         BNP   @RF00388                                            0388 00496000
*     DO;                           /*                       @ZM00727*/ 00497000
*       CALL IDCIOCL0(GDTTBL,PRINTME);/*                     @ZM00727*/ 00498000
         L     @07,@PC00001                                        0390 00499000
         ST    @07,@AL00001                                        0390 00500000
         LA    @15,PRINTME                                         0390 00501000
         ST    @15,@AL00001+4                                      0390 00502000
         MVI   @AL00001+4,X'80'                                    0390 00503000
         L     @15,GDTCLS(,@07)                                    0390 00504000
         LA    @01,@AL00001                                        0390 00505000
         BALR  @14,@15                                             0390 00506000
*       RESPECIFY                                                  0391 00507000
*         RTNREG RSTD;                                             0391 00508000
*       TESTRC=RTNREG;                                             0392 00509000
         LR    TESTRC,RTNREG                                       0392 00510000
*       RESPECIFY                                                  0393 00511000
*         RTNREG UNRSTD;            /*                       @ZM00727*/ 00512000
*                                                                  0393 00513000
*       /*************************************************************/ 00514000
*       /*                                                           */ 00515000
*       /* IF THE RETURN CODE IS NOT ZERO, SET               @ZM00727*/ 00516000
*       /* LASTCOND TO 4                                     @ZM00727*/ 00517000
*       /*                                                           */ 00518000
*       /*************************************************************/ 00519000
*                                                                  0394 00520000
*       IF TESTRC^=0 THEN           /*                       @ZM00727*/ 00521000
         LTR   TESTRC,TESTRC                                       0394 00522000
         BZ    @RF00394                                            0394 00523000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @ZM00727*/ 00524000
         L     @15,@PC00001+8                                      0395 00525000
         LH    @14,LASTCOND(,@15)                                  0395 00526000
         LA    @07,4                                               0395 00527000
         CR    @14,@07                                             0395 00528000
         BNL   *+6                                                      00529000
         LR    @14,@07                                             0395 00530000
         STH   @14,LASTCOND(,@15)                                  0395 00531000
*     END;                          /*                       @ZM00727*/ 00532000
*                                                                  0396 00533000
@RF00394 DS    0H                                                  0397 00534000
*   /*****************************************************************/ 00535000
*   /*                                                               */ 00536000
*   /* RETURN TO AMS EXECUTIVE                               @Y30LB33*/ 00537000
*   /*                                                               */ 00538000
*   /*****************************************************************/ 00539000
*                                                                  0397 00540000
*   IF GDTDBG=NULLPTR THEN                                         0397 00541000
@RF00388 L     @15,@PC00001                                        0397 00542000
         L     @15,GDTDBG(,@15)                                    0397 00543000
         LTR   @15,@15                                             0397 00544000
         BZ    @RT00397                                            0397 00545000
*     ;                                                            0398 00546000
*   ELSE                                                           0399 00547000
*     CALL IDCDB010(GDTTBL,'LVAE'); /*                       @Y30LB33*/ 00548000
         L     @15,@PC00001                                        0399 00549000
         ST    @15,@AL00001                                        0399 00550000
         LA    @14,@CC02422                                        0399 00551000
         ST    @14,@AL00001+4                                      0399 00552000
         MVI   @AL00001+4,X'80'                                    0399 00553000
         L     @15,GDTDBG(,@15)                                    0399 00554000
         LA    @01,@AL00001                                        0399 00555000
         BALR  @14,@15                                             0399 00556000
*   OLDERID2=NEWERID2;                                             0400 00557000
@RT00397 L     @15,@PC00001                                        0400 00558000
         L     @14,GDTTR2(,@15)                                    0400 00559000
         MVC   @TS00001(95),NEWERID2(@14)                          0400 00560000
         MVC   OLDERID2(95,@14),@TS00001                           0400 00561000
*   NEWID2='LVAE';                  /*                       @Y30LB33*/ 00562000
         MVC   NEWID2(4,@14),@CC02422                              0401 00563000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0402 00564000
*                                                                  0402 00565000
         ST    @15,@AL00001                                        0402 00566000
         LA    @14,MODID                                           0402 00567000
         ST    @14,@AL00001+4                                      0402 00568000
         L     @14,@PC00001+8                                      0402 00569000
         ST    @14,@AL00001+8                                      0402 00570000
         MVI   @AL00001+8,X'80'                                    0402 00571000
         L     @15,GDTEPL(,@15)                                    0402 00572000
         LA    @01,@AL00001                                        0402 00573000
         BALR  @14,@15                                             0402 00574000
*   /*****************************************************************/ 00575000
*   /*                                                               */ 00576000
*   /*                                                       @Y30LB33*/ 00577000
*   /*                                                               */ 00578000
*   /*****************************************************************/ 00579000
*                                                                  0403 00580000
*                                                                  0403 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* PROCEDURE NAME - SELRPT                               @Y30LB33*/ 00584000
*   /*                                                       @Y30LB33*/ 00585000
*   /* FUNCTION - SELECTS THE ROUTINES TO PRINT THE          @Y30LB33*/ 00586000
*   /* REPORT REQUESTED.                                     @Y30LB33*/ 00587000
*   /*                                                       @Y30LB33*/ 00588000
*   /* INPUT - THE FDTTBL                                    @Y30LB33*/ 00589000
*   /*                                                       @Y30LB33*/ 00590000
*   /* OUTPUT - IF AN ERROR OCCURS, THE RETURN CODE          @Y30LB33*/ 00591000
*   /* IS SET TO 16 AND LASTCOND IS SET TO EITHER            @Y30LB33*/ 00592000
*   /* 8, IF PART OF THE REPORT WAS PRODUCED, OR             @Y30LB33*/ 00593000
*   /* 12, IF NONE OF THE REPORT WAS PRODUCED.               @Y30LB33*/ 00594000
*   /* OTHERWISE, BOTH CODES ARE ZERO.                       @Y30LB33*/ 00595000
*   /*                                                               */ 00596000
*   /*****************************************************************/ 00597000
*                                                                  0403 00598000
*SELRPT:                                                           0403 00599000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 00600000
*                                                                  0403 00601000
@EL00001 L     @13,4(,@13)                                         0403 00602000
@EF00001 L     @00,@SIZDATD                                        0403 00603000
         LR    @01,@11                                             0403 00604000
         FREEMAIN R,LV=(0),A=(1)                                        00605000
@ER00001 LM    @14,@12,12(@13)                                     0403 00606000
         BR    @14                                                 0403 00607000
SELRPT   ST    @14,@SA00002                                        0403 00608000
*   /*****************************************************************/ 00609000
*   /*                                                               */ 00610000
*   /* HERE IS THE LIST FORM OF THE MODESET INSTRUCTIONS     @ZA27752*/ 00611000
*   /* MODESET MF(L,MOD1) MODE(SUP)                                  */ 00612000
*   /*                                                               */ 00613000
*   /*****************************************************************/ 00614000
*                                                                  0404 00615000
*   DCL                                                            0404 00616000
*     1 MOD1 STATIC BDY(WORD),      /* DEFINE LIST                   */ 00617000
*      2 MOD101 BIT(8) INIT('00000000'B),/* OR MASK                  */ 00618000
*      2 MOD102 BIT(8) INIT('00000000'B),/* AND MASK                 */ 00619000
*      2 MOD103 BIT(8) INIT('00000000'B),/* RESERVED                 */ 00620000
*      2 MOD104 BIT(8) INIT('00001100'B);/*                  @ZA27752*/ 00621000
*                                                                  0404 00622000
*   /*****************************************************************/ 00623000
*   /*                                                               */ 00624000
*   /* MODESET MF(L,MOD2) KEY(NZERO) MODE(PROB)                      */ 00625000
*   /*                                                               */ 00626000
*   /*****************************************************************/ 00627000
*                                                                  0405 00628000
*   DCL                                                            0405 00629000
*     1 MOD2 STATIC BDY(WORD),      /* DEFINE LIST                   */ 00630000
*      2 MOD201 BIT(8) INIT('00000000'B),/* OR MASK                  */ 00631000
*      2 MOD202 BIT(8) INIT('00000000'B),/* AND MASK                 */ 00632000
*      2 MOD203 BIT(8) INIT('00000000'B),/* RESERVED                 */ 00633000
*      2 MOD204 BIT(8) INIT('00100100'B);/*                  @ZA27752*/ 00634000
*   OLDERID2=NEWERID2;                                             0406 00635000
         L     @03,@PC00001                                        0406 00636000
         L     @03,GDTTR2(,@03)                                    0406 00637000
         MVC   @TS00001(95),NEWERID2(@03)                          0406 00638000
         MVC   OLDERID2(95,@03),@TS00001                           0406 00639000
*   NEWID2='LVBA';                  /*                       @Y30LB33*/ 00640000
         MVC   NEWID2(4,@03),@CC02439                              0407 00641000
*   TESTRC=0;                       /*                       @Y30LB33*/ 00642000
*                                                                  0408 00643000
         SLR   TESTRC,TESTRC                                       0408 00644000
*   /*****************************************************************/ 00645000
*   /*                                                               */ 00646000
*   /* INITIATE THE MODESET TO ALLOW THE USE                 @ZA27752*/ 00647000
*   /* OF PRIVILEGED INSTRUCTIONS.                           @ZA27752*/ 00648000
*   /*                                                               */ 00649000
*   /*****************************************************************/ 00650000
*                                                                  0409 00651000
*   RESPECIFY                                                      0409 00652000
*     REG1 RESTRICTED;              /*                       @ZA27752*/ 00653000
*   REG1=MOD1;                      /*                       @ZA27752*/ 00654000
         L     REG1,MOD1                                           0410 00655000
*LMODE1:                                                           0411 00656000
*   DO;                             /* MODESET MF(E,REG1)            */ 00657000
LMODE1   DS    0H                                                  0412 00658000
*     RESPECIFY                                                    0412 00659000
*       GPR01F RESTRICTED;                                         0412 00660000
*     GPR01F=REG1;                  /* MODESET PARMLIST              */ 00661000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 00662000
         SVC   107                                                 0414 00663000
*     RESPECIFY                                                    0415 00664000
*      (GPR01F) UNRESTRICTED;                                      0415 00665000
*   END;                            /* MODESET MF(E,REG1)    @ZA27752*/ 00666000
*   RESPECIFY                                                      0417 00667000
*     REG1 UNRESTRICTED;            /*                       @ZA27752*/ 00668000
*                                                                  0417 00669000
*   /*****************************************************************/ 00670000
*   /*                                                               */ 00671000
*   /* SELECT THE ALLVOLUME SEQUENCER IF ALLVOLUMES          @Y30LB33*/ 00672000
*   /* IS REQUESTED IN THE FDTTBL                            @Y30LB33*/ 00673000
*   /*                                                               */ 00674000
*   /*****************************************************************/ 00675000
*                                                                  0418 00676000
*   IF ADDR(ALLV)>0 THEN                                           0418 00677000
         L     @06,@PC00001+4                                      0418 00678000
         L     @06,FDTPTR+4(,@06)                                  0418 00679000
         LTR   @06,@06                                             0418 00680000
         BNP   @RF00418                                            0418 00681000
*     CALL ALLVSEQ;                 /*                       @Y30LB33*/ 00682000
         BAL   @14,ALLVSEQ                                         0419 00683000
*   RESPECIFY                                                      0420 00684000
*     RTNREG RSTD;                                                 0420 00685000
@RF00418 DS    0H                                                  0421 00686000
*   TESTRC=RTNREG;                                                 0421 00687000
         LR    TESTRC,RTNREG                                       0421 00688000
*   RESPECIFY                                                      0422 00689000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 00690000
*                                                                  0422 00691000
*   /*****************************************************************/ 00692000
*   /*                                                               */ 00693000
*   /* SELECT THE VOLUME SEQUENCER IF VOLUMES IS             @Y30LB33*/ 00694000
*   /* REQUESTED IN THE FDTTBL                               @Y30LB33*/ 00695000
*   /*                                                               */ 00696000
*   /*****************************************************************/ 00697000
*                                                                  0423 00698000
*   IF ADDR(VOLSCNT)>0 THEN                                        0423 00699000
         L     @06,@PC00001+4                                      0423 00700000
         L     @06,FDTPTR(,@06)                                    0423 00701000
         LTR   @06,@06                                             0423 00702000
         BNP   @RF00423                                            0423 00703000
*     CALL VOLSEQ;                  /*                       @Y30LB33*/ 00704000
         BAL   @14,VOLSEQ                                          0424 00705000
*   RESPECIFY                                                      0425 00706000
*     RTNREG RSTD;                                                 0425 00707000
@RF00423 DS    0H                                                  0426 00708000
*   TESTRC=RTNREG;                                                 0426 00709000
         LR    TESTRC,RTNREG                                       0426 00710000
*   RESPECIFY                                                      0427 00711000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 00712000
*                                                                  0428 00713000
*   /*****************************************************************/ 00714000
*   /*                                                               */ 00715000
*   /* SELECT THE GROUP SEQUENCER IF GROUPS IS               @Y30LB33*/ 00716000
*   /* REQUESTED                                             @Y30LB33*/ 00717000
*   /*                                                               */ 00718000
*   /*****************************************************************/ 00719000
*                                                                  0428 00720000
*   IF ADDR(GRPCNT)>0 THEN                                         0428 00721000
         L     @06,@PC00001+4                                      0428 00722000
         L     @06,FDTPTR+8(,@06)                                  0428 00723000
         LTR   @06,@06                                             0428 00724000
         BNP   @RF00428                                            0428 00725000
*     CALL GRPSEQ;                  /*                       @Y30LB33*/ 00726000
         BAL   @14,GRPSEQ                                          0429 00727000
*   RESPECIFY                                                      0430 00728000
*     RTNREG RSTD;                                                 0430 00729000
@RF00428 DS    0H                                                  0431 00730000
*   TESTRC=RTNREG;                                                 0431 00731000
         LR    TESTRC,RTNREG                                       0431 00732000
*   RESPECIFY                                                      0432 00733000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 00734000
*                                                                  0432 00735000
*   /*****************************************************************/ 00736000
*   /*                                                               */ 00737000
*   /* SELECT THE ALLGROUPS SEQUENCER IF ALLGROUPS           @Y30LB33*/ 00738000
*   /* IS SPECIFIED IN THE FDTTBL                            @Y30LB33*/ 00739000
*   /*                                                               */ 00740000
*   /*****************************************************************/ 00741000
*                                                                  0433 00742000
*   IF ADDR(AGRP)>0 THEN                                           0433 00743000
         L     @06,@PC00001+4                                      0433 00744000
         L     @06,FDTPTR+12(,@06)                                 0433 00745000
         LTR   @06,@06                                             0433 00746000
         BNP   @RF00433                                            0433 00747000
*     CALL ALLGSEQ;                 /*                       @Y30LB33*/ 00748000
         BAL   @14,ALLGSEQ                                         0434 00749000
*   RESPECIFY                                                      0435 00750000
*     RTNREG RSTD;                                                 0435 00751000
@RF00433 DS    0H                                                  0436 00752000
*   TESTRC=RTNREG;                                                 0436 00753000
         LR    TESTRC,RTNREG                                       0436 00754000
*   RESPECIFY                                                      0437 00755000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 00756000
*                                                                  0437 00757000
*   /*****************************************************************/ 00758000
*   /*                                                               */ 00759000
*   /* SELECT THE CARTRIDGE SEQUENCER IF CARTRIDGES IS       @Z40LB66*/ 00760000
*   /* REQUESTED                                             @Z40LB66*/ 00761000
*   /*                                                               */ 00762000
*   /*****************************************************************/ 00763000
*                                                                  0438 00764000
*   IF ADDR(CTGSCNT)>0 THEN                                        0438 00765000
         L     @03,@PC00001+4                                      0438 00766000
         L     @03,FDTPTR+84(,@03)                                 0438 00767000
         LTR   @03,@03                                             0438 00768000
         BNP   @RF00438                                            0438 00769000
*     CALL CTGSEQ;                  /*                       @Z40LB66*/ 00770000
         BAL   @14,CTGSEQ                                          0439 00771000
*   RESPECIFY                                                      0440 00772000
*     RTNREG RSTD;                                                 0440 00773000
@RF00438 DS    0H                                                  0441 00774000
*   TESTRC=RTNREG;                                                 0441 00775000
         LR    TESTRC,RTNREG                                       0441 00776000
*   RESPECIFY                                                      0442 00777000
*     RTNREG UNRSTD;                /*                       @Z40LB66*/ 00778000
*                                                                  0442 00779000
*   /*****************************************************************/ 00780000
*   /*                                                               */ 00781000
*   /* SELECT THE ALLCARTRIDGE SEQUENCER IF                  @Z40LB66*/ 00782000
*   /* ALLCARTRIDGES IS SPECIFIED IN THE FDTTBL              @Z40LB66*/ 00783000
*   /*                                                               */ 00784000
*   /*****************************************************************/ 00785000
*                                                                  0443 00786000
*   IF ADDR(ALLC)>0 THEN                                           0443 00787000
         L     @03,@PC00001+4                                      0443 00788000
         L     @03,FDTPTR+88(,@03)                                 0443 00789000
         LTR   @03,@03                                             0443 00790000
         BNP   @RF00443                                            0443 00791000
*     CALL ALLCSEQ;                 /*                       @Z40LB66*/ 00792000
         BAL   @14,ALLCSEQ                                         0444 00793000
*   RESPECIFY                                                      0445 00794000
*     RTNREG RSTD;                                                 0445 00795000
@RF00443 DS    0H                                                  0446 00796000
*   TESTRC=RTNREG;                                                 0446 00797000
         LR    TESTRC,RTNREG                                       0446 00798000
*   RESPECIFY                                                      0447 00799000
*     RTNREG UNRSTD;                /*                       @Z40LB66*/ 00800000
*                                                                  0448 00801000
*   /*****************************************************************/ 00802000
*   /*                                                               */ 00803000
*   /* PRINT THE LEGEND FOR THE REPORT IF ANY                #Y30LB33*/ 00804000
*   /* REPORTING WAS DONE, AS INDICATED BY MAINCTR.          @Y30LB33*/ 00805000
*   /*                                                               */ 00806000
*   /*****************************************************************/ 00807000
*                                                                  0448 00808000
*   IF MAINCTR>0&ADDR(LED)>0 THEN                                  0448 00809000
         SLR   @07,@07                                             0448 00810000
         C     @07,MAINCTR                                         0448 00811000
         BNL   @RF00448                                            0448 00812000
         L     @15,@PC00001+4                                      0448 00813000
         C     @07,FDTPTR+60(,@15)                                 0448 00814000
         BNL   @RF00448                                            0448 00815000
*     DO;                           /*                       @F30LB33*/ 00816000
*       DARGLIST=DARGLIST&&DARGLIST;/* NULL ARG LIST         @Y30LB33*/ 00817000
         L     @07,DDSTRU                                          0450 00818000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0450 00819000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 00820000
         MVC   DARGSMOD(3,@07),@CC02396                            0451 00821000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB33*/ 00822000
*                                                                  0452 00823000
         L     @07,@PC00001                                        0452 00824000
         ST    @07,@AL00001                                        0452 00825000
         LA    @15,PRINTME                                         0452 00826000
         ST    @15,@AL00001+4                                      0452 00827000
         MVI   @AL00001+4,X'80'                                    0452 00828000
         L     @15,GDTRES(,@07)                                    0452 00829000
         LA    @01,@AL00001                                        0452 00830000
         BALR  @14,@15                                             0452 00831000
*       /*************************************************************/ 00832000
*       /*                                                           */ 00833000
*       /* RE-ESTABLISH THE MAIN TITLE LINE                  @Y30LB33*/ 00834000
*       /*                                                           */ 00835000
*       /*************************************************************/ 00836000
*                                                                  0453 00837000
*       PCSTLP=0;                   /*                       @Y30LB33*/ 00838000
         SLR   @07,@07                                             0453 00839000
         ST    @07,PCSTLP                                          0453 00840000
*       PCSTLC=0;                   /*                       @Y30LB33*/ 00841000
         STH   @07,PCSTLC                                          0454 00842000
*       CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*               @Y30LB33*/ 00843000
         L     @07,@PC00001                                        0455 00844000
         ST    @07,@AL00001                                        0455 00845000
         LA    @15,PRINTME                                         0455 00846000
         ST    @15,@AL00001+4                                      0455 00847000
         LA    @15,PCARG                                           0455 00848000
         ST    @15,@AL00001+8                                      0455 00849000
         L     @15,GDTESA(,@07)                                    0455 00850000
         LA    @01,@AL00001                                        0455 00851000
         BALR  @14,@15                                             0455 00852000
*       IF ADDR(ALLC)>0|ADDR(CTGSCNT)>0 THEN                       0456 00853000
         SLR   @07,@07                                             0456 00854000
         L     @15,@PC00001+4                                      0456 00855000
         C     @07,FDTPTR+88(,@15)                                 0456 00856000
         BL    @RT00456                                            0456 00857000
         C     @07,FDTPTR+84(,@15)                                 0456 00858000
         BNL   @RF00456                                            0456 00859000
@RT00456 DS    0H                                                  0457 00860000
*         DARGSENT=CTGSLEG;         /*                       @Z40LB66*/ 00861000
         L     @07,DDSTRU                                          0457 00862000
         MVI   DARGSENT(@07),X'25'                                 0457 00863000
*       ELSE                                                       0458 00864000
*         IF ADDR(STAT)>0 THEN                                     0458 00865000
         B     @RC00456                                            0458 00866000
@RF00456 L     @07,@PC00001+4                                      0458 00867000
         L     @07,FDTPTR+52(,@07)                                 0458 00868000
         LTR   @07,@07                                             0458 00869000
         BNP   @RF00458                                            0458 00870000
*           DARGSENT=STATLEG;       /*                       @Z40LB66*/ 00871000
         L     @07,DDSTRU                                          0459 00872000
         MVI   DARGSENT(@07),X'09'                                 0459 00873000
*         ELSE                                                     0460 00874000
*           DARGSENT=USAGELEG;      /*                       @Y30LB33*/ 00875000
         B     @RC00458                                            0460 00876000
@RF00458 L     @07,DDSTRU                                          0460 00877000
         MVI   DARGSENT(@07),X'0D'                                 0460 00878000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 00879000
@RC00458 DS    0H                                                  0461 00880000
@RC00456 L     @07,@PC00001                                        0461 00881000
         ST    @07,@AL00001                                        0461 00882000
         LA    @15,PRINTME                                         0461 00883000
         ST    @15,@AL00001+4                                      0461 00884000
         LA    @15,DDSTRU                                          0461 00885000
         ST    @15,@AL00001+8                                      0461 00886000
         MVI   @AL00001+8,X'80'                                    0461 00887000
         L     @15,GDTPRT(,@07)                                    0461 00888000
         LA    @01,@AL00001                                        0461 00889000
         BALR  @14,@15                                             0461 00890000
*     END;                          /*                       @Y30LB33*/ 00891000
*                                                                  0463 00892000
*   /*****************************************************************/ 00893000
*   /*                                                               */ 00894000
*   /* INITIATE THE MODESET TO DISALLOW THE USE OF PRIVI-    @ZA27752*/ 00895000
*   /* LEGED INSTRUCTIONS AND RESTORE PROBLEM PROGRAM STATE. @ZA27752*/ 00896000
*   /*                                                               */ 00897000
*   /*****************************************************************/ 00898000
*                                                                  0463 00899000
*   RESPECIFY                                                      0463 00900000
*     REG1 RESTRICTED;              /*                       @ZA27752*/ 00901000
@RF00448 DS    0H                                                  0464 00902000
*   REG1=MOD2;                      /*                       @ZA27752*/ 00903000
         L     REG1,MOD2                                           0464 00904000
*LMODE2:                                                           0465 00905000
*   DO;                             /* MODESET MF(E,REG1)            */ 00906000
LMODE2   DS    0H                                                  0466 00907000
*     RESPECIFY                                                    0466 00908000
*       GPR01F RESTRICTED;                                         0466 00909000
*     GPR01F=REG1;                  /* MODESET PARMLIST              */ 00910000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 00911000
         SVC   107                                                 0468 00912000
*     RESPECIFY                                                    0469 00913000
*      (GPR01F) UNRESTRICTED;                                      0469 00914000
*   END;                            /* MODESET MF(E,REG1)    @ZA27752*/ 00915000
*   RESPECIFY                                                      0471 00916000
*     REG1 UNRESTRICTED;            /*                       @ZA27752*/ 00917000
*                                                                  0471 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* RETURN WITH THE CODE RETURNED FROM THE SELECTED       @Y30LB33*/ 00921000
*   /* SEQUENCER                                             @Y30LB33*/ 00922000
*   /*                                                               */ 00923000
*   /*****************************************************************/ 00924000
*                                                                  0472 00925000
*   RETURN CODE(TESTRC);            /*                       @Y30LB33*/ 00926000
         LR    @15,TESTRC                                          0472 00927000
@EL00002 DS    0H                                                  0472 00928000
@EF00002 DS    0H                                                  0472 00929000
@ER00002 L     @14,@SA00002                                        0472 00930000
         BR    @14                                                 0472 00931000
*   END SELRPT;                     /*                       @Y30LB33*/ 00932000
*                                                                  0474 00933000
*   /*****************************************************************/ 00934000
*   /*                                                               */ 00935000
*   /* PROCEDURE NAME - VOLSEQ                               @Y30LB33*/ 00936000
*   /*                                                       @Y30LB33*/ 00937000
*   /* FUNCTION - ESTABLISH SUBTITLES AND CONTROLS           @Y30LB33*/ 00938000
*   /* PROCESSING OF THE VOLUME SERIALS IN THE               @Y30LB33*/ 00939000
*   /* VOLUME PARAMETER AND THE VOLUME SUMMARIES             @Y30LB33*/ 00940000
*   /*                                                       @Y30LB33*/ 00941000
*   /* INPUT - FDTTBL                                        @Y30LB33*/ 00942000
*   /*                                                       @Y30LB33*/ 00943000
*   /* OUTPUT - RETURN CODE OF 16 AND LASTCOND OF 8          @Y30LB33*/ 00944000
*   /* IF THE REPORT DOES NOT COMPLETE SUCCESSFULLY.         @Y30LB33*/ 00945000
*   /* OTHERWISE, BOTH CODES ARE ZERO.                       @Y30LB33*/ 00946000
*   /*                                                               */ 00947000
*   /*****************************************************************/ 00948000
*                                                                  0474 00949000
*VOLSEQ:                                                           0474 00950000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 00951000
VOLSEQ   ST    @14,@SA00003                                        0474 00952000
*   OLDERID2=NEWERID2;                                             0475 00953000
         L     @03,@PC00001                                        0475 00954000
         L     @03,GDTTR2(,@03)                                    0475 00955000
         MVC   @TS00001(95),NEWERID2(@03)                          0475 00956000
         MVC   OLDERID2(95,@03),@TS00001                           0475 00957000
*   NEWID2='LVCA';                  /*                       @Y30LB33*/ 00958000
         MVC   NEWID2(4,@03),@CC02454                              0476 00959000
*   TESTRC=0;                       /*                       @Y30LB33*/ 00960000
*                                                                  0477 00961000
         SLR   TESTRC,TESTRC                                       0477 00962000
*   /*****************************************************************/ 00963000
*   /*                                                               */ 00964000
*   /* ESTABLISH THE SUBTITLE LINES BASED ON THE REPORT      @Y30LB33*/ 00965000
*   /* TYPE                                                  @Y30LB33*/ 00966000
*   /*                                                               */ 00967000
*   /*****************************************************************/ 00968000
*                                                                  0478 00969000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 00970000
         L     @03,DDSTRU                                          0478 00971000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      0478 00972000
*   DARGRETP=ADDR(TITLSPCE);        /*                       @Y30LB33*/ 00973000
         LA    @15,TITLSPCE                                        0479 00974000
         ST    @15,DARGRETP(,@03)                                  0479 00975000
*   DARGRETL=LENGTH(TITLSPCE);      /*                       @Y30LB33*/ 00976000
         MVC   DARGRETL(2,@03),@CH02376                            0480 00977000
*   DARGSMOD=MODLV0;                /*                       @Y30LB33*/ 00978000
         MVC   DARGSMOD(3,@03),@CC02396                            0481 00979000
*   IF ADDR(STAT)>0 THEN                                           0482 00980000
         L     @15,@PC00001+4                                      0482 00981000
         L     @15,FDTPTR+52(,@15)                                 0482 00982000
         LTR   @15,@15                                             0482 00983000
         BNP   @RF00482                                            0482 00984000
*     DARGSENT=VOLSTLE;             /*                       @Y30LB33*/ 00985000
         MVI   DARGSENT(@03),X'1B'                                 0483 00986000
*   ELSE                                                           0484 00987000
*     DARGSENT=VOLUTLE;             /*                       @Y30LB33*/ 00988000
*                                                                  0484 00989000
         B     @RC00482                                            0484 00990000
@RF00482 L     @03,DDSTRU                                          0484 00991000
         MVI   DARGSENT(@03),X'12'                                 0484 00992000
*   /*****************************************************************/ 00993000
*   /*                                                               */ 00994000
*   /* ISSUE UPRINT TOE READ IN THE SUBTITLES                @Y30LB33*/ 00995000
*   /*                                                               */ 00996000
*   /*****************************************************************/ 00997000
*                                                                  0485 00998000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/ 00999000
*                                                                  0485 01000000
@RC00482 L     @03,@PC00001                                        0485 01001000
         ST    @03,@AL00001                                        0485 01002000
         LA    @15,@CF00117                                        0485 01003000
         ST    @15,@AL00001+4                                      0485 01004000
         LA    @15,DDSTRU                                          0485 01005000
         ST    @15,@AL00001+8                                      0485 01006000
         MVI   @AL00001+8,X'80'                                    0485 01007000
         L     @15,GDTPRT(,@03)                                    0485 01008000
         LA    @01,@AL00001                                        0485 01009000
         BALR  @14,@15                                             0485 01010000
*   /*****************************************************************/ 01011000
*   /*                                                               */ 01012000
*   /* RESET THE MAIN TITLE ESTABLISHED BEFORE               @Y30LB33*/ 01013000
*   /*                                                               */ 01014000
*   /*****************************************************************/ 01015000
*                                                                  0486 01016000
*   CALL AMSTP044(GDTTBL,PRINTME);  /*                       @Y30LB33*/ 01017000
*                                                                  0486 01018000
         L     @03,@PC00001                                        0486 01019000
         ST    @03,@AL00001                                        0486 01020000
         LA    @15,PRINTME                                         0486 01021000
         ST    @15,@AL00001+4                                      0486 01022000
         MVI   @AL00001+4,X'80'                                    0486 01023000
         L     @15,GDTRES(,@03)                                    0486 01024000
         LA    @01,@AL00001                                        0486 01025000
         BALR  @14,@15                                             0486 01026000
*   /*****************************************************************/ 01027000
*   /*                                                               */ 01028000
*   /* ESTABLISH THE NEW MAIN TITLE AND SUBTITLES            @Y30LB33*/ 01029000
*   /*                                                               */ 01030000
*   /*****************************************************************/ 01031000
*                                                                  0487 01032000
*   PCSTLP=ADDR(TITLSPCE);          /*                       @Y30LB33*/ 01033000
         LA    @03,TITLSPCE                                        0487 01034000
         ST    @03,PCSTLP                                          0487 01035000
*   IF ADDR(STAT)>0 THEN                                           0488 01036000
         L     @03,@PC00001+4                                      0488 01037000
         L     @03,FDTPTR+52(,@03)                                 0488 01038000
         LTR   @03,@03                                             0488 01039000
         BNP   @RF00488                                            0488 01040000
*     PCSTLC=2;                     /*                       @Y30LB33*/ 01041000
         MVC   PCSTLC(2),@CH00156                                  0489 01042000
*   ELSE                                                           0490 01043000
*     PCSTLC=3;                     /*                       @Y30LB33*/ 01044000
         B     @RC00488                                            0490 01045000
@RF00488 MVC   PCSTLC(2),@CH00165                                  0490 01046000
*   CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*                   @Y30LB33*/ 01047000
@RC00488 L     @04,@PC00001                                        0491 01048000
         ST    @04,@AL00001                                        0491 01049000
         LA    @03,PRINTME                                         0491 01050000
         ST    @03,@AL00001+4                                      0491 01051000
         LA    @03,PCARG                                           0491 01052000
         ST    @03,@AL00001+8                                      0491 01053000
         L     @15,GDTESA(,@04)                                    0491 01054000
         LA    @01,@AL00001                                        0491 01055000
         BALR  @14,@15                                             0491 01056000
*                                                                  0492 01057000
*   /*****************************************************************/ 01058000
*   /*                                                               */ 01059000
*   /* SET UP THE REQUEST BLOCK TO PROCESS VOLUMES           @Y30LB33*/ 01060000
*   /*                                                               */ 01061000
*   /*****************************************************************/ 01062000
*                                                                  0492 01063000
*   VOLRVVI=VOLRVVI&&VOLRVVI;       /* NULL REQ ARG LIST     @Y30LB33*/ 01064000
         XC    VOLRVVI(68),VOLRVVI                                 0492 01065000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Y30LB33*/ 01066000
         LA    RVVIPTR,VOLRVVI                                     0493 01067000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 01068000
         LH    @04,RVVLEN                                          0494 01069000
         ST    @04,RVVLNGTH(,RVVIPTR)                              0494 01070000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 01071000
         MVI   RVVCODE(RVVIPTR),X'87'                              0495 01072000
*   RVVRDR=ON;                      /*                       @Y30LB33*/ 01073000
         OI    RVVRDR(RVVIPTR),B'10000000'                         0496 01074000
*   RVVBVRCD=ON;                    /*                       @Y30LB33*/ 01075000
         OI    RVVBVRCD(RVVIPTR),B'10000000'                       0497 01076000
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Y30LB33*/ 01077000
         LA    @04,VOLRCDBF                                        0498 01078000
         ST    @04,RVVRTBUF(,RVVIPTR)                              0498 01079000
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Y30LB33*/ 01080000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02618                        0499 01081000
*   RVVSVOL=ON;                     /*                       @Y30LB33*/ 01082000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        0500 01083000
*                                                                  0501 01084000
*   /*****************************************************************/ 01085000
*   /*                                                               */ 01086000
*   /* PASS THE REQUEST BLOCK TO THE VOLUME PROCESSOR        @Y30LB33*/ 01087000
*   /* FOR EVERY VOLUME IN THE VOLUME PARAMETER LIST.        @Y30LB33*/ 01088000
*   /* IF THE RETURN CODE IS 16, END EXECUTION.              @Y30LB33*/ 01089000
*   /*                                                               */ 01090000
*   /*****************************************************************/ 01091000
*                                                                  0501 01092000
*   DO RPTLOOP=1 BY 1 TO VOLSCNT    /*                       @Y30LB33*/ 01093000
*         WHILE(TESTRC<16);         /*                       @Y30LB33*/ 01094000
         LA    @03,1                                               0501 01095000
         STH   @03,RPTLOOP                                         0501 01096000
         B     @DE00501                                            0501 01097000
@DL00501 C     TESTRC,@CF00507                                     0501 01098000
         BNL   @DC00501                                            0501 01099000
*     RVVIPTR=ADDR(VOLRVVI);        /*                       @Y30LB33*/ 01100000
         LA    RVVIPTR,VOLRVVI                                     0502 01101000
*     RVVOLUME=VOLSVAL(RPTLOOP);    /*                       @Y30LB33*/ 01102000
         SLA   @03,3                                               0503 01103000
         L     @06,@PC00001+4                                      0503 01104000
         L     @06,FDTPTR(,@06)                                    0503 01105000
         ALR   @06,@03                                             0503 01106000
         AL    @06,@CF02637                                        0503 01107000
         MVC   RVVOLUME(6,RVVIPTR),VOLSVAL-3(@06)                  0503 01108000
*     CALL VOLPROC;                 /*                       @Y30LB33*/ 01109000
         BAL   @14,VOLPROC                                         0504 01110000
*     RESPECIFY                                                    0505 01111000
*       RTNREG RSTD;                                               0505 01112000
*     TESTRC=RTNREG;                                               0506 01113000
         LR    TESTRC,RTNREG                                       0506 01114000
*     RESPECIFY                                                    0507 01115000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 01116000
*   END;                            /*                       @Y30LB33*/ 01117000
         LA    @03,1                                               0508 01118000
         AH    @03,RPTLOOP                                         0508 01119000
         STH   @03,RPTLOOP                                         0508 01120000
@DE00501 L     @15,@PC00001+4                                      0508 01121000
         L     @01,FDTPTR(,@15)                                    0508 01122000
         CH    @03,VOLSCNT(,@01)                                   0508 01123000
         BNH   @DL00501                                            0508 01124000
@DC00501 DS    0H                                                  0509 01125000
*                                                                  0509 01126000
*   /*****************************************************************/ 01127000
*   /*                                                               */ 01128000
*   /* PROCESS THE VOLUME LIST FOR DUPLICATES                @Y30LB33*/ 01129000
*   /* IF WE ARE DOING A STATUS-TYPE REPORT                  @Y30LB33*/ 01130000
*   /*                                                               */ 01131000
*   /*****************************************************************/ 01132000
*                                                                  0509 01133000
*   IF TESTRC^=16&ADDR(STAT)>0 THEN                                0509 01134000
         C     TESTRC,@CF00507                                     0509 01135000
         BE    @RF00509                                            0509 01136000
         L     @03,@PC00001+4                                      0509 01137000
         L     @03,FDTPTR+52(,@03)                                 0509 01138000
         LTR   @03,@03                                             0509 01139000
         BNP   @RF00509                                            0509 01140000
*     DO;                           /*                       @Y30LB33*/ 01141000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 01142000
         LA    RVVIPTR,VOLRVVI                                     0511 01143000
*       RVVBVRCD=OFF;               /*                       @Y30LB33*/ 01144000
*       RVVDUPRC=ON;                /*                       @Y30LB33*/ 01145000
         OI    RVVDUPRC(RVVIPTR),B'00010000'                       0513 01146000
         NI    RVVBVRCD(RVVIPTR),B'01111111'                       0513 01147000
*       RVVDUPID=0;                 /*                       @Y30LB33*/ 01148000
         MVI   RVVDUPID(RVVIPTR),X'00'                             0514 01149000
*       RVVSDUP=ON;                 /*                       @Y30LB33*/ 01150000
         OI    RVVSDUP(RVVIPTR),B'00000010'                        0515 01151000
*       RVVDVOL=ON;                 /*                       @Y30LB33*/ 01152000
         OI    RVVDVOL(RVVIPTR),B'00000010'                        0516 01153000
*       RVVSVOL=ON;                 /*                       @Y30LB33*/ 01154000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        0517 01155000
*       FRSTDUP=ON;                 /* INDICATE FIRST DUPLICATE    0518 01156000
*                                                            @ZA00676*/ 01157000
*                                                                  0518 01158000
         OI    FRSTDUP,B'10000000'                                 0518 01159000
*       /*************************************************************/ 01160000
*       /*                                                           */ 01161000
*       /* PASS THE REQUEST BLOCK TO THE                     @Y30LB33*/ 01162000
*       /* DUPLICATE PROCESSOR FOR EVERY VOLUME IN           @Y30LB33*/ 01163000
*       /* THE VOLUME PARAMETER LIST. IF THE RETURN          @Y30LB33*/ 01164000
*       /* CODE FROM THE DUPLICATE PROCESSOR IS 16,          @Y30LB33*/ 01165000
*       /* END EXECUTION                                     @Y30LB33*/ 01166000
*       /*                                                           */ 01167000
*       /*************************************************************/ 01168000
*                                                                  0519 01169000
*       DO RPTLOOP=1 BY 1 TO VOLSCNT/*                       @Y30LB33*/ 01170000
*             WHILE(TESTRC<16);     /*                       @Y30LB33*/ 01171000
         LA    @04,1                                               0519 01172000
         STH   @04,RPTLOOP                                         0519 01173000
         B     @DE00519                                            0519 01174000
@DL00519 C     TESTRC,@CF00507                                     0519 01175000
         BNL   @DC00519                                            0519 01176000
*         RVVOLUME=VOLSVAL(RPTLOOP);/*                       @Y30LB33*/ 01177000
         SLA   @04,3                                               0520 01178000
         L     @06,@PC00001+4                                      0520 01179000
         L     @06,FDTPTR(,@06)                                    0520 01180000
         ALR   @06,@04                                             0520 01181000
         AL    @06,@CF02637                                        0520 01182000
         MVC   RVVOLUME(6,RVVIPTR),VOLSVAL-3(@06)                  0520 01183000
*         CALL DUPPROC;             /*                       @Y30LB33*/ 01184000
         BAL   @14,DUPPROC                                         0521 01185000
*         RESPECIFY                                                0522 01186000
*           RTNREG RSTD;                                           0522 01187000
*         TESTRC=RTNREG;                                           0523 01188000
         LR    TESTRC,RTNREG                                       0523 01189000
*         RESPECIFY                                                0524 01190000
*           RTNREG UNRSTD;          /*                       @Y30LB33*/ 01191000
*       END;                        /*                       @Y30LB33*/ 01192000
         LA    @04,1                                               0525 01193000
         AH    @04,RPTLOOP                                         0525 01194000
         STH   @04,RPTLOOP                                         0525 01195000
@DE00519 L     @03,@PC00001+4                                      0525 01196000
         L     @03,FDTPTR(,@03)                                    0525 01197000
         CH    @04,VOLSCNT(,@03)                                   0525 01198000
         BNH   @DL00519                                            0525 01199000
@DC00519 DS    0H                                                  0526 01200000
*     END;                          /*                       @Y30LB33*/ 01201000
*   MYCODE=TESTRC;                  /* SAVE THE RETURN CODE  @Y30LB33*/ 01202000
@RF00509 LR    MYCODE,TESTRC                                       0527 01203000
*                                                                  0528 01204000
*   /*****************************************************************/ 01205000
*   /*                                                               */ 01206000
*   /* PASS THE SUMMARY REQUEST INDICATOR TO SUMRY           @Y30LB33*/ 01207000
*   /* TO PRINT A VOLUME SUMMARY                             @Y30LB33*/ 01208000
*   /*                                                               */ 01209000
*   /*****************************************************************/ 01210000
*                                                                  0528 01211000
*   SUMMASK=VOLSUMM;                /*                       @Y30LB33*/ 01212000
         SLR   SUMMASK,SUMMASK                                     0528 01213000
*   CALL SUMRY;                     /*                       @Y30LB33*/ 01214000
*                                                                  0529 01215000
         BAL   @14,SUMRY                                           0529 01216000
*   /*****************************************************************/ 01217000
*   /*                                                               */ 01218000
*   /* RETURN WITH A CODE OF ZERO OR 16 AS RETURNED          @Y30LB33*/ 01219000
*   /* TO THIS ROUTINE FROM CALLED PROCEDURES                @Y30LB33*/ 01220000
*   /*                                                               */ 01221000
*   /*****************************************************************/ 01222000
*                                                                  0530 01223000
*   IF MYCODE=4 THEN                                               0530 01224000
         C     MYCODE,@CF00043                                     0530 01225000
         BNE   @RF00530                                            0530 01226000
*     MYCODE=0;                     /*                       @Y30LB33*/ 01227000
         SLR   MYCODE,MYCODE                                       0531 01228000
*   RETURN CODE(MYCODE);            /*                       @Y30LB33*/ 01229000
@RF00530 LR    @15,MYCODE                                          0532 01230000
@EL00003 DS    0H                                                  0532 01231000
@EF00003 DS    0H                                                  0532 01232000
@ER00003 L     @14,@SA00003                                        0532 01233000
         BR    @14                                                 0532 01234000
*   END VOLSEQ;                     /*                       @Y30LB33*/ 01235000
*                                                                  0534 01236000
*   /*****************************************************************/ 01237000
*   /*                                                               */ 01238000
*   /* PROCEDURE NAME - GRPSEQ                               @Y30LB33*/ 01239000
*   /* FUNCTION - ESTABLISH SUBTITLES AND CONTROL            @Y30LB33*/ 01240000
*   /* PROCESSING OF THE GROUP NAMES IN THE                  @Y30LB33*/ 01241000
*   /* GROUP PARAMETER IN THE FDTTBL.                        @Y30LB33*/ 01242000
*   /* ALSO CONTROLS PRINTING OF SUMMARIES.                  @Y30LB33*/ 01243000
*   /*                                                       @Y30LB33*/ 01244000
*   /* INPUT - FDTTBL                                        @Y30LB33*/ 01245000
*   /*                                                       @Y30LB33*/ 01246000
*   /* OUTPUT - RETURN CODE OF ZERO AND A LASTCOND OF        @Y30LB33*/ 01247000
*   /* ZERO TO INDICATE ALL PROCESSING COMPLETED             @Y30LB33*/ 01248000
*   /* WITHOUT ERROR. RETURN CODE OF ZERO AND A              @Y30LB33*/ 01249000
*   /* LASTCOND OF 8 TO INDICATE THAT PROCESSING             @Y30LB33*/ 01250000
*   /* WAS COMPLETED BUT A NON-TERMINATING ERROR             @Y30LB33*/ 01251000
*   /* OCCURRED. RETURN CODE OF 16 AND LASTCOND              @Y30LB33*/ 01252000
*   /* OF 8 TO INDICATE A TERMINATING ERROR.                 @Y30LB33*/ 01253000
*   /*                                                               */ 01254000
*   /*****************************************************************/ 01255000
*                                                                  0534 01256000
*GRPSEQ:                                                           0534 01257000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 01258000
GRPSEQ   ST    @14,@SA00004                                        0534 01259000
*   OLDERID2=NEWERID2;                                             0535 01260000
         L     @03,@PC00001                                        0535 01261000
         L     @03,GDTTR2(,@03)                                    0535 01262000
         MVC   @TS00001(95),NEWERID2(@03)                          0535 01263000
         MVC   OLDERID2(95,@03),@TS00001                           0535 01264000
*   NEWID2='LVDA';                  /*                       @Y30LB33*/ 01265000
         MVC   NEWID2(4,@03),@CC02461                              0536 01266000
*   TESTRC=0;                       /*                       @Y30LB33*/ 01267000
*                                                                  0537 01268000
         SLR   TESTRC,TESTRC                                       0537 01269000
*   /*****************************************************************/ 01270000
*   /*                                                               */ 01271000
*   /* ESTABLISH THE SUBTITLE LINES IF NO VOLUME LIST        @Y30LB33*/ 01272000
*   /* IS REQUESTED                                          @Y30LB33*/ 01273000
*   /*                                                               */ 01274000
*   /*****************************************************************/ 01275000
*                                                                  0538 01276000
*   IF ADDR(VOLST)=0 THEN                                          0538 01277000
         SLR   @03,@03                                             0538 01278000
         L     @15,@PC00001+4                                      0538 01279000
         C     @03,FDTPTR+24(,@15)                                 0538 01280000
         BNE   @RF00538                                            0538 01281000
*     DO;                           /*                       @Y30LB33*/ 01282000
*                                                                  0539 01283000
*       /*************************************************************/ 01284000
*       /*                                                           */ 01285000
*       /* READ IN THE SUBTITLES USING UPRINT                @Y30LB33*/ 01286000
*       /*                                                           */ 01287000
*       /*************************************************************/ 01288000
*                                                                  0540 01289000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01290000
         L     @14,DDSTRU                                          0540 01291000
         XC    DARGLIST(20,@14),DARGLIST(@14)                      0540 01292000
*       DARGRETP=ADDR(TITLSPCE);    /*                       @Y30LB33*/ 01293000
         LA    @05,TITLSPCE                                        0541 01294000
         ST    @05,DARGRETP(,@14)                                  0541 01295000
*       DARGRETL=LENGTH(TITLSPCE);  /*                       @Y30LB33*/ 01296000
         MVC   DARGRETL(2,@14),@CH02376                            0542 01297000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 01298000
         MVC   DARGSMOD(3,@14),@CC02396                            0543 01299000
*       IF ADDR(STAT)>0 THEN                                       0544 01300000
         C     @03,FDTPTR+52(,@15)                                 0544 01301000
         BNL   @RF00544                                            0544 01302000
*         DARGSENT=GRPSTLE;         /*                       @Y30LB33*/ 01303000
         MVI   DARGSENT(@14),X'19'                                 0545 01304000
*       ELSE                                                       0546 01305000
*         DARGSENT=GRPUTLE;         /*                       @Y30LB33*/ 01306000
         B     @RC00544                                            0546 01307000
@RF00544 L     @03,DDSTRU                                          0546 01308000
         MVI   DARGSENT(@03),X'17'                                 0546 01309000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01310000
*                                                                  0547 01311000
@RC00544 L     @03,@PC00001                                        0547 01312000
         ST    @03,@AL00001                                        0547 01313000
         LA    @15,@CF00117                                        0547 01314000
         ST    @15,@AL00001+4                                      0547 01315000
         LA    @15,DDSTRU                                          0547 01316000
         ST    @15,@AL00001+8                                      0547 01317000
         MVI   @AL00001+8,X'80'                                    0547 01318000
         L     @15,GDTPRT(,@03)                                    0547 01319000
         LA    @01,@AL00001                                        0547 01320000
         BALR  @14,@15                                             0547 01321000
*       /*************************************************************/ 01322000
*       /*                                                           */ 01323000
*       /* RESET THE MAIN TITLE LINE ESTABLISHED             @Y30LB33*/ 01324000
*       /* BEFORE                                            @Y30LB33*/ 01325000
*       /*                                                           */ 01326000
*       /*************************************************************/ 01327000
*                                                                  0548 01328000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB33*/ 01329000
*                                                                  0548 01330000
         L     @03,@PC00001                                        0548 01331000
         ST    @03,@AL00001                                        0548 01332000
         LA    @15,PRINTME                                         0548 01333000
         ST    @15,@AL00001+4                                      0548 01334000
         MVI   @AL00001+4,X'80'                                    0548 01335000
         L     @15,GDTRES(,@03)                                    0548 01336000
         LA    @01,@AL00001                                        0548 01337000
         BALR  @14,@15                                             0548 01338000
*       /*************************************************************/ 01339000
*       /*                                                           */ 01340000
*       /* SET UP THE ESTABLISH ARGUMENT LIST AND            #Y30LB33*/ 01341000
*       /* ISSUE THE ESTABLISH MACRO                         #Y30LB33*/ 01342000
*       /*                                                           */ 01343000
*       /*************************************************************/ 01344000
*                                                                  0549 01345000
*       PCSTLP=ADDR(TITLSPCE);      /*                       #Y30LB33*/ 01346000
         LA    @03,TITLSPCE                                        0549 01347000
         ST    @03,PCSTLP                                          0549 01348000
*       PCSTLC=3;                   /*                       #Y30LB33*/ 01349000
         MVC   PCSTLC(2),@CH00165                                  0550 01350000
*       CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*               #Y30LB33*/ 01351000
         L     @03,@PC00001                                        0551 01352000
         ST    @03,@AL00001                                        0551 01353000
         LA    @15,PRINTME                                         0551 01354000
         ST    @15,@AL00001+4                                      0551 01355000
         LA    @15,PCARG                                           0551 01356000
         ST    @15,@AL00001+8                                      0551 01357000
         L     @15,GDTESA(,@03)                                    0551 01358000
         LA    @01,@AL00001                                        0551 01359000
         BALR  @14,@15                                             0551 01360000
*     END;                          /*                       @Y30LB33*/ 01361000
*                                                                  0553 01362000
*   /*****************************************************************/ 01363000
*   /*                                                               */ 01364000
*   /* SET UP REQUEST BLOCK TO READ GROUPS                   @Y30LB33*/ 01365000
*   /*                                                               */ 01366000
*   /*****************************************************************/ 01367000
*                                                                  0553 01368000
*   GRPRVVI=GRPRVVI&&GRPRVVI;       /* NULL ARG LIST         @Y30LB33*/ 01369000
@RF00538 XC    GRPRVVI(68),GRPRVVI                                 0553 01370000
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Y30LB33*/ 01371000
         LA    RVVIPTR,GRPRVVI                                     0554 01372000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 01373000
         LH    @04,RVVLEN                                          0555 01374000
         ST    @04,RVVLNGTH(,RVVIPTR)                              0555 01375000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 01376000
         MVI   RVVCODE(RVVIPTR),X'87'                              0556 01377000
*   RVVRDR=ON;                      /*                       @Y30LB33*/ 01378000
         OI    RVVRDR(RVVIPTR),B'10000000'                         0557 01379000
*   RVVGRPRC=ON;                    /*                       @Y30LB33*/ 01380000
         OI    RVVGRPRC(RVVIPTR),B'01000000'                       0558 01381000
*   RVVSGRP=ON;                     /*                       @Y30LB33*/ 01382000
         OI    RVVSGRP(RVVIPTR),B'10000000'                        0559 01383000
*   RVVBUFLN=LENGTH(GROUP);         /*                       @Y30LB33*/ 01384000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02619                        0560 01385000
*   RVVRTBUF=ADDR(GRPRCDBF);        /*                       @Y30LB33*/ 01386000
*                                                                  0561 01387000
         LA    @04,GRPRCDBF                                        0561 01388000
         ST    @04,RVVRTBUF(,RVVIPTR)                              0561 01389000
*   /*****************************************************************/ 01390000
*   /*                                                               */ 01391000
*   /* PASS THE REQUEST BLOCK TO THE GROUP READER,           @Y30LB33*/ 01392000
*   /* AND THE RECORD TO THE GROUP PRINTER AND CHAIN         @Y30LB33*/ 01393000
*   /* SELECTER FOR EVERY GROUP IN THE GROUP PARAMETER       @Y30LB33*/ 01394000
*   /* LIST. IF THE RETURN CODE FROM THE PROCESS IS 16,      @Y30LB33*/ 01395000
*   /* END PROCESSING.                                       @Y30LB33*/ 01396000
*   /*                                                               */ 01397000
*   /*****************************************************************/ 01398000
*                                                                  0562 01399000
*   DO RPTLOOP=1 BY 1 TO GRPCNT     /*                       @Y30LB33*/ 01400000
*         WHILE(TESTRC^=16);        /*                       @Y30LB33*/ 01401000
         LA    @04,1                                               0562 01402000
         STH   @04,RPTLOOP                                         0562 01403000
         B     @DE00562                                            0562 01404000
@DL00562 C     TESTRC,@CF00507                                     0562 01405000
         BE    @DC00562                                            0562 01406000
*     RVVGROUP=GRPVAL(RPTLOOP);     /*                       @Y30LB33*/ 01407000
         MH    @04,@CH00037                                        0563 01408000
         L     @06,@PC00001+4                                      0563 01409000
         L     @06,FDTPTR+8(,@06)                                  0563 01410000
         ALR   @06,@04                                             0563 01411000
         AL    @06,@CF02639                                        0563 01412000
         MVC   RVVGROUP(8,RVVIPTR),GRPVAL-3(@06)                   0563 01413000
*     CALL GRPRDR;                  /*                       @Y30LB33*/ 01414000
         BAL   @14,GRPRDR                                          0564 01415000
*     RESPECIFY                                                    0565 01416000
*       RTNREG RSTD;                                               0565 01417000
*     TESTRC=RTNREG;                                               0566 01418000
         LR    TESTRC,RTNREG                                       0566 01419000
*     RESPECIFY                                                    0567 01420000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 01421000
*                                                                  0568 01422000
*     /***************************************************************/ 01423000
*     /*                                                             */ 01424000
*     /* IF THE RETURN CODE IS OK, CALL THE                  @Y30LB33*/ 01425000
*     /* GROUP PRINTER TO PRINT THE GROUP RECORD             @Y30LB33*/ 01426000
*     /*                                                             */ 01427000
*     /***************************************************************/ 01428000
*                                                                  0568 01429000
*     IF TESTRC=0 THEN                                             0568 01430000
         LTR   TESTRC,TESTRC                                       0568 01431000
         BNZ   @RF00568                                            0568 01432000
*       CALL GRPPRNT;               /*                       @Y30LB33*/ 01433000
*                                                                  0569 01434000
         BAL   @14,GRPPRNT                                         0569 01435000
*     /***************************************************************/ 01436000
*     /*                                                             */ 01437000
*     /* IF THE RETURN CODE IS OK, AND A VOLUME              @Y30LB33*/ 01438000
*     /* LIST IS REQUESTED, CALL THE CHAIN SELECTER          @Y30LB33*/ 01439000
*     /* TO PRINT THE VOLUMES                                @Y30LB33*/ 01440000
*     /*                                                             */ 01441000
*     /***************************************************************/ 01442000
*                                                                  0570 01443000
*     IF ADDR(VOLST)>0&TESTRC=0 THEN/*                       @Y30LB33*/ 01444000
@RF00568 SLR   @03,@03                                             0570 01445000
         L     @15,@PC00001+4                                      0570 01446000
         C     @03,FDTPTR+24(,@15)                                 0570 01447000
         BNL   @RF00570                                            0570 01448000
         CR    TESTRC,@03                                          0570 01449000
         BNE   @RF00570                                            0570 01450000
*       CALL CHNSEL;                /*                       @Y30LB33*/ 01451000
         BAL   @14,CHNSEL                                          0571 01452000
*     RVVIPTR=ADDR(GRPRVVI);        /*                       @Y30LB33*/ 01453000
@RF00570 LA    RVVIPTR,GRPRVVI                                     0572 01454000
*   END;                            /*                       @Y30LB33*/ 01455000
         LA    @04,1                                               0573 01456000
         AH    @04,RPTLOOP                                         0573 01457000
         STH   @04,RPTLOOP                                         0573 01458000
@DE00562 L     @03,@PC00001+4                                      0573 01459000
         L     @03,FDTPTR+8(,@03)                                  0573 01460000
         CH    @04,GRPCNT(,@03)                                    0573 01461000
         BNH   @DL00562                                            0573 01462000
@DC00562 DS    0H                                                  0574 01463000
*   MYCODE=TESTRC;                  /* SAVE RETURN CODE      @Y30LB33*/ 01464000
         LR    MYCODE,TESTRC                                       0574 01465000
*                                                                  0575 01466000
*   /*****************************************************************/ 01467000
*   /*                                                               */ 01468000
*   /* PASS THE SUMMARY REQUEST INDICATOR TO SUMRY TO        @Y30LB33*/ 01469000
*   /* PRINT A GROUP TOTAL                                   @Y30LB33*/ 01470000
*   /*                                                               */ 01471000
*   /*****************************************************************/ 01472000
*                                                                  0575 01473000
*   SUMMASK=GRPSUMM;                /*                       @Y30LB33*/ 01474000
         LA    SUMMASK,1                                           0575 01475000
*   CALL SUMRY;                     /*                       @Y30LB33*/ 01476000
*                                                                  0576 01477000
         BAL   @14,SUMRY                                           0576 01478000
*   /*****************************************************************/ 01479000
*   /*                                                               */ 01480000
*   /* RETURN WITH A CODE OF ZERO OR 16, AS WAS              @Y30LB33*/ 01481000
*   /* RETURNED TO THIS ROUTINE FROM CALLED PROCEDURES       @Y30LB33*/ 01482000
*   /*                                                               */ 01483000
*   /*****************************************************************/ 01484000
*                                                                  0577 01485000
*   IF MYCODE^=16 THEN                                             0577 01486000
         C     MYCODE,@CF00507                                     0577 01487000
         BE    @RF00577                                            0577 01488000
*     MYCODE=0;                     /*                       @Y30LB33*/ 01489000
         SLR   MYCODE,MYCODE                                       0578 01490000
*   RETURN CODE(MYCODE);            /*                       @Y30LB33*/ 01491000
@RF00577 LR    @15,MYCODE                                          0579 01492000
@EL00004 DS    0H                                                  0579 01493000
@EF00004 DS    0H                                                  0579 01494000
@ER00004 L     @14,@SA00004                                        0579 01495000
         BR    @14                                                 0579 01496000
*   END GRPSEQ;                     /*                       @Y30LB33*/ 01497000
*                                                                  0581 01498000
*   /*****************************************************************/ 01499000
*   /*                                                               */ 01500000
*   /* PROCEDURE NAME - ALLGSEQ                              @Y30LB33*/ 01501000
*   /*                                                       @Y30LB33*/ 01502000
*   /* FUNCTION - PROCESS ALLGROUP REQUESTS                  @Y30LB33*/ 01503000
*   /*                                                       @Y30LB33*/ 01504000
*   /* INPUT - FDTTBL                                        @Y30LB33*/ 01505000
*   /*                                                       @Y30LB33*/ 01506000
*   /* OUTPUT - RETURN CODE AND LASTCOND OF ZERO TO          @Y30LB33*/ 01507000
*   /* INDICATE NO ERRORS. RETURN CODE OF ZERO AND           @Y30LB33*/ 01508000
*   /* LASTCOND OF 8 TO INDICATE PARTIAL                     @Y30LB33*/ 01509000
*   /* COMPLETION. RETURN CODE OF 16 AND LASTCOND            @Y30LB33*/ 01510000
*   /* OF 8 IF TERMINATING ERROR.                            @Y30LB33*/ 01511000
*   /*                                                               */ 01512000
*   /*****************************************************************/ 01513000
*                                                                  0581 01514000
*ALLGSEQ:                                                          0581 01515000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 01516000
ALLGSEQ  ST    @14,@SA00005                                        0581 01517000
*   OLDERID2=NEWERID2;                                             0582 01518000
         L     @03,@PC00001                                        0582 01519000
         L     @03,GDTTR2(,@03)                                    0582 01520000
         MVC   @TS00001(95),NEWERID2(@03)                          0582 01521000
         MVC   OLDERID2(95,@03),@TS00001                           0582 01522000
*   NEWID2='LVEA';                  /*                       @Y30LB33*/ 01523000
         MVC   NEWID2(4,@03),@CC02468                              0583 01524000
*   TESTRC=0;                       /*                       @Y30LB33*/ 01525000
*                                                                  0584 01526000
         SLR   TESTRC,TESTRC                                       0584 01527000
*   /*****************************************************************/ 01528000
*   /*                                                               */ 01529000
*   /* ESTABLISH SUBTITLE LINES IF THE VLIST PARAMETER       @Y30LB33*/ 01530000
*   /* IS NOT DEFINED. USE THE SUBTITLE REQUIRED             @Y30LB33*/ 01531000
*   /* BY THE REPORT PARAMETER                               @Y30LB33*/ 01532000
*   /*                                                               */ 01533000
*   /*****************************************************************/ 01534000
*                                                                  0585 01535000
*   IF ADDR(VOLST)=0 THEN                                          0585 01536000
         SLR   @03,@03                                             0585 01537000
         L     @15,@PC00001+4                                      0585 01538000
         C     @03,FDTPTR+24(,@15)                                 0585 01539000
         BNE   @RF00585                                            0585 01540000
*     DO;                           /*                       @Y30LB33*/ 01541000
*                                                                  0586 01542000
*       /*************************************************************/ 01543000
*       /*                                                           */ 01544000
*       /* READ IN THE SUBTITLE USING UPRINT                 @Y30LB33*/ 01545000
*       /*                                                           */ 01546000
*       /*************************************************************/ 01547000
*                                                                  0587 01548000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01549000
         L     @14,DDSTRU                                          0587 01550000
         XC    DARGLIST(20,@14),DARGLIST(@14)                      0587 01551000
*       DARGRETP=ADDR(TITLSPCE);    /*                       @Y30LB33*/ 01552000
         LA    @05,TITLSPCE                                        0588 01553000
         ST    @05,DARGRETP(,@14)                                  0588 01554000
*       DARGRETL=LENGTH(TITLSPCE);  /*                       @Y30LB33*/ 01555000
         MVC   DARGRETL(2,@14),@CH02376                            0589 01556000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 01557000
         MVC   DARGSMOD(3,@14),@CC02396                            0590 01558000
*       IF ADDR(STAT)>0 THEN                                       0591 01559000
         C     @03,FDTPTR+52(,@15)                                 0591 01560000
         BNL   @RF00591                                            0591 01561000
*         DARGSENT=GRPSTLE;         /*                       @Y30LB33*/ 01562000
         MVI   DARGSENT(@14),X'19'                                 0592 01563000
*       ELSE                                                       0593 01564000
*         DARGSENT=GRPUTLE;         /*                       @Y30LB33*/ 01565000
         B     @RC00591                                            0593 01566000
@RF00591 L     @03,DDSTRU                                          0593 01567000
         MVI   DARGSENT(@03),X'17'                                 0593 01568000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01569000
*                                                                  0594 01570000
@RC00591 L     @03,@PC00001                                        0594 01571000
         ST    @03,@AL00001                                        0594 01572000
         LA    @15,@CF00117                                        0594 01573000
         ST    @15,@AL00001+4                                      0594 01574000
         LA    @15,DDSTRU                                          0594 01575000
         ST    @15,@AL00001+8                                      0594 01576000
         MVI   @AL00001+8,X'80'                                    0594 01577000
         L     @15,GDTPRT(,@03)                                    0594 01578000
         LA    @01,@AL00001                                        0594 01579000
         BALR  @14,@15                                             0594 01580000
*       /*************************************************************/ 01581000
*       /*                                                           */ 01582000
*       /* RESET THE MAIN TITLE LINE ESTABLISHED             @Y30LB33*/ 01583000
*       /* BEFORE                                            @Y30LB33*/ 01584000
*       /*                                                           */ 01585000
*       /*************************************************************/ 01586000
*                                                                  0595 01587000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB33*/ 01588000
*                                                                  0595 01589000
         L     @03,@PC00001                                        0595 01590000
         ST    @03,@AL00001                                        0595 01591000
         LA    @15,PRINTME                                         0595 01592000
         ST    @15,@AL00001+4                                      0595 01593000
         MVI   @AL00001+4,X'80'                                    0595 01594000
         L     @15,GDTRES(,@03)                                    0595 01595000
         LA    @01,@AL00001                                        0595 01596000
         BALR  @14,@15                                             0595 01597000
*       /*************************************************************/ 01598000
*       /*                                                           */ 01599000
*       /* ESTABLISH THE SUBTITLES USING UESTA               @Y30LB33*/ 01600000
*       /*                                                           */ 01601000
*       /*************************************************************/ 01602000
*                                                                  0596 01603000
*       PCSTLP=ADDR(TITLSPCE);      /*                       @Y30LB33*/ 01604000
         LA    @03,TITLSPCE                                        0596 01605000
         ST    @03,PCSTLP                                          0596 01606000
*       PCSTLC=3;                   /*                       @Y30LB33*/ 01607000
         MVC   PCSTLC(2),@CH00165                                  0597 01608000
*       CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*               @Y30LB33*/ 01609000
         L     @03,@PC00001                                        0598 01610000
         ST    @03,@AL00001                                        0598 01611000
         LA    @15,PRINTME                                         0598 01612000
         ST    @15,@AL00001+4                                      0598 01613000
         LA    @15,PCARG                                           0598 01614000
         ST    @15,@AL00001+8                                      0598 01615000
         L     @15,GDTESA(,@03)                                    0598 01616000
         LA    @01,@AL00001                                        0598 01617000
         BALR  @14,@15                                             0598 01618000
*     END;                          /*                       @Y30LB33*/ 01619000
*                                                                  0600 01620000
*   /*****************************************************************/ 01621000
*   /*                                                               */ 01622000
*   /* SET UP READ REQUEST BLOCK TO READ GROUPS              @Y30LB33*/ 01623000
*   /*                                                               */ 01624000
*   /*****************************************************************/ 01625000
*                                                                  0600 01626000
*   GRPRVVI=GRPRVVI&&GRPRVVI;       /*                       @Y30LB33*/ 01627000
@RF00585 XC    GRPRVVI(68),GRPRVVI                                 0600 01628000
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Y30LB33*/ 01629000
         LA    RVVIPTR,GRPRVVI                                     0601 01630000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 01631000
         LH    @04,RVVLEN                                          0602 01632000
         ST    @04,RVVLNGTH(,RVVIPTR)                              0602 01633000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 01634000
         MVI   RVVCODE(RVVIPTR),X'87'                              0603 01635000
*   RVVRDNR=ON;                     /*                       @Y30LB33*/ 01636000
         OI    RVVRDNR(RVVIPTR),B'01000000'                        0604 01637000
*   RVVGRPRC=ON;                    /*                       @Y30LB33*/ 01638000
         OI    RVVGRPRC(RVVIPTR),B'01000000'                       0605 01639000
*   RVVBUFLN=LENGTH(GROUP);         /*                       @Y30LB33*/ 01640000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02619                        0606 01641000
*   RVVRTBUF=ADDR(GRPRCDBF);        /*                       @Y30LB33*/ 01642000
         LA    @04,GRPRCDBF                                        0607 01643000
         ST    @04,RVVRTBUF(,RVVIPTR)                              0607 01644000
*                                                                  0608 01645000
*   /*****************************************************************/ 01646000
*   /*                                                               */ 01647000
*   /* PASS THE REQUEST BLOCK TO THE GROUP READER,           @Y30LB33*/ 01648000
*   /* AND THE GROUP RECORD TO THE GROUP PRINTER AND         @Y30LB33*/ 01649000
*   /* CHAIN SELECTER FOR EVERY GROUP FOUND. IF THE          @Y30LB33*/ 01650000
*   /* RETURN CODE FROM THE PROCESS IS NOT ZERO, END         @Y30LB33*/ 01651000
*   /* PROCESSING.                                           @Y30LB33*/ 01652000
*   /*                                                               */ 01653000
*   /*****************************************************************/ 01654000
*                                                                  0608 01655000
*   DO WHILE(TESTRC=0);             /*                       @Y30LB33*/ 01656000
         B     @DE00608                                            0608 01657000
@DL00608 DS    0H                                                  0609 01658000
*     CALL GRPRDR;                  /*                       @Y30LB33*/ 01659000
         BAL   @14,GRPRDR                                          0609 01660000
*     RESPECIFY                                                    0610 01661000
*       RTNREG RSTD;                                               0610 01662000
*     TESTRC=RTNREG;                                               0611 01663000
         LR    TESTRC,RTNREG                                       0611 01664000
*     RESPECIFY                                                    0612 01665000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 01666000
*                                                                  0612 01667000
*     /***************************************************************/ 01668000
*     /*                                                             */ 01669000
*     /* IF NO ERRORS, PRINT THE GROUP                       @Y30LB33*/ 01670000
*     /*                                                             */ 01671000
*     /***************************************************************/ 01672000
*                                                                  0613 01673000
*     IF TESTRC=0 THEN                                             0613 01674000
         LTR   TESTRC,TESTRC                                       0613 01675000
         BNZ   @RF00613                                            0613 01676000
*       CALL GRPPRNT;               /*                       @Y30LB33*/ 01677000
*                                                                  0614 01678000
         BAL   @14,GRPPRNT                                         0614 01679000
*     /***************************************************************/ 01680000
*     /*                                                             */ 01681000
*     /* IF NO ERRORS AND VLIST REQUESTED, PRINT             @Y30LB33*/ 01682000
*     /* THE CHAIN AND GET THE NEXT GROUP NAME               @Y30LB33*/ 01683000
*     /* FROM THE GROUP RECORD                               @Y30LB33*/ 01684000
*     /*                                                             */ 01685000
*     /***************************************************************/ 01686000
*                                                                  0615 01687000
*     IF TESTRC=0&ADDR(VOLST)>0     /*                       @Y30LB33*/ 01688000
*       THEN                                                       0615 01689000
@RF00613 SLR   @03,@03                                             0615 01690000
         CR    TESTRC,@03                                          0615 01691000
         BNE   @RF00615                                            0615 01692000
         L     @15,@PC00001+4                                      0615 01693000
         C     @03,FDTPTR+24(,@15)                                 0615 01694000
         BNL   @RF00615                                            0615 01695000
*       CALL CHNSEL;                /*                       @Y30LB33*/ 01696000
         BAL   @14,CHNSEL                                          0616 01697000
*     RVVIPTR=ADDR(GRPRVVI);        /*                       @Y30LB33*/ 01698000
@RF00615 LA    RVVIPTR,GRPRVVI                                     0617 01699000
*     RVVSGRP=ON;                   /*                       @Y30LB33*/ 01700000
         OI    RVVSGRP(RVVIPTR),B'10000000'                        0618 01701000
*     RVVGROUP=GROVVGRP;            /*                       @Y30LB33*/ 01702000
         MVC   RVVGROUP(8,RVVIPTR),GROVVGRP(GROUPPTR)              0619 01703000
*   END;                            /*                       @Y30LB33*/ 01704000
@DE00608 LTR   TESTRC,TESTRC                                       0620 01705000
         BZ    @DL00608                                            0620 01706000
*   MYCODE=TESTRC;                  /* SAVE RETURN CODE      @Y30LB33*/ 01707000
         LR    MYCODE,TESTRC                                       0621 01708000
*                                                                  0622 01709000
*   /*****************************************************************/ 01710000
*   /*                                                               */ 01711000
*   /* PASS THE SUMMARY REQUEST INDICATOR TO SUMRY           @Y30LB33*/ 01712000
*   /* TO PRINT A GROUP TOTAL                                @Y30LB33*/ 01713000
*   /*                                                               */ 01714000
*   /*****************************************************************/ 01715000
*                                                                  0622 01716000
*   SUMMASK=GRPSUMM;                /*                       @Y30LB33*/ 01717000
         LA    SUMMASK,1                                           0622 01718000
*   CALL SUMRY;                     /*                       @Y30LB33*/ 01719000
*                                                                  0623 01720000
         BAL   @14,SUMRY                                           0623 01721000
*   /*****************************************************************/ 01722000
*   /*                                                               */ 01723000
*   /* RETURN WITH ZERO, FOR NO ERRORS, OR 16                @Y30LB33*/ 01724000
*   /* FOR TERMINATING ERROR                                 @Y30LB33*/ 01725000
*   /*                                                               */ 01726000
*   /*****************************************************************/ 01727000
*                                                                  0624 01728000
*   IF MYCODE<16 THEN                                              0624 01729000
         C     MYCODE,@CF00507                                     0624 01730000
         BNL   @RF00624                                            0624 01731000
*     MYCODE=0;                     /*                       @Y30LB33*/ 01732000
         SLR   MYCODE,MYCODE                                       0625 01733000
*   RETURN CODE(MYCODE);            /*                       @Y30LB33*/ 01734000
@RF00624 LR    @15,MYCODE                                          0626 01735000
@EL00005 DS    0H                                                  0626 01736000
@EF00005 DS    0H                                                  0626 01737000
@ER00005 L     @14,@SA00005                                        0626 01738000
         BR    @14                                                 0626 01739000
*   END ALLGSEQ;                    /*                       @Y30LB33*/ 01740000
*                                                                  0628 01741000
*   /*****************************************************************/ 01742000
*   /*                                                               */ 01743000
*   /* PROCEDURE NAME - ALLVSEQ                              @Y30LB33*/ 01744000
*   /*                                                       @Y30LB33*/ 01745000
*   /* FUNCTION - TO PROCESS ALLVOLUME REQUESTS,             @Y30LB33*/ 01746000
*   /* ESTABLISH THE SUBTITLES FOR THE REPORT,               @Y30LB33*/ 01747000
*   /* AND CONTROL THE PRINTING OF THE SUMMARY.              @Y30LB33*/ 01748000
*   /*                                                       @Y30LB33*/ 01749000
*   /* INPUT - FDTTBL                                        @Y30LB33*/ 01750000
*   /*                                                       @Y30LB33*/ 01751000
*   /* OUTPUT - RETURN CODE AND LASTCOND OF ZERO IF          @Y30LB33*/ 01752000
*   /* PROCESSING COMPLETED WITH NO ERRORS.                  @Y30LB33*/ 01753000
*   /* RETURN CODE OF ZERO AND LASTCOND OF 8 IF              @Y30LB33*/ 01754000
*   /* PROCESSING COMPLETED WITH ERRORS. RETURN              @Y30LB33*/ 01755000
*   /* CODE OF 16 AND LASTCOND OF 8 FOR PROCESSING           @Y30LB33*/ 01756000
*   /* TERMINATION                                           @Y30LB33*/ 01757000
*   /*                                                               */ 01758000
*   /*****************************************************************/ 01759000
*                                                                  0628 01760000
*ALLVSEQ:                                                          0628 01761000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 01762000
ALLVSEQ  ST    @14,@SA00006                                        0628 01763000
*   OLDERID2=NEWERID2;                                             0629 01764000
         L     @03,@PC00001                                        0629 01765000
         L     @03,GDTTR2(,@03)                                    0629 01766000
         MVC   @TS00001(95),NEWERID2(@03)                          0629 01767000
         MVC   OLDERID2(95,@03),@TS00001                           0629 01768000
*   NEWID2='LVFA';                  /*                       @Y30LB33*/ 01769000
         MVC   NEWID2(4,@03),@CC02472                              0630 01770000
*   TESTRC=0;                       /*                       @Y30LB33*/ 01771000
*                                                                  0631 01772000
         SLR   TESTRC,TESTRC                                       0631 01773000
*   /*****************************************************************/ 01774000
*   /*                                                               */ 01775000
*   /* ESTABLISH THE REPORT SUBTITLE LINES                   @Y30LB33*/ 01776000
*   /* FIRST READ IN THE SUBTITLES USING UPRINT              @Y30LB33*/ 01777000
*   /*                                                               */ 01778000
*   /*****************************************************************/ 01779000
*                                                                  0632 01780000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 01781000
         L     @03,DDSTRU                                          0632 01782000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      0632 01783000
*   DARGRETP=ADDR(TITLSPCE);        /*                       @Y30LB33*/ 01784000
         LA    @15,TITLSPCE                                        0633 01785000
         ST    @15,DARGRETP(,@03)                                  0633 01786000
*   DARGRETL=LENGTH(TITLSPCE);      /*                       @Y30LB33*/ 01787000
         MVC   DARGRETL(2,@03),@CH02376                            0634 01788000
*   DARGSMOD=MODLV0;                /*                       @Y30LB33*/ 01789000
         MVC   DARGSMOD(3,@03),@CC02396                            0635 01790000
*   IF ADDR(STAT)>0 THEN                                           0636 01791000
         L     @15,@PC00001+4                                      0636 01792000
         L     @15,FDTPTR+52(,@15)                                 0636 01793000
         LTR   @15,@15                                             0636 01794000
         BNP   @RF00636                                            0636 01795000
*     DARGSENT=VOLSTLE;             /*                       @Y30LB33*/ 01796000
         MVI   DARGSENT(@03),X'1B'                                 0637 01797000
*   ELSE                                                           0638 01798000
*     DARGSENT=VOLUTLE;             /*                       @Y30LB33*/ 01799000
         B     @RC00636                                            0638 01800000
@RF00636 L     @03,DDSTRU                                          0638 01801000
         MVI   DARGSENT(@03),X'12'                                 0638 01802000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/ 01803000
*                                                                  0639 01804000
@RC00636 L     @03,@PC00001                                        0639 01805000
         ST    @03,@AL00001                                        0639 01806000
         LA    @15,@CF00117                                        0639 01807000
         ST    @15,@AL00001+4                                      0639 01808000
         LA    @15,DDSTRU                                          0639 01809000
         ST    @15,@AL00001+8                                      0639 01810000
         MVI   @AL00001+8,X'80'                                    0639 01811000
         L     @15,GDTPRT(,@03)                                    0639 01812000
         LA    @01,@AL00001                                        0639 01813000
         BALR  @14,@15                                             0639 01814000
*   /*****************************************************************/ 01815000
*   /*                                                               */ 01816000
*   /* RESET THE MAIN TITLE LINE ESTABLISHED BEFORE          @Y30LB33*/ 01817000
*   /*                                                               */ 01818000
*   /*****************************************************************/ 01819000
*                                                                  0640 01820000
*   CALL AMSTP044(GDTTBL,PRINTME);  /*                       @Y30LB33*/ 01821000
*                                                                  0640 01822000
         L     @03,@PC00001                                        0640 01823000
         ST    @03,@AL00001                                        0640 01824000
         LA    @15,PRINTME                                         0640 01825000
         ST    @15,@AL00001+4                                      0640 01826000
         MVI   @AL00001+4,X'80'                                    0640 01827000
         L     @15,GDTRES(,@03)                                    0640 01828000
         LA    @01,@AL00001                                        0640 01829000
         BALR  @14,@15                                             0640 01830000
*   /*****************************************************************/ 01831000
*   /*                                                               */ 01832000
*   /* THEN ESTABLISH THE SUBTITLES USING UESTA              @Y30LB33*/ 01833000
*   /*                                                               */ 01834000
*   /*****************************************************************/ 01835000
*                                                                  0641 01836000
*   PCSTLP=ADDR(TITLSPCE);          /*                       @Y30LB33*/ 01837000
         LA    @03,TITLSPCE                                        0641 01838000
         ST    @03,PCSTLP                                          0641 01839000
*   IF ADDR(STAT)>0 THEN                                           0642 01840000
         L     @03,@PC00001+4                                      0642 01841000
         L     @03,FDTPTR+52(,@03)                                 0642 01842000
         LTR   @03,@03                                             0642 01843000
         BNP   @RF00642                                            0642 01844000
*     PCSTLC=2;                     /*                       @Y30LB33*/ 01845000
         MVC   PCSTLC(2),@CH00156                                  0643 01846000
*   ELSE                                                           0644 01847000
*     PCSTLC=3;                     /*                       @Y30LB33*/ 01848000
         B     @RC00642                                            0644 01849000
@RF00642 MVC   PCSTLC(2),@CH00165                                  0644 01850000
*   CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*                   @Y30LB33*/ 01851000
@RC00642 L     @04,@PC00001                                        0645 01852000
         ST    @04,@AL00001                                        0645 01853000
         LA    @03,PRINTME                                         0645 01854000
         ST    @03,@AL00001+4                                      0645 01855000
         LA    @03,PCARG                                           0645 01856000
         ST    @03,@AL00001+8                                      0645 01857000
         L     @15,GDTESA(,@04)                                    0645 01858000
         LA    @01,@AL00001                                        0645 01859000
         BALR  @14,@15                                             0645 01860000
*                                                                  0646 01861000
*   /*****************************************************************/ 01862000
*   /*                                                               */ 01863000
*   /* INITIALIZE THE READ-REQUEST PARAMETER LIST            @Y30LB33*/ 01864000
*   /*                                                               */ 01865000
*   /*****************************************************************/ 01866000
*                                                                  0646 01867000
*   VOLRVVI=VOLRVVI&&VOLRVVI;       /*                       @Y30LB33*/ 01868000
         XC    VOLRVVI(68),VOLRVVI                                 0646 01869000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Y30LB33*/ 01870000
         LA    RVVIPTR,VOLRVVI                                     0647 01871000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 01872000
         LH    @04,RVVLEN                                          0648 01873000
         ST    @04,RVVLNGTH(,RVVIPTR)                              0648 01874000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 01875000
         MVI   RVVCODE(RVVIPTR),X'87'                              0649 01876000
*   RVVRDNR=ON;                     /*                       @Y30LB33*/ 01877000
         OI    RVVRDNR(RVVIPTR),B'01000000'                        0650 01878000
*   RVVBVRCD=ON;                    /*                       @Y30LB33*/ 01879000
         OI    RVVBVRCD(RVVIPTR),B'10000000'                       0651 01880000
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Y30LB33*/ 01881000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02618                        0652 01882000
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Y30LB33*/ 01883000
         LA    @04,VOLRCDBF                                        0653 01884000
         ST    @04,RVVRTBUF(,RVVIPTR)                              0653 01885000
*                                                                  0654 01886000
*   /*****************************************************************/ 01887000
*   /*                                                               */ 01888000
*   /* PRODUCE A NON-GROUPED LISTING IF                      @Y30LB33*/ 01889000
*   /* REQUESTED IN THE FDTTBL                               @Y30LB33*/ 01890000
*   /* CAN BE STATUS OR USAGE                                @ZDR2056*/ 01891000
*   /*                                                               */ 01892000
*   /*****************************************************************/ 01893000
*                                                                  0654 01894000
*   IF ADDR(NGRPD)>0 THEN                                          0654 01895000
         L     @04,@PC00001+4                                      0654 01896000
         L     @04,FDTPTR+16(,@04)                                 0654 01897000
         LTR   @04,@04                                             0654 01898000
         BNP   @RF00654                                            0654 01899000
*     DO;                           /*                       @Y30LB33*/ 01900000
*       RVVNGVOL=ON;                /*                       @Y30LB33*/ 01901000
         OI    RVVNGVOL(RVVIPTR),B'01000000'                       0656 01902000
*       RVVRDNR=OFF;                /*                       @ZM34321*/ 01903000
*       RVVRDCH=ON;                 /*                       @ZM34321*/ 01904000
         OI    RVVRDCH(RVVIPTR),B'00100000'                        0658 01905000
         NI    RVVRDNR(RVVIPTR),B'10111111'                        0658 01906000
*       CALL VOLCHNR;               /*                       @Y30LB33*/ 01907000
         BAL   @14,VOLCHNR                                         0659 01908000
*     END;                          /*                       @Y30LB33*/ 01909000
*                                                                  0661 01910000
*   /*****************************************************************/ 01911000
*   /*                                                               */ 01912000
*   /* PRODUCE AN ALL-VOLUME REPORT IF NON-GROUPED,          @ZDR2056*/ 01913000
*   /* DUPLICATES OR PLACE HOLDERS ARE NOT REQUESTED.        @ZDR2056*/ 01914000
*   /* PRODUCE A PLACE HOLDER REPORT IF ONLY PLACE           @ZDR2056*/ 01915000
*   /* HOLDERS IS REQUESTED.                                 @ZDR2056*/ 01916000
*   /*                                                               */ 01917000
*   /*****************************************************************/ 01918000
*                                                                  0661 01919000
*   IF(ADDR(NGRPD)=0&ADDR(DUP)=0&ADDR(PLHD)=0)|ADDR(PLHD)^=0 THEN  0661 01920000
@RF00654 SLR   @04,@04                                             0661 01921000
         L     @03,@PC00001+4                                      0661 01922000
         C     @04,FDTPTR+16(,@03)                                 0661 01923000
         BNE   @GL00014                                            0661 01924000
         C     @04,FDTPTR+32(,@03)                                 0661 01925000
         BNE   @GL00014                                            0661 01926000
         C     @04,FDTPTR+92(,@03)                                 0661 01927000
         BE    @RT00661                                            0661 01928000
@GL00014 L     @04,@PC00001+4                                      0661 01929000
         L     @04,FDTPTR+92(,@04)                                 0661 01930000
         LTR   @04,@04                                             0661 01931000
         BZ    @RF00661                                            0661 01932000
@RT00661 DS    0H                                                  0662 01933000
*     DO;                           /*                       @ZDR2056*/ 01934000
*                                                                  0662 01935000
*       /*************************************************************/ 01936000
*       /*                                                           */ 01937000
*       /* INDICATE VOLPROC CALLED BY THIS PROCEDURE         @ZDR2056*/ 01938000
*       /*                                                           */ 01939000
*       /*************************************************************/ 01940000
*                                                                  0663 01941000
*       ALLVCALL=ON;                /*                       @ZDR2056*/ 01942000
*                                                                  0663 01943000
         OI    ALLVCALL,B'00100000'                                0663 01944000
*       /*************************************************************/ 01945000
*       /*                                                           */ 01946000
*       /* RETURN ALL RECORDS                                @ZDR2056*/ 01947000
*       /*                                                           */ 01948000
*       /*************************************************************/ 01949000
*                                                                  0664 01950000
*       RVVALL=ON;                  /*                       @ZDR2056*/ 01951000
*                                                                  0664 01952000
         OI    RVVALL(RVVIPTR),B'00000001'                         0664 01953000
*       /*************************************************************/ 01954000
*       /*                                                           */ 01955000
*       /* CALL THE VOLUME PROCESSOR TO READ AND             @Y30LB33*/ 01956000
*       /* PRINT THE VOLUME AND ITS COPIES                   @Y30LB33*/ 01957000
*       /*                                                           */ 01958000
*       /*************************************************************/ 01959000
*                                                                  0665 01960000
*       CALL VOLPROC;               /*                       @Y30LB33*/ 01961000
         BAL   @14,VOLPROC                                         0665 01962000
*       RESPECIFY                                                  0666 01963000
*         RTNREG RSTD;                                             0666 01964000
*       TESTRC=RTNREG;                                             0667 01965000
         LR    TESTRC,RTNREG                                       0667 01966000
*       RESPECIFY                                                  0668 01967000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 01968000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 01969000
*                                                                  0669 01970000
         LA    RVVIPTR,VOLRVVI                                     0669 01971000
*       /*************************************************************/ 01972000
*       /*                                                           */ 01973000
*       /* KEEP CALLING THE VOLUME PROCESSOR                 @Y30LB33*/ 01974000
*       /* UNTIL IT GETS AN ERROR OR END-OF-FILE             @Y30LB33*/ 01975000
*       /*                                                           */ 01976000
*       /*************************************************************/ 01977000
*                                                                  0670 01978000
*       IF TESTRC=0 THEN            /*                       @Y30LB33*/ 01979000
         LTR   TESTRC,TESTRC                                       0670 01980000
         BNZ   @RF00670                                            0670 01981000
*         DO WHILE(TESTRC=0);       /*                       @Y30LB33*/ 01982000
         B     @DE00671                                            0671 01983000
@DL00671 DS    0H                                                  0672 01984000
*           RVVIPTR=ADDR(VOLRVVI);  /*                       @Y30LB33*/ 01985000
         LA    RVVIPTR,VOLRVVI                                     0672 01986000
*           RVVOLUME=BASSERNO;      /*                       @Y30LB33*/ 01987000
         MVC   RVVOLUME(6,RVVIPTR),BASSERNO(BASEVPTR)              0673 01988000
*           RVVSVOL=ON;             /*                       @Y30LB33*/ 01989000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        0674 01990000
*           CALL VOLPROC;           /*                       @Y30LB33*/ 01991000
         BAL   @14,VOLPROC                                         0675 01992000
*           RESPECIFY                                              0676 01993000
*             RTNREG RSTD;                                         0676 01994000
*           TESTRC=RTNREG;                                         0677 01995000
         LR    TESTRC,RTNREG                                       0677 01996000
*           RESPECIFY                                              0678 01997000
*             RTNREG UNRSTD;        /*                       @Y30LB33*/ 01998000
*         END;                      /*                       @Y30LB33*/ 01999000
@DE00671 LTR   TESTRC,TESTRC                                       0679 02000000
         BZ    @DL00671                                            0679 02001000
*       ALLVCALL=OFF;               /*                       @ZDR2056*/ 02002000
@RF00670 NI    ALLVCALL,B'11011111'                                0680 02003000
*       RVVALL=OFF;                 /*                       @ZDR2056*/ 02004000
         NI    RVVALL(RVVIPTR),B'11111110'                         0681 02005000
*     END;                          /*                       @Y30LB33*/ 02006000
*                                                                  0683 02007000
*   /*****************************************************************/ 02008000
*   /*                                                               */ 02009000
*   /* PRODUCE A DUPLICATE VOLUME REPORT IF NON-             @Y30LB33*/ 02010000
*   /* GROUPED OR PLACE HOLDER IS NOT DEFINED AND WE ARE DOING A     */ 02011000
*   /* STATUS REPORT AND NO ERRORS SO FAR                    @ZDR2056*/ 02012000
*   /*                                                               */ 02013000
*   /*****************************************************************/ 02014000
*                                                                  0683 02015000
*   IF(ADDR(NGRPD)=0&ADDR(PLHD)=0)&TESTRC^=16/*              @ZDR2056*/ 02016000
*       &ADDR(STAT)>0 THEN                                         0683 02017000
@RF00661 SLR   @03,@03                                             0683 02018000
         L     @15,@PC00001+4                                      0683 02019000
         C     @03,FDTPTR+16(,@15)                                 0683 02020000
         BNE   @RF00683                                            0683 02021000
         C     @03,FDTPTR+92(,@15)                                 0683 02022000
         BNE   @RF00683                                            0683 02023000
         C     TESTRC,@CF00507                                     0683 02024000
         BE    @RF00683                                            0683 02025000
         C     @03,FDTPTR+52(,@15)                                 0683 02026000
         BNL   @RF00683                                            0683 02027000
*     DO;                           /*                       @Y30LB33*/ 02028000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 02029000
         LA    RVVIPTR,VOLRVVI                                     0685 02030000
*       RVVBVRCD=OFF;               /*                       @Y30LB33*/ 02031000
*       RVVDUPRC=ON;                /*                       @Y30LB33*/ 02032000
         OI    RVVDUPRC(RVVIPTR),B'00010000'                       0687 02033000
         NI    RVVBVRCD(RVVIPTR),B'01111111'                       0687 02034000
*       RVVSVOL=OFF;                /*                       @Y30LB33*/ 02035000
         NI    RVVSVOL(RVVIPTR),B'11111110'                        0688 02036000
*       FRSTDUP=ON;                 /* INDICATE FIRST DUPLICATE    0689 02037000
*                                                            @ZA00676*/ 02038000
         OI    FRSTDUP,B'10000000'                                 0689 02039000
*       CALL DUPPROC;               /*                       @Y30LB33*/ 02040000
         BAL   @14,DUPPROC                                         0690 02041000
*       RESPECIFY                                                  0691 02042000
*         RTNREG RSTD;                                             0691 02043000
*       TESTRC=RTNREG;                                             0692 02044000
         LR    TESTRC,RTNREG                                       0692 02045000
*       RESPECIFY                                                  0693 02046000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02047000
*     END;                          /*                       @Y30LB33*/ 02048000
*   MYCODE=TESTRC;                  /* SAVE RETURN CODE      @Y30LB33*/ 02049000
@RF00683 LR    MYCODE,TESTRC                                       0695 02050000
*                                                                  0696 02051000
*   /*****************************************************************/ 02052000
*   /*                                                               */ 02053000
*   /* PRINT A VOLUME SUMMARY BY PASSING THE SUMMARY         @Y30LB33*/ 02054000
*   /* MASK TO THE SUMMARIZER                                @Y30LB33*/ 02055000
*   /*                                                               */ 02056000
*   /*****************************************************************/ 02057000
*                                                                  0696 02058000
*   SUMMASK=VOLSUMM;                /*                       @Y30LB33*/ 02059000
         SLR   SUMMASK,SUMMASK                                     0696 02060000
*   CALL SUMRY;                     /*                       @Y30LB33*/ 02061000
*                                                                  0697 02062000
         BAL   @14,SUMRY                                           0697 02063000
*   /*****************************************************************/ 02064000
*   /*                                                               */ 02065000
*   /* RETURN A CODE OF ZERO OR 16                           @Y30LB33*/ 02066000
*   /*                                                               */ 02067000
*   /*****************************************************************/ 02068000
*                                                                  0698 02069000
*   IF MYCODE<16 THEN                                              0698 02070000
         C     MYCODE,@CF00507                                     0698 02071000
         BNL   @RF00698                                            0698 02072000
*     MYCODE=0;                     /*                       @Y30LB33*/ 02073000
         SLR   MYCODE,MYCODE                                       0699 02074000
*   RETURN CODE(MYCODE);            /*                       @Y30LB33*/ 02075000
@RF00698 LR    @15,MYCODE                                          0700 02076000
@EL00006 DS    0H                                                  0700 02077000
@EF00006 DS    0H                                                  0700 02078000
@ER00006 L     @14,@SA00006                                        0700 02079000
         BR    @14                                                 0700 02080000
*   END ALLVSEQ;                    /*                       @Y30LB33*/ 02081000
*                                                                  0702 02082000
*   /*****************************************************************/ 02083000
*   /*                                                               */ 02084000
*   /* PROCEDURE NAME - CHNSEL                               @Y30LB33*/ 02085000
*   /*                                                       @Y30LB33*/ 02086000
*   /* FUNCTION - SELECT VOLUME TYPES FROM CHAINS IN         @Y30LB33*/ 02087000
*   /* GROUPS                                                @Y30LB33*/ 02088000
*   /*                                                       @Y30LB33*/ 02089000
*   /* INPUT - GROUP RECORD AND THE FDTTBL                   @Y30LB33*/ 02090000
*   /*                                                       @Y30LB33*/ 02091000
*   /* OUTPUT - RETURN CODE OF ZERO AND LASTCOND OF ZERO     @Y30LB33*/ 02092000
*   /* IF ALL PROCESSING WAS COMPLETED WITHOUT               @Y30LB33*/ 02093000
*   /* ERROR. RETURN CODE OF 16 AND LASTCOND OF 8            @Y30LB33*/ 02094000
*   /* IF PROCESSING TERMINATED WITH AN ERROR.               @Y30LB33*/ 02095000
*   /*                                                               */ 02096000
*   /*****************************************************************/ 02097000
*                                                                  0702 02098000
*CHNSEL:                                                           0702 02099000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 02100000
CHNSEL   ST    @14,@SA00007                                        0702 02101000
*   OLDERID2=NEWERID2;                                             0703 02102000
         L     @04,@PC00001                                        0703 02103000
         L     @04,GDTTR2(,@04)                                    0703 02104000
         MVC   @TS00001(95),NEWERID2(@04)                          0703 02105000
         MVC   OLDERID2(95,@04),@TS00001                           0703 02106000
*   NEWID2='LVGA';                  /*                       @Y30LB33*/ 02107000
         MVC   NEWID2(4,@04),@CC02477                              0704 02108000
*   TESTRC=0;                       /*                       @Y30LB33*/ 02109000
*                                                                  0705 02110000
         SLR   TESTRC,TESTRC                                       0705 02111000
*   /*****************************************************************/ 02112000
*   /*                                                               */ 02113000
*   /* SET UP THE READ REQUEST BLOCK TO START                @Y30LB33*/ 02114000
*   /* READING A CHAIN                                       @Y30LB33*/ 02115000
*   /* GET THE FIRST VOLUME SERIAL FROM THE                  @Y30LB33*/ 02116000
*   /* GROUP RECORD                                          @Y30LB33*/ 02117000
*   /*                                                               */ 02118000
*   /*****************************************************************/ 02119000
*                                                                  0706 02120000
*   VOLRVVI=VOLRVVI&&VOLRVVI;       /*                       @Y30LB33*/ 02121000
         XC    VOLRVVI(68),VOLRVVI                                 0706 02122000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Y30LB33*/ 02123000
         LA    RVVIPTR,VOLRVVI                                     0707 02124000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 02125000
         LH    @04,RVVLEN                                          0708 02126000
         ST    @04,RVVLNGTH(,RVVIPTR)                              0708 02127000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 02128000
         MVI   RVVCODE(RVVIPTR),X'87'                              0709 02129000
*   RVVRDCH=ON;                     /*                       @Y30LB33*/ 02130000
         OI    RVVRDCH(RVVIPTR),B'00100000'                        0710 02131000
*   RVVBVRCD=ON;                    /*                       @Y30LB33*/ 02132000
         OI    RVVBVRCD(RVVIPTR),B'10000000'                       0711 02133000
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Y30LB33*/ 02134000
         LA    @04,VOLRCDBF                                        0712 02135000
         ST    @04,RVVRTBUF(,RVVIPTR)                              0712 02136000
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Y30LB33*/ 02137000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02618                        0713 02138000
*   RVVSVOL=ON;                     /*                       @Y30LB33*/ 02139000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        0714 02140000
*   GROUPPTR=ADDR(GRPRCDBF);        /*                       @Y30LB33*/ 02141000
         LA    GROUPPTR,GRPRCDBF                                   0715 02142000
*   RVVGPVOL=ON;                    /*                       @Y30LB33*/ 02143000
         OI    RVVGPVOL(RVVIPTR),B'10000000'                       0716 02144000
*   RVVOLUME=GROFSN;                /*                       @Y30LB33*/ 02145000
         MVC   RVVOLUME(6,RVVIPTR),GROFSN(GROUPPTR)                0717 02146000
*   RVVGROUP=GROVVGRP;              /*                       @Y30LB33*/ 02147000
         MVC   RVVGROUP(8,RVVIPTR),GROVVGRP(GROUPPTR)              0718 02148000
*   RVVSGRP=ON;                     /*                       @Y30LB33*/ 02149000
         OI    RVVSGRP(RVVIPTR),B'10000000'                        0719 02150000
*                                                                  0720 02151000
*   /*****************************************************************/ 02152000
*   /*                                                               */ 02153000
*   /* SELECT THE GENERAL VOLUMES IF GENERAL,                @Y30LB33*/ 02154000
*   /* ACTIVE, OR ALL ARE REQUESTED IN THE FDTTBL,           @Y30LB33*/ 02155000
*   /* AND IF GROUP HAS GENERAL VOLUMES                      @Y30LB33*/ 02156000
*   /*                                                               */ 02157000
*   /*****************************************************************/ 02158000
*                                                                  0720 02159000
*   IF(ADDR(GNRL)>0|ADDR(AL)>0|     /*                       @Y30LB33*/ 02160000
*       ADDR(ACT)>0)&GRONGEN>0 THEN                                0720 02161000
         SLR   @04,@04                                             0720 02162000
         L     @03,@PC00001+4                                      0720 02163000
         C     @04,FDTPTR+76(,@03)                                 0720 02164000
         BL    @GL00020                                            0720 02165000
         C     @04,FDTPTR+36(,@03)                                 0720 02166000
         BL    @GL00020                                            0720 02167000
         C     @04,FDTPTR+68(,@03)                                 0720 02168000
         BNL   @RF00720                                            0720 02169000
@GL00020 LH    @04,GRONGEN(,GROUPPTR)                              0720 02170000
         LTR   @04,@04                                             0720 02171000
         BNP   @RF00720                                            0720 02172000
*     DO;                           /*                       @Y30LB33*/ 02173000
*                                                                  0721 02174000
*       /*************************************************************/ 02175000
*       /*                                                           */ 02176000
*       /* SET UP GENERAL VOLUME HEADER LINE                 @Y30LB33*/ 02177000
*       /*                                                           */ 02178000
*       /*************************************************************/ 02179000
*                                                                  0722 02180000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 02181000
         L     @04,DDSTRU                                          0722 02182000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0722 02183000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 02184000
         MVC   DARGSMOD(3,@04),@CC02396                            0723 02185000
*       DARGSENT=ACTGEN;            /*                       @Y30LB33*/ 02186000
*                                                                  0724 02187000
         MVI   DARGSENT(@04),X'0E'                                 0724 02188000
*       /*************************************************************/ 02189000
*       /*                                                           */ 02190000
*       /* PRINT THE GENERAL HEADING                         @Y30LB33*/ 02191000
*       /*                                                           */ 02192000
*       /*************************************************************/ 02193000
*                                                                  0725 02194000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02195000
         L     @04,@PC00001                                        0725 02196000
         ST    @04,@AL00001                                        0725 02197000
         LA    @03,PRINTME                                         0725 02198000
         ST    @03,@AL00001+4                                      0725 02199000
         LA    @03,DDSTRU                                          0725 02200000
         ST    @03,@AL00001+8                                      0725 02201000
         MVI   @AL00001+8,X'80'                                    0725 02202000
         L     @15,GDTPRT(,@04)                                    0725 02203000
         LA    @01,@AL00001                                        0725 02204000
         BALR  @14,@15                                             0725 02205000
*                                                                  0726 02206000
*       /*************************************************************/ 02207000
*       /*                                                           */ 02208000
*       /* PROCESS ACTIVE GENERAL VOLUMES                    @Y30LB33*/ 02209000
*       /*                                                           */ 02210000
*       /*************************************************************/ 02211000
*                                                                  0726 02212000
*       RVVACTV=ON;                 /* READ ACTIVE VOLS      @Y30LB33*/ 02213000
*       RVVGSVOL=ON;                /* REQUEST GENERAL       @Y30LB33*/ 02214000
         OI    RVVACTV(RVVIPTR),B'00100100'                        0727 02215000
*       CALL VOLCHNR;               /* READ THE CHAIN        @Y30LB33*/ 02216000
         BAL   @14,VOLCHNR                                         0728 02217000
*       RESPECIFY                                                  0729 02218000
*         RTNREG RSTD;                                             0729 02219000
*       TESTRC=RTNREG;                                             0730 02220000
         LR    TESTRC,RTNREG                                       0730 02221000
*       RESPECIFY                                                  0731 02222000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02223000
*       RVVACTV=OFF;                /* RESET REQUEST BLOCK   @Y30LB33*/ 02224000
*       RVVGSVOL=OFF;               /*                       @Y30LB33*/ 02225000
         NI    RVVACTV(RVVIPTR),B'11011011'                        0733 02226000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 02227000
         LA    RVVIPTR,VOLRVVI                                     0734 02228000
*     END;                          /*                       @Y30LB33*/ 02229000
*                                                                  0736 02230000
*   /*****************************************************************/ 02231000
*   /*                                                               */ 02232000
*   /* SELECT ACTIVE RESTRICTED VOLUMES IF                   @Y30LB33*/ 02233000
*   /* RESTRICTED, ALL OR ACTIVE ARE REQUESTED               @Y30LB33*/ 02234000
*   /* IN THE FDTTBL AND IF THE GROUP HAS                    @Y30LB33*/ 02235000
*   /* RESTRICTED VOLUMES                                    @Y30LB33*/ 02236000
*   /*                                                               */ 02237000
*   /*****************************************************************/ 02238000
*                                                                  0736 02239000
*   IF(TESTRC<16&GRONRSTD>0)&       /*                       @Y30LB33*/ 02240000
*       (ADDR(RSTR)>0|ADDR(AL)>0|   /*                       @Y30LB33*/ 02241000
*       ADDR(ACT)>0) THEN                                          0736 02242000
@RF00720 C     TESTRC,@CF00507                                     0736 02243000
         BNL   @RF00736                                            0736 02244000
         SLR   @04,@04                                             0736 02245000
         CH    @04,GRONRSTD(,GROUPPTR)                             0736 02246000
         BNL   @RF00736                                            0736 02247000
         L     @03,@PC00001+4                                      0736 02248000
         C     @04,FDTPTR+80(,@03)                                 0736 02249000
         BL    @RT00736                                            0736 02250000
         C     @04,FDTPTR+36(,@03)                                 0736 02251000
         BL    @RT00736                                            0736 02252000
         C     @04,FDTPTR+68(,@03)                                 0736 02253000
         BNL   @RF00736                                            0736 02254000
@RT00736 DS    0H                                                  0737 02255000
*     DO;                           /*                       @Y30LB33*/ 02256000
*                                                                  0737 02257000
*       /*************************************************************/ 02258000
*       /*                                                           */ 02259000
*       /* SET UP RESTRICTED VOLUME                          @Y30LB33*/ 02260000
*       /* HEADER LINE                                       @Y30LB33*/ 02261000
*       /*                                                           */ 02262000
*       /*************************************************************/ 02263000
*                                                                  0738 02264000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 02265000
         L     @04,DDSTRU                                          0738 02266000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0738 02267000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 02268000
         MVC   DARGSMOD(3,@04),@CC02396                            0739 02269000
*       DARGSENT=ACTRSTR;           /*                       @Y30LB33*/ 02270000
*                                                                  0740 02271000
         MVI   DARGSENT(@04),X'0F'                                 0740 02272000
*       /*************************************************************/ 02273000
*       /*                                                           */ 02274000
*       /* PRINT THE RESTRICTED HEADING                      @Y30LB33*/ 02275000
*       /*                                                           */ 02276000
*       /*************************************************************/ 02277000
*                                                                  0741 02278000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02279000
         L     @04,@PC00001                                        0741 02280000
         ST    @04,@AL00001                                        0741 02281000
         LA    @03,PRINTME                                         0741 02282000
         ST    @03,@AL00001+4                                      0741 02283000
         LA    @03,DDSTRU                                          0741 02284000
         ST    @03,@AL00001+8                                      0741 02285000
         MVI   @AL00001+8,X'80'                                    0741 02286000
         L     @15,GDTPRT(,@04)                                    0741 02287000
         LA    @01,@AL00001                                        0741 02288000
         BALR  @14,@15                                             0741 02289000
*                                                                  0742 02290000
*       /*************************************************************/ 02291000
*       /*                                                           */ 02292000
*       /* PROCESS RESTRICTED VOLUMES                        @Y30LB33*/ 02293000
*       /*                                                           */ 02294000
*       /*************************************************************/ 02295000
*                                                                  0742 02296000
*       RVVACTV=ON;                 /* READ ACTIVE VOLS      @Y30LB33*/ 02297000
*       RVVRSTD=ON;                 /*                       @Y30LB33*/ 02298000
         OI    RVVACTV(RVVIPTR),B'00010100'                        0743 02299000
*       CALL VOLCHNR;               /* READ THE CHAIN        @Y30LB33*/ 02300000
         BAL   @14,VOLCHNR                                         0744 02301000
*       RESPECIFY                                                  0745 02302000
*         RTNREG RSTD;                                             0745 02303000
*       TESTRC=RTNREG;                                             0746 02304000
         LR    TESTRC,RTNREG                                       0746 02305000
*       RESPECIFY                                                  0747 02306000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02307000
*       RVVACTV=OFF;                /* RESET REQUEST BLOCK   @Y30LB33*/ 02308000
*       RVVRSTD=OFF;                /*                       @Y30LB33*/ 02309000
         NI    RVVACTV(RVVIPTR),B'11101011'                        0749 02310000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 02311000
         LA    RVVIPTR,VOLRVVI                                     0750 02312000
*     END;                          /*                       @Y30LB33*/ 02313000
*                                                                  0752 02314000
*   /*****************************************************************/ 02315000
*   /*                                                               */ 02316000
*   /* SELECT THE INACTIVE VOLUMES IF INACTIVE               @Y30LB33*/ 02317000
*   /* OR ALL ARE SPECIFIED IN THE FDTTBL AND IF             @Y30LB33*/ 02318000
*   /* THE GROUP HAS INACTIVE VOLUMES                        @Y30LB33*/ 02319000
*   /*                                                               */ 02320000
*   /*****************************************************************/ 02321000
*                                                                  0752 02322000
*   IF TESTRC<16&GRONINAC>0&(ADDR(AL)>0|/*                   @Y30LB33*/ 02323000
*       ADDR(INACT)>0)              /*                       @Y30LB33*/ 02324000
*     THEN                                                         0752 02325000
@RF00736 C     TESTRC,@CF00507                                     0752 02326000
         BNL   @RF00752                                            0752 02327000
         SLR   @04,@04                                             0752 02328000
         CH    @04,GRONINAC(,GROUPPTR)                             0752 02329000
         BNL   @RF00752                                            0752 02330000
         L     @03,@PC00001+4                                      0752 02331000
         C     @04,FDTPTR+36(,@03)                                 0752 02332000
         BL    @RT00752                                            0752 02333000
         C     @04,FDTPTR+72(,@03)                                 0752 02334000
         BNL   @RF00752                                            0752 02335000
@RT00752 DS    0H                                                  0753 02336000
*     DO;                           /*                       @Y30LB33*/ 02337000
*                                                                  0753 02338000
*       /*************************************************************/ 02339000
*       /*                                                           */ 02340000
*       /* SET UP INACTIVE VOLUME HEADER LINE                @Y30LB33*/ 02341000
*       /*                                                           */ 02342000
*       /*************************************************************/ 02343000
*                                                                  0754 02344000
*       DARGLIST=''B;               /*                       @Y30LB33*/ 02345000
         L     @04,DDSTRU                                          0754 02346000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0754 02347000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 02348000
         MVC   DARGSMOD(3,@04),@CC02396                            0755 02349000
*       DARGSENT=INACTMSG;          /*                       @Y30LB33*/ 02350000
         MVI   DARGSENT(@04),X'10'                                 0756 02351000
*                                                                  0757 02352000
*       /*************************************************************/ 02353000
*       /*                                                           */ 02354000
*       /* PRINT THE INACTIVE HEADING                        @Y30LB33*/ 02355000
*       /*                                                           */ 02356000
*       /*************************************************************/ 02357000
*                                                                  0757 02358000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02359000
*                                                                  0757 02360000
         L     @04,@PC00001                                        0757 02361000
         ST    @04,@AL00001                                        0757 02362000
         LA    @03,PRINTME                                         0757 02363000
         ST    @03,@AL00001+4                                      0757 02364000
         LA    @03,DDSTRU                                          0757 02365000
         ST    @03,@AL00001+8                                      0757 02366000
         MVI   @AL00001+8,X'80'                                    0757 02367000
         L     @15,GDTPRT(,@04)                                    0757 02368000
         LA    @01,@AL00001                                        0757 02369000
         BALR  @14,@15                                             0757 02370000
*       /*************************************************************/ 02371000
*       /*                                                           */ 02372000
*       /* PROCESS INACTIVE VOLUMES                          @Y30LB33*/ 02373000
*       /*                                                           */ 02374000
*       /*************************************************************/ 02375000
*                                                                  0758 02376000
*       RVVINACT=ON;                /* SELECT INACTIVE VOLS  @Y30LB33*/ 02377000
         OI    RVVINACT(RVVIPTR),B'00001000'                       0758 02378000
*       CALL VOLCHNR;               /* PROCESS THE CHAIN     @Y30LB33*/ 02379000
         BAL   @14,VOLCHNR                                         0759 02380000
*       RESPECIFY                                                  0760 02381000
*         RTNREG RSTD;                                             0760 02382000
*       TESTRC=RTNREG;                                             0761 02383000
         LR    TESTRC,RTNREG                                       0761 02384000
*       RESPECIFY                                                  0762 02385000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02386000
*       RVVINACT=OFF;               /* RESET REQUEST BLOCK   @Y30LB33*/ 02387000
         NI    RVVINACT(RVVIPTR),B'11110111'                       0763 02388000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 02389000
         LA    RVVIPTR,VOLRVVI                                     0764 02390000
*     END;                          /*                       @Y30LB33*/ 02391000
*                                                                  0766 02392000
*   /*****************************************************************/ 02393000
*   /*                                                               */ 02394000
*   /* SELECT THE VOLUMES THAT WILL EXPIRE AFTER             @Y30LB33*/ 02395000
*   /* THE SPECIFIED NUMBER OF DAYS IF THE                   @Y30LB33*/ 02396000
*   /* EXPIRATION PARAMETER WAS SPECIFIED, IF THE            @Y30LB33*/ 02397000
*   /* GROUP HAS A RETENTION PERIOD, AND IF THE              @Y30LB33*/ 02398000
*   /* GROUP HAS GENERAL VOLUMES                             @Y30LB33*/ 02399000
*   /*                                                               */ 02400000
*   /*****************************************************************/ 02401000
*                                                                  0766 02402000
*   IF TESTRC<16&GRORETN=ON&GRONGEN>0/*                      @Y30LB33*/ 02403000
*       &ADDR(EXPIR)>0 THEN                                        0766 02404000
@RF00752 C     TESTRC,@CF00507                                     0766 02405000
         BNL   @RF00766                                            0766 02406000
         TM    GRORETN(GROUPPTR),B'00000100'                       0766 02407000
         BNO   @RF00766                                            0766 02408000
         SLR   @04,@04                                             0766 02409000
         CH    @04,GRONGEN(,GROUPPTR)                              0766 02410000
         BNL   @RF00766                                            0766 02411000
         L     @03,@PC00001+4                                      0766 02412000
         L     @03,FDTPTR+28(,@03)                                 0766 02413000
         CR    @03,@04                                             0766 02414000
         BNH   @RF00766                                            0766 02415000
*     DO;                           /*                       @Y30LB33*/ 02416000
*       RVVEXPIR=EXPIRVAL;          /* SET EXPIR DATE        @Y30LB33*/ 02417000
         L     @04,EXPIRVAL(,@03)                                  0768 02418000
         STH   @04,RVVEXPIR(,RVVIPTR)                              0768 02419000
*       RVVSEXP=ON;                 /*                       @Y30LB33*/ 02420000
         OI    RVVSEXP(RVVIPTR),B'01000000'                        0769 02421000
*       RVVACTV=ON;                 /*                       @Y30LB33*/ 02422000
*       RVVGSVOL=ON;                /*                       @Y30LB33*/ 02423000
*       RVVEXPDT=ON;                /*                       @Y30LB33*/ 02424000
         OI    RVVACTV(RVVIPTR),B'10100100'                        0772 02425000
*       CALL VOLCHNR;               /* PROCESS THE CHAIN     @Y30LB33*/ 02426000
         BAL   @14,VOLCHNR                                         0773 02427000
*       RESPECIFY                                                  0774 02428000
*         RTNREG RSTD;                                             0774 02429000
*       TESTRC=RTNREG;                                             0775 02430000
         LR    TESTRC,RTNREG                                       0775 02431000
*       RESPECIFY                                                  0776 02432000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02433000
*       RVVIPTR=ADDR(VOLRVVI);      /*                       @Y30LB33*/ 02434000
         LA    RVVIPTR,VOLRVVI                                     0777 02435000
*     END;                          /*                       @Y30LB33*/ 02436000
*   MYCODE=TESTRC;                  /* SAVE RETURN CODE      @Y30LB33*/ 02437000
@RF00766 LR    MYCODE,TESTRC                                       0779 02438000
*                                                                  0780 02439000
*   /*****************************************************************/ 02440000
*   /*                                                               */ 02441000
*   /* PRINT THE SUMMARY OF THE VOLUMES IN THE               @Y30LB33*/ 02442000
*   /* GROUP BY PASSING THE VOLUME TOTAL INDICATOR           @Y30LB33*/ 02443000
*   /* TO THE SUMMARIZER                                     @Y30LB33*/ 02444000
*   /*                                                               */ 02445000
*   /*****************************************************************/ 02446000
*                                                                  0780 02447000
*   SUMMASK=GRPVOLSM;               /*                       @Y30LB33*/ 02448000
         LA    SUMMASK,2                                           0780 02449000
*   CALL SUMRY;                     /*                       @Y30LB33*/ 02450000
*                                                                  0781 02451000
         BAL   @14,SUMRY                                           0781 02452000
*   /*****************************************************************/ 02453000
*   /*                                                               */ 02454000
*   /* RETURN WITH A CODE OF 16 OR ZERO                      @Y30LB33*/ 02455000
*   /*                                                               */ 02456000
*   /*****************************************************************/ 02457000
*                                                                  0782 02458000
*   IF MYCODE<16 THEN                                              0782 02459000
         C     MYCODE,@CF00507                                     0782 02460000
         BNL   @RF00782                                            0782 02461000
*     MYCODE=0;                     /*                       @Y30LB33*/ 02462000
         SLR   MYCODE,MYCODE                                       0783 02463000
*   RETURN CODE(MYCODE);            /*                       @Y30LB33*/ 02464000
@RF00782 LR    @15,MYCODE                                          0784 02465000
@EL00007 DS    0H                                                  0784 02466000
@EF00007 DS    0H                                                  0784 02467000
@ER00007 L     @14,@SA00007                                        0784 02468000
         BR    @14                                                 0784 02469000
*   END CHNSEL;                     /*                       @Y30LB33*/ 02470000
*                                                                  0786 02471000
*   /*****************************************************************/ 02472000
*   /*                                                               */ 02473000
*   /* PROCEDURE NAME - VOLCHNR                              @Y30LB33*/ 02474000
*   /*                                                       @Y30LB33*/ 02475000
*   /* FUNCTION - THIS ROUTINE PASSES TO THE VOLUME          @Y30LB33*/ 02476000
*   /* PROCESSOR THE REQUEST BLOCK TO READ VOLUMES           @Y30LB33*/ 02477000
*   /* IN A CHAIN. THE REQUEST BLOCK CONTAINS THE            @Y30LB33*/ 02478000
*   /* FIRST VOLUME TO READ. AFTER THE FIRST                 @Y30LB33*/ 02479000
*   /* READ, THIS ROUTINE PLACES IN THE REQUEST              @Y30LB33*/ 02480000
*   /* BLOCK THE NEXT VOLUME SERIAL IN THE CHAIN             @Y30LB33*/ 02481000
*   /* THAT IS RETRIEVED FROM THE LAST RECORD                @Y30LB33*/ 02482000
*   /* THAT WAS READ                                         @Y30LB33*/ 02483000
*   /*                                                       @Y30LB33*/ 02484000
*   /* INPUT - READ REQUEST BLOCK                            @Y30LB33*/ 02485000
*   /*                                                       @Y30LB33*/ 02486000
*   /* OUTPUT - RETURN CODE AND LASTCOND OF ZERO FOR         @Y30LB33*/ 02487000
*   /* NORMAL PROCESSING. RETURN CODE OF 16 AND              @Y30LB33*/ 02488000
*   /* LASTCOND OF 8 FOR TERMINATION ERROR.                  @Y30LB33*/ 02489000
*   /*                                                               */ 02490000
*   /*****************************************************************/ 02491000
*                                                                  0786 02492000
*VOLCHNR:                                                          0786 02493000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 02494000
VOLCHNR  ST    @14,@SA00008                                        0786 02495000
*   OLDERID2=NEWERID2;                                             0787 02496000
         L     @04,@PC00001                                        0787 02497000
         L     @04,GDTTR2(,@04)                                    0787 02498000
         MVC   @TS00001(95),NEWERID2(@04)                          0787 02499000
         MVC   OLDERID2(95,@04),@TS00001                           0787 02500000
*   NEWID2='LVHA';                  /*                       @Y30LB33*/ 02501000
         MVC   NEWID2(4,@04),@CC02482                              0788 02502000
*   TESTRC=0;                       /*                       @Y30LB33*/ 02503000
*                                                                  0789 02504000
         SLR   TESTRC,TESTRC                                       0789 02505000
*   /*****************************************************************/ 02506000
*   /*                                                               */ 02507000
*   /* PROCESS THE CHAIN UNTIL THE END OF THE CHAIN          @Y30LB33*/ 02508000
*   /* OR AN ERROR OCCURS READING A RECORD.                  @Y30LB33*/ 02509000
*   /* EACH CALL TO THE VOLUME PROCESSOR IS MADE WITH THE    @Y30LB33*/ 02510000
*   /* READ REQUEST BLOCK AND A NEW VOLUME SERIAL.           @Y30LB33*/ 02511000
*   /*                                                               */ 02512000
*   /*****************************************************************/ 02513000
*                                                                  0790 02514000
*   DO WHILE(TESTRC=0);             /*                       @Y30LB33*/ 02515000
         B     @DE00790                                            0790 02516000
@DL00790 DS    0H                                                  0791 02517000
*     CALL VOLPROC;                 /*                       @Y30LB33*/ 02518000
         BAL   @14,VOLPROC                                         0791 02519000
*     RESPECIFY                                                    0792 02520000
*       RTNREG RSTD;                                               0792 02521000
*     TESTRC=RTNREG;                                               0793 02522000
         LR    TESTRC,RTNREG                                       0793 02523000
*     RESPECIFY                                                    0794 02524000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 02525000
*                                                                  0794 02526000
*     /***************************************************************/ 02527000
*     /*                                                             */ 02528000
*     /* GET THE NEXT VOLUME                                 @Y30LB33*/ 02529000
*     /*                                                             */ 02530000
*     /***************************************************************/ 02531000
*                                                                  0795 02532000
*     RVVIPTR=ADDR(VOLRVVI);        /*                       @Y30LB33*/ 02533000
         LA    RVVIPTR,VOLRVVI                                     0795 02534000
*     RVVOLUME=BASNEXTV;            /*                       @Y30LB33*/ 02535000
         MVC   RVVOLUME(6,RVVIPTR),BASNEXTV(BASEVPTR)              0796 02536000
*     RVVSVOL=ON;                   /*                       @Y30LB33*/ 02537000
*                                                                  0797 02538000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        0797 02539000
*     /***************************************************************/ 02540000
*     /*                                                             */ 02541000
*     /* TEST FOR LAST VOLUME IN CHAIN AND END               @Y30LB33*/ 02542000
*     /* THE LOOP IF IT IS THE LAST                          @Y30LB33*/ 02543000
*     /*                                                             */ 02544000
*     /***************************************************************/ 02545000
*                                                                  0798 02546000
*     IF BASLAST=ON THEN                                           0798 02547000
         TM    BASLAST(BASEVPTR),B'00001000'                       0798 02548000
         BNO   @RF00798                                            0798 02549000
*       TESTRC=MAX(TESTRC,2);       /*                       @Y30LB33*/ 02550000
         LA    @04,2                                               0799 02551000
         CR    TESTRC,@04                                          0799 02552000
         BNL   *+6                                                      02553000
         LR    TESTRC,@04                                          0799 02554000
*   END;                            /*                       @Y30LB33*/ 02555000
*                                                                  0800 02556000
@RF00798 DS    0H                                                  0800 02557000
@DE00790 LTR   TESTRC,TESTRC                                       0800 02558000
         BZ    @DL00790                                            0800 02559000
*   /*****************************************************************/ 02560000
*   /*                                                               */ 02561000
*   /* SET UP FOR NEXT CHAIN READ SEQUENCE                   @YM02864*/ 02562000
*   /*                                                               */ 02563000
*   /*****************************************************************/ 02564000
*                                                                  0801 02565000
*   RVVOLUME=GROFSN;                /*                       @YM02864*/ 02566000
*                                                                  0801 02567000
         MVC   RVVOLUME(6,RVVIPTR),GROFSN(GROUPPTR)                0801 02568000
*   /*****************************************************************/ 02569000
*   /*                                                               */ 02570000
*   /* SET RETURN CODE TO ZERO OR 16                         @Y30LB33*/ 02571000
*   /*                                                               */ 02572000
*   /*****************************************************************/ 02573000
*                                                                  0802 02574000
*   IF TESTRC<16 THEN                                              0802 02575000
         C     TESTRC,@CF00507                                     0802 02576000
         BNL   @RF00802                                            0802 02577000
*     TESTRC=0;                     /*                       @Y30LB33*/ 02578000
         SLR   TESTRC,TESTRC                                       0803 02579000
*   RETURN CODE(TESTRC);            /*                       @Y30LB33*/ 02580000
@RF00802 LR    @15,TESTRC                                          0804 02581000
@EL00008 DS    0H                                                  0804 02582000
@EF00008 DS    0H                                                  0804 02583000
@ER00008 L     @14,@SA00008                                        0804 02584000
         BR    @14                                                 0804 02585000
*   END VOLCHNR;                    /*                       @Y30LB33*/ 02586000
*                                                                  0806 02587000
*   /*****************************************************************/ 02588000
*   /*                                                               */ 02589000
*   /* PROCEDURE NAME - VOLPROC                              @Y30LB33*/ 02590000
*   /*                                                       @Y30LB33*/ 02591000
*   /* FUNCTION - CONTROLS READING AND PRINTING OF A         @Y30LB33*/ 02592000
*   /* VOLUME AND ITS COPIES                                 @Y30LB33*/ 02593000
*   /*                                                       @Y30LB33*/ 02594000
*   /* INPUT - READ REQUEST BLOCK AND THE FDTTBL             @Y30LB33*/ 02595000
*   /* READVVI FLAGS - RVVALL OR RVVBPLHD                    @ZDR2056*/ 02596000
*   /* SET IN ALLSEQ                                         @ZDR2056*/ 02597000
*   /*                                                       @Y30LB33*/ 02598000
*   /* OUTPUT - RETURN CODE AND LASTCOND OF ZERO FOR         @Y30LB33*/ 02599000
*   /* NORMAL PROCESSING. RETURN CODE OF 4 AND               @Y30LB33*/ 02600000
*   /* LASTCOND OF ZERO FOR END OF RECORD CHAIN              @Y30LB33*/ 02601000
*   /* OR RECORD NOT FOUND. RETURN CODE OF 16 AND            @Y30LB33*/ 02602000
*   /* LASTCOND OF 8 FOR A TERMINATION ERROR                 @Y30LB33*/ 02603000
*   /*                                                               */ 02604000
*   /*****************************************************************/ 02605000
*                                                                  0806 02606000
*VOLPROC:                                                          0806 02607000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 02608000
VOLPROC  ST    @14,@SA00009                                        0806 02609000
*   OLDERID2=NEWERID2;                                             0807 02610000
         L     @04,@PC00001                                        0807 02611000
         L     @04,GDTTR2(,@04)                                    0807 02612000
         MVC   @TS00001(95),NEWERID2(@04)                          0807 02613000
         MVC   OLDERID2(95,@04),@TS00001                           0807 02614000
*   NEWID2='LVIA';                  /*                       @Y30LB33*/ 02615000
         MVC   NEWID2(4,@04),@CC02486                              0808 02616000
*   TESTRC=0;                       /*                       @Y30LB33*/ 02617000
*                                                                  0809 02618000
         SLR   TESTRC,TESTRC                                       0809 02619000
*   /*****************************************************************/ 02620000
*   /*                                                               */ 02621000
*   /* CALL THE VOLUME READER TO READ THE VOLUME RECORD      @Y30LB33*/ 02622000
*   /*                                                               */ 02623000
*   /*****************************************************************/ 02624000
*                                                                  0810 02625000
*   CALL VOLRDR;                    /*                       @Y30LB33*/ 02626000
         BAL   @14,VOLRDR                                          0810 02627000
*   RESPECIFY                                                      0811 02628000
*     RTNREG RSTD;                                                 0811 02629000
*   TESTRC=RTNREG;                                                 0812 02630000
         LR    TESTRC,RTNREG                                       0812 02631000
*   RESPECIFY                                                      0813 02632000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 02633000
*                                                                  0813 02634000
*   /*****************************************************************/ 02635000
*   /*                                                               */ 02636000
*   /* IF THE RECORD WAS READ WITHOUT ERROR, CALL THE        @Y30LB33*/ 02637000
*   /* VOLUME FORMATTER TO SET UP THE RECORD FIELDS FOR PRINTING AND */ 02638000
*   /* CALL THE PRINTER TO PRINT THE RECORD.                 @Y30LB33*/ 02639000
*   /*                                                               */ 02640000
*   /*****************************************************************/ 02641000
*                                                                  0814 02642000
*   IF TESTRC=0 THEN                /*                       @ZDR2056*/ 02643000
*                                                                  0814 02644000
         SLR   @04,@04                                             0814 02645000
         CR    TESTRC,@04                                          0814 02646000
         BNE   @RF00814                                            0814 02647000
*     /***************************************************************/ 02648000
*     /*                                                             */ 02649000
*     /* IF CALLED FROM ALLVPROC AND THIS IS A               @ZDR2056*/ 02650000
*     /* BASE VOLUME RECORD WHEN ONLY                        @ZDR2056*/ 02651000
*     /* PLACE HOLDER RECORDS ARE TO BE PRINTED,             @ZDR2056*/ 02652000
*     /* THEN DO NOT FORMAT AND PRINT THE RECORD.            @ZDR2056*/ 02653000
*     /*                                                             */ 02654000
*     /***************************************************************/ 02655000
*                                                                  0815 02656000
*     IF ALLVCALL=ON&BASHOLD=OFF&ADDR(PLHD)^=NULLPTR/*       @ZDR2056*/ 02657000
*       THEN                                                       0815 02658000
         TM    ALLVCALL,B'00100000'                                0815 02659000
         BNO   @RF00815                                            0815 02660000
         TM    BASHOLD(BASEVPTR),B'10000000'                       0815 02661000
         BNZ   @RF00815                                            0815 02662000
         L     @03,@PC00001+4                                      0815 02663000
         C     @04,FDTPTR+92(,@03)                                 0815 02664000
         BNE   @RT00815                                            0815 02665000
*       ;                           /*                       @ZDR2056*/ 02666000
*     ELSE                          /*                       @ZDR2056*/ 02667000
*       DO;                         /*                       @ZDR2056*/ 02668000
@RF00815 DS    0H                                                  0818 02669000
*         CALL VOLFMTR;             /* FORMAT THE DATA       @Y30LB33*/ 02670000
         BAL   @14,VOLFMTR                                         0818 02671000
*         CALL VOLPRNT;             /* PRINT THE VOLUME      @Y30LB33*/ 02672000
*                                                                  0819 02673000
         BAL   @14,VOLPRNT                                         0819 02674000
*         /***********************************************************/ 02675000
*         /*                                                         */ 02676000
*         /* TESTRC IS NOW ZERO                              @ZDR2056*/ 02677000
*         /*                                                         */ 02678000
*         /***********************************************************/ 02679000
*                                                                  0820 02680000
*       END;                        /*                       @ZDR2056*/ 02681000
*                                                                  0820 02682000
*   /*****************************************************************/ 02683000
*   /*                                                               */ 02684000
*   /* IF A STATUS REPORT IS REQUESTED WITH A VALID          @ZDR2056*/ 02685000
*   /* RETURN CODE, CALL THE COPY PROCESSOR TO               @ZDR2056*/ 02686000
*   /* READ AND PRINT COPY AND/OR COPY PLACE HOLDER          @ZDR2056*/ 02687000
*   /* VOLUME RECORDS, IF ANY.                               @ZDR2056*/ 02688000
*   /*                                                               */ 02689000
*   /*****************************************************************/ 02690000
*                                                                  0821 02691000
*   IF ADDR(STAT)>0&TESTRC=0 THEN   /*                       @ZDR2056*/ 02692000
@RT00815 DS    0H                                                  0821 02693000
@RF00814 SLR   @04,@04                                             0821 02694000
         L     @03,@PC00001+4                                      0821 02695000
         C     @04,FDTPTR+52(,@03)                                 0821 02696000
         BNL   @RF00821                                            0821 02697000
         CR    TESTRC,@04                                          0821 02698000
         BNE   @RF00821                                            0821 02699000
*     DO;                           /*                       @ZDR2056*/ 02700000
*       CALL CPYPROC;               /*                       @Y30LB33*/ 02701000
         BAL   @14,CPYPROC                                         0823 02702000
*       RESPECIFY                                                  0824 02703000
*         RTNREG RSTD;                                             0824 02704000
*       TESTRC=RTNREG;                                             0825 02705000
         LR    TESTRC,RTNREG                                       0825 02706000
*       RESPECIFY                                                  0826 02707000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02708000
*     END;                          /*                       @Y30LB33*/ 02709000
*                                                                  0828 02710000
*   /*****************************************************************/ 02711000
*   /*                                                               */ 02712000
*   /* RETURN WITH THE CODE FROM THE CALLED PROCEDURES       @Y30LB33*/ 02713000
*   /*                                                               */ 02714000
*   /*****************************************************************/ 02715000
*                                                                  0828 02716000
*   RETURN CODE(TESTRC);            /*                       @Y30LB33*/ 02717000
@RF00821 LR    @15,TESTRC                                          0828 02718000
@EL00009 DS    0H                                                  0828 02719000
@EF00009 DS    0H                                                  0828 02720000
@ER00009 L     @14,@SA00009                                        0828 02721000
         BR    @14                                                 0828 02722000
*   END VOLPROC;                    /*                       @Y30LB33*/ 02723000
*                                                                  0830 02724000
*   /*****************************************************************/ 02725000
*   /*                                                               */ 02726000
*   /* PROCEDURE NAME - VOLPRNT                              @Y30LB33*/ 02727000
*   /*                                                       @Y30LB33*/ 02728000
*   /* FUNCTION - TO PRINT A VOLUME RECORD WITH RECOVERY     @Y30LB33*/ 02729000
*   /* BIT STATUS MESSAGES AND THE DUPLICATES                @Y30LB33*/ 02730000
*   /* HEADING LINE, IF NEEDED.                              @Y30LB33*/ 02731000
*   /*                                                       @Y30LB33*/ 02732000
*   /* INPUT - THE FDTTBL, THE SUMMARY TABLE, THE            @Y30LB33*/ 02733000
*   /* VOLUME RECORD, AND THE PRINT ARGUMENT LIST            @Y30LB33*/ 02734000
*   /*                                                       @Y30LB33*/ 02735000
*   /* OUTPUT - RETURN CODE OF ZERO, AND AN UPDATED          @Y30LB33*/ 02736000
*   /* SUMMARY TABLE                                         @Y30LB33*/ 02737000
*   /*                                                               */ 02738000
*   /*****************************************************************/ 02739000
*                                                                  0830 02740000
*VOLPRNT:                                                          0830 02741000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 02742000
*                                                                  0830 02743000
VOLPRNT  ST    @14,@SA00010                                        0830 02744000
*   /*****************************************************************/ 02745000
*   /*                                                               */ 02746000
*   /* LOCAL WORK AREAS                                      @Y30LB33*/ 02747000
*   /*                                                               */ 02748000
*   /*****************************************************************/ 02749000
*                                                                  0831 02750000
*   DCL                                                            0831 02751000
*     LVMYDRG CHAR(20);             /* INTERNAL DARGLIST     @Y30LB33*/ 02752000
*   OLDERID2=NEWERID2;                                             0832 02753000
         L     @04,@PC00001                                        0832 02754000
         L     @03,GDTTR2(,@04)                                    0832 02755000
         MVC   @TS00001(95),NEWERID2(@03)                          0832 02756000
         MVC   OLDERID2(95,@03),@TS00001                           0832 02757000
*   NEWID2='LVJA';                  /*                       @Y30LB33*/ 02758000
         MVC   NEWID2(4,@03),@CC02495                              0833 02759000
*   TESTRC=0;                       /*                       @Y30LB33*/ 02760000
*                                                                  0834 02761000
         SLR   TESTRC,TESTRC                                       0834 02762000
*   /*****************************************************************/ 02763000
*   /*                                                               */ 02764000
*   /* IF WE HAVE A DUPLICATE VOLUME RECORD AND THE          @Y30LB33*/ 02765000
*   /* DUPLICATE KEYWORD IS UNDEFINED IN THE FDTTBL,         @Y30LB33*/ 02766000
*   /* AND THIS IS THE FIRST DUPLICATE BEING PROCESSED       @Y30LB33*/ 02767000
*   /* PRINT THE DUPLICATES HEADING LINE                     @Y30LB33*/ 02768000
*   /*                                                               */ 02769000
*   /*****************************************************************/ 02770000
*                                                                  0835 02771000
*   IF BCDDUP=ON&ADDR(DUP)=0&FRSTDUP=ON/*                    @Y30LB33*/ 02772000
*     THEN                                                         0835 02773000
         L     @03,BCDVPTR                                         0835 02774000
         TM    BCDDUP(@03),B'00000100'                             0835 02775000
         BNO   @RF00835                                            0835 02776000
         L     @03,@PC00001+4                                      0835 02777000
         L     @03,FDTPTR+32(,@03)                                 0835 02778000
         LTR   @03,@03                                             0835 02779000
         BNZ   @RF00835                                            0835 02780000
         TM    FRSTDUP,B'10000000'                                 0835 02781000
         BNO   @RF00835                                            0835 02782000
*     DO;                           /*                       @Y30LB33*/ 02783000
*       DARGSENT=DUPSLINE;          /*                       @Y30LB33*/ 02784000
         L     @03,DDSTRU                                          0837 02785000
         MVI   DARGSENT(@03),X'01'                                 0837 02786000
*       DDSTRU=ADDR(LVMYDRG);       /* BASE INTERNAL         @Y30LB33   02787000
*                                      DARGLIST              @Y30LB33*/ 02788000
         LA    @03,LVMYDRG                                         0838 02789000
         ST    @03,DDSTRU                                          0838 02790000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 02791000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      0839 02792000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 02793000
         MVC   DARGSMOD(3,@03),@CC02396                            0840 02794000
*       DARGSENT=DUPMSGLN;          /*                       @Y30LB33*/ 02795000
         MVI   DARGSENT(@03),X'11'                                 0841 02796000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02797000
         ST    @04,@AL00001                                        0842 02798000
         LA    @03,PRINTME                                         0842 02799000
         ST    @03,@AL00001+4                                      0842 02800000
         LA    @03,DDSTRU                                          0842 02801000
         ST    @03,@AL00001+8                                      0842 02802000
         MVI   @AL00001+8,X'80'                                    0842 02803000
         L     @15,GDTPRT(,@04)                                    0842 02804000
         LA    @01,@AL00001                                        0842 02805000
         BALR  @14,@15                                             0842 02806000
*     END;                          /*                       @Y30LB33*/ 02807000
*   DDSTRU=ADDR(LVDRGLST);          /* RESTORE THE DARGLIST  @Y30LB33   02808000
*                                      POINTER               @Y30LB33*/ 02809000
@RF00835 LA    @04,LVDRGLST                                        0844 02810000
         ST    @04,DDSTRU                                          0844 02811000
*   FRSTDUP=OFF;                    /* TURN OFF FIRST DUP SWITCH   0845 02812000
*                                                            @Y30LB33*/ 02813000
         NI    FRSTDUP,B'01111111'                                 0845 02814000
*                                                                  0846 02815000
*   /*****************************************************************/ 02816000
*   /*                                                               */ 02817000
*   /* ISSUE THE PRINT COMMAND TO PRINT THE VOLUME           @Y30LB33*/ 02818000
*   /* DATA                                                  @Y30LB33*/ 02819000
*   /*                                                               */ 02820000
*   /*****************************************************************/ 02821000
*                                                                  0846 02822000
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Y30LB33*/ 02823000
         L     @04,@PC00001                                        0846 02824000
         ST    @04,@AL00001                                        0846 02825000
         LA    @03,PRINTME                                         0846 02826000
         ST    @03,@AL00001+4                                      0846 02827000
         LA    @03,DDSTRU                                          0846 02828000
         ST    @03,@AL00001+8                                      0846 02829000
         MVI   @AL00001+8,X'80'                                    0846 02830000
         L     @15,GDTPRT(,@04)                                    0846 02831000
         LA    @01,@AL00001                                        0846 02832000
         BALR  @14,@15                                             0846 02833000
*                                                                  0847 02834000
*   /*****************************************************************/ 02835000
*   /*                                                               */ 02836000
*   /* TEST FOR AN INCOMPLETE COPY, INCOMPLETE               @Y30LB33*/ 02837000
*   /* CREATE, OR LABEL MISMATCH, AND PRINT APPROPRIATE      @Y30LB33*/ 02838000
*   /* DATA LINES IF THE FLAGS ARE ON                        @Y30LB33*/ 02839000
*   /*                                                               */ 02840000
*   /*****************************************************************/ 02841000
*                                                                  0847 02842000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 02843000
         L     @04,DDSTRU                                          0847 02844000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0847 02845000
*   DARGSMOD=MODLV0;                /*                       @Y30LB33*/ 02846000
         MVC   DARGSMOD(3,@04),@CC02396                            0848 02847000
*   IF BASIVCRE=ON THEN                                            0849 02848000
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0849 02849000
         BNO   @RF00849                                            0849 02850000
*     DO;                           /* INCOMPLETE CREATE     @Y30LB33*/ 02851000
*       DARGSENT=INCREMSG;          /*                       @Y30LB33*/ 02852000
         MVI   DARGSENT(@04),X'0B'                                 0851 02853000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02854000
         L     @04,@PC00001                                        0852 02855000
         ST    @04,@AL00001                                        0852 02856000
         LA    @03,PRINTME                                         0852 02857000
         ST    @03,@AL00001+4                                      0852 02858000
         LA    @03,DDSTRU                                          0852 02859000
         ST    @03,@AL00001+8                                      0852 02860000
         MVI   @AL00001+8,X'80'                                    0852 02861000
         L     @15,GDTPRT(,@04)                                    0852 02862000
         LA    @01,@AL00001                                        0852 02863000
         BALR  @14,@15                                             0852 02864000
*     END;                          /*                       @Y30LB33*/ 02865000
*   IF BASIVCPY=ON THEN                                            0854 02866000
@RF00849 TM    BASIVCPY(BASEVPTR),B'01000000'                      0854 02867000
         BNO   @RF00854                                            0854 02868000
*     DO;                           /* INCOMPLETE COPY       @Y30LB33*/ 02869000
*       DARGSENT=INCPYMSG;          /*                       @Y30LB33*/ 02870000
         L     @04,DDSTRU                                          0856 02871000
         MVI   DARGSENT(@04),X'0A'                                 0856 02872000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02873000
         L     @04,@PC00001                                        0857 02874000
         ST    @04,@AL00001                                        0857 02875000
         LA    @03,PRINTME                                         0857 02876000
         ST    @03,@AL00001+4                                      0857 02877000
         LA    @03,DDSTRU                                          0857 02878000
         ST    @03,@AL00001+8                                      0857 02879000
         MVI   @AL00001+8,X'80'                                    0857 02880000
         L     @15,GDTPRT(,@04)                                    0857 02881000
         LA    @01,@AL00001                                        0857 02882000
         BALR  @14,@15                                             0857 02883000
*     END;                          /*                       @Y30LB33*/ 02884000
*   IF BASVSMIS=ON THEN                                            0859 02885000
@RF00854 TM    BASVSMIS(BASEVPTR),B'00100000'                      0859 02886000
         BNO   @RF00859                                            0859 02887000
*     DO;                           /* LABEL MISMATCH        @Y30LB33*/ 02888000
*       DARGSENT=LBMISMSG;          /*                       @Y30LB33*/ 02889000
         L     @04,DDSTRU                                          0861 02890000
         MVI   DARGSENT(@04),X'0C'                                 0861 02891000
*       DARGDBP=ADDR(BASRECOV);     /*                       @Y30LB33*/ 02892000
         LA    @03,BASRECOV(,BASEVPTR)                             0862 02893000
         ST    @03,DARGDBP(,@04)                                   0862 02894000
*       DARGILP=6;                  /*                       @Y30LB33*/ 02895000
         MVC   DARGILP(2,@04),@CH00159                             0863 02896000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 02897000
         L     @04,@PC00001                                        0864 02898000
         ST    @04,@AL00001                                        0864 02899000
         LA    @03,PRINTME                                         0864 02900000
         ST    @03,@AL00001+4                                      0864 02901000
         LA    @03,DDSTRU                                          0864 02902000
         ST    @03,@AL00001+8                                      0864 02903000
         MVI   @AL00001+8,X'80'                                    0864 02904000
         L     @15,GDTPRT(,@04)                                    0864 02905000
         LA    @01,@AL00001                                        0864 02906000
         BALR  @14,@15                                             0864 02907000
*     END;                          /*                       @Y30LB33*/ 02908000
*                                                                  0866 02909000
*   /*****************************************************************/ 02910000
*   /*                                                               */ 02911000
*   /* TEST FOR VOLUME TYPE AND ADD TO THE PROPER FIELD      @Y30LB33*/ 02912000
*   /* IN THE SUMMARY TABLE                                  @Y30LB33*/ 02913000
*   /*                                                               */ 02914000
*   /*****************************************************************/ 02915000
*                                                                  0866 02916000
*   IF BCDDUP=ON THEN                                              0866 02917000
@RF00859 L     @04,BCDVPTR                                         0866 02918000
         TM    BCDDUP(@04),B'00000100'                             0866 02919000
         BNO   @RF00866                                            0866 02920000
*     SUMDUP=SUMDUP+1;              /*                       @Y30LB33*/ 02921000
         LA    @04,1                                               0867 02922000
         AL    @04,SUMDUP                                          0867 02923000
         ST    @04,SUMDUP                                          0867 02924000
*   ELSE                                                           0868 02925000
*     DO;                           /*                       @Y30LB33*/ 02926000
         B     @RC00866                                            0868 02927000
@RF00866 DS    0H                                                  0869 02928000
*       IF BASHOLD=OFF THEN         /*                       @ZDR2056*/ 02929000
         TM    BASHOLD(BASEVPTR),B'10000000'                       0869 02930000
         BNZ   @RF00869                                            0869 02931000
*         SUMVOL=SUMVOL+1;          /* BUMP VOLUME COUNT     @YM04312*/ 02932000
         LA    @04,1                                               0870 02933000
         AL    @04,SUMVOL                                          0870 02934000
         ST    @04,SUMVOL                                          0870 02935000
*       IF BASINAC=ON THEN                                         0871 02936000
@RF00869 TM    BASINAC(BASEVPTR),B'00000100'                       0871 02937000
         BNO   @RF00871                                            0871 02938000
*         SUMIVOL=SUMIVOL+1;        /*                       @Y30LB33*/ 02939000
         LA    @04,1                                               0872 02940000
         AL    @04,SUMIVOL                                         0872 02941000
         ST    @04,SUMIVOL                                         0872 02942000
*       ELSE                                                       0873 02943000
*         DO;                       /*                       @Y30LB33*/ 02944000
         B     @RC00871                                            0873 02945000
@RF00871 DS    0H                                                  0874 02946000
*           IF BASGENUS=ON THEN                                    0874 02947000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0874 02948000
         BNO   @RF00874                                            0874 02949000
*             SUMGVOL=SUMGVOL+1;    /*                       @Y30LB33*/ 02950000
         LA    @04,1                                               0875 02951000
         AL    @04,SUMGVOL                                         0875 02952000
         ST    @04,SUMGVOL                                         0875 02953000
*           IF BASRSTD=ON THEN                                     0876 02954000
@RF00874 TM    BASRSTD(BASEVPTR),B'00001000'                       0876 02955000
         BNO   @RF00876                                            0876 02956000
*             SUMRVOL=SUMRVOL+1;    /*                       @Y30LB33*/ 02957000
         LA    @04,1                                               0877 02958000
         AL    @04,SUMRVOL                                         0877 02959000
         ST    @04,SUMRVOL                                         0877 02960000
*         END;                      /*                       @Y30LB33*/ 02961000
@RF00876 DS    0H                                                  0879 02962000
*     END;                          /*                       @Y30LB33*/ 02963000
@RC00871 DS    0H                                                  0880 02964000
*   MAINCTR=MAINCTR+1;              /*                       @Y30LB33*/ 02965000
*                                                                  0880 02966000
@RC00866 LA    @04,1                                               0880 02967000
         AL    @04,MAINCTR                                         0880 02968000
         ST    @04,MAINCTR                                         0880 02969000
*   /*****************************************************************/ 02970000
*   /*                                                               */ 02971000
*   /* RETURN WITH A ZERO CODE                               @Y30LB33*/ 02972000
*   /*                                                               */ 02973000
*   /*****************************************************************/ 02974000
*                                                                  0881 02975000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 02976000
         SLR   @15,@15                                             0881 02977000
@EL00010 DS    0H                                                  0881 02978000
@EF00010 DS    0H                                                  0881 02979000
@ER00010 L     @14,@SA00010                                        0881 02980000
         BR    @14                                                 0881 02981000
*   END VOLPRNT;                    /*                       @Y30LB33*/ 02982000
*                                                                  0883 02983000
*   /*****************************************************************/ 02984000
*   /*                                                               */ 02985000
*   /* PROCEDURE NAME - VOLRDR                               @Y30LB33*/ 02986000
*   /*                                                       @Y30LB33*/ 02987000
*   /* FUNCTION - TO CALL DIRECTRD TO READ A VOLUME OR A     @ZA27752*/ 02988000
*   /* DUPLICATE VOLUME RECORD USING THE REQUEST             @Y30LB33*/ 02989000
*   /* BLOCK PASSED AS INPUT, AND TEST FOR ERRORS            @Y30LB33*/ 02990000
*   /* FROM THE READ. IF ERRORS OCCUR, PRINT THE             @Y30LB33*/ 02991000
*   /* APPROPRIATE MESSAGES AND SET THE RETURN               @Y30LB33*/ 02992000
*   /* AND CONDITION CODES TO INDICATE THE                   @Y30LB33*/ 02993000
*   /* SEVERITY OF THE ERROR.                                @Y30LB33*/ 02994000
*   /*                                                       @Y30LB33*/ 02995000
*   /* INPUT - COMPLETED REQUEST BLOCK TO READ THE RECORD    @Y30LB33*/ 02996000
*   /*                                                       @Y30LB33*/ 02997000
*   /* OUTPUT - RETURN CODE OF ZERO AND LASTCOND OF ZERO     @Y30LB33*/ 02998000
*   /* FOR NORMAL PROCESSING. RETURN CODE OF 4 AND           @Y30LB33*/ 02999000
*   /* LASTCOND OF 8 FOR VOLUME-NOT-FOUND ON A               @Y30LB33*/ 03000000
*   /* READ-DIRECT. RETURN CODE OF 4 AND LASTCOND            @Y30LB33*/ 03001000
*   /* OF ZERO FOR END-OF-RECORDS OR                         @Y30LB33*/ 03002000
*   /* END-OF-CHAIN. RETURN CODE OF 16 AND LASTCOND          @Y30LB33*/ 03003000
*   /* OF 8 FOR TERMINATING ERROR.                           @Y30LB33*/ 03004000
*   /*                                                               */ 03005000
*   /*****************************************************************/ 03006000
*                                                                  0883 03007000
*VOLRDR:                                                           0883 03008000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 03009000
VOLRDR   ST    @14,@SA00011                                        0883 03010000
*   OLDERID2=NEWERID2;                                             0884 03011000
         L     @04,@PC00001                                        0884 03012000
         L     @03,GDTTR2(,@04)                                    0884 03013000
         MVC   @TS00001(95),NEWERID2(@03)                          0884 03014000
         MVC   OLDERID2(95,@03),@TS00001                           0884 03015000
*   NEWID2='LVKA';                  /*                       @Y30LB33*/ 03016000
         MVC   NEWID2(4,@03),@CC02499                              0885 03017000
*   TESTRC=0;                       /*                       @Y30LB33*/ 03018000
*                                                                  0886 03019000
         SLR   TESTRC,TESTRC                                       0886 03020000
*   /*****************************************************************/ 03021000
*   /*                                                               */ 03022000
*   /* CALL DIRECTRD WITH THE IEZRVVI REQUEST BLOCK TO       @ZA27752*/ 03023000
*   /* READ THE VOLUME RECORD. THE REQUEST BLOCK HAS         @Y30LB33*/ 03024000
*   /* BEEN FILLED IN BY PREVIOUS PROCEDURES                 @Y30LB33*/ 03025000
*   /*                                                               */ 03026000
*   /*****************************************************************/ 03027000
*                                                                  0887 03028000
*   IF GDTDBG=NULLPTR THEN                                         0887 03029000
         L     @06,GDTDBG(,@04)                                    0887 03030000
         LTR   @06,@06                                             0887 03031000
         BZ    @RT00887                                            0887 03032000
*     ;                                                            0888 03033000
*   ELSE                                                           0889 03034000
*     DO;                                                          0889 03035000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 03036000
         LA    DMPINDEX,DUMPAREA                                   0890 03037000
*       DMPITMNM='RVVI';                                           0891 03038000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0891 03039000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0891 03040000
         MVC   DMPITMNM(4,DMPINDEX),@CC02500                       0891 03041000
*       DMPITMPT=ADDR(RVVI);                                       0892 03042000
         ST    RVVIPTR,DMPITMPT(,DMPINDEX)                         0892 03043000
*       DMPITMLN=RVVLEN;                                           0893 03044000
         LH    @06,RVVLEN                                          0893 03045000
         STH   @06,DMPITMLN(,DMPINDEX)                             0893 03046000
*       DMPITMTP='H';                                              0894 03047000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0894 03048000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0895 03049000
*                                                                  0895 03050000
         AL    DMPINDEX,@CF00507                                   0895 03051000
*       /*************************************************************/ 03052000
*       /*                                                           */ 03053000
*       /*                                                   @Y30LB33*/ 03054000
*       /*                                                           */ 03055000
*       /*************************************************************/ 03056000
*                                                                  0896 03057000
*       DMPTRM=DMPTRMVL;                                           0896 03058000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0896 03059000
*     END;                          /*                       @Y30LB33*/ 03060000
*   IF GDTDBG=NULLPTR THEN                                         0898 03061000
@RT00887 L     @06,@PC00001                                        0898 03062000
         L     @06,GDTDBG(,@06)                                    0898 03063000
         LTR   @06,@06                                             0898 03064000
         BZ    @RT00898                                            0898 03065000
*     ;                                                            0899 03066000
*   ELSE                                                           0900 03067000
*     CALL IDCDB010(GDTTBL,'LVKB',DUMPADDR);/*               @Y30LB33*/ 03068000
         L     @06,@PC00001                                        0900 03069000
         ST    @06,@AL00001                                        0900 03070000
         LA    @04,@CC02502                                        0900 03071000
         ST    @04,@AL00001+4                                      0900 03072000
         LA    @04,DUMPADDR                                        0900 03073000
         ST    @04,@AL00001+8                                      0900 03074000
         MVI   @AL00001+8,X'80'                                    0900 03075000
         L     @15,GDTDBG(,@06)                                    0900 03076000
         LA    @01,@AL00001                                        0900 03077000
         BALR  @14,@15                                             0900 03078000
*   CALL DIRECTRD;                  /*                       @ZA27752*/ 03079000
@RT00898 BAL   @14,DIRECTRD                                        0901 03080000
*   RESPECIFY                                                      0902 03081000
*     RTNREG RSTD;                                                 0902 03082000
*   TESTRC=RTNREG;                                                 0903 03083000
         LR    TESTRC,RTNREG                                       0903 03084000
*   RESPECIFY                                                      0904 03085000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 03086000
*                                                                  0905 03087000
*   /*****************************************************************/ 03088000
*   /*                                                               */ 03089000
*   /* TEST THE RETURN CODE AND RETURN REASONS               @Y30LB33*/ 03090000
*   /* AND PRINT APPROPRIATE MESSAGES                        @Y30LB33*/ 03091000
*   /*                                                               */ 03092000
*   /*****************************************************************/ 03093000
*                                                                  0905 03094000
*   SETRC=0;                        /* INITIALIZE THE CODE HOLD AREA    03095000
*                                                            @Y30LB33*/ 03096000
         SLR   @04,@04                                             0905 03097000
         STH   @04,SETRC                                           0905 03098000
*   IF TESTRC=4 THEN                                               0906 03099000
         C     TESTRC,@CF00043                                     0906 03100000
         BNE   @RF00906                                            0906 03101000
*     DO;                           /* TEST FOR PROBLEM      @Y30LB33*/ 03102000
*                                                                  0907 03103000
*       /*************************************************************/ 03104000
*       /*                                                           */ 03105000
*       /* IF WE ARE READING DIRECT AND NOT READING A        @Y30LB33*/ 03106000
*       /* DUPLICATE AND WE GET A NOT-FOUND CONDITION, CALL  @Y30LB33*/ 03107000
*       /* SSCMSG TO PRINT THE REASON , PRINT IDC2080I TO    @Y30LB33*/ 03108000
*       /* INDICATE VOLUME-NOT-FOUND, SET THE RETURN         @Y30LB33*/ 03109000
*       /* CODE TO 4 AND LASTCOND TO 8                       @Y30LB33*/ 03110000
*       /*                                                           */ 03111000
*       /*************************************************************/ 03112000
*                                                                  0908 03113000
*       IF RVVRDR=ON&REASON=NOTFOUND/*                       @Y30LB33*/ 03114000
*           &RVVDUPRC=OFF THEN                                     0908 03115000
         TM    RVVRDR(RVVIPTR),B'10000000'                         0908 03116000
         BNO   @RF00908                                            0908 03117000
         CLC   REASON(4),@CF02312                                  0908 03118000
         BNE   @RF00908                                            0908 03119000
         TM    RVVDUPRC(RVVIPTR),B'00010000'                       0908 03120000
         BNZ   @RF00908                                            0908 03121000
*         DO;                       /*                       @Y30LB33*/ 03122000
*           CALL SSCMSG(REASON);    /*                       @Y30LB33*/ 03123000
         LA    @06,REASON                                          0910 03124000
         ST    @06,@AL00001                                        0910 03125000
         LA    @01,@AL00001                                        0910 03126000
         BAL   @14,SSCMSG                                          0910 03127000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 03128000
         L     @06,DDSTRU                                          0911 03129000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0911 03130000
*           DARGDBP=ADDR(RVVOLUME); /*                       @Y30LB33*/ 03131000
         LA    @04,RVVOLUME(,RVVIPTR)                              0912 03132000
         ST    @04,DARGDBP(,@06)                                   0912 03133000
*           DARGILP=LENGTH(RVVOLUME);/*                      @Y30LB33*/ 03134000
         MVC   DARGILP(2,@06),@CH00159                             0913 03135000
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/ 03136000
         MVC   DARGSMOD(3,@06),@CC02400                            0914 03137000
*           DARGSENT=MSG2080I;      /*                       @Y30LB33*/ 03138000
         MVI   DARGSENT(@06),X'1A'                                 0915 03139000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/ 03140000
         L     @06,@PC00001                                        0916 03141000
         ST    @06,@AL00001                                        0916 03142000
         LA    @04,@CF00117                                        0916 03143000
         ST    @04,@AL00001+4                                      0916 03144000
         LA    @04,DDSTRU                                          0916 03145000
         ST    @04,@AL00001+8                                      0916 03146000
         MVI   @AL00001+8,X'80'                                    0916 03147000
         L     @15,GDTPRT(,@06)                                    0916 03148000
         LA    @01,@AL00001                                        0916 03149000
         BALR  @14,@15                                             0916 03150000
*           SETRC=4;                /*                       @Y30LB33*/ 03151000
         MVC   SETRC(2),@CH00043                                   0917 03152000
*           LASTCOND=LASTCC08;      /*                       @Y30LB33*/ 03153000
         L     @06,@PC00001+8                                      0918 03154000
         MVC   LASTCOND(2,@06),@CH00035                            0918 03155000
*         END;                      /*                       @Y30LB33*/ 03156000
*                                                                  0919 03157000
*       /*************************************************************/ 03158000
*       /*                                                           */ 03159000
*       /* IF WE ARE READING DIRECT AND READING              @Y30LB33*/ 03160000
*       /* DUPLICATES AND WE GET A NOT-FOUND                 @Y30LB33*/ 03161000
*       /* CONDITION, SET THE RETURN CODE TO 4               @Y30LB33*/ 03162000
*       /*                                                           */ 03163000
*       /*************************************************************/ 03164000
*                                                                  0920 03165000
*       IF RVVRDR=ON&RVVDUPRC=ON&   /*                       @Y30LB33*/ 03166000
*           REASON=NOTFOUND THEN                                   0920 03167000
@RF00908 TM    RVVRDR(RVVIPTR),B'10000000'                         0920 03168000
         BNO   @RF00920                                            0920 03169000
         TM    RVVDUPRC(RVVIPTR),B'00010000'                       0920 03170000
         BNO   @RF00920                                            0920 03171000
         CLC   REASON(4),@CF02312                                  0920 03172000
         BNE   @RF00920                                            0920 03173000
*         SETRC=4;                  /*                       @Y30LB33*/ 03174000
*                                                                  0921 03175000
         MVC   SETRC(2),@CH00043                                   0921 03176000
*       /*************************************************************/ 03177000
*       /*                                                           */ 03178000
*       /* IF THE READ WAS READ-DIRECT AND THE REASON        @Y30LB33*/ 03179000
*       /* IS DOESN'T-MEET-TESTS, THEN SET RETURN CODE       @Y30LB33*/ 03180000
*       /* TO 4                                              @Y30LB33*/ 03181000
*       /*                                                           */ 03182000
*       /*************************************************************/ 03183000
*                                                                  0922 03184000
*       IF RVVRDR=ON&REASON=TSTNOTMT THEN/*                  @Y30LB33*/ 03185000
@RF00920 TM    RVVRDR(RVVIPTR),B'10000000'                         0922 03186000
         BNO   @RF00922                                            0922 03187000
         CLC   REASON(4),@CF02314                                  0922 03188000
         BNE   @RF00922                                            0922 03189000
*         SETRC=4;                  /*                       @Y30LB33*/ 03190000
*                                                                  0923 03191000
         MVC   SETRC(2),@CH00043                                   0923 03192000
*       /*************************************************************/ 03193000
*       /*                                                           */ 03194000
*       /* IF THE READ WAS READ-NEXT AND THE REASON WAS      @Y30LB33*/ 03195000
*       /* DOESN'T-MEET-TESTS OR NOT-FOUND, THEN SET         @Y30LB33*/ 03196000
*       /* RETURN CODE TO 4                                  @Y30LB33*/ 03197000
*       /*                                                           */ 03198000
*       /*************************************************************/ 03199000
*                                                                  0924 03200000
*       IF RVVRDNR=ON&(REASON=TSTNOTMT|/*                    @Y30LB33*/ 03201000
*           REASON=NOTFOUND) THEN                                  0924 03202000
@RF00922 TM    RVVRDNR(RVVIPTR),B'01000000'                        0924 03203000
         BNO   @RF00924                                            0924 03204000
         L     @06,REASON                                          0924 03205000
         C     @06,@CF02314                                        0924 03206000
         BE    @RT00924                                            0924 03207000
         C     @06,@CF02312                                        0924 03208000
         BNE   @RF00924                                            0924 03209000
@RT00924 DS    0H                                                  0925 03210000
*         SETRC=4;                  /*                       @Y30LB33*/ 03211000
*                                                                  0925 03212000
         MVC   SETRC(2),@CH00043                                   0925 03213000
*       /*************************************************************/ 03214000
*       /*                                                           */ 03215000
*       /* IF THE READ WAS READ-CHAIN AND THE REASON         @Y30LB33*/ 03216000
*       /* WAS DIDN'T-FIND-CHAIN-ENTRY OR BREAK-IN-CHAIN     @Y30LB33*/ 03217000
*       /* AND THIS WAS NOT THE FIRST VOLUME READ,           @ZA00683*/ 03218000
*       /* THEN CALL SSCMSG TO PRINT THE REASON,             @ZA00683*/ 03219000
*       /* PRINT THE CHAIN-BREAK MESSAGE, SET RETURN         @ZA00683*/ 03220000
*       /* CODE TO 4 AND THE LASTCOND TO 8.                  @ZA00683*/ 03221000
*       /* IF THE FIRST VOLUME IS NOT FOUND, IT IS SIMPLY    @ZA00683*/ 03222000
*       /* THE CASE THAT NO NON-GROUPED VOLUMES EXIST        @ZA00683*/ 03223000
*       /* SO WE PRINT MESSAGE IDC0832I.                     @ZA00683*/ 03224000
*       /*                                                           */ 03225000
*       /*************************************************************/ 03226000
*                                                                  0926 03227000
*       IF RVVRDCH=ON&(REASON=NOTFOUND|/*                    #Y30LB33*/ 03228000
*           REASON=BADCHAIN) THEN   /*                       @ZA00683*/ 03229000
@RF00924 TM    RVVRDCH(RVVIPTR),B'00100000'                        0926 03230000
         BNO   @RF00926                                            0926 03231000
         L     @06,REASON                                          0926 03232000
         C     @06,@CF02312                                        0926 03233000
         BE    @RT00926                                            0926 03234000
         C     @06,@CF02316                                        0926 03235000
         BNE   @RF00926                                            0926 03236000
@RT00926 DS    0H                                                  0927 03237000
*         DO;                       /*                       @ZA00683*/ 03238000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @ZA00683*/ 03239000
         L     @06,DDSTRU                                          0928 03240000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0928 03241000
*           DARGSMOD=MODLV0;        /*                       @ZA00683*/ 03242000
         MVC   DARGSMOD(3,@06),@CC02396                            0929 03243000
*           IF RVVSVOL=ON THEN                                     0930 03244000
         TM    RVVSVOL(RVVIPTR),B'00000001'                        0930 03245000
         BNO   @RF00930                                            0930 03246000
*             DO;                   /*                       @ZA00683*/ 03247000
*               CALL SSCMSG(REASON);/*                       @ZA00683*/ 03248000
         LA    @06,REASON                                          0932 03249000
         ST    @06,@AL00001                                        0932 03250000
         LA    @01,@AL00001                                        0932 03251000
         BAL   @14,SSCMSG                                          0932 03252000
*               DARGSENT=MSG2831I;  /*                       @ZA00683*/ 03253000
         L     @06,DDSTRU                                          0933 03254000
         MVI   DARGSENT(@06),X'1F'                                 0933 03255000
*               LASTCOND=LASTCC08;  /*                       @ZA00683*/ 03256000
         L     @06,@PC00001+8                                      0934 03257000
         MVC   LASTCOND(2,@06),@CH00035                            0934 03258000
*             END;                  /*                       @ZA00683*/ 03259000
*           ELSE                                                   0936 03260000
*             DARGSENT=MSG0832I;    /*                       @ZA00683*/ 03261000
         B     @RC00930                                            0936 03262000
@RF00930 L     @06,DDSTRU                                          0936 03263000
         MVI   DARGSENT(@06),X'20'                                 0936 03264000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          #Y30LB33*/ 03265000
@RC00930 L     @06,@PC00001                                        0937 03266000
         ST    @06,@AL00001                                        0937 03267000
         LA    @04,@CF00117                                        0937 03268000
         ST    @04,@AL00001+4                                      0937 03269000
         LA    @04,DDSTRU                                          0937 03270000
         ST    @04,@AL00001+8                                      0937 03271000
         MVI   @AL00001+8,X'80'                                    0937 03272000
         L     @15,GDTPRT(,@06)                                    0937 03273000
         LA    @01,@AL00001                                        0937 03274000
         BALR  @14,@15                                             0937 03275000
*           SETRC=4;                /*                       #Y30LB33*/ 03276000
         MVC   SETRC(2),@CH00043                                   0938 03277000
*         END;                      /*                       #Y30LB33*/ 03278000
*                                                                  0939 03279000
*       /*************************************************************/ 03280000
*       /*                                                           */ 03281000
*       /* IF THE READ WAS READ-CHAIN AND THE REASON WAS     #Y30LB33*/ 03282000
*       /* DOESN'T-MEET-TESTS THEN SET RETURN CODE TO 4      #Y30LB33*/ 03283000
*       /*                                                           */ 03284000
*       /*************************************************************/ 03285000
*                                                                  0940 03286000
*       IF RVVRDCH=ON&REASON=TSTNOTMT THEN/*                 #Y30LB33*/ 03287000
@RF00926 TM    RVVRDCH(RVVIPTR),B'00100000'                        0940 03288000
         BNO   @RF00940                                            0940 03289000
         CLC   REASON(4),@CF02314                                  0940 03290000
         BNE   @RF00940                                            0940 03291000
*         SETRC=4;                  /*                       #Y30LB33*/ 03292000
*                                                                  0941 03293000
         MVC   SETRC(2),@CH00043                                   0941 03294000
*       /*************************************************************/ 03295000
*       /*                                                           */ 03296000
*       /* OTHERWISE, CALL SSCMSG TO PRINT THE               #Y30LB33*/ 03297000
*       /* REASON RETURNED AND THEN                          #Y30LB33*/ 03298000
*       /* SET THE RETURN CODE TO 16 TO INDICATE             #Y30LB33*/ 03299000
*       /* A TERMINATION ERROR                               #Y30LB33*/ 03300000
*       /*                                                           */ 03301000
*       /*************************************************************/ 03302000
*                                                                  0942 03303000
*       IF SETRC=0 THEN                                            0942 03304000
@RF00940 LH    @06,SETRC                                           0942 03305000
         LTR   @06,@06                                             0942 03306000
         BNZ   @RF00942                                            0942 03307000
*         DO;                       /*                       #Y30LB33*/ 03308000
*           LASTCOND=LASTCC08;      /*                       #Y30LB33*/ 03309000
         L     @06,@PC00001+8                                      0944 03310000
         MVC   LASTCOND(2,@06),@CH00035                            0944 03311000
*           SETRC=16;               /*                       #Y30LB33*/ 03312000
         MVC   SETRC(2),@CH00507                                   0945 03313000
*           CALL SSCMSG(REASON);    /*                       #Y30LB33*/ 03314000
         LA    @06,REASON                                          0946 03315000
         ST    @06,@AL00001                                        0946 03316000
         LA    @01,@AL00001                                        0946 03317000
         BAL   @14,SSCMSG                                          0946 03318000
*         END;                      /*                       #Y30LB33*/ 03319000
*     END;                          /*                       #Y30LB33*/ 03320000
*                                                                  0948 03321000
@RF00942 DS    0H                                                  0949 03322000
*   /*****************************************************************/ 03323000
*   /*                                                               */ 03324000
*   /* RETURN WITH THE CODE SET ABOVE                        #Y30LB33*/ 03325000
*   /*                                                               */ 03326000
*   /*****************************************************************/ 03327000
*                                                                  0949 03328000
*   RETURN CODE(SETRC);             /*                       @Y30LB33*/ 03329000
@RF00906 LH    @15,SETRC                                           0949 03330000
@EL00011 DS    0H                                                  0949 03331000
@EF00011 DS    0H                                                  0949 03332000
@ER00011 L     @14,@SA00011                                        0949 03333000
         BR    @14                                                 0949 03334000
*   END VOLRDR;                     /*                       @Y30LB33*/ 03335000
*                                                                  0951 03336000
*   /*****************************************************************/ 03337000
*   /*                                                               */ 03338000
*   /* PROCEDURE NAME - CPYPROC                              @Y30LB33*/ 03339000
*   /*                                                       @Y30LB33*/ 03340000
*   /* FUNCTION - READ AND PRINT COPIES OF A VOLUME          @Y30LB33*/ 03341000
*   /* TEST FOR ERRORS FROM THE READ, AND CALL               @Y30LB33*/ 03342000
*   /* SSCMSG TO PRINT THE REASON FOR THE                    @Y30LB33*/ 03343000
*   /* ERRORS                                                @Y30LB33*/ 03344000
*   /*                                                       @Y30LB33*/ 03345000
*   /* INPUT - THE VOLUME RECORD                             @Y30LB33*/ 03346000
*   /*                                                       @Y30LB33*/ 03347000
*   /* OUTPUT - RETURN CODE AND LAST COND OF ZERO FOR        @Y30LB33*/ 03348000
*   /* NORMAL PROCESSING. RETURN CODE OF 16 AND              @Y30LB33*/ 03349000
*   /* LASTCOND OF 8 FOR A TERMINATION ERROR                 @Y30LB33*/ 03350000
*   /*                                                               */ 03351000
*   /*****************************************************************/ 03352000
*                                                                  0951 03353000
*CPYPROC:                                                          0951 03354000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 03355000
*                                                                  0951 03356000
CPYPROC  ST    @14,@SA00012                                        0951 03357000
*   /*****************************************************************/ 03358000
*   /*                                                               */ 03359000
*   /* LOCAL WORK AREAS                                      @Y30LB33*/ 03360000
*   /*                                                               */ 03361000
*   /*****************************************************************/ 03362000
*                                                                  0952 03363000
*   DCL                                                            0952 03364000
*     VOLRPTR PTR(31);              /* REQ BLOCK ADDR HOLDER @Y30LB33*/ 03365000
*   OLDERID2=NEWERID2;                                             0953 03366000
         L     @04,@PC00001                                        0953 03367000
         L     @04,GDTTR2(,@04)                                    0953 03368000
         MVC   @TS00001(95),NEWERID2(@04)                          0953 03369000
         MVC   OLDERID2(95,@04),@TS00001                           0953 03370000
*   NEWID2='LVLA';                  /*                       @Y30LB33*/ 03371000
         MVC   NEWID2(4,@04),@CC02509                              0954 03372000
*   TESTRC=0;                       /*                       @Y30LB33*/ 03373000
         SLR   TESTRC,TESTRC                                       0955 03374000
*   SETRC=0;                        /*                       @Y30LB33*/ 03375000
*                                                                  0956 03376000
         SLR   @04,@04                                             0956 03377000
         STH   @04,SETRC                                           0956 03378000
*   /*****************************************************************/ 03379000
*   /*                                                               */ 03380000
*   /* FILL IN THE COPY RECORD READ REQUEST BLOCK            @Y30LB33*/ 03381000
*   /* USING THE DATA IN THE VOLUME REQUEST BLOCK            @Y30LB33*/ 03382000
*   /* AND SET UP TO READ THE FIRST COPY                     @Y30LB33*/ 03383000
*   /*                                                               */ 03384000
*   /*****************************************************************/ 03385000
*                                                                  0957 03386000
*   CPYTRNSQ=1;                     /* SET THE COPY SEQUENCE NUMBER     03387000
*                                                            @Y30LB33*/ 03388000
         MVC   CPYTRNSQ(2),@CH00221                                0957 03389000
*   CPYTRNDT=CPYTRNDT&&CPYTRNDT;    /* CLEAR DATE            @Y30LB33*/ 03390000
         XC    CPYTRNDT(4),CPYTRNDT                                0958 03391000
*   VOLRPTR=RVVIPTR;                /*                       @Y30LB33*/ 03392000
         LR    VOLRPTR,RVVIPTR                                     0959 03393000
*   RVVIPTR=ADDR(CPYRVVI);          /*                       @Y30LB33*/ 03394000
         LA    RVVIPTR,CPYRVVI                                     0960 03395000
*   CPYRVVI=''B;                    /*                       @Y30LB33*/ 03396000
         XC    CPYRVVI(68),CPYRVVI                                 0961 03397000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 03398000
         LH    @03,RVVLEN                                          0962 03399000
         ST    @03,RVVLNGTH(,RVVIPTR)                              0962 03400000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 03401000
         MVI   RVVCODE(RVVIPTR),X'87'                              0963 03402000
*   RVVRTBUF=ADDR(CPYRCDBF);        /*                       @Y30LB33*/ 03403000
         LA    @03,CPYRCDBF                                        0964 03404000
         ST    @03,RVVRTBUF(,RVVIPTR)                              0964 03405000
*   RVVBUFLN=LENGTH(COPYV);         /*                       @Y30LB33*/ 03406000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02619                        0965 03407000
*   RVVOLUME=BASSERNO;              /*                       @ZM01007*/ 03408000
         MVC   RVVOLUME(6,RVVIPTR),BASSERNO(BASEVPTR)              0966 03409000
*   RVVSVOL=ON;                     /*                       @Y30LB33*/ 03410000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        0967 03411000
*   RVVCPYID=0;                     /*                       @Y30LB33*/ 03412000
         MVI   RVVCPYID(RVVIPTR),X'00'                             0968 03413000
*   RVVRDNR=ON;                     /*                       @Y30LB33*/ 03414000
         OI    RVVRDNR(RVVIPTR),B'01000000'                        0969 03415000
*   RVVCPYRC=ON;                    /*                       @Y30LB33*/ 03416000
         OI    RVVCPYRC(RVVIPTR),B'00100000'                       0970 03417000
*   RVVSCPY=ON;                     /*                       @Y30LB33*/ 03418000
*                                                                  0971 03419000
         OI    RVVSCPY(RVVIPTR),B'00000100'                        0971 03420000
*   /*****************************************************************/ 03421000
*   /*                                                               */ 03422000
*   /* CHECK FOR PLACE HOLDERS                               @ZDR2056*/ 03423000
*   /*                                                               */ 03424000
*   /*****************************************************************/ 03425000
*                                                                  0972 03426000
*   IF ADDR(PLHD)^=NULLPTR THEN     /*                       @ZDR2056*/ 03427000
         L     @03,@PC00001+4                                      0972 03428000
         C     @04,FDTPTR+92(,@03)                                 0972 03429000
         BE    @RF00972                                            0972 03430000
*     RVVCPLHD=ON;                  /*                       @ZDR2056*/ 03431000
         OI    RVVCPLHD(RVVIPTR),B'00010000'                       0973 03432000
*   ELSE                                                           0974 03433000
*                                                                  0974 03434000
*     /***************************************************************/ 03435000
*     /*                                                             */ 03436000
*     /* RETURN ALL RECORDS                                  @ZDR2056*/ 03437000
*     /*                                                             */ 03438000
*     /***************************************************************/ 03439000
*                                                                  0974 03440000
*     RVVALL=ON;                    /*                       @ZDR2056*/ 03441000
         B     @RC00972                                            0974 03442000
@RF00972 OI    RVVALL(RVVIPTR),B'00000001'                         0974 03443000
*                                                                  0975 03444000
*   /*****************************************************************/ 03445000
*   /*                                                               */ 03446000
*   /* DO THE FOLLOWING READ AND PRINT OPERATIONS UNTIL      @Y30LB33*/ 03447000
*   /* AN ERROR OCCURS OR THE MSVC RETURNS WITH              @Y30LB33*/ 03448000
*   /* END-OF-COPIES                                         @Y30LB33*/ 03449000
*   /*                                                               */ 03450000
*   /*****************************************************************/ 03451000
*                                                                  0975 03452000
*   DO WHILE(TESTRC=0);             /*                       @Y30LB33*/ 03453000
*                                                                  0975 03454000
@RC00972 B     @DE00975                                            0975 03455000
@DL00975 DS    0H                                                  0976 03456000
*     /***************************************************************/ 03457000
*     /*                                                             */ 03458000
*     /* SYMBOLIC DUMP LVLB TO LIST RVVI                     @ZA27752*/ 03459000
*     /*                                                             */ 03460000
*     /***************************************************************/ 03461000
*                                                                  0976 03462000
*     IF GDTDBG=NULLPTR THEN                                       0976 03463000
         L     @06,@PC00001                                        0976 03464000
         L     @06,GDTDBG(,@06)                                    0976 03465000
         LTR   @06,@06                                             0976 03466000
         BZ    @RT00976                                            0976 03467000
*       ;                                                          0977 03468000
*     ELSE                                                         0978 03469000
*       DO;                                                        0978 03470000
*         DMPINDEX=ADDR(DUMPAREA);  /*                       @Y30LB33*/ 03471000
         LA    DMPINDEX,DUMPAREA                                   0979 03472000
*         DMPITMNM='RVVI';                                         0980 03473000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0980 03474000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0980 03475000
         MVC   DMPITMNM(4,DMPINDEX),@CC02500                       0980 03476000
*         DMPITMPT=ADDR(RVVI);                                     0981 03477000
         ST    RVVIPTR,DMPITMPT(,DMPINDEX)                         0981 03478000
*         DMPITMLN=LENGTH(RVVI);                                   0982 03479000
         MVC   DMPITMLN(2,DMPINDEX),@CH02621                       0982 03480000
*         DMPITMTP='H';                                            0983 03481000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0983 03482000
*         DMPINDEX=DMPINDEX+DMPELEMT;                              0984 03483000
*                                                                  0984 03484000
         AL    DMPINDEX,@CF00507                                   0984 03485000
*         /***********************************************************/ 03486000
*         /*                                                         */ 03487000
*         /*                                                 @Y30LB33*/ 03488000
*         /*                                                         */ 03489000
*         /***********************************************************/ 03490000
*                                                                  0985 03491000
*         DMPTRM=DMPTRMVL;                                         0985 03492000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0985 03493000
*       END;                        /*                       @Y30LB33*/ 03494000
*     IF GDTDBG=NULLPTR THEN                                       0987 03495000
@RT00976 L     @06,@PC00001                                        0987 03496000
         L     @06,GDTDBG(,@06)                                    0987 03497000
         LTR   @06,@06                                             0987 03498000
         BZ    @RT00987                                            0987 03499000
*       ;                                                          0988 03500000
*     ELSE                                                         0989 03501000
*       CALL IDCDB010(GDTTBL,'LVLB',DUMPADDR);/*             @Y30LB33*/ 03502000
*                                                                  0989 03503000
         L     @06,@PC00001                                        0989 03504000
         ST    @06,@AL00001                                        0989 03505000
         LA    @04,@CC02510                                        0989 03506000
         ST    @04,@AL00001+4                                      0989 03507000
         LA    @04,DUMPADDR                                        0989 03508000
         ST    @04,@AL00001+8                                      0989 03509000
         MVI   @AL00001+8,X'80'                                    0989 03510000
         L     @15,GDTDBG(,@06)                                    0989 03511000
         LA    @01,@AL00001                                        0989 03512000
         BALR  @14,@15                                             0989 03513000
*     /***************************************************************/ 03514000
*     /*                                                             */ 03515000
*     /* CALL DIRECTRD TO READ COPY RECORD                   @ZA27752*/ 03516000
*     /*                                                             */ 03517000
*     /***************************************************************/ 03518000
*                                                                  0990 03519000
*     CALL DIRECTRD;                /*                       @ZA27752*/ 03520000
@RT00987 BAL   @14,DIRECTRD                                        0990 03521000
*     RESPECIFY                                                    0991 03522000
*       RTNREG RSTD;                                               0991 03523000
*     TESTRC=RTNREG;                                               0992 03524000
         LR    TESTRC,RTNREG                                       0992 03525000
*     RESPECIFY                                                    0993 03526000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 03527000
*                                                                  0993 03528000
*     /***************************************************************/ 03529000
*     /*                                                             */ 03530000
*     /* TEST THE RETURN CODE FOR AN ERROR AND               @Y30LB33*/ 03531000
*     /* CALL SSCMSG IF ONE OCCURS                           @Y30LB33*/ 03532000
*     /*                                                             */ 03533000
*     /***************************************************************/ 03534000
*                                                                  0994 03535000
*     IF TESTRC=4 THEN                                             0994 03536000
         C     TESTRC,@CF00043                                     0994 03537000
         BNE   @RF00994                                            0994 03538000
*       DO;                         /*                       @Y30LB33*/ 03539000
*         IF REASON^=NOTFOUND THEN                                 0996 03540000
         CLC   REASON(4),@CF02312                                  0996 03541000
         BE    @RF00996                                            0996 03542000
*           DO;                     /*                       @Y30LB33*/ 03543000
*             CALL SSCMSG(REASON);  /*                       @Y30LB33*/ 03544000
*                                                                  0998 03545000
         LA    @04,REASON                                          0998 03546000
         ST    @04,@AL00001                                        0998 03547000
         LA    @01,@AL00001                                        0998 03548000
         BAL   @14,SSCMSG                                          0998 03549000
*             /*******************************************************/ 03550000
*             /*                                                     */ 03551000
*             /* PRINT THE MESSAGE IDC2078I IF THE           @YM04304*/ 03552000
*             /* COPY RECORD IS NOT READ AS EXPECTED         @YM04304*/ 03553000
*             /*                                                     */ 03554000
*             /*******************************************************/ 03555000
*                                                                  0999 03556000
*             DARGLIST=DARGLIST&&DARGLIST;/*                 @YM04304*/ 03557000
         L     @04,DDSTRU                                          0999 03558000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0999 03559000
*             DARGDBP=ADDR(RVVOLUME);/*                      @YM04304*/ 03560000
         LA    @03,RVVOLUME(,RVVIPTR)                              1000 03561000
         ST    @03,DARGDBP(,@04)                                   1000 03562000
*             DARGILP=LENGTH(RVVOLUME);/*                    @YM04304*/ 03563000
         MVC   DARGILP(2,@04),@CH00159                             1001 03564000
*             DARGSMOD=MODCMN;      /*                       @YM04304*/ 03565000
         MVC   DARGSMOD(3,@04),@CC02400                            1002 03566000
*             DARGSENT=MSG2078I;    /*                       @YM04304*/ 03567000
         MVI   DARGSENT(@04),X'1C'                                 1003 03568000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @YM04304*/ 03569000
         L     @04,@PC00001                                        1004 03570000
         ST    @04,@AL00001                                        1004 03571000
         LA    @03,@CF00117                                        1004 03572000
         ST    @03,@AL00001+4                                      1004 03573000
         LA    @03,DDSTRU                                          1004 03574000
         ST    @03,@AL00001+8                                      1004 03575000
         MVI   @AL00001+8,X'80'                                    1004 03576000
         L     @15,GDTPRT(,@04)                                    1004 03577000
         LA    @01,@AL00001                                        1004 03578000
         BALR  @14,@15                                             1004 03579000
*             SETRC=16;             /*                       @Y30LB33*/ 03580000
         MVC   SETRC(2),@CH00507                                   1005 03581000
*             LASTCOND=LASTCC08;    /*                       @Y30LB33*/ 03582000
         L     @04,@PC00001+8                                      1006 03583000
         MVC   LASTCOND(2,@04),@CH00035                            1006 03584000
*           END;                    /*                       @Y30LB33*/ 03585000
*       END;                        /*                       @Y30LB33*/ 03586000
@RF00996 DS    0H                                                  1009 03587000
*                                                                  1009 03588000
*     /***************************************************************/ 03589000
*     /*                                                             */ 03590000
*     /* IF NO ERROR AND NOT END-OF-FILE, SET UP             @ZDR2056*/ 03591000
*     /* THE PRINT BUFFER FOR THE COPY RECORD PRINT          @ZDR2056*/ 03592000
*     /*                                                             */ 03593000
*     /***************************************************************/ 03594000
*                                                                  1009 03595000
*     IF TESTRC=0 THEN                                             1009 03596000
@RF00994 LTR   TESTRC,TESTRC                                       1009 03597000
         BNZ   @RF01009                                            1009 03598000
*       DO;                         /*                       @Y30LB33*/ 03599000
*                                                                  1010 03600000
*         /***********************************************************/ 03601000
*         /*                                                         */ 03602000
*         /* SET UP SEQUENCE NUMBER BY BUMPING               @Y30LB33*/ 03603000
*         /* THE COUNTER BY ONE IF THE DATE IS THE           @Y30LB33*/ 03604000
*         /* SAME AS THE LAST ONE READ. SET THE              @Y30LB33*/ 03605000
*         /* COUNTER TO ZERO IF THE DATE IS                  @Y30LB33*/ 03606000
*         /* DIFFERENT FROM THE LAST                         @Y30LB33*/ 03607000
*         /*                                                         */ 03608000
*         /***********************************************************/ 03609000
*                                                                  1011 03610000
*         IF COPDATE=CPYTRNDT       /*                       @Y30LB33*/ 03611000
*           THEN                    /*                       @Y30LB33*/ 03612000
         L     @04,COPYVPTR                                        1011 03613000
         CLC   COPDATE(4,@04),CPYTRNDT                             1011 03614000
         BNE   @RF01011                                            1011 03615000
*           CPYTRNSQ=CPYTRNSQ+1;    /*                       @Y30LB33*/ 03616000
         LH    @04,CPYTRNSQ                                        1012 03617000
         LA    @04,1(,@04)                                         1012 03618000
         STH   @04,CPYTRNSQ                                        1012 03619000
*         ELSE                                                     1013 03620000
*           CPYTRNSQ=1;             /*                       @Y30LB33*/ 03621000
         B     @RC01011                                            1013 03622000
@RF01011 MVC   CPYTRNSQ(2),@CH00221                                1013 03623000
*         CPYTRNDT=COPDATE;         /*                       @Y30LB33*/ 03624000
@RC01011 L     @04,COPYVPTR                                        1014 03625000
         MVC   CPYTRNDT(4),COPDATE(@04)                            1014 03626000
*         CPYTRNST=BLANKS;          /*                       @ZDR2056*/ 03627000
         MVC   CPYTRNST(5),BLANKS                                  1015 03628000
*         DARGLIST=DARGLIST&&DARGLIST;/*                     @Y30LB33*/ 03629000
         L     @03,DDSTRU                                          1016 03630000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1016 03631000
*         DARGDBP=ADDR(CPYAREA);    /*                       @Y30LB33*/ 03632000
         LA    @15,CPYAREA                                         1017 03633000
         ST    @15,DARGDBP(,@03)                                   1017 03634000
*         DARGILP=LENGTH(CPYAREA);  /*                       @Y30LB33*/ 03635000
         MVC   DARGILP(2,@03),@CH02623                             1018 03636000
*         DARGSMOD=MODLV0;          /*                       @Y30LB33*/ 03637000
         MVC   DARGSMOD(3,@03),@CC02396                            1019 03638000
*         DARGSENT=CPYLINE;         /*                       @Y30LB33*/ 03639000
         MVI   DARGSENT(@03),X'08'                                 1020 03640000
*         IF COPBKUP=ON THEN        /*                       @Y30LB33*/ 03641000
         TM    COPBKUP(@04),B'00001000'                            1021 03642000
         BNO   @RF01021                                            1021 03643000
*           CPYTRNTY=BKUPCHAR;      /*                       @Y30LB33*/ 03644000
         MVC   CPYTRNTY(4),BKUPCHAR                                1022 03645000
*         ELSE                                                     1023 03646000
*           CPYTRNTY=COPYCHAR;      /*                       @Y30LB33*/ 03647000
*                                                                  1023 03648000
         B     @RC01021                                            1023 03649000
@RF01021 MVC   CPYTRNTY(4),COPYCHAR                                1023 03650000
*         /***********************************************************/ 03651000
*         /*                                                         */ 03652000
*         /* CHECK FOR A COPY PLACE HOLDER                   @ZDR2056*/ 03653000
*         /*                                                         */ 03654000
*         /***********************************************************/ 03655000
*                                                                  1024 03656000
*         IF COPHOLD=OFF THEN                                      1024 03657000
@RC01021 L     @04,COPYVPTR                                        1024 03658000
         TM    COPHOLD(@04),B'10000000'                            1024 03659000
         BNZ   @RF01024                                            1024 03660000
*           DO;                     /*                       @ZDR2056*/ 03661000
*                                                                  1025 03662000
*             /*******************************************************/ 03663000
*             /*                                                     */ 03664000
*             /* PRINT VOLID FOR PLACEHOLDERS KEYWORD        @ZDR2056*/ 03665000
*             /*                                                     */ 03666000
*             /*******************************************************/ 03667000
*                                                                  1026 03668000
*             COPSERNO=BLANK;       /*                       @ZDR2056*/ 03669000
*                                                                  1026 03670000
         MVI   COPSERNO+1(@04),C' '                                1026 03671000
         MVC   COPSERNO+2(4,@04),COPSERNO+1(@04)                   1026 03672000
         MVI   COPSERNO(@04),C' '                                  1026 03673000
*             /*******************************************************/ 03674000
*             /*                                                     */ 03675000
*             /* SET UP INSERTS FOR THE LOCATION AND         @Y30LB33*/ 03676000
*             /* EJECT DATE FIELDS. IF THE EJECT DATE        @Y30LB33*/ 03677000
*             /* IS NOT NULL, PRINT THE LOCATION             @Y30LB33*/ 03678000
*             /* FIELD OF THE COPY. IF THE EJECT DATE        @Y30LB33*/ 03679000
*             /* IS NULL, PRINT THE MSF ID OF THE            @Y30LB33*/ 03680000
*             /* CARTRIDGE.                                  @Y30LB33*/ 03681000
*             /*                                                     */ 03682000
*             /*******************************************************/ 03683000
*                                                                  1027 03684000
*             IF COPDTREM^='    ' THEN                             1027 03685000
         CLC   COPDTREM(4,@04),@CC02511                            1027 03686000
         BE    @RF01027                                            1027 03687000
*               DO;                 /*                       @Y30LB33*/ 03688000
*                 DARGCNT=DARGCNT+1;/*                       @Y30LB33*/ 03689000
         L     @03,DDSTRU                                          1029 03690000
         LA    @15,1                                               1029 03691000
         LH    @14,DARGCNT(,@03)                                   1029 03692000
         ALR   @14,@15                                             1029 03693000
         STH   @14,DARGCNT(,@03)                                   1029 03694000
*                 DARGINS(DARGCNT)=1;/*                      @Y30LB33*/ 03695000
         SLA   @14,3                                               1030 03696000
         STH   @15,DARGINS-8(@14,@03)                              1030 03697000
*                 DARGINL(DARGCNT)=4;/*                      @Y30LB33*/ 03698000
         LA    @15,4                                               1031 03699000
         STH   @15,DARGINL-8(@14,@03)                              1031 03700000
*                 DARGDTM(DARGCNT)=ADDR(COPDTREM);/*         @Y30LB33*/ 03701000
         LA    @04,COPDTREM(,@04)                                  1032 03702000
         ST    @04,DARGDTM-8(@14,@03)                              1032 03703000
*               END;                /*                       @Y30LB33*/ 03704000
*                                                                  1033 03705000
*             /*******************************************************/ 03706000
*             /*                                                     */ 03707000
*             /* IF THE COPY IS NOT EJECTED, SET UP          @Y30LB33*/ 03708000
*             /* THE MSF IDS IN THE DESTINATION FIELD        @Y30LB33*/ 03709000
*             /* IN THE RECORD                               @Y30LB33*/ 03710000
*             /*                                                     */ 03711000
*             /*******************************************************/ 03712000
*                                                                  1034 03713000
*             ELSE                                                 1034 03714000
*               DO;                 /*                       @Y30LB33*/ 03715000
         B     @RC01027                                            1034 03716000
@RF01027 DS    0H                                                  1035 03717000
*                 IF COPLIB1=NULLFFS THEN/*                  @ZM01010*/ 03718000
         L     @04,COPYVPTR                                        1035 03719000
         CLC   COPLIB1(1,@04),NULLFFS                              1035 03720000
         BNE   @RF01035                                            1035 03721000
*                   COPDEST(1:15)=UNKCHAR;/*                 @ZM01010*/ 03722000
         MVC   COPDEST(15,@04),UNKCHAR                             1036 03723000
*                 ELSE                                             1037 03724000
*                   DO;             /*                       @ZM01010*/ 03725000
         B     @RC01035                                            1037 03726000
@RF01035 DS    0H                                                  1038 03727000
*                     IF COPLIB1=0 THEN/*                    @Y30LB33*/ 03728000
         L     @04,COPYVPTR                                        1038 03729000
         CLI   COPLIB1(@04),0                                      1038 03730000
         BNE   @RF01038                                            1038 03731000
*                       COPDEST(1:15)=MSF0CHAR;/*            @Y30LB33*/ 03732000
         MVC   COPDEST(15,@04),MSF0CHAR                            1039 03733000
*                     IF COPLIB1=1 THEN/*                    @Y30LB33*/ 03734000
@RF01038 L     @04,COPYVPTR                                        1040 03735000
         CLI   COPLIB1(@04),1                                      1040 03736000
         BNE   @RF01040                                            1040 03737000
*                       COPDEST(1:15)=MSF1CHAR;/*            @Y30LB33*/ 03738000
         MVC   COPDEST(15,@04),MSF1CHAR                            1041 03739000
*                   END;            /*                       @ZM01010*/ 03740000
@RF01040 DS    0H                                                  1043 03741000
*                 IF COPLIB2=NULLFFS THEN/*                  @ZM01010*/ 03742000
@RC01035 L     @04,COPYVPTR                                        1043 03743000
         CLC   COPLIB2(1,@04),NULLFFS                              1043 03744000
         BNE   @RF01043                                            1043 03745000
*                   COPDEST(16:30)=UNKCHAR;/*                @ZM01010*/ 03746000
         MVC   COPDEST+15(15,@04),UNKCHAR                          1044 03747000
*                 ELSE                                             1045 03748000
*                   DO;             /*                       @ZM01010*/ 03749000
         B     @RC01043                                            1045 03750000
@RF01043 DS    0H                                                  1046 03751000
*                     IF COPLIB2=0 THEN/*                    @Y30LB33*/ 03752000
         L     @04,COPYVPTR                                        1046 03753000
         CLI   COPLIB2(@04),0                                      1046 03754000
         BNE   @RF01046                                            1046 03755000
*                       COPDEST(16:30)=MSF0CHAR;/*           @Y30LB33*/ 03756000
         MVC   COPDEST+15(15,@04),MSF0CHAR                         1047 03757000
*                     IF COPLIB2=1 THEN/*                    @Y30LB33*/ 03758000
@RF01046 L     @04,COPYVPTR                                        1048 03759000
         CLI   COPLIB2(@04),1                                      1048 03760000
         BNE   @RF01048                                            1048 03761000
*                       COPDEST(16:30)=MSF1CHAR;/*           @Y30LB33*/ 03762000
         MVC   COPDEST+15(15,@04),MSF1CHAR                         1049 03763000
*                   END;            /*                       @ZM01010*/ 03764000
*               END;                /*                       @Y30LB33*/ 03765000
*           END;                    /*                       @ZDR2056*/ 03766000
*                                                                  1052 03767000
*         /***********************************************************/ 03768000
*         /*                                                         */ 03769000
*         /* INIT PLACE HOLDER FIELDS                        @ZDR2056*/ 03770000
*         /*                                                         */ 03771000
*         /***********************************************************/ 03772000
*                                                                  1053 03773000
*         ELSE                                                     1053 03774000
*           DO;                     /*                       @ZDR2056*/ 03775000
         B     @RC01024                                            1053 03776000
@RF01024 DS    0H                                                  1054 03777000
*             CPYTRNST=PHOLDER;     /*                       @ZDR2056*/ 03778000
         MVC   CPYTRNST(5),PHOLDER                                 1054 03779000
*             COPLIB1=BLANK;        /*                       @ZDR2056*/ 03780000
         L     @04,COPYVPTR                                        1055 03781000
         MVI   COPLIB1(@04),X'40'                                  1055 03782000
*             COPLIB2=BLANK;        /*                       @ZDR2056*/ 03783000
         MVI   COPLIB2(@04),X'40'                                  1056 03784000
*             COPCSN1=BLANK;        /*                       @ZDR2056*/ 03785000
         MVI   COPCSN1+1(@04),C' '                                 1057 03786000
         MVC   COPCSN1+2(10,@04),COPCSN1+1(@04)                    1057 03787000
         MVI   COPCSN1(@04),C' '                                   1057 03788000
*             COPCSN2=BLANK;        /*                       @ZDR2056*/ 03789000
         MVI   COPCSN2+1(@04),C' '                                 1058 03790000
         MVC   COPCSN2+2(10,@04),COPCSN2+1(@04)                    1058 03791000
         MVI   COPCSN2(@04),C' '                                   1058 03792000
*             COPDEST=BLANK;        /*                       @ZDR2056*/ 03793000
*                                                                  1059 03794000
         MVI   COPDEST+1(@04),C' '                                 1059 03795000
         MVC   COPDEST+2(28,@04),COPDEST+1(@04)                    1059 03796000
         MVI   COPDEST(@04),C' '                                   1059 03797000
*             /*******************************************************/ 03798000
*             /*                                                     */ 03799000
*             /* PRINT VOLID FOR PLACEHOLDERS KEYWORD        @ZDR2056*/ 03800000
*             /*                                                     */ 03801000
*             /*******************************************************/ 03802000
*                                                                  1060 03803000
*             IF ADDR(PLHD)=NULLPTR THEN                           1060 03804000
         L     @03,@PC00001+4                                      1060 03805000
         L     @03,FDTPTR+92(,@03)                                 1060 03806000
         LTR   @03,@03                                             1060 03807000
         BNZ   @RF01060                                            1060 03808000
*               COPSERNO=BLANK;     /*                       @ZDR2056*/ 03809000
         MVI   COPSERNO+1(@04),C' '                                1061 03810000
         MVC   COPSERNO+2(4,@04),COPSERNO+1(@04)                   1061 03811000
         MVI   COPSERNO(@04),C' '                                  1061 03812000
*           END;                    /*                       @ZDR2056*/ 03813000
*                                                                  1062 03814000
@RF01060 DS    0H                                                  1063 03815000
*         /***********************************************************/ 03816000
*         /*                                                         */ 03817000
*         /* PRINT THE COPY DATA LINES                       @Y30LB33*/ 03818000
*         /*                                                         */ 03819000
*         /***********************************************************/ 03820000
*                                                                  1063 03821000
*         CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*            @Y30LB33*/ 03822000
@RC01024 L     @04,@PC00001                                        1063 03823000
         ST    @04,@AL00001                                        1063 03824000
         LA    @03,PRINTME                                         1063 03825000
         ST    @03,@AL00001+4                                      1063 03826000
         LA    @03,DDSTRU                                          1063 03827000
         ST    @03,@AL00001+8                                      1063 03828000
         MVI   @AL00001+8,X'80'                                    1063 03829000
         L     @15,GDTPRT(,@04)                                    1063 03830000
         LA    @01,@AL00001                                        1063 03831000
         BALR  @14,@15                                             1063 03832000
*                                                                  1064 03833000
*         /***********************************************************/ 03834000
*         /*                                                         */ 03835000
*         /* NOW TEST THE RECOVERY FLAGS AND                 @Y30LB33*/ 03836000
*         /* PRINT THE APPROPRIATE MESSAGES                  @Y30LB33*/ 03837000
*         /*                                                         */ 03838000
*         /***********************************************************/ 03839000
*                                                                  1064 03840000
*         DARGLIST=DARGLIST&&DARGLIST;/*                     @Y30LB33*/ 03841000
         L     @04,DDSTRU                                          1064 03842000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1064 03843000
*         DARGSMOD=MODLV0;          /*                       @Y30LB33*/ 03844000
         MVC   DARGSMOD(3,@04),@CC02396                            1065 03845000
*         IF COPIVCPY=ON THEN                                      1066 03846000
         L     @03,COPYVPTR                                        1066 03847000
         TM    COPIVCPY(@03),B'01000000'                           1066 03848000
         BNO   @RF01066                                            1066 03849000
*           DO;                     /* INCOMPLETE            @Y30LB33   03850000
*                                      COPY                  @Y30LB33*/ 03851000
*             DARGSENT=INCPYCPY;    /*                       @Y30LB33*/ 03852000
         MVI   DARGSENT(@04),X'03'                                 1068 03853000
*             CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*        @Y30LB33*/ 03854000
         L     @04,@PC00001                                        1069 03855000
         ST    @04,@AL00001                                        1069 03856000
         LA    @03,PRINTME                                         1069 03857000
         ST    @03,@AL00001+4                                      1069 03858000
         LA    @03,DDSTRU                                          1069 03859000
         ST    @03,@AL00001+8                                      1069 03860000
         MVI   @AL00001+8,X'80'                                    1069 03861000
         L     @15,GDTPRT(,@04)                                    1069 03862000
         LA    @01,@AL00001                                        1069 03863000
         BALR  @14,@15                                             1069 03864000
*           END;                    /*                       @Y30LB33*/ 03865000
*                                                                  1071 03866000
*         /***********************************************************/ 03867000
*         /*                                                         */ 03868000
*         /* ADD TO THE PRINT COUNTERS                       @Y30LB33*/ 03869000
*         /*                                                         */ 03870000
*         /***********************************************************/ 03871000
*                                                                  1071 03872000
*         MAINCTR=MAINCTR+1;        /*                       @Y30LB33*/ 03873000
@RF01066 LA    @04,1                                               1071 03874000
         L     @03,MAINCTR                                         1071 03875000
         ALR   @03,@04                                             1071 03876000
         ST    @03,MAINCTR                                         1071 03877000
*         IF COPHOLD=OFF THEN       /*                       @ZDR2056*/ 03878000
         L     @03,COPYVPTR                                        1072 03879000
         TM    COPHOLD(@03),B'10000000'                            1072 03880000
         BNZ   @RF01072                                            1072 03881000
*           SUMCPY=SUMCPY+1;        /*                       @Y30LB33*/ 03882000
*                                                                  1073 03883000
         AL    @04,SUMCPY                                          1073 03884000
         ST    @04,SUMCPY                                          1073 03885000
*         /***********************************************************/ 03886000
*         /*                                                         */ 03887000
*         /* NOW GET THE COPY ID OF THE RECORD               @Y30LB33*/ 03888000
*         /* JUST PROCESSED AND PUT IT IN THE                @Y30LB33*/ 03889000
*         /* REQUEST BLOCK SO THAT THE READ                  @Y30LB33*/ 03890000
*         /* REQUEST FINDS THE NEXT RECORD                   @Y30LB33*/ 03891000
*         /*                                                         */ 03892000
*         /***********************************************************/ 03893000
*                                                                  1074 03894000
*         RVVCPYID=COPNO;           /*                       @Y30LB33*/ 03895000
@RF01072 L     @04,COPYVPTR                                        1074 03896000
         IC    @03,COPNO(,@04)                                     1074 03897000
         STC   @03,RVVCPYID(,RVVIPTR)                              1074 03898000
*       END;                        /*                       @Y30LB33*/ 03899000
*   END;                            /* END OF THE READ AND PRINT   1076 03900000
*                                                            @Y30LB33*/ 03901000
@RF01009 DS    0H                                                  1076 03902000
@DE00975 LTR   TESTRC,TESTRC                                       1076 03903000
         BZ    @DL00975                                            1076 03904000
*   CPYTRNDT=' ';                   /*                       @Y30LB33*/ 03905000
         MVI   CPYTRNDT+1,C' '                                     1077 03906000
         MVC   CPYTRNDT+2(2),CPYTRNDT+1                            1077 03907000
         MVI   CPYTRNDT,C' '                                       1077 03908000
*   RETURN CODE(SETRC);             /*                       @Y30LB33*/ 03909000
         LH    @15,SETRC                                           1078 03910000
@EL00012 DS    0H                                                  1078 03911000
@EF00012 DS    0H                                                  1078 03912000
@ER00012 L     @14,@SA00012                                        1078 03913000
         BR    @14                                                 1078 03914000
*   END CPYPROC;                    /*                       @Y30LB33*/ 03915000
*                                                                  1080 03916000
*   /*****************************************************************/ 03917000
*   /*                                                               */ 03918000
*   /* PROCEDURE NAME - SUMRY                                @Y30LB33*/ 03919000
*   /*                                                       @Y30LB33*/ 03920000
*   /* FUNCTION - PRINT THE SUMMARY REQUESTED                @Y30LB33*/ 03921000
*   /*                                                       @Y30LB33*/ 03922000
*   /* INPUT - SUMMASK AND THE FDTTBL                        @Y30LB33*/ 03923000
*   /*                                                       @Y30LB33*/ 03924000
*   /* OUTPUT - RETURN CODE OF ZERO                          @Y30LB33*/ 03925000
*   /*                                                               */ 03926000
*   /*****************************************************************/ 03927000
*                                                                  1080 03928000
*SUMRY:                                                            1080 03929000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 03930000
SUMRY    ST    @14,@SA00013                                        1080 03931000
*   OLDERID2=NEWERID2;                                             1081 03932000
         L     @05,@PC00001                                        1081 03933000
         L     @05,GDTTR2(,@05)                                    1081 03934000
         MVC   @TS00001(95),NEWERID2(@05)                          1081 03935000
         MVC   OLDERID2(95,@05),@TS00001                           1081 03936000
*   NEWID2='LVMA';                  /*                       @Y30LB33*/ 03937000
         MVC   NEWID2(4,@05),@CC02515                              1082 03938000
*   TESTRC=0;                       /*                       @Y30LB33*/ 03939000
*                                                                  1083 03940000
         SLR   TESTRC,TESTRC                                       1083 03941000
*   /*****************************************************************/ 03942000
*   /*                                                               */ 03943000
*   /* TEST THE MAIN COUNTER TO SEE IF THERE IS              @Y30LB33*/ 03944000
*   /* ANYTHING TO PRINT                                     @Y30LB33*/ 03945000
*   /*                                                               */ 03946000
*   /*****************************************************************/ 03947000
*                                                                  1084 03948000
*   IF MAINCTR>0 THEN                                              1084 03949000
         L     @05,MAINCTR                                         1084 03950000
         LTR   @05,@05                                             1084 03951000
         BNP   @RF01084                                            1084 03952000
*     DO;                           /*                       @Y30LB33*/ 03953000
*                                                                  1085 03954000
*       /*************************************************************/ 03955000
*       /*                                                           */ 03956000
*       /* SET UP THE DARGLIST TO DO THE PRINTING            @Y30LB33*/ 03957000
*       /*                                                           */ 03958000
*       /*************************************************************/ 03959000
*                                                                  1086 03960000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 03961000
         L     @05,DDSTRU                                          1086 03962000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1086 03963000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 03964000
         MVC   DARGSMOD(3,@05),@CC02396                            1087 03965000
*       DARGDBP=ADDR(SUMTBL);       /*                       @Y30LB33*/ 03966000
         LA    @15,SUMTBL                                          1088 03967000
         ST    @15,DARGDBP(,@05)                                   1088 03968000
*       DARGILP=LENGTH(SUMTBL);     /*                       @Y30LB33*/ 03969000
*                                                                  1089 03970000
         MVC   DARGILP(2,@05),@CH02164                             1089 03971000
*       /*************************************************************/ 03972000
*       /*                                                           */ 03973000
*       /* TEST FOR AND SET UP A GROUP SUMMARY               @Y30LB33*/ 03974000
*       /*                                                           */ 03975000
*       /*************************************************************/ 03976000
*                                                                  1090 03977000
*       IF SUMMASK=GRPSUMM THEN                                    1090 03978000
         C     SUMMASK,@CF00221                                    1090 03979000
         BNE   @RF01090                                            1090 03980000
*         DO;                       /*                       @Y30LB33*/ 03981000
*           DARGSENT=GRPSUMLN;      /*                       @Y30LB33*/ 03982000
         MVI   DARGSENT(@05),X'15'                                 1092 03983000
*         END;                      /*                       @Y30LB33*/ 03984000
*                                                                  1093 03985000
*       /*************************************************************/ 03986000
*       /*                                                           */ 03987000
*       /* TEST FOR AND SET UP A VOLUME SUMMARY              @Y30LB33*/ 03988000
*       /*                                                           */ 03989000
*       /*************************************************************/ 03990000
*                                                                  1094 03991000
*       IF SUMMASK=VOLSUMM THEN     /*                       @Y30LB33*/ 03992000
@RF01090 C     SUMMASK,@CF00117                                    1094 03993000
         BNE   @RF01094                                            1094 03994000
*         DARGSENT=VOLSUMLN;        /*                       @Y30LB33*/ 03995000
*                                                                  1095 03996000
         L     @05,DDSTRU                                          1095 03997000
         MVI   DARGSENT(@05),X'16'                                 1095 03998000
*       /*************************************************************/ 03999000
*       /*                                                           */ 04000000
*       /* TEST FOR A GROUP AND VOLUME SUMMARY AND           @Y30LB33*/ 04001000
*       /* SET IT UP                                         @Y30LB33*/ 04002000
*       /*                                                           */ 04003000
*       /*************************************************************/ 04004000
*                                                                  1096 04005000
*       IF SUMMASK=GRPVOLSM THEN    /*                       @Y30LB33*/ 04006000
@RF01094 C     SUMMASK,@CF00156                                    1096 04007000
         BNE   @RF01096                                            1096 04008000
*         DARGSENT=GVSUMLN;         /*                       @Y30LB33*/ 04009000
*                                                                  1097 04010000
         L     @05,DDSTRU                                          1097 04011000
         MVI   DARGSENT(@05),X'14'                                 1097 04012000
*       /*************************************************************/ 04013000
*       /*                                                           */ 04014000
*       /* TEST FOR AND SET UP A CARTRIDGE SUMMARY           @Z40LB66*/ 04015000
*       /*                                                           */ 04016000
*       /*************************************************************/ 04017000
*                                                                  1098 04018000
*       IF SUMMASK=CTGSUMM THEN     /*                       @Z40LB66*/ 04019000
@RF01096 C     SUMMASK,@CF00165                                    1098 04020000
         BNE   @RF01098                                            1098 04021000
*         DARGSENT=CTGSUMLN;        /*                       @Z40LB66*/ 04022000
*                                                                  1099 04023000
         L     @05,DDSTRU                                          1099 04024000
         MVI   DARGSENT(@05),X'22'                                 1099 04025000
*       /*************************************************************/ 04026000
*       /*                                                           */ 04027000
*       /* PRINT THE SUMMARY LINES                           @Y30LB33*/ 04028000
*       /*                                                           */ 04029000
*       /*************************************************************/ 04030000
*                                                                  1100 04031000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB33*/ 04032000
*                                                                  1100 04033000
@RF01098 L     @05,@PC00001                                        1100 04034000
         ST    @05,@AL00001                                        1100 04035000
         LA    @15,PRINTME                                         1100 04036000
         ST    @15,@AL00001+4                                      1100 04037000
         LA    @15,DDSTRU                                          1100 04038000
         ST    @15,@AL00001+8                                      1100 04039000
         MVI   @AL00001+8,X'80'                                    1100 04040000
         L     @15,GDTPRT(,@05)                                    1100 04041000
         LA    @01,@AL00001                                        1100 04042000
         BALR  @14,@15                                             1100 04043000
*       /*************************************************************/ 04044000
*       /*                                                           */ 04045000
*       /* TEST THE SUMMARY TYPE AND REPORT TYPE             @Y30LB33*/ 04046000
*       /* AND SEE IF WE NEED TO PRINT THE COPY              @Y30LB33*/ 04047000
*       /* RECORD SUMMARY                                    @Y30LB33*/ 04048000
*       /*                                                           */ 04049000
*       /*************************************************************/ 04050000
*                                                                  1101 04051000
*       IF(SUMMASK=VOLSUMM|SUMMASK=GRPVOLSM)/*               @Y30LB33*/ 04052000
*           &ADDR(STAT)>0 THEN                                     1101 04053000
         C     SUMMASK,@CF00117                                    1101 04054000
         BE    @GL00048                                            1101 04055000
         C     SUMMASK,@CF00156                                    1101 04056000
         BNE   @RF01101                                            1101 04057000
@GL00048 L     @05,@PC00001+4                                      1101 04058000
         L     @05,FDTPTR+52(,@05)                                 1101 04059000
         LTR   @05,@05                                             1101 04060000
         BNP   @RF01101                                            1101 04061000
*         DO;                       /*                       @Y30LB33*/ 04062000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 04063000
         L     @05,DDSTRU                                          1103 04064000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1103 04065000
*           DARGSMOD=MODLV0;        /*                       @Y30LB33*/ 04066000
         MVC   DARGSMOD(3,@05),@CC02396                            1104 04067000
*           DARGILP=LENGTH(SUMTBL); /*                       @Y30LB33*/ 04068000
         MVC   DARGILP(2,@05),@CH02164                             1105 04069000
*           DARGDBP=ADDR(SUMCPY);   /*                       @Y30LB33*/ 04070000
         LA    @15,SUMCPY                                          1106 04071000
         ST    @15,DARGDBP(,@05)                                   1106 04072000
*           DARGSENT=CPYSUMLN;      /*                       @Y30LB33*/ 04073000
         MVI   DARGSENT(@05),X'1E'                                 1107 04074000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB33*/ 04075000
         L     @05,@PC00001                                        1108 04076000
         ST    @05,@AL00001                                        1108 04077000
         LA    @15,PRINTME                                         1108 04078000
         ST    @15,@AL00001+4                                      1108 04079000
         LA    @15,DDSTRU                                          1108 04080000
         ST    @15,@AL00001+8                                      1108 04081000
         MVI   @AL00001+8,X'80'                                    1108 04082000
         L     @15,GDTPRT(,@05)                                    1108 04083000
         LA    @01,@AL00001                                        1108 04084000
         BALR  @14,@15                                             1108 04085000
*         END;                      /*                       @Y30LB33*/ 04086000
*                                                                  1109 04087000
*       /*************************************************************/ 04088000
*       /*                                                           */ 04089000
*       /* IF WE ARE PRODUCING A VOLUME REPORT               @Y30LB33*/ 04090000
*       /* AND A STATUS REPORT, PRINT THE                    @Y30LB33*/ 04091000
*       /* DUPLICATE SERIAL NUMBER TOTAL                     @Y30LB33*/ 04092000
*       /*                                                           */ 04093000
*       /*************************************************************/ 04094000
*                                                                  1110 04095000
*       IF ADDR(STAT)>0&            /*                       @Y30LB33*/ 04096000
*           (ADDR(ALLV)>0|ADDR(VOLSCNT)>0)/*                 @Y30LB33*/ 04097000
*         THEN                                                     1110 04098000
@RF01101 SLR   @05,@05                                             1110 04099000
         L     @15,@PC00001+4                                      1110 04100000
         C     @05,FDTPTR+52(,@15)                                 1110 04101000
         BNL   @RF01110                                            1110 04102000
         C     @05,FDTPTR+4(,@15)                                  1110 04103000
         BL    @RT01110                                            1110 04104000
         C     @05,FDTPTR(,@15)                                    1110 04105000
         BNL   @RF01110                                            1110 04106000
@RT01110 DS    0H                                                  1111 04107000
*         DO;                       /*                       @Y30LB33*/ 04108000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 04109000
         L     @05,DDSTRU                                          1112 04110000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1112 04111000
*           DARGSMOD=MODLV0;        /*                       @Y30LB33*/ 04112000
         MVC   DARGSMOD(3,@05),@CC02396                            1113 04113000
*           DARGILP=LENGTH(SUMTBL); /*                       @Y30LB33*/ 04114000
         MVC   DARGILP(2,@05),@CH02164                             1114 04115000
*           DARGDBP=ADDR(SUMTBL);   /*                       @Y30LB33*/ 04116000
         LA    @15,SUMTBL                                          1115 04117000
         ST    @15,DARGDBP(,@05)                                   1115 04118000
*           DARGSENT=DUPSUMLN;      /*                       @Y30LB33*/ 04119000
         MVI   DARGSENT(@05),X'02'                                 1116 04120000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB33*/ 04121000
         L     @05,@PC00001                                        1117 04122000
         ST    @05,@AL00001                                        1117 04123000
         LA    @15,PRINTME                                         1117 04124000
         ST    @15,@AL00001+4                                      1117 04125000
         LA    @15,DDSTRU                                          1117 04126000
         ST    @15,@AL00001+8                                      1117 04127000
         MVI   @AL00001+8,X'80'                                    1117 04128000
         L     @15,GDTPRT(,@05)                                    1117 04129000
         LA    @01,@AL00001                                        1117 04130000
         BALR  @14,@15                                             1117 04131000
*         END;                      /*                       @Y30LB33*/ 04132000
*                                                                  1119 04133000
*       /*************************************************************/ 04134000
*       /*                                                           */ 04135000
*       /* TEST FOR THE SUMMARY TYPE AND ZERO                @Y30LB33*/ 04136000
*       /* THE COUNTERS                                      @Y30LB33*/ 04137000
*       /*                                                           */ 04138000
*       /*************************************************************/ 04139000
*                                                                  1119 04140000
*       IF SUMMASK=GRPSUMM THEN                                    1119 04141000
@RF01110 C     SUMMASK,@CF00221                                    1119 04142000
         BNE   @RF01119                                            1119 04143000
*         SUMGPS=0;                 /*                       @Y30LB33*/ 04144000
         SLR   @15,@15                                             1120 04145000
         ST    @15,SUMGPS                                          1120 04146000
*       SUMCPY=0;                   /*                       @Y30LB33*/ 04147000
@RF01119 SLR   @15,@15                                             1121 04148000
         ST    @15,SUMCPY                                          1121 04149000
*       SUMDUP=0;                   /*                       @Y30LB33*/ 04150000
         ST    @15,SUMDUP                                          1122 04151000
*       SUMVOL=0;                   /*                       @Y30LB33*/ 04152000
         ST    @15,SUMVOL                                          1123 04153000
*       SUMGVOL=0;                  /*                       @Y30LB33*/ 04154000
         ST    @15,SUMGVOL                                         1124 04155000
*       SUMRVOL=0;                  /*                       @Y30LB33*/ 04156000
         ST    @15,SUMRVOL                                         1125 04157000
*       SUMIVOL=0;                  /*                       @Y30LB33*/ 04158000
         ST    @15,SUMIVOL                                         1126 04159000
*     END;                          /*                       @Y30LB33*/ 04160000
*   RETURN CODE(TESTRC);            /*                       @Y30LB33*/ 04161000
@RF01084 LR    @15,TESTRC                                          1128 04162000
@EL00013 DS    0H                                                  1128 04163000
@EF00013 DS    0H                                                  1128 04164000
@ER00013 L     @14,@SA00013                                        1128 04165000
         BR    @14                                                 1128 04166000
*   END SUMRY;                      /*                       @Y30LB33*/ 04167000
*                                                                  1130 04168000
*   /*****************************************************************/ 04169000
*   /*                                                               */ 04170000
*   /* PROCEDURE NAME - GRPPRNT                              @Y30LB33*/ 04171000
*   /*                                                       @Y30LB33*/ 04172000
*   /* FUNCTION - TO SET UP THE TEXT PROCESSOR               @Y30LB33*/ 04173000
*   /* ARGUMENT LIST AND PRINT THE GROUP DATA                @Y30LB33*/ 04174000
*   /*                                                       @Y30LB33*/ 04175000
*   /* INPUT - THE FDTTBL, SUMTBL, AND THE GROUP RECORD      @Y30LB33*/ 04176000
*   /* TO BE PRINTED                                         @Y30LB33*/ 04177000
*   /*                                                       @Y30LB33*/ 04178000
*   /* OUTPUT - UPDATED SUMTBL AND A RETURN CODE OF          @Y30LB33*/ 04179000
*   /* ZERO                                                  @Y30LB33*/ 04180000
*   /*                                                               */ 04181000
*   /*****************************************************************/ 04182000
*                                                                  1130 04183000
*GRPPRNT:                                                          1130 04184000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 04185000
GRPPRNT  ST    @14,@SA00014                                        1130 04186000
*   OLDERID2=NEWERID2;                                             1131 04187000
         L     @03,@PC00001                                        1131 04188000
         L     @15,GDTTR2(,@03)                                    1131 04189000
         MVC   @TS00001(95),NEWERID2(@15)                          1131 04190000
         MVC   OLDERID2(95,@15),@TS00001                           1131 04191000
*   NEWID2='LVNA';                  /*                       @Y30LB33*/ 04192000
         MVC   NEWID2(4,@15),@CC02519                              1132 04193000
*   TESTRC=0;                       /*                       @Y30LB33*/ 04194000
*                                                                  1133 04195000
         SLR   TESTRC,TESTRC                                       1133 04196000
*   /*****************************************************************/ 04197000
*   /*                                                               */ 04198000
*   /* TEST IF A VOLUME LIST WAS REQUESTED, AND IF SO        @Y30LB33*/ 04199000
*   /* SO, RESET THE SUBTITLES SO THAT THE GROUP             @Y30LB33*/ 04200000
*   /* DATA HEADING DOES NOT GO UNDER A VOLUME               @Y30LB33*/ 04201000
*   /* SUBTITLE                                              @Y30LB33*/ 04202000
*   /*                                                               */ 04203000
*   /*****************************************************************/ 04204000
*                                                                  1134 04205000
*   IF ADDR(VOLST)>0 THEN                                          1134 04206000
         L     @15,@PC00001+4                                      1134 04207000
         L     @15,FDTPTR+24(,@15)                                 1134 04208000
         LTR   @15,@15                                             1134 04209000
         BNP   @RF01134                                            1134 04210000
*     DO;                           /*                       @Y30LB33*/ 04211000
*                                                                  1135 04212000
*       /*************************************************************/ 04213000
*       /*                                                           */ 04214000
*       /* RESET THE SUBTITLES AND MAIN TITLE                @Y30LB33*/ 04215000
*       /*                                                           */ 04216000
*       /*************************************************************/ 04217000
*                                                                  1136 04218000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     #Y30LB33*/ 04219000
*                                                                  1136 04220000
         ST    @03,@AL00001                                        1136 04221000
         LA    @15,PRINTME                                         1136 04222000
         ST    @15,@AL00001+4                                      1136 04223000
         MVI   @AL00001+4,X'80'                                    1136 04224000
         L     @15,GDTRES(,@03)                                    1136 04225000
         LA    @01,@AL00001                                        1136 04226000
         BALR  @14,@15                                             1136 04227000
*       /*************************************************************/ 04228000
*       /*                                                           */ 04229000
*       /* RE-ESTABLISH THE MAIN TITLE LINE                  @Y30LB33*/ 04230000
*       /*                                                           */ 04231000
*       /*************************************************************/ 04232000
*                                                                  1137 04233000
*       PCARG=PCARG&&PCARG;         /*                       @Y30LB33*/ 04234000
         XC    PCARG(33),PCARG                                     1137 04235000
*       PCMTLP=ADDR(MAINTITL);      /*                       @Y30LB33*/ 04236000
         LA    @03,MAINTITL                                        1138 04237000
         ST    @03,PCMTLP                                          1138 04238000
*       PCSTLC=1;                   /*                       @YM02855*/ 04239000
         MVC   PCSTLC(2),@CH00221                                  1139 04240000
*       PCPNL=107;                  /*                       @Y30LB33*/ 04241000
         MVC   PCPNL(2),@CH02418                                   1140 04242000
*       PCPTL=73;                   /*                       @Y30LB33*/ 04243000
         MVC   PCPTL(2),@CH02419                                   1141 04244000
*       PCPDL=89;                   /*                       @Y30LB33*/ 04245000
         MVC   PCPDL(2),@CH02420                                   1142 04246000
*       CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*               @Y30LB33*/ 04247000
         L     @03,@PC00001                                        1143 04248000
         ST    @03,@AL00001                                        1143 04249000
         LA    @15,PRINTME                                         1143 04250000
         ST    @15,@AL00001+4                                      1143 04251000
         LA    @15,PCARG                                           1143 04252000
         ST    @15,@AL00001+8                                      1143 04253000
         L     @15,GDTESA(,@03)                                    1143 04254000
         LA    @01,@AL00001                                        1143 04255000
         BALR  @14,@15                                             1143 04256000
*     END;                          /*                       #Y30LB33*/ 04257000
*                                                                  1144 04258000
*   /*****************************************************************/ 04259000
*   /*                                                               */ 04260000
*   /* SET UP THE DARGLIST FOR A STATUS OR USAGE             #Y30LB33*/ 04261000
*   /* REPORT WITH INITIAL VALUES                            @Y30LB33*/ 04262000
*   /*                                                               */ 04263000
*   /*****************************************************************/ 04264000
*                                                                  1145 04265000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 04266000
@RF01134 L     @03,DDSTRU                                          1145 04267000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1145 04268000
*   DARGSMOD=MODLV0;                /*                       @Y30LB33*/ 04269000
         MVC   DARGSMOD(3,@03),@CC02396                            1146 04270000
*   DARGDBP=ADDR(GRPAREA);          /*                       @Y30LB33*/ 04271000
         LA    @15,GRPAREA                                         1147 04272000
         ST    @15,DARGDBP(,@03)                                   1147 04273000
*   DARGILP=LENGTH(GRPAREA);        /*                       @Y30LB33*/ 04274000
*                                                                  1148 04275000
         MVC   DARGILP(2,@03),@CH02624                             1148 04276000
*   /*****************************************************************/ 04277000
*   /*                                                               */ 04278000
*   /* SET UP SPACE DISPOSITION FIELD                        @Y30LB33*/ 04279000
*   /*                                                               */ 04280000
*   /*****************************************************************/ 04281000
*                                                                  1149 04282000
*   IF GRORLSE=ON THEN                                             1149 04283000
         TM    GRORLSE(GROUPPTR),B'00001000'                       1149 04284000
         BNO   @RF01149                                            1149 04285000
*     GRPTRNRL=RLSCHAR;             /*                       @Y30LB33*/ 04286000
         MVC   GRPTRNRL(5),RLSCHAR                                 1150 04287000
*   ELSE                                                           1151 04288000
*     GRPTRNRL=NRLCHAR;             /*                       @Y30LB33*/ 04289000
*                                                                  1151 04290000
         B     @RC01149                                            1151 04291000
@RF01149 MVC   GRPTRNRL(5),NRLCHAR                                 1151 04292000
*   /*****************************************************************/ 04293000
*   /*                                                               */ 04294000
*   /* SET UP ARGUMENT LIST FOR A STATUS REPORT              @Y30LB33*/ 04295000
*   /*                                                               */ 04296000
*   /*****************************************************************/ 04297000
*                                                                  1152 04298000
*   IF ADDR(STAT)>0 THEN                                           1152 04299000
@RC01149 L     @03,@PC00001+4                                      1152 04300000
         L     @03,FDTPTR+52(,@03)                                 1152 04301000
         LTR   @03,@03                                             1152 04302000
         BNP   @RF01152                                            1152 04303000
*     DO;                           /*                       @Y30LB33*/ 04304000
*                                                                  1153 04305000
*       /*************************************************************/ 04306000
*       /*                                                           */ 04307000
*       /* SET UP ATTRIBUTES                                 @Y30LB33*/ 04308000
*       /*                                                           */ 04309000
*       /*************************************************************/ 04310000
*                                                                  1154 04311000
*       GRPTRNAT='    ';            /*                       @Y30LB33*/ 04312000
         MVC   GRPTRNAT(4),@CC02511                                1154 04313000
*       IF GROBIND=ON THEN                                         1155 04314000
         TM    GROBIND(GROUPPTR),B'10000000'                       1155 04315000
         BNO   @RF01155                                            1155 04316000
*         GRPTRNAT(1)=BCHAR;        /*                       @Y30LB33*/ 04317000
         MVC   GRPTRNAT(1),BCHAR                                   1156 04318000
*       IF GRORONLY=ON THEN                                        1157 04319000
@RF01155 TM    GRORONLY(GROUPPTR),B'00010000'                      1157 04320000
         BNO   @RF01157                                            1157 04321000
*         GRPTRNAT(2)=RCHAR;        /*                       @Y30LB33*/ 04322000
         MVC   GRPTRNAT+1(1),RCHAR                                 1158 04323000
*       IF GRODAERA=ON THEN                                        1159 04324000
@RF01157 TM    GRODAERA(GROUPPTR),B'00100000'                      1159 04325000
         BNO   @RF01159                                            1159 04326000
*         GRPTRNAT(3)=DCHAR;        /*                       @Y30LB33*/ 04327000
         MVC   GRPTRNAT+2(1),DCHAR                                 1160 04328000
*       IF GROEXCL=ON THEN                                         1161 04329000
@RF01159 TM    GROEXCL(GROUPPTR),B'01000000'                       1161 04330000
         BNO   @RF01161                                            1161 04331000
*         GRPTRNAT(4)=ECHAR;        /*                       @Y30LB33*/ 04332000
*                                                                  1162 04333000
         MVC   GRPTRNAT+3(1),ECHAR                                 1162 04334000
*       /*************************************************************/ 04335000
*       /*                                                           */ 04336000
*       /* DON'T PRINT RETENTION PERIOD IF THERE IS          @Y30LB33*/ 04337000
*       /* NONE. ZERO IS THE NULL VALUE                      @Y30LB33*/ 04338000
*       /*                                                           */ 04339000
*       /*************************************************************/ 04340000
*                                                                  1163 04341000
*       IF GRORETPD>0&GRORETN=ON THEN                              1163 04342000
@RF01161 L     @03,GRORETPD(,GROUPPTR)                             1163 04343000
         LTR   @03,@03                                             1163 04344000
         BNP   @RF01163                                            1163 04345000
         TM    GRORETN(GROUPPTR),B'00000100'                       1163 04346000
         BNO   @RF01163                                            1163 04347000
*         DO;                       /*                       @ZA16116*/ 04348000
*           DARGCNT=DARGCNT+1;      /*                       @Y30LB33*/ 04349000
         L     @03,DDSTRU                                          1165 04350000
         LA    @15,1                                               1165 04351000
         AH    @15,DARGCNT(,@03)                                   1165 04352000
         STH   @15,DARGCNT(,@03)                                   1165 04353000
*           DARGINS(DARGCNT)=2;     /*                       @ZA16116*/ 04354000
         SLA   @15,3                                               1166 04355000
         LA    @14,2                                               1166 04356000
         STH   @14,DARGINS-8(@15,@03)                              1166 04357000
*           DARGINL(DARGCNT)=4;     /*                       @Y30LB33*/ 04358000
         LA    @14,4                                               1167 04359000
         STH   @14,DARGINL-8(@15,@03)                              1167 04360000
*           DARGDTM(DARGCNT)=ADDR(GRORETPD);/*               @Y30LB33*/ 04361000
         LA    @14,GRORETPD(,GROUPPTR)                             1168 04362000
         ST    @14,DARGDTM-8(@15,@03)                              1168 04363000
*         END;                      /*                       @Y30LB33*/ 04364000
*                                                                  1169 04365000
*       /*************************************************************/ 04366000
*       /*                                                           */ 04367000
*       /* SELECT THE STATIC TEXT ENTRY BASED ON             @Y30LB33*/ 04368000
*       /* THE REPORT PARAMETER                              @Y30LB33*/ 04369000
*       /*                                                           */ 04370000
*       /*************************************************************/ 04371000
*                                                                  1170 04372000
*       IF ADDR(VOLST)>0 THEN                                      1170 04373000
@RF01163 L     @03,@PC00001+4                                      1170 04374000
         L     @03,FDTPTR+24(,@03)                                 1170 04375000
         LTR   @03,@03                                             1170 04376000
         BNP   @RF01170                                            1170 04377000
*         DARGSENT=SVGRPHD;         /*                       @Y30LB33*/ 04378000
         L     @03,DDSTRU                                          1171 04379000
         MVI   DARGSENT(@03),X'1D'                                 1171 04380000
*       ELSE                                                       1172 04381000
*         DARGSENT=GRPSLINE;        /*                       @Y30LB33*/ 04382000
         B     @RC01170                                            1172 04383000
@RF01170 L     @03,DDSTRU                                          1172 04384000
         MVI   DARGSENT(@03),X'1A'                                 1172 04385000
*     END;                          /*                       @Y30LB33*/ 04386000
*                                                                  1173 04387000
*   /*****************************************************************/ 04388000
*   /*                                                               */ 04389000
*   /* SET UP ARGUMENT LIST FOR A USAGE REPORT               @Y30LB33*/ 04390000
*   /*                                                               */ 04391000
*   /*****************************************************************/ 04392000
*                                                                  1174 04393000
*   ELSE                                                           1174 04394000
*     DO;                           /*                       @Y30LB33*/ 04395000
*                                                                  1174 04396000
         B     @RC01152                                            1174 04397000
@RF01152 DS    0H                                                  1175 04398000
*       /*************************************************************/ 04399000
*       /*                                                           */ 04400000
*       /* FIRST CALCULATE THE AVERAGE SIZE OF A FREE        @Y30LB33*/ 04401000
*       /* EXTENT                                            @Y30LB33*/ 04402000
*       /*                                                           */ 04403000
*       /*************************************************************/ 04404000
*                                                                  1175 04405000
*       IF GROFRESP>0&GROFREXT>0 THEN                              1175 04406000
         SLR   @03,@03                                             1175 04407000
         L     @15,GROFRESP(,GROUPPTR)                             1175 04408000
         CR    @15,@03                                             1175 04409000
         BNH   @RF01175                                            1175 04410000
         L     @14,GROFREXT(,GROUPPTR)                             1175 04411000
         CR    @14,@03                                             1175 04412000
         BNH   @RF01175                                            1175 04413000
*         DO;                       /*                       @Y30LB33*/ 04414000
*           GRPAVGFD=GROFRESP/GROFREXT;/*                    @Y30LB33*/ 04415000
         LR    @00,@15                                             1177 04416000
         SRDA  @00,32                                              1177 04417000
         DR    @00,@14                                             1177 04418000
         ST    @01,GRPAVGFD                                        1177 04419000
*           DARGCNT=DARGCNT+1;      /*                       @Y30LB33*/ 04420000
         L     @03,DDSTRU                                          1178 04421000
         LA    @15,1                                               1178 04422000
         AH    @15,DARGCNT(,@03)                                   1178 04423000
         STH   @15,DARGCNT(,@03)                                   1178 04424000
*           DARGINS(DARGCNT)=3;     /*                       @ZA16116*/ 04425000
         SLA   @15,3                                               1179 04426000
         LA    @14,3                                               1179 04427000
         STH   @14,DARGINS-8(@15,@03)                              1179 04428000
*           DARGINL(DARGCNT)=4;     /*                       @Y30LB33*/ 04429000
         LA    @14,4                                               1180 04430000
         STH   @14,DARGINL-8(@15,@03)                              1180 04431000
*           DARGDTM(DARGCNT)=ADDR(GRPAVGFD);/*               @Y30LB33*/ 04432000
         LA    @14,GRPAVGFD                                        1181 04433000
         ST    @14,DARGDTM-8(@15,@03)                              1181 04434000
*         END;                      /*                       @Y30LB33*/ 04435000
*                                                                  1182 04436000
*       /*************************************************************/ 04437000
*       /*                                                           */ 04438000
*       /* FIRST SET THE TOTAL SPACE PRINT FIELD             @YM02860*/ 04439000
*       /* TO ZERO                                           @YM02860*/ 04440000
*       /*                                                           */ 04441000
*       /*************************************************************/ 04442000
*                                                                  1183 04443000
*       GRPTRNTS=0;                 /*                       @YM02860*/ 04444000
*                                                                  1183 04445000
@RF01175 SLR   @03,@03                                             1183 04446000
         ST    @03,GRPTRNTS                                        1183 04447000
*       /*************************************************************/ 04448000
*       /*                                                           */ 04449000
*       /* IF THE GROUP HAS GENERAL VOLUMES,                 @YM02860*/ 04450000
*       /* SET UP THE TOTAL SPACE BY ADDING THE              @Y30LB33*/ 04451000
*       /* NUMBER OF ACTIVE GENERAL VOLUMES IN               @Y30LB33*/ 04452000
*       /* THE GROUP AND MULTIPLYING BY 404                  @Y30LB33*/ 04453000
*       /*                                                           */ 04454000
*       /*************************************************************/ 04455000
*                                                                  1184 04456000
*       IF GRONGEN>0 THEN           /*                       @Y30LB33*/ 04457000
         LH    @15,GRONGEN(,GROUPPTR)                              1184 04458000
         CR    @15,@03                                             1184 04459000
         BNH   @RF01184                                            1184 04460000
*         GRPTRNTS=404*GRONGEN;     /*                       @Y30LB33*/ 04461000
*                                                                  1185 04462000
         MH    @15,@CH02520                                        1185 04463000
         ST    @15,GRPTRNTS                                        1185 04464000
*       /*************************************************************/ 04465000
*       /*                                                           */ 04466000
*       /* SET UP RETENTION PERIOD IF NOT                    @Y30LB33*/ 04467000
*       /* NULL. NULL IS ZERO                                @Y30LB33*/ 04468000
*       /*                                                           */ 04469000
*       /*************************************************************/ 04470000
*                                                                  1186 04471000
*       IF GRORETPD>0&GRORETN=ON THEN                              1186 04472000
@RF01184 L     @03,GRORETPD(,GROUPPTR)                             1186 04473000
         LTR   @03,@03                                             1186 04474000
         BNP   @RF01186                                            1186 04475000
         TM    GRORETN(GROUPPTR),B'00000100'                       1186 04476000
         BNO   @RF01186                                            1186 04477000
*         DO;                       /*                       @Y30LB33*/ 04478000
*           DARGCNT=DARGCNT+1;      /*                       @Y30LB33*/ 04479000
         L     @03,DDSTRU                                          1188 04480000
         LA    @15,1                                               1188 04481000
         AH    @15,DARGCNT(,@03)                                   1188 04482000
         STH   @15,DARGCNT(,@03)                                   1188 04483000
*           DARGINS(DARGCNT)=2;     /*                       @Y30LB33*/ 04484000
         SLA   @15,3                                               1189 04485000
         LA    @14,2                                               1189 04486000
         STH   @14,DARGINS-8(@15,@03)                              1189 04487000
*           DARGINL(DARGCNT)=4;     /*                       @Y30LB33*/ 04488000
         LA    @14,4                                               1190 04489000
         STH   @14,DARGINL-8(@15,@03)                              1190 04490000
*           DARGDTM(DARGCNT)=ADDR(GRORETPD);/*               @Y30LB33*/ 04491000
         LA    @14,GRORETPD(,GROUPPTR)                             1191 04492000
         ST    @14,DARGDTM-8(@15,@03)                              1191 04493000
*         END;                      /*                       @Y30LB33*/ 04494000
*                                                                  1192 04495000
*       /*************************************************************/ 04496000
*       /*                                                           */ 04497000
*       /* SET UP PROPER TEXT ENTRY NUMBER                   @Y30LB33*/ 04498000
*       /*                                                           */ 04499000
*       /*************************************************************/ 04500000
*                                                                  1193 04501000
*       IF ADDR(VOLST)>0 THEN                                      1193 04502000
@RF01186 L     @03,@PC00001+4                                      1193 04503000
         L     @03,FDTPTR+24(,@03)                                 1193 04504000
         LTR   @03,@03                                             1193 04505000
         BNP   @RF01193                                            1193 04506000
*         DARGSENT=UVGRPHD;         /*                       @Y30LB33*/ 04507000
         L     @03,DDSTRU                                          1194 04508000
         MVI   DARGSENT(@03),X'04'                                 1194 04509000
*       ELSE                                                       1195 04510000
*         DARGSENT=GRPULINE;        /*                       @Y30LB33*/ 04511000
         B     @RC01193                                            1195 04512000
@RF01193 L     @03,DDSTRU                                          1195 04513000
         MVI   DARGSENT(@03),X'18'                                 1195 04514000
*     END;                          /*                       @Y30LB33*/ 04515000
*                                                                  1196 04516000
@RC01193 DS    0H                                                  1197 04517000
*   /*****************************************************************/ 04518000
*   /*                                                               */ 04519000
*   /* IF THE GROUP THRESHOLD PERCENT IS GREATER THAN ZERO,  @Y30LB33*/ 04520000
*   /* SET UP THE INSERT TO PRINT IT.                        @Y30LB33*/ 04521000
*   /*                                                               */ 04522000
*   /*****************************************************************/ 04523000
*                                                                  1197 04524000
*   IF GROPCENT>0 THEN                                             1197 04525000
@RC01152 CLI   GROPCENT(GROUPPTR),0                                1197 04526000
         BNH   @RF01197                                            1197 04527000
*     DO;                           /*                       @Y30LB33*/ 04528000
*       DARGCNT=DARGCNT+1;          /*                       @Y30LB33*/ 04529000
         L     @03,DDSTRU                                          1199 04530000
         LA    @15,1                                               1199 04531000
         LH    @14,DARGCNT(,@03)                                   1199 04532000
         ALR   @14,@15                                             1199 04533000
         STH   @14,DARGCNT(,@03)                                   1199 04534000
*       DARGINS(DARGCNT)=1;         /*                       @ZA16116*/ 04535000
         SLA   @14,3                                               1200 04536000
         STH   @15,DARGINS-8(@14,@03)                              1200 04537000
*       DARGINL(DARGCNT)=1;         /*                       @Y30LB33*/ 04538000
         STH   @15,DARGINL-8(@14,@03)                              1201 04539000
*       DARGDTM(DARGCNT)=ADDR(GROPCENT);/*                   @Y30LB33*/ 04540000
         LA    @15,GROPCENT(,GROUPPTR)                             1202 04541000
         ST    @15,DARGDTM-8(@14,@03)                              1202 04542000
*     END;                          /*                       @Y30LB33*/ 04543000
*                                                                  1203 04544000
*   /*****************************************************************/ 04545000
*   /*                                                               */ 04546000
*   /* PRINT THE GROUP                                       #Y30LB33*/ 04547000
*   /*                                                               */ 04548000
*   /*****************************************************************/ 04549000
*                                                                  1204 04550000
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Y30LB33*/ 04551000
*                                                                  1204 04552000
@RF01197 L     @03,@PC00001                                        1204 04553000
         ST    @03,@AL00001                                        1204 04554000
         LA    @15,PRINTME                                         1204 04555000
         ST    @15,@AL00001+4                                      1204 04556000
         LA    @15,DDSTRU                                          1204 04557000
         ST    @15,@AL00001+8                                      1204 04558000
         MVI   @AL00001+8,X'80'                                    1204 04559000
         L     @15,GDTPRT(,@03)                                    1204 04560000
         LA    @01,@AL00001                                        1204 04561000
         BALR  @14,@15                                             1204 04562000
*   /*****************************************************************/ 04563000
*   /*                                                               */ 04564000
*   /* UPDATE THE SUMMARY TABLE                              @Y30LB33*/ 04565000
*   /*                                                               */ 04566000
*   /*****************************************************************/ 04567000
*                                                                  1205 04568000
*   MAINCTR=MAINCTR+1;              /*                       @Y30LB33*/ 04569000
         LA    @03,1                                               1205 04570000
         L     @15,MAINCTR                                         1205 04571000
         ALR   @15,@03                                             1205 04572000
         ST    @15,MAINCTR                                         1205 04573000
*   SUMGPS=SUMGPS+1;                /*                       @Y30LB33*/ 04574000
         AL    @03,SUMGPS                                          1206 04575000
         ST    @03,SUMGPS                                          1206 04576000
*                                                                  1207 04577000
*   /*****************************************************************/ 04578000
*   /*                                                               */ 04579000
*   /* ESTABLISH HEADERS FOR THE VOLUME LIST, IF             @Y30LB33*/ 04580000
*   /* A LIST IS REQUESTED                                   @Y30LB33*/ 04581000
*   /* AND THE GROUP HAS VOLUMES TO LIST                     @Y30LB33*/ 04582000
*   /*                                                               */ 04583000
*   /*****************************************************************/ 04584000
*                                                                  1207 04585000
*   IF ADDR(VOLST)>0&((ADDR(GNRL)>0&GRONGEN>0)|/*            @Y30LB33*/ 04586000
*       (ADDR(RSTR)>0&GRONRSTD>0)|  /*                       @Y30LB33*/ 04587000
*       (ADDR(EXPIR)>0&GRONGEN>0&GRORETN=ON)|/*              @YM02881*/ 04588000
*       (ADDR(INACT)>0&GRONINAC>0)| /*                       @Y30LB33*/ 04589000
*       (ADDR(AL)>0&                /*                       @Y30LB33*/ 04590000
*       (GRONGEN>0|GRONRSTD>0|GRONINAC>0))|/*                @Y30LB33*/ 04591000
*       (ADDR(ACT)>0&(GRONGEN>0|GRONRSTD>0)))/*              @Y30LB33*/ 04592000
*     THEN                                                         1207 04593000
         SLR   @03,@03                                             1207 04594000
         L     @15,@PC00001+4                                      1207 04595000
         C     @03,FDTPTR+24(,@15)                                 1207 04596000
         BNL   @RF01207                                            1207 04597000
         C     @03,FDTPTR+76(,@15)                                 1207 04598000
         BNL   @GL00060                                            1207 04599000
         CH    @03,GRONGEN(,GROUPPTR)                              1207 04600000
         BL    @RT01207                                            1207 04601000
@GL00060 SLR   @03,@03                                             1207 04602000
         L     @15,@PC00001+4                                      1207 04603000
         C     @03,FDTPTR+80(,@15)                                 1207 04604000
         BNL   @GL00059                                            1207 04605000
         CH    @03,GRONRSTD(,GROUPPTR)                             1207 04606000
         BL    @RT01207                                            1207 04607000
@GL00059 SLR   @03,@03                                             1207 04608000
         L     @15,@PC00001+4                                      1207 04609000
         C     @03,FDTPTR+28(,@15)                                 1207 04610000
         BNL   @GL00058                                            1207 04611000
         CH    @03,GRONGEN(,GROUPPTR)                              1207 04612000
         BNL   @GL00058                                            1207 04613000
         TM    GRORETN(GROUPPTR),B'00000100'                       1207 04614000
         BO    @RT01207                                            1207 04615000
@GL00058 SLR   @03,@03                                             1207 04616000
         L     @15,@PC00001+4                                      1207 04617000
         C     @03,FDTPTR+72(,@15)                                 1207 04618000
         BNL   @GL00057                                            1207 04619000
         CH    @03,GRONINAC(,GROUPPTR)                             1207 04620000
         BL    @RT01207                                            1207 04621000
@GL00057 SLR   @03,@03                                             1207 04622000
         L     @15,@PC00001+4                                      1207 04623000
         C     @03,FDTPTR+36(,@15)                                 1207 04624000
         BNL   @GL00056                                            1207 04625000
         CH    @03,GRONGEN(,GROUPPTR)                              1207 04626000
         BL    @RT01207                                            1207 04627000
         CH    @03,GRONRSTD(,GROUPPTR)                             1207 04628000
         BL    @RT01207                                            1207 04629000
         CH    @03,GRONINAC(,GROUPPTR)                             1207 04630000
         BL    @RT01207                                            1207 04631000
@GL00056 SLR   @03,@03                                             1207 04632000
         L     @15,@PC00001+4                                      1207 04633000
         C     @03,FDTPTR+68(,@15)                                 1207 04634000
         BNL   @RF01207                                            1207 04635000
         CH    @03,GRONGEN(,GROUPPTR)                              1207 04636000
         BL    @RT01207                                            1207 04637000
         CH    @03,GRONRSTD(,GROUPPTR)                             1207 04638000
         BNL   @RF01207                                            1207 04639000
@RT01207 DS    0H                                                  1208 04640000
*     DO;                           /*                       @Y30LB33*/ 04641000
*                                                                  1208 04642000
*       /*************************************************************/ 04643000
*       /*                                                           */ 04644000
*       /* READ IN THE SUBTITLES USING UPRINT                @Y30LB33*/ 04645000
*       /*                                                           */ 04646000
*       /*************************************************************/ 04647000
*                                                                  1209 04648000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 04649000
         L     @03,DDSTRU                                          1209 04650000
         XC    DARGLIST(20,@03),DARGLIST(@03)                      1209 04651000
*       DARGRETP=ADDR(TITLSPCE);    /*                       @Y30LB33*/ 04652000
         LA    @15,TITLSPCE                                        1210 04653000
         ST    @15,DARGRETP(,@03)                                  1210 04654000
*       DARGSMOD=MODLV0;            /*                       @Y30LB33*/ 04655000
         MVC   DARGSMOD(3,@03),@CC02396                            1211 04656000
*       DARGRETL=LENGTH(TITLSPCE);  /*                       @Y30LB33*/ 04657000
         MVC   DARGRETL(2,@03),@CH02376                            1212 04658000
*       IF ADDR(STAT)>0 THEN                                       1213 04659000
         L     @15,@PC00001+4                                      1213 04660000
         L     @15,FDTPTR+52(,@15)                                 1213 04661000
         LTR   @15,@15                                             1213 04662000
         BNP   @RF01213                                            1213 04663000
*         DARGSENT=VOLSTLE;         /*                       @Y30LB33*/ 04664000
         MVI   DARGSENT(@03),X'1B'                                 1214 04665000
*       ELSE                                                       1215 04666000
*         DARGSENT=VOLUTLE;         /*                       @Y30LB33*/ 04667000
         B     @RC01213                                            1215 04668000
@RF01213 L     @03,DDSTRU                                          1215 04669000
         MVI   DARGSENT(@03),X'12'                                 1215 04670000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 04671000
*                                                                  1216 04672000
@RC01213 L     @03,@PC00001                                        1216 04673000
         ST    @03,@AL00001                                        1216 04674000
         LA    @15,@CF00117                                        1216 04675000
         ST    @15,@AL00001+4                                      1216 04676000
         LA    @15,DDSTRU                                          1216 04677000
         ST    @15,@AL00001+8                                      1216 04678000
         MVI   @AL00001+8,X'80'                                    1216 04679000
         L     @15,GDTPRT(,@03)                                    1216 04680000
         LA    @01,@AL00001                                        1216 04681000
         BALR  @14,@15                                             1216 04682000
*       /*************************************************************/ 04683000
*       /*                                                           */ 04684000
*       /* RESET THE SUBTITLES AND MAIN TITLE                @Y30LB33*/ 04685000
*       /* THAT HAVE BEEN ESTABLISHED ALREADY                @Y30LB33*/ 04686000
*       /*                                                           */ 04687000
*       /*************************************************************/ 04688000
*                                                                  1217 04689000
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB33*/ 04690000
*                                                                  1217 04691000
         L     @03,@PC00001                                        1217 04692000
         ST    @03,@AL00001                                        1217 04693000
         LA    @15,PRINTME                                         1217 04694000
         ST    @15,@AL00001+4                                      1217 04695000
         MVI   @AL00001+4,X'80'                                    1217 04696000
         L     @15,GDTRES(,@03)                                    1217 04697000
         LA    @01,@AL00001                                        1217 04698000
         BALR  @14,@15                                             1217 04699000
*       /*************************************************************/ 04700000
*       /*                                                           */ 04701000
*       /* THEN ESTABLISH THE NEW ONES USING                 @Y30LB33*/ 04702000
*       /* UESTA                                             @Y30LB33*/ 04703000
*       /*                                                           */ 04704000
*       /*************************************************************/ 04705000
*                                                                  1218 04706000
*       PCSTLP=ADDR(TITLSPCE);      /*                       @Y30LB33*/ 04707000
         LA    @03,TITLSPCE                                        1218 04708000
         ST    @03,PCSTLP                                          1218 04709000
*       IF ADDR(STAT)>0 THEN                                       1219 04710000
         L     @03,@PC00001+4                                      1219 04711000
         L     @03,FDTPTR+52(,@03)                                 1219 04712000
         LTR   @03,@03                                             1219 04713000
         BNP   @RF01219                                            1219 04714000
*         PCSTLC=2;                 /*                       @Y30LB33*/ 04715000
         MVC   PCSTLC(2),@CH00156                                  1220 04716000
*       ELSE                                                       1221 04717000
*         PCSTLC=3;                 /*                       @Y30LB33*/ 04718000
         B     @RC01219                                            1221 04719000
@RF01219 MVC   PCSTLC(2),@CH00165                                  1221 04720000
*       CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*               @Y30LB33*/ 04721000
@RC01219 L     @03,@PC00001                                        1222 04722000
         ST    @03,@AL00001                                        1222 04723000
         LA    @15,PRINTME                                         1222 04724000
         ST    @15,@AL00001+4                                      1222 04725000
         LA    @15,PCARG                                           1222 04726000
         ST    @15,@AL00001+8                                      1222 04727000
         L     @15,GDTESA(,@03)                                    1222 04728000
         LA    @01,@AL00001                                        1222 04729000
         BALR  @14,@15                                             1222 04730000
*     END;                          /*                       @Y30LB33*/ 04731000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 04732000
@RF01207 SLR   @15,@15                                             1224 04733000
@EL00014 DS    0H                                                  1224 04734000
@EF00014 DS    0H                                                  1224 04735000
@ER00014 L     @14,@SA00014                                        1224 04736000
         BR    @14                                                 1224 04737000
*   END GRPPRNT;                    /*                       @Y30LB33*/ 04738000
*                                                                  1226 04739000
*   /*****************************************************************/ 04740000
*   /*                                                               */ 04741000
*   /* PROCEDURE NAME - GRPRDR                               @Y30LB33*/ 04742000
*   /*                                                       @Y30LB33*/ 04743000
*   /* FUNCTION - READ A GROUP RECORD. DETERMINE IF          @Y30LB33*/ 04744000
*   /* END-OF-FILE HAS OCCURRED OR IF A                      @Y30LB33*/ 04745000
*   /* SPECIFIC GROUP WAS REQUESTED. IF END-OF               @Y30LB33*/ 04746000
*   /* -FILE OCCURRED SEARCHING FOR A SPECIFIC               @Y30LB33*/ 04747000
*   /* GROUP, ISSUE ERROR MESSAGE IDC2079I AND               @Y30LB33*/ 04748000
*   /* RETURN WITH A CODE OF 4. IF END-OF-FILE               @Y30LB33*/ 04749000
*   /* OCCURRED WHILE READING THROUGH THE                    @Y30LB33*/ 04750000
*   /* GROUPS, SIMPLY SET THE CODE TO INDICATE               @Y30LB33*/ 04751000
*   /* END OF GROUPS. EITHER ERROR ALLOWS FOR                @Y30LB33*/ 04752000
*   /* CONTINUATION OF THE LISTMSVI PROCESSING.              @Y30LB33*/ 04753000
*   /* ANY OTHER ERROR RESULTS IN TERMINATION                @Y30LB33*/ 04754000
*   /* OF LISTMSVI                                           @Y30LB33*/ 04755000
*   /*                                                       @Y30LB33*/ 04756000
*   /* INPUT - READ REQUEST BLOCK                            @Y30LB33*/ 04757000
*   /*                                                       @Y30LB33*/ 04758000
*   /* OUTPUT - RETURN CODE OF ZERO AND LASTCOND OF          @Y30LB33*/ 04759000
*   /* ZERO FOR NORMAL PROCESSING. RETURN CODE               @Y30LB33*/ 04760000
*   /* OF 4 AND LASTCOND OF ZERO FOR                         @Y30LB33*/ 04761000
*   /* END-OF-GROUPS ON A READ-NEXT REQUEST.                 @Y30LB33*/ 04762000
*   /* RETURN CODE OF 4 AND LASTCOND OF 8                    @Y30LB33*/ 04763000
*   /* FOR A GROUP NOT FOUND ON A READ-DIRECT                @Y30LB33*/ 04764000
*   /* RETURN CODE OF 16 AND LASTCOND OF 8                   @Y30LB33*/ 04765000
*   /* FOR A TERMINATION ERROR                               @Y30LB33*/ 04766000
*   /*                                                               */ 04767000
*   /*****************************************************************/ 04768000
*                                                                  1226 04769000
*GRPRDR:                                                           1226 04770000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 04771000
GRPRDR   ST    @14,@SA00015                                        1226 04772000
*   OLDERID2=NEWERID2;                                             1227 04773000
         L     @04,@PC00001                                        1227 04774000
         L     @04,GDTTR2(,@04)                                    1227 04775000
         MVC   @TS00001(95),NEWERID2(@04)                          1227 04776000
         MVC   OLDERID2(95,@04),@TS00001                           1227 04777000
*   NEWID2='LVOA';                  /*                       @Y30LB33*/ 04778000
         MVC   NEWID2(4,@04),@CC02524                              1228 04779000
*   TESTRC=0;                       /*                       @Y30LB33*/ 04780000
*                                                                  1229 04781000
         SLR   TESTRC,TESTRC                                       1229 04782000
*   /*****************************************************************/ 04783000
*   /*                                                               */ 04784000
*   /* IF THE USER REQUESTED PASTHRESHOLD, PUT IT            @Y30LB33*/ 04785000
*   /* IN THE REQUEST BLOCK TO SELECT ONLY THOSE             @Y30LB33*/ 04786000
*   /* GROUPS THAT ARE PAST THEIR THRESHOLD                  @Y30LB33*/ 04787000
*   /*                                                               */ 04788000
*   /*****************************************************************/ 04789000
*                                                                  1230 04790000
*   IF ADDR(PT)>0 THEN                                             1230 04791000
         L     @06,@PC00001+4                                      1230 04792000
         L     @06,FDTPTR+20(,@06)                                 1230 04793000
         LTR   @06,@06                                             1230 04794000
         BNP   @RF01230                                            1230 04795000
*     RVVTHOLD=ON;                  /*                       @Y30LB33*/ 04796000
*                                                                  1231 04797000
         OI    RVVTHOLD(RVVIPTR),B'01000000'                       1231 04798000
*   /*****************************************************************/ 04799000
*   /*                                                               */ 04800000
*   /* CALL DIRECTRD WITH THE INPUT REQUEST BLOCK            @ZA27752*/ 04801000
*   /*                                                               */ 04802000
*   /*****************************************************************/ 04803000
*                                                                  1232 04804000
*   SETRC=0;                        /*                       @Y30LB33*/ 04805000
@RF01230 SLR   @06,@06                                             1232 04806000
         STH   @06,SETRC                                           1232 04807000
*   IF GDTDBG=NULLPTR THEN                                         1233 04808000
         L     @04,@PC00001                                        1233 04809000
         C     @06,GDTDBG(,@04)                                    1233 04810000
         BE    @RT01233                                            1233 04811000
*     ;                                                            1234 04812000
*   ELSE                                                           1235 04813000
*     DO;                                                          1235 04814000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 04815000
         LA    DMPINDEX,DUMPAREA                                   1236 04816000
*       DMPITMNM='RVVI';                                           1237 04817000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           1237 04818000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         1237 04819000
         MVC   DMPITMNM(4,DMPINDEX),@CC02500                       1237 04820000
*       DMPITMPT=ADDR(RVVI);                                       1238 04821000
         ST    RVVIPTR,DMPITMPT(,DMPINDEX)                         1238 04822000
*       DMPITMLN=LENGTH(RVVI);                                     1239 04823000
         MVC   DMPITMLN(2,DMPINDEX),@CH02621                       1239 04824000
*       DMPITMTP='H';                                              1240 04825000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1240 04826000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/ 04827000
         AL    DMPINDEX,@CF00507                                   1241 04828000
*       DMPTRM=DMPTRMVL;                                           1242 04829000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1242 04830000
*     END;                          /*                       @Y30LB33*/ 04831000
*   IF GDTDBG=NULLPTR THEN                                         1244 04832000
@RT01233 L     @06,@PC00001                                        1244 04833000
         L     @06,GDTDBG(,@06)                                    1244 04834000
         LTR   @06,@06                                             1244 04835000
         BZ    @RT01244                                            1244 04836000
*     ;                                                            1245 04837000
*   ELSE                                                           1246 04838000
*     CALL IDCDB010(GDTTBL,'LVOB',DUMPADDR);/*               @Y30LB33*/ 04839000
         L     @06,@PC00001                                        1246 04840000
         ST    @06,@AL00001                                        1246 04841000
         LA    @04,@CC02525                                        1246 04842000
         ST    @04,@AL00001+4                                      1246 04843000
         LA    @04,DUMPADDR                                        1246 04844000
         ST    @04,@AL00001+8                                      1246 04845000
         MVI   @AL00001+8,X'80'                                    1246 04846000
         L     @15,GDTDBG(,@06)                                    1246 04847000
         LA    @01,@AL00001                                        1246 04848000
         BALR  @14,@15                                             1246 04849000
*   CALL DIRECTRD;                  /*                       @ZA27752*/ 04850000
@RT01244 BAL   @14,DIRECTRD                                        1247 04851000
*   RESPECIFY                                                      1248 04852000
*     RTNREG RSTD;                                                 1248 04853000
*   TESTRC=RTNREG;                                                 1249 04854000
         LR    TESTRC,RTNREG                                       1249 04855000
*   RESPECIFY                                                      1250 04856000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 04857000
*                                                                  1251 04858000
*   /*****************************************************************/ 04859000
*   /*                                                               */ 04860000
*   /* TEST FOR AN ERROR                                     @Y30LB33*/ 04861000
*   /*                                                               */ 04862000
*   /*****************************************************************/ 04863000
*                                                                  1251 04864000
*   IF TESTRC=4 THEN                                               1251 04865000
         C     TESTRC,@CF00043                                     1251 04866000
         BNE   @RF01251                                            1251 04867000
*     DO;                           /*                       @Y30LB33*/ 04868000
*                                                                  1252 04869000
*       /*************************************************************/ 04870000
*       /*                                                           */ 04871000
*       /* IF WE ARE READING DIRECT, AND WE GET A            @Y30LB33*/ 04872000
*       /* NOT-FOUND, CALL SSCMSG TO PRINT THE REASON        @Y30LB33*/ 04873000
*       /* THEN PRINT MESSAGE IDC2079I                       @Y30LB33*/ 04874000
*       /* AND SET THE RETURN CODE TO 4 AND LASTCOND         @Y30LB33*/ 04875000
*       /* TO 8                                              @Y30LB33*/ 04876000
*       /*                                                           */ 04877000
*       /*************************************************************/ 04878000
*                                                                  1253 04879000
*       IF RVVRDR=ON&REASON=NOTFOUND THEN                          1253 04880000
         TM    RVVRDR(RVVIPTR),B'10000000'                         1253 04881000
         BNO   @RF01253                                            1253 04882000
         CLC   REASON(4),@CF02312                                  1253 04883000
         BNE   @RF01253                                            1253 04884000
*         DO;                       /*                       @Y30LB33*/ 04885000
*           CALL SSCMSG(REASON);    /*                       @Y30LB33*/ 04886000
         LA    @06,REASON                                          1255 04887000
         ST    @06,@AL00001                                        1255 04888000
         LA    @01,@AL00001                                        1255 04889000
         BAL   @14,SSCMSG                                          1255 04890000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 04891000
         L     @06,DDSTRU                                          1256 04892000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      1256 04893000
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/ 04894000
         MVC   DARGSMOD(3,@06),@CC02400                            1257 04895000
*           DARGSENT=MSG2079I;      /*                       @Y30LB33*/ 04896000
         MVI   DARGSENT(@06),X'1B'                                 1258 04897000
*           DARGDBP=ADDR(RVVGROUP); /*                       @Y30LB33*/ 04898000
         LA    @04,RVVGROUP(,RVVIPTR)                              1259 04899000
         ST    @04,DARGDBP(,@06)                                   1259 04900000
*           DARGILP=8;              /*                       @Y30LB33*/ 04901000
         MVC   DARGILP(2,@06),@CH00035                             1260 04902000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/ 04903000
         L     @06,@PC00001                                        1261 04904000
         ST    @06,@AL00001                                        1261 04905000
         LA    @04,@CF00117                                        1261 04906000
         ST    @04,@AL00001+4                                      1261 04907000
         LA    @04,DDSTRU                                          1261 04908000
         ST    @04,@AL00001+8                                      1261 04909000
         MVI   @AL00001+8,X'80'                                    1261 04910000
         L     @15,GDTPRT(,@06)                                    1261 04911000
         LA    @01,@AL00001                                        1261 04912000
         BALR  @14,@15                                             1261 04913000
*           LASTCOND=LASTCC08;      /*                       @Y30LB33*/ 04914000
         L     @06,@PC00001+8                                      1262 04915000
         MVC   LASTCOND(2,@06),@CH00035                            1262 04916000
*           SETRC=04;               /*                       @Y30LB33*/ 04917000
         MVC   SETRC(2),@CH00043                                   1263 04918000
*         END;                      /*                       @Y30LB33*/ 04919000
*                                                                  1264 04920000
*       /*************************************************************/ 04921000
*       /*                                                           */ 04922000
*       /* IF WE GET A DOESN'T-MEET-TESTS, SET               @Y30LB33*/ 04923000
*       /* RETURN CODE TO 4                                  @Y30LB33*/ 04924000
*       /*                                                           */ 04925000
*       /*************************************************************/ 04926000
*                                                                  1265 04927000
*       IF REASON=TSTNOTMT THEN                                    1265 04928000
@RF01253 CLC   REASON(4),@CF02314                                  1265 04929000
         BNE   @RF01265                                            1265 04930000
*         SETRC=4;                  /*                       @Y30LB33*/ 04931000
*                                                                  1266 04932000
         MVC   SETRC(2),@CH00043                                   1266 04933000
*       /*************************************************************/ 04934000
*       /*                                                           */ 04935000
*       /* IF WE WERE READING NEXT AND GOT                   @Y30LB33*/ 04936000
*       /* END-OF-GROUPS, SET RETURN CODE TO 4               @Y30LB33*/ 04937000
*       /*                                                           */ 04938000
*       /*************************************************************/ 04939000
*                                                                  1267 04940000
*       IF RVVRDNR=ON&REASON=NOTFOUND/*                      @Y30LB33*/ 04941000
*         THEN                                                     1267 04942000
@RF01265 TM    RVVRDNR(RVVIPTR),B'01000000'                        1267 04943000
         BNO   @RF01267                                            1267 04944000
         CLC   REASON(4),@CF02312                                  1267 04945000
         BNE   @RF01267                                            1267 04946000
*         SETRC=4;                  /*                       @Y30LB33*/ 04947000
*                                                                  1268 04948000
         MVC   SETRC(2),@CH00043                                   1268 04949000
*       /*************************************************************/ 04950000
*       /*                                                           */ 04951000
*       /* BUT IF NONE OF THE ABOVE, THEN WE HAVE            @Y30LB33*/ 04952000
*       /* AN ERROR, SO CALL SSCMSG TO PRINT THE             @Y30LB33*/ 04953000
*       /* REASON AND SET THE RETURN CODES                   @Y30LB33*/ 04954000
*       /*                                                           */ 04955000
*       /*************************************************************/ 04956000
*                                                                  1269 04957000
*       IF REASON^=NOTFOUND&        /*                       @ZA26069*/ 04958000
*           REASON^=TSTNOTMT THEN   /*                       @ZA26069*/ 04959000
@RF01267 L     @06,REASON                                          1269 04960000
         C     @06,@CF02312                                        1269 04961000
         BE    @RF01269                                            1269 04962000
         C     @06,@CF02314                                        1269 04963000
         BE    @RF01269                                            1269 04964000
*         DO;                       /*                       @ZA26069*/ 04965000
*           SETRC=16;               /*                       @Y30LB33*/ 04966000
         MVC   SETRC(2),@CH00507                                   1271 04967000
*           LASTCOND=LASTCC08;      /*                       @Y30LB33*/ 04968000
         L     @06,@PC00001+8                                      1272 04969000
         MVC   LASTCOND(2,@06),@CH00035                            1272 04970000
*           CALL SSCMSG(REASON);    /*                       @Y30LB33*/ 04971000
         LA    @06,REASON                                          1273 04972000
         ST    @06,@AL00001                                        1273 04973000
         LA    @01,@AL00001                                        1273 04974000
         BAL   @14,SSCMSG                                          1273 04975000
*         END;                      /*                       @Y30LB33*/ 04976000
*     END;                          /*                       @Y30LB33*/ 04977000
@RF01269 DS    0H                                                  1276 04978000
*   RETURN CODE(SETRC);             /*                       @Y30LB33*/ 04979000
@RF01251 LH    @15,SETRC                                           1276 04980000
@EL00015 DS    0H                                                  1276 04981000
@EF00015 DS    0H                                                  1276 04982000
@ER00015 L     @14,@SA00015                                        1276 04983000
         BR    @14                                                 1276 04984000
*   END GRPRDR;                     /*                       @Y30LB33*/ 04985000
*                                                                  1278 04986000
*   /*****************************************************************/ 04987000
*   /*                                                               */ 04988000
*   /* PROCEDURE NAME - DUPPROC                              @Y30LB33*/ 04989000
*   /*                                                       @Y30LB33*/ 04990000
*   /* FUNCTION - TO READ AND PRINT DUPLICATE VOLUME         @ZA00676*/ 04991000
*   /* RECORDS. THE RECORDS ARE READ UNTIL A                 @ZA00676*/ 04992000
*   /* RETURN CODE OF 4 (END OF VOLUME), OR                  @ZA00676*/ 04993000
*   /* AN ERROR RETURN CODE. IF THE INPUT READ               @ZA00676*/ 04994000
*   /* REQUEST BLOCK HAS THE RVVDVOL FLAG ON,                @ZA00676*/ 04995000
*   /* END-OF-FILE WILL BE RETURNED AFTER ALL                @ZA00676*/ 04996000
*   /* RECORDS OF ONE VOLUME ARE PROCESSED. IF               @ZA00676*/ 04997000
*   /* THAT FLAG IS OFF, THE END-OF-FILE WILL                @ZA00676*/ 04998000
*   /* BE RETURNED AFTER ALL DUPLICATE RECORDS               @ZA00676*/ 04999000
*   /* HAVE BEEN PROCESSED.                                  @ZA00676*/ 05000000
*   /*                                                       @Y30LB33*/ 05001000
*   /* INPUT - LASTCOND, READ REQUEST BLOCK, AND THE         @Y30LB33*/ 05002000
*   /* FDTTBL                                                @Y30LB33*/ 05003000
*   /*                                                       @Y30LB33*/ 05004000
*   /* OUTPUT - RETURN CODE AND LASTCOND OF ZERO             @Y30LB33*/ 05005000
*   /* FOR NORMAL PROCESSING, RETURN CODE                    @Y30LB33*/ 05006000
*   /* OF 4 AND LASTCOND OF ZERO FOR END                     @Y30LB33*/ 05007000
*   /* OF FILE. RETURN CODE OF 16 AND                        @Y30LB33*/ 05008000
*   /* LASTCOND OF 8 FOR A TERMINATION ERROR.                @Y30LB33*/ 05009000
*   /*                                                               */ 05010000
*   /*****************************************************************/ 05011000
*                                                                  1278 05012000
*DUPPROC:                                                          1278 05013000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 05014000
DUPPROC  ST    @14,@SA00016                                        1278 05015000
*   OLDERID2=NEWERID2;                                             1279 05016000
         L     @04,@PC00001                                        1279 05017000
         L     @04,GDTTR2(,@04)                                    1279 05018000
         MVC   @TS00001(95),NEWERID2(@04)                          1279 05019000
         MVC   OLDERID2(95,@04),@TS00001                           1279 05020000
*   NEWID2='LVPA';                  /*                       @Y30LB33*/ 05021000
         MVC   NEWID2(4,@04),@CC02529                              1280 05022000
*   TESTRC=0;                       /*                       @Y30LB33*/ 05023000
*                                                                  1281 05024000
         SLR   TESTRC,TESTRC                                       1281 05025000
*   /*****************************************************************/ 05026000
*   /*                                                               */ 05027000
*   /* READ DUPLICATE VOLUME RECORDS AND PRINT               @Y30LB33*/ 05028000
*   /* EACH ONE UNTIL AN END-OF-FILE OR RECORD-              @Y30LB33*/ 05029000
*   /* NOT FOUND, OR ERROR CONDITION                         @Y30LB33*/ 05030000
*   /*                                                               */ 05031000
*   /*****************************************************************/ 05032000
*                                                                  1282 05033000
*   DO WHILE(TESTRC=0);             /*                       @Y30LB33*/ 05034000
*                                                                  1282 05035000
         B     @DE01282                                            1282 05036000
@DL01282 DS    0H                                                  1283 05037000
*     /***************************************************************/ 05038000
*     /*                                                             */ 05039000
*     /* CALL THE VOLUME READER TO READ THE RECORD           @Y30LB33*/ 05040000
*     /*                                                             */ 05041000
*     /***************************************************************/ 05042000
*                                                                  1283 05043000
*     CALL VOLRDR;                  /*                       @Y30LB33*/ 05044000
         BAL   @14,VOLRDR                                          1283 05045000
*     RESPECIFY                                                    1284 05046000
*       RTNREG RSTD;                                               1284 05047000
*     TESTRC=RTNREG;                                               1285 05048000
         LR    TESTRC,RTNREG                                       1285 05049000
*     RESPECIFY                                                    1286 05050000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 05051000
*                                                                  1286 05052000
*     /***************************************************************/ 05053000
*     /*                                                             */ 05054000
*     /* CALL THE VOLUME FORMATTER TO CONVERT THE            @Y30LB33*/ 05055000
*     /* RECORD FOR PRINTING                                 @Y30LB33*/ 05056000
*     /*                                                             */ 05057000
*     /***************************************************************/ 05058000
*                                                                  1287 05059000
*     IF TESTRC=0 THEN                                             1287 05060000
         LTR   TESTRC,TESTRC                                       1287 05061000
         BNZ   @RF01287                                            1287 05062000
*       CALL VOLFMTR;               /*                       @Y30LB33*/ 05063000
         BAL   @14,VOLFMTR                                         1288 05064000
*     RESPECIFY                                                    1289 05065000
*       RTNREG RSTD;                                               1289 05066000
@RF01287 DS    0H                                                  1290 05067000
*     TESTRC=RTNREG;                                               1290 05068000
         LR    TESTRC,RTNREG                                       1290 05069000
*     RESPECIFY                                                    1291 05070000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 05071000
*                                                                  1291 05072000
*     /***************************************************************/ 05073000
*     /*                                                             */ 05074000
*     /* CALL THE VOLUME PRINTER TO PRINT THE                @Y30LB33*/ 05075000
*     /* RECORD                                              @Y30LB33*/ 05076000
*     /*                                                             */ 05077000
*     /***************************************************************/ 05078000
*                                                                  1292 05079000
*     IF TESTRC=0 THEN                                             1292 05080000
         LTR   TESTRC,TESTRC                                       1292 05081000
         BNZ   @RF01292                                            1292 05082000
*       CALL VOLPRNT;               /*                       @Y30LB33*/ 05083000
         BAL   @14,VOLPRNT                                         1293 05084000
*     RESPECIFY                                                    1294 05085000
*       RTNREG RSTD;                                               1294 05086000
@RF01292 DS    0H                                                  1295 05087000
*     TESTRC=RTNREG;                                               1295 05088000
         LR    TESTRC,RTNREG                                       1295 05089000
*     RESPECIFY                                                    1296 05090000
*       RTNREG UNRSTD;              /*                       @Y30LB33*/ 05091000
*                                                                  1296 05092000
*     /***************************************************************/ 05093000
*     /*                                                             */ 05094000
*     /* SET UP THE REQUEST BLOCK TO READ THE NEXT           @Y30LB33*/ 05095000
*     /* RECORD. EVEN THOUGH WE ARE PRINTING ONLY            @Y30LB33*/ 05096000
*     /* ONE VOLUME'S DUPLICATES, WE MUST READ               @Y30LB33*/ 05097000
*     /* UNTIL END-OF-FILE SINCE THERE CAN BE MORE           @Y30LB33*/ 05098000
*     /* THAN ONE DUPLICATE OF A VOLUME                      @Y30LB33*/ 05099000
*     /*                                                             */ 05100000
*     /***************************************************************/ 05101000
*                                                                  1297 05102000
*     IF TESTRC=0 THEN                                             1297 05103000
         LTR   TESTRC,TESTRC                                       1297 05104000
         BNZ   @RF01297                                            1297 05105000
*       DO;                         /*                       @Y30LB33*/ 05106000
*         RVVSVOL=ON;               /*                       @Y30LB33*/ 05107000
         OI    RVVSVOL(RVVIPTR),B'00000001'                        1299 05108000
*         RVVRDR=OFF;               /*                       @Y30LB33*/ 05109000
*         RVVRDNR=ON;               /*                       @Y30LB33*/ 05110000
         OI    RVVRDNR(RVVIPTR),B'01000000'                        1301 05111000
         NI    RVVRDR(RVVIPTR),B'01111111'                         1301 05112000
*         RVVSDUP=ON;               /*                       @Y30LB33*/ 05113000
         OI    RVVSDUP(RVVIPTR),B'00000010'                        1302 05114000
*         RVVOLUME=DUPSERNO;        /*                       @Y30LB33*/ 05115000
         L     @04,DUPVPTR                                         1303 05116000
         MVC   RVVOLUME(6,RVVIPTR),DUPSERNO(@04)                   1303 05117000
*         RVVDUPID=DUPID;           /*                       @Y30LB33*/ 05118000
         MVC   RVVDUPID(1,RVVIPTR),DUPID+1(@04)                    1304 05119000
*       END;                        /*                       @Y30LB33*/ 05120000
*   END;                            /*                       @Y30LB33*/ 05121000
@RF01297 DS    0H                                                  1306 05122000
@DE01282 LTR   TESTRC,TESTRC                                       1306 05123000
         BZ    @DL01282                                            1306 05124000
*   RETURN CODE(TESTRC);            /*                       @Y30LB33*/ 05125000
         LR    @15,TESTRC                                          1307 05126000
@EL00016 DS    0H                                                  1307 05127000
@EF00016 DS    0H                                                  1307 05128000
@ER00016 L     @14,@SA00016                                        1307 05129000
         BR    @14                                                 1307 05130000
*   END DUPPROC;                    /*                       @Y30LB33*/ 05131000
*                                                                  1309 05132000
*   /*****************************************************************/ 05133000
*   /*                                                               */ 05134000
*   /* PROCEDURE NAME - VOLFMTR                              @Y30LB33*/ 05135000
*   /*                                                       @Y30LB33*/ 05136000
*   /* FUNCTION - TO PREPARE THE VOLUME DATA FOR             @Y30LB33*/ 05137000
*   /* PRINTING BY CREATING A TEXT PROCESSOR                 @Y30LB33*/ 05138000
*   /* ARGUMENT LIST AND CONVERTING BIT                      @Y30LB33*/ 05139000
*   /* PATTERNS TO PRINTABLE FIELDS                          @Y30LB33*/ 05140000
*   /*                                                       @Y30LB33*/ 05141000
*   /* INPUT - VOLUME OR DUPLICATE VOLUME RECORD             @Y30LB33*/ 05142000
*   /* AND THE FDTTBL                                        @Y30LB33*/ 05143000
*   /*                                                       @Y30LB33*/ 05144000
*   /* OUTPUT - RETURN CODE OF ZERO                          @Y30LB33*/ 05145000
*   /*                                                               */ 05146000
*   /*****************************************************************/ 05147000
*                                                                  1309 05148000
*VOLFMTR:                                                          1309 05149000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 05150000
VOLFMTR  ST    @14,12(,@13)                                        1309 05151000
*   OLDERID2=NEWERID2;                                             1310 05152000
         L     @04,@PC00001                                        1310 05153000
         L     @04,GDTTR2(,@04)                                    1310 05154000
         MVC   @TS00001(95),NEWERID2(@04)                          1310 05155000
         MVC   OLDERID2(95,@04),@TS00001                           1310 05156000
*   NEWID2='LVRA';                  /*                       @Y30LB33*/ 05157000
         MVC   NEWID2(4,@04),@CC02533                              1311 05158000
*   TESTRC=0;                       /*                       @Y30LB33*/ 05159000
*                                                                  1312 05160000
         SLR   TESTRC,TESTRC                                       1312 05161000
*   /*****************************************************************/ 05162000
*   /*                                                               */ 05163000
*   /* INITIALIZE THE DARGLIST                               @Y30LB33*/ 05164000
*   /*                                                               */ 05165000
*   /*****************************************************************/ 05166000
*                                                                  1313 05167000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 05168000
         L     @06,DDSTRU                                          1313 05169000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      1313 05170000
*   DARGSMOD=MODLV0;                /*                       @Y30LB33*/ 05171000
         MVC   DARGSMOD(3,@06),@CC02396                            1314 05172000
*   DARGDBP=ADDR(VOLAREA);          /*                       @Y30LB33*/ 05173000
         LA    @04,VOLAREA                                         1315 05174000
         ST    @04,DARGDBP(,@06)                                   1315 05175000
*   DARGILP=LENGTH(VOLAREA);        /*                       @Y30LB33*/ 05176000
*                                                                  1316 05177000
         MVC   DARGILP(2,@06),@CH02625                             1316 05178000
*   /*****************************************************************/ 05179000
*   /*                                                               */ 05180000
*   /* TEST FOR A BASE VOLUME OR BASE                        @ZDR2056*/ 05181000
*   /* VOLUME PLACE HOLDER                                   @ZDR2056*/ 05182000
*   /*                                                               */ 05183000
*   /*****************************************************************/ 05184000
*                                                                  1317 05185000
*   IF BCDBASE=ON|BASHOLD=ON THEN                                  1317 05186000
         L     @06,BCDVPTR                                         1317 05187000
         TM    BCDBASE(@06),B'00100000'                            1317 05188000
         BO    @RT01317                                            1317 05189000
         TM    BASHOLD(BASEVPTR),B'10000000'                       1317 05190000
         BNO   @RF01317                                            1317 05191000
@RT01317 DS    0H                                                  1318 05192000
*     DO;                           /*                       @ZDR2056*/ 05193000
*                                                                  1319 05194000
*       /*************************************************************/ 05195000
*       /*                                                           */ 05196000
*       /* SET UP A USAGE REPORT                             @Y30LB33*/ 05197000
*       /*                                                           */ 05198000
*       /*************************************************************/ 05199000
*                                                                  1319 05200000
*       IF ADDR(USAGE)>0 THEN                                      1319 05201000
         L     @06,@PC00001+4                                      1319 05202000
         L     @06,FDTPTR+56(,@06)                                 1319 05203000
         LTR   @06,@06                                             1319 05204000
         BNP   @RF01319                                            1319 05205000
*         DO;                       /*                       @Y30LB33*/ 05206000
*           DARGSENT=VOLULINE;      /*                       @Y30LB33*/ 05207000
         L     @06,DDSTRU                                          1321 05208000
         MVI   DARGSENT(@06),X'13'                                 1321 05209000
*           COUNTER=0;              /*                       @G24LB37*/ 05210000
*                                                                  1322 05211000
         SLR   COUNTER,COUNTER                                     1322 05212000
*           /*********************************************************/ 05213000
*           /*                                                       */ 05214000
*           /* IF SPACE-DOWN-LEVEL FLAG IS ON,               @Y30LB33*/ 05215000
*           /* PUT YES INTO PRINT FIELD, ELSE BLANK          @G24LB37*/ 05216000
*           /*                                                       */ 05217000
*           /*********************************************************/ 05218000
*                                                                  1323 05219000
*           IF BASDLSF=ON THEN                                     1323 05220000
         TM    BASDLSF(BASEVPTR),B'10000000'                       1323 05221000
         BNO   @RF01323                                            1323 05222000
*             VOLTRNS1=YESCHAR;     /*                       @G24LB37*/ 05223000
         MVC   VOLTRNS1(3),YESCHAR                                 1324 05224000
*           ELSE                                                   1325 05225000
*             VOLTRNS1='   ';       /*                       @G24LB37*/ 05226000
*                                                                  1325 05227000
         B     @RC01323                                            1325 05228000
@RF01323 MVC   VOLTRNS1(3),@CC02534                                1325 05229000
*           /*********************************************************/ 05230000
*           /*                                                       */ 05231000
*           /* IF THE VOLUME IS MOUNTED THEN COUNT           @G24LB37*/ 05232000
*           /* THE NUMBER OF CPU'S TO WHICH THE              @G24LB37*/ 05233000
*           /* VOLUME IS MOUNTED TO PRINT IT                 @G24LB37*/ 05234000
*           /*                                                       */ 05235000
*           /*********************************************************/ 05236000
*                                                                  1326 05237000
*           IF BASCPUID>0 THEN                                     1326 05238000
@RC01323 CLC   BASCPUID(2,BASEVPTR),@CH00117                       1326 05239000
         BNH   @RF01326                                            1326 05240000
*             DO;                   /*                       @G24LB37*/ 05241000
*               DO X=1 TO 8;        /*                       @G24LB37*/ 05242000
         LA    X,1                                                 1328 05243000
@DL01328 DS    0H                                                  1329 05244000
*                 IF(BITMASK(X)&CPUID1)^='00'X THEN                1329 05245000
         LA    @06,BITMASK-1(X)                                    1329 05246000
         MVC   @TS00001(1),0(@06)                                  1329 05247000
         NC    @TS00001(1),CPUID1(BASEVPTR)                        1329 05248000
         CLI   @TS00001,X'00'                                      1329 05249000
         BE    @RF01329                                            1329 05250000
*                   COUNTER=COUNTER+1;/*                     @G24LB37*/ 05251000
         AL    COUNTER,@CF00221                                    1330 05252000
*               END;                /*                       @G24LB37*/ 05253000
@RF01329 AL    X,@CF00221                                          1331 05254000
         C     X,@CF00035                                          1331 05255000
         BNH   @DL01328                                            1331 05256000
*               DO X=1 TO 8;        /*                       @G24LB37*/ 05257000
         LA    X,1                                                 1332 05258000
@DL01332 DS    0H                                                  1333 05259000
*                 IF(BITMASK(X)&CPUID2)^='00'X THEN                1333 05260000
         LA    @06,BITMASK-1(X)                                    1333 05261000
         MVC   @TS00001(1),0(@06)                                  1333 05262000
         NC    @TS00001(1),CPUID2(BASEVPTR)                        1333 05263000
         CLI   @TS00001,X'00'                                      1333 05264000
         BE    @RF01333                                            1333 05265000
*                   COUNTER=COUNTER+1;/*                     @G24LB37*/ 05266000
         AL    COUNTER,@CF00221                                    1334 05267000
*               END;                /*                       @G24LB37*/ 05268000
@RF01333 AL    X,@CF00221                                          1335 05269000
         C     X,@CF00035                                          1335 05270000
         BNH   @DL01332                                            1335 05271000
*               VOLTRNS2=COUNTER;   /*                       @G24LB37*/ 05272000
         STCM  COUNTER,3,VOLTRNS2                                  1336 05273000
*             END;                  /*                       @G24LB37*/ 05274000
*           ELSE                                                   1338 05275000
*             VOLTRNS2='0000'X;     /*                       @G24LB37*/ 05276000
         B     @RC01326                                            1338 05277000
@RF01326 MVC   VOLTRNS2(2),@CB02535                                1338 05278000
*                                                                  1339 05279000
*           /*********************************************************/ 05280000
*           /*                                                       */ 05281000
*           /* INSERT FREE SPACE FIELD IF NOT NULL           #Y30LB33*/ 05282000
*           /*                                                       */ 05283000
*           /*********************************************************/ 05284000
*                                                                  1339 05285000
*           IF BASFRESP^='FFFF'X THEN                              1339 05286000
@RC01326 CLC   BASFRESP(2,BASEVPTR),@CH02536                       1339 05287000
         BE    @RF01339                                            1339 05288000
*             DO;                   /*                       @Y30LB33*/ 05289000
*               DARGCNT=DARGCNT+1;  /*                       @Y30LB33*/ 05290000
         L     @06,DDSTRU                                          1341 05291000
         LA    @04,1                                               1341 05292000
         LH    @03,DARGCNT(,@06)                                   1341 05293000
         ALR   @03,@04                                             1341 05294000
         STH   @03,DARGCNT(,@06)                                   1341 05295000
*               DARGINS(DARGCNT)=1; /*                       @Y30LB33*/ 05296000
         SLA   @03,3                                               1342 05297000
         STH   @04,DARGINS-8(@03,@06)                              1342 05298000
*               DARGINL(DARGCNT)=2; /*                       @Y30LB33*/ 05299000
         LA    @04,2                                               1343 05300000
         STH   @04,DARGINL-8(@03,@06)                              1343 05301000
*               DARGDTM(DARGCNT)=ADDR(BASFRESP);/*           @Y30LB33*/ 05302000
         LA    @04,BASFRESP(,BASEVPTR)                             1344 05303000
         ST    @04,DARGDTM-8(@03,@06)                              1344 05304000
*             END;                  /*                       @Y30LB33*/ 05305000
*                                                                  1345 05306000
*           /*********************************************************/ 05307000
*           /*                                                       */ 05308000
*           /* INSERT LARGEST FREE EXTENT IF                 @Y30LB33*/ 05309000
*           /* NOT NULL                                      @Y30LB33*/ 05310000
*           /*                                                       */ 05311000
*           /*********************************************************/ 05312000
*                                                                  1346 05313000
*           IF BASLEXT^='FFFF'X THEN                               1346 05314000
@RF01339 CLC   BASLEXT(2,BASEVPTR),@CH02536                        1346 05315000
         BE    @RF01346                                            1346 05316000
*             DO;                   /*                       @Y30LB33*/ 05317000
*               DARGCNT=DARGCNT+1;  /*                       @Y30LB33*/ 05318000
         L     @06,DDSTRU                                          1348 05319000
         LA    @04,1                                               1348 05320000
         AH    @04,DARGCNT(,@06)                                   1348 05321000
         STH   @04,DARGCNT(,@06)                                   1348 05322000
*               DARGINS(DARGCNT)=2; /*                       @Y30LB33*/ 05323000
         LA    @03,2                                               1349 05324000
         SLA   @04,3                                               1349 05325000
         STH   @03,DARGINS-8(@04,@06)                              1349 05326000
*               DARGINL(DARGCNT)=2; /*                       @Y30LB33*/ 05327000
         STH   @03,DARGINL-8(@04,@06)                              1350 05328000
*               DARGDTM(DARGCNT)=ADDR(BASLEXT);/*            @Y30LB33*/ 05329000
         LA    @03,BASLEXT(,BASEVPTR)                              1351 05330000
         ST    @03,DARGDTM-8(@04,@06)                              1351 05331000
*             END;                  /*                       @Y30LB33*/ 05332000
*                                                                  1352 05333000
*           /*********************************************************/ 05334000
*           /*                                                       */ 05335000
*           /* INSERT NUMBER OF FREE EXTENTS IF              @Y30LB33*/ 05336000
*           /* NOT NULL                                      @Y30LB33*/ 05337000
*           /*                                                       */ 05338000
*           /*********************************************************/ 05339000
*                                                                  1353 05340000
*           IF BASFREXT^='FFFF'X THEN                              1353 05341000
@RF01346 CLC   BASFREXT(4,BASEVPTR),@CF02536                       1353 05342000
         BE    @RF01353                                            1353 05343000
*             DO;                   /*                       @Y30LB33*/ 05344000
*               DARGCNT=DARGCNT+1;  /*                       @Y30LB33*/ 05345000
         L     @06,DDSTRU                                          1355 05346000
         LA    @04,1                                               1355 05347000
         AH    @04,DARGCNT(,@06)                                   1355 05348000
         STH   @04,DARGCNT(,@06)                                   1355 05349000
*               DARGINS(DARGCNT)=3; /*                       @Y30LB33*/ 05350000
         SLA   @04,3                                               1356 05351000
         LA    @03,3                                               1356 05352000
         STH   @03,DARGINS-8(@04,@06)                              1356 05353000
*               DARGINL(DARGCNT)=4; /*                       @Y30LB33*/ 05354000
         LA    @03,4                                               1357 05355000
         STH   @03,DARGINL-8(@04,@06)                              1357 05356000
*               DARGDTM(DARGCNT)=ADDR(BASFREXT);/*           @Y30LB33*/ 05357000
         LA    @03,BASFREXT(,BASEVPTR)                             1358 05358000
         ST    @03,DARGDTM-8(@04,@06)                              1358 05359000
*             END;                  /*                       @Y30LB33*/ 05360000
*                                                                  1359 05361000
*           /*********************************************************/ 05362000
*           /*                                                       */ 05363000
*           /* CALCULATE AND INSERT THE AVERAGE FREE         @Y30LB33*/ 05364000
*           /* EXTENT IF THE NUMBER OF FREE EXTENTS          @Y30LB33*/ 05365000
*           /* AND AMOUNT OF FREE SPACE IS NOT NULL          @Y30LB33*/ 05366000
*           /*                                                       */ 05367000
*           /*********************************************************/ 05368000
*                                                                  1360 05369000
*           IF BASFREXT>0&BASFRESP^='FFFF'X&BASFREXT^='FFFF'X THEN 1360 05370000
@RF01353 L     @06,BASFREXT(,BASEVPTR)                             1360 05371000
         CL    @06,@CF00117                                        1360 05372000
         BNH   @RF01360                                            1360 05373000
         LH    @04,BASFRESP(,BASEVPTR)                             1360 05374000
         N     @04,@CF02648                                        1360 05375000
         C     @04,@CF02536                                        1360 05376000
         BE    @RF01360                                            1360 05377000
         CL    @06,@CF02536                                        1360 05378000
         BE    @RF01360                                            1360 05379000
*             DO;                   /*                       @Y30LB33*/ 05380000
*               DARGCNT=DARGCNT+1;  /*                       @Y30LB33*/ 05381000
         L     @03,DDSTRU                                          1362 05382000
         LA    @15,1                                               1362 05383000
         AH    @15,DARGCNT(,@03)                                   1362 05384000
         STH   @15,DARGCNT(,@03)                                   1362 05385000
*               DARGINS(DARGCNT)=4; /*                       @Y30LB33*/ 05386000
         LA    @14,4                                               1363 05387000
         SLA   @15,3                                               1363 05388000
         STH   @14,DARGINS-8(@15,@03)                              1363 05389000
*               DARGINL(DARGCNT)=4; /*                       @Y30LB33*/ 05390000
         STH   @14,DARGINL-8(@15,@03)                              1364 05391000
*               DARGDTM(DARGCNT)=ADDR(VOLAVGFD);/*           @Y30LB33*/ 05392000
         LA    @14,VOLAVGFD                                        1365 05393000
         ST    @14,DARGDTM-8(@15,@03)                              1365 05394000
*               VOLAVGFD=BASFRESP/BASFREXT;/*                @Y30LB33*/ 05395000
         LR    @01,@04                                             1366 05396000
         SLR   @00,@00                                             1366 05397000
         DR    @00,@06                                             1366 05398000
         ST    @01,VOLAVGFD                                        1366 05399000
*             END;                  /*                       @Y30LB33*/ 05400000
*                                                                  1367 05401000
*           /*********************************************************/ 05402000
*           /*                                                       */ 05403000
*           /* INSERT THE LAST MOUNT DATE IF NOT             @Y30LB33*/ 05404000
*           /* NULL                                          @Y30LB33*/ 05405000
*           /*                                                       */ 05406000
*           /*********************************************************/ 05407000
*                                                                  1368 05408000
*           IF BASDLMTD^='    ' THEN                               1368 05409000
@RF01360 CLC   BASDLMTD(4,BASEVPTR),@CC02511                       1368 05410000
         BE    @RF01368                                            1368 05411000
*             DO;                   /*                       @Y30LB33*/ 05412000
*               DARGCNT=DARGCNT+1;  /*                       @Y30LB33*/ 05413000
         L     @06,DDSTRU                                          1370 05414000
         LA    @04,1                                               1370 05415000
         AH    @04,DARGCNT(,@06)                                   1370 05416000
         STH   @04,DARGCNT(,@06)                                   1370 05417000
*               DARGINS(DARGCNT)=5; /*                       @Y30LB33*/ 05418000
         SLA   @04,3                                               1371 05419000
         LA    @03,5                                               1371 05420000
         STH   @03,DARGINS-8(@04,@06)                              1371 05421000
*               DARGINL(DARGCNT)=4; /*                       @Y30LB33*/ 05422000
         LA    @03,4                                               1372 05423000
         STH   @03,DARGINL-8(@04,@06)                              1372 05424000
*               DARGDTM(DARGCNT)=ADDR(BASDLMTD);/*           @Y30LB33*/ 05425000
         LA    @03,BASDLMTD(,BASEVPTR)                             1373 05426000
         ST    @03,DARGDTM-8(@04,@06)                              1373 05427000
*             END;                  /*                       @Y30LB33*/ 05428000
*                                                                  1374 05429000
*           /*********************************************************/ 05430000
*           /*                                                       */ 05431000
*           /* INSERT THE EXPIRATION DATE IF NOT             @Y30LB33*/ 05432000
*           /* NULL                                          @Y30LB33*/ 05433000
*           /*                                                       */ 05434000
*           /*********************************************************/ 05435000
*                                                                  1375 05436000
*           IF BASEXPDT^='FFFFFFFF'X THEN                          1375 05437000
@RF01368 CLC   BASEXPDT(4,BASEVPTR),@CB02537                       1375 05438000
         BE    @RF01375                                            1375 05439000
*             DO;                   /*                       @Y30LB33*/ 05440000
*               DARGCNT=DARGCNT+1;  /*                       @Y30LB33*/ 05441000
         L     @06,DDSTRU                                          1377 05442000
         LA    @04,1                                               1377 05443000
         AH    @04,DARGCNT(,@06)                                   1377 05444000
         STH   @04,DARGCNT(,@06)                                   1377 05445000
*               DARGINS(DARGCNT)=6; /*                       @Y30LB33*/ 05446000
         SLA   @04,3                                               1378 05447000
         LA    @03,6                                               1378 05448000
         STH   @03,DARGINS-8(@04,@06)                              1378 05449000
*               DARGINL(DARGCNT)=4; /*                       @Y30LB33*/ 05450000
         LA    @03,4                                               1379 05451000
         STH   @03,DARGINL-8(@04,@06)                              1379 05452000
*               DARGDTM(DARGCNT)=ADDR(BASEXPDT);/*           @Y30LB33*/ 05453000
         LA    @03,BASEXPDT(,BASEVPTR)                             1380 05454000
         ST    @03,DARGDTM-8(@04,@06)                              1380 05455000
*             END;                  /*                       @Y30LB33*/ 05456000
*         END;                      /* END OF USAGE REPORT         1382 05457000
*                                      PREPARATION           @Y30LB33*/ 05458000
*                                                                  1383 05459000
*       /*************************************************************/ 05460000
*       /*                                                           */ 05461000
*       /* IF NOT A USAGE REPORT, PREPARE A STATUS           @Y30LB33*/ 05462000
*       /* REPORT                                            @Y30LB33*/ 05463000
*       /*                                                           */ 05464000
*       /*************************************************************/ 05465000
*                                                                  1383 05466000
*       ELSE                                                       1383 05467000
*         DO;                       /*                       @Y30LB33*/ 05468000
         B     @RC01319                                            1383 05469000
@RF01319 DS    0H                                                  1384 05470000
*           DARGSENT=VOLSLINE;      /*                       @Y30LB33*/ 05471000
*                                                                  1384 05472000
         L     @06,DDSTRU                                          1384 05473000
         MVI   DARGSENT(@06),X'1C'                                 1384 05474000
*           /*********************************************************/ 05475000
*           /*                                                       */ 05476000
*           /* TRANSLATE THE STATE FIELD                     @Y30LB33*/ 05477000
*           /*                                                       */ 05478000
*           /*********************************************************/ 05479000
*                                                                  1385 05480000
*           VOLTRNST='     ';       /*                       @Y30LB33*/ 05481000
         MVC   VOLTRNST(5),@CC02538                                1385 05482000
*           IF BASHOLD=OFF THEN                                    1386 05483000
         TM    BASHOLD(BASEVPTR),B'10000000'                       1386 05484000
         BNZ   @RF01386                                            1386 05485000
*             DO;                   /*                       @ZDR2056*/ 05486000
*               IF BASINAC=ON THEN  /*                       @Y30LB33*/ 05487000
         TM    BASINAC(BASEVPTR),B'00000100'                       1388 05488000
         BNO   @RF01388                                            1388 05489000
*                 VOLTRNST=INACHAR; /*                       @Y30LB33*/ 05490000
         MVC   VOLTRNST(5),INACHAR                                 1389 05491000
*               ELSE                                               1390 05492000
*                 VOLTRNST=ACTCHAR; /*                       @Y30LB33*/ 05493000
         B     @RC01388                                            1390 05494000
@RF01388 MVC   VOLTRNST(5),ACTCHAR                                 1390 05495000
*             END;                  /*                       @ZDR2056*/ 05496000
*           ELSE                                                   1392 05497000
*             VOLTRNST=PHOLDER;     /*                       @ZDR2056*/ 05498000
*                                                                  1392 05499000
         B     @RC01386                                            1392 05500000
@RF01386 MVC   VOLTRNST(5),PHOLDER                                 1392 05501000
*           /*********************************************************/ 05502000
*           /*                                                       */ 05503000
*           /* TRANSLATE THE TYPE FIELD                      @Y30LB33*/ 05504000
*           /*                                                       */ 05505000
*           /*********************************************************/ 05506000
*                                                                  1393 05507000
*           VOLTRNTY='    ';        /*                       @Y30LB33*/ 05508000
@RC01386 MVC   VOLTRNTY(4),@CC02511                                1393 05509000
*           IF BASHOLD=OFF THEN                                    1394 05510000
         TM    BASHOLD(BASEVPTR),B'10000000'                       1394 05511000
         BNZ   @RF01394                                            1394 05512000
*             DO;                   /*                       @ZDR2056*/ 05513000
*               IF BASGENUS=ON THEN /*                       @Y30LB33*/ 05514000
         TM    BASGENUS(BASEVPTR),B'00010000'                      1396 05515000
         BNO   @RF01396                                            1396 05516000
*                 VOLTRNTY=GENCHAR; /*                       @Y30LB33*/ 05517000
         MVC   VOLTRNTY(4),GENCHAR                                 1397 05518000
*               IF BASRSTD=ON THEN  /*                       @Y30LB33*/ 05519000
@RF01396 TM    BASRSTD(BASEVPTR),B'00001000'                       1398 05520000
         BNO   @RF01398                                            1398 05521000
*                 VOLTRNTY=RSTRCHAR;/*                       @Y30LB33*/ 05522000
         MVC   VOLTRNTY(4),RSTRCHAR                                1399 05523000
*             END;                  /*                       @ZDR2056*/ 05524000
*           ELSE                                                   1401 05525000
*             VOLTRNTY=BASECHAR;    /*                       @ZDR2056*/ 05526000
*                                                                  1401 05527000
         B     @RC01394                                            1401 05528000
@RF01394 MVC   VOLTRNTY(4),BASECHAR                                1401 05529000
*           /*********************************************************/ 05530000
*           /*                                                       */ 05531000
*           /* TRANSLATE THE ATTRIBUTE FIELD                 @Y30LB33*/ 05532000
*           /*                                                       */ 05533000
*           /*********************************************************/ 05534000
*                                                                  1402 05535000
*           VOLTRNAT='    ';        /*                       @Y30LB33*/ 05536000
@RC01394 MVC   VOLTRNAT(4),@CC02511                                1402 05537000
*           IF BASHOLD=OFF THEN                                    1403 05538000
         TM    BASHOLD(BASEVPTR),B'10000000'                       1403 05539000
         BNZ   @RF01403                                            1403 05540000
*             DO;                   /*                       @ZDR2056*/ 05541000
*               IF BASBIND=ON THEN  /*                       @Y30LB33*/ 05542000
         TM    BASBIND(BASEVPTR),B'00000010'                       1405 05543000
         BNO   @RF01405                                            1405 05544000
*                 VOLTRNAT(1)=BCHAR;/*                       @Y30LB33*/ 05545000
         MVC   VOLTRNAT(1),BCHAR                                   1406 05546000
*               IF BASRONLY=ON THEN /*                       @Y30LB33*/ 05547000
@RF01405 TM    BASRONLY(BASEVPTR),B'01000000'                      1407 05548000
         BNO   @RF01407                                            1407 05549000
*                 VOLTRNAT(2)=RCHAR;/*                       @Y30LB33*/ 05550000
         MVC   VOLTRNAT+1(1),RCHAR                                 1408 05551000
*               IF BASDAERA=ON THEN /*                       @Y30LB33*/ 05552000
@RF01407 TM    BASDAERA(BASEVPTR),B'10000000'                      1409 05553000
         BNO   @RF01409                                            1409 05554000
*                 VOLTRNAT(3)=DCHAR;/*                       @Y30LB33*/ 05555000
         MVC   VOLTRNAT+2(1),DCHAR                                 1410 05556000
*               IF BASEXCL=ON THEN  /*                       @Y30LB33*/ 05557000
@RF01409 TM    BASEXCL(BASEVPTR),B'00000001'                       1411 05558000
         BNO   @RF01411                                            1411 05559000
*                 VOLTRNAT(4)=ECHAR;/*                       @Y30LB33*/ 05560000
         MVC   VOLTRNAT+3(1),ECHAR                                 1412 05561000
*             END;                  /*                       @ZDR2056*/ 05562000
@RF01411 DS    0H                                                  1414 05563000
*                                                                  1414 05564000
*           /*********************************************************/ 05565000
*           /*                                                       */ 05566000
*           /* SET UP INSERTS FOR THE LOCATION AND           @Y30LB33*/ 05567000
*           /* EJECT DATE FIELDS. IF THE CARTRIDGES          @Y30LB33*/ 05568000
*           /* HAVE BEEN REASSIGNED, PRINT NO EJECT          @Y30LB33*/ 05569000
*           /* DATE AND PRINT 'REASSIGNED' IN THE            @Y30LB33*/ 05570000
*           /* LOCATION FIELDS. IF THE CARTRIDGES            @Y30LB33*/ 05571000
*           /* HAVE NOT BEEN REASSIGNED, TEST THE            @Y30LB33*/ 05572000
*           /* EJECT DATE. IF THE DATE IS THERE,             @Y30LB33*/ 05573000
*           /* PRINT THE DESTINATION IN THE                  @Y30LB33*/ 05574000
*           /* LOCATION FIELD AND ALSO THE EJECT             @Y30LB33*/ 05575000
*           /* DATE. IF THE EJECT DATE IS NULL, TEST         @Y30LB33*/ 05576000
*           /* THE MSF FIELDS FOR EACH CARTRIDGE. IF         @Y30LB33*/ 05577000
*           /* THE MSF NUMBER IS VALID, PUT THE MSF          @Y30LB33*/ 05578000
*           /* IN THE DESTINATION FIELD. IF AN MSF           @Y30LB33*/ 05579000
*           /* IS NOT VALID, PUT 'NOT IN MSF' IN THE         @Y30LB33*/ 05580000
*           /* DESTINATION FIELD.                            @Y30LB33*/ 05581000
*           /*                                                       */ 05582000
*           /*********************************************************/ 05583000
*                                                                  1414 05584000
*           IF BASHOLD=OFF THEN                                    1414 05585000
@RF01403 TM    BASHOLD(BASEVPTR),B'10000000'                       1414 05586000
         BNZ   @RF01414                                            1414 05587000
*             DO;                   /*                       @ZDR2056*/ 05588000
*               IF BASREASS=ON      /* TEST REASSIGNED       @Y30LB33*/ 05589000
*                 THEN                                             1416 05590000
         TM    BASREASS(BASEVPTR),B'00100000'                      1416 05591000
         BNO   @RF01416                                            1416 05592000
*                 DO;               /*                       @Y30LB33*/ 05593000
*                                                                  1417 05594000
*                   /*************************************************/ 05595000
*                   /*                                               */ 05596000
*                   /* SET UP DESTINATION FIELD              @Y30LB33*/ 05597000
*                   /*                                               */ 05598000
*                   /*************************************************/ 05599000
*                                                                  1418 05600000
*                   BASDEST(1:15)=REASCHAR;/*                @Y30LB33*/ 05601000
         MVC   BASDEST(15,BASEVPTR),REASCHAR                       1418 05602000
*                   BASDEST(16:30)=REASCHAR;/*               @Y30LB33*/ 05603000
         MVC   BASDEST+15(15,BASEVPTR),REASCHAR                    1419 05604000
*                 END;              /*                       @Y30LB33*/ 05605000
*                                                                  1420 05606000
*               /*****************************************************/ 05607000
*               /*                                                   */ 05608000
*               /* IF THE VOLUME HAS BEEN EJECTED,           @Y30LB33*/ 05609000
*               /* SET UP THE EJECT DATE INSERT              @Y30LB33*/ 05610000
*               /*                                                   */ 05611000
*               /*****************************************************/ 05612000
*                                                                  1421 05613000
*               ELSE                                               1421 05614000
*                 DO;               /*                       @Y30LB33*/ 05615000
         B     @RC01416                                            1421 05616000
@RF01416 DS    0H                                                  1422 05617000
*                   IF BASDTREM^='    '/*                    @Y30LB33*/ 05618000
*                     THEN                                         1422 05619000
         CLC   BASDTREM(4,BASEVPTR),@CC02511                       1422 05620000
         BE    @RF01422                                            1422 05621000
*                     DO;           /*                       @Y30LB33*/ 05622000
*                                                                  1423 05623000
*                       /*********************************************/ 05624000
*                       /*                                           */ 05625000
*                       /* SET UP DATE INSERT                @Y30LB33*/ 05626000
*                       /*                                           */ 05627000
*                       /*********************************************/ 05628000
*                                                                  1424 05629000
*                       DARGCNT=DARGCNT+1;/*                 @Y30LB33*/ 05630000
         L     @06,DDSTRU                                          1424 05631000
         LA    @04,1                                               1424 05632000
         LH    @03,DARGCNT(,@06)                                   1424 05633000
         ALR   @03,@04                                             1424 05634000
         STH   @03,DARGCNT(,@06)                                   1424 05635000
*                       DARGINS(DARGCNT)=1;/*                @Y30LB33*/ 05636000
         SLA   @03,3                                               1425 05637000
         STH   @04,DARGINS-8(@03,@06)                              1425 05638000
*                       DARGINL(DARGCNT)=4;/*                @Y30LB33*/ 05639000
         LA    @04,4                                               1426 05640000
         STH   @04,DARGINL-8(@03,@06)                              1426 05641000
*                       DARGDTM(DARGCNT)=ADDR(BASDTREM);/*   @Y30LB33*/ 05642000
         LA    @04,BASDTREM(,BASEVPTR)                             1427 05643000
         ST    @04,DARGDTM-8(@03,@06)                              1427 05644000
*                     END;          /*                       @Y30LB33*/ 05645000
*                                                                  1428 05646000
*                   /*************************************************/ 05647000
*                   /*                                               */ 05648000
*                   /* NO EJECT DATE                         @Y30LB33*/ 05649000
*                   /*                                               */ 05650000
*                   /*************************************************/ 05651000
*                                                                  1429 05652000
*                   ELSE                                           1429 05653000
*                     DO;           /*                       @Y30LB33*/ 05654000
         B     @RC01422                                            1429 05655000
@RF01422 DS    0H                                                  1430 05656000
*                       BASDEST=' ';/*                       @Y30LB33*/ 05657000
         MVI   BASDEST+1(BASEVPTR),C' '                            1430 05658000
         MVC   BASDEST+2(28,BASEVPTR),BASDEST+1(BASEVPTR)          1430 05659000
         MVI   BASDEST(BASEVPTR),C' '                              1430 05660000
*                       IF BASLIB1=NULLFFS THEN/*            @ZM01010*/ 05661000
         CLC   BASLIB1(1,BASEVPTR),NULLFFS                         1431 05662000
         BNE   @RF01431                                            1431 05663000
*                         BASDEST(1:15)=UNKCHAR;/*           @ZM01010*/ 05664000
         MVC   BASDEST(15,BASEVPTR),UNKCHAR                        1432 05665000
*                       ELSE                                       1433 05666000
*                         DO;       /*                       @ZM01010*/ 05667000
         B     @RC01431                                            1433 05668000
@RF01431 DS    0H                                                  1434 05669000
*                           IF BASLIB1=0/*                   @Y30LB33*/ 05670000
*                             THEN                                 1434 05671000
         CLI   BASLIB1(BASEVPTR),0                                 1434 05672000
         BNE   @RF01434                                            1434 05673000
*                             BASDEST(1:15)=MSF0CHAR;/*      @Y30LB33*/ 05674000
         MVC   BASDEST(15,BASEVPTR),MSF0CHAR                       1435 05675000
*                           IF BASLIB1=1/*                   @Y30LB33*/ 05676000
*                             THEN                                 1436 05677000
@RF01434 CLI   BASLIB1(BASEVPTR),1                                 1436 05678000
         BNE   @RF01436                                            1436 05679000
*                             BASDEST(1:15)=MSF1CHAR;/*      @Y30LB33*/ 05680000
         MVC   BASDEST(15,BASEVPTR),MSF1CHAR                       1437 05681000
*                         END;      /*                       @ZM01010*/ 05682000
@RF01436 DS    0H                                                  1439 05683000
*                       IF BASLIB2=NULLFFS THEN/*            @ZM01010*/ 05684000
@RC01431 CLC   BASLIB2(1,BASEVPTR),NULLFFS                         1439 05685000
         BNE   @RF01439                                            1439 05686000
*                         BASDEST(16:30)=UNKCHAR;/*          @ZM01010*/ 05687000
         MVC   BASDEST+15(15,BASEVPTR),UNKCHAR                     1440 05688000
*                       ELSE                                       1441 05689000
*                         DO;       /*                       @ZM01010*/ 05690000
         B     @RC01439                                            1441 05691000
@RF01439 DS    0H                                                  1442 05692000
*                           IF BASLIB2=0/*                   @Y30LB33*/ 05693000
*                             THEN                                 1442 05694000
         CLI   BASLIB2(BASEVPTR),0                                 1442 05695000
         BNE   @RF01442                                            1442 05696000
*                             BASDEST(16:30)=MSF0CHAR;/*     @Y30LB33*/ 05697000
         MVC   BASDEST+15(15,BASEVPTR),MSF0CHAR                    1443 05698000
*                           IF BASLIB2=1/*                   @Y30LB33*/ 05699000
*                             THEN                                 1444 05700000
@RF01442 CLI   BASLIB2(BASEVPTR),1                                 1444 05701000
         BNE   @RF01444                                            1444 05702000
*                             BASDEST(16:30)=MSF1CHAR;/*     @Y30LB33*/ 05703000
         MVC   BASDEST+15(15,BASEVPTR),MSF1CHAR                    1445 05704000
*                         END;      /*                       @ZM01010*/ 05705000
*                     END;          /*                       @Y30LB33*/ 05706000
*                 END;              /*                       @Y30LB33*/ 05707000
*             END;                  /*                       @ZDR2056*/ 05708000
*           ELSE                                                   1450 05709000
*             DO;                   /*                       @ZDR2056*/ 05710000
         B     @RC01414                                            1450 05711000
@RF01414 DS    0H                                                  1451 05712000
*               BASGROUP=BLANK;     /*                       @ZDR2056*/ 05713000
         MVI   BASGROUP+1(BASEVPTR),C' '                           1451 05714000
         MVC   BASGROUP+2(6,BASEVPTR),BASGROUP+1(BASEVPTR)         1451 05715000
         MVI   BASGROUP(BASEVPTR),C' '                             1451 05716000
*               BASDEST=BLANK;      /*                       @ZDR2056*/ 05717000
         MVI   BASDEST+1(BASEVPTR),C' '                            1452 05718000
         MVC   BASDEST+2(28,BASEVPTR),BASDEST+1(BASEVPTR)          1452 05719000
         MVI   BASDEST(BASEVPTR),C' '                              1452 05720000
*               BASOWNER=BLANK;     /*                       @ZDR2056*/ 05721000
         MVI   BASOWNER+1(BASEVPTR),C' '                           1453 05722000
         MVC   BASOWNER+2(8,BASEVPTR),BASOWNER+1(BASEVPTR)         1453 05723000
         MVI   BASOWNER(BASEVPTR),C' '                             1453 05724000
*               BASDESCR=BLANK;     /*                       @ZDR2056*/ 05725000
         MVI   BASDESCR+1(BASEVPTR),C' '                           1454 05726000
         MVC   BASDESCR+2(28,BASEVPTR),BASDESCR+1(BASEVPTR)        1454 05727000
         MVI   BASDESCR(BASEVPTR),C' '                             1454 05728000
*               BASCSN1=BLANK;      /*                       @ZDR2056*/ 05729000
         MVI   BASCSN1+1(BASEVPTR),C' '                            1455 05730000
         MVC   BASCSN1+2(10,BASEVPTR),BASCSN1+1(BASEVPTR)          1455 05731000
         MVI   BASCSN1(BASEVPTR),C' '                              1455 05732000
*               BASCSN2=BLANK;      /*                       @ZDR2056*/ 05733000
         MVI   BASCSN2+1(BASEVPTR),C' '                            1456 05734000
         MVC   BASCSN2+2(10,BASEVPTR),BASCSN2+1(BASEVPTR)          1456 05735000
         MVI   BASCSN2(BASEVPTR),C' '                              1456 05736000
*               BASLIB1=BLANK;      /*                       @ZDR2056*/ 05737000
         MVI   BASLIB1(BASEVPTR),X'40'                             1457 05738000
*               BASLIB2=BLANK;      /*                       @ZDR2056*/ 05739000
         MVI   BASLIB2(BASEVPTR),X'40'                             1458 05740000
*             END;                  /*                       @ZDR2056*/ 05741000
*         END;                      /*                       @Y30LB33*/ 05742000
*     END;                          /*                       @Y30LB33*/ 05743000
*                                                                  1462 05744000
*   /*****************************************************************/ 05745000
*   /*                                                               */ 05746000
*   /* PROCESS A DUPLICATE VOLUME RECORD                     @Y30LB33*/ 05747000
*   /*                                                               */ 05748000
*   /*****************************************************************/ 05749000
*                                                                  1462 05750000
*   ELSE                                                           1462 05751000
*     DO;                           /*                       @Y30LB33*/ 05752000
         B     @RC01317                                            1462 05753000
@RF01317 DS    0H                                                  1463 05754000
*       BASDEST=' ';                /*                       @Y30LB33*/ 05755000
         MVI   BASDEST+1(BASEVPTR),C' '                            1463 05756000
         MVC   BASDEST+2(28,BASEVPTR),BASDEST+1(BASEVPTR)          1463 05757000
         MVI   BASDEST(BASEVPTR),C' '                              1463 05758000
*       DARGSENT=DUPSLINE;          /*                       @ZA14736*/ 05759000
         L     @06,DDSTRU                                          1464 05760000
         MVI   DARGSENT(@06),X'01'                                 1464 05761000
*       IF BASLIB1=NULLFFS THEN     /*                       @ZM01010*/ 05762000
         CLC   BASLIB1(1,BASEVPTR),NULLFFS                         1465 05763000
         BNE   @RF01465                                            1465 05764000
*         BASDEST(1:15)=UNKCHAR;    /*                       @ZM01010*/ 05765000
         MVC   BASDEST(15,BASEVPTR),UNKCHAR                        1466 05766000
*       ELSE                                                       1467 05767000
*         DO;                       /*                       @ZM01010*/ 05768000
         B     @RC01465                                            1467 05769000
@RF01465 DS    0H                                                  1468 05770000
*           IF BASLIB1=0            /*                       @Y30LB33*/ 05771000
*             THEN                                                 1468 05772000
         CLI   BASLIB1(BASEVPTR),0                                 1468 05773000
         BNE   @RF01468                                            1468 05774000
*             BASDEST(1:15)=MSF0CHAR;/*                      @Y30LB33*/ 05775000
         MVC   BASDEST(15,BASEVPTR),MSF0CHAR                       1469 05776000
*           IF BASLIB1=1            /*                       @Y30LB33*/ 05777000
*             THEN                                                 1470 05778000
@RF01468 CLI   BASLIB1(BASEVPTR),1                                 1470 05779000
         BNE   @RF01470                                            1470 05780000
*             BASDEST(1:15)=MSF1CHAR;/*                      @Y30LB33*/ 05781000
         MVC   BASDEST(15,BASEVPTR),MSF1CHAR                       1471 05782000
*         END;                      /*                       @ZM01010*/ 05783000
@RF01470 DS    0H                                                  1473 05784000
*       IF BASLIB2=NULLFFS THEN     /*                       @ZM01010*/ 05785000
@RC01465 CLC   BASLIB2(1,BASEVPTR),NULLFFS                         1473 05786000
         BNE   @RF01473                                            1473 05787000
*         BASDEST(16:30)=UNKCHAR;   /*                       @ZM01010*/ 05788000
         MVC   BASDEST+15(15,BASEVPTR),UNKCHAR                     1474 05789000
*       ELSE                                                       1475 05790000
*         DO;                       /*                       @ZM01010*/ 05791000
         B     @RC01473                                            1475 05792000
@RF01473 DS    0H                                                  1476 05793000
*           IF BASLIB2=0            /*                       #Y30LB33*/ 05794000
*             THEN                                                 1476 05795000
         CLI   BASLIB2(BASEVPTR),0                                 1476 05796000
         BNE   @RF01476                                            1476 05797000
*             BASDEST(16:30)=MSF0CHAR;/*                     #Y30LB33*/ 05798000
         MVC   BASDEST+15(15,BASEVPTR),MSF0CHAR                    1477 05799000
*           IF BASLIB2=1            /*                       #Y30LB33*/ 05800000
*             THEN                                                 1478 05801000
@RF01476 CLI   BASLIB2(BASEVPTR),1                                 1478 05802000
         BNE   @RF01478                                            1478 05803000
*             BASDEST(16:30)=MSF1CHAR;/*                     #Y30LB33*/ 05804000
         MVC   BASDEST+15(15,BASEVPTR),MSF1CHAR                    1479 05805000
*         END;                      /*                       @ZM01010*/ 05806000
@RF01478 DS    0H                                                  1481 05807000
*     END;                          /*                       #Y30LB33*/ 05808000
@RC01473 DS    0H                                                  1482 05809000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 05810000
@RC01317 SLR   @15,@15                                             1482 05811000
@EL00017 DS    0H                                                  1482 05812000
@EF00017 DS    0H                                                  1482 05813000
@ER00017 L     @14,12(,@13)                                        1482 05814000
         BR    @14                                                 1482 05815000
*   END VOLFMTR;                    /*                       @Y30LB33*/ 05816000
*                                                                  1484 05817000
*   /*****************************************************************/ 05818000
*   /*                                                               */ 05819000
*   /* PROCEDURE NAME - CTGSEQ                               @Z40LB66*/ 05820000
*   /*                                                       @Z40LB66*/ 05821000
*   /* FUNCTION - ESTABLISH SUBTITLES AND CONTROL            @Z40LB66*/ 05822000
*   /* PROCESSING OF THE CARTRIDGE SERIALS IN                @Z40LB66*/ 05823000
*   /* THE CARTRIDGES PARAMETER AND THE                      @Z40LB66*/ 05824000
*   /* CARTRIDGE SUMMARY                                     @Z40LB66*/ 05825000
*   /*                                                       @Z40LB66*/ 05826000
*   /* INPUT - FDTTBL                                        @Z40LB66*/ 05827000
*   /*                                                       @Z40LB66*/ 05828000
*   /* OUTPUT - RETURN CODE OF 16 AND LASTCOND OF 8 IF       @Z40LB66*/ 05829000
*   /* THE REPORT DOES NOT COMPLETE SUCCESSFULLY             @Z40LB66*/ 05830000
*   /* OTHERWISE, BOTH CODES ARE ZERO.                       @Z40LB66*/ 05831000
*   /*                                                               */ 05832000
*   /*****************************************************************/ 05833000
*                                                                  1484 05834000
*CTGSEQ:                                                           1484 05835000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 05836000
CTGSEQ   ST    @14,@SA00018                                        1484 05837000
*   OLDERID2=NEWERID2;                                             1485 05838000
         L     @07,@PC00001                                        1485 05839000
         L     @04,GDTTR2(,@07)                                    1485 05840000
         MVC   @TS00001(95),NEWERID2(@04)                          1485 05841000
         MVC   OLDERID2(95,@04),@TS00001                           1485 05842000
*   NEWID2='LVSA';                  /*                       @Z40LB66*/ 05843000
         MVC   NEWID2(4,@04),@CC02542                              1486 05844000
*   TESTRC=0;                       /*                       @Z40LB66*/ 05845000
*                                                                  1487 05846000
         SLR   TESTRC,TESTRC                                       1487 05847000
*   /*****************************************************************/ 05848000
*   /*                                                               */ 05849000
*   /* ESTABLISH THE SUBTITLE LINES.                         @Z40LB66*/ 05850000
*   /*                                                               */ 05851000
*   /*****************************************************************/ 05852000
*                                                                  1488 05853000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Z40LB66*/ 05854000
         L     @04,DDSTRU                                          1488 05855000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1488 05856000
*   DARGRETP=ADDR(TITLSPCE);        /*                       @Z40LB66*/ 05857000
         LA    @03,TITLSPCE                                        1489 05858000
         ST    @03,DARGRETP(,@04)                                  1489 05859000
*   DARGRETL=LENGTH(TITLSPCE);      /*                       @Z40LB66*/ 05860000
         MVC   DARGRETL(2,@04),@CH02376                            1490 05861000
*   DARGSMOD=MODLV0;                /*                       @Z40LB66*/ 05862000
         MVC   DARGSMOD(3,@04),@CC02396                            1491 05863000
*   DARGSENT=CTGSTLE;               /*                       @Z40LB66*/ 05864000
*                                                                  1492 05865000
         MVI   DARGSENT(@04),X'26'                                 1492 05866000
*   /*****************************************************************/ 05867000
*   /*                                                               */ 05868000
*   /* OBTAIN SUBTITLE FROM STATIC TEXT MODULE               @Z40LB66*/ 05869000
*   /*                                                               */ 05870000
*   /*****************************************************************/ 05871000
*                                                                  1493 05872000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB66*/ 05873000
*                                                                  1493 05874000
         ST    @07,@AL00001                                        1493 05875000
         LA    @04,@CF00117                                        1493 05876000
         ST    @04,@AL00001+4                                      1493 05877000
         LA    @04,DDSTRU                                          1493 05878000
         ST    @04,@AL00001+8                                      1493 05879000
         MVI   @AL00001+8,X'80'                                    1493 05880000
         L     @15,GDTPRT(,@07)                                    1493 05881000
         LA    @01,@AL00001                                        1493 05882000
         BALR  @14,@15                                             1493 05883000
*   /*****************************************************************/ 05884000
*   /*                                                               */ 05885000
*   /* RESET THE MAIN TITLE ESTABLISHED BEFORE               @Z40LB66*/ 05886000
*   /*                                                               */ 05887000
*   /*****************************************************************/ 05888000
*                                                                  1494 05889000
*   CALL AMSTP044(GDTTBL,PRINTME);  /*                       @Z40LB66*/ 05890000
*                                                                  1494 05891000
         L     @07,@PC00001                                        1494 05892000
         ST    @07,@AL00001                                        1494 05893000
         LA    @04,PRINTME                                         1494 05894000
         ST    @04,@AL00001+4                                      1494 05895000
         MVI   @AL00001+4,X'80'                                    1494 05896000
         L     @15,GDTRES(,@07)                                    1494 05897000
         LA    @01,@AL00001                                        1494 05898000
         BALR  @14,@15                                             1494 05899000
*   /*****************************************************************/ 05900000
*   /*                                                               */ 05901000
*   /* ESTABLISH THE NEW SUBTITLE                            @Z40LB66*/ 05902000
*   /*                                                               */ 05903000
*   /*****************************************************************/ 05904000
*                                                                  1495 05905000
*   PCSTLP=ADDR(TITLSPCE);          /*                       @Z40LB66*/ 05906000
         LA    @07,TITLSPCE                                        1495 05907000
         ST    @07,PCSTLP                                          1495 05908000
*   PCSTLC=2;                       /* SET LINE COUNT        @Z40LB66*/ 05909000
         MVC   PCSTLC(2),@CH00156                                  1496 05910000
*   CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*                   @Z40LB66*/ 05911000
         L     @07,@PC00001                                        1497 05912000
         ST    @07,@AL00001                                        1497 05913000
         LA    @04,PRINTME                                         1497 05914000
         ST    @04,@AL00001+4                                      1497 05915000
         LA    @04,PCARG                                           1497 05916000
         ST    @04,@AL00001+8                                      1497 05917000
         L     @15,GDTESA(,@07)                                    1497 05918000
         LA    @01,@AL00001                                        1497 05919000
         BALR  @14,@15                                             1497 05920000
*                                                                  1498 05921000
*   /*****************************************************************/ 05922000
*   /*                                                               */ 05923000
*   /* SET UP REQUEST BLOCK TO READ CARTRIDGE                @Z40LB66*/ 05924000
*   /* INDEX RECORD AND ASSOCIATED VOLUME RECORD             @Z40LB66*/ 05925000
*   /*                                                               */ 05926000
*   /*****************************************************************/ 05927000
*                                                                  1498 05928000
*   VOLRVVI=VOLRVVI&&VOLRVVI;       /*                       @Z40LB66*/ 05929000
         XC    VOLRVVI(68),VOLRVVI                                 1498 05930000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB66*/ 05931000
         LA    RVVIPTR,VOLRVVI                                     1499 05932000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB66*/ 05933000
         LH    @07,RVVLEN                                          1500 05934000
         ST    @07,RVVLNGTH(,RVVIPTR)                              1500 05935000
*   RVVCODE=RVVOP;                  /*                       @Z40LB66*/ 05936000
         MVI   RVVCODE(RVVIPTR),X'87'                              1501 05937000
*   RVVRDR=ON;                      /*                       @Z40LB66*/ 05938000
         OI    RVVRDR(RVVIPTR),B'10000000'                         1502 05939000
*   RVVCIRCD=ON;                    /*                       @Z40LB66*/ 05940000
         OI    RVVCIRCD(RVVIPTR),B'00000100'                       1503 05941000
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Z40LB66*/ 05942000
         LA    @07,VOLRCDBF                                        1504 05943000
         ST    @07,RVVRTBUF(,RVVIPTR)                              1504 05944000
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Z40LB66*/ 05945000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02618                        1505 05946000
*   RVVSCSN=ON;                     /*                       @Z40LB66*/ 05947000
*                                                                  1506 05948000
         OI    RVVSCSN(RVVIPTR),B'00001000'                        1506 05949000
*   /*****************************************************************/ 05950000
*   /*                                                               */ 05951000
*   /* PASS THE REQUEST BLOCK TO THE CARTRIDGE               @Z40LB66*/ 05952000
*   /* PROCESSOR FOR EVERY CARTRIDGE IN THE CARTRIDGES       @Z40LB66*/ 05953000
*   /* PARAMETER LIST. IF THE RETURN CODE IS 16, END         @Z40LB66*/ 05954000
*   /* EXECUTION.                                            @Z40LB66*/ 05955000
*   /*                                                               */ 05956000
*   /*****************************************************************/ 05957000
*                                                                  1507 05958000
*   DO RPTLOOP=1 TO CTGSCNT WHILE TESTRC<16;/*               @Z40LB66*/ 05959000
         LA    @07,1                                               1507 05960000
         B     @DE01507                                            1507 05961000
@DL01507 C     TESTRC,@CF00507                                     1507 05962000
         BNL   @DC01507                                            1507 05963000
*     RVVRDCSN=CTGSVAL(RPTLOOP);    /*                       @Z40LB66*/ 05964000
         MH    @07,@CH00650                                        1508 05965000
         L     @04,@PC00001+4                                      1508 05966000
         L     @04,FDTPTR+84(,@04)                                 1508 05967000
         ST    @07,@TF00001                                        1508 05968000
         ALR   @07,@04                                             1508 05969000
         AL    @07,@CF02649                                        1508 05970000
         MVC   RVVRDCSN(12,RVVIPTR),CTGSVAL-3(@07)                 1508 05971000
*     CALL CKCSNLEN(RVVRDCSN,CTGSLEN(RPTLOOP));/*            @Z40LB66*/ 05972000
         LA    @03,RVVRDCSN(,RVVIPTR)                              1509 05973000
         ST    @03,@AL00001                                        1509 05974000
         L     @03,@TF00001                                        1509 05975000
         AL    @04,@CF02650                                        1509 05976000
         LA    @04,CTGSLEN-2(@03,@04)                              1509 05977000
         ST    @04,@AL00001+4                                      1509 05978000
         LA    @01,@AL00001                                        1509 05979000
         BAL   @14,CKCSNLEN                                        1509 05980000
*     RESPECIFY                                                    1510 05981000
*       RTNREG RSTD;                                               1510 05982000
*     TESTRC=RTNREG;                                               1511 05983000
         LR    TESTRC,RTNREG                                       1511 05984000
*     RESPECIFY                                                    1512 05985000
*       RTNREG UNRSTD;              /*                       @Z40LB66*/ 05986000
*     IF TESTRC=0 THEN                                             1513 05987000
         LTR   TESTRC,TESTRC                                       1513 05988000
         BNZ   @RF01513                                            1513 05989000
*       DO;                         /* TEST IF CSN VALID     @Z40LB66*/ 05990000
*         CALL CTGPROC;             /*                       @Z40LB66*/ 05991000
         BAL   @14,CTGPROC                                         1515 05992000
*         RESPECIFY                                                1516 05993000
*           RTNREG RSTD;                                           1516 05994000
*         TESTRC=RTNREG;                                           1517 05995000
         LR    TESTRC,RTNREG                                       1517 05996000
*         RESPECIFY                                                1518 05997000
*           RTNREG UNRSTD;          /*                       @Z40LB66*/ 05998000
*       END;                        /*                       @Z40LB66*/ 05999000
*     ELSE                                                         1520 06000000
*       LASTCOND=LASTCC08;          /*                       @VS41109*/ 06001000
         B     @RC01513                                            1520 06002000
@RF01513 L     @07,@PC00001+8                                      1520 06003000
         MVC   LASTCOND(2,@07),@CH00035                            1520 06004000
*   END;                            /*                       @Z40LB66*/ 06005000
@RC01513 LA    @07,1                                               1521 06006000
         AH    @07,RPTLOOP                                         1521 06007000
@DE01507 STH   @07,RPTLOOP                                         1521 06008000
         L     @04,@PC00001+4                                      1521 06009000
         L     @04,FDTPTR+84(,@04)                                 1521 06010000
         CH    @07,CTGSCNT(,@04)                                   1521 06011000
         BNH   @DL01507                                            1521 06012000
@DC01507 DS    0H                                                  1522 06013000
*   MYCODE=TESTRC;                  /* SAVE RETURN CODE      @Z40LB66*/ 06014000
*                                                                  1522 06015000
         LR    MYCODE,TESTRC                                       1522 06016000
*   /*****************************************************************/ 06017000
*   /*                                                               */ 06018000
*   /* PASS THE SUMMARY REQUEST INDICATOR TO                 @Z40LB66*/ 06019000
*   /* SUMRY TO PRINT A CARTRIDGE SUMMARY.                   @Z40LB66*/ 06020000
*   /*                                                               */ 06021000
*   /*****************************************************************/ 06022000
*                                                                  1523 06023000
*   SUMMASK=CTGSUMM;                /*                       @Z40LB66*/ 06024000
         LA    SUMMASK,3                                           1523 06025000
*   CALL SUMRY;                     /*                       @Z40LB66*/ 06026000
*                                                                  1524 06027000
         BAL   @14,SUMRY                                           1524 06028000
*   /*****************************************************************/ 06029000
*   /*                                                               */ 06030000
*   /* RETURN WITH A CODE OF ZERO OR 16 AS                   @Z40LB66*/ 06031000
*   /* RETURNED FROM CALLED PROCEDURES.                      @Z40LB66*/ 06032000
*   /*                                                               */ 06033000
*   /*****************************************************************/ 06034000
*                                                                  1525 06035000
*   IF MYCODE<16 THEN                                              1525 06036000
         C     MYCODE,@CF00507                                     1525 06037000
         BNL   @RF01525                                            1525 06038000
*     MYCODE=0;                     /*                       @Z40LB66*/ 06039000
         SLR   MYCODE,MYCODE                                       1526 06040000
*   RETURN CODE(MYCODE);            /*                       @Z40LB66*/ 06041000
@RF01525 LR    @15,MYCODE                                          1527 06042000
@EL00018 DS    0H                                                  1527 06043000
@EF00018 DS    0H                                                  1527 06044000
@ER00018 L     @14,@SA00018                                        1527 06045000
         BR    @14                                                 1527 06046000
*   END CTGSEQ;                     /*                       @Z40LB66*/ 06047000
*                                                                  1529 06048000
*   /*****************************************************************/ 06049000
*   /*                                                               */ 06050000
*   /* PROCEDURE NAME - ALLCSEQ                              @Z40LB66*/ 06051000
*   /*                                                       @Z40LB66*/ 06052000
*   /* FUNCTION - TO PROCESS ALLCARTRIDGE REQUESTS.          @Z40LB66*/ 06053000
*   /* ESTABLISH THE SUBTITLES FOR THE REPORT,               @Z40LB66*/ 06054000
*   /* AND CONTROL THE PRINTING OF THE SUMMARY.              @Z40LB66*/ 06055000
*   /*                                                       @Z40LB66*/ 06056000
*   /* INPUT - FDTTBL                                        @Z40LB66*/ 06057000
*   /*                                                       @Z40LB66*/ 06058000
*   /* OUTPUT - RETURN CODE OF ZERO AND LASTCOND OF          @Z40LB66*/ 06059000
*   /* ZERO IF PROCESSING COMPLETES WITH NO                  @Z40LB66*/ 06060000
*   /* ERRORS. RETURN CODE OF ZERO AND LASTCOND              @Z40LB66*/ 06061000
*   /* OF 8 IF PROCESSING COMPLETED WITH ERRORS.             @Z40LB66*/ 06062000
*   /* RETURN CODE OF 16 AND LASTCOND OF 8 FOR               @Z40LB66*/ 06063000
*   /* TERMINATION OF PROCESSING.                            @Z40LB66*/ 06064000
*   /*                                                               */ 06065000
*   /*****************************************************************/ 06066000
*                                                                  1529 06067000
*ALLCSEQ:                                                          1529 06068000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 06069000
ALLCSEQ  ST    @14,@SA00019                                        1529 06070000
*   OLDERID2=NEWERID2;                                             1530 06071000
         L     @07,@PC00001                                        1530 06072000
         L     @04,GDTTR2(,@07)                                    1530 06073000
         MVC   @TS00001(95),NEWERID2(@04)                          1530 06074000
         MVC   OLDERID2(95,@04),@TS00001                           1530 06075000
*   NEWID2='LVTA';                  /*                       @Z40LB66*/ 06076000
         MVC   NEWID2(4,@04),@CC02548                              1531 06077000
*   TESTRC=0;                       /*                       @Z40LB66*/ 06078000
*                                                                  1532 06079000
         SLR   TESTRC,TESTRC                                       1532 06080000
*   /*****************************************************************/ 06081000
*   /*                                                               */ 06082000
*   /* ESTABLISH THE REPORT SUBTITLE LINES                   @Z40LB66*/ 06083000
*   /*                                                               */ 06084000
*   /*****************************************************************/ 06085000
*                                                                  1533 06086000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Z40LB66*/ 06087000
         L     @04,DDSTRU                                          1533 06088000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1533 06089000
*   DARGRETP=ADDR(TITLSPCE);        /*                       @Z40LB66*/ 06090000
         LA    @03,TITLSPCE                                        1534 06091000
         ST    @03,DARGRETP(,@04)                                  1534 06092000
*   DARGRETL=LENGTH(TITLSPCE);      /*                       @Z40LB66*/ 06093000
         MVC   DARGRETL(2,@04),@CH02376                            1535 06094000
*   DARGSMOD=MODLV0;                /*                       @Z40LB66*/ 06095000
         MVC   DARGSMOD(3,@04),@CC02396                            1536 06096000
*   DARGSENT=CTGSTLE;               /*                       @Z40LB66*/ 06097000
*                                                                  1537 06098000
         MVI   DARGSENT(@04),X'26'                                 1537 06099000
*   /*****************************************************************/ 06100000
*   /*                                                               */ 06101000
*   /* OBTAIN SUBTITLE FROM STATIC TEXT MODULE               @Z40LB66*/ 06102000
*   /*                                                               */ 06103000
*   /*****************************************************************/ 06104000
*                                                                  1538 06105000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB66*/ 06106000
*                                                                  1538 06107000
         ST    @07,@AL00001                                        1538 06108000
         LA    @04,@CF00117                                        1538 06109000
         ST    @04,@AL00001+4                                      1538 06110000
         LA    @04,DDSTRU                                          1538 06111000
         ST    @04,@AL00001+8                                      1538 06112000
         MVI   @AL00001+8,X'80'                                    1538 06113000
         L     @15,GDTPRT(,@07)                                    1538 06114000
         LA    @01,@AL00001                                        1538 06115000
         BALR  @14,@15                                             1538 06116000
*   /*****************************************************************/ 06117000
*   /*                                                               */ 06118000
*   /* RESET THE MAIN TITLE ESTABLISHED BEFORE               @Z40LB66*/ 06119000
*   /*                                                               */ 06120000
*   /*****************************************************************/ 06121000
*                                                                  1539 06122000
*   CALL AMSTP044(GDTTBL,PRINTME);  /*                       @Z40LB66*/ 06123000
*                                                                  1539 06124000
         L     @07,@PC00001                                        1539 06125000
         ST    @07,@AL00001                                        1539 06126000
         LA    @04,PRINTME                                         1539 06127000
         ST    @04,@AL00001+4                                      1539 06128000
         MVI   @AL00001+4,X'80'                                    1539 06129000
         L     @15,GDTRES(,@07)                                    1539 06130000
         LA    @01,@AL00001                                        1539 06131000
         BALR  @14,@15                                             1539 06132000
*   /*****************************************************************/ 06133000
*   /*                                                               */ 06134000
*   /* ESTABLISH THE NEW SUBTITLE                            @Z40LB66*/ 06135000
*   /*                                                               */ 06136000
*   /*****************************************************************/ 06137000
*                                                                  1540 06138000
*   PCSTLP=ADDR(TITLSPCE);          /*                       @Z40LB66*/ 06139000
         LA    @07,TITLSPCE                                        1540 06140000
         ST    @07,PCSTLP                                          1540 06141000
*   PCSTLC=2;                       /* SET LINE COUNT        @Z40LB66*/ 06142000
         MVC   PCSTLC(2),@CH00156                                  1541 06143000
*   CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*                   @Z40LB66*/ 06144000
         L     @07,@PC00001                                        1542 06145000
         ST    @07,@AL00001                                        1542 06146000
         LA    @04,PRINTME                                         1542 06147000
         ST    @04,@AL00001+4                                      1542 06148000
         LA    @04,PCARG                                           1542 06149000
         ST    @04,@AL00001+8                                      1542 06150000
         L     @15,GDTESA(,@07)                                    1542 06151000
         LA    @01,@AL00001                                        1542 06152000
         BALR  @14,@15                                             1542 06153000
*                                                                  1543 06154000
*   /*****************************************************************/ 06155000
*   /*                                                               */ 06156000
*   /* INITIALIZE THE READ REQUEST PARAMETER LIST            @Z40LB66*/ 06157000
*   /*                                                               */ 06158000
*   /*****************************************************************/ 06159000
*                                                                  1543 06160000
*   VOLRVVI=VOLRVVI&&VOLRVVI;       /*                       @Z40LB66*/ 06161000
         XC    VOLRVVI(68),VOLRVVI                                 1543 06162000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB66*/ 06163000
         LA    RVVIPTR,VOLRVVI                                     1544 06164000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB66*/ 06165000
         LH    @07,RVVLEN                                          1545 06166000
         ST    @07,RVVLNGTH(,RVVIPTR)                              1545 06167000
*   RVVCODE=RVVOP;                  /*                       @Z40LB66*/ 06168000
         MVI   RVVCODE(RVVIPTR),X'87'                              1546 06169000
*   RVVRDNR=ON;                     /*                       @Z40LB66*/ 06170000
         OI    RVVRDNR(RVVIPTR),B'01000000'                        1547 06171000
*   RVVCIRCD=ON;                    /*                       @Z40LB66*/ 06172000
         OI    RVVCIRCD(RVVIPTR),B'00000100'                       1548 06173000
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Z40LB66*/ 06174000
         MVC   RVVBUFLN(2,RVVIPTR),@CH02618                        1549 06175000
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Z40LB66*/ 06176000
*                                                                  1550 06177000
         LA    @07,VOLRCDBF                                        1550 06178000
         ST    @07,RVVRTBUF(,RVVIPTR)                              1550 06179000
*   /*****************************************************************/ 06180000
*   /*                                                               */ 06181000
*   /* CALL THE CARTRIDGE PROCESSOR REPETITIVELY TO          @Z40LB66*/ 06182000
*   /* READ AND PRINT THE CARTRIDGE RECORDS UNTIL            @Z40LB66*/ 06183000
*   /* IT GETS AN ERROR OR END-OF-FILE.                      @Z40LB66*/ 06184000
*   /*                                                               */ 06185000
*   /*****************************************************************/ 06186000
*                                                                  1551 06187000
*   PREVCSN=PREVCSN&&PREVCSN;       /* INIT. FOR COMPARE     @Z40LB66*/ 06188000
         XC    PREVCSN(12),PREVCSN                                 1551 06189000
*   DO WHILE TESTRC<8;              /*                       @Z40LB66*/ 06190000
         B     @DE01552                                            1552 06191000
@DL01552 DS    0H                                                  1553 06192000
*     CALL CTGPROC;                 /*                       @Z40LB66*/ 06193000
         BAL   @14,CTGPROC                                         1553 06194000
*     RESPECIFY                                                    1554 06195000
*       RTNREG RSTD;                                               1554 06196000
*     TESTRC=RTNREG;                                               1555 06197000
         LR    TESTRC,RTNREG                                       1555 06198000
*     RESPECIFY                                                    1556 06199000
*       RTNREG UNRSTD;              /*                       @Z40LB66*/ 06200000
*     RVVRDCSN=PREVCSN;             /* SAVE CSN FOR NEXT     @Z40LB66*/ 06201000
         MVC   RVVRDCSN(12,RVVIPTR),PREVCSN                        1557 06202000
*     RVVSCSN=ON;                   /*                       @Z40LB66*/ 06203000
         OI    RVVSCSN(RVVIPTR),B'00001000'                        1558 06204000
*   END;                            /*                       @Z40LB66*/ 06205000
@DE01552 C     TESTRC,@CF00035                                     1559 06206000
         BL    @DL01552                                            1559 06207000
*   MYCODE=TESTRC;                  /* SAVE RETURN CODE      @Z40LB66*/ 06208000
*                                                                  1560 06209000
         LR    MYCODE,TESTRC                                       1560 06210000
*   /*****************************************************************/ 06211000
*   /*                                                               */ 06212000
*   /* PRINT THE CARTRIDGE SUMMARY                           @Z40LB66*/ 06213000
*   /*                                                               */ 06214000
*   /*****************************************************************/ 06215000
*                                                                  1561 06216000
*   SUMMASK=CTGSUMM;                /*                       @Z40LB66*/ 06217000
         LA    SUMMASK,3                                           1561 06218000
*   CALL SUMRY;                     /*                       @Z40LB66*/ 06219000
*                                                                  1562 06220000
         BAL   @14,SUMRY                                           1562 06221000
*   /*****************************************************************/ 06222000
*   /*                                                               */ 06223000
*   /* RETURN A CODE OF ZERO OR 16                           @Z40LB66*/ 06224000
*   /*                                                               */ 06225000
*   /*****************************************************************/ 06226000
*                                                                  1563 06227000
*   IF MYCODE<16 THEN                                              1563 06228000
         C     MYCODE,@CF00507                                     1563 06229000
         BNL   @RF01563                                            1563 06230000
*     MYCODE=0;                     /*                       @Z40LB66*/ 06231000
         SLR   MYCODE,MYCODE                                       1564 06232000
*   RETURN CODE(MYCODE);            /*                       @Z40LB66*/ 06233000
@RF01563 LR    @15,MYCODE                                          1565 06234000
@EL00019 DS    0H                                                  1565 06235000
@EF00019 DS    0H                                                  1565 06236000
@ER00019 L     @14,@SA00019                                        1565 06237000
         BR    @14                                                 1565 06238000
*   END ALLCSEQ;                    /*                       @Z40LB66*/ 06239000
*                                                                  1567 06240000
*   /*****************************************************************/ 06241000
*   /*                                                               */ 06242000
*   /* PROCEDURE NAME - CTGPROC                              @Z40LB66*/ 06243000
*   /*                                                       @Z40LB66*/ 06244000
*   /* FUNCTION - CONTROL READING AND PRINTING OF A          @Z40LB66*/ 06245000
*   /* CARTRIDGE AND ASSOCIATED VOLUME RECORD.               @Z40LB66*/ 06246000
*   /*                                                       @Z40LB66*/ 06247000
*   /* INPUT - READ REQUEST BLOCK AND THE FDTTBL             @Z40LB66*/ 06248000
*   /*                                                       @Z40LB66*/ 06249000
*   /* OUTPUT - RETURN CODE AND LASTCOND OF ZERO FOR         @Z40LB66*/ 06250000
*   /* NORMAL PROCESSING. RETURN CODE OF 4 AND               @Z40LB66*/ 06251000
*   /* LASTCOND OF 8 IF CARTRIDGE OR ASSOCIATED              @Z40LB66*/ 06252000
*   /* VOLUME RECORD NOT FOUND. RETURN CODE OF 8             @Z40LB66*/ 06253000
*   /* AND LASTCOND OF 0 FOR END-OF-FILE. RETURN             @Z40LB66*/ 06254000
*   /* CODE OF 16 AND LASTCOND OF 8 FOR                      @Z40LB66*/ 06255000
*   /* TERMINATING ERROR.                                    @Z40LB66*/ 06256000
*   /*                                                               */ 06257000
*   /*****************************************************************/ 06258000
*                                                                  1567 06259000
*CTGPROC:                                                          1567 06260000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 06261000
CTGPROC  ST    @14,@SA00020                                        1567 06262000
*   OLDERID2=NEWERID2;                                             1568 06263000
         L     @07,@PC00001                                        1568 06264000
         L     @07,GDTTR2(,@07)                                    1568 06265000
         MVC   @TS00001(95),NEWERID2(@07)                          1568 06266000
         MVC   OLDERID2(95,@07),@TS00001                           1568 06267000
*   NEWID2='LVUA';                  /*                       @Z40LB66*/ 06268000
         MVC   NEWID2(4,@07),@CC02552                              1569 06269000
*   TESTRC=0;                       /*                       @Z40LB66*/ 06270000
*                                                                  1570 06271000
         SLR   TESTRC,TESTRC                                       1570 06272000
*   /*****************************************************************/ 06273000
*   /*                                                               */ 06274000
*   /* CALL THE CARTRIDGE READER TO READ THE                 @Z40LB66*/ 06275000
*   /* CARTRIDGE INDEX RECORD AND THE CORRESPONDING          @Z40LB66*/ 06276000
*   /* VOLUME RECORD.                                        @Z40LB66*/ 06277000
*   /*                                                               */ 06278000
*   /*****************************************************************/ 06279000
*                                                                  1571 06280000
*   CALL CTGRDR;                    /*                       @Z40LB66*/ 06281000
         BAL   @14,CTGRDR                                          1571 06282000
*   RESPECIFY                                                      1572 06283000
*     RTNREG RSTD;                                                 1572 06284000
*   TESTRC=RTNREG;                                                 1573 06285000
         LR    TESTRC,RTNREG                                       1573 06286000
*   RESPECIFY                                                      1574 06287000
*     RTNREG UNRSTD;                /*                       @Z40LB66*/ 06288000
*                                                                  1574 06289000
*   /*****************************************************************/ 06290000
*   /*                                                               */ 06291000
*   /* IF BOTH RECORDS ARE READ WITHOUT ERROR, PRINT         @Z40LB66*/ 06292000
*   /* THE CARTRIDGE INFORMATION.                            @Z40LB66*/ 06293000
*   /*                                                               */ 06294000
*   /*****************************************************************/ 06295000
*                                                                  1575 06296000
*   IF TESTRC=0 THEN                                               1575 06297000
         LTR   TESTRC,TESTRC                                       1575 06298000
         BNZ   @RF01575                                            1575 06299000
*     DO;                           /*                       @Z40LB66*/ 06300000
*       CALL CTGFMTR;               /*                       @Z40LB66*/ 06301000
         BAL   @14,CTGFMTR                                         1577 06302000
*       CALL CTGPRNT;               /*                       @Z40LB66*/ 06303000
         BAL   @14,CTGPRNT                                         1578 06304000
*       IF MSVIERR=ON THEN          /*                       @ZA13476*/ 06305000
         TM    MSVIERR,B'00010000'                                 1579 06306000
         BNO   @RF01579                                            1579 06307000
*         DO;                       /*                       @ZA13476*/ 06308000
*           TESTRC=16;              /*                       @ZA13476*/ 06309000
         LA    TESTRC,16                                           1581 06310000
*           LASTCOND=LASTCC08;      /*                       @ZA13476*/ 06311000
         L     @07,@PC00001+8                                      1582 06312000
         MVC   LASTCOND(2,@07),@CH00035                            1582 06313000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @ZA13476*/ 06314000
         L     @07,DDSTRU                                          1583 06315000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1583 06316000
*           DARGSMOD=MODLV0;        /*                       @ZA13476*/ 06317000
         MVC   DARGSMOD(3,@07),@CC02396                            1584 06318000
*           DARGSENT=MSG3835I;      /*                       @ZA13476*/ 06319000
         MVI   DARGSENT(@07),X'2B'                                 1585 06320000
*           DARGILP=LENGTH(SAVECSN);/*                       @ZA13476*/ 06321000
         MVC   DARGILP(2,@07),@CH00038                             1586 06322000
*           DARGDBP=ADDR(SAVECSN);  /*                       @ZA13476*/ 06323000
         LA    @04,SAVECSN                                         1587 06324000
         ST    @04,DARGDBP(,@07)                                   1587 06325000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @ZA13476*/ 06326000
         L     @07,@PC00001                                        1588 06327000
         ST    @07,@AL00001                                        1588 06328000
         LA    @04,@CF00117                                        1588 06329000
         ST    @04,@AL00001+4                                      1588 06330000
         LA    @04,DDSTRU                                          1588 06331000
         ST    @04,@AL00001+8                                      1588 06332000
         MVI   @AL00001+8,X'80'                                    1588 06333000
         L     @15,GDTPRT(,@07)                                    1588 06334000
         LA    @01,@AL00001                                        1588 06335000
         BALR  @14,@15                                             1588 06336000
*         END;                      /*                       @ZA13476*/ 06337000
*     END;                          /*                       @Z40LB66*/ 06338000
*                                                                  1590 06339000
@RF01579 DS    0H                                                  1591 06340000
*   /*****************************************************************/ 06341000
*   /*                                                               */ 06342000
*   /* RETURN WITH THE CODE FROM THE CALLED PROCEDURES       @Z40LB66*/ 06343000
*   /*                                                               */ 06344000
*   /*****************************************************************/ 06345000
*                                                                  1591 06346000
*   RETURN CODE(TESTRC);            /*                       @Z40LB66*/ 06347000
@RF01575 LR    @15,TESTRC                                          1591 06348000
@EL00020 DS    0H                                                  1591 06349000
@EF00020 DS    0H                                                  1591 06350000
@ER00020 L     @14,@SA00020                                        1591 06351000
         BR    @14                                                 1591 06352000
*   END CTGPROC;                    /*                       @Z40LB66*/ 06353000
*                                                                  1593 06354000
*   /*****************************************************************/ 06355000
*   /*                                                               */ 06356000
*   /* PROCEDURE NAME - CTGRDR                               @Z40LB66*/ 06357000
*   /*                                                       @Z40LB66*/ 06358000
*   /* FUNCTION - TO CALL DIRECTRD TO READ A CARTRIDGE       @ZA27752*/ 06359000
*   /* INDEX RECORD AND THE ASSOCIATED VOLUME                @Z40LB66*/ 06360000
*   /* RECORD USING THE REQUEST BLOCK PASSED AS              @Z40LB66*/ 06361000
*   /* INPUT AND TEST FOR ERRORS FROM THE READ.              @Z40LB66*/ 06362000
*   /* IF AN ERROR OCCURS, PRINT THE APPROPRIATE             @Z40LB66*/ 06363000
*   /* MESSAGE AND SET THE RETURN AND CONDITION              @Z40LB66*/ 06364000
*   /* CODES.                                                @Z40LB66*/ 06365000
*   /*                                                       @Z40LB66*/ 06366000
*   /* INPUT - COMPLETED READ REQUEST BLOCK                  @Z40LB66*/ 06367000
*   /*                                                       @Z40LB66*/ 06368000
*   /* OUTPUT - RETURN CODE OF ZERO AND LASTCOND OF          @Z40LB66*/ 06369000
*   /* ZERO FOR NORMAL PROCESSING. RETURN CODE               @Z40LB66*/ 06370000
*   /* OF 4 AND LASTCOND OF 8 FOR CARTRIDGE-NOT-             @Z40LB66*/ 06371000
*   /* FOUND OR FOR CARTRIDGE-VOLUME-NOT-FOUND.              @Z40LB66*/ 06372000
*   /* RETURN CODE OF 16 AND LASTCOND OF 8 FOR               @Z40LB66*/ 06373000
*   /* TERMINATING ERROR.                                    @Z40LB66*/ 06374000
*   /*                                                               */ 06375000
*   /*****************************************************************/ 06376000
*                                                                  1593 06377000
*CTGRDR:                                                           1593 06378000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 06379000
CTGRDR   ST    @14,@SA00021                                        1593 06380000
*   OLDERID2=NEWERID2;                                             1594 06381000
         L     @07,@PC00001                                        1594 06382000
         L     @04,GDTTR2(,@07)                                    1594 06383000
         MVC   @TS00001(95),NEWERID2(@04)                          1594 06384000
         MVC   OLDERID2(95,@04),@TS00001                           1594 06385000
*   NEWID2='LVVA';                  /*                       @Z40LB66*/ 06386000
         MVC   NEWID2(4,@04),@CC02559                              1595 06387000
*   TESTRC=0;                       /*                       @Z40LB66*/ 06388000
         SLR   TESTRC,TESTRC                                       1596 06389000
*   SETRC=0;                        /*                       @Z40LB66*/ 06390000
*                                                                  1597 06391000
         SLR   @04,@04                                             1597 06392000
         STH   @04,SETRC                                           1597 06393000
*   /*****************************************************************/ 06394000
*   /*                                                               */ 06395000
*   /* CALL DIRECTRD WITH THE IEZRVVI REQUEST BLOCK          @ZA27752*/ 06396000
*   /* TO READ THE CARTRIDGE INDEX RECORD. THE REQUEST       @Z40LB66*/ 06397000
*   /* BLOCK HAS BEEN FILLED IN BY THE CALLER.               @Z40LB66*/ 06398000
*   /*                                                               */ 06399000
*   /*****************************************************************/ 06400000
*                                                                  1598 06401000
*   IF GDTDBG=NULLPTR THEN                                         1598 06402000
         C     @04,GDTDBG(,@07)                                    1598 06403000
         BE    @RT01598                                            1598 06404000
*     ;                                                            1599 06405000
*   ELSE                                                           1600 06406000
*     DO;                                                          1600 06407000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Z40LB66*/ 06408000
         LA    DMPINDEX,DUMPAREA                                   1601 06409000
*       DMPITMNM='RVVI';                                           1602 06410000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           1602 06411000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         1602 06412000
         MVC   DMPITMNM(4,DMPINDEX),@CC02500                       1602 06413000
*       DMPITMPT=ADDR(RVVI);                                       1603 06414000
         ST    RVVIPTR,DMPITMPT(,DMPINDEX)                         1603 06415000
*       DMPITMLN=RVVLEN;                                           1604 06416000
         LH    @04,RVVLEN                                          1604 06417000
         STH   @04,DMPITMLN(,DMPINDEX)                             1604 06418000
*       DMPITMTP='H';                                              1605 06419000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1605 06420000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1606 06421000
*                                                                  1606 06422000
         AL    DMPINDEX,@CF00507                                   1606 06423000
*       /*************************************************************/ 06424000
*       /*                                                           */ 06425000
*       /*                                                   @Z40LB66*/ 06426000
*       /*                                                           */ 06427000
*       /*************************************************************/ 06428000
*                                                                  1607 06429000
*       DMPTRM=DMPTRMVL;                                           1607 06430000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1607 06431000
*     END;                          /*                       @Z40LB66*/ 06432000
*   IF GDTDBG=NULLPTR THEN                                         1609 06433000
@RT01598 L     @04,@PC00001                                        1609 06434000
         L     @04,GDTDBG(,@04)                                    1609 06435000
         LTR   @04,@04                                             1609 06436000
         BZ    @RT01609                                            1609 06437000
*     ;                                                            1610 06438000
*   ELSE                                                           1611 06439000
*     CALL IDCDB010(GDTTBL,'LVVB',DUMPADDR);/*               @Z40LB66*/ 06440000
         L     @04,@PC00001                                        1611 06441000
         ST    @04,@AL00001                                        1611 06442000
         LA    @03,@CC02560                                        1611 06443000
         ST    @03,@AL00001+4                                      1611 06444000
         LA    @03,DUMPADDR                                        1611 06445000
         ST    @03,@AL00001+8                                      1611 06446000
         MVI   @AL00001+8,X'80'                                    1611 06447000
         L     @15,GDTDBG(,@04)                                    1611 06448000
         LA    @01,@AL00001                                        1611 06449000
         BALR  @14,@15                                             1611 06450000
*   CALL DIRECTRD;                  /*                       @ZA27752*/ 06451000
@RT01609 BAL   @14,DIRECTRD                                        1612 06452000
*   RESPECIFY                                                      1613 06453000
*     RTNREG RSTD;                                                 1613 06454000
*   TESTRC=RTNREG;                                                 1614 06455000
         LR    TESTRC,RTNREG                                       1614 06456000
*   RESPECIFY                                                      1615 06457000
*     RTNREG UNRSTD;                /*                       @Z40LB66*/ 06458000
*                                                                  1616 06459000
*   /*****************************************************************/ 06460000
*   /*                                                               */ 06461000
*   /* TEST THE RETURN AND REASON CODES AND                  @Z40LB66*/ 06462000
*   /* PRINT APPROPRIATE MESSAGES                            @Z40LB66*/ 06463000
*   /*                                                               */ 06464000
*   /*****************************************************************/ 06465000
*                                                                  1616 06466000
*   IF TESTRC=4 THEN                                               1616 06467000
         C     TESTRC,@CF00043                                     1616 06468000
         BNE   @RF01616                                            1616 06469000
*     DO;                           /*                       @Z40LB66*/ 06470000
*                                                                  1617 06471000
*       /*************************************************************/ 06472000
*       /*                                                           */ 06473000
*       /* IF WE ARE READING DIRECT AND GET A                @Z40LB66*/ 06474000
*       /* NOT-FOUND CONDITION, CALL SSCMSG TO PRINT         @Z40LB66*/ 06475000
*       /* THE REASON, PRINT IDC2833I TO INDICATE            @Z40LB66*/ 06476000
*       /* CARTRIDGE-NOT-FOUND, AND SET THE RETURN           @Z40LB66*/ 06477000
*       /* CODE TO 4 AND LASTCOND TO 8.                      @Z40LB66*/ 06478000
*       /*                                                           */ 06479000
*       /*************************************************************/ 06480000
*                                                                  1618 06481000
*       IF RVVRDR=ON&REASON=NOTFOUND THEN                          1618 06482000
         TM    RVVRDR(RVVIPTR),B'10000000'                         1618 06483000
         BNO   @RF01618                                            1618 06484000
         CLC   REASON(4),@CF02312                                  1618 06485000
         BNE   @RF01618                                            1618 06486000
*         DO;                       /*                       @Z40LB66*/ 06487000
*           CALL SSCMSG(REASON);    /*                       @Z40LB66*/ 06488000
         LA    @04,REASON                                          1620 06489000
         ST    @04,@AL00001                                        1620 06490000
         LA    @01,@AL00001                                        1620 06491000
         BAL   @14,SSCMSG                                          1620 06492000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Z40LB66*/ 06493000
         L     @04,DDSTRU                                          1621 06494000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1621 06495000
*           DARGDBP=ADDR(RVVRDCSN); /*                       @Z40LB66*/ 06496000
         LA    @03,RVVRDCSN(,RVVIPTR)                              1622 06497000
         ST    @03,DARGDBP(,@04)                                   1622 06498000
*           DARGILP=LENGTH(RVVRDCSN);/*                      @Z40LB66*/ 06499000
         MVC   DARGILP(2,@04),@CH00038                             1623 06500000
*           DARGSMOD=MODLV0;        /*                       @Z40LB66*/ 06501000
         MVC   DARGSMOD(3,@04),@CC02396                            1624 06502000
*           DARGSENT=MSG2833I;      /*                       @Z40LB66*/ 06503000
         MVI   DARGSENT(@04),X'23'                                 1625 06504000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB66*/ 06505000
         L     @04,@PC00001                                        1626 06506000
         ST    @04,@AL00001                                        1626 06507000
         LA    @03,@CF00117                                        1626 06508000
         ST    @03,@AL00001+4                                      1626 06509000
         LA    @03,DDSTRU                                          1626 06510000
         ST    @03,@AL00001+8                                      1626 06511000
         MVI   @AL00001+8,X'80'                                    1626 06512000
         L     @15,GDTPRT(,@04)                                    1626 06513000
         LA    @01,@AL00001                                        1626 06514000
         BALR  @14,@15                                             1626 06515000
*           SETRC=4;                /*                       @Z40LB66*/ 06516000
         MVC   SETRC(2),@CH00043                                   1627 06517000
*           LASTCOND=LASTCC08;      /*                       @Z40LB66*/ 06518000
         L     @04,@PC00001+8                                      1628 06519000
         MVC   LASTCOND(2,@04),@CH00035                            1628 06520000
*         END;                      /*                       @Z40LB66*/ 06521000
*                                                                  1629 06522000
*       /*************************************************************/ 06523000
*       /*                                                           */ 06524000
*       /* IF THE REASON IS CARTRIDGE-VOLUME-NOT-            @Z40LB66*/ 06525000
*       /* FOUND, PRINT IDC2834I TO INDICATE THE ERROR       @Z40LB66*/ 06526000
*       /* AND SET THE RETURN CODE TO 4 AND LASTCOND TO 8    @Z40LB66*/ 06527000
*       /*                                                           */ 06528000
*       /*************************************************************/ 06529000
*                                                                  1630 06530000
*       ELSE                                                       1630 06531000
*         IF REASON=NOCTGVOL THEN                                  1630 06532000
         B     @RC01618                                            1630 06533000
@RF01618 CLC   REASON(4),@CF02318                                  1630 06534000
         BNE   @RF01630                                            1630 06535000
*           DO;                     /*                       @Z40LB66*/ 06536000
*             INDEXPTR=ADDR(VOLRCDBF);/*                     @Z40LB66*/ 06537000
         LA    INDEXPTR,VOLRCDBF                                   1632 06538000
*             DARGLIST=DARGLIST&&DARGLIST;/*                 @Z40LB66*/ 06539000
         L     @04,DDSTRU                                          1633 06540000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1633 06541000
*             DARGDBP=ADDR(INDEX);  /*                       @Z40LB66*/ 06542000
         ST    INDEXPTR,DARGDBP(,@04)                              1634 06543000
*             DARGILP=LENGTH(INDEX);/*                       @Z40LB66*/ 06544000
         MVC   DARGILP(2,@04),@CH02362                             1635 06545000
*             DARGSMOD=MODLV0;      /*                       @Z40LB66*/ 06546000
         MVC   DARGSMOD(3,@04),@CC02396                            1636 06547000
*             DARGSENT=MSG2834I;    /*                       @Z40LB66*/ 06548000
         MVI   DARGSENT(@04),X'24'                                 1637 06549000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB66*/ 06550000
         L     @04,@PC00001                                        1638 06551000
         ST    @04,@AL00001                                        1638 06552000
         LA    @15,@CF00117                                        1638 06553000
         ST    @15,@AL00001+4                                      1638 06554000
         LA    @15,DDSTRU                                          1638 06555000
         ST    @15,@AL00001+8                                      1638 06556000
         MVI   @AL00001+8,X'80'                                    1638 06557000
         L     @15,GDTPRT(,@04)                                    1638 06558000
         LA    @01,@AL00001                                        1638 06559000
         BALR  @14,@15                                             1638 06560000
*             PREVCSN=INDSERNO;     /* SET FOR NEXT READ     @Z40LB66*/ 06561000
         MVC   PREVCSN(12),INDSERNO(INDEXPTR)                      1639 06562000
*             SETRC=4;              /*                       @Z40LB66*/ 06563000
         MVC   SETRC(2),@CH00043                                   1640 06564000
*             LASTCOND=LASTCC08;    /*                       @Z40LB66*/ 06565000
         L     @04,@PC00001+8                                      1641 06566000
         MVC   LASTCOND(2,@04),@CH00035                            1641 06567000
*           END;                    /*                       @Z40LB66*/ 06568000
*                                                                  1642 06569000
*       /*************************************************************/ 06570000
*       /*                                                           */ 06571000
*       /* IF THE READ WAS READ-NEXT AND THE REASON          @Z40LB66*/ 06572000
*       /* WAS NOT-FOUND, THEN SET RETURN CODE TO 8 TO       @Z40LB66*/ 06573000
*       /* INDICATE END-OF-FILE                              @Z40LB66*/ 06574000
*       /*                                                           */ 06575000
*       /*************************************************************/ 06576000
*                                                                  1643 06577000
*         ELSE                                                     1643 06578000
*           IF RVVRDNR=ON&REASON=NOTFOUND THEN                     1643 06579000
         B     @RC01630                                            1643 06580000
@RF01630 TM    RVVRDNR(RVVIPTR),B'01000000'                        1643 06581000
         BNO   @RF01643                                            1643 06582000
         CLC   REASON(4),@CF02312                                  1643 06583000
         BNE   @RF01643                                            1643 06584000
*             DO;                   /*                       @Z40LB66*/ 06585000
*               SETRC=8;            /*                       @Z40LB66*/ 06586000
         LA    @07,8                                               1645 06587000
         STH   @07,SETRC                                           1645 06588000
*               TESTRC=8;           /*                       @Z40LB66*/ 06589000
         LR    TESTRC,@07                                          1646 06590000
*             END;                  /*                       @Z40LB66*/ 06591000
*                                                                  1647 06592000
*       /*************************************************************/ 06593000
*       /*                                                           */ 06594000
*       /* IF ANY OTHER REASON CODE IS RETURNED,             @Z40LB66*/ 06595000
*       /* CALL SSCMSG TO PRINT THE ERROR MESSAGE            @Z40LB66*/ 06596000
*       /* AND SET RC TO 16 AND LASTCOND TO 8                @Z40LB66*/ 06597000
*       /*                                                           */ 06598000
*       /*************************************************************/ 06599000
*                                                                  1648 06600000
*           ELSE                                                   1648 06601000
*             DO;                   /*                       @Z40LB66*/ 06602000
         B     @RC01643                                            1648 06603000
@RF01643 DS    0H                                                  1649 06604000
*               CALL SSCMSG(REASON);/*                       @Z40LB66*/ 06605000
         LA    @04,REASON                                          1649 06606000
         ST    @04,@AL00001                                        1649 06607000
         LA    @01,@AL00001                                        1649 06608000
         BAL   @14,SSCMSG                                          1649 06609000
*               SETRC=16;           /*                       @Z40LB66*/ 06610000
         MVC   SETRC(2),@CH00507                                   1650 06611000
*               LASTCOND=LASTCC08;  /*                       @Z40LB66*/ 06612000
         L     @04,@PC00001+8                                      1651 06613000
         MVC   LASTCOND(2,@04),@CH00035                            1651 06614000
*             END;                  /*                       @Z40LB66*/ 06615000
*     END;                          /*                       @Z40LB66*/ 06616000
*                                                                  1653 06617000
@RC01643 DS    0H                                                  1653 06618000
@RC01630 DS    0H                                                  1653 06619000
@RC01618 DS    0H                                                  1654 06620000
*   /*****************************************************************/ 06621000
*   /*                                                               */ 06622000
*   /* RETURN WITH THE RETURN CODE SET ABOVE                 @Z40LB66*/ 06623000
*   /*                                                               */ 06624000
*   /*****************************************************************/ 06625000
*                                                                  1654 06626000
*   RETURN CODE(SETRC);             /*                       @Z40LB66*/ 06627000
@RF01616 LH    @15,SETRC                                           1654 06628000
@EL00021 DS    0H                                                  1654 06629000
@EF00021 DS    0H                                                  1654 06630000
@ER00021 L     @14,@SA00021                                        1654 06631000
         BR    @14                                                 1654 06632000
*   END CTGRDR;                     /*                       @Z40LB66*/ 06633000
*                                                                  1656 06634000
*   /*****************************************************************/ 06635000
*   /*                                                               */ 06636000
*   /* PROCEDURE NAME - CTGFMTR                              @Z40LB66*/ 06637000
*   /*                                                       @Z40LB66*/ 06638000
*   /* FUNCTION - TO PREPARE THE CARTRIDGE DATA FOR          @Z40LB66*/ 06639000
*   /* PRINTING BY CREATING A TEXT PROCESSOR                 @Z40LB66*/ 06640000
*   /* ARGUMENT LIST AND CONVERTING BIT                      @Z40LB66*/ 06641000
*   /* PATTERNS TO PRINTABLE FIELDS                          @Z40LB66*/ 06642000
*   /*                                                       @Z40LB66*/ 06643000
*   /* INPUT - VOLUME RECORD, THE FDTTBL, AND THE            @Z40LB66*/ 06644000
*   /* PREVIOUS CARTRIDGE SERIAL                             @Z40LB66*/ 06645000
*   /*                                                       @Z40LB66*/ 06646000
*   /* OUTPUT - RETURN CODE OF ZERO AND TEXT                 @Z40LB66*/ 06647000
*   /* PROCESSOR ARGUMENT LIST                               @Z40LB66*/ 06648000
*   /*                                                               */ 06649000
*   /*****************************************************************/ 06650000
*                                                                  1656 06651000
*CTGFMTR:                                                          1656 06652000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 06653000
CTGFMTR  ST    @14,12(,@13)                                        1656 06654000
*   OLDERID2=NEWERID2;                                             1657 06655000
         L     @07,@PC00001                                        1657 06656000
         L     @07,GDTTR2(,@07)                                    1657 06657000
         MVC   @TS00001(95),NEWERID2(@07)                          1657 06658000
         MVC   OLDERID2(95,@07),@TS00001                           1657 06659000
*   NEWID2='LVWA';                  /*                       @Z40LB66*/ 06660000
         MVC   NEWID2(4,@07),@CC02564                              1658 06661000
*   TESTRC=0;                       /*                       @Z40LB66*/ 06662000
*                                                                  1659 06663000
         SLR   TESTRC,TESTRC                                       1659 06664000
*   /*****************************************************************/ 06665000
*   /*                                                               */ 06666000
*   /* INITIALIZE THE PRINT PARAMETERS                       @Z40LB66*/ 06667000
*   /*                                                               */ 06668000
*   /*****************************************************************/ 06669000
*                                                                  1660 06670000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Z40LB66*/ 06671000
         L     @04,DDSTRU                                          1660 06672000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1660 06673000
*   DARGSMOD=MODLV0;                /*                       @Z40LB66*/ 06674000
         MVC   DARGSMOD(3,@04),@CC02396                            1661 06675000
*   DARGDBP=ADDR(VOLAREA);          /*                       @Z40LB66*/ 06676000
         LA    @03,VOLAREA                                         1662 06677000
         ST    @03,DARGDBP(,@04)                                   1662 06678000
*   DARGILP=LENGTH(VOLAREA);        /*                       @Z40LB66*/ 06679000
         MVC   DARGILP(2,@04),@CH02625                             1663 06680000
*   DARGSENT=CTGSLINE;              /*                       @Z40LB66*/ 06681000
         MVI   DARGSENT(@04),X'21'                                 1664 06682000
*   VOLAREA(1:13)=' ';              /*                       @Z40LB66*/ 06683000
         MVI   VOLAREA+1,C' '                                      1665 06684000
         MVC   VOLAREA+2(11),VOLAREA+1                             1665 06685000
         MVI   VOLAREA,C' '                                        1665 06686000
*   BASDEST(1:5)=' ';               /*                       @Z40LB66*/ 06687000
*                                                                  1666 06688000
         MVI   BASDEST+1(BASEVPTR),C' '                            1666 06689000
         MVC   BASDEST+2(3,BASEVPTR),BASDEST+1(BASEVPTR)           1666 06690000
         MVI   BASDEST(BASEVPTR),C' '                              1666 06691000
*   /*****************************************************************/ 06692000
*   /*                                                               */ 06693000
*   /* OBTAIN THE REPORT DATA FROM THE VOLUME RECORD         @Z40LB66*/ 06694000
*   /* ACCORDING TO THE VOLUME TYPE                          @Z40LB66*/ 06695000
*   /*                                                               */ 06696000
*   /*****************************************************************/ 06697000
*                                                                  1667 06698000
*   VOLTRNST=INACHAR;               /* INIT. INACTIVE        @Z40LB66*/ 06699000
         MVC   VOLTRNST(5),INACHAR                                 1667 06700000
*   IF BCDDUP=ON THEN                                              1668 06701000
         L     @04,BCDVPTR                                         1668 06702000
         TM    BCDDUP(@04),B'00000100'                             1668 06703000
         BNO   @RF01668                                            1668 06704000
*     DO;                           /* DUPLICATE VOLUME ?    @Z40LB66*/ 06705000
*       VOLTRNTY=DUPCHAR;           /*                       @Z40LB66*/ 06706000
         MVI   VOLTRNTY+3,C' '                                     1670 06707000
         MVC   VOLTRNTY(3),DUPCHAR                                 1670 06708000
*       BASOWNER=' ';               /*                       @Z40LB66*/ 06709000
         MVI   BASOWNER+1(BASEVPTR),C' '                           1671 06710000
         MVC   BASOWNER+2(8,BASEVPTR),BASOWNER+1(BASEVPTR)         1671 06711000
         MVI   BASOWNER(BASEVPTR),C' '                             1671 06712000
*     END;                          /*                       @Z40LB66*/ 06713000
*   ELSE                                                           1673 06714000
*     DO;                           /*                       @Z40LB66*/ 06715000
         B     @RC01668                                            1673 06716000
@RF01668 DS    0H                                                  1674 06717000
*       IF BCDBASE=ON THEN                                         1674 06718000
         L     @04,BCDVPTR                                         1674 06719000
         TM    BCDBASE(@04),B'00100000'                            1674 06720000
         BNO   @RF01674                                            1674 06721000
*         DO;                       /*                       @Z40LB66*/ 06722000
*                                                                  1675 06723000
*           /*********************************************************/ 06724000
*           /*                                                       */ 06725000
*           /* FOR BASE VOLUMES, SET THE STATE,              @Z40LB66*/ 06726000
*           /* TYPE AND ATTRIBUTES                           @Z40LB66*/ 06727000
*           /*                                                       */ 06728000
*           /*********************************************************/ 06729000
*                                                                  1676 06730000
*           IF BASINAC=OFF THEN     /* ACTIVE ?              @Z40LB66*/ 06731000
         TM    BASINAC(BASEVPTR),B'00000100'                       1676 06732000
         BNZ   @RF01676                                            1676 06733000
*             VOLTRNST=ACTCHAR;     /*                       @Z40LB66*/ 06734000
         MVC   VOLTRNST(5),ACTCHAR                                 1677 06735000
*           IF BASGENUS=ON THEN     /* GENERAL USE ?         @Z40LB66*/ 06736000
@RF01676 TM    BASGENUS(BASEVPTR),B'00010000'                      1678 06737000
         BNO   @RF01678                                            1678 06738000
*             VOLTRNTY=GENCHAR;     /*                       @Z40LB66*/ 06739000
         MVC   VOLTRNTY(4),GENCHAR                                 1679 06740000
*           IF BASRSTD=ON THEN      /* RESTRICTED USE ?      @Z40LB66*/ 06741000
@RF01678 TM    BASRSTD(BASEVPTR),B'00001000'                       1680 06742000
         BNO   @RF01680                                            1680 06743000
*             VOLTRNTY=RSTRCHAR;    /*                       @Z40LB66*/ 06744000
         MVC   VOLTRNTY(4),RSTRCHAR                                1681 06745000
*           IF BASBIND=ON THEN                                     1682 06746000
@RF01680 TM    BASBIND(BASEVPTR),B'00000010'                       1682 06747000
         BNO   @RF01682                                            1682 06748000
*             VOLTRNAT(1)=BCHAR;    /*                       @Z40LB66*/ 06749000
         MVC   VOLTRNAT(1),BCHAR                                   1683 06750000
*           IF BASRONLY=ON THEN                                    1684 06751000
@RF01682 TM    BASRONLY(BASEVPTR),B'01000000'                      1684 06752000
         BNO   @RF01684                                            1684 06753000
*             VOLTRNAT(2)=RCHAR;    /*                       @Z40LB66*/ 06754000
         MVC   VOLTRNAT+1(1),RCHAR                                 1685 06755000
*           IF BASDAERA=ON THEN                                    1686 06756000
@RF01684 TM    BASDAERA(BASEVPTR),B'10000000'                      1686 06757000
         BNO   @RF01686                                            1686 06758000
*             VOLTRNAT(3)=DCHAR;    /*                       @Z40LB66*/ 06759000
         MVC   VOLTRNAT+2(1),DCHAR                                 1687 06760000
*           IF BASEXCL=ON THEN                                     1688 06761000
@RF01686 TM    BASEXCL(BASEVPTR),B'00000001'                       1688 06762000
         BNO   @RF01688                                            1688 06763000
*             VOLTRNAT(4)=ECHAR;    /*                       @Z40LB66*/ 06764000
         MVC   VOLTRNAT+3(1),ECHAR                                 1689 06765000
*         END;                      /*                       @Z40LB66*/ 06766000
*       ELSE                                                       1691 06767000
*         DO;                       /*                       @Z40LB66*/ 06768000
*                                                                  1691 06769000
         B     @RC01674                                            1691 06770000
@RF01674 DS    0H                                                  1692 06771000
*           /*********************************************************/ 06772000
*           /*                                                       */ 06773000
*           /* SET TYPE AND ATTRIBUTE FIELDS FOR             @Z40LB66*/ 06774000
*           /* COPY VOLUMES                                  @Z40LB66*/ 06775000
*           /*                                                       */ 06776000
*           /*********************************************************/ 06777000
*                                                                  1692 06778000
*           COPYVPTR=ADDR(VOLRCDBF);/*                       @Z40LB66*/ 06779000
         LA    @04,VOLRCDBF                                        1692 06780000
         ST    @04,COPYVPTR                                        1692 06781000
*           IF COPBKUP=ON THEN      /* BACKUP COPY ?         @Z40LB66*/ 06782000
         TM    COPBKUP(@04),B'00001000'                            1693 06783000
         BNO   @RF01693                                            1693 06784000
*             VOLTRNTY=BKUPCHAR;    /*                       @Z40LB66*/ 06785000
         MVC   VOLTRNTY(4),BKUPCHAR                                1694 06786000
*           ELSE                                                   1695 06787000
*             VOLTRNTY=COPYCHAR;    /*                       @Z40LB66*/ 06788000
         B     @RC01693                                            1695 06789000
@RF01693 MVC   VOLTRNTY(4),COPYCHAR                                1695 06790000
*           IF COPBIND=ON THEN                                     1696 06791000
@RC01693 L     @04,COPYVPTR                                        1696 06792000
         TM    COPBIND(@04),B'00000100'                            1696 06793000
         BNO   @RF01696                                            1696 06794000
*             VOLTRNAT(1)=BCHAR;    /*                       @Z40LB66*/ 06795000
         MVC   VOLTRNAT(1),BCHAR                                   1697 06796000
*           IF COPRONLY=ON THEN                                    1698 06797000
@RF01696 L     @04,COPYVPTR                                        1698 06798000
         TM    COPRONLY(@04),B'10000000'                           1698 06799000
         BNO   @RF01698                                            1698 06800000
*             VOLTRNAT(2)=RCHAR;    /*                       @Z40LB66*/ 06801000
         MVC   VOLTRNAT+1(1),RCHAR                                 1699 06802000
*           IF COPDAERA=ON THEN                                    1700 06803000
@RF01698 L     @04,COPYVPTR                                        1700 06804000
         TM    COPDAERA(@04),B'00000001'                           1700 06805000
         BNO   @RF01700                                            1700 06806000
*             VOLTRNAT(3)=DCHAR;    /*                       @Z40LB66*/ 06807000
         MVC   VOLTRNAT+2(1),DCHAR                                 1701 06808000
*           IF COPEXCL=ON THEN                                     1702 06809000
@RF01700 L     @04,COPYVPTR                                        1702 06810000
         TM    COPEXCL(@04),B'00000010'                            1702 06811000
         BNO   @RF01702                                            1702 06812000
*             VOLTRNAT(4)=ECHAR;    /*                       @Z40LB66*/ 06813000
         MVC   VOLTRNAT+3(1),ECHAR                                 1703 06814000
*           BASOWNER=COPOWNER;      /*                       @Z40LB66*/ 06815000
@RF01702 L     @04,COPYVPTR                                        1704 06816000
         MVC   BASOWNER(10,BASEVPTR),COPOWNER(@04)                 1704 06817000
*         END;                      /*                       @Z40LB66*/ 06818000
*     END;                          /*                       @Z40LB66*/ 06819000
@RC01674 DS    0H                                                  1707 06820000
*                                                                  1707 06821000
*   /*****************************************************************/ 06822000
*   /*                                                               */ 06823000
*   /* SET THE CARTRIDGE SERIAL NUMBERS AND THE MSFID        @Z40LB66*/ 06824000
*   /*                                                               */ 06825000
*   /*****************************************************************/ 06826000
*                                                                  1707 06827000
*   IF ADDR(ALLC)>0 THEN                                           1707 06828000
@RC01668 L     @04,@PC00001+4                                      1707 06829000
         L     @04,FDTPTR+88(,@04)                                 1707 06830000
         LTR   @04,@04                                             1707 06831000
         BNP   @RF01707                                            1707 06832000
*     DO;                           /*                       @Z40LB66*/ 06833000
*                                                                  1708 06834000
*       /*************************************************************/ 06835000
*       /*                                                           */ 06836000
*       /* IF THERE IS AN INCONSISTENCY BETWEEN THE CARTRIDGE INDEX  */ 06837000
*       /* RECORDS AND THE BASE VOLUME RECORDS IN THE MSVI, THEN WE  */ 06838000
*       /* MUST LET THE USER KNOW ABOUT IT AND TERMINATE THE LIST TO */ 06839000
*       /* PREVENT LOOPING.                                  @ZA13476*/ 06840000
*       /*                                                           */ 06841000
*       /*************************************************************/ 06842000
*                                                                  1709 06843000
*       SAVECSN=PREVCSN;            /*                       @ZA13476*/ 06844000
         MVC   SAVECSN(12),PREVCSN                                 1709 06845000
*       IF(PREVCSN>=BCDCSN1&PREVCSN>=BCDCSN2)|/*             @ZA13476*/ 06846000
*           BCDCSN1=ZEROCSN|BCDCSN2=ZEROCSN THEN/*           @ZA13476*/ 06847000
         L     @04,BCDVPTR                                         1710 06848000
         CLC   PREVCSN(12),BCDCSN1(@04)                            1710 06849000
         BL    @GL00080                                            1710 06850000
         CLC   PREVCSN(12),BCDCSN2(@04)                            1710 06851000
         BNL   @RT01710                                            1710 06852000
@GL00080 L     @04,BCDVPTR                                         1710 06853000
         CLC   BCDCSN1(12,@04),ZEROCSN                             1710 06854000
         BE    @RT01710                                            1710 06855000
         CLC   BCDCSN2(12,@04),ZEROCSN                             1710 06856000
         BNE   @RF01710                                            1710 06857000
@RT01710 DS    0H                                                  1711 06858000
*         MSVIERR=ON;               /*                       @ZA13476*/ 06859000
*                                                                  1711 06860000
         OI    MSVIERR,B'00010000'                                 1711 06861000
*       /*************************************************************/ 06862000
*       /*                                                           */ 06863000
*       /* WHEN PROCESSING ALL CARTRIDGES, THE               @Z40LB66*/ 06864000
*       /* CURRENT CART. IS DETERMINED BY COMPARING THE      @Z40LB66*/ 06865000
*       /* TWO CSN VALUES AND THE PREVIOUS ONE (CTGSERNO)    @Z40LB66*/ 06866000
*       /*                                                           */ 06867000
*       /*************************************************************/ 06868000
*                                                                  1712 06869000
*       IF(BCDCSN1>BCDCSN2&BCDCSN2^>PREVCSN)/*               @Z40LB66*/ 06870000
*           |(BCDCSN1<BCDCSN2&BCDCSN1>PREVCSN)/*             @Z40LB66*/ 06871000
*         THEN                                                     1712 06872000
@RF01710 L     @04,BCDVPTR                                         1712 06873000
         CLC   BCDCSN1(12,@04),BCDCSN2(@04)                        1712 06874000
         BNH   @GL00082                                            1712 06875000
         CLC   BCDCSN2(12,@04),PREVCSN                             1712 06876000
         BNH   @RT01712                                            1712 06877000
@GL00082 L     @04,BCDVPTR                                         1712 06878000
         CLC   BCDCSN1(12,@04),BCDCSN2(@04)                        1712 06879000
         BNL   @RF01712                                            1712 06880000
         CLC   BCDCSN1(12,@04),PREVCSN                             1712 06881000
         BNH   @RF01712                                            1712 06882000
@RT01712 DS    0H                                                  1713 06883000
*         DO;                       /*                       @Z40LB66*/ 06884000
*           PREVCSN=BCDCSN1;        /*                       @Z40LB66*/ 06885000
         L     @04,BCDVPTR                                         1714 06886000
         MVC   PREVCSN(12),BCDCSN1(@04)                            1714 06887000
*           IF BCDLIB1=0 THEN                                      1715 06888000
         CLI   BCDLIB1(@04),0                                      1715 06889000
         BNE   @RF01715                                            1715 06890000
*             BASDEST(1:5)=MSF0CHAR;/*                       @Z40LB66*/ 06891000
         MVC   BASDEST(5,BASEVPTR),MSF0CHAR                        1716 06892000
*           IF BCDLIB1=1 THEN                                      1717 06893000
@RF01715 L     @04,BCDVPTR                                         1717 06894000
         CLI   BCDLIB1(@04),1                                      1717 06895000
         BNE   @RF01717                                            1717 06896000
*             BASDEST(1:5)=MSF1CHAR;/*                       @Z40LB66*/ 06897000
         MVC   BASDEST(5,BASEVPTR),MSF1CHAR                        1718 06898000
*         END;                      /*                       @Z40LB66*/ 06899000
*       ELSE                                                       1720 06900000
*         DO;                       /*                       @Z40LB66*/ 06901000
         B     @RC01712                                            1720 06902000
@RF01712 DS    0H                                                  1721 06903000
*           PREVCSN=BCDCSN2;        /*                       @Z40LB66*/ 06904000
         L     @04,BCDVPTR                                         1721 06905000
         MVC   PREVCSN(12),BCDCSN2(@04)                            1721 06906000
*           BCDCSN2=BCDCSN1;        /*                       @Z40LB66*/ 06907000
         MVC   BCDCSN2(12,@04),BCDCSN1(@04)                        1722 06908000
*           BCDCSN1=PREVCSN;        /*                       @Z40LB66*/ 06909000
         MVC   BCDCSN1(12,@04),PREVCSN                             1723 06910000
*           IF BCDLIB2=0 THEN                                      1724 06911000
         CLI   BCDLIB2(@04),0                                      1724 06912000
         BNE   @RF01724                                            1724 06913000
*             BASDEST(1:5)=MSF0CHAR;/*                       @Z40LB66*/ 06914000
         MVC   BASDEST(5,BASEVPTR),MSF0CHAR                        1725 06915000
*           IF BCDLIB2=1 THEN                                      1726 06916000
@RF01724 L     @04,BCDVPTR                                         1726 06917000
         CLI   BCDLIB2(@04),1                                      1726 06918000
         BNE   @RF01726                                            1726 06919000
*             BASDEST(1:5)=MSF1CHAR;/*                       @Z40LB66*/ 06920000
         MVC   BASDEST(5,BASEVPTR),MSF1CHAR                        1727 06921000
*         END;                      /*                       @Z40LB66*/ 06922000
*     END;                          /*                       @Z40LB66*/ 06923000
*   ELSE                                                           1730 06924000
*     DO;                           /*                       @Z40LB66*/ 06925000
*                                                                  1730 06926000
         B     @RC01707                                            1730 06927000
@RF01707 DS    0H                                                  1731 06928000
*       /*************************************************************/ 06929000
*       /*                                                           */ 06930000
*       /* WHEN PROCESSING ONLY SPECIFIED CARTRIDGES,        @Z40LB66*/ 06931000
*       /* THE CSN IS IN THE READVVI PARAMETER LIST          @Z40LB66*/ 06932000
*       /*                                                           */ 06933000
*       /*************************************************************/ 06934000
*                                                                  1731 06935000
*       IF RVVRDCSN=BCDCSN1 THEN                                   1731 06936000
         L     @04,BCDVPTR                                         1731 06937000
         CLC   RVVRDCSN(12,RVVIPTR),BCDCSN1(@04)                   1731 06938000
         BNE   @RF01731                                            1731 06939000
*         DO;                       /*                       @Z40LB66*/ 06940000
*           PREVCSN=BCDCSN1;        /*                       @Z40LB66*/ 06941000
         MVC   PREVCSN(12),BCDCSN1(@04)                            1733 06942000
*           IF BCDLIB1=0 THEN                                      1734 06943000
         CLI   BCDLIB1(@04),0                                      1734 06944000
         BNE   @RF01734                                            1734 06945000
*             BASDEST(1:5)=MSF0CHAR;/*                       @Z40LB66*/ 06946000
         MVC   BASDEST(5,BASEVPTR),MSF0CHAR                        1735 06947000
*           IF BCDLIB1=1 THEN                                      1736 06948000
@RF01734 L     @04,BCDVPTR                                         1736 06949000
         CLI   BCDLIB1(@04),1                                      1736 06950000
         BNE   @RF01736                                            1736 06951000
*             BASDEST(1:5)=MSF1CHAR;/*                       @Z40LB66*/ 06952000
         MVC   BASDEST(5,BASEVPTR),MSF1CHAR                        1737 06953000
*         END;                      /*                       @Z40LB66*/ 06954000
*       ELSE                                                       1739 06955000
*         DO;                       /*                       @Z40LB66*/ 06956000
         B     @RC01731                                            1739 06957000
@RF01731 DS    0H                                                  1740 06958000
*           PREVCSN=BCDCSN2;        /*                       @Z40LB66*/ 06959000
         L     @04,BCDVPTR                                         1740 06960000
         MVC   PREVCSN(12),BCDCSN2(@04)                            1740 06961000
*           BCDCSN2=BCDCSN1;        /*                       @Z40LB66*/ 06962000
         MVC   BCDCSN2(12,@04),BCDCSN1(@04)                        1741 06963000
*           BCDCSN1=PREVCSN;        /*                       @Z40LB66*/ 06964000
         MVC   BCDCSN1(12,@04),PREVCSN                             1742 06965000
*           IF BCDLIB2=0 THEN                                      1743 06966000
         CLI   BCDLIB2(@04),0                                      1743 06967000
         BNE   @RF01743                                            1743 06968000
*             BASDEST(1:5)=MSF0CHAR;/*                       @Z40LB66*/ 06969000
         MVC   BASDEST(5,BASEVPTR),MSF0CHAR                        1744 06970000
*           IF BCDLIB2=1 THEN                                      1745 06971000
@RF01743 L     @04,BCDVPTR                                         1745 06972000
         CLI   BCDLIB2(@04),1                                      1745 06973000
         BNE   @RF01745                                            1745 06974000
*             BASDEST(1:5)=MSF1CHAR;/*                       @Z40LB66*/ 06975000
         MVC   BASDEST(5,BASEVPTR),MSF1CHAR                        1746 06976000
*         END;                      /*                       @Z40LB66*/ 06977000
@RF01745 DS    0H                                                  1748 06978000
*     END;                          /*                       @Z40LB66*/ 06979000
@RC01731 DS    0H                                                  1749 06980000
*   RETURN CODE(0);                 /*                       @Z40LB66*/ 06981000
@RC01707 SLR   @15,@15                                             1749 06982000
@EL00022 DS    0H                                                  1749 06983000
@EF00022 DS    0H                                                  1749 06984000
@ER00022 L     @14,12(,@13)                                        1749 06985000
         BR    @14                                                 1749 06986000
*   END CTGFMTR;                    /*                       @Z40LB66*/ 06987000
*                                                                  1751 06988000
*   /*****************************************************************/ 06989000
*   /*                                                               */ 06990000
*   /* PROCEDURE NAME - CTGPRNT                              @Z40LB66*/ 06991000
*   /*                                                       @Z40LB66*/ 06992000
*   /* FUNCTION - TO PRINT DATA FOR A SINGLE CARTRIDGE       @Z40LB66*/ 06993000
*   /*                                                       @Z40LB66*/ 06994000
*   /* INPUT - THE PRINT ARGUMENT LIST AND THE MSF           @Z40LB66*/ 06995000
*   /* IDENTIFIER IN THE VOLUME RECORD                       @Z40LB66*/ 06996000
*   /*                                                       @Z40LB66*/ 06997000
*   /* OUTPUT - RETURN CODE OF ZERO AND UPDATED              @Z40LB66*/ 06998000
*   /* SUMMARY TABLE                                         @Z40LB66*/ 06999000
*   /*                                                               */ 07000000
*   /*****************************************************************/ 07001000
*                                                                  1751 07002000
*CTGPRNT:                                                          1751 07003000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2056*/ 07004000
CTGPRNT  ST    @14,@SA00023                                        1751 07005000
*   OLDERID2=NEWERID2;                                             1752 07006000
         L     @07,@PC00001                                        1752 07007000
         L     @04,GDTTR2(,@07)                                    1752 07008000
         MVC   @TS00001(95),NEWERID2(@04)                          1752 07009000
         MVC   OLDERID2(95,@04),@TS00001                           1752 07010000
*   NEWID2='LVXA';                  /*                       @Z40LB66*/ 07011000
         MVC   NEWID2(4,@04),@CC02568                              1753 07012000
*   TESTRC=0;                       /*                       @Z40LB66*/ 07013000
*                                                                  1754 07014000
         SLR   TESTRC,TESTRC                                       1754 07015000
*   /*****************************************************************/ 07016000
*   /*                                                               */ 07017000
*   /* PRINT THE CARTRIDGE DATA                              @Z40LB66*/ 07018000
*   /*                                                               */ 07019000
*   /*****************************************************************/ 07020000
*                                                                  1755 07021000
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Z40LB66*/ 07022000
*                                                                  1755 07023000
         ST    @07,@AL00001                                        1755 07024000
         LA    @04,PRINTME                                         1755 07025000
         ST    @04,@AL00001+4                                      1755 07026000
         LA    @04,DDSTRU                                          1755 07027000
         ST    @04,@AL00001+8                                      1755 07028000
         MVI   @AL00001+8,X'80'                                    1755 07029000
         L     @15,GDTPRT(,@07)                                    1755 07030000
         LA    @01,@AL00001                                        1755 07031000
         BALR  @14,@15                                             1755 07032000
*   /*****************************************************************/ 07033000
*   /*                                                               */ 07034000
*   /* INCREMENT THE PROPER COUNTS IN THE SUMMARY TABLE      @Z40LB66*/ 07035000
*   /*                                                               */ 07036000
*   /*****************************************************************/ 07037000
*                                                                  1756 07038000
*   MAINCTR=MAINCTR+1;              /*                       @Z40LB66*/ 07039000
         LA    @07,1                                               1756 07040000
         L     @04,MAINCTR                                         1756 07041000
         ALR   @04,@07                                             1756 07042000
         ST    @04,MAINCTR                                         1756 07043000
*   SUMCTG=SUMCTG+1;                /*                       @Z40LB66*/ 07044000
         L     @04,SUMCTG                                          1757 07045000
         ALR   @04,@07                                             1757 07046000
         ST    @04,SUMCTG                                          1757 07047000
*   IF BASDEST(1:5)=MSF0CHAR(1:5) THEN                             1758 07048000
         CLC   BASDEST(5,BASEVPTR),MSF0CHAR                        1758 07049000
         BNE   @RF01758                                            1758 07050000
*     SUMMSF0=SUMMSF0+1;            /*                       @Z40LB66*/ 07051000
         AL    @07,SUMMSF0                                         1759 07052000
         ST    @07,SUMMSF0                                         1759 07053000
*   ELSE                                                           1760 07054000
*     IF BASDEST(1:5)=MSF1CHAR(1:5) THEN                           1760 07055000
         B     @RC01758                                            1760 07056000
@RF01758 CLC   BASDEST(5,BASEVPTR),MSF1CHAR                        1760 07057000
         BNE   @RF01760                                            1760 07058000
*       SUMMSF1=SUMMSF1+1;          /*                       @Z40LB66*/ 07059000
         LA    @07,1                                               1761 07060000
         AL    @07,SUMMSF1                                         1761 07061000
         ST    @07,SUMMSF1                                         1761 07062000
*     ELSE                                                         1762 07063000
*       SUMEJECT=SUMEJECT+1;        /*                       @Z40LB66*/ 07064000
         B     @RC01760                                            1762 07065000
@RF01760 LA    @07,1                                               1762 07066000
         AL    @07,SUMEJECT                                        1762 07067000
         ST    @07,SUMEJECT                                        1762 07068000
*   RETURN CODE(0);                 /*                       @Z40LB66*/ 07069000
@RC01760 DS    0H                                                  1763 07070000
@RC01758 SLR   @15,@15                                             1763 07071000
@EL00023 DS    0H                                                  1763 07072000
@EF00023 DS    0H                                                  1763 07073000
@ER00023 L     @14,@SA00023                                        1763 07074000
         BR    @14                                                 1763 07075000
*   END CTGPRNT;                    /*                       @Z40LB66*/ 07076000
*                                                                  1765 07077000
*   /*****************************************************************/ 07078000
*   /*                                                               */ 07079000
*   /*                                                       @ZA27752*/ 07080000
*   /* PROCEDURE NAME - DIRECTRD                             @ZA27752*/ 07081000
*   /*                                                       @ZA27752*/ 07082000
*   /* FUNCTION - THE PRIMARY FUNCTION OF THIS ROUTINE IS    @ZA27752*/ 07083000
*   /* TO SET THE PROGRAM KEY TO 0 IN ORDER TO               @ZA27752*/ 07084000
*   /* ALLOW SPECIAL PRIVILEGED INSTRUCTIONS AND             @ZA27752*/ 07085000
*   /* TO CALL (VIA BALR) THE MSVI QUEUE MANAGER             @ZA27752*/ 07086000
*   /* (ICBVQM00) TO DIRECTLY READ RECORDS SPEC-             @ZA27752*/ 07087000
*   /* IFIED BY OTHER PROCEDURES WITHIN LISTMSVI             @ZA27752*/ 07088000
*   /* WITHOUT USING SVC126 WHEREBY REDUCING I/O             @ZA27752*/ 07089000
*   /* OVERHEAD. THIS FUNCTION THEN ENHANCES                 @ZA27752*/ 07090000
*   /* PERFORMANCE OF THIS FREQUENTLY USED MSS               @ZA27752*/ 07091000
*   /* UTILITY.                                              @ZA27752*/ 07092000
*   /*                                                       @ZA27752*/ 07093000
*   /* INPUT - THE RVVI CONTROL BLOCK MUST HAVE BEEN         @ZA27752*/ 07094000
*   /* PREVIOUSLY INITIALIZED FOR THE CALLERS                @ZA27752*/ 07095000
*   /* SPECIAL REQUEST (SEE CALLING PROCEDURE).              @ZA27752*/ 07096000
*   /* THE MSVC CONTROL BLOCK (IEZSSC) MUST BE               @ZA27752*/ 07097000
*   /* MADE AVAILABLE TO MSS.                                @ZA27752*/ 07098000
*   /*                                                       @ZA27752*/ 07099000
*   /* OUTPUT - REGISTER 15 - 0 = SUCCESSFUL                 @ZA27752*/ 07100000
*   /* 4 = ICBVQM00 FAILED                                   @ZA27752*/ 07101000
*   /*                                                       @ZA27752*/ 07102000
*   /*                                                               */ 07103000
*   /*****************************************************************/ 07104000
*                                                                  1765 07105000
*DIRECTRD:                                                         1765 07106000
*   PROCEDURE;                      /*                       @ZA27752*/ 07107000
DIRECTRD STM   @14,@12,@SA00024                                    1765 07108000
*   OLDERID2=NEWERID2;                                             1766 07109000
         L     @07,@PC00001                                        1766 07110000
         L     @07,GDTTR2(,@07)                                    1766 07111000
         MVC   @TS00001(95),NEWERID2(@07)                          1766 07112000
         MVC   OLDERID2(95,@07),@TS00001                           1766 07113000
*   NEWID2='LVDR';                  /*                       @ZA27752*/ 07114000
         MVC   NEWID2(4,@07),@CC02572                              1767 07115000
*   TESTRC=0;                       /*                       @ZA27752*/ 07116000
*                                                                  1768 07117000
         SLR   TESTRC,TESTRC                                       1768 07118000
*   /*****************************************************************/ 07119000
*   /*                                                               */ 07120000
*   /* SET UP ADDRESSABILITY TO THE QUEUE MANAGER WITH THE   @ZA27752*/ 07121000
*   /* REGISTER 0 SET TO ZERO AND REGISTER 1 POINTING TO THE @ZA27752*/ 07122000
*   /* RVVI CONTROL BLOCK. SAVE THE KEY OF THE CALLER'S      @ZA27752*/ 07123000
*   /* TCB IN ORDER TO RESTORE IT AFTER RETURNING FROM VQM.  @ZA27752*/ 07124000
*   /*                                                               */ 07125000
*   /*****************************************************************/ 07126000
*                                                                  1769 07127000
*   RESPECIFY                                                      1769 07128000
*    (REG0,                                                        1769 07129000
*     REG1,                                                        1769 07130000
*     REG2,                                                        1769 07131000
*     REG15) RESTRICTED;            /*                       @ZA27752*/ 07132000
*   REG15=ICBVVIC;                  /*                       @ZA27752*/ 07133000
         L     @07,CVTPTR                                          1770 07134000
         L     @07,CVTEXT2(,@07)                                   1770 07135000
         L     @07,CVTICB(,@07)                                    1770 07136000
         L     REG15,ICBVVIC(,@07)                                 1770 07137000
*   REG1=RVVIPTR;                   /*                       @ZA27752*/ 07138000
         LR    REG1,RVVIPTR                                        1771 07139000
*   REG0=NULLPTR;                   /*                       @ZA27752*/ 07140000
         SLR   REG0,REG0                                           1772 07141000
*   REG2=NULLPTR;                   /*                       @ZA27752*/ 07142000
         SLR   REG2,REG2                                           1773 07143000
*   IPK;                            /*                       @ZA27752*/ 07144000
*                                                                  1774 07145000
         IPK                                                       1774 07146000
*   /*****************************************************************/ 07147000
*   /*                                                               */ 07148000
*   /* THE SPKA INSTRUCTION PUTS US IN KEY 0. SINCE THERE    @ZA27752*/ 07149000
*   /* IS POTENTIAL EXPOSURE TO UNINTENTIONAL MISUSE OF      @ZA27752*/ 07150000
*   /* PRIVILEGED INSTRUCTIONS OR POSSIBLE OVER-WRITING OF   @ZA27752*/ 07151000
*   /* LOW CORE, CARE SHOULD BE TAKEN WITH ISSUING ANY       @ZA27752*/ 07152000
*   /* INTERVENING INSTRUCTIONS.                             @ZA27752*/ 07153000
*   /*                                                               */ 07154000
*   /*****************************************************************/ 07155000
*                                                                  1775 07156000
*   GENERATE;                                                      1775 07157000
*                                                                  1775 07158000
*                                                         /*@ZA27752*/  07159000
        SPKA 0(0)                                                       07160000
        BALR 14,15                                                      07161000
        SPKA 0(2)                                                       07162000
*   /*****************************************************************/ 07163000
*   /*                                                               */ 07164000
*   /* NOW WE HAVE RETURNED TO THE KEY OF OUR CALLERS TCB.   @ZA27752*/ 07165000
*   /*                                                               */ 07166000
*   /*****************************************************************/ 07167000
*                                                                  1776 07168000
*   RESPECIFY                                                      1776 07169000
*     RTNREG RSTD;                                                 1776 07170000
*   TESTRC=RTNREG;                                                 1777 07171000
         LR    TESTRC,RTNREG                                       1777 07172000
*   RESPECIFY                                                      1778 07173000
*     RTNREG UNRSTD;                /*                       @ZA27752*/ 07174000
*   IF TESTRC=0 THEN                /*                       @ZA27752*/ 07175000
         LTR   TESTRC,TESTRC                                       1779 07176000
         BNZ   @RF01779                                            1779 07177000
*     REASON=REASON&&REASON;        /*                       @ZA27752*/ 07178000
         L     @14,REASON                                          1780 07179000
         LR    @07,@14                                             1780 07180000
         XR    @07,@14                                             1780 07181000
         ST    @07,REASON                                          1780 07182000
*   ELSE                            /*                       @ZA27752*/ 07183000
*     REASON=REG0;                  /*                       @ZA27752*/ 07184000
         B     @RC01779                                            1781 07185000
@RF01779 ST    REG0,REASON                                         1781 07186000
*   RESPECIFY                                                      1782 07187000
*    (REG0,                                                        1782 07188000
*     REG1,                                                        1782 07189000
*     REG2,                                                        1782 07190000
*     REG15) UNRESTRICTED;          /*                       @ZA27752*/ 07191000
*                                                                  1782 07192000
@RC01779 DS    0H                                                  1783 07193000
*   /*****************************************************************/ 07194000
*   /*                                                               */ 07195000
*   /* RETURN TO CALLER WITH PROPER RETURN CODE              @ZA27752*/ 07196000
*   /*                                                               */ 07197000
*   /*****************************************************************/ 07198000
*                                                                  1783 07199000
*   RETURN CODE(TESTRC);            /*                       @ZA27752*/ 07200000
         LR    @15,TESTRC                                          1783 07201000
         L     @14,@SA00024                                        1783 07202000
         LM    @00,@12,@SA00024+8                                  1783 07203000
         BR    @14                                                 1783 07204000
*   END DIRECTRD;                   /*                       @ZA27752*/ 07205000
*                                                                  1785 07206000
*/***********************************************************@Y30LB39*/ 07207000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07208000
*/*                                                          @Y30LB39*/ 07209000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07210000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07211000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07212000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07213000
*/*                                                          @Y30LB39*/ 07214000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07215000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07216000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07217000
*/*                                                          @Y30LB39*/ 07218000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07219000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07220000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07221000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07222000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07223000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07224000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07225000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07226000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07227000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07228000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07229000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07230000
*/*                                                          @Y30LB39*/ 07231000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07232000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07233000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07234000
*/*                                                          @Y30LB39*/ 07235000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07236000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07237000
*/*                                                          @Y30LB39*/ 07238000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07239000
*/*                                                          @Y30LB39*/ 07240000
*/***********************************************************@Y30LB39*/ 07241000
*                                                                  1785 07242000
*                                   /*                       @Y30LB39*/ 07243000
*SSCMSG:                                                           1785 07244000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07245000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07246000
*                                                            @Y30LB39*/ 07247000
SSCMSG   STM   @14,@12,@SA00025                                    1785 07248000
         MVC   @PC00025(8),0(@01)                                  1785 07249000
*                                   /*                       @Y30LB39*/ 07250000
*                                                                  1786 07251000
*   /*****************************************************************/ 07252000
*   /*                                                               */ 07253000
*   /*                                                       @Y30LB39*/ 07254000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07255000
*   /*                                                       @Y30LB39*/ 07256000
*   /*                                                               */ 07257000
*   /*****************************************************************/ 07258000
*                                                                  1786 07259000
*                                   /*                       @Y30LB39   07260000
*                                                            @Y30LB39*/ 07261000
*                                                                  1786 07262000
*   /*****************************************************************/ 07263000
*   /*                                                               */ 07264000
*   /*                                                       @Y30LB39*/ 07265000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07266000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07267000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07268000
*   /*                                                       @Y30LB39*/ 07269000
*   /*                                                               */ 07270000
*   /*****************************************************************/ 07271000
*                                                                  1786 07272000
*                                   /*                       @Y30LB39*/ 07273000
*   DCL                                                            1786 07274000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07275000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07276000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07277000
*   DCL                                                            1787 07278000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07279000
*                                                            @Y30LB39   07280000
*                                                            @Y30LB39*/ 07281000
*                                                                  1787 07282000
*   /*****************************************************************/ 07283000
*   /*                                                               */ 07284000
*   /*                                                       @Y30LB39*/ 07285000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07286000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07287000
*   /*                                                       @Y30LB39*/ 07288000
*   /*                                                               */ 07289000
*   /*****************************************************************/ 07290000
*                                                                  1788 07291000
*                                   /*                       @Y30LB39*/ 07292000
*   DCL                                                            1788 07293000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07294000
*   DCL                                                            1789 07295000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07296000
*                                                            @Y30LB39*/ 07297000
*                                                                  1789 07298000
*   /*****************************************************************/ 07299000
*   /*                                                               */ 07300000
*   /*                                                       @Y30LB39*/ 07301000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07302000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07303000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07304000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07305000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07306000
*   /*                                                       @Y30LB39*/ 07307000
*   /*                                                               */ 07308000
*   /*****************************************************************/ 07309000
*                                                                  1790 07310000
*                                   /*                       @Y30LB39*/ 07311000
*   DECLARE                                                        1790 07312000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07313000
*                                                            @Y30LB39*/ 07314000
*                                                                  1790 07315000
*   /*****************************************************************/ 07316000
*   /*                                                               */ 07317000
*   /*                                                       @Y30LB39*/ 07318000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07319000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07320000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07321000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07322000
*   /*                                                       @Y30LB39*/ 07323000
*   /*                                                               */ 07324000
*   /*****************************************************************/ 07325000
*                                                                  1791 07326000
*                                   /*                       @Y30LB39*/ 07327000
*   DECLARE                                                        1791 07328000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07329000
*                                                            @Y30LB39*/ 07330000
*                                                                  1791 07331000
*   /*****************************************************************/ 07332000
*   /*                                                               */ 07333000
*   /*                                                       @Y30LB39*/ 07334000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07335000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07336000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07337000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07338000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07339000
*   /*                                                       @Y30LB39*/ 07340000
*   /*                                                               */ 07341000
*   /*****************************************************************/ 07342000
*                                                                  1792 07343000
*                                   /*                       @Y30LB39*/ 07344000
*   DECLARE                                                        1792 07345000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07346000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07347000
*                                                            @Y30LB39*/ 07348000
*                                                                  1792 07349000
*   /*****************************************************************/ 07350000
*   /*                                                               */ 07351000
*   /*                                                       @Y30LB39*/ 07352000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07353000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07354000
*   /*                                                       @Y30LB39*/ 07355000
*   /*                                                               */ 07356000
*   /*****************************************************************/ 07357000
*                                                                  1793 07358000
*                                   /*                       @Y30LB39*/ 07359000
*   DECLARE                                                        1793 07360000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07361000
*                                                            @Y30LB39*/ 07362000
*                                                                  1793 07363000
*   /*****************************************************************/ 07364000
*   /*                                                               */ 07365000
*   /*                                                       @Y30LB39*/ 07366000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07367000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07368000
*   /*                                                       @Y30LB39*/ 07369000
*   /*                                                               */ 07370000
*   /*****************************************************************/ 07371000
*                                                                  1794 07372000
*                                   /*                       @Y30LB39*/ 07373000
*   DECLARE                                                        1794 07374000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07375000
*                                                            @Y30LB39*/ 07376000
*                                   /*                       @Y30LB39*/ 07377000
*                                                                  1795 07378000
*   /*****************************************************************/ 07379000
*   /*                                                               */ 07380000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07381000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07382000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07383000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07384000
*   /*                                                       @Y30LB39*/ 07385000
*   /*                                                               */ 07386000
*   /*****************************************************************/ 07387000
*                                                                  1795 07388000
*                                   /*                       @Y30LB39*/ 07389000
*   OLDERID2=NEWERID2;                                             1795 07390000
         L     @15,@PC00001                                        1795 07391000
         L     @14,GDTTR2(,@15)                                    1795 07392000
         MVC   @TS00001(95),NEWERID2(@14)                          1795 07393000
         MVC   OLDERID2(95,@14),@TS00001                           1795 07394000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07395000
*                                                            @Y30LB39*/ 07396000
*                                                                  1796 07397000
         MVC   NEWID2(4,@14),@CC02594                              1796 07398000
*   /*****************************************************************/ 07399000
*   /*                                                               */ 07400000
*   /*                                                       @Y30LB39*/ 07401000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 07402000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 07403000
*   /*                                                       @Y30LB39*/ 07404000
*   /*                                                               */ 07405000
*   /*****************************************************************/ 07406000
*                                                                  1797 07407000
*                                   /*                       @Y30LB39*/ 07408000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   07409000
*                                                            @Y30LB39*/ 07410000
*                                                                  1797 07411000
         LA    @14,SSDRGLT                                         1797 07412000
         ST    @14,SSDLPTR                                         1797 07413000
*   /*****************************************************************/ 07414000
*   /*                                                               */ 07415000
*   /*                                                       @Y30LB39*/ 07416000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 07417000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 07418000
*   /*                                                       @Y30LB39*/ 07419000
*   /*                                                               */ 07420000
*   /*****************************************************************/ 07421000
*                                                                  1798 07422000
*                                   /*                       @Y30LB39*/ 07423000
*   IF SSRCODE>0 THEN                                              1798 07424000
         L     @07,@PC00025                                        1798 07425000
         L     @07,SSRCODE(,@07)                                   1798 07426000
         LTR   @07,@07                                             1798 07427000
         BNP   @RF01798                                            1798 07428000
*     DO;                           /*                       @Y30LB39   07429000
*                                                            @Y30LB39*/ 07430000
*                                                                  1799 07431000
*       /*************************************************************/ 07432000
*       /*                                                           */ 07433000
*       /*                                                   @Y30LB39*/ 07434000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 07435000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 07436000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 07437000
*       /* CODES.                                            @Y30LB39*/ 07438000
*       /*                                                   @Y30LB39*/ 07439000
*       /*                                                           */ 07440000
*       /*************************************************************/ 07441000
*                                                                  1800 07442000
*                                   /*                       @Y30LB39*/ 07443000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07444000
         XC    SSDRGLT(20),SSDRGLT                                 1800 07445000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 07446000
         LA    @03,SSINXLST                                        1801 07447000
         ST    @03,DARGRETP(,@14)                                  1801 07448000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07449000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1802 07450000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 07451000
         MVI   DARGSENT(@14),X'01'                                 1803 07452000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   07453000
*                                                            @Y30LB39*/ 07454000
*                                                                  1804 07455000
         MVC   DARGRETL(2,@14),@CH02613                            1804 07456000
*       /*************************************************************/ 07457000
*       /*                                                           */ 07458000
*       /*                                                   @Y30LB39*/ 07459000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 07460000
*       /* ARRAY.                                            @Y30LB39*/ 07461000
*       /*                                                   @Y30LB39*/ 07462000
*       /*                                                           */ 07463000
*       /*************************************************************/ 07464000
*                                                                  1805 07465000
*                                   /*                       @Y30LB39*/ 07466000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   07467000
*                                                            @Y30LB39*/ 07468000
*                                                                  1805 07469000
         ST    @15,@AL00001                                        1805 07470000
         LA    @03,@CF00117                                        1805 07471000
         ST    @03,@AL00001+4                                      1805 07472000
         LA    @03,SSDLPTR                                         1805 07473000
         ST    @03,@AL00001+8                                      1805 07474000
         MVI   @AL00001+8,X'80'                                    1805 07475000
         L     @15,GDTPRT(,@15)                                    1805 07476000
         LA    @01,@AL00001                                        1805 07477000
         BALR  @14,@15                                             1805 07478000
*       /*************************************************************/ 07479000
*       /*                                                           */ 07480000
*       /*                                                   @Y30LB39*/ 07481000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 07482000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 07483000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 07484000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 07485000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 07486000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 07487000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 07488000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 07489000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 07490000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 07491000
*       /* REASON CODE.                                      @Y30LB39*/ 07492000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 07493000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 07494000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 07495000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 07496000
*       /*                                                   @Y30LB39*/ 07497000
*       /*                                                           */ 07498000
*       /*************************************************************/ 07499000
*                                                                  1806 07500000
*                                   /*                       @Y30LB39*/ 07501000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 07502000
         LA    ENTRYNUM,1                                          1806 07503000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1807 07504000
@DL01807 DS    0H                                                  1808 07505000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 07506000
         LA    ENTRYNUM,1(,ENTRYNUM)                               1808 07507000
*       END;                        /*                       @Y30LB39   07508000
*                                                            @Y30LB39*/ 07509000
*                                                                  1809 07510000
@DE01807 L     @03,@PC00025                                        1809 07511000
         LR    @15,ENTRYNUM                                        1809 07512000
         ALR   @15,@15                                             1809 07513000
         LH    @15,SSARRAY-2(@15)                                  1809 07514000
         CH    @15,SSRHALF(,@03)                                   1809 07515000
         BE    @DC01807                                            1809 07516000
         LTR   @15,@15                                             1809 07517000
         BNZ   @DL01807                                            1809 07518000
@DC01807 DS    0H                                                  1810 07519000
*       /*************************************************************/ 07520000
*       /*                                                           */ 07521000
*       /*                                                   @Y30LB39*/ 07522000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 07523000
*       /*                                                   @Y30LB39*/ 07524000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 07525000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 07526000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 07527000
*       /* CODE OR                                           @Y30LB39*/ 07528000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 07529000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 07530000
*       /*                                                   @Y30LB39*/ 07531000
*       /*                                                           */ 07532000
*       /*************************************************************/ 07533000
*                                                                  1810 07534000
*                                   /*                       @Y30LB39*/ 07535000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07536000
         XC    SSDRGLT(20),SSDRGLT                                 1810 07537000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07538000
         L     @03,SSDLPTR                                         1811 07539000
         MVC   DARGSMOD(3,@03),SSMODSS0                            1811 07540000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 07541000
         STC   ENTRYNUM,DARGSENT(,@03)                             1812 07542000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 07543000
         LR    @15,ENTRYNUM                                        1813 07544000
         ALR   @15,@15                                             1813 07545000
         LH    @15,SSARRAY-2(@15)                                  1813 07546000
         LTR   @15,@15                                             1813 07547000
         BNZ   @RF01813                                            1813 07548000
*         DO;                       /*                       @Y30LB39*/ 07549000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 07550000
         L     @02,@PC00025                                        1815 07551000
         ST    @02,DARGDBP(,@03)                                   1815 07552000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 07553000
         MVC   DARGILP(2,@03),@CH00043                             1816 07554000
*         END;                      /*                       @Y30LB39*/ 07555000
*     END;                          /*                       @Y30LB39*/ 07556000
*                                   /*                       @Y30LB39*/ 07557000
*                                                                  1819 07558000
*   /*****************************************************************/ 07559000
*   /*                                                               */ 07560000
*   /*                                                       @Y30LB39*/ 07561000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 07562000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 07563000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 07564000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 07565000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 07566000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 07567000
*   /* POST CODE.                                            @Y30LB39*/ 07568000
*   /*                                                       @Y30LB39*/ 07569000
*   /*                                                               */ 07570000
*   /*****************************************************************/ 07571000
*                                                                  1819 07572000
*                                   /*                       @Y30LB39*/ 07573000
*   ELSE                            /*                       @Y30LB39*/ 07574000
*     DO;                           /*                       @Y30LB39*/ 07575000
         B     @RC01798                                            1819 07576000
@RF01798 DS    0H                                                  1820 07577000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07578000
         XC    SSDRGLT(20),SSDRGLT                                 1820 07579000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 07580000
         L     @15,SSDLPTR                                         1821 07581000
         MVC   DARGSMOD(3,@15),SSMODCM0                            1821 07582000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 07583000
         IC    @14,SSMSGNUM                                        1822 07584000
         STC   @14,DARGSENT(,@15)                                  1822 07585000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 07586000
         L     @14,@PC00025+4                                      1823 07587000
         ST    @14,DARGDBP(,@15)                                   1823 07588000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 07589000
         MVC   DARGILP(2,@15),@CH00221                             1824 07590000
*     END;                          /*                       @Y30LB39   07591000
*                                                            @Y30LB39*/ 07592000
*                                                                  1825 07593000
*   /*****************************************************************/ 07594000
*   /*                                                               */ 07595000
*   /*                                                       @Y30LB39*/ 07596000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 07597000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 07598000
*   /*                                                       @Y30LB39*/ 07599000
*   /*                                                               */ 07600000
*   /*****************************************************************/ 07601000
*                                                                  1826 07602000
*                                   /*                       @Y30LB39*/ 07603000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   07604000
*                                                            @Y30LB39*/ 07605000
*                                                                  1826 07606000
@RC01798 L     @15,@PC00001                                        1826 07607000
         ST    @15,@AL00001                                        1826 07608000
         LA    @14,@CF00117                                        1826 07609000
         ST    @14,@AL00001+4                                      1826 07610000
         LA    @14,SSDLPTR                                         1826 07611000
         ST    @14,@AL00001+8                                      1826 07612000
         MVI   @AL00001+8,X'80'                                    1826 07613000
         L     @15,GDTPRT(,@15)                                    1826 07614000
         LA    @01,@AL00001                                        1826 07615000
         BALR  @14,@15                                             1826 07616000
*   /*****************************************************************/ 07617000
*   /*                                                               */ 07618000
*   /*                                                       @Y30LB39*/ 07619000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 07620000
*   /*                                                       @Y30LB39*/ 07621000
*   /*                                                               */ 07622000
*   /*****************************************************************/ 07623000
*                                                                  1827 07624000
*                                   /*                       @Y30LB39   07625000
*                                                            @Y30LB39*/ 07626000
*   RETURN CODE(0);                 /*                       @Y30LB39   07627000
*                                                            @Y30LB39*/ 07628000
         SLR   @15,@15                                             1827 07629000
         L     @14,@SA00025                                        1827 07630000
         LM    @00,@12,@SA00025+8                                  1827 07631000
         BR    @14                                                 1827 07632000
*   END SSCMSG;                     /*                       @Y30LB39*/ 07633000
*                                                                  1829 07634000
*/****************************************************************** */ 07635000
*/*                                                          @Y30LB32*/ 07636000
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/ 07637000
*/*                                                          @Y30LB32*/ 07638000
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/ 07639000
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/ 07640000
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/ 07641000
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/ 07642000
*/*             CHARACTER                                    @Y30LB32*/ 07643000
*/*                                                          @Y30LB32*/ 07644000
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/ 07645000
*/*                                                          @Y30LB32*/ 07646000
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/ 07647000
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/ 07648000
*/*                                                          @Y30LB32*/ 07649000
*/********************************************************************/ 07650000
*                                                                  1829 07651000
*CKCSNLEN:                          /*                       @Y30LB32*/ 07652000
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/ 07653000
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/ 07654000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/ 07655000
*                                                                  1829 07656000
CKCSNLEN MVC   @PC00026(8),0(@01)                                  1829 07657000
*   /*****************************************************************/ 07658000
*   /*                                                               */ 07659000
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/ 07660000
*   /*                                                               */ 07661000
*   /*****************************************************************/ 07662000
*                                                                  1830 07663000
*   DCL                                                            1830 07664000
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/ 07665000
*   DCL                                                            1831 07666000
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/ 07667000
*   DCL                                                            1832 07668000
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/ 07669000
*   DCL                                                            1833 07670000
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/ 07671000
*   DCL                                                            1834 07672000
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/ 07673000
*   DCL                                                            1835 07674000
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/ 07675000
*   DCL                                                            1836 07676000
*     CKCOND FIXED(15);                                            1836 07677000
*                                                                  1836 07678000
*   /*****************************************************************/ 07679000
*   /*                                                               */ 07680000
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/ 07681000
*   /*                                                               */ 07682000
*   /*****************************************************************/ 07683000
*                                                                  1837 07684000
*   DCL                                                            1837 07685000
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32   07686000
*                                      CSN                   @Y30LB32*/ 07687000
*   DCL                                                            1838 07688000
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32   07689000
*                                      OF CSN AGAINST        @Y30LB32*/ 07690000
*   DCL                                                            1839 07691000
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/ 07692000
*   DCL                                                            1840 07693000
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/ 07694000
*                                                                  1841 07695000
*   /*****************************************************************/ 07696000
*   /*                                                               */ 07697000
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/ 07698000
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/ 07699000
*   /*                                                               */ 07700000
*   /*****************************************************************/ 07701000
*                                                                  1841 07702000
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/ 07703000
         LR    CKRETPTR,REG14                                      1841 07704000
*   OLDERID2=NEWERID2;                                             1842 07705000
         L     @04,@PC00001                                        1842 07706000
         L     @04,GDTTR2(,@04)                                    1842 07707000
         MVC   @TS00001(95),NEWERID2(@04)                          1842 07708000
         MVC   OLDERID2(95,@04),@TS00001                           1842 07709000
*   NEWID2='CKLN';                  /*                       @Y30LB32*/ 07710000
*                                                                  1843 07711000
         MVC   NEWID2(4,@04),@CC02612                              1843 07712000
*   /*****************************************************************/ 07713000
*   /*                                                               */ 07714000
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/ 07715000
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/ 07716000
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/ 07717000
*   /*                                                               */ 07718000
*   /*****************************************************************/ 07719000
*                                                                  1844 07720000
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/ 07721000
         L     CKSAVPTR,DDSTRU                                     1844 07722000
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/ 07723000
         LA    @04,CKPRTTAB                                        1845 07724000
         ST    @04,DDSTRU                                          1845 07725000
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/ 07726000
         XC    CKPRTTAB(20),CKPRTTAB                               1846 07727000
*   CKCOND=''B;                     /*                       @Y30LB32*/ 07728000
*                                                                  1847 07729000
         SLR   CKCOND,CKCOND                                       1847 07730000
*   /*****************************************************************/ 07731000
*   /*                                                               */ 07732000
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/ 07733000
*   /* OR MORE                                               @Y30LB32*/ 07734000
*   /*                                                               */ 07735000
*   /*****************************************************************/ 07736000
*                                                                  1848 07737000
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/ 07738000
*                                                                  1848 07739000
         L     @04,@PC00026+4                                      1848 07740000
         CLI   CKLENGTH(@04),11                                    1848 07741000
         BL    @RF01848                                            1848 07742000
*     /***************************************************************/ 07743000
*     /*                                                             */ 07744000
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/ 07745000
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/ 07746000
*     /* CHARACTER                                           @Y30LB32*/ 07747000
*     /*                                                             */ 07748000
*     /***************************************************************/ 07749000
*                                                                  1849 07750000
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/ 07751000
         CLI   CKLENGTH(@04),11                                    1849 07752000
         BNE   @RF01849                                            1849 07753000
*       DO;                         /*                       @Y30LB32*/ 07754000
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/ 07755000
         MVI   CKCSNADJ+3,C' '                                     1851 07756000
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/ 07757000
         L     @04,@PC00026                                        1852 07758000
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@04)                       1852 07759000
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/ 07760000
         MVC   CKCSNVAL+3(9,@04),CKCSNADJ+3                        1853 07761000
*       END;                        /*                       @Y30LB32*/ 07762000
*     ELSE                                                         1855 07763000
*       ;                           /*                       @Y30LB32*/ 07764000
*                                                                  1855 07765000
@RF01849 DS    0H                                                  1856 07766000
*   /*****************************************************************/ 07767000
*   /*                                                               */ 07768000
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/ 07769000
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/ 07770000
*   /*                                                               */ 07771000
*   /*****************************************************************/ 07772000
*                                                                  1856 07773000
*   ELSE                            /*                       @Y30LB32*/ 07774000
*     DO;                           /*                       @Y30LB32*/ 07775000
         B     @RC01848                                            1856 07776000
@RF01848 DS    0H                                                  1857 07777000
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/ 07778000
         L     @04,DDSTRU                                          1857 07779000
         MVC   DARGSMOD(3,@04),@CC02400                            1857 07780000
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/ 07781000
         MVI   DARGSENT(@04),X'01'                                 1858 07782000
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/ 07783000
         L     @15,@PC00026                                        1859 07784000
         ST    @15,DARGDBP(,@04)                                   1859 07785000
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/ 07786000
         MVC   DARGILP(2,@04),@CH00038                             1860 07787000
*       DARGRETP=''B;               /*                       @Y30LB32*/ 07788000
         SLR   @15,@15                                             1861 07789000
         ST    @15,DARGRETP(,@04)                                  1861 07790000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 07791000
         L     @04,@PC00001                                        1862 07792000
         ST    @04,@AL00001                                        1862 07793000
         LA    @15,@CF00117                                        1862 07794000
         ST    @15,@AL00001+4                                      1862 07795000
         LA    @15,DDSTRU                                          1862 07796000
         ST    @15,@AL00001+8                                      1862 07797000
         MVI   @AL00001+8,X'80'                                    1862 07798000
         L     @15,GDTPRT(,@04)                                    1862 07799000
         LA    @01,@AL00001                                        1862 07800000
         BALR  @14,@15                                             1862 07801000
*       CKCOND=4;                   /*                       @Y30LB32*/ 07802000
         LA    CKCOND,4                                            1863 07803000
*     END;                          /*                       @Y30LB32*/ 07804000
*                                                                  1864 07805000
*   /*****************************************************************/ 07806000
*   /*                                                               */ 07807000
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/ 07808000
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/ 07809000
*   /*                                                               */ 07810000
*   /*****************************************************************/ 07811000
*                                                                  1865 07812000
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/ 07813000
@RC01848 ST    CKSAVPTR,DDSTRU                                     1865 07814000
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/ 07815000
         LR    REG14,CKRETPTR                                      1866 07816000
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/ 07817000
         LR    @15,CKCOND                                          1867 07818000
@EL00026 DS    0H                                                  1867 07819000
@EF00026 DS    0H                                                  1867 07820000
@ER00026 BR    @14                                                 1867 07821000
*   END CKCSNLEN;                   /*                       @Y30LB32*/ 07822000
*   END IDCLV01                     /*                       @Y30LB33*/ 07823000
*                                                                  1869 07824000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07825000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 07826000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 07827000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 07828000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 07829000
*/*%INCLUDE SYSLIB  (IDCCSLV )                                       */ 07830000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 07831000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 07832000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 07833000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 07834000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 07835000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 07836000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 07837000
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */ 07838000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 07839000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 07840000
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */ 07841000
*                                                                  1869 07842000
*       ;                                                          1869 07843000
@DATA    DS    0H                                                       07844000
@CH00159 DC    H'6'                                                     07845000
@CH00037 DC    H'10'                                                    07846000
@CH00650 DC    H'14'                                                    07847000
@CH02362 DC    H'36'                                                    07848000
@CH02164 DC    H'48'                                                    07849000
@CH02621 DC    H'68'                                                    07850000
@CH02419 DC    H'73'                                                    07851000
@CH02420 DC    H'89'                                                    07852000
@CH02418 DC    H'107'                                                   07853000
@CH02613 DC    H'120'                                                   07854000
@CH02378 DC    H'121'                                                   07855000
@CH02619 DC    H'164'                                                   07856000
@CH02623 DC    H'182'                                                   07857000
@CH02624 DC    H'184'                                                   07858000
@CH02618 DC    H'224'                                                   07859000
@CH02625 DC    H'244'                                                   07860000
@CH02520 DC    H'404'                                                   07861000
@CH02376 DC    H'484'                                                   07862000
@DATD    DSECT                                                          07863000
         DS    0F                                                       07864000
@SA00001 DS    18F                                                      07865000
@PC00001 DS    3F                                                       07866000
@SA00002 DS    1F                                                       07867000
@SA00006 DS    1F                                                       07868000
@SA00003 DS    1F                                                       07869000
@SA00004 DS    1F                                                       07870000
@SA00005 DS    1F                                                       07871000
@SA00018 DS    1F                                                       07872000
@SA00019 DS    1F                                                       07873000
@SA00009 DS    1F                                                       07874000
@SA00016 DS    1F                                                       07875000
@SA00013 DS    1F                                                       07876000
@SA00015 DS    1F                                                       07877000
@SA00014 DS    1F                                                       07878000
@SA00007 DS    1F                                                       07879000
@SA00008 DS    1F                                                       07880000
@SA00011 DS    1F                                                       07881000
@SA00010 DS    1F                                                       07882000
@SA00012 DS    1F                                                       07883000
@SA00024 DS    15F                                                      07884000
@SA00025 DS    15F                                                      07885000
@PC00025 DS    2F                                                       07886000
@PC00026 DS    2F                                                       07887000
@SA00020 DS    1F                                                       07888000
@SA00021 DS    1F                                                       07889000
@SA00023 DS    1F                                                       07890000
@AL00001 DS    3A                                                       07891000
@TF00001 DS    F                                                        07892000
IDCLV01  CSECT                                                          07893000
         DS    0F                                                       07894000
@CF00117 DC    F'0'                                                     07895000
@CH00117 EQU   @CF00117+2                                               07896000
@CF00221 DC    F'1'                                                     07897000
@CH00221 EQU   @CF00221+2                                               07898000
@CF00156 DC    F'2'                                                     07899000
@CH00156 EQU   @CF00156+2                                               07900000
@CF00165 DC    F'3'                                                     07901000
@CH00165 EQU   @CF00165+2                                               07902000
@CF00043 DC    F'4'                                                     07903000
@CH00043 EQU   @CF00043+2                                               07904000
@CF00035 DC    F'8'                                                     07905000
@CH00035 EQU   @CF00035+2                                               07906000
@CF00038 DC    F'12'                                                    07907000
@CH00038 EQU   @CF00038+2                                               07908000
@CF00507 DC    F'16'                                                    07909000
@CH00507 EQU   @CF00507+2                                               07910000
@CF02312 DC    F'520'                                                   07911000
@CF02314 DC    F'547'                                                   07912000
@CF02316 DC    F'548'                                                   07913000
@CF02318 DC    F'572'                                                   07914000
@CF02650 DC    F'-12'                                                   07915000
@CF02649 DC    F'-11'                                                   07916000
@CF02639 DC    F'-7'                                                    07917000
@CF02637 DC    F'-5'                                                    07918000
@CF02648 DC    XL4'0000FFFF'                                            07919000
@CF02536 DC    XL4'FFFF'                                                07920000
@CH02536 EQU   @CF02536+2                                               07921000
@DATD    DSECT                                                          07922000
         DS    0D                                                       07923000
LISTSCAN DS    A                                                        07924000
IOCSPTR  DS    A                                                        07925000
DDSTRU   DS    A                                                        07926000
FSADDR   DS    A                                                        07927000
ERCNVADR DS    A                                                        07928000
CCMSGPTR DS    A                                                        07929000
CMMSGPTR DS    A                                                        07930000
CTMSGPTR DS    A                                                        07931000
ELEMENT  DS    F                                                        07932000
BCDVPTR  DS    A                                                        07933000
COPYVPTR DS    A                                                        07934000
DUPVPTR  DS    A                                                        07935000
PRINTME  DS    A                                                        07936000
REASON   DS    F                                                        07937000
DUMPADDR DS    A                                                        07938000
SSDLPTR  DS    A                                                        07939000
LISTPTR  DS    A                                                        07940000
SETRC    DS    H                                                        07941000
RPTLOOP  DS    H                                                        07942000
LISTLN   DS    FL1                                                      07943000
@TS00001 DS    CL95                                                     07944000
PRNTCONS DS    CL120                                                    07945000
         ORG   PRNTCONS                                                 07946000
BCHAR    DS    CL1                                                      07947000
RCHAR    DS    CL1                                                      07948000
DCHAR    DS    CL1                                                      07949000
ECHAR    DS    CL1                                                      07950000
UNKCHAR  DS    CL15                                                     07951000
REASCHAR DS    CL15                                                     07952000
MSF0CHAR DS    CL15                                                     07953000
MSF1CHAR DS    CL15                                                     07954000
NRLCHAR  DS    CL5                                                      07955000
RLSCHAR  DS    CL5                                                      07956000
ACTCHAR  DS    CL5                                                      07957000
INACHAR  DS    CL5                                                      07958000
PHOLDER  DS    CL5                                                      07959000
BLANKS   DS    CL5                                                      07960000
GENCHAR  DS    CL4                                                      07961000
RSTRCHAR DS    CL4                                                      07962000
COPYCHAR DS    CL4                                                      07963000
BKUPCHAR DS    CL4                                                      07964000
BASECHAR DS    CL4                                                      07965000
YESCHAR  DS    CL3                                                      07966000
DUPCHAR  DS    CL3                                                      07967000
         ORG   PRNTCONS+120                                             07968000
LVOPNAGL DS    BL48                                                     07969000
LVDRGLST DS    CL80                                                     07970000
SUMTBL   DS    CL48                                                     07971000
         ORG   SUMTBL                                                   07972000
SUMGVOL  DS    FL4                                                      07973000
SUMRVOL  DS    FL4                                                      07974000
SUMIVOL  DS    FL4                                                      07975000
SUMCPY   DS    FL4                                                      07976000
SUMGPS   DS    FL4                                                      07977000
SUMDUP   DS    FL4                                                      07978000
SUMVOL   DS    FL4                                                      07979000
MAINCTR  DS    FL4                                                      07980000
SUMCTG   DS    FL4                                                      07981000
SUMMSF0  DS    FL4                                                      07982000
SUMMSF1  DS    FL4                                                      07983000
SUMEJECT DS    FL4                                                      07984000
         ORG   SUMTBL+48                                                07985000
VOLAREA  DS    CL244                                                    07986000
         ORG   VOLAREA                                                  07987000
VOLTRNST DS    CL5                                                      07988000
         ORG   VOLTRNST                                                 07989000
VOLTRNS1 DS    CL3                                                      07990000
VOLTRNS2 DS    CL2                                                      07991000
         ORG   VOLAREA+5                                                07992000
VOLTRNAT DS    CL4                                                      07993000
VOLTRNTY DS    CL4                                                      07994000
@NM00118 DS    CL3                                                      07995000
VOLAVGFD DS    FL4                                                      07996000
VOLRCDBF DS    CL224                                                    07997000
         ORG   VOLAREA+244                                              07998000
CPYAREA  DS    CL182                                                    07999000
         ORG   CPYAREA                                                  08000000
CPYTRNST DS    CL5                                                      08001000
CPYTRNDT DS    CL4                                                      08002000
CPYTRNTY DS    CL4                                                      08003000
@NM00119 DS    CL3                                                      08004000
CPYTRNSQ DS    FL2                                                      08005000
CPYRCDBF DS    CL164                                                    08006000
         ORG   CPYAREA+182                                              08007000
         DS    CL2                                                      08008000
GRPAREA  DS    CL184                                                    08009000
         ORG   GRPAREA                                                  08010000
GRPTRNAT DS    CL4                                                      08011000
GRPTRNRL DS    CL5                                                      08012000
@NM00120 DS    CL3                                                      08013000
GRPTRNTS DS    FL4                                                      08014000
GRPAVGFD DS    FL4                                                      08015000
GRPRCDBF DS    CL164                                                    08016000
         ORG   GRPAREA+184                                              08017000
VOLRVVI  DS    CL68                                                     08018000
GRPRVVI  DS    CL68                                                     08019000
CPYRVVI  DS    CL68                                                     08020000
PREVCSN  DS    CL12                                                     08021000
SAVECSN  DS    CL12                                                     08022000
SWCHBITS DS    CL1                                                      08023000
         ORG   SWCHBITS                                                 08024000
FRSTDUP  DS    BL1                                                      08025000
LISTGO   EQU   SWCHBITS+0                                               08026000
ALLVCALL EQU   SWCHBITS+0                                               08027000
MSVIERR  EQU   SWCHBITS+0                                               08028000
@NM00122 EQU   SWCHBITS+0                                               08029000
         ORG   SWCHBITS+1                                               08030000
TITLSPCE DS    CL484                                                    08031000
MAINTITL DS    CL121                                                    08032000
         DS    CL2                                                      08033000
PCARG    DS    CL33                                                     08034000
         ORG   PCARG                                                    08035000
PCMTLP   DS    AL4                                                      08036000
PCSTLP   DS    AL4                                                      08037000
PCFLP    DS    AL4                                                      08038000
PCPCP    DS    AL4                                                      08039000
PCPNL    DS    FL2                                                      08040000
PCPTL    DS    FL2                                                      08041000
PCPDL    DS    FL2                                                      08042000
PCMTLC   DS    FL2                                                      08043000
PCSTLC   DS    FL2                                                      08044000
PCFLC    DS    FL2                                                      08045000
PCLW     DS    FL2                                                      08046000
PCPD     DS    FL2                                                      08047000
PCDSC    DS    AL1                                                      08048000
         ORG   PCARG+33                                                 08049000
         DS    CL3                                                      08050000
DUMPAREA DS    CL17                                                     08051000
LVMYDRG  DS    CL20                                                     08052000
SSDRGLT  DS    CL20                                                     08053000
         DS    CL3                                                      08054000
SSINXLST DS    CL120                                                    08055000
         ORG   SSINXLST                                                 08056000
SSARRAY  DS    60H                                                      08057000
         ORG   SSINXLST+120                                             08058000
CKCSNADJ DS    CL12                                                     08059000
CKPRTTAB DS    CL20                                                     08060000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08061000
@ENDDATD EQU   *                                                        08062000
IDCLV01  CSECT                                                          08063000
         DS    0F                                                       08064000
@SIZDATD DC    AL1(0)                                                   08065000
         DC    AL3(@ENDDATD-@DATD)                                      08066000
         DS    0D                                                       08067000
RVVLEN   DC    AL2(68)                                                  08068000
SSMSGNUM DC    AL1(56)                                                  08069000
@CC02538 DC    C'     '                                                 08070000
@CC02417 DC    C'LVAA'                                                  08071000
@CC02422 DC    C'LVAE'                                                  08072000
@CC02439 DC    C'LVBA'                                                  08073000
@CC02454 DC    C'LVCA'                                                  08074000
@CC02461 DC    C'LVDA'                                                  08075000
@CC02468 DC    C'LVEA'                                                  08076000
@CC02472 DC    C'LVFA'                                                  08077000
@CC02477 DC    C'LVGA'                                                  08078000
@CC02482 DC    C'LVHA'                                                  08079000
@CC02486 DC    C'LVIA'                                                  08080000
@CC02495 DC    C'LVJA'                                                  08081000
@CC02499 DC    C'LVKA'                                                  08082000
@CC02500 DC    C'RVVI'                                                  08083000
@CC02502 DC    C'LVKB'                                                  08084000
@CC02509 DC    C'LVLA'                                                  08085000
@CC02510 DC    C'LVLB'                                                  08086000
@CC02511 EQU   @CC02538                                                 08087000
@CC02515 DC    C'LVMA'                                                  08088000
@CC02519 DC    C'LVNA'                                                  08089000
@CC02524 DC    C'LVOA'                                                  08090000
@CC02525 DC    C'LVOB'                                                  08091000
@CC02529 DC    C'LVPA'                                                  08092000
@CC02533 DC    C'LVRA'                                                  08093000
@CC02542 DC    C'LVSA'                                                  08094000
@CC02548 DC    C'LVTA'                                                  08095000
@CC02552 DC    C'LVUA'                                                  08096000
@CC02559 DC    C'LVVA'                                                  08097000
@CC02560 DC    C'LVVB'                                                  08098000
@CC02564 DC    C'LVWA'                                                  08099000
@CC02568 DC    C'LVXA'                                                  08100000
@CC02572 DC    C'LVDR'                                                  08101000
@CC02594 DC    C'SSAA'                                                  08102000
@CC02612 DC    C'CKLN'                                                  08103000
@CC02394 DC    C'UV0'                                                   08104000
@CC02396 DC    C'LV0'                                                   08105000
@CC02400 DC    C'CM0'                                                   08106000
@CC02534 EQU   @CC02538                                                 08107000
@CB02537 DC    X'FFFFFFFF'                                              08108000
@CB02535 DC    X'0000'                                                  08109000
ALL      DC    CL3'ALL'                                                 08110000
FORMAT   DC    CL4'FORM'                                                08111000
HSECOND  DC    CL4'HSEC'                                                08112000
CLOCK    DC    CL4'KLOK'                                                08113000
SETZERO  DC    CL4'ZERO'                                                08114000
SETBLANK DC    CL4'BLNK'                                                08115000
NOSET    DC    CL4'NSET'                                                08116000
OVERRIDE DC    CL4'OVRD'                                                08117000
ACQUIRE  DC    CL8'ACQUIRE '                                            08118000
RELINQ   DC    CL8'RELINQ  '                                            08119000
MOUNT    DC    CL8'MOUNT   '                                            08120000
DEMOUNT  DC    CL8'DEMOUNT '                                            08121000
DEFINE   DC    CL8'DEFINE  '                                            08122000
MOVE     DC    CL8'MOVE    '                                            08123000
TRACEQ   DC    CL8'TRACEQ  '                                            08124000
COPYTABL DC    CL8'COPYTABL'                                            08125000
COPYCRTG DC    CL8'COPYCRTG'                                            08126000
COPYVOL  DC    CL8'COPYVOL '                                            08127000
VVIC     DC    CL8'VVIC    '                                            08128000
TUNE     DC    CL8'TUNE    '                                            08129000
NAMES    DC    CL4'NAME'                                                08130000
UNIT     DC    CL4'UNIT'                                                08131000
SHR      DC    CL4'SHR '                                                08132000
EXCL     DC    CL4'EXCL'                                                08133000
NOWAIT   DC    CL4'NWAI'                                                08134000
WAIT     DC    CL4'WAIT'                                                08135000
SECCHECK DC    CL8'SECCHECK'                                            08136000
SCRVTOC  DC    CL8'SCRVTOC '                                            08137000
GETVTOC  DC    CL8'GETVTOC '                                            08138000
PUTVTOC  DC    CL8'PUTVTOC '                                            08139000
RECATLG  DC    CL8'RECATLG '                                            08140000
INITVOL  DC    CL8'INITVOL '                                            08141000
CHECK    DC    CL8'CHECK   '                                            08142000
POSTUCB  DC    CL8'POSTUCB '                                            08143000
GET      DC    CL8'GET     '                                            08144000
PUT      DC    CL8'PUT     '                                            08145000
CLOSE    DC    CL8'CLOSE   '                                            08146000
OPEN     DC    CL8'OPEN    '                                            08147000
RVOPENR  DC    CL8'OPENR   '                                            08148000
RVRDCNT  DC    CL8'READCNT '                                            08149000
RVREADKD DC    CL8'READKD  '                                            08150000
RVSPACCR DC    CL8'SPACCR  '                                            08151000
RVFWRITE DC    CL8'FWRITE  '                                            08152000
RVWRITER DC    CL8'WRITEREC'                                            08153000
PUTLABEL DC    CL8'PUTLABEL'                                            08154000
GETLABEL DC    CL8'GETLABEL'                                            08155000
CANCEL   DC    CL8'CANCEL  '                                            08156000
SET      DC    CL8'SET     '                                            08157000
SELECTX  DC    CL8'SELECTX '                                            08158000
CHANGEX  DC    CL8'CHANGEX '                                            08159000
SELECTDD DC    CL8'SELECTDD'                                            08160000
SELECTDS DC    CL8'SELECTDS'                                            08161000
TBLREST  DC    CL8'TBLREST '                                            08162000
NULLIFYC DC    CL8'NULLIFYC'                                            08163000
RDMSC    DC    CL8'RDMSC   '                                            08164000
RDMSCTBL DC    CL8'RDMSCTBL'                                            08165000
RDCARTLB DC    CL8'RDCARTLB'                                            08166000
AUDITCEL DC    CL8'AUDITCEL'                                            08167000
RDSTGAD  DC    CL8'RDSTGAD '                                            08168000
MODIFYC  DC    CL8'MODIFYC '                                            08169000
MODID    DC    CL4'LV01'                                                08170000
         DS    CL2                                                      08171000
ZEROCSN  DS    CL12                                                     08172000
         ORG   ZEROCSN                                                  08173000
@NM00121 DC    12X'00'                                                  08174000
         ORG   ZEROCSN+12                                               08175000
NULLFFS  DC    X'FF'                                                    08176000
         DS    CL3                                                      08177000
FIXAREA  DS    CL642                                                    08178000
         ORG   FIXAREA                                                  08179000
@NM00123 DS    CL642                                                    08180000
         ORG   @NM00123                                                 08181000
@NM00124 DC    214X'00'                                                 08182000
@NM00125 DC    214X'00'                                                 08183000
@NM00126 DC    214X'00'                                                 08184000
         ORG   FIXAREA+642                                              08185000
         DS    CL2                                                      08186000
MOD1     DS    CL4                                                      08187000
         ORG   MOD1                                                     08188000
MOD101   DC    B'00000000'                                              08189000
MOD102   DC    B'00000000'                                              08190000
MOD103   DC    B'00000000'                                              08191000
MOD104   DC    B'00001100'                                              08192000
         ORG   MOD1+4                                                   08193000
MOD2     DS    CL4                                                      08194000
         ORG   MOD2                                                     08195000
MOD201   DC    B'00000000'                                              08196000
MOD202   DC    B'00000000'                                              08197000
MOD203   DC    B'00000000'                                              08198000
MOD204   DC    B'00100100'                                              08199000
         ORG   MOD2+4                                                   08200000
SSMODSS0 DC    CL3'SS0'                                                 08201000
SSMODCM0 DC    CL3'CM0'                                                 08202000
BITMASK  DC    X'80'                                                    08203000
         DC    X'40'                                                    08204000
         DC    X'20'                                                    08205000
         DC    X'10'                                                    08206000
         DC    X'08'                                                    08207000
         DC    X'04'                                                    08208000
         DC    X'02'                                                    08209000
         DC    X'01'                                                    08210000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08211000
@01      EQU   01                                                       08212000
@02      EQU   02                                                       08213000
@03      EQU   03                                                       08214000
@04      EQU   04                                                       08215000
@05      EQU   05                                                       08216000
@06      EQU   06                                                       08217000
@07      EQU   07                                                       08218000
@08      EQU   08                                                       08219000
@09      EQU   09                                                       08220000
@10      EQU   10                                                       08221000
@11      EQU   11                                                       08222000
@12      EQU   12                                                       08223000
@13      EQU   13                                                       08224000
@14      EQU   14                                                       08225000
@15      EQU   15                                                       08226000
CKCOND   EQU   @03                                                      08227000
CKSAVPTR EQU   @07                                                      08228000
CKRETPTR EQU   @06                                                      08229000
ENTRYNUM EQU   @02                                                      08230000
VOLRPTR  EQU   @03                                                      08231000
X        EQU   @03                                                      08232000
COUNTER  EQU   @04                                                      08233000
MYCODE   EQU   @03                                                      08234000
SUMMASK  EQU   @04                                                      08235000
RVVIPTR  EQU   @05                                                      08236000
INDEXPTR EQU   @03                                                      08237000
GROUPPTR EQU   @07                                                      08238000
BASEVPTR EQU   @02                                                      08239000
DMPINDEX EQU   @03                                                      08240000
OPNPTR   EQU   @03                                                      08241000
TESTRC   EQU   @06                                                      08242000
RTNREG   EQU   @15                                                      08243000
REG0     EQU   @00                                                      08244000
REG1     EQU   @01                                                      08245000
REG2     EQU   @02                                                      08246000
REG14    EQU   @14                                                      08247000
REG15    EQU   @15                                                      08248000
GPR01F   EQU   @01                                                      08249000
GPR00P   EQU   @00                                                      08250000
GPR01P   EQU   @01                                                      08251000
REG10    EQU   @10                                                      08252000
REG11    EQU   @11                                                      08253000
REG12    EQU   @12                                                      08254000
REG13    EQU   @13                                                      08255000
REG3     EQU   @03                                                      08256000
REG4     EQU   @04                                                      08257000
REG5     EQU   @05                                                      08258000
REG6     EQU   @06                                                      08259000
REG7     EQU   @07                                                      08260000
REG8     EQU   @08                                                      08261000
REG9     EQU   @09                                                      08262000
CVTPTR   EQU   16                                                       08263000
IDCSAEP0 EQU   0                                                        08264000
TRACE1   EQU   0                                                        08265000
OLDERID1 EQU   TRACE1                                                   08266000
TRACE2   EQU   0                                                        08267000
OLDERID2 EQU   TRACE2                                                   08268000
NEWID2   EQU   TRACE2+95                                                08269000
NEWERID2 EQU   5                                                        08270000
CIRAGL   EQU   0                                                        08271000
CIRTYPE  EQU   CIRAGL                                                   08272000
ALLAGL   EQU   0                                                        08273000
ALLSTS   EQU   ALLAGL+24                                                08274000
ALLDSP   EQU   ALLAGL+25                                                08275000
ALLORG   EQU   ALLAGL+26                                                08276000
ALLOPT   EQU   ALLAGL+28                                                08277000
RACFAGL  EQU   0                                                        08278000
RACFFLG1 EQU   RACFAGL                                                  08279000
RACFFLG2 EQU   RACFAGL+1                                                08280000
RACFFLG3 EQU   RACFAGL+2                                                08281000
RACFFLG4 EQU   RACFAGL+3                                                08282000
UNITABL  EQU   0                                                        08283000
UNITADR  EQU   UNITABL+4                                                08284000
@NM00017 EQU   UNITADR                                                  08285000
UNITSTAT EQU   UNITABL+6                                                08286000
IDCIOOP0 EQU   0                                                        08287000
IDCIOCL0 EQU   0                                                        08288000
IOCSTR   EQU   0                                                        08289000
IOCDSO   EQU   IOCSTR+16                                                08290000
IOCRFM   EQU   IOCSTR+17                                                08291000
IOCMAC   EQU   IOCSTR+18                                                08292000
IOCMAC2  EQU   IOCSTR+19                                                08293000
IOCCHP   EQU   IOCSTR+20                                                08294000
IOCMSG   EQU   IOCSTR+21                                                08295000
IOCRBA   EQU   IOCSTR+40                                                08296000
IOCTTR   EQU   IOCRBA                                                   08297000
IOCMEM   EQU   IOCSTR+44                                                08298000
IOCNWM   EQU   IOCSTR+48                                                08299000
IOCREL   EQU   IOCSTR+60                                                08300000
OPNAGL   EQU   0                                                        08301000
OPNOPT   EQU   OPNAGL                                                   08302000
OPNOPTOT EQU   OPNOPT                                                   08303000
OPNRFM   EQU   OPNAGL+1                                                 08304000
OPNTYP   EQU   OPNAGL+2                                                 08305000
OPNMOD   EQU   OPNAGL+3                                                 08306000
OPNMODAC EQU   OPNMOD                                                   08307000
OPNIOC   EQU   OPNAGL+4                                                 08308000
OPNDDN   EQU   OPNAGL+8                                                 08309000
OPNDSN   EQU   OPNAGL+16                                                08310000
OPNDEV   EQU   OPNAGL+24                                                08311000
OPNDSO   EQU   OPNAGL+41                                                08312000
OPNOPT2  EQU   OPNAGL+42                                                08313000
IOINFOPT EQU   0                                                        08314000
UVOLLIST EQU   0                                                        08315000
UVOLENT  EQU   UVOLLIST+2                                               08316000
AMSTP011 EQU   0                                                        08317000
AMSTP042 EQU   0                                                        08318000
AMSTP044 EQU   0                                                        08319000
DARGLIST EQU   0                                                        08320000
DARGDBP  EQU   DARGLIST                                                 08321000
DARGRETP EQU   DARGLIST+4                                               08322000
DARGSTID EQU   DARGLIST+8                                               08323000
DARGSMOD EQU   DARGSTID                                                 08324000
DARGSENT EQU   DARGSTID+3                                               08325000
DARGILP  EQU   DARGLIST+12                                              08326000
DARGCNT  EQU   DARGLIST+14                                              08327000
DARGRETL EQU   DARGLIST+16                                              08328000
DARGARY  EQU   DARGLIST+20                                              08329000
DARGINS  EQU   DARGARY                                                  08330000
DARGINL  EQU   DARGARY+2                                                08331000
DARGDTM  EQU   DARGARY+4                                                08332000
FMTLIST  EQU   0                                                        08333000
FMTFLGS  EQU   FMTLIST                                                  08334000
FMTSPF   EQU   FMTLIST+2                                                08335000
FMTRFNO  EQU   FMTSPF                                                   08336000
FMTILEN  EQU   FMTRFNO                                                  08337000
FMTIOFF  EQU   FMTLIST+4                                                08338000
FMTTRBC  EQU   FMTIOFF                                                  08339000
FMTSTO   EQU   FMTTRBC                                                  08340000
FMTOCOL  EQU   FMTLIST+6                                                08341000
FMTCNVF  EQU   FMTLIST+10                                               08342000
ERCNVTAB EQU   0                                                        08343000
ERTYPE   EQU   ERCNVTAB                                                 08344000
EROPER   EQU   ERCNVTAB+1                                               08345000
EROSOPER EQU   ERCNVTAB+2                                               08346000
ERCATRC  EQU   ERCNVTAB+16                                              08347000
ERCPLPT  EQU   ERCNVTAB+20                                              08348000
IDCDB010 EQU   0                                                        08349000
DMPITM   EQU   0                                                        08350000
DMPITMNM EQU   DMPITM                                                   08351000
DMPITMPT EQU   DMPITM+8                                                 08352000
DMPITMLN EQU   DMPITM+12                                                08353000
DMPITMTP EQU   DMPITM+14                                                08354000
DMPARY   EQU   0                                                        08355000
DMPTRM   EQU   0                                                        08356000
CCMSG    EQU   0                                                        08357000
CMMSG    EQU   0                                                        08358000
CMVOLFLG EQU   CMMSG+6                                                  08359000
CTMSG    EQU   0                                                        08360000
CTARRAY  EQU   CTMSG+4                                                  08361000
MDAGL    EQU   0                                                        08362000
MDFLAGS  EQU   MDAGL+30                                                 08363000
MDVTOC   EQU   MDAGL+32                                                 08364000
PUAGL    EQU   0                                                        08365000
CKAGL    EQU   0                                                        08366000
CKFLAGS  EQU   CKAGL+28                                                 08367000
EXCLAGL  EQU   0                                                        08368000
EXCLFLAG EQU   EXCLAGL+22                                               08369000
EXOARG   EQU   0                                                        08370000
EXOPT    EQU   EXOARG+32                                                08371000
EXFLG    EQU   EXOARG+33                                                08372000
EXGARG   EQU   0                                                        08373000
EXWRARG  EQU   0                                                        08374000
EXRWCHR  EQU   EXWRARG+26                                               08375000
EXSPACE  EQU   EXWRARG+36                                               08376000
EXPARG   EQU   0                                                        08377000
EXPDATA  EQU   EXPARG+12                                                08378000
EXPDATAB EQU   0                                                        08379000
EXPARRAY EQU   EXPDATAB+4                                               08380000
VS2AGL   EQU   0                                                        08381000
VSLABOPT EQU   VS2AGL+28                                                08382000
VS2MSG   EQU   VS2AGL+35                                                08383000
VS2RESOP EQU   VS2AGL+36                                                08384000
VS1AGL   EQU   0                                                        08385000
VSSECOPT EQU   VS1AGL+68                                                08386000
VSVTOPT  EQU   VS1AGL+69                                                08387000
VSCATOPT EQU   VS1AGL+70                                                08388000
VSRETURN EQU   VS1AGL+71                                                08389000
VSMSG    EQU   VS1AGL+72                                                08390000
VSRESOPT EQU   VS1AGL+73                                                08391000
RCTAGL   EQU   0                                                        08392000
RCTOPT   EQU   RCTAGL+8                                                 08393000
STAEPARM EQU   0                                                        08394000
STARCVY  EQU   STAEPARM+52                                              08395000
STARETRY EQU   STAEPARM+53                                              08396000
VOLLABEL EQU   0                                                        08397000
SV82LIST EQU   0                                                        08398000
@NM00073 EQU   SV82LIST+4                                               08399000
SV82DCBP EQU   @NM00073                                                 08400000
@NM00074 EQU   SV82LIST+12                                              08401000
SV82WRKP EQU   @NM00074                                                 08402000
SRTAGL   EQU   0                                                        08403000
LCTINFO  EQU   0                                                        08404000
LCTFLAGS EQU   LCTINFO+32                                               08405000
UCTAGL   EQU   0                                                        08406000
UCTFLAGS EQU   UCTAGL+68                                                08407000
SELAGL   EQU   0                                                        08408000
SELFLAGS EQU   SELAGL+22                                                08409000
DATESAGL EQU   0                                                        08410000
DATESOPT EQU   DATESAGL+20                                              08411000
VS3AGL   EQU   0                                                        08412000
VS3FLAGS EQU   VS3AGL+58                                                08413000
VSDVTOC  EQU   0                                                        08414000
VSDSTAT  EQU   0                                                        08415000
VSDSFLG1 EQU   VSDSTAT+16                                               08416000
VSDFLG2  EQU   VSDSTAT+17                                               08417000
VSDSCR   EQU   0                                                        08418000
VSDSCRFL EQU   VSDSCR+4                                                 08419000
VSDUSAGE EQU   0                                                        08420000
VSDDORG  EQU   VSDUSAGE+9                                               08421000
VSDALLOC EQU   VSDUSAGE+10                                              08422000
VSDUSEF  EQU   VSDUSAGE+11                                              08423000
VSDDSORG EQU   VSDUSAGE+16                                              08424000
VSDBLOCK EQU   0                                                        08425000
VSDSPACE EQU   VSDBLOCK+12                                              08426000
VSDARRAY EQU   VSDBLOCK+16                                              08427000
VSDVARY  EQU   VSDARRAY+48                                              08428000
VOLS     EQU   0                                                        08429000
VOLSCNT  EQU   VOLS                                                     08430000
@NM00093 EQU   VOLS+2                                                   08431000
VOLSVAL  EQU   @NM00093+1                                               08432000
ALLV     EQU   0                                                        08433000
GRP      EQU   0                                                        08434000
GRPCNT   EQU   GRP                                                      08435000
@NM00094 EQU   GRP+2                                                    08436000
GRPVAL   EQU   @NM00094+1                                               08437000
AGRP     EQU   0                                                        08438000
NGRPD    EQU   0                                                        08439000
PT       EQU   0                                                        08440000
VOLST    EQU   0                                                        08441000
EXPIR    EQU   0                                                        08442000
EXPIRVAL EQU   EXPIR                                                    08443000
AL       EQU   0                                                        08444000
OFILE    EQU   0                                                        08445000
OFILEVAL EQU   OFILE+1                                                  08446000
ODS      EQU   0                                                        08447000
ODSFLG   EQU   ODS+10                                                   08448000
ODSVAL   EQU   ODS+21                                                   08449000
STAT     EQU   0                                                        08450000
USAGE    EQU   0                                                        08451000
LED      EQU   0                                                        08452000
ACT      EQU   0                                                        08453000
INACT    EQU   0                                                        08454000
GNRL     EQU   0                                                        08455000
RSTR     EQU   0                                                        08456000
CTGS     EQU   0                                                        08457000
CTGSCNT  EQU   CTGS                                                     08458000
@NM00095 EQU   CTGS+2                                                   08459000
CTGSLEN  EQU   @NM00095                                                 08460000
CTGSVAL  EQU   @NM00095+1                                               08461000
ALLC     EQU   0                                                        08462000
DUP      EQU   0                                                        08463000
PLHD     EQU   0                                                        08464000
CVTMAP   EQU   0                                                        08465000
CVTDAR   EQU   CVTMAP+72                                                08466000
CVTFLGS1 EQU   CVTDAR                                                   08467000
CVTDCB   EQU   CVTMAP+116                                               08468000
CVTIOQET EQU   CVTMAP+120                                               08469000
CVTIERLC EQU   CVTMAP+144                                               08470000
CVTHEAD  EQU   CVTMAP+160                                               08471000
CVTSV76C EQU   CVTHEAD                                                  08472000
CVTOPTA  EQU   CVTMAP+182                                               08473000
CVTOPTB  EQU   CVTMAP+183                                               08474000
CVTGTF   EQU   CVTMAP+236                                               08475000
CVTGTFST EQU   CVTGTF                                                   08476000
CVTGTFS  EQU   CVTGTFST                                                 08477000
CVTSTATE EQU   CVTGTFST                                                 08478000
CVTTMODE EQU   CVTGTFST                                                 08479000
CVTFORM  EQU   CVTGTFST                                                 08480000
CVTAQAVT EQU   CVTMAP+240                                               08481000
CVTTCMFG EQU   CVTAQAVT                                                 08482000
CVTVOLM2 EQU   CVTMAP+244                                               08483000
CVTTATA  EQU   CVTVOLM2                                                 08484000
CVTTSKS  EQU   CVTTATA                                                  08485000
CVTVOLF2 EQU   CVTTSKS                                                  08486000
CVTTAT   EQU   CVTTATA+1                                                08487000
CVTATER  EQU   CVTMAP+248                                               08488000
CVTEXT1  EQU   CVTMAP+252                                               08489000
CVTPURG  EQU   CVTMAP+260                                               08490000
CVTQMSG  EQU   CVTMAP+268                                               08491000
CVTDMSR  EQU   CVTMAP+272                                               08492000
CVTRSV37 EQU   CVTDMSR                                                  08493000
CVTDMSRF EQU   CVTRSV37                                                 08494000
CVTERPV  EQU   CVTMAP+316                                               08495000
CVTINTLA EQU   CVTMAP+320                                               08496000
CVTAPF   EQU   CVTMAP+324                                               08497000
CVTEXT2  EQU   CVTMAP+328                                               08498000
CVTHJES  EQU   CVTMAP+332                                               08499000
CVTPGSIA EQU   CVTMAP+348                                               08500000
CVTA1F1  EQU   CVTMAP+356                                               08501000
CVTSYSK  EQU   CVTMAP+357                                               08502000
CVTVOLM1 EQU   CVTMAP+380                                               08503000
CVTVOLF1 EQU   CVTVOLM1                                                 08504000
CVTATMCT EQU   CVTMAP+388                                               08505000
CVTXTNT1 EQU   0                                                        08506000
CVTXTNT2 EQU   0                                                        08507000
CVTDSSV  EQU   CVTXTNT2                                                 08508000
CVTFLGBT EQU   CVTXTNT2+5                                               08509000
CVTQID   EQU   CVTXTNT2+24                                              08510000
CVTICB   EQU   CVTXTNT2+48                                              08511000
CVTRV400 EQU   CVTXTNT2+52                                              08512000
CVTRV409 EQU   CVTXTNT2+53                                              08513000
CVTATCVT EQU   CVTXTNT2+64                                              08514000
CVTRV429 EQU   CVTXTNT2+84                                              08515000
CVTRV438 EQU   CVTXTNT2+85                                              08516000
CVTRV457 EQU   CVTXTNT2+112                                             08517000
CVTRV466 EQU   CVTXTNT2+113                                             08518000
CVTFIX   EQU   0                                                        08519000
CVTRELNO EQU   CVTFIX+252                                               08520000
ICB2SSCB EQU   0                                                        08521000
ICBOPT   EQU   ICB2SSCB+48                                              08522000
ICBFLG   EQU   ICB2SSCB+52                                              08523000
ICBFG1   EQU   ICBFLG                                                   08524000
ICBVVIC  EQU   ICB2SSCB+72                                              08525000
ICBTRACE EQU   ICB2SSCB+148                                             08526000
BASEV    EQU   0                                                        08527000
BASNAME  EQU   BASEV                                                    08528000
BASSERNO EQU   BASNAME+5                                                08529000
BASID    EQU   BASNAME+11                                               08530000
BASFLAGA EQU   BASEV+14                                                 08531000
BASTYPE  EQU   BASFLAGA                                                 08532000
BASDLSF  EQU   BASFLAGA+2                                               08533000
BASGENUS EQU   BASFLAGA+2                                               08534000
BASRSTD  EQU   BASFLAGA+2                                               08535000
BASINAC  EQU   BASFLAGA+2                                               08536000
BASBIND  EQU   BASFLAGA+2                                               08537000
BASEXCL  EQU   BASFLAGA+2                                               08538000
BASDAERA EQU   BASFLAGA+3                                               08539000
BASRONLY EQU   BASFLAGA+3                                               08540000
BASREASS EQU   BASFLAGA+3                                               08541000
BASLAST  EQU   BASFLAGA+3                                               08542000
BASCPUID EQU   BASEV+18                                                 08543000
BASRCVYF EQU   BASEV+20                                                 08544000
BASSATIA EQU   BASRCVYF                                                 08545000
BASIVCRE EQU   BASSATIA                                                 08546000
BASIVCPY EQU   BASSATIA                                                 08547000
BASVSMIS EQU   BASSATIA                                                 08548000
BASMISCF EQU   BASRCVYF+2                                               08549000
BASHOLD  EQU   BASMISCF                                                 08550000
BASCSN1  EQU   BASEV+24                                                 08551000
BASLIB1  EQU   BASEV+36                                                 08552000
BASLID1  EQU   BASLIB1                                                  08553000
BASCSN2  EQU   BASEV+37                                                 08554000
BASLIB2  EQU   BASEV+49                                                 08555000
BASLID2  EQU   BASLIB2                                                  08556000
BASNEXTV EQU   BASEV+56                                                 08557000
BASFRESP EQU   BASEV+68                                                 08558000
BASLEXT  EQU   BASEV+70                                                 08559000
BASFREXT EQU   BASEV+72                                                 08560000
BASKLCPY EQU   BASEV+76                                                 08561000
BASCOPID EQU   BASKLCPY+11                                              08562000
BASDLMTD EQU   BASEV+92                                                 08563000
BASEXPDT EQU   BASEV+96                                                 08564000
BASDTREM EQU   BASEV+100                                                08565000
BASDESCR EQU   BASEV+104                                                08566000
BASOWNER EQU   BASEV+134                                                08567000
BASDEST  EQU   BASEV+144                                                08568000
BASRECOV EQU   BASEV+174                                                08569000
BASGROUP EQU   BASEV+180                                                08570000
BCDV     EQU   0                                                        08571000
BCDNAME  EQU   BCDV                                                     08572000
BCDPREFX EQU   BCDNAME                                                  08573000
BCDID    EQU   BCDNAME+11                                               08574000
BCDFLAGA EQU   BCDV+14                                                  08575000
BCDTYPE  EQU   BCDFLAGA                                                 08576000
BCDBASE  EQU   BCDTYPE                                                  08577000
BCDDUP   EQU   BCDTYPE                                                  08578000
BCDFLAGB EQU   BCDFLAGA+2                                               08579000
BCDRCVYF EQU   BCDV+20                                                  08580000
BCDSATIA EQU   BCDRCVYF                                                 08581000
BCDMISCF EQU   BCDRCVYF+2                                               08582000
BCDCSN1  EQU   BCDV+24                                                  08583000
BCDLIB1  EQU   BCDV+36                                                  08584000
BCDLID1  EQU   BCDLIB1                                                  08585000
BCDCSN2  EQU   BCDV+37                                                  08586000
BCDLIB2  EQU   BCDV+49                                                  08587000
BCDLID2  EQU   BCDLIB2                                                  08588000
COPYV    EQU   0                                                        08589000
COPNAME  EQU   COPYV                                                    08590000
COPSERNO EQU   COPNAME+5                                                08591000
COPID    EQU   COPNAME+11                                               08592000
COPNO    EQU   COPID+1                                                  08593000
COPFLAGA EQU   COPYV+14                                                 08594000
COPTYPE  EQU   COPFLAGA                                                 08595000
COPBKUP  EQU   COPFLAGA+2                                               08596000
COPBIND  EQU   COPFLAGA+2                                               08597000
COPEXCL  EQU   COPFLAGA+2                                               08598000
COPDAERA EQU   COPFLAGA+2                                               08599000
COPRONLY EQU   COPFLAGA+3                                               08600000
COPRCVYF EQU   COPYV+20                                                 08601000
COPSATIA EQU   COPRCVYF                                                 08602000
COPIVCPY EQU   COPSATIA                                                 08603000
COPMISCF EQU   COPRCVYF+2                                               08604000
COPHOLD  EQU   COPMISCF                                                 08605000
COPCSN1  EQU   COPYV+24                                                 08606000
COPLIB1  EQU   COPYV+36                                                 08607000
COPLID1  EQU   COPLIB1                                                  08608000
COPCSN2  EQU   COPYV+37                                                 08609000
COPLIB2  EQU   COPYV+49                                                 08610000
COPLID2  EQU   COPLIB2                                                  08611000
COPDATE  EQU   COPYV+50                                                 08612000
COPDTREM EQU   COPYV+54                                                 08613000
COPDEST  EQU   COPYV+88                                                 08614000
COPOWNER EQU   COPYV+118                                                08615000
DUPV     EQU   0                                                        08616000
DUPNAME  EQU   DUPV                                                     08617000
DUPSERNO EQU   DUPNAME+5                                                08618000
DUPID    EQU   DUPNAME+11                                               08619000
DUPFLAGA EQU   DUPV+14                                                  08620000
DUPTYPE  EQU   DUPFLAGA                                                 08621000
DUPRCVYF EQU   DUPV+20                                                  08622000
DUPLIB1  EQU   DUPV+36                                                  08623000
DUPLID1  EQU   DUPLIB1                                                  08624000
DUPLIB2  EQU   DUPV+49                                                  08625000
DUPLID2  EQU   DUPLIB2                                                  08626000
GROUP    EQU   0                                                        08627000
GRONAME  EQU   GROUP                                                    08628000
GROVVGRP EQU   GRONAME+3                                                08629000
GROID    EQU   GRONAME+11                                               08630000
GROFLAGA EQU   GROUP+13                                                 08631000
GROTYPE  EQU   GROFLAGA                                                 08632000
GROBIND  EQU   GROFLAGA+2                                               08633000
GROEXCL  EQU   GROFLAGA+2                                               08634000
GRODAERA EQU   GROFLAGA+2                                               08635000
GRORONLY EQU   GROFLAGA+2                                               08636000
GRORLSE  EQU   GROFLAGA+2                                               08637000
GRORETN  EQU   GROFLAGA+2                                               08638000
GROFSN   EQU   GROUP+17                                                 08639000
GROPCENT EQU   GROUP+29                                                 08640000
GRONGEN  EQU   GROUP+30                                                 08641000
GRONRSTD EQU   GROUP+32                                                 08642000
GRONINAC EQU   GROUP+34                                                 08643000
GROFRESP EQU   GROUP+44                                                 08644000
GROFREXT EQU   GROUP+48                                                 08645000
GRORETPD EQU   GROUP+52                                                 08646000
GROERRTS EQU   GROUP+56                                                 08647000
INDEX    EQU   0                                                        08648000
INDNAME  EQU   INDEX                                                    08649000
INDSERNO EQU   INDNAME+1                                                08650000
INDTYPE  EQU   INDEX+13                                                 08651000
INDRECKY EQU   INDEX+15                                                 08652000
INDPREFX EQU   INDRECKY                                                 08653000
INDRECID EQU   INDRECKY+11                                              08654000
RVVI     EQU   0                                                        08655000
RVVLNGTH EQU   RVVI                                                     08656000
RVVOPCOD EQU   RVVI+4                                                   08657000
RVVCODE  EQU   RVVOPCOD                                                 08658000
RVVOLUME EQU   RVVI+8                                                   08659000
RVVGROUP EQU   RVVI+14                                                  08660000
RVVBUFLN EQU   RVVI+30                                                  08661000
RVVRTBUF EQU   RVVI+32                                                  08662000
RVVEXPIR EQU   RVVI+36                                                  08663000
RVVRDCSN EQU   RVVI+44                                                  08664000
RVVCPYID EQU   RVVI+56                                                  08665000
RVVDUPID EQU   RVVI+57                                                  08666000
RVVFLAGA EQU   RVVI+58                                                  08667000
RVVRMODE EQU   RVVFLAGA                                                 08668000
RVVRDR   EQU   RVVRMODE                                                 08669000
RVVRDNR  EQU   RVVRMODE                                                 08670000
RVVRDCH  EQU   RVVRMODE                                                 08671000
RVVCHAIN EQU   RVVFLAGA+1                                               08672000
RVVGPVOL EQU   RVVCHAIN                                                 08673000
RVVNGVOL EQU   RVVCHAIN                                                 08674000
RVVRDRCD EQU   RVVFLAGA+2                                               08675000
RVVBVRCD EQU   RVVRDRCD                                                 08676000
RVVGRPRC EQU   RVVRDRCD                                                 08677000
RVVCPYRC EQU   RVVRDRCD                                                 08678000
RVVDUPRC EQU   RVVRDRCD                                                 08679000
RVVCIRCD EQU   RVVRDRCD                                                 08680000
RVVALL   EQU   RVVRDRCD                                                 08681000
RVVRTEST EQU   RVVFLAGA+3                                               08682000
RVVEXPDT EQU   RVVRTEST                                                 08683000
RVVTHOLD EQU   RVVRTEST                                                 08684000
RVVGSVOL EQU   RVVRTEST                                                 08685000
RVVRSTD  EQU   RVVRTEST                                                 08686000
RVVINACT EQU   RVVRTEST                                                 08687000
RVVACTV  EQU   RVVRTEST                                                 08688000
RVVDVOL  EQU   RVVRTEST                                                 08689000
RVVCPYTP EQU   RVVFLAGA+4                                               08690000
RVVCPLHD EQU   RVVCPYTP                                                 08691000
RVVSPEC  EQU   RVVFLAGA+5                                               08692000
RVVSGRP  EQU   RVVSPEC                                                  08693000
RVVSEXP  EQU   RVVSPEC                                                  08694000
RVVSCSN  EQU   RVVSPEC                                                  08695000
RVVSCPY  EQU   RVVSPEC                                                  08696000
RVVSDUP  EQU   RVVSPEC                                                  08697000
RVVSVOL  EQU   RVVSPEC                                                  08698000
AMSTP041 EQU   0                                                        08699000
AMSTP043 EQU   0                                                        08700000
IDCIOCO0 EQU   0                                                        08701000
IDCIOGT0 EQU   0                                                        08702000
IDCIOIT0 EQU   0                                                        08703000
IDCIOPO0 EQU   0                                                        08704000
IDCIOPT0 EQU   0                                                        08705000
IDCIOSI0 EQU   0                                                        08706000
IDCIOST0 EQU   0                                                        08707000
IDCIOTM0 EQU   0                                                        08708000
IDCIOVY0 EQU   0                                                        08709000
IDCIO050 EQU   0                                                        08710000
IDCSAAL0 EQU   0                                                        08711000
IDCSACA0 EQU   0                                                        08712000
IDCSACL0 EQU   0                                                        08713000
IDCSACR0 EQU   0                                                        08714000
IDCSADE0 EQU   0                                                        08715000
IDCSADL0 EQU   0                                                        08716000
IDCSADQ0 EQU   0                                                        08717000
IDCSAFP0 EQU   0                                                        08718000
IDCSAFS0 EQU   0                                                        08719000
IDCSAGP0 EQU   0                                                        08720000
IDCSAGS0 EQU   0                                                        08721000
IDCSAID0 EQU   0                                                        08722000
IDCSALC0 EQU   0                                                        08723000
IDCSALD0 EQU   0                                                        08724000
IDCSALK0 EQU   0                                                        08725000
IDCSANQ0 EQU   0                                                        08726000
IDCSAPR0 EQU   0                                                        08727000
IDCSAPT0 EQU   0                                                        08728000
IDCSAQL0 EQU   0                                                        08729000
IDCSARC0 EQU   0                                                        08730000
IDCSARK0 EQU   0                                                        08731000
IDCSARV0 EQU   0                                                        08732000
IDCSASC0 EQU   0                                                        08733000
IDCSASI0 EQU   0                                                        08734000
IDCSASN0 EQU   0                                                        08735000
IDCSASS0 EQU   0                                                        08736000
IDCSAST0 EQU   0                                                        08737000
IDCSATI0 EQU   0                                                        08738000
IDCSAUC0 EQU   0                                                        08739000
IDCSAWO0 EQU   0                                                        08740000
IDCSA060 EQU   0                                                        08741000
IDCST010 EQU   0                                                        08742000
IDCTPER0 EQU   0                                                        08743000
LISTTEST EQU   0                                                        08744000
NEWERID1 EQU   5                                                        08745000
NLED     EQU   0                                                        08746000
RPT      EQU   0                                                        08747000
GDTTBL   EQU   0                                                        08748000
GDTTR1   EQU   GDTTBL+8                                                 08749000
GDTTR2   EQU   GDTTBL+12                                                08750000
GDTDBG   EQU   GDTTBL+40                                                08751000
GDTSTC   EQU   GDTTBL+44                                                08752000
GDTPRT   EQU   GDTTBL+48                                                08753000
GDTESS   EQU   GDTTBL+52                                                08754000
GDTESA   EQU   GDTTBL+56                                                08755000
GDTRST   EQU   GDTTBL+60                                                08756000
GDTRES   EQU   GDTTBL+64                                                08757000
GDTCAL   EQU   GDTTBL+68                                                08758000
GDTGSP   EQU   GDTTBL+72                                                08759000
GDTFSP   EQU   GDTTBL+76                                                08760000
GDTGPL   EQU   GDTTBL+80                                                08761000
GDTFPL   EQU   GDTTBL+84                                                08762000
GDTLOD   EQU   GDTTBL+88                                                08763000
GDTDEL   EQU   GDTTBL+92                                                08764000
GDTPRL   EQU   GDTTBL+96                                                08765000
GDTEPL   EQU   GDTTBL+100                                               08766000
GDTTIM   EQU   GDTTBL+104                                               08767000
GDTIIO   EQU   GDTTBL+108                                               08768000
GDTTIO   EQU   GDTTBL+112                                               08769000
GDTOPN   EQU   GDTTBL+124                                               08770000
GDTCLS   EQU   GDTTBL+128                                               08771000
GDTGET   EQU   GDTTBL+132                                               08772000
GDTPUT   EQU   GDTTBL+136                                               08773000
GDTPOS   EQU   GDTTBL+140                                               08774000
GDTCPY   EQU   GDTTBL+144                                               08775000
GDTCAT   EQU   GDTTBL+148                                               08776000
GDTSNP   EQU   GDTTBL+164                                               08777000
GDTVFY   EQU   GDTTBL+172                                               08778000
GDTUID   EQU   GDTTBL+192                                               08779000
GDTPMT   EQU   GDTTBL+196                                               08780000
GDTCIR   EQU   GDTTBL+200                                               08781000
GDTLNK   EQU   GDTTBL+204                                               08782000
GDTALC   EQU   GDTTBL+208                                               08783000
GDTDLC   EQU   GDTTBL+212                                               08784000
GDTQAL   EQU   GDTTBL+216                                               08785000
GDTSTW   EQU   GDTTBL+220                                               08786000
GDTSSC   EQU   GDTTBL+224                                               08787000
GDTENQ   EQU   GDTTBL+228                                               08788000
GDTRSV   EQU   GDTTBL+232                                               08789000
GDTDEQ   EQU   GDTTBL+236                                               08790000
GDTSFO   EQU   GDTTBL+240                                               08791000
GDTWTO   EQU   GDTTBL+244                                               08792000
GDTSCR   EQU   GDTTBL+248                                               08793000
GDTUNT   EQU   GDTTBL+252                                               08794000
GDTRCT   EQU   GDTTBL+256                                               08795000
GDTIFO   EQU   GDTTBL+260                                               08796000
GDTEXP   EQU   GDTTBL+264                                               08797000
GDTSTA   EQU   GDTTBL+268                                               08798000
GDTERR   EQU   GDTTBL+272                                               08799000
GDTUNC   EQU   GDTTBL+276                                               08800000
GDTLOC   EQU   GDTTBL+280                                               08801000
GDTRCK   EQU   GDTTBL+284                                               08802000
FDTTBL   EQU   0                                                        08803000
FDTPTR   EQU   FDTTBL+8                                                 08804000
LASTCOND EQU   0                                                        08805000
SSRCODE  EQU   0                                                        08806000
SSRHALF  EQU   SSRCODE+2                                                08807000
SSECBCD  EQU   0                                                        08808000
CKCSNVAL EQU   0                                                        08809000
CKLENGTH EQU   0                                                        08810000
CVTS01   EQU   CVTPGSIA                                                 08811000
CVTLPDIA EQU   CVTS01+12                                                08812000
CVTDIRST EQU   CVTLPDIA                                                 08813000
CVTSLIDA EQU   CVTS01+24                                                08814000
CVTCTLFG EQU   CVTS01+50                                                08815000
CVTRV210 EQU   CVTS01+424                                               08816000
CVTRV219 EQU   CVTS01+425                                               08817000
CVTRV228 EQU   CVTS01+426                                               08818000
CVTRV237 EQU   CVTS01+427                                               08819000
CVTMFRTR EQU   CVTS01+452                                               08820000
CVTRV262 EQU   CVTS01+468                                               08821000
CVTRV271 EQU   CVTS01+469                                               08822000
CVTRV280 EQU   CVTS01+470                                               08823000
CVTRV289 EQU   CVTS01+471                                               08824000
CVTGSDA  EQU   CVTS01+600                                               08825000
MYCPUID  EQU   BASCPUID                                                 08826000
CPUID1   EQU   MYCPUID                                                  08827000
CPUID2   EQU   MYCPUID+1                                                08828000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08829000
CVTRV628 EQU   CVTS01+728                                               08830000
CVTRV627 EQU   CVTS01+724                                               08831000
CVTRV626 EQU   CVTS01+720                                               08832000
CVTRV625 EQU   CVTS01+716                                               08833000
CVTRV624 EQU   CVTS01+712                                               08834000
CVTRV623 EQU   CVTS01+708                                               08835000
CVTRV622 EQU   CVTS01+704                                               08836000
CVTRV621 EQU   CVTS01+700                                               08837000
CVTIHASU EQU   CVTS01+696                                               08838000
CVTRV619 EQU   CVTS01+692                                               08839000
CVTRV618 EQU   CVTS01+688                                               08840000
CVTRV617 EQU   CVTS01+684                                               08841000
CVTRV616 EQU   CVTS01+680                                               08842000
CVTRV615 EQU   CVTS01+676                                               08843000
CVTRV614 EQU   CVTS01+672                                               08844000
CVTRV613 EQU   CVTS01+668                                               08845000
CVTTCASP EQU   CVTS01+664                                               08846000
CVT0PT03 EQU   CVTS01+660                                               08847000
CVT0PT0E EQU   CVTS01+656                                               08848000
CVTRV609 EQU   CVTS01+652                                               08849000
CVTCGK   EQU   CVTS01+648                                               08850000
CVTRAC   EQU   CVTS01+644                                               08851000
CVTRV606 EQU   CVTS01+640                                               08852000
CVTRV605 EQU   CVTS01+636                                               08853000
CVTRV604 EQU   CVTS01+632                                               08854000
CVTEFF02 EQU   CVTS01+628                                               08855000
CVTCBBR  EQU   CVTS01+624                                               08856000
CVTSSCR  EQU   CVTS01+620                                               08857000
CVTEVENT EQU   CVTS01+616                                               08858000
CVTCRCA  EQU   CVTS01+612                                               08859000
CVTTPIO  EQU   CVTS01+608                                               08860000
CVTADV   EQU   CVTS01+604                                               08861000
CVTGSDAB EQU   CVTGSDA                                                  08862000
CVTQV3   EQU   CVTS01+596                                               08863000
CVTQV2   EQU   CVTS01+592                                               08864000
CVTQV1   EQU   CVTS01+588                                               08865000
CVTRPT   EQU   CVTS01+584                                               08866000
CVTSSRB  EQU   CVTS01+580                                               08867000
CVTCSDRL EQU   CVTS01+576                                               08868000
CVTEXP1  EQU   CVTS01+572                                               08869000
CVTRMPMT EQU   CVTS01+568                                               08870000
CVTRMPTT EQU   CVTS01+564                                               08871000
CVTVPSA  EQU   CVTS01+560                                               08872000
CVTVSTOP EQU   CVTS01+556                                               08873000
CVTGTFR8 EQU   CVTS01+552                                               08874000
CVTQUIT  EQU   CVTS01+548                                               08875000
CVTVACR  EQU   CVTS01+544                                               08876000
CVTWTCB  EQU   CVTS01+540                                               08877000
CVTSTPRS EQU   CVTS01+536                                               08878000
CVT0PT02 EQU   CVTS01+532                                               08879000
CVTDARCM EQU   CVTS01+528                                               08880000
CVTIRECM EQU   CVTS01+524                                               08881000
CVTJRECM EQU   CVTS01+520                                               08882000
CVTVEMS0 EQU   CVTS01+516                                               08883000
CVTSPFRR EQU   CVTS01+512                                               08884000
CVTRLSTG EQU   CVTS01+508                                               08885000
CVT0TC0A EQU   CVTS01+504                                               08886000
CVTGMBR  EQU   CVTS01+500                                               08887000
CVTLFRM  EQU   CVTS01+496                                               08888000
CVTRMBR  EQU   CVTS01+492                                               08889000
CVTVIOP  EQU   CVTS01+488                                               08890000
CVTRV307 EQU   CVTS01+486                                               08891000
CVTRV306 EQU   CVTS01+484                                               08892000
CVTRV305 EQU   CVTS01+482                                               08893000
CVTRV304 EQU   CVTS01+480                                               08894000
CVTRV303 EQU   CVTS01+478                                               08895000
CVTRV302 EQU   CVTS01+476                                               08896000
CVTTRCA  EQU   CVTS01+472                                               08897000
CVTRV297 EQU   CVTRV289                                                 08898000
CVTRV296 EQU   CVTRV289                                                 08899000
CVTRV295 EQU   CVTRV289                                                 08900000
CVTRV294 EQU   CVTRV289                                                 08901000
CVTRV293 EQU   CVTRV289                                                 08902000
CVTRV292 EQU   CVTRV289                                                 08903000
CVTRV291 EQU   CVTRV289                                                 08904000
CVTRV290 EQU   CVTRV289                                                 08905000
CVTRV288 EQU   CVTRV280                                                 08906000
CVTRV287 EQU   CVTRV280                                                 08907000
CVTRV286 EQU   CVTRV280                                                 08908000
CVTRV285 EQU   CVTRV280                                                 08909000
CVTRV284 EQU   CVTRV280                                                 08910000
CVTRV283 EQU   CVTRV280                                                 08911000
CVTRV282 EQU   CVTRV280                                                 08912000
CVTRV281 EQU   CVTRV280                                                 08913000
CVTRV279 EQU   CVTRV271                                                 08914000
CVTRV278 EQU   CVTRV271                                                 08915000
CVTRV277 EQU   CVTRV271                                                 08916000
CVTRV276 EQU   CVTRV271                                                 08917000
CVTRV275 EQU   CVTRV271                                                 08918000
CVTRV274 EQU   CVTRV271                                                 08919000
CVTRV273 EQU   CVTRV271                                                 08920000
CVTRV272 EQU   CVTRV271                                                 08921000
CVTRV270 EQU   CVTRV262                                                 08922000
CVTRV269 EQU   CVTRV262                                                 08923000
CVTRV268 EQU   CVTRV262                                                 08924000
CVTRV267 EQU   CVTRV262                                                 08925000
CVTRV266 EQU   CVTRV262                                                 08926000
CVTRV265 EQU   CVTRV262                                                 08927000
CVTRV264 EQU   CVTRV262                                                 08928000
CVTRV263 EQU   CVTRV262                                                 08929000
CVTVFP   EQU   CVTS01+464                                               08930000
CVTVSI   EQU   CVTS01+460                                               08931000
CVTVPSIB EQU   CVTS01+456                                               08932000
CVTMFACT EQU   CVTMFRTR                                                 08933000
CVTMFCTL EQU   CVTS01+448                                               08934000
CVTPVBP  EQU   CVTS01+444                                               08935000
CVTPWI   EQU   CVTS01+440                                               08936000
CVTRV254 EQU   CVTS01+438                                               08937000
CVTRV253 EQU   CVTS01+436                                               08938000
CVTRV252 EQU   CVTS01+434                                               08939000
CVTRV251 EQU   CVTS01+433                                               08940000
CVTRV250 EQU   CVTS01+432                                               08941000
CVTRV249 EQU   CVTS01+431                                               08942000
CVTRV248 EQU   CVTS01+430                                               08943000
CVTRV247 EQU   CVTS01+429                                               08944000
CVTRV246 EQU   CVTS01+428                                               08945000
CVTRV245 EQU   CVTRV237                                                 08946000
CVTRV244 EQU   CVTRV237                                                 08947000
CVTRV243 EQU   CVTRV237                                                 08948000
CVTRV242 EQU   CVTRV237                                                 08949000
CVTRV241 EQU   CVTRV237                                                 08950000
CVTRV240 EQU   CVTRV237                                                 08951000
CVTRV239 EQU   CVTRV237                                                 08952000
CVTRV238 EQU   CVTRV237                                                 08953000
CVTRV236 EQU   CVTRV228                                                 08954000
CVTRV235 EQU   CVTRV228                                                 08955000
CVTRV234 EQU   CVTRV228                                                 08956000
CVTRV233 EQU   CVTRV228                                                 08957000
CVTRV232 EQU   CVTRV228                                                 08958000
CVTRV231 EQU   CVTRV228                                                 08959000
CVTRV230 EQU   CVTRV228                                                 08960000
CVTRV229 EQU   CVTRV228                                                 08961000
CVTRV227 EQU   CVTRV219                                                 08962000
CVTRV226 EQU   CVTRV219                                                 08963000
CVTRV225 EQU   CVTRV219                                                 08964000
CVTRV224 EQU   CVTRV219                                                 08965000
CVTRV223 EQU   CVTRV219                                                 08966000
CVTRV222 EQU   CVTRV219                                                 08967000
CVTRV221 EQU   CVTRV219                                                 08968000
CVTRV220 EQU   CVTRV219                                                 08969000
CVTRV218 EQU   CVTRV210                                                 08970000
CVTRV217 EQU   CVTRV210                                                 08971000
CVTRV216 EQU   CVTRV210                                                 08972000
CVTRV215 EQU   CVTRV210                                                 08973000
CVTRV214 EQU   CVTRV210                                                 08974000
CVTRV213 EQU   CVTRV210                                                 08975000
CVTRV212 EQU   CVTRV210                                                 08976000
CVTRV211 EQU   CVTRV210                                                 08977000
CVTLCCAT EQU   CVTS01+420                                               08978000
CVTPCCAT EQU   CVTS01+416                                               08979000
CVTIPCRP EQU   CVTS01+412                                               08980000
CVTIPCRI EQU   CVTS01+408                                               08981000
CVTIPCDS EQU   CVTS01+404                                               08982000
CVTAIDVT EQU   CVTS01+400                                               08983000
CVTSSAP  EQU   CVTS01+396                                               08984000
CVTEHCIR EQU   CVTS01+392                                               08985000
CVTEHDEF EQU   CVTS01+388                                               08986000
CVTDAIR  EQU   CVTS01+384                                               08987000
CVTPERFM EQU   CVTS01+380                                               08988000
CVT044R2 EQU   CVTS01+376                                               08989000
CVTFETCH EQU   CVTS01+372                                               08990000
CVTRSTWD EQU   CVTS01+368                                               08991000
CVTSPOST EQU   CVTS01+364                                               08992000
CVTIOBP  EQU   CVTS01+360                                               08993000
CVTASMVT EQU   CVTS01+356                                               08994000
CVTRECRQ EQU   CVTS01+352                                               08995000
CVTWSAC  EQU   CVTS01+348                                               08996000
CVTRV149 EQU   CVTS01+344                                               08997000
CVTWSAL  EQU   CVTS01+340                                               08998000
CVTSPSA  EQU   CVTS01+336                                               08999000
CVTGLMN  EQU   CVTS01+332                                               09000000
CVTVEAC0 EQU   CVTS01+328                                               09001000
CVT062R1 EQU   CVTS01+324                                               09002000
CVTRPOST EQU   CVTS01+320                                               09003000
CVTDQIQE EQU   CVTS01+316                                               09004000
CVTCSD   EQU   CVTS01+312                                               09005000
CVTLKRMA EQU   CVTS01+308                                               09006000
CVTRSPIE EQU   CVTS01+304                                               09007000
CVTRENQ  EQU   CVTS01+300                                               09008000
CVTLQCB  EQU   CVTS01+296                                               09009000
CVTFQCB  EQU   CVTS01+292                                               09010000
CVTQCS01 EQU   CVTS01+288                                               09011000
CVTAPFT  EQU   CVTS01+284                                               09012000
CVTPARRL EQU   CVTS01+280                                               09013000
CVTVWAIT EQU   CVTS01+276                                               09014000
CVTGSPL  EQU   CVTS01+272                                               09015000
CVTLSMQ  EQU   CVTS01+268                                               09016000
CVTGSMQ  EQU   CVTS01+264                                               09017000
CVTEXPRO EQU   CVTS01+260                                               09018000
CVTOPCTP EQU   CVTS01+256                                               09019000
CVTSIC   EQU   CVTS01+252                                               09020000
CVTTPIOS EQU   CVTS01+248                                               09021000
CVTRTMS  EQU   CVTS01+244                                               09022000
CVTSDBF  EQU   CVTS01+240                                               09023000
CVTSCBP  EQU   CVTS01+236                                               09024000
CVTSDMP  EQU   CVTS01+232                                               09025000
CVTSV60  EQU   CVTS01+228                                               09026000
CVTRTMCT EQU   CVTS01+224                                               09027000
CVTASCBL EQU   CVTS01+220                                               09028000
CVTASCBH EQU   CVTS01+216                                               09029000
CVTGDA   EQU   CVTS01+212                                               09030000
CVTASVT  EQU   CVTS01+208                                               09031000
CVTVVMDI EQU   CVTS01+204                                               09032000
CVTAQTOP EQU   CVTS01+200                                               09033000
CVTIOSCS EQU   CVTS01+196                                               09034000
CVTSDRM  EQU   CVTS01+192                                               09035000
CVTOPTE  EQU   CVTS01+188                                               09036000
CVTSTXU  EQU   CVTS01+184                                               09037000
CVTQUIS  EQU   CVTS01+180                                               09038000
CVTPARS  EQU   CVTS01+176                                               09039000
CVTS1EE  EQU   CVTS01+172                                               09040000
CVTFRAS  EQU   CVTS01+168                                               09041000
CVTQSAS  EQU   CVTS01+164                                               09042000
CVTCRAS  EQU   CVTS01+160                                               09043000
CVTCRMN  EQU   CVTS01+156                                               09044000
CVTDELCP EQU   CVTS01+152                                               09045000
CVTFRECL EQU   CVTS01+148                                               09046000
CVTGETCL EQU   CVTS01+144                                               09047000
CVTBLDCP EQU   CVTS01+140                                               09048000
CVTAUTHL EQU   CVTS01+136                                               09049000
CVTSCAN  EQU   CVTS01+132                                               09050000
CVTRV144 EQU   CVTS01+130                                               09051000
CVTMAXMP EQU   CVTS01+128                                               09052000
CVTSTCK  EQU   CVTS01+124                                               09053000
CVTRV139 EQU   CVTS01+123                                               09054000
CVTDSSAC EQU   CVTS01+122                                               09055000
CVTRV513 EQU   CVTS01+121                                               09056000
CVTIOSPL EQU   CVTS01+120                                               09057000
CVTPTGT  EQU   CVTS01+116                                               09058000
CVTCSPIE EQU   CVTS01+112                                               09059000
CVTSMFEX EQU   CVTS01+108                                               09060000
CVTOLT0A EQU   CVTS01+104                                               09061000
CVTSRBRT EQU   CVTS01+100                                               09062000
CVTPUTL  EQU   CVTS01+96                                                09063000
CVTASCRL EQU   CVTS01+92                                                09064000
CVTASCRF EQU   CVTS01+88                                                09065000
CVTRV326 EQU   CVTS01+84                                                09066000
CVTRV325 EQU   CVTS01+80                                                09067000
CVTRV324 EQU   CVTS01+76                                                09068000
CVT0VL01 EQU   CVTS01+72                                                09069000
CVTSHRVM EQU   CVTS01+68                                                09070000
CVTRV332 EQU   CVTS01+64                                                09071000
CVTTAS   EQU   CVTS01+60                                                09072000
CVTRSCN  EQU   CVTS01+56                                                09073000
CVTTRAC2 EQU   CVTS01+54                                                09074000
CVTTRACE EQU   CVTS01+52                                                09075000
CVTAPG   EQU   CVTS01+51                                                09076000
CVTSDTRC EQU   CVTCTLFG                                                 09077000
CVTGTRCE EQU   CVTCTLFG                                                 09078000
CVTNOMP  EQU   CVTCTLFG                                                 09079000
CVTRSV79 EQU   CVTCTLFG                                                 09080000
CVTDSTAT EQU   CVTCTLFG                                                 09081000
CVTRSV78 EQU   CVTCTLFG                                                 09082000
CVTRV333 EQU   CVTCTLFG                                                 09083000
CVTRV323 EQU   CVTCTLFG                                                 09084000
CVTSPVLK EQU   CVTS01+49                                                09085000
CVTRSV77 EQU   CVTS01+48                                                09086000
CVTRV331 EQU   CVTS01+44                                                09087000
CVTRV330 EQU   CVTS01+40                                                09088000
CVTRV329 EQU   CVTS01+36                                                09089000
CVTRV328 EQU   CVTS01+32                                                09090000
CVTRV322 EQU   CVTS01+28                                                09091000
CVTSLID  EQU   CVTSLIDA+1                                               09092000
CVTSYLK  EQU   CVTSLIDA                                                 09093000
CVTRV321 EQU   CVTS01+20                                                09094000
CVTRV320 EQU   CVTS01+16                                                09095000
CVTLPDIR EQU   CVTLPDIA+1                                               09096000
CVTRSV69 EQU   CVTDIRST                                                 09097000
CVTRSV68 EQU   CVTDIRST                                                 09098000
CVTRSV67 EQU   CVTDIRST                                                 09099000
CVTRSV66 EQU   CVTDIRST                                                 09100000
CVTRSV65 EQU   CVTDIRST                                                 09101000
CVTRSV64 EQU   CVTDIRST                                                 09102000
CVTRSV63 EQU   CVTDIRST                                                 09103000
CVTDICOM EQU   CVTDIRST                                                 09104000
CVTPVTP  EQU   CVTS01+8                                                 09105000
CVTLPDSR EQU   CVTS01+4                                                 09106000
CVTGETL  EQU   CVTS01                                                   09107000
@NM00127 EQU   SSRCODE                                                  09108000
FDTVERB  EQU   FDTTBL                                                   09109000
GDTECT   EQU   GDTTBL+188                                               09110000
GDTPSB   EQU   GDTTBL+184                                               09111000
GDTUPT   EQU   GDTTBL+180                                               09112000
GDTCMB   EQU   GDTTBL+176                                               09113000
GDTSPR   EQU   GDTTBL+168                                               09114000
@NM00001 EQU   GDTTBL+160                                               09115000
GDTABH   EQU   GDTTBL+156                                               09116000
GDTABT   EQU   GDTTBL+152                                               09117000
GDTTOH   EQU   GDTTBL+120                                               09118000
GDTRIP   EQU   GDTTBL+116                                               09119000
GDTIOH   EQU   GDTTBL+36                                                09120000
GDTSAH   EQU   GDTTBL+32                                                09121000
GDTTPH   EQU   GDTTBL+28                                                09122000
GDTRIH   EQU   GDTTBL+24                                                09123000
GDTSTH   EQU   GDTTBL+20                                                09124000
GDTDBH   EQU   GDTTBL+16                                                09125000
GDTPRM   EQU   GDTTBL+4                                                 09126000
GDTHDR   EQU   GDTTBL                                                   09127000
@NM00117 EQU   RVVI+64                                                  09128000
RVVSSEQ  EQU   RVVSPEC                                                  09129000
RVVSDTE  EQU   RVVSPEC                                                  09130000
@NM00116 EQU   RVVCPYTP                                                 09131000
RVVLCOPY EQU   RVVCPYTP                                                 09132000
RVVOBKUP EQU   RVVCPYTP                                                 09133000
RVVLBKUP EQU   RVVCPYTP                                                 09134000
RVVBPLHD EQU   RVVRTEST                                                 09135000
RVVCPURC EQU   RVVRDRCD                                                 09136000
RVVRUNKN EQU   RVVRDRCD                                                 09137000
@NM00115 EQU   RVVCHAIN                                                 09138000
@NM00114 EQU   RVVRMODE                                                 09139000
RVVRDSEQ EQU   RVVI+43                                                  09140000
RVVBLNK1 EQU   RVVI+42                                                  09141000
RVVCDATE EQU   RVVI+38                                                  09142000
@NM00113 EQU   RVVI+28                                                  09143000
RVVAREA  EQU   RVVI+24                                                  09144000
RVVARLN  EQU   RVVI+22                                                  09145000
@NM00112 EQU   RVVOPCOD+1                                               09146000
@NM00111 EQU   INDEX+28                                                 09147000
INDEXREC EQU   INDRECID+1                                               09148000
INDBLNK2 EQU   INDRECID                                                 09149000
INDVSRNO EQU   INDRECKY+5                                               09150000
INDBLNK1 EQU   INDPREFX+1                                               09151000
INDALPHA EQU   INDPREFX                                                 09152000
INDRES2  EQU   INDTYPE                                                  09153000
INDINDEX EQU   INDTYPE                                                  09154000
INDRES1  EQU   INDTYPE                                                  09155000
INDI     EQU   INDNAME                                                  09156000
@NM00110 EQU   GROUP+136                                                09157000
GROADDR  EQU   GROUP+106                                                09158000
GROOWNER EQU   GROUP+96                                                 09159000
GRORESSP EQU   GROUP+95                                                 09160000
GROCONUS EQU   GROUP+94                                                 09161000
GRODESCR EQU   GROUP+64                                                 09162000
GROERRTM EQU   GROERRTS+4                                               09163000
GROERRDT EQU   GROERRTS                                                 09164000
GROSTRSH EQU   GROUP+40                                                 09165000
GROSSPD  EQU   GROUP+38                                                 09166000
GROPSPD  EQU   GROUP+36                                                 09167000
GROLSN   EQU   GROUP+23                                                 09168000
@NM00109 EQU   GROFLAGA+2                                               09169000
GROMSG1  EQU   GROFLAGA+2                                               09170000
GRORES1  EQU   GROTYPE                                                  09171000
GROGVR   EQU   GROTYPE                                                  09172000
GROZERO  EQU   GROID+1                                                  09173000
GROBLANK EQU   GROID                                                    09174000
GROG     EQU   GRONAME                                                  09175000
@NM00108 EQU   DUPV+50                                                  09176000
DUP2BIT2 EQU   DUPLID2                                                  09177000
DUP2BIT1 EQU   DUPLID2                                                  09178000
DUPRES4  EQU   DUPLIB2                                                  09179000
DUPCSN2  EQU   DUPV+37                                                  09180000
DUP1BIT2 EQU   DUPLID1                                                  09181000
DUP1BIT1 EQU   DUPLID1                                                  09182000
DUPRES3  EQU   DUPLIB1                                                  09183000
DUPCSN1  EQU   DUPV+24                                                  09184000
DUPMISCF EQU   DUPRCVYF+2                                               09185000
DUPSATIA EQU   DUPRCVYF                                                 09186000
@NM00107 EQU   DUPV+18                                                  09187000
@NM00106 EQU   DUPFLAGA+2                                               09188000
DUPRES2  EQU   DUPTYPE                                                  09189000
DUPDUPLR EQU   DUPTYPE                                                  09190000
DUPRES1  EQU   DUPTYPE                                                  09191000
DUPRES5  EQU   DUPV+13                                                  09192000
DUPNO    EQU   DUPID+1                                                  09193000
DUPBLANK EQU   DUPID                                                    09194000
DUPD     EQU   DUPNAME                                                  09195000
@NM00105 EQU   COPYV+136                                                09196000
COPFREXT EQU   COPYV+132                                                09197000
COPLEXT  EQU   COPYV+130                                                09198000
COPFRESP EQU   COPYV+128                                                09199000
COPDESCR EQU   COPYV+58                                                 09200000
COP2BIT2 EQU   COPLID2                                                  09201000
COP2BIT1 EQU   COPLID2                                                  09202000
COPRES5  EQU   COPLIB2                                                  09203000
COP1BIT2 EQU   COPLID1                                                  09204000
COP1BIT1 EQU   COPLID1                                                  09205000
COPRES4  EQU   COPLIB1                                                  09206000
@NM00104 EQU   COPMISCF                                                 09207000
COPRES3  EQU   COPSATIA                                                 09208000
COPVSMIS EQU   COPSATIA                                                 09209000
COPIVCRE EQU   COPSATIA                                                 09210000
@NM00103 EQU   COPYV+18                                                 09211000
@NM00102 EQU   COPFLAGA+3                                               09212000
COPDLSPF EQU   COPFLAGA+3                                               09213000
COPRSTD  EQU   COPFLAGA+2                                               09214000
COPGENUS EQU   COPFLAGA+2                                               09215000
COPVSAM  EQU   COPFLAGA+2                                               09216000
COPGROUP EQU   COPFLAGA+2                                               09217000
COPRES2  EQU   COPTYPE                                                  09218000
COPCOPYV EQU   COPTYPE                                                  09219000
COPRES1  EQU   COPTYPE                                                  09220000
COPRES6  EQU   COPYV+13                                                 09221000
COPBLANK EQU   COPID                                                    09222000
COPV     EQU   COPNAME                                                  09223000
BCD2BIT2 EQU   BCDLID2                                                  09224000
BCD2BIT1 EQU   BCDLID2                                                  09225000
BCDRES8  EQU   BCDLIB2                                                  09226000
BCD1BIT2 EQU   BCDLID1                                                  09227000
BCD1BIT1 EQU   BCDLID1                                                  09228000
BCDRE10  EQU   BCDLIB1                                                  09229000
BCDRES7A EQU   BCDMISCF                                                 09230000
BCDHOLD  EQU   BCDMISCF                                                 09231000
BCDRES7  EQU   BCDSATIA                                                 09232000
BCDVSMIS EQU   BCDSATIA                                                 09233000
BCDIVCPY EQU   BCDSATIA                                                 09234000
BCDIVCRE EQU   BCDSATIA                                                 09235000
BCDCPUID EQU   BCDV+18                                                  09236000
BCDRES5  EQU   BCDFLAGB+1                                               09237000
BCDREASS EQU   BCDFLAGB+1                                               09238000
BCDRES4  EQU   BCDFLAGB                                                 09239000
BCDRES3  EQU   BCDTYPE                                                  09240000
BCDRES2  EQU   BCDTYPE                                                  09241000
BCDCOPY  EQU   BCDTYPE                                                  09242000
BCDRES1  EQU   BCDTYPE                                                  09243000
BCDRES9  EQU   BCDV+13                                                  09244000
BCDINDEX EQU   BCDID+1                                                  09245000
BCDBLNK2 EQU   BCDID                                                    09246000
BCDSERNO EQU   BCDNAME+5                                                09247000
BCDBLNK1 EQU   BCDPREFX+1                                               09248000
BCDALPHA EQU   BCDPREFX                                                 09249000
@NM00101 EQU   BASEV+192                                                09250000
BASXPDT2 EQU   BASEV+188                                                09251000
BASRES6  EQU   BASEV+89                                                 09252000
BASCOPNO EQU   BASCOPID+1                                               09253000
BASCOPBK EQU   BASCOPID                                                 09254000
BASCOPSN EQU   BASKLCPY+5                                               09255000
BASCOPV  EQU   BASKLCPY                                                 09256000
@NM00100 EQU   BASEV+65                                                 09257000
BASBKLMT EQU   BASEV+64                                                 09258000
BASNBKUP EQU   BASEV+63                                                 09259000
BASNCOPY EQU   BASEV+62                                                 09260000
BASPREV  EQU   BASEV+50                                                 09261000
BAS2BIT2 EQU   BASLID2                                                  09262000
BAS2BIT1 EQU   BASLID2                                                  09263000
BASRES5  EQU   BASLIB2                                                  09264000
BAS1BIT2 EQU   BASLID1                                                  09265000
BAS1BIT1 EQU   BASLID1                                                  09266000
BASRES4  EQU   BASLIB1                                                  09267000
BASRES3  EQU   BASMISCF                                                 09268000
BASRES8  EQU   BASSATIA                                                 09269000
@NM00099 EQU   BASFLAGA+3                                               09270000
BASFIRST EQU   BASFLAGA+3                                               09271000
BASGRPV  EQU   BASFLAGA+2                                               09272000
BASNOCPY EQU   BASFLAGA+2                                               09273000
BASRES2  EQU   BASTYPE                                                  09274000
BASBASVR EQU   BASTYPE                                                  09275000
BASRES1  EQU   BASTYPE                                                  09276000
BASRES7  EQU   BASEV+13                                                 09277000
BASZERO  EQU   BASID+1                                                  09278000
BASBLANK EQU   BASID                                                    09279000
BASEVKEY EQU   BASNAME                                                  09280000
ICBLORD  EQU   ICBTRACE+256                                             09281000
ICBOTRC  EQU   ICBTRACE                                                 09282000
ICBRESV  EQU   ICB2SSCB+128                                             09283000
ICBVOLST EQU   ICB2SSCB+124                                             09284000
ICBVSCRA EQU   ICB2SSCB+120                                             09285000
ICBSAMP  EQU   ICB2SSCB+118                                             09286000
ICBRESVD EQU   ICB2SSCB+117                                             09287000
ICBCPUID EQU   ICB2SSCB+112                                             09288000
ICBFAB   EQU   ICB2SSCB+108                                             09289000
ICBMSSC  EQU   ICB2SSCB+104                                             09290000
ICBRSVP  EQU   ICB2SSCB+100                                             09291000
ICBAEAP  EQU   ICB2SSCB+96                                              09292000
ICBSIOBP EQU   ICB2SSCB+92                                              09293000
ICBIATNA EQU   ICB2SSCB+88                                              09294000
ICBIPRGA EQU   ICB2SSCB+84                                              09295000
ICBSRBP  EQU   ICB2SSCB+80                                              09296000
ICBVVICB EQU   ICB2SSCB+76                                              09297000
ICBSIOP  EQU   ICB2SSCB+68                                              09298000
ICBMEP   EQU   ICB2SSCB+64                                              09299000
ICBIORCI EQU   ICB2SSCB+60                                              09300000
ICB2ACTP EQU   ICB2SSCB+56                                              09301000
ICBFG3   EQU   ICBFLG+2                                                 09302000
ICBFG2   EQU   ICBFLG+1                                                 09303000
@NM00098 EQU   ICBFG1                                                   09304000
ICBMSCA  EQU   ICBFG1                                                   09305000
ICBMSCMP EQU   ICBFG1                                                   09306000
ICBS     EQU   ICBFG1                                                   09307000
ICBB     EQU   ICBFG1                                                   09308000
ICBV     EQU   ICBFG1                                                   09309000
ICBR     EQU   ICBFG1                                                   09310000
ICBI     EQU   ICBFG1                                                   09311000
ICBNVT   EQU   ICBOPT                                                   09312000
ICBVN02P EQU   ICB2SSCB+44                                              09313000
ICBTCB   EQU   ICB2SSCB+40                                              09314000
ICBQHEAD EQU   ICB2SSCB+36                                              09315000
ICBAUCB  EQU   ICB2SSCB+32                                              09316000
ICBPUCB  EQU   ICB2SSCB+28                                              09317000
ICBCOMQ  EQU   ICB2SSCB+24                                              09318000
ICBIOR   EQU   ICB2SSCB+20                                              09319000
ICBCOM   EQU   ICB2SSCB+16                                              09320000
ICBACTV  EQU   ICB2SSCB+12                                              09321000
ICBECB   EQU   ICB2SSCB+8                                               09322000
ICBSSNAM EQU   ICB2SSCB                                                 09323000
CVTLEVL  EQU   CVTRELNO+2                                               09324000
CVTNUMB  EQU   CVTRELNO                                                 09325000
CVTMDL   EQU   CVTFIX+250                                               09326000
@NM00097 EQU   CVTFIX+248                                               09327000
@NM00096 EQU   CVTFIX                                                   09328000
CVTRV482 EQU   CVTXTNT2+128                                             09329000
CVTRV481 EQU   CVTXTNT2+124                                             09330000
CVTRV480 EQU   CVTXTNT2+120                                             09331000
CVTRV479 EQU   CVTXTNT2+118                                             09332000
CVTRV478 EQU   CVTXTNT2+117                                             09333000
CVTRV477 EQU   CVTXTNT2+116                                             09334000
CVTRV476 EQU   CVTXTNT2+115                                             09335000
CVTRV475 EQU   CVTXTNT2+114                                             09336000
CVTRV474 EQU   CVTRV466                                                 09337000
CVTRV473 EQU   CVTRV466                                                 09338000
CVTRV472 EQU   CVTRV466                                                 09339000
CVTRV471 EQU   CVTRV466                                                 09340000
CVTRV470 EQU   CVTRV466                                                 09341000
CVTRV469 EQU   CVTRV466                                                 09342000
CVTRV468 EQU   CVTRV466                                                 09343000
CVTRV467 EQU   CVTRV466                                                 09344000
CVTRV465 EQU   CVTRV457                                                 09345000
CVTRV464 EQU   CVTRV457                                                 09346000
CVTRV463 EQU   CVTRV457                                                 09347000
CVTRV462 EQU   CVTRV457                                                 09348000
CVTRV461 EQU   CVTRV457                                                 09349000
CVTRV460 EQU   CVTRV457                                                 09350000
CVTRV459 EQU   CVTRV457                                                 09351000
CVTRV458 EQU   CVTRV457                                                 09352000
CVTRV456 EQU   CVTXTNT2+108                                             09353000
CVTRV455 EQU   CVTXTNT2+104                                             09354000
CVTRV454 EQU   CVTXTNT2+100                                             09355000
CVTRV453 EQU   CVTXTNT2+96                                              09356000
CVTRV452 EQU   CVTXTNT2+94                                              09357000
CVTRV451 EQU   CVTXTNT2+92                                              09358000
CVTRV450 EQU   CVTXTNT2+90                                              09359000
CVTRV449 EQU   CVTXTNT2+88                                              09360000
CVTRV448 EQU   CVTXTNT2+87                                              09361000
CVTRV447 EQU   CVTXTNT2+86                                              09362000
CVTRV446 EQU   CVTRV438                                                 09363000
CVTRV445 EQU   CVTRV438                                                 09364000
CVTRV444 EQU   CVTRV438                                                 09365000
CVTRV443 EQU   CVTRV438                                                 09366000
CVTRV442 EQU   CVTRV438                                                 09367000
CVTRV441 EQU   CVTRV438                                                 09368000
CVTRV440 EQU   CVTRV438                                                 09369000
CVTRV439 EQU   CVTRV438                                                 09370000
CVTRV437 EQU   CVTRV429                                                 09371000
CVTRV436 EQU   CVTRV429                                                 09372000
CVTRV435 EQU   CVTRV429                                                 09373000
CVTRV434 EQU   CVTRV429                                                 09374000
CVTRV433 EQU   CVTRV429                                                 09375000
CVTRV432 EQU   CVTRV429                                                 09376000
CVTRV431 EQU   CVTRV429                                                 09377000
CVTRV430 EQU   CVTRV429                                                 09378000
CVTRV428 EQU   CVTXTNT2+80                                              09379000
CVTRV427 EQU   CVTXTNT2+76                                              09380000
CVTRV426 EQU   CVTXTNT2+72                                              09381000
CVTRV425 EQU   CVTXTNT2+68                                              09382000
CVTATACT EQU   CVTATCVT                                                 09383000
CVTRV423 EQU   CVTXTNT2+62                                              09384000
CVTRV422 EQU   CVTXTNT2+60                                              09385000
CVTRV421 EQU   CVTXTNT2+58                                              09386000
CVTRV420 EQU   CVTXTNT2+56                                              09387000
CVTRV419 EQU   CVTXTNT2+55                                              09388000
CVTRV418 EQU   CVTXTNT2+54                                              09389000
CVTRV417 EQU   CVTRV409                                                 09390000
CVTRV416 EQU   CVTRV409                                                 09391000
CVTRV415 EQU   CVTRV409                                                 09392000
CVTRV414 EQU   CVTRV409                                                 09393000
CVTRV413 EQU   CVTRV409                                                 09394000
CVTRV412 EQU   CVTRV409                                                 09395000
CVTRV411 EQU   CVTRV409                                                 09396000
CVTRV410 EQU   CVTRV409                                                 09397000
CVTRV408 EQU   CVTRV400                                                 09398000
CVTRV407 EQU   CVTRV400                                                 09399000
CVTRV406 EQU   CVTRV400                                                 09400000
CVTRV405 EQU   CVTRV400                                                 09401000
CVTRV404 EQU   CVTRV400                                                 09402000
CVTRV403 EQU   CVTRV400                                                 09403000
CVTRV402 EQU   CVTRV400                                                 09404000
CVTRV401 EQU   CVTRV400                                                 09405000
CVTSKTA  EQU   CVTXTNT2+44                                              09406000
CVTRSV99 EQU   CVTXTNT2+40                                              09407000
CVTRSV98 EQU   CVTXTNT2+36                                              09408000
CVTRSV97 EQU   CVTXTNT2+34                                              09409000
CVTRSV96 EQU   CVTXTNT2+32                                              09410000
CVTOLTEP EQU   CVTXTNT2+28                                              09411000
CVTQIDA  EQU   CVTQID+1                                                 09412000
CVTRSV95 EQU   CVTQID                                                   09413000
CVTRSV94 EQU   CVTXTNT2+20                                              09414000
CVTRSV93 EQU   CVTXTNT2+16                                              09415000
CVTRSV92 EQU   CVTXTNT2+12                                              09416000
CVTDEBVR EQU   CVTXTNT2+8                                               09417000
CVTRSV91 EQU   CVTXTNT2+6                                               09418000
CVTRSV9H EQU   CVTFLGBT                                                 09419000
CVTRSV9G EQU   CVTFLGBT                                                 09420000
CVTRSV9F EQU   CVTFLGBT                                                 09421000
CVTRSV9E EQU   CVTFLGBT                                                 09422000
CVTRSV9D EQU   CVTFLGBT                                                 09423000
CVTRSV9C EQU   CVTFLGBT                                                 09424000
CVTVME   EQU   CVTFLGBT                                                 09425000
CVTNPE   EQU   CVTFLGBT                                                 09426000
CVTNUCLS EQU   CVTXTNT2+4                                               09427000
CVTDSSVA EQU   CVTDSSV+1                                                09428000
CVTRSV89 EQU   CVTDSSV                                                  09429000
CVTRSV88 EQU   CVTXTNT1+8                                               09430000
CVTRSV87 EQU   CVTXTNT1+4                                               09431000
CVTFACHN EQU   CVTXTNT1                                                 09432000
CVTRV488 EQU   CVTMAP+412                                               09433000
CVTRV487 EQU   CVTMAP+408                                               09434000
CVTRV486 EQU   CVTMAP+404                                               09435000
CVTRV485 EQU   CVTMAP+400                                               09436000
CVTACTAP EQU   CVTMAP+396                                               09437000
CVTAUTH  EQU   CVTMAP+392                                               09438000
CVTATMCA EQU   CVTATMCT+1                                               09439000
CVTATMST EQU   CVTATMCT                                                 09440000
CVTRSV61 EQU   CVTMAP+384                                               09441000
CVTVOLT1 EQU   CVTVOLM1+1                                               09442000
CVTVOLI1 EQU   CVTVOLF1                                                 09443000
CVTSTOA  EQU   CVTMAP+376                                               09444000
CVTRSV58 EQU   CVTMAP+374                                               09445000
CVTRSV57 EQU   CVTMAP+372                                               09446000
CVTDDCE  EQU   CVTMAP+368                                               09447000
CVTPNWFR EQU   CVTMAP+364                                               09448000
CVTSMF   EQU   CVTMAP+360                                               09449000
CVTSULK  EQU   CVTMAP+358                                               09450000
CVTSLKO  EQU   CVTSYSK                                                  09451000
CVTSLKP  EQU   CVTSYSK                                                  09452000
CVTSLKQ  EQU   CVTSYSK                                                  09453000
CVTSLKR  EQU   CVTSYSK                                                  09454000
CVTRSV56 EQU   CVTSYSK                                                  09455000
CVTRSV55 EQU   CVTSYSK                                                  09456000
CVTRSV54 EQU   CVTSYSK                                                  09457000
CVTRSV53 EQU   CVTSYSK                                                  09458000
CVTRSV52 EQU   CVTA1F1                                                  09459000
CVTRSV51 EQU   CVTA1F1                                                  09460000
CVTRSV50 EQU   CVTA1F1                                                  09461000
CVTRSV49 EQU   CVTA1F1                                                  09462000
CVTRSV48 EQU   CVTA1F1                                                  09463000
CVTRSV47 EQU   CVTA1F1                                                  09464000
CVTSRSW  EQU   CVTA1F1                                                  09465000
CVTPFSW  EQU   CVTA1F1                                                  09466000
CVTPCVT  EQU   CVTMAP+352                                               09467000
CVTRSV46 EQU   CVTMAP+344                                               09468000
CVTRSV45 EQU   CVTMAP+340                                               09469000
CVTRSV44 EQU   CVTMAP+338                                               09470000
CVTRSV43 EQU   CVTMAP+336                                               09471000
CVTHJESA EQU   CVTHJES+1                                                09472000
CVTRSV42 EQU   CVTHJES                                                  09473000
CVTEXT2A EQU   CVTEXT2+1                                                09474000
CVTRSV41 EQU   CVTEXT2                                                  09475000
CVTAPFA  EQU   CVTAPF+1                                                 09476000
CVTRSV40 EQU   CVTAPF                                                   09477000
CVTRV518 EQU   CVTINTLA                                                 09478000
CVTRV517 EQU   CVTERPV                                                  09479000
CVTEORM  EQU   CVTMAP+312                                               09480000
CVTMCHPR EQU   CVTMAP+308                                               09481000
CVTTZ    EQU   CVTMAP+304                                               09482000
CVTJEPS  EQU   CVTMAP+300                                               09483000
CVTJESCT EQU   CVTMAP+296                                               09484000
CVTMODE  EQU   CVTMAP+292                                               09485000
CVTPTRV  EQU   CVTMAP+288                                               09486000
CVTREAL  EQU   CVTMAP+284                                               09487000
CVTRSV39 EQU   CVTMAP+280                                               09488000
CVTRSV38 EQU   CVTMAP+276                                               09489000
CVTDMSRA EQU   CVTDMSR+1                                                09490000
CVTRV634 EQU   CVTDMSRF                                                 09491000
CVTRV633 EQU   CVTDMSRF                                                 09492000
CVTRV632 EQU   CVTDMSRF                                                 09493000
CVTRV631 EQU   CVTDMSRF                                                 09494000
CVTRV630 EQU   CVTDMSRF                                                 09495000
CVTRV629 EQU   CVTDMSRF                                                 09496000
CVTUDUMP EQU   CVTDMSRF                                                 09497000
CVTSDUMP EQU   CVTDMSRF                                                 09498000
CVTQMSGA EQU   CVTQMSG+1                                                09499000
CVTRSV36 EQU   CVTQMSG                                                  09500000
CVTAMFF  EQU   CVTMAP+264                                               09501000
CVTPURGA EQU   CVTPURG+1                                                09502000
CVTRSV35 EQU   CVTPURG                                                  09503000
CVTCBSP  EQU   CVTMAP+256                                               09504000
CVTATERA EQU   CVTATER+1                                                09505000
CVTSYST  EQU   CVTATER                                                  09506000
CVTVOLT2 EQU   CVTTAT                                                   09507000
CVTVOLI2 EQU   CVTVOLF2                                                 09508000
CVTAQAVB EQU   CVTAQAVT+1                                               09509000
CVTRSV34 EQU   CVTTCMFG                                                 09510000
CVTRSV33 EQU   CVTTCMFG                                                 09511000
CVTRSV32 EQU   CVTTCMFG                                                 09512000
CVTRSV31 EQU   CVTTCMFG                                                 09513000
CVTRSV30 EQU   CVTTCMFG                                                 09514000
CVTRSV29 EQU   CVTTCMFG                                                 09515000
CVTRSV28 EQU   CVTTCMFG                                                 09516000
CVTTCRDY EQU   CVTTCMFG                                                 09517000
CVTGTFA  EQU   CVTGTF+1                                                 09518000
CVTRSV27 EQU   CVTGTFST                                                 09519000
CVTRNIO  EQU   CVTGTFST                                                 09520000
CVTUSR   EQU   CVTGTFST                                                 09521000
CVTRV318 EQU   CVTFORM                                                  09522000
CVTRV317 EQU   CVTTMODE                                                 09523000
CVTRV316 EQU   CVTSTATE                                                 09524000
CVTRV315 EQU   CVTGTFS                                                  09525000
CVTGTFAV EQU   CVTGTFS                                                  09526000
CVT0SCR1 EQU   CVTMAP+232                                               09527000
CVTRV515 EQU   CVTMAP+228                                               09528000
CVTRMS   EQU   CVTMAP+224                                               09529000
CVTPATCH EQU   CVTMAP+220                                               09530000
CVTTSCE  EQU   CVTMAP+216                                               09531000
CVTLNKSC EQU   CVTMAP+214                                               09532000
CVTQABST EQU   CVTMAP+212                                               09533000
CVTMDLDS EQU   CVTMAP+208                                               09534000
CVTUSER  EQU   CVTMAP+204                                               09535000
CVTABEND EQU   CVTMAP+200                                               09536000
CVTSMCA  EQU   CVTMAP+196                                               09537000
CVTRSV18 EQU   CVTMAP+192                                               09538000
CVTQLPAQ EQU   CVTMAP+188                                               09539000
CVTQCDSR EQU   CVTMAP+184                                               09540000
CVTRSV17 EQU   CVTOPTB                                                  09541000
CVTRSV16 EQU   CVTOPTB                                                  09542000
CVTFP    EQU   CVTOPTB                                                  09543000
CVTAPTHR EQU   CVTOPTB                                                  09544000
CVTNLOG  EQU   CVTOPTB                                                  09545000
CVTTOD   EQU   CVTOPTB                                                  09546000
CVTCTIMS EQU   CVTOPTB                                                  09547000
CVTPROT  EQU   CVTOPTB                                                  09548000
CVTXPFP  EQU   CVTOPTA                                                  09549000
CVTASCII EQU   CVTOPTA                                                  09550000
CVTRSV13 EQU   CVTOPTA                                                  09551000
CVTRSV12 EQU   CVTOPTA                                                  09552000
CVTNIP   EQU   CVTOPTA                                                  09553000
CVTDDR   EQU   CVTOPTA                                                  09554000
CVTAPR   EQU   CVTOPTA                                                  09555000
CVTCCH   EQU   CVTOPTA                                                  09556000
CVTSNCTR EQU   CVTMAP+180                                               09557000
CVTQMWR  EQU   CVTMAP+176                                               09558000
CVTQOCR  EQU   CVTMAP+172                                               09559000
CVT1EF00 EQU   CVTMAP+168                                               09560000
CVTMZ00  EQU   CVTMAP+164                                               09561000
CVTSV76Q EQU   CVTSV76C                                                 09562000
CVTRSV11 EQU   CVTMAP+156                                               09563000
CVT0PT01 EQU   CVTMAP+152                                               09564000
CVTMSER  EQU   CVTMAP+148                                               09565000
CVTRV516 EQU   CVTIERLC                                                 09566000
CVTILCH  EQU   CVTMAP+140                                               09567000
CVT0DS   EQU   CVTMAP+136                                               09568000
CVTFBOSV EQU   CVTMAP+132                                               09569000
CVTNUCB  EQU   CVTMAP+128                                               09570000
CVTIXAVL EQU   CVTMAP+124                                               09571000
CVTSV76M EQU   CVTIOQET                                                 09572000
CVTDCBA  EQU   CVTMAP+117                                               09573000
CVTMVS2  EQU   CVTDCB                                                   09574000
CVT6DAT  EQU   CVTDCB                                                   09575000
CVT4MPS  EQU   CVTDCB                                                   09576000
CVTRSV09 EQU   CVTDCB                                                   09577000
CVT4MS1  EQU   CVTDCB                                                   09578000
CVT2SPS  EQU   CVTDCB                                                   09579000
CVT1SSS  EQU   CVTDCB                                                   09580000
CVTRSV08 EQU   CVTDCB                                                   09581000
CVTSTB   EQU   CVTMAP+112                                               09582000
CVTQTD00 EQU   CVTMAP+108                                               09583000
CVTQTE00 EQU   CVTMAP+104                                               09584000
CVTCUCB  EQU   CVTMAP+100                                               09585000
CVTSJQ   EQU   CVTMAP+96                                                09586000
CVTPBLDL EQU   CVTMAP+92                                                09587000
CVTTPC   EQU   CVTMAP+88                                                09588000
CVTSVDCB EQU   CVTMAP+84                                                09589000
CVTBRET  EQU   CVTMAP+82                                                09590000
CVTEXIT  EQU   CVTMAP+80                                                09591000
CVT0FN00 EQU   CVTMAP+76                                                09592000
CVTDARA  EQU   CVTDAR+1                                                 09593000
CVTRSV07 EQU   CVTFLGS1                                                 09594000
CVTRSV06 EQU   CVTFLGS1                                                 09595000
CVTRSV05 EQU   CVTFLGS1                                                 09596000
CVTRSV04 EQU   CVTFLGS1                                                 09597000
CVTRSV03 EQU   CVTFLGS1                                                 09598000
CVTRSV02 EQU   CVTFLGS1                                                 09599000
CVTRSV01 EQU   CVTFLGS1                                                 09600000
CVTDMPLK EQU   CVTFLGS1                                                 09601000
CVTXITP  EQU   CVTMAP+68                                                09602000
CVTZDTAB EQU   CVTMAP+64                                                09603000
CVTMSLT  EQU   CVTMAP+60                                                09604000
CVTDATE  EQU   CVTMAP+56                                                09605000
CVTBTERM EQU   CVTMAP+52                                                09606000
CVTSYSAD EQU   CVTMAP+48                                                09607000
CVTXTLER EQU   CVTMAP+44                                                09608000
CVTILK2  EQU   CVTMAP+40                                                09609000
CVTILK1  EQU   CVTMAP+36                                                09610000
CVTPRLTV EQU   CVTMAP+32                                                09611000
CVTPCNVT EQU   CVTMAP+28                                                09612000
CVT0VL00 EQU   CVTMAP+24                                                09613000
CVTXAPG  EQU   CVTMAP+20                                                09614000
CVTBUF   EQU   CVTMAP+16                                                09615000
CVTJOB   EQU   CVTMAP+12                                                09616000
CVTLINK  EQU   CVTMAP+8                                                 09617000
CVT0EF00 EQU   CVTMAP+4                                                 09618000
CVTTCBP  EQU   CVTMAP                                                   09619000
CVT      EQU   CVTMAP                                                   09620000
ODSLEN   EQU   ODS+20                                                   09621000
ODSMEM   EQU   ODS+12                                                   09622000
ODSMLN   EQU   ODS+11                                                   09623000
ODSFUQ   EQU   ODSFLG                                                   09624000
ODSPOS   EQU   ODS+9                                                    09625000
ODSPAS   EQU   ODS+1                                                    09626000
ODSPLN   EQU   ODS                                                      09627000
OFILELEN EQU   OFILE                                                    09628000
GRPLEN   EQU   @NM00094                                                 09629000
VOLSLEN  EQU   @NM00093                                                 09630000
VSDDSN   EQU   VSDARRAY+4                                               09631000
VSDVOLCT EQU   VSDARRAY                                                 09632000
VSDFMT0  EQU   VSDBLOCK+8                                               09633000
VSDVTOCS EQU   VSDBLOCK+4                                               09634000
VSDELEM  EQU   VSDBLOCK                                                 09635000
VSDFREE  EQU   VSDUSAGE+24                                              09636000
VSDALLC  EQU   VSDUSAGE+19                                              09637000
VSDDSOR3 EQU   VSDDSORG+2                                               09638000
@NM00092 EQU   VSDDSORG                                                 09639000
VSDSCAL  EQU   VSDUSAGE+12                                              09640000
@NM00091 EQU   VSDUSEF                                                  09641000
VSDCALFR EQU   VSDUSEF                                                  09642000
@NM00090 EQU   VSDALLOC                                                 09643000
VSDABSTR EQU   VSDALLOC                                                 09644000
VSDABLK  EQU   VSDALLOC                                                 09645000
VSDATRK  EQU   VSDALLOC                                                 09646000
VSDACYL  EQU   VSDALLOC                                                 09647000
@NM00089 EQU   VSDDORG                                                  09648000
VSDOU    EQU   VSDDORG                                                  09649000
VSDOIS   EQU   VSDDORG                                                  09650000
VSDODA   EQU   VSDDORG                                                  09651000
VSDOUN   EQU   VSDDORG                                                  09652000
VSDOPS   EQU   VSDDORG                                                  09653000
VSDOPO   EQU   VSDDORG                                                  09654000
VSDEXTS  EQU   VSDUSAGE+8                                               09655000
VSDSECAL EQU   VSDUSAGE+4                                               09656000
VSDFTRK  EQU   VSDUSAGE+2                                               09657000
VSDTRKS  EQU   VSDUSAGE                                                 09658000
@NM00088 EQU   VSDSCR+5                                                 09659000
@NM00087 EQU   VSDSCRFL                                                 09660000
VSDVSAM  EQU   VSDSCRFL                                                 09661000
VSDCATLC EQU   VSDSCRFL                                                 09662000
VSDACBPT EQU   VSDSCR                                                   09663000
@NM00086 EQU   VSDSTAT+29                                               09664000
VSDPRTC  EQU   VSDSTAT+25                                               09665000
VSDCAT   EQU   VSDSTAT+22                                               09666000
VSDEXP   EQU   VSDSTAT+20                                               09667000
VSDCRE   EQU   VSDSTAT+18                                               09668000
@NM00085 EQU   VSDFLG2                                                  09669000
VSDRACF  EQU   VSDFLG2                                                  09670000
VSDERROR EQU   VSDFLG2                                                  09671000
VSDPROT  EQU   VSDFLG2                                                  09672000
VSDPWW   EQU   VSDFLG2                                                  09673000
VSDPWR   EQU   VSDFLG2                                                  09674000
@NM00084 EQU   VSDSFLG1                                                 09675000
VSDCVSAM EQU   VSDSFLG1                                                 09676000
VSDCATLG EQU   VSDSFLG1                                                 09677000
VSDVSAME EQU   VSDSFLG1                                                 09678000
VSDVSAMC EQU   VSDSFLG1                                                 09679000
VSDVTOCE EQU   VSDSFLG1                                                 09680000
VSDVTOCC EQU   VSDSFLG1                                                 09681000
VSDOWNER EQU   VSDSTAT+8                                                09682000
VSDEXPIR EQU   VSDSTAT+4                                                09683000
VSDCREAT EQU   VSDSTAT                                                  09684000
VSDFRCCL EQU   VSDVTOC+21                                               09685000
@NM00083 EQU   VSDVTOC+20                                               09686000
VSDFREXT EQU   VSDVTOC+16                                               09687000
@NM00082 EQU   VSDVTOC+15                                               09688000
VSDFRTRK EQU   VSDVTOC+11                                               09689000
@NM00081 EQU   VSDVTOC+10                                               09690000
VSDFRCYL EQU   VSDVTOC+6                                                09691000
@NM00080 EQU   VSDVTOC                                                  09692000
@NM00079 EQU   VS3FLAGS                                                 09693000
VS3SYSNM EQU   VS3FLAGS                                                 09694000
VS3UNCAT EQU   VS3FLAGS                                                 09695000
VS3SCR   EQU   VS3FLAGS                                                 09696000
VS3USAGE EQU   VS3FLAGS                                                 09697000
VS3STAT  EQU   VS3FLAGS                                                 09698000
VS3DD    EQU   VS3AGL+50                                                09699000
VS3VOL   EQU   VS3AGL+44                                                09700000
VS3POOL  EQU   VS3AGL+40                                                09701000
VS3DEV   EQU   VS3AGL+36                                                09702000
VS3UCBP  EQU   VS3AGL+32                                                09703000
VS3CREAT EQU   VS3AGL+28                                                09704000
VS3EXPIR EQU   VS3AGL+24                                                09705000
VS3AST   EQU   VS3AGL+22                                                09706000
VS3LEVLN EQU   VS3AGL+20                                                09707000
VS3LEVP  EQU   VS3AGL+16                                                09708000
VS3EXDSP EQU   VS3AGL+12                                                09709000
VS3LISTP EQU   VS3AGL+8                                                 09710000
VS3HEAD  EQU   VS3AGL                                                   09711000
@NM00078 EQU   DATESOPT                                                 09712000
DATDAYOP EQU   DATESOPT                                                 09713000
DATDTEOP EQU   DATESOPT                                                 09714000
DATSUB   EQU   DATESOPT                                                 09715000
DATADD   EQU   DATESOPT                                                 09716000
DATRETRN EQU   DATESAGL+16                                              09717000
DATDAYS  EQU   DATESAGL+12                                              09718000
DATDATE  EQU   DATESAGL+8                                               09719000
DATHEAD  EQU   DATESAGL                                                 09720000
@NM00077 EQU   SELFLAGS                                                 09721000
SELVOL   EQU   SELAGL+16                                                09722000
SELDDNP  EQU   SELAGL+12                                                09723000
SELUCBP  EQU   SELAGL+8                                                 09724000
SELHEAD  EQU   SELAGL                                                   09725000
@NM00076 EQU   UCTFLAGS                                                 09726000
UCTVSCAT EQU   UCTFLAGS                                                 09727000
UCTDD    EQU   UCTAGL+60                                                09728000
UCTVOLP  EQU   UCTAGL+56                                                09729000
UCTACBP  EQU   UCTAGL+52                                                09730000
UCTDSN   EQU   UCTAGL+8                                                 09731000
UCTHEAD  EQU   UCTAGL                                                   09732000
@NM00075 EQU   LCTFLAGS                                                 09733000
LCTVSCAT EQU   LCTFLAGS                                                 09734000
LCTOWNER EQU   LCTINFO+24                                               09735000
LCTEXPIR EQU   LCTINFO+20                                               09736000
LCTCREAT EQU   LCTINFO+16                                               09737000
LCTACBP  EQU   LCTINFO+12                                               09738000
LCTMULVC EQU   LCTINFO+8                                                09739000
LCTHEAD  EQU   LCTINFO                                                  09740000
SRTWORKP EQU   SRTAGL+28                                                09741000
SRTFLDLN EQU   SRTAGL+24                                                09742000
SRTPOSIT EQU   SRTAGL+20                                                09743000
SRTLEN   EQU   SRTAGL+16                                                09744000
SRTNUM   EQU   SRTAGL+12                                                09745000
SRTADDR  EQU   SRTAGL+8                                                 09746000
SRTHEAD  EQU   SRTAGL                                                   09747000
SV82DEBP EQU   SV82WRKP                                                 09748000
SV82TTRP EQU   SV82LIST+8                                               09749000
SV82VOLP EQU   SV82DCBP                                                 09750000
SV82UCBP EQU   SV82LIST+1                                               09751000
SV82CODE EQU   SV82LIST                                                 09752000
VOLRESV3 EQU   VOLLABEL+55                                              09753000
VOLOWNER EQU   VOLLABEL+45                                              09754000
VOLRESV1 EQU   VOLLABEL+20                                              09755000
VOLVTOC  EQU   VOLLABEL+15                                              09756000
VOLSECTY EQU   VOLLABEL+14                                              09757000
VOLSERNO EQU   VOLLABEL+8                                               09758000
VOLNO    EQU   VOLLABEL+7                                               09759000
VOLLABI  EQU   VOLLABEL+4                                               09760000
VOLKEY   EQU   VOLLABEL                                                 09761000
STAVTTR  EQU   STAEPARM+54                                              09762000
@NM00072 EQU   STARETRY                                                 09763000
STAVTOC  EQU   STARETRY                                                 09764000
STAOFF   EQU   STARETRY                                                 09765000
STAIO05  EQU   STARETRY                                                 09766000
@NM00071 EQU   STARCVY                                                  09767000
STACLEAR EQU   STARCVY                                                  09768000
STAVPOST EQU   STARCVY                                                  09769000
STAVENQ  EQU   STARCVY                                                  09770000
STAVDMNT EQU   STARCVY                                                  09771000
STAVMNT  EQU   STARCVY                                                  09772000
STATCB   EQU   STAEPARM+48                                              09773000
STARTADD EQU   STAEPARM+44                                              09774000
STAEXSAV EQU   STAEPARM+40                                              09775000
STARTSAV EQU   STAEPARM+36                                              09776000
STARTTR  EQU   STAEPARM+32                                              09777000
@NM00070 EQU   STAEPARM+30                                              09778000
STARVOL  EQU   STAEPARM+24                                              09779000
STARUCB  EQU   STAEPARM+20                                              09780000
@NM00069 EQU   STAEPARM+18                                              09781000
STAVVOL  EQU   STAEPARM+12                                              09782000
STAVUCB  EQU   STAEPARM+8                                               09783000
STAHEAD  EQU   STAEPARM                                                 09784000
RCTDSET  EQU   RCTAGL+32                                                09785000
RCTNVOL  EQU   RCTAGL+26                                                09786000
RCTOVOL  EQU   RCTAGL+20                                                09787000
RCTNDEV  EQU   RCTAGL+16                                                09788000
RCTODEV  EQU   RCTAGL+12                                                09789000
@NM00068 EQU   RCTAGL+10                                                09790000
@NM00067 EQU   RCTOPT                                                   09791000
RCTVOL   EQU   RCTOPT                                                   09792000
RCTDEV   EQU   RCTOPT                                                   09793000
RCTHEAD  EQU   RCTAGL                                                   09794000
@NM00066 EQU   VSRESOPT                                                 09795000
VSREAL   EQU   VSRESOPT                                                 09796000
VSRES    EQU   VSRESOPT                                                 09797000
@NM00065 EQU   VSMSG                                                    09798000
VSTOV    EQU   VSMSG                                                    09799000
VSFROMV  EQU   VSMSG                                                    09800000
@NM00064 EQU   VSRETURN                                                 09801000
VSUCAT   EQU   VSRETURN                                                 09802000
VSVSAM   EQU   VSRETURN                                                 09803000
@NM00063 EQU   VSCATOPT                                                 09804000
VSLIST   EQU   VSCATOPT                                                 09805000
VSSERIAL EQU   VSCATOPT                                                 09806000
VSDEVICE EQU   VSCATOPT                                                 09807000
@NM00062 EQU   VSVTOPT                                                  09808000
VSVSFLAG EQU   VSVTOPT                                                  09809000
VSALTTRK EQU   VSVTOPT                                                  09810000
VSTIME   EQU   VSVTOPT                                                  09811000
VSUCMAST EQU   VSSECOPT                                                 09812000
VSOPCAT  EQU   VSSECOPT                                                 09813000
VSUCTEST EQU   VSSECOPT                                                 09814000
VSWRITE  EQU   VSSECOPT                                                 09815000
VSREAD   EQU   VSSECOPT                                                 09816000
VSNONONV EQU   VSSECOPT                                                 09817000
VSMASTER EQU   VSSECOPT                                                 09818000
VSNOVSAM EQU   VSSECOPT                                                 09819000
VSODEVP  EQU   VS1AGL+64                                                09820000
VSOSERP  EQU   VS1AGL+60                                                09821000
VSDEVP   EQU   VS1AGL+56                                                09822000
VSSERP   EQU   VS1AGL+52                                                09823000
VSPFILEP EQU   VS1AGL+48                                                09824000
VSPSWDP  EQU   VS1AGL+44                                                09825000
VSCATDDP EQU   VS1AGL+40                                                09826000
VSACBP   EQU   VS1AGL+36                                                09827000
VSCATP   EQU   VS1AGL+32                                                09828000
VSNXTATP EQU   VS1AGL+28                                                09829000
VSNUMATP EQU   VS1AGL+24                                                09830000
VSIOP    EQU   VS1AGL+20                                                09831000
VSFILEP  EQU   VS1AGL+16                                                09832000
VSVOLP   EQU   VS1AGL+12                                                09833000
VSUCBP   EQU   VS1AGL+8                                                 09834000
VSHEAD   EQU   VS1AGL                                                   09835000
VSVTOCPT EQU   VS2AGL+48                                                09836000
@NM00061 EQU   VS2AGL+45                                                09837000
VSDDNAME EQU   VS2AGL+37                                                09838000
@NM00060 EQU   VS2RESOP                                                 09839000
VS2REAL  EQU   VS2RESOP                                                 09840000
VS2RES   EQU   VS2RESOP                                                 09841000
@NM00059 EQU   VS2MSG                                                   09842000
VS2TOV   EQU   VS2MSG                                                   09843000
VSVOLUME EQU   VS2AGL+29                                                09844000
@NM00058 EQU   VSLABOPT                                                 09845000
VSNOVTOC EQU   VSLABOPT                                                 09846000
VSVOLSER EQU   VSLABOPT                                                 09847000
VSOWNER  EQU   VSLABOPT                                                 09848000
VSIOBKPT EQU   VS2AGL+24                                                09849000
VSVOLPTR EQU   VS2AGL+20                                                09850000
VSOWNPTR EQU   VS2AGL+16                                                09851000
VSVTOCSZ EQU   VS2AGL+12                                                09852000
VSUCBPTR EQU   VS2AGL+8                                                 09853000
VS2HEAD  EQU   VS2AGL                                                   09854000
EXPDATAL EQU   EXPARRAY+6                                               09855000
@NM00057 EQU   EXPARRAY+5                                               09856000
EXPKEYLN EQU   EXPARRAY+4                                               09857000
EXPDATAP EQU   EXPARRAY                                                 09858000
EXPRECNO EQU   EXPDATAB                                                 09859000
EXPCCHHR EQU   EXPARG+16                                                09860000
EXPCTLBK EQU   EXPARG+8                                                 09861000
EXPHEAD  EQU   EXPARG                                                   09862000
EXRWFUN  EQU   EXWRARG+46                                               09863000
@NM00056 EQU   EXSPACE+8                                                09864000
@NM00055 EQU   EXSPACE+6                                                09865000
@NM00054 EQU   EXSPACE+4                                                09866000
@NM00053 EQU   EXSPACE+1                                                09867000
@NM00052 EQU   EXSPACE                                                  09868000
EXRWKDLN EQU   EXWRARG+32                                               09869000
@NM00051 EQU   EXWRARG+31                                               09870000
EXRECNUM EQU   EXRWCHR+4                                                09871000
EXHH     EQU   EXRWCHR+2                                                09872000
EXCC     EQU   EXRWCHR                                                  09873000
EXCCWCNT EQU   EXWRARG+24                                               09874000
EXLOCPTR EQU   EXWRARG+20                                               09875000
EXRWDARE EQU   EXWRARG+16                                               09876000
EXRWIOAR EQU   EXWRARG+12                                               09877000
EXRWCTBL EQU   EXWRARG+8                                                09878000
EXRWRES  EQU   EXWRARG                                                  09879000
EXGDATAL EQU   EXGARG+30                                                09880000
@NM00050 EQU   EXGARG+29                                                09881000
EXGKEYLN EQU   EXGARG+28                                                09882000
EXGDATAP EQU   EXGARG+24                                                09883000
EXGRECNO EQU   EXGARG+20                                                09884000
EXGCCHH2 EQU   EXGARG+16                                                09885000
EXGCCHH1 EQU   EXGARG+12                                                09886000
EXGCTLBK EQU   EXGARG+8                                                 09887000
EXGHEAD  EQU   EXGARG                                                   09888000
EXOVTH   EQU   EXFLG                                                    09889000
EXORVT   EQU   EXFLG                                                    09890000
EXORDS   EQU   EXFLG                                                    09891000
EXOSPK   EQU   EXFLG                                                    09892000
EXORVS   EQU   EXFLG                                                    09893000
@NM00049 EQU   EXFLG                                                    09894000
EXOREAD  EQU   EXFLG                                                    09895000
@NM00048 EQU   EXOPT                                                    09896000
EXOREP   EQU   EXOPT                                                    09897000
EXOVTOC  EQU   EXOPT                                                    09898000
EXONEW   EQU   EXOPT                                                    09899000
EXOPASS  EQU   EXOPT                                                    09900000
EXOLAB   EQU   EXOPT                                                    09901000
EXOTAB   EQU   EXOPT                                                    09902000
EXOCTLBK EQU   EXOARG+28                                                09903000
EXOEXT   EQU   EXOARG+24                                                09904000
EXOUCB   EQU   EXOARG+20                                                09905000
EXOVSN   EQU   EXOARG+16                                                09906000
EXODSN   EQU   EXOARG+12                                                09907000
EXODDN   EQU   EXOARG+8                                                 09908000
EXOHEAD  EQU   EXOARG                                                   09909000
@NM00047 EQU   EXCLFLAG                                                 09910000
EXCLMNT  EQU   EXCLFLAG                                                 09911000
EXCLVOL  EQU   EXCLAGL+16                                               09912000
EXCLDDP  EQU   EXCLAGL+12                                               09913000
EXCLUCBP EQU   EXCLAGL+8                                                09914000
EXCLHEAD EQU   EXCLAGL                                                  09915000
@NM00046 EQU   CKFLAGS                                                  09916000
CKDMTABL EQU   CKFLAGS                                                  09917000
CKRETTYP EQU   CKFLAGS                                                  09918000
CKTESTVT EQU   CKFLAGS                                                  09919000
CKLABELP EQU   CKAGL+24                                                 09920000
CKDATYPE EQU   CKAGL+20                                                 09921000
CKDDNAME EQU   CKAGL+12                                                 09922000
CKUCBPTR EQU   CKAGL+8                                                  09923000
CKHEAD   EQU   CKAGL                                                    09924000
PULABELP EQU   PUAGL+16                                                 09925000
PUTTRPTR EQU   PUAGL+12                                                 09926000
PUUCBPTR EQU   PUAGL+8                                                  09927000
PUHEAD   EQU   PUAGL                                                    09928000
MDR      EQU   MDVTOC+4                                                 09929000
MDHH     EQU   MDVTOC+2                                                 09930000
MDCC     EQU   MDVTOC                                                   09931000
@NM00045 EQU   MDAGL+31                                                 09932000
MDVTOCTR EQU   MDFLAGS                                                  09933000
MDFORCE  EQU   MDFLAGS                                                  09934000
MDDEQ    EQU   MDFLAGS                                                  09935000
MDENQ    EQU   MDFLAGS                                                  09936000
MDWAIT   EQU   MDFLAGS                                                  09937000
MDPOST   EQU   MDFLAGS                                                  09938000
MDCLEAR  EQU   MDFLAGS                                                  09939000
MDNEWVOL EQU   MDFLAGS                                                  09940000
MDLABEL  EQU   MDAGL+24                                                 09941000
MDPUAGL  EQU   MDAGL+20                                                 09942000
MDDDNAME EQU   MDAGL+12                                                 09943000
MDUCBPTR EQU   MDAGL+8                                                  09944000
MDHEAD   EQU   MDAGL                                                    09945000
CTTBLRR  EQU   CTARRAY+3                                                09946000
CTTBLHH  EQU   CTARRAY+2                                                09947000
CTTBLCC  EQU   CTARRAY+1                                                09948000
CTTBLID  EQU   CTARRAY                                                  09949000
CTREALH  EQU   CTMSG+3                                                  09950000
CTREALCC EQU   CTMSG+1                                                  09951000
@NM00044 EQU   CTMSG                                                    09952000
CMCSN2   EQU   CMMSG+28                                                 09953000
CMCSN1   EQU   CMMSG+16                                                 09954000
CMNUMCRT EQU   CMMSG+15                                                 09955000
@NM00043 EQU   CMMSG+14                                                 09956000
CMNEWVOL EQU   CMMSG+8                                                  09957000
@NM00042 EQU   CMMSG+7                                                  09958000
@NM00041 EQU   CMVOLFLG                                                 09959000
CMRONLY  EQU   CMVOLFLG                                                 09960000
CMBIND   EQU   CMVOLFLG                                                 09961000
CMSCRCRT EQU   CMVOLFLG                                                 09962000
CMEXCL   EQU   CMVOLFLG                                                 09963000
CMDERAS  EQU   CMVOLFLG                                                 09964000
CMSCRVOL EQU   CMVOLFLG                                                 09965000
CMCECART EQU   CMVOLFLG                                                 09966000
CMOLDVOL EQU   CMMSG                                                    09967000
CCOLDCSN EQU   CCMSG+24                                                 09968000
CCNEWCSN EQU   CCMSG+12                                                 09969000
@NM00040 EQU   CCMSG+10                                                 09970000
CCVOL    EQU   CCMSG+4                                                  09971000
@NM00039 EQU   CCMSG+2                                                  09972000
CCEJCODE EQU   CCMSG+1                                                  09973000
CCPSTCDE EQU   CCMSG                                                    09974000
@NM00038 EQU   DMPARY+15                                                09975000
DMPARYTP EQU   DMPARY+14                                                09976000
DMPARYEX EQU   DMPARY+12                                                09977000
DMPARYIC EQU   DMPARY+10                                                09978000
DMPARYSZ EQU   DMPARY+8                                                 09979000
DMPARYNM EQU   DMPARY                                                   09980000
@NM00037 EQU   DMPITM+15                                                09981000
@NM00036 EQU   ERCNVTAB+24                                              09982000
ERDARBPT EQU   ERCPLPT                                                  09983000
ERDYNRC  EQU   ERCATRC                                                  09984000
ERDSNM   EQU   ERCNVTAB+12                                              09985000
@NM00035 EQU   ERCNVTAB+4                                               09986000
@NM00034 EQU   ERCNVTAB+3                                               09987000
@NM00033 EQU   EROSOPER                                                 09988000
EROSUCDX EQU   EROSOPER                                                 09989000
EROSCATL EQU   EROSOPER                                                 09990000
@NM00032 EQU   EROPER                                                   09991000
ERCATAL  EQU   EROPER                                                   09992000
ERCATDL  EQU   EROPER                                                   09993000
ERCATDE  EQU   EROPER                                                   09994000
ERCATLC  EQU   EROPER                                                   09995000
@NM00031 EQU   ERTYPE                                                   09996000
ERDYNAL  EQU   ERTYPE                                                   09997000
EROSCAT  EQU   ERTYPE                                                   09998000
ERCATLG  EQU   ERTYPE                                                   09999000
@NM00030 EQU   FMTCNVF+1                                                10000000
FMTAR    EQU   FMTCNVF+1                                                10001000
FMTBS    EQU   FMTCNVF+1                                                10002000
FMTSS    EQU   FMTCNVF+1                                                10003000
FMTAL    EQU   FMTCNVF+1                                                10004000
FMTZS    EQU   FMTCNVF+1                                                10005000
@NM00029 EQU   FMTCNVF                                                  10006000
FMTPU    EQU   FMTCNVF                                                  10007000
FMTBD    EQU   FMTCNVF                                                  10008000
FMTBHD   EQU   FMTCNVF                                                  10009000
FMTBHA   EQU   FMTCNVF                                                  10010000
FMTBH    EQU   FMTCNVF                                                  10011000
FMTOLEN  EQU   FMTLIST+8                                                10012000
FMTRIO   EQU   FMTOCOL                                                  10013000
FMTSPT   EQU   FMTSTO                                                   10014000
FMTSTL   EQU   FMTILEN                                                  10015000
@NM00028 EQU   FMTFLGS+1                                                10016000
FMTSMSG  EQU   FMTFLGS+1                                                10017000
FMTHDF   EQU   FMTFLGS                                                  10018000
FMTDFF   EQU   FMTFLGS                                                  10019000
FMTSTF   EQU   FMTFLGS                                                  10020000
FMTREPF  EQU   FMTFLGS                                                  10021000
FMTBDF   EQU   FMTFLGS                                                  10022000
FMTIDF   EQU   FMTFLGS                                                  10023000
FMTSCF   EQU   FMTFLGS                                                  10024000
FMTEOLF  EQU   FMTFLGS                                                  10025000
DARGPCT  EQU   DARGINL                                                  10026000
DARGREP  EQU   DARGINS                                                  10027000
@NM00027 EQU   DARGLIST+19                                              10028000
DARGIND  EQU   DARGLIST+18                                              10029000
UVOLVOL  EQU   UVOLENT+4                                                10030000
UVOLDEV  EQU   UVOLENT                                                  10031000
UVOLCNT  EQU   UVOLLIST                                                 10032000
@NM00026 EQU   IOINFOPT                                                 10033000
IOINFLUB EQU   IOINFOPT                                                 10034000
IOINFTMS EQU   IOINFOPT                                                 10035000
IOINFSUP EQU   IOINFOPT                                                 10036000
IOINFDSN EQU   IOINFOPT                                                 10037000
IOINFVOL EQU   IOINFOPT                                                 10038000
IOINFDVT EQU   IOINFOPT                                                 10039000
OPNVOL   EQU   OPNAGL+44                                                10040000
OPNSTRNO EQU   OPNAGL+43                                                10041000
@NM00025 EQU   OPNOPT2                                                  10042000
OPNOPTJM EQU   OPNOPT2                                                  10043000
OPNOPTNM EQU   OPNOPT2                                                  10044000
OPNOPTAS EQU   OPNOPT2                                                  10045000
@NM00024 EQU   OPNDSO                                                   10046000
OPNDSOPO EQU   OPNDSO                                                   10047000
OPNDSOIS EQU   OPNDSO                                                   10048000
OPNDSOPS EQU   OPNDSO                                                   10049000
OPNDSOAM EQU   OPNDSO                                                   10050000
OPNKYL   EQU   OPNAGL+40                                                10051000
OPNBLK   EQU   OPNAGL+36                                                10052000
OPNREC   EQU   OPNAGL+32                                                10053000
OPNDEVIX EQU   OPNDEV+4                                                 10054000
OPNDEVDT EQU   OPNDEV                                                   10055000
OPNCBP   EQU   OPNAGL+20                                                10056000
OPNPWA   EQU   OPNAGL+12                                                10057000
OPNMODRP EQU   OPNMOD                                                   10058000
OPNMODUB EQU   OPNMOD                                                   10059000
OPNMODRS EQU   OPNMOD                                                   10060000
OPNMODAX EQU   OPNMOD                                                   10061000
OPNMODRR EQU   OPNMOD                                                   10062000
OPNMODRC EQU   OPNMOD                                                   10063000
OPNMODPD EQU   OPNMOD                                                   10064000
OPNTYPSY EQU   OPNTYP                                                   10065000
OPNTYPRV EQU   OPNTYP                                                   10066000
OPNTYPEX EQU   OPNTYP                                                   10067000
OPNTYPRA EQU   OPNTYP                                                   10068000
OPNTYPXM EQU   OPNTYP                                                   10069000
OPNTYPCI EQU   OPNTYP                                                   10070000
OPNTYPSO EQU   OPNTYP                                                   10071000
OPNTYPSI EQU   OPNTYP                                                   10072000
@NM00023 EQU   OPNRFM                                                   10073000
OPNRFMBK EQU   OPNRFM                                                   10074000
OPNRFMSF EQU   OPNRFM                                                   10075000
OPNRFMUN EQU   OPNRFM                                                   10076000
OPNRFMVR EQU   OPNRFM                                                   10077000
OPNRFMFX EQU   OPNRFM                                                   10078000
OPNOPTSK EQU   OPNOPT                                                   10079000
OPNOPTDR EQU   OPNOPT                                                   10080000
OPNOPTCR EQU   OPNOPT                                                   10081000
OPNOPTKS EQU   OPNOPT                                                   10082000
OPNOPTBK EQU   OPNOPT                                                   10083000
OPNOPTUP EQU   OPNOPT                                                   10084000
OPNOPTIN EQU   OPNOPT                                                   10085000
IOCEXT   EQU   IOCSTR+64                                                10086000
IOCTSML  EQU   IOCREL+2                                                 10087000
IOCTPML  EQU   IOCREL                                                   10088000
IOCWORK  EQU   IOCSTR+56                                                10089000
IOCRRN   EQU   IOCSTR+52                                                10090000
IOCPNM   EQU   IOCNWM+2                                                 10091000
IOCPTL   EQU   IOCNWM                                                   10092000
IOCKYA   EQU   IOCMEM                                                   10093000
IOCVRC   EQU   IOCTTR                                                   10094000
IOCCBP   EQU   IOCSTR+36                                                10095000
IOCDSN   EQU   IOCSTR+32                                                10096000
IOCHURBA EQU   IOCSTR+28                                                10097000
IOCVOLSR EQU   IOCSTR+22                                                10098000
@NM00022 EQU   IOCMSG                                                   10099000
IOCMSGSM EQU   IOCMSG                                                   10100000
IOCMSGAE EQU   IOCMSG                                                   10101000
IOCMSGCE EQU   IOCMSG                                                   10102000
IOCMSGOE EQU   IOCMSG                                                   10103000
IOCMSGOP EQU   IOCMSG                                                   10104000
IOCCHPKG EQU   IOCMSG                                                   10105000
IOCCHPKE EQU   IOCMSG                                                   10106000
IOCCHPNU EQU   IOCCHP                                                   10107000
IOCCHPUP EQU   IOCCHP                                                   10108000
IOCCHPBK EQU   IOCCHP                                                   10109000
IOCCHPCR EQU   IOCCHP                                                   10110000
IOCCHPKS EQU   IOCCHP                                                   10111000
IOCCHPSK EQU   IOCCHP                                                   10112000
IOCCHPDR EQU   IOCCHP                                                   10113000
IOCCHPSQ EQU   IOCCHP                                                   10114000
IOCMACNT EQU   IOCMAC2                                                  10115000
IOCMACER EQU   IOCMAC2                                                  10116000
IOCMACPA EQU   IOCMAC2                                                  10117000
IOCMACEN EQU   IOCMAC2                                                  10118000
IOCMACCP EQU   IOCMAC2                                                  10119000
IOCMACRR EQU   IOCMAC2                                                  10120000
IOCMACAS EQU   IOCMAC2                                                  10121000
IOCMACSK EQU   IOCMAC2                                                  10122000
@NM00021 EQU   IOCMAC                                                   10123000
IOCMACCC EQU   IOCMAC                                                   10124000
IOCMACDR EQU   IOCMAC                                                   10125000
IOCMACBK EQU   IOCMAC                                                   10126000
IOCMACCR EQU   IOCMAC                                                   10127000
IOCMACUP EQU   IOCMAC                                                   10128000
IOCMACOT EQU   IOCMAC                                                   10129000
IOCMACIN EQU   IOCMAC                                                   10130000
@NM00020 EQU   IOCRFM                                                   10131000
IOCRFMBK EQU   IOCRFM                                                   10132000
IOCRFMSF EQU   IOCRFM                                                   10133000
IOCRFMUN EQU   IOCRFM                                                   10134000
IOCRFMVR EQU   IOCRFM                                                   10135000
IOCRFMFX EQU   IOCRFM                                                   10136000
@NM00019 EQU   IOCDSO                                                   10137000
IOCDSOPO EQU   IOCDSO                                                   10138000
IOCDSOIS EQU   IOCDSO                                                   10139000
IOCDSOPS EQU   IOCDSO                                                   10140000
IOCDSOAM EQU   IOCDSO                                                   10141000
IOCRKP   EQU   IOCSTR+13                                                10142000
IOCKYL   EQU   IOCSTR+12                                                10143000
IOCTRN   EQU   IOCSTR+8                                                 10144000
IOCDLN   EQU   IOCSTR+4                                                 10145000
IOCDAD   EQU   IOCSTR                                                   10146000
UNITVTOC EQU   UNITABL+7                                                10147000
@NM00018 EQU   UNITSTAT                                                 10148000
UNITUSHR EQU   UNITSTAT                                                 10149000
UNITXSHR EQU   UNITSTAT                                                 10150000
UNITISHR EQU   UNITSTAT                                                 10151000
UNITUA   EQU   @NM00017+1                                               10152000
UNITCHA  EQU   @NM00017                                                 10153000
UNITUCB  EQU   UNITABL                                                  10154000
RACFVOLS EQU   RACFAGL+16                                               10155000
RACFCLN  EQU   RACFAGL+12                                               10156000
RACFPROF EQU   RACFAGL+8                                                10157000
RACFENT  EQU   RACFAGL+4                                                10158000
@NM00016 EQU   RACFFLG4                                                 10159000
@NM00015 EQU   RACFFLG3                                                 10160000
RACFPRF  EQU   RACFFLG3                                                 10161000
@NM00014 EQU   RACFFLG3                                                 10162000
@NM00013 EQU   RACFFLG2                                                 10163000
RACFTRD  EQU   RACFFLG2                                                 10164000
RACFTUPD EQU   RACFFLG2                                                 10165000
RACFTCTL EQU   RACFFLG2                                                 10166000
@NM00012 EQU   RACFFLG2                                                 10167000
RACFTALT EQU   RACFFLG2                                                 10168000
RACFCSA  EQU   RACFFLG1                                                 10169000
RACFLOGN EQU   RACFFLG1                                                 10170000
RACFLOGF EQU   RACFFLG1                                                 10171000
@NM00011 EQU   RACFFLG1                                                 10172000
RACFDSTV EQU   RACFFLG1                                                 10173000
@NM00010 EQU   RACFFLG1                                                 10174000
ALLUNCNT EQU   ALLAGL+30                                                10175000
ALLVLCNT EQU   ALLAGL+29                                                10176000
@NM00009 EQU   ALLOPT                                                   10177000
ALLOPTUN EQU   ALLOPT                                                   10178000
ALLOPTPV EQU   ALLOPT                                                   10179000
ALLOPTDS EQU   ALLOPT                                                   10180000
ALLOPTVL EQU   ALLOPT                                                   10181000
@NM00008 EQU   ALLORG+1                                                 10182000
ALLORGVS EQU   ALLORG+1                                                 10183000
@NM00007 EQU   ALLORG+1                                                 10184000
ALLORGGS EQU   ALLORG+1                                                 10185000
ALLORGUN EQU   ALLORG                                                   10186000
ALLORGPO EQU   ALLORG                                                   10187000
ALLORGMQ EQU   ALLORG                                                   10188000
ALLORGCQ EQU   ALLORG                                                   10189000
ALLORGCX EQU   ALLORG                                                   10190000
ALLORGDA EQU   ALLORG                                                   10191000
ALLORGPS EQU   ALLORG                                                   10192000
ALLORGIS EQU   ALLORG                                                   10193000
ALLDSPUN EQU   ALLDSP                                                   10194000
ALLDSPCG EQU   ALLDSP                                                   10195000
ALLDSPDE EQU   ALLDSP                                                   10196000
ALLDSPKP EQU   ALLDSP                                                   10197000
@NM00006 EQU   ALLDSP                                                   10198000
ALLSTSOD EQU   ALLSTS                                                   10199000
ALLSTSMD EQU   ALLSTS                                                   10200000
ALLSTSNW EQU   ALLSTS                                                   10201000
ALLSTSSR EQU   ALLSTS                                                   10202000
@NM00005 EQU   ALLSTS                                                   10203000
ALLPWD   EQU   ALLAGL+20                                                10204000
ALLVLP   EQU   ALLAGL+16                                                10205000
ALLULP   EQU   ALLAGL+12                                                10206000
ALLDDN   EQU   ALLAGL+4                                                 10207000
ALLDSN   EQU   ALLAGL                                                   10208000
CIRPID   EQU   CIRAGL+28                                                10209000
CIRPWD   EQU   CIRAGL+24                                                10210000
CIRCAT   EQU   CIRAGL+20                                                10211000
CIRWKP   EQU   CIRAGL+16                                                10212000
CIRTLR   EQU   CIRAGL+12                                                10213000
CIRHDR   EQU   CIRAGL+8                                                 10214000
CIRTLN   EQU   CIRAGL+6                                                 10215000
CIRHLN   EQU   CIRAGL+4                                                 10216000
@NM00004 EQU   CIRAGL+1                                                 10217000
@NM00003 EQU   CIRTYPE                                                  10218000
CIRTYPAQ EQU   CIRTYPE                                                  10219000
CIRTYP1Q EQU   CIRTYPE                                                  10220000
NEWID1   EQU   TRACE1+95                                                10221000
CALLID   EQU   OLDERID1+90                                              10222000
@NM00002 EQU   OLDERID1                                                 10223000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      10224000
@RC01027 EQU   @RC01024                                                 10225000
@RC01043 EQU   @RC01024                                                 10226000
@RF01048 EQU   @RC01024                                                 10227000
@RC01170 EQU   @RC01152                                                 10228000
@RC01388 EQU   @RC01386                                                 10229000
@RF01398 EQU   @RC01394                                                 10230000
@RC01319 EQU   @RC01317                                                 10231000
@RC01414 EQU   @RC01317                                                 10232000
@RF01688 EQU   @RC01674                                                 10233000
@RC01712 EQU   @RC01707                                                 10234000
@RF01726 EQU   @RC01707                                                 10235000
@RF01736 EQU   @RC01731                                                 10236000
@RF01813 EQU   @RC01798                                                 10237000
@PB00026 EQU   @EL00001                                                 10238000
@RF01375 EQU   @RC01319                                                 10239000
@RC01416 EQU   @RC01414                                                 10240000
@RC01422 EQU   @RC01414                                                 10241000
@RC01439 EQU   @RC01414                                                 10242000
@RF01444 EQU   @RC01414                                                 10243000
@RF01717 EQU   @RC01712                                                 10244000
@PB00025 EQU   @PB00026                                                 10245000
@PB00024 EQU   @PB00025                                                 10246000
@PB00023 EQU   @PB00024                                                 10247000
@PB00022 EQU   @PB00023                                                 10248000
@PB00021 EQU   @PB00022                                                 10249000
@PB00020 EQU   @PB00021                                                 10250000
@PB00019 EQU   @PB00020                                                 10251000
@PB00018 EQU   @PB00019                                                 10252000
@PB00017 EQU   @PB00018                                                 10253000
@PB00016 EQU   @PB00017                                                 10254000
@PB00015 EQU   @PB00016                                                 10255000
@PB00014 EQU   @PB00015                                                 10256000
@PB00013 EQU   @PB00014                                                 10257000
@PB00012 EQU   @PB00013                                                 10258000
@PB00011 EQU   @PB00012                                                 10259000
@PB00010 EQU   @PB00011                                                 10260000
@PB00009 EQU   @PB00010                                                 10261000
@PB00008 EQU   @PB00009                                                 10262000
@PB00007 EQU   @PB00008                                                 10263000
@PB00006 EQU   @PB00007                                                 10264000
@PB00005 EQU   @PB00006                                                 10265000
@PB00004 EQU   @PB00005                                                 10266000
@PB00003 EQU   @PB00004                                                 10267000
@PB00002 EQU   @PB00003                                                 10268000
@ENDDATA EQU   *                                                        10269000
         END   IDCLV01,(C'PLS1930',0701,77354)                          10270000
