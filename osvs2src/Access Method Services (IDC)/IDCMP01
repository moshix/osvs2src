         TITLE '*********** IDCMP01:  IMPORT FUNCTION SUPPORT ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCMP01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCMP01   78.177'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         LA    @08,4095(,@09)                                      0002 00025000
         LA    @07,4095(,@08)                                      0002 00026000
         USING @PSTART,@12                                         0002 00027000
         USING @PSTART+4095,@11                                    0002 00028000
         USING @PSTART+8190,@10                                    0002 00029000
         USING @PSTART+12285,@09                                   0002 00030000
         USING @PSTART+16380,@08                                   0002 00031000
         USING @PSTART+20475,@07                                   0002 00032000
         L     @00,@SIZDATD                                        0002 00033000
         GETMAIN  R,LV=(0)                                              00034000
         LR    @06,@01                                             0002 00035000
         USING @DATD,@06                                           0002 00036000
         ST    @13,@SA00001+4                                      0002 00037000
         LM    @00,@01,20(@13)                                     0002 00038000
         ST    @06,8(,@13)                                         0002 00039000
         LR    @13,@06                                             0002 00040000
         MVC   @PC00001(12),0(@01)                                 0002 00041000
*                                      /*MAPPING OF THE PART @Y30SSFR*/ 00042000
*                                      /*OF THE BUFFER TO BE @Y30SSFR*/ 00043000
*                                      /*CLEARED             @Y30SSFR*/ 00044000
*        /************************************************************/ 00045000
*        /*                                                          */ 00046000
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */ 00047000
*        /*   IMPORT ROUTINE.  THIS SECTION DETERMINES WHETHER A     */ 00048000
*        /*   USER CATALOG OR A CLUSTER OBJECT IS TO BE IMPORTED,    */ 00049000
*        /*   AND CALLS THE CORRESPONDING OBJECT PROCESSOR.          */ 00050000
*        /*   TERMINATION PROCESSING IS ALSO HANDLED IN THIS SECTION.*/ 00051000
*        /*                                                          */ 00052000
*        /************************************************************/ 00053000
*                                                                  0351 00054000
*        OLDERID2 = NEWERID2;                                      0351 00055000
         L     @15,@PC00001                                        0351 00056000
         L     @15,GDTTR2(,@15)                                    0351 00057000
         MVC   @TS00001(95),NEWERID2(@15)                          0351 00058000
         MVC   OLDERID2(95,@15),@TS00001                           0351 00059000
*        NEWID2 = 'MPBG';                                          0352 00060000
*                                                                  0352 00061000
         MVC   NEWID2(4,@15),@CC01277                              0352 00062000
*        /************************************************************/ 00063000
*        /*                                                          */ 00064000
*        /*  INITIALIZE FIELDS FOR MESSAGE OUTPUT                    */ 00065000
*        /*                                                          */ 00066000
*        /************************************************************/ 00067000
*                                                                  0353 00068000
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/ 00069000
*        DEALLOC = OFF;                                    /*@YL026UA*/ 00070000
         NI    DEALLOC,B'01111111'                                 0354 00071000
*        UNIQD = OFF;                                      /*@YL026UA*/ 00072000
         NI    UNIQD,B'01111111'                                   0355 00073000
*        UNIQI = OFF;                                      /*@YL026UA*/ 00074000
         NI    UNIQI,B'01111111'                                   0356 00075000
*        DDSTRU = ADDR(PRINTTAB);                                  0357 00076000
         LA    @15,PRINTTAB                                        0357 00077000
         ST    @15,DDSTRU                                          0357 00078000
*        DARGLIST = ''B;                                           0358 00079000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0358 00080000
*        DEFSTID = 0;                                              0359 00081000
         MVI   DEFSTID,X'00'                                       0359 00082000
*        DALCINDX = 0;                                     /*@YL026UA*/ 00083000
         SLR   @14,@14                                             0360 00084000
         ST    @14,DALCINDX                                        0360 00085000
*        DARGSMOD = 'MP0';                                         0361 00086000
*                                                                  0361 00087000
         MVC   DARGSMOD(3,@15),@CC01000                            0361 00088000
*        /************************************************************/ 00089000
*        /*                                                          */ 00090000
*        /*  INITIALIZE POINTERS TO INPUT IOCS AND OUTPUT IOCS,      */ 00091000
*        /*  CATALOG IOCS, PASSWORD, AND ZERO IMPORT FLAGS           */ 00092000
*        /*                                                          */ 00093000
*        /************************************************************/ 00094000
*                                                                  0362 00095000
*        POUTIOCS = NULLPTR;           /* OUTPUT IOCS                */ 00096000
         ST    @14,POUTIOCS                                        0362 00097000
*        PINIOCS = NULLPTR;            /*INPUT IOCS                  */ 00098000
         ST    @14,PINIOCS                                         0363 00099000
*        PTRCTACB = NULLPTR;           /*CATALOG ACB POINTER         */ 00100000
         ST    @14,PTRCTACB                                        0364 00101000
*        PTRCTIOC = NULLPTR;           /*CATALOG IOCS POINTER        */ 00102000
         ST    @14,PTRCTIOC                                        0365 00103000
*        IMPFLG2 = '00'X;              /*IMPORT FLAGS                */ 00104000
         MVI   IMPFLG2,X'00'                                       0366 00105000
*        CPSWD = NULLPTR;              /*CLUSTER PASSWORD POINTER    */ 00106000
         ST    @14,CPSWD                                           0367 00107000
*        CATRCVWK = ''B;               /*ZERO WORK AREA FOR  @Y30SSFR*/ 00108000
         XC    CATRCVWK(10),CATRCVWK                               0368 00109000
*                                      /*RECOVERY VOLSER     @Y30SSFR*/ 00110000
*        RCVLN = LENGTH(CATRCVWK);     /*SET THE LENGTH OF   @Y30SSFR*/ 00111000
         MVC   RCVLN(2),@CH00037                                   0369 00112000
*                                      /*THE RECOVERY WORK   @Y30SSFR*/ 00113000
*                                      /*AREA IN THE FIRST   @Y30SSFR*/ 00114000
*                                      /*TWO BYTES           @Y30SSFR*/ 00115000
*        SETRC = 0;                    /*SET FINAL RETURN    @Y30SSFR*/ 00116000
         STH   @14,SETRC                                           0370 00117000
*                                      /*CODE TO 0           @Y30SSFR*/ 00118000
*                                                                  0371 00119000
*        /************************************************************/ 00120000
*        /*                                                          */ 00121000
*        /* DETERMINE WHETHER A USERCATALOG IS TO BE         @Y30SSFR*/ 00122000
*        /*   IMPORTED -- TEST FOR CONNECT PARAMETER SPECIFIED       */ 00123000
*        /*                                                          */ 00124000
*        /************************************************************/ 00125000
*                                                                  0371 00126000
*        IF ADDR(CON) ^= NULLPTR                                   0371 00127000
*          THEN                                                    0371 00128000
         L     @15,@PC00001+4                                      0371 00129000
         C     @14,FDTPTR+52(,@15)                                 0371 00130000
         BE    @RF00371                                            0371 00131000
*            DO;                                                   0372 00132000
*                                                                  0372 00133000
*            /********************************************************/ 00134000
*            /*                                                      */ 00135000
*            /*  PROCESS CONNECT OF USER CATALOG                     */ 00136000
*            /*                                                      */ 00137000
*            /********************************************************/ 00138000
*                                                                  0373 00139000
*            CALL CNCTPROC;                                        0373 00140000
         BAL   @14,CNCTPROC                                        0373 00141000
*            RESPECIFY RTNREG RSTD;                                0374 00142000
*            TESTRC = RTNREG;                                      0375 00143000
         LR    TESTRC,RTNREG                                       0375 00144000
*            RESPECIFY RTNREG UNRSTD;                              0376 00145000
*            SETRC = TESTRC;                                       0377 00146000
         STH   TESTRC,SETRC                                        0377 00147000
*            END;                                                  0378 00148000
*                                                                  0378 00149000
*          ELSE                                                    0379 00150000
*            DO;                                                   0379 00151000
*                                                                  0379 00152000
         B     @RC00371                                            0379 00153000
@RF00371 DS    0H                                                  0380 00154000
*            /********************************************************/ 00155000
*            /*                                                      */ 00156000
*            /*  PROCESS IMPORTATION OF A CLUSTER OR AN AIX  @Y30SSFR*/ 00157000
*            /*                                                      */ 00158000
*            /********************************************************/ 00159000
*                                                                  0380 00160000
*            CALL CLUSPROC;                                        0380 00161000
         BAL   @14,CLUSPROC                                        0380 00162000
*            RESPECIFY RTNREG RSTD;                                0381 00163000
*            TESTRC = RTNREG;                                      0382 00164000
         LR    TESTRC,RTNREG                                       0382 00165000
*            RESPECIFY RTNREG UNRSTD;                              0383 00166000
*            SETRC = MAX(TESTRC,SETRC);                    /*@Y30SSFR*/ 00167000
         LH    @03,SETRC                                           0384 00168000
         CR    @03,TESTRC                                          0384 00169000
         BNL   *+6                                                      00170000
         LR    @03,TESTRC                                          0384 00171000
         STH   @03,SETRC                                           0384 00172000
*            END;                                                  0385 00173000
*                                                                  0385 00174000
*                                                                  0385 00175000
*        /************************************************************/ 00176000
*        /*                                                          */ 00177000
*        /*   TERMINATION PROCESSING WILL LIST APPROPRIATE ERROR     */ 00178000
*        /*   MESSAGES, AND INDICATE THE FINAL STATUS OF IMPORT      */ 00179000
*        /*   IN LASTCC.                                             */ 00180000
*        /*                                                          */ 00181000
*        /************************************************************/ 00182000
*                                                                  0386 00183000
*        IF GDTDBG = NULLPTR                                       0386 00184000
*          THEN;                                                   0386 00185000
@RC00371 L     @15,@PC00001                                        0386 00186000
         L     @15,GDTDBG(,@15)                                    0386 00187000
         LTR   @15,@15                                             0386 00188000
         BZ    @RT00386                                            0386 00189000
*          ELSE                                                    0388 00190000
*            CALL IDCDB010 (GDTTBL,'MPFN');                        0388 00191000
*                                                                  0388 00192000
         L     @15,@PC00001                                        0388 00193000
         ST    @15,@AL00001                                        0388 00194000
         LA    @14,@CC01283                                        0388 00195000
         ST    @14,@AL00001+4                                      0388 00196000
         MVI   @AL00001+4,X'80'                                    0388 00197000
         L     @15,GDTDBG(,@15)                                    0388 00198000
         LA    @01,@AL00001                                        0388 00199000
         BALR  @14,@15                                             0388 00200000
*        /************************************************************/ 00201000
*        /*                                                          */ 00202000
*        /*  TEST FOR ANY SPECIAL MESSAGES TO BE LISTED - ERROR OR   */ 00203000
*        /*  INFORMATIONAL                                           */ 00204000
*        /*                                                          */ 00205000
*        /************************************************************/ 00206000
*                                                                  0389 00207000
*        IF DEFSTID ^= NORMSTAT                                    0389 00208000
*          THEN                                                    0389 00209000
@RT00386 CLI   DEFSTID,0                                           0389 00210000
         BE    @RF00389                                            0389 00211000
*            DO;                                                   0390 00212000
*            DARGSENT = DEFSTID;                                   0391 00213000
*                                                                  0391 00214000
         L     @15,DDSTRU                                          0391 00215000
         IC    @14,DEFSTID                                         0391 00216000
         STC   @14,DARGSENT(,@15)                                  0391 00217000
*            /********************************************************/ 00218000
*            /*                                                      */ 00219000
*            /*  TEST FOR CATALOG RETURN CODE MESSAGE TO BE LISTED   */ 00220000
*            /*  IF SO, SET POINTER TO RETURN CODE                   */ 00221000
*            /*                                                      */ 00222000
*            /********************************************************/ 00223000
*                                                                  0392 00224000
*            IF DEFSTID = CATLGMSG & DARGSMOD = UNIVMSG            0392 00225000
*              THEN                                                0392 00226000
         CLI   DEFSTID,7                                           0392 00227000
         BNE   @RF00392                                            0392 00228000
         CLC   DARGSMOD(3,@15),@CC01023                            0392 00229000
         BNE   @RF00392                                            0392 00230000
*                DO;                                               0393 00231000
*                DARGDBP = ADDR(CATLGRC);                          0394 00232000
         LA    @14,CATLGRC                                         0394 00233000
         ST    @14,DARGDBP(,@15)                                   0394 00234000
*                DARGILP = LENGTH(CATLGRC);                        0395 00235000
         MVC   DARGILP(2,@15),@CH00156                             0395 00236000
*                END;                                              0396 00237000
*                                                                  0396 00238000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0397 00239000
*                                                                  0397 00240000
@RF00392 L     @15,@PC00001                                        0397 00241000
         ST    @15,@AL00001                                        0397 00242000
         LA    @14,@CF00118                                        0397 00243000
         ST    @14,@AL00001+4                                      0397 00244000
         LA    @14,DDSTRU                                          0397 00245000
         ST    @14,@AL00001+8                                      0397 00246000
         MVI   @AL00001+8,X'80'                                    0397 00247000
         L     @15,GDTPRT(,@15)                                    0397 00248000
         LA    @01,@AL00001                                        0397 00249000
         BALR  @14,@15                                             0397 00250000
*            END;                                                  0398 00251000
*                                                                  0398 00252000
*                                                                  0398 00253000
*        /************************************************************/ 00254000
*        /*                                                          */ 00255000
*        /*  CLOSE ANY OPEN DATA SETS                                */ 00256000
*        /*                                                          */ 00257000
*        /************************************************************/ 00258000
*                                                                  0399 00259000
*        IF POUTIOCS ^= NULLPTR                                    0399 00260000
*          THEN                                                    0399 00261000
@RF00389 L     @15,POUTIOCS                                        0399 00262000
         LTR   @15,@15                                             0399 00263000
         BZ    @RF00399                                            0399 00264000
*            CALL IDCIOCL0 (GDTTBL,POUTIOCS);/*                    0400 00265000
*                                        OUTPUT - THE CLUSTER        */ 00266000
*                                                                  0400 00267000
         L     @15,@PC00001                                        0400 00268000
         ST    @15,@AL00001                                        0400 00269000
         LA    @14,POUTIOCS                                        0400 00270000
         ST    @14,@AL00001+4                                      0400 00271000
         MVI   @AL00001+4,X'80'                                    0400 00272000
         L     @15,GDTCLS(,@15)                                    0400 00273000
         LA    @01,@AL00001                                        0400 00274000
         BALR  @14,@15                                             0400 00275000
*        IF PINIOCS ^= NULLPTR         /*INPUT - PORTABLE DATA SET   */ 00276000
*          THEN                                                    0401 00277000
@RF00399 L     @15,PINIOCS                                         0401 00278000
         LTR   @15,@15                                             0401 00279000
         BZ    @RF00401                                            0401 00280000
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0402 00281000
*                                                                  0402 00282000
         L     @15,@PC00001                                        0402 00283000
         ST    @15,@AL00001                                        0402 00284000
         LA    @14,PINIOCS                                         0402 00285000
         ST    @14,@AL00001+4                                      0402 00286000
         MVI   @AL00001+4,X'80'                                    0402 00287000
         L     @15,GDTCLS(,@15)                                    0402 00288000
         LA    @01,@AL00001                                        0402 00289000
         BALR  @14,@15                                             0402 00290000
*        /************************************************************/ 00291000
*        /*                                                          */ 00292000
*        /*  IF IMPORT FAILED AFTER DEFINE, BUT PRIOR TO COPYING DATA*/ 00293000
*        /*  A FLAG WILL BE SET.  IF SET, DELETE THE DEFINED OBJECT  */ 00294000
*        /*                                                          */ 00295000
*        /************************************************************/ 00296000
*                                                                  0403 00297000
*        IF IMPF2DEL = ON                                          0403 00298000
*          THEN                                                    0403 00299000
@RF00401 TM    IMPF2DEL,B'01000000'                                0403 00300000
         BNO   @RF00403                                            0403 00301000
*            DO;                                                   0404 00302000
*            CTGPLPTR= PTRCPL;                                     0405 00303000
         L     @15,PTRCPL                                          0405 00304000
         ST    @15,CTGPLPTR                                        0405 00305000
*            CTGFVPTR = CTGFVT;                                    0406 00306000
*                                                                  0406 00307000
         L     @15,CTGFVT(,@15)                                    0406 00308000
         ST    @15,CTGFVPTR                                        0406 00309000
*            /********************************************************/ 00310000
*            /*                                                      */ 00311000
*            /*  ISSUE MESSAGE--DELETE ATTEMPTED FOR CLUSTER @Y30SSFR*/ 00312000
*            /*  OR AIX THAT WAS UNSUCCESSFULLY IMPORTED     @Y30SSFR*/ 00313000
*            /*                                                      */ 00314000
*            /********************************************************/ 00315000
*                                                                  0407 00316000
*            DARGSMOD = IMPMSG;                                    0407 00317000
         L     @15,DDSTRU                                          0407 00318000
         MVC   DARGSMOD(3,@15),@CC01000                            0407 00319000
*            DARGSENT = IDELFAIL;                                  0408 00320000
*                                                                  0408 00321000
         MVI   DARGSENT(@15),X'09'                                 0408 00322000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0409 00323000
*                                                                  0409 00324000
*                                                                  0409 00325000
         L     @15,@PC00001                                        0409 00326000
         ST    @15,@AL00001                                        0409 00327000
         LA    @14,@CF00118                                        0409 00328000
         ST    @14,@AL00001+4                                      0409 00329000
         LA    @14,DDSTRU                                          0409 00330000
         ST    @14,@AL00001+8                                      0409 00331000
         MVI   @AL00001+8,X'80'                                    0409 00332000
         L     @15,GDTPRT(,@15)                                    0409 00333000
         LA    @01,@AL00001                                        0409 00334000
         BALR  @14,@15                                             0409 00335000
*            /********************************************************/ 00336000
*            /*                                                      */ 00337000
*            /*  CONSTRUCT CPL FOR DELETE OF CLUSTER OR AIX  @Y30SSFR*/ 00338000
*            /*                                                      */ 00339000
*            /********************************************************/ 00340000
*                                                                  0410 00341000
*            CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);    0410 00342000
*                                                                  0410 00343000
         LA    @15,@CC00807                                        0410 00344000
         ST    @15,@AL00001                                        0410 00345000
         LA    @15,DCPLPTR                                         0410 00346000
         ST    @15,@AL00001+4                                      0410 00347000
         L     @01,CTGPLPTR                                        0410 00348000
         L     @01,CTGFVT(,@01)                                    0410 00349000
         LA    @15,CTGFVENT(,@01)                                  0410 00350000
         ST    @15,@AL00001+8                                      0410 00351000
         LA    @15,NULLPARM                                        0410 00352000
         ST    @15,@AL00001+12                                     0410 00353000
         LA    @15,CPSWD                                           0410 00354000
         ST    @15,@AL00001+16                                     0410 00355000
         LA    @01,@AL00001                                        0410 00356000
         BAL   @14,CPLPROC                                         0410 00357000
*            /********************************************************/ 00358000
*            /*                                                      */ 00359000
*            /*  SET PURGE FLAG IN CPL SO THAT CLUSTER OR    @Y30SSFR*/ 00360000
*            /*  AIX WILL BE DELETED EVEN IF RETENTION       @Y30SSFR*/ 00361000
*            /*  PERIOD NOT EXPIRED.                         @Y30SSFR*/ 00362000
*            /*                                                      */ 00363000
*            /********************************************************/ 00364000
*                                                                  0411 00365000
*            DCPLPTR -> CTGPURG = ON;                              0411 00366000
*                                                                  0411 00367000
         L     @01,DCPLPTR                                         0411 00368000
         OI    CTGPURG(@01),B'00100000'                            0411 00369000
*            /********************************************************/ 00370000
*            /*                                                      */ 00371000
*            /*  INVOKE CATALOG MANAGEMENT TO DELETE CLUSTER         */ 00372000
*            /*                                                      */ 00373000
*            /********************************************************/ 00374000
*                                                                  0412 00375000
*            CALL DELTPROC(DCPLPTR);                       /*@Y30SSFR*/ 00376000
         LA    @15,DCPLPTR                                         0412 00377000
         ST    @15,@AL00001                                        0412 00378000
         LA    @01,@AL00001                                        0412 00379000
         BAL   @14,DELTPROC                                        0412 00380000
*            END;                                                  0413 00381000
*                                                                  0413 00382000
*        /************************************************************/ 00383000
*        /*                                                          */ 00384000
*        /*  IF VSAM CATALOG WAS OPENED BY IMPORT, CLOSE IT          */ 00385000
*        /*                                                          */ 00386000
*        /************************************************************/ 00387000
*                                                                  0414 00388000
*        IF PTRCTIOC ^= NULLPTR                                    0414 00389000
*          THEN                                                    0414 00390000
@RF00403 L     @15,PTRCTIOC                                        0414 00391000
         LTR   @15,@15                                             0414 00392000
         BZ    @RF00414                                            0414 00393000
*            CALL IDCIOCL0 (GDTTBL,PTRCTIOC);                      0415 00394000
*                                                                  0415 00395000
*                                                                  0415 00396000
         L     @15,@PC00001                                        0415 00397000
         ST    @15,@AL00001                                        0415 00398000
         LA    @14,PTRCTIOC                                        0415 00399000
         ST    @14,@AL00001+4                                      0415 00400000
         MVI   @AL00001+4,X'80'                                    0415 00401000
         L     @15,GDTCLS(,@15)                                    0415 00402000
         LA    @01,@AL00001                                        0415 00403000
         BALR  @14,@15                                             0415 00404000
*        /************************************************************/ 00405000
*        /*                                                          */ 00406000
*        /*  ISSUE FINAL COMPLETION MESSAGE INDICATING WHETHER       */ 00407000
*        /*  IMPORT WAS SUCCESSFUL OR NOT.                           */ 00408000
*        /*  SET LASTCC TO INDICATE SUCCESS OR FAILURE TO THE        */ 00409000
*        /*  AMS EXECUTIVE                                           */ 00410000
*        /*                                                          */ 00411000
*        /************************************************************/ 00412000
*                                                                  0416 00413000
*        IF (SETRC > LASTCC00) & (GDTECT ^= NULLPTR)       /*@Y30SSFR*/ 00414000
*          THEN                                            /*@Y30SSFR*/ 00415000
@RF00414 SLR   @15,@15                                             0416 00416000
         CH    @15,SETRC                                           0416 00417000
         BNL   @RF00416                                            0416 00418000
         L     @14,@PC00001                                        0416 00419000
         C     @15,GDTECT(,@14)                                    0416 00420000
         BE    @RF00416                                            0416 00421000
*            DARGSENT = TSOFAIL;       /*IMPORT FAILED       @Y30SSFR*/ 00422000
         L     @01,DDSTRU                                          0417 00423000
         MVI   DARGSENT(@01),X'0F'                                 0417 00424000
*          ELSE                                            /*@Y30SSFR*/ 00425000
*            IF SETRC < LASTCC12                           /*@ZA16093*/ 00426000
*              THEN                                        /*@Y30SSFR*/ 00427000
         B     @RC00416                                            0418 00428000
@RF00416 LH    @15,SETRC                                           0418 00429000
         C     @15,@CF00035                                        0418 00430000
         BNL   @RF00418                                            0418 00431000
*                DARGSENT = IMPTGOOD;  /*IMPORT SUCCESSFUL   @Y30SSFR*/ 00432000
         L     @01,DDSTRU                                          0419 00433000
         MVI   DARGSENT(@01),X'01'                                 0419 00434000
*              ELSE                                        /*@Y30SSFR*/ 00435000
*                DARGSENT = IMPTFAIL;                      /*@Y30SSFR*/ 00436000
*                                                                  0420 00437000
         B     @RC00418                                            0420 00438000
@RF00418 L     @01,DDSTRU                                          0420 00439000
         MVI   DARGSENT(@01),X'03'                                 0420 00440000
*        LASTCC = SETRC;                                   /*@Y30SSFR*/ 00441000
@RC00418 DS    0H                                                  0421 00442000
@RC00416 L     @15,@PC00001+8                                      0421 00443000
         LH    @14,SETRC                                           0421 00444000
         STH   @14,LASTCC(,@15)                                    0421 00445000
*        DARGSMOD = UNIVMSG;                                       0422 00446000
         L     @14,DDSTRU                                          0422 00447000
         MVC   DARGSMOD(3,@14),@CC01023                            0422 00448000
*        DARGDBP = ADDR(LASTCC);                                   0423 00449000
         ST    @15,DARGDBP(,@14)                                   0423 00450000
*        DARGILP = LENGTH(LASTCC);                                 0424 00451000
*                                                                  0424 00452000
         MVC   DARGILP(2,@14),@CH00156                             0424 00453000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0425 00454000
*                                                                  0425 00455000
         L     @15,@PC00001                                        0425 00456000
         ST    @15,@AL00001                                        0425 00457000
         LA    @14,@CF00118                                        0425 00458000
         ST    @14,@AL00001+4                                      0425 00459000
         LA    @14,DDSTRU                                          0425 00460000
         ST    @14,@AL00001+8                                      0425 00461000
         MVI   @AL00001+8,X'80'                                    0425 00462000
         L     @15,GDTPRT(,@15)                                    0425 00463000
         LA    @01,@AL00001                                        0425 00464000
         BALR  @14,@15                                             0425 00465000
*        IF DEALLOC = ON                                           0426 00466000
*          THEN                                                    0426 00467000
         TM    DEALLOC,B'10000000'                                 0426 00468000
         BNO   @RF00426                                            0426 00469000
*            CALL IDCSADL0(GDTTBL,ALLAGL);                 /*@YL026UA*/ 00470000
*                                                                  0427 00471000
         L     @15,@PC00001                                        0427 00472000
         ST    @15,@AL00001                                        0427 00473000
         L     @01,ALLPTR                                          0427 00474000
         ST    @01,@AL00001+4                                      0427 00475000
         MVI   @AL00001+4,X'80'                                    0427 00476000
         L     @15,GDTDLC(,@15)                                    0427 00477000
         LA    @01,@AL00001                                        0427 00478000
         BALR  @14,@15                                             0427 00479000
*        /************************************************************/ 00480000
*        /*                                                          */ 00481000
*        /*  FREE STORAGE OBTAINED BY IMPORT AND RETURN TO THE       */ 00482000
*        /*  AMS EXECUTIVE                                           */ 00483000
*        /*                                                          */ 00484000
*        /************************************************************/ 00485000
*                                                                  0428 00486000
*        CALL IDCSAFP0 (GDTTBL,GPID);                              0428 00487000
*                                                                  0428 00488000
@RF00426 L     @15,@PC00001                                        0428 00489000
         ST    @15,@AL00001                                        0428 00490000
         LA    @14,GPID                                            0428 00491000
         ST    @14,@AL00001+4                                      0428 00492000
         MVI   @AL00001+4,X'80'                                    0428 00493000
         L     @15,GDTFPL(,@15)                                    0428 00494000
         LA    @01,@AL00001                                        0428 00495000
         BALR  @14,@15                                             0428 00496000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0429 00497000
         L     @15,@PC00001                                        0429 00498000
         ST    @15,@AL00001                                        0429 00499000
         LA    @14,MODID                                           0429 00500000
         ST    @14,@AL00001+4                                      0429 00501000
         L     @14,@PC00001+8                                      0429 00502000
         ST    @14,@AL00001+8                                      0429 00503000
         MVI   @AL00001+8,X'80'                                    0429 00504000
         L     @15,GDTEPL(,@15)                                    0429 00505000
         LA    @01,@AL00001                                        0429 00506000
         BALR  @14,@15                                             0429 00507000
*        /************************************************************/ 00508000
*        /*                                                          */ 00509000
*        /*  PROCEDURE NAME - CLUSPROC                               */ 00510000
*        /*                                                          */ 00511000
*        /*  FUNCTION - READ CATALOG AND DATA RECORDS FROM THE       */ 00512000
*        /*  PORTABILITY VOLUME, USE CATALOG INFORMATION FROM THE    */ 00513000
*        /*  FROM CATALOG RECORDS PLUS INFORMATION FROM THE AMS      */ 00514000
*        /*  COMMAND TO PERFORM A CATALOG DEFINE FOR THE     @Y30SSFR*/ 00515000
*        /*  OBJECT, COPY DATA INTO THE DATA SET AFTER SUCCESSFUL    */ 00516000
*        /*  DEFINITION IN THE CATALOG                               */ 00517000
*        /*  CLUSPROC PROCESSES EXPORTED KSDS'S, RRDS'S,     @Y30SSFR*/ 00518000
*        /*  ESDS'S, AND AIX'S AS WELL AS THEIR ASSOCIATED   @Y30SSFR*/ 00519000
*        /*  PATHS.                                          @Y30SSFR*/ 00520000
*        /*                                                          */ 00521000
*        /*  INPUT - FUNCTION DEFINITION TABLE                       */ 00522000
*        /*                                                          */ 00523000
*        /*  OUTPUT- A RECREATED CLUSTER OR AIX              @Y30SSFR*/ 00524000
*        /*                                                          */ 00525000
*        /************************************************************/ 00526000
*CLUSPROC: PROCEDURE;                                              0430 00527000
*                                                                  0430 00528000
@EL00001 L     @13,4(,@13)                                         0430 00529000
@EF00001 L     @00,@SIZDATD                                        0430 00530000
         LR    @01,@06                                             0430 00531000
         FREEMAIN R,LV=(0),A=(1)                                        00532000
@ER00001 LM    @14,@12,12(@13)                                     0430 00533000
         BR    @14                                                 0430 00534000
CLUSPROC STM   @14,@12,@SA00002                                    0430 00535000
*        /************************************************************/ 00536000
*        /*                                                          */ 00537000
*        /*  PERFORM INITIALIZATION                                  */ 00538000
*        /*                                                          */ 00539000
*        /************************************************************/ 00540000
*                                                                  0431 00541000
*        OLDERID2 = NEWERID2;                                      0431 00542000
         L     @15,@PC00001                                        0431 00543000
         L     @15,GDTTR2(,@15)                                    0431 00544000
         MVC   @TS00001(95),NEWERID2(@15)                          0431 00545000
         MVC   OLDERID2(95,@15),@TS00001                           0431 00546000
*        NEWID2 = 'MPCP';                                          0432 00547000
*                                                                  0432 00548000
         MVC   NEWID2(4,@15),@CC01289                              0432 00549000
*        /************************************************************/ 00550000
*        /*                                                  @Y30SSFR*/ 00551000
*        /*  SET AN INITIAL VALUE FOR THE BLOCKSIZE OF THE   @Y30SSFR*/ 00552000
*        /*  PORTABLE DATA SET.                              @Y30SSFR*/ 00553000
*        /*                                                  @Y30SSFR*/ 00554000
*        /************************************************************/ 00555000
*                                                                  0433 00556000
*        BLKSIZ = 2048;                                    /*@Y30SSFR*/ 00557000
*                                                                  0433 00558000
         MVC   BLKSIZ(4),@CF01290                                  0433 00559000
*        DO I = 1 TO CMPNUM;                                       0434 00560000
         LA    I,1                                                 0434 00561000
@DL00434 DS    0H                                                  0435 00562000
*          FVTPTR(I) = NULLPTR;        /*ZERO FVT POINTERS           */ 00563000
         LR    @02,I                                               0435 00564000
         SLA   @02,2                                               0435 00565000
         SLR   @15,@15                                             0435 00566000
         ST    @15,FVTPTR-4(@02)                                   0435 00567000
*        END;                                                      0436 00568000
*                                                                  0436 00569000
         AL    I,@CF00221                                          0436 00570000
         C     I,@CF00165                                          0436 00571000
         BNH   @DL00434                                            0436 00572000
*        PFVTPTR = NULLPTR;            /*ZERO PATH FVT       @Y30SSFR*/ 00573000
         SLR   @15,@15                                             0437 00574000
         ST    @15,PFVTPTR                                         0437 00575000
*                                      /*POINTER             @Y30SSFR*/ 00576000
*        RANGPORT = NULLPTR;           /*KEYRANGE LIST- MODELED      */ 00577000
         ST    @15,RANGPORT                                        0438 00578000
*        RANGINPT = NULLPTR;           /*KEYRANGE LIST- AMS INPUT    */ 00579000
         ST    @15,RANGINPT                                        0439 00580000
*        RESPECIFY IDAAMDSB BASED(DSCCATPT);               /*@Y30SSFR*/ 00581000
*                                                                  0440 00582000
*        /************************************************************/ 00583000
*        /*                                                  @Y30SSFR*/ 00584000
*        /*  INITIALIZE THE EMPTY DATA SET FLAG TO OFF.      @Y30SSFR*/ 00585000
*        /*                                                  @Y30SSFR*/ 00586000
*        /************************************************************/ 00587000
*                                                                  0441 00588000
*        EMPTYDS = OFF;                                    /*@Y30SSFR*/ 00589000
*                                                                  0441 00590000
         NI    EMPTYDS,B'01111111'                                 0441 00591000
*        /************************************************************/ 00592000
*        /*                                                          */ 00593000
*        /*  CHECK THAT THE IN PARAMETER WAS SPECIFIED ON THE        */ 00594000
*        /*  AMS COMMAND. IF NOT, RETURN.                            */ 00595000
*        /*                                                          */ 00596000
*        /************************************************************/ 00597000
*                                                                  0442 00598000
*        IF ADDR(IN) = NULLPTR & ADDR(INDS) = NULLPTR              0442 00599000
*          THEN                                                    0442 00600000
         L     @14,@PC00001+4                                      0442 00601000
         C     @15,FDTPTR(,@14)                                    0442 00602000
         BNE   @RF00442                                            0442 00603000
         C     @15,FDTPTR+92(,@14)                                 0442 00604000
         BNE   @RF00442                                            0442 00605000
*            DO;                                                   0443 00606000
*            DEFSTID = NOINPARM;                                   0444 00607000
         MVI   DEFSTID,X'03'                                       0444 00608000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0445 00609000
         L     @15,@PC00001                                        0445 00610000
         ST    @15,@AL00001                                        0445 00611000
         LA    @14,@CF00118                                        0445 00612000
         ST    @14,@AL00001+4                                      0445 00613000
         LA    @14,DDSTRU                                          0445 00614000
         ST    @14,@AL00001+8                                      0445 00615000
         MVI   @AL00001+8,X'80'                                    0445 00616000
         L     @15,GDTPRT(,@15)                                    0445 00617000
         LA    @01,@AL00001                                        0445 00618000
         BALR  @14,@15                                             0445 00619000
*            RETURN CODE(LASTCC12);                        /*@YL026UA*/ 00620000
         LA    @15,12                                              0446 00621000
         L     @14,@SA00002                                        0446 00622000
         LM    @00,@12,@SA00002+8                                  0446 00623000
         BR    @14                                                 0446 00624000
*            END;                                                  0447 00625000
*                                                                  0447 00626000
*                                                                  0447 00627000
*        /************************************************************/ 00628000
*        /*                                                          */ 00629000
*        /*  CHECK THAT THE OUT PARAMETER WAS SPECIFIED ON THE       */ 00630000
*        /*  AMS COMMAND. IF NOT, RETURN.                            */ 00631000
*        /*                                                          */ 00632000
*        /************************************************************/ 00633000
*                                                                  0448 00634000
*        IF ADDR(OUTDD) = NULLPTR & ADDR(OUTDS) = NULLPTR          0448 00635000
*          THEN                                                    0448 00636000
@RF00442 SLR   @15,@15                                             0448 00637000
         L     @14,@PC00001+4                                      0448 00638000
         C     @15,FDTPTR+4(,@14)                                  0448 00639000
         BNE   @RF00448                                            0448 00640000
         C     @15,FDTPTR+96(,@14)                                 0448 00641000
         BNE   @RF00448                                            0448 00642000
*            DO;                                                   0449 00643000
*            DEFSTID = NOOUPARM;                                   0450 00644000
         MVI   DEFSTID,X'04'                                       0450 00645000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0451 00646000
         L     @15,@PC00001                                        0451 00647000
         ST    @15,@AL00001                                        0451 00648000
         LA    @14,@CF00118                                        0451 00649000
         ST    @14,@AL00001+4                                      0451 00650000
         LA    @14,DDSTRU                                          0451 00651000
         ST    @14,@AL00001+8                                      0451 00652000
         MVI   @AL00001+8,X'80'                                    0451 00653000
         L     @15,GDTPRT(,@15)                                    0451 00654000
         LA    @01,@AL00001                                        0451 00655000
         BALR  @14,@15                                             0451 00656000
*            RETURN CODE(LASTCC12);                        /*@YL026UA*/ 00657000
         LA    @15,12                                              0452 00658000
         L     @14,@SA00002                                        0452 00659000
         LM    @00,@12,@SA00002+8                                  0452 00660000
         BR    @14                                                 0452 00661000
*            END;                                                  0453 00662000
*                                                                  0453 00663000
*           ENTNAM = INDSVAL;                              /*@YL026UA*/ 00664000
@RF00448 L     @15,@PC00001+4                                      0454 00665000
         L     @14,FDTPTR+92(,@15)                                 0454 00666000
         MVC   ENTNAM(44),INDSVAL(@14)                             0454 00667000
*           ENTNLN = INDSLEN;                              /*@YL026UA*/ 00668000
         SLR   @05,@05                                             0455 00669000
         IC    @05,INDSLEN(,@14)                                   0455 00670000
         STH   @05,ENTNLN                                          0455 00671000
*           OUTDSNAM = OUTDSVAL;                           /*@YL026UA*/ 00672000
         L     @15,FDTPTR+96(,@15)                                 0456 00673000
         MVC   OUTDSNAM(44),OUTDSVAL(@15)                          0456 00674000
*           OUTDSNLN = OUTDSLEN;                           /*@YL026UA*/ 00675000
*                                                                  0457 00676000
         SLR   @05,@05                                             0457 00677000
         IC    @05,OUTDSLEN(,@15)                                  0457 00678000
         STH   @05,OUTDSNLN                                        0457 00679000
*        /************************************************************/ 00680000
*        /*                                                  @YL026UA*/ 00681000
*        /*  IF THE ENTRIES ARE NOT FULLY QUALIFIED - ISSUE  @YL026UA*/ 00682000
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIERS       */ 00683000
*        /*                                                  @YL026UA*/ 00684000
*        /************************************************************/ 00685000
*                                                                  0458 00686000
*          IF INDSFUQ = ON & ADDR(INDS) ^= NULLPTR                 0458 00687000
*            THEN                                                  0458 00688000
         TM    INDSFUQ(@14),B'10000000'                            0458 00689000
         BNO   @RF00458                                            0458 00690000
         LTR   @14,@14                                             0458 00691000
         BZ    @RF00458                                            0458 00692000
*              DO;                                         /*@YL026UA*/ 00693000
*                QUALLIST = ''B;                           /*@YL026UA*/ 00694000
         XC    QUALLIST(12),QUALLIST                               0460 00695000
*                QUALADDR = ADDR(ENTNAM);                   /*@YL026UA* 00696000
         LA    @15,ENTNAM                                          0461 00697000
         ST    @15,QUALADDR                                        0461 00698000
*                IF INDSPLN ^= 0                                   0462 00699000
*                  THEN                                            0462 00700000
         CLI   INDSPLN(@14),0                                      0462 00701000
         BE    @RF00462                                            0462 00702000
*                    QUALPAS = ADDR(INDSPAS);              /*@YL026UA*/ 00703000
*                                                                  0463 00704000
         LA    @15,INDSPAS(,@14)                                   0463 00705000
         ST    @15,QUALPAS                                         0463 00706000
*                CALL IDCSAQL0(GDTTBL,QUALADDR,ENTNLN,QUALCAT,QUALPAS); 00707000
@RF00462 L     @03,@PC00001                                        0464 00708000
         ST    @03,@AL00001                                        0464 00709000
         LA    @15,QUALADDR                                        0464 00710000
         ST    @15,@AL00001+4                                      0464 00711000
         LA    @15,ENTNLN                                          0464 00712000
         ST    @15,@AL00001+8                                      0464 00713000
         LA    @15,QUALCAT                                         0464 00714000
         ST    @15,@AL00001+12                                     0464 00715000
         LA    @15,QUALPAS                                         0464 00716000
         ST    @15,@AL00001+16                                     0464 00717000
         MVI   @AL00001+16,X'80'                                   0464 00718000
         L     @15,GDTQAL(,@03)                                    0464 00719000
         LA    @01,@AL00001                                        0464 00720000
         BALR  @14,@15                                             0464 00721000
*                                                          /*@YL026UA*/ 00722000
*                RESPECIFY RTNREG RSTD;                            0465 00723000
*                TESTRC = RTNREG;                                  0466 00724000
         LR    TESTRC,RTNREG                                       0466 00725000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/ 00726000
*                IF TESTRC ^= 0                                    0468 00727000
*                  THEN                                            0468 00728000
         LTR   TESTRC,TESTRC                                       0468 00729000
         BZ    @RF00468                                            0468 00730000
*                    RETURN CODE(LASTCC12);                /*@YL026UA*/ 00731000
         LA    @15,12                                              0469 00732000
         L     @14,@SA00002                                        0469 00733000
         LM    @00,@12,@SA00002+8                                  0469 00734000
         BR    @14                                                 0469 00735000
*              END;                                        /*@YL026UA*/ 00736000
*                                                                  0470 00737000
@RF00468 DS    0H                                                  0471 00738000
*        /************************************************************/ 00739000
*        /*                                                          */ 00740000
*        /*  OPEN INPUT DATA SET - THE PORTABILITY VOLUME AS         */ 00741000
*        /*  SPECIFIED IN THE IN PARAMETER                           */ 00742000
*        /*                                                          */ 00743000
*        /************************************************************/ 00744000
*                                                                  0471 00745000
*        IF ADDR(IN) ^= NULLPTR                            /*@Y30SSFR*/ 00746000
*          THEN                                            /*@Y30SSFR*/ 00747000
@RF00458 L     @15,@PC00001+4                                      0471 00748000
         L     @14,FDTPTR(,@15)                                    0471 00749000
         LTR   @14,@14                                             0471 00750000
         BZ    @RF00471                                            0471 00751000
*            CALL OPENPROC('I',ADDR(INDDVAL),NULLPARM,0,   /*@Y30SSFR*/ 00752000
*              BLKSIZ,ADDR(PINIOCS));                      /*@Y30SSFR*/ 00753000
         LA    @02,@CC00809                                        0472 00754000
         ST    @02,@AL00001                                        0472 00755000
         L     @02,FDTPTR+56(,@15)                                 0472 00756000
         LA    @02,INDDVAL(,@02)                                   0472 00757000
         ST    @02,@AFTEMPS                                        0472 00758000
         LA    @02,@AFTEMPS                                        0472 00759000
         ST    @02,@AL00001+4                                      0472 00760000
         LA    @02,NULLPARM                                        0472 00761000
         ST    @02,@AL00001+8                                      0472 00762000
         LA    @02,@CF00118                                        0472 00763000
         ST    @02,@AL00001+12                                     0472 00764000
         LA    @02,BLKSIZ                                          0472 00765000
         ST    @02,@AL00001+16                                     0472 00766000
         LA    @02,PINIOCS                                         0472 00767000
         ST    @02,@AFTEMPS+4                                      0472 00768000
         LA    @02,@AFTEMPS+4                                      0472 00769000
         ST    @02,@AL00001+20                                     0472 00770000
         LA    @01,@AL00001                                        0472 00771000
         BAL   @14,OPENPROC                                        0472 00772000
*          ELSE                                            /*@Y30SSFR*/ 00773000
*            CALL OPENPROC('I',NULLPARM,ADDR(INDSVAL),0,   /*@Y30SSFR*/ 00774000
*              BLKSIZ,ADDR(PINIOCS));                      /*@Y30SSFR*/ 00775000
*                                                                  0473 00776000
         B     @RC00471                                            0473 00777000
@RF00471 LA    @02,@CC00809                                        0473 00778000
         ST    @02,@AL00001                                        0473 00779000
         LA    @02,NULLPARM                                        0473 00780000
         ST    @02,@AL00001+4                                      0473 00781000
         L     @02,@PC00001+4                                      0473 00782000
         L     @02,FDTPTR+92(,@02)                                 0473 00783000
         LA    @02,INDSVAL(,@02)                                   0473 00784000
         ST    @02,@AFTEMPS                                        0473 00785000
         LA    @02,@AFTEMPS                                        0473 00786000
         ST    @02,@AL00001+8                                      0473 00787000
         LA    @02,@CF00118                                        0473 00788000
         ST    @02,@AL00001+12                                     0473 00789000
         LA    @02,BLKSIZ                                          0473 00790000
         ST    @02,@AL00001+16                                     0473 00791000
         LA    @02,PINIOCS                                         0473 00792000
         ST    @02,@AFTEMPS+4                                      0473 00793000
         LA    @02,@AFTEMPS+4                                      0473 00794000
         ST    @02,@AL00001+20                                     0473 00795000
         LA    @01,@AL00001                                        0473 00796000
         BAL   @14,OPENPROC                                        0473 00797000
*        /************************************************************/ 00798000
*        /*                                                          */ 00799000
*        /*  TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL         */ 00800000
*        /*  RETURN TO CALLING PROCESSOR                             */ 00801000
*        /*                                                          */ 00802000
*        /************************************************************/ 00803000
*                                                                  0474 00804000
*        RESPECIFY RTNREG RSTD;                                    0474 00805000
@RC00471 DS    0H                                                  0475 00806000
*        TESTRC = RTNREG;                                          0475 00807000
         LR    TESTRC,RTNREG                                       0475 00808000
*        RESPECIFY RTNREG UNRSTD;                                  0476 00809000
*        IF TESTRC ^= 0                                            0477 00810000
*          THEN                                                    0477 00811000
         LTR   TESTRC,TESTRC                                       0477 00812000
         BZ    @RF00477                                            0477 00813000
*            DO;                                                   0478 00814000
*            DEFSTID = ERROPENP;                                   0479 00815000
         MVI   DEFSTID,X'0E'                                       0479 00816000
*            RETURN CODE(LASTCC12);                                0480 00817000
         LA    @15,12                                              0480 00818000
         L     @14,@SA00002                                        0480 00819000
         LM    @00,@12,@SA00002+8                                  0480 00820000
         BR    @14                                                 0480 00821000
*            END;                                                  0481 00822000
*                                                                  0481 00823000
*        /***********************************************************/  00824000
*        /*                                                          */ 00825000
*        /*  PROCESS THE TIME STAMP RECORD WHICH IS THE FIRST        */ 00826000
*        /*  RECORD ON THE PORTABILITY VOLUME  THIS RECORD GIVES     */ 00827000
*        /*  THE TIME AND DATE THE DATA SET WAS EXPORTED.            */ 00828000
*        /*                                                          */ 00829000
*        /************************************************************/ 00830000
*                                                                  0482 00831000
*        /************************************************************/ 00832000
*        /*                                                          */ 00833000
*        /*  READ THE TIME STAMP RECORD FROM THE PORTABLE DATA SET   */ 00834000
*        /*                                                          */ 00835000
*        /************************************************************/ 00836000
*                                                                  0482 00837000
*        IOCSPTR = PINIOCS;                                        0482 00838000
*                                                                  0482 00839000
@RF00477 L     @03,PINIOCS                                         0482 00840000
         ST    @03,IOCSPTR                                         0482 00841000
*        CALL IDCIOGT0 (GDTTBL,IOCSPTR);                           0483 00842000
*                                                                  0483 00843000
         L     @03,@PC00001                                        0483 00844000
         ST    @03,@AL00001                                        0483 00845000
         LA    @15,IOCSPTR                                         0483 00846000
         ST    @15,@AL00001+4                                      0483 00847000
         MVI   @AL00001+4,X'80'                                    0483 00848000
         L     @15,GDTGET(,@03)                                    0483 00849000
         LA    @01,@AL00001                                        0483 00850000
         BALR  @14,@15                                             0483 00851000
*        RESPECIFY RTNREG RSTD;                                    0484 00852000
*        TESTRC = RTNREG;                                          0485 00853000
         LR    TESTRC,RTNREG                                       0485 00854000
*        RESPECIFY RTNREG UNRSTD;                                  0486 00855000
*        IF TESTRC ^= 0                                            0487 00856000
*          THEN                                                    0487 00857000
         LTR   TESTRC,TESTRC                                       0487 00858000
         BZ    @RF00487                                            0487 00859000
*            /********************************************************/ 00860000
*            /*                                                      */ 00861000
*            /*  COULD NOT READ RECORD FROM PORTABILITY VOLUME.      */ 00862000
*            /*  INDICATE ERROR  AND RETURN TO CALLING PROCESSOR     */ 00863000
*            /*                                                      */ 00864000
*            /********************************************************/ 00865000
*                                                                  0488 00866000
*            RETURN CODE(LASTCC12);                                0488 00867000
*                                                                  0488 00868000
         LA    @15,12                                              0488 00869000
         L     @14,@SA00002                                        0488 00870000
         LM    @00,@12,@SA00002+8                                  0488 00871000
         BR    @14                                                 0488 00872000
*        /************************************************************/ 00873000
*        /*                                                          */ 00874000
*        /*  SAVE INFORMATION PASSED BY EXPORT GIVING NUMBER OF      */ 00875000
*        /*  COMPONENTS IN CLUSTER AND FLAG BYTE INDICATING          */ 00876000
*        /*  WHETHER INHIBITTARGET WAS SPECIFIED AT EXPORT TIME      */ 00877000
*        /*                                                          */ 00878000
*        /************************************************************/ 00879000
*                                                                  0489 00880000
*        CONRCPTR = IOCDAD;                                        0489 00881000
*                                                                  0489 00882000
@RF00487 L     @01,IOCSPTR                                         0489 00883000
         L     @15,IOCDAD(,@01)                                    0489 00884000
         ST    @15,CONRCPTR                                        0489 00885000
*        /************************************************************/ 00886000
*        /*                                                          */ 00887000
*        /*  CHECK TO SEE THAT THIS IS A PORTABLE DATA SET -         */ 00888000
*        /*  CHECK FOR TIME STAMP FLAGS SET IN FIRST RECORD.         */ 00889000
*        /*  IF FLAGS INCORRECT, RETURN WITH ERROR                   */ 00890000
*        /*                                                          */ 00891000
*        /************************************************************/ 00892000
*                                                                  0490 00893000
*        IF HEADFLG1 ^= HDFL1CAT | HEADFLG2 ^=HDFL2TSP     /*@Y30SSFR*/ 00894000
*          THEN                                                    0490 00895000
         CLI   HEADFLG1(@15),X'FF'                                 0490 00896000
         BNE   @RT00490                                            0490 00897000
         CLI   HEADFLG2(@15),X'FF'                                 0490 00898000
         BE    @RF00490                                            0490 00899000
@RT00490 DS    0H                                                  0491 00900000
*            DO;                                                   0491 00901000
*            DEFSTID = PORTERR;                                    0492 00902000
         MVI   DEFSTID,X'01'                                       0492 00903000
*            RETURN CODE(LASTCC12);                                0493 00904000
         LA    @15,12                                              0493 00905000
         L     @14,@SA00002                                        0493 00906000
         LM    @00,@12,@SA00002+8                                  0493 00907000
         BR    @14                                                 0493 00908000
*            END;                                                  0494 00909000
*                                                                  0494 00910000
*        NUMOBJ = TEXOJCT;                                         0495 00911000
@RF00490 LA    @15,8                                               0495 00912000
         AL    @15,CONRCPTR                                        0495 00913000
         SLR   @14,@14                                             0495 00914000
         IC    @14,TEXOJCT(,@15)                                   0495 00915000
         STH   @14,NUMOBJ                                          0495 00916000
*        IMPFLG = TEXFLG;                                          0496 00917000
*                                                                  0496 00918000
         MVC   IMPFLG(1),TEXFLG(@15)                               0496 00919000
*        /************************************************************/ 00920000
*        /*                                                  @Y30SSFR*/ 00921000
*        /*  COMPUTE HOW MANY OBJECTS THERE ARE TO BE        @Y30SSFR*/ 00922000
*        /*  IMPORTED EXCLUSIVE OF PATHS AND SET THE         @Y30SSFR*/ 00923000
*        /*  KSDSFLAG ACCORDINGLY.                           @Y30SSFR*/ 00924000
*        /*                                                  @Y30SSFR*/ 00925000
*        /************************************************************/ 00926000
*                                                                  0497 00927000
*        IF IMPASSOC = OFF                                 /*@Y30SSFR*/ 00928000
*          THEN                                            /*@Y30SSFR*/ 00929000
*                                                                  0497 00930000
         TM    IMPASSOC,B'00100000'                                0497 00931000
         BNZ   @RF00497                                            0497 00932000
*            /********************************************************/ 00933000
*            /*                                              @Y30SSFR*/ 00934000
*            /*  THERE ARE NO PATH ASSOCIATIONS PRESENT.     @Y30SSFR*/ 00935000
*            /*  THE NUMBER OF COMPONENTS IS EQUAL TO        @Y30SSFR*/ 00936000
*            /*  THE NUMBER OF OBJECTS PRESENT IN THE        @Y30SSFR*/ 00937000
*            /*  PORTABILITY DATA SET.                       @Y30SSFR*/ 00938000
*            /*                                              @Y30SSFR*/ 00939000
*            /********************************************************/ 00940000
*                                                                  0498 00941000
*            NUMCOMP = NUMOBJ;                             /*@Y30SSFR*/ 00942000
*                                                                  0498 00943000
         STH   @14,NUMCOMP                                         0498 00944000
*          ELSE                                            /*@Y30SSFR*/ 00945000
*                                                                  0499 00946000
*            /********************************************************/ 00947000
*            /*                                              @Y30SSFR*/ 00948000
*            /*  THERE ARE PATH ASSOCIATIONS PRESENT.  USE   @Y30SSFR*/ 00949000
*            /*  THE IMPBASE BIT TO DETERMINE IF AN INDEX    @Y30SSFR*/ 00950000
*            /*  COMPONENT HAS BEEN EXPORTED.                @Y30SSFR*/ 00951000
*            /*                                              @Y30SSFR*/ 00952000
*            /********************************************************/ 00953000
*                                                                  0499 00954000
*            IF IMPBASE = ON                               /*@Y30SSFR*/ 00955000
*              THEN                                        /*@Y30SSFR*/ 00956000
*                                                                  0499 00957000
         B     @RC00497                                            0499 00958000
@RF00497 TM    IMPBASE,B'00010000'                                 0499 00959000
         BNO   @RF00499                                            0499 00960000
*                /****************************************************/ 00961000
*                /*                                          @Y30SSFR*/ 00962000
*                /*  THERE IS AN INDEX COMPONENT ON THE      @Y30SSFR*/ 00963000
*                /*  PORTABILITY DATA SET.  SET THE VALUE    @Y30SSFR*/ 00964000
*                /*  OF NUMCOMP TO BE THREE.                 @Y30SSFR*/ 00965000
*                /*                                          @Y30SSFR*/ 00966000
*                /****************************************************/ 00967000
*                                                                  0500 00968000
*                NUMCOMP = 3;                              /*@Y30SSFR*/ 00969000
*                                                                  0500 00970000
         MVC   NUMCOMP(2),@CH00165                                 0500 00971000
*              ELSE                                                0501 00972000
*                                                                  0501 00973000
*                /****************************************************/ 00974000
*                /*                                          @Y30SSFR*/ 00975000
*                /*  IMPBASE IS OFF, INDICATING THAT THERE   @Y30SSFR*/ 00976000
*                /*  IS NO INDEX COMPONENT.  SET NUMCOMP TO  @Y30SSFR*/ 00977000
*                /*  BE TWO.                                 @Y30SSFR*/ 00978000
*                /*                                          @Y30SSFR*/ 00979000
*                /****************************************************/ 00980000
*                                                                  0501 00981000
*                NUMCOMP = 2;                              /*@Y30SSFR*/ 00982000
*                                                                  0501 00983000
         B     @RC00499                                            0501 00984000
@RF00499 MVC   NUMCOMP(2),@CH00156                                 0501 00985000
*        /************************************************************/ 00986000
*        /*                                                  @Y30SSFR*/ 00987000
*        /*  IF NUMCOMP IS 3, WE ARE IMPORTING A KSDS, SO    @Y30SSFR*/ 00988000
*        /*  THE KSDSFLAG IS SET TO ON.  OTHERWISE           @Y30SSFR*/ 00989000
*        /*  THE OBJECT BEING IMPORTED IS NOT A KSDS, AND    @Y30SSFR*/ 00990000
*        /*  THE KSDSFLAG MUST BE SET TO OFF.                @Y30SSFR*/ 00991000
*        /*                                                  @Y30SSFR*/ 00992000
*        /************************************************************/ 00993000
*                                                                  0502 00994000
*        IF NUMCOMP = 3                                    /*@Y30SSFR*/ 00995000
*          THEN                                            /*@Y30SSFR*/ 00996000
@RC00499 DS    0H                                                  0502 00997000
@RC00497 CLC   NUMCOMP(2),@CH00165                                 0502 00998000
         BNE   @RF00502                                            0502 00999000
*            KSDSFLAG = ON;                                /*@Y30SSFR*/ 01000000
         OI    KSDSFLAG,B'10000000'                                0503 01001000
*          ELSE                                            /*@Y30SSFR*/ 01002000
*            KSDSFLAG = OFF;                               /*@Y30SSFR*/ 01003000
*                                                                  0504 01004000
*                                                                  0504 01005000
         B     @RC00502                                            0504 01006000
@RF00502 NI    KSDSFLAG,B'01111111'                                0504 01007000
*        /************************************************************/ 01008000
*        /*                                                          */ 01009000
*        /*  LIST EXPORT TIME STAMP INFORMATION USING TEXT PROCESSOR */ 01010000
*        /*  INTERFACE                                               */ 01011000
*        /*                                                          */ 01012000
*        /************************************************************/ 01013000
*                                                                  0505 01014000
*        DARGCNT = 2;                                              0505 01015000
@RC00502 LA    @15,2                                               0505 01016000
         L     @14,DDSTRU                                          0505 01017000
         STH   @15,DARGCNT(,@14)                                   0505 01018000
*        DARGINS(1) = 1;                                           0506 01019000
         MVC   DARGINS(2,@14),@CH00221                             0506 01020000
*        DARGINL(1) = LENGTH(TIMEDATE);                            0507 01021000
         LA    @05,8                                               0507 01022000
         STH   @05,DARGINL(,@14)                                   0507 01023000
*        DARGDTM(1) = ADDR(TIMEDATE);                              0508 01024000
         L     @04,CONRCPTR                                        0508 01025000
         ALR   @04,@05                                             0508 01026000
         LA    @03,TIMEDATE(,@04)                                  0508 01027000
         ST    @03,DARGDTM(,@14)                                   0508 01028000
*        DARGINS(2) = 2;                                           0509 01029000
         STH   @15,DARGINS+8(,@14)                                 0509 01030000
*        DARGINL(2) = LENGTH(TIMEODAY);                            0510 01031000
         STH   @05,DARGINL+8(,@14)                                 0510 01032000
*        DARGDTM(2) = ADDR(TIMEODAY);                              0511 01033000
         LA    @15,TIMEODAY(,@04)                                  0511 01034000
         ST    @15,DARGDTM+8(,@14)                                 0511 01035000
*        CALL MSGPROC(TIMEMSG);                                    0512 01036000
*                                                                  0512 01037000
         LA    @01,@AL00512                                        0512 01038000
         BAL   @14,MSGPROC                                         0512 01039000
*        /************************************************************/ 01040000
*        /*                                                          */ 01041000
*        /*  SET ADDRESS OF  CONTROL RECORD BUFFER WHICH WILL        */ 01042000
*        /*  CONTAIN DICTIONARY FOR CATALOG RECORDS                  */ 01043000
*        /*                                                          */ 01044000
*        /************************************************************/ 01045000
*                                                                  0513 01046000
*        CONRCPTR = ADDR(CONRCARE);                                0513 01047000
*                                                                  0513 01048000
         LA    @15,CONRCARE                                        0513 01049000
         ST    @15,CONRCPTR                                        0513 01050000
*        /************************************************************/ 01051000
*        /*                                                  @Y30SSFR*/ 01052000
*        /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORD @Y30SSFR*/ 01053000
*        /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR @Y30SSFR*/ 01054000
*        /*  AND ZCNTRL.                                     @Y30SSFR*/ 01055000
*        /*                                                  @Y30SSFR*/ 01056000
*        /************************************************************/ 01057000
*                                                                  0514 01058000
*        ZSIZE = LENGTH(CONRCARE);                         /*@Y30SSFR*/ 01059000
         LA    ZSIZE,268                                           0514 01060000
*        ZPTR = CONRCPTR;                                  /*@Y30SSFR*/ 01061000
         LR    ZPTR,@15                                            0515 01062000
*        ZCNTRL = ON;                                      /*@Y30SSFR*/ 01063000
*                                                                  0516 01064000
         OI    ZCNTRL,B'10000000'                                  0516 01065000
*        /************************************************************/ 01066000
*        /*                                                  @Y30SSFR*/ 01067000
*        /*  LOOP CLEARING OUT THE BUFFER FOR THE CONTROL    @Y30SSFR*/ 01068000
*        /*  RECORD.                                         @Y30SSFR*/ 01069000
*        /*                                                  @Y30SSFR*/ 01070000
*        /************************************************************/ 01071000
*                                                                  0517 01072000
*        DO WHILE (ZCNTRL = ON);                           /*@Y30SSFR*/ 01073000
         B     @DE00517                                            0517 01074000
@DL00517 DS    0H                                                  0518 01075000
*          IF ZSIZE > 256                                  /*@Y30SSFR*/ 01076000
*            THEN                                          /*@Y30SSFR*/ 01077000
         LA    @15,256                                             0518 01078000
         CR    ZSIZE,@15                                           0518 01079000
         BNH   @RF00518                                            0518 01080000
*              DO;                                         /*@Y30SSFR*/ 01081000
*              ZAREA(1:256) = ZER(1:256);                  /*@Y30SSFR*/ 01082000
         MVC   ZAREA(256,ZPTR),ZER                                 0520 01083000
*              ZSIZE = ZSIZE - 256;                        /*@Y30SSFR*/ 01084000
         SLR   ZSIZE,@15                                           0521 01085000
*              ZPTR = ZPTR + 256;                          /*@Y30SSFR*/ 01086000
         ALR   ZPTR,@15                                            0522 01087000
*              END;                                        /*@Y30SSFR*/ 01088000
*            ELSE                                          /*@Y30SSFR*/ 01089000
*              DO;                                         /*@Y30SSFR*/ 01090000
         B     @RC00518                                            0524 01091000
@RF00518 DS    0H                                                  0525 01092000
*              ZAREA(1:ZSIZE) = ZER(1:ZSIZE);              /*@Y30SSFR*/ 01093000
         LR    @15,ZSIZE                                           0525 01094000
         BCTR  @15,0                                               0525 01095000
         EX    @15,@SM01687                                        0525 01096000
*              ZCNTRL = OFF;                               /*@Y30SSFR*/ 01097000
         NI    ZCNTRL,B'01111111'                                  0526 01098000
*              END;                                        /*@Y30SSFR*/ 01099000
*        END;                                              /*@Y30SSFR*/ 01100000
*                                                                  0528 01101000
@RC00518 DS    0H                                                  0528 01102000
@DE00517 TM    ZCNTRL,B'10000000'                                  0528 01103000
         BO    @DL00517                                            0528 01104000
*        /************************************************************/ 01105000
*        /*                                                          */ 01106000
*        /*  PROCESS CATALOG INFORMATION FROM THE PORTABILITY VOLUME */ 01107000
*        /*                                                          */ 01108000
*        /************************************************************/ 01109000
*                                                                  0529 01110000
*        OLDERID2 = NEWERID2;                                      0529 01111000
         L     @15,@PC00001                                        0529 01112000
         L     @15,GDTTR2(,@15)                                    0529 01113000
         MVC   @TS00001(95),NEWERID2(@15)                          0529 01114000
         MVC   OLDERID2(95,@15),@TS00001                           0529 01115000
*        NEWID2 = 'MPCT';                                          0530 01116000
*                                                                  0530 01117000
         MVC   NEWID2(4,@15),@CC01294                              0530 01118000
*        /************************************************************/ 01119000
*        /*                                                          */ 01120000
*        /*  CONSTRUCT THE CPL TO BE EMPLOYED FOR THE DEFINE         */ 01121000
*        /*  FUNCTION.  IF NOT CONSTRUCTED SUCCESSFULLY, RETURN TO   */ 01122000
*        /*  THE CALLING PROCESSOR WITH AN ERROR INDICATOR           */ 01123000
*        /*                                                          */ 01124000
*        /************************************************************/ 01125000
*                                                                  0531 01126000
*        CALL CPLPROC('F',PTRCPL,NULLPARM,NULLPARM,NULLPARM);      0531 01127000
         MVC   @AL00001(20),@AL00531                               0531 01128000
         LA    @15,PTRCPL                                          0531 01129000
         ST    @15,@AL00001+4                                      0531 01130000
         LA    @01,@AL00001                                        0531 01131000
         BAL   @14,CPLPROC                                         0531 01132000
*        RESPECIFY RTNREG RSTD;                                    0532 01133000
*        TESTRC = RTNREG;                                          0533 01134000
         LR    TESTRC,RTNREG                                       0533 01135000
*        RESPECIFY RTNREG UNRSTD;                                  0534 01136000
*        IF TESTRC ^= 0                                            0535 01137000
*          THEN                                                    0535 01138000
         LTR   TESTRC,TESTRC                                       0535 01139000
         BZ    @RF00535                                            0535 01140000
*            RETURN CODE(LASTCC12);                                0536 01141000
         LA    @15,12                                              0536 01142000
         L     @14,@SA00002                                        0536 01143000
         LM    @00,@12,@SA00002+8                                  0536 01144000
         BR    @14                                                 0536 01145000
*        CTGPLPTR = PTRCPL;                                        0537 01146000
*                                                                  0537 01147000
*                                                                  0537 01148000
@RF00535 L     @15,PTRCPL                                          0537 01149000
         ST    @15,CTGPLPTR                                        0537 01150000
*CATLOOP:  DO I = 1 TO NUMCOMP;                            /*@Y30SSFR*/ 01151000
*                                                                  0538 01152000
CATLOOP  LA    I,1                                                 0538 01153000
         B     @DE00538                                            0538 01154000
@DL00538 DS    0H                                                  0539 01155000
*        /************************************************************/ 01156000
*        /*                                                          */ 01157000
*        /*  READ CONTROL RECORD FROM PORTABLE DATA SET, CONTAINING  */ 01158000
*        /*  DICTIONARY FOR CATALOG INFORMATION.                     */ 01159000
*        /*  IF UNSUCCESSFUL, RETURN TO CALLING PROCESSOR.           */ 01160000
*        /*                                                          */ 01161000
*        /************************************************************/ 01162000
*                                                                  0539 01163000
*        CALL IDCIOGT0 (GDTTBL,PINIOCS);                           0539 01164000
*                                                                  0539 01165000
         L     @15,@PC00001                                        0539 01166000
         ST    @15,@AL00001                                        0539 01167000
         LA    @14,PINIOCS                                         0539 01168000
         ST    @14,@AL00001+4                                      0539 01169000
         MVI   @AL00001+4,X'80'                                    0539 01170000
         L     @15,GDTGET(,@15)                                    0539 01171000
         LA    @01,@AL00001                                        0539 01172000
         BALR  @14,@15                                             0539 01173000
*        RESPECIFY RTNREG RSTD;                                    0540 01174000
*        TESTRC = RTNREG;                                          0541 01175000
         LR    TESTRC,RTNREG                                       0541 01176000
*        RESPECIFY RTNREG UNRSTD;                                  0542 01177000
*        IF TESTRC ^= 0                                            0543 01178000
*          THEN                                                    0543 01179000
         LTR   TESTRC,TESTRC                                       0543 01180000
         BZ    @RF00543                                            0543 01181000
*            RETURN CODE(LASTCC12);                                0544 01182000
*                                                                  0544 01183000
         LA    @15,12                                              0544 01184000
         L     @14,@SA00002                                        0544 01185000
         LM    @00,@12,@SA00002+8                                  0544 01186000
         BR    @14                                                 0544 01187000
*        /************************************************************/ 01188000
*        /*                                                          */ 01189000
*        /*  MOVE CONTROL RECORD JUST READ INTO BUFFER               */ 01190000
*        /*                                                          */ 01191000
*        /************************************************************/ 01192000
*                                                                  0545 01193000
*        TFVTLEN = IOCDAD -> HEADLN;                               0545 01194000
*                                                                  0545 01195000
@RF00543 L     @02,IOCSPTR                                         0545 01196000
         L     @01,IOCDAD(,@02)                                    0545 01197000
         LH    @15,HEADLN(,@01)                                    0545 01198000
         STH   @15,TFVTLEN                                         0545 01199000
*        CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                   0546 01200000
*                                                                  0546 01201000
         LA    @15,TFVTLEN                                         0546 01202000
         ST    @15,@AL00001                                        0546 01203000
         ST    @02,@AL00001+4                                      0546 01204000
         LA    @02,CONRCPTR                                        0546 01205000
         ST    @02,@AL00001+8                                      0546 01206000
         LA    @01,@AL00001                                        0546 01207000
         BAL   @14,MVDAPROC                                        0546 01208000
*        IF HEADFLG1 = HDFL1CAT                                    0547 01209000
*          THEN                                                    0547 01210000
         L     @02,CONRCPTR                                        0547 01211000
         CLI   HEADFLG1(@02),X'FF'                                 0547 01212000
         BNE   @RF00547                                            0547 01213000
*            DO;                                                   0548 01214000
*                                                                  0548 01215000
*            /********************************************************/ 01216000
*            /*                                                      */ 01217000
*            /*  GET A BUFFER FOR THE NEXT RECORD WHICH WILL BE      */ 01218000
*            /*  A DATA RECORD CONTAINING CATALOG LOCATE WORK AREA   */ 01219000
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */ 01220000
*            /*  THE CALLING PROCEDURE                               */ 01221000
*            /*                                                      */ 01222000
*            /********************************************************/ 01223000
*                                                                  0549 01224000
*                                                                  0549 01225000
*            TOTLEN = ASSRECLN;                                    0549 01226000
*                                                                  0549 01227000
         L     @15,CONRCPTR                                        0549 01228000
         LH    @15,ASSRECLN(,@15)                                  0549 01229000
         ST    @15,TOTLEN                                          0549 01230000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,WORKAR(I),GPID,SETZERO); 0550 01231000
*                                                                  0550 01232000
         L     @15,@PC00001                                        0550 01233000
         ST    @15,@AL00001                                        0550 01234000
         LA    @14,TOTLEN                                          0550 01235000
         ST    @14,@AL00001+4                                      0550 01236000
         LR    @14,I                                               0550 01237000
         SLA   @14,2                                               0550 01238000
         LA    @14,WORKAR-4(@14)                                   0550 01239000
         ST    @14,@AL00001+8                                      0550 01240000
         LA    @14,GPID                                            0550 01241000
         ST    @14,@AL00001+12                                     0550 01242000
         LA    @14,SETZERO                                         0550 01243000
         ST    @14,@AL00001+16                                     0550 01244000
         MVI   @AL00001+16,X'80'                                   0550 01245000
         L     @15,GDTGPL(,@15)                                    0550 01246000
         LA    @01,@AL00001                                        0550 01247000
         BALR  @14,@15                                             0550 01248000
*            RESPECIFY RTNREG RSTD;                                0551 01249000
*            TESTRC = RTNREG;                                      0552 01250000
         LR    TESTRC,RTNREG                                       0552 01251000
*            RESPECIFY RTNREG UNRSTD;                              0553 01252000
*            IF TESTRC ^= 0                                        0554 01253000
*              THEN                                                0554 01254000
         LTR   TESTRC,TESTRC                                       0554 01255000
         BZ    @RF00554                                            0554 01256000
*                DO;                                               0555 01257000
*                DEFSTID = NOSTORAG;                               0556 01258000
         MVI   DEFSTID,X'04'                                       0556 01259000
*                DARGSMOD = UNIVMSG;                               0557 01260000
         L     @01,DDSTRU                                          0557 01261000
         MVC   DARGSMOD(3,@01),@CC01023                            0557 01262000
*                RETURN CODE(LASTCC12);                            0558 01263000
         LA    @15,12                                              0558 01264000
         L     @14,@SA00002                                        0558 01265000
         LM    @00,@12,@SA00002+8                                  0558 01266000
         BR    @14                                                 0558 01267000
*                END;                                              0559 01268000
*                                                                  0559 01269000
*            /********************************************************/ 01270000
*            /*                                                      */ 01271000
*            /*  NOW READ A DATA RECORD WHICH WILL CONTAIN THE       */ 01272000
*            /*  CATALOG FIELD INFORMATION WHICH IS REFERENCED BY    */ 01273000
*            /*  THE DICTIONARY CONTAINED IN THE CONTROL RECORD      */ 01274000
*            /*  IF AN ERROR IS ENCOUNTERED, RETURN TO CALLING       */ 01275000
*            /*  PROCESSOR                                           */ 01276000
*            /*                                                      */ 01277000
*            /********************************************************/ 01278000
*                                                                  0560 01279000
*            CALL GETPROC(WORKAR(I),ASSRECLN);                     0560 01280000
*                                                                  0560 01281000
@RF00554 LR    @02,I                                               0560 01282000
         SLA   @02,2                                               0560 01283000
         LA    @02,WORKAR-4(@02)                                   0560 01284000
         ST    @02,@AL00001                                        0560 01285000
         L     @02,CONRCPTR                                        0560 01286000
         LA    @02,ASSRECLN(,@02)                                  0560 01287000
         ST    @02,@AL00001+4                                      0560 01288000
         LA    @01,@AL00001                                        0560 01289000
         BAL   @14,GETPROC                                         0560 01290000
*            RESPECIFY RTNREG RSTD;                                0561 01291000
*            TESTRC = RTNREG;                                      0562 01292000
         LR    TESTRC,RTNREG                                       0562 01293000
*            RESPECIFY RTNREG UNRSTD;                              0563 01294000
*            IF TESTRC ^= 0                                        0564 01295000
*              THEN                                                0564 01296000
         LTR   TESTRC,TESTRC                                       0564 01297000
         BZ    @RF00564                                            0564 01298000
*                RETURN CODE(LASTCC12);                            0565 01299000
*                                                                  0565 01300000
         LA    @15,12                                              0565 01301000
         L     @14,@SA00002                                        0565 01302000
         LM    @00,@12,@SA00002+8                                  0565 01303000
         BR    @14                                                 0565 01304000
*            /********************************************************/ 01305000
*            /*                                                      */ 01306000
*            /*  BUILD AN FVT TO CORRESPOND TO THIS RECORD OF        */ 01307000
*            /*  CATALOG INFORMATION.  FVTPROC WILL GET CORE         */ 01308000
*            /*  AND BUILD FPLS FROM INFORMATION IN THE DICTIONARY   */ 01309000
*            /*  AND WORK AREA.                                      */ 01310000
*            /*  IF AN ERROR IS ENCOUNTERED, RETURN TO CALLING       */ 01311000
*            /*  PROCESSOR                                           */ 01312000
*            /*                                                      */ 01313000
*            /********************************************************/ 01314000
*                                                                  0566 01315000
*            DICTPTR = ADDR(VARDATA);                              0566 01316000
*                                                                  0566 01317000
@RF00564 L     @02,CONRCPTR                                        0566 01318000
         LA    @02,VARDATA(,@02)                                   0566 01319000
         ST    @02,DICTPTR                                         0566 01320000
*            CALL FVTPROC(DICTPTR,WORKAR(I),FVTPTR(I));            0567 01321000
*                                                                  0567 01322000
         LA    @02,DICTPTR                                         0567 01323000
         ST    @02,@AL00001                                        0567 01324000
         LR    @02,I                                               0567 01325000
         SLA   @02,2                                               0567 01326000
         LA    @15,WORKAR-4(@02)                                   0567 01327000
         ST    @15,@AL00001+4                                      0567 01328000
         LA    @02,FVTPTR-4(@02)                                   0567 01329000
         ST    @02,@AL00001+8                                      0567 01330000
         LA    @01,@AL00001                                        0567 01331000
         BAL   @14,FVTPROC                                         0567 01332000
*            RESPECIFY RTNREG RSTD;                                0568 01333000
*            TESTRC = RTNREG;                                      0569 01334000
         LR    TESTRC,RTNREG                                       0569 01335000
*            RESPECIFY RTNREG UNRSTD;                              0570 01336000
*            IF TESTRC ^= 0                                        0571 01337000
*              THEN                                                0571 01338000
         LTR   TESTRC,TESTRC                                       0571 01339000
         BZ    @RF00571                                            0571 01340000
*                RETURN CODE(LASTCC12);                            0572 01341000
*                                                                  0572 01342000
         LA    @15,12                                              0572 01343000
         L     @14,@SA00002                                        0572 01344000
         LM    @00,@12,@SA00002+8                                  0572 01345000
         BR    @14                                                 0572 01346000
*            /********************************************************/ 01347000
*            /*                                                      */ 01348000
*            /*  PLACE THE FVT POINTER IN   PROPER FIELD.THE CLUSTER */ 01349000
*            /*  FVT POINTER WILL BE PLACED IN THE CPL.  THE DATA OR */ 01350000
*            /*  INDEX OBJECT FVT POINTERS WILL BE PLACED IN CLUSTER */ 01351000
*            /*  OR AIX FVT.                                 @Y30SSFR*/ 01352000
*            /*                                                      */ 01353000
*            /********************************************************/ 01354000
*                                                                  0573 01355000
*            RESPECIFY CTGFV BASED(CTGFVPTR);                      0573 01356000
@RF00571 DS    0H                                                  0574 01357000
*            CTGFVPTR = FVTPTR(I);                                 0574 01358000
         LR    @02,I                                               0574 01359000
         SLA   @02,2                                               0574 01360000
         L     @02,FVTPTR-4(@02)                                   0574 01361000
         ST    @02,CTGFVPTR                                        0574 01362000
*            IF CTGFVTYP = CTGTCL | CTGFVTYP = CTGTAIX     /*@Y30SSFR*/ 01363000
*              THEN                                                0575 01364000
         CLI   CTGFVTYP(@02),C'C'                                  0575 01365000
         BE    @RT00575                                            0575 01366000
         CLI   CTGFVTYP(@02),C'G'                                  0575 01367000
         BNE   @RF00575                                            0575 01368000
@RT00575 DS    0H                                                  0576 01369000
*                DO;                                               0576 01370000
*                CTGFVT = FVTPTR(I);                               0577 01371000
*                                                                  0577 01372000
         LR    @02,I                                               0577 01373000
         SLA   @02,2                                               0577 01374000
         L     @02,FVTPTR-4(@02)                                   0577 01375000
         L     @01,CTGPLPTR                                        0577 01376000
         ST    @02,CTGFVT(,@01)                                    0577 01377000
*                /****************************************************/ 01378000
*                /*                                                  */ 01379000
*                /*  SET POINTER TO MASTER PASSWORD FOR CLUSTER IF   */ 01380000
*                /*  PROTECTION INFORMATION EXISTS.                  */ 01381000
*                /*                                                  */ 01382000
*                /****************************************************/ 01383000
*                                                                  0578 01384000
*                IF CTGFVSTY ^= NULLPTR                            0578 01385000
*                  THEN                                            0578 01386000
         L     @02,CTGFVPTR                                        0578 01387000
         L     @02,CTGFVSTY(,@02)                                  0578 01388000
         LTR   @02,@02                                             0578 01389000
         BZ    @RF00578                                            0578 01390000
*                    CPSWD = CTGFVSTY -> CTGFLPT(1);               0579 01391000
*                                                                  0579 01392000
         L     @02,CTGFLPT(,@02)                                   0579 01393000
         ST    @02,CPSWD                                           0579 01394000
*                END;                                              0580 01395000
*              ELSE                                                0581 01396000
*                DO;                                               0581 01397000
         B     @RC00575                                            0581 01398000
@RF00575 DS    0H                                                  0582 01399000
*                IF CTGFVTYP = CTGTDATA                            0582 01400000
*                  THEN                                            0582 01401000
         L     @02,CTGFVPTR                                        0582 01402000
         CLI   CTGFVTYP(@02),C'D'                                  0582 01403000
         BNE   @RF00582                                            0582 01404000
*                    DO;                                           0583 01405000
*                    CTGFVPTR = CTGFVT;                            0584 01406000
         L     @02,CTGPLPTR                                        0584 01407000
         L     @02,CTGFVT(,@02)                                    0584 01408000
         ST    @02,CTGFVPTR                                        0584 01409000
*                    CTGFVDCH = FVTPTR(I);                         0585 01410000
         LR    @15,I                                               0585 01411000
         SLA   @15,2                                               0585 01412000
         L     @15,FVTPTR-4(@15)                                   0585 01413000
         ST    @15,CTGFVDCH(,@02)                                  0585 01414000
*                    END;                                          0586 01415000
*                  ELSE                                            0587 01416000
*                    DO;                                           0587 01417000
         B     @RC00582                                            0587 01418000
@RF00582 DS    0H                                                  0588 01419000
*                    CTGFVPTR = CTGFVT;                            0588 01420000
         L     @02,CTGPLPTR                                        0588 01421000
         L     @02,CTGFVT(,@02)                                    0588 01422000
         ST    @02,CTGFVPTR                                        0588 01423000
*                    CTGFVICH = FVTPTR(I);                         0589 01424000
         LR    @15,I                                               0589 01425000
         SLA   @15,2                                               0589 01426000
         L     @15,FVTPTR-4(@15)                                   0589 01427000
         ST    @15,CTGFVICH(,@02)                                  0589 01428000
*                    END;                                          0590 01429000
*                END;                                              0591 01430000
@RC00582 DS    0H                                                  0592 01431000
*        END;                                                      0592 01432000
@RC00575 DS    0H                                                  0593 01433000
*        END CATLOOP;                                      /*@Y30SSFR*/ 01434000
*                                                                  0593 01435000
@RF00547 AL    I,@CF00221                                          0593 01436000
@DE00538 CH    I,NUMCOMP                                           0593 01437000
         BNH   @DL00538                                            0593 01438000
*        /************************************************************/ 01439000
*        /*                                                          */ 01440000
*        /*  IF A DATA SET WAS A UNIQUE DATA SET (HAVING ITS OWN     */ 01441000
*        /*  DATA SPACE) PRIOR TO EXPORT, IT WILL AGAIN BE DEFINED   */ 01442000
*        /*  AS A UNIQUE DATA SET.    IUNIQPRC WILL DETERMINE IF THE */ 01443000
*        /*  DATA SET WAS UNIQUE AND IF SO, CONSTRUCT THE NULL SPACE */ 01444000
*        /*  FVT REQUIRED FOR DEFINE                                 */ 01445000
*        /*  IF IUNIQPRC DOES NOT COMPLETE SUCCESSFULLY, CONTROL     */ 01446000
*        /*  WILL BE RETURNED TO THE CALLING PROCESSOR               */ 01447000
*        /*                                                          */ 01448000
*        /************************************************************/ 01449000
*                                                                  0594 01450000
*        CALL IUNIQPRC;                                            0594 01451000
*                                                                  0594 01452000
         BAL   @14,IUNIQPRC                                        0594 01453000
*        RESPECIFY RTNREG RSTD;                                    0595 01454000
*        TESTRC = RTNREG;                                          0596 01455000
         LR    TESTRC,RTNREG                                       0596 01456000
*        RESPECIFY RTNREG UNRSTD;                                  0597 01457000
*        IF TESTRC ^= 0                                            0598 01458000
*          THEN                                                    0598 01459000
         LTR   TESTRC,TESTRC                                       0598 01460000
         BZ    @RF00598                                            0598 01461000
*            RETURN CODE(LASTCC12);                                0599 01462000
         LA    @15,12                                              0599 01463000
         L     @14,@SA00002                                        0599 01464000
         LM    @00,@12,@SA00002+8                                  0599 01465000
         BR    @14                                                 0599 01466000
*        /************************************************************/ 01467000
*        /*                                                          */ 01468000
*        /*  MODIFY FVT'S WITH INFORMATION FROM THE AMS COMMAND      */ 01469000
*        /*  PARAMETER - OBJECT.  THE ENTRYNAME MAY BE MODIFIED VIA  */ 01470000
*        /*  THE NEWNAME PARAMETER. LISTVOLS AND DNAME  ARE          */ 01471000
*        /*  CONSTRUCTED FROM INFORMATION IN THE AMS COMMAND.        */ 01472000
*        /*  PROCESS FVTS IN THE CLUSTER, DATA AND INDEX ORDER.      */ 01473000
*        /*                                                          */ 01474000
*        /************************************************************/ 01475000
*                                                                  0600 01476000
*        CTGFVPTR = CTGFVT;                                        0600 01477000
*                                                                  0600 01478000
@RF00598 L     @01,CTGPLPTR                                        0600 01479000
         L     @15,CTGFVT(,@01)                                    0600 01480000
         ST    @15,CTGFVPTR                                        0600 01481000
*        /************************************************************/ 01482000
*        /*                                                          */ 01483000
*        /*  MATCH OBJECT PARAMETER WITH CORRECT FVT BY MATCHING     */ 01484000
*        /*  ENTRYNAME FROM ENTNAME FPL WITH OBJECTNAME              */ 01485000
*        /*                                                          */ 01486000
*        /************************************************************/ 01487000
*                                                                  0601 01488000
*        IF ADDR(OBJTS) ^= NULLPTR                                 0601 01489000
*          THEN                                                    0601 01490000
         L     @15,@PC00001+4                                      0601 01491000
         L     @15,FDTPTR+8(,@15)                                  0601 01492000
         LTR   @15,@15                                             0601 01493000
         BZ    @RF00601                                            0601 01494000
*OBJCTLP:  DO FX = 1 TO NUMCOMP;                                   0602 01495000
OBJCTLP  LA    FX,1                                                0602 01496000
         B     @DE00602                                            0602 01497000
@DL00602 DS    0H                                                  0603 01498000
*            CTGFVPTR = FVTPTR(FX);                                0603 01499000
         LR    @02,FX                                              0603 01500000
         SLA   @02,2                                               0603 01501000
         L     @02,FVTPTR-4(@02)                                   0603 01502000
         ST    @02,CTGFVPTR                                        0603 01503000
*OBJENTLP:   DO IX = 1 TO OBJTSCNT;                        /*@OZ32365*/ 01504000
*                                                                  0604 01505000
OBJENTLP LA    @02,1                                               0604 01506000
         B     @DE00604                                            0604 01507000
@DL00604 DS    0H                                                  0605 01508000
*              /******************************************************/ 01509000
*              /*                                                    */ 01510000
*              /*  IF A MATCH IS FOUND BETWEEN THE FVT AND THE       */ 01511000
*              /*  NAME IN THE OBJECTS PARAMETER, PROCESS THE        */ 01512000
*              /*  INPUT INFORMATION SPECIFIED FOR THAT OBJECT.      */ 01513000
*              /*                                                    */ 01514000
*              /******************************************************/ 01515000
*                                                                  0605 01516000
*              IF OBJNMPTR(IX)->OBJNMVAL(1:44) = FENTNAME(1:44)    0605 01517000
*                THEN                                              0605 01518000
         SLA   @02,2                                               0605 01519000
         L     @15,@PC00001+4                                      0605 01520000
         L     @01,FDTPTR+12(,@15)                                 0605 01521000
         AL    @01,@CF01689                                        0605 01522000
         L     @02,OBJNMPTR(@02,@01)                               0605 01523000
         L     @01,CTGFVPTR                                        0605 01524000
         L     @01,CTGFVENT(,@01)                                  0605 01525000
         CLC   OBJNMVAL(44,@02),FENTNAME(@01)                      0605 01526000
         BNE   @RF00605                                            0605 01527000
*OBJMATCH:         DO;                                             0606 01528000
OBJMATCH DS    0H                                                  0607 01529000
*                  IMPF2OBJ = ON;                                  0607 01530000
*                                                                  0607 01531000
         OI    IMPF2OBJ,B'00100000'                                0607 01532000
*              /******************************************************/ 01533000
*              /*                                                    */ 01534000
*              /*       PROCESS  THE FILE PARAMETER                  */ 01535000
*              /*                                                    */ 01536000
*              /******************************************************/ 01537000
*                                                                  0608 01538000
*                IF OBJFLPTR(IX) ^= NULLPTR                        0608 01539000
*                  THEN CTGFVIND=ADDR(OBJFLPTR(IX) -> OBJFLVAL);   0608 01540000
*                                                                  0608 01541000
         L     @02,IX                                              0608 01542000
         SLA   @02,2                                               0608 01543000
         L     @15,@PC00001+4                                      0608 01544000
         L     @01,FDTPTR+20(,@15)                                 0608 01545000
         AL    @01,@CF01689                                        0608 01546000
         L     @02,OBJFLPTR(@02,@01)                               0608 01547000
         LTR   @02,@02                                             0608 01548000
         BZ    @RF00608                                            0608 01549000
         LA    @02,OBJFLVAL(,@02)                                  0609 01550000
         L     @01,CTGFVPTR                                        0609 01551000
         ST    @02,CTGFVIND(,@01)                                  0609 01552000
*                  /**************************************************/ 01553000
*                  /*                                                */ 01554000
*                  /*  IF THE NEWNAME PARAMETER HAS BEEN SPECIFIED,  */ 01555000
*                  /*  SET A POINTER TO THE CHANGED NAME IN THE      */ 01556000
*                  /*  ENTNAME FPL                                   */ 01557000
*                  /*                                                */ 01558000
*                  /**************************************************/ 01559000
*                                                                  0610 01560000
*                  IF NEWNMPTR(IX) ^= NULLPTR                      0610 01561000
*                    THEN                                          0610 01562000
@RF00608 L     @02,IX                                              0610 01563000
         SLA   @02,2                                               0610 01564000
         L     @15,@PC00001+4                                      0610 01565000
         L     @01,FDTPTR+16(,@15)                                 0610 01566000
         AL    @01,@CF01689                                        0610 01567000
         L     @02,NEWNMPTR(@02,@01)                               0610 01568000
         LTR   @02,@02                                             0610 01569000
         BZ    @RF00610                                            0610 01570000
*                      CTGFVENT = ADDR(NEWNMPTR(IX)->      /*@Y30SSFR*/ 01571000
*                                  NEWNMVAL);              /*@Y30SSFR*/ 01572000
*                                                                  0611 01573000
         LA    @02,NEWNMVAL(,@02)                                  0611 01574000
         L     @01,CTGFVPTR                                        0611 01575000
         ST    @02,CTGFVENT(,@01)                                  0611 01576000
*                  /**************************************************/ 01577000
*                  /*                                                */ 01578000
*                  /*  PROCESS THE ORDERED OPTION                    */ 01579000
*                  /*                                                */ 01580000
*                  /**************************************************/ 01581000
*                                                                  0612 01582000
*                  IF ORDPTR(IX) ^= NULLPTR                /*@Y30SSFR*/ 01583000
*                    THEN                                          0612 01584000
*                                                                  0612 01585000
@RF00610 SLR   @02,@02                                             0612 01586000
         L     @15,IX                                              0612 01587000
         SLA   @15,2                                               0612 01588000
         L     @14,@PC00001+4                                      0612 01589000
         L     @01,FDTPTR+36(,@14)                                 0612 01590000
         AL    @01,@CF01689                                        0612 01591000
         C     @02,ORDPTR(@15,@01)                                 0612 01592000
         BE    @RF00612                                            0612 01593000
*                      /**********************************************/ 01594000
*                      /*                                            */ 01595000
*                      /*  IF ORDERED WAS SPECIFIED AT THE CLUSTER   */ 01596000
*                      /*  LEVEL, SET THE ORDERED ATTRIBUTE AT THE   */ 01597000
*                      /*  DATA AND INDEX LEVEL(IF EXISTANT).        */ 01598000
*                      /*                                            */ 01599000
*                      /**********************************************/ 01600000
*                                                                  0613 01601000
*                      IF FX = 1                           /*@Y30SSFR*/ 01602000
*                        THEN                                      0613 01603000
         C     FX,@CF00221                                         0613 01604000
         BNE   @RF00613                                            0613 01605000
*                          DO;                                     0614 01606000
*                          CTGFLPTR = FVTPTR(2) -> CTGFVAMD;       0615 01607000
         L     @01,FVTPTR+4                                        0615 01608000
         L     CTGFLPTR,CTGFVAMD(,@01)                             0615 01609000
*                          CTGFLPT(1) -> AMDORDER = ON;            0616 01610000
         L     @05,CTGFLPT(,CTGFLPTR)                              0616 01611000
         OI    AMDORDER(@05),B'00001000'                           0616 01612000
*                          IF FVTPTR(3) ^= NULLPTR                 0617 01613000
*                            THEN                                  0617 01614000
         L     @15,FVTPTR+8                                        0617 01615000
         CR    @15,@02                                             0617 01616000
         BE    @RF00617                                            0617 01617000
*                              DO;                                 0618 01618000
*                              CTGFLPTR = FVTPTR(3) -> CTGFVAMD;   0619 01619000
         L     CTGFLPTR,CTGFVAMD(,@15)                             0619 01620000
*                              CTGFLPT(1) -> AMDORDER = ON;        0620 01621000
         L     @05,CTGFLPT(,CTGFLPTR)                              0620 01622000
         OI    AMDORDER(@05),B'00001000'                           0620 01623000
*                              END;                                0621 01624000
*                          END;                                    0622 01625000
*                        ELSE                                      0623 01626000
*                                                                  0623 01627000
*                          /******************************************/ 01628000
*                          /*                                        */ 01629000
*                          /*  IF ORDERED WAS SPECIFIED AT THE DATA  */ 01630000
*                          /*  OR INDEX LEVEL, SET THE ORDERED       */ 01631000
*                          /*  ATTRIBUTE ONLY AT THAT LEVEL          */ 01632000
*                          /*                                        */ 01633000
*                          /******************************************/ 01634000
*                                                                  0623 01635000
*                          DO;                                     0623 01636000
         B     @RC00613                                            0623 01637000
@RF00613 DS    0H                                                  0624 01638000
*                          CTGFLPTR = CTGFVAMD;                    0624 01639000
         L     @02,CTGFVPTR                                        0624 01640000
         L     CTGFLPTR,CTGFVAMD(,@02)                             0624 01641000
*                          CTGFLPT(1) -> AMDORDER = ON;            0625 01642000
         L     @05,CTGFLPT(,CTGFLPTR)                              0625 01643000
         OI    AMDORDER(@05),B'00001000'                           0625 01644000
*                          END;                                    0626 01645000
*                                                                  0626 01646000
*                  /**************************************************/ 01647000
*                  /*                                                */ 01648000
*                  /*  PROCESS THE UNORDERED OPTION                  */ 01649000
*                  /*                                                */ 01650000
*                  /**************************************************/ 01651000
*                                                                  0627 01652000
*                  IF UNORDPTR(IX) ^= NULLPTR                      0627 01653000
*                    THEN                                          0627 01654000
*                                                                  0627 01655000
@RC00613 DS    0H                                                  0627 01656000
@RF00612 SLR   @02,@02                                             0627 01657000
         L     @15,IX                                              0627 01658000
         SLA   @15,2                                               0627 01659000
         L     @14,@PC00001+4                                      0627 01660000
         L     @01,FDTPTR+40(,@14)                                 0627 01661000
         AL    @01,@CF01689                                        0627 01662000
         C     @02,UNORDPTR(@15,@01)                               0627 01663000
         BE    @RF00627                                            0627 01664000
*                      /**********************************************/ 01665000
*                      /*                                            */ 01666000
*                      /*  IF UNORDERED WAS SPECIFIED AT THE CLUSTER */ 01667000
*                      /*  LEVEL, SET THE UNORDERED ATTRIBUTE AT THE */ 01668000
*                      /*  DATA AND INDEX LEVEL(IF EXISTANT).        */ 01669000
*                      /*                                            */ 01670000
*                      /**********************************************/ 01671000
*                                                                  0628 01672000
*                      IF FX = 1                           /*@Y30SSFR*/ 01673000
*                        THEN                                      0628 01674000
         C     FX,@CF00221                                         0628 01675000
         BNE   @RF00628                                            0628 01676000
*                          DO;                                     0629 01677000
*                          CTGFLPTR = FVTPTR(2) -> CTGFVAMD;       0630 01678000
         L     @01,FVTPTR+4                                        0630 01679000
         L     CTGFLPTR,CTGFVAMD(,@01)                             0630 01680000
*                          CTGFLPT(1) -> AMDORDER = OFF;           0631 01681000
         L     @05,CTGFLPT(,CTGFLPTR)                              0631 01682000
         NI    AMDORDER(@05),B'11110111'                           0631 01683000
*                          IF FVTPTR(3) ^= NULLPTR                 0632 01684000
*                            THEN                                  0632 01685000
         L     @15,FVTPTR+8                                        0632 01686000
         CR    @15,@02                                             0632 01687000
         BE    @RF00632                                            0632 01688000
*                              DO;                                 0633 01689000
*                              CTGFLPTR = FVTPTR(3) -> CTGFVAMD;   0634 01690000
         L     CTGFLPTR,CTGFVAMD(,@15)                             0634 01691000
*                              CTGFLPT(1) -> AMDORDER = OFF;       0635 01692000
         L     @05,CTGFLPT(,CTGFLPTR)                              0635 01693000
         NI    AMDORDER(@05),B'11110111'                           0635 01694000
*                              END;                                0636 01695000
*                          END;                                    0637 01696000
*                        ELSE                                      0638 01697000
*                                                                  0638 01698000
*                          /******************************************/ 01699000
*                          /*                                        */ 01700000
*                          /*  IF UNORDERED WAS SPECIFIED AT THE DATA*/ 01701000
*                          /*  OR INDEX LEVEL, SET THE ORDERED       */ 01702000
*                          /*  ATTRIBUTE ONLY AT THAT LEVEL          */ 01703000
*                          /*                                        */ 01704000
*                          /******************************************/ 01705000
*                                                                  0638 01706000
*                          DO;                                     0638 01707000
         B     @RC00628                                            0638 01708000
@RF00628 DS    0H                                                  0639 01709000
*                          CTGFLPTR = CTGFVAMD;                    0639 01710000
         L     @02,CTGFVPTR                                        0639 01711000
         L     CTGFLPTR,CTGFVAMD(,@02)                             0639 01712000
*                          CTGFLPT(1) -> AMDORDER = OFF;           0640 01713000
         L     @05,CTGFLPT(,CTGFLPTR)                              0640 01714000
         NI    AMDORDER(@05),B'11110111'                           0640 01715000
*                          END;                                    0641 01716000
*                                                                  0641 01717000
*                  /**************************************************/ 01718000
*                  /*                                                */ 01719000
*                  /*  CALL LVLRPROC TO CONSTRUCT THE LIST OF VOLUME */ 01720000
*                  /*  SERIAL NUMBERS IF VOLUMES SPECIFIED IN THE    */ 01721000
*                  /*  AMS COMMAND FOR THIS OBJECT                   */ 01722000
*                  /*                                                */ 01723000
*                  /**************************************************/ 01724000
*                                                                  0642 01725000
*                  IF LISTVPTR(IX) ^= NULLPTR                      0642 01726000
*                    THEN                                          0642 01727000
@RC00628 DS    0H                                                  0642 01728000
@RF00627 SLR   @02,@02                                             0642 01729000
         L     @15,IX                                              0642 01730000
         SLA   @15,2                                               0642 01731000
         L     @14,@PC00001+4                                      0642 01732000
         L     @01,FDTPTR+24(,@14)                                 0642 01733000
         AL    @01,@CF01689                                        0642 01734000
         C     @02,LISTVPTR(@15,@01)                               0642 01735000
         BE    @RF00642                                            0642 01736000
*                      DO;                                         0643 01737000
*                                                                  0643 01738000
*                      /**********************************************/ 01739000
*                      /*                                            */ 01740000
*                      /*  IF VOLUMES IS SPECIFIED AT THE CLUSTER    */ 01741000
*                      /*  LEVEL, REMOVE THE DATA AND IF APPLICABLE  */ 01742000
*                      /*  INDEX FVT VOLUME LIST POINTERS(S).  THIS  */ 01743000
*                      /*  WILL ALLOW PROPAGATION OF THE CLUSTER      / 01744000
*                      /*  LEVEL VOLUME LIST.  IF VOLUMES IS NOT     */ 01745000
*                      /*  SPECIFIED ATH THE DATA/INDEX LEVEL(S).    */ 01746000
*                      /*                                            */ 01747000
*                      /**********************************************/ 01748000
*                                                                  0644 01749000
*                      IF FX = 1                           /*@OZ32365*/ 01750000
*                        THEN                              /*@OZ32365*/ 01751000
         C     FX,@CF00221                                         0644 01752000
         BNE   @RF00644                                            0644 01753000
*                          DO;                             /*@OZ32365*/ 01754000
*                          FVTPTR(2)->CTGFVVLT = NULLPTR;  /*@OZ32365*/ 01755000
         L     @01,FVTPTR+4                                        0646 01756000
         ST    @02,CTGFVVLT(,@01)                                  0646 01757000
*                          IF FVTPTR(3) ^= NULLPTR         /*@OZ32365*/ 01758000
*                            THEN                          /*@OZ32365*/ 01759000
         L     @15,FVTPTR+8                                        0647 01760000
         CR    @15,@02                                             0647 01761000
         BE    @RF00647                                            0647 01762000
*                              FVTPTR(3)->CTGFVVLT=NULLPTR;/*@OZ32365*/ 01763000
         ST    @02,CTGFVVLT(,@15)                                  0648 01764000
*                            ELSE;                         /*@OZ32365*/ 01765000
@RF00647 DS    0H                                                  0650 01766000
*                          END;                            /*@OZ32365*/ 01767000
*                        ELSE;                             /*@OZ32365*/ 01768000
*                                                                  0651 01769000
@RF00644 DS    0H                                                  0652 01770000
*                      /**********************************************/ 01771000
*                      /*                                            */ 01772000
*                      /*  CONSTRUCT VOLUMES SERIAL LIST.  IF        */ 01773000
*                      /*  UNSUCCESSFUL, RETURN TO CALLING PROCESSOR */ 01774000
*                      /*                                            */ 01775000
*                      /**********************************************/ 01776000
*                                                                  0652 01777000
*                      CALL LVLRPROC(IX,NULLPARM,NULLPARM,FVTPTR(FX));  01778000
         LA    @02,IX                                              0652 01779000
         ST    @02,@AL00001                                        0652 01780000
         LA    @02,NULLPARM                                        0652 01781000
         ST    @02,@AL00001+4                                      0652 01782000
         LA    @02,NULLPARM                                        0652 01783000
         ST    @02,@AL00001+8                                      0652 01784000
         LR    @02,FX                                              0652 01785000
         SLA   @02,2                                               0652 01786000
         LA    @02,FVTPTR-4(@02)                                   0652 01787000
         ST    @02,@AL00001+12                                     0652 01788000
         LA    @01,@AL00001                                        0652 01789000
         BAL   @14,LVLRPROC                                        0652 01790000
*                      RESPECIFY RTNREG RSTD;                      0653 01791000
*                      TESTRC = RTNREG;                            0654 01792000
         LR    TESTRC,RTNREG                                       0654 01793000
*                      RESPECIFY RTNREG UNRSTD;                    0655 01794000
*                      IF TESTRC ^= 0                              0656 01795000
*                        THEN                                      0656 01796000
         LTR   TESTRC,TESTRC                                       0656 01797000
         BZ    @RF00656                                            0656 01798000
*                          RETURN CODE(LASTCC12);                  0657 01799000
*                                                                  0657 01800000
         LA    @15,12                                              0657 01801000
         L     @14,@SA00002                                        0657 01802000
         LM    @00,@12,@SA00002+8                                  0657 01803000
         BR    @14                                                 0657 01804000
*                      END;                                        0658 01805000
*                                                                  0658 01806000
@RF00656 DS    0H                                                  0659 01807000
*                  /**************************************************/ 01808000
*                  /*                                                */ 01809000
*                  /*  IF THE KEYRANGES PARAMETER HAS BEEN SPECIFIED */ 01810000
*                  /*  IN THE AMS COMMAND, CALL RANGPROC TO CONSTRUCT*/ 01811000
*                  /*  THE KEYRANGES LIST FOR DEFINE                 */ 01812000
*                  /*                                                */ 01813000
*                 /**************************************************/  01814000
*                                                                  0659 01815000
*                  IF RANGEPTR(IX) ^= NULLPTR                      0659 01816000
*                    THEN                                          0659 01817000
@RF00642 SLR   @02,@02                                             0659 01818000
         L     @15,IX                                              0659 01819000
         SLA   @15,2                                               0659 01820000
         L     @14,@PC00001+4                                      0659 01821000
         L     @01,FDTPTR+28(,@14)                                 0659 01822000
         AL    @01,@CF01689                                        0659 01823000
         C     @02,RANGEPTR(@15,@01)                               0659 01824000
         BE    @RF00659                                            0659 01825000
*                      DO;                                         0660 01826000
*                                                                  0660 01827000
*                      /**********************************************/ 01828000
*                      /*                                            */ 01829000
*                      /*  IF KEYRANGES IS SPECIFIED IN THE AMS      */ 01830000
*                      /*  IMPORT COMMAND BOTH AT THE DATA AND INDEX */ 01831000
*                      /*  LEVELS, IGNORE THE INDEX LEVEL            */ 01832000
*                      /*  SPECIFICATION                             */ 01833000
*                      /*  IF LIST NOT CONSTRUCTED SUCCESSFULLY,     */ 01834000
*                      /*  RETURN WITH ERROR INDICATED               */ 01835000
*                      /*                                            */ 01836000
*                      /**********************************************/ 01837000
*                                                                  0661 01838000
*                      IF FX = 3 & RANGINPT ^= NULLPTR             0661 01839000
*                        THEN;                                     0661 01840000
         C     FX,@CF00165                                         0661 01841000
         BNE   @RF00661                                            0661 01842000
         C     @02,RANGINPT                                        0661 01843000
         BNE   @RT00661                                            0661 01844000
*                        ELSE                                      0663 01845000
*                          DO;                                     0663 01846000
*                                                                  0663 01847000
@RF00661 DS    0H                                                  0664 01848000
*                          CALL RANGPROC(IX,NULLPARM,NULLPARM,     0664 01849000
*                            RANGINPT);                            0664 01850000
*                                                                  0664 01851000
         LA    @02,IX                                              0664 01852000
         ST    @02,@AL00001                                        0664 01853000
         LA    @02,NULLPARM                                        0664 01854000
         ST    @02,@AL00001+4                                      0664 01855000
         LA    @02,NULLPARM                                        0664 01856000
         ST    @02,@AL00001+8                                      0664 01857000
         LA    @02,RANGINPT                                        0664 01858000
         ST    @02,@AL00001+12                                     0664 01859000
         LA    @01,@AL00001                                        0664 01860000
         BAL   @14,RANGPROC                                        0664 01861000
*                          RESPECIFY RTNREG RSTD;                  0665 01862000
*                          TESTRC = RTNREG;                        0666 01863000
         LR    TESTRC,RTNREG                                       0666 01864000
*                          RESPECIFY RTNREG UNRSTD;                0667 01865000
*                          IF TESTRC ^= 0                          0668 01866000
*                            THEN                                  0668 01867000
         LTR   TESTRC,TESTRC                                       0668 01868000
         BZ    @RF00668                                            0668 01869000
*                              RETURN CODE(LASTCC12);              0669 01870000
         LA    @15,12                                              0669 01871000
         L     @14,@SA00002                                        0669 01872000
         LM    @00,@12,@SA00002+8                                  0669 01873000
         BR    @14                                                 0669 01874000
*                          END;                                    0670 01875000
@RF00668 DS    0H                                                  0671 01876000
*                      END;                                        0671 01877000
@RT00661 DS    0H                                                  0672 01878000
*                  END OBJMATCH;                                   0672 01879000
@RF00659 DS    0H                                                  0673 01880000
*              END OBJENTLP;                                       0673 01881000
*                                                                  0673 01882000
@RF00605 LA    @02,1                                               0673 01883000
         AL    @02,IX                                              0673 01884000
@DE00604 ST    @02,IX                                              0673 01885000
         L     @15,@PC00001+4                                      0673 01886000
         LA    @15,FDTPTR+8(,@15)                                  0673 01887000
         C     @02,OBJTSCNT(,@15)                                  0673 01888000
         BNH   @DL00604                                            0673 01889000
*        END OBJCTLP;                                              0674 01890000
*                                                                  0674 01891000
         AL    FX,@CF00221                                         0674 01892000
@DE00602 CH    FX,NUMCOMP                                          0674 01893000
         BNH   @DL00602                                            0674 01894000
*        /************************************************************/ 01895000
*        /*                                                          */ 01896000
*        /*  IF A VOLUMES LIST HAS NOT BEEN BUILT (VOLUMES           */ 01897000
*        /*  WASN'T EXPORTED AND VOLUMES NOT SPECIFIED)              */ 01898000
*        /*  THEN TERMINATE.                                         */ 01899000
*        /*                                                          */ 01900000
*        /************************************************************/ 01901000
*                                                                  0675 01902000
*        IF IMPF2VOL ^= ON                                         0675 01903000
*          THEN                                                    0675 01904000
@RF00601 TM    IMPF2VOL,B'10000000'                                0675 01905000
         BO    @RF00675                                            0675 01906000
*            DO;                                                   0676 01907000
*            DARGILP = LENGTH(FENTNAME);                   /*@Y30SSFR*/ 01908000
         L     @15,DDSTRU                                          0677 01909000
         MVC   DARGILP(2,@15),@CH00605                             0677 01910000
*            DARGDBP = FVTPTR(1) -> CTGFVENT;              /*@Y30SSFR*/ 01911000
         L     @01,FVTPTR                                          0678 01912000
         L     @14,CTGFVENT(,@01)                                  0678 01913000
         ST    @14,DARGDBP(,@15)                                   0678 01914000
*            DEFSTID = NOLISTPM;                                   0679 01915000
         MVI   DEFSTID,X'05'                                       0679 01916000
*            RETURN CODE(LASTCC12);                                0680 01917000
         LA    @15,12                                              0680 01918000
         L     @14,@SA00002                                        0680 01919000
         LM    @00,@12,@SA00002+8                                  0680 01920000
         BR    @14                                                 0680 01921000
*            END;                                                  0681 01922000
*                                                                  0681 01923000
*        /************************************************************/ 01924000
*        /*                                                          */ 01925000
*        /*  SET POINTER TO KEYRANGES LIST IN THE FVT IF KEYRANGES   */ 01926000
*        /*  WAS SPECIFIED AS INPUT IN THE AMS IMPORT COMMAND OR     */ 01927000
*        /*  IF IT WAS MODELED FROM THE EXPORTED DATA SET.  THE LIST */ 01928000
*        /*  BUILT FROM AMS COMMAND INPUT WILL OVERRIDE THE LIST     */ 01929000
*        /*  MODELED FROM THE EXPORTED DATA SET.                     */ 01930000
*        /*                                                          */ 01931000
*        /************************************************************/ 01932000
*                                                                  0682 01933000
*        IF RANGINPT ^= NULLPTR                                    0682 01934000
*          THEN                                                    0682 01935000
@RF00675 L     @15,RANGINPT                                        0682 01936000
         LTR   @15,@15                                             0682 01937000
         BZ    @RF00682                                            0682 01938000
*            FVTPTR(2) -> CTGFVRNG = RANGINPT;                     0683 01939000
         L     @01,FVTPTR+4                                        0683 01940000
         ST    @15,CTGFVRNG(,@01)                                  0683 01941000
*          ELSE                                                    0684 01942000
*            IF RANGPORT ^= NULLPTR                                0684 01943000
*              THEN                                                0684 01944000
         B     @RC00682                                            0684 01945000
@RF00682 L     @15,RANGPORT                                        0684 01946000
         LTR   @15,@15                                             0684 01947000
         BZ    @RF00684                                            0684 01948000
*                FVTPTR(2) -> CTGFVRNG = RANGPORT;                 0685 01949000
*                                                                  0685 01950000
         L     @01,FVTPTR+4                                        0685 01951000
         ST    @15,CTGFVRNG(,@01)                                  0685 01952000
*        /************************************************************/ 01953000
*        /*                                                  @Y30SSFR*/ 01954000
*        /*  MIGRATE THE FILE INFORMATION JUST OBTAINED      @Y30SSFR*/ 01955000
*        /*  FROM THE SCAN OF THE OBJECTS LIST TO THE PROPER @Y30SSFR*/ 01956000
*        /*  LEVEL.  BEGIN BY TESTING TO DETERMINE IF THERE  @Y30SSFR*/ 01957000
*        /*  IS FILE INFORMATION AT THE CLUSTER OR AIX       @Y30SSFR*/ 01958000
*        /*  LEVEL.                                          @Y30SSFR*/ 01959000
*        /*                                                  @Y30SSFR*/ 01960000
*        /************************************************************/ 01961000
*                                                                  0686 01962000
*        IF (FVTPTR(1) -> CTGFVIND) ^= NULLPTR             /*@Y30SSFR*/ 01963000
*          THEN                                            /*@Y30SSFR*/ 01964000
@RF00684 DS    0H                                                  0686 01965000
@RC00682 SLR   @15,@15                                             0686 01966000
         L     @01,FVTPTR                                          0686 01967000
         L     @14,CTGFVIND(,@01)                                  0686 01968000
         CR    @14,@15                                             0686 01969000
         BE    @RF00686                                            0686 01970000
*            DO;                                           /*@Y30SSFR*/ 01971000
*                                                                  0687 01972000
*            /********************************************************/ 01973000
*            /*                                              @Y30SSFR*/ 01974000
*            /*  FILE INFORMATION WAS SPECIFIED AT THE       @Y30SSFR*/ 01975000
*            /*  CLUSTER OR AIX LEVEL.  TEST TO DETERMINE    @Y30SSFR*/ 01976000
*            /*  IF THIS INFORMATION NEEDS TO BE MIGRATED    @Y30SSFR*/ 01977000
*            /*  TO THE DATA OR INDEX LEVEL.                 @Y30SSFR*/ 01978000
*            /*                                              @Y30SSFR*/ 01979000
*            /********************************************************/ 01980000
*                                                                  0688 01981000
*            IF (FVTPTR(2) -> CTGFVIND) = NULLPTR          /*@Y30SSFR*/ 01982000
*              THEN                                        /*@Y30SSFR*/ 01983000
         L     @05,FVTPTR+4                                        0688 01984000
         C     @15,CTGFVIND(,@05)                                  0688 01985000
         BNE   @RF00688                                            0688 01986000
*                FVTPTR(2) -> CTGFVIND = FVTPTR(1) ->      /*@Y30SSFR*/ 01987000
*                   CTGFVIND;                              /*@Y30SSFR*/ 01988000
*                                                                  0689 01989000
         ST    @14,CTGFVIND(,@05)                                  0689 01990000
*            /********************************************************/ 01991000
*            /*                                              @Y30SSFR*/ 01992000
*            /*  TEST FOR THE EXISTENCE OF AN INDEX PRIOR    @Y30SSFR*/ 01993000
*            /*  TO TESTING FOR THE PRESENCE OF FILE INFOR-  @Y30SSFR*/ 01994000
*            /*  MATION.                                     @Y30SSFR*/ 01995000
*            /*                                              @Y30SSFR*/ 01996000
*            /********************************************************/ 01997000
*                                                                  0690 01998000
*            IF FVTPTR(3) ^= NULLPTR                       /*@Y30SSFR*/ 01999000
*              THEN                                        /*@Y30SSFR*/ 02000000
@RF00688 SLR   @15,@15                                             0690 02001000
         L     @14,FVTPTR+8                                        0690 02002000
         CR    @14,@15                                             0690 02003000
         BE    @RF00690                                            0690 02004000
*                IF (FVTPTR(3) -> CTGFVIND) = NULLPTR      /*@Y30SSFR*/ 02005000
*                  THEN                                    /*@Y30SSFR*/ 02006000
         C     @15,CTGFVIND(,@14)                                  0691 02007000
         BNE   @RF00691                                            0691 02008000
*                    FVTPTR(3) -> CTGFVIND =               /*@Y30SSFR*/ 02009000
*                       FVTPTR(1) -> CTGFVIND;             /*@Y30SSFR*/ 02010000
         L     @01,FVTPTR                                          0692 02011000
         L     @15,CTGFVIND(,@01)                                  0692 02012000
         ST    @15,CTGFVIND(,@14)                                  0692 02013000
*            END;                                          /*@Y30SSFR*/ 02014000
*                                                                  0693 02015000
@RF00691 DS    0H                                                  0693 02016000
@RF00690 DS    0H                                                  0694 02017000
*        /************************************************************/ 02018000
*        /*                                                  @Y30SSFR*/ 02019000
*        /*  IF THERE IS STILL NO FILE INFORMATION AT THE    @Y30SSFR*/ 02020000
*        /*  DATA AND INDEX LEVELS, ATTEMPT TO SUPPLY        @Y30SSFR*/ 02021000
*        /*  DEFAULT INFORMATION USING THE OUTFILE PARAMETER @Y30SSFR*/ 02022000
*        /*  IF THAT WAS SPECIFIED BY THE USER.              @Y30SSFR*/ 02023000
*        /*                                                  @Y30SSFR*/ 02024000
*        /************************************************************/ 02025000
*                                                                  0694 02026000
*        IF FVTPTR(2) -> CTGFVIND = NULLPTR                /*@Y30SSFR*/ 02027000
*           & ADDR(OUTDD) ^= NULLPTR                       /*@Y30SSFR*/ 02028000
*          THEN                                            /*@Y30SSFR*/ 02029000
@RF00686 SLR   @15,@15                                             0694 02030000
         L     @14,FVTPTR+4                                        0694 02031000
         C     @15,CTGFVIND(,@14)                                  0694 02032000
         BNE   @RF00694                                            0694 02033000
         L     @05,@PC00001+4                                      0694 02034000
         L     @05,FDTPTR+4(,@05)                                  0694 02035000
         CR    @05,@15                                             0694 02036000
         BE    @RF00694                                            0694 02037000
*            FVTPTR(2) -> CTGFVIND = ADDR(OUTDDVAL);       /*@Y30SSFR*/ 02038000
*                                                                  0695 02039000
         LA    @15,OUTDDVAL(,@05)                                  0695 02040000
         ST    @15,CTGFVIND(,@14)                                  0695 02041000
*        IF FVTPTR(3) ^= NULLPTR                           /*@Y30SSFR*/ 02042000
*          THEN                                            /*@Y30SSFR*/ 02043000
@RF00694 SLR   @15,@15                                             0696 02044000
         L     @14,FVTPTR+8                                        0696 02045000
         CR    @14,@15                                             0696 02046000
         BE    @RF00696                                            0696 02047000
*            IF FVTPTR(3) -> CTGFVIND = NULLPTR            /*@Y30SSFR*/ 02048000
*               & ADDR(OUTDD) ^= NULLPTR                   /*@Y30SSFR*/ 02049000
*              THEN                                        /*@Y30SSFR*/ 02050000
         C     @15,CTGFVIND(,@14)                                  0697 02051000
         BNE   @RF00697                                            0697 02052000
         L     @05,@PC00001+4                                      0697 02053000
         L     @05,FDTPTR+4(,@05)                                  0697 02054000
         CR    @05,@15                                             0697 02055000
         BE    @RF00697                                            0697 02056000
*                FVTPTR(3) -> CTGFVIND = ADDR(OUTDDVAL);   /*@Y30SSFR*/ 02057000
         LA    @15,OUTDDVAL(,@05)                                  0698 02058000
         ST    @15,CTGFVIND(,@14)                                  0698 02059000
*                                                                  0699 02060000
*        /************************************************************/ 02061000
*        /*                                                  #Y30SSFR*/ 02062000
*        /*  PUT THE VOLUME INFORMATION INTO THE FVTS AT     #Y30SSFR*/ 02063000
*        /*  THE PROPER LEVEL--DATA AND POSSIBLY INDEX.      #Y30SSFR*/ 02064000
*        /* FIRST CHECK THE DATA FVT TO SEE IF CTGFVVLT IS ZERO      */ 02065000
*        /* IF IT IS- REPRODUCE THE VOLUME LIST REFERENCED FROM      */ 02066000
*        /* THE CLUSTER FVT AND POINT TO IT FROM THE DATA FVT        */ 02067000
*        /* IF AN INDEX FVT ALSO EXISTS DO THE SAME.         #Y30SSFR*/ 02068000
*        /* IN EITHER CASE, IF THE DATA OR INDEX FVT HAS NO VOL      */ 02069000
*        /* POINTER AND THERE ARE NO CLUSTER VOLUMES THIS IS A       */ 02070000
*        /* TERMINAL ERROR, SET DEFSTID AND TERMINATE        #Y30SSFR*/ 02071000
*        /*                                                  #Y30SSFR*/ 02072000
*        /************************************************************/ 02073000
*                                                                  0699 02074000
*        IF FVTPTR(2) -> CTGFVVLT = NULLPTR                        0699 02075000
*          THEN                                                    0699 02076000
@RF00697 DS    0H                                                  0699 02077000
@RF00696 SLR   @15,@15                                             0699 02078000
         L     @01,FVTPTR+4                                        0699 02079000
         C     @15,CTGFVVLT(,@01)                                  0699 02080000
         BNE   @RF00699                                            0699 02081000
*            IF FVTPTR(1) -> CTGFVVLT = NULLPTR                    0700 02082000
*              THEN                                                0700 02083000
         L     @14,FVTPTR                                          0700 02084000
         C     @15,CTGFVVLT(,@14)                                  0700 02085000
         BNE   @RF00700                                            0700 02086000
*                DO;                                       /*@Y30SSFR*/ 02087000
*                                                                  0701 02088000
*                /****************************************************/ 02089000
*                /*                                          #Y30SSFR*/ 02090000
*                /* THERE IS NO VOL LIST FROM DATA FVT NOR IS        */ 02091000
*                /* THERE ONE WE CAN MOVE DOWN FROM THE CLUSTER      */ 02092000
*                /* THIS IS A TERMINAL ERROR.                #Y30SSFR*/ 02093000
*                /*                                          #Y30SSFR*/ 02094000
*                /****************************************************/ 02095000
*                                                                  0702 02096000
*                DARGILP = LENGTH(FENTNAME);               /*#Y30SSFR*/ 02097000
         L     @15,DDSTRU                                          0702 02098000
         MVC   DARGILP(2,@15),@CH00605                             0702 02099000
*                DARGDBP = FVTPTR(1) -> CTGFVENT;          /*#Y30SSFR*/ 02100000
         L     @14,CTGFVENT(,@14)                                  0703 02101000
         ST    @14,DARGDBP(,@15)                                   0703 02102000
*                DEFSTID = NOLISTPM;                       /*#Y30SSFR*/ 02103000
         MVI   DEFSTID,X'05'                                       0704 02104000
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/ 02105000
*                                                                  0705 02106000
         LA    @15,12                                              0705 02107000
         L     @14,@SA00002                                        0705 02108000
         LM    @00,@12,@SA00002+8                                  0705 02109000
         BR    @14                                                 0705 02110000
*                END;                                      /*#Y30SSFR*/ 02111000
*                                                                  0706 02112000
*              /******************************************************/ 02113000
*              /*                                            #Y30SSFR*/ 02114000
*              /* THERE IS NO VOLLIST FROM DATA SO MOVE THAT AT      */ 02115000
*              /* THE CLUSTER.                               @Y30SSFR*/ 02116000
*              /*                                            @Y30SSFR*/ 02117000
*              /******************************************************/ 02118000
*                                                                  0707 02119000
*              ELSE                                                0707 02120000
*                DO;                                       /*@Y30SSFR*/ 02121000
*                                                                  0707 02122000
@RF00700 DS    0H                                                  0708 02123000
*                TOTLEN = (FVTPTR(1) -> CTGFVVLT->FLISTLN) + 2;    0708 02124000
*                                                                  0708 02125000
         L     @03,FVTPTR                                          0708 02126000
         L     @03,CTGFVVLT(,@03)                                  0708 02127000
         LA    @15,2                                               0708 02128000
         AH    @15,FLISTLN(,@03)                                   0708 02129000
         ST    @15,TOTLEN                                          0708 02130000
*                CTGFVPTR = FVTPTR(2);                     /*@Y30SSFR*/ 02131000
*                                                                  0709 02132000
         L     @03,FVTPTR+4                                        0709 02133000
         ST    @03,CTGFVPTR                                        0709 02134000
*                CALL IDCSAGP0(                                    0710 02135000
*                 GDTTBL,                                          0710 02136000
*                 TOTLEN,               /* LENGTH OF STORAGE @Y30SSFR*/ 02137000
*                 CTGFVVLT,             /* ADDRESS OF STORAGE        */ 02138000
*                 GPID,                                            0710 02139000
*                 SETZERO);                                /*@Y30SSFR*/ 02140000
*                                                                  0710 02141000
         L     @15,@PC00001                                        0710 02142000
         ST    @15,@AL00001                                        0710 02143000
         LA    @14,TOTLEN                                          0710 02144000
         ST    @14,@AL00001+4                                      0710 02145000
         LA    @03,CTGFVVLT(,@03)                                  0710 02146000
         ST    @03,@AL00001+8                                      0710 02147000
         LA    @03,GPID                                            0710 02148000
         ST    @03,@AL00001+12                                     0710 02149000
         LA    @03,SETZERO                                         0710 02150000
         ST    @03,@AL00001+16                                     0710 02151000
         MVI   @AL00001+16,X'80'                                   0710 02152000
         L     @15,GDTGPL(,@15)                                    0710 02153000
         LA    @01,@AL00001                                        0710 02154000
         BALR  @14,@15                                             0710 02155000
*                RESPECIFY RTNREG RSTD;                            0711 02156000
*                TESTRC = RTNREG;                                  0712 02157000
         LR    TESTRC,RTNREG                                       0712 02158000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/ 02159000
*                                                                  0713 02160000
*                /****************************************************/ 02161000
*                /*                                          @Y30SSFR*/ 02162000
*                /* STORAGE REQUEST FAILED FOR VOL LIST      @Y30SSFR*/ 02163000
*                /*                                          @Y30SSFR*/ 02164000
*                /****************************************************/ 02165000
*                                                                  0714 02166000
*                IF TESTRC ^= 0                                    0714 02167000
*                  THEN                                            0714 02168000
         LTR   TESTRC,TESTRC                                       0714 02169000
         BZ    @RF00714                                            0714 02170000
*                    DO;                                   /*@Y30SSFR*/ 02171000
*                                                                  0715 02172000
*                    DEFSTID = NOSTORAG;                   /*@Y30SSFR*/ 02173000
         MVI   DEFSTID,X'04'                                       0716 02174000
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/ 02175000
         L     @01,DDSTRU                                          0717 02176000
         MVC   DARGSMOD(3,@01),@CC01023                            0717 02177000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 02178000
*                                                                  0718 02179000
         LA    @15,12                                              0718 02180000
         L     @14,@SA00002                                        0718 02181000
         LM    @00,@12,@SA00002+8                                  0718 02182000
         BR    @14                                                 0718 02183000
*                    END;                                  /*@Y30SSFR*/ 02184000
*                                                                  0719 02185000
*                /****************************************************/ 02186000
*                /*                                          @Y30SSFR*/ 02187000
*                /* MOVE THE VOLUME LIST FROM THE CLUSTER TO THE     */ 02188000
*                /* DATA FVT VOLUME LIST CREATED BY ABOVE UGPOOL     */ 02189000
*                /*                                          @Y30SSFR*/ 02190000
*                /****************************************************/ 02191000
*                                                                  0720 02192000
*                FVTPTR(2)->CTGFVVLT->FLISTVOL(1 : TOTLEN) =       0720 02193000
*                  FVTPTR(1) -> CTGFVVLT->FLISTVOL(1 : TOTLEN);    0720 02194000
*                                                                  0720 02195000
@RF00714 L     @15,FVTPTR+4                                        0720 02196000
         L     @01,CTGFVVLT(,@15)                                  0720 02197000
         L     @14,TOTLEN                                          0720 02198000
         BCTR  @14,0                                               0720 02199000
         L     @05,FVTPTR                                          0720 02200000
         L     @05,CTGFVVLT(,@05)                                  0720 02201000
         EX    @14,@SM01692                                        0720 02202000
*                  IF FVTPTR(2) -> CTGFVIND = NULLPTR & UNIQD = ON 0721 02203000
*                    THEN                                          0721 02204000
         L     @14,CTGFVIND(,@15)                                  0721 02205000
         LTR   @14,@14                                             0721 02206000
         BNZ   @RF00721                                            0721 02207000
         TM    UNIQD,B'10000000'                                   0721 02208000
         BNO   @RF00721                                            0721 02209000
*                      DO;                                 /*@Y30SSFR*/ 02210000
*                                                                  0722 02211000
*                      /**********************************************/ 02212000
*                        /*                                  @Y30SSFR*/ 02213000
*                        /* DYNAMICALLY ALLOCATE THE DATA COMPONENT  */ 02214000
*                        /* VOLUMES AS REFERENCED FROM DATA FVT      */ 02215000
*                        /*                                  @Y30SSFR*/ 02216000
*                        /********************************************/ 02217000
*                                                                  0723 02218000
*                        CALL DALCPROC ('A',                       0723 02219000
*                          FVTPTR(2)->CTGFVVLT,                    0723 02220000
*                          FVTPTR(2)->CTGFVIND,                    0723 02221000
*                          DALCINDX);                      /*@Y30SSFR*/ 02222000
*                                                                  0723 02223000
         LA    @14,@CC00811                                        0723 02224000
         ST    @14,@AL00001                                        0723 02225000
         LA    @14,CTGFVVLT(,@15)                                  0723 02226000
         ST    @14,@AL00001+4                                      0723 02227000
         LA    @15,CTGFVIND(,@15)                                  0723 02228000
         ST    @15,@AL00001+8                                      0723 02229000
         LA    @15,DALCINDX                                        0723 02230000
         ST    @15,@AL00001+12                                     0723 02231000
         LA    @01,@AL00001                                        0723 02232000
         BAL   @14,DALCPROC                                        0723 02233000
*                        IF DEFSTID ^= NORMSTAT                    0724 02234000
*                          THEN                                    0724 02235000
         CLI   DEFSTID,0                                           0724 02236000
         BE    @RF00724                                            0724 02237000
*                            /****************************************/ 02238000
*                            /*                              @Y30SSFR*/ 02239000
*                            /* ALLOCATION FAILED FOR DATA VOLUMES   */ 02240000
*                            /* LIST.                        @Y30SSFR*/ 02241000
*                            /*                              @Y30SSFR*/ 02242000
*                            /****************************************/ 02243000
*                            DO;                           /*@Y30SSFR*/ 02244000
*                                                                  0725 02245000
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/ 02246000
         L     @01,DDSTRU                                          0726 02247000
         MVC   DARGSMOD(3,@01),@CC01038                            0726 02248000
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/ 02249000
*                                                                  0727 02250000
         LA    @15,12                                              0727 02251000
         L     @14,@SA00002                                        0727 02252000
         LM    @00,@12,@SA00002+8                                  0727 02253000
         BR    @14                                                 0727 02254000
*                            END;                          /*@Y30SSFR*/ 02255000
*                        END;                              /*@Y30SSFR*/ 02256000
*                    END;                                  /*@Y30SSFR*/ 02257000
*                ELSE                                      /*@Y30SSFR*/ 02258000
*                                                                  0731 02259000
*                IF UNIQD = ON                                     0731 02260000
*                  THEN                                            0731 02261000
         B     @RC00699                                            0731 02262000
@RF00699 TM    UNIQD,B'10000000'                                   0731 02263000
         BNO   @RF00731                                            0731 02264000
*                    IF FVTPTR(2) -> CTGFVIND = NULLPTR            0732 02265000
*                      THEN                                        0732 02266000
         L     @15,FVTPTR+4                                        0732 02267000
         L     @14,CTGFVIND(,@15)                                  0732 02268000
         LTR   @14,@14                                             0732 02269000
         BNZ   @RF00732                                            0732 02270000
*                        DO;                               /*@Y30SSFR*/ 02271000
*                        /********************************************/ 02272000
*                        /*                                  @Y30SSFR*/ 02273000
*                        /* DYNAMICALLY ALLOCATE THE DATA COMPONENT  */ 02274000
*                        /* VOLUMES AS REFERENCED FROM DATA FVT      */ 02275000
*                        /*                                  @Y30SSFR*/ 02276000
*                        /********************************************/ 02277000
*                                                                  0734 02278000
*                        CALL DALCPROC ('A',                       0734 02279000
*                          FVTPTR(2)->CTGFVVLT,                    0734 02280000
*                          FVTPTR(2)->CTGFVIND,                    0734 02281000
*                          DALCINDX);                      /*@Y30SSFR*/ 02282000
*                                                                  0734 02283000
         LA    @14,@CC00811                                        0734 02284000
         ST    @14,@AL00001                                        0734 02285000
         LA    @14,CTGFVVLT(,@15)                                  0734 02286000
         ST    @14,@AL00001+4                                      0734 02287000
         LA    @15,CTGFVIND(,@15)                                  0734 02288000
         ST    @15,@AL00001+8                                      0734 02289000
         LA    @15,DALCINDX                                        0734 02290000
         ST    @15,@AL00001+12                                     0734 02291000
         LA    @01,@AL00001                                        0734 02292000
         BAL   @14,DALCPROC                                        0734 02293000
*                        IF DEFSTID ^= NORMSTAT                    0735 02294000
*                          THEN                                    0735 02295000
         CLI   DEFSTID,0                                           0735 02296000
         BE    @RF00735                                            0735 02297000
*                            /****************************************/ 02298000
*                            /*                              @Y30SSFR*/ 02299000
*                            /* ALLOCATION FAILED FOR DATA VOLUMES   */ 02300000
*                            /* LIST.                        @Y30SSFR*/ 02301000
*                            /*                              @Y30SSFR*/ 02302000
*                            /****************************************/ 02303000
*                            DO;                           /*@Y30SSFR*/ 02304000
*                                                                  0736 02305000
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/ 02306000
         L     @01,DDSTRU                                          0737 02307000
         MVC   DARGSMOD(3,@01),@CC01038                            0737 02308000
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/ 02309000
*                                                                  0738 02310000
         LA    @15,12                                              0738 02311000
         L     @14,@SA00002                                        0738 02312000
         LM    @00,@12,@SA00002+8                                  0738 02313000
         BR    @14                                                 0738 02314000
*                            END;                          /*@Y30SSFR*/ 02315000
*                        END;                              /*@Y30SSFR*/ 02316000
@RF00735 DS    0H                                                  0741 02317000
*            /********************************************************/ 02318000
*            /*                                              @Y30SSFR*/ 02319000
*            /* INDEX FVT MIGRATION - MOVE CLUSTER VOL LIST IF THERE */ 02320000
*            /* IS NONE AT INDEX FVT - IF THERE IS AN INDEX FVT      */ 02321000
*            /*                                              @Y30SSFR*/ 02322000
*            /********************************************************/ 02323000
*                                                                  0741 02324000
*            IF FVTPTR(3) ^= NULLPTR                               0741 02325000
*              THEN                                                0741 02326000
@RF00732 DS    0H                                                  0741 02327000
@RF00731 DS    0H                                                  0741 02328000
@RC00699 SLR   @15,@15                                             0741 02329000
         L     @14,FVTPTR+8                                        0741 02330000
         CR    @14,@15                                             0741 02331000
         BE    @RF00741                                            0741 02332000
*                DO;                                       /*@Y30SSFR*/ 02333000
*                                                                  0742 02334000
*                IF FVTPTR(3) -> CTGFVVLT = NULLPTR                0743 02335000
*                  THEN                                            0743 02336000
         C     @15,CTGFVVLT(,@14)                                  0743 02337000
         BNE   @RF00743                                            0743 02338000
*                    IF FVTPTR(1) -> CTGFVVLT = NULLPTR            0744 02339000
*                      THEN                                        0744 02340000
*                                                                  0744 02341000
         L     @14,FVTPTR                                          0744 02342000
         C     @15,CTGFVVLT(,@14)                                  0744 02343000
         BNE   @RF00744                                            0744 02344000
*                        /********************************************/ 02345000
*                        /*                                  @Y30SSFR*/ 02346000
*                        /* THERE IS NO VOL LIST  AT INDEX FVT, NOR  */ 02347000
*                        /* IS THERE ONE TO MOVE FROM CLUSTER. THIS  */ 02348000
*                        /* IS A TERMINAL ERROR.             @Y30SSFR*/ 02349000
*                        /*                                  @Y30SSFR*/ 02350000
*                        /********************************************/ 02351000
*                                                                  0745 02352000
*                        DO;                               /*@Y30SSFR*/ 02353000
*                                                                  0745 02354000
*                        DARGILP = LENGTH(FENTNAME);       /*@OZ32365*/ 02355000
         L     @15,DDSTRU                                          0746 02356000
         MVC   DARGILP(2,@15),@CH00605                             0746 02357000
*                        DARGDBP = FVTPTR(1) -> CTGFVENT;  /*@OZ32365*/ 02358000
         L     @14,CTGFVENT(,@14)                                  0747 02359000
         ST    @14,DARGDBP(,@15)                                   0747 02360000
*                        DEFSTID = NOLISTPM;               /*@Y30SSFR*/ 02361000
         MVI   DEFSTID,X'05'                                       0748 02362000
*                        RETURN CODE(LASTCC12);            /*@OZ32365*/ 02363000
*                                                                  0749 02364000
         LA    @15,12                                              0749 02365000
         L     @14,@SA00002                                        0749 02366000
         LM    @00,@12,@SA00002+8                                  0749 02367000
         BR    @14                                                 0749 02368000
*                        END;                              /*@Y30SSFR*/ 02369000
*                                                                  0750 02370000
*                      ELSE                                        0751 02371000
*                        /********************************************/ 02372000
*                        /*                                  @Y30SSFR*/ 02373000
*                        /* THE INDEX FVT HAS NO VOL LIST MOVE IT    */ 02374000
*                        /* FROM THE CLUSTER .               @Y30SSFR*/ 02375000
*                        /*                                  @Y30SSFR*/ 02376000
*                        /********************************************/ 02377000
*                        DO;                               /*@Y30SSFR*/ 02378000
*                                                                  0751 02379000
@RF00744 DS    0H                                                  0752 02380000
*                        TOTLEN = (FVTPTR(1)->CTGFVVLT->FLISTLN) + 2;   02381000
         L     @03,FVTPTR                                          0752 02382000
         L     @03,CTGFVVLT(,@03)                                  0752 02383000
         LA    @15,2                                               0752 02384000
         AH    @15,FLISTLN(,@03)                                   0752 02385000
         ST    @15,TOTLEN                                          0752 02386000
*                        CTGFVPTR = FVTPTR(3);             /*@Y30SSFR*/ 02387000
*                                                                  0753 02388000
         L     @03,FVTPTR+8                                        0753 02389000
         ST    @03,CTGFVPTR                                        0753 02390000
*                        CALL IDCSAGP0 (GDTTBL,                    0754 02391000
*                         TOTLEN,                                  0754 02392000
*                         CTGFVVLT,                                0754 02393000
*                         GPID,                                    0754 02394000
*                         SETZERO);                        /*@Y30SSFR*/ 02395000
*                                                                  0754 02396000
         L     @15,@PC00001                                        0754 02397000
         ST    @15,@AL00001                                        0754 02398000
         LA    @14,TOTLEN                                          0754 02399000
         ST    @14,@AL00001+4                                      0754 02400000
         LA    @03,CTGFVVLT(,@03)                                  0754 02401000
         ST    @03,@AL00001+8                                      0754 02402000
         LA    @03,GPID                                            0754 02403000
         ST    @03,@AL00001+12                                     0754 02404000
         LA    @03,SETZERO                                         0754 02405000
         ST    @03,@AL00001+16                                     0754 02406000
         MVI   @AL00001+16,X'80'                                   0754 02407000
         L     @15,GDTGPL(,@15)                                    0754 02408000
         LA    @01,@AL00001                                        0754 02409000
         BALR  @14,@15                                             0754 02410000
*                        RESPECIFY RTNREG RSTD;                    0755 02411000
*                        TESTRC = RTNREG;                          0756 02412000
         LR    TESTRC,RTNREG                                       0756 02413000
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSFR*/ 02414000
*                                                                  0757 02415000
*                        IF TESTRC ^= 0                            0758 02416000
*                          THEN                                    0758 02417000
         LTR   TESTRC,TESTRC                                       0758 02418000
         BZ    @RF00758                                            0758 02419000
*                            /****************************************/ 02420000
*                            /*                              @Y30SSFR*/ 02421000
*                            /* STORAGE REQUEST FAILED FOR INDEX VOL */ 02422000
*                            /* LIST.                        @Y30SSFR*/ 02423000
*                            /*                              @Y30SSFR*/ 02424000
*                            /****************************************/ 02425000
*                            DO;                           /*@Y30SSFR*/ 02426000
*                                                                  0759 02427000
*                            DEFSTID = NOSTORAG;           /*@Y30SSFR*/ 02428000
         MVI   DEFSTID,X'04'                                       0760 02429000
*                            DARGSMOD = UNIVMSG;           /*@Y30SSFR*/ 02430000
         L     @01,DDSTRU                                          0761 02431000
         MVC   DARGSMOD(3,@01),@CC01023                            0761 02432000
*                            RETURN CODE(LASTCC);          /*@Y30SSFR*/ 02433000
*                                                                  0762 02434000
         L     @14,@PC00001+8                                      0762 02435000
         LH    @15,LASTCC(,@14)                                    0762 02436000
         L     @14,@SA00002                                        0762 02437000
         LM    @00,@12,@SA00002+8                                  0762 02438000
         BR    @14                                                 0762 02439000
*                            END;                          /*@Y30SSFR*/ 02440000
*                        /********************************************/ 02441000
*                        /*                                  @Y30SSFR*/ 02442000
*                        /* MOVE THE VOL LIST FROM THE CLUSTER TO THE*/ 02443000
*                        /* INDEX FVT VOL LIST CREATED BY ABOVE      */ 02444000
*                        /* UGPOOL                           @Y30SSFR*/ 02445000
*                        /*                                  @Y30SSFR*/ 02446000
*                        /********************************************/ 02447000
*                                                                  0764 02448000
*                        FVTPTR(3)->CTGFVVLT->FLISTVOL(1 : TOTLEN)=     02449000
*                         FVTPTR(1)->CTGFVVLT->FLISTVOL(1:TOTLEN); 0764 02450000
*                                                                  0764 02451000
@RF00758 L     @15,FVTPTR+8                                        0764 02452000
         L     @01,CTGFVVLT(,@15)                                  0764 02453000
         L     @14,TOTLEN                                          0764 02454000
         BCTR  @14,0                                               0764 02455000
         L     @05,FVTPTR                                          0764 02456000
         L     @05,CTGFVVLT(,@05)                                  0764 02457000
         EX    @14,@SM01692                                        0764 02458000
*                    IF FVTPTR(3) -> CTGFVIND = NULLPTR & UNIQI = ON    02459000
*                      THEN                                        0765 02460000
         L     @14,CTGFVIND(,@15)                                  0765 02461000
         LTR   @14,@14                                             0765 02462000
         BNZ   @RF00765                                            0765 02463000
         TM    UNIQI,B'10000000'                                   0765 02464000
         BNO   @RF00765                                            0765 02465000
*                        DO;                               /*@Y30SSFR*/ 02466000
*                        /********************************************/ 02467000
*                        /*                                  @Y30SSFR*/ 02468000
*                        /* DYNAMICALLY ALLOCATE THE INDEX COMPONENT */ 02469000
*                        /* VOLUMES AS REFERENCED FROM INDEX FVT     */ 02470000
*                        /*                                  @Y30SSFR*/ 02471000
*                        /********************************************/ 02472000
*                                                                  0767 02473000
*                        CALL DALCPROC ('A',                       0767 02474000
*                          FVTPTR(3)->CTGFVVLT,                    0767 02475000
*                          FVTPTR(3)->CTGFVIND,                    0767 02476000
*                          DALCINDX);                      /*@Y30SSFR*/ 02477000
*                                                                  0767 02478000
         LA    @14,@CC00811                                        0767 02479000
         ST    @14,@AL00001                                        0767 02480000
         LA    @14,CTGFVVLT(,@15)                                  0767 02481000
         ST    @14,@AL00001+4                                      0767 02482000
         LA    @15,CTGFVIND(,@15)                                  0767 02483000
         ST    @15,@AL00001+8                                      0767 02484000
         LA    @15,DALCINDX                                        0767 02485000
         ST    @15,@AL00001+12                                     0767 02486000
         LA    @01,@AL00001                                        0767 02487000
         BAL   @14,DALCPROC                                        0767 02488000
*                        IF DEFSTID ^= NORMSTAT                    0768 02489000
*                          THEN                                    0768 02490000
         CLI   DEFSTID,0                                           0768 02491000
         BE    @RF00768                                            0768 02492000
*                            /****************************************/ 02493000
*                            /*                              @Y30SSFR*/ 02494000
*                            /* ALLOCATION FAILED FOR INDEX VOLUMES  */ 02495000
*                            /* LIST.                        @Y30SSFR*/ 02496000
*                            /*                              @Y30SSFR*/ 02497000
*                            /****************************************/ 02498000
*                            DO;                           /*@Y30SSFR*/ 02499000
*                                                                  0769 02500000
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/ 02501000
         L     @01,DDSTRU                                          0770 02502000
         MVC   DARGSMOD(3,@01),@CC01038                            0770 02503000
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/ 02504000
*                                                                  0771 02505000
         LA    @15,12                                              0771 02506000
         L     @14,@SA00002                                        0771 02507000
         LM    @00,@12,@SA00002+8                                  0771 02508000
         BR    @14                                                 0771 02509000
*                            END;                          /*@Y30SSFR*/ 02510000
*                        END;                              /*@Y30SSFR*/ 02511000
*                    END;                                  /*@Y30SSFR*/ 02512000
*                  ELSE                                    /*@Y30SSFR*/ 02513000
*                    IF FVTPTR(3) -> CTGFVIND = NULLPTR & UNIQI = ON    02514000
*                      THEN                                        0775 02515000
         B     @RC00743                                            0775 02516000
@RF00743 L     @15,FVTPTR+8                                        0775 02517000
         L     @14,CTGFVIND(,@15)                                  0775 02518000
         LTR   @14,@14                                             0775 02519000
         BNZ   @RF00775                                            0775 02520000
         TM    UNIQI,B'10000000'                                   0775 02521000
         BNO   @RF00775                                            0775 02522000
*                        DO;                               /*@Y30SSFR*/ 02523000
*                        /********************************************/ 02524000
*                        /*                                  @Y30SSFR*/ 02525000
*                        /* DYNAMICALLY ALLOCATE THE INDEX COMPONENT */ 02526000
*                        /* VOLUMES AS REFERENCED FROM INDEX FVT     */ 02527000
*                        /*                                  @Y30SSFR*/ 02528000
*                        /********************************************/ 02529000
*                                                                  0777 02530000
*                        CALL DALCPROC ('A',                       0777 02531000
*                          FVTPTR(3)->CTGFVVLT,                    0777 02532000
*                          FVTPTR(3)->CTGFVIND,                    0777 02533000
*                          DALCINDX);                      /*@Y30SSFR*/ 02534000
*                                                                  0777 02535000
         LA    @14,@CC00811                                        0777 02536000
         ST    @14,@AL00001                                        0777 02537000
         LA    @14,CTGFVVLT(,@15)                                  0777 02538000
         ST    @14,@AL00001+4                                      0777 02539000
         LA    @15,CTGFVIND(,@15)                                  0777 02540000
         ST    @15,@AL00001+8                                      0777 02541000
         LA    @15,DALCINDX                                        0777 02542000
         ST    @15,@AL00001+12                                     0777 02543000
         LA    @01,@AL00001                                        0777 02544000
         BAL   @14,DALCPROC                                        0777 02545000
*                        IF DEFSTID ^= NORMSTAT                    0778 02546000
*                          THEN                                    0778 02547000
         CLI   DEFSTID,0                                           0778 02548000
         BE    @RF00778                                            0778 02549000
*                            /****************************************/ 02550000
*                            /*                              @Y30SSFR*/ 02551000
*                            /* ALLOCATION FAILED FOR INDEX VOLUMES  */ 02552000
*                            /* LIST.                        @Y30SSFR*/ 02553000
*                            /*                              @Y30SSFR*/ 02554000
*                            /****************************************/ 02555000
*                            DO;                           /*@Y30SSFR*/ 02556000
*                                                                  0779 02557000
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/ 02558000
         L     @01,DDSTRU                                          0780 02559000
         MVC   DARGSMOD(3,@01),@CC01038                            0780 02560000
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/ 02561000
*                                                                  0781 02562000
         LA    @15,12                                              0781 02563000
         L     @14,@SA00002                                        0781 02564000
         LM    @00,@12,@SA00002+8                                  0781 02565000
         BR    @14                                                 0781 02566000
*                            END;                          /*@Y30SSFR*/ 02567000
*                        END;                              /*@Y30SSFR*/ 02568000
@RF00778 DS    0H                                                  0784 02569000
*                END;                                      /*@Y30SSFR*/ 02570000
*                                                                  0784 02571000
@RF00775 DS    0H                                                  0784 02572000
@RC00743 DS    0H                                                  0785 02573000
*        /************************************************************/ 02574000
*        /*                                                  @Y30SSFR*/ 02575000
*        /* ZERO OUT THE VOLUME LIST POINTER AT CLUSTER FVT  @Y30SSFR*/ 02576000
*        /*                                                  @Y30SSFR*/ 02577000
*        /************************************************************/ 02578000
*                                                                  0785 02579000
*        FVTPTR(1) -> CTGFVVLT = NULLPTR;                  /*@Y30SSFR*/ 02580000
*                                                                  0785 02581000
*                                                                  0785 02582000
@RF00741 L     @15,FVTPTR                                          0785 02583000
         SLR   @14,@14                                             0785 02584000
         ST    @14,CTGFVVLT(,@15)                                  0785 02585000
*        /************************************************************/ 02586000
*        /*                                                  @Y30SSFR*/ 02587000
*        /*  SET CTGFVWKA TO POINT TO A WORK AREA FOR THE    @Y30SSFR*/ 02588000
*        /*  VOLUME SERIAL NUMBER OF THE CATALOG RECOVERY    @Y30SSFR*/ 02589000
*        /*  VOLUME.                                         @Y30SSFR*/ 02590000
*        /*                                                  @Y30SSFR*/ 02591000
*        /************************************************************/ 02592000
*                                                                  0786 02593000
*        FVTPTR(1) -> CTGFVWKA = ADDR(CATRCVWK);           /*@Y30SSFR*/ 02594000
*                                                                  0786 02595000
         LA    @14,CATRCVWK                                        0786 02596000
         ST    @14,CTGFVWKA(,@15)                                  0786 02597000
*        /************************************************************/ 02598000
*        /*                                                  @Y30SSFR*/ 02599000
*        /*  SAVE CPL, FVTS, AND FPLS PRIOR TO INVOKING CATALOG      */ 02600000
*        /*  MANAGEMENT BECAUSE THESE CONTROL BLOCKS MAY BE ALTERED  */ 02601000
*        /*  BY CATALOG MANAGEMENT.  IF THE OBJECT NAME IS A @Y30SSFR*/ 02602000
*        /*  DUPLICATE, IT MAY BE DELETED THEN REDEFINED, IN WHICH   */ 02603000
*        /*  CASE IT WILL BE NECESSARY TO RESTORE THE CONTROL BLOCKS */ 02604000
*        /*                                                  @Y30SSFR*/ 02605000
*        /************************************************************/ 02606000
*                                                                  0787 02607000
*        TFVTLEN = LENGTH(CTGFV) + (LENGTH(CTGFL) + 8) * CFPLNUM + 0787 02608000
*          LENGTH(IDAAMDSB);                               /*@Y30SSFR*/ 02609000
*                                                                  0787 02610000
         LH    @15,CFPLNUM                                         0787 02611000
         MH    @15,@CH00312                                        0787 02612000
         LA    @15,188(,@15)                                       0787 02613000
         STH   @15,TFVTLEN                                         0787 02614000
*        SAVCPL = PTRCPL -> FIELDR(1:LENGTH(CTGPL) + 16);  /*@Y30SSFR*/ 02615000
*                                                                  0788 02616000
         L     @01,PTRCPL                                          0788 02617000
         MVC   SAVCPL(28),FIELDR(@01)                              0788 02618000
*        /************************************************************/ 02619000
*        /*                                                  @Y30SSFR*/ 02620000
*        /*  WHEN THE FVT'S WERE CONSTRUCTED, DOUBLE THE AREA NEEDED */ 02621000
*        /*  WAS OBTAINED FOR THE FVT SAVE AREA              @Y30SSFR*/ 02622000
*        /*                                                  @Y30SSFR*/ 02623000
*        /************************************************************/ 02624000
*                                                                  0789 02625000
*        DO I = 1 TO NUMCOMP;                              /*@Y30SSFR*/ 02626000
         LA    I,1                                                 0789 02627000
         B     @DE00789                                            0789 02628000
@DL00789 DS    0H                                                  0790 02629000
*          SAVFVT(I) = FVTPTR(I) + TFVTLEN;                /*@Y30SSFR*/ 02630000
*                                                                  0790 02631000
         LR    @02,I                                               0790 02632000
         SLA   @02,2                                               0790 02633000
         LH    @15,TFVTLEN                                         0790 02634000
         AL    @15,FVTPTR-4(@02)                                   0790 02635000
         ST    @15,SAVFVT-4(@02)                                   0790 02636000
*          CALL MVDAPROC(TFVTLEN,FVTPTR(I),SAVFVT(I));     /*@Y30SSFR*/ 02637000
*                                                                  0791 02638000
         LA    @15,TFVTLEN                                         0791 02639000
         ST    @15,@AL00001                                        0791 02640000
         LA    @15,FVTPTR-4(@02)                                   0791 02641000
         ST    @15,@AL00001+4                                      0791 02642000
         LA    @02,SAVFVT-4(@02)                                   0791 02643000
         ST    @02,@AL00001+8                                      0791 02644000
         LA    @01,@AL00001                                        0791 02645000
         BAL   @14,MVDAPROC                                        0791 02646000
*        END;                                              /*@Y30SSFR*/ 02647000
*                                                                  0792 02648000
         AL    I,@CF00221                                          0792 02649000
@DE00789 CH    I,NUMCOMP                                           0792 02650000
         BNH   @DL00789                                            0792 02651000
*        /************************************************************/ 02652000
*        /*                                                  @Y30SSFR*/ 02653000
*        /*  INVOKE CATALOG MANAGEMENT TO DEFINE THE CLUSTER @Y30SSFR*/ 02654000
*        /*  OR AIX AND ITS COMPONENTS.                      @Y30SSFR*/ 02655000
*        /*  SET IMPF2NER TO BE ON TO INDICATE THAT CTLGPROC @Y30SSFR*/ 02656000
*        /*  IS NOT TO PRINT ANY MESSAGES FOR A VSAM         @Y30SSFR*/ 02657000
*        /*  CATALOG RETURN CODE OF 8.                       @Y30SSFR*/ 02658000
*        /*                                                  #Y30SSFR*/ 02659000
*        /************************************************************/ 02660000
*                                                                  0793 02661000
*        IMPF2NER = ON;                                    /*@Y30SSFR*/ 02662000
         OI    IMPF2NER,B'00001000'                                0793 02663000
*        CALL CTLGPROC(PTRCPL);                            /*#Y30SSFR*/ 02664000
         LA    @15,PTRCPL                                          0794 02665000
         ST    @15,@AL00001                                        0794 02666000
         LA    @01,@AL00001                                        0794 02667000
         BAL   @14,CTLGPROC                                        0794 02668000
*        RESPECIFY RTNREG RSTD;                                    0795 02669000
*        TESTRC = RTNREG;                                          0796 02670000
         LR    TESTRC,RTNREG                                       0796 02671000
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/ 02672000
*                                                                  0797 02673000
*        /************************************************************/ 02674000
*        /*                                                  @Y30SSFR*/ 02675000
*        /*  RESET IMPF2NER TO BE OFF.  ALL CATALOG ERROR    @Y30SSFR*/ 02676000
*        /*  MESSAGES ARE TO BE PRINTED ON ALL OTHER CALLS   @Y30SSFR*/ 02677000
*        /*  TO VSAM CATALOG MANAGEMENT.                     @Y30SSFR*/ 02678000
*        /*                                                  @Y30SSFR*/ 02679000
*        /************************************************************/ 02680000
*                                                                  0798 02681000
*        IMPF2NER = OFF;                                   /*@Y30SSFR*/ 02682000
         NI    IMPF2NER,B'11110111'                                0798 02683000
*        IF TESTRC ^= 0                                            0799 02684000
*          THEN                                                    0799 02685000
         LTR   TESTRC,TESTRC                                       0799 02686000
         BZ    @RF00799                                            0799 02687000
*DEFERR:     DO;                                           /*#Y30SSFR*/ 02688000
*                                                                  0800 02689000
DEFERR   DS    0H                                                  0801 02690000
*            /********************************************************/ 02691000
*            /*                                              #Y30SSFR*/ 02692000
*            /*  IF THE CATALOG RETURN CODE INDICATES A DUPLICATE    */ 02693000
*            /*  ENTRY NAME EXISTS, GO INVOKE THE PROCEDURE DUPNPROC */ 02694000
*            /*  TO SEE IF THE DUPLICATE ENTRY HAS THE TEMPORARY     */ 02695000
*            /*  EXPORT ATTRIBUTE OR IS EMPTY.               #Y30SSFR*/ 02696000
*            /*  IF THE CATALOG DEFINE FAILED FOR ANY OTHER REASON,  */ 02697000
*            /*  RETURN TO THE CALLING PROCESSOR             #Y30SSFR*/ 02698000
*            /*                                              #Y30SSFR*/ 02699000
*            /********************************************************/ 02700000
*                                                                  0801 02701000
*            IF CATLGRC ^= DUPNAME                                 0801 02702000
*              THEN                                                0801 02703000
         CLC   CATLGRC(2),@CH00039                                 0801 02704000
         BE    @RF00801                                            0801 02705000
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/ 02706000
         LA    @15,12                                              0802 02707000
         L     @14,@SA00002                                        0802 02708000
         LM    @00,@12,@SA00002+8                                  0802 02709000
         BR    @14                                                 0802 02710000
*              ELSE                                                0803 02711000
*DUPENT:         DO;                                       /*#Y30SSFR*/ 02712000
*                                                                  0803 02713000
@RF00801 DS    0H                                                  0803 02714000
DUPENT   DS    0H                                                  0804 02715000
*                /****************************************************/ 02716000
*                /*                                          #Y30SSFR*/ 02717000
*                /*  CALL DUPNPROC TO HANDLE DUPLICATE ENTRY #Y30SSFR*/ 02718000
*                /*  PROCESSING.                             #Y30SSFR*/ 02719000
*                /*                                          #Y30SSFR*/ 02720000
*                /****************************************************/ 02721000
*                                                                  0804 02722000
*                CALL DUPNPROC;                            /*#Y30SSFR*/ 02723000
*                                                                  0804 02724000
         BAL   @14,DUPNPROC                                        0804 02725000
*                RESPECIFY RTNREG RSTD;                            0805 02726000
*                TESTRC = RTNREG;                                  0806 02727000
         LR    TESTRC,RTNREG                                       0806 02728000
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/ 02729000
*                IF TESTRC ^= 0                                    0808 02730000
*                  THEN                                            0808 02731000
*                                                                  0808 02732000
         LTR   TESTRC,TESTRC                                       0808 02733000
         BZ    @RF00808                                            0808 02734000
*                    /************************************************/ 02735000
*                    /*                                      #Y30SSFR*/ 02736000
*                    /*  THE LOCATE OR DELETE OF THE DUPLICATE ENTRY */ 02737000
*                    /*  HAS FAILED.  RETURN WITH ERROR INDICATED.   */ 02738000
*                    /*                                      #Y30SSFR*/ 02739000
*                    /************************************************/ 02740000
*                                                                  0809 02741000
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/ 02742000
*                                                                  0809 02743000
         LA    @15,12                                              0809 02744000
         L     @14,@SA00002                                        0809 02745000
         LM    @00,@12,@SA00002+8                                  0809 02746000
         BR    @14                                                 0809 02747000
*                /****************************************************/ 02748000
*                /*                                          #Y30SSFR*/ 02749000
*                /*  TEST TO DETERMINE IF DUPNPROC FOUND A   #Y30SSFR*/ 02750000
*                /*  DEFINED EMPTY DATA SET WITH ATTRIBUTES  #Y30SSFR*/ 02751000
*                /*  CONSISTENT WITH THOSE OF THE DATA SET   #Y30SSFR*/ 02752000
*                /*  BEING IMPORTED.  IF NOT, THEN PROCEED   #Y30SSFR*/ 02753000
*                /*  TO CALL CATALOG AGAIN TO ATTEMPT        #Y30SSFR*/ 02754000
*                /*  ANOTHER DEFINE.                         #Y30SSFR*/ 02755000
*                /*                                          #Y30SSFR*/ 02756000
*                /****************************************************/ 02757000
*                                                                  0810 02758000
*                IF EMPTYDS = OFF                          /*#Y30SSFR*/ 02759000
*                  THEN                                    /*#Y30SSFR*/ 02760000
@RF00808 TM    EMPTYDS,B'10000000'                                 0810 02761000
         BNZ   @RF00810                                            0810 02762000
*DUPNM:              DO;                                   /*#Y30SSFR*/ 02763000
*                                                                  0811 02764000
DUPNM    DS    0H                                                  0812 02765000
*                    /************************************************/ 02766000
*                    /*                                      #Y30SSFR*/ 02767000
*                    /*  THE PREVIOUSLY EXISTING ENTRY HAS   #Y30SSFR*/ 02768000
*                    /*  BEEN DELETED.  RESTORE THE CPL TO   #Y30SSFR*/ 02769000
*                    /*  ITS STATE PRIOR TO INVOKING         #Y30SSFR*/ 02770000
*                    /*  CATALOG MANAGEMENT DEFINE.          #Y30SSFR*/ 02771000
*                    /*                                      #Y30SSFR*/ 02772000
*                    /************************************************/ 02773000
*                                                                  0812 02774000
*                    PTRCPL -> FIELDR(1:LENGTH(CTGPL)+16)  /*#Y30SSFR*/ 02775000
*                       = SAVCPL;                          /*#Y30SSFR*/ 02776000
*                                                                  0812 02777000
         L     @01,PTRCPL                                          0812 02778000
         MVI   FIELDR+28(@01),C' '                                 0812 02779000
         MVC   FIELDR+29(15,@01),FIELDR+28(@01)                    0812 02780000
         MVC   FIELDR(28,@01),SAVCPL                               0812 02781000
*                    DO I = 1 TO NUMCOMP;                  /*#Y30SSFR*/ 02782000
*                                                                  0813 02783000
         LA    I,1                                                 0813 02784000
         B     @DE00813                                            0813 02785000
@DL00813 DS    0H                                                  0814 02786000
*                      CALL MVDAPROC(TFVTLEN,SAVFVT(I),    /*#Y30SSFR*/ 02787000
*                          FVTPTR(I));                     /*#Y30SSFR*/ 02788000
*                                                                  0814 02789000
         LA    @02,TFVTLEN                                         0814 02790000
         ST    @02,@AL00001                                        0814 02791000
         LR    @02,I                                               0814 02792000
         SLA   @02,2                                               0814 02793000
         LA    @15,SAVFVT-4(@02)                                   0814 02794000
         ST    @15,@AL00001+4                                      0814 02795000
         LA    @02,FVTPTR-4(@02)                                   0814 02796000
         ST    @02,@AL00001+8                                      0814 02797000
         LA    @01,@AL00001                                        0814 02798000
         BAL   @14,MVDAPROC                                        0814 02799000
*                      /**********************************************/ 02800000
*                      /*                                    #Y30SSFR*/ 02801000
*                      /*  REINITIALIZE VOLUME SERIAL LIST   #Y30SSFR*/ 02802000
*                      /*  RETURN CODE FIELDS FOR DATA AND   #Y30SSFR*/ 02803000
*                      /*  INDEX COMPONENTS (IF EXISTANT).   #Y30SSFR*/ 02804000
*                      /*                                    #Y30SSFR*/ 02805000
*                      /**********************************************/ 02806000
*                                                                  0815 02807000
*                      CTGFVPTR = FVTPTR(I);               /*#Y30SSFR*/ 02808000
         LR    @02,I                                               0815 02809000
         SLA   @02,2                                               0815 02810000
         L     @02,FVTPTR-4(@02)                                   0815 02811000
         ST    @02,CTGFVPTR                                        0815 02812000
*                      IF  CTGFVVLT ^= NULLPTR             /*#Y30SSFR*/ 02813000
*                        THEN                              /*#Y30SSFR*/ 02814000
         L     @02,CTGFVVLT(,@02)                                  0816 02815000
         LTR   @02,@02                                             0816 02816000
         BZ    @RF00816                                            0816 02817000
*                          DO J = 1 TO                     /*#Y30SSFR*/ 02818000
*                             (FLISTLN/LENGTH(FVOLSERL));  /*#Y30SSFR*/ 02819000
         LA    J,1                                                 0817 02820000
         B     @DE00817                                            0817 02821000
@DL00817 DS    0H                                                  0818 02822000
*                            FVOLRTN(J) = 0;               /*#Y30SSFR*/ 02823000
         LR    @15,J                                               0818 02824000
         SLA   @15,3                                               0818 02825000
         L     @01,CTGFVPTR                                        0818 02826000
         L     @01,CTGFVVLT(,@01)                                  0818 02827000
         ALR   @01,@15                                             0818 02828000
         AL    @01,@CF01694                                        0818 02829000
         SLR   @00,@00                                             0818 02830000
         STCM  @00,3,FVOLRTN-2(@01)                                0818 02831000
*                          END;                            /*#Y30SSFR*/ 02832000
*                                                                  0819 02833000
         AL    J,@CF00221                                          0819 02834000
@DE00817 L     @01,CTGFVPTR                                        0819 02835000
         L     @01,CTGFVVLT(,@01)                                  0819 02836000
         LH    @00,FLISTLN(,@01)                                   0819 02837000
         SRDA  @00,32                                              0819 02838000
         D     @00,@CF00039                                        0819 02839000
         CR    J,@01                                               0819 02840000
         BNH   @DL00817                                            0819 02841000
*                      /**********************************************/ 02842000
*                      /*                                    #Y30SSFR*/ 02843000
*                      /*  IF A UNIQUE DATA SET DEFINED,     #Y30SSFR*/ 02844000
*                      /*  RESTORE THE VOLUME FVT.           #Y30SSFR*/ 02845000
*                      /*                                    #Y30SSFR*/ 02846000
*                      /**********************************************/ 02847000
*                                                                  0820 02848000
*                      IF (FVTPTR(1) -> CTGFVVCH) ^= NULLPTR       0820 02849000
*                        THEN                                      0820 02850000
@RF00816 L     @02,FVTPTR                                          0820 02851000
         L     @02,CTGFVVCH(,@02)                                  0820 02852000
         LTR   @02,@02                                             0820 02853000
         BZ    @RF00820                                            0820 02854000
*                          DO;                             /*#Y30SSFR*/ 02855000
*                          IUNIQFVT = ''B;                 /*#Y30SSFR*/ 02856000
         XC    IUNIQFVT(92),IUNIQFVT                               0822 02857000
*                          FVTPTR(1) -> CTGFVVCH -> CTGFVTYP       0823 02858000
*                             = CTGFVVOL;                  /*#Y30SSFR*/ 02859000
         MVI   CTGFVTYP(@02),C'V'                                  0823 02860000
*                          END;                            /*#Y30SSFR*/ 02861000
*                                                                  0824 02862000
*                    END;                                  /*#Y30SSFR*/ 02863000
*                                                                  0825 02864000
@RF00820 AL    I,@CF00221                                          0825 02865000
@DE00813 CH    I,NUMCOMP                                           0825 02866000
         BNH   @DL00813                                            0825 02867000
*                    /************************************************/ 02868000
*                    /*                                      #Y30SSFR*/ 02869000
*                    /*  INVOKE CATALOG MANAGEMENT TO DEFINE #Y30SSFR*/ 02870000
*                    /*  THE OBJECT.  IF DEFINE FAILS RETURN #Y30SSFR*/ 02871000
*                    /*  TO CALLING PROCESSOR.               #Y30SSFR*/ 02872000
*                    /*                                      #Y30SSFR*/ 02873000
*                    /************************************************/ 02874000
*                                                                  0826 02875000
*                    CTGPLPTR = PTRCPL;                    /*#Y30SSFR*/ 02876000
*                                                                  0826 02877000
         L     @15,PTRCPL                                          0826 02878000
         ST    @15,CTGPLPTR                                        0826 02879000
*                    CALL CTLGPROC(PTRCPL);                /*#Y30SSFR*/ 02880000
*                                                                  0827 02881000
         LA    @15,PTRCPL                                          0827 02882000
         ST    @15,@AL00001                                        0827 02883000
         LA    @01,@AL00001                                        0827 02884000
         BAL   @14,CTLGPROC                                        0827 02885000
*                    RESPECIFY RTNREG RSTD;                        0828 02886000
*                    TESTRC = RTNREG;                              0829 02887000
         LR    TESTRC,RTNREG                                       0829 02888000
*                    RESPECIFY RTNREG UNRSTD;              /*#Y30SSFR*/ 02889000
*                    IF TESTRC ^= 0                        /*#Y30SSFR*/ 02890000
*                      THEN                                /*#Y30SSFR*/ 02891000
         LTR   TESTRC,TESTRC                                       0831 02892000
         BZ    @RF00831                                            0831 02893000
*                        RETURN CODE(LASTCC12);            /*#Y30SSFR*/ 02894000
         LA    @15,12                                              0832 02895000
         L     @14,@SA00002                                        0832 02896000
         LM    @00,@12,@SA00002+8                                  0832 02897000
         BR    @14                                                 0832 02898000
*                    END DUPNM;                            /*#Y30SSFR*/ 02899000
@RF00831 DS    0H                                                  0834 02900000
*              END DUPENT;                                 /*#Y30SSFR*/ 02901000
@RF00810 DS    0H                                                  0835 02902000
*            END DEFERR;                                   /*#Y30SSFR*/ 02903000
*                                                                  0835 02904000
*        IF EMPTYDS = OFF                                  /*#Y30SSFR*/ 02905000
*          THEN                                            /*#Y30SSFR*/ 02906000
@RF00799 TM    EMPTYDS,B'10000000'                                 0836 02907000
         BNZ   @RF00836                                            0836 02908000
*NEMPDS:     DO;                                           /*#Y30SSFR*/ 02909000
*                                                                  0837 02910000
NEMPDS   DS    0H                                                  0838 02911000
*            /********************************************************/ 02912000
*            /*                                              #Y30SSFR*/ 02913000
*            /*  CHECK TO SEE IF A RECOVERY VOLSER HAS BEEN  #Y30SSFR*/ 02914000
*            /*  RETURNED BY CATALOG.  IF SO, PRINT IT.      #Y30SSFR*/ 02915000
*            /*                                              #Y30SSFR*/ 02916000
*            /********************************************************/ 02917000
*                                                                  0838 02918000
*            DARGSMOD = DEFMODID;                          /*#Y30SSFR*/ 02919000
         L     @15,DDSTRU                                          0838 02920000
         MVC   DARGSMOD(3,@15),@CC01038                            0838 02921000
*            IF CATRCWKA ^= ZEROS                          /*#Y30SSFR*/ 02922000
*              THEN                                        /*#Y30SSFR*/ 02923000
         CLC   CATRCWKA(6),ZEROS                                   0839 02924000
         BE    @RF00839                                            0839 02925000
*                DO;                                       /*#Y30SSFR*/ 02926000
*                DARGSENT = RCVYVOLM;                      /*#Y30SSFR*/ 02927000
         MVI   DARGSENT(@15),X'15'                                 0841 02928000
*                DARGILP = LENGTH(CATRCWKA);               /*#Y30SSFR*/ 02929000
         MVC   DARGILP(2,@15),@CH00159                             0842 02930000
*                DARGDBP = ADDR(CATRCWKA);                 /*#Y30SSFR*/ 02931000
*                                                                  0843 02932000
         LA    @14,CATRCWKA                                        0843 02933000
         ST    @14,DARGDBP(,@15)                                   0843 02934000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*#Y30SSFR*/ 02935000
*                                                                  0844 02936000
         L     @15,@PC00001                                        0844 02937000
         ST    @15,@AL00001                                        0844 02938000
         LA    @14,@CF00118                                        0844 02939000
         ST    @14,@AL00001+4                                      0844 02940000
         LA    @14,DDSTRU                                          0844 02941000
         ST    @14,@AL00001+8                                      0844 02942000
         MVI   @AL00001+8,X'80'                                    0844 02943000
         L     @15,GDTPRT(,@15)                                    0844 02944000
         LA    @01,@AL00001                                        0844 02945000
         BALR  @14,@15                                             0844 02946000
*                END;                                      /*#Y30SSFR*/ 02947000
*                                                                  0845 02948000
*            /********************************************************/ 02949000
*            /*                                              #Y30SSFR*/ 02950000
*            /*  CLUSTER HAS BEEN DEFINED SUCCESSFULLY.      #Y30SSFR*/ 02951000
*            /*  ISSUE ALLOCATION MESSAGES                   #Y30SSFR*/ 02952000
*            /*                                              #Y30SSFR*/ 02953000
*            /********************************************************/ 02954000
*                                                                  0846 02955000
*            DARGSENT = VOLDATA;                           /*#Y30SSFR*/ 02956000
@RF00839 L     @01,DDSTRU                                          0846 02957000
         MVI   DARGSENT(@01),X'09'                                 0846 02958000
*            CTGFVPTR = CTGFVT -> CTGFVDCH;                /*#Y30SSFR*/ 02959000
*                                                                  0847 02960000
         L     @01,CTGPLPTR                                        0847 02961000
         L     @01,CTGFVT(,@01)                                    0847 02962000
         L     @15,CTGFVDCH(,@01)                                  0847 02963000
         ST    @15,CTGFVPTR                                        0847 02964000
*            /********************************************************/ 02965000
*            /*                                              #Y30SSFR*/ 02966000
*            /*  FIRST ISSUE THE VOLUME ALLOCATION MESSAGE   #Y30SSFR*/ 02967000
*            /*  FOR THE DATA COMPONENT AND THEN FOR THE     #Y30SSFR*/ 02968000
*            /*  INDEX IF ANY EXISTS.  ONE CALL TO THE TEXT  #Y30SSFR*/ 02969000
*            /*  PROCESSOR WILL PRINT THE ENTIRE VOLUME      #Y30SSFR*/ 02970000
*            /*  FOR ONE COMPONENT.                          #Y30SSFR*/ 02971000
*            /*                                              #Y30SSFR*/ 02972000
*            /********************************************************/ 02973000
*                                                                  0848 02974000
*            DO I = 2 TO NUMCOMP;                          /*#Y30SSFR*/ 02975000
         LA    I,2                                                 0848 02976000
         B     @DE00848                                            0848 02977000
@DL00848 DS    0H                                                  0849 02978000
*              IF CTGFVVLT ^= NULLPTR                              0849 02979000
*                THEN                                              0849 02980000
         L     @02,CTGFVPTR                                        0849 02981000
         L     @02,CTGFVVLT(,@02)                                  0849 02982000
         LTR   @02,@02                                             0849 02983000
         BZ    @RF00849                                            0849 02984000
*                  DO;                                     /*#Y30SSFR*/ 02985000
*                  DARGDBP = CTGFVVLT + 2;                 /*#Y30SSFR*/ 02986000
         L     @15,DDSTRU                                          0851 02987000
         LA    @14,2                                               0851 02988000
         ALR   @14,@02                                             0851 02989000
         ST    @14,DARGDBP(,@15)                                   0851 02990000
*                  DARGILP = CTGFVVLT -> FLISTLN;          /*#Y30SSFR*/ 02991000
         LH    @02,FLISTLN(,@02)                                   0852 02992000
         STH   @02,DARGILP(,@15)                                   0852 02993000
*                  DARGCNT = 1;                            /*#Y30SSFR*/ 02994000
         LA    @14,1                                               0853 02995000
         STH   @14,DARGCNT(,@15)                                   0853 02996000
*                  DARGINS(1) = 1;                         /*#Y30SSFR*/ 02997000
         STH   @14,DARGINS(,@15)                                   0854 02998000
*                  DARGPCT(1) = DARGILP/8;                 /*#Y30SSFR*/ 02999000
*                                                                  0855 03000000
         LR    @00,@02                                             0855 03001000
         SRDA  @00,32                                              0855 03002000
         D     @00,@CF00039                                        0855 03003000
         STH   @01,DARGPCT(,@15)                                   0855 03004000
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   /*#Y30SSFR*/ 03005000
*                                                                  0856 03006000
         L     @02,@PC00001                                        0856 03007000
         ST    @02,@AL00001                                        0856 03008000
         LA    @15,@CF00118                                        0856 03009000
         ST    @15,@AL00001+4                                      0856 03010000
         LA    @15,DDSTRU                                          0856 03011000
         ST    @15,@AL00001+8                                      0856 03012000
         MVI   @AL00001+8,X'80'                                    0856 03013000
         L     @15,GDTPRT(,@02)                                    0856 03014000
         LA    @01,@AL00001                                        0856 03015000
         BALR  @14,@15                                             0856 03016000
*                  END;                                    /*#Y30SSFR*/ 03017000
*              CTGFVPTR = CTGFVT -> CTGFVICH;              /*#Y30SSFR*/ 03018000
@RF00849 L     @02,CTGPLPTR                                        0858 03019000
         L     @02,CTGFVT(,@02)                                    0858 03020000
         L     @02,CTGFVICH(,@02)                                  0858 03021000
         ST    @02,CTGFVPTR                                        0858 03022000
*              DARGSENT = VOLINDEX;                        /*#Y30SSFR*/ 03023000
         L     @02,DDSTRU                                          0859 03024000
         MVI   DARGSENT(@02),X'0A'                                 0859 03025000
*            END;                                          /*#Y30SSFR*/ 03026000
*                                                                  0860 03027000
         AL    I,@CF00221                                          0860 03028000
@DE00848 CH    I,NUMCOMP                                           0860 03029000
         BNH   @DL00848                                            0860 03030000
*            END NEMPDS;                                   /*#Y30SSFR*/ 03031000
*                                                                  0861 03032000
*        DARGSMOD=IMPMSG;                                  /*#Y30SSFR*/ 03033000
*                                                                  0862 03034000
@RF00836 L     @01,DDSTRU                                          0862 03035000
         MVC   DARGSMOD(3,@01),@CC01000                            0862 03036000
*        /************************************************************/ 03037000
*        /*                                                  #Y30SSFR*/ 03038000
*        /* DEALLOCATE VOLUMES WHICH HAVE BEEN DYNAMICALLY ALLOCATED */ 03039000
*        /*                                                  #Y30SSFR*/ 03040000
*        /************************************************************/ 03041000
*                                                                  0863 03042000
*        IF DALCINDX > 0                                           0863 03043000
*          THEN                                                    0863 03044000
*                                                                  0863 03045000
         L     @15,DALCINDX                                        0863 03046000
         LTR   @15,@15                                             0863 03047000
         BNP   @RF00863                                            0863 03048000
*            CALL DALCPROC ('D',                                   0864 03049000
*                            NULLPARM,NULLPARM,DALCINDX);  /*#Y30SSFR*/ 03050000
*                                                                  0864 03051000
         MVC   @AL00001(12),@AL00864                               0864 03052000
         LA    @15,DALCINDX                                        0864 03053000
         ST    @15,@AL00001+12                                     0864 03054000
         LA    @01,@AL00001                                        0864 03055000
         BAL   @14,DALCPROC                                        0864 03056000
*        /************************************************************/ 03057000
*        /*                                                  @Y30SSFR*/ 03058000
*        /*  ATTEMPT TO QUALIFY THE OUTPUT DATA SET NAME,    @Y30SSFR*/ 03059000
*        /*  IF NECESSARY.                                   @Y30SSFR*/ 03060000
*        /*                                                  @Y30SSFR*/ 03061000
*        /************************************************************/ 03062000
*                                                                  0865 03063000
*        IF OUTDSFUQ = ON & ADDR(OUTDS) ^= NULLPTR                 0865 03064000
*          THEN                                                    0865 03065000
@RF00863 L     @15,@PC00001+4                                      0865 03066000
         L     @15,FDTPTR+96(,@15)                                 0865 03067000
         TM    OUTDSFUQ(@15),B'10000000'                           0865 03068000
         BNO   @RF00865                                            0865 03069000
         LTR   @15,@15                                             0865 03070000
         BZ    @RF00865                                            0865 03071000
*            DO;                                           /*@Y30SSFR*/ 03072000
*            QUALLIST = ''B;                               /*@Y30SSFR*/ 03073000
         XC    QUALLIST(12),QUALLIST                               0867 03074000
*            QUALADDR = ADDR(OUTDSNAM);                    /*@Y30SSFR*/ 03075000
         LA    @14,OUTDSNAM                                        0868 03076000
         ST    @14,QUALADDR                                        0868 03077000
*            IF OUTDSPLN ^= NULLPTR                                0869 03078000
*              THEN                                                0869 03079000
         CLI   OUTDSPLN(@15),0                                     0869 03080000
         BE    @RF00869                                            0869 03081000
*                QUALPAS = ADDR(OUTDSPAS);                 /*@Y30SSFR*/ 03082000
*                                                                  0870 03083000
         LA    @15,OUTDSPAS(,@15)                                  0870 03084000
         ST    @15,QUALPAS                                         0870 03085000
*            CALL IDCSAQL0(GDTTBL,QUALADDR,OUTDSNLN,QUALCAT,QUALPAS);   03086000
@RF00869 L     @03,@PC00001                                        0871 03087000
         ST    @03,@AL00001                                        0871 03088000
         LA    @15,QUALADDR                                        0871 03089000
         ST    @15,@AL00001+4                                      0871 03090000
         LA    @15,OUTDSNLN                                        0871 03091000
         ST    @15,@AL00001+8                                      0871 03092000
         LA    @15,QUALCAT                                         0871 03093000
         ST    @15,@AL00001+12                                     0871 03094000
         LA    @15,QUALPAS                                         0871 03095000
         ST    @15,@AL00001+16                                     0871 03096000
         MVI   @AL00001+16,X'80'                                   0871 03097000
         L     @15,GDTQAL(,@03)                                    0871 03098000
         LA    @01,@AL00001                                        0871 03099000
         BALR  @14,@15                                             0871 03100000
*                                                          /*@Y30SSFR*/ 03101000
*            RESPECIFY RTNREG RSTD;                                0872 03102000
*            TESTRC = RTNREG;                                      0873 03103000
         LR    TESTRC,RTNREG                                       0873 03104000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 03105000
*            IF TESTRC ^= 0                                        0875 03106000
*              THEN                                                0875 03107000
         LTR   TESTRC,TESTRC                                       0875 03108000
         BZ    @RF00875                                            0875 03109000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 03110000
         LA    @15,12                                              0876 03111000
         L     @14,@SA00002                                        0876 03112000
         LM    @00,@12,@SA00002+8                                  0876 03113000
         BR    @14                                                 0876 03114000
*            END;                                          /*@Y30SSFR*/ 03115000
*                                                                  0877 03116000
@RF00875 DS    0H                                                  0878 03117000
*        /************************************************************/ 03118000
*        /*                                                  #Y30SSFR*/ 03119000
*        /*  ALLOCATE THE CLUSTER IF                         #Y30SSFR*/ 03120000
*        /*  IT WAS NOT ALLOCATED BY JCL                     #Y30SSFR*/ 03121000
*        /*                                                  #Y30SSFR*/ 03122000
*        /************************************************************/ 03123000
*                                                                  0878 03124000
*        IF ADDR(OUTDS) ^= NULLPTR                                 0878 03125000
*          THEN                                                    0878 03126000
@RF00865 L     @15,@PC00001+4                                      0878 03127000
         L     @15,FDTPTR+96(,@15)                                 0878 03128000
         LTR   @15,@15                                             0878 03129000
         BZ    @RF00878                                            0878 03130000
*            DO;                                           /*#Y30SSFR*/ 03131000
*              ALLPTR = ADDR(ALLLIST);                     /*#Y30SSFR*/ 03132000
         LA    @14,ALLLIST                                         0880 03133000
         ST    @14,ALLPTR                                          0880 03134000
*              ALLAGL = ''B;                               /*#Y30SSFR*/ 03135000
         XC    ALLAGL(31,@14),ALLAGL(@14)                          0881 03136000
*              ALLDSN = ADDR(OUTDSNAM);                    /*#Y30SSFR*/ 03137000
         LA    @05,OUTDSNAM                                        0882 03138000
         ST    @05,ALLDSN(,@14)                                    0882 03139000
*              IF OUTDSPLN ^= 0                                    0883 03140000
*                THEN                                              0883 03141000
         CLI   OUTDSPLN(@15),0                                     0883 03142000
         BE    @RF00883                                            0883 03143000
*                  ALLPWD = ADDR(OUTDSPAS);                /*#Y30SSFR*/ 03144000
         LA    @15,OUTDSPAS(,@15)                                  0884 03145000
         ST    @15,ALLPWD(,@14)                                    0884 03146000
*              ALLOPTVL = OFF;                             /*#Y30SSFR*/ 03147000
@RF00883 DS    0H                                                  0886 03148000
*              ALLOPTDS = ON;                              /*#Y30SSFR*/ 03149000
         L     @03,ALLPTR                                          0886 03150000
         OI    ALLOPTDS(@03),B'01000000'                           0886 03151000
         NI    ALLOPTVL(@03),B'01111111'                           0886 03152000
*              ALLSTSOD = ON;                              /*#Y30SSFR*/ 03153000
         OI    ALLSTSOD(@03),B'00000001'                           0887 03154000
*              ALLDSPKP = ON;                              /*#Y30SSFR*/ 03155000
         OI    ALLDSPKP(@03),B'00001000'                           0888 03156000
*              CALL IDCSAAL0(GDTTBL,ALLAGL);               /*#Y30SSFR*/ 03157000
         L     @15,@PC00001                                        0889 03158000
         ST    @15,@AL00001                                        0889 03159000
         ST    @03,@AL00001+4                                      0889 03160000
         MVI   @AL00001+4,X'80'                                    0889 03161000
         L     @15,GDTALC(,@15)                                    0889 03162000
         LA    @01,@AL00001                                        0889 03163000
         BALR  @14,@15                                             0889 03164000
*              RESPECIFY RTNREG RSTD;                              0890 03165000
*              TESTRC = RTNREG;                                    0891 03166000
         LR    TESTRC,RTNREG                                       0891 03167000
*              RESPECIFY RTNREG UNRSTD;                    /*#Y30SSFR*/ 03168000
*              IF TESTRC = 0                                       0893 03169000
*                THEN                                              0893 03170000
         LTR   TESTRC,TESTRC                                       0893 03171000
         BNZ   @RF00893                                            0893 03172000
*                    DEALLOC = ON;                         /*#Y30SSFR*/ 03173000
         OI    DEALLOC,B'10000000'                                 0894 03174000
*                ELSE                                              0895 03175000
*                  RETURN CODE(LASTCC12);                  /*#Y30SSFR*/ 03176000
         B     @RC00893                                            0895 03177000
@RF00893 LA    @15,12                                              0895 03178000
         L     @14,@SA00002                                        0895 03179000
         LM    @00,@12,@SA00002+8                                  0895 03180000
         BR    @14                                                 0895 03181000
*            END;                                          /*#Y30SSFR*/ 03182000
*                                                                  0896 03183000
@RC00893 DS    0H                                                  0897 03184000
*        /*                                                  @Z40RSSA*/ 03185000
*        /*  IF DUPNPROC FOUND AN EMPTY DATA SET, DETERMINE  @Z40RSSA*/ 03186000
*        /* IF THE 'INTOEMPTY' PARAMETER WAS USED.  IF NOT   @Z40RSSA*/ 03187000
*        /*  ISSUE AN ERROR MESSAGE.                         @Z40RSSA*/ 03188000
*        /*                                                  @Z40RSSA*/ 03189000
*        IF EMPTYDS = ON & ADDR (IMPTY) = 0 THEN           /*@Z40RSSA*/ 03190000
@RF00878 TM    EMPTYDS,B'10000000'                                 0897 03191000
         BNO   @RF00897                                            0897 03192000
         L     @15,@PC00001+4                                      0897 03193000
         L     @15,FDTPTR+132(,@15)                                0897 03194000
         LTR   @15,@15                                             0897 03195000
         BNZ   @RF00897                                            0897 03196000
*              DO;                                         /*@Z40RSSA*/ 03197000
*                DARGLIST = ''B;                           /*@Z40RSSA*/ 03198000
         L     @15,DDSTRU                                          0899 03199000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0899 03200000
*                DARGSMOD = IMPMSG;                        /*@Z40RSSA*/ 03201000
         MVC   DARGSMOD(3,@15),@CC01000                            0900 03202000
*                DARGSENT = NEMPTYKW;                      /*@Z40RSSA*/ 03203000
         MVI   DARGSENT(@15),X'19'                                 0901 03204000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Z40RSSA*/ 03205000
         L     @15,@PC00001                                        0902 03206000
         ST    @15,@AL00001                                        0902 03207000
         LA    @14,@CF00118                                        0902 03208000
         ST    @14,@AL00001+4                                      0902 03209000
         LA    @14,DDSTRU                                          0902 03210000
         ST    @14,@AL00001+8                                      0902 03211000
         MVI   @AL00001+8,X'80'                                    0902 03212000
         L     @15,GDTPRT(,@15)                                    0902 03213000
         LA    @01,@AL00001                                        0902 03214000
         BALR  @14,@15                                             0902 03215000
*                RETURN CODE(LASTCC12);                    /*@Z40RSSA*/ 03216000
         LA    @15,12                                              0903 03217000
         L     @14,@SA00002                                        0903 03218000
         LM    @00,@12,@SA00002+8                                  0903 03219000
         BR    @14                                                 0903 03220000
*              END;                                        /*@Z40RSSA*/ 03221000
*                                                                  0904 03222000
*        /************************************************************/ 03223000
*        /*  LOOP DEFINING THE PATHS THAT WERE EXPORTED WITH #Y30SSFR*/ 03224000
*        /*  THE DATA SET.  SHOULD ANY CMS DEFINE FAIL,      #Y30SSFR*/ 03225000
*        /*  SIMPLY GO ON TO THE NEXT PATH.                  #Y30SSFR*/ 03226000
*        /*                                                  #Y30SSFR*/ 03227000
*        /************************************************************/ 03228000
*                                                                  0905 03229000
*        /************************************************************/ 03230000
*        /*                                                  #Y30SSFR*/ 03231000
*        /*  TEST FOR THE PRESENCE OF PATH ASSOCIATIONS ON   #Y30SSFR*/ 03232000
*        /*  THE PORTABILITY DATA SET.                       #Y30SSFR*/ 03233000
*        /*                                                  #Y30SSFR*/ 03234000
*        /************************************************************/ 03235000
*                                                                  0905 03236000
*        IF IMPASSOC = ON                                  /*#Y30SSFR*/ 03237000
*          THEN                                            /*#Y30SSFR*/ 03238000
@RF00897 TM    IMPASSOC,B'00100000'                                0905 03239000
         BNO   @RF00905                                            0905 03240000
*PATHDEF:    DO;                                           /*#Y30SSFR*/ 03241000
*                                                                  0906 03242000
PATHDEF  DS    0H                                                  0907 03243000
*            /********************************************************/ 03244000
*            /*                                              #Y30SSFR*/ 03245000
*            /*  BUILD AND SAVE THE CPL USED TO DEFINE       #Y30SSFR*/ 03246000
*            /*  ALL OF THE PATHS ON THE PORTABILITY         #Y30SSFR*/ 03247000
*            /*  DATA SET.                                   #Y30SSFR*/ 03248000
*            /*                                              #Y30SSFR*/ 03249000
*            /********************************************************/ 03250000
*                                                                  0907 03251000
*            CALL CPLPROC('F',PPTRCPL,NULLPARM,NULLPARM,   /*#Y30SSFR*/ 03252000
*               NULLPARM);                                 /*#Y30SSFR*/ 03253000
*                                                                  0907 03254000
         MVC   @AL00001(20),@AL00907                               0907 03255000
         LA    @15,PPTRCPL                                         0907 03256000
         ST    @15,@AL00001+4                                      0907 03257000
         LA    @01,@AL00001                                        0907 03258000
         BAL   @14,CPLPROC                                         0907 03259000
*            RESPECIFY RTNREG RSTD;                                0908 03260000
*            TESTRC = RTNREG;                                      0909 03261000
         LR    TESTRC,RTNREG                                       0909 03262000
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/ 03263000
*                                                                  0910 03264000
*            IF TESTRC ^= 0                                /*#Y30SSFR*/ 03265000
*              THEN                                        /*#Y30SSFR*/ 03266000
         LTR   TESTRC,TESTRC                                       0911 03267000
         BZ    @RF00911                                            0911 03268000
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/ 03269000
*                                                                  0912 03270000
         LA    @15,12                                              0912 03271000
         L     @14,@SA00002                                        0912 03272000
         LM    @00,@12,@SA00002+8                                  0912 03273000
         BR    @14                                                 0912 03274000
*            CTGPLPTR = PPTRCPL;                           /*#Y30SSFR*/ 03275000
@RF00911 L     @15,PPTRCPL                                         0913 03276000
         ST    @15,CTGPLPTR                                        0913 03277000
*            PSAVCPL = CTGPL;                              /*#Y30SSFR*/ 03278000
*                                                                  0914 03279000
         MVC   PSAVCPL(28),CTGPL(@15)                              0914 03280000
*            /********************************************************/ 03281000
*            /*                                              #Y30SSFR*/ 03282000
*            /*  SET THE TOTAL LENGTH OF THE WORK AREA TO 0, #Y30SSFR*/ 03283000
*            /*  AND TURN OFF THE FLAG INDICATING THAT CORE  #Y30SSFR*/ 03284000
*            /*  HAS BEEN GOTTEN FOR IT.                     #Y30SSFR*/ 03285000
*            /*                                              #Y30SSFR*/ 03286000
*            /********************************************************/ 03287000
*                                                                  0915 03288000
*            TOTLEN = 0;                                   /*#Y30SSFR*/ 03289000
         SLR   @15,@15                                             0915 03290000
         ST    @15,TOTLEN                                          0915 03291000
*            PCOREFLG = OFF;                               /*#Y30SSFR*/ 03292000
*                                                                  0916 03293000
         NI    PCOREFLG,B'01111111'                                0916 03294000
*            /********************************************************/ 03295000
*            /*                                              #Y30SSFR*/ 03296000
*            /*  DEFINE EACH PATH FROM THE PORTABILITY DATA  #Y30SSFR*/ 03297000
*            /*  SET.  SHOULD ANY DEFINE FAIL, GO ON TO THE  #Y30SSFR*/ 03298000
*            /*  NEXT PATH.                                  #Y30SSFR*/ 03299000
*            /*                                              #Y30SSFR*/ 03300000
*            /********************************************************/ 03301000
*                                                                  0917 03302000
*PATHLOOP:   DO I = NUMCOMP+1 TO NUMOBJ;                   /*#Y30SSFR*/ 03303000
*                                                                  0917 03304000
PATHLOOP LA    I,1                                                 0917 03305000
         AH    I,NUMCOMP                                           0917 03306000
         B     @DE00917                                            0917 03307000
@DL00917 DS    0H                                                  0918 03308000
*              /******************************************************/ 03309000
*              /*                                            #Y30SSFR*/ 03310000
*              /*  RESET THE FLAG THAT INDICATES THE CATALOG #Y30SSFR*/ 03311000
*              /*  DEFINE OPERATION IS TO BE SKIPPED         #Y30SSFR*/ 03312000
*              /*                                            #Y30SSFR*/ 03313000
*              /******************************************************/ 03314000
*                                                                  0918 03315000
*              IMPF2NOD = OFF;                             /*#Y30SSFR*/ 03316000
*                                                                  0918 03317000
         NI    IMPF2NOD,B'11101111'                                0918 03318000
*              /******************************************************/ 03319000
*              /*                                            #Y30SSFR*/ 03320000
*              /*  RESTORE THE CPL AND READ IN THE CONTROL   #Y30SSFR*/ 03321000
*              /*  RECORD FOR THE PATH TO BE DEFINED.        #Y30SSFR*/ 03322000
*              /*                                            #Y30SSFR*/ 03323000
*              /******************************************************/ 03324000
*                                                                  0919 03325000
*              CTGPL = PSAVCPL;                            /*#Y30SSFR*/ 03326000
*                                                                  0919 03327000
         L     @01,CTGPLPTR                                        0919 03328000
         MVC   CTGPL(28,@01),PSAVCPL                               0919 03329000
*              CALL IDCIOGT0(GDTTBL,PINIOCS);              /*#Y30SSFR*/ 03330000
*                                                                  0920 03331000
         L     @15,@PC00001                                        0920 03332000
         ST    @15,@AL00001                                        0920 03333000
         LA    @14,PINIOCS                                         0920 03334000
         ST    @14,@AL00001+4                                      0920 03335000
         MVI   @AL00001+4,X'80'                                    0920 03336000
         L     @15,GDTGET(,@15)                                    0920 03337000
         LA    @01,@AL00001                                        0920 03338000
         BALR  @14,@15                                             0920 03339000
*              RESPECIFY RTNREG RSTD;                              0921 03340000
*              TESTRC = RTNREG;                                    0922 03341000
         LR    TESTRC,RTNREG                                       0922 03342000
*              RESPECIFY RTNREG UNRSTD;                    /*#Y30SSFR*/ 03343000
*                                                                  0923 03344000
*              IF TESTRC ^= 0                              /*#Y30SSFR*/ 03345000
*                THEN                                      /*#Y30SSFR*/ 03346000
         LTR   TESTRC,TESTRC                                       0924 03347000
         BZ    @RF00924                                            0924 03348000
*                  RETURN CODE(LASTCC12);                  /*#Y30SSFR*/ 03349000
*                                                                  0925 03350000
         LA    @15,12                                              0925 03351000
         L     @14,@SA00002                                        0925 03352000
         LM    @00,@12,@SA00002+8                                  0925 03353000
         BR    @14                                                 0925 03354000
*              /******************************************************/ 03355000
*              /*                                            #Y30SSFR*/ 03356000
*              /*  MOVE THE CONTROL RECORD                   #Y30SSFR*/ 03357000
*              /*                                            #Y30SSFR*/ 03358000
*              /******************************************************/ 03359000
*                                                                  0926 03360000
*              TFVTLEN = IOCDAD -> HEADLN;                 /*#Y30SSFR*/ 03361000
*                                                                  0926 03362000
@RF00924 L     @02,IOCSPTR                                         0926 03363000
         L     @01,IOCDAD(,@02)                                    0926 03364000
         LH    @15,HEADLN(,@01)                                    0926 03365000
         STH   @15,TFVTLEN                                         0926 03366000
*              CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);     /*#Y30SSFR*/ 03367000
*                                                                  0927 03368000
         LA    @15,TFVTLEN                                         0927 03369000
         ST    @15,@AL00001                                        0927 03370000
         ST    @02,@AL00001+4                                      0927 03371000
         LA    @02,CONRCPTR                                        0927 03372000
         ST    @02,@AL00001+8                                      0927 03373000
         LA    @01,@AL00001                                        0927 03374000
         BAL   @14,MVDAPROC                                        0927 03375000
*              /******************************************************/ 03376000
*              /*                                            #Y30SSFR*/ 03377000
*              /*  TEST THE HEADER FLAG TO MAKE SURE THAT    #Y30SSFR*/ 03378000
*              /*  WE HAVE A CATALOG RECORD.                 #Y30SSFR*/ 03379000
*              /*                                            #Y30SSFR*/ 03380000
*              /******************************************************/ 03381000
*                                                                  0928 03382000
*              IF HEADFLG1 = HDFL1CAT                      /*#Y30SSFR*/ 03383000
*                THEN                                      /*#Y30SSFR*/ 03384000
         L     @02,CONRCPTR                                        0928 03385000
         CLI   HEADFLG1(@02),X'FF'                                 0928 03386000
         BNE   @RF00928                                            0928 03387000
*CATHDFLG:         DO;                                     /*#Y30SSFR*/ 03388000
*                                                                  0929 03389000
CATHDFLG DS    0H                                                  0930 03390000
*                  /**************************************************/ 03391000
*                  /*                                        #Y30SSFR*/ 03392000
*                  /*  GET STORAGE FOR THE CATALOG WORK AREA #Y30SSFR*/ 03393000
*                  /*  IF THE CURRENT WORK AREA IS TOO SMALL #Y30SSFR*/ 03394000
*                  /*                                        #Y30SSFR*/ 03395000
*                  /**************************************************/ 03396000
*                                                                  0930 03397000
*                  IF ASSRECLN > TOTLEN                            0930 03398000
*                    THEN                                          0930 03399000
         L     @02,CONRCPTR                                        0930 03400000
         LH    @02,ASSRECLN(,@02)                                  0930 03401000
         C     @02,TOTLEN                                          0930 03402000
         BNH   @RF00930                                            0930 03403000
*                      DO;                                 /*#Y30SSFR*/ 03404000
*                                                                  0931 03405000
*                      /**********************************************/ 03406000
*                      /*                                    #Y30SSFR*/ 03407000
*                      /*  IF CORE HAS BEEN GOTTEN FOR THE   #Y30SSFR*/ 03408000
*                      /*  WORK AREA PREVIOUSLY, FREE IT.    #Y30SSFR*/ 03409000
*                      /*                                    #Y30SSFR*/ 03410000
*                      /**********************************************/ 03411000
*                                                                  0932 03412000
*                      IF PCOREFLG = ON                            0932 03413000
*                        THEN                                      0932 03414000
         TM    PCOREFLG,B'10000000'                                0932 03415000
         BNO   @RF00932                                            0932 03416000
*                          CALL IDCSAFS0(GDTTBL,PWORKAR);  /*#Y30SSFR*/ 03417000
*                                                                  0933 03418000
         L     @02,@PC00001                                        0933 03419000
         ST    @02,@AL00001                                        0933 03420000
         LA    @15,PWORKAR                                         0933 03421000
         ST    @15,@AL00001+4                                      0933 03422000
         L     @15,GDTFSP(,@02)                                    0933 03423000
         LA    @01,@AL00001                                        0933 03424000
         BALR  @14,@15                                             0933 03425000
*                      PCOREFLG = ON;                      /*#Y30SSFR*/ 03426000
@RF00932 OI    PCOREFLG,B'10000000'                                0934 03427000
*                      TOTLEN = ASSRECLN;                  /*#Y30SSFR*/ 03428000
*                                                                  0935 03429000
         L     @01,CONRCPTR                                        0935 03430000
         LH    @15,ASSRECLN(,@01)                                  0935 03431000
         ST    @15,TOTLEN                                          0935 03432000
*                      CALL IDCSAGP0(GDTTBL,TOTLEN,PWORKAR,GPID,/* 0936 03433000
*                                                            #Y30SSFR*/ 03434000
*                       SETZERO);                          /*#Y30SSFR*/ 03435000
*                                                                  0936 03436000
         L     @15,@PC00001                                        0936 03437000
         ST    @15,@AL00001                                        0936 03438000
         LA    @14,TOTLEN                                          0936 03439000
         ST    @14,@AL00001+4                                      0936 03440000
         LA    @14,PWORKAR                                         0936 03441000
         ST    @14,@AL00001+8                                      0936 03442000
         LA    @14,GPID                                            0936 03443000
         ST    @14,@AL00001+12                                     0936 03444000
         LA    @14,SETZERO                                         0936 03445000
         ST    @14,@AL00001+16                                     0936 03446000
         MVI   @AL00001+16,X'80'                                   0936 03447000
         L     @15,GDTGPL(,@15)                                    0936 03448000
         LA    @01,@AL00001                                        0936 03449000
         BALR  @14,@15                                             0936 03450000
*                      RESPECIFY RTNREG RSTD;                      0937 03451000
*                      TESTRC = RTNREG;                            0938 03452000
         LR    TESTRC,RTNREG                                       0938 03453000
*                      RESPECIFY RTNREG UNRSTD;            /*#Y30SSFR*/ 03454000
*                                                                  0939 03455000
*                      IF TESTRC ^= 0                      /*#Y30SSFR*/ 03456000
*                        THEN                              /*#Y30SSFR*/ 03457000
         LTR   TESTRC,TESTRC                                       0940 03458000
         BZ    @RF00940                                            0940 03459000
*                          DO;                             /*#Y30SSFR*/ 03460000
*                          DARGSMOD = UNIVMSG;             /*#Y30SSFR*/ 03461000
         L     @01,DDSTRU                                          0942 03462000
         MVC   DARGSMOD(3,@01),@CC01023                            0942 03463000
*                          DEFSTID = NOSTORAG;             /*#Y30SSFR*/ 03464000
         MVI   DEFSTID,X'04'                                       0943 03465000
*                          RETURN CODE(LASTCC12);          /*#Y30SSFR*/ 03466000
         LA    @15,12                                              0944 03467000
         L     @14,@SA00002                                        0944 03468000
         LM    @00,@12,@SA00002+8                                  0944 03469000
         BR    @14                                                 0944 03470000
*                          END;                            /*#Y30SSFR*/ 03471000
*                                                                  0945 03472000
*                      END;                                /*#Y30SSFR*/ 03473000
*                                                                  0946 03474000
@RF00940 DS    0H                                                  0947 03475000
*                  /**************************************************/ 03476000
*                  /*                                        #Y30SSFR*/ 03477000
*                  /*  READ IN THE CATALOG WORK AREA AND     #Y30SSFR*/ 03478000
*                  /*  CALL FVTPROC TO BUILD THE FVT AND     #Y30SSFR*/ 03479000
*                  /*  FPL'S NEEDED TO DO THE DEFINE.        #Y30SSFR*/ 03480000
*                  /*                                        #Y30SSFR*/ 03481000
*                  /**************************************************/ 03482000
*                                                                  0947 03483000
*                  CALL GETPROC(PWORKAR,ASSRECLN);         /*#Y30SSFR*/ 03484000
*                                                                  0947 03485000
@RF00930 LA    @02,PWORKAR                                         0947 03486000
         ST    @02,@AL00001                                        0947 03487000
         L     @02,CONRCPTR                                        0947 03488000
         LA    @02,ASSRECLN(,@02)                                  0947 03489000
         ST    @02,@AL00001+4                                      0947 03490000
         LA    @01,@AL00001                                        0947 03491000
         BAL   @14,GETPROC                                         0947 03492000
*                  RESPECIFY RTNREG RSTD;                          0948 03493000
*                  TESTRC = RTNREG;                                0949 03494000
         LR    TESTRC,RTNREG                                       0949 03495000
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/ 03496000
*                                                                  0950 03497000
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/ 03498000
*                    THEN                                  /*#Y30SSFR*/ 03499000
         LTR   TESTRC,TESTRC                                       0951 03500000
         BZ    @RF00951                                            0951 03501000
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/ 03502000
*                                                                  0952 03503000
         LA    @15,12                                              0952 03504000
         L     @14,@SA00002                                        0952 03505000
         LM    @00,@12,@SA00002+8                                  0952 03506000
         BR    @14                                                 0952 03507000
*                  DICTPTR = ADDR(VARDATA);                /*#Y30SSFR*/ 03508000
*                                                                  0953 03509000
@RF00951 L     @02,CONRCPTR                                        0953 03510000
         LA    @02,VARDATA(,@02)                                   0953 03511000
         ST    @02,DICTPTR                                         0953 03512000
*                  CALL FVTPROC(DICTPTR,PWORKAR,PFVTPTR);  /*#Y30SSFR*/ 03513000
*                                                                  0954 03514000
         LA    @02,DICTPTR                                         0954 03515000
         ST    @02,@AL00001                                        0954 03516000
         LA    @02,PWORKAR                                         0954 03517000
         ST    @02,@AL00001+4                                      0954 03518000
         LA    @02,PFVTPTR                                         0954 03519000
         ST    @02,@AL00001+8                                      0954 03520000
         LA    @01,@AL00001                                        0954 03521000
         BAL   @14,FVTPROC                                         0954 03522000
*                  RESPECIFY RTNREG RSTD;                          0955 03523000
*                  TESTRC = RTNREG;                                0956 03524000
         LR    TESTRC,RTNREG                                       0956 03525000
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/ 03526000
*                                                                  0957 03527000
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/ 03528000
*                    THEN                                  /*#Y30SSFR*/ 03529000
         LTR   TESTRC,TESTRC                                       0958 03530000
         BZ    @RF00958                                            0958 03531000
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/ 03532000
*                                                                  0959 03533000
         LA    @15,12                                              0959 03534000
         L     @14,@SA00002                                        0959 03535000
         LM    @00,@12,@SA00002+8                                  0959 03536000
         BR    @14                                                 0959 03537000
*                  /**************************************************/ 03538000
*                  /*                                        #Y30SSFR*/ 03539000
*                  /*  SET THE POINTER TO FVT IN THE CPL     #Y30SSFR*/ 03540000
*                  /*                                        #Y30SSFR*/ 03541000
*                  /**************************************************/ 03542000
*                                                                  0960 03543000
*                  CTGFVT = PFVTPTR;                       /*#Y30SSFR*/ 03544000
@RF00958 L     @02,PFVTPTR                                         0960 03545000
         L     @01,CTGPLPTR                                        0960 03546000
         ST    @02,CTGFVT(,@01)                                    0960 03547000
*                  CTGFVPTR = PFVTPTR;                     /*#Y30SSFR*/ 03548000
*                                                                  0961 03549000
         ST    @02,CTGFVPTR                                        0961 03550000
*                  /**************************************************/ 03551000
*                  /*                                        #Y30SSFR*/ 03552000
*                  /*  SCAN THE OBJECTS LIST FOR A MATCH TO  #Y30SSFR*/ 03553000
*                  /*  THE PATH BEING DEFINED.               #Y30SSFR*/ 03554000
*                  /*                                        #Y30SSFR*/ 03555000
*                  /**************************************************/ 03556000
*                                                                  0962 03557000
*POBJLOOP:         DO IX = 1 TO OBJTSCNT;                  /*#Y30SSFR*/ 03558000
*                                                                  0962 03559000
POBJLOOP LA    @02,1                                               0962 03560000
         B     @DE00962                                            0962 03561000
@DL00962 DS    0H                                                  0963 03562000
*                    IF OBJNMPTR(IX) -> OBJNMVAL(1:44) =   /*#Y30SSFR*/ 03563000
*                       FENTNAME(1:44)                     /*#Y30SSFR*/ 03564000
*                      THEN                                /*#Y30SSFR*/ 03565000
         SLA   @02,2                                               0963 03566000
         L     @15,@PC00001+4                                      0963 03567000
         L     @01,FDTPTR+12(,@15)                                 0963 03568000
         AL    @01,@CF01689                                        0963 03569000
         L     @01,OBJNMPTR(@02,@01)                               0963 03570000
         L     @14,CTGFVPTR                                        0963 03571000
         L     @05,CTGFVENT(,@14)                                  0963 03572000
         CLC   OBJNMVAL(44,@01),FENTNAME(@05)                      0963 03573000
         BNE   @RF00963                                            0963 03574000
*                        DO;                               /*#Y30SSFR*/ 03575000
*                                                                  0964 03576000
*                        /********************************************/ 03577000
*                        /*                                  #Y30SSFR*/ 03578000
*                        /*  TEST FOR A NEWNAME AND SET THE  #Y30SSFR*/ 03579000
*                        /*  APPROPRIATE POINTER IF ONE IS   #Y30SSFR*/ 03580000
*                        /*  PRESENT.                        #Y30SSFR*/ 03581000
*                        /*                                  #Y30SSFR*/ 03582000
*                        /********************************************/ 03583000
*                                                                  0965 03584000
*                        IF NEWNMPTR(IX) ^= NULLPTR        /*#Y30SSFR*/ 03585000
*                          THEN                            /*#Y30SSFR*/ 03586000
         L     @01,FDTPTR+16(,@15)                                 0965 03587000
         AL    @01,@CF01689                                        0965 03588000
         L     @02,NEWNMPTR(@02,@01)                               0965 03589000
         LTR   @02,@02                                             0965 03590000
         BZ    @RF00965                                            0965 03591000
*                            CTGFVENT = ADDR(NEWNMPTR(IX)->/*#Y30SSFR*/ 03592000
*                               NEWNMVAL);                 /*#Y30SSFR*/ 03593000
         LA    @02,NEWNMVAL(,@02)                                  0966 03594000
         ST    @02,CTGFVENT(,@14)                                  0966 03595000
*                          ELSE                            /*#Y30SSFR*/ 03596000
*                                                                  0967 03597000
*                            /****************************************/ 03598000
*                            /*                              @Y30SSFR*/ 03599000
*                            /*  TEST FOR THE PRESENCE OF    @Y30SSFR*/ 03600000
*                            /*  THE FILE PARAMETER.  IF     @Y30SSFR*/ 03601000
*                            /*  SPECIFIED, SET A POINTER    @Y30SSFR*/ 03602000
*                            /*  TO IT IN THE FVT.           @Y30SSFR*/ 03603000
*                            /*                              @Y30SSFR*/ 03604000
*                            /****************************************/ 03605000
*                                                                  0967 03606000
*                            IF OBJFLPTR(IX) ^= NULLPTR    /*@Y30SSFR*/ 03607000
*                              THEN                        /*@Y30SSFR*/ 03608000
         B     @RC00965                                            0967 03609000
@RF00965 L     @02,IX                                              0967 03610000
         SLA   @02,2                                               0967 03611000
         L     @15,@PC00001+4                                      0967 03612000
         L     @01,FDTPTR+20(,@15)                                 0967 03613000
         AL    @01,@CF01689                                        0967 03614000
         L     @02,OBJFLPTR(@02,@01)                               0967 03615000
         LTR   @02,@02                                             0967 03616000
         BZ    @RF00967                                            0967 03617000
*                                CTGFVIND = ADDR(          /*@Y30SSFR*/ 03618000
*                                  OBJFLPTR(IX)->OBJFLVAL);/*@Y30SSFR*/ 03619000
*                                                                  0968 03620000
         LA    @02,OBJFLVAL(,@02)                                  0968 03621000
         L     @01,CTGFVPTR                                        0968 03622000
         ST    @02,CTGFVIND(,@01)                                  0968 03623000
*                              ELSE                        /*@Y30SSFR*/ 03624000
*                                DO;                       /*#Y30SSFR*/ 03625000
*                                                                  0969 03626000
         B     @RC00967                                            0969 03627000
@RF00967 DS    0H                                                  0970 03628000
*                                /************************************/ 03629000
*                                /*                          @Y30SSFR*/ 03630000
*                                /*  THE PRESENCE OF ANY     @Y30SSFR*/ 03631000
*                                /*  OTHER OBJECTS SUBPARA-  @Y30SSFR*/ 03632000
*                                /*  METER IS AN ERROR.      @Y30SSFR*/ 03633000
*                                /*  PRINT A MESSAGE, AND    @Y30SSFR*/ 03634000
*                                /*  INDICATE THAT NO        @Y30SSFR*/ 03635000
*                                /*  ATTEMPT WILL BE MADE    @Y30SSFR*/ 03636000
*                                /*  TO DEFINE THE PATH.     @Y30SSFR*/ 03637000
*                                /*                          @Y30SSFR*/ 03638000
*                                /************************************/ 03639000
*                                                                  0970 03640000
*                                IMPF2NOD = ON;            /*#Y30SSFR*/ 03641000
         OI    IMPF2NOD,B'00010000'                                0970 03642000
*                                DARGSENT = BADOBJPM;      /*#Y30SSFR*/ 03643000
         L     @02,DDSTRU                                          0971 03644000
         MVI   DARGSENT(@02),X'12'                                 0971 03645000
*                                DARGSMOD = IMPMSG;        /*#Y30SSFR*/ 03646000
         MVC   DARGSMOD(3,@02),@CC01000                            0972 03647000
*                                DARGILP =                 /*#Y30SSFR*/ 03648000
*                                  LENGTH(FENTNAME);       /*#Y30SSFR*/ 03649000
         MVC   DARGILP(2,@02),@CH00605                             0973 03650000
*                                DARGDBP =                 /*#Y30SSFR*/ 03651000
*                                  ADDR(FENTNAME);         /*#Y30SSFR*/ 03652000
*                                                                  0974 03653000
         L     @01,CTGFVPTR                                        0974 03654000
         L     @15,CTGFVENT(,@01)                                  0974 03655000
         ST    @15,DARGDBP(,@02)                                   0974 03656000
*                                CALL AMSTP011(GDTTBL,PRTFILE,/*   0975 03657000
*                                                            #Y30SSFR*/ 03658000
*                                  DDSTRU);                /*#Y30SSFR*/ 03659000
*                                                                  0975 03660000
         L     @02,@PC00001                                        0975 03661000
         ST    @02,@AL00001                                        0975 03662000
         LA    @15,@CF00118                                        0975 03663000
         ST    @15,@AL00001+4                                      0975 03664000
         LA    @15,DDSTRU                                          0975 03665000
         ST    @15,@AL00001+8                                      0975 03666000
         MVI   @AL00001+8,X'80'                                    0975 03667000
         L     @15,GDTPRT(,@02)                                    0975 03668000
         LA    @01,@AL00001                                        0975 03669000
         BALR  @14,@15                                             0975 03670000
*                                SETRC = LASTCC08;         /*#Y30SSFR*/ 03671000
         MVC   SETRC(2),@CH00039                                   0976 03672000
*                                DEFSTID = 0;              /*#Y30SSFR*/ 03673000
         MVI   DEFSTID,X'00'                                       0977 03674000
*                                END;                      /*#Y30SSFR*/ 03675000
*                        END;                              /*#Y30SSFR*/ 03676000
*                                                                  0979 03677000
@RC00967 DS    0H                                                  0979 03678000
@RC00965 DS    0H                                                  0980 03679000
*                  END POBJLOOP;                           /*@Y30SSFR*/ 03680000
*                                                                  0980 03681000
@RF00963 LA    @02,1                                               0980 03682000
         AL    @02,IX                                              0980 03683000
@DE00962 ST    @02,IX                                              0980 03684000
         L     @15,@PC00001+4                                      0980 03685000
         LA    @15,FDTPTR+8(,@15)                                  0980 03686000
         C     @02,OBJTSCNT(,@15)                                  0980 03687000
         BNH   @DL00962                                            0980 03688000
*                  /**************************************************/ 03689000
*                  /*                                        @Y30SSFR*/ 03690000
*                  /*  IF THE USER SPECIFIED OUTFILE AND     @Y30SSFR*/ 03691000
*                  /*  DID NOT EXPLICITLY GIVE A FILE        @Y30SSFR*/ 03692000
*                  /*  PARAMETER FOR THE PATH, SET           @Y30SSFR*/ 03693000
*                  /*  CTGFVIND TO POINT THE OUTFILE DD      @Y30SSFR*/ 03694000
*                  /*  STATEMENT.                            @Y30SSFR*/ 03695000
*                  /*                                        @Y30SSFR*/ 03696000
*                  /**************************************************/ 03697000
*                                                                  0981 03698000
*                  IF CTGFVIND = NULLPTR &                         0981 03699000
*                     ADDR(OUTDD) ^= NULLPTR                       0981 03700000
*                    THEN                                          0981 03701000
         SLR   @02,@02                                             0981 03702000
         L     @15,CTGFVPTR                                        0981 03703000
         C     @02,CTGFVIND(,@15)                                  0981 03704000
         BNE   @RF00981                                            0981 03705000
         L     @14,@PC00001+4                                      0981 03706000
         L     @14,FDTPTR+4(,@14)                                  0981 03707000
         CR    @14,@02                                             0981 03708000
         BE    @RF00981                                            0981 03709000
*                      CTGFVIND = ADDR(OUTDDVAL);          /*@Y30SSFR*/ 03710000
*                                                                  0982 03711000
         LA    @02,OUTDDVAL(,@14)                                  0982 03712000
         ST    @02,CTGFVIND(,@15)                                  0982 03713000
*                  /**************************************************/ 03714000
*                  /*                                        #Y30SSFR*/ 03715000
*                  /*  SET THE CTGFVWKA FIELD OF THE FVT     #Y30SSFR*/ 03716000
*                  /*  TO POINT THE WORK AREA FOR THE        #Y30SSFR*/ 03717000
*                  /*  RECOVERY VOLUME SERIAL NUMBER.        #Y30SSFR*/ 03718000
*                  /*                                        #Y30SSFR*/ 03719000
*                  /**************************************************/ 03720000
*                                                                  0983 03721000
*                  PFVTPTR -> CTGFVWKA = ADDR(CATRCVWK);   /*#Y30SSFR*/ 03722000
*                                                                  0983 03723000
@RF00981 LA    @02,CATRCVWK                                        0983 03724000
         L     @01,PFVTPTR                                         0983 03725000
         ST    @02,CTGFVWKA(,@01)                                  0983 03726000
*                  /**************************************************/ 03727000
*                  /*                                        #Y30SSFR*/ 03728000
*                  /*  TEST TO DETERMINE IF IMPF2NOD IS SET  #Y30SSFR*/ 03729000
*                  /*  IF IT IS, THEN SKIP THE DEFINE OF     #Y30SSFR*/ 03730000
*                  /*  THE PRESENT PATH, AND PROCEED TO THE  #Y30SSFR*/ 03731000
*                  /*  NEXT.  OTHERWISE, DO A CMS DEFINE.    #Y30SSFR*/ 03732000
*                  /*                                        #Y30SSFR*/ 03733000
*                  /**************************************************/ 03734000
*                                                                  0984 03735000
*                  IF IMPF2NOD ^= ON                       /*#Y30SSFR*/ 03736000
*                    THEN                                  /*#Y30SSFR*/ 03737000
         TM    IMPF2NOD,B'00010000'                                0984 03738000
         BO    @RF00984                                            0984 03739000
*                      DO;                                 /*#Y30SSFR*/ 03740000
*                                                                  0985 03741000
*                      /**********************************************/ 03742000
*                      /*                                    #Y30SSFR*/ 03743000
*                      /*  CALL CATALOG MANAGEMENT TO DO     #Y30SSFR*/ 03744000
*                      /*  A CMS DEFINE                      #Y30SSFR*/ 03745000
*                      /*                                    #Y30SSFR*/ 03746000
*                      /**********************************************/ 03747000
*                                                                  0986 03748000
*                      CALL CTLGPROC(PPTRCPL);             /*#Y30SSFR*/ 03749000
*                                                                  0986 03750000
         LA    @02,PPTRCPL                                         0986 03751000
         ST    @02,@AL00001                                        0986 03752000
         LA    @01,@AL00001                                        0986 03753000
         BAL   @14,CTLGPROC                                        0986 03754000
*                      RESPECIFY RTNREG RSTD;                      0987 03755000
*                      TESTRC = RTNREG;                            0988 03756000
         LR    TESTRC,RTNREG                                       0988 03757000
*                      RESPECIFY RTNREG UNRSTD;            /*#Y30SSFR*/ 03758000
*                                                                  0989 03759000
*                      IF TESTRC ^= 0                      /*#Y30SSFR*/ 03760000
*                        THEN                              /*#Y30SSFR*/ 03761000
         LTR   TESTRC,TESTRC                                       0990 03762000
         BZ    @RF00990                                            0990 03763000
*                          DO;                             /*#Y30SSFR*/ 03764000
*                                                                  0991 03765000
*                          /******************************************/ 03766000
*                          /*                                #Y30SSFR*/ 03767000
*                          /*  THE DEFINE OF THE PATH HAS    #Y30SSFR*/ 03768000
*                          /*  FAILED.  PRINT AN ERROR       #Y30SSFR*/ 03769000
*                          /*  MESSAGE, BUT CONTINUE         #Y30SSFR*/ 03770000
*                          /*  PROCESSING WITH THE NEXT      #Y30SSFR*/ 03771000
*                          /*  PATH.                         #Y30SSFR*/ 03772000
*                          /*                                #Y30SSFR*/ 03773000
*                          /******************************************/ 03774000
*                                                                  0992 03775000
*                          DARGSMOD = IMPMSG;              /*#Y30SSFR*/ 03776000
         L     @02,DDSTRU                                          0992 03777000
         MVC   DARGSMOD(3,@02),@CC01000                            0992 03778000
*                          DARGSENT = BADPTMP;             /*#Y30SSFR*/ 03779000
         MVI   DARGSENT(@02),X'10'                                 0993 03780000
*                          DARGILP = LENGTH(FENTNAME);     /*#Y30SSFR*/ 03781000
         MVC   DARGILP(2,@02),@CH00605                             0994 03782000
*                          DARGDBP = ADDR(FENTNAME);       /*#Y30SSFR*/ 03783000
*                                                                  0995 03784000
         L     @01,CTGFVPTR                                        0995 03785000
         L     @15,CTGFVENT(,@01)                                  0995 03786000
         ST    @15,DARGDBP(,@02)                                   0995 03787000
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* 0996 03788000
*                                                            #Y30SSFR*/ 03789000
*                                                                  0996 03790000
         L     @02,@PC00001                                        0996 03791000
         ST    @02,@AL00001                                        0996 03792000
         LA    @15,@CF00118                                        0996 03793000
         ST    @15,@AL00001+4                                      0996 03794000
         LA    @15,DDSTRU                                          0996 03795000
         ST    @15,@AL00001+8                                      0996 03796000
         MVI   @AL00001+8,X'80'                                    0996 03797000
         L     @15,GDTPRT(,@02)                                    0996 03798000
         LA    @01,@AL00001                                        0996 03799000
         BALR  @14,@15                                             0996 03800000
*                          SETRC = LASTCC08;               /*#Y30SSFR*/ 03801000
         MVC   SETRC(2),@CH00039                                   0997 03802000
*                          DEFSTID = 0;                    /*#Y30SSFR*/ 03803000
         MVI   DEFSTID,X'00'                                       0998 03804000
*                          END;                            /*#Y30SSFR*/ 03805000
*                                                                  0999 03806000
*                  END;                                    /*#Y30SSFR*/ 03807000
*                                                                  1000 03808000
@RF00990 DS    0H                                                  1001 03809000
*                  /**************************************************/ 03810000
*                  /*                                        #Y30SSFR*/ 03811000
*                  /*  FREE CORE GOTTEN BY FVTPROC FOR THE   #Y30SSFR*/ 03812000
*                  /*  FVT AND FPL'S USED TO DEFINE THE      #Y30SSFR*/ 03813000
*                  /*  PATH.                                 #Y30SSFR*/ 03814000
*                  /*                                        #Y30SSFR*/ 03815000
*                  /**************************************************/ 03816000
*                                                                  1001 03817000
*                  CALL IDCSAFS0(GDTTBL,PFVTPTR);          /*#Y30SSFR*/ 03818000
*                                                                  1001 03819000
@RF00984 L     @02,@PC00001                                        1001 03820000
         ST    @02,@AL00001                                        1001 03821000
         LA    @15,PFVTPTR                                         1001 03822000
         ST    @15,@AL00001+4                                      1001 03823000
         L     @15,GDTFSP(,@02)                                    1001 03824000
         LA    @01,@AL00001                                        1001 03825000
         BALR  @14,@15                                             1001 03826000
*                  END CATHDFLG;                           /*#Y30SSFR*/ 03827000
*                                                                  1002 03828000
*            END PATHLOOP;                                 /*#Y30SSFR*/ 03829000
*                                                                  1003 03830000
@RF00928 AL    I,@CF00221                                          1003 03831000
@DE00917 CH    I,NUMOBJ                                            1003 03832000
         BNH   @DL00917                                            1003 03833000
*            /********************************************************/ 03834000
*            /*                                              #Y30SSFR*/ 03835000
*            /*  FREE UP ANY CORE USED BY THE WORKAREA       #Y30SSFR*/ 03836000
*            /*  EMPLOYED TO DO THE PATH DEFINES.            #Y30SSFR*/ 03837000
*            /*                                              #Y30SSFR*/ 03838000
*            /********************************************************/ 03839000
*                                                                  1004 03840000
*            IF PCOREFLG = ON                              /*#Y30SSFR*/ 03841000
*              THEN                                        /*#Y30SSFR*/ 03842000
         TM    PCOREFLG,B'10000000'                                1004 03843000
         BNO   @RF01004                                            1004 03844000
*                CALL IDCSAFS0(GDTTBL,PWORKAR);            /*#Y30SSFR*/ 03845000
*                                                                  1005 03846000
         L     @15,@PC00001                                        1005 03847000
         ST    @15,@AL00001                                        1005 03848000
         LA    @14,PWORKAR                                         1005 03849000
         ST    @14,@AL00001+4                                      1005 03850000
         L     @15,GDTFSP(,@15)                                    1005 03851000
         LA    @01,@AL00001                                        1005 03852000
         BALR  @14,@15                                             1005 03853000
*            END PATHDEF;                                  /*#Y30SSFR*/ 03854000
@RF01004 DS    0H                                                  1007 03855000
*        /************************************************************/ 03856000
*        /*                                                  #Y30SSFR*/ 03857000
*        /*  GET THE RECORD FROM THE PORTABLE DATA SET WHICH #Y30SSFR*/ 03858000
*        /*  DESCRIBES THE FORMAT OF THE DATA TO BE WRITTEN INTO     */ 03859000
*        /*  THE CLUSTER.                                    #Y30SSFR*/ 03860000
*        /*  IF THE GET FAILS, RETURN TO THE CALLING PROCESSOR.      */ 03861000
*        /*                                                  #Y30SSFR*/ 03862000
*        /************************************************************/ 03863000
*                                                                  1007 03864000
*        CALL IDCIOGT0(GDTTBL,PINIOCS);                    /*#Y30SSFR*/ 03865000
*                                                                  1007 03866000
@RF00905 L     @03,@PC00001                                        1007 03867000
         ST    @03,@AL00001                                        1007 03868000
         LA    @15,PINIOCS                                         1007 03869000
         ST    @15,@AL00001+4                                      1007 03870000
         MVI   @AL00001+4,X'80'                                    1007 03871000
         L     @15,GDTGET(,@03)                                    1007 03872000
         LA    @01,@AL00001                                        1007 03873000
         BALR  @14,@15                                             1007 03874000
*        RESPECIFY RTNREG RSTD;                                    1008 03875000
*        TESTRC = RTNREG;                                          1009 03876000
         LR    TESTRC,RTNREG                                       1009 03877000
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/ 03878000
*        IF TESTRC ^= 0                                            1011 03879000
*          THEN                                                    1011 03880000
         LTR   TESTRC,TESTRC                                       1011 03881000
         BZ    @RF01011                                            1011 03882000
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/ 03883000
*                                                                  1012 03884000
         LA    @15,12                                              1012 03885000
         L     @14,@SA00002                                        1012 03886000
         LM    @00,@12,@SA00002+8                                  1012 03887000
         BR    @14                                                 1012 03888000
*        CONRCPTR = IOCDAD;                                /*#Y30SSFR*/ 03889000
*                                                                  1013 03890000
@RF01011 L     @01,IOCSPTR                                         1013 03891000
         L     @15,IOCDAD(,@01)                                    1013 03892000
         ST    @15,CONRCPTR                                        1013 03893000
*        IF  HEADFLG1 ^= HDFL1REO                                  1014 03894000
*          THEN                                                    1014 03895000
         CLI   HEADFLG1(@15),X'01'                                 1014 03896000
         BE    @RF01014                                            1014 03897000
*            DO;                                           /*#Y30SSFR*/ 03898000
*                                                                  1015 03899000
*            /*******************************************************/  03900000
*            /*                                              #Y30SSFR*/ 03901000
*            /*  IF THE CONTROL RECORD IS NOT FOR A DATA RECORD,     */ 03902000
*            /*  THEN THE PORTABILITY VOLUME IS IN ERROR     #Y30SSFR*/ 03903000
*            /*  RETURN TO THE CALLING PROCESSOR.            #Y30SSFR*/ 03904000
*            /*                                              #Y30SSFR*/ 03905000
*            /********************************************************/ 03906000
*                                                                  1016 03907000
*            DEFSTID = PORTERR;                            /*#Y30SSFR*/ 03908000
         MVI   DEFSTID,X'01'                                       1016 03909000
*            IF EMPTYDS ^= ON                              /*#Y30SSFR*/ 03910000
*              THEN                                        /*#Y30SSFR*/ 03911000
         TM    EMPTYDS,B'10000000'                                 1017 03912000
         BO    @RF01017                                            1017 03913000
*                IMPF2DEL = ON;                            /*#Y30SSFR*/ 03914000
         OI    IMPF2DEL,B'01000000'                                1018 03915000
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/ 03916000
@RF01017 LA    @15,12                                              1019 03917000
         L     @14,@SA00002                                        1019 03918000
         LM    @00,@12,@SA00002+8                                  1019 03919000
         BR    @14                                                 1019 03920000
*            END;                                          /*#Y30SSFR*/ 03921000
*                                                                  1020 03922000
*        /************************************************************/ 03923000
*        /*                                                  #Y30SSFR*/ 03924000
*        /*  CALL RECPROC TO OPEN THE VSAM CLUSTER JUST DEFINED, AND */ 03925000
*        /*  COPY THE DATA INTO IT RECORD BY RECORD FROM THE #Y30SSFR*/ 03926000
*        /*  PORTABILITY DATA SET.                           #Y30SSFR*/ 03927000
*        /*  IF ANY ERRORS ARE ENCOUNTERED, RETURN TO THE CALLING    */ 03928000
*        /*  PROCESSOR,AFTER SETTING THE DELETE CLUSTER FLAG.        */ 03929000
*        /*                                                  #Y30SSFR*/ 03930000
*        /************************************************************/ 03931000
*                                                                  1021 03932000
*        CALL RECPROC;                                     /*#Y30SSFR*/ 03933000
*                                                                  1021 03934000
@RF01014 BAL   @14,RECPROC                                         1021 03935000
*        RESPECIFY RTNREG RSTD;                                    1022 03936000
*        TESTRC = RTNREG;                                          1023 03937000
         LR    TESTRC,RTNREG                                       1023 03938000
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/ 03939000
*        IF TESTRC ^= 0                                            1025 03940000
*          THEN                                                    1025 03941000
         LTR   TESTRC,TESTRC                                       1025 03942000
         BZ    @RF01025                                            1025 03943000
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/ 03944000
         LA    @15,12                                              1026 03945000
         L     @14,@SA00002                                        1026 03946000
         LM    @00,@12,@SA00002+8                                  1026 03947000
         BR    @14                                                 1026 03948000
*        /************************************************************/ 03949000
*        /*                                                  #Y30SSFR*/ 03950000
*        /*  ALL INPUT FROM THE PORTABILITY VOLUME HAS BEEN COPIED.  */ 03951000
*        /*  SO CLOSE THE PORTABLE DATA SET.                 #Y30SSFR*/ 03952000
*        /*  IF THE CLOSE FAILS, RETURN TO THE CALLING PROCESSOR     */ 03953000
*        /*                                                  #Y30SSFR*/ 03954000
*        /************************************************************/ 03955000
*                                                                  1027 03956000
*        OLDERID2 = NEWERID2;                                      1027 03957000
@RF01025 L     @03,@PC00001                                        1027 03958000
         L     @15,GDTTR2(,@03)                                    1027 03959000
         MVC   @TS00001(95),NEWERID2(@15)                          1027 03960000
         MVC   OLDERID2(95,@15),@TS00001                           1027 03961000
*        NEWID2 = 'MPPT';                                  /*#Y30SSFR*/ 03962000
*                                                                  1028 03963000
         MVC   NEWID2(4,@15),@CC01330                              1028 03964000
*        CALL IDCIOCL0 (GDTTBL,PINIOCS);                   /*#Y30SSFR*/ 03965000
*                                                                  1029 03966000
         ST    @03,@AL00001                                        1029 03967000
         LA    @15,PINIOCS                                         1029 03968000
         ST    @15,@AL00001+4                                      1029 03969000
         MVI   @AL00001+4,X'80'                                    1029 03970000
         L     @15,GDTCLS(,@03)                                    1029 03971000
         LA    @01,@AL00001                                        1029 03972000
         BALR  @14,@15                                             1029 03973000
*        RESPECIFY RTNREG RSTD;                                    1030 03974000
*        TESTRC = RTNREG;                                          1031 03975000
         LR    TESTRC,RTNREG                                       1031 03976000
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/ 03977000
*        PINIOCS = NULLPTR;                                /*#Y30SSFR*/ 03978000
         SLR   @03,@03                                             1033 03979000
         ST    @03,PINIOCS                                         1033 03980000
*        IF TESTRC ^= 0                                            1034 03981000
*          THEN                                                    1034 03982000
         CR    TESTRC,@03                                          1034 03983000
         BE    @RF01034                                            1034 03984000
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/ 03985000
*                                                                  1035 03986000
         LA    @15,12                                              1035 03987000
         L     @14,@SA00002                                        1035 03988000
         LM    @00,@12,@SA00002+8                                  1035 03989000
         BR    @14                                                 1035 03990000
*        /************************************************************/ 03991000
*        /*                                                  #Y30SSFR*/ 03992000
*        /*  IF THE INHIBITTARGET WAS INDICATED AT EXPORT TIME, A    */ 03993000
*        /*  CATALOG ALTER MUST BE PERFORMED TO SET THE ATTRIBUTES   */ 03994000
*        /*  CATALOG FIELD                                   #Y30SSFR*/ 03995000
*        /*  IF THE ALTER FAILS, RETURN TO THE CALLING PROCESSOR     */ 03996000
*        /*                                                  #Y30SSFR*/ 03997000
*        /************************************************************/ 03998000
*                                                                  1036 03999000
*        IF IMPINHTG = ON                                          1036 04000000
*          THEN                                                    1036 04001000
@RF01034 TM    IMPINHTG,B'01000000'                                1036 04002000
         BNO   @RF01036                                            1036 04003000
*            DO;                                           /*#Y30SSFR*/ 04004000
*                                                                  1037 04005000
*            CALL ALTRPROC;                                /*#Y30SSFR*/ 04006000
*                                                                  1038 04007000
         BAL   @14,ALTRPROC                                        1038 04008000
*            RESPECIFY RTNREG RSTD;                                1039 04009000
*            TESTRC = RTNREG;                                      1040 04010000
         LR    TESTRC,RTNREG                                       1040 04011000
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/ 04012000
*            IF TESTRC ^= 0                                        1042 04013000
*              THEN                                                1042 04014000
         LTR   TESTRC,TESTRC                                       1042 04015000
         BZ    @RF01042                                            1042 04016000
*                RETURN CODE(LASTCC08);                    /*#Y30SSFR*/ 04017000
         LA    @15,8                                               1043 04018000
         L     @14,@SA00002                                        1043 04019000
         LM    @00,@12,@SA00002+8                                  1043 04020000
         BR    @14                                                 1043 04021000
*                END;                                      /*#Y30SSFR*/ 04022000
*                                                                  1044 04023000
*                                                                  1044 04024000
@RF01042 DS    0H                                                  1045 04025000
*        /************************************************************/ 04026000
*        /*                                                  #Y30SSFR*/ 04027000
*        /*  RETURN TO MAIN PROCEDURE, INDICATING THAT ENTIRE        */ 04028000
*        /*  FUNCTION COMPLETED SUCCESSFULLY                 #Y30SSFR*/ 04029000
*        /*                                                  #Y30SSFR*/ 04030000
*        /************************************************************/ 04031000
*                                                                  1045 04032000
*        RETURN CODE(0);                                   /*#Y30SSFR*/ 04033000
@RF01036 SLR   @15,@15                                             1045 04034000
         L     @14,@SA00002                                        1045 04035000
         LM    @00,@12,@SA00002+8                                  1045 04036000
         BR    @14                                                 1045 04037000
*END CLUSPROC;                                             /*#Y30SSFR*/ 04038000
*        /************************************************************/ 04039000
*        /*                                                  #Y30SSFR*/ 04040000
*        /*  PROCEDURE NAME - CNCTPROC                       #Y30SSFR*/ 04041000
*        /*                                                  #Y30SSFR*/ 04042000
*        /*  FUNCTION -  THIS PROCESSOR WILL CONNECT A USER CATALOG  */ 04043000
*        /*  OR SEVERAL USER CATALOGS                        #Y30SSFR*/ 04044000
*        /*                                                  #Y30SSFR*/ 04045000
*        /*  INPUT - FUNCTION DEFINITION TABLE               #Y30SSFR*/ 04046000
*        /*                                                  #Y30SSFR*/ 04047000
*        /*  OUTPUT - THE USER CATALOG NAME WILL HAVE BEEN PLACED    */ 04048000
*        /*  IN THE MASTER CATALOG                           #Y30SSFR*/ 04049000
*        /*                                                  #Y30SSFR*/ 04050000
*        /************************************************************/ 04051000
*                                                                  1047 04052000
*CNCTPROC: PROCEDURE;                                              1047 04053000
*                                                                  1047 04054000
CNCTPROC STM   @14,@12,@SA00003                                    1047 04055000
*        /************************************************************/ 04056000
*        /*                                                          */ 04057000
*        /*  LOCAL DECLARES                                          */ 04058000
*        /*                                                          */ 04059000
*        /************************************************************/ 04060000
*                                                                  1048 04061000
*        DCL 1 CNCTBLKS BDY(WORD),                                 1048 04062000
*          2 CNCTCPL    CHAR(LENGTH(CTGPL)),                       1048 04063000
*                                      /*CATALOG PARAMETER LIST      */ 04064000
*          2 CNCTFVT    CHAR(LENGTH(CTGFV));                       1048 04065000
*                                      /*CATALOG FIELD VECTOR TABLE  */ 04066000
*        /***********************************************************/  04067000
*        /*                                                          */ 04068000
*        /*  FOR EACH OBJECT PARAMETER SPECIFIED IN THE AMS COMMAND  */ 04069000
*        /*  PERFORM A USER CATALOG CONNECT.  THE FVT MUST CONTAIN   */ 04070000
*        /*  A POINTER TO AN ENTNAME FPL, A DEVTYPE FPL, AND A       */ 04071000
*        /*  POINTER TO A LIST OF VOLUME SERIALS ON WHICH THE USER   */ 04072000
*        /*  CATALOG IS LOCATED.  IF NO OBJECT PARAMETER SPECIFIED,  */ 04073000
*        /*  SEND MESSAGE AND SKIP THE CONNECT.              @OZ14834*/ 04074000
*        /*                                                          */ 04075000
*        /************************************************************/ 04076000
*                                                                  1049 04077000
*        OLDERID2 = NEWERID2;                                      1049 04078000
         L     @15,@PC00001                                        1049 04079000
         L     @15,GDTTR2(,@15)                                    1049 04080000
         MVC   @TS00001(95),NEWERID2(@15)                          1049 04081000
         MVC   OLDERID2(95,@15),@TS00001                           1049 04082000
*        NEWID2 = 'MPUC';                                          1050 04083000
*                                                                  1050 04084000
         MVC   NEWID2(4,@15),@CC01338                              1050 04085000
*        CTGPLPTR = ADDR(CNCTCPL);                                 1051 04086000
         LA    @15,CNCTCPL                                         1051 04087000
         ST    @15,CTGPLPTR                                        1051 04088000
*        PTRCPL = CTGPLPTR;                                        1052 04089000
         ST    @15,PTRCPL                                          1052 04090000
*        CTGFVPTR = ADDR(CNCTFVT);                                 1053 04091000
*                                                                  1053 04092000
         LA    @15,CNCTFVT                                         1053 04093000
         ST    @15,CTGFVPTR                                        1053 04094000
*        IF OBJTSCNT = NULLPTR                             /*@OZ14834*/ 04095000
*           THEN                                           /*@OZ14834*/ 04096000
         L     @15,@PC00001+4                                      1054 04097000
         LA    @15,FDTPTR+8(,@15)                                  1054 04098000
         L     @15,OBJTSCNT(,@15)                                  1054 04099000
         LTR   @15,@15                                             1054 04100000
         BNZ   @RF01054                                            1054 04101000
*             DO;                                          /*@OZ14834*/ 04102000
*             DEFSTID = NODEVLST;                          /*@OZ14834*/ 04103000
         MVI   DEFSTID,X'06'                                       1056 04104000
*             RETURN CODE(LASTCC12);                       /*@OZ14834*/ 04105000
         LA    @15,12                                              1057 04106000
         L     @14,@SA00003                                        1057 04107000
         LM    @00,@12,@SA00003+8                                  1057 04108000
         BR    @14                                                 1057 04109000
*             END;                                         /*@OZ14834*/ 04110000
*                                                                  1058 04111000
*OBJLOOP:DO INDX = 1 TO OBJTSCNT;                                  1059 04112000
*                                                                  1059 04113000
@RF01054 DS    0H                                                  1059 04114000
OBJLOOP  LA    @15,1                                               1059 04115000
         B     @DE01059                                            1059 04116000
@DL01059 DS    0H                                                  1060 04117000
*        /************************************************************/ 04118000
*        /*                                                          */ 04119000
*        /*  CONSTRUCT A CPL FOR USE BY CATALOG DEFINE               */ 04120000
*        /*                                                          */ 04121000
*        /************************************************************/ 04122000
*                                                                  1060 04123000
*        CNCTBLKS = ''B;                                           1060 04124000
         XC    CNCTBLKS(120),CNCTBLKS                              1060 04125000
*        CTGFUNC = CTGCMS;             /*CMS FUNCTION                */ 04126000
         L     @15,CTGPLPTR                                        1061 04127000
         NI    CTGFUNC(@15),B'10011111'                            1061 04128000
         OI    CTGFUNC(@15),B'10000000'                            1061 04129000
*        CTGAM0 = ON;                  /*VSAM REQUEST                */ 04130000
         OI    CTGAM0(@15),B'00000001'                             1062 04131000
*        CTGCNAME = ON;                /*CATALOG ACB ADDR NOT PASSED */ 04132000
*        CTGNAME = ON;                 /*ENTRY NAME PASSED           */ 04133000
         OI    CTGCNAME(@15),B'00000110'                           1064 04134000
*        CTGOPTNS = CTGDEFIN;          /*DEFINE OPERATION            */ 04135000
         NI    CTGOPTNS(@15),B'00001111'                           1065 04136000
         OI    CTGOPTNS(@15),B'00001000'                           1065 04137000
*        CTGTYPE = CTGTUCAT;           /*TYPE = USER CATALOG         */ 04138000
         MVI   CTGTYPE(@15),C'U'                                   1066 04139000
*        CTGFVT = ADDR(CNCTFVT);       /*SET FVT ADDRESS             */ 04140000
*                                                                  1067 04141000
         LA    @14,CNCTFVT                                         1067 04142000
         ST    @14,CTGFVT(,@15)                                    1067 04143000
*        /************************************************************/ 04144000
*        /*                                                          */ 04145000
*        /*  TEST FOR CATALOG PARAMETER SPECIFIED IN AMS COMMAND.    */ 04146000
*        /*  IF IT IS, SET THE CATALOG NAME.  IF THE CATALOG PASSWORD*/ 04147000
*        /*  IS SPECIFIED, SET A POINTER TO IT ALSO IN THE CPL.      */ 04148000
*        /*                                                          */ 04149000
*        /************************************************************/ 04150000
*                                                                  1068 04151000
*        IF ADDR(CAT) ^= NULLPTR                                   1068 04152000
*          THEN                                                    1068 04153000
         L     @14,@PC00001+4                                      1068 04154000
         L     @14,FDTPTR+128(,@14)                                1068 04155000
         LTR   @14,@14                                             1068 04156000
         BZ    @RF01068                                            1068 04157000
*            DO;                                                   1069 04158000
*            CTGCAT = ADDR(CATVAL);    /*CATALOG NAME POINTER        */ 04159000
         LA    @05,CATVAL(,@14)                                    1070 04160000
         ST    @05,CTGCAT(,@15)                                    1070 04161000
*            IF CATPLN > 0                                         1071 04162000
*              THEN                                                1071 04163000
         CLI   CATPLN(@14),0                                       1071 04164000
         BNH   @RF01071                                            1071 04165000
*              CTGPSWD = ADDR(CATPAS);                             1072 04166000
         LA    @14,CATPAS(,@14)                                    1072 04167000
         ST    @14,CTGPSWD(,@15)                                   1072 04168000
*                                      /*CATALOG PASSWORD POINTER    */ 04169000
*            END;                                                  1073 04170000
*                                                                  1073 04171000
*                                                                  1073 04172000
@RF01071 DS    0H                                                  1074 04173000
*        /************************************************************/ 04174000
*        /*                                                          */ 04175000
*        /*  CONSTRUCT A FIELD VECTOR TABLE (FVT)                    */ 04176000
*        /*                                                          */ 04177000
*        /************************************************************/ 04178000
*                                                                  1074 04179000
*        CTGFVPTR = ADDR(CNCTFVT);                                 1074 04180000
*                                                                  1074 04181000
@RF01068 LA    @15,CNCTFVT                                         1074 04182000
         ST    @15,CTGFVPTR                                        1074 04183000
*        /************************************************************/ 04184000
*        /*                                                          */ 04185000
*        /*  TEST TO BE SURE LIST AND DEVICETYPES PARAMETERS HAVE    */ 04186000
*        /*  BEEN SPECIFIED IN THE AMS COMMAND                       */ 04187000
*        /*  IF NOT, RETURN TO THE CALLING PROCESSOR WITH THE        */ 04188000
*        /*  ERROR INDICATED                                         */ 04189000
*        /*                                                          */ 04190000
*        /************************************************************/ 04191000
*                                                                  1075 04192000
*        IF LISTVPTR(INDX) = NULLPTR | DEVTPTR(INDX) = NULLPTR     1075 04193000
*          THEN                                                    1075 04194000
         SLR   @15,@15                                             1075 04195000
         L     @14,INDX                                            1075 04196000
         SLA   @14,2                                               1075 04197000
         L     @05,@PC00001+4                                      1075 04198000
         L     @01,FDTPTR+24(,@05)                                 1075 04199000
         AL    @01,@CF01689                                        1075 04200000
         C     @15,LISTVPTR(@14,@01)                               1075 04201000
         BE    @RT01075                                            1075 04202000
         L     @01,FDTPTR+32(,@05)                                 1075 04203000
         AL    @01,@CF01689                                        1075 04204000
         C     @15,DEVTPTR(@14,@01)                                1075 04205000
         BNE   @RF01075                                            1075 04206000
@RT01075 DS    0H                                                  1076 04207000
*            DO;                                                   1076 04208000
*            DEFSTID = NODEVLST;                                   1077 04209000
         MVI   DEFSTID,X'06'                                       1077 04210000
*            RETURN CODE(LASTCC12);                                1078 04211000
         LA    @15,12                                              1078 04212000
         L     @14,@SA00003                                        1078 04213000
         LM    @00,@12,@SA00003+8                                  1078 04214000
         BR    @14                                                 1078 04215000
*            END;                                                  1079 04216000
*                                                                  1079 04217000
*        /************************************************************/ 04218000
*        /*                                                          */ 04219000
*        /*  CONSTRUCT DEVTYP FPL FROM DEVICETYPES PARAMETER ON AMS  */ 04220000
*        /*  COMMAND AND LISTVOLS LIST FROM LIST OF VOLUME SERIALS   */ 04221000
*        /*  FROM LIST PARAMETER ON AMS COMMAND                      */ 04222000
*        /*  IF NOT CONSTRUCTED SUCCESSFULLY, RETURN TO THE CALLING  */ 04223000
*        /*  PROCESSOR                                               */ 04224000
*        /*                                                          */ 04225000
*        /************************************************************/ 04226000
*                                                                  1080 04227000
*          CALL LVLRPROC(INDX,NULLPARM,NULLPARM,CTGFVPTR);         1080 04228000
*                                                                  1080 04229000
@RF01075 LA    @15,INDX                                            1080 04230000
         ST    @15,@AL00001                                        1080 04231000
         LA    @15,NULLPARM                                        1080 04232000
         ST    @15,@AL00001+4                                      1080 04233000
         LA    @15,NULLPARM                                        1080 04234000
         ST    @15,@AL00001+8                                      1080 04235000
         LA    @15,CTGFVPTR                                        1080 04236000
         ST    @15,@AL00001+12                                     1080 04237000
         LA    @01,@AL00001                                        1080 04238000
         BAL   @14,LVLRPROC                                        1080 04239000
*          RESPECIFY RTNREG RSTD;                                  1081 04240000
*          TESTRC = RTNREG;                                        1082 04241000
         LR    TESTRC,RTNREG                                       1082 04242000
*          RESPECIFY RTNREG UNRSTD;                                1083 04243000
*          IF TESTRC ^= 0                                          1084 04244000
*            THEN                                                  1084 04245000
         LTR   TESTRC,TESTRC                                       1084 04246000
         BZ    @RF01084                                            1084 04247000
*              RETURN CODE(LASTCC12);                              1085 04248000
*                                                                  1085 04249000
         LA    @15,12                                              1085 04250000
         L     @14,@SA00003                                        1085 04251000
         LM    @00,@12,@SA00003+8                                  1085 04252000
         BR    @14                                                 1085 04253000
*        /************************************************************/ 04254000
*        /*                                                          */ 04255000
*        /*  SET POINTER TO ENTRY NAME FROM OBJECTS PARAMETER        */ 04256000
*        /*  ON AMS COMMAND                                          */ 04257000
*        /*                                                          */ 04258000
*        /************************************************************/ 04259000
*                                                                  1086 04260000
*          CTGFVENT = ADDR(OBJNMPTR(INDX)->OBJNMVAL);      /*@Y30SSFR*/ 04261000
*                                                                  1086 04262000
@RF01084 L     @15,CTGFVPTR                                        1086 04263000
         L     @14,INDX                                            1086 04264000
         SLA   @14,2                                               1086 04265000
         L     @05,@PC00001+4                                      1086 04266000
         L     @01,FDTPTR+12(,@05)                                 1086 04267000
         AL    @01,@CF01689                                        1086 04268000
         L     @01,OBJNMPTR(@14,@01)                               1086 04269000
         LA    @14,OBJNMVAL(,@01)                                  1086 04270000
         ST    @14,CTGFVENT(,@15)                                  1086 04271000
*        /************************************************************/ 04272000
*        /*                                                          */ 04273000
*        /*  THE COMBINATION OF THE TYPE FIELD IN THE FVT SET TO     */ 04274000
*        /*  NON VSAM AND THE TYPE FIELD IN THE CPL SET TO USER      */ 04275000
*        /*  CATALOG WILL SIGNAL CATALOG MANAGEMENT TO PERFORM       */ 04276000
*        /*  THE USER CATALOG CONNECT OPERATION.                     */ 04277000
*        /*                                                          */ 04278000
*        /************************************************************/ 04279000
*                                                                  1087 04280000
*        CTGFVTYP = CTGTALIN;                                      1087 04281000
*                                                                  1087 04282000
         MVI   CTGFVTYP(@15),C'A'                                  1087 04283000
*          /**********************************************************/ 04284000
*          /*                                                        */ 04285000
*          /*  INVOKE CATALOG MANAGEMENT TO PERFORM THE USER CATALOG */ 04286000
*          /*  CONNECT. IF THE CONNECT FAILS, ISSUE THE MESSAGE      */ 04287000
*          /*  INDICATED BY THE CATALOG RETURN CODE.                 */ 04288000
*          /*                                                        */ 04289000
*          /**********************************************************/ 04290000
*                                                                  1088 04291000
*          CALL CTLGPROC (PTRCPL);                                 1088 04292000
*                                                                  1088 04293000
         LA    @15,PTRCPL                                          1088 04294000
         ST    @15,@AL00001                                        1088 04295000
         LA    @01,@AL00001                                        1088 04296000
         BAL   @14,CTLGPROC                                        1088 04297000
*          RESPECIFY RTNREG RSTD;                                  1089 04298000
*          TESTRC = RTNREG;                                        1090 04299000
         LR    TESTRC,RTNREG                                       1090 04300000
*          RESPECIFY RTNREG UNRSTD;                                1091 04301000
*          IF TESTRC ^= 0                                          1092 04302000
*            THEN                                                  1092 04303000
         LTR   TESTRC,TESTRC                                       1092 04304000
         BZ    @RF01092                                            1092 04305000
*              DO;                                                 1093 04306000
*                                                                  1093 04307000
*              /******************************************************/ 04308000
*              /*                                                    */ 04309000
*              /*  ISSUE MESSAGE THAT CONNECT FAILED FOR USERCATALOG */ 04310000
*              /*                                                    */ 04311000
*              /******************************************************/ 04312000
*                                                                  1094 04313000
*              DARGILP = LENGTH(FENTNAME);                         1094 04314000
         L     @15,DDSTRU                                          1094 04315000
         MVC   DARGILP(2,@15),@CH00605                             1094 04316000
*              DARGDBP = ADDR(OBJNMPTR(INDX) -> OBJNMVAL); /*@Y30SSFR*/ 04317000
*                                                                  1095 04318000
         L     @14,INDX                                            1095 04319000
         SLA   @14,2                                               1095 04320000
         L     @05,@PC00001+4                                      1095 04321000
         L     @01,FDTPTR+12(,@05)                                 1095 04322000
         AL    @01,@CF01689                                        1095 04323000
         L     @01,OBJNMPTR(@14,@01)                               1095 04324000
         LA    @14,OBJNMVAL(,@01)                                  1095 04325000
         ST    @14,DARGDBP(,@15)                                   1095 04326000
*              CALL MSGPROC(BADCNCT);                              1096 04327000
*                                                                  1096 04328000
         LA    @01,@AL01096                                        1096 04329000
         BAL   @14,MSGPROC                                         1096 04330000
*              RETURN CODE(LASTCC12);                              1097 04331000
         LA    @15,12                                              1097 04332000
         L     @14,@SA00003                                        1097 04333000
         LM    @00,@12,@SA00003+8                                  1097 04334000
         BR    @14                                                 1097 04335000
*              END;                                                1098 04336000
*            ELSE                                                  1099 04337000
*              DO;                                                 1099 04338000
*                                                                  1099 04339000
*                                                                  1099 04340000
@RF01092 DS    0H                                                  1100 04341000
*              /******************************************************/ 04342000
*              /*                                                    */ 04343000
*              /*  ISSUE MESSAGE - GOOD CONNECT FOR USERCATALOG      */ 04344000
*              /*                                                    */ 04345000
*              /******************************************************/ 04346000
*                                                                  1100 04347000
*              DARGILP = LENGTH(FENTNAME);                         1100 04348000
         L     @15,DDSTRU                                          1100 04349000
         MVC   DARGILP(2,@15),@CH00605                             1100 04350000
*              DARGDBP = ADDR(OBJNMPTR(INDX) -> OBJNMVAL); /*@Y30SSFR*/ 04351000
*                                                                  1101 04352000
         L     @14,INDX                                            1101 04353000
         SLA   @14,2                                               1101 04354000
         L     @05,@PC00001+4                                      1101 04355000
         L     @01,FDTPTR+12(,@05)                                 1101 04356000
         AL    @01,@CF01689                                        1101 04357000
         L     @01,OBJNMPTR(@14,@01)                               1101 04358000
         LA    @14,OBJNMVAL(,@01)                                  1101 04359000
         ST    @14,DARGDBP(,@15)                                   1101 04360000
*              CALL MSGPROC(GOODCNCT);                             1102 04361000
*                                                                  1102 04362000
         LA    @01,@AL01102                                        1102 04363000
         BAL   @14,MSGPROC                                         1102 04364000
*              END;                                                1103 04365000
*                                                                  1103 04366000
*        END OBJLOOP;                                              1104 04367000
*                                                                  1104 04368000
         LA    @15,1                                               1104 04369000
         AL    @15,INDX                                            1104 04370000
@DE01059 ST    @15,INDX                                            1104 04371000
         L     @14,@PC00001+4                                      1104 04372000
         LA    @14,FDTPTR+8(,@14)                                  1104 04373000
         C     @15,OBJTSCNT(,@14)                                  1104 04374000
         BNH   @DL01059                                            1104 04375000
*        /************************************************************/ 04376000
*        /*                                                          */ 04377000
*        /*  RETURN TO MAIN PROCESSOR, INDICATING SUCCESSFUL         */ 04378000
*        /*  COMPLETION OF ENTIRE FUNCTION                           */ 04379000
*        /*                                                          */ 04380000
*        /************************************************************/ 04381000
*                                                                  1105 04382000
*        RETURN CODE(0);                                           1105 04383000
         SLR   @15,@15                                             1105 04384000
         L     @14,@SA00003                                        1105 04385000
         LM    @00,@12,@SA00003+8                                  1105 04386000
         BR    @14                                                 1105 04387000
*END CNCTPROC;                                                     1106 04388000
*        /************************************************************/ 04389000
*        /*                                                          */ 04390000
*        /*  PROCEDURE NAME - DUPNPROC                               */ 04391000
*        /*                                                          */ 04392000
*        /*  FUNCTION - THIS PROCEDURE IS CALLED WHEN A DUPLICATE    */ 04393000
*        /*  ENTRYNAME IS FOUND IN THE CATALOG WHEN TRYING TO        */ 04394000
*        /*  DEFINE THE DATA SET TO BE IMPORTED.  A LOCATE WILL BE   */ 04395000
*        /*  PERFORMED TO SEE IF THE ENTRY HAS THE TEMPORARY EXPORT  */ 04396000
*        /*  FLAG SET IN THE ATTRIBUTES FIELD.  IF SO, A DELETE IS   */ 04397000
*        /*  THEN PERFORMED SO THAT THE IMPORTED DATA SET MAY BE     */ 04398000
*        /*  DEFINED.                                                */ 04399000
*        /*  THE SAME LOCATE WILL ALSO LOCATE THE HIGH USED  @Y30SSFR*/ 04400000
*        /*  RBA VALUE.  IF THIS IS 0, TESTS ARE MADE TO     @Y30SSFR*/ 04401000
*        /*  COMPARE THE ATTRIBUTES OF THE EMPTY DATA SET    @Y30SSFR*/ 04402000
*        /*  WITH THOSE OF THE EXPORTED OBJECT.  IF THEY     @Y30SSFR*/ 04403000
*        /*  ARE COMPARABLE, THEN THE IMPORT IS DONE BY      @Y30SSFR*/ 04404000
*        /*  LOADING EMPTY DATA SET FROM THE PORTABILITY     @Y30SSFR*/ 04405000
*        /*  VOLUME.                                         @Y30SSFR*/ 04406000
*        /*                                                          */ 04407000
*        /*  INPUT- ENTRYNAME OF DUPLICATE CLUSTER (FROM FVT)        */ 04408000
*        /*                                                          */ 04409000
*        /*  OUTPUT - THE CATALOG NO LONGER CONTAINS THE DUPLICATE   */ 04410000
*        /*  ENTRY OR THE EMPTYDS BIT IS TURNED ON           @Y30SSFR*/ 04411000
*        /*                                                          */ 04412000
*        /************************************************************/ 04413000
*                                                                  1107 04414000
*DUPNPROC: PROCEDURE;                                              1107 04415000
*                                                                  1107 04416000
DUPNPROC STM   @14,@12,@SA00004                                    1107 04417000
*        /************************************************************/ 04418000
*        /*                                                          */ 04419000
*        /*  LOCAL DECLARES                                          */ 04420000
*        /*                                                          */ 04421000
*        /************************************************************/ 04422000
*                                                                  1108 04423000
*        DCL LCPLPTR(3)  PTR(31);      /*POINTER TO CPLS FOR LOCATE  */ 04424000
*        DCL LPSWD       PTR(31);      /*POINTER TO OBJECT PASSWORD  */ 04425000
*        DCL LDOCNTRL    BIT(1);       /*FOR CONTROLLING DO LOOPS    */ 04426000
*        DCL LOOPCTR     FIXED(31);    /*USED AS A COUNTER   @Y30SSFR*/ 04427000
*                                      /*IN CONTROLLING      @Y30SSFR*/ 04428000
*                                      /*DO LOOP             @Y30SSFR*/ 04429000
*        DCL ILDSATTR    FIXED(8) CONSTANT(1);                     1112 04430000
*        DCL ILHURBAD    FIXED(8) CONSTANT(2);             /*@Y30SSFR*/ 04431000
*        DCL ILAMDSB     FIXED(8) CONSTANT(3);             /*@Y30SSFR*/ 04432000
*        DCL ILCATACB    FIXED(8) CONSTANT(1);                     1115 04433000
*        DCL ILNAMEDS    FIXED(8) CONSTANT(2);                     1116 04434000
*        DCL ILENTYPE    FIXED(8) CONSTANT(3);             /*@Y30SSFR*/ 04435000
*                                      /*INDEXES TO FPLS USED BY     */ 04436000
*                                      /*LOCATE                      */ 04437000
*        DCL EXPMSG   CHAR(3) CONSTANT('XP0');                     1118 04438000
*                                      /*EXPORT STATIC TEXT MODULE ID * 04439000
*        DCL NOCTFLD  FIXED(8) CONSTANT(4);                        1119 04440000
*                                      /*STATIC TEXT MESSAGE ID FOR  */ 04441000
*                                      /*A MISSING CATALOG FIELD     */ 04442000
*                                                                  1120 04443000
*        DCL FHURBADS FIXED(31) BASED(CTGFLPT(1));         /*@Y30SSFR*/ 04444000
*                                      /*MAPPING OF HIGH     @Y30SSFR*/ 04445000
*                                      /*USED RBA            @Y30SSFR*/ 04446000
*                                                                  1121 04447000
*        DCL AMDSBPTR PTR(31);         /*POINTER USED TO     @Y30SSFR*/ 04448000
*                                      /*POINT TO THE AMDSB  @Y30SSFR*/ 04449000
*                                      /*USED IN THE CATALOG @Y30SSFR*/ 04450000
*                                      /*DEFINE OPERATION    @Y30SSFR*/ 04451000
*                                                                  1122 04452000
*        /************************************************************/ 04453000
*        /*                                                          */ 04454000
*        /*  TO DETERMINE IF THE DUPLICATE NAME IN THE CATALOG IS AN */ 04455000
*        /*  OBJECT WITH THE TEMPORARY EXPORT ATTRIBUTE,     @Y30SSFR*/ 04456000
*        /*  OR A PRE-DEFINED EMPTY DATA SET, SEVERAL        @Y30SSFR*/ 04457000
*        /*  CATALOG LOCATES MUST BE PERFORMED.  FIRST THE CLUSTER   */ 04458000
*        /*  MUST BE LOCATED.  A CLUSTER OBJECT DOES NOT HAVE THE    */ 04459000
*        /*  ATTRIBUTES FIELD(DSATTR) IN WHICH THE TEMPORARY EXPORT  */ 04460000
*        /*  FLAG IS SET, BUT IT MUST BE LOCATED IN ORDER TO LOCATE  */ 04461000
*        /*  THE DATA AND INDEX OBJECTS.  THE NAMEDS CATALOG FIELD   */ 04462000
*        /*  PROVIDES THE CONTROL INTERVAL NUMBER IN THE CATALOG     */ 04463000
*        /*  WHICH IS USED TO LOCATE THE DATA AND INDEX OBJECT.      */ 04464000
*        /*                                                          */ 04465000
*        /************************************************************/ 04466000
*                                                                  1122 04467000
*        OLDERID2 = NEWERID2;                                      1122 04468000
         L     @15,@PC00001                                        1122 04469000
         L     @15,GDTTR2(,@15)                                    1122 04470000
         MVC   @TS00001(95),NEWERID2(@15)                          1122 04471000
         MVC   OLDERID2(95,@15),@TS00001                           1122 04472000
*        NEWID2 = 'MPDN';                                          1123 04473000
*                                                                  1123 04474000
         MVC   NEWID2(4,@15),@CC01359                              1123 04475000
*        /************************************************************/ 04476000
*        /*                                                          */ 04477000
*        /*  CONSTRUCT THE CPL REQUIRED TO LOCATE THE CLUSTER.  THE  */ 04478000
*        /*  ENTRYNAME OF THE CLUSTER IS OBTAINED FROM THE FVT       */ 04479000
*        /*  EMPLOYED BY THE CATALOG DEFINE OPERATION.               */ 04480000
*        /*  IF THE CPL IS NOT CONSTRUCTED SUCCESSFULLY, RETURN      */ 04481000
*        /*                                                          */ 04482000
*        /************************************************************/ 04483000
*                                                                  1124 04484000
*        CTGPLPTR = PTRCPL;            /*SET CPL BASE TO DEFINE CPL  */ 04485000
*                                                                  1124 04486000
         L     @15,PTRCPL                                          1124 04487000
         ST    @15,CTGPLPTR                                        1124 04488000
*        CALL CPLPROC('L',LCPLPTR(1),FVTPTR(1)->CTGFVENT,NULLPARM, 1125 04489000
*              CPSWD);                                             1125 04490000
*                                                                  1125 04491000
         LA    @15,@CC01360                                        1125 04492000
         ST    @15,@AL00001                                        1125 04493000
         LA    @15,LCPLPTR                                         1125 04494000
         ST    @15,@AL00001+4                                      1125 04495000
         L     @01,FVTPTR                                          1125 04496000
         LA    @15,CTGFVENT(,@01)                                  1125 04497000
         ST    @15,@AL00001+8                                      1125 04498000
         LA    @15,NULLPARM                                        1125 04499000
         ST    @15,@AL00001+12                                     1125 04500000
         LA    @15,CPSWD                                           1125 04501000
         ST    @15,@AL00001+16                                     1125 04502000
         LA    @01,@AL00001                                        1125 04503000
         BAL   @14,CPLPROC                                         1125 04504000
*        RESPECIFY RTNREG RSTD;                                    1126 04505000
*        TESTRC = RTNREG;                                          1127 04506000
         LR    TESTRC,RTNREG                                       1127 04507000
*        RESPECIFY RTNREG UNRSTD;                                  1128 04508000
*        IF TESTRC ^= 0                                            1129 04509000
*          THEN                                                    1129 04510000
         LTR   TESTRC,TESTRC                                       1129 04511000
         BZ    @RF01129                                            1129 04512000
*            RETURN CODE(LASTCC12);                                1130 04513000
*                                                                  1130 04514000
         LA    @15,12                                              1130 04515000
         L     @14,@SA00004                                        1130 04516000
         LM    @00,@12,@SA00004+8                                  1130 04517000
         BR    @14                                                 1130 04518000
*        CTGPLPTR = LCPLPTR(1);        /*SET CPL BASE TO LOCATE CPL  */ 04519000
@RF01129 L     @15,LCPLPTR                                         1131 04520000
         ST    @15,CTGPLPTR                                        1131 04521000
*        CTGNOFLD = 3;                 /*SET FPL COUNT IN CPL        */ 04522000
*                                                                  1132 04523000
         MVI   CTGNOFLD(@15),X'03'                                 1132 04524000
*        /************************************************************/ 04525000
*        /*                                                          */ 04526000
*        /*      CONSTRUCT FPLS FOR THE FIELDS TO BE LOCATED WHICH   */ 04527000
*        /*      ARE -  ENTYPE, NAMEDS, AND CATACB.                  */ 04528000
*        /*      IF THE FPL IS NOT CONSTRUCTED SUCCESSFULLY, CONTROL */ 04529000
*        /*      IS RETURNED TO THE CALLING PROCESSOR                */ 04530000
*        /*                                                          */ 04531000
*        /***********************************************************/  04532000
*                                                                  1133 04533000
*        /************************************************************/ 04534000
*        /*                                                          */ 04535000
*        /*  THE FPL FOR THE CATACB FIELD WILL RETURN THE CATALOG    */ 04536000
*        /*  ACB ADDRESS FOR THE CATALOG IN WHICH THE ENTRYNAME IS   */ 04537000
*        /*  FOUND                                                   */ 04538000
*        /*                                                          */ 04539000
*        /************************************************************/ 04540000
*                                                                  1133 04541000
*        CALL BFPLPROC(ADDR(FIELDLST),ICATACB,             /*@Y30SSFR*/ 04542000
*          CTGFIELD(ILCATACB),NULLPARM,NULLPARM,NULLPARM); /*@Y30SSFR*/ 04543000
         MVC   @AL00001+4(20),@AL01133                             1133 04544000
         LA    @14,FIELDLST                                        1133 04545000
         ST    @14,@AFTEMPS+8                                      1133 04546000
         LA    @14,@AFTEMPS+8                                      1133 04547000
         ST    @14,@AL00001                                        1133 04548000
         LA    @15,CTGFIELD(,@15)                                  1133 04549000
         ST    @15,@AL00001+8                                      1133 04550000
         LA    @01,@AL00001                                        1133 04551000
         BAL   @14,BFPLPROC                                        1133 04552000
*        RESPECIFY RTNREG RSTD;                                    1134 04553000
*        TESTRC = RTNREG;                                          1135 04554000
         LR    TESTRC,RTNREG                                       1135 04555000
*        RESPECIFY RTNREG UNRSTD;                                  1136 04556000
*        IF TESTRC ^= 0                                            1137 04557000
*          THEN                                                    1137 04558000
         LTR   TESTRC,TESTRC                                       1137 04559000
         BZ    @RF01137                                            1137 04560000
*            RETURN CODE(LASTCC12);                                1138 04561000
*                                                                  1138 04562000
         LA    @15,12                                              1138 04563000
         L     @14,@SA00004                                        1138 04564000
         LM    @00,@12,@SA00004+8                                  1138 04565000
         BR    @14                                                 1138 04566000
*        /************************************************************/ 04567000
*        /*                                                          */ 04568000
*        /*  THE FPL FOR THE NAMEDS FIELD WILL RETURN INFORMATION    */ 04569000
*        /*  ABOUT THE COMPONENTS OF THIS CLUSTER.  FROM THIS        */ 04570000
*        /*  INFORMATION THE DATA AND INDEX COMPONENTS CAN BE        */ 04571000
*        /*  LOCATED.                                                */ 04572000
*        /*                                                          */ 04573000
*        /************************************************************/ 04574000
*                                                                  1139 04575000
*        CALL BFPLPROC(ADDR(FIELDLST),INAMEDS,             /*@Y30SSFR*/ 04576000
*          CTGFIELD(ILNAMEDS),NULLPARM,NULLPARM,NULLPARM); /*@Y30SSFR*/ 04577000
@RF01137 MVC   @AL00001+4(20),@AL01139                             1139 04578000
         LA    @15,FIELDLST                                        1139 04579000
         ST    @15,@AFTEMPS+8                                      1139 04580000
         LA    @15,@AFTEMPS+8                                      1139 04581000
         ST    @15,@AL00001                                        1139 04582000
         L     @01,CTGPLPTR                                        1139 04583000
         LA    @15,CTGFIELD+4(,@01)                                1139 04584000
         ST    @15,@AL00001+8                                      1139 04585000
         LA    @01,@AL00001                                        1139 04586000
         BAL   @14,BFPLPROC                                        1139 04587000
*        RESPECIFY RTNREG RSTD;                                    1140 04588000
*        TESTRC = RTNREG;                                          1141 04589000
         LR    TESTRC,RTNREG                                       1141 04590000
*        RESPECIFY RTNREG UNRSTD;                                  1142 04591000
*        IF TESTRC ^= 0                                            1143 04592000
*          THEN                                                    1143 04593000
         LTR   TESTRC,TESTRC                                       1143 04594000
         BZ    @RF01143                                            1143 04595000
*            RETURN CODE(LASTCC12);                                1144 04596000
*                                                                  1144 04597000
         LA    @15,12                                              1144 04598000
         L     @14,@SA00004                                        1144 04599000
         LM    @00,@12,@SA00004+8                                  1144 04600000
         BR    @14                                                 1144 04601000
*        /************************************************************/ 04602000
*        /*                                                          */ 04603000
*        /*  THE ENTYPE CATALOG FIELD WILL RETURN THE ENTRY TYPE     */ 04604000
*        /*  OF THE COMPONENT BEING LOCATED.  THIS INFORMATION WILL  */ 04605000
*        /*  WILL BE USED TO INSURE THAT THE DUPLICATE IN THE        */ 04606000
*        /*  CATALOG IS INDEED A CLUSTER OR AN AIX.          @Y30SSFR*/ 04607000
*        /*                                                          */ 04608000
*        /************************************************************/ 04609000
*                                                                  1145 04610000
*        CALL BFPLPROC(ADDR(FIELDLST),IENTYPE,             /*@Y30SSFR*/ 04611000
*          CTGFIELD(ILENTYPE),NULLPARM,NULLPARM,NULLPARM); /*@Y30SSFR*/ 04612000
@RF01143 MVC   @AL00001+4(20),@AL01145                             1145 04613000
         LA    @15,FIELDLST                                        1145 04614000
         ST    @15,@AFTEMPS+8                                      1145 04615000
         LA    @15,@AFTEMPS+8                                      1145 04616000
         ST    @15,@AL00001                                        1145 04617000
         L     @01,CTGPLPTR                                        1145 04618000
         LA    @15,CTGFIELD+8(,@01)                                1145 04619000
         ST    @15,@AL00001+8                                      1145 04620000
         LA    @01,@AL00001                                        1145 04621000
         BAL   @14,BFPLPROC                                        1145 04622000
*        RESPECIFY RTNREG RSTD;                                    1146 04623000
*        TESTRC = RTNREG;                                          1147 04624000
         LR    TESTRC,RTNREG                                       1147 04625000
*        RESPECIFY RTNREG UNRSTD;                                  1148 04626000
*        IF TESTRC ^= 0                                            1149 04627000
*          THEN                                                    1149 04628000
         LTR   TESTRC,TESTRC                                       1149 04629000
         BZ    @RF01149                                            1149 04630000
*            RETURN CODE(LASTCC12);                                1150 04631000
*                                                                  1150 04632000
         LA    @15,12                                              1150 04633000
         L     @14,@SA00004                                        1150 04634000
         LM    @00,@12,@SA00004+8                                  1150 04635000
         BR    @14                                                 1150 04636000
*        /************************************************************/ 04637000
*        /*                                                          */ 04638000
*        /*      INVOKE CATALOG MANAGEMENT TO ISSUE CATALOG LOCATE   */ 04639000
*        /*      FOR THE CLUSTER OR AIX.                     @Y30SSFR*/ 04640000
*        /*      IF LOCATE FAILS, RETURN TO CALLING PROCESSOR        */ 04641000
*        /*                                                          */ 04642000
*        /************************************************************/ 04643000
*                                                                  1151 04644000
*        CALL CTLGPROC(LCPLPTR(1));                        /*@Y30SSFR*/ 04645000
*                                                                  1151 04646000
@RF01149 LA    @15,LCPLPTR                                         1151 04647000
         ST    @15,@AL00001                                        1151 04648000
         LA    @01,@AL00001                                        1151 04649000
         BAL   @14,CTLGPROC                                        1151 04650000
*        RESPECIFY RTNREG RSTD;                                    1152 04651000
*        TESTRC = RTNREG;                                          1153 04652000
         LR    TESTRC,RTNREG                                       1153 04653000
*        RESPECIFY RTNREG UNRSTD;                                  1154 04654000
*        IF TESTRC ^= 0                                            1155 04655000
*          THEN                                                    1155 04656000
         LTR   TESTRC,TESTRC                                       1155 04657000
         BZ    @RF01155                                            1155 04658000
*            RETURN CODE(LASTCC12);                                1156 04659000
*                                                                  1156 04660000
         LA    @15,12                                              1156 04661000
         L     @14,@SA00004                                        1156 04662000
         LM    @00,@12,@SA00004+8                                  1156 04663000
         BR    @14                                                 1156 04664000
*        /************************************************************/ 04665000
*        /*                                                          */ 04666000
*        /*  CHECK TO SEE THAT THE DUPLICATE ENTRY IS INDEED @Y30SSFR*/ 04667000
*        /*  A CLUSTER OR AN AIX.  IF NOT, INDICATE ERROR    @Y30SSFR*/ 04668000
*        /*  AND RETURN TO THE CALLING PROCESSOR.            @Y30SSFR*/ 04669000
*        /*                                                          */ 04670000
*        /************************************************************/ 04671000
*                                                                  1157 04672000
*        CTGFLPTR = CTGFIELD(ILENTYPE);                            1157 04673000
*                                                                  1157 04674000
@RF01155 L     @01,CTGPLPTR                                        1157 04675000
         L     CTGFLPTR,CTGFIELD+8(,@01)                           1157 04676000
*        /************************************************************/ 04677000
*        /*                                                          */ 04678000
*        /*        BE SURE ENTYPE INFORMATION WAS RETURNED           */ 04679000
*        /*                                                          */ 04680000
*        /************************************************************/ 04681000
*                                                                  1158 04682000
*        IF CTGFLNG(1) ^= 0                                        1158 04683000
*          THEN                                                    1158 04684000
         L     @05,CTGFLNG(,CTGFLPTR)                              1158 04685000
         LTR   @05,@05                                             1158 04686000
         BZ    @RF01158                                            1158 04687000
*            IF FENTYPE ^= CTGTCL & FENTYPE ^= CTGTAIX     /*@Y30SSFR*/ 04688000
*              THEN                                                1159 04689000
*                                                                  1159 04690000
         L     @05,CTGFLPT(,CTGFLPTR)                              1159 04691000
         CLI   FENTYPE(@05),C'C'                                   1159 04692000
         BE    @RF01159                                            1159 04693000
         CLI   FENTYPE(@05),C'G'                                   1159 04694000
         BE    @RF01159                                            1159 04695000
*                /****************************************************/ 04696000
*                /*                                                  */ 04697000
*                /*  ENTYPE NOT VALID - RETURN WITH ERROR    @Y30SSFR*/ 04698000
*                /*                                                  */ 04699000
*                /****************************************************/ 04700000
*                                                                  1160 04701000
*                DO;                                               1160 04702000
*                DARGSMOD = IMPMSG;                        /*@Y30SSFR*/ 04703000
         L     @01,DDSTRU                                          1161 04704000
         MVC   DARGSMOD(3,@01),@CC01000                            1161 04705000
*                DEFSTID = NOCLUSNM;                               1162 04706000
         MVI   DEFSTID,X'08'                                       1162 04707000
*                RETURN CODE(LASTCC12);                            1163 04708000
         LA    @15,12                                              1163 04709000
         L     @14,@SA00004                                        1163 04710000
         LM    @00,@12,@SA00004+8                                  1163 04711000
         BR    @14                                                 1163 04712000
*                END;                                              1164 04713000
*              ELSE;                                               1165 04714000
*                                                                  1165 04715000
@RF01159 DS    0H                                                  1166 04716000
*            /********************************************************/ 04717000
*            /*                                                      */ 04718000
*            /*  IF ENTYPE INFORMATION NOT RETURNED, THEN    @Y30SSFR*/ 04719000
*            /*  CATALOG IS IN ERROR. RETURN TO CALLING PROCESSOR    */ 04720000
*            /*                                                      */ 04721000
*            /********************************************************/ 04722000
*                                                                  1166 04723000
*          ELSE                                                    1166 04724000
*            DO;                                                   1166 04725000
         B     @RC01158                                            1166 04726000
@RF01158 DS    0H                                                  1167 04727000
*            DEFSTID = NOCTFLD;                                    1167 04728000
         MVI   DEFSTID,X'04'                                       1167 04729000
*            DARGSMOD = EXPMSG;                                    1168 04730000
         L     @01,DDSTRU                                          1168 04731000
         MVC   DARGSMOD(3,@01),@CC01355                            1168 04732000
*            RETURN CODE(LASTCC12);                                1169 04733000
         LA    @15,12                                              1169 04734000
         L     @14,@SA00004                                        1169 04735000
         LM    @00,@12,@SA00004+8                                  1169 04736000
         BR    @14                                                 1169 04737000
*            END;                                                  1170 04738000
*                                                                  1170 04739000
*        /************************************************************/ 04740000
*        /*                                                          */ 04741000
*        /*  GET CONTROL INTERVALS FOR THE CLUSTER OR AIX    @Y30SSFR*/ 04742000
*        /*  COMPONENTS FROM THE NAMEDS CATALOG FIELD.       @Y30SSFR*/ 04743000
*        /*                                                          */ 04744000
*        /************************************************************/ 04745000
*                                                                  1171 04746000
*        CTGPLPTR = LCPLPTR(1);                                    1171 04747000
@RC01158 L     @05,LCPLPTR                                         1171 04748000
         ST    @05,CTGPLPTR                                        1171 04749000
*        CTGFLPTR = CTGFIELD(ILNAMEDS);                            1172 04750000
         L     CTGFLPTR,CTGFIELD+4(,@05)                           1172 04751000
*        IF CTGFLNG(1) ^= 0                                        1173 04752000
*          THEN                                                    1173 04753000
         L     @05,CTGFLNG(,CTGFLPTR)                              1173 04754000
         LTR   @05,@05                                             1173 04755000
         BZ    @RF01173                                            1173 04756000
*            IF CTGFLNG(1) = LNAMEDS                       /*@Y30SSFR*/ 04757000
*              THEN                                        /*@Y30SSFR*/ 04758000
         CH    @05,LNAMEDS                                         1174 04759000
         BNE   @RF01174                                            1174 04760000
*                DO;                                       /*@Y30SSFR*/ 04761000
*                LOOPCTR = 1;                              /*@Y30SSFR*/ 04762000
         MVC   LOOPCTR(4),@CF00221                                 1176 04763000
*                FNMPTR = CTGFLPT(1);                      /*@Y30SSFR*/ 04764000
         L     @05,CTGFLPT(,CTGFLPTR)                              1177 04765000
         ST    @05,FNMPTR                                          1177 04766000
*                END;                                      /*@Y30SSFR*/ 04767000
*              ELSE                                        /*@Y30SSFR*/ 04768000
*                DO;                                       /*@Y30SSFR*/ 04769000
         B     @RC01174                                            1179 04770000
@RF01174 DS    0H                                                  1180 04771000
*                FNMPTR = CTGFLPT(1) + LNAMEDS;            /*@Y30SSFR*/ 04772000
         LH    @05,LNAMEDS                                         1180 04773000
         AL    @05,CTGFLPT(,CTGFLPTR)                              1180 04774000
         ST    @05,FNMPTR                                          1180 04775000
*                IF FTYPE = CTGTINDX                       /*@Y30SSFR*/ 04776000
*                  THEN                                    /*@Y30SSFR*/ 04777000
         CLI   FTYPE(@05),C'I'                                     1181 04778000
         BNE   @RF01181                                            1181 04779000
*                    LOOPCTR = 2;                          /*@Y30SSFR*/ 04780000
         MVC   LOOPCTR(4),@CF00156                                 1182 04781000
*                  ELSE                                    /*@Y30SSFR*/ 04782000
*                    LOOPCTR = 1;                          /*@Y30SSFR*/ 04783000
         B     @RC01181                                            1183 04784000
@RF01181 MVC   LOOPCTR(4),@CF00221                                 1183 04785000
*                FNMPTR = CTGFLPT(1);                      /*@Y30SSFR*/ 04786000
@RC01181 L     @05,CTGFLPT(,CTGFLPTR)                              1184 04787000
         ST    @05,FNMPTR                                          1184 04788000
*                END;                                      /*@Y30SSFR*/ 04789000
*                                                                  1185 04790000
*          /**********************************************************/ 04791000
*          /*                                                        */ 04792000
*          /*  IF NO CLUSTER OR AIX COMPONENTS, RETURN TO    @Y30SSFR*/ 04793000
*          /*  CALLING PROCESSOR                             @Y30SSFR*/ 04794000
*          /*                                                        */ 04795000
*          /**********************************************************/ 04796000
*                                                                  1186 04797000
*          ELSE                                                    1186 04798000
*            DO;                                                   1186 04799000
         B     @RC01173                                            1186 04800000
@RF01173 DS    0H                                                  1187 04801000
*            DEFSTID = NOCTFLD;                                    1187 04802000
         MVI   DEFSTID,X'04'                                       1187 04803000
*            DARGSMOD = EXPMSG;                                    1188 04804000
         L     @01,DDSTRU                                          1188 04805000
         MVC   DARGSMOD(3,@01),@CC01355                            1188 04806000
*            RETURN CODE(LASTCC12);                                1189 04807000
         LA    @15,12                                              1189 04808000
         L     @14,@SA00004                                        1189 04809000
         LM    @00,@12,@SA00004+8                                  1189 04810000
         BR    @14                                                 1189 04811000
*            END;                                                  1190 04812000
*                                                                  1190 04813000
*        /************************************************************/ 04814000
*        /*                                                          */ 04815000
*        /*      IF CATALOG ACB IS NOT ALREADY KNOWN DUE TO OPEN     */ 04816000
*        /*      OF CATALOG, THEN PICK ADDRESS UP FROM CATACB FIELD  */ 04817000
*        /*      WHICH WAS RETURNED BY CATALOG MANAGEMENT LOCATE     */ 04818000
*        /*                                                          */ 04819000
*        /************************************************************/ 04820000
*                                                                  1191 04821000
*        IF  PTRCTACB = NULLPTR                                    1191 04822000
*          THEN                                                    1191 04823000
@RC01173 L     @15,PTRCTACB                                        1191 04824000
         LTR   @15,@15                                             1191 04825000
         BNZ   @RF01191                                            1191 04826000
*            DO;                                                   1192 04827000
*            CTGFLPTR = CTGFIELD(ILCATACB);                        1193 04828000
         L     @01,CTGPLPTR                                        1193 04829000
         L     CTGFLPTR,CTGFIELD(,@01)                             1193 04830000
*            PTRCTACB = FCATACB;                                   1194 04831000
         L     @05,CTGFLPT(,CTGFLPTR)                              1194 04832000
         L     @05,FCATACB(,@05)                                   1194 04833000
         ST    @05,PTRCTACB                                        1194 04834000
*            END;                                                  1195 04835000
*                                                                  1195 04836000
*        /************************************************************/ 04837000
*        /*                                                          */ 04838000
*        /*      NOW DO LOCATE ON EACH OF ASSOCIATED COMPONENTS OF   */ 04839000
*        /*      THE CLUSTER, WHOSE CONTROL INTERVAL NUMBERS ARE     */ 04840000
*        /*      INDICATED FROM THE NAMEDS FPL                       */ 04841000
*        /*      THE LOOP CONTROL FLAG WILL BE TURNED OFF IF THE     */ 04842000
*        /*  TEMPORARY EXPORT ATTRIBUTE IS PRESENT OR IF THE @Y30SSFR*/ 04843000
*        /*  THE DATA SET IS EMPTY.  OTHERWISE THE LOOP WILL @Y30SSFR*/ 04844000
*        /*  TERMINATE WHEN ALL COMPONENTS HAVE BEEN LOCATED @Y30SSFR*/ 04845000
*        /*                                                          */ 04846000
*        /************************************************************/ 04847000
*                                                                  1196 04848000
*        LDOCNTRL = ON;                                            1196 04849000
@RF01191 OI    LDOCNTRL,B'10000000'                                1196 04850000
*LOCLOOP:DO I = 1 TO LOOPCTR WHILE LDOCNTRL = ON;                  1197 04851000
*                                                                  1197 04852000
LOCLOOP  LA    I,1                                                 1197 04853000
         B     @DE01197                                            1197 04854000
@DL01197 TM    LDOCNTRL,B'10000000'                                1197 04855000
         BNO   @DC01197                                            1197 04856000
*          /**********************************************************/ 04857000
*          /*                                                        */ 04858000
*          /*      CONSTRUCT CPL FOR LOCATE OF COMPONENT             */ 04859000
*          /*      IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR    */ 04860000
*          /*                                                        */ 04861000
*          /**********************************************************/ 04862000
*                                                                  1198 04863000
*          CALL CPLPROC('L',LCPLPTR(I+1),NULLPARM,FNAME,CPSWD);    1198 04864000
*                                                                  1198 04865000
         LA    @02,@CC01360                                        1198 04866000
         ST    @02,@AL00001                                        1198 04867000
         LR    @02,I                                               1198 04868000
         SLA   @02,2                                               1198 04869000
         LA    @02,LCPLPTR(@02)                                    1198 04870000
         ST    @02,@AL00001+4                                      1198 04871000
         LA    @02,NULLPARM                                        1198 04872000
         ST    @02,@AL00001+8                                      1198 04873000
         L     @02,FNMPTR                                          1198 04874000
         LA    @02,FNAME(,@02)                                     1198 04875000
         ST    @02,@AL00001+12                                     1198 04876000
         LA    @02,CPSWD                                           1198 04877000
         ST    @02,@AL00001+16                                     1198 04878000
         LA    @01,@AL00001                                        1198 04879000
         BAL   @14,CPLPROC                                         1198 04880000
*          RESPECIFY RTNREG RSTD;                                  1199 04881000
*          TESTRC = RTNREG;                                        1200 04882000
         LR    TESTRC,RTNREG                                       1200 04883000
*          RESPECIFY RTNREG UNRSTD;                                1201 04884000
*          IF TESTRC ^= 0                                          1202 04885000
*            THEN                                                  1202 04886000
         LTR   TESTRC,TESTRC                                       1202 04887000
         BZ    @RF01202                                            1202 04888000
*              RETURN CODE(LASTCC12);                              1203 04889000
*                                                                  1203 04890000
         LA    @15,12                                              1203 04891000
         L     @14,@SA00004                                        1203 04892000
         LM    @00,@12,@SA00004+8                                  1203 04893000
         BR    @14                                                 1203 04894000
*          /**********************************************************/ 04895000
*          /*                                                @Y30SSFR*/ 04896000
*          /*  SET THE CTGPLPTR TO POINT TO THE CPL JUST     @Y30SSFR*/ 04897000
*          /*  CONSTRUCTED.                                  @Y30SSFR*/ 04898000
*          /*                                                @Y30SSFR*/ 04899000
*          /**********************************************************/ 04900000
*                                                                  1204 04901000
*          CTGPLPTR = LCPLPTR(I+1);                        /*@Y30SSFR*/ 04902000
*                                                                  1204 04903000
@RF01202 LR    @02,I                                               1204 04904000
         SLA   @02,2                                               1204 04905000
         L     @02,LCPLPTR(@02)                                    1204 04906000
         ST    @02,CTGPLPTR                                        1204 04907000
*          /**********************************************************/ 04908000
*          /*                                                @Y30SSFR*/ 04909000
*          /*  SET THE VALUE OF CTGNOFLD TO 3 TO INDICATE    @Y30SSFR*/ 04910000
*          /*  THAT THE LOCATE IS ON 3 CATALOG FIELDS.       @Y30SSFR*/ 04911000
*          /*                                                @Y30SSFR*/ 04912000
*          /**********************************************************/ 04913000
*                                                                  1205 04914000
*                                                                  1205 04915000
*          CTGNOFLD = 3;                                   /*@Y30SSFR*/ 04916000
*                                                                  1205 04917000
         MVI   CTGNOFLD(@02),X'03'                                 1205 04918000
*          /**********************************************************/ 04919000
*          /*                                                        */ 04920000
*          /*      CONSTRUCT DSATTR, HURBADS, AND AMDSBCAT   @Y30SSFR*/ 04921000
*          /*      FPLS.  PLACE POINTERS IN THE CPL.         @Y30SSFR*/ 04922000
*          /*      IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR    */ 04923000
*          /*                                                        */ 04924000
*          /**********************************************************/ 04925000
*                                                                  1206 04926000
*          CALL BFPLPROC(ADDR(FIELDLST),IDSATTR,           /*@Y30SSFR*/ 04927000
*            CTGFIELD(ILDSATTR),NULLPARM,NULLPARM,         /*@Y30SSFR*/ 04928000
*            NULLPARM);                                    /*@Y30SSFR*/ 04929000
*                                                                  1206 04930000
         MVC   @AL00001+4(20),@AL01206                             1206 04931000
         LA    @15,FIELDLST                                        1206 04932000
         ST    @15,@AFTEMPS+8                                      1206 04933000
         LA    @15,@AFTEMPS+8                                      1206 04934000
         ST    @15,@AL00001                                        1206 04935000
         LA    @02,CTGFIELD(,@02)                                  1206 04936000
         ST    @02,@AL00001+8                                      1206 04937000
         LA    @01,@AL00001                                        1206 04938000
         BAL   @14,BFPLPROC                                        1206 04939000
*          RESPECIFY RTNREG RSTD;                                  1207 04940000
*          TESTRC = RTNREG;                                        1208 04941000
         LR    TESTRC,RTNREG                                       1208 04942000
*          RESPECIFY RTNREG UNRSTD;                                1209 04943000
*          IF TESTRC ^= 0                                          1210 04944000
*            THEN                                                  1210 04945000
         LTR   TESTRC,TESTRC                                       1210 04946000
         BZ    @RF01210                                            1210 04947000
*              RETURN CODE(LASTCC12);                              1211 04948000
*                                                                  1211 04949000
         LA    @15,12                                              1211 04950000
         L     @14,@SA00004                                        1211 04951000
         LM    @00,@12,@SA00004+8                                  1211 04952000
         BR    @14                                                 1211 04953000
*          CALL BFPLPROC(ADDR(FIELDLST),IHURBAD,          /*@Y30SSFR*/  04954000
*             CTGFIELD(ILHURBAD),NULLPARM,NULLPARM,        /*@Y30SSFR*/ 04955000
*             NULLPARM);                                   /*@Y30SSFR*/ 04956000
*                                                                  1212 04957000
@RF01210 MVC   @AL00001+4(20),@AL01212                             1212 04958000
         LA    @02,FIELDLST                                        1212 04959000
         ST    @02,@AFTEMPS+8                                      1212 04960000
         LA    @02,@AFTEMPS+8                                      1212 04961000
         ST    @02,@AL00001                                        1212 04962000
         L     @02,CTGPLPTR                                        1212 04963000
         LA    @02,CTGFIELD+4(,@02)                                1212 04964000
         ST    @02,@AL00001+8                                      1212 04965000
         LA    @01,@AL00001                                        1212 04966000
         BAL   @14,BFPLPROC                                        1212 04967000
*          RESPECIFY RTNREG RSTD;                                  1213 04968000
*          TESTRC = RTNREG;                                        1214 04969000
         LR    TESTRC,RTNREG                                       1214 04970000
*          RESPECIFY RTNREG UNRSTD;                        /*@Y30SSFR*/ 04971000
*                                                                  1215 04972000
*          IF TESTRC ^= 0                                          1216 04973000
*            THEN                                                  1216 04974000
         LTR   TESTRC,TESTRC                                       1216 04975000
         BZ    @RF01216                                            1216 04976000
*              RETURN CODE(LASTCC12);                      /*@Y30SSFR*/ 04977000
*                                                                  1217 04978000
         LA    @15,12                                              1217 04979000
         L     @14,@SA00004                                        1217 04980000
         LM    @00,@12,@SA00004+8                                  1217 04981000
         BR    @14                                                 1217 04982000
*          CALL BFPLPROC(ADDR(FIELDLST),IAMDSB,                    1218 04983000
*             CTGFIELD(ILAMDSB),NULLPARM,NULLPARM,                 1218 04984000
*             NULLPARM);                                   /*@Y30SSFR*/ 04985000
*                                                                  1218 04986000
@RF01216 MVC   @AL00001+4(20),@AL01218                             1218 04987000
         LA    @02,FIELDLST                                        1218 04988000
         ST    @02,@AFTEMPS+8                                      1218 04989000
         LA    @02,@AFTEMPS+8                                      1218 04990000
         ST    @02,@AL00001                                        1218 04991000
         L     @02,CTGPLPTR                                        1218 04992000
         LA    @02,CTGFIELD+8(,@02)                                1218 04993000
         ST    @02,@AL00001+8                                      1218 04994000
         LA    @01,@AL00001                                        1218 04995000
         BAL   @14,BFPLPROC                                        1218 04996000
*          RESPECIFY RTNREG RSTD;                                  1219 04997000
*          TESTRC = RTNREG;                                        1220 04998000
         LR    TESTRC,RTNREG                                       1220 04999000
*          RESPECIFY RTNREG UNRSTD;                        /*@Y30SSFR*/ 05000000
*                                                                  1221 05001000
*          IF TESTRC ^= 0                                          1222 05002000
*            THEN                                                  1222 05003000
         LTR   TESTRC,TESTRC                                       1222 05004000
         BZ    @RF01222                                            1222 05005000
*              RETURN CODE(LASTCC12);                      /*@Y30SSFR*/ 05006000
*                                                                  1223 05007000
         LA    @15,12                                              1223 05008000
         L     @14,@SA00004                                        1223 05009000
         LM    @00,@12,@SA00004+8                                  1223 05010000
         BR    @14                                                 1223 05011000
*          /**********************************************************/ 05012000
*          /*                                                @Y30SSFR*/ 05013000
*          /*      INVOKE CATALOG MANAGEMENT TO LOCATE DATA OR INDEX */ 05014000
*          /*    COMPONENT.                                  @Y30SSFR*/ 05015000
*          /*      IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR    */ 05016000
*          /*                                                @Y30SSFR*/ 05017000
*          /**********************************************************/ 05018000
*                                                                  1224 05019000
*          CALL CTLGPROC(LCPLPTR(I+1));                    /*@Y30SSFR*/ 05020000
*                                                                  1224 05021000
@RF01222 LR    @02,I                                               1224 05022000
         SLA   @02,2                                               1224 05023000
         LA    @02,LCPLPTR(@02)                                    1224 05024000
         ST    @02,@AL00001                                        1224 05025000
         LA    @01,@AL00001                                        1224 05026000
         BAL   @14,CTLGPROC                                        1224 05027000
*          RESPECIFY RTNREG RSTD;                                  1225 05028000
*          TESTRC = RTNREG;                                        1226 05029000
         LR    TESTRC,RTNREG                                       1226 05030000
*          RESPECIFY RTNREG UNRSTD;                        /*@Y30SSFR*/ 05031000
*          IF TESTRC ^= 0                                          1228 05032000
*            THEN                                                  1228 05033000
         LTR   TESTRC,TESTRC                                       1228 05034000
         BZ    @RF01228                                            1228 05035000
*              RETURN CODE(LASTCC12);                      /*@Y30SSFR*/ 05036000
*                                                                  1229 05037000
         LA    @15,12                                              1229 05038000
         L     @14,@SA00004                                        1229 05039000
         LM    @00,@12,@SA00004+8                                  1229 05040000
         BR    @14                                                 1229 05041000
*          /**********************************************************/ 05042000
*          /*                                                @Y30SSFR*/ 05043000
*          /*      CHECK DSATTR FIELD FOR TEMPORARY EXPORT FLAG      */ 05044000
*          /*    CHECK HURBADS FIELD FOR AN EMPTY DATA SET.  @Y30SSFR*/ 05045000
*          /*                                                @Y30SSFR*/ 05046000
*          /**********************************************************/ 05047000
*                                                                  1230 05048000
*          CTGPLPTR = LCPLPTR(I+1);                        /*@Y30SSFR*/ 05049000
@RF01228 LR    @05,I                                               1230 05050000
         SLA   @05,2                                               1230 05051000
         L     @05,LCPLPTR(@05)                                    1230 05052000
         ST    @05,CTGPLPTR                                        1230 05053000
*          CTGFLPTR = CTGFIELD(1);                         /*@Y30SSFR*/ 05054000
         L     CTGFLPTR,CTGFIELD(,@05)                             1231 05055000
*          IF FDSTMPEX = ON                                        1232 05056000
*            THEN                                                  1232 05057000
         L     @05,CTGFLPT(,CTGFLPTR)                              1232 05058000
         TM    FDSTMPEX(@05),B'00000010'                           1232 05059000
         BNO   @RF01232                                            1232 05060000
*              LDOCNTRL = OFF;                             /*@Y30SSFR*/ 05061000
         NI    LDOCNTRL,B'01111111'                                1233 05062000
*            ELSE                                                  1234 05063000
*              DO;                                         /*@Y30SSFR*/ 05064000
         B     @RC01232                                            1234 05065000
@RF01232 DS    0H                                                  1235 05066000
*              CTGFLPTR = CTGFIELD(ILHURBAD);              /*@Y30SSFR*/ 05067000
         L     @02,CTGPLPTR                                        1235 05068000
         L     CTGFLPTR,CTGFIELD+4(,@02)                           1235 05069000
*              IF FHURBADS = 0 & I = 1                     /*@Y30SSFR*/ 05070000
*                THEN                                      /*@Y30SSFR*/ 05071000
         L     @05,CTGFLPT(,CTGFLPTR)                              1236 05072000
         L     @05,FHURBADS(,@05)                                  1236 05073000
         LTR   @05,@05                                             1236 05074000
         BNZ   @RF01236                                            1236 05075000
         C     I,@CF00221                                          1236 05076000
         BNE   @RF01236                                            1236 05077000
*                  DO;                                     /*@Y30SSFR*/ 05078000
*                  LDOCNTRL = OFF;                         /*@Y30SSFR*/ 05079000
         NI    LDOCNTRL,B'01111111'                                1238 05080000
*                  EMPTYDS = ON;                           /*@Y30SSFR*/ 05081000
         OI    EMPTYDS,B'10000000'                                 1239 05082000
*                  END;                                    /*@Y30SSFR*/ 05083000
*                ELSE                                      /*@Y30SSFR*/ 05084000
*                  FNMPTR = FNMPTR + LNAMEDS;              /*@Y30SSFR*/ 05085000
         B     @RC01236                                            1241 05086000
@RF01236 LH    @02,LNAMEDS                                         1241 05087000
         AL    @02,FNMPTR                                          1241 05088000
         ST    @02,FNMPTR                                          1241 05089000
*              END;                                        /*@Y30SSFR*/ 05090000
*                                                                  1242 05091000
@RC01236 DS    0H                                                  1243 05092000
*        END LOCLOOP;                                      /*@Y30SSFR*/ 05093000
*                                                                  1243 05094000
@RC01232 AL    I,@CF00221                                          1243 05095000
@DE01197 C     I,LOOPCTR                                           1243 05096000
         BNH   @DL01197                                            1243 05097000
@DC01197 DS    0H                                                  1244 05098000
*        /************************************************************/ 05099000
*        /*                                                  @Y30SSFR*/ 05100000
*        /*        IF THE DUPLICATE ENTRY DOES NOT HAVE THE TEMPORARY*/ 05101000
*        /*        EXPORT ATTRIBUTE OR IS NOT EMPTY,         @Y30SSFR*/ 05102000
*        /*        RETURN TO CALLING PROCESSOR               @Y30SSFR*/ 05103000
*        /*        WITH AN ERROR INDICATED                   @Y30SSFR*/ 05104000
*        /*                                                  @Y30SSFR*/ 05105000
*        /************************************************************/ 05106000
*                                                                  1244 05107000
*        IF LDOCNTRL = ON                                          1244 05108000
*          THEN                                                    1244 05109000
         TM    LDOCNTRL,B'10000000'                                1244 05110000
         BNO   @RF01244                                            1244 05111000
*            DO;                                           /*@Y30SSFR*/ 05112000
*            DARGSMOD = IMPMSG;                            /*@Y30SSFR*/ 05113000
         L     @01,DDSTRU                                          1246 05114000
         MVC   DARGSMOD(3,@01),@CC01000                            1246 05115000
*            DEFSTID = DELNTEMP;                           /*@Y30SSFR*/ 05116000
         MVI   DEFSTID,X'0D'                                       1247 05117000
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/ 05118000
         LA    @15,12                                              1248 05119000
         L     @14,@SA00004                                        1248 05120000
         LM    @00,@12,@SA00004+8                                  1248 05121000
         BR    @14                                                 1248 05122000
*            END;                                          /*@Y30SSFR*/ 05123000
*                                                                  1249 05124000
*        /************************************************************/ 05125000
*        /*                                                  @Y30SSFR*/ 05126000
*        /*  IF WE HAVE AN EMPTY DATA SET TO IMPORT INTO,    @Y30SSFR*/ 05127000
*        /*  TEST TO BE CERTAIN THAT THE ATTRIBUTES OF THAT  @Y30SSFR*/ 05128000
*        /*  DATA SET ARE CONSISTENT WITH THOSE OF THE       @Y30SSFR*/ 05129000
*        /*  PORTABLE DATA SET.                              @Y30SSFR*/ 05130000
*        /*                                                  @Y30SSFR*/ 05131000
*        /************************************************************/ 05132000
*                                                                  1250 05133000
*        IF EMPTYDS = ON                                           1250 05134000
*          THEN                                                    1250 05135000
*                                                                  1250 05136000
@RF01244 TM    EMPTYDS,B'10000000'                                 1250 05137000
         BNO   @RF01250                                            1250 05138000
*            /********************************************************/ 05139000
*            /*                                              @Y30SSFR*/ 05140000
*            /*  CHECK TO BE SURE THAT THE DATA SETS HAVE    @Y30SSFR*/ 05141000
*            /*  THE SAME NUMBER OF NON-PATH COMPONENTS.     @Y30SSFR*/ 05142000
*            /*                                              @Y30SSFR*/ 05143000
*            /********************************************************/ 05144000
*                                                                  1251 05145000
*            IF NUMCOMP ^= LOOPCTR + 1                     /*@Y30SSFR*/ 05146000
*              THEN                                        /*@Y30SSFR*/ 05147000
         LA    @15,1                                               1251 05148000
         AL    @15,LOOPCTR                                         1251 05149000
         CH    @15,NUMCOMP                                         1251 05150000
         BE    @RF01251                                            1251 05151000
*                DO;                                       /*@Y30SSFR*/ 05152000
*                DEFSTID = INCOMPAR;                       /*@Y30SSFR*/ 05153000
         MVI   DEFSTID,X'11'                                       1253 05154000
*                DARGSMOD = IMPMSG;                        /*@Y30SSFR*/ 05155000
         L     @01,DDSTRU                                          1254 05156000
         MVC   DARGSMOD(3,@01),@CC01000                            1254 05157000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 05158000
         LA    @15,12                                              1255 05159000
         L     @14,@SA00004                                        1255 05160000
         LM    @00,@12,@SA00004+8                                  1255 05161000
         BR    @14                                                 1255 05162000
*                END;                                      /*@Y30SSFR*/ 05163000
*                                                                  1256 05164000
*              /******************************************************/ 05165000
*              /*                                            @Y30SSFR*/ 05166000
*              /*  BOTH DATA SETS HAVE THE SAME NUMBER OF    @Y30SSFR*/ 05167000
*              /*  COMPONENTS.  TEST TO MAKE SURE THAT BOTH  @Y30SSFR*/ 05168000
*              /*  ARE RRDS'S OR NEITHER IS.  ALSO CHECK FOR @Y30SSFR*/ 05169000
*              /*  EQUALITY OF KEY LENGTH AND RELATIVE KEY   @Y30SSFR*/ 05170000
*              /*  POSITION.  MAKE SURE THAT THE MAXIMUM     @Y30SSFR*/ 05171000
*              /*  LRECL OF THE EMPTY DATA SET IS GREATER    @Y30SSFR*/ 05172000
*              /*  THAN OR EQUAL TO THAT OF THE PORTABILITY  @Y30SSFR*/ 05173000
*              /*  DATA SET.                                 @Y30SSFR*/ 05174000
*              /*                                            @Y30SSFR*/ 05175000
*              /******************************************************/ 05176000
*                                                                  1257 05177000
*              ELSE                                        /*@Y30SSFR*/ 05178000
*                DO;                                       /*@Y30SSFR*/ 05179000
@RF01251 DS    0H                                                  1258 05180000
*                CTGPLPTR = LCPLPTR(2);                    /*@Y30SSFR*/ 05181000
         L     @05,LCPLPTR+4                                       1258 05182000
         ST    @05,CTGPLPTR                                        1258 05183000
*                CTGFLPTR = CTGFIELD(ILAMDSB);             /*@Y30SSFR*/ 05184000
         L     CTGFLPTR,CTGFIELD+8(,@05)                           1259 05185000
*                DSCCATPT = CTGFLPT(1);                    /*@Y30SSFR*/ 05186000
         L     DSCCATPT,CTGFLPT(,CTGFLPTR)                         1260 05187000
*                AMDSBPTR = FVTPTR(2) -> CTGFVAMD ->       /*@Y30SSFR*/ 05188000
*                   CTGFLPT(1);                            /*@Y30SSFR*/ 05189000
         L     @01,FVTPTR+4                                        1261 05190000
         L     @01,CTGFVAMD(,@01)                                  1261 05191000
         L     AMDSBPTR,CTGFLPT(,@01)                              1261 05192000
*                IF (AMDKEYLN ^= AMDSBPTR ->               /*@Y30SSFR*/ 05193000
*                   AMDKEYLN) |                            /*@Y30SSFR*/ 05194000
*                   (AMDRKP ^= AMDSBPTR ->                 /*@Y30SSFR*/ 05195000
*                   AMDRKP) |                              /*@Y30SSFR*/ 05196000
*                   (AMDLRECL < AMDSBPTR ->                /*@Y30SSFR*/ 05197000
*                   AMDLRECL)                              /*@Y30SSFR*/ 05198000
*                  THEN                                    /*@Y30SSFR*/ 05199000
         CLC   AMDKEYLN(2,DSCCATPT),AMDKEYLN(AMDSBPTR)             1262 05200000
         BNE   @RT01262                                            1262 05201000
         CLC   AMDRKP(2,DSCCATPT),AMDRKP(AMDSBPTR)                 1262 05202000
         BNE   @RT01262                                            1262 05203000
         L     @15,AMDLRECL(,DSCCATPT)                             1262 05204000
         C     @15,AMDLRECL(,AMDSBPTR)                             1262 05205000
         BNL   @RF01262                                            1262 05206000
@RT01262 DS    0H                                                  1263 05207000
*                    DO;                                   /*@Y30SSFR*/ 05208000
*                    DEFSTID = INCOMPAR;                   /*@Y30SSFR*/ 05209000
         MVI   DEFSTID,X'11'                                       1264 05210000
*                    DARGSMOD = IMPMSG;                    /*@Y30SSFR*/ 05211000
         L     @01,DDSTRU                                          1265 05212000
         MVC   DARGSMOD(3,@01),@CC01000                            1265 05213000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 05214000
         LA    @15,12                                              1266 05215000
         L     @14,@SA00004                                        1266 05216000
         LM    @00,@12,@SA00004+8                                  1266 05217000
         BR    @14                                                 1266 05218000
*                    END;                                  /*@Y30SSFR*/ 05219000
*                IF (AMDRRDS = ON & AMDSBPTR ->            /*@Y30SSFR*/ 05220000
*                    AMDRRDS = OFF) |                      /*@Y30SSFR*/ 05221000
*                   (AMDRRDS = OFF & AMDSBPTR ->           /*@Y30SSFR*/ 05222000
*                    AMDRRDS = ON)                         /*@Y30SSFR*/ 05223000
*                  THEN                                    /*@Y30SSFR*/ 05224000
@RF01262 TM    AMDRRDS(DSCCATPT),B'00000010'                       1268 05225000
         BNO   @GL00022                                            1268 05226000
         TM    AMDRRDS(AMDSBPTR),B'00000010'                       1268 05227000
         BZ    @RT01268                                            1268 05228000
@GL00022 TM    AMDRRDS(DSCCATPT),B'00000010'                       1268 05229000
         BNZ   @RF01268                                            1268 05230000
         TM    AMDRRDS(AMDSBPTR),B'00000010'                       1268 05231000
         BNO   @RF01268                                            1268 05232000
@RT01268 DS    0H                                                  1269 05233000
*                    DO;                                   /*@Y30SSFR*/ 05234000
*                    DEFSTID = INCOMPAR;                   /*@Y30SSFR*/ 05235000
         MVI   DEFSTID,X'11'                                       1270 05236000
*                    DARGSMOD = IMPMSG;                    /*@Y30SSFR*/ 05237000
         L     @01,DDSTRU                                          1271 05238000
         MVC   DARGSMOD(3,@01),@CC01000                            1271 05239000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 05240000
         LA    @15,12                                              1272 05241000
         L     @14,@SA00004                                        1272 05242000
         LM    @00,@12,@SA00004+8                                  1272 05243000
         BR    @14                                                 1272 05244000
*                    END;                                  /*@Y30SSFR*/ 05245000
*                END;                                      /*@Y30SSFR*/ 05246000
*          ELSE                                            /*@Y30SSFR*/ 05247000
*                                                                  1275 05248000
*DUP:        DO;                                           /*@Y30SSFR*/ 05249000
*                                                                  1275 05250000
         B     @RC01250                                            1275 05251000
@RF01250 DS    0H                                                  1275 05252000
DUP      DS    0H                                                  1276 05253000
*            /********************************************************/ 05254000
*            /*                                              @Y30SSFR*/ 05255000
*            /*  THE TEMPORARY EXPORT FLAG WAS ON- SET UP TO DELETE  */ 05256000
*            /*  THE EXISTANT CLUSTER ENTRY, AND THEN REDEFINE IT    */ 05257000
*            /*  USING THE CATALOG INFORMATION SUPPLIED THRO IMPORT  */ 05258000
*            /*                                              @Y30SSFR*/ 05259000
*            /********************************************************/ 05260000
*                                                                  1276 05261000
*            CTGPLPTR = PTRCPL;                            /*@Y30SSFR*/ 05262000
         L     @15,PTRCPL                                          1276 05263000
         ST    @15,CTGPLPTR                                        1276 05264000
*            CTGFVPTR = CTGFVT;                            /*@Y30SSFR*/ 05265000
*                                                                  1277 05266000
         L     @15,CTGFVT(,@15)                                    1277 05267000
         ST    @15,CTGFVPTR                                        1277 05268000
*            /********************************************************/ 05269000
*            /*                                              @Y30SSFR*/ 05270000
*            /*  CONSTRUCT THE CPL TO BE EMPLOYED FOR THE    @Y30SSFR*/ 05271000
*            /*  CATALOG MANAGEMENT DELETE FUNCTION.         @Y30SSFR*/ 05272000
*            /*  IF THE CONSTRUCTION OF THE CPL FAILS, RETURN TO THE */ 05273000
*            /*  CALLING PROCESSOR INDICATING FAILURE        @Y30SSFR*/ 05274000
*            /*                                              @Y30SSFR*/ 05275000
*            /********************************************************/ 05276000
*                                                                  1278 05277000
*            CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);    1278 05278000
*                                                                  1278 05279000
         LA    @14,@CC00807                                        1278 05280000
         ST    @14,@AL00001                                        1278 05281000
         LA    @14,DCPLPTR                                         1278 05282000
         ST    @14,@AL00001+4                                      1278 05283000
         LA    @15,CTGFVENT(,@15)                                  1278 05284000
         ST    @15,@AL00001+8                                      1278 05285000
         LA    @15,NULLPARM                                        1278 05286000
         ST    @15,@AL00001+12                                     1278 05287000
         LA    @15,CPSWD                                           1278 05288000
         ST    @15,@AL00001+16                                     1278 05289000
         LA    @01,@AL00001                                        1278 05290000
         BAL   @14,CPLPROC                                         1278 05291000
*            RESPECIFY RTNREG RSTD;                                1279 05292000
*            TESTRC = RTNREG;                                      1280 05293000
         LR    TESTRC,RTNREG                                       1280 05294000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 05295000
*            IF TESTRC ^= 0                                        1282 05296000
*              THEN                                                1282 05297000
         LTR   TESTRC,TESTRC                                       1282 05298000
         BZ    @RF01282                                            1282 05299000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 05300000
*                                                                  1283 05301000
         LA    @15,12                                              1283 05302000
         L     @14,@SA00004                                        1283 05303000
         LM    @00,@12,@SA00004+8                                  1283 05304000
         BR    @14                                                 1283 05305000
*            /********************************************************/ 05306000
*            /*                                              @Y30SSFR*/ 05307000
*            /*      CALL DELTPROC TO DELETE THE CLUSTER.    @Y30SSFR*/ 05308000
*            /*      IF THE DELETE FAILS, RETURN TO THE      @Y30SSFR*/ 05309000
*            /*    CALLING PROCESSOR.                        @Y30SSFR*/ 05310000
*            /*                                              @Y30SSFR*/ 05311000
*            /********************************************************/ 05312000
*                                                                  1284 05313000
*            CALL DELTPROC(DCPLPTR);                       /*@Y30SSFR*/ 05314000
@RF01282 LA    @15,DCPLPTR                                         1284 05315000
         ST    @15,@AL00001                                        1284 05316000
         LA    @01,@AL00001                                        1284 05317000
         BAL   @14,DELTPROC                                        1284 05318000
*            RESPECIFY RTNREG RSTD;                                1285 05319000
*            TESTRC = RTNREG;                                      1286 05320000
         LR    TESTRC,RTNREG                                       1286 05321000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 05322000
*            IF TESTRC ^= 0                                        1288 05323000
*              THEN                                                1288 05324000
         LTR   TESTRC,TESTRC                                       1288 05325000
         BZ    @RF01288                                            1288 05326000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 05327000
*                                                                  1289 05328000
         LA    @15,12                                              1289 05329000
         L     @14,@SA00004                                        1289 05330000
         LM    @00,@12,@SA00004+8                                  1289 05331000
         BR    @14                                                 1289 05332000
*            END DUP;                                      /*@Y30SSFR*/ 05333000
*                                                                  1290 05334000
@RF01288 DS    0H                                                  1291 05335000
*        /************************************************************/ 05336000
*        /*                                                  @Y30SSFR*/ 05337000
*        /*  RESET THE VALUE OF DEFSTID TO NORMSTAT TO       @Y30SSFR*/ 05338000
*        /*  INDICATE THAT ERROR FOUND IN THE FIRST DEFINE   @Y30SSFR*/ 05339000
*        /*  HAS BEEN RESOLVED.                              @Y30SSFR*/ 05340000
*        /*                                                  @Y30SSFR*/ 05341000
*        /************************************************************/ 05342000
*                                                                  1291 05343000
*        DEFSTID = NORMSTAT;                               /*@Y30SSFR*/ 05344000
*                                                                  1291 05345000
@RC01250 MVI   DEFSTID,X'00'                                       1291 05346000
*        /************************************************************/ 05347000
*        /*                                                  @Y30SSFR*/ 05348000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESS    @Y30SSFR*/ 05349000
*        /*  INDICATED.                                      @Y30SSFR*/ 05350000
*        /*                                                  @Y30SSFR*/ 05351000
*        /************************************************************/ 05352000
*                                                                  1292 05353000
*        RETURN CODE(0);                                   /*@Y30SSFR*/ 05354000
*                                                                  1292 05355000
         SLR   @15,@15                                             1292 05356000
         L     @14,@SA00004                                        1292 05357000
         LM    @00,@12,@SA00004+8                                  1292 05358000
         BR    @14                                                 1292 05359000
*END DUPNPROC;                                             /*@Y30SSFR*/ 05360000
*        /************************************************************/ 05361000
*        /*                                                          */ 05362000
*        /*  PROCEDURE NAME - CPLPROC                                */ 05363000
*        /*                                                          */ 05364000
*        /*  FUNCTION - CONSTRUCT A CATALOG PARAMETER LIST (CPL)     */ 05365000
*        /*  WHICH IS THE PRIMARY CONTROL BLOCK FOR ORGANIZING A     */ 05366000
*        /*  REQUEST FOR CATALOG MANAGEMENT SERVICES         @Y30SSFR*/ 05367000
*        /*  THE CPL CONSTRUCTED IN THIS PROCEDURE WILL BE USED FOR  */ 05368000
*        /*  A CATALOG DEFINE, ALTER, DELETE OR LOCATE OPERATION.    */ 05369000
*        /*                                                          */ 05370000
*        /*  INPUT -                                                 */ 05371000
*        /*    CTYPE - TYPE INDICATOR (DELETE,ALTER,LOCATE,DEFINE    */ 05372000
*        /*    CPTRCPL - RETURN CELL FOR CPL CONSTRUCTED             */ 05373000
*        /*    CNAME - NAME OF CLUSTER FOR DELETE OR LOCATE          */ 05374000
*        /*    CINUM - CONTROL INTERVAL NUMBER FOR LOCATE OF         */ 05375000
*        /*            CLUSTER COMPONENT                             */ 05376000
*        /*    CPSWD - OBJECT PASSWORD OR ZERO                       */ 05377000
*        /*                                                          */ 05378000
*        /*  OUTPUT - AN INITIALIZED CPL                             */ 05379000
*        /*                                                          */ 05380000
*        /************************************************************/ 05381000
*                                                                  1294 05382000
*CPLPROC: PROCEDURE(CTYPE,             /*TYPE OF CPL TO BE BUILT     */ 05383000
*                   CPTRCPL,           /*RETURN CELL FOR CPL POINTER */ 05384000
*                   CNAME,             /*ADDRESS OF ENTRYNAME OR 0   */ 05385000
*                   CINUM,             /*CONTROL INTERVAL NUMBER OR 0*/ 05386000
*                   CCPSWD);           /*ADDRESS OF 8-BYTE PASSWORD  */ 05387000
*                                                                  1294 05388000
CPLPROC  STM   @14,@12,@SA00005                                    1294 05389000
         MVC   @PC00005(20),0(@01)                                 1294 05390000
*        /************************************************************/ 05391000
*        /*                                                          */ 05392000
*        /*  ARGUMENTS OF INVOCATION                                 */ 05393000
*        /*                                                          */ 05394000
*        /************************************************************/ 05395000
*                                                                  1295 05396000
*        DCL                                                       1295 05397000
*          CTYPE    CHAR(1),                                       1295 05398000
*          CPTRCPL  PTR(31),                                       1295 05399000
*          CNAME    PTR(31),                                       1295 05400000
*          CINUM    CHAR(3),                                       1295 05401000
*          CCPSWD    PTR(31);                                      1295 05402000
*                                                                  1295 05403000
*        /************************************************************/ 05404000
*        /*                                                          */ 05405000
*        /* LOCAL DECLARATIONS                                       */ 05406000
*        /*                                                          */ 05407000
*        /************************************************************/ 05408000
*                                                                  1296 05409000
*        DCL LENWKA FIXED(15) CONSTANT(24);                        1296 05410000
*                                      /*LENGTH WORK AREA NEEDED FOR */ 05411000
*                                      /*ALTER, LOCATE, DEFINE       */ 05412000
*        DCL 1 DELTWKA BDY(WORD),                          /*@Y30SSFR*/ 05413000
*          2 *     FIXED(15),                              /*@Y30SSFR*/ 05414000
*          2 *     FIXED(15),                              /*@Y30SSFR*/ 05415000
*          2 *(12) CHAR(45);                               /*@Y30SSFR*/ 05416000
*                                      /*WORK AREA FOR DELETE        */ 05417000
*                                                                  1298 05418000
*        DCL CPLPROCI FIXED(31);       /*INDEX USED TO CLEAR @Y30SSFR*/ 05419000
*                                      /*CATALOG WORK AREA   @Y30SSFR*/ 05420000
*                                                                  1299 05421000
*        /************************************************************/ 05422000
*        /*                                                          */ 05423000
*        /*  GET CORE FOR CATALOG PARAMETER LIST(CPL)                */ 05424000
*        /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO THE     */ 05425000
*        /*  CALLING PROCEDURE                                       */ 05426000
*        /*                                                          */ 05427000
*        /************************************************************/ 05428000
*                                                                  1299 05429000
*        CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGPL)+16+LENWKA),CPTRCPL,GPID,S 05430000
*TZERO);                                                           1299 05431000
*                                                                  1299 05432000
         L     @03,@PC00001                                        1299 05433000
         ST    @03,@AL00001                                        1299 05434000
         LA    @15,68                                              1299 05435000
         ST    @15,@AFTEMPS+12                                     1299 05436000
         LA    @15,@AFTEMPS+12                                     1299 05437000
         ST    @15,@AL00001+4                                      1299 05438000
         L     @15,@PC00005+4                                      1299 05439000
         ST    @15,@AL00001+8                                      1299 05440000
         LA    @15,GPID                                            1299 05441000
         ST    @15,@AL00001+12                                     1299 05442000
         LA    @15,SETZERO                                         1299 05443000
         ST    @15,@AL00001+16                                     1299 05444000
         MVI   @AL00001+16,X'80'                                   1299 05445000
         L     @15,GDTGPL(,@03)                                    1299 05446000
         LA    @01,@AL00001                                        1299 05447000
         BALR  @14,@15                                             1299 05448000
*        RESPECIFY RTNREG RSTD;                                    1300 05449000
*        TESTRC = RTNREG;                                          1301 05450000
         LR    TESTRC,RTNREG                                       1301 05451000
*        RESPECIFY RTNREG UNRSTD;                                  1302 05452000
*        IF TESTRC ^= 0                                            1303 05453000
*          THEN                                                    1303 05454000
         LTR   TESTRC,TESTRC                                       1303 05455000
         BZ    @RF01303                                            1303 05456000
*            DO;                                                   1304 05457000
*            DARGSMOD = UNIVMSG;                                   1305 05458000
         L     @01,DDSTRU                                          1305 05459000
         MVC   DARGSMOD(3,@01),@CC01023                            1305 05460000
*            DEFSTID = NOSTORAG;                                   1306 05461000
         MVI   DEFSTID,X'04'                                       1306 05462000
*            RETURN CODE(LASTCC12);                                1307 05463000
         LA    @15,12                                              1307 05464000
         L     @14,@SA00005                                        1307 05465000
         LM    @00,@12,@SA00005+8                                  1307 05466000
         BR    @14                                                 1307 05467000
*            END;                                                  1308 05468000
*                                                                  1308 05469000
*        /************************************************************/ 05470000
*        /*                                                          */ 05471000
*        /*  INITIALIZE CPL WITH INFORMATION COMMON TO ALL 4 CATALOG */ 05472000
*        /*  MANAGEMENT FUNCTIONS                                    */ 05473000
*        /*                                                          */ 05474000
*        /************************************************************/ 05475000
*                                                                  1309 05476000
*        CTGPLPTR = CPTRCPL;           /*SET CPL BASE POINTER        */ 05477000
@RF01303 L     @15,@PC00005+4                                      1309 05478000
         L     @15,CPTRCPL(,@15)                                   1309 05479000
         ST    @15,CTGPLPTR                                        1309 05480000
*        CTGWKA = CTGPLPTR + (LENGTH(CTGPL)+16);                   1310 05481000
         LA    @14,44                                              1310 05482000
         ALR   @14,@15                                             1310 05483000
         ST    @14,CTGWKA(,@15)                                    1310 05484000
*                                      /*SET WORK AREA ADDRESS       */ 05485000
*        AREALN = LENWKA;              /*SET WORK AREA LENGTH        */ 05486000
         MVC   AREALN(2,@14),@CH00312                              1311 05487000
*        CTGAM0 = ON;                  /*VSAM REQUEST                */ 05488000
         OI    CTGAM0(@15),B'00000001'                             1312 05489000
*        IF CTYPE ^= 'L'                                           1313 05490000
*          THEN                                                    1313 05491000
         L     @14,@PC00005                                        1313 05492000
         CLI   CTYPE(@14),C'L'                                     1313 05493000
         BE    @RF01313                                            1313 05494000
*            CTGFUNC = CTGCMS;         /*CMS FUNCTION                */ 05495000
         NI    CTGFUNC(@15),B'10011111'                            1314 05496000
         OI    CTGFUNC(@15),B'10000000'                            1314 05497000
*        IF PTRCTACB ^= NULLPTR                                    1315 05498000
*          THEN                                                    1315 05499000
@RF01313 L     @15,PTRCTACB                                        1315 05500000
         LTR   @15,@15                                             1315 05501000
         BZ    @RF01315                                            1315 05502000
*            CTGCAT = ADDR(PTRCTACB);  /*SET CATALOG ACB ADDR        */ 05503000
         LA    @15,PTRCTACB                                        1316 05504000
         L     @14,CTGPLPTR                                        1316 05505000
         ST    @15,CTGCAT(,@14)                                    1316 05506000
*          ELSE                                                    1317 05507000
*            CTGCNAME = ON;            /*NO CATALOG ACB PASSED       */ 05508000
*                                                                  1317 05509000
         B     @RC01315                                            1317 05510000
@RF01315 L     @01,CTGPLPTR                                        1317 05511000
         OI    CTGCNAME(@01),B'00000010'                           1317 05512000
*        /************************************************************/ 05513000
*        /*                                                          */ 05514000
*        /*  IF THE CATALOG PASSWORD IS SPECIFIED IN THE AMS COMMAND,*/ 05515000
*        /*  PASS IT TO CATALOG MANAGEMENT.  OTHERWISE SEE IF AN     */ 05516000
*        /*  OBJECT PASSWORD HAS BEEN SUPPLIED BY THE CALLER OF THE  */ 05517000
*        /*  PROCEDURE                                               */ 05518000
*        /*                                                          */ 05519000
*        /************************************************************/ 05520000
*                                                                  1318 05521000
*        IF ADDR(CAT) ^= NULLPTR & CATPLN > 0                      1318 05522000
*          THEN                                                    1318 05523000
@RC01315 L     @15,@PC00001+4                                      1318 05524000
         L     @15,FDTPTR+128(,@15)                                1318 05525000
         LTR   @15,@15                                             1318 05526000
         BZ    @RF01318                                            1318 05527000
         CLI   CATPLN(@15),0                                       1318 05528000
         BNH   @RF01318                                            1318 05529000
*            CTGPSWD = ADDR(CATPAS);                               1319 05530000
         LA    @15,CATPAS(,@15)                                    1319 05531000
         L     @14,CTGPLPTR                                        1319 05532000
         ST    @15,CTGPSWD(,@14)                                   1319 05533000
*          ELSE                                                    1320 05534000
*            IF CPSWD ^= NULLPTR                                   1320 05535000
*              THEN                                                1320 05536000
         B     @RC01318                                            1320 05537000
@RF01318 L     @15,CPSWD                                           1320 05538000
         LTR   @15,@15                                             1320 05539000
         BZ    @RF01320                                            1320 05540000
*                CTGPSWD = CPSWD;                                  1321 05541000
*                                                                  1321 05542000
         L     @14,CTGPLPTR                                        1321 05543000
         ST    @15,CTGPSWD(,@14)                                   1321 05544000
*        /************************************************************/ 05545000
*        /*                                                          */ 05546000
*        /*  SET THE APPROPRIATE FLAGS FOR EACH PARTICULAR FUNCTION  */ 05547000
*        /*                                                          */ 05548000
*        /************************************************************/ 05549000
*                                                                  1322 05550000
*        /************************************************************/ 05551000
*        /*                                                          */ 05552000
*        /*  CATALOG DEFINE FUNCTION                                 */ 05553000
*        /*                                                          */ 05554000
*        /************************************************************/ 05555000
*                                                                  1322 05556000
*        IF CTYPE = 'F'                                            1322 05557000
*          THEN                                                    1322 05558000
@RF01320 DS    0H                                                  1322 05559000
@RC01318 L     @15,@PC00005                                        1322 05560000
         CLI   CTYPE(@15),C'F'                                     1322 05561000
         BNE   @RF01322                                            1322 05562000
*            DO;                                                   1323 05563000
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */ 05564000
         L     @15,CTGPLPTR                                        1324 05565000
         OI    CTGNAME(@15),B'00000100'                            1324 05566000
*            CTGOPTNS = CTGDEFIN;      /*DEFINE FUNCTION             */ 05567000
         NI    CTGOPTNS(@15),B'00001111'                           1325 05568000
         OI    CTGOPTNS(@15),B'00001000'                           1325 05569000
*            /* IF SAVRAC DONT RACF-DEFINE PROFILES          @Z40RSSA*/ 05570000
*            IF ADDR(SRAC) ^= 0 THEN                       /*@Z40RSSA*/ 05571000
         L     @14,@PC00001+4                                      1326 05572000
         L     @14,FDTPTR+136(,@14)                                1326 05573000
         LTR   @14,@14                                             1326 05574000
         BZ    @RF01326                                            1326 05575000
*              CTGNPROF = ON;                              /*@Z40RSSA*/ 05576000
         OI    CTGNPROF(@15),B'00100000'                           1327 05577000
*            END;                                                  1328 05578000
*                                                                  1328 05579000
@RF01326 DS    0H                                                  1329 05580000
*        /************************************************************/ 05581000
*        /*                                                          */ 05582000
*        /*  CATALOG LOCATE FUNCTION                                 */ 05583000
*        /*                                                          */ 05584000
*        /************************************************************/ 05585000
*                                                                  1329 05586000
*        IF CTYPE = 'L'                                            1329 05587000
*          THEN                                                    1329 05588000
@RF01322 L     @15,@PC00005                                        1329 05589000
         CLI   CTYPE(@15),C'L'                                     1329 05590000
         BNE   @RF01329                                            1329 05591000
*            CTGFUNC = CTGLOC;         /*CATALOG LOCATE FUNCTION     */ 05592000
*                                                                  1330 05593000
         L     @01,CTGPLPTR                                        1330 05594000
         NI    CTGFUNC(@01),B'00111111'                            1330 05595000
         OI    CTGFUNC(@01),B'00100000'                            1330 05596000
*        /************************************************************/ 05597000
*        /*                                                          */ 05598000
*        /*  CATALOG ALTER  FUNCTION                                 */ 05599000
*        /*                                                          */ 05600000
*        /************************************************************/ 05601000
*                                                                  1331 05602000
*        IF CTYPE = 'A'                                            1331 05603000
*          THEN                                                    1331 05604000
@RF01329 L     @15,@PC00005                                        1331 05605000
         CLI   CTYPE(@15),C'A'                                     1331 05606000
         BNE   @RF01331                                            1331 05607000
*            DO;                                                   1332 05608000
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */ 05609000
         L     @15,CTGPLPTR                                        1333 05610000
         OI    CTGNAME(@15),B'00000100'                            1333 05611000
*            CTGOPTNS = CTGALTER;      /*ALTER FUNCTION              */ 05612000
         NI    CTGOPTNS(@15),B'00010111'                           1334 05613000
         OI    CTGOPTNS(@15),B'00010000'                           1334 05614000
*            CTGNUM = ON;              /*SEARCH ONE CATALOG          */ 05615000
         OI    CTGNUM(@15),B'00000010'                             1335 05616000
*            END;                                                  1336 05617000
*                                                                  1336 05618000
*        /************************************************************/ 05619000
*        /*                                                          */ 05620000
*        /*  CATALOG DELETE FUNCTION                                 */ 05621000
*        /*                                                          */ 05622000
*        /************************************************************/ 05623000
*                                                                  1337 05624000
*        IF CTYPE = 'D'                                            1337 05625000
*          THEN                                                    1337 05626000
@RF01331 L     @15,@PC00005                                        1337 05627000
         CLI   CTYPE(@15),C'D'                                     1337 05628000
         BNE   @RF01337                                            1337 05629000
*            DO;                                                   1338 05630000
*            /* IF SAVRAC DONT RACF-DELETE PROFILES          @Z40RSSA*/ 05631000
*            IF ADDR(SRAC) ^= 0 THEN                       /*@Z40RSSA*/ 05632000
         L     @15,@PC00001+4                                      1339 05633000
         L     @15,FDTPTR+136(,@15)                                1339 05634000
         LTR   @15,@15                                             1339 05635000
         BZ    @RF01339                                            1339 05636000
*              CTGNPROF = ON;                              /*@Z40RSSA*/ 05637000
         L     @01,CTGPLPTR                                        1340 05638000
         OI    CTGNPROF(@01),B'00100000'                           1340 05639000
*            CTGOPTNS = CTGDELET;      /*DELETE FUNCTION             */ 05640000
@RF01339 L     @15,CTGPLPTR                                        1341 05641000
         NI    CTGOPTNS(@15),B'00011111'                           1341 05642000
         OI    CTGOPTNS(@15),B'00011000'                           1341 05643000
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */ 05644000
         OI    CTGNAME(@15),B'00000100'                            1342 05645000
*            CTGTYPE = FVTPTR(1) -> CTGFVTYP;              /*@Y30SSFR*/ 05646000
         L     @14,FVTPTR                                          1343 05647000
         MVC   CTGTYPE(1,@15),CTGFVTYP(@14)                        1343 05648000
*                                      /*TYPE = CLUSTER OR   @Y30SSFR*/ 05649000
*                                      /*TYPE = AIX          @Y30SSFR*/ 05650000
*            IF ADDR(OUTDD) ^= NULLPTR                             1344 05651000
*              THEN                                                1344 05652000
         L     @14,@PC00001+4                                      1344 05653000
         L     @14,FDTPTR+4(,@14)                                  1344 05654000
         LTR   @14,@14                                             1344 05655000
         BZ    @RF01344                                            1344 05656000
*                CTGDDNM = ADDR(OUTDDVAL); /*DDNAME POINTER  @YL026UA*/ 05657000
         LA    @14,OUTDDVAL(,@14)                                  1345 05658000
         ST    @14,CTGDDNM(,@15)                                   1345 05659000
*            CTGWKA = ADDR(DELTWKA);   /*SET WORK AREA ADDRESS       */ 05660000
@RF01344 LA    @15,DELTWKA                                         1346 05661000
         L     @14,CTGPLPTR                                        1346 05662000
         ST    @15,CTGWKA(,@14)                                    1346 05663000
*            AREALN = LENGTH(DELTWKA); /*WORK AREA LENGTH            */ 05664000
         MVC   AREALN(2,@15),@CH01662                              1347 05665000
*            RETURNLN = 0;             /*RETURN LENGTH FROM  @Y30SSFR*/ 05666000
         SLR   @14,@14                                             1348 05667000
         STH   @14,RETURNLN(,@15)                                  1348 05668000
*                                      /*CATALOG MANAGEMENT  @Y30SSFR*/ 05669000
*                                                                  1349 05670000
*            /********************************************************/ 05671000
*            /*                                              @Y30SSFR*/ 05672000
*            /*  CLEAR THE REST OF THE WORK AREA FOR VSAM    @Y30SSFR*/ 05673000
*            /*  CATALOG MANAGEMENT DELETE                   @Y30SSFR*/ 05674000
*            /*                                              @Y30SSFR*/ 05675000
*            /********************************************************/ 05676000
*                                                                  1349 05677000
*            DO CPLPROCI = 1 TO 12;                        /*@Y30SSFR*/ 05678000
         LA    CPLPROCI,1                                          1349 05679000
@DL01349 DS    0H                                                  1350 05680000
*              ENTITEM(CPLPROCI) = ''B;                    /*@Y30SSFR*/ 05681000
         LR    @03,CPLPROCI                                        1350 05682000
         MH    @03,@CH01384                                        1350 05683000
         L     @01,CTGPLPTR                                        1350 05684000
         L     @01,CTGWKA(,@01)                                    1350 05685000
         ALR   @01,@03                                             1350 05686000
         AL    @01,@CF01706                                        1350 05687000
         XC    ENTITEM-4(45,@01),ENTITEM-4(@01)                    1350 05688000
*            END;                                          /*@Y30SSFR*/ 05689000
*                                                                  1351 05690000
         AL    CPLPROCI,@CF00221                                   1351 05691000
         C     CPLPROCI,@CF00035                                   1351 05692000
         BNH   @DL01349                                            1351 05693000
*              /******************************************************/ 05694000
*              /*                                                    */ 05695000
*              /*  IF IT IS A TEMPORARY EXPORT ONLY          @Y30SSFR*/ 05696000
*              /*  CHECK FOR NOERASE ERASE PURGE                     */ 05697000
*              /*  IF ERASE IS SPECIFIED THEN THE ERASE OVERRIDE     */ 05698000
*              /*  AND THE ERASE BITS ARE TURNED ON.                 */ 05699000
*              /*  IF  NOERASE IS SPECIFIED THEN THE ERASE OVERRIDE  */ 05700000
*              /*  BIT IS ON AND THE ERASE BIT IS TURNED OFF.        */ 05701000
*              /*  IF NOTHING IS SPECIFIED THEN BOTH ERASE OVERRIDE  */ 05702000
*              /*  AND ERASE BITS ARE TURNED OFF.                    */ 05703000
*              /*  IF PRG IS SPECIFIED THEN THE PRG BIT IS TURNED ON.*/ 05704000
*              /*                                                    */ 05705000
*              /******************************************************/ 05706000
*                                                                  1352 05707000
*                   IF  ADDR(ERAS)  ^= 0                           1352 05708000
*                     THEN DO;                                     1352 05709000
         L     @15,@PC00001+4                                      1352 05710000
         L     @15,FDTPTR+72(,@15)                                 1352 05711000
         LTR   @15,@15                                             1352 05712000
         BZ    @RF01352                                            1352 05713000
*                           CTGERASE='1'B;                         1354 05714000
*                           CTGOVRID='1'B;                         1355 05715000
         L     @01,CTGPLPTR                                        1355 05716000
         OI    CTGERASE(@01),B'01000100'                           1355 05717000
*                           END;                                   1356 05718000
*                   IF ADDR(NERAS)  ^=0                            1357 05719000
*                     THEN DO;                                     1357 05720000
@RF01352 L     @15,@PC00001+4                                      1357 05721000
         L     @15,FDTPTR+76(,@15)                                 1357 05722000
         LTR   @15,@15                                             1357 05723000
         BZ    @RF01357                                            1357 05724000
*                           CTGERASE='0'B;                         1359 05725000
*                           CTGOVRID='1'B;                         1360 05726000
         L     @01,CTGPLPTR                                        1360 05727000
         OI    CTGOVRID(@01),B'00000100'                           1360 05728000
         NI    CTGERASE(@01),B'10111111'                           1360 05729000
*                           END;                                   1361 05730000
*                   IF ADDR (PRG)  ^=0                             1362 05731000
*                     THEN CTGPURG='1'B;                           1362 05732000
*                                                                  1362 05733000
@RF01357 L     @15,@PC00001+4                                      1362 05734000
         L     @15,FDTPTR+64(,@15)                                 1362 05735000
         LTR   @15,@15                                             1362 05736000
         BZ    @RF01362                                            1362 05737000
         L     @01,CTGPLPTR                                        1363 05738000
         OI    CTGPURG(@01),B'00100000'                            1363 05739000
*             END;                                                 1364 05740000
*                                                                  1364 05741000
@RF01362 DS    0H                                                  1365 05742000
*        /************************************************************/ 05743000
*        /*                                                          */ 05744000
*        /*  FOR DELETE OR LOCATE, SUPPLY ENTRYNAME                  */ 05745000
*        /*                                                          */ 05746000
*        /************************************************************/ 05747000
*                                                                  1365 05748000
*        IF CTYPE = 'L' | CTYPE ='D'                               1365 05749000
*          THEN                                                    1365 05750000
@RF01337 L     @15,@PC00005                                        1365 05751000
         CLI   CTYPE(@15),C'L'                                     1365 05752000
         BE    @RT01365                                            1365 05753000
         CLI   CTYPE(@15),C'D'                                     1365 05754000
         BNE   @RF01365                                            1365 05755000
@RT01365 DS    0H                                                  1366 05756000
*            DO;                                                   1366 05757000
*            IF CNAME ^= NULLPTR                                   1367 05758000
*              THEN                                                1367 05759000
         L     @15,@PC00005+8                                      1367 05760000
         L     @15,CNAME(,@15)                                     1367 05761000
         LTR   @15,@15                                             1367 05762000
         BZ    @RF01367                                            1367 05763000
*                DO;                                               1368 05764000
*                CTGENT = CNAME;       /*SET POINTER TO ENTRY NAME   */ 05765000
         L     @14,CTGPLPTR                                        1369 05766000
         ST    @15,CTGENT(,@14)                                    1369 05767000
*                CTGNAME = ON;         /*ENTRY NAME SUPPLIED         */ 05768000
         OI    CTGNAME(@14),B'00000100'                            1370 05769000
*                END;                                              1371 05770000
*              ELSE                                                1372 05771000
*                CTGENT = ADDR(CINUM); /*SET CONTROL INTERVAL NUMBER */ 05772000
         B     @RC01367                                            1372 05773000
@RF01367 L     @15,@PC00005+12                                     1372 05774000
         L     @14,CTGPLPTR                                        1372 05775000
         ST    @15,CTGENT(,@14)                                    1372 05776000
*            END;                                                  1373 05777000
*                                                                  1373 05778000
@RC01367 DS    0H                                                  1374 05779000
*        /************************************************************/ 05780000
*        /*                                                          */ 05781000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 05782000
*        /*                                                          */ 05783000
*        /************************************************************/ 05784000
*                                                                  1374 05785000
*        RETURN CODE(0);                                           1374 05786000
@RF01365 SLR   @15,@15                                             1374 05787000
         L     @14,@SA00005                                        1374 05788000
         LM    @00,@12,@SA00005+8                                  1374 05789000
         BR    @14                                                 1374 05790000
*END CPLPROC;                                                      1375 05791000
*        /************************************************************/ 05792000
*        /*                                                          */ 05793000
*        /*  PROCEDURE NAME - IUNIQPRC                               */ 05794000
*        /*                                                          */ 05795000
*        /*  FUNCTION - CHECK THE DSATTR FIELDS TO SEE IF THE DATA   */ 05796000
*        /*  SET BEING DEFINED IS A UNIQUE DATA SET.  IF SO, A NULL  */ 05797000
*        /*  SPACE(VOLUME) FVT MUST BE SUPPLIED FOR CATALOG DEFINE   */ 05798000
*        /*                                                          */ 05799000
*        /*  INPUT - NONE                                            */ 05800000
*        /*                                                          */ 05801000
*        /*  OUTPUT - FOR A UNIQUE DATA SET, A NULL VOLUME FVT WILL  */ 05802000
*        /*  HAVE BEEN CONSTRUCTED AND A POINTER TO IT PLACED IN THE */ 05803000
*        /*  CLUSTER FVT                                             */ 05804000
*        /*  UNIQD AND UNIQI ARE SET TO INDICATE THAT THE    @VS06407*/ 05805000
*        /*  DATA AND OR INDEX COMPONENTS ARE UNIQUE. THIS   @VS06407*/ 05806000
*        /*  SETTING IS CHECKED IN CLUSPROC(VOLSMIGR) TO SEE @VS06407*/ 05807000
*        /*  IF DYNAMIC ALLOCATION OF VOLUMES IS REQUIRED    @Y30SSFR*/ 05808000
*        /*                                                          */ 05809000
*        /************************************************************/ 05810000
*                                                                  1376 05811000
*                                                                  1376 05812000
*IUNIQPRC: PROCEDURE;                                              1376 05813000
*                                                                  1376 05814000
IUNIQPRC STM   @14,@12,12(@13)                                     1376 05815000
*        /************************************************************/ 05816000
*        /*                                                          */ 05817000
*        /*  GET THE DATA FVT AND CHECK THE DSATTR FIELD FOR UNIQUE  */ 05818000
*        /*                                                          */ 05819000
*        /************************************************************/ 05820000
*                                                                  1377 05821000
*        CTGPLPTR = PTRCPL;                                        1377 05822000
         L     @15,PTRCPL                                          1377 05823000
         ST    @15,CTGPLPTR                                        1377 05824000
*        CTGFVPTR = CTGFVT;            /*FVT BASE- CLUSTER           */ 05825000
         L     @15,CTGFVT(,@15)                                    1378 05826000
         ST    @15,CTGFVPTR                                        1378 05827000
*        CTGFVPTR = CTGFVDCH;          /*FVT BASE - DATA COMPONENT   */ 05828000
         L     @15,CTGFVDCH(,@15)                                  1379 05829000
         ST    @15,CTGFVPTR                                        1379 05830000
*        IF CTGFVATR ^= NULLPTR                                    1380 05831000
*          THEN                                                    1380 05832000
         L     @15,CTGFVATR(,@15)                                  1380 05833000
         LTR   @15,@15                                             1380 05834000
         BZ    @RF01380                                            1380 05835000
*            DO;                                                   1381 05836000
*            CTGFLPTR = CTGFVATR;      /*SET FPL BASE TO DSATTR FPL  */ 05837000
         LR    CTGFLPTR,@15                                        1382 05838000
*            IF FDSUNIQ = ON                                       1383 05839000
*              THEN                                                1383 05840000
         L     @05,CTGFLPT(,CTGFLPTR)                              1383 05841000
         TM    FDSUNIQ(@05),B'01000000'                            1383 05842000
         BNO   @RF01383                                            1383 05843000
*                DO;                                       /*@VS06407*/ 05844000
*                UNIQD = ON;           /* INDICATE UNIQUE    @VS06407*/ 05845000
         OI    UNIQD,B'10000000'                                   1385 05846000
*                IMPUNIQ = ON;         /*SET IMPORT UNIQUE FLAG      */ 05847000
         OI    IMPUNIQ,B'10000000'                                 1386 05848000
*                END;                                      /*@VS06407*/ 05849000
*            END;                                                  1388 05850000
*                                                                  1388 05851000
@RF01383 DS    0H                                                  1389 05852000
*        /************************************************************/ 05853000
*        /*                                                          */ 05854000
*        /*  IF AN INDEX FVT IS EXISTANT, CHECK IT ITS DSATTR FIELD  */ 05855000
*        /*                                                          */ 05856000
*        /************************************************************/ 05857000
*                                                                  1389 05858000
*        CTGFVPTR = CTGFVT;            /*SET FVT BASE- CLUSTER FVT   */ 05859000
@RF01380 L     @01,CTGPLPTR                                        1389 05860000
         L     @15,CTGFVT(,@01)                                    1389 05861000
         ST    @15,CTGFVPTR                                        1389 05862000
*        IF CTGFVICH ^= NULLPTR                                    1390 05863000
*          THEN                                                    1390 05864000
         SLR   @14,@14                                             1390 05865000
         L     @15,CTGFVICH(,@15)                                  1390 05866000
         CR    @15,@14                                             1390 05867000
         BE    @RF01390                                            1390 05868000
*            DO;                                                   1391 05869000
*            CTGFVPTR = CTGFVICH;      /*SET FVT BASE- INDEX FVT     */ 05870000
         ST    @15,CTGFVPTR                                        1392 05871000
*            IF CTGFVATR ^= NULLPTR                                1393 05872000
*              THEN                                                1393 05873000
         L     @15,CTGFVATR(,@15)                                  1393 05874000
         CR    @15,@14                                             1393 05875000
         BE    @RF01393                                            1393 05876000
*                DO;                                               1394 05877000
*                CTGFLPTR = CTGFVATR;  /*SET FPL BASE- DSATTR FPL    */ 05878000
         LR    CTGFLPTR,@15                                        1395 05879000
*                IF FDSUNIQ = ON                                   1396 05880000
*                  THEN                                            1396 05881000
         L     @05,CTGFLPT(,CTGFLPTR)                              1396 05882000
         TM    FDSUNIQ(@05),B'01000000'                            1396 05883000
         BNO   @RF01396                                            1396 05884000
*                    DO;                                   /*@VS06407*/ 05885000
*                    UNIQI = ON;       /* INDICATE UNIQUE    @VS06407*/ 05886000
         OI    UNIQI,B'10000000'                                   1398 05887000
*                    IMPUNIQ = ON;     /*SET IMPORT UNIQUE FLAG      */ 05888000
         OI    IMPUNIQ,B'10000000'                                 1399 05889000
*                    END;                                  /*@VS06407*/ 05890000
*                END;                                              1401 05891000
@RF01396 DS    0H                                                  1402 05892000
*            END;                                                  1402 05893000
*                                                                  1402 05894000
@RF01393 DS    0H                                                  1403 05895000
*        /***********************************************************/  05896000
*        /*                                                          */ 05897000
*        /*  IF A DATA SET WAS A UNIQUE DATA SET (HAVING ITS OWN     */ 05898000
*        /*  DATA SPACE) PRIOR TO EXPORT, IT WILL AGAIN BE DEFINED   */ 05899000
*        /*  AS A UNIQUE DATA SET.  THIS ENTAILS SUPPLYING A NULL    */ 05900000
*        /*  SPACE (VOLUME) FVT FOR CATALOG DEFINE                   */ 05901000
*        /*                                                          */ 05902000
*        /************************************************************/ 05903000
*                                                                  1403 05904000
*        IF IMPUNIQ = ON                                           1403 05905000
*          THEN                                                    1403 05906000
@RF01390 TM    IMPUNIQ,B'10000000'                                 1403 05907000
         BNO   @RF01403                                            1403 05908000
*            DO;                                                   1404 05909000
*            OLDERID2 = NEWERID2;                                  1405 05910000
         L     @15,@PC00001                                        1405 05911000
         L     @15,GDTTR2(,@15)                                    1405 05912000
         MVC   @TS00001(95),NEWERID2(@15)                          1405 05913000
         MVC   OLDERID2(95,@15),@TS00001                           1405 05914000
*            NEWID2 = 'MPUQ';                                      1406 05915000
         MVC   NEWID2(4,@15),@CC01389                              1406 05916000
*            CTGFVPTR = CTGFVT;        /*SET FVT BASE - CLUSTER FVT  */ 05917000
         L     @01,CTGPLPTR                                        1407 05918000
         L     @15,CTGFVT(,@01)                                    1407 05919000
         ST    @15,CTGFVPTR                                        1407 05920000
*            CTGFVVCH = ADDR(IUNIQFVT);/*SET VOLUME FVT ADDRESS      */ 05921000
         LA    @14,IUNIQFVT                                        1408 05922000
         ST    @14,CTGFVVCH(,@15)                                  1408 05923000
*            IUNIQFVT = ''B;           /*ZERO VOLUME FVT             */ 05924000
*                                                                  1409 05925000
         XC    IUNIQFVT(92),IUNIQFVT                               1409 05926000
*            /********************************************************/ 05927000
*            /*                                                      */ 05928000
*            /*  SET VOLUME INDICATOR IN VOLUME FVT                  */ 05929000
*            /*                                                      */ 05930000
*            /********************************************************/ 05931000
*                                                                  1410 05932000
*            CTGFVPTR = CTGFVVCH;      /*SET FVT BASE - VOLUME FVT   */ 05933000
         ST    @14,CTGFVPTR                                        1410 05934000
*            CTGFVTYP = CTGFVVOL;      /*SET TYPE FLAG = VOLUME      */ 05935000
         MVI   CTGFVTYP(@14),C'V'                                  1411 05936000
*            END;                                                  1412 05937000
*                                                                  1412 05938000
*        /************************************************************/ 05939000
*        /*                                                          */ 05940000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 05941000
*        /*                                                          */ 05942000
*        /************************************************************/ 05943000
*                                                                  1413 05944000
*        RETURN CODE(0);                                           1413 05945000
@RF01403 SLR   @15,@15                                             1413 05946000
         L     @14,12(,@13)                                        1413 05947000
         LM    @00,@12,20(@13)                                     1413 05948000
         BR    @14                                                 1413 05949000
*END IUNIQPRC;                                                     1414 05950000
*        /************************************************************/ 05951000
*        /*                                                          */ 05952000
*        /*  PROCEDURE NAME - ALTRPROC                               */ 05953000
*        /*                                                          */ 05954000
*        /*  FUNCTION - ALTRPROC WILL CONSTRUCT A CPL AND FVT TO BE  */ 05955000
*        /*  EMPLOYED BY THE CATALOG ALTER INTERFACE TO ALTER THE    */ 05956000
*        /*  DSATTR CATALOG FIELDS IF INHIBITTARGET WAS SPECIFIED    */ 05957000
*        /*  AT THE TIME OF EXPORT OF THE DATA SET.  CTLGPROC WILL   */ 05958000
*        /*  BE EMPLOYED TO INVOKE CATALOG MANAGEMENT.               */ 05959000
*        /*                                                          */ 05960000
*        /*  INPUT - NONE                                            */ 05961000
*        /*                                                          */ 05962000
*        /*  OUTPUT - THE ATTRIBUTES CATALOG FIELDS WILL HAVE BEEN   */ 05963000
*        /*  ALTERED TO PREVENT UPDATING OF THE SOURCE.              */ 05964000
*        /*                                                          */ 05965000
*        /************************************************************/ 05966000
*                                                                  1415 05967000
*ALTRPROC: PROCEDURE;                                              1415 05968000
ALTRPROC STM   @14,@12,@SA00007                                    1415 05969000
*        /************************************************************/ 05970000
*        /*                                                          */ 05971000
*        /*  LOCAL DECLARATIONS                                      */ 05972000
*        /*                                                          */ 05973000
*        /************************************************************/ 05974000
*                                                                  1416 05975000
*        DCL AFVT CHAR(LENGTH(CTGFV));  /*ALTER FVT                   * 05976000
*        DCL APSWD PTR(31);            /*POINTER TO PASSWORD         */ 05977000
*                                                                  1417 05978000
*        /************************************************************/ 05979000
*        /*                                                          */ 05980000
*        /*  CONSTRUCT CPL AND FVT FOR ALTER INTERFACE IN ORDER TO   */ 05981000
*        /*  ALTER DSATTR (ATTRIBUTES) CATALOG FIELD FOR DATA        */ 05982000
*        /*  COMPONENT AND INDEX COMPONENT,IF EXISTANT.              */ 05983000
*        /*                                                          */ 05984000
*        /************************************************************/ 05985000
*                                                                  1418 05986000
*        CTGPLPTR = PTRCPL;            /*SET CPL BASE -DEFINE CLUSTER*/ 05987000
         L     @15,PTRCPL                                          1418 05988000
         ST    @15,CTGPLPTR                                        1418 05989000
*        CTGFVPTR = CTGFVT;            /*SET FVT BASE - CLUSTER FVT  */ 05990000
         L     @15,CTGFVT(,@15)                                    1419 05991000
         ST    @15,CTGFVPTR                                        1419 05992000
*        CTGFVPTR = CTGFVDCH;          /*SET FVT BASE - DATA FVT     */ 05993000
*                                                                  1420 05994000
         L     @15,CTGFVDCH(,@15)                                  1420 05995000
         ST    @15,CTGFVPTR                                        1420 05996000
*ALTRLP: DO I = 2 TO NUMCOMP;                              /*@Y30SSFR*/ 05997000
ALTRLP   LA    I,2                                                 1421 05998000
         B     @DE01421                                            1421 05999000
@DL01421 DS    0H                                                  1422 06000000
*        IF CTGFVATR ^= NULLPTR                                    1422 06001000
*          THEN                                                    1422 06002000
         SLR   @02,@02                                             1422 06003000
         L     @15,CTGFVPTR                                        1422 06004000
         L     @14,CTGFVATR(,@15)                                  1422 06005000
         CR    @14,@02                                             1422 06006000
         BE    @RF01422                                            1422 06007000
*            DO;                                                   1423 06008000
*                                                                  1423 06009000
*            /********************************************************/ 06010000
*            /*                                                      */ 06011000
*            /*  IF THERE IS AN EXISTANT DSATTR FIELD, TURN ON THE   */ 06012000
*            /*  TEMPORARY EXPORT FLAG.                              */ 06013000
*            /*  SINCE THE FPL HAS BEEN EMPLOYED FOR DEFINE,         */ 06014000
*            /*  IT MUST BE REINITIALIZED.                           */ 06015000
*            /*                                                      */ 06016000
*            /********************************************************/ 06017000
*                                                                  1424 06018000
*            CTGFLPTR = CTGFVATR;      /*SET FPL BASE - DSATTR FPL   */ 06019000
         LR    CTGFLPTR,@14                                        1424 06020000
*            FDSINHUP = ON;            /*SET INHIBIT UPDATE          */ 06021000
         L     @05,CTGFLPT(,CTGFLPTR)                              1425 06022000
         OI    FDSINHUP(@05),B'00000100'                           1425 06023000
*            CTGFLDWA = ''B;           /*ZERO FPL WORK AREA          */ 06024000
         XC    CTGFLDWA(4,CTGFLPTR),CTGFLDWA(CTGFLPTR)             1426 06025000
*            CTGFLCHN = NULLPTR;       /*ZERO CHAIN FIELD            */ 06026000
*                                                                  1427 06027000
         ST    @02,CTGFLCHN(,CTGFLPTR)                             1427 06028000
*            /********************************************************/ 06029000
*            /*                                                      */ 06030000
*            /*  SET POINTER TO FVT. SET THE TYPE FIELD IN THE FVT,  */ 06031000
*            /*  THE ENTNAME FIELD TO THE ENTNAME FPL, AND THE       */ 06032000
*            /*  ATTRIBUTES FIELD TO THE DSATTR FPL                  */ 06033000
*            /*                                                      */ 06034000
*            /********************************************************/ 06035000
*                                                                  1428 06036000
*            AFVTPTR = ADDR(AFVT);                                 1428 06037000
         LA    AFVTPTR,AFVT                                        1428 06038000
*            AFVT = ''B;                                           1429 06039000
*                                                                  1429 06040000
         XC    AFVT(92),AFVT                                       1429 06041000
*            /********************************************************/ 06042000
*            /*                                                      */ 06043000
*            /*  SET TYPE FIELD, ENTNAME FPL POINTER AND DSATTR FPL  */ 06044000
*            /*                                                      */ 06045000
*            /********************************************************/ 06046000
*                                                                  1430 06047000
*            AFVTPTR -> CTGFVTYP = CTGFVTYP;  /*SET TYPE FIELD       */ 06048000
         MVC   CTGFVTYP(1,AFVTPTR),CTGFVTYP(@15)                   1430 06049000
*            AFVTPTR -> CTGFVENT = CTGFVENT;  /*ENTNAME - ENTRY NAME */ 06050000
         L     @05,CTGFVENT(,@15)                                  1431 06051000
         ST    @05,CTGFVENT(,AFVTPTR)                              1431 06052000
*            AFVTPTR -> CTGFVATR = CTGFVATR;  /*SET PTR TO DSATTR FPL*/ 06053000
         ST    @14,CTGFVATR(,AFVTPTR)                              1432 06054000
*            AFVTPTR -> CTGFVIND = ADDR(OUTDDVAL);         /*@Y30SSFR*/ 06055000
*                                                                  1433 06056000
         L     @05,@PC00001+4                                      1433 06057000
         L     @05,FDTPTR+4(,@05)                                  1433 06058000
         LA    @05,OUTDDVAL(,@05)                                  1433 06059000
         ST    @05,CTGFVIND(,AFVTPTR)                              1433 06060000
*            /********************************************************/ 06061000
*            /*                                                      */ 06062000
*            /*  DETERMINE IF THE DATA OR INDEX COMPONENT IS         */ 06063000
*            /*  UNIQUELY PASSWORD PROTECTED.  IF SO, SET PASSWORD   */ 06064000
*            /*  POINTER TO DATA OR INDEX MASTER PASSWORD.           */ 06065000
*            /*                                                      */ 06066000
*            /********************************************************/ 06067000
*                                                                  1434 06068000
*            IF CTGFVSTY ^= NULLPTR                                1434 06069000
*              THEN                                                1434 06070000
         L     @05,CTGFVSTY(,@15)                                  1434 06071000
         CR    @05,@02                                             1434 06072000
         BE    @RF01434                                            1434 06073000
*                APSWD = CTGFVSTY -> CTGFLPT(1);                   1435 06074000
         L     @05,CTGFLPT(,@05)                                   1435 06075000
         ST    @05,APSWD                                           1435 06076000
*              ELSE                                                1436 06077000
*                APSWD = CPSWD;                                    1436 06078000
*                                                                  1436 06079000
         B     @RC01434                                            1436 06080000
@RF01434 L     @05,CPSWD                                           1436 06081000
         ST    @05,APSWD                                           1436 06082000
*            /********************************************************/ 06083000
*            /*                                                      */ 06084000
*            /*  NOW BUILD CPL FOR THE CATALOG ALTER                 */ 06085000
*            /*  IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR      */ 06086000
*            /*                                                      */ 06087000
*            /********************************************************/ 06088000
*                                                                  1437 06089000
*            CALL CPLPROC('A',ACPLPTR,NULLPARM,NULLPARM,APSWD);    1437 06090000
@RC01434 MVC   @AL00001(16),@AL01437                               1437 06091000
         LA    @05,ACPLPTR                                         1437 06092000
         ST    @05,@AL00001+4                                      1437 06093000
         LA    @05,APSWD                                           1437 06094000
         ST    @05,@AL00001+16                                     1437 06095000
         LA    @01,@AL00001                                        1437 06096000
         BAL   @14,CPLPROC                                         1437 06097000
*                                                          /*@OZ33267*/ 06098000
*                                                                  1438 06099000
*            RESPECIFY RTNREG RSTD;                                1438 06100000
*            TESTRC = RTNREG;                                      1439 06101000
         LR    TESTRC,RTNREG                                       1439 06102000
*            RESPECIFY RTNREG UNRSTD;                              1440 06103000
*            IF TESTRC ^= 0                                        1441 06104000
*              THEN                                                1441 06105000
         LTR   TESTRC,TESTRC                                       1441 06106000
         BZ    @RF01441                                            1441 06107000
*                RETURN CODE(LASTCC12);                            1442 06108000
         LA    @15,12                                              1442 06109000
         L     @14,@SA00007                                        1442 06110000
         LM    @00,@12,@SA00007+8                                  1442 06111000
         BR    @14                                                 1442 06112000
*            ACPLPTR -> CTGFVT = AFVTPTR;                  /*@Y30SSFR*/ 06113000
*                                                                  1443 06114000
@RF01441 L     @05,ACPLPTR                                         1443 06115000
         ST    AFVTPTR,CTGFVT(,@05)                                1443 06116000
*            /********************************************************/ 06117000
*            /*                                                      */ 06118000
*            /*  INVOKE CATALOG MANAGEMENT  TO ALTER ATTRIBUTES FIELD*/ 06119000
*            /*  IF ALTER FAILS, RETURN TO CALLER WITH FAILURE       */ 06120000
*            /*  INDICATED.                                          */ 06121000
*            /*                                                      */ 06122000
*            /********************************************************/ 06123000
*                                                                  1444 06124000
*            CALL CTLGPROC(ACPLPTR);                               1444 06125000
*                                                                  1444 06126000
         LA    @02,ACPLPTR                                         1444 06127000
         ST    @02,@AL00001                                        1444 06128000
         LA    @01,@AL00001                                        1444 06129000
         BAL   @14,CTLGPROC                                        1444 06130000
*            RESPECIFY RTNREG RSTD;                                1445 06131000
*            TESTRC = RTNREG;                                      1446 06132000
         LR    TESTRC,RTNREG                                       1446 06133000
*            RESPECIFY RTNREG UNRSTD;                              1447 06134000
*            IF TESTRC ^= 0                                        1448 06135000
*              THEN                                                1448 06136000
         LTR   TESTRC,TESTRC                                       1448 06137000
         BZ    @RF01448                                            1448 06138000
*                RETURN CODE(LASTCC12);                            1449 06139000
*                                                                  1449 06140000
         LA    @15,12                                              1449 06141000
         L     @14,@SA00007                                        1449 06142000
         LM    @00,@12,@SA00007+8                                  1449 06143000
         BR    @14                                                 1449 06144000
*            /********************************************************/ 06145000
*            /*                                                      */ 06146000
*            /*  SET POINTERS FOR ALTER OF INDEX FVT.  IF NO INDEX   */ 06147000
*            /*  CLUSTER COMPONENT, RETURN TO CALLING PROCESSOR      */ 06148000
*            /*                                                      */ 06149000
*            /********************************************************/ 06150000
*                                                                  1450 06151000
*            CTGFVPTR =PTRCPL -> CTGFVT;                           1450 06152000
@RF01448 L     @02,PTRCPL                                          1450 06153000
         L     @02,CTGFVT(,@02)                                    1450 06154000
         ST    @02,CTGFVPTR                                        1450 06155000
*            IF CTGFVICH = NULLPTR                                 1451 06156000
*              THEN                                                1451 06157000
         SLR   @15,@15                                             1451 06158000
         C     @15,CTGFVICH(,@02)                                  1451 06159000
         BNE   @RF01451                                            1451 06160000
*                RETURN CODE(0);                                   1452 06161000
         L     @14,@SA00007                                        1452 06162000
         LM    @00,@12,@SA00007+8                                  1452 06163000
         BR    @14                                                 1452 06164000
*            CTGFVPTR = CTGFVICH;                                  1453 06165000
@RF01451 L     @02,CTGFVPTR                                        1453 06166000
         L     @02,CTGFVICH(,@02)                                  1453 06167000
         ST    @02,CTGFVPTR                                        1453 06168000
*            END;                                                  1454 06169000
*        END ALTRLP;                                               1455 06170000
*                                                                  1455 06171000
@RF01422 AL    I,@CF00221                                          1455 06172000
@DE01421 CH    I,NUMCOMP                                           1455 06173000
         BNH   @DL01421                                            1455 06174000
*        /************************************************************/ 06175000
*        /*                                                          */ 06176000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 06177000
*        /*                                                          */ 06178000
*        /************************************************************/ 06179000
*                                                                  1456 06180000
*        RETURN CODE(0);                                           1456 06181000
         SLR   @15,@15                                             1456 06182000
         L     @14,@SA00007                                        1456 06183000
         LM    @00,@12,@SA00007+8                                  1456 06184000
         BR    @14                                                 1456 06185000
*END ALTRPROC;                                                     1457 06186000
*        /************************************************************/ 06187000
*        /*                                                          */ 06188000
*        /*  PROCEDURE NAME - LVLRPROC                               */ 06189000
*        /*                                                          */ 06190000
*        /*  FUNCTION - CONSTRUCT FIELD PARAMETER LISTS (FPL'S)      */ 06191000
*        /*  FOR DEVTYPE (FROM DEVICETYPES PARAMETER IN AMS COMMAND  */ 06192000
*        /*  OR LISTS FOR LISTVOLS OR LISTRNGS FROM THE LIST         */ 06193000
*        /*  PARAMETER IN THE AMS COMMAND OR THE RANGES PARAMETER    */ 06194000
*        /*                                                          */ 06195000
*        /*  INPUT -                                                 */ 06196000
*        /*    .LX - INDEX TO CORRECT OBJECT PARAMETER IN FDTTBL     */ 06197000
*        /*    .LFVTPTR - POINTER TO FVT WHERE FPL OR LIST POINTERS  */ 06198000
*        /*     ARE TO BE INSERTED                                   */ 06199000
*        /*                                                          */ 06200000
*        /*  OUTPUT - FPL AND LISTS WILL BE CONSTRUCTED              */ 06201000
*        /*                                                          */ 06202000
*        /************************************************************/ 06203000
*                                                                  1458 06204000
*LVLRPROC: PROCEDURE (LX,              /*INDEX TO OBJECT PARAMETER   */ 06205000
*                    LISTDICT,         /*POINTER TO DICTIONARY FROM  */ 06206000
*                    LISTWKA,          /*FVT POINTER                 */ 06207000
*                    LFVTPTR);         /*WORK AREA CONTAINED CATALOG */ 06208000
LVLRPROC STM   @14,@12,@SA00008                                    1458 06209000
         MVC   @PC00008(16),0(@01)                                 1458 06210000
*                                      /*FIELD INFORMATION           */ 06211000
*                                                                  1459 06212000
*        /************************************************************/ 06213000
*        /*                                                          */ 06214000
*        /*  ARGUMENTS OF INVOCATION                                 */ 06215000
*        /*                                                          */ 06216000
*        /************************************************************/ 06217000
*                                                                  1459 06218000
*        DCL LX       FIXED(31),                                   1459 06219000
*            LISTDICT PTR(31),                                     1459 06220000
*            LISTWKA  PTR(31),                                     1459 06221000
*            LFVTPTR  PTR(31);                                     1459 06222000
*                                                                  1459 06223000
*        /************************************************************/ 06224000
*        /*                                                          */ 06225000
*        /*  LOCAL DECLARES                                          */ 06226000
*        /*                                                          */ 06227000
*        /************************************************************/ 06228000
*                                                                  1460 06229000
*        DCL FLISTPTR PTR(31);         /*POINTER TO VOL SER LIST     */ 06230000
*                                                                  1460 06231000
*        DCL FDEVTPTR PTR(31);         /*POINTER TO DEVICETYPE FPL   */ 06232000
*        DCL 1 FDEV BASED(FDEVTPTR),                               1462 06233000
*              2 FDEVTYP (*),                                      1462 06234000
*                3 FDEVT CHAR(8),      /*DEVICE TYPE                 */ 06235000
*                3 FDRESV CHAR(4);     /*RESERVED                    */ 06236000
*        DCL NUMVOL FIXED(15);         /*NUMBER OF VOLUMES   @Y30SSFR*/ 06237000
*                                                                  1463 06238000
*        /************************************************************/ 06239000
*        /*                                                          */ 06240000
*        /*  CHECK TO BE SURE THE VOLUME PARAMETER WAS SPECIFIED     */ 06241000
*        /*  IN THE AMS COMMAND                                      */ 06242000
*        /*                                                          */ 06243000
*        /************************************************************/ 06244000
*                                                                  1464 06245000
*        OLDERID2 = NEWERID2;                                      1464 06246000
         L     @15,@PC00001                                        1464 06247000
         L     @14,GDTTR2(,@15)                                    1464 06248000
         MVC   @TS00001(95),NEWERID2(@14)                          1464 06249000
         MVC   OLDERID2(95,@14),@TS00001                           1464 06250000
*        NEWID2 = 'MPLV';                                          1465 06251000
*                                                                  1465 06252000
         MVC   NEWID2(4,@14),@CC01415                              1465 06253000
*        CTGFVPTR = LFVTPTR;                                       1466 06254000
*                                                                  1466 06255000
         L     @14,@PC00008+12                                     1466 06256000
         L     @14,LFVTPTR(,@14)                                   1466 06257000
         ST    @14,CTGFVPTR                                        1466 06258000
*        /************************************************************/ 06259000
*        /*                                                          */ 06260000
*        /*             CONSTRUCT LIST OF VOLUME SERIALS             */ 06261000
*        /*                                                          */ 06262000
*        /************************************************************/ 06263000
*                                                                  1467 06264000
*        IF LISTDICT ^= NULLPTR                                    1467 06265000
*          THEN                                                    1467 06266000
         SLR   @05,@05                                             1467 06267000
         L     @04,@PC00008+4                                      1467 06268000
         L     @04,LISTDICT(,@04)                                  1467 06269000
         CR    @04,@05                                             1467 06270000
         BE    @RF01467                                            1467 06271000
*            DO;                                                   1468 06272000
*                                                                  1468 06273000
*            /********************************************************/ 06274000
*            /*                                                      */ 06275000
*            /*  PICK UP POINTER TO DICTIONARY ENTRY AND SEE IF A    */ 06276000
*            /*  VOLUME SERIAL LIST WAS PASSED FOR THIS COMPONENT    */ 06277000
*            /*                                                      */ 06278000
*            /********************************************************/ 06279000
*                                                                  1469 06280000
*            DICTPTR = LISTDICT;                                   1469 06281000
         ST    @04,DICTPTR                                         1469 06282000
*            IF DICTLN(IVOLSER) ^= 0                               1470 06283000
*              THEN                                                1470 06284000
         L     @04,DICTLN+128(,@04)                                1470 06285000
         CR    @04,@05                                             1470 06286000
         BE    @RF01470                                            1470 06287000
*                DO;                                               1471 06288000
*                                                                  1471 06289000
         ST    @04,@TF00001                                        1471 06290000
*                /****************************************************/ 06291000
*                /*                                                  */ 06292000
*                /*  A VOLUME SERIAL LIST WAS PASSED. COMPUTE LENGTH */ 06293000
*                /*  OF LIST TO BE CONSTRUCTED FOR DEFINE            */ 06294000
*                /*                                                  */ 06295000
*                /****************************************************/ 06296000
*                                                                  1472 06297000
*                NUMVOL = DICTLN(IVOLSER) / 6;                     1472 06298000
         L     @00,@TF00001                                        1472 06299000
         SRDA  @00,32                                              1472 06300000
         D     @00,@CF00159                                        1472 06301000
         LR    NUMVOL,@01                                          1472 06302000
*                TOTLEN = LENGTH(FVOLSERL) * NUMVOL + 2;           1473 06303000
*                                                                  1473 06304000
         LR    @05,NUMVOL                                          1473 06305000
         SLA   @05,3                                               1473 06306000
         AL    @05,@CF00156                                        1473 06307000
         ST    @05,TOTLEN                                          1473 06308000
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVVLT,GPID,SETZERO);   06309000
*                                                                  1474 06310000
         ST    @15,@AL00001                                        1474 06311000
         LA    @05,TOTLEN                                          1474 06312000
         ST    @05,@AL00001+4                                      1474 06313000
         LA    @05,CTGFVVLT(,@14)                                  1474 06314000
         ST    @05,@AL00001+8                                      1474 06315000
         LA    @05,GPID                                            1474 06316000
         ST    @05,@AL00001+12                                     1474 06317000
         LA    @05,SETZERO                                         1474 06318000
         ST    @05,@AL00001+16                                     1474 06319000
         MVI   @AL00001+16,X'80'                                   1474 06320000
         L     @15,GDTGPL(,@15)                                    1474 06321000
         LA    @01,@AL00001                                        1474 06322000
         BALR  @14,@15                                             1474 06323000
*                RESPECIFY RTNREG RSTD;                            1475 06324000
*                TESTRC = RTNREG;                                  1476 06325000
         LR    TESTRC,RTNREG                                       1476 06326000
*                RESPECIFY RTNREG UNRSTD;                          1477 06327000
*                                                                  1477 06328000
*                /****************************************************/ 06329000
*                /*                                                  */ 06330000
*                /*  IF CORE IS NOT OBTAINED SUCCESSFULLY FOR THE    */ 06331000
*                /*  RETURN TO CALLER WITH AN ERROR INDICATED        */ 06332000
*                /*                                                  */ 06333000
*                /****************************************************/ 06334000
*                                                                  1478 06335000
*                IF TESTRC ^= 0                                    1478 06336000
*                  THEN                                            1478 06337000
         LTR   TESTRC,TESTRC                                       1478 06338000
         BZ    @RF01478                                            1478 06339000
*                    DO;                                           1479 06340000
*                    DEFSTID = NOSTORAG;                           1480 06341000
         MVI   DEFSTID,X'04'                                       1480 06342000
*                    DARGSMOD = UNIVMSG;                           1481 06343000
         L     @01,DDSTRU                                          1481 06344000
         MVC   DARGSMOD(3,@01),@CC01023                            1481 06345000
*                    RETURN CODE(LASTCC12);                        1482 06346000
         LA    @15,12                                              1482 06347000
         L     @14,@SA00008                                        1482 06348000
         LM    @00,@12,@SA00008+8                                  1482 06349000
         BR    @14                                                 1482 06350000
*                    END;                                          1483 06351000
*                                                                  1483 06352000
*                /****************************************************/ 06353000
*                /*                                                  */ 06354000
*                /*  CONSTRUCT LISTVOLS VOLUME SERIAL LIST           */ 06355000
*                /*                                                  */ 06356000
*                /****************************************************/ 06357000
*                                                                  1484 06358000
*                DO N = 1 TO NUMVOL;                               1484 06359000
@RF01478 LA    N,1                                                 1484 06360000
         B     @DE01484                                            1484 06361000
@DL01484 DS    0H                                                  1485 06362000
*                  FVOLSER(N) = (DICTDL(IVOLSER) +LISTWKA + (N-1)  1485 06363000
*                    * 6) -> FLVOLSER;                             1485 06364000
         LR    @05,N                                               1485 06365000
         SLA   @05,3                                               1485 06366000
         L     @02,CTGFVPTR                                        1485 06367000
         L     @02,CTGFVVLT(,@02)                                  1485 06368000
         ALR   @02,@05                                             1485 06369000
         AL    @02,@CF01689                                        1485 06370000
         L     @05,@PC00008+8                                      1485 06371000
         L     @01,DICTPTR                                         1485 06372000
         L     @15,DICTDL+128(,@01)                                1485 06373000
         AL    @15,LISTWKA(,@05)                                   1485 06374000
         LR    @05,N                                               1485 06375000
         BCTR  @05,0                                               1485 06376000
         MH    @05,@CH00159                                        1485 06377000
         ALR   @15,@05                                             1485 06378000
         MVC   FVOLSER-4(6,@02),FLVOLSER(@15)                      1485 06379000
*                END;                                              1486 06380000
         AL    N,@CF00221                                          1486 06381000
@DE01484 CR    N,NUMVOL                                            1486 06382000
         BNH   @DL01484                                            1486 06383000
*                FLISTLN = TOTLEN - 2;                             1487 06384000
         L     @01,CTGFVPTR                                        1487 06385000
         L     @01,CTGFVVLT(,@01)                                  1487 06386000
         L     @00,TOTLEN                                          1487 06387000
         BCTR  @00,0                                               1487 06388000
         BCTR  @00,0                                               1487 06389000
         STH   @00,FLISTLN(,@01)                                   1487 06390000
*                IMPF2VOL= ON;                                     1488 06391000
         OI    IMPF2VOL,B'10000000'                                1488 06392000
*                END;                                              1489 06393000
*                                                                  1489 06394000
*            /********************************************************/ 06395000
*            /*                                                      */ 06396000
*            /*  RETURN TO CALLER WITH A GOOD RETURN CODE            */ 06397000
*            /*                                                      */ 06398000
*            /********************************************************/ 06399000
*                                                                  1490 06400000
*            RETURN CODE(0);                                       1490 06401000
@RF01470 SLR   @15,@15                                             1490 06402000
         L     @14,@SA00008                                        1490 06403000
         LM    @00,@12,@SA00008+8                                  1490 06404000
         BR    @14                                                 1490 06405000
*            END;                                                  1491 06406000
*                                                                  1491 06407000
*        /************************************************************/ 06408000
*        /*                                                          */ 06409000
*        /*  CONSTRUCT LIST OF VOLUME SERIALS IF LIST PARAMETER      */ 06410000
*        /*  WAS SPECIFIED IN THE AMS COMMAND                        */ 06411000
*        /*                                                          */ 06412000
*        /************************************************************/ 06413000
*                                                                  1492 06414000
*        IF LISTVPTR(LX) ^= NULLPTR                                1492 06415000
*          THEN                                                    1492 06416000
@RF01467 L     @15,@PC00008                                        1492 06417000
         L     @15,LX(,@15)                                        1492 06418000
         SLA   @15,2                                               1492 06419000
         L     @14,@PC00001+4                                      1492 06420000
         L     @01,FDTPTR+24(,@14)                                 1492 06421000
         AL    @01,@CF01689                                        1492 06422000
         L     @15,LISTVPTR(@15,@01)                               1492 06423000
         LTR   @15,@15                                             1492 06424000
         BZ    @RF01492                                            1492 06425000
*            DO;                                                   1493 06426000
*            TOTLEN = LENGTH(FVOLSERL) * (LISTVPTR(LX)->LISTVCNT) +2;   06427000
*                                                                  1494 06428000
         LH    @03,LISTVCNT(,@15)                                  1494 06429000
         SLA   @03,3                                               1494 06430000
         AL    @03,@CF00156                                        1494 06431000
         ST    @03,TOTLEN                                          1494 06432000
*            /*******************************************************/  06433000
*            /*                                                      */ 06434000
*            /*  GET CORE FOR THE VOLUME SERIAL LIST. IF CORE IS     */ 06435000
*            /*  NOT OBTAINED SUCCESSFULLY, RETURN TO THE CALLING    */ 06436000
*            /*  PROCESSOR                                           */ 06437000
*            /*                                                      */ 06438000
*            /********************************************************/ 06439000
*                                                                  1495 06440000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVVLT,GPID,SETZERO);  1495 06441000
*                                                                  1495 06442000
         L     @03,@PC00001                                        1495 06443000
         ST    @03,@AL00001                                        1495 06444000
         LA    @15,TOTLEN                                          1495 06445000
         ST    @15,@AL00001+4                                      1495 06446000
         L     @01,CTGFVPTR                                        1495 06447000
         LA    @15,CTGFVVLT(,@01)                                  1495 06448000
         ST    @15,@AL00001+8                                      1495 06449000
         LA    @15,GPID                                            1495 06450000
         ST    @15,@AL00001+12                                     1495 06451000
         LA    @15,SETZERO                                         1495 06452000
         ST    @15,@AL00001+16                                     1495 06453000
         MVI   @AL00001+16,X'80'                                   1495 06454000
         L     @15,GDTGPL(,@03)                                    1495 06455000
         LA    @01,@AL00001                                        1495 06456000
         BALR  @14,@15                                             1495 06457000
*            RESPECIFY RTNREG RSTD;                                1496 06458000
*            TESTRC = RTNREG;                                      1497 06459000
         LR    TESTRC,RTNREG                                       1497 06460000
*            RESPECIFY RTNREG UNRSTD;                              1498 06461000
*            IF TESTRC ^= 0                                        1499 06462000
*              THEN                                                1499 06463000
         LTR   TESTRC,TESTRC                                       1499 06464000
         BZ    @RF01499                                            1499 06465000
*                DO;                                               1500 06466000
*                DARGSMOD = UNIVMSG;                               1501 06467000
         L     @01,DDSTRU                                          1501 06468000
         MVC   DARGSMOD(3,@01),@CC01023                            1501 06469000
*                DEFSTID = NOSTORAG;                               1502 06470000
         MVI   DEFSTID,X'04'                                       1502 06471000
*                RETURN CODE(LASTCC12);                            1503 06472000
         LA    @15,12                                              1503 06473000
         L     @14,@SA00008                                        1503 06474000
         LM    @00,@12,@SA00008+8                                  1503 06475000
         BR    @14                                                 1503 06476000
*                END;                                              1504 06477000
*                                                                  1504 06478000
*            /********************************************************/ 06479000
*            /*                                                      */ 06480000
*            /*  CONSTRUCT LIST OF VOLUME SERIAL NUMBERS             */ 06481000
*            /*                                                      */ 06482000
*            /********************************************************/ 06483000
*                                                                  1505 06484000
*            DO N = 1 TO (LISTVPTR(LX)->LISTVCNT);                 1505 06485000
@RF01499 LA    N,1                                                 1505 06486000
         B     @DE01505                                            1505 06487000
@DL01505 DS    0H                                                  1506 06488000
*              FVOLSER(N) = LISTVPTR(LX) -> LISTVVAL(N);           1506 06489000
         LR    @02,N                                               1506 06490000
         SLA   @02,3                                               1506 06491000
         L     @01,CTGFVPTR                                        1506 06492000
         L     @01,CTGFVVLT(,@01)                                  1506 06493000
         ALR   @01,@02                                             1506 06494000
         AL    @01,@CF01689                                        1506 06495000
         L     @15,@PC00008                                        1506 06496000
         L     @15,LX(,@15)                                        1506 06497000
         SLA   @15,2                                               1506 06498000
         L     @14,@PC00001+4                                      1506 06499000
         L     @14,FDTPTR+24(,@14)                                 1506 06500000
         AL    @14,@CF01689                                        1506 06501000
         L     @15,LISTVPTR(@15,@14)                               1506 06502000
         ALR   @15,@02                                             1506 06503000
         AL    @15,@CF01707                                        1506 06504000
         MVC   FVOLSER-4(6,@01),LISTVVAL-3(@15)                    1506 06505000
*              END;                                                1507 06506000
         AL    N,@CF00221                                          1507 06507000
@DE01505 L     @02,@PC00008                                        1507 06508000
         L     @02,LX(,@02)                                        1507 06509000
         SLA   @02,2                                               1507 06510000
         L     @15,@PC00001+4                                      1507 06511000
         L     @01,FDTPTR+24(,@15)                                 1507 06512000
         AL    @01,@CF01689                                        1507 06513000
         L     @02,LISTVPTR(@02,@01)                               1507 06514000
         CH    N,LISTVCNT(,@02)                                    1507 06515000
         BNH   @DL01505                                            1507 06516000
*            FLISTLN = TOTLEN -2;                                  1508 06517000
         L     @01,CTGFVPTR                                        1508 06518000
         L     @01,CTGFVVLT(,@01)                                  1508 06519000
         L     @00,TOTLEN                                          1508 06520000
         BCTR  @00,0                                               1508 06521000
         BCTR  @00,0                                               1508 06522000
         STH   @00,FLISTLN(,@01)                                   1508 06523000
*            IMPF2VOL = ON;                                        1509 06524000
         OI    IMPF2VOL,B'10000000'                                1509 06525000
*            END;                                                  1510 06526000
*                                                                  1510 06527000
*        /************************************************************/ 06528000
*        /*                                                          */ 06529000
*        /*  IF DEVICETYPES WAS SPECIFIED IN THE AMS COMMAND, SET    */ 06530000
*        /*  UP THE DEVTYP FPL AND FIELD INFORMATION.  THIS          */ 06531000
*        /*  PARAMETER MAY ONLY BE SPECIFIED FOR  A USER CATALOG     */ 06532000
*        /*  CONNECT OPERATION.                                      */ 06533000
*        /*                                                          */ 06534000
*        /************************************************************/ 06535000
*                                                                  1511 06536000
*        IF DEVTPTR(LX) ^= NULLPTR & ADDR(CON) ^= NULLPTR          1511 06537000
*          THEN                                                    1511 06538000
@RF01492 SLR   @15,@15                                             1511 06539000
         L     @14,@PC00008                                        1511 06540000
         L     @14,LX(,@14)                                        1511 06541000
         SLA   @14,2                                               1511 06542000
         L     @05,@PC00001+4                                      1511 06543000
         L     @01,FDTPTR+32(,@05)                                 1511 06544000
         AL    @01,@CF01689                                        1511 06545000
         L     @14,DEVTPTR(@14,@01)                                1511 06546000
         CR    @14,@15                                             1511 06547000
         BE    @RF01511                                            1511 06548000
         C     @15,FDTPTR+52(,@05)                                 1511 06549000
         BE    @RF01511                                            1511 06550000
*            DO;                                                   1512 06551000
*                                                                  1512 06552000
*            /********************************************************/ 06553000
*            /*                                                      */ 06554000
*            /*  GET CORE FOR THE FPL PLUS THE FIELD INFORMATION     */ 06555000
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR*/ 06556000
*            /*                                                      */ 06557000
*            /********************************************************/ 06558000
*                                                                  1513 06559000
*            TOTLEN = (LENGTH(CTGFL) + 8) + DEVTPTR(LX)->DEVTCNT * 1513 06560000
*               LENGTH(FDEVTYP);                                   1513 06561000
*                                                                  1513 06562000
         LH    @03,DEVTCNT(,@14)                                   1513 06563000
         MH    @03,@CH00035                                        1513 06564000
         AL    @03,@CF00312                                        1513 06565000
         ST    @03,TOTLEN                                          1513 06566000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVDVT,GPID,SETZERO);  1514 06567000
*                                                                  1514 06568000
         L     @03,@PC00001                                        1514 06569000
         ST    @03,@AL00001                                        1514 06570000
         LA    @15,TOTLEN                                          1514 06571000
         ST    @15,@AL00001+4                                      1514 06572000
         L     @01,CTGFVPTR                                        1514 06573000
         LA    @15,CTGFVDVT(,@01)                                  1514 06574000
         ST    @15,@AL00001+8                                      1514 06575000
         LA    @15,GPID                                            1514 06576000
         ST    @15,@AL00001+12                                     1514 06577000
         LA    @15,SETZERO                                         1514 06578000
         ST    @15,@AL00001+16                                     1514 06579000
         MVI   @AL00001+16,X'80'                                   1514 06580000
         L     @15,GDTGPL(,@03)                                    1514 06581000
         LA    @01,@AL00001                                        1514 06582000
         BALR  @14,@15                                             1514 06583000
*            RESPECIFY RTNREG RSTD;                                1515 06584000
*            TESTRC = RTNREG;                                      1516 06585000
         LR    TESTRC,RTNREG                                       1516 06586000
*            RESPECIFY RTNREG UNRSTD;                              1517 06587000
*            IF TESTRC ^= 0                                        1518 06588000
*              THEN                                                1518 06589000
         LTR   TESTRC,TESTRC                                       1518 06590000
         BZ    @RF01518                                            1518 06591000
*                DO;                                               1519 06592000
*                DARGSMOD = UNIVMSG;                               1520 06593000
         L     @01,DDSTRU                                          1520 06594000
         MVC   DARGSMOD(3,@01),@CC01023                            1520 06595000
*                DEFSTID = NOSTORAG;                               1521 06596000
         MVI   DEFSTID,X'04'                                       1521 06597000
*                RETURN CODE(LASTCC12);                            1522 06598000
         LA    @15,12                                              1522 06599000
         L     @14,@SA00008                                        1522 06600000
         LM    @00,@12,@SA00008+8                                  1522 06601000
         BR    @14                                                 1522 06602000
*                END;                                              1523 06603000
*                                                                  1523 06604000
*            /********************************************************/ 06605000
*            /*                                                      */ 06606000
*            /*  CONSTRUCT DEVICETYPES LIST                          */ 06607000
*            /*                                                      */ 06608000
*            /********************************************************/ 06609000
*                                                                  1524 06610000
*            CTGFLPTR = CTGFVDVT;                                  1524 06611000
@RF01518 L     @03,CTGFVPTR                                        1524 06612000
         L     @03,CTGFVDVT(,@03)                                  1524 06613000
         LR    CTGFLPTR,@03                                        1524 06614000
*            FDEVTPTR = CTGFVDVT + LENGTH(CTGFL) +8;               1525 06615000
         AL    @03,@CF00312                                        1525 06616000
         LR    FDEVTPTR,@03                                        1525 06617000
*            DO N = 1 TO  DEVTPTR(LX)->DEVTCNT;                    1526 06618000
         LA    N,1                                                 1526 06619000
         B     @DE01526                                            1526 06620000
@DL01526 DS    0H                                                  1527 06621000
*              FDEVT(N) = DEVTPTR(LX) -> DEVTVAL(N,1:8);           1527 06622000
         LR    @05,N                                               1527 06623000
         MH    @05,@CH00035                                        1527 06624000
         ALR   @05,FDEVTPTR                                        1527 06625000
         AL    @05,@CF01708                                        1527 06626000
         LR    @15,N                                               1527 06627000
         MH    @15,@CH00037                                        1527 06628000
         L     @14,@PC00008                                        1527 06629000
         L     @14,LX(,@14)                                        1527 06630000
         SLA   @14,2                                               1527 06631000
         L     @01,@PC00001+4                                      1527 06632000
         L     @01,FDTPTR+32(,@01)                                 1527 06633000
         AL    @01,@CF01689                                        1527 06634000
         L     @01,DEVTPTR(@14,@01)                                1527 06635000
         ALR   @01,@15                                             1527 06636000
         AL    @01,@CF01709                                        1527 06637000
         MVC   FDEVT(8,@05),DEVTVAL-3(@01)                         1527 06638000
*              END;                                                1528 06639000
*                                                                  1528 06640000
         AL    N,@CF00221                                          1528 06641000
@DE01526 L     @05,@PC00008                                        1528 06642000
         L     @05,LX(,@05)                                        1528 06643000
         SLA   @05,2                                               1528 06644000
         L     @15,@PC00001+4                                      1528 06645000
         L     @01,FDTPTR+32(,@15)                                 1528 06646000
         AL    @01,@CF01689                                        1528 06647000
         L     @05,DEVTPTR(@05,@01)                                1528 06648000
         CH    N,DEVTCNT(,@05)                                     1528 06649000
         BNH   @DL01526                                            1528 06650000
*            /********************************************************/ 06651000
*            /*                                                      */ 06652000
*            /*  SET FIELDS IN DEVTYP FPL                            */ 06653000
*            /*                                                      */ 06654000
*            /********************************************************/ 06655000
*                                                                  1529 06656000
*            CTGFLDNO = '00000001'B;                               1529 06657000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1529 06658000
*            CTGFLDNM = ADDR(FNDEVTYP);                            1530 06659000
         LA    @05,FNDEVTYP                                        1530 06660000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             1530 06661000
*            CTGFLNG(1) = DEVTPTR(LX)->DEVTCNT * LENGTH(FDEVTYP);  1531 06662000
         L     @05,@PC00008                                        1531 06663000
         L     @05,LX(,@05)                                        1531 06664000
         SLA   @05,2                                               1531 06665000
         L     @03,@PC00001+4                                      1531 06666000
         L     @03,FDTPTR+32(,@03)                                 1531 06667000
         AL    @03,@CF01689                                        1531 06668000
         L     @05,DEVTPTR(@05,@03)                                1531 06669000
         LH    @05,DEVTCNT(,@05)                                   1531 06670000
         MH    @05,@CH00035                                        1531 06671000
         ST    @05,CTGFLNG(,CTGFLPTR)                              1531 06672000
*            CTGFLPT(1) = FDEVTPTR;                                1532 06673000
         ST    FDEVTPTR,CTGFLPT(,CTGFLPTR)                         1532 06674000
*            END;                                                  1533 06675000
*                                                                  1533 06676000
*        /************************************************************/ 06677000
*        /*                                                          */ 06678000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 06679000
*        /*                                                          */ 06680000
*        /************************************************************/ 06681000
*                                                                  1534 06682000
*        RETURN CODE(0);                                           1534 06683000
*                                                                  1534 06684000
@RF01511 SLR   @15,@15                                             1534 06685000
         L     @14,@SA00008                                        1534 06686000
         LM    @00,@12,@SA00008+8                                  1534 06687000
         BR    @14                                                 1534 06688000
*END LVLRPROC;                                                     1535 06689000
*        /************************************************************/ 06690000
*        /*                                                          */ 06691000
*        /* PROCEDURE NAME - CTLGPROC                                */ 06692000
*        /*                                                          */ 06693000
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/ 06694000
*        /*  THE OPERATION INDICATED IN THE CPL (LOCATE,ALTER,DELETE)*/ 06695000
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/ 06696000
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */ 06697000
*        /*  INDICATORS                                              */ 06698000
*        /*                                                          */ 06699000
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */ 06700000
*        /*                                                          */ 06701000
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */ 06702000
*        /*  FAILURE.  DEFSTID IS SET TO INDICATE MESSAGE ID IF      */ 06703000
*        /*  AN ERROR MESSAGE IS TO BE LISTED.                       */ 06704000
*        /*                                                          */ 06705000
*        /************************************************************/ 06706000
*                                                                  1536 06707000
*CTLGPROC: PROCEDURE(SCPLPTR);         /*CPL POINTER                 */ 06708000
*                                                                  1536 06709000
CTLGPROC STM   @14,@12,@SA00009                                    1536 06710000
         MVC   @PC00009(4),0(@01)                                  1536 06711000
*        /************************************************************/ 06712000
*        /*                                                          */ 06713000
*        /*  ARGUMENTS OF INVOCATION                                 */ 06714000
*        /*                                                          */ 06715000
*        /************************************************************/ 06716000
*                                                                  1537 06717000
*        DCL SCPLPTR PTR(31);                                      1537 06718000
*                                                                  1537 06719000
*        /************************************************************/ 06720000
*        /*                                                          */ 06721000
*        /* LOCAL DECLARATIONS                                       */ 06722000
*        /*                                                          */ 06723000
*        /************************************************************/ 06724000
*                                                                  1538 06725000
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */ 06726000
*                                      /*AM/0 CATALOG MANAGEMENT     */ 06727000
*        DCL VOLLSTOR CHAR(10) BDY(WORD);                  /*@Y30SSFR*/ 06728000
*                                      /*STORAGE FOR THE     @Y30SSFR*/ 06729000
*                                      /*FAKE VOLUMES LIST   @Y30SSFR*/ 06730000
*                                      /*TO BE PASSED TO     @Y30SSFR*/ 06731000
*                                      /*DALCPROC WHEN CMS   @Y30SSFR*/ 06732000
*                                      /*PLACES THE VOLSER   @Y30SSFR*/ 06733000
*                                      /*TO BE ALLOCATED IN  @Y30SSFR*/ 06734000
*                                      /*THE WORKAREA.       @Y30SSFR*/ 06735000
*        DCL VOLLSTPT PTR(31);         /*POINTER TO VOLLSTOR @Y30SSFR*/ 06736000
*        DCL JX       FIXED(31);       /*INDEX USED IN       @Y30SSFR*/ 06737000
*                                      /*VOLUME LIST         @Y30SSFR*/ 06738000
*                                      /*RESTORE             @Y30SSFR*/ 06739000
*        DCL JX1      FIXED(31);       /*INDEX USED IN       @Y30SSFR*/ 06740000
*                                      /*VOLUME LIST         @Y30SSFR*/ 06741000
*                                      /*RESTORE             @Y30SSFR*/ 06742000
*                                                                  1543 06743000
*        /************************************************************/ 06744000
*        /*                                                          */ 06745000
*        /*  INVOKE  CATALOG MANAGEMENT                              */ 06746000
*        /*                                                          */ 06747000
*        /************************************************************/ 06748000
*                                                                  1543 06749000
*        OLDERID2 = NEWERID2;                                      1543 06750000
         L     @15,@PC00001                                        1543 06751000
         L     @14,GDTTR2(,@15)                                    1543 06752000
         MVC   @TS00001(95),NEWERID2(@14)                          1543 06753000
         MVC   OLDERID2(95,@14),@TS00001                           1543 06754000
*        NEWID2 = 'MPSP';                                          1544 06755000
*                                                                  1544 06756000
         MVC   NEWID2(4,@14),@CC01427                              1544 06757000
*        IF GDTDBG = NULLPTR                                       1545 06758000
*          THEN;                                                   1545 06759000
         L     @15,GDTDBG(,@15)                                    1545 06760000
         LTR   @15,@15                                             1545 06761000
         BZ    @RT01545                                            1545 06762000
*          ELSE                                                    1547 06763000
*            CALL IDCDB010 (GDTTBL,'MPZZ');                        1547 06764000
*                                                                  1547 06765000
         L     @15,@PC00001                                        1547 06766000
         ST    @15,@AL00001                                        1547 06767000
         LA    @14,@CC01428                                        1547 06768000
         ST    @14,@AL00001+4                                      1547 06769000
         MVI   @AL00001+4,X'80'                                    1547 06770000
         L     @15,GDTDBG(,@15)                                    1547 06771000
         LA    @01,@AL00001                                        1547 06772000
         BALR  @14,@15                                             1547 06773000
*        CATRTNID = 'CATLGRTN';                                    1548 06774000
*                                                                  1548 06775000
@RT01545 MVC   CATRTNID(8),@CC01429                                1548 06776000
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           1549 06777000
*                                                                  1549 06778000
         L     @15,@PC00001                                        1549 06779000
         ST    @15,@AL00001                                        1549 06780000
         L     @14,@PC00009                                        1549 06781000
         ST    @14,@AL00001+4                                      1549 06782000
         L     @15,GDTCAT(,@15)                                    1549 06783000
         LA    @01,@AL00001                                        1549 06784000
         BALR  @14,@15                                             1549 06785000
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/ 06786000
*        CATLGRC = REG15;                                          1551 06787000
         STH   REG15,CATLGRC                                       1551 06788000
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/ 06789000
*                                                                  1552 06790000
*        IF GDTDBG = NULLPTR                                       1553 06791000
*          THEN;                                                   1553 06792000
         L     @15,@PC00001                                        1553 06793000
         L     @15,GDTDBG(,@15)                                    1553 06794000
         LTR   @15,@15                                             1553 06795000
         BZ    @RT01553                                            1553 06796000
*          ELSE                                                    1555 06797000
*            CALL IDCDB010 (GDTTBL,'MPZZ');                        1555 06798000
*                                                                  1555 06799000
         L     @15,@PC00001                                        1555 06800000
         ST    @15,@AL00001                                        1555 06801000
         LA    @14,@CC01428                                        1555 06802000
         ST    @14,@AL00001+4                                      1555 06803000
         MVI   @AL00001+4,X'80'                                    1555 06804000
         L     @15,GDTDBG(,@15)                                    1555 06805000
         LA    @01,@AL00001                                        1555 06806000
         BALR  @14,@15                                             1555 06807000
*        CTGPLPTR = SCPLPTR;                               /*@Y30SSFR*/ 06808000
*                                                                  1556 06809000
@RT01553 L     @15,@PC00009                                        1556 06810000
         L     @15,SCPLPTR(,@15)                                   1556 06811000
         ST    @15,CTGPLPTR                                        1556 06812000
*        /************************************************************/ 06813000
*        /*                                                          */ 06814000
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */ 06815000
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */ 06816000
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */ 06817000
*        /*                                                          */ 06818000
*        /************************************************************/ 06819000
*                                                                  1557 06820000
*        IF CATLGRC ^= 0                                           1557 06821000
*          THEN                                                    1557 06822000
         LH    @14,CATLGRC                                         1557 06823000
         SLR   @05,@05                                             1557 06824000
         CR    @14,@05                                             1557 06825000
         BE    @RF01557                                            1557 06826000
*            IF CATLGRC = RCWORKSM                                 1558 06827000
*              THEN                                                1558 06828000
         C     @14,@CF01151                                        1558 06829000
         BNE   @RF01558                                            1558 06830000
*                DO;                                               1559 06831000
*                                                                  1559 06832000
*                /****************************************************/ 06833000
*                /*                                                  */ 06834000
*                /*  GET NEEDED SIZE FROM CATALOG WORKAREA   @Y30SSFR*/ 06835000
*                /*                                                  */ 06836000
*                /****************************************************/ 06837000
*                                                                  1560 06838000
*                WSIZE = RETURNLN;                                 1560 06839000
*                                                                  1560 06840000
*                                                                  1560 06841000
         L     @03,CTGWKA(,@15)                                    1560 06842000
         LH    @03,RETURNLN(,@03)                                  1560 06843000
         ST    @03,WSIZE                                           1560 06844000
*                /****************************************************/ 06845000
*                /*                                          @Y30SSFR*/ 06846000
*                /*  ZERO OUT CTGWKA, THE POINTER TO THE     @Y30SSFR*/ 06847000
*                /*  CATALOG WORKAREA.  THE WORKAREA         @Y30SSFR*/ 06848000
*                /*  IS A PART OF A LARGER AREA THAT WAS     @Y30SSFR*/ 06849000
*                /*  GOTTEN TO HOLD THE CPL AND THE WORKAREA @Y30SSFR*/ 06850000
*                /*  AND AS SUCH CANNOT BE FREED INDEPEN-    @Y30SSFR*/ 06851000
*                /*  DENTLY.                                 @Y30SSFR*/ 06852000
*                /*                                          @Y30SSFR*/ 06853000
*                /****************************************************/ 06854000
*                                                                  1561 06855000
*                CTGWKA = NULLPTR;                         /*@Y30SSFR*/ 06856000
*                                                                  1561 06857000
         ST    @05,CTGWKA(,@15)                                    1561 06858000
*            /********************************************************/ 06859000
*            /*                                                      */ 06860000
*            /*  GET CORE FOR THE LARGER WORK AREA.  IF CORE IS NOT  */ 06861000
*            /*  OBTAINED SUCCESSFULLY, RETURN TO CALLING PROCESSOR  */ 06862000
*            /*                                                      */ 06863000
*            /********************************************************/ 06864000
*                                                                  1562 06865000
*                CALL IDCSAGP0 (GDTTBL,WSIZE,CTGWKA,GPID,SETZERO); 1562 06866000
*                                                                  1562 06867000
         L     @03,@PC00001                                        1562 06868000
         ST    @03,@AL00001                                        1562 06869000
         LA    @14,WSIZE                                           1562 06870000
         ST    @14,@AL00001+4                                      1562 06871000
         LA    @15,CTGWKA(,@15)                                    1562 06872000
         ST    @15,@AL00001+8                                      1562 06873000
         LA    @15,GPID                                            1562 06874000
         ST    @15,@AL00001+12                                     1562 06875000
         LA    @15,SETZERO                                         1562 06876000
         ST    @15,@AL00001+16                                     1562 06877000
         MVI   @AL00001+16,X'80'                                   1562 06878000
         L     @15,GDTGPL(,@03)                                    1562 06879000
         LA    @01,@AL00001                                        1562 06880000
         BALR  @14,@15                                             1562 06881000
*                RESPECIFY RTNREG RSTD;                            1563 06882000
*                TESTRC = RTNREG;                                  1564 06883000
         LR    TESTRC,RTNREG                                       1564 06884000
*                RESPECIFY RTNREG UNRSTD;                          1565 06885000
*                IF TESTRC ^= 0                                    1566 06886000
*                  THEN                                            1566 06887000
         LTR   TESTRC,TESTRC                                       1566 06888000
         BZ    @RF01566                                            1566 06889000
*                    DO;                                           1567 06890000
*                    DEFSTID = NOSTORAG;                           1568 06891000
         MVI   DEFSTID,X'04'                                       1568 06892000
*                    DARGSMOD = UNIVMSG;                           1569 06893000
         L     @01,DDSTRU                                          1569 06894000
         MVC   DARGSMOD(3,@01),@CC01023                            1569 06895000
*                    RETURN CODE(LASTCC12);                        1570 06896000
         LA    @15,12                                              1570 06897000
         L     @14,@SA00009                                        1570 06898000
         LM    @00,@12,@SA00009+8                                  1570 06899000
         BR    @14                                                 1570 06900000
*                    END;                                          1571 06901000
*                                                                  1571 06902000
*                AREALN = WSIZE;                                   1572 06903000
*                                                                  1572 06904000
@RF01566 L     @01,CTGPLPTR                                        1572 06905000
         L     @01,CTGWKA(,@01)                                    1572 06906000
         L     @00,WSIZE                                           1572 06907000
         STH   @00,AREALN(,@01)                                    1572 06908000
*                /****************************************************/ 06909000
*                /*                                                  */ 06910000
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */ 06911000
*                /*                                                  */ 06912000
*                /****************************************************/ 06913000
*                                                                  1573 06914000
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   1573 06915000
*                                                                  1573 06916000
         L     @15,@PC00001                                        1573 06917000
         ST    @15,@AL00001                                        1573 06918000
         L     @14,@PC00009                                        1573 06919000
         ST    @14,@AL00001+4                                      1573 06920000
         L     @15,GDTCAT(,@15)                                    1573 06921000
         LA    @01,@AL00001                                        1573 06922000
         BALR  @14,@15                                             1573 06923000
*                RESPECIFY REG15 RSTD;                     /*@Y30SSFR*/ 06924000
*                CATLGRC = REG15;                                  1575 06925000
         STH   REG15,CATLGRC                                       1575 06926000
*                RESPECIFY REG15 UNRSTD;                   /*@Y30SSFR*/ 06927000
*                END;                                              1577 06928000
*              ELSE                                                1578 06929000
*                                                                  1578 06930000
*                /****************************************************/ 06931000
*                /*                                          @Y30SSFR*/ 06932000
*                /*  TEST FOR A VSAM CATALOG RETURN CODE OF  @Y30SSFR*/ 06933000
*                /*  140 WITH A REASON CODE OF 40.  THIS     @Y30SSFR*/ 06934000
*                /*  INDICATES THAT A VOLUME MUST BE         @Y30SSFR*/ 06935000
*                /*  DYNAMICALLY ALLOCATED SO THAT ITS CRA   @Y30SSFR*/ 06936000
*                /*  CAN BE UPDATED.                         @Y30SSFR*/ 06937000
*                /*                                          @Y30SSFR*/ 06938000
*                /****************************************************/ 06939000
*                                                                  1578 06940000
*                IF (CATLGRC = DEFALLRC) & (CTGFBFLG =             1578 06941000
*                   DEFALLFG)                                      1578 06942000
*                  THEN                                            1578 06943000
         B     @RC01558                                            1578 06944000
@RF01558 CLC   CATLGRC(2),@CH01163                                 1578 06945000
         BNE   @RF01578                                            1578 06946000
         L     @01,CTGPLPTR                                        1578 06947000
         CLC   CTGFBFLG(2,@01),@CH01151                            1578 06948000
         BNE   @RF01578                                            1578 06949000
*DEFALLC:            DO;                                   /*@Y30SSFR*/ 06950000
*                                                                  1579 06951000
DEFALLC  DS    0H                                                  1580 06952000
*                    /************************************************/ 06953000
*                    /*                                      @Y30SSFR*/ 06954000
*                    /*  VSAM CATALOG MANAGEMENT IS TO BE    @Y30SSFR*/ 06955000
*                    /*  INVOKED AGAIN.  RESTORE THE CATALOG @Y30SSFR*/ 06956000
*                    /*  PARAMETER LISTS TO BE PASSED TO     @Y30SSFR*/ 06957000
*                    /*  VSAM.                               @Y30SSFR*/ 06958000
*                    /*                                      @Y30SSFR*/ 06959000
*                    /************************************************/ 06960000
*                                                                  1580 06961000
*                    IF (CTGFVT->CTGFVTYP = CTGTCL) |      /*@Y30SSFR*/ 06962000
*                         (CTGFVT->CTGFVTYP = CTGTAIX)     /*@Y30SSFR*/ 06963000
*                      THEN                                /*@Y30SSFR*/ 06964000
         L     @01,CTGPLPTR                                        1580 06965000
         L     @15,CTGFVT(,@01)                                    1580 06966000
         CLI   CTGFVTYP(@15),C'C'                                  1580 06967000
         BE    @RT01580                                            1580 06968000
         CLI   CTGFVTYP(@15),C'G'                                  1580 06969000
         BNE   @RF01580                                            1580 06970000
@RT01580 DS    0H                                                  1581 06971000
*DEFCALLC:               DO;                               /*@Y30SSFR*/ 06972000
DEFCALLC DS    0H                                                  1582 06973000
*                        CTGPL = SAVCPL;                   /*@Y30SSFR*/ 06974000
         L     @01,CTGPLPTR                                        1582 06975000
         MVC   CTGPL(28,@01),SAVCPL                                1582 06976000
*                        DO JX = 1 TO NUMCOMP;             /*@Y30SSFR*/ 06977000
         LA    JX,1                                                1583 06978000
         B     @DE01583                                            1583 06979000
@DL01583 DS    0H                                                  1584 06980000
*                          CALL MVDAPROC(TFVTLEN,SAVFVT(JX),       1584 06981000
*                             FVTPTR(JX));                 /*@Y30SSFR*/ 06982000
         LA    @03,TFVTLEN                                         1584 06983000
         ST    @03,@AL00001                                        1584 06984000
         LR    @03,JX                                              1584 06985000
         SLA   @03,2                                               1584 06986000
         LA    @15,SAVFVT-4(@03)                                   1584 06987000
         ST    @15,@AL00001+4                                      1584 06988000
         LA    @03,FVTPTR-4(@03)                                   1584 06989000
         ST    @03,@AL00001+8                                      1584 06990000
         LA    @01,@AL00001                                        1584 06991000
         BAL   @14,MVDAPROC                                        1584 06992000
*                          IF CTGFVVLT ^= NULLPTR                  1585 06993000
*                            THEN                                  1585 06994000
         L     @03,CTGFVPTR                                        1585 06995000
         L     @03,CTGFVVLT(,@03)                                  1585 06996000
         LTR   @03,@03                                             1585 06997000
         BZ    @RF01585                                            1585 06998000
*                              DO JX1 = 1 TO (FLISTLN/             1586 06999000
*                                 LENGTH(FVOLSERL));       /*@Y30SSFR*/ 07000000
         LA    JX1,1                                               1586 07001000
         B     @DE01586                                            1586 07002000
@DL01586 DS    0H                                                  1587 07003000
*                                FVOLRTN(JX1) = 0;         /*@Y30SSFR*/ 07004000
         LR    @15,JX1                                             1587 07005000
         SLA   @15,3                                               1587 07006000
         L     @01,CTGFVPTR                                        1587 07007000
         L     @01,CTGFVVLT(,@01)                                  1587 07008000
         ALR   @01,@15                                             1587 07009000
         AL    @01,@CF01694                                        1587 07010000
         SLR   @00,@00                                             1587 07011000
         STCM  @00,3,FVOLRTN-2(@01)                                1587 07012000
*                              END;                        /*@Y30SSFR*/ 07013000
         AL    JX1,@CF00221                                        1588 07014000
@DE01586 L     @01,CTGFVPTR                                        1588 07015000
         L     @01,CTGFVVLT(,@01)                                  1588 07016000
         LH    @00,FLISTLN(,@01)                                   1588 07017000
         SRDA  @00,32                                              1588 07018000
         D     @00,@CF00039                                        1588 07019000
         CR    JX1,@01                                             1588 07020000
         BNH   @DL01586                                            1588 07021000
*                        END;                              /*@Y30SSFR*/ 07022000
*                                                                  1589 07023000
@RF01585 AL    JX,@CF00221                                         1589 07024000
@DE01583 CH    JX,NUMCOMP                                          1589 07025000
         BNH   @DL01583                                            1589 07026000
*                        /********************************************/ 07027000
*                        /*                                  @Y30SSFR*/ 07028000
*                        /*  IF THERE IS A NULL VOLUME       @Y30SSFR*/ 07029000
*                        /*  FVT, RESTORE THAT.              @Y30SSFR*/ 07030000
*                        /*                                  @Y30SSFR*/ 07031000
*                        /********************************************/ 07032000
*                                                                  1590 07033000
*                        IF FVTPTR(1) -> CTGFVVCH ^= NULLPTR       1590 07034000
*                          THEN                                    1590 07035000
         L     @01,FVTPTR                                          1590 07036000
         L     @15,CTGFVVCH(,@01)                                  1590 07037000
         LTR   @15,@15                                             1590 07038000
         BZ    @RF01590                                            1590 07039000
*                            DO;                           /*@Y30SSFR*/ 07040000
*                            IUNIQFVT = ''B;               /*@Y30SSFR*/ 07041000
         XC    IUNIQFVT(92),IUNIQFVT                               1592 07042000
*                            FVTPTR(1) -> CTGFVVCH -> CTGFVTYP     1593 07043000
*                               = CTGFVVOL;                /*@Y30SSFR*/ 07044000
         MVI   CTGFVTYP(@15),C'V'                                  1593 07045000
*                            END;                          /*@Y30SSFR*/ 07046000
*                                                                  1594 07047000
*                        /********************************************/ 07048000
*                        /*                                  @Y30SSFR*/ 07049000
*                        /*  IF THE OBJECT BEING DEFINED IS  @Y30SSFR*/ 07050000
*                        /*  AN ALTERNATE INDEX, THEN        @Y30SSFR*/ 07051000
*                        /*  THEN CMS HAS PLACED THE VOLUME  @Y30SSFR*/ 07052000
*                        /*  SERIAL OF THE VOLUME TO BE      @Y30SSFR*/ 07053000
*                        /*  ALLOCATED IN THE WORK AREA.     @Y30SSFR*/ 07054000
*                        /*                                  @Y30SSFR*/ 07055000
*                        /********************************************/ 07056000
*                                                                  1595 07057000
*                        IF (FVTPTR(1) -> CTGFVTYP = CTGTAIX)      1595 07058000
*                          THEN                                    1595 07059000
@RF01590 L     @15,FVTPTR                                          1595 07060000
         CLI   CTGFVTYP(@15),C'G'                                  1595 07061000
         BNE   @RF01595                                            1595 07062000
*                            DO;                           /*@Y30SSFR*/ 07063000
*                                                                  1596 07064000
*                            /****************************************/ 07065000
*                            /*                              @Y30SSFR*/ 07066000
*                            /*  BUILD A FAKE VOLUMES LIST TO BE     */ 07067000
*                            /*  PASSED TO DALCPROC.         @Y30SSFR*/ 07068000
*                            /*  RESPECIFY THE VOLUME LIST   @Y30SSFR*/ 07069000
*                            /*  OVERLAY TO BE BASED ON VOLLSTPT     */ 07070000
*                            /*  AND ESTABLISH ADDRESSABILITY TO     */ 07071000
*                            /*  THE STORAGE FOR THE VOLUME LIST.    */ 07072000
*                            /*                              @Y30SSFR*/ 07073000
*                            /****************************************/ 07074000
*                                                                  1597 07075000
*                            RESPECIFY FLISTVOL BASED(VOLLSTPT);   1597 07076000
*                            VOLLSTPT = ADDR(VOLLSTOR);    /*@Y30SSFR*/ 07077000
*                                                                  1598 07078000
         LA    @14,VOLLSTOR                                        1598 07079000
         ST    @14,VOLLSTPT                                        1598 07080000
*                            /****************************************/ 07081000
*                            /*                              @Y30SSFR*/ 07082000
*                            /*  BUILD THE FAKE VOLUMES LIST AND     */ 07083000
*                            /*  CALL DALCPROC.              @Y30SSFR*/ 07084000
*                            /*                              @Y30SSFR*/ 07085000
*                            /****************************************/ 07086000
*                                                                  1599 07087000
*                            FLISTLN = LENGTH(FVOLSERL(1));/*@Y30SSFR*/ 07088000
         MVC   FLISTLN(2,@14),@CH00039                             1599 07089000
*                            FVOLSER(1) = CATRCWKA;        /*@Y30SSFR*/ 07090000
*                                                                  1600 07091000
         MVC   FVOLSER(6,@14),CATRCWKA                             1600 07092000
*                            CALL DALCPROC('A',VOLLSTPT,           1601 07093000
*                               FVTPTR(1) -> CTGFVIND,DALCINDX);   1601 07094000
*                                                                  1601 07095000
         LA    @14,@CC00811                                        1601 07096000
         ST    @14,@AL00001                                        1601 07097000
         LA    @14,VOLLSTPT                                        1601 07098000
         ST    @14,@AL00001+4                                      1601 07099000
         LA    @15,CTGFVIND(,@15)                                  1601 07100000
         ST    @15,@AL00001+8                                      1601 07101000
         LA    @15,DALCINDX                                        1601 07102000
         ST    @15,@AL00001+12                                     1601 07103000
         LA    @01,@AL00001                                        1601 07104000
         BAL   @14,DALCPROC                                        1601 07105000
*                            /****************************************/ 07106000
*                            /*                              @Y30SSFR*/ 07107000
*                            /*  TEST THE RETURN CODE FROM   @Y30SSFR*/ 07108000
*                            /*  DALCPROC.  IF IT IS NON-ZERO,       */ 07109000
*                            /*  INDICATE A FAILURE, AND RETURN      */ 07110000
*                            /*  TO THE CALLING PROCESSOR.   @Y30SSFR*/ 07111000
*                            /*                              @Y30SSFR*/ 07112000
*                            /****************************************/ 07113000
*                                                                  1602 07114000
*                            RESPECIFY RTNREG RSTD;                1602 07115000
*                            TESTRC = RTNREG;                      1603 07116000
         LR    TESTRC,RTNREG                                       1603 07117000
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSFR*/ 07118000
*                            IF TESTRC ^= 0                        1605 07119000
*                              THEN                                1605 07120000
         LTR   TESTRC,TESTRC                                       1605 07121000
         BZ    @RF01605                                            1605 07122000
*                                RETURN CODE(LASTCC12);    /*@Y30SSFR*/ 07123000
         LA    @15,12                                              1606 07124000
         L     @14,@SA00009                                        1606 07125000
         LM    @00,@12,@SA00009+8                                  1606 07126000
         BR    @14                                                 1606 07127000
*                            RESPECIFY FLISTVOL                    1607 07128000
*                               BASED(CTGFVVLT);           /*@Y30SSFR*/ 07129000
@RF01605 DS    0H                                                  1608 07130000
*                            END;                          /*@Y30SSFR*/ 07131000
*                                                                  1608 07132000
*                    /************************************************/ 07133000
*                    /*                                      @Y30SSFR*/ 07134000
*                    /*  IF THERE IS A DATA COMPONENT PRESENT,       */ 07135000
*                    /*  DYNAMICALLY ALLOCATE THE VOLUMES FROM       */ 07136000
*                    /*  THE VOLUMES LIST AT THE DATA LEVEL. @Y30SSFR*/ 07137000
*                    /*                                      @Y30SSFR*/ 07138000
*                    /************************************************/ 07139000
*                                                                  1609 07140000
*                    IF FVTPTR(2) ^= NULLPTR                       1609 07141000
*                      THEN                                        1609 07142000
@RF01595 SLR   @15,@15                                             1609 07143000
         L     @14,FVTPTR+4                                        1609 07144000
         CR    @14,@15                                             1609 07145000
         BE    @RF01609                                            1609 07146000
*                        IF (FVTPTR(2) -> CTGFVIND = NULLPTR)      1610 07147000
*                           & (FVTPTR(2) -> CTGFVVLT ^=            1610 07148000
*                           NULLPTR)                               1610 07149000
*                          THEN                                    1610 07150000
         C     @15,CTGFVIND(,@14)                                  1610 07151000
         BNE   @RF01610                                            1610 07152000
         C     @15,CTGFVVLT(,@14)                                  1610 07153000
         BE    @RF01610                                            1610 07154000
*                            DO;                           /*@Y30SSFR*/ 07155000
*                            CALL DALCPROC('A',                    1612 07156000
*                               FVTPTR(2) -> CTGFVVLT,             1612 07157000
*                               FVTPTR(2) -> CTGFVIND,             1612 07158000
*                               DALCINDX);                 /*@Y30SSFR*/ 07159000
         LA    @15,@CC00811                                        1612 07160000
         ST    @15,@AL00001                                        1612 07161000
         LA    @15,CTGFVVLT(,@14)                                  1612 07162000
         ST    @15,@AL00001+4                                      1612 07163000
         LA    @15,CTGFVIND(,@14)                                  1612 07164000
         ST    @15,@AL00001+8                                      1612 07165000
         LA    @15,DALCINDX                                        1612 07166000
         ST    @15,@AL00001+12                                     1612 07167000
         LA    @01,@AL00001                                        1612 07168000
         BAL   @14,DALCPROC                                        1612 07169000
*                            RESPECIFY RTNREG RSTD;                1613 07170000
*                            TESTRC = RTNREG;                      1614 07171000
         LR    TESTRC,RTNREG                                       1614 07172000
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSFR*/ 07173000
*                            IF TESTRC ^= 0                        1616 07174000
*                              THEN                                1616 07175000
         LTR   TESTRC,TESTRC                                       1616 07176000
         BZ    @RF01616                                            1616 07177000
*                                RETURN CODE(LASTCC12);    /*@Y30SSFR*/ 07178000
         LA    @15,12                                              1617 07179000
         L     @14,@SA00009                                        1617 07180000
         LM    @00,@12,@SA00009+8                                  1617 07181000
         BR    @14                                                 1617 07182000
*                            END;                          /*@Y30SSFR*/ 07183000
*                                                                  1618 07184000
@RF01616 DS    0H                                                  1619 07185000
*                    /************************************************/ 07186000
*                    /*                                      @Y30SSFR*/ 07187000
*                    /*  IF THERE IS AN INDEX COMPONENT PRESENT,     */ 07188000
*                    /*  DYNAMICALLY ALLOCATE THE VOLUMES FROM       */ 07189000
*                    /*  THE VOLUMES LIST AT THE INDEX LEVEL.        */ 07190000
*                    /*                                      @Y30SSFR*/ 07191000
*                    /************************************************/ 07192000
*                                                                  1619 07193000
*                    IF FVTPTR(3) ^= NULLPTR                       1619 07194000
*                      THEN                                        1619 07195000
@RF01610 DS    0H                                                  1619 07196000
@RF01609 SLR   @15,@15                                             1619 07197000
         L     @14,FVTPTR+8                                        1619 07198000
         CR    @14,@15                                             1619 07199000
         BE    @RF01619                                            1619 07200000
*                        IF (FVTPTR(3) -> CTGFVIND = NULLPTR)      1620 07201000
*                           & (FVTPTR(3) -> CTGFVVLT ^=            1620 07202000
*                           NULLPTR)                               1620 07203000
*                          THEN                                    1620 07204000
         C     @15,CTGFVIND(,@14)                                  1620 07205000
         BNE   @RF01620                                            1620 07206000
         C     @15,CTGFVVLT(,@14)                                  1620 07207000
         BE    @RF01620                                            1620 07208000
*                            DO;                           /*@Y30SSFR*/ 07209000
*                            CALL DALCPROC('A',                    1622 07210000
*                               FVTPTR(3) -> CTGFVVLT,             1622 07211000
*                               FVTPTR(3) -> CTGFVIND,             1622 07212000
*                               DALCINDX);                 /*@Y30SSFR*/ 07213000
         LA    @15,@CC00811                                        1622 07214000
         ST    @15,@AL00001                                        1622 07215000
         LA    @15,CTGFVVLT(,@14)                                  1622 07216000
         ST    @15,@AL00001+4                                      1622 07217000
         LA    @15,CTGFVIND(,@14)                                  1622 07218000
         ST    @15,@AL00001+8                                      1622 07219000
         LA    @15,DALCINDX                                        1622 07220000
         ST    @15,@AL00001+12                                     1622 07221000
         LA    @01,@AL00001                                        1622 07222000
         BAL   @14,DALCPROC                                        1622 07223000
*                            RESPECIFY RTNREG RSTD;                1623 07224000
*                            TESTRC = RTNREG;                      1624 07225000
         LR    TESTRC,RTNREG                                       1624 07226000
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSFR*/ 07227000
*                            IF TESTRC ^= 0                        1626 07228000
*                              THEN                                1626 07229000
         LTR   TESTRC,TESTRC                                       1626 07230000
         BZ    @RF01626                                            1626 07231000
*                                RETURN CODE(LASTCC12);    /*@Y30SSFR*/ 07232000
         LA    @15,12                                              1627 07233000
         L     @14,@SA00009                                        1627 07234000
         LM    @00,@12,@SA00009+8                                  1627 07235000
         BR    @14                                                 1627 07236000
*                            END;                          /*@Y30SSFR*/ 07237000
*                        END DEFCALLC;                     /*@Y30SSFR*/ 07238000
*                      ELSE                                        1630 07239000
*DEFPALLC:               DO;                               /*@Y30SSFR*/ 07240000
*                                                                  1630 07241000
         B     @RC01580                                            1630 07242000
@RF01580 DS    0H                                                  1630 07243000
DEFPALLC DS    0H                                                  1631 07244000
*                        /********************************************/ 07245000
*                        /*                                  @Y30SSFR*/ 07246000
*                        /*  HANDLE 140-40 FOR PATHS.        @Y30SSFR*/ 07247000
*                        /*                                  @Y30SSFR*/ 07248000
*                        /********************************************/ 07249000
*                                                                  1631 07250000
*                        CTGPL = PSAVCPL;                  /*@Y30SSFR*/ 07251000
*                                                                  1631 07252000
         L     @15,CTGPLPTR                                        1631 07253000
         MVC   CTGPL(28,@15),PSAVCPL                               1631 07254000
*                        /********************************************/ 07255000
*                        /*                                  @Y30SSFR*/ 07256000
*                        /*  SET CTGFVT TO POINT TO THE FVT  @Y30SSFR*/ 07257000
*                        /*  FOR THE PATH DEFINE OPERATION.  @Y30SSFR*/ 07258000
*                        /*                                  @Y30SSFR*/ 07259000
*                        /********************************************/ 07260000
*                                                                  1632 07261000
*                        CTGFVT = PFVTPTR;                 /*@Y30SSFR*/ 07262000
*                                                                  1632 07263000
         L     @14,PFVTPTR                                         1632 07264000
         ST    @14,CTGFVT(,@15)                                    1632 07265000
*                        /********************************************/ 07266000
*                        /*                                  #Y30SSFR*/ 07267000
*                        /*  IF THE OBJECT BEING DEFINED IS  #Y30SSFR*/ 07268000
*                        /*  A PATH, THEN                    #Y30SSFR*/ 07269000
*                        /*  THEN CMS HAS PLACED THE VOLUME  #Y30SSFR*/ 07270000
*                        /*  SERIAL OF THE VOLUME TO BE      #Y30SSFR*/ 07271000
*                        /*  ALLOCATED IN THE WORK AREA.     #Y30SSFR*/ 07272000
*                        /*                                  #Y30SSFR*/ 07273000
*                        /********************************************/ 07274000
*                                                                  1633 07275000
*                        IF (PFVTPTR -> CTGFVTYP = CTGTPTH)        1633 07276000
*                          THEN                                    1633 07277000
         CLI   CTGFVTYP(@14),C'R'                                  1633 07278000
         BNE   @RF01633                                            1633 07279000
*                            DO;                           /*#Y30SSFR*/ 07280000
*                                                                  1634 07281000
*                            /****************************************/ 07282000
*                            /*                              #Y30SSFR*/ 07283000
*                            /*  BUILD A FAKE VOLUMES LIST TO BE     */ 07284000
*                            /*  PASSED TO DALCPROC.         #Y30SSFR*/ 07285000
*                            /*  RESPECIFY THE VOLUME LIST   #Y30SSFR*/ 07286000
*                            /*  OVERLAY TO BE BASED ON VOLLSTPT     */ 07287000
*                            /*  AND ESTABLISH ADDRESSABILITY TO     */ 07288000
*                            /*  THE STORAGE FOR THE VOLUME LIST.    */ 07289000
*                            /*                              #Y30SSFR*/ 07290000
*                            /****************************************/ 07291000
*                                                                  1635 07292000
*                            RESPECIFY FLISTVOL BASED(VOLLSTPT);   1635 07293000
*                            VOLLSTPT = ADDR(VOLLSTOR);    /*#Y30SSFR*/ 07294000
*                                                                  1636 07295000
         LA    @15,VOLLSTOR                                        1636 07296000
         ST    @15,VOLLSTPT                                        1636 07297000
*                            /****************************************/ 07298000
*                            /*                              #Y30SSFR*/ 07299000
*                            /*  BUILD THE FAKE VOLUMES LIST AND     */ 07300000
*                            /*  CALL DALCPROC.              #Y30SSFR*/ 07301000
*                            /*                              #Y30SSFR*/ 07302000
*                            /****************************************/ 07303000
*                                                                  1637 07304000
*                            FLISTLN = LENGTH(FVOLSERL(1));/*#Y30SSFR*/ 07305000
         MVC   FLISTLN(2,@15),@CH00039                             1637 07306000
*                            FVOLSER(1) = CATRCWKA;        /*#Y30SSFR*/ 07307000
*                                                                  1638 07308000
         MVC   FVOLSER(6,@15),CATRCWKA                             1638 07309000
*                            CALL DALCPROC('A',VOLLSTPT,           1639 07310000
*                               PFVTPTR -> CTGFVIND,DALCINDX);     1639 07311000
*                                                                  1639 07312000
         LA    @15,@CC00811                                        1639 07313000
         ST    @15,@AL00001                                        1639 07314000
         LA    @15,VOLLSTPT                                        1639 07315000
         ST    @15,@AL00001+4                                      1639 07316000
         LA    @15,CTGFVIND(,@14)                                  1639 07317000
         ST    @15,@AL00001+8                                      1639 07318000
         LA    @15,DALCINDX                                        1639 07319000
         ST    @15,@AL00001+12                                     1639 07320000
         LA    @01,@AL00001                                        1639 07321000
         BAL   @14,DALCPROC                                        1639 07322000
*                            /****************************************/ 07323000
*                            /*                              #Y30SSFR*/ 07324000
*                            /*  TEST THE RETURN CODE FROM   #Y30SSFR*/ 07325000
*                            /*  DALCPROC.  IF IT IS NON-ZERO,       */ 07326000
*                            /*  INDICATE A FAILURE, AND RETURN      */ 07327000
*                            /*  TO THE CALLING PROCESSOR.   #Y30SSFR*/ 07328000
*                            /*                              #Y30SSFR*/ 07329000
*                            /****************************************/ 07330000
*                                                                  1640 07331000
*                            RESPECIFY RTNREG RSTD;                1640 07332000
*                            TESTRC = RTNREG;                      1641 07333000
         LR    TESTRC,RTNREG                                       1641 07334000
*                            RESPECIFY RTNREG UNRSTD;      /*#Y30SSFR*/ 07335000
*                            IF TESTRC ^= 0                        1643 07336000
*                              THEN                                1643 07337000
         LTR   TESTRC,TESTRC                                       1643 07338000
         BZ    @RF01643                                            1643 07339000
*                                RETURN CODE(LASTCC12);    /*#Y30SSFR*/ 07340000
         LA    @15,12                                              1644 07341000
         L     @14,@SA00009                                        1644 07342000
         LM    @00,@12,@SA00009+8                                  1644 07343000
         BR    @14                                                 1644 07344000
*                            RESPECIFY FLISTVOL                    1645 07345000
*                               BASED(CTGFVVLT);           /*#Y30SSFR*/ 07346000
@RF01643 DS    0H                                                  1646 07347000
*                            END;                          /*#Y30SSFR*/ 07348000
*                        END DEFPALLC;                     /*#Y30SSFR*/ 07349000
*                                                                  1647 07350000
@RF01633 DS    0H                                                  1648 07351000
*                /****************************************************/ 07352000
*                /*                                          #Y30SSFR*/ 07353000
*                /*  NOW CALL VSAM CATALOG MANAGEMENT AGAIN. #Y30SSFR*/ 07354000
*                /*                                          #Y30SSFR*/ 07355000
*                /****************************************************/ 07356000
*                                                                  1648 07357000
*                CALL IDCSACA0(GDTTBL,SCPLPTR);            /*#Y30SSFR*/ 07358000
*                                                                  1648 07359000
@RC01580 L     @15,@PC00001                                        1648 07360000
         ST    @15,@AL00001                                        1648 07361000
         L     @14,@PC00009                                        1648 07362000
         ST    @14,@AL00001+4                                      1648 07363000
         L     @15,GDTCAT(,@15)                                    1648 07364000
         LA    @01,@AL00001                                        1648 07365000
         BALR  @14,@15                                             1648 07366000
*                RESPECIFY REG15 RSTD;                     /*#Y30SSFR*/ 07367000
*                CATLGRC = REG15;                          /*#Y30SSFR*/ 07368000
         STH   REG15,CATLGRC                                       1650 07369000
*                RESPECIFY REG15 UNRSTD;                   /*#Y30SSFR*/ 07370000
*                                                                  1651 07371000
*                /****************************************************/ 07372000
*                /*                                          #Y30SSFR*/ 07373000
*                /*  CALL DALCPROC TO DYNAMICALLY UNALLOCATE #Y30SSFR*/ 07374000
*                /*  THE VOLUMES ALLOCATED.                  #Y30SSFR*/ 07375000
*                /*                                          #Y30SSFR*/ 07376000
*                /****************************************************/ 07377000
*                                                                  1652 07378000
*                CALL DALCPROC('D',NULLPARM,NULLPARM,              1652 07379000
*                   DALCINDX);                             /*#Y30SSFR*/ 07380000
         MVC   @AL00001(12),@AL01652                               1652 07381000
         LA    @15,DALCINDX                                        1652 07382000
         ST    @15,@AL00001+12                                     1652 07383000
         LA    @01,@AL00001                                        1652 07384000
         BAL   @14,DALCPROC                                        1652 07385000
*                RESPECIFY RTNREG RSTD;                            1653 07386000
*                TESTRC = RTNREG;                                  1654 07387000
         LR    TESTRC,RTNREG                                       1654 07388000
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/ 07389000
*                IF TESTRC ^= 0                                    1656 07390000
*                  THEN                                            1656 07391000
         LTR   TESTRC,TESTRC                                       1656 07392000
         BZ    @RF01656                                            1656 07393000
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/ 07394000
         LA    @15,12                                              1657 07395000
         L     @14,@SA00009                                        1657 07396000
         LM    @00,@12,@SA00009+8                                  1657 07397000
         BR    @14                                                 1657 07398000
*                END DEFALLC;                              /*#Y30SSFR*/ 07399000
*                                                                  1658 07400000
@RF01656 DS    0H                                                  1659 07401000
*        IF CATLGRC ^= 0 &                                 /*#Y30SSFR*/ 07402000
*             (IMPF2NER = OFF | CATLGRC ^= DUPNAME)        /*#Y30SSFR*/ 07403000
*          THEN                                            /*#Y30SSFR*/ 07404000
@RF01578 DS    0H                                                  1659 07405000
@RC01558 DS    0H                                                  1659 07406000
@RF01557 LH    @15,CATLGRC                                         1659 07407000
         LTR   @15,@15                                             1659 07408000
         BZ    @RF01659                                            1659 07409000
         TM    IMPF2NER,B'00001000'                                1659 07410000
         BZ    @RT01659                                            1659 07411000
         C     @15,@CF00039                                        1659 07412000
         BE    @RF01659                                            1659 07413000
@RT01659 DS    0H                                                  1660 07414000
*ERCALL1:    DO;                                           /*#Y30SSFR*/ 07415000
*                                                                  1660 07416000
ERCALL1  DS    0H                                                  1661 07417000
*            /********************************************************/ 07418000
*            /*                                              #Y30SSFR*/ 07419000
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     #Y30SSFR*/ 07420000
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/ 07421000
*            /*                                              #Y30SSFR*/ 07422000
*            /********************************************************/ 07423000
*                                                                  1661 07424000
*            ERRORTAB = ''B;                               /*#Y30SSFR*/ 07425000
*                                                                  1661 07426000
         XC    ERRORTAB(32),ERRORTAB                               1661 07427000
*            /********************************************************/ 07428000
*            /*                                              #Y30SSFR*/ 07429000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    #Y30SSFR*/ 07430000
*            /*  THE ERROR CONVERSION TABLE.                 #Y30SSFR*/ 07431000
*            /*                                              #Y30SSFR*/ 07432000
*            /********************************************************/ 07433000
*                                                                  1662 07434000
*            ERCNVADR = ADDR(ERRORTAB);                    /*#Y30SSFR*/ 07435000
*                                                                  1662 07436000
         LA    @15,ERRORTAB                                        1662 07437000
         ST    @15,ERCNVADR                                        1662 07438000
*            /********************************************************/ 07439000
*            /*                                              #Y30SSFR*/ 07440000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  #Y30SSFR*/ 07441000
*            /*  IS A CATALOG ERROR.  DETERMINE THE CMS      #Y30SSFR*/ 07442000
*            /*  FUNCTION BEING PERFORMED, AND SET THE       #Y30SSFR*/ 07443000
*            /*  APPROPRIATE EROPER BIT.                     #Y30SSFR*/ 07444000
*            /*                                              #Y30SSFR*/ 07445000
*            /********************************************************/ 07446000
*                                                                  1663 07447000
*            ERCATLG = ON;                                 /*#Y30SSFR*/ 07448000
         OI    ERCATLG(@15),B'10000000'                            1663 07449000
*            IF CTGFUNC = CTGLOC                                   1664 07450000
*              THEN                                                1664 07451000
*                                                                  1664 07452000
         L     @01,CTGPLPTR                                        1664 07453000
         TM    CTGFUNC(@01),B'00100000'                            1664 07454000
         BNO   @RF01664                                            1664 07455000
         TM    CTGFUNC(@01),B'11000000'                            1664 07456000
         BNZ   @RF01664                                            1664 07457000
*                /****************************************************/ 07458000
*                /*                                          #Y30SSFR*/ 07459000
*                /*  THE OPERATION WAS A LOCATE.  SET        #Y30SSFR*/ 07460000
*                /*  ERCATLC.                                #Y30SSFR*/ 07461000
*                /*                                          #Y30SSFR*/ 07462000
*                /****************************************************/ 07463000
*                                                                  1665 07464000
*                ERCATLC = ON;                             /*#Y30SSFR*/ 07465000
         OI    ERCATLC(@15),B'10000000'                            1665 07466000
*              ELSE                                                1666 07467000
*                IF CTGOPTNS = CTGALTER                            1666 07468000
*                  THEN                                            1666 07469000
*                                                                  1666 07470000
         B     @RC01664                                            1666 07471000
@RF01664 L     @01,CTGPLPTR                                        1666 07472000
         TM    CTGOPTNS(@01),B'00010000'                           1666 07473000
         BNO   @RF01666                                            1666 07474000
         TM    CTGOPTNS(@01),B'11101000'                           1666 07475000
         BNZ   @RF01666                                            1666 07476000
*                    /************************************************/ 07477000
*                    /*                                      #Y30SSFR*/ 07478000
*                    /*  THE CATALOG OPERATION IS AN ALTER.  #Y30SSFR*/ 07479000
*                    /*  SET ERCATAL TO BE ON.               #Y30SSFR*/ 07480000
*                    /*                                      #Y30SSFR*/ 07481000
*                    /************************************************/ 07482000
*                                                                  1667 07483000
*                    ERCATAL = ON;                         /*#Y30SSFR*/ 07484000
         L     @01,ERCNVADR                                        1667 07485000
         OI    ERCATAL(@01),B'00010000'                            1667 07486000
*                  ELSE                                            1668 07487000
*                    IF CTGOPTNS = CTGDEFIN                        1668 07488000
*                      THEN                                        1668 07489000
*                                                                  1668 07490000
         B     @RC01666                                            1668 07491000
@RF01666 L     @01,CTGPLPTR                                        1668 07492000
         TM    CTGOPTNS(@01),B'00001000'                           1668 07493000
         BNO   @RF01668                                            1668 07494000
         TM    CTGOPTNS(@01),B'11110000'                           1668 07495000
         BNZ   @RF01668                                            1668 07496000
*                        /********************************************/ 07497000
*                        /*                                  #Y30SSFR*/ 07498000
*                        /*  THE CATALOG OPERATION WAS A     #Y30SSFR*/ 07499000
*                        /*  DEFINE.  SET ERCATDE TO BE      #Y30SSFR*/ 07500000
*                        /*  ON.                             #Y30SSFR*/ 07501000
*                        /*                                  #Y30SSFR*/ 07502000
*                        /********************************************/ 07503000
*                                                                  1669 07504000
*                        ERCATDE = ON;                     /*#Y30SSFR*/ 07505000
*                                                                  1669 07506000
         L     @01,ERCNVADR                                        1669 07507000
         OI    ERCATDE(@01),B'01000000'                            1669 07508000
*            /********************************************************/ 07509000
*            /*                                              #Y30SSFR*/ 07510000
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  #Y30SSFR*/ 07511000
*            /*  POINT TO THE CPL FOR THE CATALOG OPERATION. #Y30SSFR*/ 07512000
*            /*                                              #Y30SSFR*/ 07513000
*            /********************************************************/ 07514000
*                                                                  1670 07515000
*            ERCATRC = CATLGRC;                            /*#Y30SSFR*/ 07516000
@RF01668 DS    0H                                                  1670 07517000
@RC01666 DS    0H                                                  1670 07518000
@RC01664 L     @15,ERCNVADR                                        1670 07519000
         LH    @14,CATLGRC                                         1670 07520000
         ST    @14,ERCATRC(,@15)                                   1670 07521000
*            ERCPLPT = CTGPLPTR;                           /*#Y30SSFR*/ 07522000
*                                                                  1671 07523000
         L     @14,CTGPLPTR                                        1671 07524000
         ST    @14,ERCPLPT(,@15)                                   1671 07525000
*            /********************************************************/ 07526000
*            /*                                              #Y30SSFR*/ 07527000
*            /*  SET A POINTER TO THE ENTRY NAME IN THE      #Y30SSFR*/ 07528000
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/ 07529000
*            /*                                              #Y30SSFR*/ 07530000
*            /********************************************************/ 07531000
*                                                                  1672 07532000
*            IF ERCATLC = ON                               /*#Y30SSFR*/ 07533000
*              THEN                                        /*#Y30SSFR*/ 07534000
         TM    ERCATLC(@15),B'10000000'                            1672 07535000
         BNO   @RF01672                                            1672 07536000
*                ERDSNM = CTGENT;                          /*#Y30SSFR*/ 07537000
         L     @14,CTGENT(,@14)                                    1673 07538000
         ST    @14,ERDSNM(,@15)                                    1673 07539000
*              ELSE                                        /*#Y30SSFR*/ 07540000
*                ERDSNM = CTGFVT -> CTGFVENT;              /*#Y30SSFR*/ 07541000
*                                                                  1674 07542000
         B     @RC01672                                            1674 07543000
@RF01672 L     @01,CTGPLPTR                                        1674 07544000
         L     @01,CTGFVT(,@01)                                    1674 07545000
         L     @15,CTGFVENT(,@01)                                  1674 07546000
         L     @14,ERCNVADR                                        1674 07547000
         ST    @15,ERDSNM(,@14)                                    1674 07548000
*            /********************************************************/ 07549000
*            /*                                              #Y30SSFR*/ 07550000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    #Y30SSFR*/ 07551000
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     #Y30SSFR*/ 07552000
*            /*                                              #Y30SSFR*/ 07553000
*            /********************************************************/ 07554000
*                                                                  1675 07555000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*#Y30SSFR*/ 07556000
@RC01672 L     @15,@PC00001                                        1675 07557000
         ST    @15,@AL00001                                        1675 07558000
         LA    @14,ERCNVADR                                        1675 07559000
         ST    @14,@AL00001+4                                      1675 07560000
         MVI   @AL00001+4,X'80'                                    1675 07561000
         L     @15,GDTERR(,@15)                                    1675 07562000
         LA    @01,@AL00001                                        1675 07563000
         BALR  @14,@15                                             1675 07564000
*            END ERCALL1;                                  /*#Y30SSFR*/ 07565000
*                                                                  1676 07566000
*        /************************************************************/ 07567000
*        /*                                                          */ 07568000
*        /*  RETURN TO CALLER, INDICATING THE RESULT.        #Y30SSFR*/ 07569000
*        /*                                                          */ 07570000
*        /************************************************************/ 07571000
*                                                                  1677 07572000
*        IF CATLGRC ^= 0                                   /*#Y30SSFR*/ 07573000
*          THEN                                            /*#Y30SSFR*/ 07574000
@RF01659 LH    @15,CATLGRC                                         1677 07575000
         LTR   @15,@15                                             1677 07576000
         BZ    @RF01677                                            1677 07577000
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/ 07578000
         LA    @15,12                                              1678 07579000
         L     @14,@SA00009                                        1678 07580000
         LM    @00,@12,@SA00009+8                                  1678 07581000
         BR    @14                                                 1678 07582000
*          ELSE                                            /*#Y30SSFR*/ 07583000
*            RETURN CODE(0);                               /*#Y30SSFR*/ 07584000
*                                                                  1679 07585000
@RF01677 SLR   @15,@15                                             1679 07586000
         L     @14,@SA00009                                        1679 07587000
         LM    @00,@12,@SA00009+8                                  1679 07588000
         BR    @14                                                 1679 07589000
*END CTLGPROC;                                                     1680 07590000
*        /************************************************************/ 07591000
*        /*                                                  #Y30SSFR*/ 07592000
*        /*  PROCEDURE NAME - DELTPROC                       #Y30SSFR*/ 07593000
*        /*                                                  #Y30SSFR*/ 07594000
*        /*  FUNCTION - PERFORMS ALL CALLS TO CATALOG        #Y30SSFR*/ 07595000
*        /*  DELETE.  WILL ITERATIVELY CALL CATALOG          #Y30SSFR*/ 07596000
*        /*  DELETE IF NECESSARY TO DELETE ALL OF THE        #Y30SSFR*/ 07597000
*        /*  OBJECT.                                         #Y30SSFR*/ 07598000
*        /*                                                  #Y30SSFR*/ 07599000
*        /*  INPUT - A POINTER TO A CPL                      #Y30SSFR*/ 07600000
*        /*                                                  #Y30SSFR*/ 07601000
*        /*  OUTPUT - A PRINTED LIST OF ITEMS DELETED AND    #Y30SSFR*/ 07602000
*        /*  ANY APPROPRIATE ERROR MESSAGES.                 #Y30SSFR*/ 07603000
*        /*                                                  #Y30SSFR*/ 07604000
*        /************************************************************/ 07605000
*                                                                  1681 07606000
*DELTPROC: PROCEDURE(DLCPLPTR);                            /*#Y30SSFR*/ 07607000
*                                                                  1681 07608000
DELTPROC STM   @14,@12,@SA00010                                    1681 07609000
         MVC   @PC00010(4),0(@01)                                  1681 07610000
*        /************************************************************/ 07611000
*        /*                                                  #Y30SSFR*/ 07612000
*        /*  ARGUMENTS OF INVOCATION                         #Y30SSFR*/ 07613000
*        /*                                                  #Y30SSFR*/ 07614000
*        /************************************************************/ 07615000
*                                                                  1682 07616000
*        DCL DLCPLPTR PTR(31);         /*POINTER TO THE CPL  #Y30SSFR*/ 07617000
*                                                                  1682 07618000
*        /************************************************************/ 07619000
*        /*                                                  #Y30SSFR*/ 07620000
*        /*  LOCAL DECLARATIONS                              #Y30SSFR*/ 07621000
*        /*                                                  #Y30SSFR*/ 07622000
*        /************************************************************/ 07623000
*                                                                  1683 07624000
*        DCL DSAVCPL CHAR(LENGTH(CTGPL));                  /*#Y30SSFR*/ 07625000
*                                      /*SAVE AREA FOR       #Y30SSFR*/ 07626000
*                                      /*DELETE CPL          #Y30SSFR*/ 07627000
*        DCL IX1 FIXED(31);            /*IX1 AND K ARE       #Y30SSFR*/ 07628000
*                                      /*USED FOR LOOP       #Y30SSFR*/ 07629000
*        DCL K FIXED(31);              /*CONTROL             #Y30SSFR*/ 07630000
*        DCL LIMIT FIXED(15);          /*MAXIMUM NUMBER OF   #Y30SSFR*/ 07631000
*                                      /*CATALOG ENTRIES     #Y30SSFR*/ 07632000
*                                      /*THAT WILL FIT INTO  #Y30SSFR*/ 07633000
*                                      /*THE CURRENT WORK    #Y30SSFR*/ 07634000
*                                      /*AREA                #Y30SSFR*/ 07635000
*        DCL COREFLAG BIT(1);          /*FLAG INDICATING     #Y30SSFR*/ 07636000
*                                      /*WHETHER CORE HAS    #Y30SSFR*/ 07637000
*                                      /*BEEN GOTTEN         #Y30SSFR*/ 07638000
*        DCL SIZENEED FIXED(31);       /*SIZE OF WORK AREA   #Y30SSFR*/ 07639000
*                                      /*NEEDED              #Y30SSFR*/ 07640000
*        DCL CURSIZE  FIXED(15);       /*CURRENT SIZE OF THE #Y30SSFR*/ 07641000
*                                      /*WORK AREA           #Y30SSFR*/ 07642000
*        DCL PLIMIT   FIXED(15);       /*NUMBER OF ENTRIES   #Y30SSFR*/ 07643000
*                                      /*TO BE PRINTED FROM  @Y30SSFR*/ 07644000
*                                      /*THE CMS WORKAREA    @Y30SSFR*/ 07645000
*                                                                  1691 07646000
*        OLDERID2 = NEWERID2;                                      1691 07647000
         L     @02,@PC00001                                        1691 07648000
         L     @15,GDTTR2(,@02)                                    1691 07649000
         MVC   @TS00001(95),NEWERID2(@15)                          1691 07650000
         MVC   OLDERID2(95,@15),@TS00001                           1691 07651000
*        NEWID2 = 'MPDL';                                  /*@Y30SSFR*/ 07652000
*                                                                  1692 07653000
         MVC   NEWID2(4,@15),@CC01455                              1692 07654000
*        /************************************************************/ 07655000
*        /*                                                  @Y30SSFR*/ 07656000
*        /*  INITIALIZE AND CALL CATALOG                     @Y30SSFR*/ 07657000
*        /*                                                  @Y30SSFR*/ 07658000
*        /************************************************************/ 07659000
*                                                                  1693 07660000
*        CTGPLPTR = DLCPLPTR;                              /*@Y30SSFR*/ 07661000
         L     @15,@PC00010                                        1693 07662000
         L     @14,DLCPLPTR(,@15)                                  1693 07663000
         ST    @14,CTGPLPTR                                        1693 07664000
*        DSAVCPL = CTGPL;                                  /*@Y30SSFR*/ 07665000
         MVC   DSAVCPL(28),CTGPL(@14)                              1694 07666000
*        LIMIT = (AREALN - 4) / LENGTH(ENTITEM);           /*@Y30SSFR*/ 07667000
         L     @01,CTGWKA(,@14)                                    1695 07668000
         LH    @14,AREALN(,@01)                                    1695 07669000
         LR    @00,@14                                             1695 07670000
         SL    @00,@CF00045                                        1695 07671000
         SRDA  @00,32                                              1695 07672000
         D     @00,@CF01384                                        1695 07673000
         LR    LIMIT,@01                                           1695 07674000
*        CURSIZE = AREALN;                                 /*@Y30SSFR*/ 07675000
         STH   @14,CURSIZE                                         1696 07676000
*        COREFLAG = OFF;                                   /*@Y30SSFR*/ 07677000
         NI    COREFLAG,B'01111111'                                1697 07678000
*        DARGSMOD = DELMSG;                                /*@Y30SSFR*/ 07679000
         L     @14,DDSTRU                                          1698 07680000
         MVC   DARGSMOD(3,@14),@CC01031                            1698 07681000
*        DARGSENT = ENTRYMSG;                              /*@Y30SSFR*/ 07682000
         MVI   DARGSENT(@14),X'01'                                 1699 07683000
*        CATRTNID = 'CATLGRTN';                            /*@Y30SSFR*/ 07684000
*                                                                  1700 07685000
         MVC   CATRTNID(8),@CC01429                                1700 07686000
*        CALL IDCSACA0(GDTTBL,DLCPLPTR);                   /*@Y30SSFR*/ 07687000
*                                                                  1701 07688000
         ST    @02,@AL00001                                        1701 07689000
         ST    @15,@AL00001+4                                      1701 07690000
         L     @15,GDTCAT(,@02)                                    1701 07691000
         LA    @01,@AL00001                                        1701 07692000
         BALR  @14,@15                                             1701 07693000
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/ 07694000
*        CATLGRC = REG15;                                  /*@Y30SSFR*/ 07695000
         STH   REG15,CATLGRC                                       1703 07696000
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/ 07697000
*                                                                  1704 07698000
*        IF GDTDBG = NULLPTR                                       1705 07699000
*          THEN;                                                   1705 07700000
         L     @02,@PC00001                                        1705 07701000
         L     @02,GDTDBG(,@02)                                    1705 07702000
         LTR   @02,@02                                             1705 07703000
         BZ    @RT01705                                            1705 07704000
*          ELSE                                                    1707 07705000
*            CALL IDCDB010(GDTTBL,'MPDC');                         1707 07706000
         L     @02,@PC00001                                        1707 07707000
         ST    @02,@AL00001                                        1707 07708000
         LA    @15,@CC01456                                        1707 07709000
         ST    @15,@AL00001+4                                      1707 07710000
         MVI   @AL00001+4,X'80'                                    1707 07711000
         L     @15,GDTDBG(,@02)                                    1707 07712000
         LA    @01,@AL00001                                        1707 07713000
         BALR  @14,@15                                             1707 07714000
*                                                          /*@Y30SSFR*/ 07715000
*                                                                  1708 07716000
*        /************************************************************/ 07717000
*        /*                                                  @Y30SSFR*/ 07718000
*        /*  RESTORE THE CPL.  TO PREVENT CATALOG FROM       @Y30SSFR*/ 07719000
*        /*  RE-ERASING THE OBJECT ON SUBSEQUENT CALLS,      @Y30SSFR*/ 07720000
*        /*  SET CTGOVRID TO ON AND CTGERASE TO OFF. THEN    @Y30SSFR*/ 07721000
*        /*  SAVE THE CPL AGAIN.                             @Y30SSFR*/ 07722000
*        /*                                                  @Y30SSFR*/ 07723000
*        /************************************************************/ 07724000
*                                                                  1708 07725000
*        IF (CATLGRC = RCWORKSM) | (CATLGRC = ALLORC1)     /*@Y30SSFR*/ 07726000
*           | (CATLGRC = ALLORC2) | (CATLGRC = ALLORC3)    /*@Y30SSFR*/ 07727000
*          THEN                                            /*@Y30SSFR*/ 07728000
@RT01705 LH    @02,CATLGRC                                         1708 07729000
         C     @02,@CF01151                                        1708 07730000
         BE    @RT01708                                            1708 07731000
         C     @02,@CF01153                                        1708 07732000
         BE    @RT01708                                            1708 07733000
         C     @02,@CF01161                                        1708 07734000
         BE    @RT01708                                            1708 07735000
         C     @02,@CF01155                                        1708 07736000
         BNE   @RF01708                                            1708 07737000
@RT01708 DS    0H                                                  1709 07738000
*            DO;                                           /*@Y30SSFR*/ 07739000
*            CTGPL = DSAVCPL;                              /*@Y30SSFR*/ 07740000
         L     @02,CTGPLPTR                                        1710 07741000
         MVC   CTGPL(28,@02),DSAVCPL                               1710 07742000
*            CTGERASE = OFF;                               /*@Y30SSFR*/ 07743000
*            CTGOVRID = ON;                                /*@Y30SSFR*/ 07744000
         OI    CTGOVRID(@02),B'00000100'                           1712 07745000
         NI    CTGERASE(@02),B'10111111'                           1712 07746000
*            DSAVCPL = CTGPL;                              /*@Y30SSFR*/ 07747000
         MVC   DSAVCPL(28),CTGPL(@02)                              1713 07748000
*            END;                                          /*@Y30SSFR*/ 07749000
*                                                                  1714 07750000
*        /************************************************************/ 07751000
*        /*                                                  #Y30SSFR*/ 07752000
*        /*  IF VSAM CATALOG RETURNS A CODE OF 40, LOOP      #Y30SSFR*/ 07753000
*        /*  DELETING OBJECTS AND PRINTING THEM.  GET A      #Y30SSFR*/ 07754000
*        /*  LARGER WORK AREA AS NEEDED.                     #Y30SSFR*/ 07755000
*        /*  IF VSAM CATALOG RETURNS A CODE OF 72, 76 OR ONE @Y30SSFR*/ 07756000
*        /*  OF 240, SOMETHING MUST BE DYNAMICALLY           #Y30SSFR*/ 07757000
*        /*  ALLOCATED.  LOOP PRINTING NAMES FROM THE        #Y30SSFR*/ 07758000
*        /*  WORKAREA, AND CALLING CATALOG, ALLOCATING       #Y30SSFR*/ 07759000
*        /*  OBJECTS NEEDED.                                 #Y30SSFR*/ 07760000
*        /*                                                  #Y30SSFR*/ 07761000
*        /************************************************************/ 07762000
*                                                                  1715 07763000
*DELLP:  DO WHILE (CATLGRC = RCWORKSM) |                   /*#Y30SSFR*/ 07764000
*            (CATLGRC = ALLORC1) | (CATLGRC = ALLORC2)     /*@Y30SSFR*/ 07765000
*            | (CATLGRC = ALLORC3);                        /*@Y30SSFR*/ 07766000
*                                                                  1715 07767000
@RF01708 DS    0H                                                  1715 07768000
DELLP    B     @DE01715                                            1715 07769000
@DL01715 DS    0H                                                  1716 07770000
*          IX1 = 1;                                        /*#Y30SSFR*/ 07771000
*                                                                  1716 07772000
         LA    IX1,1                                               1716 07773000
*          /**********************************************************/ 07774000
*          /*                                                #Y30SSFR*/ 07775000
*          /*  IF THE VSAM CATALOG RETURN CODE WAS 72 OR 76, @Y30SSFR*/ 07776000
*          /*  ADJUST THE VALUE OF PLIMIT,  THE NUMBER OF    #Y30SSFR*/ 07777000
*          /*  ENTRIES TO BE PRINTED FROM THE CMS WORKAREA   #Y30SSFR*/ 07778000
*          /*  SO THAT THE OBJECT TO BE ALLOCATED AND ITS    #Y30SSFR*/ 07779000
*          /*  ASSOCIATIONS DO NOT GET PRINTED.              #Y30SSFR*/ 07780000
*          /*  IN ALL OTHER CASES, THE VALUE OF PLIMIT IS    #Y30SSFR*/ 07781000
*          /*  THE SIZE OF THE WORK AREA.                    #Y30SSFR*/ 07782000
*          /*                                                #Y30SSFR*/ 07783000
*          /**********************************************************/ 07784000
*                                                                  1717 07785000
*          IF (CATLGRC = ALLORC1) | (CATLGRC = ALLORC3)    /*@Y30SSFR*/ 07786000
*            THEN                                          /*#Y30SSFR*/ 07787000
         LH    @15,CATLGRC                                         1717 07788000
         C     @15,@CF01153                                        1717 07789000
         BE    @RT01717                                            1717 07790000
         C     @15,@CF01155                                        1717 07791000
         BNE   @RF01717                                            1717 07792000
@RT01717 DS    0H                                                  1718 07793000
*              PLIMIT = (RETURNLN - 4) / LENGTH(ENTITEM);  /*@Y30SSFR*/ 07794000
         L     @01,CTGPLPTR                                        1718 07795000
         L     @01,CTGWKA(,@01)                                    1718 07796000
         LH    @00,RETURNLN(,@01)                                  1718 07797000
         SL    @00,@CF00045                                        1718 07798000
         SRDA  @00,32                                              1718 07799000
         D     @00,@CF01384                                        1718 07800000
         LR    PLIMIT,@01                                          1718 07801000
*            ELSE                                          /*#Y30SSFR*/ 07802000
*              PLIMIT = LIMIT;                             /*#Y30SSFR*/ 07803000
*                                                                  1719 07804000
         B     @RC01717                                            1719 07805000
@RF01717 LR    PLIMIT,LIMIT                                        1719 07806000
*          /**********************************************************/ 07807000
*          /*                                                #Y30SSFR*/ 07808000
*          /*  LOOP THROUGH THE CATALOG WORK AREA, PRINTING  #Y30SSFR*/ 07809000
*          /*  THE NAMES OF THE OBJECTS DELETED.             #Y30SSFR*/ 07810000
*          /*                                                #Y30SSFR*/ 07811000
*          /**********************************************************/ 07812000
*                                                                  1720 07813000
*          DO WHILE IX1 <= PLIMIT & ENTRYTYP(IX1) ^= 0;    /*#Y30SSFR*/ 07814000
@RC01717 B     @DE01720                                            1720 07815000
@DL01720 DS    0H                                                  1721 07816000
*            DARGDBP = ADDR(ENTLIST(IX1));                 /*#Y30SSFR*/ 07817000
         L     @05,DDSTRU                                          1721 07818000
         LA    @15,45                                              1721 07819000
         LR    @01,IX1                                             1721 07820000
         MR    @00,@15                                             1721 07821000
         L     @14,CTGPLPTR                                        1721 07822000
         L     @14,CTGWKA(,@14)                                    1721 07823000
         AL    @14,@CF01706                                        1721 07824000
         LA    @14,ENTLIST-4(@01,@14)                              1721 07825000
         ST    @14,DARGDBP(,@05)                                   1721 07826000
*            DARGILP = LENGTH(ENTLIST(1));                 /*#Y30SSFR*/ 07827000
         STH   @15,DARGILP(,@05)                                   1722 07828000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*#Y30SSFR*/ 07829000
         L     @05,@PC00001                                        1723 07830000
         ST    @05,@AL00001                                        1723 07831000
         LA    @15,@CF00118                                        1723 07832000
         ST    @15,@AL00001+4                                      1723 07833000
         LA    @15,DDSTRU                                          1723 07834000
         ST    @15,@AL00001+8                                      1723 07835000
         MVI   @AL00001+8,X'80'                                    1723 07836000
         L     @15,GDTPRT(,@05)                                    1723 07837000
         LA    @01,@AL00001                                        1723 07838000
         BALR  @14,@15                                             1723 07839000
*            IX1 = IX1 + 1;                                /*#Y30SSFR*/ 07840000
         AL    IX1,@CF00221                                        1724 07841000
*          END;                                            /*#Y30SSFR*/ 07842000
*                                                                  1725 07843000
@DE01720 CR    IX1,PLIMIT                                          1725 07844000
         BH    @DC01720                                            1725 07845000
         LR    @05,IX1                                             1725 07846000
         MH    @05,@CH01384                                        1725 07847000
         L     @01,CTGPLPTR                                        1725 07848000
         L     @01,CTGWKA(,@01)                                    1725 07849000
         AL    @01,@CF01706                                        1725 07850000
         SLR   @00,@00                                             1725 07851000
         IC    @00,ENTRYTYP-4(@05,@01)                             1725 07852000
         C     @00,@CF00118                                        1725 07853000
         BNE   @DL01720                                            1725 07854000
@DC01720 DS    0H                                                  1726 07855000
*          /**********************************************************/ 07856000
*          /*                                                #Y30SSFR*/ 07857000
*          /*  RESTORE THE CPL FOR THE NEXT CALL TO CATALOG. #Y30SSFR*/ 07858000
*          /*                                                #Y30SSFR*/ 07859000
*          /**********************************************************/ 07860000
*                                                                  1726 07861000
*          CTGPL = DSAVCPL;                                /*#Y30SSFR*/ 07862000
*                                                                  1726 07863000
         L     @05,CTGPLPTR                                        1726 07864000
         MVC   CTGPL(28,@05),DSAVCPL                               1726 07865000
*          /**********************************************************/ 07866000
*          /*                                                #Y30SSFR*/ 07867000
*          /*  TEST FOR A VSAM CATALOG RETURN CODE OF 40.    #Y30SSFR*/ 07868000
*          /*                                                #Y30SSFR*/ 07869000
*          /**********************************************************/ 07870000
*                                                                  1727 07871000
*          IF CATLGRC = RCWORKSM                           /*#Y30SSFR*/ 07872000
*            THEN                                          /*#Y30SSFR*/ 07873000
         CLC   CATLGRC(2),@CH01151                                 1727 07874000
         BNE   @RF01727                                            1727 07875000
*MORESP:       DO;                                         /*#Y30SSFR*/ 07876000
*                                                                  1728 07877000
*                                                                  1728 07878000
MORESP   DS    0H                                                  1729 07879000
*              /******************************************************/ 07880000
*              /*                                            #Y30SSFR*/ 07881000
*              /*  COMPUTE THE AMOUNT OF SPACE NEEDED BY CMS #Y30SSFR*/ 07882000
*              /*  TO CONTINUE WITH THE DELETE               #Y30SSFR*/ 07883000
*              /*                                            #Y30SSFR*/ 07884000
*              /******************************************************/ 07885000
*                                                                  1729 07886000
*              SIZENEED = RETURNLN - (LENGTH(ENTITEM) *    /*#Y30SSFR*/ 07887000
*                (IX1 - 1));                               /*#Y30SSFR*/ 07888000
*                                                                  1729 07889000
         L     @15,CTGPLPTR                                        1729 07890000
         L     @01,CTGWKA(,@15)                                    1729 07891000
         LR    @00,IX1                                             1729 07892000
         BCTR  @00,0                                               1729 07893000
         MH    @00,@CH01384                                        1729 07894000
         LCR   @00,@00                                             1729 07895000
         AH    @00,RETURNLN(,@01)                                  1729 07896000
         ST    @00,SIZENEED                                        1729 07897000
*              /******************************************************/ 07898000
*              /*                                            #Y30SSFR*/ 07899000
*              /*  COMPARE THE AMOUNT OF CORE NEEDED WITH    #Y30SSFR*/ 07900000
*              /*  THAT AVAILABLE, AND GET A LARGER WORK     #Y30SSFR*/ 07901000
*              /*  AREA IF NEEDED.                           #Y30SSFR*/ 07902000
*              /*                                            #Y30SSFR*/ 07903000
*              /******************************************************/ 07904000
*                                                                  1730 07905000
*              IF SIZENEED > CURSIZE                       /*#Y30SSFR*/ 07906000
*                THEN                                      /*#Y30SSFR*/ 07907000
         CH    @00,CURSIZE                                         1730 07908000
         BNH   @RF01730                                            1730 07909000
*                  DO;                                     /*#Y30SSFR*/ 07910000
*                                                                  1731 07911000
*                  /**************************************************/ 07912000
*                  /*                                        #Y30SSFR*/ 07913000
*                  /*  IF WE HAVE GOTTEN CORE PREVIOUSLY,    #Y30SSFR*/ 07914000
*                  /*  FREE IT PRIOR TO GETTING ANOTHER      #Y30SSFR*/ 07915000
*                  /*  WORK AREA.                            #Y30SSFR*/ 07916000
*                  /*                                        #Y30SSFR*/ 07917000
*                  /**************************************************/ 07918000
*                                                                  1732 07919000
*                  IF COREFLAG = ON                        /*#Y30SSFR*/ 07920000
*                    THEN                                  /*#Y30SSFR*/ 07921000
         TM    COREFLAG,B'10000000'                                1732 07922000
         BNO   @RF01732                                            1732 07923000
*                      CALL IDCSAFS0(GDTTBL,CTGWKA);       /*#Y30SSFR*/ 07924000
         L     @14,@PC00001                                        1733 07925000
         ST    @14,@AL00001                                        1733 07926000
         LA    @15,CTGWKA(,@15)                                    1733 07927000
         ST    @15,@AL00001+4                                      1733 07928000
         L     @15,GDTFSP(,@14)                                    1733 07929000
         LA    @01,@AL00001                                        1733 07930000
         BALR  @14,@15                                             1733 07931000
*                    ELSE ;                                /*#Y30SSFR*/ 07932000
*                                                                  1734 07933000
@RF01732 DS    0H                                                  1735 07934000
*                  /**************************************************/ 07935000
*                  /*                                        #Y30SSFR*/ 07936000
*                  /*  TURN THE COREFLAG ON AND ISSUE A      #Y30SSFR*/ 07937000
*                  /*  UGPOOL TO OBTAIN CORE.                #Y30SSFR*/ 07938000
*                  /*                                        #Y30SSFR*/ 07939000
*                  /*************************************************/  07940000
*                                                                  1735 07941000
*                  COREFLAG = ON;                          /*#Y30SSFR*/ 07942000
*                                                                  1735 07943000
         OI    COREFLAG,B'10000000'                                1735 07944000
*                  CALL IDCSAGP0(GDTTBL,SIZENEED,          /*#Y30SSFR*/ 07945000
*                    CTGWKA,GPID,SETZERO);                 /*#Y30SSFR*/ 07946000
*                                                                  1736 07947000
         L     @03,@PC00001                                        1736 07948000
         ST    @03,@AL00001                                        1736 07949000
         LA    @15,SIZENEED                                        1736 07950000
         ST    @15,@AL00001+4                                      1736 07951000
         L     @01,CTGPLPTR                                        1736 07952000
         LA    @15,CTGWKA(,@01)                                    1736 07953000
         ST    @15,@AL00001+8                                      1736 07954000
         LA    @15,GPID                                            1736 07955000
         ST    @15,@AL00001+12                                     1736 07956000
         LA    @15,SETZERO                                         1736 07957000
         ST    @15,@AL00001+16                                     1736 07958000
         MVI   @AL00001+16,X'80'                                   1736 07959000
         L     @15,GDTGPL(,@03)                                    1736 07960000
         LA    @01,@AL00001                                        1736 07961000
         BALR  @14,@15                                             1736 07962000
*                  RESPECIFY RTNREG RSTD;                          1737 07963000
*                  TESTRC = RTNREG;                                1738 07964000
         LR    TESTRC,RTNREG                                       1738 07965000
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/ 07966000
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/ 07967000
*                    THEN                                  /*#Y30SSFR*/ 07968000
         LTR   TESTRC,TESTRC                                       1740 07969000
         BZ    @RF01740                                            1740 07970000
*                      DO;                                 /*#Y30SSFR*/ 07971000
*                      DARGSMOD = UNIVMSG;                 /*#Y30SSFR*/ 07972000
         L     @01,DDSTRU                                          1742 07973000
         MVC   DARGSMOD(3,@01),@CC01023                            1742 07974000
*                      DEFSTID = NOSTORAG;                 /*#Y30SSFR*/ 07975000
         MVI   DEFSTID,X'04'                                       1743 07976000
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/ 07977000
         LA    @15,12                                              1744 07978000
         L     @14,@SA00010                                        1744 07979000
         LM    @00,@12,@SA00010+8                                  1744 07980000
         BR    @14                                                 1744 07981000
*                      END;                                /*#Y30SSFR*/ 07982000
*                                                                  1745 07983000
*                  /**************************************************/ 07984000
*                  /*                                        #Y30SSFR*/ 07985000
*                  /*  COMPUTE A NEW VALUE FOR LIMIT, AND    #Y30SSFR*/ 07986000
*                  /*  SET CURSIZE AND AREALN TO THE         #Y30SSFR*/ 07987000
*                  /*  PROPER VALUES.                        #Y30SSFR*/ 07988000
*                  /*                                        #Y30SSFR*/ 07989000
*                  /**************************************************/ 07990000
*                                                                  1746 07991000
*                  LIMIT = (SIZENEED - 4) /                /*#Y30SSFR*/ 07992000
*                     LENGTH(ENTITEM);                     /*#Y30SSFR*/ 07993000
@RF01740 L     @15,SIZENEED                                        1746 07994000
         LR    @00,@15                                             1746 07995000
         SL    @00,@CF00045                                        1746 07996000
         SRDA  @00,32                                              1746 07997000
         D     @00,@CF01384                                        1746 07998000
         LR    LIMIT,@01                                           1746 07999000
*                  CURSIZE = SIZENEED;                     /*#Y30SSFR*/ 08000000
         STH   @15,CURSIZE                                         1747 08001000
*                  AREALN = SIZENEED;                      /*#Y30SSFR*/ 08002000
         L     @02,CTGPLPTR                                        1748 08003000
         L     @02,CTGWKA(,@02)                                    1748 08004000
         STH   @15,AREALN(,@02)                                    1748 08005000
*                  END;                                    /*#Y30SSFR*/ 08006000
*                                                                  1749 08007000
*                ELSE                                      /*#Y30SSFR*/ 08008000
*                                                                  1750 08009000
*                  /**************************************************/ 08010000
*                  /*                                        #Y30SSFR*/ 08011000
*                  /*  ZERO AND REUSE THE PRESENT CATALOG    #Y30SSFR*/ 08012000
*                  /*  WORK AREA.  IT IS ALREADY LARGE       #Y30SSFR*/ 08013000
*                  /*  ENOUGH.                               #Y30SSFR*/ 08014000
*                  /*                                        #Y30SSFR*/ 08015000
*                  /**************************************************/ 08016000
*                                                                  1750 08017000
*                  DO;                                     /*#Y30SSFR*/ 08018000
         B     @RC01730                                            1750 08019000
@RF01730 DS    0H                                                  1751 08020000
*                  RETURNLN = 0;                           /*#Y30SSFR*/ 08021000
         L     @02,CTGPLPTR                                        1751 08022000
         L     @02,CTGWKA(,@02)                                    1751 08023000
         SLR   @15,@15                                             1751 08024000
         STH   @15,RETURNLN(,@02)                                  1751 08025000
*                  DO J = 1 TO LIMIT;                      /*#Y30SSFR*/ 08026000
         LA    J,1                                                 1752 08027000
         B     @DE01752                                            1752 08028000
@DL01752 DS    0H                                                  1753 08029000
*                    ENTLIST(J) = ''B;                     /*#Y30SSFR*/ 08030000
         LR    @15,J                                               1753 08031000
         MH    @15,@CH01384                                        1753 08032000
         L     @01,CTGPLPTR                                        1753 08033000
         L     @01,CTGWKA(,@01)                                    1753 08034000
         ALR   @01,@15                                             1753 08035000
         AL    @01,@CF01706                                        1753 08036000
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    1753 08037000
*                  END;                                    /*#Y30SSFR*/ 08038000
         AL    J,@CF00221                                          1754 08039000
@DE01752 CR    J,LIMIT                                             1754 08040000
         BNH   @DL01752                                            1754 08041000
*                  END;                                    /*#Y30SSFR*/ 08042000
*                                                                  1755 08043000
*              END MORESP;                                 /*#Y30SSFR*/ 08044000
*                                                                  1756 08045000
*            ELSE                                                  1757 08046000
*                                                                  1757 08047000
*              /******************************************************/ 08048000
*              /*                                            #Y30SSFR*/ 08049000
*              /*  TEST FOR VSAM CATALOG RETURN CODES OF 72, #Y30SSFR*/ 08050000
*              /*  76, AND 240.  THESE INDICATE THAT         #Y30SSFR*/ 08051000
*              /*  SOMETHING MUST BE DYNAMICALLY ALLOCATED.  #Y30SSFR*/ 08052000
*              /*                                            #Y30SSFR*/ 08053000
*              /******************************************************/ 08054000
*                                                                  1757 08055000
*              IF (CATLGRC = ALLORC1) | (CATLGRC = ALLORC2)        1757 08056000
*                  | (CATLGRC = ALLORC3)                           1757 08057000
*                THEN                                              1757 08058000
*                                                                  1757 08059000
         B     @RC01727                                            1757 08060000
@RF01727 LH    @05,CATLGRC                                         1757 08061000
         C     @05,@CF01153                                        1757 08062000
         BE    @RT01757                                            1757 08063000
         C     @05,@CF01161                                        1757 08064000
         BE    @RT01757                                            1757 08065000
         C     @05,@CF01155                                        1757 08066000
         BNE   @RF01757                                            1757 08067000
@RT01757 DS    0H                                                  1758 08068000
*ALLOCRC:          DO;                                     /*#Y30SSFR*/ 08069000
*                                                                  1758 08070000
ALLOCRC  DS    0H                                                  1759 08071000
*                  /**************************************************/ 08072000
*                  /*                                        #Y30SSFR*/ 08073000
*                  /*  IF DEALLOC IS ON, SOMETHING HAS BEEN  #Y30SSFR*/ 08074000
*                  /*  DYNAMICALLY ALLOCATED.  DYNAMICALLY   #Y30SSFR*/ 08075000
*                  /*  UNALLOCATE THE OBJECT SO THAT THE     #Y30SSFR*/ 08076000
*                  /*  SAME STORAGE CAN BE USED FOR THE      #Y30SSFR*/ 08077000
*                  /*  ALLAGL OF THE NEXT THING TO BE        #Y30SSFR*/ 08078000
*                  /*  ALLOCATED.                            #Y30SSFR*/ 08079000
*                  /*                                        #Y30SSFR*/ 08080000
*                  /**************************************************/ 08081000
*                                                                  1759 08082000
*                  IF DEALLOC = ON                                 1759 08083000
*                    THEN                                          1759 08084000
*                                                                  1759 08085000
         TM    DEALLOC,B'10000000'                                 1759 08086000
         BNO   @RF01759                                            1759 08087000
*                      DO;                                 /*#Y30SSFR*/ 08088000
*                      DEALLOC = OFF;                      /*#Y30SSFR*/ 08089000
*                                                                  1761 08090000
         NI    DEALLOC,B'01111111'                                 1761 08091000
*                      CALL IDCSADL0(GDTTBL,ALLAGL);       /*#Y30SSFR*/ 08092000
         L     @05,@PC00001                                        1762 08093000
         ST    @05,@AL00001                                        1762 08094000
         L     @01,ALLPTR                                          1762 08095000
         ST    @01,@AL00001+4                                      1762 08096000
         MVI   @AL00001+4,X'80'                                    1762 08097000
         L     @15,GDTDLC(,@05)                                    1762 08098000
         LA    @01,@AL00001                                        1762 08099000
         BALR  @14,@15                                             1762 08100000
*                      RESPECIFY RTNREG RSTD;                      1763 08101000
*                      TESTRC = RTNREG;                            1764 08102000
         LR    TESTRC,RTNREG                                       1764 08103000
*                      RESPECIFY RTNREG UNRSTD;            /*#Y30SSFR*/ 08104000
*                      IF TESTRC ^= 0                              1766 08105000
*                        THEN                                      1766 08106000
         LTR   TESTRC,TESTRC                                       1766 08107000
         BZ    @RF01766                                            1766 08108000
*                          SETRC = LASTCC08;               /*#Y30SSFR*/ 08109000
         MVC   SETRC(2),@CH00039                                   1767 08110000
*                      END;                                /*#Y30SSFR*/ 08111000
*                                                                  1768 08112000
@RF01766 DS    0H                                                  1769 08113000
*                  /**************************************************/ 08114000
*                  /*                                        #Y30SSFR*/ 08115000
*                  /*  SET DEALLOC TO INDICATE THAT AN       #Y30SSFR*/ 08116000
*                  /*  ATTEMPT HAS BEEN MADE TO DYNAMICALLY  #Y30SSFR*/ 08117000
*                  /*  ALLOCATE SOMETHING.                   #Y30SSFR*/ 08118000
*                  /*                                        #Y30SSFR*/ 08119000
*                  /**************************************************/ 08120000
*                                                                  1769 08121000
*                  DEALLOC = ON;                           /*#Y30SSFR*/ 08122000
*                                                                  1769 08123000
@RF01759 OI    DEALLOC,B'10000000'                                 1769 08124000
*                  /**************************************************/ 08125000
*                  /*                                        #Y30SSFR*/ 08126000
*                  /*  POINT TO THE STORAGE FOR THE ALLAGL,  #Y30SSFR*/ 08127000
*                  /*  AND CLEAR IT TO ZEROS.                #Y30SSFR*/ 08128000
*                  /*                                        #Y30SSFR*/ 08129000
*                  /**************************************************/ 08130000
*                                                                  1770 08131000
*                  ALLPTR = ADDR(ALLLIST);                 /*#Y30SSFR*/ 08132000
         LA    @05,ALLLIST                                         1770 08133000
         ST    @05,ALLPTR                                          1770 08134000
*                  ALLAGL = ''B;                           /*#Y30SSFR*/ 08135000
*                                                                  1771 08136000
         XC    ALLAGL(31,@05),ALLAGL(@05)                          1771 08137000
*                  /**************************************************/ 08138000
*                  /*                                        #Y30SSFR*/ 08139000
*                  /*  IF THE VSAM CATALOG RETURN CODE IS 72 OR 76,  */ 08140000
*                  /*  THEN THE THING TO BE DYNAMICALLY      #Y30SSFR*/ 08141000
*                  /*  ALLOCATED IS THE LAST ITEM IN THE     #Y30SSFR*/ 08142000
*                  /*  CMS WORK AREA.  IF IT IS 240, THEN    #Y30SSFR*/ 08143000
*                  /*  THE ADDRESS OF THE THING TO ALLOCATE  #Y30SSFR*/ 08144000
*                  /*  IS IN CTGENT.                         #Y30SSFR*/ 08145000
*                  /*                                        #Y30SSFR*/ 08146000
*                  /**************************************************/ 08147000
*                                                                  1772 08148000
*                  IF (CATLGRC = ALLORC1) |                /*#Y30SSFR*/ 08149000
*                       (CATLGRC = ALLORC3)                /*#Y30SSFR*/ 08150000
*                    THEN                                  /*#Y30SSFR*/ 08151000
         LH    @05,CATLGRC                                         1772 08152000
         C     @05,@CF01153                                        1772 08153000
         BE    @RT01772                                            1772 08154000
         C     @05,@CF01155                                        1772 08155000
         BNE   @RF01772                                            1772 08156000
@RT01772 DS    0H                                                  1773 08157000
*                      ALLDSN = ADDR(ENTRYNM(PLIMIT + 1)); /*#Y30SSFR*/ 08158000
         LR    @05,PLIMIT                                          1773 08159000
         MH    @05,@CH01384                                        1773 08160000
         L     @02,CTGPLPTR                                        1773 08161000
         L     @02,CTGWKA(,@02)                                    1773 08162000
         LA    @05,ENTRYNM(@05,@02)                                1773 08163000
         L     @02,ALLPTR                                          1773 08164000
         ST    @05,ALLDSN(,@02)                                    1773 08165000
*                    ELSE                                  /*#Y30SSFR*/ 08166000
*                      ALLDSN = CTGENT;                    /*#Y30SSFR*/ 08167000
*                                                                  1774 08168000
         B     @RC01772                                            1774 08169000
@RF01772 L     @02,CTGPLPTR                                        1774 08170000
         L     @02,CTGENT(,@02)                                    1774 08171000
         L     @01,ALLPTR                                          1774 08172000
         ST    @02,ALLDSN(,@01)                                    1774 08173000
*                  /**************************************************/ 08174000
*                  /*                                        #Y30SSFR*/ 08175000
*                  /*  SELECT DYNAMIC ALLOCATION OPTIONS     #Y30SSFR*/ 08176000
*                  /*  (1) DYNAMIC ALLOCATION BY DATA SET    #Y30SSFR*/ 08177000
*                  /*      NAME                              #Y30SSFR*/ 08178000
*                  /*  (2) STATUS = OLD                      #Y30SSFR*/ 08179000
*                  /*  (3) DISP = KEEP                       #Y30SSFR*/ 08180000
*                  /*                                        #Y30SSFR*/ 08181000
*                  /**************************************************/ 08182000
*                                                                  1775 08183000
*                  ALLOPTVL = OFF;                         /*#Y30SSFR*/ 08184000
@RC01772 DS    0H                                                  1776 08185000
*                  ALLOPTDS = ON;                          /*#Y30SSFR*/ 08186000
         L     @15,ALLPTR                                          1776 08187000
         OI    ALLOPTDS(@15),B'01000000'                           1776 08188000
         NI    ALLOPTVL(@15),B'01111111'                           1776 08189000
*                  ALLSTSOD = ON;                          /*#Y30SSFR*/ 08190000
         OI    ALLSTSOD(@15),B'00000001'                           1777 08191000
*                  ALLDSPKP = ON;                          /*#Y30SSFR*/ 08192000
*                                                                  1778 08193000
         OI    ALLDSPKP(@15),B'00001000'                           1778 08194000
*                  /**************************************************/ 08195000
*                  /*                                        #Y30SSFR*/ 08196000
*                  /*  ISSUE THE UALLOC MACRO OF THE SYSTEM  #Y30SSFR*/ 08197000
*                  /*  ADAPTER, AND TEST THE RETURN CODE.    #Y30SSFR*/ 08198000
*                  /*                                        #Y30SSFR*/ 08199000
*                  /**************************************************/ 08200000
*                                                                  1779 08201000
*                  CALL IDCSAAL0(GDTTBL,ALLAGL);           /*#Y30SSFR*/ 08202000
         L     @14,@PC00001                                        1779 08203000
         ST    @14,@AL00001                                        1779 08204000
         ST    @15,@AL00001+4                                      1779 08205000
         MVI   @AL00001+4,X'80'                                    1779 08206000
         L     @15,GDTALC(,@14)                                    1779 08207000
         LA    @01,@AL00001                                        1779 08208000
         BALR  @14,@15                                             1779 08209000
*                  RESPECIFY RTNREG RSTD;                          1780 08210000
*                  TESTRC = RTNREG;                                1781 08211000
         LR    TESTRC,RTNREG                                       1781 08212000
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/ 08213000
*                                                                  1782 08214000
*                  IF TESTRC = 0                                   1783 08215000
*                    THEN                                          1783 08216000
*                                                                  1783 08217000
         LTR   TESTRC,TESTRC                                       1783 08218000
         BNZ   @RF01783                                            1783 08219000
*                      /**********************************************/ 08220000
*                      /*                                    #Y30SSFR*/ 08221000
*                      /*  THE OBJECT HAS BEEN ALLOCATED     #Y30SSFR*/ 08222000
*                      /*  SUCCESSFULLY.  RESTORE THE CPL,   #Y30SSFR*/ 08223000
*                      /*  AND PLACE A POINTER TO THE        #Y30SSFR*/ 08224000
*                      /*  DDNAME RETURNED BY ALLOCATION IN  #Y30SSFR*/ 08225000
*                      /*  THE CPL.                          #Y30SSFR*/ 08226000
*                      /*                                    #Y30SSFR*/ 08227000
*                      /**********************************************/ 08228000
*                                                                  1784 08229000
*                      DO;                                 /*#Y30SSFR*/ 08230000
*                      CTGPL = DSAVCPL;                    /*#Y30SSFR*/ 08231000
         L     @02,CTGPLPTR                                        1785 08232000
         MVC   CTGPL(28,@02),DSAVCPL                               1785 08233000
*                      CTGDDNM = ADDR(ALLDDN);             /*#Y30SSFR*/ 08234000
*                                                                  1786 08235000
         L     @01,ALLPTR                                          1786 08236000
         LA    @15,ALLDDN(,@01)                                    1786 08237000
         ST    @15,CTGDDNM(,@02)                                   1786 08238000
*                      /**********************************************/ 08239000
*                      /*                                    #Y30SSFR*/ 08240000
*                      /*  CLEAR THE CMS WORKAREA.           #Y30SSFR*/ 08241000
*                      /*                                    #Y30SSFR*/ 08242000
*                      /**********************************************/ 08243000
*                                                                  1787 08244000
*                      DO J = 1 TO LIMIT;                  /*#Y30SSFR*/ 08245000
         LA    J,1                                                 1787 08246000
         B     @DE01787                                            1787 08247000
@DL01787 DS    0H                                                  1788 08248000
*                        ENTITEM(J) = ''B;                 /*#Y30SSFR*/ 08249000
         LR    @15,J                                               1788 08250000
         MH    @15,@CH01384                                        1788 08251000
         L     @01,CTGPLPTR                                        1788 08252000
         L     @01,CTGWKA(,@01)                                    1788 08253000
         ALR   @01,@15                                             1788 08254000
         AL    @01,@CF01706                                        1788 08255000
         XC    ENTITEM-4(45,@01),ENTITEM-4(@01)                    1788 08256000
*                      END;                                /*#Y30SSFR*/ 08257000
         AL    J,@CF00221                                          1789 08258000
@DE01787 CR    J,LIMIT                                             1789 08259000
         BNH   @DL01787                                            1789 08260000
*                      RETURNLN = 0;                       /*#Y30SSFR*/ 08261000
         L     @02,CTGPLPTR                                        1790 08262000
         L     @02,CTGWKA(,@02)                                    1790 08263000
         SLR   @15,@15                                             1790 08264000
         STH   @15,RETURNLN(,@02)                                  1790 08265000
*                      END;                                /*#Y30SSFR*/ 08266000
*                                                                  1791 08267000
*                    ELSE                                  /*#Y30SSFR*/ 08268000
*                                                                  1792 08269000
*                      /**********************************************/ 08270000
*                      /*                                    #Y30SSFR*/ 08271000
*                      /*  DYNAMIC ALLOCATION HAS FAILED.    #Y30SSFR*/ 08272000
*                      /*  PRINT AN ERROR MESSAGE, AND       #Y30SSFR*/ 08273000
*                      /*  RETURN TO THE CALLING PROCESSOR.  #Y30SSFR*/ 08274000
*                      /*                                    #Y30SSFR*/ 08275000
*                      /**********************************************/ 08276000
*                                                                  1792 08277000
*                      DO;                                 /*#Y30SSFR*/ 08278000
         B     @RC01783                                            1792 08279000
@RF01783 DS    0H                                                  1793 08280000
*                      DEFSTID = 0;                        /*#Y30SSFR*/ 08281000
         MVI   DEFSTID,X'00'                                       1793 08282000
*                      DARGSMOD = DELMSG;                  /*#Y30SSFR*/ 08283000
         L     @15,DDSTRU                                          1794 08284000
         MVC   DARGSMOD(3,@15),@CC01031                            1794 08285000
*                      DARGILP = LENGTH(FENTNAME);         /*#Y30SSFR*/ 08286000
         MVC   DARGILP(2,@15),@CH00605                             1795 08287000
*                      DARGSENT = NODELMSG;                /*#Y30SSFR*/ 08288000
         MVI   DARGSENT(@15),X'08'                                 1796 08289000
*                      DARGDBP = CTGENT;                   /*#Y30SSFR*/ 08290000
*                                                                  1797 08291000
         L     @01,CTGPLPTR                                        1797 08292000
         L     @14,CTGENT(,@01)                                    1797 08293000
         ST    @14,DARGDBP(,@15)                                   1797 08294000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*     1798 08295000
*                                                            #Y30SSFR*/ 08296000
*                                                                  1798 08297000
         L     @15,@PC00001                                        1798 08298000
         ST    @15,@AL00001                                        1798 08299000
         LA    @14,@CF00118                                        1798 08300000
         ST    @14,@AL00001+4                                      1798 08301000
         LA    @14,DDSTRU                                          1798 08302000
         ST    @14,@AL00001+8                                      1798 08303000
         MVI   @AL00001+8,X'80'                                    1798 08304000
         L     @15,GDTPRT(,@15)                                    1798 08305000
         LA    @01,@AL00001                                        1798 08306000
         BALR  @14,@15                                             1798 08307000
*                      DARGSMOD = UNIVMSG;                 /*#Y30SSFR*/ 08308000
         L     @01,DDSTRU                                          1799 08309000
         MVC   DARGSMOD(3,@01),@CC01023                            1799 08310000
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/ 08311000
         LA    @15,12                                              1800 08312000
         L     @14,@SA00010                                        1800 08313000
         LM    @00,@12,@SA00010+8                                  1800 08314000
         BR    @14                                                 1800 08315000
*                      END;                                /*#Y30SSFR*/ 08316000
*                                                                  1801 08317000
*                  END ALLOCRC;                            /*#Y30SSFR*/ 08318000
*                                                                  1802 08319000
@RC01783 DS    0H                                                  1803 08320000
*            /********************************************************/ 08321000
*            /*                                              #Y30SSFR*/ 08322000
*            /*  CALL CATALOG AND SAVE THE RETURN CODE.      #Y30SSFR*/ 08323000
*            /*                                              #Y30SSFR*/ 08324000
*            /********************************************************/ 08325000
*                                                                  1803 08326000
*            CALL IDCSACA0(GDTTBL,DLCPLPTR);               /*#Y30SSFR*/ 08327000
*                                                                  1803 08328000
@RF01757 DS    0H                                                  1803 08329000
@RC01727 L     @02,@PC00001                                        1803 08330000
         ST    @02,@AL00001                                        1803 08331000
         L     @15,@PC00010                                        1803 08332000
         ST    @15,@AL00001+4                                      1803 08333000
         L     @15,GDTCAT(,@02)                                    1803 08334000
         LA    @01,@AL00001                                        1803 08335000
         BALR  @14,@15                                             1803 08336000
*            RESPECIFY REG15 RSTD;                         /*#Y30SSFR*/ 08337000
*            CATLGRC = REG15;                              /*#Y30SSFR*/ 08338000
         STH   REG15,CATLGRC                                       1805 08339000
*            RESPECIFY REG15 UNRSTD;                       /*#Y30SSFR*/ 08340000
*                                                                  1806 08341000
*            IF GDTDBG = NULLPTR                                   1807 08342000
*              THEN;                                               1807 08343000
         L     @02,@PC00001                                        1807 08344000
         L     @02,GDTDBG(,@02)                                    1807 08345000
         LTR   @02,@02                                             1807 08346000
         BZ    @RT01807                                            1807 08347000
*              ELSE                                                1809 08348000
*                CALL IDCDB010(GDTTBL,'MPDD');                     1809 08349000
         L     @02,@PC00001                                        1809 08350000
         ST    @02,@AL00001                                        1809 08351000
         LA    @15,@CC01463                                        1809 08352000
         ST    @15,@AL00001+4                                      1809 08353000
         MVI   @AL00001+4,X'80'                                    1809 08354000
         L     @15,GDTDBG(,@02)                                    1809 08355000
         LA    @01,@AL00001                                        1809 08356000
         BALR  @14,@15                                             1809 08357000
*                                                          /*#Y30SSFR*/ 08358000
*                                                                  1810 08359000
*        END DELLP;                                        /*#Y30SSFR*/ 08360000
*                                                                  1810 08361000
@RT01807 DS    0H                                                  1810 08362000
@DE01715 LH    @02,CATLGRC                                         1810 08363000
         C     @02,@CF01151                                        1810 08364000
         BE    @DL01715                                            1810 08365000
         C     @02,@CF01153                                        1810 08366000
         BE    @DL01715                                            1810 08367000
         C     @02,@CF01161                                        1810 08368000
         BE    @DL01715                                            1810 08369000
         C     @02,@CF01155                                        1810 08370000
         BE    @DL01715                                            1810 08371000
*        /************************************************************/ 08372000
*        /*                                                  #Y30SSFR*/ 08373000
*        /*  IF VSAM CATALOG MANAGEMENT HAS PLACED ANYTHING  #Y30SSFR*/ 08374000
*        /*  IN THE WORKAREA PASSED TO IT FOR THE CATALOG    #Y30SSFR*/ 08375000
*        /*  DELETE, PRINT IT OUT.                           #Y30SSFR*/ 08376000
*        /*                                                  #Y30SSFR*/ 08377000
*        /************************************************************/ 08378000
*                                                                  1811 08379000
*        IF RETURNLN > 4                                   /*#Y30SSFR*/ 08380000
*          THEN                                            /*#Y30SSFR*/ 08381000
         LA    @15,4                                               1811 08382000
         L     @01,CTGPLPTR                                        1811 08383000
         L     @01,CTGWKA(,@01)                                    1811 08384000
         LH    @14,RETURNLN(,@01)                                  1811 08385000
         CR    @14,@15                                             1811 08386000
         BNH   @RF01811                                            1811 08387000
*            DO;                                           /*#Y30SSFR*/ 08388000
*            ENTRYNO = (RETURNLN - 4) / LENGTH(ENTITEM);   /*#Y30SSFR*/ 08389000
         SLR   @14,@15                                             1813 08390000
         SRDA  @14,32                                              1813 08391000
         D     @14,@CF01384                                        1813 08392000
         LR    ENTRYNO,@15                                         1813 08393000
*            DO K = 1 TO ENTRYNO;                          /*#Y30SSFR*/ 08394000
         LA    K,1                                                 1814 08395000
         B     @DE01814                                            1814 08396000
@DL01814 DS    0H                                                  1815 08397000
*              DARGDBP = ADDR(ENTLIST(K));                 /*#Y30SSFR*/ 08398000
         L     @15,DDSTRU                                          1815 08399000
         LA    @14,45                                              1815 08400000
         LR    @01,K                                               1815 08401000
         MR    @00,@14                                             1815 08402000
         L     @05,CTGPLPTR                                        1815 08403000
         L     @05,CTGWKA(,@05)                                    1815 08404000
         AL    @05,@CF01706                                        1815 08405000
         LA    @05,ENTLIST-4(@01,@05)                              1815 08406000
         ST    @05,DARGDBP(,@15)                                   1815 08407000
*              DARGILP = LENGTH(ENTLIST(1));               /*#Y30SSFR*/ 08408000
*                                                                  1816 08409000
         STH   @14,DARGILP(,@15)                                   1816 08410000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*#Y30SSFR*/ 08411000
         L     @15,@PC00001                                        1817 08412000
         ST    @15,@AL00001                                        1817 08413000
         LA    @14,@CF00118                                        1817 08414000
         ST    @14,@AL00001+4                                      1817 08415000
         LA    @14,DDSTRU                                          1817 08416000
         ST    @14,@AL00001+8                                      1817 08417000
         MVI   @AL00001+8,X'80'                                    1817 08418000
         L     @15,GDTPRT(,@15)                                    1817 08419000
         LA    @01,@AL00001                                        1817 08420000
         BALR  @14,@15                                             1817 08421000
*            END;                                          /*#Y30SSFR*/ 08422000
*                                                                  1818 08423000
         AL    K,@CF00221                                          1818 08424000
@DE01814 CR    K,ENTRYNO                                           1818 08425000
         BNH   @DL01814                                            1818 08426000
*            END;                                          /*#Y30SSFR*/ 08427000
*          ELSE ;                                          /*#Y30SSFR*/ 08428000
*                                                                  1820 08429000
@RF01811 DS    0H                                                  1821 08430000
*        /************************************************************/ 08431000
*        /*                                                  @Z40RSSA*/ 08432000
*        /*  IF THE VSAM CATALOG RETURN CODE IS 110          @Z40RSSA*/ 08433000
*        /*  PRINT THE REASON THE PROFILE COULD NOT BE       @Z40RSSA*/ 08434000
*        /*  DELETED.                                        @Z40RSSA*/ 08435000
*        /*         REASON CODE 4 - NO PROFILE               @Z40RSSA*/ 08436000
*        /*         REASON CODE 8 - PROFILE NOT DELETEABLE   @Z40RSSA*/ 08437000
*        /*                                                  @Z40RSSA*/ 08438000
*        /*  IF NOT 110, SIMPLY PRINT THE VSAM RETURN CODE   @Z40RSSA*/ 08439000
*        /*                                                  @Z40RSSA*/ 08440000
*        /************************************************************/ 08441000
*                                                                  1821 08442000
*               IF CATLGRC = PRNTDEL & (CTGFBFLG =NFRET |          1821 08443000
*                CTGFBFLG = NDRET) THEN                            1821 08444000
         CLC   CATLGRC(2),@CH01157                                 1821 08445000
         BNE   @RF01821                                            1821 08446000
         L     @15,CTGPLPTR                                        1821 08447000
         CLC   CTGFBFLG(2,@15),@CH00045                            1821 08448000
         BE    @RT01821                                            1821 08449000
         CLC   CTGFBFLG(2,@15),@CH00039                            1821 08450000
         BNE   @RF01821                                            1821 08451000
@RT01821 DS    0H                                                  1822 08452000
*                  DO;                                     /*@Z40RSSA*/ 08453000
*                    DARGLIST = ''B;                       /*@Z40RSSA*/ 08454000
         L     @15,DDSTRU                                          1823 08455000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1823 08456000
*                    DARGSMOD = DELMSG;                    /*@Z40RSSA*/ 08457000
         MVC   DARGSMOD(3,@15),@CC01031                            1824 08458000
*                    IF CTGFBFLG = 4 THEN                  /*@Z40RSSA*/ 08459000
         L     @01,CTGPLPTR                                        1825 08460000
         CLC   CTGFBFLG(2,@01),@CH00045                            1825 08461000
         BNE   @RF01825                                            1825 08462000
*                      DARGSENT = PFNTFND;                 /*@Z40RSSA*/ 08463000
         MVI   DARGSENT(@15),X'0D'                                 1826 08464000
*                    ELSE                                  /*@Z40RSSA*/ 08465000
*                      DARGSENT = PFNTDL;                  /*@Z40RSSA*/ 08466000
         B     @RC01825                                            1827 08467000
@RF01825 L     @01,DDSTRU                                          1827 08468000
         MVI   DARGSENT(@01),X'0C'                                 1827 08469000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*     1828 08470000
*                                                            @Z40RSSA*/ 08471000
@RC01825 L     @15,@PC00001                                        1828 08472000
         ST    @15,@AL00001                                        1828 08473000
         LA    @14,@CF00118                                        1828 08474000
         ST    @14,@AL00001+4                                      1828 08475000
         LA    @14,DDSTRU                                          1828 08476000
         ST    @14,@AL00001+8                                      1828 08477000
         MVI   @AL00001+8,X'80'                                    1828 08478000
         L     @15,GDTPRT(,@15)                                    1828 08479000
         LA    @01,@AL00001                                        1828 08480000
         BALR  @14,@15                                             1828 08481000
*                      SETRC = LASTCC04;                   /*@Z40RSSA*/ 08482000
         MVC   SETRC(2),@CH00045                                   1829 08483000
*                  END;                                    /*@Z40RSSA*/ 08484000
*               ELSE                                       /*@Z40RSSA*/ 08485000
*        /************************************************************/ 08486000
*        /*                                                  #Y30SSFR*/ 08487000
*        /*  TEST FOR A VSAM CATALOG RETURN CODE OTHER THAN  #Y30SSFR*/ 08488000
*        /*  ZERO.  IF CATALOG MANAGEMENT HAS SET A NON-ZERO #Y30SSFR*/ 08489000
*        /*  RETURN CODE, PRINT AN APPROPRIATE MESSAGE.      #Y30SSFR*/ 08490000
*        /*                                                  #Y30SSFR*/ 08491000
*        /************************************************************/ 08492000
*                                                                  1831 08493000
*        IF CATLGRC ^= 0                                   /*#Y30SSFR*/ 08494000
*          THEN                                            /*#Y30SSFR*/ 08495000
         B     @RC01821                                            1831 08496000
@RF01821 LH    @15,CATLGRC                                         1831 08497000
         LTR   @15,@15                                             1831 08498000
         BZ    @RF01831                                            1831 08499000
*ERCALL2:    DO;                                           /*#Y30SSFR*/ 08500000
*                                                                  1832 08501000
ERCALL2  DS    0H                                                  1833 08502000
*            /********************************************************/ 08503000
*            /*                                              #Y30SSFR*/ 08504000
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     #Y30SSFR*/ 08505000
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/ 08506000
*            /*                                              #Y30SSFR*/ 08507000
*            /********************************************************/ 08508000
*                                                                  1833 08509000
*            ERRORTAB = ''B;                               /*#Y30SSFR*/ 08510000
*                                                                  1833 08511000
         XC    ERRORTAB(32),ERRORTAB                               1833 08512000
*            /********************************************************/ 08513000
*            /*                                              #Y30SSFR*/ 08514000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    #Y30SSFR*/ 08515000
*            /*  THE ERROR CONVERSION TABLE.                 #Y30SSFR*/ 08516000
*            /*                                              #Y30SSFR*/ 08517000
*            /********************************************************/ 08518000
*                                                                  1834 08519000
*            ERCNVADR = ADDR(ERRORTAB);                    /*#Y30SSFR*/ 08520000
*                                                                  1834 08521000
         LA    @15,ERRORTAB                                        1834 08522000
         ST    @15,ERCNVADR                                        1834 08523000
*            /********************************************************/ 08524000
*            /*                                              #Y30SSFR*/ 08525000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  #Y30SSFR*/ 08526000
*            /*  IS A CATALOG ERROR.  THE CMS                #Y30SSFR*/ 08527000
*            /*  FUNCTION BEING PERFORMED IS A DELETE.       #Y30SSFR*/ 08528000
*            /*  SET THE ERCATDL BIT TO ON.                  #Y30SSFR*/ 08529000
*            /*                                              #Y30SSFR*/ 08530000
*            /********************************************************/ 08531000
*                                                                  1835 08532000
*            ERCATLG = ON;                                 /*#Y30SSFR*/ 08533000
         OI    ERCATLG(@15),B'10000000'                            1835 08534000
*            ERCATDL = ON;                                 /*#Y30SSFR*/ 08535000
*                                                                  1836 08536000
         OI    ERCATDL(@15),B'00100000'                            1836 08537000
*            /********************************************************/ 08538000
*            /*                                              #Y30SSFR*/ 08539000
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  #Y30SSFR*/ 08540000
*            /*  POINT TO THE CPL FOR THE CATALOG OPERATION. #Y30SSFR*/ 08541000
*            /*                                              #Y30SSFR*/ 08542000
*            /********************************************************/ 08543000
*                                                                  1837 08544000
*            ERCATRC = CATLGRC;                            /*#Y30SSFR*/ 08545000
         LH    @14,CATLGRC                                         1837 08546000
         ST    @14,ERCATRC(,@15)                                   1837 08547000
*            ERCPLPT = CTGPLPTR;                           /*#Y30SSFR*/ 08548000
*                                                                  1838 08549000
         L     @14,CTGPLPTR                                        1838 08550000
         ST    @14,ERCPLPT(,@15)                                   1838 08551000
*            /********************************************************/ 08552000
*            /*                                              #Y30SSFR*/ 08553000
*            /*  SET A POINTER IN THE ERROR CONVERSION       #Y30SSFR*/ 08554000
*            /*  TABLE TO THE ENTRY NAME.                    #Y30SSFR*/ 08555000
*            /*                                              #Y30SSFR*/ 08556000
*            /********************************************************/ 08557000
*                                                                  1839 08558000
*            ERDSNM = CTGENT;                              /*#Y30SSFR*/ 08559000
*                                                                  1839 08560000
         L     @14,CTGENT(,@14)                                    1839 08561000
         ST    @14,ERDSNM(,@15)                                    1839 08562000
*            /********************************************************/ 08563000
*            /*                                              #Y30SSFR*/ 08564000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    #Y30SSFR*/ 08565000
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     #Y30SSFR*/ 08566000
*            /*                                              #Y30SSFR*/ 08567000
*            /********************************************************/ 08568000
*                                                                  1840 08569000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*#Y30SSFR*/ 08570000
         L     @15,@PC00001                                        1840 08571000
         ST    @15,@AL00001                                        1840 08572000
         LA    @14,ERCNVADR                                        1840 08573000
         ST    @14,@AL00001+4                                      1840 08574000
         MVI   @AL00001+4,X'80'                                    1840 08575000
         L     @15,GDTERR(,@15)                                    1840 08576000
         LA    @01,@AL00001                                        1840 08577000
         BALR  @14,@15                                             1840 08578000
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/ 08579000
         LA    @15,12                                              1841 08580000
         L     @14,@SA00010                                        1841 08581000
         LM    @00,@12,@SA00010+8                                  1841 08582000
         BR    @14                                                 1841 08583000
*            END ERCALL2;                                  /*#Y30SSFR*/ 08584000
*                                                                  1842 08585000
*        /************************************************************/ 08586000
*        /*                                                  #Y30SSFR*/ 08587000
*        /*  IF CORE WAS OBTAINED BY THIS PROCEDURE, FREE    #Y30SSFR*/ 08588000
*        /*  IT.                                             #Y30SSFR*/ 08589000
*        /*                                                  #Y30SSFR*/ 08590000
*        /************************************************************/ 08591000
*                                                                  1843 08592000
*        IF COREFLAG = ON                                  /*#Y30SSFR*/ 08593000
*          THEN                                            /*#Y30SSFR*/ 08594000
*                                                                  1843 08595000
@RF01831 DS    0H                                                  1843 08596000
@RC01821 TM    COREFLAG,B'10000000'                                1843 08597000
         BNO   @RF01843                                            1843 08598000
*            DO;                                           /*#Y30SSFR*/ 08599000
*            COREFLAG = OFF;                               /*#Y30SSFR*/ 08600000
         NI    COREFLAG,B'01111111'                                1845 08601000
*            CALL IDCSAFS0(GDTTBL,CTGWKA);                 /*#Y30SSFR*/ 08602000
         L     @15,@PC00001                                        1846 08603000
         ST    @15,@AL00001                                        1846 08604000
         L     @01,CTGPLPTR                                        1846 08605000
         LA    @14,CTGWKA(,@01)                                    1846 08606000
         ST    @14,@AL00001+4                                      1846 08607000
         L     @15,GDTFSP(,@15)                                    1846 08608000
         LA    @01,@AL00001                                        1846 08609000
         BALR  @14,@15                                             1846 08610000
*            END;                                          /*#Y30SSFR*/ 08611000
*                                                                  1847 08612000
*        /************************************************************/ 08613000
*        /*                                                  #Y30SSFR*/ 08614000
*        /*  IF DYNAMIC ALLOCATION HAS BEEN PERFORMED BY     #Y30SSFR*/ 08615000
*        /*  THIS PROCEDURE, DYNAMICALLY UNALLOCATE.         #Y30SSFR*/ 08616000
*        /*                                                  #Y30SSFR*/ 08617000
*        /************************************************************/ 08618000
*                                                                  1848 08619000
*        IF DEALLOC = ON                                   /*#Y30SSFR*/ 08620000
*          THEN                                            /*#Y30SSFR*/ 08621000
@RF01843 TM    DEALLOC,B'10000000'                                 1848 08622000
         BNO   @RF01848                                            1848 08623000
*            DO;                                           /*#Y30SSFR*/ 08624000
*            DEALLOC = OFF;                                /*#Y30SSFR*/ 08625000
         NI    DEALLOC,B'01111111'                                 1850 08626000
*            CALL IDCSADL0(GDTTBL,ALLAGL);                 /*#Y30SSFR*/ 08627000
         L     @03,@PC00001                                        1851 08628000
         ST    @03,@AL00001                                        1851 08629000
         L     @01,ALLPTR                                          1851 08630000
         ST    @01,@AL00001+4                                      1851 08631000
         MVI   @AL00001+4,X'80'                                    1851 08632000
         L     @15,GDTDLC(,@03)                                    1851 08633000
         LA    @01,@AL00001                                        1851 08634000
         BALR  @14,@15                                             1851 08635000
*            RESPECIFY RTNREG RSTD;                                1852 08636000
*            TESTRC = RTNREG;                                      1853 08637000
         LR    TESTRC,RTNREG                                       1853 08638000
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/ 08639000
*            IF TESTRC ^= 0                                /*#Y30SSFR*/ 08640000
*              THEN                                        /*#Y30SSFR*/ 08641000
         LTR   TESTRC,TESTRC                                       1855 08642000
         BZ    @RF01855                                            1855 08643000
*                SETRC = LASTCC08;                         /*#Y30SSFR*/ 08644000
         MVC   SETRC(2),@CH00039                                   1856 08645000
*            END;                                          /*#Y30SSFR*/ 08646000
*                                                                  1857 08647000
@RF01855 DS    0H                                                  1858 08648000
*        /************************************************************/ 08649000
*        /*                                                  #Y30SSFR*/ 08650000
*        /*  RETURN TO THE CALLER WITH SUCCESS INDICATED.    #Y30SSFR*/ 08651000
*        /*                                                  #Y30SSFR*/ 08652000
*        /************************************************************/ 08653000
*                                                                  1858 08654000
*        RETURN CODE(0);                                   /*#Y30SSFR*/ 08655000
*                                                                  1858 08656000
@RF01848 SLR   @15,@15                                             1858 08657000
         L     @14,@SA00010                                        1858 08658000
         LM    @00,@12,@SA00010+8                                  1858 08659000
         BR    @14                                                 1858 08660000
*END DELTPROC;                                             /*#Y30SSFR*/ 08661000
*        /************************************************************/ 08662000
*        /*                                                          */ 08663000
*        /*  PROCEDURE NAME - OPENPROC                               */ 08664000
*        /*                                                          */ 08665000
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING A    */ 08666000
*        /*  VSAM OBJECT FOR OUTPUT, OR OPENING THE PORTABILITY      */ 08667000
*        /*  VOLUME FOR INPUT.                               #Y30SSFR*/ 08668000
*        /*  WHEN OPENING A VSAM OBJECT FOR INPUT OPENPROC   #Y30SSFR*/ 08669000
*        /*  SETS THE EXPORT/IMPORT FLAG IN THE OPNAGL.      #Y30SSFR*/ 08670000
*        /*                                                          */ 08671000
*        /*  INPUT -                                                 */ 08672000
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */ 08673000
*        /*        C  INDICATES A USER CATALOG                       */ 08674000
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */ 08675000
*        /*           OPENED                                         */ 08676000
*        /*    .ODSN - NAME OF VSAM CLUSTER COMPONENT                */ 08677000
*        /*    .OREC - LRECL SIZE FOR OUTPUT DATA SET                */ 08678000
*        /*    .OBLK - BLKSIZE FOR OUTPUT DATA SET                   */ 08679000
*        /*                                                          */ 08680000
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */ 08681000
*        /*                                                          */ 08682000
*        /************************************************************/ 08683000
*                                                                  1860 08684000
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */ 08685000
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */ 08686000
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */ 08687000
*                                      /*TO CLUSTER                  */ 08688000
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */ 08689000
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */ 08690000
*                     OIOCS);          /*RETURN CELL FOR IOCS        */ 08691000
*                                                                  1860 08692000
OPENPROC STM   @14,@02,@SA00011                                    1860 08693000
         STM   @04,@12,@SA00011+20                                 1860 08694000
         MVC   @PC00011(24),0(@01)                                 1860 08695000
*        /************************************************************/ 08696000
*        /*                                                          */ 08697000
*        /*  ARGUMENTS OF INVOCATION                                 */ 08698000
*        /*                                                          */ 08699000
*        /************************************************************/ 08700000
*                                                                  1861 08701000
*        DCL                                                       1861 08702000
*          OTYPE CHAR(1),                                          1861 08703000
*          ODD   PTR(31),                                          1861 08704000
*          ODSN  PTR(31),                                          1861 08705000
*          OREC,                                                   1861 08706000
*          OBLK,                                                   1861 08707000
*          OIOCS PTR(31);                                          1861 08708000
*                                                                  1861 08709000
*        /************************************************************/ 08710000
*        /*                                                          */ 08711000
*        /*  LOCAL DECLARATIONS                                      */ 08712000
*        /*                                                          */ 08713000
*        /************************************************************/ 08714000
*                                                                  1862 08715000
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               1862 08716000
*                                      /* STORAGE FOR OPEN ARGUMENT  */ 08717000
*                                      /* LIST                       */ 08718000
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        1863 08719000
*                                                                  1863 08720000
*        /************************************************************/ 08721000
*        /*                                                          */ 08722000
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */ 08723000
*        /*  VERSUS AN OUTPUT DATA SET                               */ 08724000
*        /*                                                          */ 08725000
*        /************************************************************/ 08726000
*                                                                  1864 08727000
*        OLDERID2 = NEWERID2;                                      1864 08728000
         L     @02,@PC00001                                        1864 08729000
         L     @02,GDTTR2(,@02)                                    1864 08730000
         MVC   @TS00001(95),NEWERID2(@02)                          1864 08731000
         MVC   OLDERID2(95,@02),@TS00001                           1864 08732000
*        NEWID2 = 'MPOP';                                          1865 08733000
         MVC   NEWID2(4,@02),@CC01483                              1865 08734000
*        OPENLIST = ''B;                                           1866 08735000
         XC    OPENLIST(48),OPENLIST                               1866 08736000
*        OPNPTR = ADDR(OPENLIST);                                  1867 08737000
         LA    OPNPTR,OPENLIST                                     1867 08738000
*        IF OTYPE = 'I'                                            1868 08739000
*          THEN                                                    1868 08740000
         L     @02,@PC00011                                        1868 08741000
         CLI   OTYPE(@02),C'I'                                     1868 08742000
         BNE   @RF01868                                            1868 08743000
*            /********************************************************/ 08744000
*            /*                                                      */ 08745000
*            /*  OPEN FOR  INPUT SPECIFIED - SET VBS FORMAT          */ 08746000
*            /*                                                      */ 08747000
*            /********************************************************/ 08748000
*                                                                  1869 08749000
*            DO;                                                   1869 08750000
*            OPNOPTIN = ON;                                        1870 08751000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1870 08752000
*            OPNRFMSF = ON;                                        1871 08753000
*            OPNRFMBK = ON;                                        1872 08754000
         OI    OPNRFMSF(OPNPTR),B'00011000'                        1872 08755000
*            OPNBLK = OBLK;                                        1873 08756000
*                                                                  1873 08757000
         L     @02,@PC00011+16                                     1873 08758000
         L     @02,OBLK(,@02)                                      1873 08759000
         ST    @02,OPNBLK(,OPNPTR)                                 1873 08760000
*            /********************************************************/ 08761000
*            /*                                                      */ 08762000
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS               */ 08763000
*            /*  SET DEVICE TYPE ADDRESS                             */ 08764000
*            /*                                                      */ 08765000
*            /********************************************************/ 08766000
*                                                                  1874 08767000
*            IF ADDR(ENV) ^= NULLPTR                               1874 08768000
*              THEN                                                1874 08769000
         SLR   @02,@02                                             1874 08770000
         L     @15,@PC00001+4                                      1874 08771000
         C     @02,FDTPTR+60(,@15)                                 1874 08772000
         BE    @RF01874                                            1874 08773000
*                DO;                                               1875 08774000
*                IF ADDR(PDEV) ^= NULLPTR                          1876 08775000
*                  THEN                                            1876 08776000
         L     @15,FDTPTR+84(,@15)                                 1876 08777000
         CR    @15,@02                                             1876 08778000
         BE    @RF01876                                            1876 08779000
*                    OPNDEVDT = ADDR(PDEVVAL);                     1877 08780000
*                                                                  1877 08781000
         LA    @02,PDEVVAL(,@15)                                   1877 08782000
         ST    @02,OPNDEVDT(,OPNPTR)                               1877 08783000
*                /****************************************************/ 08784000
*                /*                                          @Y30SSFR*/ 08785000
*                /*  IF THE USER SPECIFIED THE BLOCKSIZE     @Y30SSFR*/ 08786000
*                /*  SUBPARAMETER, OVERRIDE THE VALUE OF     @Y30SSFR*/ 08787000
*                /*  OPNBLK WITH THE VALUE SPECIFIED BY THE  @Y30SSFR*/ 08788000
*                /*  USER.                                   @Y30SSFR*/ 08789000
*                /*                                          @Y30SSFR*/ 08790000
*                /****************************************************/ 08791000
*                                                                  1878 08792000
*                IF ADDR(BLKSZ) ^= NULLPTR                 /*@Y30SSFR*/ 08793000
*                  THEN                                    /*@Y30SSFR*/ 08794000
@RF01876 L     @02,@PC00001+4                                      1878 08795000
         L     @02,FDTPTR+80(,@02)                                 1878 08796000
         LTR   @02,@02                                             1878 08797000
         BZ    @RF01878                                            1878 08798000
*                    OPNBLK = BLKSZVAL;                    /*@Y30SSFR*/ 08799000
*                                                                  1879 08800000
         L     @02,BLKSZVAL(,@02)                                  1879 08801000
         ST    @02,OPNBLK(,OPNPTR)                                 1879 08802000
*                IF ADDR(RCSZE) ^= NULLPTR                         1880 08803000
*                  THEN                                            1880 08804000
*                                                                  1880 08805000
@RF01878 L     @02,@PC00001+4                                      1880 08806000
         L     @02,FDTPTR+88(,@02)                                 1880 08807000
         LTR   @02,@02                                             1880 08808000
         BZ    @RF01880                                            1880 08809000
*                    /************************************************/ 08810000
*                    /*                                      @Y30SSFR*/ 08811000
*                    /*  SET THE VALUE OF THE OPNREC FIELD   @Y30SSFR*/ 08812000
*                    /*  OF THE OPNAGL TO BE THE VALUE       @Y30SSFR*/ 08813000
*                    /*  SPECIFIED BY THE USER OR THE        @Y30SSFR*/ 08814000
*                    /*  MINIMUM VALUE, WHICHEVER IS LARGER  @Y30SSFR*/ 08815000
*                    /*                                      @Y30SSFR*/ 08816000
*                    /************************************************/ 08817000
*                                                                  1881 08818000
*                    IF RCSZEVAL > MINRECSZ + 8            /*@Y30SSFR*/ 08819000
*                      THEN                                /*@Y30SSFR*/ 08820000
         L     @02,RCSZEVAL(,@02)                                  1881 08821000
         C     @02,@CF01667                                        1881 08822000
         BNH   @RF01881                                            1881 08823000
*                        OPNREC = RCSZEVAL;                /*@Y30SSFR*/ 08824000
         ST    @02,OPNREC(,OPNPTR)                                 1882 08825000
*                      ELSE                                /*@Y30SSFR*/ 08826000
*                        OPNREC = MINRECSZ + 8;            /*@Y30SSFR*/ 08827000
         B     @RC01881                                            1883 08828000
@RF01881 MVC   OPNREC(4,OPNPTR),@CF01667                           1883 08829000
*                END;                                              1884 08830000
@RC01881 DS    0H                                                  1884 08831000
@RF01880 DS    0H                                                  1885 08832000
*             IF ADDR(INDD) = NULLPTR                              1885 08833000
*               THEN                                               1885 08834000
@RF01874 L     @02,@PC00001+4                                      1885 08835000
         L     @02,FDTPTR+56(,@02)                                 1885 08836000
         LTR   @02,@02                                             1885 08837000
         BNZ   @RF01885                                            1885 08838000
*                 OPNDSN = ODSN;                           /*@YL026UA*/ 08839000
         L     @02,@PC00011+8                                      1886 08840000
         L     @02,ODSN(,@02)                                      1886 08841000
         ST    @02,OPNDSN(,OPNPTR)                                 1886 08842000
*               ELSE                                               1887 08843000
*                 OPNDDN = ODD;                            /*@YL026UA*/ 08844000
         B     @RC01885                                            1887 08845000
@RF01885 L     @02,@PC00011+4                                      1887 08846000
         L     @02,ODD(,@02)                                       1887 08847000
         ST    @02,OPNDDN(,OPNPTR)                                 1887 08848000
*            END;                                                  1888 08849000
*                                                                  1888 08850000
@RC01885 DS    0H                                                  1889 08851000
*        IF OTYPE = 'O'                                            1889 08852000
*          THEN                                                    1889 08853000
*                                                                  1889 08854000
@RF01868 L     @02,@PC00011                                        1889 08855000
         CLI   OTYPE(@02),C'O'                                     1889 08856000
         BNE   @RF01889                                            1889 08857000
*            /********************************************************/ 08858000
*            /*                                                      */ 08859000
*            /*  OPEN FOR OUTPUT FOR VSAM DATA SET.  SET OPEN FOR    */ 08860000
*            /*  OUTPUT.                                             */ 08861000
*            /*                                                      */ 08862000
*            /********************************************************/ 08863000
*                                                                  1890 08864000
*            DO;                                                   1890 08865000
*            OPNOPTOT = ON;                                        1891 08866000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        1891 08867000
*            OPNTYPXM = ON;                                /*@Y30SSFR*/ 08868000
         OI    OPNTYPXM(OPNPTR),B'00010000'                        1892 08869000
*            OPNDDN = ODD;                                 /*@Y30SSFR*/ 08870000
*                                                                  1893 08871000
         L     @02,@PC00011+4                                      1893 08872000
         L     @02,ODD(,@02)                                       1893 08873000
         ST    @02,OPNDDN(,OPNPTR)                                 1893 08874000
*            /********************************************************/ 08875000
*            /*                                              @Y30SSFR*/ 08876000
*            /*  IF IMPORTING AN AIX, SET THE OPNMODAX BIT,  @Y30SSFR*/ 08877000
*            /*  SO THAT WHEN OPENING BY PATH NAME, THE AIX  @Y30SSFR*/ 08878000
*            /*  IS OPENED RATHER THAN THE BASE CLUSTER.     @Y30SSFR*/ 08879000
*            /*                                              @Y30SSFR*/ 08880000
*            /********************************************************/ 08881000
*                                                                  1894 08882000
*            IF FVTPTR(1) -> CTGFVTYP = CTGTAIX            /*@Y30SSFR*/ 08883000
*              THEN                                        /*@Y30SSFR*/ 08884000
         L     @02,FVTPTR                                          1894 08885000
         CLI   CTGFVTYP(@02),C'G'                                  1894 08886000
         BNE   @RF01894                                            1894 08887000
*                OPNMODAX = ON;                            /*@Y30SSFR*/ 08888000
*                                                                  1895 08889000
         OI    OPNMODAX(OPNPTR),B'00001000'                        1895 08890000
*            /********************************************************/ 08891000
*            /*                                                      */ 08892000
*            /*  GET OBJECT PASSWORD, WHICH WILL BE OVERRIDEN        */ 08893000
*            /*  IF A PASSWORD WAS SPECIFIED VIA OUTFILE.    @Y30SSFR*/ 08894000
*            /*                                                      */ 08895000
*            /********************************************************/ 08896000
*                                                                  1896 08897000
*            IF ADDR(OUTDD) ^= NULLPTR                     /*@Y30SSFR*/ 08898000
*              THEN                                        /*@Y30SSFR*/ 08899000
@RF01894 L     @02,@PC00001+4                                      1896 08900000
         L     @02,FDTPTR+4(,@02)                                  1896 08901000
         LTR   @02,@02                                             1896 08902000
         BZ    @RF01896                                            1896 08903000
*                DO;                                       /*@Y30SSFR*/ 08904000
*                IF OUTDDPLN ^= 0                          /*@Y30SSFR*/ 08905000
*                  THEN                                    /*@Y30SSFR*/ 08906000
         CLI   OUTDDPLN(@02),0                                     1898 08907000
         BE    @RF01898                                            1898 08908000
*                    OPNPWA = ADDR(OUTDDPAS);              /*@Y30SSFR*/ 08909000
         LA    @02,OUTDDPAS(,@02)                                  1899 08910000
         ST    @02,OPNPWA(,OPNPTR)                                 1899 08911000
*                END;                                      /*@Y30SSFR*/ 08912000
*              ELSE                                        /*#Y30SSFR*/ 08913000
*                IF ADDR(OUTDS) ^= NULLPTR                 /*@Y30SSFR*/ 08914000
*                  THEN                                    /*@Y30SSFR*/ 08915000
         B     @RC01896                                            1901 08916000
@RF01896 L     @02,@PC00001+4                                      1901 08917000
         L     @02,FDTPTR+96(,@02)                                 1901 08918000
         LTR   @02,@02                                             1901 08919000
         BZ    @RF01901                                            1901 08920000
*                    DO;                                   /*@Y30SSFR*/ 08921000
*                    IF OUTDSPLN ^= 0                      /*@Y30SSFR*/ 08922000
*                      THEN                                /*@Y30SSFR*/ 08923000
         CLI   OUTDSPLN(@02),0                                     1903 08924000
         BE    @RF01903                                            1903 08925000
*                        OPNPWA = ADDR(OUTDSPAS);          /*@Y30SSFR*/ 08926000
         LA    @02,OUTDSPAS(,@02)                                  1904 08927000
         ST    @02,OPNPWA(,OPNPTR)                                 1904 08928000
*                    END;                                  /*@Y30SSFR*/ 08929000
*                                                                  1905 08930000
@RF01903 DS    0H                                                  1906 08931000
*            /********************************************************/ 08932000
*            /*                                              @Y30SSFR*/ 08933000
*            /*  IF THERE IS STILL NO PASSWORD POINTED TO    @Y30SSFR*/ 08934000
*            /*  BY THE OPNAGL, THEN USE THE ONE FROM        @Y30SSFR*/ 08935000
*            /*  THE PORTABLE DATA SET.                      @Y30SSFR*/ 08936000
*            /*                                              @Y30SSFR*/ 08937000
*            /********************************************************/ 08938000
*                                                                  1906 08939000
*            IF OPNPWA = NULLPTR                           /*@Y30SSFR*/ 08940000
*              THEN                                        /*@Y30SSFR*/ 08941000
@RF01901 DS    0H                                                  1906 08942000
@RC01896 SLR   @02,@02                                             1906 08943000
         C     @02,OPNPWA(,OPNPTR)                                 1906 08944000
         BNE   @RF01906                                            1906 08945000
*                DO;                                       /*@Y30SSFR*/ 08946000
*                CTGFVPTR = FVTPTR(1);                     /*@Y30SSFR*/ 08947000
         L     @15,FVTPTR                                          1908 08948000
         ST    @15,CTGFVPTR                                        1908 08949000
*                IF CTGFVSTY ^= NULLPTR                    /*@Y30SSFR*/ 08950000
*                  THEN                                    /*@Y30SSFR*/ 08951000
         L     @15,CTGFVSTY(,@15)                                  1909 08952000
         CR    @15,@02                                             1909 08953000
         BE    @RF01909                                            1909 08954000
*                    DO;                                   /*@Y30SSFR*/ 08955000
*                    CTGFLPTR = CTGFVSTY;                  /*@Y30SSFR*/ 08956000
         LR    CTGFLPTR,@15                                        1911 08957000
*                    OPNPWA = CTGFLPT(1);                  /*@Y30SSFR*/ 08958000
         L     @05,CTGFLPT(,CTGFLPTR)                              1912 08959000
         ST    @05,OPNPWA(,OPNPTR)                                 1912 08960000
*                    END;                                  /*@Y30SSFR*/ 08961000
*                END;                                      /*@Y30SSFR*/ 08962000
@RF01909 DS    0H                                                  1915 08963000
*            END;                                                  1915 08964000
*                                                                  1915 08965000
@RF01906 DS    0H                                                  1916 08966000
*        /************************************************************/ 08967000
*        /*                                                          */ 08968000
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */ 08969000
*        /*  INPUT                                                   */ 08970000
*        /*                                                          */ 08971000
*        /************************************************************/ 08972000
*                                                                  1916 08973000
*        OPNIOC = OIOCS;                                           1916 08974000
*                                                                  1916 08975000
@RF01889 L     @15,@PC00011+20                                     1916 08976000
         L     @15,OIOCS(,@15)                                     1916 08977000
         ST    @15,OPNIOC(,OPNPTR)                                 1916 08978000
*        /************************************************************/ 08979000
*        /*                                                          */ 08980000
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */ 08981000
*        /*                                                          */ 08982000
*        /************************************************************/ 08983000
*                                                                  1917 08984000
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            1917 08985000
*                                                                  1917 08986000
         L     @15,@PC00001                                        1917 08987000
         ST    @15,@AL00001                                        1917 08988000
         ST    OPNPTR,@AL00001+4                                   1917 08989000
         MVI   @AL00001+4,X'80'                                    1917 08990000
         L     @15,GDTOPN(,@15)                                    1917 08991000
         LA    @01,@AL00001                                        1917 08992000
         BALR  @14,@15                                             1917 08993000
*        RESPECIFY RTNREG RSTD;                                    1918 08994000
*        TESTRC = RTNREG;                                          1919 08995000
         LR    TESTRC,RTNREG                                       1919 08996000
*        RESPECIFY RTNREG UNRSTD;                                  1920 08997000
*                                                                  1920 08998000
*        /************************************************************/ 08999000
*        /*                                                          */ 09000000
*        /*  TEST RETURN CODE FROM OPEN.  IF NOT SUCCESSFUL, CLOSE   */ 09001000
*        /*  DATA SET TO FREE CORE, AND SET RETURN CODE TO FAILURE   */ 09002000
*        /*                                                          */ 09003000
*        /************************************************************/ 09004000
*                                                                  1921 09005000
*        IF TESTRC ^= 0                                            1921 09006000
*          THEN                                                    1921 09007000
         LTR   TESTRC,TESTRC                                       1921 09008000
         BZ    @RF01921                                            1921 09009000
*            DO;                                                   1922 09010000
*                                                                  1922 09011000
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);                      1923 09012000
*                                                                  1923 09013000
         L     @02,@PC00001                                        1923 09014000
         ST    @02,@AL00001                                        1923 09015000
         L     @15,@PC00011+20                                     1923 09016000
         L     @01,OIOCS(,@15)                                     1923 09017000
         ST    @01,@AL00001+4                                      1923 09018000
         MVI   @AL00001+4,X'80'                                    1923 09019000
         L     @15,GDTCLS(,@02)                                    1923 09020000
         LA    @01,@AL00001                                        1923 09021000
         BALR  @14,@15                                             1923 09022000
*            OIOCSPTR = NULLPTR;                                   1924 09023000
         L     @02,@PC00011+20                                     1924 09024000
         L     @02,OIOCS(,@02)                                     1924 09025000
         SLR   @15,@15                                             1924 09026000
         ST    @15,OIOCSPTR(,@02)                                  1924 09027000
*            RETURN CODE(LASTCC12);                                1925 09028000
         LA    @15,12                                              1925 09029000
         L     @14,@SA00011                                        1925 09030000
         LM    @00,@02,@SA00011+8                                  1925 09031000
         LM    @04,@12,@SA00011+20                                 1925 09032000
         BR    @14                                                 1925 09033000
*            END;                                                  1926 09034000
*          ELSE                                                    1927 09035000
*            /********************************************************/ 09036000
*            /*                                                      */ 09037000
*            /*  RETURN TO CALLER WITH SUCCESS INDICATED             */ 09038000
*            /*                                                      */ 09039000
*            /********************************************************/ 09040000
*                                                                  1927 09041000
*            RETURN CODE(0);                                       1927 09042000
*                                                                  1927 09043000
@RF01921 SLR   @15,@15                                             1927 09044000
         L     @14,@SA00011                                        1927 09045000
         LM    @00,@02,@SA00011+8                                  1927 09046000
         LM    @04,@12,@SA00011+20                                 1927 09047000
         BR    @14                                                 1927 09048000
*END OPENPROC;                                                     1928 09049000
*        /************************************************************/ 09050000
*        /*                                                          */ 09051000
*        /*  PROCEDURE NAME - RANGPROC                               */ 09052000
*        /*                                                          */ 09053000
*        /*  FUNCTION - RANGPROC WILL PROCESS ALL INFORMATIION       */ 09054000
*        /*  DEALING WITH KEYRANGES.  IT WILL BUILD THE RANGES LIST  */ 09055000
*        /*  THE HIKEYV AND LOKEYV CATALOG INFORMATION FROM  VOLUME  */ 09056000
*        /*  OF PORTABILITY, AND IT WILL BUILD THE RANGES LIST FROM  */ 09057000
*        /*  THE OBJECTS PARAMETER IN THE AMS COMMAND.               */ 09058000
*        /*  WHEN THE LIST IS CONSTRUCTED FROM THE KEYRANGES PARAMETER* 09059000
*        /*  IN THE AMS COMMAND, A POINTER TO THE LIST IS PLACED IN  */ 09060000
*        /*  THE FIELD RANGEPTR, THEN PRIOR TO CALLING CATALOG       */ 09061000
*        /*  MANAGEMENT, THE POINTER IS PLACED IN THE DATA FVT.      */ 09062000
*        /*                                                          */ 09063000
*        /*  INPUT -                                                 */ 09064000
*        /*    RX - INDEX TO OBJECT PARAMETER OR ZERO                */ 09065000
*        /*    RDICT - DICTIONARY POINTER                            */ 09066000
*        /*    RWKA - WORK AREA POINTER (CONTAINS CATALOG FIELD INFO)*/ 09067000
*        /*    RRANGPTR - PTR TO FIELD IN WHICH TO PLACE LISTRNGS    */ 09068000
*        /*    POINTER                                               */ 09069000
*        /*                                                          */ 09070000
*        /*  OUTPUT - A LISTRNGS LIST OF KEY RANGES WILL HAVE BEEN   */ 09071000
*        /*  CONSTRUCTED                                             */ 09072000
*        /*                                                          */ 09073000
*        /************************************************************/ 09074000
*                                                                  1929 09075000
*RANGPROC: PROCEDURE(RX,               /*INDEX TO OBJECTS PARAMETER  */ 09076000
*                   RDICT,             /*DICTIONARY POINTER          */ 09077000
*                   RWKA,              /*WORK AREA POINTER           */ 09078000
*                   RRANGPTR);         /*RETURN CELL FOR LISTRNGS    */ 09079000
RANGPROC STM   @14,@12,@SA00012                                    1929 09080000
         MVC   @PC00012(16),0(@01)                                 1929 09081000
*                                      /*LIST                        */ 09082000
*                                                                  1930 09083000
*        /************************************************************/ 09084000
*        /*                                                          */ 09085000
*        /*  ARGUMENTS OF INVOCATION                                 */ 09086000
*        /*                                                          */ 09087000
*        /************************************************************/ 09088000
*                                                                  1930 09089000
*        DCL RX        FIXED(31),                                  1930 09090000
*            RDICT     PTR(31),                                    1930 09091000
*            RWKA      PTR(31),                                    1930 09092000
*            RRANGPTR  PTR(31);                                    1930 09093000
*                                                                  1930 09094000
*        /************************************************************/ 09095000
*        /*                                                          */ 09096000
*        /*  LOCAL DECLARES                                          */ 09097000
*        /*                                                          */ 09098000
*        /************************************************************/ 09099000
*        DCL KEYLENGH FIXED(31);                                   1931 09100000
*        DCL 1 FRANGLST BASED(RRANGPTR),                           1932 09101000
*              2 FRANGLN   FIXED(15);  /*LENGTH OF LIST EXCLUDING    */ 09102000
*                                      /*THIS 2-BYTE FIELD           */ 09103000
*       DCL 1 FRANGES BASED(FRANPTR1),/*DESCRIPTION OF EACH HIGH  */    09104000
*                                      /*KEY-LOW KEY PAIR            */ 09105000
*                2 FKEYLN FIXED(15),   /*LENGTH OF LOW KEY           */ 09106000
*                2 FKEY   CHAR(*);    /*VARIABLE LENGTH KEY         */  09107000
*        DCL FRANPTR1 PTR(31);         /*POINTER TO EACH MEMBER OF   */ 09108000
*                                      /*LOW KEY-HIGH KEY PAIR       */ 09109000
*                                                                  1935 09110000
*        DCL RPTR1  PTR(31);           /*POINTER TO KEY VALUE        */ 09111000
*        DCL RPTR2  PTR(31);           /*POINTER TO KEY VALUE        */ 09112000
*        DCL LENG   FIXED(15);         /*USED TO CONSTRUCT LISTRNGS  */ 09113000
*                                      /*FROM HIKEYV-LOKEYV FIELDS   */ 09114000
*        DCL RDOCNTRL BIT(1);          /*LOOP CONTROL                */ 09115000
*        DCL LKEY  CHAR(64);                                       1939 09116000
*        DCL HKEY  CHAR(64);           /*HIGH KEY FOR RANGE VALIDITY */ 09117000
*                                      /*CHECK                       */ 09118000
*        DCL 1 FFS    CHAR(64) STATIC LOCAL,               /*@Y30SSFR*/ 09119000
*              2 *(64) CHAR(1) INIT ((64)'FF'X);           /*@ZA00954*/ 09120000
*        DCL KERROR BIT(1);            /*SET WHEN KEYRANGES INVALID  */ 09121000
*        DCL HILN  FIXED(31);          /*LENGTH OF HIGH KEY  @Y30SSFR*/ 09122000
*        DCL LOWLN FIXED(31);          /*LENGTH OF LOW KEY   @Y30SSFR*/ 09123000
*                                                                  1944 09124000
*        /************************************************************/ 09125000
*        /*                                                          */ 09126000
*        /*  IF THE DICTIONARY POINTER IS ZERO, THEN CONSTRUCT THE   */ 09127000
*        /*  KEY RANGES LIST FROM THE OBJECT PARAMETER IN AMS COMMAND*/ 09128000
*        /*                                                          */ 09129000
*        /************************************************************/ 09130000
*                                                                  1945 09131000
*        IF RDICT = NULLPTR                                        1945 09132000
*          THEN                                                    1945 09133000
         L     @15,@PC00012+4                                      1945 09134000
         L     @15,RDICT(,@15)                                     1945 09135000
         LTR   @15,@15                                             1945 09136000
         BNZ   @RF01945                                            1945 09137000
*RANGFCMD:   DO;                                                   1946 09138000
*                                                                  1946 09139000
RANGFCMD DS    0H                                                  1947 09140000
*            /********************************************************/ 09141000
*            /*                                                      */ 09142000
*            /*  IF RANGES WAS SPECIFIED IN THE AMS COMMAND,         */ 09143000
*            /*  CONSTRUCT A KEY RANGES LIST                         */ 09144000
*            /*                                                      */ 09145000
*            /********************************************************/ 09146000
*                                                                  1947 09147000
*            IF RANGEPTR(RX) ^= NULLPTR                            1947 09148000
*              THEN                                                1947 09149000
         L     @15,@PC00012                                        1947 09150000
         L     @15,RX(,@15)                                        1947 09151000
         SLA   @15,2                                               1947 09152000
         L     @14,@PC00001+4                                      1947 09153000
         L     @01,FDTPTR+28(,@14)                                 1947 09154000
         AL    @01,@CF01689                                        1947 09155000
         L     @15,RANGEPTR(@15,@01)                               1947 09156000
         LTR   @15,@15                                             1947 09157000
         BZ    @RF01947                                            1947 09158000
*                DO;                                               1948 09159000
*                                                                  1948 09160000
*                /****************************************************/ 09161000
*                /*                                                  */ 09162000
*                /*  VALIDITY CHECK KEY RANGES SPECIFIED BY USER     */ 09163000
*                /*                                                  */ 09164000
*                /****************************************************/ 09165000
*                                                                  1949 09166000
*                KERROR = OFF;                                     1949 09167000
         NI    KERROR,B'01111111'                                  1949 09168000
*KCOMP1:         DO N = 1 TO RANGECNT(RX) WHILE KERROR = OFF;      1950 09169000
KCOMP1   LA    N,1                                                 1950 09170000
         B     @DE01950                                            1950 09171000
@DL01950 TM    KERROR,B'10000000'                                  1950 09172000
         BNZ   @DC01950                                            1950 09173000
*                  LKEY = ''B;                                     1951 09174000
         XC    LKEY(64),LKEY                                       1951 09175000
*                  HKEY = FFS;                                     1952 09176000
         MVC   HKEY(64),FFS                                        1952 09177000
*                  LKEY = LOWKYPTR(RX,N) ->                        1953 09178000
*                    LOWKYVAL(1:LOWKYPTR(RX,N) -> LOWKYLEN);       1953 09179000
         MVI   LKEY+1,C' '                                         1953 09180000
         MVC   LKEY+2(62),LKEY+1                                   1953 09181000
         L     @02,@PC00012                                        1953 09182000
         L     @02,RX(,@02)                                        1953 09183000
         MH    @02,@CH00629                                        1953 09184000
         ALR   @02,N                                               1953 09185000
         SLA   @02,2                                               1953 09186000
         L     @15,@PC00001+4                                      1953 09187000
         L     @01,FDTPTR+44(,@15)                                 1953 09188000
         AL    @01,@CF01710                                        1953 09189000
         L     @14,LOWKYPTR(@02,@01)                               1953 09190000
         SLR   @05,@05                                             1953 09191000
         IC    @05,LOWKYLEN(,@14)                                  1953 09192000
         BCTR  @05,0                                               1953 09193000
         EX    @05,@SM01711                                        1953 09194000
*                  HKEY = HIKEYPTR(RX,N) ->                        1954 09195000
*                    HIKEYVAL(1:HIKEYPTR(RX,N) -> HIKEYLEN);       1954 09196000
*                                                                  1954 09197000
         MVI   HKEY+1,C' '                                         1954 09198000
         MVC   HKEY+2(62),HKEY+1                                   1954 09199000
         L     @01,FDTPTR+48(,@15)                                 1954 09200000
         AL    @01,@CF01710                                        1954 09201000
         L     @02,HIKEYPTR(@02,@01)                               1954 09202000
         SLR   @15,@15                                             1954 09203000
         IC    @15,HIKEYLEN(,@02)                                  1954 09204000
         BCTR  @15,0                                               1954 09205000
         EX    @15,@SM01713                                        1954 09206000
*                /****************************************************/ 09207000
*                /*                                                  */ 09208000
*                /*  CHECK THAT HIGH KEY IS INDEED HIGHER THAN LOW   */ 09209000
*                /*  KEY                                             */ 09210000
*                /*                                                  */ 09211000
*                /****************************************************/ 09212000
*                                                                  1955 09213000
*                  IF HKEY < LKEY                                  1955 09214000
*                    THEN                                          1955 09215000
         CLC   HKEY(64),LKEY                                       1955 09216000
         BNL   @RF01955                                            1955 09217000
*                      KERROR = ON;                                1956 09218000
*                                                                  1956 09219000
         OI    KERROR,B'10000000'                                  1956 09220000
*                  /**************************************************/ 09221000
*                  /*                                                */ 09222000
*                  /*  CHECK FOR OVERLAP BETEEN HIGH KEY-LOW KEY     */ 09223000
*                  /*  PAIRS                                         */ 09224000
*                  /*                                                */ 09225000
*                  /**************************************************/ 09226000
*                                                                  1957 09227000
*                  DO J = (N + 1) TO RANGECNT(RX);                 1957 09228000
*                                                                  1957 09229000
@RF01955 LA    J,1                                                 1957 09230000
         ALR   J,N                                                 1957 09231000
         B     @DE01957                                            1957 09232000
@DL01957 DS    0H                                                  1958 09233000
*                    LOWLN = LOWKYPTR(RX,J) -> LOWKYLEN;           1958 09234000
         L     @05,@PC00012                                        1958 09235000
         L     @05,RX(,@05)                                        1958 09236000
         MH    @05,@CH00629                                        1958 09237000
         ALR   @05,J                                               1958 09238000
         SLA   @05,2                                               1958 09239000
         L     @15,@PC00001+4                                      1958 09240000
         L     @01,FDTPTR+44(,@15)                                 1958 09241000
         AL    @01,@CF01710                                        1958 09242000
         L     @14,LOWKYPTR(@05,@01)                               1958 09243000
         SLR   @01,@01                                             1958 09244000
         IC    @01,LOWKYLEN(,@14)                                  1958 09245000
         ST    @01,LOWLN                                           1958 09246000
*                    HILN = HIKEYPTR(RX,J) -> HIKEYLEN;            1959 09247000
*                                                                  1959 09248000
         L     @15,FDTPTR+48(,@15)                                 1959 09249000
         AL    @15,@CF01710                                        1959 09250000
         L     @15,HIKEYPTR(@05,@15)                               1959 09251000
         SLR   HILN,HILN                                           1959 09252000
         IC    HILN,HIKEYLEN(,@15)                                 1959 09253000
*                    IF LKEY(1:LOWLN) >= LOWKYPTR(RX,J) ->         1960 09254000
*                      LOWKYVAL(1:LOWLN) &                         1960 09255000
*                      LKEY(1:HILN) <= HIKEYPTR(RX,J)->HIKEYVAL(1:HILN) 09256000
*                      THEN                                        1960 09257000
         BCTR  @01,0                                               1960 09258000
         EX    @01,@SC01715                                        1960 09259000
         BL    @RF01960                                            1960 09260000
         LR    @05,HILN                                            1960 09261000
         BCTR  @05,0                                               1960 09262000
         EX    @05,@SC01717                                        1960 09263000
         BH    @RF01960                                            1960 09264000
*                        KERROR = ON;                              1961 09265000
*                                                                  1961 09266000
         OI    KERROR,B'10000000'                                  1961 09267000
*                    IF HKEY(1:LOWLN) >= LOWKYPTR(RX,J) ->         1962 09268000
*                      LOWKYVAL(1:LOWLN) &                         1962 09269000
*                      HKEY(1:HILN) <= HIKEYPTR(RX,J)->HIKEYVAL(1:HILN) 09270000
*                      THEN                                        1962 09271000
@RF01960 L     @05,@PC00012                                        1962 09272000
         L     @05,RX(,@05)                                        1962 09273000
         MH    @05,@CH00629                                        1962 09274000
         ALR   @05,J                                               1962 09275000
         SLA   @05,2                                               1962 09276000
         L     @15,@PC00001+4                                      1962 09277000
         L     @01,FDTPTR+44(,@15)                                 1962 09278000
         AL    @01,@CF01710                                        1962 09279000
         L     @01,LOWKYPTR(@05,@01)                               1962 09280000
         L     @14,LOWLN                                           1962 09281000
         BCTR  @14,0                                               1962 09282000
         EX    @14,@SC01719                                        1962 09283000
         BL    @RF01962                                            1962 09284000
         L     @01,FDTPTR+48(,@15)                                 1962 09285000
         AL    @01,@CF01710                                        1962 09286000
         L     @05,HIKEYPTR(@05,@01)                               1962 09287000
         LR    @15,HILN                                            1962 09288000
         BCTR  @15,0                                               1962 09289000
         EX    @15,@SC01721                                        1962 09290000
         BH    @RF01962                                            1962 09291000
*                        KERROR = ON;                              1963 09292000
         OI    KERROR,B'10000000'                                  1963 09293000
*                  END;                                            1964 09294000
@RF01962 AL    J,@CF00221                                          1964 09295000
@DE01957 L     @15,@PC00012                                        1964 09296000
         L     @15,RX(,@15)                                        1964 09297000
         SLA   @15,2                                               1964 09298000
         L     @14,@PC00001+4                                      1964 09299000
         L     @01,FDTPTR+28(,@14)                                 1964 09300000
         AL    @01,@CF01689                                        1964 09301000
         C     J,RANGECNT(@15,@01)                                 1964 09302000
         BNH   @DL01957                                            1964 09303000
*                END KCOMP1;                                       1965 09304000
*                                                                  1965 09305000
         AL    N,@CF00221                                          1965 09306000
@DE01950 L     @02,@PC00012                                        1965 09307000
         L     @02,RX(,@02)                                        1965 09308000
         SLA   @02,2                                               1965 09309000
         L     @15,@PC00001+4                                      1965 09310000
         L     @01,FDTPTR+28(,@15)                                 1965 09311000
         AL    @01,@CF01689                                        1965 09312000
         C     N,RANGECNT(@02,@01)                                 1965 09313000
         BNH   @DL01950                                            1965 09314000
@DC01950 DS    0H                                                  1966 09315000
*                /****************************************************/ 09316000
*                /*                                                  */ 09317000
*                /*  IF KEYRANGES ARE INVALID, TERMINATE WITH ERROR  */ 09318000
*                /*                                                  */ 09319000
*                /****************************************************/ 09320000
*                                                                  1966 09321000
*                IF KERROR = ON                                    1966 09322000
*                  THEN                                            1966 09323000
         TM    KERROR,B'10000000'                                  1966 09324000
         BNO   @RF01966                                            1966 09325000
*                    DO;                                           1967 09326000
*                    DEFSTID = BADRANG;                            1968 09327000
         MVI   DEFSTID,X'0F'                                       1968 09328000
*                    DARGSMOD = DEFMODID;                          1969 09329000
         L     @01,DDSTRU                                          1969 09330000
         MVC   DARGSMOD(3,@01),@CC01038                            1969 09331000
*                    RETURN CODE(LASTCC12);                        1970 09332000
         LA    @15,12                                              1970 09333000
         L     @14,@SA00012                                        1970 09334000
         LM    @00,@12,@SA00012+8                                  1970 09335000
         BR    @14                                                 1970 09336000
*                    END;                                          1971 09337000
*                                                                  1971 09338000
*                /****************************************************/ 09339000
*                /*                                                  */ 09340000
*                /*  COMPUTE THE AMOUNT OF CORE NEEDED FOR THE RANGES*/ 09341000
*                /*  LIST AND OBTAIN THAT MUCH CORE                  */ 09342000
*                /*                                                  */ 09343000
*                /****************************************************/ 09344000
*                                                                  1972 09345000
*                KEYLENGH = 0;                                     1972 09346000
@RF01966 SLR   KEYLENGH,KEYLENGH                                   1972 09347000
*                DO N= 1 TO RANGECNT(RX);                          1973 09348000
         LA    N,1                                                 1973 09349000
         B     @DE01973                                            1973 09350000
@DL01973 DS    0H                                                  1974 09351000
*                  KEYLENGH = KEYLENGH + LOWKYPTR(RX,N) -> LOWKYLEN     09352000
*                    + HIKEYPTR(RX,N) ->  HIKEYLEN;                1974 09353000
         L     @15,@PC00012                                        1974 09354000
         L     @15,RX(,@15)                                        1974 09355000
         MH    @15,@CH00629                                        1974 09356000
         ALR   @15,N                                               1974 09357000
         SLA   @15,2                                               1974 09358000
         L     @14,@PC00001+4                                      1974 09359000
         L     @01,FDTPTR+44(,@14)                                 1974 09360000
         AL    @01,@CF01710                                        1974 09361000
         L     @01,LOWKYPTR(@15,@01)                               1974 09362000
         LR    @00,KEYLENGH                                        1974 09363000
         SLR   @05,@05                                             1974 09364000
         IC    @05,LOWKYLEN(,@01)                                  1974 09365000
         ALR   @00,@05                                             1974 09366000
         L     @01,FDTPTR+48(,@14)                                 1974 09367000
         AL    @01,@CF01710                                        1974 09368000
         L     @01,HIKEYPTR(@15,@01)                               1974 09369000
         SLR   @15,@15                                             1974 09370000
         IC    @15,HIKEYLEN(,@01)                                  1974 09371000
         ALR   @00,@15                                             1974 09372000
         LR    KEYLENGH,@00                                        1974 09373000
*                END;                                              1975 09374000
         AL    N,@CF00221                                          1975 09375000
@DE01973 L     @15,@PC00012                                        1975 09376000
         L     @15,RX(,@15)                                        1975 09377000
         SLA   @15,2                                               1975 09378000
         L     @14,@PC00001+4                                      1975 09379000
         L     @01,FDTPTR+28(,@14)                                 1975 09380000
         AL    @01,@CF01689                                        1975 09381000
         C     N,RANGECNT(@15,@01)                                 1975 09382000
         BNH   @DL01973                                            1975 09383000
*                TOTLEN = (RANGECNT(RX) * 4) +  KEYLENGH + 2;      1976 09384000
*                                                                  1976 09385000
         L     @03,@PC00012                                        1976 09386000
         L     @03,RX(,@03)                                        1976 09387000
         SLA   @03,2                                               1976 09388000
         L     @15,@PC00001+4                                      1976 09389000
         L     @01,FDTPTR+28(,@15)                                 1976 09390000
         AL    @01,@CF01689                                        1976 09391000
         L     @03,RANGECNT(@03,@01)                               1976 09392000
         SLA   @03,2                                               1976 09393000
         ALR   @03,KEYLENGH                                        1976 09394000
         AL    @03,@CF00156                                        1976 09395000
         ST    @03,TOTLEN                                          1976 09396000
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,RRANGPTR,GPID,SETZERO);   09397000
*                                                                  1977 09398000
         L     @03,@PC00001                                        1977 09399000
         ST    @03,@AL00001                                        1977 09400000
         LA    @15,TOTLEN                                          1977 09401000
         ST    @15,@AL00001+4                                      1977 09402000
         L     @15,@PC00012+12                                     1977 09403000
         ST    @15,@AL00001+8                                      1977 09404000
         LA    @15,GPID                                            1977 09405000
         ST    @15,@AL00001+12                                     1977 09406000
         LA    @15,SETZERO                                         1977 09407000
         ST    @15,@AL00001+16                                     1977 09408000
         MVI   @AL00001+16,X'80'                                   1977 09409000
         L     @15,GDTGPL(,@03)                                    1977 09410000
         LA    @01,@AL00001                                        1977 09411000
         BALR  @14,@15                                             1977 09412000
*                RESPECIFY RTNREG RSTD;                            1978 09413000
*                TESTRC = RTNREG;                                  1979 09414000
         LR    TESTRC,RTNREG                                       1979 09415000
*                RESPECIFY RTNREG UNRSTD;                          1980 09416000
*                IF TESTRC ^= 0                                    1981 09417000
*                  THEN                                            1981 09418000
*                                                                  1981 09419000
         LTR   TESTRC,TESTRC                                       1981 09420000
         BZ    @RF01981                                            1981 09421000
*                    /************************************************/ 09422000
*                    /*                                              */ 09423000
*                    /*  CORE WAS NOT OBTAINED SUCCESSFULLY. RETURN  */ 09424000
*                    /*  TO CALLING PROCESSOR.                       */ 09425000
*                    /*                                              */ 09426000
*                    /************************************************/ 09427000
*                                                                  1982 09428000
*                    DO;                                           1982 09429000
*                    DARGSMOD = UNIVMSG;                           1983 09430000
         L     @01,DDSTRU                                          1983 09431000
         MVC   DARGSMOD(3,@01),@CC01023                            1983 09432000
*                    DEFSTID = NOSTORAG;                           1984 09433000
         MVI   DEFSTID,X'04'                                       1984 09434000
*                    RETURN CODE(LASTCC12);                        1985 09435000
         LA    @15,12                                              1985 09436000
         L     @14,@SA00012                                        1985 09437000
         LM    @00,@12,@SA00012+8                                  1985 09438000
         BR    @14                                                 1985 09439000
*                    END;                                          1986 09440000
*                FRANPTR1 = RRANGPTR + 2;                          1987 09441000
*                                                                  1987 09442000
@RF01981 L     @15,@PC00012+12                                     1987 09443000
         LA    FRANPTR1,2                                          1987 09444000
         AL    FRANPTR1,RRANGPTR(,@15)                             1987 09445000
*                /****************************************************/ 09446000
*                /*                                                  */ 09447000
*                /*  NOW CONSTRUCT THE RANGES LIST FROM THE HIGH     */ 09448000
*                /*  KEY- LOW KEY PAIRS SPECIFIED IN THE AMS COMMAND */ 09449000
*                /*                                                  */ 09450000
*                /****************************************************/ 09451000
*                                                                  1988 09452000
*                DO N = 1 TO RANGECNT(RX);                         1988 09453000
*                                                                  1988 09454000
         LA    N,1                                                 1988 09455000
         B     @DE01988                                            1988 09456000
@DL01988 DS    0H                                                  1989 09457000
*                  /**************************************************/ 09458000
*                  /*                                                */ 09459000
*                  /*  SET LENGTH OF LOW KEY AND MOVE LOW KEY INTO   */ 09460000
*                  /*  LIST.                                         */ 09461000
*                  /*                                                */ 09462000
*                  /**************************************************/ 09463000
*                                                                  1989 09464000
*                  FKEYLN = LOWKYPTR(RX,N) -> LOWKYLEN;            1989 09465000
         L     @15,@PC00012                                        1989 09466000
         L     @15,RX(,@15)                                        1989 09467000
         MH    @15,@CH00629                                        1989 09468000
         ALR   @15,N                                               1989 09469000
         SLA   @15,2                                               1989 09470000
         L     @14,@PC00001+4                                      1989 09471000
         L     @01,FDTPTR+44(,@14)                                 1989 09472000
         AL    @01,@CF01710                                        1989 09473000
         L     @05,LOWKYPTR(@15,@01)                               1989 09474000
         SLR   @04,@04                                             1989 09475000
         IC    @04,LOWKYLEN(,@05)                                  1989 09476000
         STH   @04,FKEYLN(,FRANPTR1)                               1989 09477000
*                  FKEY(1:FKEYLN) = LOWKYPTR(RX,N) ->              1990 09478000
*                     LOWKYVAL(1:FKEYLN);                          1990 09479000
         LR    @01,@04                                             1990 09480000
         BCTR  @01,0                                               1990 09481000
         EX    @01,@SM01723                                        1990 09482000
*                  FRANPTR1 = FRANPTR1 + LENGTH(FKEYLN) + FKEYLN;  1991 09483000
*                                                                  1991 09484000
         LA    @05,2                                               1991 09485000
         LR    @01,FRANPTR1                                        1991 09486000
         ALR   @01,@05                                             1991 09487000
         ALR   @01,@04                                             1991 09488000
         LR    FRANPTR1,@01                                        1991 09489000
*                  /**************************************************/ 09490000
*                  /*                                                */ 09491000
*                  /*  SET LENGTH OF HIGH KEY AND MOVE HIGH KEY INTO */ 09492000
*                  /*  LIST.                                         */ 09493000
*                  /*                                                */ 09494000
*                  /**************************************************/ 09495000
*                                                                  1992 09496000
*                  FKEYLN = HIKEYPTR(RX,N) -> HIKEYLEN;            1992 09497000
         L     @01,FDTPTR+48(,@14)                                 1992 09498000
         AL    @01,@CF01710                                        1992 09499000
         L     @04,HIKEYPTR(@15,@01)                               1992 09500000
         SLR   @15,@15                                             1992 09501000
         IC    @15,HIKEYLEN(,@04)                                  1992 09502000
         STH   @15,FKEYLN(,FRANPTR1)                               1992 09503000
*                  FKEY(1:FKEYLN) = HIKEYPTR(RX,N) ->              1993 09504000
*                    HIKEYVAL(1:FKEYLN);                           1993 09505000
         LR    @14,@15                                             1993 09506000
         BCTR  @14,0                                               1993 09507000
         EX    @14,@SM01725                                        1993 09508000
*                  FRANPTR1 = FRANPTR1 + LENGTH(FKEYLN) + FKEYLN;  1994 09509000
         ALR   @05,FRANPTR1                                        1994 09510000
         ALR   @05,@15                                             1994 09511000
         LR    FRANPTR1,@05                                        1994 09512000
*                  END;                                            1995 09513000
*                                                                  1995 09514000
         AL    N,@CF00221                                          1995 09515000
@DE01988 L     @15,@PC00012                                        1995 09516000
         L     @15,RX(,@15)                                        1995 09517000
         SLA   @15,2                                               1995 09518000
         L     @14,@PC00001+4                                      1995 09519000
         L     @01,FDTPTR+28(,@14)                                 1995 09520000
         AL    @01,@CF01689                                        1995 09521000
         C     N,RANGECNT(@15,@01)                                 1995 09522000
         BNH   @DL01988                                            1995 09523000
*                /****************************************************/ 09524000
*                /*                                                  */ 09525000
*                /*  SET TOTAL LENGTH OF LIST IN FIRST TWO BYTES OF  */ 09526000
*                /*  OF THE LIST.                                    */ 09527000
*                /*                                                  */ 09528000
*                /****************************************************/ 09529000
*                                                                  1996 09530000
*                FRANGLN = TOTLEN;                                 1996 09531000
         L     @15,@PC00012+12                                     1996 09532000
         L     @01,RRANGPTR(,@15)                                  1996 09533000
         L     @00,TOTLEN                                          1996 09534000
         STH   @00,FRANGLN(,@01)                                   1996 09535000
*                END;                                              1997 09536000
*                                                                  1997 09537000
*          ELSE;                                                   1998 09538000
@RF01947 DS    0H                                                  1999 09539000
*        END RANGFCMD;                                             1999 09540000
*                                                                  1999 09541000
*          /**********************************************************/ 09542000
*          /*                                                        */ 09543000
*          /*  THE RANGE LIST IS TO BE CONSTRUCTED FROM CATALOG      */ 09544000
*          /*  INFORMATION READ IN FROM THE PORTABILITY VOLUME.      */ 09545000
*          /*  THE HIKEYV AND LOKEYV CATALOG FIELDS CONTAIN THE      */ 09546000
*          /*  INFORMATION                                           */ 09547000
*          /*                                                        */ 09548000
*          /**********************************************************/ 09549000
*                                                                  2000 09550000
*          ELSE                                                    2000 09551000
*RANGFDCT:   DO;                                                   2000 09552000
         B     @RC01945                                            2000 09553000
@RF01945 DS    0H                                                  2000 09554000
RANGFDCT DS    0H                                                  2001 09555000
*            DICTPTR = RDICT;                                      2001 09556000
         L     @15,@PC00012+4                                      2001 09557000
         L     @15,RDICT(,@15)                                     2001 09558000
         ST    @15,DICTPTR                                         2001 09559000
*            IF DICTLN(IHIKEYV) ^= 0 &                             2002 09560000
*              DICTLN(ILOKEYV) ^= 0                                2002 09561000
*              THEN                                                2002 09562000
         SLR   @14,@14                                             2002 09563000
         L     @05,DICTLN+120(,@15)                                2002 09564000
         CR    @05,@14                                             2002 09565000
         BE    @RF02002                                            2002 09566000
         L     @15,DICTLN+112(,@15)                                2002 09567000
         CR    @15,@14                                             2002 09568000
         BE    @RF02002                                            2002 09569000
*                DO;                                               2003 09570000
*                                                                  2003 09571000
*                /****************************************************/ 09572000
*                /*                                                  */ 09573000
*                /*  COMPUTE SIZE OF RANGES LIST  AND OBTAIN CORE    */ 09574000
*                /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING      */ 09575000
*                /*  PROCESSOR                                       */ 09576000
*                /*                                                  */ 09577000
*                /****************************************************/ 09578000
*                                                                  2004 09579000
*                TOTLEN = DICTLN(IHIKEYV) + DICTLN(ILOKEYV) + 2;   2004 09580000
*                                                                  2004 09581000
         ALR   @05,@15                                             2004 09582000
         AL    @05,@CF00156                                        2004 09583000
         ST    @05,TOTLEN                                          2004 09584000
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,RRANGPTR,GPID,SETZERO);   09585000
*                                                                  2005 09586000
         L     @03,@PC00001                                        2005 09587000
         ST    @03,@AL00001                                        2005 09588000
         LA    @15,TOTLEN                                          2005 09589000
         ST    @15,@AL00001+4                                      2005 09590000
         L     @15,@PC00012+12                                     2005 09591000
         ST    @15,@AL00001+8                                      2005 09592000
         LA    @15,GPID                                            2005 09593000
         ST    @15,@AL00001+12                                     2005 09594000
         LA    @15,SETZERO                                         2005 09595000
         ST    @15,@AL00001+16                                     2005 09596000
         MVI   @AL00001+16,X'80'                                   2005 09597000
         L     @15,GDTGPL(,@03)                                    2005 09598000
         LA    @01,@AL00001                                        2005 09599000
         BALR  @14,@15                                             2005 09600000
*                RESPECIFY RTNREG RSTD;                            2006 09601000
*                TESTRC = RTNREG;                                  2007 09602000
         LR    TESTRC,RTNREG                                       2007 09603000
*                RESPECIFY RTNREG UNRSTD;                          2008 09604000
*                IF TESTRC ^= 0                                    2009 09605000
*                  THEN                                            2009 09606000
         LTR   TESTRC,TESTRC                                       2009 09607000
         BZ    @RF02009                                            2009 09608000
*                    DO;                                           2010 09609000
*                    DEFSTID = NOSTORAG;                           2011 09610000
         MVI   DEFSTID,X'04'                                       2011 09611000
*                    DARGSMOD = UNIVMSG;                           2012 09612000
         L     @01,DDSTRU                                          2012 09613000
         MVC   DARGSMOD(3,@01),@CC01023                            2012 09614000
*                    RETURN CODE(LASTCC12);                        2013 09615000
         LA    @15,12                                              2013 09616000
         L     @14,@SA00012                                        2013 09617000
         LM    @00,@12,@SA00012+8                                  2013 09618000
         BR    @14                                                 2013 09619000
*                    END;                                          2014 09620000
*                                                                  2014 09621000
*                /****************************************************/ 09622000
*                /*                                                  */ 09623000
*                /*  SET POINTERS TO START OF HIGH KEY AND LOW KEY   */ 09624000
*                /*  VALUES.  INITIALIZE LOOP CONTROL.               */ 09625000
*                /*                                                  */ 09626000
*                /****************************************************/ 09627000
*                                                                  2015 09628000
*                FRANPTR1 = RRANGPTR + 2;                          2015 09629000
@RF02009 LA    @05,2                                               2015 09630000
         L     @15,@PC00012+12                                     2015 09631000
         L     FRANPTR1,RRANGPTR(,@15)                             2015 09632000
         ALR   FRANPTR1,@05                                        2015 09633000
*                LENG = TOTLEN - 2;                                2016 09634000
         LCR   @05,@05                                             2016 09635000
         AL    @05,TOTLEN                                          2016 09636000
         LR    LENG,@05                                            2016 09637000
*                RPTR1 = DICTDL(ILOKEYV) + RWKA;                   2017 09638000
         L     @15,DICTPTR                                         2017 09639000
         L     @14,@PC00012+8                                      2017 09640000
         L     @14,RWKA(,@14)                                      2017 09641000
         L     RPTR1,DICTDL+112(,@15)                              2017 09642000
         ALR   RPTR1,@14                                           2017 09643000
*                RPTR2 = DICTDL(IHIKEYV) + RWKA;                   2018 09644000
*                                                                  2018 09645000
         AL    @14,DICTDL+120(,@15)                                2018 09646000
         ST    @14,RPTR2                                           2018 09647000
*                DO WHILE LENG > 0;                                2019 09648000
*                                                                  2019 09649000
         B     @DE02019                                            2019 09650000
@DL02019 DS    0H                                                  2020 09651000
*                  /**************************************************/ 09652000
*                  /*                                                */ 09653000
*                  /*  MOVE LOW KEY & LENGTH INTO RANGE LIST. UPDATE */ 09654000
*                  /*  POINTERS AND LOOP CONTROL.                    */ 09655000
*                  /*                                                */ 09656000
*                  /**************************************************/ 09657000
*                                                                  2020 09658000
*                  FKEYLN = RPTR1 -> FIELDR(1:2);                  2020 09659000
*                                                                  2020 09660000
         SLR   @05,@05                                             2020 09661000
         ICM   @05,3,FIELDR(RPTR1)                                 2020 09662000
         STH   @05,FKEYLN(,FRANPTR1)                               2020 09663000
*                  IF FKEYLN ^= 0                          /*@OZ10865*/ 09664000
*                   THEN                                   /*@OZ10865*/ 09665000
         LTR   @05,@05                                             2021 09666000
         BZ    @RF02021                                            2021 09667000
*                     FKEY(1:FKEYLN) = (RPTR1 + 2) -> FIELDR(1:FKEYLN); 09668000
         BCTR  @05,0                                               2022 09669000
         EX    @05,@SM01727                                        2022 09670000
*                                                          /*@OZ10865*/ 09671000
*                  RPTR1 = RPTR1 + FKEYLN + 2;                     2023 09672000
@RF02021 LA    @05,2                                               2023 09673000
         LH    @15,FKEYLN(,FRANPTR1)                               2023 09674000
         LR    @14,RPTR1                                           2023 09675000
         ALR   @14,@15                                             2023 09676000
         ALR   @14,@05                                             2023 09677000
         LR    RPTR1,@14                                           2023 09678000
*                  LENG = LENG - FKEYLN - 2;                       2024 09679000
         LR    @14,LENG                                            2024 09680000
         SLR   @14,@15                                             2024 09681000
         SLR   @14,@05                                             2024 09682000
         LR    LENG,@14                                            2024 09683000
*                  FRANPTR1 = FRANPTR1 + FKEYLN + 2;               2025 09684000
*                                                                  2025 09685000
         ALR   @15,FRANPTR1                                        2025 09686000
         ALR   @15,@05                                             2025 09687000
         LR    FRANPTR1,@15                                        2025 09688000
*                  /**************************************************/ 09689000
*                  /*                                                */ 09690000
*                  /*  MOVE HIGH KEY & LENGTH INTO RANGE LIST. UPDATE*/ 09691000
*                  /*  POINTERS AND LOOP CONTROL                     */ 09692000
*                  /*                                                */ 09693000
*                  /**************************************************/ 09694000
*                                                                  2026 09695000
*                  FKEYLN = RPTR2 -> FIELDR(1:2);                  2026 09696000
*                                                                  2026 09697000
         L     @15,RPTR2                                           2026 09698000
         SLR   @14,@14                                             2026 09699000
         ICM   @14,3,FIELDR(@15)                                   2026 09700000
         STH   @14,FKEYLN(,FRANPTR1)                               2026 09701000
*                  IF FKEYLN ^= 0                          /*@OZ10865*/ 09702000
*                    THEN                                  /*@OZ10865*/ 09703000
         LTR   @14,@14                                             2027 09704000
         BZ    @RF02027                                            2027 09705000
*                       FKEY(1:FKEYLN) = (RPTR2+2) -> FIELDR(1:FKEYLN); 09706000
         BCTR  @14,0                                               2028 09707000
         ALR   @15,@05                                             2028 09708000
         EX    @14,@SM01729                                        2028 09709000
*                                                          /*@OZ10865*/ 09710000
*                  RPTR2 = RPTR2 + FKEYLN + 2;                     2029 09711000
@RF02027 LA    @05,2                                               2029 09712000
         LH    @15,FKEYLN(,FRANPTR1)                               2029 09713000
         L     @14,RPTR2                                           2029 09714000
         ALR   @14,@15                                             2029 09715000
         ALR   @14,@05                                             2029 09716000
         ST    @14,RPTR2                                           2029 09717000
*                  LENG = LENG - FKEYLN - 2;                       2030 09718000
         LR    @14,LENG                                            2030 09719000
         SLR   @14,@15                                             2030 09720000
         SLR   @14,@05                                             2030 09721000
         LR    LENG,@14                                            2030 09722000
*                  FRANPTR1 = FRANPTR1 + FKEYLN + 2;               2031 09723000
         ALR   @15,FRANPTR1                                        2031 09724000
         ALR   @15,@05                                             2031 09725000
         LR    FRANPTR1,@15                                        2031 09726000
*                END;                                              2032 09727000
*                                                                  2032 09728000
@DE02019 LTR   LENG,LENG                                           2032 09729000
         BP    @DL02019                                            2032 09730000
*                  /**************************************************/ 09731000
*                  /*                                                */ 09732000
*                  /*  SET LENGTH OF ENTIRE LIST AND RETURN          */ 09733000
*                  /*  WITH SUCCESS INDICATED                        */ 09734000
*                  /*                                                */ 09735000
*                  /**************************************************/ 09736000
*                                                                  2033 09737000
*                FRANGLN = TOTLEN;                                 2033 09738000
         L     @15,@PC00012+12                                     2033 09739000
         L     @01,RRANGPTR(,@15)                                  2033 09740000
         L     @00,TOTLEN                                          2033 09741000
         STH   @00,FRANGLN(,@01)                                   2033 09742000
*                END;                                              2034 09743000
*          END RANGFDCT;                                           2035 09744000
*                                                                  2035 09745000
@RF02002 DS    0H                                                  2036 09746000
*        /************************************************************/ 09747000
*        /*                                                          */ 09748000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 09749000
*        /*                                                          */ 09750000
*        /************************************************************/ 09751000
*                                                                  2036 09752000
*        RETURN CODE(0);                                           2036 09753000
@RC01945 SLR   @15,@15                                             2036 09754000
         L     @14,@SA00012                                        2036 09755000
         LM    @00,@12,@SA00012+8                                  2036 09756000
         BR    @14                                                 2036 09757000
*END RANGPROC;                                                     2037 09758000
*        /************************************************************/ 09759000
*        /*                                                          */ 09760000
*        /*  PROCEDURE NAME- BFPLPROC                                */ 09761000
*        /*                                                          */ 09762000
*        /*  FUNCTION - CONSTRUCT A FIELD PARAMETER LIST FROM        */ 09763000
*        /*  DICTIONARY AND WORK AREA INFORMATION PASSED BY EXPORT   */ 09764000
*        /*  ON PORTABILITY VOLUME OR CONSTRUCT A SKELETON FPL       */ 09765000
*        /*  CONTAINING NO FIELD INFORMATION                         */ 09766000
*        /*                                                          */ 09767000
*        /*  INPUT -                                                 */ 09768000
*        /*    .BFLISTPT - POINTER TO THE FIELD LIST USED    @Y30SSFR*/ 09769000
*        /*      TO PROVIDE CATALOG FIELD NAMES              @Y30SSFR*/ 09770000
*        /*    .BINDX - INDEX OF FIELDNAME INTO FIELDLST             */ 09771000
*        /*    .BFPLADDR - RETURN CELL FOR FPL ADDRESS               */ 09772000
*        /*    .BDICTPTR - POINTER TO DICTIONARY WHICH REFERENCES    */ 09773000
*        /*     CATALOG FIELD INFORMATION IN THE WORK AREA           */ 09774000
*        /*    .BWKAPTR - WORK AREA REFERENCED BY DICTIONARY         */ 09775000
*        /*                                                          */ 09776000
*        /*  OUTPUT - A FPL IS CONSTRUCTED                           */ 09777000
*        /*                                                          */ 09778000
*        /************************************************************/ 09779000
*                                                                  2038 09780000
*BFPLPROC: PROCEDURE(BFLISTPT,         /*ADDRESS OF FIELD    @Y30SSFR*/ 09781000
*                                      /*NAMES LIST          @Y30SSFR*/ 09782000
*                    BINDX,            /*INDEX OF FIELDNAME  @Y30SSFR*/ 09783000
*                    BFPLADDR,         /*RETURN CELL FOR FPL POINTER */ 09784000
*                    BDICTPTR,         /*POINTER TO DICTIONARY       */ 09785000
*                    BWKAPTR,          /*POINTER TO WORK AREA        */ 09786000
*                                      /*REFERENCED BY DICTIONARY    */ 09787000
*                    BFPLRTN);         /*ADDR IN WHICH TO STORE FPL  */ 09788000
BFPLPROC STM   @14,@12,@SA00013                                    2038 09789000
         MVC   @PC00013(24),0(@01)                                 2038 09790000
*                                      /*POINTER(WITHIN A FVT)       */ 09791000
*                                                                  2039 09792000
*        /************************************************************/ 09793000
*        /*                                                          */ 09794000
*        /*  ARGUMENTS OF INVOCATION                                 */ 09795000
*        /*                                                          */ 09796000
*        /************************************************************/ 09797000
*                                                                  2039 09798000
*        DCL BFLISTPT PTR(31),                                     2039 09799000
*            BINDX    FIXED(15),                                   2039 09800000
*            BFPLADDR PTR(31),                                     2039 09801000
*            BDICTPTR PTR(31),                                     2039 09802000
*            BWKAPTR  PTR(31),                                     2039 09803000
*            BFPLRTN  PTR(31);                                     2039 09804000
*                                                                  2039 09805000
*        /************************************************************/ 09806000
*        /*                                                  @Y30SSFR*/ 09807000
*        /*  LOCAL DECLARATIONS FOR BFPLPROC                 @Y30SSFR*/ 09808000
*        /*                                                  @Y30SSFR*/ 09809000
*        /************************************************************/ 09810000
*                                                                  2040 09811000
*        DCL BFLIST(*) CHAR(8) BASED(BFLISTPT);            /*@Y30SSFR*/ 09812000
*                                      /*TEMPLATE FOR FIELD  @Y30SSFR*/ 09813000
*                                      /*NAME LIST           @Y30SSFR*/ 09814000
*                                                                  2041 09815000
*        /************************************************************/ 09816000
*        /*                                                          */ 09817000
*        /*  IF THE DICTIONARY POINTER IS ZERO, THEN A SKELETON      */ 09818000
*        /*  FIELD PARAMETER LIST(FPL) IS CONSTRUCTED                */ 09819000
*        /*                                                          */ 09820000
*        /************************************************************/ 09821000
*                                                                  2041 09822000
*        OLDERID2 = NEWERID2;                                      2041 09823000
         L     @15,@PC00001                                        2041 09824000
         L     @14,GDTTR2(,@15)                                    2041 09825000
         MVC   @TS00001(95),NEWERID2(@14)                          2041 09826000
         MVC   OLDERID2(95,@14),@TS00001                           2041 09827000
*        NEWID2 = 'MPBF';                                          2042 09828000
*                                                                  2042 09829000
         MVC   NEWID2(4,@14),@CC01536                              2042 09830000
*        IF BDICTPTR = NULLPTR                                     2043 09831000
*          THEN                                                    2043 09832000
*                                                                  2043 09833000
         L     @14,@PC00013+12                                     2043 09834000
         L     @14,BDICTPTR(,@14)                                  2043 09835000
         LTR   @14,@14                                             2043 09836000
         BNZ   @RF02043                                            2043 09837000
*            /********************************************************/ 09838000
*            /*                                              @Y30SSFR*/ 09839000
*            /*  TEST TO DETERMINE IF WE ARE BUILDING AN FPL @Y30SSFR*/ 09840000
*            /*  FOR THE NAMEDS FIELD.                       @Y30SSFR*/ 09841000
*            /*                                              @Y30SSFR*/ 09842000
*            /********************************************************/ 09843000
*                                                                  2044 09844000
*            IF BINDX = INAMEDS                                    2044 09845000
*              THEN                                                2044 09846000
*                                                                  2044 09847000
         L     @14,@PC00013+4                                      2044 09848000
         CLC   BINDX(2,@14),@CH00705                               2044 09849000
         BNE   @RF02044                                            2044 09850000
*                /****************************************************/ 09851000
*                /*                                          @Y30SSFR*/ 09852000
*                /*  BUILD AN FPL FOR NAMEDS AND ALSO A TEST @Y30SSFR*/ 09853000
*                /*  FPL SO THAT CATALOG MANAGEMENT WILL     @Y30SSFR*/ 09854000
*                /*  RETURN AT MOST THE FIRST TWO ASSOCIA-   @Y30SSFR*/ 09855000
*                /*  TIONS FOUND IN THE CATALOG.             @Y30SSFR*/ 09856000
*                /*                                          @Y30SSFR*/ 09857000
*                /****************************************************/ 09858000
*                                                                  2045 09859000
*                DO;                                       /*@Y30SSFR*/ 09860000
*                                                                  2045 09861000
*                /****************************************************/ 09862000
*                /*                                          @Y30SSFR*/ 09863000
*                /*  GET CORE FOR TWO FPL'S.                 @Y30SSFR*/ 09864000
*                /*                                          @Y30SSFR*/ 09865000
*                /****************************************************/ 09866000
*                                                                  2046 09867000
*                CALL IDCSAGP0(GDTTBL,(2*(LENGTH(CTGFL)+8)),/*     2046 09868000
*                                                            @Y30SSFR*/ 09869000
*                  BFPLADDR,GPID,SETZERO);                 /*@Y30SSFR*/ 09870000
*                                                                  2046 09871000
         ST    @15,@AL00001                                        2046 09872000
         LA    @03,48                                              2046 09873000
         ST    @03,@AFTEMPS+16                                     2046 09874000
         LA    @03,@AFTEMPS+16                                     2046 09875000
         ST    @03,@AL00001+4                                      2046 09876000
         L     @03,@PC00013+8                                      2046 09877000
         ST    @03,@AL00001+8                                      2046 09878000
         LA    @03,GPID                                            2046 09879000
         ST    @03,@AL00001+12                                     2046 09880000
         LA    @03,SETZERO                                         2046 09881000
         ST    @03,@AL00001+16                                     2046 09882000
         MVI   @AL00001+16,X'80'                                   2046 09883000
         L     @15,GDTGPL(,@15)                                    2046 09884000
         LA    @01,@AL00001                                        2046 09885000
         BALR  @14,@15                                             2046 09886000
*                RESPECIFY RTNREG RSTD;                            2047 09887000
*                TESTRC = RTNREG;                                  2048 09888000
         LR    TESTRC,RTNREG                                       2048 09889000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/ 09890000
*                                                                  2049 09891000
*                IF TESTRC ^= 0                            /*@Y30SSFR*/ 09892000
*                  THEN                                    /*@Y30SSFR*/ 09893000
         LTR   TESTRC,TESTRC                                       2050 09894000
         BZ    @RF02050                                            2050 09895000
*                    DO;                                   /*@Y30SSFR*/ 09896000
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/ 09897000
         L     @01,DDSTRU                                          2052 09898000
         MVC   DARGSMOD(3,@01),@CC01023                            2052 09899000
*                    DEFSTID = NOSTORAG;                   /*@Y30SSFR*/ 09900000
         MVI   DEFSTID,X'04'                                       2053 09901000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 09902000
         LA    @15,12                                              2054 09903000
         L     @14,@SA00013                                        2054 09904000
         LM    @00,@12,@SA00013+8                                  2054 09905000
         BR    @14                                                 2054 09906000
*                    END;                                  /*@Y30SSFR*/ 09907000
*                                                                  2055 09908000
*                /****************************************************/ 09909000
*                /*                                          @Y30SSFR*/ 09910000
*                /*  CONSTRUCT THE FPL FOR THE NAMEDS FIELD  @Y30SSFR*/ 09911000
*                /*  ITSELF.                                 @Y30SSFR*/ 09912000
*                /*                                          @Y30SSFR*/ 09913000
*                /****************************************************/ 09914000
*                                                                  2056 09915000
*                CTGFLPTR = BFPLADDR;                      /*@Y30SSFR*/ 09916000
@RF02050 L     @15,@PC00013+8                                      2056 09917000
         L     @15,BFPLADDR(,@15)                                  2056 09918000
         LR    CTGFLPTR,@15                                        2056 09919000
*                CTGFLDNO = '00000001'B;                   /*@Y30SSFR*/ 09920000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2057 09921000
*                CTGFLDNM = ADDR(BFLIST(BINDX));           /*@Y30SSFR*/ 09922000
*                                                                  2058 09923000
         L     @05,@PC00013+4                                      2058 09924000
         LH    @05,BINDX(,@05)                                     2058 09925000
         SLA   @05,3                                               2058 09926000
         L     @14,@PC00013                                        2058 09927000
         L     @01,BFLISTPT(,@14)                                  2058 09928000
         AL    @01,@CF01731                                        2058 09929000
         LA    @05,BFLIST(@05,@01)                                 2058 09930000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2058 09931000
*                /****************************************************/ 09932000
*                /*                                          @Y30SSFR*/ 09933000
*                /*  SET THE CHAIN FIELD FROM THE NAMEDS     @Y30SSFR*/ 09934000
*                /*  FPL.                                    @Y30SSFR*/ 09935000
*                /*                                          @Y30SSFR*/ 09936000
*                /****************************************************/ 09937000
*                                                                  2059 09938000
*                CTGFLCHN = BFPLADDR + LENGTH(CTGFL) + 8;  /*@Y30SSFR*/ 09939000
*                                                                  2059 09940000
         AL    @15,@CF00312                                        2059 09941000
         ST    @15,CTGFLCHN(,CTGFLPTR)                             2059 09942000
*                /****************************************************/ 09943000
*                /*                                          @Y30SSFR*/ 09944000
*                /*  SET THE CTGFLPTR TO POINT TO THE TEST   @Y30SSFR*/ 09945000
*                /*  FPL.                                    @Y30SSFR*/ 09946000
*                /*                                          @Y30SSFR*/ 09947000
*                /****************************************************/ 09948000
*                                                                  2060 09949000
*                CTGFLPTR = CTGFLCHN;                      /*@Y30SSFR*/ 09950000
*                                                                  2060 09951000
         LR    CTGFLPTR,@15                                        2060 09952000
*                /****************************************************/ 09953000
*                /*                                          @Y30SSFR*/ 09954000
*                /*  CONSTRUCT THE TEST FPL ITSELF.          @Y30SSFR*/ 09955000
*                /*                                          @Y30SSFR*/ 09956000
*                /****************************************************/ 09957000
*                                                                  2061 09958000
*                CTGFLDNO = '00000001'B;                   /*@Y30SSFR*/ 09959000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2061 09960000
*                CTGFLDNM = ADDR(CNTREPNO);                /*@Y30SSFR*/ 09961000
         LA    @05,CNTREPNO                                        2062 09962000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2062 09963000
*                CTGFLDCD = CTGFLDLE;                      /*@Y30SSFR*/ 09964000
         MVI   CTGFLDCD(CTGFLPTR),X'C0'                            2063 09965000
*                CTGFLNG(1) = LENGTH(NUMASSOB);            /*@Y30SSFR*/ 09966000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00156                        2064 09967000
*                CTGFLPT(1) = ADDR(NUMASSOB);              /*@Y30SSFR*/ 09968000
*                                                                  2065 09969000
         LA    @05,@CH00156                                        2065 09970000
         ST    @05,CTGFLPT(,CTGFLPTR)                              2065 09971000
*                RETURN CODE(0);                           /*@Y30SSFR*/ 09972000
*                                                                  2066 09973000
         SLR   @15,@15                                             2066 09974000
         L     @14,@SA00013                                        2066 09975000
         LM    @00,@12,@SA00013+8                                  2066 09976000
         BR    @14                                                 2066 09977000
*                END;                                      /*@Y30SSFR*/ 09978000
*                                                                  2067 09979000
*              ELSE                                                2068 09980000
*                                                                  2068 09981000
*                DO;                                       /*@Y30SSFR*/ 09982000
*                                                                  2068 09983000
@RF02044 DS    0H                                                  2069 09984000
*                /****************************************************/ 09985000
*                /*                                          @Y30SSFR*/ 09986000
*                /*  GET CORE FOR A FPL                      @Y30SSFR*/ 09987000
*                /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO */ 09988000
*                /*  CALLING PROCESSOR.                      @Y30SSFR*/ 09989000
*                /*                                          @Y30SSFR*/ 09990000
*                /****************************************************/ 09991000
*                                                                  2069 09992000
*                CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGFL)+8),BFPLADDR,GPID, 09993000
*ETZERO);                                                          2069 09994000
         L     @03,@PC00001                                        2069 09995000
         ST    @03,@AL00001                                        2069 09996000
         LA    @15,24                                              2069 09997000
         ST    @15,@AFTEMPS+16                                     2069 09998000
         LA    @15,@AFTEMPS+16                                     2069 09999000
         ST    @15,@AL00001+4                                      2069 10000000
         L     @15,@PC00013+8                                      2069 10001000
         ST    @15,@AL00001+8                                      2069 10002000
         LA    @15,GPID                                            2069 10003000
         ST    @15,@AL00001+12                                     2069 10004000
         LA    @15,SETZERO                                         2069 10005000
         ST    @15,@AL00001+16                                     2069 10006000
         MVI   @AL00001+16,X'80'                                   2069 10007000
         L     @15,GDTGPL(,@03)                                    2069 10008000
         LA    @01,@AL00001                                        2069 10009000
         BALR  @14,@15                                             2069 10010000
*                RESPECIFY RTNREG RSTD;                            2070 10011000
*                TESTRC = RTNREG;                                  2071 10012000
         LR    TESTRC,RTNREG                                       2071 10013000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/ 10014000
*                IF TESTRC ^= 0                                    2073 10015000
*                  THEN                                            2073 10016000
         LTR   TESTRC,TESTRC                                       2073 10017000
         BZ    @RF02073                                            2073 10018000
*                    DO;                                   /*@Y30SSFR*/ 10019000
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/ 10020000
         L     @01,DDSTRU                                          2075 10021000
         MVC   DARGSMOD(3,@01),@CC01023                            2075 10022000
*                    DEFSTID = NOSTORAG;                   /*@Y30SSFR*/ 10023000
         MVI   DEFSTID,X'04'                                       2076 10024000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 10025000
         LA    @15,12                                              2077 10026000
         L     @14,@SA00013                                        2077 10027000
         LM    @00,@12,@SA00013+8                                  2077 10028000
         BR    @14                                                 2077 10029000
*                    END;                                  /*@Y30SSFR*/ 10030000
*                                                                  2078 10031000
*                /****************************************************/ 10032000
*                /*                                          @Y30SSFR*/ 10033000
*                /*  SET FIELDS IN SKELETON FPL .  RETURN TO CALLING */ 10034000
*                /*  PROCESSOR INDICATING SUCCESS.           @Y30SSFR*/ 10035000
*                /*                                          @Y30SSFR*/ 10036000
*                /****************************************************/ 10037000
*                                                                  2079 10038000
*                CTGFLPTR = BFPLADDR;  /*SET FPL BASE        @Y30SSFR*/ 10039000
@RF02073 L     @15,@PC00013+8                                      2079 10040000
         L     CTGFLPTR,BFPLADDR(,@15)                             2079 10041000
*                CTGFLDNO = '00000001'B;                   /*@Y30SSFR*/ 10042000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2080 10043000
*                                      /*NUMBER OF LNG/ADDR PAIRS    */ 10044000
*                CTGFLDNM = ADDR(BFLIST(BINDX));           /*@Y30SSFR*/ 10045000
         L     @05,@PC00013+4                                      2081 10046000
         LH    @05,BINDX(,@05)                                     2081 10047000
         SLA   @05,3                                               2081 10048000
         L     @15,@PC00013                                        2081 10049000
         L     @01,BFLISTPT(,@15)                                  2081 10050000
         AL    @01,@CF01731                                        2081 10051000
         LA    @05,BFLIST(@05,@01)                                 2081 10052000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2081 10053000
*                                      /*CATALOG FIELD NAME          */ 10054000
*                RETURN CODE(0);                           /*@Y30SSFR*/ 10055000
         SLR   @15,@15                                             2082 10056000
         L     @14,@SA00013                                        2082 10057000
         LM    @00,@12,@SA00013+8                                  2082 10058000
         BR    @14                                                 2082 10059000
*                END;                                      /*@Y30SSFR*/ 10060000
*                                                                  2083 10061000
*        /************************************************************/ 10062000
*        /*                                                          */ 10063000
*        /*  CONSTRUCT A FIELD PARAMETER LIST POINTING TO FIELD      */ 10064000
*        /*  INFORMATION WITHIN THE WORK AREA REFERENCED BY THE      */ 10065000
*        /*  DICTIONARY                                              */ 10066000
*        /*                                                          */ 10067000
*        /************************************************************/ 10068000
*                                                                  2084 10069000
*          ELSE                                                    2084 10070000
*            DO;                                                   2084 10071000
@RF02043 DS    0H                                                  2085 10072000
*            DICTPTR = BDICTPTR;                                   2085 10073000
         L     @15,@PC00013+12                                     2085 10074000
         L     @15,BDICTPTR(,@15)                                  2085 10075000
         ST    @15,DICTPTR                                         2085 10076000
*            IF DICTLN(BINDX) = 0                                  2086 10077000
*              THEN                                                2086 10078000
         SLR   @14,@14                                             2086 10079000
         L     @05,@PC00013+4                                      2086 10080000
         LH    @05,BINDX(,@05)                                     2086 10081000
         SLA   @05,3                                               2086 10082000
         AL    @15,@CF01689                                        2086 10083000
         C     @14,DICTLN-4(@05,@15)                               2086 10084000
         BNE   @RF02086                                            2086 10085000
*                DO;                                               2087 10086000
*                                                                  2087 10087000
*                /****************************************************/ 10088000
*                /*                                                  */ 10089000
*                /*  IF THE DICTIONARY ENTRY INDICATES NOT CATALOG   */ 10090000
*                /*  INFORMATION FOR THIS FIELD, SET FVT POINTER     */ 10091000
*                /*  TO FIELD TO ZERO AND RETURN INDICATING          */ 10092000
*                /*  SUCCESSFUL COMPLETION.                          */ 10093000
*                /*                                                  */ 10094000
*                /****************************************************/ 10095000
*                                                                  2088 10096000
*                BFPLRTN = NULLPTR;                                2088 10097000
         L     @15,@PC00013+20                                     2088 10098000
         ST    @14,BFPLRTN(,@15)                                   2088 10099000
*                RETURN CODE(0);                                   2089 10100000
         LR    @15,@14                                             2089 10101000
         L     @14,@SA00013                                        2089 10102000
         LM    @00,@12,@SA00013+8                                  2089 10103000
         BR    @14                                                 2089 10104000
*                END;                                              2090 10105000
*                                                                  2090 10106000
*            /********************************************************/ 10107000
*            /*                                                      */ 10108000
*            /*  CORE FOR FPL HAS ALREADY BEEN OBTAINED.  FILL IN    */ 10109000
*            /*  CATALOG FIELD INFORMATION FROM WORK AREA            */ 10110000
*            /*                                                      */ 10111000
*            /********************************************************/ 10112000
*                                                                  2091 10113000
*            CTGFLPTR = BFPLADDR;      /*SET FPL BASE                */ 10114000
@RF02086 L     @15,@PC00013+8                                      2091 10115000
         L     @14,BFPLADDR(,@15)                                  2091 10116000
         LR    CTGFLPTR,@14                                        2091 10117000
*            BFPLRTN = BFPLADDR;                                   2092 10118000
         L     @05,@PC00013+20                                     2092 10119000
         ST    @14,BFPLRTN(,@05)                                   2092 10120000
*            CTGFLDNO = '00000001'B;   /*SET NUMBER LNG/ADDR PAIRS   */ 10121000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2093 10122000
*            CTGFLDNM = ADDR(BFLIST(BINDX));               /*@Y30SSFR*/ 10123000
         L     @05,@PC00013+4                                      2094 10124000
         LH    @05,BINDX(,@05)                                     2094 10125000
         LR    @03,@05                                             2094 10126000
         SLA   @03,3                                               2094 10127000
         L     @02,@PC00013                                        2094 10128000
         L     @01,BFLISTPT(,@02)                                  2094 10129000
         AL    @01,@CF01731                                        2094 10130000
         LA    @03,BFLIST(@03,@01)                                 2094 10131000
         ST    @03,CTGFLDNM(,CTGFLPTR)                             2094 10132000
*                                      /*SET CATALOG FIELD NAME      */ 10133000
*                                                                  2095 10134000
*            /********************************************************/ 10135000
*            /*                                                      */ 10136000
*            /*  IF CONSTRUCTING AMDSBCAT FPL, THE CATALOG FIELD     */ 10137000
*            /*  INFORMATION AREA IS JUST BEYOND THE FPL AREA.       */ 10138000
*            /*                                                      */ 10139000
*            /********************************************************/ 10140000
*                                                                  2095 10141000
*            IF BINDX = IAMDSB                                     2095 10142000
*              THEN                                                2095 10143000
         C     @05,@CF00625                                        2095 10144000
         BNE   @RF02095                                            2095 10145000
*                DO;                                               2096 10146000
*                CTGFLNG(1) = LENGTH(IDAAMDSB);                    2097 10147000
         LA    @05,96                                              2097 10148000
         ST    @05,CTGFLNG(,CTGFLPTR)                              2097 10149000
*                                      /*CATALOG DATA LENGTH         */ 10150000
*                BFPLADDR = BFPLADDR + LENGTH(CTGFL) + 8;          2098 10151000
         AL    @14,@CF00312                                        2098 10152000
         ST    @14,BFPLADDR(,@15)                                  2098 10153000
*                CTGFLPT(1) = BFPLADDR;/*CATALOG DATA ADDRESS        */ 10154000
         ST    @14,CTGFLPT(,CTGFLPTR)                              2099 10155000
*                BFPLADDR = BFPLADDR + LENGTH(IDAAMDSB);           2100 10156000
         ALR   @14,@05                                             2100 10157000
         ST    @14,BFPLADDR(,@15)                                  2100 10158000
*                END;                                              2101 10159000
*              ELSE                                                2102 10160000
*                /****************************************************/ 10161000
*                /*                                                  */ 10162000
*                /*  FOR A FPL OTHER THAN AMDSBCAT, THE CATALOG FIELD*/ 10163000
*                /*  INFORMATION IS IN THE WORK AREA READ IN FROM THE*/ 10164000
*                /*  PORTABLE DATA SET.                              */ 10165000
*                /*                                                  */ 10166000
*                /****************************************************/ 10167000
*                                                                  2102 10168000
*                DO;                                               2102 10169000
         B     @RC02095                                            2102 10170000
@RF02095 DS    0H                                                  2103 10171000
*                CTGFLNG(1) = DICTLN(BINDX);                       2103 10172000
         L     @05,DICTPTR                                         2103 10173000
         L     @15,@PC00013+4                                      2103 10174000
         LH    @15,BINDX(,@15)                                     2103 10175000
         SLA   @15,3                                               2103 10176000
         LA    @01,0(@15,@05)                                      2103 10177000
         AL    @01,@CF01689                                        2103 10178000
         L     @14,DICTLN-4(,@01)                                  2103 10179000
         ST    @14,CTGFLNG(,CTGFLPTR)                              2103 10180000
*                                      /*CATALOG DATA LENGTH         */ 10181000
*                CTGFLPT(1) = BWKAPTR + DICTDL(BINDX);             2104 10182000
         L     @14,@PC00013+16                                     2104 10183000
         L     @14,BWKAPTR(,@14)                                   2104 10184000
         AL    @14,DICTDL-8(@15,@05)                               2104 10185000
         ST    @14,CTGFLPT(,CTGFLPTR)                              2104 10186000
*                                      /*CATALOG DATA ADDRESS        */ 10187000
*                                                                  2105 10188000
*                /****************************************************/ 10189000
*                /*                                                  */ 10190000
*                /*  INCREMENT FPL ADDRESS TO NEXT FPL POSITION      */ 10191000
*                /*                                                  */ 10192000
*                /****************************************************/ 10193000
*                                                                  2105 10194000
*                BFPLADDR = BFPLADDR + LENGTH(CTGFL) +8;           2105 10195000
         L     @15,@PC00013+8                                      2105 10196000
         LA    @14,24                                              2105 10197000
         AL    @14,BFPLADDR(,@15)                                  2105 10198000
         ST    @14,BFPLADDR(,@15)                                  2105 10199000
*                END;                                              2106 10200000
*            END;                                                  2107 10201000
*                                                                  2107 10202000
@RC02095 DS    0H                                                  2108 10203000
*        /************************************************************/ 10204000
*        /*                                                          */ 10205000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 10206000
*        /*                                                          */ 10207000
*        /************************************************************/ 10208000
*                                                                  2108 10209000
*        RETURN CODE(0);                                           2108 10210000
*                                                                  2108 10211000
         SLR   @15,@15                                             2108 10212000
         L     @14,@SA00013                                        2108 10213000
         LM    @00,@12,@SA00013+8                                  2108 10214000
         BR    @14                                                 2108 10215000
*END BFPLPROC;                                                     2109 10216000
*        /************************************************************/ 10217000
*        /*                                                          */ 10218000
*        /*  PROCEDURE NAME - RECPROC                                */ 10219000
*        /*                                                          */ 10220000
*        /*  FUNCTION - COPY THE DATA FROM THE PORTABILITY DATA SET  */ 10221000
*        /*  TO THE VSAM CLUSTER BEING IMPORTED.                     */ 10222000
*        /*  THE VSAM CLUSTER IS OPENED BY OPENPROC,                 */ 10223000
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */ 10224000
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */ 10225000
*        /*  UCLOSE MACRO.                                           */ 10226000
*        /*                                                          */ 10227000
*        /*  INPUT - NONE                                            */ 10228000
*        /*                                                          */ 10229000
*        /*  OUTPUT - THE VSAM CLUSTER WILL CONTAIN ALL DATA THAT IT */ 10230000
*        /*  CONTAINED PRIOR TO EXPORT.                              */ 10231000
*        /*                                                          */ 10232000
*        /************************************************************/ 10233000
*                                                                  2110 10234000
*RECPROC:  PROCEDURE;                                              2110 10235000
*                                                                  2110 10236000
RECPROC  STM   @14,@12,@SA00014                                    2110 10237000
*        /************************************************************/ 10238000
*        /*                                                  @Y30SSFR*/ 10239000
*        /*  LOCAL DECLARATIONS FOR RECPROC                  @Y30SSFR*/ 10240000
*        /*                                                  @Y30SSFR*/ 10241000
*        /************************************************************/ 10242000
*                                                                  2111 10243000
*        DCL DSNAME CHAR(44) BASED(IOCDSN);                /*@Y30SSFR*/ 10244000
*                                      /*DATA SET OPENED BY  @Y30SSFR*/ 10245000
*                                      /*UOPEN               @Y30SSFR*/ 10246000
*        DCL RLCPLPTR PTR(31);         /*POINTER TO CPL USED @Y30SSFR*/ 10247000
*                                      /*TO DO LOCATES       @Y30SSFR*/ 10248000
*        DCL IRENTYPE FIXED(15) CONSTANT(1);               /*@Y30SSFR*/ 10249000
*                                      /*INDEX FOR ENTRY     @Y30SSFR*/ 10250000
*                                      /*TYPE                @Y30SSFR*/ 10251000
*        DCL IRNAMEDS FIXED(15) CONSTANT(2);               /*@Y30SSFR*/ 10252000
*                                      /*INDEX FOR           @Y30SSFR*/ 10253000
*                                      /*ASSOCIATED OBJECTS  @Y30SSFR*/ 10254000
*        DCL IRENTNAM FIXED(15) CONSTANT(1);               /*@Y30SSFR*/ 10255000
*                                      /*INDEX FOR ENTRY     @Y30SSFR*/ 10256000
*                                      /*NAME                @Y30SSFR*/ 10257000
*        DCL RSAVCPL  CHAR(LENGTH(CTGPL));                 /*@Y30SSFR*/ 10258000
*                                      /*SAVE AREA FOR CPL   @Y30SSFR*/ 10259000
*        DCL RLFNAME  FIXED(24);       /*AREA TO HOLD CI     @Y30SSFR*/ 10260000
*                                      /*NUMBER              @Y30SSFR*/ 10261000
*                                                                  2118 10262000
*        /************************************************************/ 10263000
*        /*                                                          */ 10264000
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */ 10265000
*        /*  IF THE OPEN FAILS, RETURN TO THE CALLING PROCESSOR WITH */ 10266000
*        /*  FAILURE INDICATED                                       */ 10267000
*        /*                                                          */ 10268000
*        /************************************************************/ 10269000
*                                                                  2118 10270000
*        IF ADDR(OUTDD) ^= NULLPTR                                 2118 10271000
*          THEN                                                    2118 10272000
         L     @15,@PC00001+4                                      2118 10273000
         L     @15,FDTPTR+4(,@15)                                  2118 10274000
         LTR   @15,@15                                             2118 10275000
         BZ    @RF02118                                            2118 10276000
*            CALL OPENPROC('O',ADDR(OUTDDVAL),NULLPARM,0,0,        2119 10277000
*              ADDR(POUTIOCS));                            /*@YL026UA*/ 10278000
         MVC   @AL00001(20),@AL02119                               2119 10279000
         LA    @02,OUTDDVAL(,@15)                                  2119 10280000
         ST    @02,@AFTEMPS+20                                     2119 10281000
         LA    @02,@AFTEMPS+20                                     2119 10282000
         ST    @02,@AL00001+4                                      2119 10283000
         LA    @02,POUTIOCS                                        2119 10284000
         ST    @02,@AFTEMPS+24                                     2119 10285000
         LA    @02,@AFTEMPS+24                                     2119 10286000
         ST    @02,@AL00001+20                                     2119 10287000
         LA    @01,@AL00001                                        2119 10288000
         BAL   @14,OPENPROC                                        2119 10289000
*          ELSE                                                    2120 10290000
*            CALL OPENPROC('O',ADDR(ALLDDN),NULLPARM,0,0,          2120 10291000
*              ADDR(POUTIOCS));                            /*@YL026UA*/ 10292000
         B     @RC02118                                            2120 10293000
@RF02118 MVC   @AL00001(20),@AL02120                               2120 10294000
         L     @02,ALLPTR                                          2120 10295000
         LA    @02,ALLDDN(,@02)                                    2120 10296000
         ST    @02,@AFTEMPS+20                                     2120 10297000
         LA    @02,@AFTEMPS+20                                     2120 10298000
         ST    @02,@AL00001+4                                      2120 10299000
         LA    @02,POUTIOCS                                        2120 10300000
         ST    @02,@AFTEMPS+24                                     2120 10301000
         LA    @02,@AFTEMPS+24                                     2120 10302000
         ST    @02,@AL00001+20                                     2120 10303000
         LA    @01,@AL00001                                        2120 10304000
         BAL   @14,OPENPROC                                        2120 10305000
*        RESPECIFY RTNREG RSTD;                                    2121 10306000
@RC02118 DS    0H                                                  2122 10307000
*        TESTRC = RTNREG;                                          2122 10308000
         LR    TESTRC,RTNREG                                       2122 10309000
*        RESPECIFY RTNREG UNRSTD;                                  2123 10310000
*        IF TESTRC ^= 0                                            2124 10311000
*          THEN                                                    2124 10312000
         LTR   TESTRC,TESTRC                                       2124 10313000
         BZ    @RF02124                                            2124 10314000
*            RETURN CODE(LASTCC12);                                2125 10315000
*                                                                  2125 10316000
         LA    @15,12                                              2125 10317000
         L     @14,@SA00014                                        2125 10318000
         LM    @00,@12,@SA00014+8                                  2125 10319000
         BR    @14                                                 2125 10320000
*        /************************************************************/ 10321000
*        /*                                                          */ 10322000
*        /*  CHECK TO BE SURE THAT THE PROPER DATA SET NAME WAS      */ 10323000
*        /*  SPECIFIED ON THE DD CARD.                               */ 10324000
*        /*  COMPARE THE NAME RETURNED BY OPEN WITH THAT OF  @Y30SSFR*/ 10325000
*        /*  THE OBJECT DEFINED.  IF THEY ARE NOT EQUAL,     @Y30SSFR*/ 10326000
*        /*  DETERMINE IF THE OBJECT OPENED IS A PATH OVER   @Y30SSFR*/ 10327000
*        /*  THE OBJECT BEING IMPORTED.                      @Y30SSFR*/ 10328000
*        /*                                                          */ 10329000
*        /************************************************************/ 10330000
*                                                                  2126 10331000
*        IOCSPTR = POUTIOCS;                                       2126 10332000
*                                                                  2126 10333000
@RF02124 L     @02,POUTIOCS                                        2126 10334000
         ST    @02,IOCSPTR                                         2126 10335000
*        IF DSNAME ^= FVTPTR(1)->CTGFVENT->FENTNAME        /*@Y30SSFR*/ 10336000
*          THEN                                            /*@Y30SSFR*/ 10337000
         L     @02,IOCDSN(,@02)                                    2127 10338000
         L     @01,FVTPTR                                          2127 10339000
         L     @01,CTGFVENT(,@01)                                  2127 10340000
         CLC   DSNAME(44,@02),FENTNAME(@01)                        2127 10341000
         BE    @RF02127                                            2127 10342000
*PTHTEST:    DO;                                           /*@Y30SSFR*/ 10343000
*                                                                  2128 10344000
PTHTEST  DS    0H                                                  2129 10345000
*            /********************************************************/ 10346000
*            /*                                              @Y30SSFR*/ 10347000
*            /*  BUILD A CPL AND FPL'S FOR ENTYPE AND        @Y30SSFR*/ 10348000
*            /*  NAMEDS.  THEN PERFORM A LOCATE.             @Y30SSFR*/ 10349000
*            /*                                              @Y30SSFR*/ 10350000
*            /********************************************************/ 10351000
*                                                                  2129 10352000
*            CALL CPLPROC('L',RLCPLPTR,ADDR(DSNAME),       /*@Y30SSFR*/ 10353000
*               NULLPARM,OPNPWA);                          /*@Y30SSFR*/ 10354000
*                                                                  2129 10355000
         LA    @02,@CC01360                                        2129 10356000
         ST    @02,@AL00001                                        2129 10357000
         LA    @02,RLCPLPTR                                        2129 10358000
         ST    @02,@AL00001+4                                      2129 10359000
         L     @02,IOCSPTR                                         2129 10360000
         LA    @02,IOCDSN(,@02)                                    2129 10361000
         ST    @02,@AL00001+8                                      2129 10362000
         LA    @02,NULLPARM                                        2129 10363000
         ST    @02,@AL00001+12                                     2129 10364000
         LA    @02,OPNPWA(,OPNPTR)                                 2129 10365000
         ST    @02,@AL00001+16                                     2129 10366000
         LA    @01,@AL00001                                        2129 10367000
         BAL   @14,CPLPROC                                         2129 10368000
*            RESPECIFY RTNREG RSTD;                                2130 10369000
*            TESTRC = RTNREG;                                      2131 10370000
         LR    TESTRC,RTNREG                                       2131 10371000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 10372000
*                                                                  2132 10373000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 10374000
*              THEN                                        /*@Y30SSFR*/ 10375000
         LTR   TESTRC,TESTRC                                       2133 10376000
         BZ    @RF02133                                            2133 10377000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 10378000
*                                                                  2134 10379000
         LA    @15,12                                              2134 10380000
         L     @14,@SA00014                                        2134 10381000
         LM    @00,@12,@SA00014+8                                  2134 10382000
         BR    @14                                                 2134 10383000
*            /********************************************************/ 10384000
*            /*                                              @Y30SSFR*/ 10385000
*            /*  SET CTGBYPSS TO ON TO REQUEST THAT DOS      @Y30SSFR*/ 10386000
*            /*  BYPASS SECURITY VERIFICATION.               @Y30SSFR*/ 10387000
*            /*  SAVE THE CPL AND BUILD A ENTYPE FPL.        @Y30SSFR*/ 10388000
*            /*                                              @Y30SSFR*/ 10389000
*            /********************************************************/ 10390000
*                                                                  2135 10391000
*            CTGBYPSS = ON;                                /*@Y30SSFR*/ 10392000
*                                                                  2135 10393000
@RF02133 L     @01,CTGPLPTR                                        2135 10394000
         OI    CTGBYPSS(@01),B'10000000'                           2135 10395000
*            CTGPLPTR = RLCPLPTR;                          /*@Y30SSFR*/ 10396000
         L     @15,RLCPLPTR                                        2136 10397000
         ST    @15,CTGPLPTR                                        2136 10398000
*            RSAVCPL = CTGPL;                              /*@Y30SSFR*/ 10399000
*                                                                  2137 10400000
         MVC   RSAVCPL(28),CTGPL(@15)                              2137 10401000
*            CTGNOFLD = 2;                                 /*@Y30SSFR*/ 10402000
*                                                                  2138 10403000
         MVI   CTGNOFLD(@15),X'02'                                 2138 10404000
*            CALL BFPLPROC(ADDR(FIELDLST),IENTYPE,         /*@Y30SSFR*/ 10405000
*              CTGFIELD(IRENTYPE),NULLPARM,NULLPARM,       /*@Y30SSFR*/ 10406000
*              NULLPARM);                                  /*@Y30SSFR*/ 10407000
*                                                                  2139 10408000
         MVC   @AL00001+4(20),@AL02139                             2139 10409000
         LA    @14,FIELDLST                                        2139 10410000
         ST    @14,@AFTEMPS+20                                     2139 10411000
         LA    @14,@AFTEMPS+20                                     2139 10412000
         ST    @14,@AL00001                                        2139 10413000
         LA    @15,CTGFIELD(,@15)                                  2139 10414000
         ST    @15,@AL00001+8                                      2139 10415000
         LA    @01,@AL00001                                        2139 10416000
         BAL   @14,BFPLPROC                                        2139 10417000
*            RESPECIFY RTNREG RSTD;                                2140 10418000
*            TESTRC = RTNREG;                                      2141 10419000
         LR    TESTRC,RTNREG                                       2141 10420000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 10421000
*                                                                  2142 10422000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 10423000
*              THEN                                        /*@Y30SSFR*/ 10424000
         LTR   TESTRC,TESTRC                                       2143 10425000
         BZ    @RF02143                                            2143 10426000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 10427000
*                                                                  2144 10428000
         LA    @15,12                                              2144 10429000
         L     @14,@SA00014                                        2144 10430000
         LM    @00,@12,@SA00014+8                                  2144 10431000
         BR    @14                                                 2144 10432000
*            /********************************************************/ 10433000
*            /*                                              @Y30SSFR*/ 10434000
*            /*  BUILD A NAMEDS FPL.                         @Y30SSFR*/ 10435000
*            /*                                              @Y30SSFR*/ 10436000
*            /********************************************************/ 10437000
*                                                                  2145 10438000
*            CALL BFPLPROC(ADDR(FIELDLST),INAMEDS,         /*@Y30SSFR*/ 10439000
*              CTGFIELD(IRNAMEDS),NULLPARM,NULLPARM,       /*@Y30SSFR*/ 10440000
*              NULLPARM);                                  /*@Y30SSFR*/ 10441000
*                                                                  2145 10442000
@RF02143 MVC   @AL00001+4(20),@AL02145                             2145 10443000
         LA    @15,FIELDLST                                        2145 10444000
         ST    @15,@AFTEMPS+20                                     2145 10445000
         LA    @15,@AFTEMPS+20                                     2145 10446000
         ST    @15,@AL00001                                        2145 10447000
         L     @01,CTGPLPTR                                        2145 10448000
         LA    @15,CTGFIELD+4(,@01)                                2145 10449000
         ST    @15,@AL00001+8                                      2145 10450000
         LA    @01,@AL00001                                        2145 10451000
         BAL   @14,BFPLPROC                                        2145 10452000
*            RESPECIFY RTNREG RSTD;                                2146 10453000
*            TESTRC = RTNREG;                                      2147 10454000
         LR    TESTRC,RTNREG                                       2147 10455000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 10456000
*                                                                  2148 10457000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 10458000
*              THEN                                        /*@Y30SSFR*/ 10459000
         LTR   TESTRC,TESTRC                                       2149 10460000
         BZ    @RF02149                                            2149 10461000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 10462000
*                                                                  2150 10463000
         LA    @15,12                                              2150 10464000
         L     @14,@SA00014                                        2150 10465000
         LM    @00,@12,@SA00014+8                                  2150 10466000
         BR    @14                                                 2150 10467000
*            /********************************************************/ 10468000
*            /*                                              @Y30SSFR*/ 10469000
*            /*  INVOKE CATALOG MANAGEMENT TO DO A LOCATE    @Y30SSFR*/ 10470000
*            /*                                              @Y30SSFR*/ 10471000
*            /********************************************************/ 10472000
*                                                                  2151 10473000
*            CALL CTLGPROC(RLCPLPTR);                      /*@Y30SSFR*/ 10474000
*                                                                  2151 10475000
@RF02149 LA    @15,RLCPLPTR                                        2151 10476000
         ST    @15,@AL00001                                        2151 10477000
         LA    @01,@AL00001                                        2151 10478000
         BAL   @14,CTLGPROC                                        2151 10479000
*            RESPECIFY RTNREG RSTD;                                2152 10480000
*            TESTRC = RTNREG;                                      2153 10481000
         LR    TESTRC,RTNREG                                       2153 10482000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 10483000
*                                                                  2154 10484000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 10485000
*              THEN                                        /*@Y30SSFR*/ 10486000
         LTR   TESTRC,TESTRC                                       2155 10487000
         BZ    @RF02155                                            2155 10488000
*                DO;                                       /*@Y30SSFR*/ 10489000
*                IF EMPTYDS = OFF                          /*@Y30SSFR*/ 10490000
*                  THEN                                    /*@Y30SSFR*/ 10491000
         TM    EMPTYDS,B'10000000'                                 2157 10492000
         BNZ   @RF02157                                            2157 10493000
*                    IMPF2DEL = ON;                        /*@Y30SSFR*/ 10494000
         OI    IMPF2DEL,B'01000000'                                2158 10495000
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/ 10496000
@RF02157 LA    @15,12                                              2159 10497000
         L     @14,@SA00014                                        2159 10498000
         LM    @00,@12,@SA00014+8                                  2159 10499000
         BR    @14                                                 2159 10500000
*                END;                                      /*@Y30SSFR*/ 10501000
*                                                                  2160 10502000
*            /********************************************************/ 10503000
*            /*                                              #Y30SSFR*/ 10504000
*            /*  TEST TO DETERMINE IF THE ENTRY LOCATED ON   #Y30SSFR*/ 10505000
*            /*  IS A PATH.                                  #Y30SSFR*/ 10506000
*            /*                                              #Y30SSFR*/ 10507000
*            /********************************************************/ 10508000
*                                                                  2161 10509000
*            CTGFLPTR = CTGFIELD(IRENTYPE);                /*#Y30SSFR*/ 10510000
@RF02155 L     @15,CTGPLPTR                                        2161 10511000
         L     CTGFLPTR,CTGFIELD(,@15)                             2161 10512000
*            IF FENTYPE = CTGTPTH                          /*#Y30SSFR*/ 10513000
*              THEN                                        /*#Y30SSFR*/ 10514000
         L     @05,CTGFLPT(,CTGFLPTR)                              2162 10515000
         CLI   FENTYPE(@05),C'R'                                   2162 10516000
         BNE   @RF02162                                            2162 10517000
*                DO;                                       /*#Y30SSFR*/ 10518000
*                                                                  2163 10519000
*                /****************************************************/ 10520000
*                /*                                          #Y30SSFR*/ 10521000
*                /*  BUILD AN FPL FOR ENTNAME AND DO A       #Y30SSFR*/ 10522000
*                /*  LOCATE.                                 #Y30SSFR*/ 10523000
*                /*                                          #Y30SSFR*/ 10524000
*                /****************************************************/ 10525000
*                                                                  2164 10526000
*                FNMPTR = CTGFIELD(IRNAMEDS) -> CTGFLPT(1);/*#Y30SSFR*/ 10527000
         L     @01,CTGFIELD+4(,@15)                                2164 10528000
         L     @14,CTGFLPT(,@01)                                   2164 10529000
         ST    @14,FNMPTR                                          2164 10530000
*                RLFNAME = FNAME;                          /*#Y30SSFR*/ 10531000
         MVC   RLFNAME(3),FNAME(@14)                               2165 10532000
*                CTGPL = RSAVCPL;                          /*#Y30SSFR*/ 10533000
         MVC   CTGPL(28,@15),RSAVCPL                               2166 10534000
*                CTGNAME = OFF;                            /*#Y30SSFR*/ 10535000
         NI    CTGNAME(@15),B'11111011'                            2167 10536000
*                CTGENT = ADDR(RLFNAME);                   /*#Y30SSFR*/ 10537000
         LA    @14,RLFNAME                                         2168 10538000
         ST    @14,CTGENT(,@15)                                    2168 10539000
*                CTGNOFLD = 1;                             /*#Y30SSFR*/ 10540000
*                                                                  2169 10541000
         MVI   CTGNOFLD(@15),X'01'                                 2169 10542000
*                /****************************************************/ 10543000
*                /*                                          #Y30SSFR*/ 10544000
*                /*  ZERO OUT THE WORK AREA POINTED TO BY    #Y30SSFR*/ 10545000
*                /*  THE CPL.  BEGIN BY SETTING ZSIZE,       #Y30SSFR*/ 10546000
*                /*  ZPTR, AND ZCNTRL TO THEIR INITIAL       #Y30SSFR*/ 10547000
*                /*  VALUES.                                 #Y30SSFR*/ 10548000
*                /*                                          #Y30SSFR*/ 10549000
*                /****************************************************/ 10550000
*                                                                  2170 10551000
*                ZSIZE = AREALN;                           /*#Y30SSFR*/ 10552000
         L     @15,CTGWKA(,@15)                                    2170 10553000
         LH    ZSIZE,AREALN(,@15)                                  2170 10554000
*                ZPTR = CTGWKA + 2;                        /*#Y30SSFR*/ 10555000
         AL    @15,@CF00156                                        2171 10556000
         LR    ZPTR,@15                                            2171 10557000
*                ZCNTRL = ON;                              /*#Y30SSFR*/ 10558000
*                                                                  2172 10559000
         OI    ZCNTRL,B'10000000'                                  2172 10560000
*                /****************************************************/ 10561000
*                /*                                          #Y30SSFR*/ 10562000
*                /*  LOOP CLEARING OUT THE WORK AREA FOR     #Y30SSFR*/ 10563000
*                /*  THE LOCATE FOR THE ENTRY NAME.          #Y30SSFR*/ 10564000
*                /*                                          #Y30SSFR*/ 10565000
*                /****************************************************/ 10566000
*                                                                  2173 10567000
*                DO WHILE (ZCNTRL = ON);                   /*#Y30SSFR*/ 10568000
         B     @DE02173                                            2173 10569000
@DL02173 DS    0H                                                  2174 10570000
*                  IF ZSIZE > 256                          /*#Y30SSFR*/ 10571000
*                    THEN                                  /*#Y30SSFR*/ 10572000
         LA    @15,256                                             2174 10573000
         CR    ZSIZE,@15                                           2174 10574000
         BNH   @RF02174                                            2174 10575000
*                      DO;                                 /*#Y30SSFR*/ 10576000
*                      ZAREA(1:256) = ZER(1:256);          /*#Y30SSFR*/ 10577000
         MVC   ZAREA(256,ZPTR),ZER                                 2176 10578000
*                      ZSIZE = ZSIZE - 256;                /*#Y30SSFR*/ 10579000
         SLR   ZSIZE,@15                                           2177 10580000
*                      ZPTR = ZPTR + 256;                  /*#Y30SSFR*/ 10581000
         ALR   ZPTR,@15                                            2178 10582000
*                      END;                                /*#Y30SSFR*/ 10583000
*                    ELSE                                  /*#Y30SSFR*/ 10584000
*                      DO;                                 /*#Y30SSFR*/ 10585000
         B     @RC02174                                            2180 10586000
@RF02174 DS    0H                                                  2181 10587000
*                      ZAREA(1:ZSIZE) = ZER(1:ZSIZE);      /*#Y30SSFR*/ 10588000
         LR    @15,ZSIZE                                           2181 10589000
         BCTR  @15,0                                               2181 10590000
         EX    @15,@SM01687                                        2181 10591000
*                      ZCNTRL = OFF;                       /*#Y30SSFR*/ 10592000
         NI    ZCNTRL,B'01111111'                                  2182 10593000
*                      END;                                /*#Y30SSFR*/ 10594000
*                END;                                      /*#Y30SSFR*/ 10595000
*                                                                  2184 10596000
@RC02174 DS    0H                                                  2184 10597000
@DE02173 TM    ZCNTRL,B'10000000'                                  2184 10598000
         BO    @DL02173                                            2184 10599000
*                CALL BFPLPROC(ADDR(FIELDLST),IENTNAME,    /*#Y30SSFR*/ 10600000
*                  CTGFIELD(IRENTNAM),NULLPARM,NULLPARM,   /*#Y30SSFR*/ 10601000
*                  NULLPARM);                              /*#Y30SSFR*/ 10602000
*                                                                  2185 10603000
         MVC   @AL00001+4(20),@AL02185                             2185 10604000
         LA    @15,FIELDLST                                        2185 10605000
         ST    @15,@AFTEMPS+20                                     2185 10606000
         LA    @15,@AFTEMPS+20                                     2185 10607000
         ST    @15,@AL00001                                        2185 10608000
         L     @01,CTGPLPTR                                        2185 10609000
         LA    @15,CTGFIELD(,@01)                                  2185 10610000
         ST    @15,@AL00001+8                                      2185 10611000
         LA    @01,@AL00001                                        2185 10612000
         BAL   @14,BFPLPROC                                        2185 10613000
*                RESPECIFY RTNREG RSTD;                            2186 10614000
*                TESTRC = RTNREG;                                  2187 10615000
         LR    TESTRC,RTNREG                                       2187 10616000
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/ 10617000
*                                                                  2188 10618000
*                IF TESTRC ^= 0                            /*#Y30SSFR*/ 10619000
*                  THEN                                    /*#Y30SSFR*/ 10620000
         LTR   TESTRC,TESTRC                                       2189 10621000
         BZ    @RF02189                                            2189 10622000
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/ 10623000
*                                                                  2190 10624000
         LA    @15,12                                              2190 10625000
         L     @14,@SA00014                                        2190 10626000
         LM    @00,@12,@SA00014+8                                  2190 10627000
         BR    @14                                                 2190 10628000
*                CALL CTLGPROC(RLCPLPTR);                  /*#Y30SSFR*/ 10629000
*                                                                  2191 10630000
@RF02189 LA    @15,RLCPLPTR                                        2191 10631000
         ST    @15,@AL00001                                        2191 10632000
         LA    @01,@AL00001                                        2191 10633000
         BAL   @14,CTLGPROC                                        2191 10634000
*                RESPECIFY RTNREG RSTD;                            2192 10635000
*                TESTRC = RTNREG;                                  2193 10636000
         LR    TESTRC,RTNREG                                       2193 10637000
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/ 10638000
*                                                                  2194 10639000
*                IF TESTRC ^= 0                            /*#Y30SSFR*/ 10640000
*                  THEN                                    /*#Y30SSFR*/ 10641000
         LTR   TESTRC,TESTRC                                       2195 10642000
         BZ    @RF02195                                            2195 10643000
*                    DO;                                   /*@Y30SSFR*/ 10644000
*                    IF EMPTYDS = OFF                      /*@Y30SSFR*/ 10645000
*                      THEN                                /*@Y30SSFR*/ 10646000
         TM    EMPTYDS,B'10000000'                                 2197 10647000
         BNZ   @RF02197                                            2197 10648000
*                        IMPF2DEL = ON;                    /*@Y30SSFR*/ 10649000
         OI    IMPF2DEL,B'01000000'                                2198 10650000
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/ 10651000
@RF02197 LA    @15,12                                              2199 10652000
         L     @14,@SA00014                                        2199 10653000
         LM    @00,@12,@SA00014+8                                  2199 10654000
         BR    @14                                                 2199 10655000
*                    END;                                  /*@Y30SSFR*/ 10656000
*                                                                  2200 10657000
*                CTGFLPTR = CTGFIELD(IRENTNAM);            /*#Y30SSFR*/ 10658000
*                                                                  2201 10659000
@RF02195 L     @01,CTGPLPTR                                        2201 10660000
         L     CTGFLPTR,CTGFIELD(,@01)                             2201 10661000
*                IF RLCPLPTR->CTGFIELD(IRENTNAM)->         /*#Y30SSFR*/ 10662000
*                  CTGFLPT(1)->FENTNAME ^= FVTPTR(1)->     /*#Y30SSFR*/ 10663000
*                  CTGFVENT->FENTNAME                      /*#Y30SSFR*/ 10664000
*                  THEN                                    /*#Y30SSFR*/ 10665000
         L     @01,RLCPLPTR                                        2202 10666000
         L     @01,CTGFIELD(,@01)                                  2202 10667000
         L     @01,CTGFLPT(,@01)                                   2202 10668000
         L     @15,FVTPTR                                          2202 10669000
         L     @15,CTGFVENT(,@15)                                  2202 10670000
         CLC   FENTNAME(44,@01),FENTNAME(@15)                      2202 10671000
         BE    @RF02202                                            2202 10672000
*                    DO;                                   /*#Y30SSFR*/ 10673000
*                                                                  2203 10674000
*                    /************************************************/ 10675000
*                    /*                                      #Y30SSFR*/ 10676000
*                    /*  THE NAME OF THE BASE OBJECT OPENED  #Y30SSFR*/ 10677000
*                    /*  DOES NOT EQUAL THE NAME OF THE      #Y30SSFR*/ 10678000
*                    /*  OBJECT DEFINED BY IMPORT.  PRINT    #Y30SSFR*/ 10679000
*                    /*  AN ERROR MESSAGE AND INDICATE       #Y30SSFR*/ 10680000
*                    /*  THAT THE OBJECT DEFINED IS TO BE    #Y30SSFR*/ 10681000
*                    /*  DELETED UNLESS IT WAS A PREDEFINED  #Y30SSFR*/ 10682000
*                    /*  EMPTY DATA SET.                     #Y30SSFR*/ 10683000
*                    /*                                      #Y30SSFR*/ 10684000
*                    /************************************************/ 10685000
*                                                                  2204 10686000
*                    DARGSMOD = UNIVMSG;                   /*#Y30SSFR*/ 10687000
         L     @14,DDSTRU                                          2204 10688000
         MVC   DARGSMOD(3,@14),@CC01023                            2204 10689000
*                    DEFSTID = NOOPENMG;                   /*#Y30SSFR*/ 10690000
         MVI   DEFSTID,X'0B'                                       2205 10691000
*                    DARGILP = LENGTH(FENTNAME);           /*#Y30SSFR*/ 10692000
         MVC   DARGILP(2,@14),@CH00605                             2206 10693000
*                    DARGDBP = ADDR(FVTPTR(1)->CTGFVENT->  /*#Y30SSFR*/ 10694000
*                       FENTNAME);                         /*#Y30SSFR*/ 10695000
         ST    @15,DARGDBP(,@14)                                   2207 10696000
*                    IF EMPTYDS = OFF                      /*#Y30SSFR*/ 10697000
*                      THEN                                /*#Y30SSFR*/ 10698000
         TM    EMPTYDS,B'10000000'                                 2208 10699000
         BNZ   @RF02208                                            2208 10700000
*                        IMPF2DEL = ON;                    /*#Y30SSFR*/ 10701000
         OI    IMPF2DEL,B'01000000'                                2209 10702000
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/ 10703000
@RF02208 LA    @15,12                                              2210 10704000
         L     @14,@SA00014                                        2210 10705000
         LM    @00,@12,@SA00014+8                                  2210 10706000
         BR    @14                                                 2210 10707000
*                    END;                                  /*#Y30SSFR*/ 10708000
*                                                                  2211 10709000
*                  ELSE ;                                  /*#Y30SSFR*/ 10710000
@RF02202 DS    0H                                                  2213 10711000
*                END;                                      /*#Y30SSFR*/ 10712000
*                                                                  2213 10713000
*              ELSE                                        /*#Y30SSFR*/ 10714000
*                                                                  2214 10715000
*                /****************************************************/ 10716000
*                /*                                          #Y30SSFR*/ 10717000
*                /*  THE OBJECT WAS NOT A PATH.              #Y30SSFR*/ 10718000
*                /*  PREPARE TO PRINT AN ERROR MESSAGE AND   #Y30SSFR*/ 10719000
*                /*  SET A FLAG INDICATING THAT THE OBJECT   #Y30SSFR*/ 10720000
*                /*  DEFINED BY IMPORT IS TO BE DELETED      #Y30SSFR*/ 10721000
*                /*  UNLESS IT IS A PRE-DEFINED DATA         #Y30SSFR*/ 10722000
*                /*  SET.                                    #Y30SSFR*/ 10723000
*                /*                                          #Y30SSFR*/ 10724000
*                /****************************************************/ 10725000
*                                                                  2214 10726000
*                DO;                                       /*#Y30SSFR*/ 10727000
         B     @RC02162                                            2214 10728000
@RF02162 DS    0H                                                  2215 10729000
*                DEFSTID = NOOPENMG;                       /*#Y30SSFR*/ 10730000
         MVI   DEFSTID,X'0B'                                       2215 10731000
*                DARGSMOD = UNIVMSG;                       /*#Y30SSFR*/ 10732000
         L     @15,DDSTRU                                          2216 10733000
         MVC   DARGSMOD(3,@15),@CC01023                            2216 10734000
*                DARGILP = LENGTH(FENTNAME);               /*#Y30SSFR*/ 10735000
         MVC   DARGILP(2,@15),@CH00605                             2217 10736000
*                DARGDBP = ADDR(FVTPTR(1)->CTGFVENT->      /*#Y30SSFR*/ 10737000
*                   FENTNAME);                             /*#Y30SSFR*/ 10738000
         L     @01,FVTPTR                                          2218 10739000
         L     @14,CTGFVENT(,@01)                                  2218 10740000
         ST    @14,DARGDBP(,@15)                                   2218 10741000
*                IF EMPTYDS = OFF                          /*#Y30SSFR*/ 10742000
*                  THEN                                    /*#Y30SSFR*/ 10743000
         TM    EMPTYDS,B'10000000'                                 2219 10744000
         BNZ   @RF02219                                            2219 10745000
*                    IMPF2DEL = ON;                        /*#Y30SSFR*/ 10746000
         OI    IMPF2DEL,B'01000000'                                2220 10747000
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/ 10748000
@RF02219 LA    @15,12                                              2221 10749000
         L     @14,@SA00014                                        2221 10750000
         LM    @00,@12,@SA00014+8                                  2221 10751000
         BR    @14                                                 2221 10752000
*                END;                                      /*#Y30SSFR*/ 10753000
*                                                                  2222 10754000
*            END PTHTEST;                                  /*#Y30SSFR*/ 10755000
*                                                                  2223 10756000
*          ELSE ;                                          /*#Y30SSFR*/ 10757000
*                                                                  2224 10758000
@RF02127 DS    0H                                                  2225 10759000
*        /************************************************************/ 10760000
*        /*                                                          */ 10761000
*        /*  COPY DATA BY RECORD FROM THE PORTABILITY DATA SET TO    */ 10762000
*        /*  THE CLUSTER. IF ANY ERRORS ARE ENCOUNTERED, RETURN TO   */ 10763000
*        /*  CALLING PROCESSOR WITH ERROR INDICATED                  */ 10764000
*        /*                                                          */ 10765000
*        /************************************************************/ 10766000
*                                                                  2225 10767000
*        CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);                  2225 10768000
*                                                                  2225 10769000
@RC02127 L     @03,@PC00001                                        2225 10770000
         ST    @03,@AL00001                                        2225 10771000
         LA    @15,PINIOCS                                         2225 10772000
         ST    @15,@AL00001+4                                      2225 10773000
         LA    @15,POUTIOCS                                        2225 10774000
         ST    @15,@AL00001+8                                      2225 10775000
         MVI   @AL00001+8,X'80'                                    2225 10776000
         L     @15,GDTCPY(,@03)                                    2225 10777000
         LA    @01,@AL00001                                        2225 10778000
         BALR  @14,@15                                             2225 10779000
*        RESPECIFY RTNREG RSTD;                                    2226 10780000
*        TESTRC = RTNREG;                                          2227 10781000
         LR    TESTRC,RTNREG                                       2227 10782000
*        RESPECIFY RTNREG UNRSTD;                                  2228 10783000
*        IF TESTRC ^= 0                                            2229 10784000
*          THEN                                                    2229 10785000
         LTR   TESTRC,TESTRC                                       2229 10786000
         BZ    @RF02229                                            2229 10787000
*            DO;                                           /*#Y30SSFR*/ 10788000
*            IMPF2DEL = ON;                                /*#Y30SSFR*/ 10789000
         OI    IMPF2DEL,B'01000000'                                2231 10790000
*            RETURN CODE(LASTCC12);                                2232 10791000
         LA    @15,12                                              2232 10792000
         L     @14,@SA00014                                        2232 10793000
         LM    @00,@12,@SA00014+8                                  2232 10794000
         BR    @14                                                 2232 10795000
*            END;                                          /*#Y30SSFR*/ 10796000
*                                                                  2233 10797000
*        /************************************************************/ 10798000
*        /*                                                          */ 10799000
*        /*  CLOSE THE OUTPUT DATA SET (THE VSAM CLUSTER).  IF THE   */ 10800000
*        /*  CLOSE FAILS, RETURN TO THE CALLING PROCESSOR WITH ERROR */ 10801000
*        /*  INDICATED.                                              */ 10802000
*        /*                                                          */ 10803000
*        /************************************************************/ 10804000
*                                                                  2234 10805000
*        CALL IDCIOCL0 (GDTTBL,POUTIOCS);                          2234 10806000
*                                                                  2234 10807000
@RF02229 L     @03,@PC00001                                        2234 10808000
         ST    @03,@AL00001                                        2234 10809000
         LA    @15,POUTIOCS                                        2234 10810000
         ST    @15,@AL00001+4                                      2234 10811000
         MVI   @AL00001+4,X'80'                                    2234 10812000
         L     @15,GDTCLS(,@03)                                    2234 10813000
         LA    @01,@AL00001                                        2234 10814000
         BALR  @14,@15                                             2234 10815000
*        RESPECIFY RTNREG RSTD;                                    2235 10816000
*        TESTRC = RTNREG;                                          2236 10817000
         LR    TESTRC,RTNREG                                       2236 10818000
*        RESPECIFY RTNREG UNRSTD;                                  2237 10819000
*        POUTIOCS = NULLPTR;                                       2238 10820000
         SLR   @03,@03                                             2238 10821000
         ST    @03,POUTIOCS                                        2238 10822000
*        IF TESTRC ^= 0                                            2239 10823000
*          THEN                                                    2239 10824000
         CR    TESTRC,@03                                          2239 10825000
         BE    @RF02239                                            2239 10826000
*            DO;                                           /*#Y30SSFR*/ 10827000
*            IMPF2DEL = ON;                                /*#Y30SSFR*/ 10828000
         OI    IMPF2DEL,B'01000000'                                2241 10829000
*            RETURN CODE(LASTCC12);                                2242 10830000
         LA    @15,12                                              2242 10831000
         L     @14,@SA00014                                        2242 10832000
         LM    @00,@12,@SA00014+8                                  2242 10833000
         BR    @14                                                 2242 10834000
*            END;                                          /*#Y30SSFR*/ 10835000
*                                                                  2243 10836000
*        /************************************************************/ 10837000
*        /*                                                          */ 10838000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */ 10839000
*        /*  COMPLETION INDICATED                                    */ 10840000
*        /*                                                          */ 10841000
*        /************************************************************/ 10842000
*                                                                  2244 10843000
*        RETURN CODE(LASTCC00);                                    2244 10844000
@RF02239 SLR   @15,@15                                             2244 10845000
         L     @14,@SA00014                                        2244 10846000
         LM    @00,@12,@SA00014+8                                  2244 10847000
         BR    @14                                                 2244 10848000
*END RECPROC;                                                      2245 10849000
*        /************************************************************/ 10850000
*        /*                                                          */ 10851000
*        /*  PROCEDURE NAME - MVDAPROC                               */ 10852000
*        /*                                                          */ 10853000
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE TO      */ 10854000
*        /*  ANOTHER AS SPECIFIED BY INPUT ARGUMENTS.                */ 10855000
*        /*                                                          */ 10856000
*        /*  INPUT -                                                 */ 10857000
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED           @Y30SSFR*/ 10858000
*        /*    .MF1PTR- FROM LOCATION                        @Y30SSFR*/ 10859000
*        /*    .MT1PTR- TO LOCATION                          @Y30SSFR*/ 10860000
*        /*                                                          */ 10861000
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */ 10862000
*        /*  THE "TO" AGRUMENT (MPTR).                               */ 10863000
*        /*                                                          */ 10864000
*        /************************************************************/ 10865000
*                                                                  2246 10866000
*MVDAPROC: PROCEDURE(MSIZE,                                        2246 10867000
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */ 10868000
*                    MT1PTR);          /*LOCATION TO MOVE DATA INTO  */ 10869000
*                                                                  2246 10870000
MVDAPROC STM   @14,@12,12(@13)                                     2246 10871000
         MVC   @PC00015(12),0(@01)                                 2246 10872000
*        /************************************************************/ 10873000
*        /*                                                          */ 10874000
*        /*  ARGUMENTS OF INVOCATION                                 */ 10875000
*        /*                                                          */ 10876000
*        /************************************************************/ 10877000
*                                                                  2247 10878000
*        DCL MSIZE    FIXED(15),                                   2247 10879000
*            MF1PTR   PTR(31),                                     2247 10880000
*            MT1PTR   PTR(31);                                     2247 10881000
*                                                                  2247 10882000
*        /************************************************************/ 10883000
*        /*                                                          */ 10884000
*        /*  LOCAL DECLARATIONS                                      */ 10885000
*        /*                                                          */ 10886000
*        /************************************************************/ 10887000
*                                                                  2248 10888000
*        DCL MFPTR PTR(31);            /*WORKING SOURCE PTR  @Y30SSFR*/ 10889000
*        DCL MTPTR PTR(31);            /*WORKING TARGET PTR  @Y30SSFR*/ 10890000
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                        2250 10891000
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                        2251 10892000
*        DCL M1SIZE FIXED(15);                                     2252 10893000
*        DCL DOCNTRL  BIT(1);                                      2253 10894000
*                                                                  2253 10895000
*        /************************************************************/ 10896000
*        /*                                                          */ 10897000
*        /*  LOOP MOVING 256 BYTES AT A TIME                         */ 10898000
*        /*                                                          */ 10899000
*        /************************************************************/ 10900000
*                                                                  2254 10901000
*        MFPTR = MF1PTR;                                           2254 10902000
         L     @15,@PC00015+4                                      2254 10903000
         L     MFPTR,MF1PTR(,@15)                                  2254 10904000
*        MTPTR = MT1PTR;                                           2255 10905000
         L     @05,@PC00015+8                                      2255 10906000
         L     MTPTR,MT1PTR(,@05)                                  2255 10907000
*        M1SIZE = MSIZE;                                           2256 10908000
         L     @05,@PC00015                                        2256 10909000
         LH    M1SIZE,MSIZE(,@05)                                  2256 10910000
*        DOCNTRL = ON;                                             2257 10911000
         OI    DOCNTRL,B'10000000'                                 2257 10912000
*        DO WHILE (DOCNTRL = ON);                                  2258 10913000
*                                                                  2258 10914000
         B     @DE02258                                            2258 10915000
@DL02258 DS    0H                                                  2259 10916000
*          /**********************************************************/ 10917000
*          /*                                                        */ 10918000
*          /*  CHECK FOR MORE THAN 256 BYTES TO MOVE                 */ 10919000
*          /*                                                        */ 10920000
*          /**********************************************************/ 10921000
*                                                                  2259 10922000
*          IF M1SIZE > 256                                         2259 10923000
*            THEN                                                  2259 10924000
         LA    @05,256                                             2259 10925000
         CR    M1SIZE,@05                                          2259 10926000
         BNH   @RF02259                                            2259 10927000
*              DO;                                                 2260 10928000
*              /******************************************************/ 10929000
*              /*                                                    */ 10930000
*              /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND      */ 10931000
*              /*  POINTER VARIABLES FOR NEXT ITERATION              */ 10932000
*              /*                                                    */ 10933000
*              /******************************************************/ 10934000
*                                                                  2261 10935000
*              TOAREA(1:256) = FROMAREA(1:256);                    2261 10936000
         MVC   TOAREA(256,MTPTR),FROMAREA(MFPTR)                   2261 10937000
*              M1SIZE = M1SIZE - 256;                              2262 10938000
         SLR   M1SIZE,@05                                          2262 10939000
*              MTPTR = MTPTR +256;                                 2263 10940000
         ALR   MTPTR,@05                                           2263 10941000
*              MFPTR = MFPTR + 256;                                2264 10942000
         ALR   MFPTR,@05                                           2264 10943000
*              END;                                                2265 10944000
*                                                                  2265 10945000
*            ELSE                                                  2266 10946000
*              DO;                                                 2266 10947000
         B     @RC02259                                            2266 10948000
@RF02259 DS    0H                                                  2267 10949000
*              /******************************************************/ 10950000
*              /*                                                    */ 10951000
*              /*  MOVE NUMBER OF BYTES INDICATED BY MSIZE AND RETURN*/ 10952000
*              /*                                                    */ 10953000
*              /******************************************************/ 10954000
*                                                                  2267 10955000
*              TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);              2267 10956000
         LR    @05,M1SIZE                                          2267 10957000
         BCTR  @05,0                                               2267 10958000
         EX    @05,@SM01733                                        2267 10959000
*              DOCNTRL = OFF;                                      2268 10960000
         NI    DOCNTRL,B'01111111'                                 2268 10961000
*              END;                                                2269 10962000
*          END;                                                    2270 10963000
*                                                                  2270 10964000
@RC02259 DS    0H                                                  2270 10965000
@DE02258 TM    DOCNTRL,B'10000000'                                 2270 10966000
         BO    @DL02258                                            2270 10967000
*        /************************************************************/ 10968000
*        /*                                                          */ 10969000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 10970000
*        /*                                                          */ 10971000
*        /************************************************************/ 10972000
*                                                                  2271 10973000
*        RETURN CODE(0);                                           2271 10974000
         SLR   @15,@15                                             2271 10975000
         L     @14,12(,@13)                                        2271 10976000
         LM    @00,@12,20(@13)                                     2271 10977000
         BR    @14                                                 2271 10978000
*END MVDAPROC;                                             /*@Y30SSFR*/ 10979000
*        /************************************************************/ 10980000
*        /*                                                          */ 10981000
*        /*  PROCEDURE NAME - MSGPROC                                */ 10982000
*        /*                                                          */ 10983000
*        /*  FUNCTION - USE TEXT PROCESSOR INTERFACE TO LIST         */ 10984000
*        /*  INFORMATIONAL OR ERROR MESSAGE TO USER                  */ 10985000
*        /*                                                          */ 10986000
*        /*  INPUT - MESSAGE ID FOR STATIC TEXT MODULE, DARGSMOD     */ 10987000
*        /*  ALREADY CONTAINS MODULE ID                              */ 10988000
*        /*                                                          */ 10989000
*        /*  OUTPUT - MESSAGE WILL BE LISTED FOR USER. ARGUMENT      */ 10990000
*        /*  LIST FOR TEXT PROCESSOR WILL BE ZEROED, EXCEPT FOR      */ 10991000
*        /*  STATIC TEXT MODULE ID, WHICH WILL BE SET TO IMPORT      */ 10992000
*        /*  STATIC TEXT MODULE.                                     */ 10993000
*        /*                                                          */ 10994000
*        /************************************************************/ 10995000
*                                                                  2273 10996000
*MSGPROC: PROCEDURE(MNUM);             /*MESSAGE ID NUMBER IN STATIC */ 10997000
MSGPROC  STM   @14,@12,@SA00016                                    2273 10998000
         MVC   @PC00016(4),0(@01)                                  2273 10999000
*                                      /*TEXT MODULE                 */ 11000000
*                                                                  2274 11001000
*        /************************************************************/ 11002000
*        /*                                                          */ 11003000
*        /*  ARGUMENTS OF INVOCATION                                 */ 11004000
*        /*                                                          */ 11005000
*        /************************************************************/ 11006000
*                                                                  2274 11007000
*        DCL MNUM FIXED(8);                                        2274 11008000
*                                                                  2274 11009000
*        /************************************************************/ 11010000
*        /*                                                          */ 11011000
*        /*  ISSUE TEXT PROCESSOR UPRINT TO LIST MESSAGE             */ 11012000
*        /*  IF PRINT FAILS, RETURN TO CALLING PROCESSOR INDICATING  */ 11013000
*        /*  FAILURE.                                                */ 11014000
*        /*                                                          */ 11015000
*        /************************************************************/ 11016000
*                                                                  2275 11017000
*        OLDERID2 = NEWERID2;                                      2275 11018000
         L     @15,@PC00001                                        2275 11019000
         L     @15,GDTTR2(,@15)                                    2275 11020000
         MVC   @TS00001(95),NEWERID2(@15)                          2275 11021000
         MVC   OLDERID2(95,@15),@TS00001                           2275 11022000
*        NEWID2 = 'MPMG';                                          2276 11023000
         MVC   NEWID2(4,@15),@CC01569                              2276 11024000
*        DARGSENT = MNUM;                                          2277 11025000
*                                                                  2277 11026000
         L     @15,DDSTRU                                          2277 11027000
         L     @14,@PC00016                                        2277 11028000
         IC    @05,MNUM(,@14)                                      2277 11029000
         STC   @05,DARGSENT(,@15)                                  2277 11030000
*        IF MNUM = CATLGMSG & DARGSMOD = UNIVMSG                   2278 11031000
*          THEN                                                    2278 11032000
         CLI   MNUM(@14),7                                         2278 11033000
         BNE   @RF02278                                            2278 11034000
         CLC   DARGSMOD(3,@15),@CC01023                            2278 11035000
         BNE   @RF02278                                            2278 11036000
*            DO;                                                   2279 11037000
*            DARGDBP = ADDR(CATLGRC);                              2280 11038000
         LA    @14,CATLGRC                                         2280 11039000
         ST    @14,DARGDBP(,@15)                                   2280 11040000
*            DARGILP = 2;                                          2281 11041000
         MVC   DARGILP(2,@15),@CH00156                             2281 11042000
*            END;                                                  2282 11043000
*                                                                  2282 11044000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    2283 11045000
*                                                                  2283 11046000
*                                                                  2283 11047000
@RF02278 L     @15,@PC00001                                        2283 11048000
         ST    @15,@AL00001                                        2283 11049000
         LA    @14,@CF00118                                        2283 11050000
         ST    @14,@AL00001+4                                      2283 11051000
         LA    @14,DDSTRU                                          2283 11052000
         ST    @14,@AL00001+8                                      2283 11053000
         MVI   @AL00001+8,X'80'                                    2283 11054000
         L     @15,GDTPRT(,@15)                                    2283 11055000
         LA    @01,@AL00001                                        2283 11056000
         BALR  @14,@15                                             2283 11057000
*        /************************************************************/ 11058000
*        /*                                                          */ 11059000
*        /*  ZERO OUT ARGUMENT FOR TEXT PROCESSOR INTERFACE AND      */ 11060000
*        /*  RESET MODULE ID                                         */ 11061000
*        /*                                                          */ 11062000
*        /************************************************************/ 11063000
*                                                                  2284 11064000
*        DARGLIST = ''B;                                           2284 11065000
         L     @15,DDSTRU                                          2284 11066000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      2284 11067000
*        DARGSMOD = 'MP0';                                         2285 11068000
         MVC   DARGSMOD(3,@15),@CC01000                            2285 11069000
*        RETURN CODE(0);                                           2286 11070000
         SLR   @15,@15                                             2286 11071000
         L     @14,@SA00016                                        2286 11072000
         LM    @00,@12,@SA00016+8                                  2286 11073000
         BR    @14                                                 2286 11074000
*END MSGPROC;                                                      2287 11075000
*        /************************************************************/ 11076000
*        /*                                                          */ 11077000
*        /*  PROCEDURE NAME - FVTPROC                                */ 11078000
*        /*                                                          */ 11079000
*        /*  FUNCTION - CONSTRUCT FVT AND FPL'S FROM INFORMATION     */ 11080000
*        /*  IN THE DICTIONARY PASSED AS AN ARGUMENT TO THIS         */ 11081000
*        /*  PROCEDURE.  FPL'S WILL POINT TO THE CATALOG FIELD       */ 11082000
*        /*  INFORMATION WITHIN THE WORK AREA.                       */ 11083000
*        /*                                                          */ 11084000
*        /*  INPUT -                                                 */ 11085000
*        /*    .FDICT - POINTER TO DICTIONARY WHICH REFERENCES       */ 11086000
*        /*      CATALOG FIELD INFORMATION WITH WORK AREA            */ 11087000
*        /*    .FWKA - WORK AREA CONTAINING CATALOG FIELD INFORMATION*/ 11088000
*        /*    .FPTRFVT - RETURN CELL FOR FVT POINTER                */ 11089000
*        /*                                                          */ 11090000
*        /*  OUTPUT - POINTER TO FVT CONSTRUCTED.  THIS FVT WILL     */ 11091000
*        /*  REFERENCE ALL FPL'S CONSTRUCTED BY THIS PROCEDURE       */ 11092000
*        /*                                                          */ 11093000
*        /************************************************************/ 11094000
*                                                                  2288 11095000
*FVTPROC: PROCEDURE(FDICT,             /*DICTIONARY POINTER          */ 11096000
*                  FWKA,     /*WORK AREA POINTER                     */ 11097000
*                  FPTRFVT); /*RETURN CELL FOR FVT POINTER           */ 11098000
*                                                                  2288 11099000
FVTPROC  STM   @14,@12,@SA00017                                    2288 11100000
         MVC   @PC00017(12),0(@01)                                 2288 11101000
*        /************************************************************/ 11102000
*        /*                                                          */ 11103000
*        /*  ARGUMENTS OF INVOCATION                                 */ 11104000
*        /*                                                          */ 11105000
*        /************************************************************/ 11106000
*                                                                  2289 11107000
*        DCL FDICT    PTR(31),                                     2289 11108000
*            FWKA     PTR(31),                                     2289 11109000
*            FPTRFVT  PTR(31);                                     2289 11110000
*                                                                  2289 11111000
*        /************************************************************/ 11112000
*        /*                                                          */ 11113000
*        /*  LOCAL DECLARATIONS                                      */ 11114000
*        /*                                                          */ 11115000
*        /************************************************************/ 11116000
*                                                                  2290 11117000
*        DCL FPLADDR  PTR(31);                                     2290 11118000
*        DCL FPLNUM  FIXED(15) CONSTANT(12); /*NUMBER OF FPL'S BUILT */ 11119000
*                                       /*BY THIS PROCEDURE          */ 11120000
*        DCL FIELDPTR  PTR(31);   /*USED TO POINT TO ENTRY TYPE      */ 11121000
*                                      /* OR SECFLAGS IN THE         */ 11122000
*                                      /* DICTIONARY WORK AREA       */ 11123000
*                                                                  2293 11124000
*        /************************************************************/ 11125000
*        /*                                                          */ 11126000
*        /*  GET CORE FOR THE FVT AND THE TOTAL NUMBER OF FPL'S      */ 11127000
*        /*  THAT CAN BE CONSTRUCTED BY THIS PROCEDURE               */ 11128000
*        /*                                                          */ 11129000
*        /************************************************************/ 11130000
*                                                                  2293 11131000
*        OLDERID2 = NEWERID2;                                      2293 11132000
         L     @03,@PC00001                                        2293 11133000
         L     @15,GDTTR2(,@03)                                    2293 11134000
         MVC   @TS00001(95),NEWERID2(@15)                          2293 11135000
         MVC   OLDERID2(95,@15),@TS00001                           2293 11136000
*        NEWID2 = 'MPFV';                                          2294 11137000
         MVC   NEWID2(4,@15),@CC01582                              2294 11138000
*        RESPECIFY CTGFV BASED(FPTRFVT);                           2295 11139000
*        TOTLEN =2*(LENGTH(CTGFV) + (LENGTH(CTGFL)+8) * FPLNUM     2296 11140000
*          + LENGTH(IDAAMDSB));                                    2296 11141000
*                                                                  2296 11142000
         MVC   TOTLEN(4),@CF01674                                  2296 11143000
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,FPTRFVT,GPID,SETZERO);       2297 11144000
*                                                                  2297 11145000
         ST    @03,@AL00001                                        2297 11146000
         LA    @15,TOTLEN                                          2297 11147000
         ST    @15,@AL00001+4                                      2297 11148000
         L     @15,@PC00017+8                                      2297 11149000
         ST    @15,@AL00001+8                                      2297 11150000
         LA    @15,GPID                                            2297 11151000
         ST    @15,@AL00001+12                                     2297 11152000
         LA    @15,SETZERO                                         2297 11153000
         ST    @15,@AL00001+16                                     2297 11154000
         MVI   @AL00001+16,X'80'                                   2297 11155000
         L     @15,GDTGPL(,@03)                                    2297 11156000
         LA    @01,@AL00001                                        2297 11157000
         BALR  @14,@15                                             2297 11158000
*        RESPECIFY RTNREG RSTD;                                    2298 11159000
*        TESTRC = RTNREG;                                          2299 11160000
         LR    TESTRC,RTNREG                                       2299 11161000
*        RESPECIFY RTNREG UNRSTD;                                  2300 11162000
*        IF TESTRC ^= 0                                            2301 11163000
*          THEN                                                    2301 11164000
*                                                                  2301 11165000
         LTR   TESTRC,TESTRC                                       2301 11166000
         BZ    @RF02301                                            2301 11167000
*            /********************************************************/ 11168000
*            /*                                                      */ 11169000
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */ 11170000
*            /*  CALLING PROCESSOR WITH FAILURE INDICATED            */ 11171000
*            /*                                                      */ 11172000
*            /********************************************************/ 11173000
*                                                                  2302 11174000
*            DO;                                                   2302 11175000
*            DEFSTID = NOSTORAG;                                   2303 11176000
         MVI   DEFSTID,X'04'                                       2303 11177000
*            RETURN CODE(LASTCC12);                                2304 11178000
         LA    @15,12                                              2304 11179000
         L     @14,@SA00017                                        2304 11180000
         LM    @00,@12,@SA00017+8                                  2304 11181000
         BR    @14                                                 2304 11182000
*            END;                                                  2305 11183000
*                                                                  2305 11184000
*        DICTPTR = FDICT;                                          2306 11185000
@RF02301 L     @03,@PC00017                                        2306 11186000
         L     @03,FDICT(,@03)                                     2306 11187000
         ST    @03,DICTPTR                                         2306 11188000
*        FPLADDR = FPTRFVT + LENGTH(CTGFV);                        2307 11189000
*                                                                  2307 11190000
         L     @15,@PC00017+8                                      2307 11191000
         L     @15,FPTRFVT(,@15)                                   2307 11192000
         LA    @14,92                                              2307 11193000
         ALR   @14,@15                                             2307 11194000
         ST    @14,FPLADDR                                         2307 11195000
*        /************************************************************/ 11196000
*        /*                                                          */ 11197000
*        /*  SET TYPE FIELD IN FVT FROM CATALOG FIELD INFORMATION    */ 11198000
*        /*                                                          */ 11199000
*        /************************************************************/ 11200000
*                                                                  2308 11201000
*        FIELDPTR = DICTDL(IENTYPE) + FWKA;                        2308 11202000
         L     @14,@PC00017+4                                      2308 11203000
         L     @14,FWKA(,@14)                                      2308 11204000
         L     FIELDPTR,DICTDL(,@03)                               2308 11205000
         ALR   FIELDPTR,@14                                        2308 11206000
*        CTGFVTYP = FIELDPTR -> FENTYPE;                           2309 11207000
         MVC   CTGFVTYP(1,@15),FENTYPE(FIELDPTR)                   2309 11208000
*        /*                                                  @Z40RSSA*/ 11209000
*        /*  SET CTGFVRON TO VALUE OF IMPORTED RAC INDICATOR @Z40RSSA*/ 11210000
*        /*                                                  @Z40RSSA*/ 11211000
*        IF DICTLN(ISECFLG) ^= NULLPTR THEN                        2310 11212000
         L     @02,DICTLN+248(,@03)                                2310 11213000
         LTR   @02,@02                                             2310 11214000
         BZ    @RF02310                                            2310 11215000
*          DO;                                             /*@Z40RSSA*/ 11216000
*            FIELDPTR = DICTDL(ISECFLG) + FWKA;            /*@Z40RSSA*/ 11217000
         AL    @14,DICTDL+248(,@03)                                2312 11218000
         LR    FIELDPTR,@14                                        2312 11219000
*            IF FIELDPTR -> RCDEXSEC= ON THEN                      2313 11220000
         TM    RCDEXSEC(FIELDPTR),B'10000000'                      2313 11221000
         BNO   @RF02313                                            2313 11222000
*              CTGFVRON=ON;                                /*@Z40RSSA*/ 11223000
         OI    CTGFVRON(@15),B'00001000'                           2314 11224000
*          END;                                            /*@Z40RSSA*/ 11225000
*                                                                  2315 11226000
*                                                                  2315 11227000
@RF02313 DS    0H                                                  2316 11228000
*        /************************************************************/ 11229000
*        /*                                                          */ 11230000
*        /*  SET ENTNAME FIELD POINTER IN FPL                        */ 11231000
*        /*                                                          */ 11232000
*        /************************************************************/ 11233000
*                                                                  2316 11234000
*        IF DICTLN(IENTNAME) ^= NULLPTR                            2316 11235000
*          THEN                                                    2316 11236000
@RF02310 L     @15,DICTPTR                                         2316 11237000
         L     @14,DICTLN+8(,@15)                                  2316 11238000
         LTR   @14,@14                                             2316 11239000
         BZ    @RF02316                                            2316 11240000
*            CTGFVENT = DICTDL(IENTNAME) + FWKA;                   2317 11241000
*                                                                  2317 11242000
         L     @14,@PC00017+8                                      2317 11243000
         L     @01,FPTRFVT(,@14)                                   2317 11244000
         L     @14,@PC00017+4                                      2317 11245000
         L     @15,DICTDL+8(,@15)                                  2317 11246000
         AL    @15,FWKA(,@14)                                      2317 11247000
         ST    @15,CTGFVENT(,@01)                                  2317 11248000
*        /************************************************************/ 11249000
*        /*                                                  @Y30SSFR*/ 11250000
*        /*  TEST TO DETERMINE IF WE ARE BUILDING AN FVT     @Y30SSFR*/ 11251000
*        /*  FOR AN AIX OR A PATH                            @Y30SSFR*/ 11252000
*        /*                                                  @Y30SSFR*/ 11253000
*        /************************************************************/ 11254000
*                                                                  2318 11255000
*        IF CTGFVTYP = CTGTAIX | CTGFVTYP = CTGTPTH        /*@Y30SSFR*/ 11256000
*          THEN                                            /*@Y30SSFR*/ 11257000
*                                                                  2318 11258000
@RF02316 L     @15,@PC00017+8                                      2318 11259000
         L     @15,FPTRFVT(,@15)                                   2318 11260000
         CLI   CTGFVTYP(@15),C'G'                                  2318 11261000
         BE    @RT02318                                            2318 11262000
         CLI   CTGFVTYP(@15),C'R'                                  2318 11263000
         BNE   @RF02318                                            2318 11264000
@RT02318 DS    0H                                                  2319 11265000
*            /********************************************************/ 11266000
*            /*                                              @Y30SSFR*/ 11267000
*            /*  BUILD AN FPL FOR RGATTR                     @Y30SSFR*/ 11268000
*            /*                                              @Y30SSFR*/ 11269000
*            /********************************************************/ 11270000
*                                                                  2319 11271000
*            DO;                                           /*@Y30SSFR*/ 11272000
*            CALL BFPLPROC(ADDR(FIELDLST),IRGATTR,FPLADDR, /*@Y30SSFR*/ 11273000
*               FDICT,FWKA,CTGFVUPG);                      /*@Y30SSFR*/ 11274000
*                                                                  2320 11275000
         LA    @15,FIELDLST                                        2320 11276000
         ST    @15,@AFTEMPS+28                                     2320 11277000
         LA    @15,@AFTEMPS+28                                     2320 11278000
         ST    @15,@AL00001                                        2320 11279000
         LA    @15,@CH01098                                        2320 11280000
         ST    @15,@AL00001+4                                      2320 11281000
         LA    @15,FPLADDR                                         2320 11282000
         ST    @15,@AL00001+8                                      2320 11283000
         L     @15,@PC00017                                        2320 11284000
         ST    @15,@AL00001+12                                     2320 11285000
         L     @15,@PC00017+4                                      2320 11286000
         ST    @15,@AL00001+16                                     2320 11287000
         L     @15,@PC00017+8                                      2320 11288000
         L     @01,FPTRFVT(,@15)                                   2320 11289000
         LA    @15,CTGFVUPG(,@01)                                  2320 11290000
         ST    @15,@AL00001+20                                     2320 11291000
         LA    @01,@AL00001                                        2320 11292000
         BAL   @14,BFPLPROC                                        2320 11293000
*            /********************************************************/ 11294000
*            /*                                              @Y30SSFR*/ 11295000
*            /*  DETERMINE IF AN FVT FOR AN AIX IS BEING     @Y30SSFR*/ 11296000
*            /*  BUILT.  IF SO, SET RELATED NAME VALUE.      @Y30SSFR*/ 11297000
*            /*                                              @Y30SSFR*/ 11298000
*            /********************************************************/ 11299000
*                                                                  2321 11300000
*            IF CTGFVTYP = CTGTAIX                         /*@Y30SSFR*/ 11301000
*              THEN                                        /*@Y30SSFR*/ 11302000
         L     @15,@PC00017+8                                      2321 11303000
         L     @15,FPTRFVT(,@15)                                   2321 11304000
         CLI   CTGFVTYP(@15),C'G'                                  2321 11305000
         BNE   @RF02321                                            2321 11306000
*                CTGFVNAM = DICTDL(IRELNAM) + FWKA;        /*@Y30SSFR*/ 11307000
         L     @14,@PC00017+4                                      2322 11308000
         L     @01,DICTPTR                                         2322 11309000
         L     @05,DICTDL+232(,@01)                                2322 11310000
         AL    @05,FWKA(,@14)                                      2322 11311000
         ST    @05,CTGFVNAM(,@15)                                  2322 11312000
*              ELSE                                        /*@Y30SSFR*/ 11313000
*                                                                  2323 11314000
*                /****************************************************/ 11315000
*                /*                                          @Y30SSFR*/ 11316000
*                /*  OTHERWISE WE ARE CONSTRUCTING A PATH    @Y30SSFR*/ 11317000
*                /*  FVT.  PLACE THE APPROPRIATE PATHENTRY   @Y30SSFR*/ 11318000
*                /*  NAME AND PASSWORD IN THE FVT.           @Y30SSFR*/ 11319000
*                /*                                          @Y30SSFR*/ 11320000
*                /****************************************************/ 11321000
*                                                                  2323 11322000
*                DO;                                       /*@Y30SSFR*/ 11323000
         B     @RC02321                                            2323 11324000
@RF02321 DS    0H                                                  2324 11325000
*                CTGFVNAM = FVTPTR(1) -> CTGFVENT;         /*@Y30SSFR*/ 11326000
         L     @15,@PC00017+8                                      2324 11327000
         L     @15,FPTRFVT(,@15)                                   2324 11328000
         L     @14,FVTPTR                                          2324 11329000
         L     @14,CTGFVENT(,@14)                                  2324 11330000
         ST    @14,CTGFVNAM(,@15)                                  2324 11331000
*                IF DICTDL(IPTHPASS) ^= 0                  /*@Y30SSFR*/ 11332000
*                  THEN                                    /*@Y30SSFR*/ 11333000
         L     @01,DICTPTR                                         2325 11334000
         L     @14,DICTDL+240(,@01)                                2325 11335000
         LTR   @14,@14                                             2325 11336000
         BZ    @RF02325                                            2325 11337000
*                    CTGFVPWD = DICTDL(IPTHPASS) + FWKA;   /*@Y30SSFR*/ 11338000
         L     @05,@PC00017+4                                      2326 11339000
         AL    @14,FWKA(,@05)                                      2326 11340000
         ST    @14,CTGFVPWD(,@15)                                  2326 11341000
*                END;                                      /*@Y30SSFR*/ 11342000
*                                                                  2327 11343000
@RF02325 DS    0H                                                  2328 11344000
*            END;                                          /*@Y30SSFR*/ 11345000
*                                                                  2328 11346000
@RC02321 DS    0H                                                  2329 11347000
*        /************************************************************/ 11348000
*        /*                                                  @Y30SSFR*/ 11349000
*        /*  CONSTRUCT PASSWALL FPL WHICH REFERENCES THE PASSWORD    */ 11350000
*        /*  CATALOG FIELD, PLACE POINTER TO FPL IN FVT      @Y30SSFR*/ 11351000
*        /*  IF THE PASSWALL FIELD IS NOT CONSTRUCTED        @Y30SSFR*/ 11352000
*        /*  SUCCESSFULLY, RETURN TO THE CALLING             @Y30SSFR*/ 11353000
*        /*  PROCESSOR WITH FAILURE INDICATED.               @Y30SSFR*/ 11354000
*        /*                                                  @Y30SSFR*/ 11355000
*        /************************************************************/ 11356000
*                                                                  2329 11357000
*        CTGFVSTY = FPLADDR;                               /*@Y30SSFR*/ 11358000
@RF02318 L     @15,@PC00017+8                                      2329 11359000
         L     @01,FPTRFVT(,@15)                                   2329 11360000
         L     @00,FPLADDR                                         2329 11361000
         ST    @00,CTGFVSTY(,@01)                                  2329 11362000
*        CALL BPASPROC(FPLADDR,FDICT,FWKA);                /*@Y30SSFR*/ 11363000
         LA    @15,FPLADDR                                         2330 11364000
         ST    @15,@AL00001                                        2330 11365000
         L     @15,@PC00017                                        2330 11366000
         ST    @15,@AL00001+4                                      2330 11367000
         L     @15,@PC00017+4                                      2330 11368000
         ST    @15,@AL00001+8                                      2330 11369000
         LA    @01,@AL00001                                        2330 11370000
         BAL   @14,BPASPROC                                        2330 11371000
*        RESPECIFY RTNREG RSTD;                                    2331 11372000
*        TESTRC = RTNREG;                                          2332 11373000
         LR    TESTRC,RTNREG                                       2332 11374000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/ 11375000
*        IF TESTRC ^= 0                                            2334 11376000
*          THEN                                                    2334 11377000
         SLR   @03,@03                                             2334 11378000
         CR    TESTRC,@03                                          2334 11379000
         BE    @RF02334                                            2334 11380000
*            DO;                                           /*@Y30SSFR*/ 11381000
*            IF TESTRC = 4                                         2336 11382000
*              THEN                                                2336 11383000
         C     TESTRC,@CF00045                                     2336 11384000
         BNE   @RF02336                                            2336 11385000
*                CTGFVSTY = NULLPTR;                       /*@Y30SSFR*/ 11386000
         L     @02,@PC00017+8                                      2337 11387000
         L     @01,FPTRFVT(,@02)                                   2337 11388000
         ST    @03,CTGFVSTY(,@01)                                  2337 11389000
*              ELSE                                                2338 11390000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 11391000
         B     @RC02336                                            2338 11392000
@RF02336 LA    @15,12                                              2338 11393000
         L     @14,@SA00017                                        2338 11394000
         LM    @00,@12,@SA00017+8                                  2338 11395000
         BR    @14                                                 2338 11396000
*            END;                                          /*@Y30SSFR*/ 11397000
*                                                                  2339 11398000
@RC02336 DS    0H                                                  2340 11399000
*        /************************************************************/ 11400000
*        /*                                                  @Y30SSFR*/ 11401000
*        /*  CONSTRUCT OWNERID FPL WHICH REFERENCES THE OWNER OF     */ 11402000
*        /*  DATA SET CATALOG FIELD, PLACE POINTER TO FPL IN FVT     */ 11403000
*        /*                                                  @Y30SSFR*/ 11404000
*        /************************************************************/ 11405000
*                                                                  2340 11406000
*        CALL BFPLPROC(ADDR(FIELDLST),IOWNERID,                    2340 11407000
*            FPLADDR,FDICT,FWKA,CTGFVOWN);                 /*@Y30SSFR*/ 11408000
*                                                                  2340 11409000
@RF02334 LA    @15,FIELDLST                                        2340 11410000
         ST    @15,@AFTEMPS+28                                     2340 11411000
         LA    @15,@AFTEMPS+28                                     2340 11412000
         ST    @15,@AL00001                                        2340 11413000
         LA    @15,@CH00045                                        2340 11414000
         ST    @15,@AL00001+4                                      2340 11415000
         LA    @15,FPLADDR                                         2340 11416000
         ST    @15,@AL00001+8                                      2340 11417000
         L     @15,@PC00017                                        2340 11418000
         ST    @15,@AL00001+12                                     2340 11419000
         L     @15,@PC00017+4                                      2340 11420000
         ST    @15,@AL00001+16                                     2340 11421000
         L     @15,@PC00017+8                                      2340 11422000
         L     @01,FPTRFVT(,@15)                                   2340 11423000
         LA    @15,CTGFVOWN(,@01)                                  2340 11424000
         ST    @15,@AL00001+20                                     2340 11425000
         LA    @01,@AL00001                                        2340 11426000
         BAL   @14,BFPLPROC                                        2340 11427000
*        /************************************************************/ 11428000
*        /*                                                  @Y30SSFR*/ 11429000
*        /*  CONSTRUCT DSETEXDT FPL WHICH REFERENCES         @Y30SSFR*/ 11430000
*        /*  THE EXPIRATION DATE CATALOG FIELD, PLACE        @Y30SSFR*/ 11431000
*        /*  POINTER IN FVT                                  @Y30SSFR*/ 11432000
*        /*                                                  @Y30SSFR*/ 11433000
*        /************************************************************/ 11434000
*                                                                  2341 11435000
*        CALL BFPLPROC(ADDR(FIELDLST),IDSETEXD,            /*@Y30SSFR*/ 11436000
*           FPLADDR,FDICT,FWKA,CTGFVEXP);                  /*@Y30SSFR*/ 11437000
*                                                                  2341 11438000
         LA    @15,FIELDLST                                        2341 11439000
         ST    @15,@AFTEMPS+28                                     2341 11440000
         LA    @15,@AFTEMPS+28                                     2341 11441000
         ST    @15,@AL00001                                        2341 11442000
         LA    @15,@CH00159                                        2341 11443000
         ST    @15,@AL00001+4                                      2341 11444000
         LA    @15,FPLADDR                                         2341 11445000
         ST    @15,@AL00001+8                                      2341 11446000
         L     @15,@PC00017                                        2341 11447000
         ST    @15,@AL00001+12                                     2341 11448000
         L     @15,@PC00017+4                                      2341 11449000
         ST    @15,@AL00001+16                                     2341 11450000
         L     @15,@PC00017+8                                      2341 11451000
         L     @01,FPTRFVT(,@15)                                   2341 11452000
         LA    @15,CTGFVEXP(,@01)                                  2341 11453000
         ST    @15,@AL00001+20                                     2341 11454000
         LA    @01,@AL00001                                        2341 11455000
         BAL   @14,BFPLPROC                                        2341 11456000
*        /************************************************************/ 11457000
*        /*                                                  @Y30SSFR*/ 11458000
*        /*  CONSTRUCT DSETCRDT FPL WHICH REFERENCES THE     @Y30SSFR*/ 11459000
*        /*  CREATION DATE CATALOG FIELD, PLACE              @Y30SSFR*/ 11460000
*        /*                                                  @Y30SSFR*/ 11461000
*        /************************************************************/ 11462000
*                                                                  2342 11463000
*        CALL BFPLPROC(ADDR(FIELDLST),IDSETCRD,            /*@Y30SSFR*/ 11464000
*           FPLADDR,FDICT,FWKA,CTGFVCRE);                  /*@Y30SSFR*/ 11465000
*                                                                  2342 11466000
         LA    @15,FIELDLST                                        2342 11467000
         ST    @15,@AFTEMPS+28                                     2342 11468000
         LA    @15,@AFTEMPS+28                                     2342 11469000
         ST    @15,@AL00001                                        2342 11470000
         LA    @15,@CH00288                                        2342 11471000
         ST    @15,@AL00001+4                                      2342 11472000
         LA    @15,FPLADDR                                         2342 11473000
         ST    @15,@AL00001+8                                      2342 11474000
         L     @15,@PC00017                                        2342 11475000
         ST    @15,@AL00001+12                                     2342 11476000
         L     @15,@PC00017+4                                      2342 11477000
         ST    @15,@AL00001+16                                     2342 11478000
         L     @15,@PC00017+8                                      2342 11479000
         L     @01,FPTRFVT(,@15)                                   2342 11480000
         LA    @15,CTGFVCRE(,@01)                                  2342 11481000
         ST    @15,@AL00001+20                                     2342 11482000
         LA    @01,@AL00001                                        2342 11483000
         BAL   @14,BFPLPROC                                        2342 11484000
*        /************************************************************/ 11485000
*        /*                                                  @Y30SSFR*/ 11486000
*        /*  IF THE TYPE IS PATH, OMIT BUILDING THE REST OF  @Y30SSFR*/ 11487000
*        /*  THE FPL'S.                                      @Y30SSFR*/ 11488000
*        /*                                                  @Y30SSFR*/ 11489000
*        /************************************************************/ 11490000
*                                                                  2343 11491000
*        IF CTGFVTYP ^= CTGTPTH                                    2343 11492000
*          THEN                                                    2343 11493000
         L     @15,@PC00017+8                                      2343 11494000
         L     @01,FPTRFVT(,@15)                                   2343 11495000
         CLI   CTGFVTYP(@01),C'R'                                  2343 11496000
         BE    @RF02343                                            2343 11497000
*NOPTH:      DO;                                           /*@Y30SSFR*/ 11498000
*                                                                  2344 11499000
NOPTH    DS    0H                                                  2345 11500000
*        /************************************************************/ 11501000
*        /*                                                          */ 11502000
*        /*  CONSTRUCT SPACPARM FPL WHICH REFERENCES THE SPACE       */ 11503000
*        /*  ALLOCATION CATALOG FIELD, PLACE FVT POINTER IN FPL      */ 11504000
*        /*                                                          */ 11505000
*        /************************************************************/ 11506000
*                                                                  2345 11507000
*            CALL BFPLPROC(ADDR(FIELDLST),ISPACPAR,        /*@Y30SSFR*/ 11508000
*                FPLADDR,FDICT,FWKA,CTGFVSPC);             /*@Y30SSFR*/ 11509000
*                                                                  2345 11510000
         LA    @15,FIELDLST                                        2345 11511000
         ST    @15,@AFTEMPS+28                                     2345 11512000
         LA    @15,@AFTEMPS+28                                     2345 11513000
         ST    @15,@AL00001                                        2345 11514000
         LA    @15,@CH00038                                        2345 11515000
         ST    @15,@AL00001+4                                      2345 11516000
         LA    @15,FPLADDR                                         2345 11517000
         ST    @15,@AL00001+8                                      2345 11518000
         L     @15,@PC00017                                        2345 11519000
         ST    @15,@AL00001+12                                     2345 11520000
         L     @15,@PC00017+4                                      2345 11521000
         ST    @15,@AL00001+16                                     2345 11522000
         L     @15,@PC00017+8                                      2345 11523000
         L     @01,FPTRFVT(,@15)                                   2345 11524000
         LA    @15,CTGFVSPC(,@01)                                  2345 11525000
         ST    @15,@AL00001+20                                     2345 11526000
         LA    @01,@AL00001                                        2345 11527000
         BAL   @14,BFPLPROC                                        2345 11528000
*            /********************************************************/ 11529000
*            /*                                              @Y30SSFR*/ 11530000
*            /*  CONSTRUCT AMDSB FPL, PLACE POINTER IN FVT   @Y30SSFR*/ 11531000
*            /*                                              @Y30SSFR*/ 11532000
*            /********************************************************/ 11533000
*                                                                  2346 11534000
*            CALL BFPLPROC(ADDR(FIELDLST),IAMDSB,          /*@Y30SSFR*/ 11535000
*                FPLADDR,FDICT,FWKA,CTGFVAMD);             /*@Y30SSFR*/ 11536000
         LA    @15,FIELDLST                                        2346 11537000
         ST    @15,@AFTEMPS+28                                     2346 11538000
         LA    @15,@AFTEMPS+28                                     2346 11539000
         ST    @15,@AL00001                                        2346 11540000
         LA    @15,@CH00625                                        2346 11541000
         ST    @15,@AL00001+4                                      2346 11542000
         LA    @15,FPLADDR                                         2346 11543000
         ST    @15,@AL00001+8                                      2346 11544000
         L     @15,@PC00017                                        2346 11545000
         ST    @15,@AL00001+12                                     2346 11546000
         L     @15,@PC00017+4                                      2346 11547000
         ST    @15,@AL00001+16                                     2346 11548000
         L     @15,@PC00017+8                                      2346 11549000
         L     @01,FPTRFVT(,@15)                                   2346 11550000
         LA    @15,CTGFVAMD(,@01)                                  2346 11551000
         ST    @15,@AL00001+20                                     2346 11552000
         LA    @01,@AL00001                                        2346 11553000
         BAL   @14,BFPLPROC                                        2346 11554000
*            RESPECIFY IDAAMDSB BASED(DSCCATPT);           /*@Y30SSFR*/ 11555000
*            IF CTGFVAMD ^= NULLPTR                        /*@Y30SSFR*/ 11556000
*              THEN                                        /*@Y30SSFR*/ 11557000
*                                                                  2348 11558000
         L     @15,@PC00017+8                                      2348 11559000
         L     @15,FPTRFVT(,@15)                                   2348 11560000
         L     @14,CTGFVAMD(,@15)                                  2348 11561000
         LTR   @14,@14                                             2348 11562000
         BZ    @RF02348                                            2348 11563000
*                /****************************************************/ 11564000
*                /*                                          @Y30SSFR*/ 11565000
*                /*  IF AMDSBCAT INFORMATION EXISTS FOR THIS @Y30SSFR*/ 11566000
*                /*  COMPONENT INITIALIZE THE AMDSBCAT       @Y30SSFR*/ 11567000
*                /*  INFORMATION FROM INFORMATION            @Y30SSFR*/ 11568000
*                /*  IN THE DICTIONARY AND WORK AREA.        @Y30SSFR*/ 11569000
*                /*                                          @Y30SSFR*/ 11570000
*                /****************************************************/ 11571000
*                                                                  2349 11572000
*                DO;                                       /*@Y30SSFR*/ 11573000
*                DSCCATPT = CTGFVAMD -> CTGFLPT(1);        /*@Y30SSFR*/ 11574000
         L     DSCCATPT,CTGFLPT(,@14)                              2350 11575000
*                AMDLEN = LENGTH(IDAAMDSB);                /*@Y30SSFR*/ 11576000
         MVC   AMDLEN(2,DSCCATPT),@CH01655                         2351 11577000
*                AMDATTR = (FWKA + DICTDL(IAMDSB)) -> AMDATTR;     2352 11578000
         L     @03,@PC00017+4                                      2352 11579000
         L     @03,FWKA(,@03)                                      2352 11580000
         L     @01,DICTPTR                                         2352 11581000
         AL    @03,DICTDL+136(,@01)                                2352 11582000
         MVC   AMDATTR(1,DSCCATPT),AMDATTR(@03)                    2352 11583000
*                AMDRKP = (FWKA + DICTDL(IAMDSB)) -> AMDRKP;       2353 11584000
         LH    @14,AMDRKP(,@03)                                    2353 11585000
         STH   @14,AMDRKP(,DSCCATPT)                               2353 11586000
*                AMDKEYLN = (FWKA + DICTDL(IAMDSB)) -> AMDKEYLN;   2354 11587000
         LH    @14,AMDKEYLN(,@03)                                  2354 11588000
         STH   @14,AMDKEYLN(,DSCCATPT)                             2354 11589000
*                AMDCINV = (FWKA + DICTDL(IAMDSB))-> AMDCINV;      2355 11590000
         L     @14,AMDCINV(,@03)                                   2355 11591000
         ST    @14,AMDCINV(,DSCCATPT)                              2355 11592000
*                AMDLRECL = (FWKA + DICTDL(IAMDSB)) -> AMDLRECL;   2356 11593000
         L     @14,AMDLRECL(,@03)                                  2356 11594000
         ST    @14,AMDLRECL(,DSCCATPT)                             2356 11595000
*                AMDPCTCA = (FWKA + DICTDL(IAMDSB)) -> AMDPCTCA;   2357 11596000
         IC    @14,AMDPCTCA(,@03)                                  2357 11597000
         STC   @14,AMDPCTCA(,DSCCATPT)                             2357 11598000
*                AMDPCTCI = (FWKA + DICTDL(IAMDSB)) -> AMDPCTCI;   2358 11599000
         IC    @14,AMDPCTCI(,@03)                                  2358 11600000
         STC   @14,AMDPCTCI(,DSCCATPT)                             2358 11601000
*                AMDATTR3 = (FWKA + DICTDL(IAMDSB))->      /*@Y30SSFR*/ 11602000
*                   AMDATTR3;                              /*@Y30SSFR*/ 11603000
*                                                                  2359 11604000
         MVC   AMDATTR3(1,DSCCATPT),AMDATTR3(@03)                  2359 11605000
*                IF CTGFVTYP = CTGTDATA                            2360 11606000
*                  THEN                                            2360 11607000
         CLI   CTGFVTYP(@15),C'D'                                  2360 11608000
         BNE   @RF02360                                            2360 11609000
*                    AMDAXRKP = (FWKA + DICTDL(IAMDSB))->  /*@Y30SSFR*/ 11610000
*                       AMDAXRKP;                          /*@Y30SSFR*/ 11611000
         LH    @03,AMDAXRKP(,@03)                                  2361 11612000
         STH   @03,AMDAXRKP(,DSCCATPT)                             2361 11613000
*                END;                                      /*@Y30SSFR*/ 11614000
*                                                                  2362 11615000
@RF02360 DS    0H                                                  2363 11616000
*            /********************************************************/ 11617000
*            /*                                              @Y30SSFR*/ 11618000
*            /*  CONSTRUCT DSATTR FPL WHICH REFERENCES DATA  @Y30SSFR*/ 11619000
*            /*  SET ATTRIBUTES CATALOG FIELD, PLACE POINTER @Y30SSFR*/ 11620000
*            /*  IN FVT                                      @Y30SSFR*/ 11621000
*            /*                                              @Y30SSFR*/ 11622000
*            /********************************************************/ 11623000
*                                                                  2363 11624000
*            IF CTGFVTYP = CTGTINDX | CTGFVTYP = CTGTDATA          2363 11625000
*              THEN                                                2363 11626000
@RF02348 L     @15,@PC00017+8                                      2363 11627000
         L     @15,FPTRFVT(,@15)                                   2363 11628000
         CLI   CTGFVTYP(@15),C'I'                                  2363 11629000
         BE    @RT02363                                            2363 11630000
         CLI   CTGFVTYP(@15),C'D'                                  2363 11631000
         BNE   @RF02363                                            2363 11632000
@RT02363 DS    0H                                                  2364 11633000
*                CALL BFPLPROC(ADDR(FIELDLST),IDSATTR,     /*@Y30SSFR*/ 11634000
*                   FPLADDR,FDICT,FWKA,CTGFVATR);          /*@Y30SSFR*/ 11635000
*                                                                  2364 11636000
         LA    @15,FIELDLST                                        2364 11637000
         ST    @15,@AFTEMPS+28                                     2364 11638000
         LA    @15,@AFTEMPS+28                                     2364 11639000
         ST    @15,@AL00001                                        2364 11640000
         LA    @15,@CH00165                                        2364 11641000
         ST    @15,@AL00001+4                                      2364 11642000
         LA    @15,FPLADDR                                         2364 11643000
         ST    @15,@AL00001+8                                      2364 11644000
         L     @15,@PC00017                                        2364 11645000
         ST    @15,@AL00001+12                                     2364 11646000
         L     @15,@PC00017+4                                      2364 11647000
         ST    @15,@AL00001+16                                     2364 11648000
         L     @15,@PC00017+8                                      2364 11649000
         L     @01,FPTRFVT(,@15)                                   2364 11650000
         LA    @15,CTGFVATR(,@01)                                  2364 11651000
         ST    @15,@AL00001+20                                     2364 11652000
         LA    @01,@AL00001                                        2364 11653000
         BAL   @14,BFPLPROC                                        2364 11654000
*            /********************************************************/ 11655000
*            /*                                              @Y30SSFR*/ 11656000
*            /*  CONSTRUCT EXCEPTION EXIT FPL, PLACE POINTER @Y30SSFR*/ 11657000
*            /*  IN THE FVT.                                 @Y30SSFR*/ 11658000
*            /*                                              @Y30SSFR*/ 11659000
*            /********************************************************/ 11660000
*                                                                  2365 11661000
*            CALL BFPLPROC(ADDR(FIELDLST),IEXCPXIT,        /*@Y30SSFR*/ 11662000
*               FPLADDR,FDICT,FWKA,CTGFVEXT);              /*@Y30SSFR*/ 11663000
*                                                                  2365 11664000
@RF02363 LA    @15,FIELDLST                                        2365 11665000
         ST    @15,@AFTEMPS+28                                     2365 11666000
         LA    @15,@AFTEMPS+28                                     2365 11667000
         ST    @15,@AL00001                                        2365 11668000
         LA    @15,@CH01096                                        2365 11669000
         ST    @15,@AL00001+4                                      2365 11670000
         LA    @15,FPLADDR                                         2365 11671000
         ST    @15,@AL00001+8                                      2365 11672000
         L     @15,@PC00017                                        2365 11673000
         ST    @15,@AL00001+12                                     2365 11674000
         L     @15,@PC00017+4                                      2365 11675000
         ST    @15,@AL00001+16                                     2365 11676000
         L     @15,@PC00017+8                                      2365 11677000
         L     @01,FPTRFVT(,@15)                                   2365 11678000
         LA    @15,CTGFVEXT(,@01)                                  2365 11679000
         ST    @15,@AL00001+20                                     2365 11680000
         LA    @01,@AL00001                                        2365 11681000
         BAL   @14,BFPLPROC                                        2365 11682000
*            /********************************************************/ 11683000
*            /*                                              @Y30SSFR*/ 11684000
*            /*  CONSTRUCT BUFSIZE FPL, PLACE POINTER IN FVT @Y30SSFR*/ 11685000
*            /*                                              @Y30SSFR*/ 11686000
*            /********************************************************/ 11687000
*                                                                  2366 11688000
*            IF CTGFVTYP ^= CTGFVIDX                       /*@Y30SSFR*/ 11689000
*              THEN                                        /*@Y30SSFR*/ 11690000
         L     @15,@PC00017+8                                      2366 11691000
         L     @15,FPTRFVT(,@15)                                   2366 11692000
         CLI   CTGFVTYP(@15),C'I'                                  2366 11693000
         BE    @RF02366                                            2366 11694000
*                CALL BFPLPROC(ADDR(FIELDLST),IBUFSIZE,    /*@Y30SSFR*/ 11695000
*                   FPLADDR,FDICT,FWKA,CTGFVBUF);          /*@Y30SSFR*/ 11696000
*                                                                  2367 11697000
         LA    @14,FIELDLST                                        2367 11698000
         ST    @14,@AFTEMPS+28                                     2367 11699000
         LA    @14,@AFTEMPS+28                                     2367 11700000
         ST    @14,@AL00001                                        2367 11701000
         LA    @14,@CH00040                                        2367 11702000
         ST    @14,@AL00001+4                                      2367 11703000
         LA    @14,FPLADDR                                         2367 11704000
         ST    @14,@AL00001+8                                      2367 11705000
         L     @14,@PC00017                                        2367 11706000
         ST    @14,@AL00001+12                                     2367 11707000
         L     @14,@PC00017+4                                      2367 11708000
         ST    @14,@AL00001+16                                     2367 11709000
         LA    @15,CTGFVBUF(,@15)                                  2367 11710000
         ST    @15,@AL00001+20                                     2367 11711000
         LA    @01,@AL00001                                        2367 11712000
         BAL   @14,BFPLPROC                                        2367 11713000
*            /********************************************************/ 11714000
*            /*                                              @Y30SSFR*/ 11715000
*            /*  CONSTRUCT LRECL FPL AND PLACE POINTER IN FVT@Y30SSFR*/ 11716000
*            /*                                              @Y30SSFR*/ 11717000
*            /********************************************************/ 11718000
*                                                                  2368 11719000
*            IF CTGFVTYP ^= CTGFVIDX                       /*@Y30SSFR*/ 11720000
*              THEN                                        /*@Y30SSFR*/ 11721000
@RF02366 L     @15,@PC00017+8                                      2368 11722000
         L     @15,FPTRFVT(,@15)                                   2368 11723000
         CLI   CTGFVTYP(@15),C'I'                                  2368 11724000
         BE    @RF02368                                            2368 11725000
*                CALL BFPLPROC(ADDR(FIELDLST),ILRECL,      /*@Y30SSFR*/ 11726000
*                   FPLADDR,FDICT,FWKA,CTGFVLRS);          /*@Y30SSFR*/ 11727000
*                                                                  2369 11728000
         LA    @14,FIELDLST                                        2369 11729000
         ST    @14,@AFTEMPS+28                                     2369 11730000
         LA    @14,@AFTEMPS+28                                     2369 11731000
         ST    @14,@AL00001                                        2369 11732000
         LA    @14,@CH00039                                        2369 11733000
         ST    @14,@AL00001+4                                      2369 11734000
         LA    @14,FPLADDR                                         2369 11735000
         ST    @14,@AL00001+8                                      2369 11736000
         L     @14,@PC00017                                        2369 11737000
         ST    @14,@AL00001+12                                     2369 11738000
         L     @14,@PC00017+4                                      2369 11739000
         ST    @14,@AL00001+16                                     2369 11740000
         LA    @15,CTGFVLRS(,@15)                                  2369 11741000
         ST    @15,@AL00001+20                                     2369 11742000
         LA    @01,@AL00001                                        2369 11743000
         BAL   @14,BFPLPROC                                        2369 11744000
*            /********************************************************/ 11745000
*            /*                                              @Y30SSFR*/ 11746000
*            /*  CONSTRUCT KEY RANGES LIST IF HIKEYV, LOKEYV @Y30SSFR*/ 11747000
*            /*  FIELDS WERE LOCATED AT EXPORT TIME          @Y30SSFR*/ 11748000
*            /*  IF RANGPROC DOES NOT CONSTRUCT THE LIST     @Y30SSFR*/ 11749000
*            /*  SUCCESSFULLY, INDICATE AN ERROR AND RETURN  @Y30SSFR*/ 11750000
*            /*  TO CALLING PROCESSOR.                       @Y30SSFR*/ 11751000
*            /*                                              @Y30SSFR*/ 11752000
*            /********************************************************/ 11753000
*                                                                  2370 11754000
*            CALL RANGPROC(0,FDICT,FWKA,CTGFVRNG);         /*@Y30SSFR*/ 11755000
@RF02368 LA    @15,@CF00118                                        2370 11756000
         ST    @15,@AL00001                                        2370 11757000
         L     @15,@PC00017                                        2370 11758000
         ST    @15,@AL00001+4                                      2370 11759000
         L     @15,@PC00017+4                                      2370 11760000
         ST    @15,@AL00001+8                                      2370 11761000
         L     @15,@PC00017+8                                      2370 11762000
         L     @01,FPTRFVT(,@15)                                   2370 11763000
         LA    @15,CTGFVRNG(,@01)                                  2370 11764000
         ST    @15,@AL00001+12                                     2370 11765000
         LA    @01,@AL00001                                        2370 11766000
         BAL   @14,RANGPROC                                        2370 11767000
*            RESPECIFY RTNREG RSTD;                                2371 11768000
*            TESTRC = RTNREG;                                      2372 11769000
         LR    TESTRC,RTNREG                                       2372 11770000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 11771000
*            IF TESTRC ^= 0                                        2374 11772000
*              THEN                                                2374 11773000
         LTR   TESTRC,TESTRC                                       2374 11774000
         BZ    @RF02374                                            2374 11775000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 11776000
*                                                                  2375 11777000
         LA    @15,12                                              2375 11778000
         L     @14,@SA00017                                        2375 11779000
         LM    @00,@12,@SA00017+8                                  2375 11780000
         BR    @14                                                 2375 11781000
*            /********************************************************/ 11782000
*            /*                                                      */ 11783000
*            /*  CONSTRUCT LIST OF VOLUME SERIALS IF THE VOLUME      */ 11784000
*            /*  SERIAL NUMBER WERE EXPORTED.                        */ 11785000
*            /*  NOTE THAT IN RELEASE 1 THE VOLUME LIST WAS NOT      */ 11786000
*            /*  EXPORTED IF PERMANENT WAS  SPECIFIED.               */ 11787000
*            /*                                                      */ 11788000
*            /********************************************************/ 11789000
*                                                                  2376 11790000
*            CALL LVLRPROC(0,FDICT,FWKA,FPTRFVT);          /*@OZ32365*/ 11791000
*                                                                  2376 11792000
@RF02374 LA    @15,@CF00118                                        2376 11793000
         ST    @15,@AL00001                                        2376 11794000
         L     @15,@PC00017                                        2376 11795000
         ST    @15,@AL00001+4                                      2376 11796000
         L     @15,@PC00017+4                                      2376 11797000
         ST    @15,@AL00001+8                                      2376 11798000
         L     @15,@PC00017+8                                      2376 11799000
         ST    @15,@AL00001+12                                     2376 11800000
         LA    @01,@AL00001                                        2376 11801000
         BAL   @14,LVLRPROC                                        2376 11802000
*            RESPECIFY RTNREG RSTD;                                2377 11803000
*            TESTRC = RTNREG;                                      2378 11804000
         LR    TESTRC,RTNREG                                       2378 11805000
*            RESPECIFY RTNREG UNRSTD;                              2379 11806000
*                                                                  2379 11807000
*            /********************************************************/ 11808000
*            /*                                                      */ 11809000
*            /*  IF UNSUCCESSFUL, RETURN TO CALLER                   */ 11810000
*            /*                                                      */ 11811000
*            /********************************************************/ 11812000
*                                                                  2380 11813000
*            IF TESTRC ^= 0                                        2380 11814000
*              THEN                                                2380 11815000
         LTR   TESTRC,TESTRC                                       2380 11816000
         BZ    @RF02380                                            2380 11817000
*                RETURN CODE(LASTCC12);                /*@Y30SSFR*/     11818000
*                                                                  2381 11819000
*                                                                  2381 11820000
         LA    @15,12                                              2381 11821000
         L     @14,@SA00017                                        2381 11822000
         LM    @00,@12,@SA00017+8                                  2381 11823000
         BR    @14                                                 2381 11824000
*            END NOPTH;                                    /*@Y30SSFR*/ 11825000
*                                                                  2382 11826000
@RF02380 DS    0H                                                  2383 11827000
*        /************************************************************/ 11828000
*        /*                                                          */ 11829000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 11830000
*        /*                                                          */ 11831000
*        /************************************************************/ 11832000
*                                                                  2383 11833000
*        RETURN CODE(0);                                           2383 11834000
@RF02343 SLR   @15,@15                                             2383 11835000
         L     @14,@SA00017                                        2383 11836000
         LM    @00,@12,@SA00017+8                                  2383 11837000
         BR    @14                                                 2383 11838000
*END FVTPROC;                                                      2384 11839000
*        /************************************************************/ 11840000
*        /*                                                          */ 11841000
*        /*  PROCEDURE NAME - BPASPROC                               */ 11842000
*        /*                                                          */ 11843000
*        /*  FUNCTION - CONSTRUCT PASSWALL FPL, MOVE FIELD           */ 11844000
*        /*  INFORMATION FROM PASSWORD, PASSPRMT, PASSATM, USERAREA  */ 11845000
*        /*  AND USVRMDUL FIELDS INTO PASSWALL COMBINATION FIELD     */ 11846000
*        /*                                                          */ 11847000
*        /*  INPUT -                                                 */ 11848000
*        /*    .BFPL - FPL POINTER                                   */ 11849000
*        /*    .BDICT - POINTER TO DICTIONARY REFERENCING CATALOG    */ 11850000
*        /*      FIELD INFORMATION WITHIN THE WORK AREA              */ 11851000
*        /*    .BWKA - WORK AREA CONTAINING CATALOG FIELD INFORMATION*/ 11852000
*        /*                                                          */ 11853000
*        /*  OUTPUT - PASSWALL FPL, AND PASSWALL COMBINATION FIELD   */ 11854000
*        /*                                                          */ 11855000
*        /************************************************************/ 11856000
*                                                                  2385 11857000
*BPASPROC: PROCEDURE(BFPL,             /*POINTER TO FPL              */ 11858000
*                    BDICT,            /*DICTIONARY POINTER          */ 11859000
*                    BWKA);            /*WORK AREA POINTER           */ 11860000
*                                                                  2385 11861000
BPASPROC STM   @14,@12,@SA00018                                    2385 11862000
         MVC   @PC00018(12),0(@01)                                 2385 11863000
*        /************************************************************/ 11864000
*        /*                                                          */ 11865000
*        /*  ARGUMENTS OF INVOCATION                                 */ 11866000
*        /*                                                          */ 11867000
*        /************************************************************/ 11868000
*                                                                  2386 11869000
*        DCL BFPL   PTR(31),                                       2386 11870000
*            BDICT  PTR(31),                                       2386 11871000
*            BWKA   PTR(31);                                       2386 11872000
*                                                                  2386 11873000
*        /************************************************************/ 11874000
*        /*                                                          */ 11875000
*        /*  LOCAL DECLARATIONS                                      */ 11876000
*        /*                                                          */ 11877000
*        /************************************************************/ 11878000
*                                                                  2387 11879000
*        DCL DICENPTR PTR(31);                                     2387 11880000
*        DCL FIELDPS  CHAR(*) BASED(DICENPTR);                     2388 11881000
*        DCL NOFIND   CONSTANT(4);                                 2389 11882000
*                                                                  2389 11883000
*        /************************************************************/ 11884000
*        /*                                                          */ 11885000
*        /*  CHECK TO BE SURE PASSWORD INFORMATION WAS SPECIFIED.    */ 11886000
*        /*  IF IT WAS FILL IN FPL FIELDS FOR PASSSWALL FIELD        */ 11887000
*        /*                                                          */ 11888000
*        /************************************************************/ 11889000
*                                                                  2390 11890000
*        OLDERID2 = NEWERID2;                                      2390 11891000
         L     @15,@PC00001                                        2390 11892000
         L     @14,GDTTR2(,@15)                                    2390 11893000
         MVC   @TS00001(95),NEWERID2(@14)                          2390 11894000
         MVC   OLDERID2(95,@14),@TS00001                           2390 11895000
*        NEWID2 = 'MPPS';                                          2391 11896000
         MVC   NEWID2(4,@14),@CC01600                              2391 11897000
*        DICTPTR = BDICT;                                          2392 11898000
         L     @14,@PC00018+4                                      2392 11899000
         L     @14,BDICT(,@14)                                     2392 11900000
         ST    @14,DICTPTR                                         2392 11901000
*        IF DICTLN(IPASSWOR) ^= 0                                  2393 11902000
*          THEN                                                    2393 11903000
         L     @05,DICTLN+72(,@14)                                 2393 11904000
         LTR   @05,@05                                             2393 11905000
         BZ    @RF02393                                            2393 11906000
*            DO;                                                   2394 11907000
*            CTGFLPTR = BFPL;                                      2395 11908000
         L     @03,@PC00018                                        2395 11909000
         L     CTGFLPTR,BFPL(,@03)                                 2395 11910000
*            CTGFLDNO = '00000001'B;                               2396 11911000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2396 11912000
*            CTGFLDNM = ADDR(FPASNAME);                            2397 11913000
         LA    @05,FPASNAME                                        2397 11914000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2397 11915000
*            CTGFLNG(1) = LENGTH(FPASSWAL) + DICTLN(IUSRAREC);     2398 11916000
*                                                                  2398 11917000
         LA    @05,52                                              2398 11918000
         AL    @05,DICTLN+104(,@14)                                2398 11919000
         ST    @05,CTGFLNG(,CTGFLPTR)                              2398 11920000
*            /********************************************************/ 11921000
*            /*                                                      */ 11922000
*            /*  GET CORE TO CONTAIN FIELD INFORMATION               */ 11923000
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR*/ 11924000
*            /*                                                      */ 11925000
*            /********************************************************/ 11926000
*                                                                  2399 11927000
*            CALL IDCSAGP0(GDTTBL,CTGFLNG(1),CTGFLPT(1),GPID,SETZERO);  11928000
*                                                                  2399 11929000
         ST    @15,@AL00001                                        2399 11930000
         LA    @05,CTGFLNG(,CTGFLPTR)                              2399 11931000
         ST    @05,@AL00001+4                                      2399 11932000
         LA    @05,CTGFLPT(,CTGFLPTR)                              2399 11933000
         ST    @05,@AL00001+8                                      2399 11934000
         LA    @05,GPID                                            2399 11935000
         ST    @05,@AL00001+12                                     2399 11936000
         LA    @05,SETZERO                                         2399 11937000
         ST    @05,@AL00001+16                                     2399 11938000
         MVI   @AL00001+16,X'80'                                   2399 11939000
         L     @15,GDTGPL(,@15)                                    2399 11940000
         LA    @01,@AL00001                                        2399 11941000
         BALR  @14,@15                                             2399 11942000
*            RESPECIFY RTNREG RSTD;                                2400 11943000
*            TESTRC = RTNREG;                                      2401 11944000
         LR    TESTRC,RTNREG                                       2401 11945000
*            RESPECIFY RTNREG UNRSTD;                              2402 11946000
*            IF TESTRC ^= 0                                        2403 11947000
*              THEN                                                2403 11948000
         LTR   TESTRC,TESTRC                                       2403 11949000
         BZ    @RF02403                                            2403 11950000
*                DO;                                               2404 11951000
*                DEFSTID = NOSTORAG;                               2405 11952000
         MVI   DEFSTID,X'04'                                       2405 11953000
*                DARGSMOD = UNIVMSG;                               2406 11954000
         L     @01,DDSTRU                                          2406 11955000
         MVC   DARGSMOD(3,@01),@CC01023                            2406 11956000
*                RETURN CODE(LASTCC12);                            2407 11957000
         LA    @15,12                                              2407 11958000
         L     @14,@SA00018                                        2407 11959000
         LM    @00,@12,@SA00018+8                                  2407 11960000
         BR    @14                                                 2407 11961000
*                END;                                              2408 11962000
*                                                                  2408 11963000
*            /********************************************************/ 11964000
*            /*                                                      */ 11965000
*            /*  INITIALIZE PASSWORD PORTION OF PASSWALL COMBINATION */ 11966000
*            /*  FIELD TO FF'S                                       */ 11967000
*            /*                                                      */ 11968000
*            /********************************************************/ 11969000
*                                                                  2409 11970000
*            DO J = 1 TO LENGTH(FPASSWAL);                         2409 11971000
@RF02403 LA    J,1                                                 2409 11972000
@DL02409 DS    0H                                                  2410 11973000
*              FPASSWAL(J) = 'FF'X;                                2410 11974000
         L     @05,CTGFLPT(,CTGFLPTR)                              2410 11975000
         ALR   @05,J                                               2410 11976000
         BCTR  @05,0                                               2410 11977000
         MVI   FPASSWAL(@05),X'FF'                                 2410 11978000
*            END;                                                  2411 11979000
*                                                                  2411 11980000
         AL    J,@CF00221                                          2411 11981000
         C     J,@CF01653                                          2411 11982000
         BNH   @DL02409                                            2411 11983000
*            FUSERLN = 0;                                          2412 11984000
*                                                                  2412 11985000
         SLR   @05,@05                                             2412 11986000
         L     @03,CTGFLPT(,CTGFLPTR)                              2412 11987000
         STH   @05,FUSERLN(,@03)                                   2412 11988000
*            DICENPTR = DICTDL(IPASSWOR) + BWKA;                   2413 11989000
*                                                                  2413 11990000
         L     @15,DICTPTR                                         2413 11991000
         L     @14,@PC00018+8                                      2413 11992000
         L     DICENPTR,DICTDL+72(,@15)                            2413 11993000
         AL    DICENPTR,BWKA(,@14)                                 2413 11994000
*            /********************************************************/ 11995000
*            /*                                                      */ 11996000
*            /*  CONSTRUCT PASSWALL COMBINATION CATALOG FIELD FROM   */ 11997000
*            /*  ALL SUPPLIED INFORMATION IN WORK AREA.  FIELDS WILL */ 11998000
*            /*  BE LEFT ZERO WHEN NO INFORMATION HAS BEEN SUPPLIED  */ 11999000
*            /*  FOR THAT ENTRY                                      */ 12000000
*            /*                                                      */ 12001000
*            /********************************************************/ 12002000
*                                                                  2414 12003000
*            IF DICTLN(IPASSWOR) ^= 0                              2414 12004000
*              THEN                                                2414 12005000
         L     @15,DICTLN+72(,@15)                                 2414 12006000
         CR    @15,@05                                             2414 12007000
         BE    @RF02414                                            2414 12008000
*                FPASWD(1:DICTLN(IPASSWOR)) =                      2415 12009000
*                  FIELDPS(1:DICTLN(IPASSWOR));                    2415 12010000
*                                                                  2415 12011000
         BCTR  @15,0                                               2415 12012000
         EX    @15,@SM01735                                        2415 12013000
*            DICENPTR = DICTDL(IPASSPRM) + BWKA;                   2416 12014000
@RF02414 L     @05,DICTPTR                                         2416 12015000
         L     @15,@PC00018+8                                      2416 12016000
         L     DICENPTR,DICTDL+80(,@05)                            2416 12017000
         AL    DICENPTR,BWKA(,@15)                                 2416 12018000
*            IF DICTLN(IPASSPRM) ^= 0                              2417 12019000
*              THEN                                                2417 12020000
         L     @05,DICTLN+80(,@05)                                 2417 12021000
         LTR   @05,@05                                             2417 12022000
         BZ    @RF02417                                            2417 12023000
*                FPASSPRM(1:DICTLN(IPASSPRM)) =                    2418 12024000
*                  FIELDPS(1:DICTLN(IPASSPRM));                    2418 12025000
*                                                                  2418 12026000
         L     @03,CTGFLPT(,CTGFLPTR)                              2418 12027000
         BCTR  @05,0                                               2418 12028000
         EX    @05,@SM01737                                        2418 12029000
*            DICENPTR = DICTDL(IPASSATM) + BWKA;                   2419 12030000
@RF02417 L     @05,DICTPTR                                         2419 12031000
         L     @15,DICTDL+88(,@05)                                 2419 12032000
         L     @14,@PC00018+8                                      2419 12033000
         LR    DICENPTR,@15                                        2419 12034000
         AL    DICENPTR,BWKA(,@14)                                 2419 12035000
*            IF DICTDL(IPASSATM) ^= 0                              2420 12036000
*              THEN                                                2420 12037000
         LTR   @15,@15                                             2420 12038000
         BZ    @RF02420                                            2420 12039000
*                FPASSATM(1:DICTLN(IPASSATM)) =                    2421 12040000
*                  FIELDPS(1:DICTLN(IPASSATM));                    2421 12041000
*                                                                  2421 12042000
         L     @03,CTGFLPT(,CTGFLPTR)                              2421 12043000
         L     @05,DICTLN+88(,@05)                                 2421 12044000
         BCTR  @05,0                                               2421 12045000
         EX    @05,@SM01739                                        2421 12046000
*            DICENPTR = DICTDL(IUSVRMDU) + BWKA;                   2422 12047000
@RF02420 L     @05,DICTPTR                                         2422 12048000
         L     @15,@PC00018+8                                      2422 12049000
         L     DICENPTR,DICTDL+96(,@05)                            2422 12050000
         AL    DICENPTR,BWKA(,@15)                                 2422 12051000
*            IF DICTLN(IUSVRMDU) ^= 0                              2423 12052000
*              THEN                                                2423 12053000
         L     @05,DICTLN+96(,@05)                                 2423 12054000
         LTR   @05,@05                                             2423 12055000
         BZ    @RF02423                                            2423 12056000
*                FUSVRMDU(1:DICTLN(IUSVRMDU)) =                    2424 12057000
*                  FIELDPS(1:DICTDL(IUSVRMDU));                    2424 12058000
*                                                                  2424 12059000
         L     @03,CTGFLPT(,CTGFLPTR)                              2424 12060000
         BCTR  @05,0                                               2424 12061000
         EX    @05,@SM01741                                        2424 12062000
*            DICENPTR = DICTDL(IUSRAREC) + BWKA;                   2425 12063000
@RF02423 L     @05,DICTPTR                                         2425 12064000
         L     @15,@PC00018+8                                      2425 12065000
         L     DICENPTR,DICTDL+104(,@05)                           2425 12066000
         AL    DICENPTR,BWKA(,@15)                                 2425 12067000
*            IF DICTLN(IUSRAREC) ^= 0                              2426 12068000
*              THEN                                                2426 12069000
         L     @05,DICTLN+104(,@05)                                2426 12070000
         LTR   @05,@05                                             2426 12071000
         BZ    @RF02426                                            2426 12072000
*                FUSERARE(1:DICTLN(IUSRAREC)) =                    2427 12073000
*                  FIELDPS(1:DICTLN(IUSRAREC));                    2427 12074000
         L     @03,CTGFLPT(,CTGFLPTR)                              2427 12075000
         BCTR  @05,0                                               2427 12076000
         EX    @05,@SM01743                                        2427 12077000
*            END;                                                  2428 12078000
*                                                                  2428 12079000
*          /**********************************************************/ 12080000
*          /*                                                        */ 12081000
*          /*  PASSWORD FIELD IS ZERO, THEREFORE DON'T BUILD FPL     */ 12082000
*          /*  OR FIELD                                              */ 12083000
*          /*                                                        */ 12084000
*          /**********************************************************/ 12085000
*                                                                  2429 12086000
*          ELSE                                                    2429 12087000
*            RETURN CODE(NOFIND);                                  2429 12088000
*                                                                  2429 12089000
*                                                                  2429 12090000
         B     @RC02393                                            2429 12091000
@RF02393 LA    @15,4                                               2429 12092000
         L     @14,@SA00018                                        2429 12093000
         LM    @00,@12,@SA00018+8                                  2429 12094000
         BR    @14                                                 2429 12095000
*        /************************************************************/ 12096000
*        /*                                                          */ 12097000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 12098000
*        /*                                                          */ 12099000
*        /************************************************************/ 12100000
*                                                                  2430 12101000
*        BFPL = BFPL + LENGTH(CTGFL) + 8;                          2430 12102000
*                                                                  2430 12103000
@RC02393 L     @15,@PC00018                                        2430 12104000
         LA    @14,24                                              2430 12105000
         AL    @14,BFPL(,@15)                                      2430 12106000
         ST    @14,BFPL(,@15)                                      2430 12107000
*        RETURN CODE(0);                                           2431 12108000
         SLR   @15,@15                                             2431 12109000
         L     @14,@SA00018                                        2431 12110000
         LM    @00,@12,@SA00018+8                                  2431 12111000
         BR    @14                                                 2431 12112000
*END BPASPROC;                                                     2432 12113000
*/********************************************************************/ 12114000
*/*                                                          @YL026UA*/ 12115000
*/* PROCEDURE NAME - DALCPROC (SERVICE ROUTINE)              @YL026UA*/ 12116000
*/*                                                          @YL026UA*/ 12117000
*/* FUNCTION - DALCPROC PERFORMS THE NECESSARY PROCESSING TO @YL026UA*/ 12118000
*/*            INVOKE THE AMS UALLOC ROUTINE WHICH PERFORMS  @YL026UA*/ 12119000
*/*            DYNAMIC ALLOCATION.                           @YL026UA*/ 12120000
*/********************************************************************/ 12121000
*                                                                  2433 12122000
*DALCPROC:                                                         2433 12123000
*        PROCEDURE (REQTYPE,DALVLPTR,DALDNMPT,DALINDEX);   /*@YL026UA*/ 12124000
*                                                                  2433 12125000
DALCPROC STM   @14,@12,@SA00019                                    2433 12126000
         MVC   @PC00019(16),0(@01)                                 2433 12127000
*        /************************************************************/ 12128000
*        /*                                                  @YL026UA*/ 12129000
*        /* ARGUMENTS OF INVOCATION                          @YL026UA*/ 12130000
*        /*                                                  @YL026UA*/ 12131000
*        /************************************************************/ 12132000
*        DCL                                                       2434 12133000
*          REQTYPE CHAR(1),            /* TYPE OF REQUEST    @YL026UA*/ 12134000
*          DALVLPTR,                   /* ADDR OF VOLUMES    @Y30SSFR*/ 12135000
*          DALDNMPT,                   /* ADDR OF DNAME      @YL026UA*/ 12136000
*          DALINDEX;                   /* INDEX OF ALLAGLS   @YL026UA*/ 12137000
*                                                                  2434 12138000
*        /************************************************************/ 12139000
*        /*                                                  @YL026UA*/ 12140000
*        /* UNIT DESCRIPTOR LIST REFERENCED BY ALLAGL        @YL026UA*/ 12141000
*        /*                                                  @YL026UA*/ 12142000
*        /************************************************************/ 12143000
*        DCL                                                       2435 12144000
*          1 DALCUNIT STATIC LOCAL,                                2435 12145000
*            2 DL#UNIT   FIXED(15) INIT(1),                        2435 12146000
*            2 DLUNITLN  FIXED(15) INIT(8),                  /*YM6050*/ 12147000
*            2 DLUNIT    CHAR(8)   INIT('SYSALLDA');         /*YM6050*/ 12148000
*                                                                  2435 12149000
*        /************************************************************/ 12150000
*        /*                                                  @YL026UA*/ 12151000
*        /* SAVE AREAS FOR POINTERS TO ALLAGLS               @YL026UA*/ 12152000
*        /*                                                  @YL026UA*/ 12153000
*        /************************************************************/ 12154000
*        DCL                                                       2436 12155000
*          1 ALGLSAVE  CHAR(20) BDY(WORD),                         2436 12156000
*            2 ALSAVPTR(*) PTR(31);                        /*@YL026UA*/ 12157000
*                                                                  2436 12158000
*        /************************************************************/ 12159000
*        /*                                                  @YL026UA*/ 12160000
*        /* MAPPING STRUCTURE FOR VOLUME LIST TO BE DYNAMICALLY      */ 12161000
*        /* ALLOCATED, THIS LIST IS RECONSTRUCTED IN A FORM  @YL026UA*/ 12162000
*        /* COMPATIBLE TO DYNAMIC ALLOCATION IN A NEW AREA   @YL026UA*/ 12163000
*        /*                                                  @YL026UA*/ 12164000
*        /************************************************************/ 12165000
*                                                                  2437 12166000
*        DCL                                                       2437 12167000
*          1 FVTVLIST BASED(DALVLPTR),                             2437 12168000
*            2 FVTVLEN FIXED(15),                                  2437 12169000
*            2 * (*),                                              2437 12170000
*              3 *       FIXED(15),                                2437 12171000
*              3 FVTVSER CHAR(6);                          /*@YL026UA*/ 12172000
*                                                                  2437 12173000
*        /************************************************************/ 12174000
*        /*                                                  @YL026UA*/ 12175000
*        /* MAPPING STRUCTURE FOR VOLUME LIST CONSTRUCTED IN DALCPROC*/ 12176000
*        /* AND PASSED TO DYNAMIC ALLOCATION VIA THE ALLAGL PARAMETER*/ 12177000
*        /* LIST                                             @YL026UA*/ 12178000
*        /*                                                  @YL026UA*/ 12179000
*        /************************************************************/ 12180000
*                                                                  2438 12181000
*        DCL                                                       2438 12182000
*          1 ALCVLIST BASED(ALLVLP),                               2438 12183000
*            2 ALC#ENT FIXED(15),                                  2438 12184000
*            2 * (*),                                              2438 12185000
*              3 ALCVLEN FIXED(15),                                2438 12186000
*              3 ALCVSER CHAR(6);                          /*@YL026UA*/ 12187000
*                                                                  2438 12188000
*        /************************************************************/ 12189000
*        /*                                                  @YL026UA*/ 12190000
*        /* POINTER TO ALLAGL PARAMETERLIST                  @YL026UA*/ 12191000
*        /*                                                  @YL026UA*/ 12192000
*        /************************************************************/ 12193000
*        DCL                                                       2439 12194000
*          DALGLPTR  PTR(31);                              /*@YL026UA*/ 12195000
*                                                                  2439 12196000
*        /************************************************************/ 12197000
*        /*                                                  @YL026UA*/ 12198000
*        /* ENTRY POINT TO DALCPROC                          @YL026UA*/ 12199000
*        /*                                                  @YL026UA*/ 12200000
*        /************************************************************/ 12201000
*                                                                  2440 12202000
*        OLDERID2 = NEWERID2;                                      2440 12203000
         L     @15,@PC00001                                        2440 12204000
         L     @15,GDTTR2(,@15)                                    2440 12205000
         MVC   @TS00001(95),NEWERID2(@15)                          2440 12206000
         MVC   OLDERID2(95,@15),@TS00001                           2440 12207000
*        NEWID2 = 'MPDA';                                  /*@YL026UA*/ 12208000
*                                                                  2441 12209000
         MVC   NEWID2(4,@15),@CC01630                              2441 12210000
*        /************************************************************/ 12211000
*        /*                                                  @YL026UA*/ 12212000
*        /* CHECK REQUEST TYPE FOR ALLOCATION OR DEALLOCATION        */ 12213000
*        /*                                                  @YL026UA*/ 12214000
*        /************************************************************/ 12215000
*                                                                  2442 12216000
*        IF REQTYPE = 'A'                                          2442 12217000
*          THEN                                                    2442 12218000
         L     @15,@PC00019                                        2442 12219000
         CLI   REQTYPE(@15),C'A'                                   2442 12220000
         BNE   @RF02442                                            2442 12221000
*DALOOP0:    DO;                                           /*@YL026UA*/ 12222000
*                                                                  2443 12223000
DALOOP0  DS    0H                                                  2444 12224000
*            /********************************************************/ 12225000
*            /*                                              @YL026UA*/ 12226000
*            /* THIS IS AN ALLOCATION REQUEST - GET SPACE FOR THE    */ 12227000
*            /* VOLUME LIST TO BE BUILT AND PASSED TO THE AMS        */ 12228000
*            /* SYSTEM ADAPTER VIA THE ALLAGL PARAMETERLIST  @YL026UA*/ 12229000
*            /*                                              @YL026UA*/ 12230000
*            /********************************************************/ 12231000
*                                                                  2444 12232000
*            CALL IDCSAGP0 (GDTTBL,                                2444 12233000
*              ((FVTVLEN + 8) + (LENGTH(ALLAGL) +4 )),             2444 12234000
*              DALGLPTR,                                           2444 12235000
*              GPID,                                               2444 12236000
*              SETZERO);                                   /*@YL026UA*/ 12237000
*                                                                  2444 12238000
         L     @03,@PC00001                                        2444 12239000
         ST    @03,@AL00001                                        2444 12240000
         L     @15,@PC00019+4                                      2444 12241000
         L     @01,DALVLPTR(,@15)                                  2444 12242000
         LA    @00,43                                              2444 12243000
         AH    @00,FVTVLEN(,@01)                                   2444 12244000
         ST    @00,@AFTEMPS+32                                     2444 12245000
         LA    @15,@AFTEMPS+32                                     2444 12246000
         ST    @15,@AL00001+4                                      2444 12247000
         LA    @15,DALGLPTR                                        2444 12248000
         ST    @15,@AL00001+8                                      2444 12249000
         LA    @15,GPID                                            2444 12250000
         ST    @15,@AL00001+12                                     2444 12251000
         LA    @15,SETZERO                                         2444 12252000
         ST    @15,@AL00001+16                                     2444 12253000
         MVI   @AL00001+16,X'80'                                   2444 12254000
         L     @15,GDTGPL(,@03)                                    2444 12255000
         LA    @01,@AL00001                                        2444 12256000
         BALR  @14,@15                                             2444 12257000
*            RESPECIFY RTNREG RSTD;                                2445 12258000
*            TESTRC = RTNREG;                                      2446 12259000
         LR    TESTRC,RTNREG                                       2446 12260000
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UA*/ 12261000
*            IF TESTRC ^= 0                                        2448 12262000
*              THEN                                                2448 12263000
         LTR   TESTRC,TESTRC                                       2448 12264000
         BZ    @RF02448                                            2448 12265000
*                DO;                                       /*@YL026UA*/ 12266000
*                                                                  2449 12267000
*                DEFSTID = NOSTORAG;                       /*@YL026UA*/ 12268000
         MVI   DEFSTID,X'04'                                       2450 12269000
*                RETURN;                                   /*@YL026UA*/ 12270000
*                                                                  2451 12271000
@EL00019 DS    0H                                                  2451 12272000
@EF00019 DS    0H                                                  2451 12273000
@ER00019 LM    @14,@12,@SA00019                                    2451 12274000
         BR    @14                                                 2451 12275000
*                END;                                      /*@YL026UA*/ 12276000
*                                                                  2452 12277000
*            /********************************************************/ 12278000
*            /*                                              @YL026UA*/ 12279000
*            /* SET ADDRESSABILITY TO ALLAGL AND INITIALIZE ALLVLP   */ 12280000
*            /*                                              @YL026UA*/ 12281000
*            /********************************************************/ 12282000
*                                                                  2453 12283000
*            RFY ALLAGL BASED(DALGLPTR);                   /*@YL026UA*/ 12284000
@RF02448 DS    0H                                                  2454 12285000
*            ALLVLP = DALGLPTR + (LENGTH(ALLAGL) +4);      /*@YL026UA*/ 12286000
*                                                                  2454 12287000
         L     @15,DALGLPTR                                        2454 12288000
         LA    @14,35                                              2454 12289000
         ALR   @14,@15                                             2454 12290000
         ST    @14,ALLVLP(,@15)                                    2454 12291000
*            /********************************************************/ 12292000
*            /*                                              @YL026UA*/ 12293000
*            /* COMPUTE THE NUMBER OF ENTRIES IN THE UALLOC VOLUME   */ 12294000
*            /* LIST                                         @YL026UA*/ 12295000
*            /********************************************************/ 12296000
*                                                                  2455 12297000
*            ALC#ENT = FVTVLEN / 8;                        /*@YL026UA*/ 12298000
*                                                                  2455 12299000
         L     @15,@PC00019+4                                      2455 12300000
         L     @01,DALVLPTR(,@15)                                  2455 12301000
         LH    @00,FVTVLEN(,@01)                                   2455 12302000
         SRDA  @00,32                                              2455 12303000
         D     @00,@CF00039                                        2455 12304000
         STH   @01,ALC#ENT(,@14)                                   2455 12305000
*            /********************************************************/ 12306000
*            /*                                              @YL026UA*/ 12307000
*            /* CHECK FOR UNREASONABLE VALUE IN ALC#ENT TO PREVENT   */ 12308000
*            /* ALLOPING PROBLEM IN DALOOP1                  @YL026UA*/ 12309000
*            /*                                              @YL026UA*/ 12310000
*            /********************************************************/ 12311000
*            IF ALC#ENT  < 1  |                                    2456 12312000
*               ALC#ENT  > 255                                     2456 12313000
*              THEN                                                2456 12314000
         LTR   @01,@01                                             2456 12315000
         BNP   @RT02456                                            2456 12316000
         C     @01,@CF00634                                        2456 12317000
         BNH   @RF02456                                            2456 12318000
@RT02456 DS    0H                                                  2457 12319000
*                DO;                                       /*@YL026UA*/ 12320000
*                                                                  2457 12321000
*                DEFSTID = UALLCERR;                       /*@YL026UA*/ 12322000
         MVI   DEFSTID,X'10'                                       2458 12323000
*                RETURN;                                   /*@YL026UA*/ 12324000
*                                                                  2459 12325000
         B     @EL00019                                            2459 12326000
*                END;                                      /*@YL026UA*/ 12327000
*                                                                  2460 12328000
*            /********************************************************/ 12329000
*            /*                                              @YL026UA*/ 12330000
*            /* LOOP THRU THE LIST OF VOLUMES REFERENCED BY DALVLPTR */ 12331000
*            /* MOVING EACH VOLSER INTO THE LIST PASSED VIA THE      */ 12332000
*            /* ALLAGL AND COMPUTE THE LENGTH OF THE NON-BLANK       */ 12333000
*            /* PORTION OF THE VOLSER, THIS LENGTH PRECEEDES EACH    */ 12334000
*            /* VOLSER IN THE ALLAGL VOLUME LIST             @YL026UA*/ 12335000
*            /*                                              @YL026UA*/ 12336000
*            /********************************************************/ 12337000
*                                                                  2461 12338000
*DALOOP1:    DO N = 1 TO ALC#ENT;                          /*@YL026UA*/ 12339000
*                                                                  2461 12340000
@RF02456 DS    0H                                                  2461 12341000
DALOOP1  LA    N,1                                                 2461 12342000
         B     @DE02461                                            2461 12343000
@DL02461 DS    0H                                                  2462 12344000
*              DO J = 1 TO 6                                       2462 12345000
*                WHILE FVTVSER (N,J) ^= ' ';               /*@YL026UA*/ 12346000
         LA    J,1                                                 2462 12347000
@DL02462 LR    @15,N                                               2462 12348000
         SLA   @15,3                                               2462 12349000
         ALR   @15,J                                               2462 12350000
         L     @14,@PC00019+4                                      2462 12351000
         L     @01,DALVLPTR(,@14)                                  2462 12352000
         ALR   @01,@15                                             2462 12353000
         AL    @01,@CF01707                                        2462 12354000
         CLI   FVTVSER-4(@01),C' '                                 2462 12355000
         BE    @DC02462                                            2462 12356000
*              END;                                        /*@YL026UA*/ 12357000
*                                                                  2463 12358000
         AL    J,@CF00221                                          2463 12359000
         C     J,@CF00159                                          2463 12360000
         BNH   @DL02462                                            2463 12361000
@DC02462 DS    0H                                                  2464 12362000
*              /******************************************************/ 12363000
*              /*                                            @YL026UA*/ 12364000
*              /* ON EXIT FROM ABOVE LOOP J HAS THE LENGTH OF THE    */ 12365000
*              /* NONBLANK PORTION OF THE VOLSER + 1         @YL026UA*/ 12366000
*              /*                                            @YL026UA*/ 12367000
*              /******************************************************/ 12368000
*                                                                  2464 12369000
*              ALCVLEN(N) = (J - 1);                       /*@YL026UA*/ 12370000
         LR    @15,N                                               2464 12371000
         SLA   @15,3                                               2464 12372000
         L     @01,DALGLPTR                                        2464 12373000
         L     @14,ALLVLP(,@01)                                    2464 12374000
         LR    @05,J                                               2464 12375000
         BCTR  @05,0                                               2464 12376000
         LA    @04,0(@15,@14)                                      2464 12377000
         AL    @04,@CF01694                                        2464 12378000
         STH   @05,ALCVLEN-2(,@04)                                 2464 12379000
*              ALCVSER(N) = FVTVSER(N);                    /*@YL026UA*/ 12380000
*                                                                  2465 12381000
         ALR   @14,@15                                             2465 12382000
         AL    @14,@CF01689                                        2465 12383000
         L     @02,@PC00019+4                                      2465 12384000
         L     @02,DALVLPTR(,@02)                                  2465 12385000
         ALR   @02,@15                                             2465 12386000
         AL    @02,@CF01689                                        2465 12387000
         MVC   ALCVSER-4(6,@14),FVTVSER-4(@02)                     2465 12388000
*            END DALOOP1;                                  /*@YL026UA*/ 12389000
*                                                                  2466 12390000
         AL    N,@CF00221                                          2466 12391000
@DE02461 L     @02,DALGLPTR                                        2466 12392000
         L     @02,ALLVLP(,@02)                                    2466 12393000
         CH    N,ALC#ENT(,@02)                                     2466 12394000
         BNH   @DL02461                                            2466 12395000
*            /********************************************************/ 12396000
*            /*                                              @YL026UA*/ 12397000
*            /* INITIALIZE REMAINING ALLAGL FIELDS           @YL026UA*/ 12398000
*            /*                                              @YL026UA*/ 12399000
*            /********************************************************/ 12400000
*                                                                  2467 12401000
*            ALLULP = ADDR(DALCUNIT);                      /*@YL026UA*/ 12402000
         L     @03,DALGLPTR                                        2467 12403000
         LA    @15,DALCUNIT                                        2467 12404000
         ST    @15,ALLULP(,@03)                                    2467 12405000
*            ALLOPTVL = ON;                                /*@YL026UA*/ 12406000
*                                                                  2468 12407000
         OI    ALLOPTVL(@03),B'10000000'                           2468 12408000
*            /********************************************************/ 12409000
*            /*                                              @YL026UA*/ 12410000
*            /*  INVOKE DYNAMIC ALLOCATION VIA AMS UALLOC MACRO      */ 12411000
*            /*                                              @YL026UA*/ 12412000
*            /********************************************************/ 12413000
*                                                                  2469 12414000
*            CALL IDCSAAL0 (GDTTBL,ALLAGL);                /*@YL026UA*/ 12415000
*                                                                  2469 12416000
         L     @15,@PC00001                                        2469 12417000
         ST    @15,@AL00001                                        2469 12418000
         ST    @03,@AL00001+4                                      2469 12419000
         MVI   @AL00001+4,X'80'                                    2469 12420000
         L     @15,GDTALC(,@15)                                    2469 12421000
         LA    @01,@AL00001                                        2469 12422000
         BALR  @14,@15                                             2469 12423000
*            RESPECIFY RTNREG RSTD;                                2470 12424000
*            TESTRC = RTNREG;                                      2471 12425000
         LR    TESTRC,RTNREG                                       2471 12426000
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UA*/ 12427000
*            IF TESTRC = 4                                         2473 12428000
*              THEN                                                2473 12429000
         C     TESTRC,@CF00045                                     2473 12430000
         BNE   @RF02473                                            2473 12431000
*                DO;                                       /*@YL026UA*/ 12432000
*                                                                  2474 12433000
*                DEFSTID = UALLCERR;                       /*@YL026UA*/ 12434000
         MVI   DEFSTID,X'10'                                       2475 12435000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 12436000
*                                                                  2476 12437000
         LA    @15,12                                              2476 12438000
         L     @14,@SA00019                                        2476 12439000
         LM    @00,@12,@SA00019+8                                  2476 12440000
         BR    @14                                                 2476 12441000
*                END;                                      /*@YL026UA*/ 12442000
*            /********************************************************/ 12443000
*            /*                                              @YL026UA*/ 12444000
*            /* MAINTAIN A LIST OF POINTERS TO ALLAGLS - THERE IS A  */ 12445000
*            /* POSSIBILITY OF MULTIPLE ALLAGLS.             @Y30SSFR*/ 12446000
*            /*                                              @YL026UA*/ 12447000
*            /********************************************************/ 12448000
*                                                                  2478 12449000
*            DALINDEX = DALINDEX + 1;                      /*@YL026UA*/ 12450000
@RF02473 L     @15,@PC00019+12                                     2478 12451000
         LA    @14,1                                               2478 12452000
         AL    @14,DALINDEX(,@15)                                  2478 12453000
         ST    @14,DALINDEX(,@15)                                  2478 12454000
*            ALSAVPTR(DALINDEX) = DALGLPTR;                /*@YL026UA*/ 12455000
*                                                                  2479 12456000
         L     @15,DALGLPTR                                        2479 12457000
         SLA   @14,2                                               2479 12458000
         ST    @15,ALSAVPTR-4(@14)                                 2479 12459000
*            /********************************************************/ 12460000
*            /*                                              @YL026UA*/ 12461000
*            /* SET POINTER TO DDNAME BUILT BY UALLOC        @YL026UA*/ 12462000
*            /*                                              @YL026UA*/ 12463000
*            /********************************************************/ 12464000
*                                                                  2480 12465000
*            DALDNMPT = ADDR(ALLDDN);                      /*@YL026UA*/ 12466000
*                                                                  2480 12467000
         L     @14,@PC00019+8                                      2480 12468000
         LA    @15,ALLDDN(,@15)                                    2480 12469000
         ST    @15,DALDNMPT(,@14)                                  2480 12470000
*            END DALOOP0;                                  /*@YL026UA*/ 12471000
*                                                                  2481 12472000
*          /**********************************************************/ 12473000
*          /* THIS IS A DEALLOCATE REQUEST                   @YL026UA*/ 12474000
*          /**********************************************************/ 12475000
*          ELSE                                                    2482 12476000
*            DO;                                           /*@Y30SSFR*/ 12477000
         B     @RC02442                                            2482 12478000
@RF02442 DS    0H                                                  2483 12479000
*            DO N = 1 TO DALINDEX;                         /*#YL026UA*/ 12480000
*                                                                  2483 12481000
         LA    N,1                                                 2483 12482000
         B     @DE02483                                            2483 12483000
@DL02483 DS    0H                                                  2484 12484000
*              RFY ALLAGL BASED(ALSAVPTR(N));                /*YM5040*/ 12485000
*                                                                  2484 12486000
*              CALL IDCSADL0 (GDTTBL,ALLAGL);              /*#YL026UA*/ 12487000
*                                                                  2485 12488000
         L     @02,@PC00001                                        2485 12489000
         ST    @02,@AL00001                                        2485 12490000
         LR    @15,N                                               2485 12491000
         SLA   @15,2                                               2485 12492000
         L     @01,ALSAVPTR-4(@15)                                 2485 12493000
         ST    @01,@AL00001+4                                      2485 12494000
         MVI   @AL00001+4,X'80'                                    2485 12495000
         L     @15,GDTDLC(,@02)                                    2485 12496000
         LA    @01,@AL00001                                        2485 12497000
         BALR  @14,@15                                             2485 12498000
*            END;                                          /*#YL026UA*/ 12499000
*                                                                  2486 12500000
         AL    N,@CF00221                                          2486 12501000
@DE02483 L     @02,@PC00019+12                                     2486 12502000
         C     N,DALINDEX(,@02)                                    2486 12503000
         BNH   @DL02483                                            2486 12504000
*            /********************************************************/ 12505000
*            /*                                              @Y30SSFR*/ 12506000
*            /*  RESET THE VALUE OF DALINDEX TO ZERO.        @Y30SSFR*/ 12507000
*            /*                                              @Y30SSFR*/ 12508000
*            /********************************************************/ 12509000
*                                                                  2487 12510000
*            DALINDEX = 0;                                 /*@Y30SSFR*/ 12511000
         L     @15,@PC00019+12                                     2487 12512000
         SLR   @14,@14                                             2487 12513000
         ST    @14,DALINDEX(,@15)                                  2487 12514000
*            END;                                          /*@Y30SSFR*/ 12515000
*                                                                  2488 12516000
*        RETURN CODE(0);                                   /*@Y30SSFR*/ 12517000
@RC02442 SLR   @15,@15                                             2489 12518000
         L     @14,@SA00019                                        2489 12519000
         LM    @00,@12,@SA00019+8                                  2489 12520000
         BR    @14                                                 2489 12521000
*        RFY ALLAGL BASED(ALLPTR);                         /*#YL026UA*/ 12522000
*END DALCPROC;                                             /*#YL026UA*/ 12523000
*        /************************************************************/ 12524000
*        /*                                                          */ 12525000
*        /*  PROCEDURE NAME - GETPROC                                */ 12526000
*        /*                                                          */ 12527000
*        /*  FUNCTION - GET A DATA RECORD AND PLACE IT INTO A        */ 12528000
*        /*  SUPPLIED BUFFER, RECONSTRUCTING THE ORIGINAL RECORD     */ 12529000
*        /*  IF IT HAS BEEN SEGMENTED INTO SEVERAL RECORDS           */ 12530000
*        /*                                                          */ 12531000
*        /*  INPUT -                                                 */ 12532000
*        /*    .GINVBUF - ADDR OF SUPPLIED BUFFER TO CONTAIN RECORD  */ 12533000
*        /*    .GLENGTH - LENGTH OF ENTIRE RECORD                    */ 12534000
*        /*                                                          */ 12535000
*        /*  OUTPUT - A BUFFER CONTAINING THE ENTIRE RECORD          */ 12536000
*        /*                                                          */ 12537000
*        /************************************************************/ 12538000
*                                                                  2492 12539000
*GETPROC: PROCEDURE (GINVBUF,          /*BUFFER TO CONTAIN RECORD    */ 12540000
*                    GLENGTH);         /*LENGTH OF RECORD            */ 12541000
*                                                                  2492 12542000
GETPROC  STM   @14,@12,@SA00020                                    2492 12543000
         MVC   @PC00020(8),0(@01)                                  2492 12544000
*        /************************************************************/ 12545000
*        /*                                                          */ 12546000
*        /*  ARGUMENTS OF INVOCATION                                 */ 12547000
*        /*                                                          */ 12548000
*        /************************************************************/ 12549000
*                                                                  2493 12550000
*        DCL GINVBUF  PTR(31),                                     2493 12551000
*            GLENGTH  FIXED(15);                                   2493 12552000
*                                                                  2493 12553000
*        /************************************************************/ 12554000
*        /*                                                          */ 12555000
*        /*  LOCAL DECLARATIONS                                      */ 12556000
*        /*                                                          */ 12557000
*        /************************************************************/ 12558000
*                                                                  2494 12559000
*        DCL GDOCNTRL BIT(1);                                      2494 12560000
*        DCL GMLEN  FIXED(15);                                     2495 12561000
*        DCL RDBUF PTR(31);            /*POINTER TO BUFFER POSITION  */ 12562000
*                                      /*INTO WHICH DATA TO BE MOVED */ 12563000
*        DCL RDLEN FIXED(15);          /*LENGTH OF DATA YET TO BE    */ 12564000
*                                      /*READ                        */ 12565000
*                                                                  2498 12566000
*        /************************************************************/ 12567000
*        /*                                                          */ 12568000
*        /*  ISSUE UGETS UNTIL ENTIRE RECORD HAS BEEN READ INTO CORE */ 12569000
*        /*                                                          */ 12570000
*        /************************************************************/ 12571000
*                                                                  2498 12572000
*        RDBUF = GINVBUF;                                          2498 12573000
         L     @02,@PC00020                                        2498 12574000
         L     @02,GINVBUF(,@02)                                   2498 12575000
         ST    @02,RDBUF                                           2498 12576000
*        RDLEN= GLENGTH;                                           2499 12577000
         L     @15,@PC00020+4                                      2499 12578000
         LH    RDLEN,GLENGTH(,@15)                                 2499 12579000
*        GDOCNTRL = ON;                                            2500 12580000
*                                                                  2500 12581000
         OI    GDOCNTRL,B'10000000'                                2500 12582000
*READLOOP: DO WHILE (GDOCNTRL = ON);                               2501 12583000
READLOOP B     @DE02501                                            2501 12584000
@DL02501 DS    0H                                                  2502 12585000
*            IOCSPTR = PINIOCS;                                    2502 12586000
*                                                                  2502 12587000
         L     @15,PINIOCS                                         2502 12588000
         ST    @15,IOCSPTR                                         2502 12589000
*            CALL IDCIOGT0(GDTTBL,PINIOCS);                        2503 12590000
*                                                                  2503 12591000
         L     @15,@PC00001                                        2503 12592000
         ST    @15,@AL00001                                        2503 12593000
         LA    @14,PINIOCS                                         2503 12594000
         ST    @14,@AL00001+4                                      2503 12595000
         MVI   @AL00001+4,X'80'                                    2503 12596000
         L     @15,GDTGET(,@15)                                    2503 12597000
         LA    @01,@AL00001                                        2503 12598000
         BALR  @14,@15                                             2503 12599000
*            RESPECIFY RTNREG RSTD;                                2504 12600000
*            TESTRC = RTNREG;                                      2505 12601000
         LR    TESTRC,RTNREG                                       2505 12602000
*            RESPECIFY RTNREG UNRSTD;                              2506 12603000
*            IF TESTRC ^= 0                                        2507 12604000
*              THEN                                                2507 12605000
*                                                                  2507 12606000
         LTR   TESTRC,TESTRC                                       2507 12607000
         BZ    @RF02507                                            2507 12608000
*              /******************************************************/ 12609000
*              /*                                                    */ 12610000
*              /*  IF AN ERROR OR END OF DATA CONDITION IS           */ 12611000
*              /*  RETURN TO THE CALLING PROCESSOR                   */ 12612000
*              /*                                                    */ 12613000
*              /******************************************************/ 12614000
*                                                                  2508 12615000
*                IF TESTRC = 16                                    2508 12616000
*                  THEN                                            2508 12617000
         LA    @03,16                                              2508 12618000
         CR    TESTRC,@03                                          2508 12619000
         BNE   @RF02508                                            2508 12620000
*                    RETURN CODE(16);                              2509 12621000
         LR    @15,@03                                             2509 12622000
         L     @14,@SA00020                                        2509 12623000
         LM    @00,@12,@SA00020+8                                  2509 12624000
         BR    @14                                                 2509 12625000
*                  ELSE                                            2510 12626000
*                    RETURN CODE(LASTCC12);                        2510 12627000
@RF02508 LA    @15,12                                              2510 12628000
         L     @14,@SA00020                                        2510 12629000
         LM    @00,@12,@SA00020+8                                  2510 12630000
         BR    @14                                                 2510 12631000
*              ELSE;                                               2511 12632000
*                                                                  2511 12633000
@RF02507 DS    0H                                                  2512 12634000
*          /**********************************************************/ 12635000
*          /*                                                        */ 12636000
*          /*  MOVE DATA JUST READ IN INTO BUFFER                    */ 12637000
*          /*                                                        */ 12638000
*          /**********************************************************/ 12639000
*                                                                  2512 12640000
*          GMLEN = IOCDLN;                                         2512 12641000
*                                                                  2512 12642000
         L     @02,IOCSPTR                                         2512 12643000
         L     @15,IOCDLN(,@02)                                    2512 12644000
         STH   @15,GMLEN                                           2512 12645000
*          CALL MVDAPROC(GMLEN,IOCDAD,RDBUF);                      2513 12646000
*                                                                  2513 12647000
         LA    @15,GMLEN                                           2513 12648000
         ST    @15,@AL00001                                        2513 12649000
         ST    @02,@AL00001+4                                      2513 12650000
         LA    @02,RDBUF                                           2513 12651000
         ST    @02,@AL00001+8                                      2513 12652000
         LA    @01,@AL00001                                        2513 12653000
         BAL   @14,MVDAPROC                                        2513 12654000
*        /************************************************************/ 12655000
*        /*                                                          */ 12656000
*        /*  DETERMINE IF ALL RECORD SEGMENTS HAVE BEEN READ IN.     */ 12657000
*        /*  IF SO, EXIT FROM LOOP.  IF NOT ADJUST LENGTH AND        */ 12658000
*        /*  AND CONTINUE GETTING RECORDS.                           */ 12659000
*        /*                                                          */ 12660000
*        /************************************************************/ 12661000
*                                                                  2514 12662000
*          IF IOCDLN < RDLEN                                       2514 12663000
*            THEN                                                  2514 12664000
         L     @02,IOCSPTR                                         2514 12665000
         L     @02,IOCDLN(,@02)                                    2514 12666000
         CR    @02,RDLEN                                           2514 12667000
         BNL   @RF02514                                            2514 12668000
*              DO;                                                 2515 12669000
*              RDLEN = RDLEN - IOCDLN;                             2516 12670000
         SLR   RDLEN,@02                                           2516 12671000
*              RDBUF = RDBUF + IOCDLN;                             2517 12672000
         AL    @02,RDBUF                                           2517 12673000
         ST    @02,RDBUF                                           2517 12674000
*              END;                                                2518 12675000
*            ELSE                                                  2519 12676000
*              GDOCNTRL = OFF;                                     2519 12677000
         B     @RC02514                                            2519 12678000
@RF02514 NI    GDOCNTRL,B'01111111'                                2519 12679000
*        END READLOOP;                                             2520 12680000
*                                                                  2520 12681000
@RC02514 DS    0H                                                  2520 12682000
@DE02501 TM    GDOCNTRL,B'10000000'                                2520 12683000
         BO    @DL02501                                            2520 12684000
*        /************************************************************/ 12685000
*        /*                                                          */ 12686000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 12687000
*        /*                                                          */ 12688000
*        /************************************************************/ 12689000
*                                                                  2521 12690000
*        RETURN CODE(0);                                           2521 12691000
         SLR   @15,@15                                             2521 12692000
         L     @14,@SA00020                                        2521 12693000
         LM    @00,@12,@SA00020+8                                  2521 12694000
         BR    @14                                                 2521 12695000
*END GETPROC;                                                      2522 12696000
*END IDCMP01                                                       2523 12697000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 12698000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 12699000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 12700000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 12701000
*/*%INCLUDE SYSLIB  (IDCCSMP )                                        * 12702000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 12703000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 12704000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 12705000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 12706000
*;                                                                 2523 12707000
@DATA    DS    0H                                                       12708000
@CH00288 DC    H'5'                                                     12709000
@CH00040 DC    H'7'                                                     12710000
@CH00038 DC    H'9'                                                     12711000
@CH00037 DC    H'10'                                                    12712000
@CH00036 DC    H'11'                                                    12713000
@CH00629 DC    H'20'                                                    12714000
@CH00701 DC    H'22'                                                    12715000
@CH00705 DC    H'23'                                                    12716000
@CH01096 DC    H'28'                                                    12717000
@CH01098 DC    H'29'                                                    12718000
@CH00605 DC    H'44'                                                    12719000
@CH01655 DC    H'96'                                                    12720000
@CH01157 DC    H'110'                                                   12721000
@CH01163 DC    H'140'                                                   12722000
@CH01662 DC    H'544'                                                   12723000
@SM01687 MVC   ZAREA(0,ZPTR),ZER                                        12724000
@SM01692 MVC   FLISTVOL(0,@01),FLISTVOL(@05)                            12725000
@SM01711 MVC   LKEY(0),LOWKYVAL(@14)                                    12726000
@SM01713 MVC   HKEY(0),HIKEYVAL(@02)                                    12727000
@SC01715 CLC   LKEY(0),LOWKYVAL(@14)                                    12728000
@SC01717 CLC   LKEY(0),HIKEYVAL(@15)                                    12729000
@SC01719 CLC   HKEY(0),LOWKYVAL(@01)                                    12730000
@SC01721 CLC   HKEY(0),HIKEYVAL(@05)                                    12731000
@SM01723 MVC   FKEY(0,FRANPTR1),LOWKYVAL(@05)                           12732000
@SM01725 MVC   FKEY(0,FRANPTR1),HIKEYVAL(@04)                           12733000
@SM01727 MVC   FKEY(0,FRANPTR1),FIELDR+2(RPTR1)                         12734000
@SM01729 MVC   FKEY(0,FRANPTR1),FIELDR(@15)                             12735000
@SM01733 MVC   TOAREA(0,MTPTR),FROMAREA(MFPTR)                          12736000
@SM01735 MVC   FPASWD(0,@03),FIELDPS(DICENPTR)                          12737000
@SM01737 MVC   FPASSPRM(0,@03),FIELDPS(DICENPTR)                        12738000
@SM01739 MVC   FPASSATM(0,@03),FIELDPS(DICENPTR)                        12739000
@SM01741 MVC   FUSVRMDU(0,@03),FIELDPS(DICENPTR)                        12740000
@SM01743 MVC   FUSERARE(0,@03),FIELDPS(DICENPTR)                        12741000
         DS    0F                                                       12742000
@AL00531 EQU   *                       LIST WITH   5 ARGUMENT(S)        12743000
@AL00907 DC    A(@CC00823)             LIST WITH   5 ARGUMENT(S)        12744000
         DC    A(@CC00807)                                              12745000
         DC    A(NULLPARM)                                              12746000
         DC    A(NULLPARM)                                              12747000
         DC    A(NULLPARM)                                              12748000
@AL01133 DC    A(@CH00701)             LIST WITH   5 ARGUMENT(S)        12749000
         DC    A(@CC00811)                                              12750000
         DC    A(NULLPARM)                                              12751000
         DC    A(NULLPARM)                                              12752000
         DC    A(NULLPARM)                                              12753000
@AL01139 EQU   *                       LIST WITH   5 ARGUMENT(S)        12754000
@AL02145 DC    A(@CH00705)             LIST WITH   5 ARGUMENT(S)        12755000
         DC    A(@CF00035+3)                                            12756000
         DC    A(NULLPARM)                                              12757000
         DC    A(NULLPARM)                                              12758000
         DC    A(NULLPARM)                                              12759000
@AL01145 EQU   *                       LIST WITH   5 ARGUMENT(S)        12760000
@AL02139 DC    A(@CF00221+2)           LIST WITH   5 ARGUMENT(S)        12761000
         DC    A(@CC00807)                                              12762000
         DC    A(NULLPARM)                                              12763000
         DC    A(NULLPARM)                                              12764000
         DC    A(NULLPARM)                                              12765000
@AL01206 DC    A(@CF00165+2)           LIST WITH   5 ARGUMENT(S)        12766000
@AL01096 DC    A(@CH00037+1)           LIST WITH   1 ARGUMENT(S)        12767000
         DC    A(NULLPARM)                                              12768000
         DC    A(NULLPARM)                                              12769000
         DC    A(NULLPARM)                                              12770000
@AL01212 DC    A(@CF00312+2)           LIST WITH   5 ARGUMENT(S)        12771000
@AL01102 DC    A(@CH00036+1)           LIST WITH   1 ARGUMENT(S)        12772000
         DC    A(NULLPARM)                                              12773000
         DC    A(NULLPARM)                                              12774000
         DC    A(NULLPARM)                                              12775000
@AL01218 DC    A(@CF00625+2)           LIST WITH   5 ARGUMENT(S)        12776000
@AL01437 DC    A(@CC00811)             LIST WITH   4 ARGUMENT(S)        12777000
         DC    A(NULLPARM)                                              12778000
         DC    A(NULLPARM)                                              12779000
         DC    A(NULLPARM)                                              12780000
@AL02119 EQU   *                       LIST WITH   5 ARGUMENT(S)        12781000
@AL02120 DC    A(@CC01484)             LIST WITH   5 ARGUMENT(S)        12782000
@AL00512 DC    A(@CF00035+3)           LIST WITH   1 ARGUMENT(S)        12783000
         DC    A(NULLPARM)                                              12784000
         DC    A(@CF00118)                                              12785000
         DC    A(@CF00118)                                              12786000
@AL02185 DC    A(@CF00156+2)           LIST WITH   5 ARGUMENT(S)        12787000
@AL00864 EQU   *                       LIST WITH   3 ARGUMENT(S)        12788000
@AL01652 DC    A(@CC00807)             LIST WITH   3 ARGUMENT(S)        12789000
         DC    A(NULLPARM)                                              12790000
         DC    A(NULLPARM)                                              12791000
         DC    A(NULLPARM)                                              12792000
@DATD    DSECT                                                          12793000
         DS    0F                                                       12794000
@SA00001 DS    18F                                                      12795000
@PC00001 DS    3F                                                       12796000
@SA00003 DS    15F                                                      12797000
@SA00002 DS    15F                                                      12798000
@SA00005 DS    15F                                                      12799000
@PC00005 DS    5F                                                       12800000
@SA00010 DS    15F                                                      12801000
@PC00010 DS    1F                                                       12802000
@SA00011 DS    14F                                                      12803000
@PC00011 DS    6F                                                       12804000
@SA00016 DS    15F                                                      12805000
@PC00016 DS    1F                                                       12806000
@PC00015 DS    3F                                                       12807000
@SA00020 DS    15F                                                      12808000
@PC00020 DS    2F                                                       12809000
@SA00017 DS    15F                                                      12810000
@PC00017 DS    3F                                                       12811000
@SA00008 DS    15F                                                      12812000
@PC00008 DS    4F                                                       12813000
@SA00012 DS    15F                                                      12814000
@PC00012 DS    4F                                                       12815000
@SA00019 DS    15F                                                      12816000
@PC00019 DS    4F                                                       12817000
@SA00009 DS    15F                                                      12818000
@PC00009 DS    1F                                                       12819000
@SA00004 DS    15F                                                      12820000
@SA00014 DS    15F                                                      12821000
@SA00007 DS    15F                                                      12822000
@SA00013 DS    15F                                                      12823000
@PC00013 DS    6F                                                       12824000
@SA00018 DS    15F                                                      12825000
@PC00018 DS    3F                                                       12826000
@AL00001 DS    6A                                                       12827000
@TF00001 DS    F                                                        12828000
@AFTEMPS DS    9F                                                       12829000
IDCMP01  CSECT                                                          12830000
         DS    0F                                                       12831000
@CF00118 DC    F'0'                                                     12832000
@CF00221 DC    F'1'                                                     12833000
@CH00221 EQU   @CF00221+2                                               12834000
@CF00156 DC    F'2'                                                     12835000
@CH00156 EQU   @CF00156+2                                               12836000
@CF00165 DC    F'3'                                                     12837000
@CH00165 EQU   @CF00165+2                                               12838000
@CF00045 DC    F'4'                                                     12839000
@CH00045 EQU   @CF00045+2                                               12840000
@CF00159 DC    F'6'                                                     12841000
@CH00159 EQU   @CF00159+2                                               12842000
@CF00039 DC    F'8'                                                     12843000
@CH00039 EQU   @CF00039+2                                               12844000
@CF00035 DC    F'12'                                                    12845000
@CH00035 EQU   @CF00035+2                                               12846000
@CF00625 DC    F'18'                                                    12847000
@CH00625 EQU   @CF00625+2                                               12848000
@CF00312 DC    F'24'                                                    12849000
@CH00312 EQU   @CF00312+2                                               12850000
@CF01151 DC    F'40'                                                    12851000
@CH01151 EQU   @CF01151+2                                               12852000
@CF01384 DC    F'45'                                                    12853000
@CH01384 EQU   @CF01384+2                                               12854000
@CF01653 DC    F'52'                                                    12855000
@CF01153 DC    F'72'                                                    12856000
@CF01155 DC    F'76'                                                    12857000
@CF01161 DC    F'240'                                                   12858000
@CF00634 DC    F'255'                                                   12859000
@CF01667 DC    F'276'                                                   12860000
@CF01674 DC    F'952'                                                   12861000
@CF01290 DC    F'2048'                                                  12862000
@CF01710 DC    F'-84'                                                   12863000
@CF01706 DC    F'-41'                                                   12864000
@CF01708 DC    F'-12'                                                   12865000
@CF01731 DC    F'-8'                                                    12866000
@CF01709 DC    F'-7'                                                    12867000
@CF01694 DC    F'-6'                                                    12868000
@CF01707 DC    F'-5'                                                    12869000
@CF01689 DC    F'-4'                                                    12870000
@DATD    DSECT                                                          12871000
         DS    0D                                                       12872000
LISTSCAN DS    A                                                        12873000
IOCSPTR  DS    A                                                        12874000
DDSTRU   DS    A                                                        12875000
FSADDR   DS    A                                                        12876000
ERCNVADR DS    A                                                        12877000
DMPINDEX DS    A                                                        12878000
CTGPLPTR DS    A                                                        12879000
CTGFVPTR DS    A                                                        12880000
BLKSIZ   DS    F                                                        12881000
TOTLEN   DS    F                                                        12882000
FNMPTR   DS    A                                                        12883000
PWORKAR  DS    A                                                        12884000
PFVTPTR  DS    A                                                        12885000
PTRCPL   DS    A                                                        12886000
PPTRCPL  DS    A                                                        12887000
DCPLPTR  DS    A                                                        12888000
CPSWD    DS    A                                                        12889000
PINIOCS  DS    A                                                        12890000
POUTIOCS DS    A                                                        12891000
PTRCTIOC DS    A                                                        12892000
PTRCTACB DS    A                                                        12893000
RANGINPT DS    A                                                        12894000
RANGPORT DS    A                                                        12895000
CONRCPTR DS    A                                                        12896000
DICTPTR  DS    A                                                        12897000
ALLPTR   DS    A                                                        12898000
DALCINDX DS    F                                                        12899000
INDX     DS    F                                                        12900000
IX       DS    F                                                        12901000
ACPLPTR  DS    A                                                        12902000
LOOPCTR  DS    F                                                        12903000
APSWD    DS    A                                                        12904000
WSIZE    DS    F                                                        12905000
VOLLSTPT DS    A                                                        12906000
SIZENEED DS    F                                                        12907000
RPTR2    DS    A                                                        12908000
LOWLN    DS    F                                                        12909000
RLCPLPTR DS    A                                                        12910000
FPLADDR  DS    A                                                        12911000
DALGLPTR DS    A                                                        12912000
RDBUF    DS    A                                                        12913000
FLISTPTR DS    A                                                        12914000
LISTPTR  DS    A                                                        12915000
LPSWD    DS    A                                                        12916000
SAVFVTV  DS    A                                                        12917000
SETRC    DS    H                                                        12918000
TFVTLEN  DS    H                                                        12919000
NUMCOMP  DS    H                                                        12920000
NUMOBJ   DS    H                                                        12921000
ENTNLN   DS    H                                                        12922000
OUTDSNLN DS    H                                                        12923000
CURSIZE  DS    H                                                        12924000
GMLEN    DS    H                                                        12925000
TOTLENH  DS    H                                                        12926000
DEFSTID  DS    FL1                                                      12927000
         DS    CL2                                                      12928000
RLFNAME  DS    FL3                                                      12929000
LISTLN   DS    FL1                                                      12930000
@TS00001 DS    CL95                                                     12931000
ERRORTAB DS    CL32                                                     12932000
@NM00054 DS    CL10                                                     12933000
         ORG   @NM00054                                                 12934000
CATRTNID DS    CL8                                                      12935000
CATLGRC  DS    FL2                                                      12936000
         ORG   @NM00054+10                                              12937000
         DS    CL2                                                      12938000
CATRCVWK DS    CL10                                                     12939000
         ORG   CATRCVWK                                                 12940000
RCVLN    DS    FL2                                                      12941000
RCVRLN   DS    FL2                                                      12942000
CATRCWKA DS    CL6                                                      12943000
         ORG   CATRCVWK+10                                              12944000
PCOREFLG DS    BL1                                                      12945000
SAVCPL   DS    CL28                                                     12946000
PSAVCPL  DS    CL28                                                     12947000
IMPFLG   DS    BL1                                                      12948000
         ORG   IMPFLG                                                   12949000
IMPUNIQ  DS    BL1                                                      12950000
IMPINHTG EQU   IMPFLG+0                                                 12951000
IMPASSOC EQU   IMPFLG+0                                                 12952000
IMPBASE  EQU   IMPFLG+0                                                 12953000
IMPNTUSD EQU   IMPFLG+0                                                 12954000
         ORG   IMPFLG+1                                                 12955000
KSDSFLAG DS    BL1                                                      12956000
IMPFLG2  DS    BL1                                                      12957000
         ORG   IMPFLG2                                                  12958000
IMPF2VOL DS    BL1                                                      12959000
IMPF2DEL EQU   IMPFLG2+0                                                12960000
IMPF2OBJ EQU   IMPFLG2+0                                                12961000
IMPF2NOD EQU   IMPFLG2+0                                                12962000
IMPF2NER EQU   IMPFLG2+0                                                12963000
IMPF2RES EQU   IMPFLG2+0                                                12964000
         ORG   IMPFLG2+1                                                12965000
         DS    CL2                                                      12966000
CONRCARE DS    CL268                                                    12967000
ALLLIST  DS    CL29                                                     12968000
         DS    CL3                                                      12969000
QUALLIST DS    CL12                                                     12970000
         ORG   QUALLIST                                                 12971000
QUALADDR DS    AL4                                                      12972000
QUALCAT  DS    AL4                                                      12973000
QUALPAS  DS    AL4                                                      12974000
         ORG   QUALLIST+12                                              12975000
ENTNAM   DS    CL44                                                     12976000
OUTDSNAM DS    CL44                                                     12977000
DEALLOC  DS    BL1                                                      12978000
UNIQD    DS    BL1                                                      12979000
UNIQI    DS    BL1                                                      12980000
EMPTYDS  DS    BL1                                                      12981000
IUNIQFVT DS    CL92                                                     12982000
ZCNTRL   DS    BL1                                                      12983000
         DS    CL3                                                      12984000
CNCTBLKS DS    CL120                                                    12985000
         ORG   CNCTBLKS                                                 12986000
CNCTCPL  DS    CL28                                                     12987000
CNCTFVT  DS    CL92                                                     12988000
         ORG   CNCTBLKS+120                                             12989000
LDOCNTRL DS    BL1                                                      12990000
         DS    CL3                                                      12991000
DELTWKA  DS    CL544                                                    12992000
         ORG   DELTWKA                                                  12993000
@NM00055 DS    FL2                                                      12994000
@NM00056 DS    FL2                                                      12995000
@NM00057 DS    12CL45                                                   12996000
         ORG   DELTWKA+544                                              12997000
AFVT     DS    CL92                                                     12998000
VOLLSTOR DS    CL10                                                     12999000
DSAVCPL  DS    CL28                                                     13000000
COREFLAG DS    BL1                                                      13001000
         DS    CL1                                                      13002000
OPENLIST DS    BL48                                                     13003000
LKEY     DS    CL64                                                     13004000
HKEY     DS    CL64                                                     13005000
KERROR   DS    BL1                                                      13006000
RSAVCPL  DS    CL28                                                     13007000
DOCNTRL  DS    BL1                                                      13008000
         DS    CL2                                                      13009000
ALGLSAVE DS    CL20                                                     13010000
         ORG   ALGLSAVE                                                 13011000
ALSAVPTR DS    0A                                                       13012000
         ORG   ALGLSAVE+20                                              13013000
GDOCNTRL DS    BL1                                                      13014000
CDOCNTRL DS    BL1                                                      13015000
DEFSTMOD DS    CL3                                                      13016000
RDOCNTRL DS    BL1                                                      13017000
RENEWCPL DS    CL28                                                     13018000
         DS    CL2                                                      13019000
PRINTTAB DS    9F                                                       13020000
WORKAR   DS    3A                                                       13021000
FVTPTR   DS    3A                                                       13022000
SAVFVT   DS    3A                                                       13023000
LCPLPTR  DS    3A                                                       13024000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                13025000
@ENDDATD EQU   *                                                        13026000
IDCMP01  CSECT                                                          13027000
         DS    0F                                                       13028000
@SIZDATD DC    AL1(0)                                                   13029000
         DC    AL3(@ENDDATD-@DATD)                                      13030000
         DS    0D                                                       13031000
NULLPARM DC    A(0)                                                     13032000
CFPLNUM  DC    H'12'                                                    13033000
LNAMEDS  DC    H'4'                                                     13034000
@CC01429 DC    C'CATLGRTN'                                              13035000
@CC01277 DC    C'MPBG'                                                  13036000
@CC01283 DC    C'MPFN'                                                  13037000
@CC01289 DC    C'MPCP'                                                  13038000
@CC01294 DC    C'MPCT'                                                  13039000
@CC01330 DC    C'MPPT'                                                  13040000
@CC01338 DC    C'MPUC'                                                  13041000
@CC01359 DC    C'MPDN'                                                  13042000
@CC01389 DC    C'MPUQ'                                                  13043000
@CC01415 DC    C'MPLV'                                                  13044000
@CC01427 DC    C'MPSP'                                                  13045000
@CC01428 DC    C'MPZZ'                                                  13046000
@CC01455 DC    C'MPDL'                                                  13047000
@CC01456 DC    C'MPDC'                                                  13048000
@CC01463 DC    C'MPDD'                                                  13049000
@CC01483 DC    C'MPOP'                                                  13050000
@CC01536 DC    C'MPBF'                                                  13051000
@CC01569 DC    C'MPMG'                                                  13052000
@CC01582 DC    C'MPFV'                                                  13053000
@CC01600 DC    C'MPPS'                                                  13054000
@CC01630 DC    C'MPDA'                                                  13055000
@CC01000 DC    C'MP0'                                                   13056000
@CC01023 DC    C'UV0'                                                   13057000
@CC01031 DC    C'DL0'                                                   13058000
@CC01038 DC    C'DE0'                                                   13059000
@CC01355 DC    C'XP0'                                                   13060000
@CC00807 EQU   @CC01031                                                 13061000
@CC00809 DC    C'I'                                                     13062000
@CC00811 DC    C'A'                                                     13063000
@CC00823 DC    C'F'                                                     13064000
@CC01360 DC    C'L'                                                     13065000
@CC01484 DC    C'O'                                                     13066000
ALL      DC    CL3'ALL'                                                 13067000
FORMAT   DC    CL4'FORM'                                                13068000
HSECOND  DC    CL4'HSEC'                                                13069000
CLOCK    DC    CL4'KLOK'                                                13070000
SETZERO  DC    CL4'ZERO'                                                13071000
SETBLANK DC    CL4'BLNK'                                                13072000
NOSET    DC    CL4'NSET'                                                13073000
OVERRIDE DC    CL4'OVRD'                                                13074000
ACQUIRE  DC    CL8'ACQUIRE '                                            13075000
RELINQ   DC    CL8'RELINQ  '                                            13076000
MOUNT    DC    CL8'MOUNT   '                                            13077000
DEMOUNT  DC    CL8'DEMOUNT '                                            13078000
DEFINE   DC    CL8'DEFINE  '                                            13079000
MOVE     DC    CL8'MOVE    '                                            13080000
TRACEQ   DC    CL8'TRACEQ  '                                            13081000
COPYTABL DC    CL8'COPYTABL'                                            13082000
COPYCRTG DC    CL8'COPYCRTG'                                            13083000
COPYVOL  DC    CL8'COPYVOL '                                            13084000
VVIC     DC    CL8'VVIC    '                                            13085000
TUNE     DC    CL8'TUNE    '                                            13086000
NAMES    DC    CL4'NAME'                                                13087000
UNIT     DC    CL4'UNIT'                                                13088000
SHR      DC    CL4'SHR '                                                13089000
EXCL     DC    CL4'EXCL'                                                13090000
NOWAIT   DC    CL4'NWAI'                                                13091000
WAIT     DC    CL4'WAIT'                                                13092000
MODID    DC    CL4'MP01'                                                13093000
GPID     DC    CL4'MP01'                                                13094000
         DS    CL1                                                      13095000
FIXAREA  DS    CL1024                                                   13096000
         ORG   FIXAREA                                                  13097000
@NM00044 DS    CL256                                                    13098000
         ORG   @NM00044                                                 13099000
@NM00045 DC    256X'00'                                                 13100000
         ORG   FIXAREA+256                                              13101000
@NM00046 DS    CL256                                                    13102000
         ORG   @NM00046                                                 13103000
@NM00047 DC    256X'00'                                                 13104000
         ORG   FIXAREA+512                                              13105000
@NM00048 DS    CL256                                                    13106000
         ORG   @NM00048                                                 13107000
@NM00049 DC    256X'00'                                                 13108000
         ORG   FIXAREA+768                                              13109000
@NM00050 DS    CL256                                                    13110000
         ORG   @NM00050                                                 13111000
@NM00051 DC    256X'00'                                                 13112000
         ORG   FIXAREA+1024                                             13113000
FPASNAME DC    CL8'PASSWALL'                                            13114000
FNDEVTYP DC    CL8'DEVTYP  '                                            13115000
CNTREPNO DC    CL8'CNTREPNO'                                            13116000
ZEROS    DC    X'00'                                                    13117000
         DC    XL5'0'                                                   13118000
ZER      DC    X'00'                                                    13119000
         DC    XL255'0'                                                 13120000
FFS      DS    CL64                                                     13121000
         ORG   FFS                                                      13122000
@NM00058 DC    64X'FF'                                                  13123000
         ORG   FFS+64                                                   13124000
DALCUNIT DS    CL12                                                     13125000
         ORG   DALCUNIT                                                 13126000
DL#UNIT  DC    H'1'                                                     13127000
DLUNITLN DC    H'8'                                                     13128000
DLUNIT   DC    CL8'SYSALLDA'                                            13129000
         ORG   DALCUNIT+12                                              13130000
FIELDLST DC    CL8'ENTYPE  '                                            13131000
         DC    CL8'ENTNAME '                                            13132000
         DC    CL8'DSATTR  '                                            13133000
         DC    CL8'OWNERID '                                            13134000
         DC    CL8'DSETCRDT'                                            13135000
         DC    CL8'DSETEXDT'                                            13136000
         DC    CL8'BUFSIZE '                                            13137000
         DC    CL8'LRECL   '                                            13138000
         DC    CL8'SPACPARM'                                            13139000
         DC    CL8'PASSWORD'                                            13140000
         DC    CL8'PASSPRMT'                                            13141000
         DC    CL8'PASSATMP'                                            13142000
         DC    CL8'USVRMDUL'                                            13143000
         DC    CL8'USERAREC'                                            13144000
         DC    CL8'LOKEYV  '                                            13145000
         DC    CL8'HIKEYV  '                                            13146000
         DC    CL8'VOLSER  '                                            13147000
         DC    CL8'AMDSBCAT'                                            13148000
         DC    CL8'EXCPEXIT'                                            13149000
         DC    CL8'RGATTR  '                                            13150000
         DC    CL8'SECFLAGS'                                            13151000
         DC    CL8'CATACB  '                                            13152000
         DC    CL8'NAMEDS  '                                            13153000
         DC    CL8'HURBADS '                                            13154000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       13155000
@01      EQU   01                                                       13156000
@02      EQU   02                                                       13157000
@03      EQU   03                                                       13158000
@04      EQU   04                                                       13159000
@05      EQU   05                                                       13160000
@06      EQU   06                                                       13161000
@07      EQU   07                                                       13162000
@08      EQU   08                                                       13163000
@09      EQU   09                                                       13164000
@10      EQU   10                                                       13165000
@11      EQU   11                                                       13166000
@12      EQU   12                                                       13167000
@13      EQU   13                                                       13168000
@14      EQU   14                                                       13169000
@15      EQU   15                                                       13170000
RDLEN    EQU   @03                                                      13171000
DICENPTR EQU   @02                                                      13172000
FIELDPTR EQU   @02                                                      13173000
M1SIZE   EQU   @02                                                      13174000
MTPTR    EQU   @03                                                      13175000
MFPTR    EQU   @04                                                      13176000
HILN     EQU   @04                                                      13177000
LENG     EQU   @03                                                      13178000
RPTR1    EQU   @04                                                      13179000
FRANPTR1 EQU   @02                                                      13180000
KEYLENGH EQU   @02                                                      13181000
PLIMIT   EQU   @04                                                      13182000
LIMIT    EQU   @03                                                      13183000
K        EQU   @02                                                      13184000
IX1      EQU   @02                                                      13185000
JX1      EQU   @03                                                      13186000
JX       EQU   @02                                                      13187000
NUMVOL   EQU   @04                                                      13188000
FDEVTPTR EQU   @02                                                      13189000
CPLPROCI EQU   @02                                                      13190000
AMDSBPTR EQU   @03                                                      13191000
ZPTR     EQU   @03                                                      13192000
ZSIZE    EQU   @02                                                      13193000
AFVTPTR  EQU   @04                                                      13194000
J        EQU   @02                                                      13195000
N        EQU   @03                                                      13196000
I        EQU   @03                                                      13197000
FX       EQU   @03                                                      13198000
ENTRYNO  EQU   @03                                                      13199000
DSCCATPT EQU   @02                                                      13200000
CTGFLPTR EQU   @04                                                      13201000
OPNPTR   EQU   @03                                                      13202000
TESTRC   EQU   @02                                                      13203000
RTNREG   EQU   @15                                                      13204000
REG15    EQU   @15                                                      13205000
REG0     EQU   @00                                                      13206000
REG1     EQU   @01                                                      13207000
REG10    EQU   @10                                                      13208000
REG11    EQU   @11                                                      13209000
REG12    EQU   @12                                                      13210000
REG13    EQU   @13                                                      13211000
REG14    EQU   @14                                                      13212000
REG2     EQU   @02                                                      13213000
REG3     EQU   @03                                                      13214000
REG4     EQU   @04                                                      13215000
REG5     EQU   @05                                                      13216000
REG6     EQU   @06                                                      13217000
REG7     EQU   @07                                                      13218000
REG8     EQU   @08                                                      13219000
REG9     EQU   @09                                                      13220000
IDCSAEP0 EQU   0                                                        13221000
IDCSAFS0 EQU   0                                                        13222000
IDCSAGP0 EQU   0                                                        13223000
IDCSAFP0 EQU   0                                                        13224000
IDCSACA0 EQU   0                                                        13225000
IDCSAAL0 EQU   0                                                        13226000
IDCSADL0 EQU   0                                                        13227000
IDCSAQL0 EQU   0                                                        13228000
TRACE1   EQU   0                                                        13229000
OLDERID1 EQU   TRACE1                                                   13230000
TRACE2   EQU   0                                                        13231000
OLDERID2 EQU   TRACE2                                                   13232000
NEWID2   EQU   TRACE2+95                                                13233000
NEWERID2 EQU   5                                                        13234000
CIRAGL   EQU   0                                                        13235000
CIRTYPE  EQU   CIRAGL                                                   13236000
ALLAGL   EQU   0                                                        13237000
ALLDSN   EQU   ALLAGL                                                   13238000
ALLDDN   EQU   ALLAGL+4                                                 13239000
ALLULP   EQU   ALLAGL+12                                                13240000
ALLVLP   EQU   ALLAGL+16                                                13241000
ALLPWD   EQU   ALLAGL+20                                                13242000
ALLSTS   EQU   ALLAGL+24                                                13243000
ALLSTSOD EQU   ALLSTS                                                   13244000
ALLDSP   EQU   ALLAGL+25                                                13245000
ALLDSPKP EQU   ALLDSP                                                   13246000
ALLORG   EQU   ALLAGL+26                                                13247000
ALLOPT   EQU   ALLAGL+28                                                13248000
ALLOPTVL EQU   ALLOPT                                                   13249000
ALLOPTDS EQU   ALLOPT                                                   13250000
UNITABL  EQU   0                                                        13251000
UNITADR  EQU   UNITABL+4                                                13252000
@NM00010 EQU   UNITADR                                                  13253000
UNITSTAT EQU   UNITABL+6                                                13254000
IDCIOOP0 EQU   0                                                        13255000
IDCIOCL0 EQU   0                                                        13256000
IDCIOGT0 EQU   0                                                        13257000
IDCIOCO0 EQU   0                                                        13258000
IOCSTR   EQU   0                                                        13259000
IOCDAD   EQU   IOCSTR                                                   13260000
IOCDLN   EQU   IOCSTR+4                                                 13261000
IOCDSO   EQU   IOCSTR+16                                                13262000
IOCRFM   EQU   IOCSTR+17                                                13263000
IOCMAC   EQU   IOCSTR+18                                                13264000
IOCMAC2  EQU   IOCSTR+19                                                13265000
IOCCHP   EQU   IOCSTR+20                                                13266000
IOCMSG   EQU   IOCSTR+21                                                13267000
IOCDSN   EQU   IOCSTR+32                                                13268000
IOCRBA   EQU   IOCSTR+40                                                13269000
IOCTTR   EQU   IOCRBA                                                   13270000
IOCMEM   EQU   IOCSTR+44                                                13271000
IOCNWM   EQU   IOCSTR+48                                                13272000
IOCREL   EQU   IOCSTR+60                                                13273000
OPNAGL   EQU   0                                                        13274000
OPNOPT   EQU   OPNAGL                                                   13275000
OPNOPTIN EQU   OPNOPT                                                   13276000
OPNOPTOT EQU   OPNOPT                                                   13277000
OPNRFM   EQU   OPNAGL+1                                                 13278000
OPNRFMSF EQU   OPNRFM                                                   13279000
OPNRFMBK EQU   OPNRFM                                                   13280000
OPNTYP   EQU   OPNAGL+2                                                 13281000
OPNTYPXM EQU   OPNTYP                                                   13282000
OPNMOD   EQU   OPNAGL+3                                                 13283000
OPNMODAX EQU   OPNMOD                                                   13284000
OPNIOC   EQU   OPNAGL+4                                                 13285000
OPNDDN   EQU   OPNAGL+8                                                 13286000
OPNPWA   EQU   OPNAGL+12                                                13287000
OPNDSN   EQU   OPNAGL+16                                                13288000
OPNDEV   EQU   OPNAGL+24                                                13289000
OPNDEVDT EQU   OPNDEV                                                   13290000
OPNREC   EQU   OPNAGL+32                                                13291000
OPNBLK   EQU   OPNAGL+36                                                13292000
OPNDSO   EQU   OPNAGL+41                                                13293000
OPNOPT2  EQU   OPNAGL+42                                                13294000
IOINFOPT EQU   0                                                        13295000
UVOLLIST EQU   0                                                        13296000
UVOLENT  EQU   UVOLLIST+2                                               13297000
AMSTP011 EQU   0                                                        13298000
IDCTPER0 EQU   0                                                        13299000
DARGLIST EQU   0                                                        13300000
DARGDBP  EQU   DARGLIST                                                 13301000
DARGSTID EQU   DARGLIST+8                                               13302000
DARGSMOD EQU   DARGSTID                                                 13303000
DARGSENT EQU   DARGSTID+3                                               13304000
DARGILP  EQU   DARGLIST+12                                              13305000
DARGCNT  EQU   DARGLIST+14                                              13306000
DARGFLGS EQU   DARGLIST+19                                              13307000
DARGARY  EQU   DARGLIST+20                                              13308000
DARGINS  EQU   DARGARY                                                  13309000
DARGINL  EQU   DARGARY+2                                                13310000
DARGPCT  EQU   DARGINL                                                  13311000
DARGDTM  EQU   DARGARY+4                                                13312000
FMTLIST  EQU   0                                                        13313000
FMTFLGS  EQU   FMTLIST                                                  13314000
FMTSPF   EQU   FMTLIST+2                                                13315000
FMTRFNO  EQU   FMTSPF                                                   13316000
FMTILEN  EQU   FMTRFNO                                                  13317000
FMTIOFF  EQU   FMTLIST+4                                                13318000
FMTTRBC  EQU   FMTIOFF                                                  13319000
FMTSTO   EQU   FMTTRBC                                                  13320000
FMTOCOL  EQU   FMTLIST+6                                                13321000
FMTCNVF  EQU   FMTLIST+10                                               13322000
ERCNVTAB EQU   0                                                        13323000
ERTYPE   EQU   ERCNVTAB                                                 13324000
ERCATLG  EQU   ERTYPE                                                   13325000
EROPER   EQU   ERCNVTAB+1                                               13326000
ERCATLC  EQU   EROPER                                                   13327000
ERCATDE  EQU   EROPER                                                   13328000
ERCATDL  EQU   EROPER                                                   13329000
ERCATAL  EQU   EROPER                                                   13330000
EROSOPER EQU   ERCNVTAB+2                                               13331000
ERDSNM   EQU   ERCNVTAB+12                                              13332000
ERCATRC  EQU   ERCNVTAB+16                                              13333000
ERCPLPT  EQU   ERCNVTAB+20                                              13334000
IDCDB010 EQU   0                                                        13335000
DMPITM   EQU   0                                                        13336000
DMPARY   EQU   0                                                        13337000
IN       EQU   0                                                        13338000
INDS     EQU   0                                                        13339000
INDSPLN  EQU   INDS                                                     13340000
INDSPAS  EQU   INDS+1                                                   13341000
INDSFLG  EQU   INDS+10                                                  13342000
INDSFUQ  EQU   INDSFLG                                                  13343000
INDSLEN  EQU   INDS+20                                                  13344000
INDSVAL  EQU   INDS+21                                                  13345000
OUTDD    EQU   0                                                        13346000
OUTDDPLN EQU   OUTDD                                                    13347000
OUTDDPAS EQU   OUTDD+1                                                  13348000
OUTDDVAL EQU   OUTDD+10                                                 13349000
OUTDS    EQU   0                                                        13350000
OUTDSPLN EQU   OUTDS                                                    13351000
OUTDSPAS EQU   OUTDS+1                                                  13352000
OUTDSFLG EQU   OUTDS+10                                                 13353000
OUTDSFUQ EQU   OUTDSFLG                                                 13354000
OUTDSLEN EQU   OUTDS+20                                                 13355000
OUTDSVAL EQU   OUTDS+21                                                 13356000
PRG      EQU   0                                                        13357000
ERAS     EQU   0                                                        13358000
NERAS    EQU   0                                                        13359000
OBJTS    EQU   0                                                        13360000
OBJTSCNT EQU   0                                                        13361000
OBJNMPTR EQU   0                                                        13362000
OBJNM    EQU   0                                                        13363000
OBJNMFLG EQU   OBJNM+10                                                 13364000
OBJNMVAL EQU   OBJNM+21                                                 13365000
NEWNMPTR EQU   0                                                        13366000
NEWNM    EQU   0                                                        13367000
NEWNMFLG EQU   NEWNM+10                                                 13368000
NEWNMVAL EQU   NEWNM+21                                                 13369000
OBJFLPTR EQU   0                                                        13370000
OBJFL    EQU   0                                                        13371000
OBJFLVAL EQU   OBJFL+1                                                  13372000
LISTVPTR EQU   0                                                        13373000
LISTV    EQU   0                                                        13374000
LISTVCNT EQU   LISTV                                                    13375000
@NM00032 EQU   LISTV+2                                                  13376000
LISTVVAL EQU   @NM00032+1                                               13377000
RANGEPTR EQU   0                                                        13378000
RANGECNT EQU   0                                                        13379000
LOWKYPTR EQU   0                                                        13380000
LOWKY    EQU   0                                                        13381000
LOWKYLEN EQU   LOWKY                                                    13382000
LOWKYVAL EQU   LOWKY+1                                                  13383000
HIKEYPTR EQU   0                                                        13384000
HIKEY    EQU   0                                                        13385000
HIKEYLEN EQU   HIKEY                                                    13386000
HIKEYVAL EQU   HIKEY+1                                                  13387000
DEVTPTR  EQU   0                                                        13388000
DEVT     EQU   0                                                        13389000
DEVTCNT  EQU   DEVT                                                     13390000
@NM00033 EQU   DEVT+2                                                   13391000
DEVTVAL  EQU   @NM00033+1                                               13392000
ORDPTR   EQU   0                                                        13393000
UNORDPTR EQU   0                                                        13394000
CON      EQU   0                                                        13395000
INDD     EQU   0                                                        13396000
INDDVAL  EQU   INDD+10                                                  13397000
ENV      EQU   0                                                        13398000
BLKSZ    EQU   0                                                        13399000
BLKSZVAL EQU   BLKSZ                                                    13400000
PDEV     EQU   0                                                        13401000
PDEVVAL  EQU   PDEV+1                                                   13402000
RCSZE    EQU   0                                                        13403000
RCSZEVAL EQU   RCSZE                                                    13404000
CAT      EQU   0                                                        13405000
CATPLN   EQU   CAT                                                      13406000
CATPAS   EQU   CAT+1                                                    13407000
CATFLG   EQU   CAT+10                                                   13408000
CATVAL   EQU   CAT+21                                                   13409000
IMPTY    EQU   0                                                        13410000
SRAC     EQU   0                                                        13411000
CTGPL    EQU   0                                                        13412000
CTGOPTN1 EQU   CTGPL                                                    13413000
CTGBYPSS EQU   CTGOPTN1                                                 13414000
CTGNAME  EQU   CTGOPTN1                                                 13415000
CTGCNAME EQU   CTGOPTN1                                                 13416000
CTGOPTN2 EQU   CTGPL+1                                                  13417000
CTGEXT   EQU   CTGOPTN2                                                 13418000
CTGERASE EQU   CTGOPTN2                                                 13419000
CTGSMF   EQU   CTGERASE                                                 13420000
CTGREL   EQU   CTGSMF                                                   13421000
CTGPURG  EQU   CTGOPTN2                                                 13422000
CTGVMNT  EQU   CTGPURG                                                  13423000
CTGRCATN EQU   CTGVMNT                                                  13424000
CTGOVRID EQU   CTGOPTN2                                                 13425000
CTGOPTN3 EQU   CTGPL+2                                                  13426000
CTGFUNC  EQU   CTGOPTN3                                                 13427000
CTGNUM   EQU   CTGOPTN3                                                 13428000
CTGAM0   EQU   CTGOPTN3                                                 13429000
CTGOPTN4 EQU   CTGPL+3                                                  13430000
CTGNPROF EQU   CTGOPTN4                                                 13431000
CTGENT   EQU   CTGPL+4                                                  13432000
CTGFVT   EQU   CTGENT                                                   13433000
CTGCAT   EQU   CTGPL+8                                                  13434000
CTGWKA   EQU   CTGPL+12                                                 13435000
CTGDSORG EQU   CTGPL+16                                                 13436000
CTGOPTNS EQU   CTGDSORG                                                 13437000
CTGTYPE  EQU   CTGPL+18                                                 13438000
CTGNOFLD EQU   CTGPL+19                                                 13439000
CTGDDNM  EQU   CTGPL+20                                                 13440000
CTGNEWNM EQU   CTGDDNM                                                  13441000
CTGFBFLG EQU   CTGNEWNM+2                                               13442000
CTGJSCB  EQU   CTGPL+24                                                 13443000
CTGPSWD  EQU   CTGJSCB                                                  13444000
CTGFIELD EQU   CTGPL+28                                                 13445000
CTGFL    EQU   0                                                        13446000
CTGFLDNO EQU   CTGFL                                                    13447000
CTGFLDCD EQU   CTGFL+1                                                  13448000
CTGFLDRE EQU   CTGFL+3                                                  13449000
CTGFLDWA EQU   CTGFL+4                                                  13450000
CTGFLDNM EQU   CTGFL+8                                                  13451000
CTGFLCHN EQU   CTGFL+12                                                 13452000
CTGFLDAT EQU   CTGFL+16                                                 13453000
CTGFLNG  EQU   CTGFLDAT                                                 13454000
CTGFLPT  EQU   CTGFLDAT+4                                               13455000
CTGFV    EQU   0                                                        13456000
CTGFVTYP EQU   CTGFV                                                    13457000
CTGFVPRO EQU   CTGFV+1                                                  13458000
CTGFVRON EQU   CTGFVPRO                                                 13459000
CTGFVDCH EQU   CTGFV+4                                                  13460000
CTGFVICH EQU   CTGFV+8                                                  13461000
CTGFVVCH EQU   CTGFV+12                                                 13462000
CTGFVIND EQU   CTGFV+16                                                 13463000
CTGFVENT EQU   CTGFV+20                                                 13464000
CTGFVSTY EQU   CTGFV+24                                                 13465000
CTGFVOWN EQU   CTGFV+28                                                 13466000
CTGFVEXP EQU   CTGFV+32                                                 13467000
CTGFVCRE EQU   CTGFV+36                                                 13468000
CTGFVVLT EQU   CTGFV+40                                                 13469000
CTGFVRNG EQU   CTGFV+44                                                 13470000
CTGFVDVT EQU   CTGFV+48                                                 13471000
CTGFVSPC EQU   CTGFV+52                                                 13472000
CTGFVAMD EQU   CTGFV+56                                                 13473000
CTGFVATR EQU   CTGFV+60                                                 13474000
CTGFVBUF EQU   CTGFV+64                                                 13475000
CTGFVLRS EQU   CTGFV+68                                                 13476000
CTGFVLMT EQU   CTGFV+72                                                 13477000
CTGFVEXT EQU   CTGFVLMT                                                 13478000
CTGFVGAT EQU   CTGFV+76                                                 13479000
CTGFVUPG EQU   CTGFVGAT                                                 13480000
CTGFVNAM EQU   CTGFV+80                                                 13481000
CTGFVPWD EQU   CTGFV+84                                                 13482000
CTGFVWKA EQU   CTGFV+88                                                 13483000
IDAAMDSB EQU   0                                                        13484000
AMDATTR  EQU   IDAAMDSB+1                                               13485000
AMDORDER EQU   AMDATTR                                                  13486000
AMDRRDS  EQU   AMDATTR                                                  13487000
AMDLEN   EQU   IDAAMDSB+2                                               13488000
AMDNEST  EQU   IDAAMDSB+4                                               13489000
AMDAXRKP EQU   AMDNEST                                                  13490000
AMDRKP   EQU   IDAAMDSB+6                                               13491000
AMDKEYLN EQU   IDAAMDSB+8                                               13492000
AMDPCTCA EQU   IDAAMDSB+10                                              13493000
AMDPCTCI EQU   IDAAMDSB+11                                              13494000
AMDCINV  EQU   IDAAMDSB+20                                              13495000
AMDLRECL EQU   IDAAMDSB+24                                              13496000
AMDHLRBA EQU   IDAAMDSB+28                                              13497000
AMDSSRBA EQU   IDAAMDSB+32                                              13498000
AMDATTR3 EQU   IDAAMDSB+40                                              13499000
AMDSTAT  EQU   IDAAMDSB+48                                              13500000
FIELDR   EQU   0                                                        13501000
FENTYPE  EQU   0                                                        13502000
FENTNAME EQU   0                                                        13503000
FDSATTR  EQU   0                                                        13504000
FDSUNIQ  EQU   FDSATTR                                                  13505000
FDSINHUP EQU   FDSATTR                                                  13506000
FDSTMPEX EQU   FDSATTR                                                  13507000
FCATACB  EQU   0                                                        13508000
FLVOLSER EQU   0                                                        13509000
FIELDVR  EQU   0                                                        13510000
FPASSWAL EQU   0                                                        13511000
FPASWD   EQU   FPASSWAL                                                 13512000
FPASSPRM EQU   FPASSWAL+32                                              13513000
FPASSATM EQU   FPASSWAL+40                                              13514000
FUSVRMDU EQU   FPASSWAL+42                                              13515000
FUSERARE EQU   FPASSWAL+50                                              13516000
FUSERLN  EQU   FUSERARE                                                 13517000
FLISTVOL EQU   0                                                        13518000
FLISTLN  EQU   FLISTVOL                                                 13519000
FVOLSERL EQU   FLISTVOL+2                                               13520000
FVOLRTN  EQU   FVOLSERL                                                 13521000
FVOLSER  EQU   FVOLSERL+2                                               13522000
FNAMEDS  EQU   0                                                        13523000
FTYPE    EQU   FNAMEDS                                                  13524000
FNAME    EQU   FNAMEDS+1                                                13525000
RCDSECF  EQU   0                                                        13526000
RCDEXSEC EQU   RCDSECF                                                  13527000
WORKAREA EQU   0                                                        13528000
AREALN   EQU   WORKAREA                                                 13529000
RETURNLN EQU   WORKAREA+2                                               13530000
ENTLIST  EQU   WORKAREA+4                                               13531000
ENTITEM  EQU   ENTLIST                                                  13532000
ENTRYTYP EQU   ENTITEM                                                  13533000
ENTRYNM  EQU   ENTITEM+1                                                13534000
CONREC   EQU   0                                                        13535000
HEADER   EQU   CONREC                                                   13536000
HEADLN   EQU   HEADER                                                   13537000
HEADFLG1 EQU   HEADER+2                                                 13538000
HEADFLG2 EQU   HEADER+3                                                 13539000
ASSRECLN EQU   HEADER+4                                                 13540000
VARDATA  EQU   CONREC+8                                                 13541000
DICT     EQU   0                                                        13542000
DICTEN   EQU   DICT+4                                                   13543000
DICTLN   EQU   DICTEN                                                   13544000
DICTDL   EQU   DICTEN+4                                                 13545000
TIMESTMP EQU   0                                                        13546000
TEXOJCT  EQU   TIMESTMP                                                 13547000
TEXFLG   EQU   TIMESTMP+1                                               13548000
TIMEODAY EQU   TIMESTMP+4                                               13549000
TIMEDATE EQU   TIMESTMP+12                                              13550000
ZAREA    EQU   0                                                        13551000
FHURBADS EQU   0                                                        13552000
FDEV     EQU   0                                                        13553000
FDEVTYP  EQU   FDEV                                                     13554000
FDEVT    EQU   FDEVTYP                                                  13555000
OIOCSPTR EQU   0                                                        13556000
FRANGLST EQU   0                                                        13557000
FRANGLN  EQU   FRANGLST                                                 13558000
FRANGES  EQU   0                                                        13559000
FKEYLN   EQU   FRANGES                                                  13560000
FKEY     EQU   FRANGES+2                                                13561000
BFLIST   EQU   0                                                        13562000
DSNAME   EQU   0                                                        13563000
FROMAREA EQU   0                                                        13564000
TOAREA   EQU   0                                                        13565000
FIELDPS  EQU   0                                                        13566000
FVTVLIST EQU   0                                                        13567000
FVTVLEN  EQU   FVTVLIST                                                 13568000
@NM00059 EQU   FVTVLIST+2                                               13569000
FVTVSER  EQU   @NM00059+2                                               13570000
ALCVLIST EQU   0                                                        13571000
ALC#ENT  EQU   ALCVLIST                                                 13572000
@NM00061 EQU   ALCVLIST+2                                               13573000
ALCVLEN  EQU   @NM00061                                                 13574000
ALCVSER  EQU   @NM00061+2                                               13575000
AMSTP041 EQU   0                                                        13576000
AMSTP042 EQU   0                                                        13577000
AMSTP043 EQU   0                                                        13578000
AMSTP044 EQU   0                                                        13579000
DMPTRM   EQU   0                                                        13580000
IDCIOIT0 EQU   0                                                        13581000
IDCIOPO0 EQU   0                                                        13582000
IDCIOPT0 EQU   0                                                        13583000
IDCIOSI0 EQU   0                                                        13584000
IDCIOST0 EQU   0                                                        13585000
IDCIOTM0 EQU   0                                                        13586000
IDCIOVY0 EQU   0                                                        13587000
IDCIO050 EQU   0                                                        13588000
IDCSACL0 EQU   0                                                        13589000
IDCSACR0 EQU   0                                                        13590000
IDCSADE0 EQU   0                                                        13591000
IDCSADQ0 EQU   0                                                        13592000
IDCSAGS0 EQU   0                                                        13593000
IDCSAID0 EQU   0                                                        13594000
IDCSALC0 EQU   0                                                        13595000
IDCSALD0 EQU   0                                                        13596000
IDCSALK0 EQU   0                                                        13597000
IDCSANQ0 EQU   0                                                        13598000
IDCSAPR0 EQU   0                                                        13599000
IDCSAPT0 EQU   0                                                        13600000
IDCSARC0 EQU   0                                                        13601000
IDCSARV0 EQU   0                                                        13602000
IDCSASC0 EQU   0                                                        13603000
IDCSASI0 EQU   0                                                        13604000
IDCSASN0 EQU   0                                                        13605000
IDCSASS0 EQU   0                                                        13606000
IDCSAST0 EQU   0                                                        13607000
IDCSATI0 EQU   0                                                        13608000
IDCSAUC0 EQU   0                                                        13609000
IDCSAWO0 EQU   0                                                        13610000
IDCSA060 EQU   0                                                        13611000
IDCST010 EQU   0                                                        13612000
LISTTEST EQU   0                                                        13613000
NEWERID1 EQU   5                                                        13614000
NPRG     EQU   0                                                        13615000
NSRAC    EQU   0                                                        13616000
ORD      EQU   0                                                        13617000
RANGE    EQU   0                                                        13618000
UNORD    EQU   0                                                        13619000
GDTTBL   EQU   0                                                        13620000
GDTTR1   EQU   GDTTBL+8                                                 13621000
GDTTR2   EQU   GDTTBL+12                                                13622000
GDTDBG   EQU   GDTTBL+40                                                13623000
GDTSTC   EQU   GDTTBL+44                                                13624000
GDTPRT   EQU   GDTTBL+48                                                13625000
GDTESS   EQU   GDTTBL+52                                                13626000
GDTESA   EQU   GDTTBL+56                                                13627000
GDTRST   EQU   GDTTBL+60                                                13628000
GDTRES   EQU   GDTTBL+64                                                13629000
GDTCAL   EQU   GDTTBL+68                                                13630000
GDTGSP   EQU   GDTTBL+72                                                13631000
GDTFSP   EQU   GDTTBL+76                                                13632000
GDTGPL   EQU   GDTTBL+80                                                13633000
GDTFPL   EQU   GDTTBL+84                                                13634000
GDTLOD   EQU   GDTTBL+88                                                13635000
GDTDEL   EQU   GDTTBL+92                                                13636000
GDTPRL   EQU   GDTTBL+96                                                13637000
GDTEPL   EQU   GDTTBL+100                                               13638000
GDTTIM   EQU   GDTTBL+104                                               13639000
GDTIIO   EQU   GDTTBL+108                                               13640000
GDTTIO   EQU   GDTTBL+112                                               13641000
GDTOPN   EQU   GDTTBL+124                                               13642000
GDTCLS   EQU   GDTTBL+128                                               13643000
GDTGET   EQU   GDTTBL+132                                               13644000
GDTPUT   EQU   GDTTBL+136                                               13645000
GDTPOS   EQU   GDTTBL+140                                               13646000
GDTCPY   EQU   GDTTBL+144                                               13647000
GDTCAT   EQU   GDTTBL+148                                               13648000
GDTSNP   EQU   GDTTBL+164                                               13649000
GDTVFY   EQU   GDTTBL+172                                               13650000
GDTECT   EQU   GDTTBL+188                                               13651000
GDTUID   EQU   GDTTBL+192                                               13652000
GDTPMT   EQU   GDTTBL+196                                               13653000
GDTCIR   EQU   GDTTBL+200                                               13654000
GDTLNK   EQU   GDTTBL+204                                               13655000
GDTALC   EQU   GDTTBL+208                                               13656000
GDTDLC   EQU   GDTTBL+212                                               13657000
GDTQAL   EQU   GDTTBL+216                                               13658000
GDTSTW   EQU   GDTTBL+220                                               13659000
GDTSSC   EQU   GDTTBL+224                                               13660000
GDTENQ   EQU   GDTTBL+228                                               13661000
GDTRSV   EQU   GDTTBL+232                                               13662000
GDTDEQ   EQU   GDTTBL+236                                               13663000
GDTSFO   EQU   GDTTBL+240                                               13664000
GDTWTO   EQU   GDTTBL+244                                               13665000
GDTSCR   EQU   GDTTBL+248                                               13666000
GDTUNT   EQU   GDTTBL+252                                               13667000
GDTRCT   EQU   GDTTBL+256                                               13668000
GDTIFO   EQU   GDTTBL+260                                               13669000
GDTEXP   EQU   GDTTBL+264                                               13670000
GDTSTA   EQU   GDTTBL+268                                               13671000
GDTERR   EQU   GDTTBL+272                                               13672000
GDTUNC   EQU   GDTTBL+276                                               13673000
GDTLOC   EQU   GDTTBL+280                                               13674000
FDTTBL   EQU   0                                                        13675000
FDTPTR   EQU   FDTTBL+8                                                 13676000
LASTCC   EQU   0                                                        13677000
CTYPE    EQU   0                                                        13678000
CPTRCPL  EQU   0                                                        13679000
CNAME    EQU   0                                                        13680000
CINUM    EQU   0                                                        13681000
CCPSWD   EQU   0                                                        13682000
LX       EQU   0                                                        13683000
LISTDICT EQU   0                                                        13684000
LISTWKA  EQU   0                                                        13685000
LFVTPTR  EQU   0                                                        13686000
SCPLPTR  EQU   0                                                        13687000
DLCPLPTR EQU   0                                                        13688000
OTYPE    EQU   0                                                        13689000
ODD      EQU   0                                                        13690000
ODSN     EQU   0                                                        13691000
OREC     EQU   0                                                        13692000
OBLK     EQU   0                                                        13693000
OIOCS    EQU   0                                                        13694000
RX       EQU   0                                                        13695000
RDICT    EQU   0                                                        13696000
RWKA     EQU   0                                                        13697000
RRANGPTR EQU   0                                                        13698000
BFLISTPT EQU   0                                                        13699000
BINDX    EQU   0                                                        13700000
BFPLADDR EQU   0                                                        13701000
BDICTPTR EQU   0                                                        13702000
BWKAPTR  EQU   0                                                        13703000
BFPLRTN  EQU   0                                                        13704000
MSIZE    EQU   0                                                        13705000
MF1PTR   EQU   0                                                        13706000
MT1PTR   EQU   0                                                        13707000
MNUM     EQU   0                                                        13708000
FDICT    EQU   0                                                        13709000
FWKA     EQU   0                                                        13710000
FPTRFVT  EQU   0                                                        13711000
BFPL     EQU   0                                                        13712000
BDICT    EQU   0                                                        13713000
BWKA     EQU   0                                                        13714000
REQTYPE  EQU   0                                                        13715000
DALVLPTR EQU   0                                                        13716000
DALDNMPT EQU   0                                                        13717000
DALINDEX EQU   0                                                        13718000
GINVBUF  EQU   0                                                        13719000
GLENGTH  EQU   0                                                        13720000
@NM00038 EQU   CTGDDNM                                                  13721000
CTGPROB  EQU   @NM00038                                                 13722000
CTGREASN EQU   CTGPROB+2                                                13723000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    13724000
CTGREAS2 EQU   CTGREASN+1                                               13725000
CTGREAS1 EQU   CTGREASN                                                 13726000
CTGMODID EQU   CTGPROB                                                  13727000
FDTVERB  EQU   FDTTBL                                                   13728000
GDTPSB   EQU   GDTTBL+184                                               13729000
GDTUPT   EQU   GDTTBL+180                                               13730000
GDTCMB   EQU   GDTTBL+176                                               13731000
GDTSPR   EQU   GDTTBL+168                                               13732000
@NM00001 EQU   GDTTBL+160                                               13733000
GDTABH   EQU   GDTTBL+156                                               13734000
GDTABT   EQU   GDTTBL+152                                               13735000
GDTTOH   EQU   GDTTBL+120                                               13736000
GDTRIP   EQU   GDTTBL+116                                               13737000
GDTIOH   EQU   GDTTBL+36                                                13738000
GDTSAH   EQU   GDTTBL+32                                                13739000
GDTTPH   EQU   GDTTBL+28                                                13740000
GDTRIH   EQU   GDTTBL+24                                                13741000
GDTSTH   EQU   GDTTBL+20                                                13742000
GDTDBH   EQU   GDTTBL+16                                                13743000
GDTPRM   EQU   GDTTBL+4                                                 13744000
GDTHDR   EQU   GDTTBL                                                   13745000
@NM00060 EQU   @NM00059                                                 13746000
FDRESV   EQU   FDEVTYP+8                                                13747000
TEXRESV  EQU   TIMESTMP+2                                               13748000
TEXBASE  EQU   TEXFLG                                                   13749000
TEXASSOC EQU   TEXFLG                                                   13750000
TEXINHTG EQU   TEXFLG                                                   13751000
TEXUNIQ  EQU   TEXFLG                                                   13752000
DICTNM   EQU   DICT                                                     13753000
ASSRECNM EQU   HEADER+6                                                 13754000
@NM00053 EQU   RCDSECF                                                  13755000
FUSERVAL EQU   FUSERARE+2                                               13756000
FIELDCT  EQU   FIELDVR+2                                                13757000
FIELDLN  EQU   FIELDVR                                                  13758000
FDSNTUSE EQU   FDSATTR+1                                                13759000
@NM00052 EQU   FDSATTR+1                                                13760000
FDSTROVF EQU   FDSATTR                                                  13761000
FDSSHARE EQU   FDSATTR                                                  13762000
FDSERASE EQU   FDSATTR                                                  13763000
FDSRELSE EQU   FDSATTR                                                  13764000
FDSSPEED EQU   FDSATTR                                                  13765000
AMDEXCP  EQU   AMDSTAT+44                                               13766000
AMDNCAS  EQU   AMDSTAT+40                                               13767000
AMDNCIS  EQU   AMDSTAT+36                                               13768000
AMDASPA  EQU   AMDSTAT+32                                               13769000
AMDRETR  EQU   AMDSTAT+28                                               13770000
AMDUPR   EQU   AMDSTAT+24                                               13771000
AMDIREC  EQU   AMDSTAT+20                                               13772000
AMDDELR  EQU   AMDSTAT+16                                               13773000
AMDNLR   EQU   AMDSTAT+12                                               13774000
AMDNEXT  EQU   AMDSTAT+10                                               13775000
AMDNIL   EQU   AMDSTAT+8                                                13776000
AMDSTSP  EQU   AMDSTAT                                                  13777000
@NM00043 EQU   IDAAMDSB+41                                              13778000
@NM00042 EQU   AMDATTR3                                                 13779000
AMDLM    EQU   AMDATTR3                                                 13780000
AMDWAIT  EQU   AMDATTR3                                                 13781000
AMDBIND  EQU   AMDATTR3                                                 13782000
AMDFAULT EQU   AMDATTR3                                                 13783000
AMDUNQ   EQU   AMDATTR3                                                 13784000
AMDPARDB EQU   IDAAMDSB+36                                              13785000
AMDMAXRR EQU   AMDSSRBA                                                 13786000
AMDNSLOT EQU   AMDHLRBA                                                 13787000
AMDFSCI  EQU   IDAAMDSB+16                                              13788000
AMDFSCA  EQU   IDAAMDSB+14                                              13789000
AMDCIPCA EQU   IDAAMDSB+12                                              13790000
AMDSPAN  EQU   AMDATTR                                                  13791000
AMDRANGE EQU   AMDATTR                                                  13792000
AMDREPL  EQU   AMDATTR                                                  13793000
AMDSDT   EQU   AMDATTR                                                  13794000
AMDWCK   EQU   AMDATTR                                                  13795000
AMDDST   EQU   AMDATTR                                                  13796000
AMDSBID  EQU   IDAAMDSB                                                 13797000
CTGFVCPP EQU   CTGFVPWD                                                 13798000
CTGFVFSN EQU   CTGFVAMD                                                 13799000
CTGFVTTR EQU   CTGFVSPC                                                 13800000
@NM00041 EQU   CTGFV+3                                                  13801000
CTGFVELM EQU   CTGFV+2                                                  13802000
@NM00040 EQU   CTGFVPRO                                                 13803000
CTGFVROF EQU   CTGFVPRO                                                 13804000
CTGFVDRC EQU   CTGFVPRO                                                 13805000
CTGFVNDC EQU   CTGFVPRO                                                 13806000
CTGFVRVL EQU   CTGFVPRO                                                 13807000
CTGFVAVL EQU   CTGFVPRO                                                 13808000
CTGFLDTS EQU   CTGFLDRE                                                 13809000
@NM00039 EQU   CTGFLDRE                                                 13810000
CTGFLDGC EQU   CTGFL+2                                                  13811000
@NM00037 EQU   CTGFBFLG                                                 13812000
CTGNGDSN EQU   CTGFBFLG                                                 13813000
CTGGDGB  EQU   CTGFBFLG                                                 13814000
CTGKEEP  EQU   CTGFBFLG                                                 13815000
CTGPAR   EQU   CTGFBFLG                                                 13816000
CTGFDBK  EQU   CTGNEWNM                                                 13817000
@NM00036 EQU   CTGDSORG                                                 13818000
CTGCVOL  EQU   CTGCAT                                                   13819000
@NM00035 EQU   CTGOPTN4                                                 13820000
CTGTIOT  EQU   CTGOPTN4                                                 13821000
CTGBYPMT EQU   CTGOPTN4                                                 13822000
CTGCOIN  EQU   CTGOPTN4                                                 13823000
CTGDOCAT EQU   CTGOPTN4                                                 13824000
CTGLBASE EQU   CTGOPTN4                                                 13825000
CTGSRH   EQU   CTGOPTN3                                                 13826000
CTGGDGL  EQU   CTGOPTN3                                                 13827000
CTGSUPLT EQU   CTGOPTN3                                                 13828000
@NM00034 EQU   CTGOPTN2                                                 13829000
CTGSCR   EQU   CTGOPTN2                                                 13830000
CTGDISC  EQU   CTGOPTN2                                                 13831000
CTGGTNXT EQU   CTGOPTN2                                                 13832000
CTGSWAP  EQU   CTGRCATN                                                 13833000
CTGGTALL EQU   CTGREL                                                   13834000
CTGNSVS  EQU   CTGEXT                                                   13835000
CTGGENLD EQU   CTGOPTN1                                                 13836000
CTGREAD  EQU   CTGOPTN1                                                 13837000
CTGUPD   EQU   CTGOPTN1                                                 13838000
CTGCI    EQU   CTGOPTN1                                                 13839000
CTGMAST  EQU   CTGOPTN1                                                 13840000
CATLEN   EQU   CAT+20                                                   13841000
CATMEM   EQU   CAT+12                                                   13842000
CATMLN   EQU   CAT+11                                                   13843000
CATFUQ   EQU   CATFLG                                                   13844000
CATPOS   EQU   CAT+9                                                    13845000
PDEVLEN  EQU   PDEV                                                     13846000
INDDLEN  EQU   INDD+9                                                   13847000
INDDPAS  EQU   INDD+1                                                   13848000
INDDPLN  EQU   INDD                                                     13849000
DEVTLEN  EQU   @NM00033                                                 13850000
LISTVLEN EQU   @NM00032                                                 13851000
OBJFLLEN EQU   OBJFL                                                    13852000
NEWNMLEN EQU   NEWNM+20                                                 13853000
NEWNMMEM EQU   NEWNM+12                                                 13854000
NEWNMMLN EQU   NEWNM+11                                                 13855000
NEWNMFUQ EQU   NEWNMFLG                                                 13856000
NEWNMPOS EQU   NEWNM+9                                                  13857000
NEWNMPAS EQU   NEWNM+1                                                  13858000
NEWNMPLN EQU   NEWNM                                                    13859000
OBJNMLEN EQU   OBJNM+20                                                 13860000
OBJNMMEM EQU   OBJNM+12                                                 13861000
OBJNMMLN EQU   OBJNM+11                                                 13862000
OBJNMFUQ EQU   OBJNMFLG                                                 13863000
OBJNMPOS EQU   OBJNM+9                                                  13864000
OBJNMPAS EQU   OBJNM+1                                                  13865000
OBJNMPLN EQU   OBJNM                                                    13866000
OUTDSMEM EQU   OUTDS+12                                                 13867000
OUTDSMLN EQU   OUTDS+11                                                 13868000
OUTDSPOS EQU   OUTDS+9                                                  13869000
OUTDDLEN EQU   OUTDD+9                                                  13870000
INDSMEM  EQU   INDS+12                                                  13871000
INDSMLN  EQU   INDS+11                                                  13872000
INDSPOS  EQU   INDS+9                                                   13873000
@NM00031 EQU   DMPARY+15                                                13874000
DMPARYTP EQU   DMPARY+14                                                13875000
DMPARYEX EQU   DMPARY+12                                                13876000
DMPARYIC EQU   DMPARY+10                                                13877000
DMPARYSZ EQU   DMPARY+8                                                 13878000
DMPARYNM EQU   DMPARY                                                   13879000
@NM00030 EQU   DMPITM+15                                                13880000
DMPITMTP EQU   DMPITM+14                                                13881000
DMPITMLN EQU   DMPITM+12                                                13882000
DMPITMPT EQU   DMPITM+8                                                 13883000
DMPITMNM EQU   DMPITM                                                   13884000
@NM00029 EQU   ERCNVTAB+24                                              13885000
ERDARBPT EQU   ERCPLPT                                                  13886000
ERDYNRC  EQU   ERCATRC                                                  13887000
@NM00028 EQU   ERCNVTAB+4                                               13888000
@NM00027 EQU   ERCNVTAB+3                                               13889000
@NM00026 EQU   EROSOPER                                                 13890000
EROSUCDX EQU   EROSOPER                                                 13891000
EROSCATL EQU   EROSOPER                                                 13892000
@NM00025 EQU   EROPER                                                   13893000
@NM00024 EQU   ERTYPE                                                   13894000
ERDYNAL  EQU   ERTYPE                                                   13895000
EROSCAT  EQU   ERTYPE                                                   13896000
@NM00023 EQU   FMTCNVF+1                                                13897000
FMTAR    EQU   FMTCNVF+1                                                13898000
FMTBS    EQU   FMTCNVF+1                                                13899000
FMTSS    EQU   FMTCNVF+1                                                13900000
FMTAL    EQU   FMTCNVF+1                                                13901000
FMTZS    EQU   FMTCNVF+1                                                13902000
@NM00022 EQU   FMTCNVF                                                  13903000
FMTPU    EQU   FMTCNVF                                                  13904000
FMTBD    EQU   FMTCNVF                                                  13905000
FMTBHD   EQU   FMTCNVF                                                  13906000
FMTBHA   EQU   FMTCNVF                                                  13907000
FMTBH    EQU   FMTCNVF                                                  13908000
FMTOLEN  EQU   FMTLIST+8                                                13909000
FMTRIO   EQU   FMTOCOL                                                  13910000
FMTSPT   EQU   FMTSTO                                                   13911000
FMTSTL   EQU   FMTILEN                                                  13912000
@NM00021 EQU   FMTFLGS+1                                                13913000
FMTSMSG  EQU   FMTFLGS+1                                                13914000
FMTHDF   EQU   FMTFLGS                                                  13915000
FMTDFF   EQU   FMTFLGS                                                  13916000
FMTSTF   EQU   FMTFLGS                                                  13917000
FMTREPF  EQU   FMTFLGS                                                  13918000
FMTBDF   EQU   FMTFLGS                                                  13919000
FMTIDF   EQU   FMTFLGS                                                  13920000
FMTSCF   EQU   FMTFLGS                                                  13921000
FMTEOLF  EQU   FMTFLGS                                                  13922000
DARGREP  EQU   DARGINS                                                  13923000
@NM00020 EQU   DARGFLGS                                                 13924000
DARGFULL EQU   DARGFLGS                                                 13925000
DARGIND  EQU   DARGLIST+18                                              13926000
DARGRETL EQU   DARGLIST+16                                              13927000
DARGRETP EQU   DARGLIST+4                                               13928000
UVOLVOL  EQU   UVOLENT+4                                                13929000
UVOLDEV  EQU   UVOLENT                                                  13930000
UVOLCNT  EQU   UVOLLIST                                                 13931000
@NM00019 EQU   IOINFOPT                                                 13932000
IOINFLUB EQU   IOINFOPT                                                 13933000
IOINFTMS EQU   IOINFOPT                                                 13934000
IOINFSUP EQU   IOINFOPT                                                 13935000
IOINFDSN EQU   IOINFOPT                                                 13936000
IOINFVOL EQU   IOINFOPT                                                 13937000
IOINFDVT EQU   IOINFOPT                                                 13938000
OPNVOL   EQU   OPNAGL+44                                                13939000
OPNSTRNO EQU   OPNAGL+43                                                13940000
@NM00018 EQU   OPNOPT2                                                  13941000
OPNOPTJM EQU   OPNOPT2                                                  13942000
OPNOPTNM EQU   OPNOPT2                                                  13943000
OPNOPTAS EQU   OPNOPT2                                                  13944000
@NM00017 EQU   OPNDSO                                                   13945000
OPNDSOPO EQU   OPNDSO                                                   13946000
OPNDSOIS EQU   OPNDSO                                                   13947000
OPNDSOPS EQU   OPNDSO                                                   13948000
OPNDSOAM EQU   OPNDSO                                                   13949000
OPNKYL   EQU   OPNAGL+40                                                13950000
OPNDEVIX EQU   OPNDEV+4                                                 13951000
OPNCBP   EQU   OPNAGL+20                                                13952000
OPNMODRP EQU   OPNMOD                                                   13953000
OPNMODUB EQU   OPNMOD                                                   13954000
OPNMODRS EQU   OPNMOD                                                   13955000
OPNMODRR EQU   OPNMOD                                                   13956000
OPNMODRC EQU   OPNMOD                                                   13957000
OPNMODAC EQU   OPNMOD                                                   13958000
OPNMODPD EQU   OPNMOD                                                   13959000
OPNTYPSY EQU   OPNTYP                                                   13960000
OPNTYPRV EQU   OPNTYP                                                   13961000
OPNTYPEX EQU   OPNTYP                                                   13962000
OPNTYPRA EQU   OPNTYP                                                   13963000
OPNTYPCI EQU   OPNTYP                                                   13964000
OPNTYPSO EQU   OPNTYP                                                   13965000
OPNTYPSI EQU   OPNTYP                                                   13966000
@NM00016 EQU   OPNRFM                                                   13967000
OPNRFMUN EQU   OPNRFM                                                   13968000
OPNRFMVR EQU   OPNRFM                                                   13969000
OPNRFMFX EQU   OPNRFM                                                   13970000
OPNOPTSK EQU   OPNOPT                                                   13971000
OPNOPTDR EQU   OPNOPT                                                   13972000
OPNOPTCR EQU   OPNOPT                                                   13973000
OPNOPTKS EQU   OPNOPT                                                   13974000
OPNOPTBK EQU   OPNOPT                                                   13975000
OPNOPTUP EQU   OPNOPT                                                   13976000
IOCEXT   EQU   IOCSTR+64                                                13977000
IOCTSML  EQU   IOCREL+2                                                 13978000
IOCTPML  EQU   IOCREL                                                   13979000
IOCWORK  EQU   IOCSTR+56                                                13980000
IOCRRN   EQU   IOCSTR+52                                                13981000
IOCPNM   EQU   IOCNWM+2                                                 13982000
IOCPTL   EQU   IOCNWM                                                   13983000
IOCKYA   EQU   IOCMEM                                                   13984000
IOCVRC   EQU   IOCTTR                                                   13985000
IOCCBP   EQU   IOCSTR+36                                                13986000
IOCHURBA EQU   IOCSTR+28                                                13987000
IOCVOLSR EQU   IOCSTR+22                                                13988000
@NM00015 EQU   IOCMSG                                                   13989000
IOCMSGSM EQU   IOCMSG                                                   13990000
IOCMSGAE EQU   IOCMSG                                                   13991000
IOCMSGCE EQU   IOCMSG                                                   13992000
IOCMSGOE EQU   IOCMSG                                                   13993000
IOCMSGOP EQU   IOCMSG                                                   13994000
IOCCHPKG EQU   IOCMSG                                                   13995000
IOCCHPKE EQU   IOCMSG                                                   13996000
IOCCHPNU EQU   IOCCHP                                                   13997000
IOCCHPUP EQU   IOCCHP                                                   13998000
IOCCHPBK EQU   IOCCHP                                                   13999000
IOCCHPCR EQU   IOCCHP                                                   14000000
IOCCHPKS EQU   IOCCHP                                                   14001000
IOCCHPSK EQU   IOCCHP                                                   14002000
IOCCHPDR EQU   IOCCHP                                                   14003000
IOCCHPSQ EQU   IOCCHP                                                   14004000
IOCMACNT EQU   IOCMAC2                                                  14005000
IOCMACER EQU   IOCMAC2                                                  14006000
IOCMACPA EQU   IOCMAC2                                                  14007000
IOCMACEN EQU   IOCMAC2                                                  14008000
IOCMACCP EQU   IOCMAC2                                                  14009000
IOCMACRR EQU   IOCMAC2                                                  14010000
IOCMACAS EQU   IOCMAC2                                                  14011000
IOCMACSK EQU   IOCMAC2                                                  14012000
@NM00014 EQU   IOCMAC                                                   14013000
IOCMACCC EQU   IOCMAC                                                   14014000
IOCMACDR EQU   IOCMAC                                                   14015000
IOCMACBK EQU   IOCMAC                                                   14016000
IOCMACCR EQU   IOCMAC                                                   14017000
IOCMACUP EQU   IOCMAC                                                   14018000
IOCMACOT EQU   IOCMAC                                                   14019000
IOCMACIN EQU   IOCMAC                                                   14020000
@NM00013 EQU   IOCRFM                                                   14021000
IOCRFMBK EQU   IOCRFM                                                   14022000
IOCRFMSF EQU   IOCRFM                                                   14023000
IOCRFMUN EQU   IOCRFM                                                   14024000
IOCRFMVR EQU   IOCRFM                                                   14025000
IOCRFMFX EQU   IOCRFM                                                   14026000
@NM00012 EQU   IOCDSO                                                   14027000
IOCDSOPO EQU   IOCDSO                                                   14028000
IOCDSOIS EQU   IOCDSO                                                   14029000
IOCDSOPS EQU   IOCDSO                                                   14030000
IOCDSOAM EQU   IOCDSO                                                   14031000
IOCRKP   EQU   IOCSTR+13                                                14032000
IOCKYL   EQU   IOCSTR+12                                                14033000
IOCTRN   EQU   IOCSTR+8                                                 14034000
UNITVTOC EQU   UNITABL+7                                                14035000
@NM00011 EQU   UNITSTAT                                                 14036000
UNITUSHR EQU   UNITSTAT                                                 14037000
UNITXSHR EQU   UNITSTAT                                                 14038000
UNITISHR EQU   UNITSTAT                                                 14039000
UNITUA   EQU   @NM00010+1                                               14040000
UNITCHA  EQU   @NM00010                                                 14041000
UNITUCB  EQU   UNITABL                                                  14042000
ALLUNCNT EQU   ALLAGL+30                                                14043000
ALLVLCNT EQU   ALLAGL+29                                                14044000
@NM00009 EQU   ALLOPT                                                   14045000
ALLOPTUN EQU   ALLOPT                                                   14046000
ALLOPTPV EQU   ALLOPT                                                   14047000
@NM00008 EQU   ALLORG+1                                                 14048000
ALLORGVS EQU   ALLORG+1                                                 14049000
@NM00007 EQU   ALLORG+1                                                 14050000
ALLORGGS EQU   ALLORG+1                                                 14051000
ALLORGUN EQU   ALLORG                                                   14052000
ALLORGPO EQU   ALLORG                                                   14053000
ALLORGMQ EQU   ALLORG                                                   14054000
ALLORGCQ EQU   ALLORG                                                   14055000
ALLORGCX EQU   ALLORG                                                   14056000
ALLORGDA EQU   ALLORG                                                   14057000
ALLORGPS EQU   ALLORG                                                   14058000
ALLORGIS EQU   ALLORG                                                   14059000
ALLDSPUN EQU   ALLDSP                                                   14060000
ALLDSPCG EQU   ALLDSP                                                   14061000
ALLDSPDE EQU   ALLDSP                                                   14062000
@NM00006 EQU   ALLDSP                                                   14063000
ALLSTSMD EQU   ALLSTS                                                   14064000
ALLSTSNW EQU   ALLSTS                                                   14065000
ALLSTSSR EQU   ALLSTS                                                   14066000
@NM00005 EQU   ALLSTS                                                   14067000
CIRPID   EQU   CIRAGL+28                                                14068000
CIRPWD   EQU   CIRAGL+24                                                14069000
CIRCAT   EQU   CIRAGL+20                                                14070000
CIRWKP   EQU   CIRAGL+16                                                14071000
CIRTLR   EQU   CIRAGL+12                                                14072000
CIRHDR   EQU   CIRAGL+8                                                 14073000
CIRTLN   EQU   CIRAGL+6                                                 14074000
CIRHLN   EQU   CIRAGL+4                                                 14075000
@NM00004 EQU   CIRAGL+1                                                 14076000
@NM00003 EQU   CIRTYPE                                                  14077000
CIRTYPAQ EQU   CIRTYPE                                                  14078000
CIRTYP1Q EQU   CIRTYPE                                                  14079000
NEWID1   EQU   TRACE1+95                                                14080000
CALLID   EQU   OLDERID1+90                                              14081000
@NM00002 EQU   OLDERID1                                                 14082000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      14083000
@RF00578 EQU   @RC00575                                                 14084000
@RF00617 EQU   @RC00613                                                 14085000
@RF00632 EQU   @RC00628                                                 14086000
@RF00721 EQU   @RC00699                                                 14087000
@RF00724 EQU   @RC00699                                                 14088000
@RF00765 EQU   @RC00743                                                 14089000
@RF00768 EQU   @RC00743                                                 14090000
@RC01174 EQU   @RC01173                                                 14091000
@RF01268 EQU   @RC01250                                                 14092000
@RF01620 EQU   @RC01580                                                 14093000
@RF01619 EQU   @RC01580                                                 14094000
@RF01626 EQU   @RC01580                                                 14095000
@RC01730 EQU   @RC01727                                                 14096000
@RF01898 EQU   @RC01896                                                 14097000
@RC02162 EQU   @RC02127                                                 14098000
@RF02426 EQU   @RC02393                                                 14099000
@PB00020 EQU   @EL00001                                                 14100000
@PB00019 EQU   @PB00020                                                 14101000
@PB00018 EQU   @PB00019                                                 14102000
@PB00017 EQU   @PB00018                                                 14103000
@PB00016 EQU   @PB00017                                                 14104000
@PB00015 EQU   @PB00016                                                 14105000
@PB00014 EQU   @PB00015                                                 14106000
@PB00013 EQU   @PB00014                                                 14107000
@PB00012 EQU   @PB00013                                                 14108000
@PB00011 EQU   @PB00012                                                 14109000
@PB00010 EQU   @PB00011                                                 14110000
@PB00009 EQU   @PB00010                                                 14111000
@PB00008 EQU   @PB00009                                                 14112000
@PB00007 EQU   @PB00008                                                 14113000
@PB00006 EQU   @PB00007                                                 14114000
@PB00005 EQU   @PB00006                                                 14115000
@PB00004 EQU   @PB00005                                                 14116000
@PB00003 EQU   @PB00004                                                 14117000
@PB00002 EQU   @PB00003                                                 14118000
@ENDDATA EQU   *                                                        14119000
         END   IDCMP01,(C'PLS1441',0701,78177)                          14120000
