         TITLE '******** IDCMV01: MODIFYV FSR ********                 *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCMV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCMV01   76.349'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @08,0                                               0002 00021000
@PSTART  LA    @09,4095(,@08)                                      0002 00022000
         LA    @10,4095(,@09)                                      0002 00023000
         LA    @12,4095(,@10)                                      0002 00024000
         USING @PSTART,@08                                         0002 00025000
         USING @PSTART+4095,@09                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @11,@01                                             0002 00031000
         USING @DATD,@11                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @11,8(,@13)                                         0002 00035000
         LR    @13,@11                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0313 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* THIS IS THE MAIN ROUTINE. IT ENQUEUES ON THE          @Y30LB33*/ 00041000
*   /* VOLUME AND CALLS THE INPUT CHECKING                   @Y30LB33*/ 00042000
*   /* FUNCTION. IF THE CHECKING FUNCTION FINDS NO           @Y30LB33*/ 00043000
*   /* ERRORS, IT CALLS THE MODIFICATION ROUTINE             @Y30LB33*/ 00044000
*   /* THAT UPDATES THE VOLUME. IT THEN DEQUEUES             @Y30LB33*/ 00045000
*   /* ON THE VOLUME, PRINTS THE FINAL COMPLETION            @Y30LB33*/ 00046000
*   /* MESSAGE ACCORDING TO THE VALUE OF LASTCOND            @Y30LB33*/ 00047000
*   /* AND RETURNS WITH A RETURN CODE IN LASTCOND            @Y30LB33*/ 00048000
*   /*                                                               */ 00049000
*   /*****************************************************************/ 00050000
*                                                                  0313 00051000
*   OLDERID2=NEWERID2;                                             0313 00052000
         L     @15,@PC00001                                        0313 00053000
         L     @14,GDTTR2(,@15)                                    0313 00054000
         MVC   @TS00001(95),NEWERID2(@14)                          0313 00055000
         MVC   OLDERID2(95,@14),@TS00001                           0313 00056000
*   NEWID2='MVAA';                  /*                       @Y30LB33*/ 00057000
         MVC   NEWID2(4,@14),@CC01637                              0314 00058000
*   IF GDTDBG=NULLPTR THEN                                         0315 00059000
         L     @15,GDTDBG(,@15)                                    0315 00060000
         LTR   @15,@15                                             0315 00061000
         BZ    @RT00315                                            0315 00062000
*     ;                                                            0316 00063000
*   ELSE                                                           0317 00064000
*     CALL IDCDB010(GDTTBL,'MVAA'); /*                       @Y30LB33*/ 00065000
*                                                                  0317 00066000
         L     @15,@PC00001                                        0317 00067000
         ST    @15,@AL00001                                        0317 00068000
         LA    @14,@CC01637                                        0317 00069000
         ST    @14,@AL00001+4                                      0317 00070000
         MVI   @AL00001+4,X'80'                                    0317 00071000
         L     @15,GDTDBG(,@15)                                    0317 00072000
         LA    @01,@AL00001                                        0317 00073000
         BALR  @14,@15                                             0317 00074000
*   /*****************************************************************/ 00075000
*   /*                                                               */ 00076000
*   /* FIRST, INITIALIZE POINTERS                            @Y30LB33*/ 00077000
*   /*                                                               */ 00078000
*   /*****************************************************************/ 00079000
*                                                                  0318 00080000
*   DUMPADDR=ADDR(DUMPAREA);        /*                       @Y30LB33*/ 00081000
@RT00315 LA    @07,DUMPAREA                                        0318 00082000
         ST    @07,DUMPADDR                                        0318 00083000
*   DDSTRU=ADDR(MVDRGLST);          /*                       @Y30LB33*/ 00084000
         LA    @07,MVDRGLST                                        0319 00085000
         ST    @07,DDSTRU                                          0319 00086000
*   BASEVPTR=ADDR(VOLRCDBF);        /*                       @Y30LB33*/ 00087000
         LA    BASEVPTR,VOLRCDBF                                   0320 00088000
*   GROUPPTR=ADDR(GRPRCDBF);        /*                       @Y30LB33*/ 00089000
         LA    GROUPPTR,GRPRCDBF                                   0321 00090000
*   RVVIPTR=ADDR(MVRVVI);           /*                       @Y30LB33*/ 00091000
         LA    @07,MVRVVI                                          0322 00092000
         ST    @07,RVVIPTR                                         0322 00093000
*   DEFVEPTR=ADDR(MVDEFVE);         /*                       @Y30LB33*/ 00094000
         LA    DEFVEPTR,MVDEFVE                                    0323 00095000
*   OPNPTR=ADDR(MVOPNAGL);          /*                       @Y30LB33*/ 00096000
         LA    OPNPTR,MVOPNAGL                                     0324 00097000
*   DEFVPTR=ADDR(MVDEFLST);         /*                       @Y30LB33*/ 00098000
         LA    @07,MVDEFLST                                        0325 00099000
         ST    @07,DEFVPTR                                         0325 00100000
*   MVRPTR=ADDR(MVMVRLST);          /*                       @Y30LB33*/ 00101000
         LA    @07,MVMVRLST                                        0326 00102000
         ST    @07,MVRPTR                                          0326 00103000
*   MVUCBPTR=NULLPTR;               /*                       @Y30LB33*/ 00104000
         SLR   @07,@07                                             0327 00105000
         ST    @07,MVUCBPTR                                        0327 00106000
*   IOCTLBKP=NULLPTR;               /*                       @ZDR2057*/ 00107000
*                                                                  0328 00108000
         ST    @07,IOCTLBKP                                        0328 00109000
*   /*****************************************************************/ 00110000
*   /*                                                               */ 00111000
*   /* CLEAR THE BIT SWITCHES AND FLAG HOLDER                @Y30LB33*/ 00112000
*   /*                                                               */ 00113000
*   /*****************************************************************/ 00114000
*                                                                  0329 00115000
*   SWCHBITS=SWCHBITS&&SWCHBITS;    /*                       @Y30LB33*/ 00116000
         XC    SWCHBITS(2),SWCHBITS                                0329 00117000
*   MYVVFLG=MYVVFLG&&MYVVFLG;       /*                       @Y30LB33*/ 00118000
*                                                                  0330 00119000
         XC    MYVVFLG(1),MYVVFLG                                  0330 00120000
*   /*****************************************************************/ 00121000
*   /*                                                               */ 00122000
*   /* INITIALIZE THE ENQUEUE ARGUMENT LIST                  @Y30LB33*/ 00123000
*   /*                                                               */ 00124000
*   /*****************************************************************/ 00125000
*                                                                  0331 00126000
*   MVMAJNAM=MVMAJCON;              /*                       @Y30LB33*/ 00127000
         MVC   MVMAJNAM(8),@CC01584                                0331 00128000
*   MINAMLN=LENGTH(MVMINNAM)-1;     /*                       @Y30LB33*/ 00129000
         MVI   MINAMLN,X'16'                                       0332 00130000
*   MINAMQL=MINQLE;                 /*                       @Y30LB33*/ 00131000
         MVC   MINAMQL(16),@CC01586                                0333 00132000
*   MINAMVOL=VOLVAL;                /*                       @Y30LB33*/ 00133000
*                                                                  0334 00134000
         L     @15,@PC00001+4                                      0334 00135000
         L     @01,FDTPTR(,@15)                                    0334 00136000
         MVC   MINAMVOL(6),VOLVAL(@01)                             0334 00137000
*   /*****************************************************************/ 00138000
*   /*                                                               */ 00139000
*   /* IF THE FILE PARAMETER IS PRESENT, PUT THE             @Y30LB33*/ 00140000
*   /* DDNAME GIVEN INTO THE HOLD AREA                       @Y30LB33*/ 00141000
*   /*                                                               */ 00142000
*   /*****************************************************************/ 00143000
*                                                                  0335 00144000
*   IF ADDR(FYLE)>0 THEN                                           0335 00145000
         L     @15,FDTPTR+88(,@15)                                 0335 00146000
         CR    @15,@07                                             0335 00147000
         BNH   @RF00335                                            0335 00148000
*     MVDDNAME=FYLEVAL;             /*                       @Y30LB33*/ 00149000
*                                                                  0336 00150000
         MVC   MVDDNAME(8),FYLEVAL(@15)                            0336 00151000
*   /*****************************************************************/ 00152000
*   /*                                                               */ 00153000
*   /* IF THE NEWSERIAL IS GIVEN, PUT ITS VALUE              @Y30LB33*/ 00154000
*   /* INTO THE VOLUME SERIAL HOLD AREA. OTHERWISE           @Y30LB33*/ 00155000
*   /* PUT IN THE VOLUME PARAMETER VALUE                     @Y30LB33*/ 00156000
*   /*                                                               */ 00157000
*   /*****************************************************************/ 00158000
*                                                                  0337 00159000
*   IF ADDR(NEWSR)>0 THEN                                          0337 00160000
@RF00335 L     @07,@PC00001+4                                      0337 00161000
         L     @07,FDTPTR+4(,@07)                                  0337 00162000
         LTR   @07,@07                                             0337 00163000
         BNP   @RF00337                                            0337 00164000
*     MVVOLUME=NEWSRVAL;            /*                       @Y30LB33*/ 00165000
         MVC   MVVOLUME(6),NEWSRVAL(@07)                           0338 00166000
*   ELSE                                                           0339 00167000
*     MVVOLUME=VOLVAL;              /*                       @Y30LB33*/ 00168000
         B     @RC00337                                            0339 00169000
@RF00337 L     @07,@PC00001+4                                      0339 00170000
         L     @07,FDTPTR(,@07)                                    0339 00171000
         MVC   MVVOLUME(6),VOLVAL(@07)                             0339 00172000
*                                                                  0340 00173000
*   /*****************************************************************/ 00174000
*   /*                                                               */ 00175000
*   /* ENQUEUE ON THE VOLUME SERIAL                          @Y30LB33*/ 00176000
*   /*                                                               */ 00177000
*   /*****************************************************************/ 00178000
*                                                                  0340 00179000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MVMAJNAM,MVMINNAM);/*     @Y30LB33*/ 00180000
*                                                                  0340 00181000
@RC00337 L     @07,@PC00001                                        0340 00182000
         ST    @07,@AL00001                                        0340 00183000
         LA    @15,EXCL                                            0340 00184000
         ST    @15,@AL00001+4                                      0340 00185000
         LA    @15,WAIT                                            0340 00186000
         ST    @15,@AL00001+8                                      0340 00187000
         LA    @15,MVMAJNAM                                        0340 00188000
         ST    @15,@AL00001+12                                     0340 00189000
         LA    @15,MVMINNAM                                        0340 00190000
         ST    @15,@AL00001+16                                     0340 00191000
         MVI   @AL00001+16,X'80'                                   0340 00192000
         L     @15,GDTENQ(,@07)                                    0340 00193000
         LA    @01,@AL00001                                        0340 00194000
         BALR  @14,@15                                             0340 00195000
*   /*****************************************************************/ 00196000
*   /*                                                               */ 00197000
*   /* CALL THE CHECKOUT ROUTINE TO ESTABLISH                @Y30LB33*/ 00198000
*   /* THE VALIDITY OF THE MODIFYV COMMAND                   @Y30LB33*/ 00199000
*   /*                                                               */ 00200000
*   /*****************************************************************/ 00201000
*                                                                  0341 00202000
*   CALL CHECKOUT;                  /*                       @Y30LB33*/ 00203000
*                                                                  0341 00204000
         BAL   @14,CHECKOUT                                        0341 00205000
*   /*****************************************************************/ 00206000
*   /*                                                               */ 00207000
*   /* IF LASTCOND IS NOT 12, CALL THE DOIT OR               @ZDR2057*/ 00208000
*   /* RBLABEL TO PERFORM THE VOLUME MODIFICATION            @ZDR2057*/ 00209000
*   /*                                                               */ 00210000
*   /*****************************************************************/ 00211000
*                                                                  0342 00212000
*   IF LASTCOND^=TERMCODE THEN      /*                       @ZDR2057*/ 00213000
         L     @07,@PC00001+8                                      0342 00214000
         CLC   LASTCOND(2,@07),@CH00038                            0342 00215000
         BE    @RF00342                                            0342 00216000
*     IF ADDR(RLBL)^=NULLPTR THEN                                  0343 00217000
         L     @07,@PC00001+4                                      0343 00218000
         L     @07,FDTPTR+100(,@07)                                0343 00219000
         LTR   @07,@07                                             0343 00220000
         BZ    @RF00343                                            0343 00221000
*       CALL RBLABEL;               /*                       @ZDR2057*/ 00222000
         BAL   @14,RBLABEL                                         0344 00223000
*     ELSE                                                         0345 00224000
*       CALL DOIT;                  /*                       @ZDR2057*/ 00225000
*                                                                  0345 00226000
         B     @RC00343                                            0345 00227000
@RF00343 BAL   @14,DOIT                                            0345 00228000
*   /*****************************************************************/ 00229000
*   /*                                                               */ 00230000
*   /* ISSUE A DEQUEUE AGAINST THE VOLUME MODIFIED           @Y30LB33*/ 00231000
*   /*                                                               */ 00232000
*   /*****************************************************************/ 00233000
*                                                                  0346 00234000
*   MINAMLN=LENGTH(MVMINNAM)-1;     /*                       @Y30LB33*/ 00235000
@RC00343 DS    0H                                                  0346 00236000
@RF00342 MVI   MINAMLN,X'16'                                       0346 00237000
*   MINAMVOL=VOLVAL;                /*                       @Y30LB33*/ 00238000
         L     @15,@PC00001+4                                      0347 00239000
         L     @01,FDTPTR(,@15)                                    0347 00240000
         MVC   MINAMVOL(6),VOLVAL(@01)                             0347 00241000
*   MINAMQL=MINQLE;                 /*                       @Y30LB33*/ 00242000
         MVC   MINAMQL(16),@CC01586                                0348 00243000
*   CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*               @Y30LB33*/ 00244000
         L     @15,@PC00001                                        0349 00245000
         ST    @15,@AL00001                                        0349 00246000
         LA    @14,MVMAJNAM                                        0349 00247000
         ST    @14,@AL00001+4                                      0349 00248000
         LA    @14,MVMINNAM                                        0349 00249000
         ST    @14,@AL00001+8                                      0349 00250000
         MVI   @AL00001+8,X'80'                                    0349 00251000
         L     @15,GDTDEQ(,@15)                                    0349 00252000
         LA    @01,@AL00001                                        0349 00253000
         BALR  @14,@15                                             0349 00254000
*                                                                  0350 00255000
*   /*****************************************************************/ 00256000
*   /*                                                               */ 00257000
*   /* ISSUE PRINT FOR MESSAGES IDC0001I OR IDC3003I         @Y30LB33*/ 00258000
*   /* TO INDICATE THE FINAL COMPLETION STATUS AND           @Y30LB33*/ 00259000
*   /* RETURN TO THE EXECUTIVE                               @Y30LB33*/ 00260000
*   /*                                                               */ 00261000
*   /*****************************************************************/ 00262000
*                                                                  0350 00263000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 00264000
         L     @15,DDSTRU                                          0350 00265000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0350 00266000
*   DARGSMOD=MODUNIV;               /*                       @Y30LB33*/ 00267000
         MVC   DARGSMOD(3,@15),MODUNIV                             0351 00268000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB33*/ 00269000
         L     @14,@PC00001+8                                      0352 00270000
         ST    @14,DARGDBP(,@15)                                   0352 00271000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB33*/ 00272000
         MVC   DARGILP(2,@15),@CH00156                             0353 00273000
*   IF LASTCOND<LASTCC12 THEN                                      0354 00274000
         LH    @14,LASTCOND(,@14)                                  0354 00275000
         C     @14,@CF00038                                        0354 00276000
         BNL   @RF00354                                            0354 00277000
*     DARGSENT=MSG0001I;            /*                       @Y30LB33*/ 00278000
         MVI   DARGSENT(@15),X'01'                                 0355 00279000
*   ELSE                                                           0356 00280000
*     DARGSENT=MSG3003I;            /*                       @Y30LB33*/ 00281000
         B     @RC00354                                            0356 00282000
@RF00354 L     @01,DDSTRU                                          0356 00283000
         MVI   DARGSENT(@01),X'03'                                 0356 00284000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/ 00285000
@RC00354 L     @15,@PC00001                                        0357 00286000
         ST    @15,@AL00001                                        0357 00287000
         LA    @14,@CF00117                                        0357 00288000
         ST    @14,@AL00001+4                                      0357 00289000
         LA    @14,DDSTRU                                          0357 00290000
         ST    @14,@AL00001+8                                      0357 00291000
         MVI   @AL00001+8,X'80'                                    0357 00292000
         L     @15,GDTPRT(,@15)                                    0357 00293000
         LA    @01,@AL00001                                        0357 00294000
         BALR  @14,@15                                             0357 00295000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0358 00296000
*                                                                  0358 00297000
         L     @15,@PC00001                                        0358 00298000
         ST    @15,@AL00001                                        0358 00299000
         LA    @14,MODID                                           0358 00300000
         ST    @14,@AL00001+4                                      0358 00301000
         L     @14,@PC00001+8                                      0358 00302000
         ST    @14,@AL00001+8                                      0358 00303000
         MVI   @AL00001+8,X'80'                                    0358 00304000
         L     @15,GDTEPL(,@15)                                    0358 00305000
         LA    @01,@AL00001                                        0358 00306000
         BALR  @14,@15                                             0358 00307000
*   /*****************************************************************/ 00308000
*   /*                                                               */ 00309000
*   /*                                                       @Y30LB33*/ 00310000
*   /*                                                               */ 00311000
*   /*****************************************************************/ 00312000
*                                                                  0359 00313000
*                                                                  0359 00314000
*/********************************************************   @Y30LB33*/ 00315000
*/* PROCEDURE NAME - CHECKOUT                                @Y30LB33*/ 00316000
*/*                                                          @Y30LB33*/ 00317000
*/* FUNCTION - CALLS OTHER ROUTINES TO ESTABLISH THE         @Y30LB33*/ 00318000
*/*      VALIDITY OF THE MODIFYV REQUEST. IT ENSURES THAT    @Y30LB33*/ 00319000
*/*      THE VOLUME IS AVAILABLE FOR MODIFICATION AND THAT   @Y30LB33*/ 00320000
*/*      THE MODIFICATIONS ARE NOT CONFLICTING EITHER WITH   @Y30LB33*/ 00321000
*/*      THEMSELVES OR WITH EXISTING CHARACTERISTICS OF THE  @Y30LB33*/ 00322000
*/*      VOLUME. IT ISSUES MESSAGE IDC3090I IF THE VOLUME    @Y30LB33*/ 00323000
*/*      CHANGES CAN NOT BE MADE BECAUSE THE VOLUME HAS      @Y30LB33*/ 00324000
*/*      THE READONLY ATTRIBUTE.                             @Y30LB33*/ 00325000
*/*                                                          @Y30LB33*/ 00326000
*/*      MSG3090I IS ISSUED WHEN READONLY ATTRIBUTE DOES NOT @Y30LB33*/ 00327000
*/*      ALLOW UPDATING OF THE VOLUME LABEL AS REQUESTED     @Y30LB33*/ 00328000
*/*                                                          @Y30LB33*/ 00329000
*/*      MSG3692I IS ISSUED WHEN A VTOC HEAD ADDRESS         @ZDR2057*/ 00330000
*/*      GREATER THAN HEX 12 IS SPECIFIED FOR REBUILD        @ZDR2057*/ 00331000
*/*      A VOLUME LABEL.                                     @ZDR2057*/ 00332000
*/*                                                          @ZDR2057*/ 00333000
*/*      THIS ROUTINE CALLS THE PROCEDURES                   @Y30LB33*/ 00334000
*/*                                                          @Y30LB33*/ 00335000
*/*            VOLCK                                         @Y30LB33*/ 00336000
*/*            GRPPROC                                       @Y30LB33*/ 00337000
*/*                                                          @Y30LB33*/ 00338000
*/* INPUT - THE FDTTBL CONTAINING THE INPUT PARAMETERS FROM  @Y30LB33*/ 00339000
*/*      THE USER, AND THE SWCHBITS AREA                     @Y30LB33*/ 00340000
*/*                                                          @Y30LB33*/ 00341000
*/* OUTPUT - LASTCOND IS SET TO 12 TO INDICATE THAT          @Y30LB33*/ 00342000
*/*      THE VOLUME LABEL WAS REQUESTED TO BE CHANGED AND    @Y30LB33*/ 00343000
*/*      THAT THAT OPERATION CAN NOT BE PERFORMED BECAUSE    @Y30LB33*/ 00344000
*/*      EITHER THE VOLUME HAS THE READONLY ATTRIBUTE        @Y30LB33*/ 00345000
*/*      OR THE VOLUME IS NOT ALLOCATED WITH EXCLUSIVE       @Y30LB33*/ 00346000
*/*      CONTROL OR IS NOT A VIRTUAL VOLUME                  @Y30LB33*/ 00347000
*/*                                                          @Y30LB33*/ 00348000
*/*      SWCHBITS ARE SET TO INDICATE THE CONDITIONS FOR     @Y30LB33*/ 00349000
*/*      WHICH THEY ARE DEFINED. THOSE THAT ARE SET INCLUDE  @Y30LB33*/ 00350000
*/*                                                          @Y30LB33*/ 00351000
*/*            RENAMSW                                       @Y30LB33*/ 00352000
*/*            ATTRSW                                        @Y30LB33*/ 00353000
*/*            MSVCSW                                        @Y30LB33*/ 00354000
*/********************************************************   @Y30LB33*/ 00355000
*                                                                  0359 00356000
*CHECKOUT:                                                         0359 00357000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 00358000
@EL00001 L     @13,4(,@13)                                         0359 00359000
@EF00001 L     @00,@SIZDATD                                        0359 00360000
         LR    @01,@11                                             0359 00361000
         FREEMAIN R,LV=(0),A=(1)                                        00362000
@ER00001 LM    @14,@12,12(@13)                                     0359 00363000
         BR    @14                                                 0359 00364000
CHECKOUT DS    0H                                                  0360 00365000
*   DCL                                                            0360 00366000
*     CKOUTSV PTR(31);              /* SAVE AREA FOR REG 14  @Y30LB33*/ 00367000
*   CKOUTSV=REG14;                  /* SAVE RETURN ADDRESS   @Y30LB33*/ 00368000
         ST    REG14,CKOUTSV                                       0361 00369000
*   OLDERID2=NEWERID2;                                             0362 00370000
         L     @07,@PC00001                                        0362 00371000
         L     @07,GDTTR2(,@07)                                    0362 00372000
         MVC   @TS00001(95),NEWERID2(@07)                          0362 00373000
         MVC   OLDERID2(95,@07),@TS00001                           0362 00374000
*   NEWID2='MVBA';                  /*                       @Y30LB33*/ 00375000
*                                                                  0363 00376000
         MVC   NEWID2(4,@07),@CC01645                              0363 00377000
*   /*****************************************************************/ 00378000
*   /*                                                               */ 00379000
*   /* IF WE ARE CHANGING THE SERIAL OR THE OWNER,           @Y30LB33*/ 00380000
*   /* TURN ON THE RENAME SWITCH TO INDICATE RELABELING      @Y30LB33*/ 00381000
*   /*                                                               */ 00382000
*   /*****************************************************************/ 00383000
*                                                                  0364 00384000
*   IF ADDR(NEWSR)>0|ADDR(OWNER)>0| /*                       @Y30LB33*/ 00385000
*       ADDR(NOWN)>0 THEN           /*                       @Y30LB33*/ 00386000
         SLR   @07,@07                                             0364 00387000
         L     @15,@PC00001+4                                      0364 00388000
         C     @07,FDTPTR+4(,@15)                                  0364 00389000
         BL    @RT00364                                            0364 00390000
         C     @07,FDTPTR+8(,@15)                                  0364 00391000
         BL    @RT00364                                            0364 00392000
         C     @07,FDTPTR+72(,@15)                                 0364 00393000
         BNL   @RF00364                                            0364 00394000
@RT00364 DS    0H                                                  0365 00395000
*     RENAMSW=ON;                   /*                       @Y30LB33*/ 00396000
*                                                                  0365 00397000
         OI    RENAMSW,B'01000000'                                 0365 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* IF ANY ATTRIBUTES ARE BEING SET OR NULLIFIED,         @Y30LB33*/ 00401000
*   /* BY USER REQUEST, TURN ON THE ATTRIBUTE SWITCH         @Y30LB33*/ 00402000
*   /*                                                               */ 00403000
*   /*****************************************************************/ 00404000
*                                                                  0366 00405000
*   IF ADDR(BIND)>0|ADDR(NBIND)>0|  /*                       @Y30LB33*/ 00406000
*       ADDR(EXECL)>0|ADDR(SHRD)>0| /*                       @Y30LB33*/ 00407000
*       ADDR(RONLY)>0|ADDR(RW)>0|   /*                       @Y30LB33*/ 00408000
*       ADDR(DERAS)>0|ADDR(NDERS)>0 /*                       @Y30LB33*/ 00409000
*     THEN                                                         0366 00410000
@RF00364 SLR   @07,@07                                             0366 00411000
         L     @15,@PC00001+4                                      0366 00412000
         C     @07,FDTPTR+24(,@15)                                 0366 00413000
         BL    @RT00366                                            0366 00414000
         C     @07,FDTPTR+28(,@15)                                 0366 00415000
         BL    @RT00366                                            0366 00416000
         C     @07,FDTPTR+32(,@15)                                 0366 00417000
         BL    @RT00366                                            0366 00418000
         C     @07,FDTPTR+36(,@15)                                 0366 00419000
         BL    @RT00366                                            0366 00420000
         C     @07,FDTPTR+40(,@15)                                 0366 00421000
         BL    @RT00366                                            0366 00422000
         C     @07,FDTPTR+44(,@15)                                 0366 00423000
         BL    @RT00366                                            0366 00424000
         C     @07,FDTPTR+48(,@15)                                 0366 00425000
         BL    @RT00366                                            0366 00426000
         C     @07,FDTPTR+52(,@15)                                 0366 00427000
         BNL   @RF00366                                            0366 00428000
@RT00366 DS    0H                                                  0367 00429000
*     ATTRSW=ON;                    /*                       @Y30LB33*/ 00430000
*                                                                  0367 00431000
         OI    ATTRSW,B'00100000'                                  0367 00432000
*   /*****************************************************************/ 00433000
*   /*                                                               */ 00434000
*   /* IF CHANGES ARE TO BE MADE TO THE MSVC RECORD          @Y30LB33*/ 00435000
*   /* BY USER REQUEST, TURN ON THE APPROPRIATE SWITCH       @Y30LB33*/ 00436000
*   /*                                                               */ 00437000
*   /*****************************************************************/ 00438000
*                                                                  0368 00439000
*   IF ADDR(GRP)>0|ADDR(GNRL)>0|    /*                       @Y30LB33*/ 00440000
*       ADDR(RSTR)>0|ADDR(DESCR)>0| /*                       @Y30LB33*/ 00441000
*       ADDR(BKUP)>0|ADDR(NGRP)>0|  /*                       @Y30LB33*/ 00442000
*       ADDR(NRET)>0|ADDR(NDESC)>0| /*                       @Y30LB33*/ 00443000
*       ADDR(TO)>0|ADDR(FORE)>0     /*                       @Y30LB33*/ 00444000
*     THEN                                                         0368 00445000
@RF00366 SLR   @07,@07                                             0368 00446000
         L     @15,@PC00001+4                                      0368 00447000
         C     @07,FDTPTR+12(,@15)                                 0368 00448000
         BL    @RT00368                                            0368 00449000
         C     @07,FDTPTR+16(,@15)                                 0368 00450000
         BL    @RT00368                                            0368 00451000
         C     @07,FDTPTR+20(,@15)                                 0368 00452000
         BL    @RT00368                                            0368 00453000
         C     @07,FDTPTR+56(,@15)                                 0368 00454000
         BL    @RT00368                                            0368 00455000
         C     @07,FDTPTR+64(,@15)                                 0368 00456000
         BL    @RT00368                                            0368 00457000
         C     @07,FDTPTR+76(,@15)                                 0368 00458000
         BL    @RT00368                                            0368 00459000
         C     @07,FDTPTR+84(,@15)                                 0368 00460000
         BL    @RT00368                                            0368 00461000
         C     @07,FDTPTR+80(,@15)                                 0368 00462000
         BL    @RT00368                                            0368 00463000
         C     @07,FDTPTR+60(,@15)                                 0368 00464000
         BL    @RT00368                                            0368 00465000
         C     @07,FDTPTR+96(,@15)                                 0368 00466000
         BNL   @RF00368                                            0368 00467000
@RT00368 DS    0H                                                  0369 00468000
*     MSVCSW=ON;                    /*                       @Y30LB33*/ 00469000
*                                                                  0369 00470000
         OI    MSVCSW,B'00010000'                                  0369 00471000
*   /*****************************************************************/ 00472000
*   /*                                                               */ 00473000
*   /* CHECK FOR A VALID VTOC HEAD ADDRESS                   @ZDR2057*/ 00474000
*   /* FOR A REBUILD LABEL REQUEST.                          @ZDR2057*/ 00475000
*   /*                                                               */ 00476000
*   /*****************************************************************/ 00477000
*                                                                  0370 00478000
*   IF ADDR(RLBL)^=NULLPTR THEN                                    0370 00479000
@RF00368 L     @07,@PC00001+4                                      0370 00480000
         L     @15,FDTPTR+100(,@07)                                0370 00481000
         LTR   @15,@15                                             0370 00482000
         BZ    @RF00370                                            0370 00483000
*     DO;                           /*                       @ZDR2057*/ 00484000
*       VTOCCCHH=VADDRVAL;          /*                       @ZDR2057*/ 00485000
         L     @07,FDTPTR+104(,@07)                                0372 00486000
         MVC   VTOCCCHH(4),VADDRVAL(@07)                           0372 00487000
*       VTOCR=VTOCRR;               /* RECORD TO 1           @ZDR2057*/ 00488000
         MVC   VTOCR(1),VTOCRR                                     0373 00489000
*       IF VTOCHH>MAXHH THEN                                       0374 00490000
         CLC   VTOCHH(2),MAXHH                                     0374 00491000
         BNH   @RF00374                                            0374 00492000
*         DO;                       /*                       @ZDR2057*/ 00493000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @ZDR2057*/ 00494000
         L     @07,DDSTRU                                          0376 00495000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0376 00496000
*           DARGSMOD=MODMV0;        /*                       @ZDR2057*/ 00497000
         MVC   DARGSMOD(3,@07),MODMV0                              0377 00498000
*           DARGSENT=MSG3692I;      /*                       @ZDR2057*/ 00499000
         MVI   DARGSENT(@07),X'03'                                 0378 00500000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @ZDR2057*/ 00501000
         L     @07,@PC00001                                        0379 00502000
         ST    @07,@AL00001                                        0379 00503000
         LA    @15,@CF00117                                        0379 00504000
         ST    @15,@AL00001+4                                      0379 00505000
         LA    @15,DDSTRU                                          0379 00506000
         ST    @15,@AL00001+8                                      0379 00507000
         MVI   @AL00001+8,X'80'                                    0379 00508000
         L     @15,GDTPRT(,@07)                                    0379 00509000
         LA    @01,@AL00001                                        0379 00510000
         BALR  @14,@15                                             0379 00511000
*           LASTCOND=TERMCODE;      /*                       @ZDR2057*/ 00512000
         L     @07,@PC00001+8                                      0380 00513000
         MVC   LASTCOND(2,@07),@CH00038                            0380 00514000
*         END;                      /*                       @ZDR2057*/ 00515000
*     END;                          /*                       @ZDR2057*/ 00516000
@RF00374 DS    0H                                                  0383 00517000
*   IF LASTCOND^=TERMCODE THEN                                     0383 00518000
@RF00370 L     @07,@PC00001+8                                      0383 00519000
         CLC   LASTCOND(2,@07),@CH00038                            0383 00520000
         BE    @RF00383                                            0383 00521000
*     DO;                           /*                       @ZDR2057*/ 00522000
*                                                                  0384 00523000
*       /*************************************************************/ 00524000
*       /*                                                           */ 00525000
*       /* CALL THE VOLUME CHECKER TO READ THE BASE VOLUME   @Y30LB33*/ 00526000
*       /* RECORD AND MAKE SURE THAT THE REQUESTED CHANGES   @Y30LB33*/ 00527000
*       /* CAN BE MADE                                       @Y30LB33*/ 00528000
*       /*                                                           */ 00529000
*       /*************************************************************/ 00530000
*                                                                  0385 00531000
*       CALL VOLCK;                 /*                       @Y30LB33*/ 00532000
*                                                                  0385 00533000
         BAL   @14,VOLCK                                           0385 00534000
*       /*************************************************************/ 00535000
*       /*                                                           */ 00536000
*       /* IF THE VOLUME RECORD WAS READ, AND THIS IS        @ZDR2057*/ 00537000
*       /* NOT A REBUILD LABEL REQUEST CALL THE GROUP        @ZDR2057*/ 00538000
*       /* CHECKER TO READ ANY GROUP RECORDS INVOLVED IN     @Y30LB33*/ 00539000
*       /* THE CHANGE AND CHECK FOR CONFLICTS                @Y30LB33*/ 00540000
*       /*                                                           */ 00541000
*       /*************************************************************/ 00542000
*                                                                  0386 00543000
*       IF VOLRCD=ON&ADDR(RLBL)=NULLPTR THEN                       0386 00544000
         TM    VOLRCD,B'00001000'                                  0386 00545000
         BNO   @RF00386                                            0386 00546000
         L     @07,@PC00001+4                                      0386 00547000
         L     @07,FDTPTR+100(,@07)                                0386 00548000
         LTR   @07,@07                                             0386 00549000
         BNZ   @RF00386                                            0386 00550000
*         CALL GRPPROC;             /*                       @ZDR2057*/ 00551000
         BAL   @14,GRPPROC                                         0387 00552000
*                                                                  0388 00553000
*       /*************************************************************/ 00554000
*       /*                                                           */ 00555000
*       /* IF THE FILE PARAMETER IS SPECIFIED, AND           @Y30LB33*/ 00556000
*       /* THE VOLUME ATTRIBUTES ARE CHANGING OR THE         @Y30LB33*/ 00557000
*       /* VOLUME LABEL WILL BE CHANGED, CHECK THE UNIT      @Y30LB33*/ 00558000
*       /* CHARACTERISTICS FOR VIRTUAL AND OBTAIN            @YD00175*/ 00559000
*       /* THE UNIT FOR EXCLUSIVE CONTROL                    @YD00175*/ 00560000
*       /*                                                           */ 00561000
*       /*************************************************************/ 00562000
*                                                                  0388 00563000
*       IF ADDR(FYLE)>NULLPTR&      /*                       @Y30LB33*/ 00564000
*           (ATTRSW=ON|COPYATTR=ON| /*                       @Y30LB33*/ 00565000
*           ONLYONLY=ON|RENAMSW=ON|ADDR(RLBL)^=NULLPTR) THEN       0388 00566000
@RF00386 SLR   @07,@07                                             0388 00567000
         L     @15,@PC00001+4                                      0388 00568000
         C     @07,FDTPTR+88(,@15)                                 0388 00569000
         BNL   @RF00388                                            0388 00570000
         TM    ATTRSW,B'00100010'                                  0388 00571000
         BNZ   @RT00388                                            0388 00572000
         TM    ONLYONLY,B'10000000'                                0388 00573000
         BO    @RT00388                                            0388 00574000
         TM    RENAMSW,B'01000000'                                 0388 00575000
         BO    @RT00388                                            0388 00576000
         C     @07,FDTPTR+100(,@15)                                0388 00577000
         BE    @RF00388                                            0388 00578000
@RT00388 DS    0H                                                  0389 00579000
*         DO;                       /*                       @ZDR2057*/ 00580000
*                                                                  0389 00581000
*           /*********************************************************/ 00582000
*           /*                                                       */ 00583000
*           /* BUILD THE CHANGEX ARGUMENT LIST.              @YD00175*/ 00584000
*           /* IF THE VOLUME LABEL IS NOT BEING CHANGED,     @YD00175*/ 00585000
*           /* REQUEST THAT THE ALLOCATION BE CHANGED TO     @YD00175*/ 00586000
*           /* EXCLUSIVE ONLY IF THE VOLUME IS MOUNTED       @YD00175*/ 00587000
*           /*                                                       */ 00588000
*           /*********************************************************/ 00589000
*                                                                  0390 00590000
*           EXCLAGL=EXCLAGL&&EXCLAGL;/*                      @YD00175*/ 00591000
         LA    @07,MVEXAGL                                         0390 00592000
         XC    EXCLAGL(23,@07),EXCLAGL(@07)                        0390 00593000
*           EXCLUCBP=ADDR(MVUCBPTR);/*                       @YD00175*/ 00594000
         LA    @15,MVUCBPTR                                        0391 00595000
         ST    @15,EXCLUCBP(,@07)                                  0391 00596000
*           EXCLDDP=ADDR(FYLEVAL);  /*                       @YD00175*/ 00597000
         L     @15,@PC00001+4                                      0392 00598000
         L     @01,FDTPTR+88(,@15)                                 0392 00599000
         LA    @14,FYLEVAL(,@01)                                   0392 00600000
         ST    @14,EXCLDDP(,@07)                                   0392 00601000
*           EXCLVOL=VOLVAL;         /*                       @ZA05119*/ 00602000
         L     @01,FDTPTR(,@15)                                    0393 00603000
         MVC   EXCLVOL(6,@07),VOLVAL(@01)                          0393 00604000
*           IF RENAMSW=OFF THEN                                    0394 00605000
         TM    RENAMSW,B'01000000'                                 0394 00606000
         BNZ   @RF00394                                            0394 00607000
*             EXCLMNT=ON;           /*                       @YD00175*/ 00608000
*                                                                  0395 00609000
         OI    EXCLMNT(@07),B'10000000'                            0395 00610000
*           /*********************************************************/ 00611000
*           /*                                                       */ 00612000
*           /* DUMP THE EXCLUSIVE ARGUMENT LIST              @ZA09560*/ 00613000
*           /*                                                       */ 00614000
*           /*********************************************************/ 00615000
*                                                                  0396 00616000
*           IF GDTDBG=NULLPTR THEN                                 0396 00617000
@RF00394 L     @07,@PC00001                                        0396 00618000
         L     @07,GDTDBG(,@07)                                    0396 00619000
         LTR   @07,@07                                             0396 00620000
         BZ    @RT00396                                            0396 00621000
*             ;                                                    0397 00622000
*           ELSE                                                   0398 00623000
*             DO;                                                  0398 00624000
*               DMPINDEX=ADDR(DUMPAREA);/*                   @ZA09560*/ 00625000
         LA    DMPINDEX,DUMPAREA                                   0399 00626000
*               DMPITMNM='EXCLAGL';                                0400 00627000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0400 00628000
         MVC   DMPITMNM(7,DMPINDEX),@CC01648                       0400 00629000
*               DMPITMPT=ADDR(EXCLAGL);                            0401 00630000
         LA    @07,MVEXAGL                                         0401 00631000
         ST    @07,DMPITMPT(,DMPINDEX)                             0401 00632000
*               DMPITMLN=LENGTH(EXCLAGL);                          0402 00633000
         MVC   DMPITMLN(2,DMPINDEX),@CH01468                       0402 00634000
*               DMPITMTP='H';                                      0403 00635000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0403 00636000
*               DMPINDEX=DMPINDEX+DMPELEMT;/*                @ZA09560*/ 00637000
         AL    DMPINDEX,@CF00507                                   0404 00638000
*               DMPTRM=DMPTRMVL;                                   0405 00639000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0405 00640000
*             END;                  /*                       @ZA09560*/ 00641000
*           IF GDTDBG=NULLPTR THEN                                 0407 00642000
@RT00396 L     @07,@PC00001                                        0407 00643000
         L     @07,GDTDBG(,@07)                                    0407 00644000
         LTR   @07,@07                                             0407 00645000
         BZ    @RT00407                                            0407 00646000
*             ;                                                    0408 00647000
*           ELSE                                                   0409 00648000
*             CALL IDCDB010(GDTTBL,'MVBB',DUMPADDR);/*       @ZA09560*/ 00649000
*                                                                  0409 00650000
         L     @07,@PC00001                                        0409 00651000
         ST    @07,@AL00001                                        0409 00652000
         LA    @15,@CC01650                                        0409 00653000
         ST    @15,@AL00001+4                                      0409 00654000
         LA    @15,DUMPADDR                                        0409 00655000
         ST    @15,@AL00001+8                                      0409 00656000
         MVI   @AL00001+8,X'80'                                    0409 00657000
         L     @15,GDTDBG(,@07)                                    0409 00658000
         LA    @01,@AL00001                                        0409 00659000
         BALR  @14,@15                                             0409 00660000
*           /*********************************************************/ 00661000
*           /*                                                       */ 00662000
*           /* ISSUE THE CHANGEX REQUEST TO CHANGE THE       @YD00175*/ 00663000
*           /* ALLOCATION TO EXCLUSIVE                       @YD00175*/ 00664000
*           /*                                                       */ 00665000
*           /*********************************************************/ 00666000
*                                                                  0410 00667000
*           CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*         @YD00175*/ 00668000
@RT00407 L     @07,@PC00001                                        0410 00669000
         ST    @07,@AL00001                                        0410 00670000
         LA    @02,CHANGEX                                         0410 00671000
         ST    @02,@AL00001+4                                      0410 00672000
         LA    @02,MVEXAGL                                         0410 00673000
         ST    @02,@AL00001+8                                      0410 00674000
         MVI   @AL00001+8,X'80'                                    0410 00675000
         L     @15,GDTUNT(,@07)                                    0410 00676000
         LA    @01,@AL00001                                        0410 00677000
         BALR  @14,@15                                             0410 00678000
*           RESPECIFY                                              0411 00679000
*             RTNREG RSTD;                                         0411 00680000
*           TESTRC=RTNREG;                                         0412 00681000
         LR    TESTRC,RTNREG                                       0412 00682000
*           RESPECIFY                                              0413 00683000
*             RTNREG UNRSTD;        /*                       @Y30LB33*/ 00684000
*                                                                  0413 00685000
*           /*********************************************************/ 00686000
*           /*                                                       */ 00687000
*           /* IF THE RETURN CODE IS NOT ZERO,               @Y30LB33*/ 00688000
*           /* SET LASTCOND TO 12 TO TERMINATE               @Y30LB33*/ 00689000
*           /*                                                       */ 00690000
*           /*********************************************************/ 00691000
*                                                                  0414 00692000
*           IF TESTRC^=0 THEN                                      0414 00693000
         LTR   TESTRC,TESTRC                                       0414 00694000
         BZ    @RF00414                                            0414 00695000
*             LASTCOND=TERMCODE;    /*                       @Y30LB33*/ 00696000
*                                                                  0415 00697000
         L     @07,@PC00001+8                                      0415 00698000
         MVC   LASTCOND(2,@07),@CH00038                            0415 00699000
*           /*********************************************************/ 00700000
*           /*                                                       */ 00701000
*           /* IF WE ARE NOT TERMINATING, CHECK THE          @YD00175*/ 00702000
*           /* VOLUME TO MAKE SURE IT IS VIRTUAL             @YD00175*/ 00703000
*           /*                                                       */ 00704000
*           /*********************************************************/ 00705000
*                                                                  0416 00706000
*           IF LASTCOND<TERMCODE THEN                              0416 00707000
@RF00414 L     @07,@PC00001+8                                      0416 00708000
         LH    @07,LASTCOND(,@07)                                  0416 00709000
         C     @07,@CF00038                                        0416 00710000
         BNL   @RF00416                                            0416 00711000
*             DO;                   /*                       @YD00175*/ 00712000
*               CKAGL=CKAGL&&CKAGL; /*                       @YD00175*/ 00713000
         LA    @07,MVCKAGL                                         0418 00714000
         XC    CKAGL(29,@07),CKAGL(@07)                            0418 00715000
*               CKDDNAME=FYLEVAL;   /*                       @YD00175*/ 00716000
         L     @02,@PC00001+4                                      0419 00717000
         L     @02,FDTPTR+88(,@02)                                 0419 00718000
         MVC   CKDDNAME(8,@07),FYLEVAL(@02)                        0419 00719000
*               CKTESTVT=ON;        /*                       @YD00175*/ 00720000
         OI    CKTESTVT(@07),B'10000000'                           0420 00721000
*               CKUCBPTR=ADDR(MVUCBPTR);/*                   @YD00175*/ 00722000
*                                                                  0421 00723000
         LA    @02,MVUCBPTR                                        0421 00724000
         ST    @02,CKUCBPTR(,@07)                                  0421 00725000
*               /*****************************************************/ 00726000
*               /*                                                   */ 00727000
*               /* ISSUE THE CHECK UMSSUNIT                  @YD00175*/ 00728000
*               /*                                                   */ 00729000
*               /*****************************************************/ 00730000
*                                                                  0422 00731000
*               CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*         @YD00175*/ 00732000
         L     @02,@PC00001                                        0422 00733000
         ST    @02,@AL00001                                        0422 00734000
         LA    @15,CHECK                                           0422 00735000
         ST    @15,@AL00001+4                                      0422 00736000
         ST    @07,@AL00001+8                                      0422 00737000
         MVI   @AL00001+8,X'80'                                    0422 00738000
         L     @15,GDTUNT(,@02)                                    0422 00739000
         LA    @01,@AL00001                                        0422 00740000
         BALR  @14,@15                                             0422 00741000
*               RESPECIFY                                          0423 00742000
*                 RTNREG RSTD;                                     0423 00743000
*               TESTRC=RTNREG;                                     0424 00744000
         LR    TESTRC,RTNREG                                       0424 00745000
*               RESPECIFY                                          0425 00746000
*                 RTNREG UNRSTD;    /*                       @YD00175*/ 00747000
*                                                                  0425 00748000
*               /*****************************************************/ 00749000
*               /*                                                   */ 00750000
*               /* IF WE HAVE AN ERROR, TERMINATE            @YD00175*/ 00751000
*               /*                                                   */ 00752000
*               /*****************************************************/ 00753000
*                                                                  0426 00754000
*               IF TESTRC>0 THEN    /*                       @YD00175*/ 00755000
         LTR   TESTRC,TESTRC                                       0426 00756000
         BNP   @RF00426                                            0426 00757000
*                 LASTCOND=TERMCODE;/*                       @YD00175*/ 00758000
         L     @07,@PC00001+8                                      0427 00759000
         MVC   LASTCOND(2,@07),@CH00038                            0427 00760000
*             END;                  /*                       @YD00175*/ 00761000
@RF00426 DS    0H                                                  0429 00762000
*         END;                      /*                       @Y30LB33*/ 00763000
@RF00416 DS    0H                                                  0430 00764000
*                                                                  0430 00765000
*       /*************************************************************/ 00766000
*       /*                                                           */ 00767000
*       /* IF THE GROUP RECORD WAS TO BE READ AND            @YD00175*/ 00768000
*       /* IT WAS NOT, THE FOLLOWING TESTS CAN NOT           @Y30LB33*/ 00769000
*       /* BE MADE                                           @Y30LB33*/ 00770000
*       /*                                                           */ 00771000
*       /*************************************************************/ 00772000
*                                                                  0430 00773000
*       IF NEWGENSW=ON&GRPRCD=OFF THEN                             0430 00774000
@RF00388 TM    NEWGENSW,B'00000100'                                0430 00775000
         BNO   @RF00430                                            0430 00776000
         TM    GRPRCD,B'00001000'                                  0430 00777000
         BZ    @RT00430                                            0430 00778000
*         ;                         /*                       @YD00175*/ 00779000
*                                                                  0431 00780000
*       /*************************************************************/ 00781000
*       /*                                                           */ 00782000
*       /* IF THE USER SPECIFIED AN OWNER OR                 @YD00175*/ 00783000
*       /* VOLUME SERIAL CHANGE                              @Y30LB33*/ 00784000
*       /*                                                           */ 00785000
*       /*************************************************************/ 00786000
*                                                                  0432 00787000
*       ELSE                        /*                       @YD00175*/ 00788000
*         IF VOLRCD=ON&RENAMSW=ON&  /*                       @Y30LB33*/ 00789000
*                                                                  0432 00790000
*         /***********************************************************/ 00791000
*         /*                                                         */ 00792000
*         /* AND THE VOLUME RECORD HAS THE READONLY          @Y30LB33*/ 00793000
*         /* ATTRIBUTE SET ON                                @Y30LB33*/ 00794000
*         /*                                                         */ 00795000
*         /***********************************************************/ 00796000
*                                                                  0432 00797000
*             BASRONLY=ON&          /*                       @Y30LB33*/ 00798000
*                                                                  0432 00799000
*         /***********************************************************/ 00800000
*         /*                                                         */ 00801000
*         /* AND THE USER DID NOT ASK FOR THE READONLY       @Y30LB33*/ 00802000
*         /* ATTRIBUTE TO BE TURNED OFF                      @Y30LB33*/ 00803000
*         /*                                                         */ 00804000
*         /***********************************************************/ 00805000
*                                                                  0432 00806000
*             ADDR(RW)=NULLPTR&     /*                       @Y30LB33*/ 00807000
*                                                                  0432 00808000
*         /***********************************************************/ 00809000
*         /*                                                         */ 00810000
*         /* AND THE VOLUME IS NOT BEING PLACED IN A         @Y30LB33*/ 00811000
*         /* GROUP THAT WILL AUTOMATICALLY TURN OFF THE      @Y30LB33*/ 00812000
*         /* VOLUME'S READONLY ATTRIBUTE                     @Y30LB33*/ 00813000
*         /*                                                         */ 00814000
*         /***********************************************************/ 00815000
*                                                                  0432 00816000
*             COPYRW=OFF|           /*                       @ZDR2057*/ 00817000
*                                                                  0432 00818000
*         /***********************************************************/ 00819000
*         /*                                                         */ 00820000
*         /* OR THE USER REQUESTED THE VOLUME LABEL TO BE    @ZDR2057*/ 00821000
*         /* REBUILT FOR A READONLY VOLUME,                  @ZDR2057*/ 00822000
*         /*                                                         */ 00823000
*         /***********************************************************/ 00824000
*                                                                  0432 00825000
*             (BASRONLY=ON&ADDR(RLBL)^=NULLPTR) THEN               0432 00826000
*                                                                  0432 00827000
@RF00430 TM    VOLRCD,B'00001000'                                  0432 00828000
         BNO   @GL00025                                            0432 00829000
         TM    RENAMSW,B'01000000'                                 0432 00830000
         BNO   @GL00025                                            0432 00831000
         TM    BASRONLY(BASEVPTR),B'01000000'                      0432 00832000
         BNO   @GL00025                                            0432 00833000
         L     @07,@PC00001+4                                      0432 00834000
         L     @07,FDTPTR+44(,@07)                                 0432 00835000
         LTR   @07,@07                                             0432 00836000
         BNZ   @GL00025                                            0432 00837000
         TM    COPYRW,B'00010000'                                  0432 00838000
         BZ    @RT00432                                            0432 00839000
@GL00025 TM    BASRONLY(BASEVPTR),B'01000000'                      0432 00840000
         BNO   @RF00432                                            0432 00841000
         L     @07,@PC00001+4                                      0432 00842000
         L     @07,FDTPTR+100(,@07)                                0432 00843000
         LTR   @07,@07                                             0432 00844000
         BZ    @RF00432                                            0432 00845000
@RT00432 DS    0H                                                  0433 00846000
*           /*********************************************************/ 00847000
*           /*                                                       */ 00848000
*           /* THEN PRINT IDC3090I AND SET LASTCOND TO 12    #Y30LB33*/ 00849000
*           /*                                                       */ 00850000
*           /*********************************************************/ 00851000
*                                                                  0433 00852000
*           DO;                     /*                       #Y30LB33*/ 00853000
*             DARGLIST=DARGLIST&&DARGLIST;/*                 @Y30LB33*/ 00854000
         L     @07,DDSTRU                                          0434 00855000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0434 00856000
*             DARGSMOD=MODCMN;      /*                       @Y30LB33*/ 00857000
         MVC   DARGSMOD(3,@07),MODCMN                              0435 00858000
*             DARGSENT=MSG3090I;    /*                       @Y30LB33*/ 00859000
         MVI   DARGSENT(@07),X'10'                                 0436 00860000
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB33*/ 00861000
         L     @15,@PC00001+4                                      0437 00862000
         L     @01,FDTPTR(,@15)                                    0437 00863000
         LA    @15,VOLVAL(,@01)                                    0437 00864000
         ST    @15,DARGDBP(,@07)                                   0437 00865000
*             DARGILP=LENGTH(VOLVAL);/*                      @Y30LB33*/ 00866000
         MVC   DARGILP(2,@07),@CH00159                             0438 00867000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB33*/ 00868000
         L     @07,@PC00001                                        0439 00869000
         ST    @07,@AL00001                                        0439 00870000
         LA    @15,@CF00117                                        0439 00871000
         ST    @15,@AL00001+4                                      0439 00872000
         LA    @15,DDSTRU                                          0439 00873000
         ST    @15,@AL00001+8                                      0439 00874000
         MVI   @AL00001+8,X'80'                                    0439 00875000
         L     @15,GDTPRT(,@07)                                    0439 00876000
         LA    @01,@AL00001                                        0439 00877000
         BALR  @14,@15                                             0439 00878000
*             LASTCOND=TERMCODE;    /*                       @Y30LB33*/ 00879000
         L     @07,@PC00001+8                                      0440 00880000
         MVC   LASTCOND(2,@07),@CH00038                            0440 00881000
*           END;                    /*                       @Y30LB33*/ 00882000
*     END;                          /*                       @ZDR2057*/ 00883000
*                                                                  0442 00884000
@RF00432 DS    0H                                                  0442 00885000
@RT00430 DS    0H                                                  0443 00886000
*   /*****************************************************************/ 00887000
*   /*                                                               */ 00888000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 00889000
*   /*                                                               */ 00890000
*   /*****************************************************************/ 00891000
*                                                                  0443 00892000
*   REG14=CKOUTSV;                  /*                       @Y30LB33*/ 00893000
@RF00383 L     REG14,CKOUTSV                                       0443 00894000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 00895000
         SLR   @15,@15                                             0444 00896000
@EL00002 DS    0H                                                  0444 00897000
@EF00002 DS    0H                                                  0444 00898000
@ER00002 BR    @14                                                 0444 00899000
*   END CHECKOUT;                   /*                       @Y30LB33*/ 00900000
*                                                                  0446 00901000
*/********************************************************   @ZDR2057*/ 00902000
*/* PROCEDURE NAME - RBLABEL                                 @ZDR2057*/ 00903000
*/*                                                          @ZDR2057*/ 00904000
*/* FUNCTION - THIS PROCEDURE WILL REWRITE A VOLUME          @ZDR2057*/ 00905000
*/*      LABEL THAT COULD BE UNREADABLE.  IT CALLS           @ZDR2057*/ 00906000
*/*      MNTVOL TO HAVE THE VOLUME MOUNTED, AND CALLS        @ZDR2057*/ 00907000
*/*      NEWLABL TO HAVE THE LABEL REWRITTEN.  IF NO         @ZDR2057*/ 00908000
*/*      ERROR HAS OCCURED, THE THE RESERVE DONE BY          @ZDR2057*/ 00909000
*/*      VOLUME SERVICES IS DEQUED, THE DCB OPENED BY        @ZDR2057*/ 00910000
*/*      VOLUME SERVICES IS CLOSED, AND THE VOLUME           @ZDR2057*/ 00911000
*/*      IS DEMOUNTED.                                       @ZDR2057*/ 00912000
*/*                                                          @ZDR2057*/ 00913000
*/* INPUT - FDTTBL                                           @ZDR2057*/ 00914000
*/*                                                          @ZDR2057*/ 00915000
*/* OUTPUT - LASTCOND IS SET TO 12 TO INDICATE THAT          @ZDR2057*/ 00916000
*/*      THE VOLUME LABEL COULD NOT BE WRITTEN AND           @ZDR2057*/ 00917000
*/*      MESSAGE IDC3691I IS ISSUED.                         @ZDR2057*/ 00918000
*/********************************************************   @ZDR2057*/ 00919000
*                                                                  0446 00920000
*RBLABEL:                                                          0446 00921000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2057*/ 00922000
RBLABEL  ST    @14,@SA00003                                        0446 00923000
*   OLDERID2=NEWERID2;              /*                       @ZDR2057*/ 00924000
         L     @05,@PC00001                                        0447 00925000
         L     @05,GDTTR2(,@05)                                    0447 00926000
         MVC   @TS00001(95),NEWERID2(@05)                          0447 00927000
         MVC   OLDERID2(95,@05),@TS00001                           0447 00928000
*   NEWID2='MVRL';                  /*                       @ZDR2057*/ 00929000
*                                                                  0448 00930000
         MVC   NEWID2(4,@05),@CC01654                              0448 00931000
*   /*****************************************************************/ 00932000
*   /*                                                               */ 00933000
*   /* MOUNT THE VOLUME AS AN UNINITIALIZED VOLUME.          @ZDR2057*/ 00934000
*   /*                                                               */ 00935000
*   /*****************************************************************/ 00936000
*                                                                  0449 00937000
*   CALL MNTVOL;                    /*                       @ZDR2057*/ 00938000
*                                                                  0449 00939000
         BAL   @14,MNTVOL                                          0449 00940000
*   /*****************************************************************/ 00941000
*   /*                                                               */ 00942000
*   /* REWRITE THE VOLUME LABEL.                             @ZDR2057*/ 00943000
*   /*                                                               */ 00944000
*   /*****************************************************************/ 00945000
*                                                                  0450 00946000
*   CALL NEWLABL;                   /*                       @ZDR2057*/ 00947000
         BAL   @14,NEWLABL                                         0450 00948000
*   IF LASTCOND^=TERMCODE THEN                                     0451 00949000
         L     @15,@PC00001+8                                      0451 00950000
         CLC   LASTCOND(2,@15),@CH00038                            0451 00951000
         BE    @RF00451                                            0451 00952000
*     DO;                           /*                       @ZDR2057*/ 00953000
*                                                                  0452 00954000
*       /*************************************************************/ 00955000
*       /*                                                           */ 00956000
*       /* DEQUE THE RESERVE DONE BY VOLUME SERVICES IN NEWLABL      */ 00957000
*       /*                                                   @ZDR2057*/ 00958000
*       /*                                                           */ 00959000
*       /*************************************************************/ 00960000
*                                                                  0453 00961000
*       MINAMVOL=MVVOLUME;          /*                       @ZDR2057*/ 00962000
         MVC   MINAMVOL(6),MVVOLUME                                0453 00963000
*       MINAMQL=MINQLR;             /*                       @ZDR2057*/ 00964000
*                                                                  0454 00965000
         MVC   MINAMQL(16),@CC01589                                0454 00966000
*       /*************************************************************/ 00967000
*       /*                                                           */ 00968000
*       /* ISSUE THE DEQUEUE ON THE RESERVE                  @ZDR2057*/ 00969000
*       /*                                                           */ 00970000
*       /*************************************************************/ 00971000
*                                                                  0455 00972000
*       CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*           @ZDR2057*/ 00973000
*                                                                  0455 00974000
         L     @15,@PC00001                                        0455 00975000
         ST    @15,@AL00001                                        0455 00976000
         LA    @14,MVMAJNAM                                        0455 00977000
         ST    @14,@AL00001+4                                      0455 00978000
         LA    @14,MVMINNAM                                        0455 00979000
         ST    @14,@AL00001+8                                      0455 00980000
         MVI   @AL00001+8,X'80'                                    0455 00981000
         L     @15,GDTDEQ(,@15)                                    0455 00982000
         LA    @01,@AL00001                                        0455 00983000
         BALR  @14,@15                                             0455 00984000
*       /*************************************************************/ 00985000
*       /*                                                           */ 00986000
*       /* CLOSE THE DCB                                     @ZDR2057*/ 00987000
*       /*                                                           */ 00988000
*       /*************************************************************/ 00989000
*                                                                  0456 00990000
*       CALL IDCIO050(GDTTBL,CLOSE,IOCTLBKP);/*              @ZDR2057*/ 00991000
*                                                                  0456 00992000
         L     @15,@PC00001                                        0456 00993000
         ST    @15,@AL00001                                        0456 00994000
         LA    @14,CLOSE                                           0456 00995000
         ST    @14,@AL00001+4                                      0456 00996000
         LA    @14,IOCTLBKP                                        0456 00997000
         ST    @14,@AL00001+8                                      0456 00998000
         MVI   @AL00001+8,X'80'                                    0456 00999000
         L     @15,GDTEXP(,@15)                                    0456 01000000
         LA    @01,@AL00001                                        0456 01001000
         BALR  @14,@15                                             0456 01002000
*       /*************************************************************/ 01003000
*       /*                                                           */ 01004000
*       /* SET UP THE DEMOUNT LIST                           @ZDR2057*/ 01005000
*       /*                                                           */ 01006000
*       /*************************************************************/ 01007000
*                                                                  0457 01008000
*       MDAGL=MDAGL&&MDAGL;         /*                       @ZDR2057*/ 01009000
         LA    @15,MVMDAGL                                         0457 01010000
         XC    MDAGL(37,@15),MDAGL(@15)                            0457 01011000
*       MDDDNAME=MVDDNAME;          /*                       @ZDR2057*/ 01012000
         MVC   MDDDNAME(8,@15),MVDDNAME                            0458 01013000
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @ZDR2057*/ 01014000
         LA    @14,MVUCBPTR                                        0459 01015000
         ST    @14,MDUCBPTR(,@15)                                  0459 01016000
*       MDLABEL=MVVOLUME;           /*                       @ZDR2057*/ 01017000
         MVC   MDLABEL(6,@15),MVVOLUME                             0460 01018000
*       MDWAIT=ON;                  /*                       @ZDR2057*/ 01019000
*                                                                  0461 01020000
         OI    MDWAIT(@15),B'00010000'                             0461 01021000
*       /*************************************************************/ 01022000
*       /*                                                           */ 01023000
*       /* ISSUE THE DEMOUNT                                 @ZDR2057*/ 01024000
*       /*                                                           */ 01025000
*       /*************************************************************/ 01026000
*                                                                  0462 01027000
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @ZDR2057*/ 01028000
         L     @14,@PC00001                                        0462 01029000
         ST    @14,@AL00001                                        0462 01030000
         LA    @07,DEMOUNT                                         0462 01031000
         ST    @07,@AL00001+4                                      0462 01032000
         ST    @15,@AL00001+8                                      0462 01033000
         MVI   @AL00001+8,X'80'                                    0462 01034000
         L     @15,GDTUNT(,@14)                                    0462 01035000
         LA    @01,@AL00001                                        0462 01036000
         BALR  @14,@15                                             0462 01037000
*     END;                          /*                       @ZDR2057*/ 01038000
*   ELSE                                                           0464 01039000
*                                                                  0464 01040000
*     /***************************************************************/ 01041000
*     /*                                                             */ 01042000
*     /* PRINT MESSAGE IDC3691I VOLUME XXXXXX LABEL          @ZDR2057*/ 01043000
*     /* NOT REBUILT                                         @ZDR2057*/ 01044000
*     /*                                                             */ 01045000
*     /***************************************************************/ 01046000
*                                                                  0464 01047000
*     DO;                           /*                       @ZDR2057*/ 01048000
         B     @RC00451                                            0464 01049000
@RF00451 DS    0H                                                  0465 01050000
*       MVDRGLST=''B;               /*                       @ZDR2057*/ 01051000
         XC    MVDRGLST(36),MVDRGLST                               0465 01052000
*       DARGSMOD=MODMV0;            /*                       @ZDR2057*/ 01053000
         L     @15,DDSTRU                                          0466 01054000
         MVC   DARGSMOD(3,@15),MODMV0                              0466 01055000
*       DARGSENT=MSG3691I;          /*                       @ZDR2057*/ 01056000
         MVI   DARGSENT(@15),X'02'                                 0467 01057000
*       DARGCNT=1;                  /*                       @ZDR2057*/ 01058000
         LA    @14,1                                               0468 01059000
         STH   @14,DARGCNT(,@15)                                   0468 01060000
*       DARGINS(1)=1;               /*                       @ZDR2057*/ 01061000
         STH   @14,DARGINS(,@15)                                   0469 01062000
*       DARGINL(1)=6;               /*                       @ZDR2057*/ 01063000
         MVC   DARGINL(2,@15),@CH00159                             0470 01064000
*       DARGDTM(1)=ADDR(MVVOLUME);  /*                       @ZDR2057*/ 01065000
         LA    @14,MVVOLUME                                        0471 01066000
         ST    @14,DARGDTM(,@15)                                   0471 01067000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @ZDR2057*/ 01068000
         L     @15,@PC00001                                        0472 01069000
         ST    @15,@AL00001                                        0472 01070000
         LA    @14,@CF00117                                        0472 01071000
         ST    @14,@AL00001+4                                      0472 01072000
         LA    @14,DDSTRU                                          0472 01073000
         ST    @14,@AL00001+8                                      0472 01074000
         MVI   @AL00001+8,X'80'                                    0472 01075000
         L     @15,GDTPRT(,@15)                                    0472 01076000
         LA    @01,@AL00001                                        0472 01077000
         BALR  @14,@15                                             0472 01078000
*     END;                          /*                       @ZDR2057*/ 01079000
*   RETURN CODE(0);                 /*                       @ZDR2057*/ 01080000
@RC00451 SLR   @15,@15                                             0474 01081000
@EL00003 DS    0H                                                  0474 01082000
@EF00003 DS    0H                                                  0474 01083000
@ER00003 L     @14,@SA00003                                        0474 01084000
         BR    @14                                                 0474 01085000
*   END RBLABEL;                    /*                       @ZDR2057*/ 01086000
*                                                                  0476 01087000
*/********************************************************   #Y30LB33*/ 01088000
*/* PROCEDURE NAME - VOLCK                                   #Y30LB33*/ 01089000
*/*                                                          @Y30LB33*/ 01090000
*/* FUNCTION - READS IN THE VOLUME INVENTORY RECORD THAT     @Y30LB33*/ 01091000
*/*      IS TO BE CHANGED AND CALLS BVOLCK                   @Y30LB33*/ 01092000
*/*                                                          @Y30LB33*/ 01093000
*/*      IF THE VOLUME RECORD IS NOT READ, THIS ROUTINE      @Y30LB33*/ 01094000
*/*      ISSUES MESSAGE IDC2080I TO INDICATE THE ERROR       @Y30LB33*/ 01095000
*/*                                                          @Y30LB33*/ 01096000
*/* INPUT - THE FDTTBL CONTAINING THE VOLUME SERIAL          @Y30LB33*/ 01097000
*/*                                                          @Y30LB33*/ 01098000
*/* OUTPUT - THE FOLLOWING BITS IN SWCHBITS ARE SET          @Y30LB33*/ 01099000
*/*                                                          @Y30LB33*/ 01100000
*/*            VOLRCD                                        @Y30LB33*/ 01101000
*/*                                                          @Y30LB33*/ 01102000
*/*      LASTCOND IS SET TO 12 IF THE VOLUME INVENTORY       @Y30LB33*/ 01103000
*/*      RECORD IS NOT READ                                  @Y30LB33*/ 01104000
*/********************************************************   @Y30LB33*/ 01105000
*                                                                  0476 01106000
*VOLCK:                                                            0476 01107000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 01108000
*                                                                  0476 01109000
VOLCK    DS    0H                                                  0477 01110000
*   /*****************************************************************/ 01111000
*   /*                                                               */ 01112000
*   /* REGISTER 14 SAVE AREA                                 @Y30LB33*/ 01113000
*   /*                                                               */ 01114000
*   /*****************************************************************/ 01115000
*                                                                  0477 01116000
*   DCL                                                            0477 01117000
*     VOLCKSV PTR(31);              /*                       @Y30LB33*/ 01118000
*   VOLCKSV=REG14;                  /* SAVE RETURN ADDRESS   @Y30LB33*/ 01119000
         LR    VOLCKSV,REG14                                       0478 01120000
*   OLDERID2=NEWERID2;                                             0479 01121000
         L     @15,@PC00001                                        0479 01122000
         L     @14,GDTTR2(,@15)                                    0479 01123000
         MVC   @TS00001(95),NEWERID2(@14)                          0479 01124000
         MVC   OLDERID2(95,@14),@TS00001                           0479 01125000
*   NEWID2='MVDA';                  /*                       @Y30LB33*/ 01126000
*                                                                  0480 01127000
         MVC   NEWID2(4,@14),@CC01662                              0480 01128000
*   /*****************************************************************/ 01129000
*   /*                                                               */ 01130000
*   /* BUILD THE READ ARGUMENT LIST                          @Y30LB33*/ 01131000
*   /*                                                               */ 01132000
*   /*****************************************************************/ 01133000
*                                                                  0481 01134000
*   RVVI=RVVI&&RVVI;                /*                       @Y30LB33*/ 01135000
         L     @14,RVVIPTR                                         0481 01136000
         XC    RVVI(68,@14),RVVI(@14)                              0481 01137000
*   RVVOLUME=VOLVAL;                /*                       @Y30LB33*/ 01138000
         L     @03,@PC00001+4                                      0482 01139000
         L     @01,FDTPTR(,@03)                                    0482 01140000
         MVC   RVVOLUME(6,@14),VOLVAL(@01)                         0482 01141000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/ 01142000
         LH    @03,RVVLEN                                          0483 01143000
         ST    @03,RVVLNGTH(,@14)                                  0483 01144000
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/ 01145000
         MVI   RVVCODE(@14),X'87'                                  0484 01146000
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Y30LB33*/ 01147000
         LA    @03,VOLRCDBF                                        0485 01148000
         ST    @03,RVVRTBUF(,@14)                                  0485 01149000
*   RVVRDR=ON;                      /*                       @Y30LB33*/ 01150000
         OI    RVVRDR(@14),B'10000000'                             0486 01151000
*   RVVBVRCD=ON;                    /*                       @Y30LB33*/ 01152000
         OI    RVVBVRCD(@14),B'10000000'                           0487 01153000
*   RVVSVOL=ON;                     /*                       @Y30LB33*/ 01154000
         OI    RVVSVOL(@14),B'00000001'                            0488 01155000
*   RVVBUFLN=LENGTH(VOLRCDBF);      /*                       @Y30LB33*/ 01156000
*                                                                  0489 01157000
         MVC   RVVBUFLN(2,@14),@CH01832                            0489 01158000
*   /*****************************************************************/ 01159000
*   /*                                                               */ 01160000
*   /* DUMP THE READ ARGUMENT LIST                           @Y30LB33*/ 01161000
*   /*                                                               */ 01162000
*   /*****************************************************************/ 01163000
*                                                                  0490 01164000
*   IF GDTDBG=NULLPTR THEN                                         0490 01165000
         L     @15,GDTDBG(,@15)                                    0490 01166000
         LTR   @15,@15                                             0490 01167000
         BZ    @RT00490                                            0490 01168000
*     ;                                                            0491 01169000
*   ELSE                                                           0492 01170000
*     DO;                                                          0492 01171000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 01172000
         LA    DMPINDEX,DUMPAREA                                   0493 01173000
*       DMPITMNM='RVVI';                                           0494 01174000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0494 01175000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0494 01176000
         MVC   DMPITMNM(4,DMPINDEX),@CC01663                       0494 01177000
*       DMPITMPT=ADDR(RVVI);                                       0495 01178000
         L     @03,RVVIPTR                                         0495 01179000
         ST    @03,DMPITMPT(,DMPINDEX)                             0495 01180000
*       DMPITMLN=LENGTH(RVVI);                                     0496 01181000
         MVC   DMPITMLN(2,DMPINDEX),@CH01833                       0496 01182000
*       DMPITMTP='H';                                              0497 01183000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0497 01184000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/ 01185000
         AL    DMPINDEX,@CF00507                                   0498 01186000
*       DMPTRM=DMPTRMVL;                                           0499 01187000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0499 01188000
*     END;                          /*                       @Y30LB33*/ 01189000
*   IF GDTDBG=NULLPTR THEN                                         0501 01190000
@RT00490 L     @15,@PC00001                                        0501 01191000
         L     @15,GDTDBG(,@15)                                    0501 01192000
         LTR   @15,@15                                             0501 01193000
         BZ    @RT00501                                            0501 01194000
*     ;                                                            0502 01195000
*   ELSE                                                           0503 01196000
*     CALL IDCDB010(GDTTBL,'MVDB',DUMPADDR);/*               @Y30LB33*/ 01197000
         L     @15,@PC00001                                        0503 01198000
         ST    @15,@AL00001                                        0503 01199000
         LA    @14,@CC01664                                        0503 01200000
         ST    @14,@AL00001+4                                      0503 01201000
         LA    @14,DUMPADDR                                        0503 01202000
         ST    @14,@AL00001+8                                      0503 01203000
         MVI   @AL00001+8,X'80'                                    0503 01204000
         L     @15,GDTDBG(,@15)                                    0503 01205000
         LA    @01,@AL00001                                        0503 01206000
         BALR  @14,@15                                             0503 01207000
*                                                                  0504 01208000
*   /*****************************************************************/ 01209000
*   /*                                                               */ 01210000
*   /* ISSUE USSC TO READ THE VOLUME RECORD                  @Y30LB33*/ 01211000
*   /*                                                               */ 01212000
*   /*****************************************************************/ 01213000
*                                                                  0504 01214000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,RCAREA);/*             @Y30LB33*/ 01215000
@RT00501 L     @02,@PC00001                                        0504 01216000
         ST    @02,@AL00001                                        0504 01217000
         LA    @15,VVIC                                            0504 01218000
         ST    @15,@AL00001+4                                      0504 01219000
         LA    @15,RVVIPTR                                         0504 01220000
         ST    @15,@AL00001+8                                      0504 01221000
         LA    @15,RCAREA                                          0504 01222000
         ST    @15,@AL00001+12                                     0504 01223000
         MVI   @AL00001+12,X'80'                                   0504 01224000
         L     @15,GDTSSC(,@02)                                    0504 01225000
         LA    @01,@AL00001                                        0504 01226000
         BALR  @14,@15                                             0504 01227000
*   RESPECIFY                                                      0505 01228000
*     RTNREG RSTD;                                                 0505 01229000
*   TESTRC=RTNREG;                                                 0506 01230000
         LR    TESTRC,RTNREG                                       0506 01231000
*   RESPECIFY                                                      0507 01232000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 01233000
*                                                                  0507 01234000
*   /*****************************************************************/ 01235000
*   /*                                                               */ 01236000
*   /* IF THE RETURN CODE IS 4, CALL SSCMSG TO PRINT         @Y30LB33*/ 01237000
*   /* THE REASON FOR THE ERROR. ALSO, PRINT IDC2080I        @Y30LB33*/ 01238000
*   /* AND SET THE LASTCOND TO 12 TO INDICATE A              @Y30LB33*/ 01239000
*   /* TERMINATING ERROR                                     @Y30LB33*/ 01240000
*   /*                                                               */ 01241000
*   /*****************************************************************/ 01242000
*                                                                  0508 01243000
*   IF TESTRC=4 THEN                                               0508 01244000
         C     TESTRC,@CF00043                                     0508 01245000
         BNE   @RF00508                                            0508 01246000
*     DO;                           /*                       @Y30LB33*/ 01247000
*       CALL SSCMSG(RCAREA);        /*                       @Y30LB33*/ 01248000
         LA    @15,RCAREA                                          0510 01249000
         ST    @15,@AL00001                                        0510 01250000
         LA    @01,@AL00001                                        0510 01251000
         BAL   @14,SSCMSG                                          0510 01252000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01253000
         L     @15,DDSTRU                                          0511 01254000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0511 01255000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 01256000
         MVC   DARGSMOD(3,@15),MODCMN                              0512 01257000
*       DARGSENT=MSG2080I;          /*                       @Y30LB33*/ 01258000
         MVI   DARGSENT(@15),X'1A'                                 0513 01259000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/ 01260000
         MVC   DARGILP(2,@15),@CH00159                             0514 01261000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/ 01262000
         L     @14,@PC00001+4                                      0515 01263000
         L     @01,FDTPTR(,@14)                                    0515 01264000
         LA    @14,VOLVAL(,@01)                                    0515 01265000
         ST    @14,DARGDBP(,@15)                                   0515 01266000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01267000
         L     @15,@PC00001                                        0516 01268000
         ST    @15,@AL00001                                        0516 01269000
         LA    @14,@CF00117                                        0516 01270000
         ST    @14,@AL00001+4                                      0516 01271000
         LA    @14,DDSTRU                                          0516 01272000
         ST    @14,@AL00001+8                                      0516 01273000
         MVI   @AL00001+8,X'80'                                    0516 01274000
         L     @15,GDTPRT(,@15)                                    0516 01275000
         LA    @01,@AL00001                                        0516 01276000
         BALR  @14,@15                                             0516 01277000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01278000
         L     @15,@PC00001+8                                      0517 01279000
         MVC   LASTCOND(2,@15),@CH00038                            0517 01280000
*     END;                          /*                       @Y30LB33*/ 01281000
*                                                                  0519 01282000
*   /*****************************************************************/ 01283000
*   /*                                                               */ 01284000
*   /* IF WE HAD NO ERRORS READING,                          @Y30LB33*/ 01285000
*   /* TURN ON THE SWITCH TO INDICATE THAT THE               @Y30LB33*/ 01286000
*   /* VOLUME RECORD WAS READ                                @Y30LB33*/ 01287000
*   /*                                                               */ 01288000
*   /*****************************************************************/ 01289000
*                                                                  0519 01290000
*   ELSE                                                           0519 01291000
*     DO;                           /*                       @Y30LB33*/ 01292000
         B     @RC00508                                            0519 01293000
@RF00508 DS    0H                                                  0520 01294000
*       VOLRCD=ON;                  /*                       @Y30LB33*/ 01295000
*                                                                  0520 01296000
         OI    VOLRCD,B'00001000'                                  0520 01297000
*       /*************************************************************/ 01298000
*       /*                                                           */ 01299000
*       /* SINCE THE RECORD WAS READ, CALL BVOLCK TO CHECK   @Y30LB33*/ 01300000
*       /* OUT THE BASE VOLUME AGAINST THE REQUESTED         @Y30LB33*/ 01301000
*       /* CHANGES                                           @Y30LB33*/ 01302000
*       /*                                                           */ 01303000
*       /*************************************************************/ 01304000
*                                                                  0521 01305000
*       CALL BVOLCK;                /*                       @Y30LB33*/ 01306000
         BAL   @14,BVOLCK                                          0521 01307000
*     END;                          /*                       @Y30LB33*/ 01308000
*                                                                  0522 01309000
*   /*****************************************************************/ 01310000
*   /*                                                               */ 01311000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 01312000
*   /*                                                               */ 01313000
*   /*****************************************************************/ 01314000
*                                                                  0523 01315000
*   REG14=VOLCKSV;                  /*                       @Y30LB33*/ 01316000
@RC00508 LR    REG14,VOLCKSV                                       0523 01317000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 01318000
         SLR   @15,@15                                             0524 01319000
@EL00004 DS    0H                                                  0524 01320000
@EF00004 DS    0H                                                  0524 01321000
@ER00004 BR    @14                                                 0524 01322000
*   END VOLCK;                      /*                       @Y30LB33*/ 01323000
*                                                                  0526 01324000
*/********************************************************   @Y30LB33*/ 01325000
*/* PROCEDURE NAME - BVOLCK                                  @Y30LB33*/ 01326000
*/*                                                          @Y30LB33*/ 01327000
*/* FUNCTION - TO CHECK THE VOLUME RECORD AGAINST            @Y30LB33*/ 01328000
*/*      THE REQUESTED CHANGES TO MAKE SURE THAT             @Y30LB33*/ 01329000
*/*      THE CHANGES CAN BE MADE                             @Y30LB33*/ 01330000
*/*                                                          @Y30LB33*/ 01331000
*/*      MESSAGE IDC3074I IS ISSUED IF THE VOLUME IS         @Y30LB33*/ 01332000
*/*      INACTIVE                                            @Y30LB33*/ 01333000
*/*                                                          @Y30LB33*/ 01334000
*/*      MESSAGE IDC3097I IS ISSUED IF THE VOLUME WAS        @Y30LB33*/ 01335000
*/*      INCOMPLETELY CREATED                                @Y30LB33*/ 01336000
*/*                                                          @Y30LB33*/ 01337000
*/*      MESSAGE IDC3096I IS ISSUED IF THE VOLUME WAS        @Y30LB33*/ 01338000
*/*      INCOMPLETELY COPIED                                 @Y30LB33*/ 01339000
*/*                                                          @Y30LB33*/ 01340000
*/*      MESSAGE IDC3095I IS ISSUED IF THE VOLUME HAS        @Y30LB33*/ 01341000
*/*      A LABEL MISMATCH AND THE USER HAS NOT SPECIFIED     @Y30LB33*/ 01342000
*/*      A NEWSERIAL PARAMETER                               @Y30LB33*/ 01343000
*/*                                                          @Y30LB33*/ 01344000
*/*      MESSAGE IDC3092I IS ISSUED IF THE VOLUME HAS        @Y30LB33*/ 01345000
*/*      A LABEL MISMATCH AND THE FILE PARAMETER WAS         @Y30LB33*/ 01346000
*/*      NOT PROVIDED BY THE USER                            @Y30LB33*/ 01347000
*/*                                                          @Y30LB33*/ 01348000
*/*      MESSAGE IDC3861I IS ISSUED IF THE USER SPECIFIED    @Y30LB33*/ 01349000
*/*      GROUP CHARACTERISTICS FOR A NON-GROUPED VOLUME      @Y30LB33*/ 01350000
*/*                                                          @Y30LB33*/ 01351000
*/* INPUT - THE INPUT PARAMETERS IN THE FDTTBL AND THE       @Y30LB33*/ 01352000
*/*      VOLUME RECORD                                       @Y30LB33*/ 01353000
*/*                                                          @Y30LB33*/ 01354000
*/* OUTPUT - LASTCOND OF 12 TO TERMINATE PROCESSING IF ANY   @Y30LB33*/ 01355000
*/*      ERRORS CITED IN THE ABOVE FUNCTION DESCRIPTION      @Y30LB33*/ 01356000
*/*      ARE ENCOUNTERED                                     @Y30LB33*/ 01357000
*/********************************************************   @Y30LB33*/ 01358000
*                                                                  0526 01359000
*BVOLCK:                                                           0526 01360000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 01361000
*                                                                  0526 01362000
BVOLCK   DS    0H                                                  0527 01363000
*   /*****************************************************************/ 01364000
*   /*                                                               */ 01365000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 01366000
*   /*                                                               */ 01367000
*   /*****************************************************************/ 01368000
*                                                                  0527 01369000
*   DCL                                                            0527 01370000
*     BVOLSV PTR(31);               /*                       @Y30LB33*/ 01371000
*   BVOLSV=REG14;                   /*                       @Y30LB33*/ 01372000
         LR    BVOLSV,REG14                                        0528 01373000
*   OLDERID2=NEWERID2;                                             0529 01374000
         L     @02,@PC00001                                        0529 01375000
         L     @15,GDTTR2(,@02)                                    0529 01376000
         MVC   @TS00001(95),NEWERID2(@15)                          0529 01377000
         MVC   OLDERID2(95,@15),@TS00001                           0529 01378000
*   NEWID2='MVEA';                  /*                       @Y30LB33*/ 01379000
*                                                                  0530 01380000
         MVC   NEWID2(4,@15),@CC01671                              0530 01381000
*   /*****************************************************************/ 01382000
*   /*                                                               */ 01383000
*   /* IF THE VOLUME IS INACTIVE, PRINT IDC3074I             @Y30LB33*/ 01384000
*   /* AND SET LASTCOND TO 12                                @Y30LB33*/ 01385000
*   /*                                                               */ 01386000
*   /*****************************************************************/ 01387000
*                                                                  0531 01388000
*   IF BASINAC=ON THEN                                             0531 01389000
         TM    BASINAC(BASEVPTR),B'00000100'                       0531 01390000
         BNO   @RF00531                                            0531 01391000
*     DO;                           /*                       @Y30LB33*/ 01392000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01393000
         L     @15,DDSTRU                                          0533 01394000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0533 01395000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 01396000
         MVC   DARGSMOD(3,@15),MODCMN                              0534 01397000
*       DARGSENT=MSG3074I;          /*                       @Y30LB33*/ 01398000
         MVI   DARGSENT(@15),X'20'                                 0535 01399000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/ 01400000
         MVC   DARGILP(2,@15),@CH00159                             0536 01401000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/ 01402000
         L     @14,@PC00001+4                                      0537 01403000
         L     @01,FDTPTR(,@14)                                    0537 01404000
         LA    @14,VOLVAL(,@01)                                    0537 01405000
         ST    @14,DARGDBP(,@15)                                   0537 01406000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01407000
         ST    @02,@AL00001                                        0538 01408000
         LA    @15,@CF00117                                        0538 01409000
         ST    @15,@AL00001+4                                      0538 01410000
         LA    @15,DDSTRU                                          0538 01411000
         ST    @15,@AL00001+8                                      0538 01412000
         MVI   @AL00001+8,X'80'                                    0538 01413000
         L     @15,GDTPRT(,@02)                                    0538 01414000
         LA    @01,@AL00001                                        0538 01415000
         BALR  @14,@15                                             0538 01416000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01417000
         L     @02,@PC00001+8                                      0539 01418000
         MVC   LASTCOND(2,@02),@CH00038                            0539 01419000
*     END;                          /*                       @Y30LB33*/ 01420000
*                                                                  0540 01421000
*   /*****************************************************************/ 01422000
*   /*                                                               */ 01423000
*   /* IF THE VOLUME WAS INCOMPLETELY CREATED,               @Y30LB33*/ 01424000
*   /* PRINT IDC2097I AND SET LASTCOND TO 12                 @YD00175*/ 01425000
*   /*                                                               */ 01426000
*   /*****************************************************************/ 01427000
*                                                                  0541 01428000
*   IF BASIVCRE=ON THEN                                            0541 01429000
@RF00531 TM    BASIVCRE(BASEVPTR),B'10000000'                      0541 01430000
         BNO   @RF00541                                            0541 01431000
*     DO;                           /*                       @Y30LB33*/ 01432000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01433000
         L     @02,DDSTRU                                          0543 01434000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0543 01435000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 01436000
         MVC   DARGSMOD(3,@02),MODCMN                              0544 01437000
*       DARGSENT=MSG2097I;          /*                       @YD00175*/ 01438000
         MVI   DARGSENT(@02),X'03'                                 0545 01439000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/ 01440000
         MVC   DARGILP(2,@02),@CH00159                             0546 01441000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/ 01442000
         L     @15,@PC00001+4                                      0547 01443000
         L     @01,FDTPTR(,@15)                                    0547 01444000
         LA    @15,VOLVAL(,@01)                                    0547 01445000
         ST    @15,DARGDBP(,@02)                                   0547 01446000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01447000
         L     @02,@PC00001                                        0548 01448000
         ST    @02,@AL00001                                        0548 01449000
         LA    @15,@CF00117                                        0548 01450000
         ST    @15,@AL00001+4                                      0548 01451000
         LA    @15,DDSTRU                                          0548 01452000
         ST    @15,@AL00001+8                                      0548 01453000
         MVI   @AL00001+8,X'80'                                    0548 01454000
         L     @15,GDTPRT(,@02)                                    0548 01455000
         LA    @01,@AL00001                                        0548 01456000
         BALR  @14,@15                                             0548 01457000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01458000
         L     @02,@PC00001+8                                      0549 01459000
         MVC   LASTCOND(2,@02),@CH00038                            0549 01460000
*     END;                          /*                       @Y30LB33*/ 01461000
*                                                                  0550 01462000
*   /*****************************************************************/ 01463000
*   /*                                                               */ 01464000
*   /* IF THE VOLUME WAS INCOMPLETELY COPIED, PRINT          @Y30LB33*/ 01465000
*   /* IDC2096I AND SET LASTCOND TO 12                       @YD00175*/ 01466000
*   /*                                                               */ 01467000
*   /*****************************************************************/ 01468000
*                                                                  0551 01469000
*   IF BASIVCPY=ON THEN                                            0551 01470000
@RF00541 TM    BASIVCPY(BASEVPTR),B'01000000'                      0551 01471000
         BNO   @RF00551                                            0551 01472000
*     DO;                           /*                       @Y30LB33*/ 01473000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01474000
         L     @02,DDSTRU                                          0553 01475000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0553 01476000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 01477000
         MVC   DARGSMOD(3,@02),MODCMN                              0554 01478000
*       DARGSENT=MSG2096I;          /*                       @YD00175*/ 01479000
         MVI   DARGSENT(@02),X'06'                                 0555 01480000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/ 01481000
         MVC   DARGILP(2,@02),@CH00159                             0556 01482000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/ 01483000
         L     @15,@PC00001+4                                      0557 01484000
         L     @01,FDTPTR(,@15)                                    0557 01485000
         LA    @15,VOLVAL(,@01)                                    0557 01486000
         ST    @15,DARGDBP(,@02)                                   0557 01487000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01488000
         L     @02,@PC00001                                        0558 01489000
         ST    @02,@AL00001                                        0558 01490000
         LA    @15,@CF00117                                        0558 01491000
         ST    @15,@AL00001+4                                      0558 01492000
         LA    @15,DDSTRU                                          0558 01493000
         ST    @15,@AL00001+8                                      0558 01494000
         MVI   @AL00001+8,X'80'                                    0558 01495000
         L     @15,GDTPRT(,@02)                                    0558 01496000
         LA    @01,@AL00001                                        0558 01497000
         BALR  @14,@15                                             0558 01498000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01499000
         L     @02,@PC00001+8                                      0559 01500000
         MVC   LASTCOND(2,@02),@CH00038                            0559 01501000
*     END;                          /*                       @Y30LB33*/ 01502000
*                                                                  0560 01503000
*   /*****************************************************************/ 01504000
*   /*                                                               */ 01505000
*   /* IF THE LABEL MISMATCH FLAG IS ON AND A NEW            @Y30LB33*/ 01506000
*   /* SERIAL IS NOT SPECIFIED BY THE USER,                  @Y30LB33*/ 01507000
*   /* PRINT IDC2095I AND SET LASTCOND TO 12                 @YD00175*/ 01508000
*   /*                                                               */ 01509000
*   /*****************************************************************/ 01510000
*                                                                  0561 01511000
*   IF BASVSMIS=ON&                 /*                       @Y30LB33*/ 01512000
*       ADDR(NEWSR)=NULLPTR THEN                                   0561 01513000
@RF00551 TM    BASVSMIS(BASEVPTR),B'00100000'                      0561 01514000
         BNO   @RF00561                                            0561 01515000
         L     @02,@PC00001+4                                      0561 01516000
         L     @15,FDTPTR+4(,@02)                                  0561 01517000
         LTR   @15,@15                                             0561 01518000
         BNZ   @RF00561                                            0561 01519000
*     DO;                           /*                       @Y30LB33*/ 01520000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01521000
         L     @15,DDSTRU                                          0563 01522000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0563 01523000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 01524000
         MVC   DARGSMOD(3,@15),MODCMN                              0564 01525000
*       DARGSENT=MSG2095I;          /*                       @YD00175*/ 01526000
         MVI   DARGSENT(@15),X'09'                                 0565 01527000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/ 01528000
         MVC   DARGILP(2,@15),@CH00159                             0566 01529000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/ 01530000
         L     @02,FDTPTR(,@02)                                    0567 01531000
         LA    @02,VOLVAL(,@02)                                    0567 01532000
         ST    @02,DARGDBP(,@15)                                   0567 01533000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01534000
         L     @02,@PC00001                                        0568 01535000
         ST    @02,@AL00001                                        0568 01536000
         LA    @15,@CF00117                                        0568 01537000
         ST    @15,@AL00001+4                                      0568 01538000
         LA    @15,DDSTRU                                          0568 01539000
         ST    @15,@AL00001+8                                      0568 01540000
         MVI   @AL00001+8,X'80'                                    0568 01541000
         L     @15,GDTPRT(,@02)                                    0568 01542000
         LA    @01,@AL00001                                        0568 01543000
         BALR  @14,@15                                             0568 01544000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01545000
         L     @02,@PC00001+8                                      0569 01546000
         MVC   LASTCOND(2,@02),@CH00038                            0569 01547000
*     END;                          /*                       @Y30LB33*/ 01548000
*                                                                  0570 01549000
*   /*****************************************************************/ 01550000
*   /*                                                               */ 01551000
*   /* IF THE LABEL MISMATCH FLAG IS ON BUT NO FILE          @Y30LB33*/ 01552000
*   /* PARAMETER IS SPECIFIED, PRINT IDC3092I AND SET        @Y30LB33*/ 01553000
*   /* LASTCOND TO 12                                        @Y30LB33*/ 01554000
*   /*                                                               */ 01555000
*   /*****************************************************************/ 01556000
*                                                                  0571 01557000
*   IF BASVSMIS=ON&                 /*                       @Y30LB33*/ 01558000
*       ADDR(FYLE)=NULLPTR THEN                                    0571 01559000
@RF00561 TM    BASVSMIS(BASEVPTR),B'00100000'                      0571 01560000
         BNO   @RF00571                                            0571 01561000
         L     @02,@PC00001+4                                      0571 01562000
         L     @15,FDTPTR+88(,@02)                                 0571 01563000
         LTR   @15,@15                                             0571 01564000
         BNZ   @RF00571                                            0571 01565000
*     DO;                           /*                       @Y30LB33*/ 01566000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01567000
         L     @15,DDSTRU                                          0573 01568000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0573 01569000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 01570000
         MVC   DARGSMOD(3,@15),MODCMN                              0574 01571000
*       DARGSENT=MSG3092I;          /*                       @Y30LB33*/ 01572000
         MVI   DARGSENT(@15),X'0E'                                 0575 01573000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/ 01574000
         L     @02,FDTPTR(,@02)                                    0576 01575000
         LA    @02,VOLVAL(,@02)                                    0576 01576000
         ST    @02,DARGDBP(,@15)                                   0576 01577000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/ 01578000
         MVC   DARGILP(2,@15),@CH00159                             0577 01579000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01580000
         L     @02,@PC00001                                        0578 01581000
         ST    @02,@AL00001                                        0578 01582000
         LA    @15,@CF00117                                        0578 01583000
         ST    @15,@AL00001+4                                      0578 01584000
         LA    @15,DDSTRU                                          0578 01585000
         ST    @15,@AL00001+8                                      0578 01586000
         MVI   @AL00001+8,X'80'                                    0578 01587000
         L     @15,GDTPRT(,@02)                                    0578 01588000
         LA    @01,@AL00001                                        0578 01589000
         BALR  @14,@15                                             0578 01590000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01591000
         L     @02,@PC00001+8                                      0579 01592000
         MVC   LASTCOND(2,@02),@CH00038                            0579 01593000
*     END;                          /*                       @Y30LB33*/ 01594000
*                                                                  0580 01595000
*   /*****************************************************************/ 01596000
*   /*                                                               */ 01597000
*   /* IF GROUP ATTRIBUTES ARE SPECIFIED FOR A               @Y30LB33*/ 01598000
*   /* NON-GROUPED VOLUME, PRINT IDC3860I                    @Y30LB33*/ 01599000
*   /* AND SET LASTCOND TO 12                                @Y30LB33*/ 01600000
*   /*                                                               */ 01601000
*   /*****************************************************************/ 01602000
*                                                                  0581 01603000
*   IF(ADDR(NGRP)>NULLPTR|          /*                       @Y30LB33*/ 01604000
*       (BASGRPV=OFF&ADDR(GRP)=NULLPTR))/*                   @Y30LB33*/ 01605000
*       &(ADDR(FORE)>0|ADDR(TO)>0|  /*                       @Y30LB33*/ 01606000
*       ADDR(GNRL)>0|ADDR(RSTR)>0) THEN                            0581 01607000
@RF00571 SLR   @02,@02                                             0581 01608000
         L     @15,@PC00001+4                                      0581 01609000
         C     @02,FDTPTR+76(,@15)                                 0581 01610000
         BL    @GL00033                                            0581 01611000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0581 01612000
         BNZ   @RF00581                                            0581 01613000
         C     @02,FDTPTR+12(,@15)                                 0581 01614000
         BNE   @RF00581                                            0581 01615000
@GL00033 SLR   @02,@02                                             0581 01616000
         L     @15,@PC00001+4                                      0581 01617000
         C     @02,FDTPTR+96(,@15)                                 0581 01618000
         BL    @RT00581                                            0581 01619000
         C     @02,FDTPTR+60(,@15)                                 0581 01620000
         BL    @RT00581                                            0581 01621000
         C     @02,FDTPTR+16(,@15)                                 0581 01622000
         BL    @RT00581                                            0581 01623000
         C     @02,FDTPTR+20(,@15)                                 0581 01624000
         BNL   @RF00581                                            0581 01625000
@RT00581 DS    0H                                                  0582 01626000
*     DO;                           /*                       @Y30LB33*/ 01627000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 01628000
         L     @02,DDSTRU                                          0583 01629000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0583 01630000
*       DARGSMOD=MODMV0;            /*                       @Y30LB33*/ 01631000
         MVC   DARGSMOD(3,@02),MODMV0                              0584 01632000
*       DARGSENT=MSG3860I;          /*                       @Y30LB33*/ 01633000
         MVI   DARGSENT(@02),X'01'                                 0585 01634000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 01635000
         L     @02,@PC00001                                        0586 01636000
         ST    @02,@AL00001                                        0586 01637000
         LA    @15,@CF00117                                        0586 01638000
         ST    @15,@AL00001+4                                      0586 01639000
         LA    @15,DDSTRU                                          0586 01640000
         ST    @15,@AL00001+8                                      0586 01641000
         MVI   @AL00001+8,X'80'                                    0586 01642000
         L     @15,GDTPRT(,@02)                                    0586 01643000
         LA    @01,@AL00001                                        0586 01644000
         BALR  @14,@15                                             0586 01645000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 01646000
         L     @02,@PC00001+8                                      0587 01647000
         MVC   LASTCOND(2,@02),@CH00038                            0587 01648000
*     END;                          /*                       @Y30LB33*/ 01649000
*                                                                  0588 01650000
*   /*****************************************************************/ 01651000
*   /*                                                               */ 01652000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 01653000
*   /*                                                               */ 01654000
*   /*****************************************************************/ 01655000
*                                                                  0589 01656000
*   REG14=BVOLSV;                   /*                       @Y30LB33*/ 01657000
@RF00581 LR    REG14,BVOLSV                                        0589 01658000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 01659000
         SLR   @15,@15                                             0590 01660000
@EL00005 DS    0H                                                  0590 01661000
@EF00005 DS    0H                                                  0590 01662000
@ER00005 BR    @14                                                 0590 01663000
*   END BVOLCK;                     /*                       @Y30LB33*/ 01664000
*                                                                  0592 01665000
*/********************************************************   @Y30LB33*/ 01666000
*/* PROCEDURE NAME - GRPPROC                                 @Y30LB33*/ 01667000
*/*                                                          @Y30LB33*/ 01668000
*/* FUNCTION - TO DETERMINE, FROM THE VOLUME INVENTORY       @Y30LB33*/ 01669000
*/*      RECORD AND THE USER'S PARAMETERS, IF THE VOLUME     @Y30LB33*/ 01670000
*/*      IS GOING TO BE A GROUPED-GENERAL VOLUME AFTER       @Y30LB33*/ 01671000
*/*      MODIFICATION AND IF THE GROUP'S ATTRIBUTES WILL     @Y30LB33*/ 01672000
*/*      HAVE TO BE IMPOSED ON THE VOLUME                    @Y30LB33*/ 01673000
*/*                                                          @Y30LB33*/ 01674000
*/*      THE SWCHBITS SET IN THIS ROUTINE ARE                @Y30LB33*/ 01675000
*/*                                                          @Y30LB33*/ 01676000
*/*            NEWGENSW                                      @Y30LB33*/ 01677000
*/*                                                          @Y30LB33*/ 01678000
*/*      IF THE VOLUME'S GROUP MUST BE INSPECTED FOR         @Y30LB33*/ 01679000
*/*      ATTRIBUTE CHANGES, THE GRPCHK ROUTINE IS            @Y30LB33*/ 01680000
*/*      CALLED                                              @Y30LB33*/ 01681000
*/*                                                          @Y30LB33*/ 01682000
*/* INPUT - THE USER'S PARAMETERS IN THE FDTTBL AND THE      @Y30LB33*/ 01683000
*/*      VOLUME RECORD                                       @Y30LB33*/ 01684000
*/*                                                          @Y30LB33*/ 01685000
*/* OUTPUT - THE NEWGENSW IS SET IF THE VOLUME IS BECOMING   @Y30LB33*/ 01686000
*/*      GENERAL, OR IF THE VOLUME'S ATTRIBUTES ARE CHANGING @Y30LB33*/ 01687000
*/*      TO AGREE WITH THE GROUP                             @Y30LB33*/ 01688000
*/********************************************************   @Y30LB33*/ 01689000
*                                                                  0592 01690000
*GRPPROC:                                                          0592 01691000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 01692000
*                                                                  0592 01693000
GRPPROC  DS    0H                                                  0593 01694000
*   /*****************************************************************/ 01695000
*   /*                                                               */ 01696000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 01697000
*   /*                                                               */ 01698000
*   /*****************************************************************/ 01699000
*                                                                  0593 01700000
*   DCL                                                            0593 01701000
*     GRPROCSV PTR(31);             /*                       @Y30LB33*/ 01702000
*   GRPROCSV=REG14;                 /*                       @Y30LB33*/ 01703000
         ST    REG14,GRPROCSV                                      0594 01704000
*   OLDERID2=NEWERID2;                                             0595 01705000
         L     @07,@PC00001                                        0595 01706000
         L     @07,GDTTR2(,@07)                                    0595 01707000
         MVC   @TS00001(95),NEWERID2(@07)                          0595 01708000
         MVC   OLDERID2(95,@07),@TS00001                           0595 01709000
*   NEWID2='MVGB';                  /*                       @ZA09560*/ 01710000
*                                                                  0596 01711000
         MVC   NEWID2(4,@07),@CC01676                              0596 01712000
*   /*****************************************************************/ 01713000
*   /*                                                               */ 01714000
*   /* TURN ON THE NEW-GENERAL SWITCH IF THE VOLUME          @Y30LB33*/ 01715000
*   /* WILL BECOME A GENERAL VOLUME IN A NEW GROUP           @Y30LB33*/ 01716000
*   /*                                                               */ 01717000
*   /*****************************************************************/ 01718000
*                                                                  0597 01719000
*   IF                              /*                       @Y30LB33*/ 01720000
*       (ADDR(GRP)>0&BASGENUS=ON&   /*                       @Y30LB33*/ 01721000
*       ADDR(RSTR)=0)|              /*                       @Y30LB33*/ 01722000
*                                                                  0597 01723000
*   /*****************************************************************/ 01724000
*   /*                                                               */ 01725000
*   /* IF IT IS GROUPED AND RESTRICTED                       @Y30LB33*/ 01726000
*   /* NOW BUT WILL BE GENERAL                               @Y30LB33*/ 01727000
*   /*                                                               */ 01728000
*   /*****************************************************************/ 01729000
*                                                                  0597 01730000
*       (BASRSTD=ON&ADDR(GNRL)>0)|  /*                       @Y30LB33*/ 01731000
*                                                                  0597 01732000
*   /*****************************************************************/ 01733000
*   /*                                                               */ 01734000
*   /* OR, IF IT IS NOT GROUPED NOW AND                      @Y30LB33*/ 01735000
*   /* WILL BECOME GROUPED AND GENERAL                       @Y30LB33*/ 01736000
*   /*                                                               */ 01737000
*   /*****************************************************************/ 01738000
*                                                                  0597 01739000
*       (BASGRPV=OFF&ADDR(GRP)>0&   /*                       @Y30LB33*/ 01740000
*       ADDR(GNRL)>0)|              /*                       @Y30LB33*/ 01741000
*                                                                  0597 01742000
*   /*****************************************************************/ 01743000
*   /*                                                               */ 01744000
*   /* OR, IF IT IS NOT GROUPED NOW AND                      @Y30LB33*/ 01745000
*   /* IT WILL BECOME GROUPED BUT RESTRICTED                 @Y30LB33*/ 01746000
*   /* IS NOT SPECIFIED                                      @Y30LB33*/ 01747000
*   /*                                                               */ 01748000
*   /*****************************************************************/ 01749000
*                                                                  0597 01750000
*       (BASGRPV=OFF&ADDR(RSTR)=0&  /*                       @Y30LB33*/ 01751000
*       ADDR(GRP)>0)                /*                       @G24LB23*/ 01752000
*     THEN                                                         0597 01753000
         SLR   @07,@07                                             0597 01754000
         L     @15,@PC00001+4                                      0597 01755000
         C     @07,FDTPTR+12(,@15)                                 0597 01756000
         BNL   @GL00041                                            0597 01757000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0597 01758000
         BNO   @GL00041                                            0597 01759000
         C     @07,FDTPTR+20(,@15)                                 0597 01760000
         BE    @RT00597                                            0597 01761000
@GL00041 TM    BASRSTD(BASEVPTR),B'00001000'                       0597 01762000
         BNO   @GL00040                                            0597 01763000
         L     @07,@PC00001+4                                      0597 01764000
         L     @07,FDTPTR+16(,@07)                                 0597 01765000
         LTR   @07,@07                                             0597 01766000
         BP    @RT00597                                            0597 01767000
@GL00040 TM    BASGRPV(BASEVPTR),B'00100000'                       0597 01768000
         BNZ   @GL00039                                            0597 01769000
         SLR   @07,@07                                             0597 01770000
         L     @15,@PC00001+4                                      0597 01771000
         C     @07,FDTPTR+12(,@15)                                 0597 01772000
         BNL   @GL00039                                            0597 01773000
         C     @07,FDTPTR+16(,@15)                                 0597 01774000
         BL    @RT00597                                            0597 01775000
@GL00039 TM    BASGRPV(BASEVPTR),B'00100000'                       0597 01776000
         BNZ   @RF00597                                            0597 01777000
         SLR   @07,@07                                             0597 01778000
         L     @15,@PC00001+4                                      0597 01779000
         C     @07,FDTPTR+20(,@15)                                 0597 01780000
         BNE   @RF00597                                            0597 01781000
         C     @07,FDTPTR+12(,@15)                                 0597 01782000
         BNL   @RF00597                                            0597 01783000
@RT00597 DS    0H                                                  0598 01784000
*     DO;                           /*                       @G24LB23*/ 01785000
*       NEWGENSW=ON;                /*                       @G24LB23*/ 01786000
*                                                                  0599 01787000
         OI    NEWGENSW,B'00000100'                                0599 01788000
*       /*************************************************************/ 01789000
*       /*                                                           */ 01790000
*       /* CALL THE ROUTINE THAT CHECKS FOR A DOWN LEVEL     @G24LB23*/ 01791000
*       /* SPACE PROBLEM WITH A GROUPED GENERAL-USE          @G24LB23*/ 01792000
*       /* VOLUME                                            @G24LB23*/ 01793000
*       /*                                                           */ 01794000
*       /*************************************************************/ 01795000
*                                                                  0600 01796000
*       CALL DLSPCHK;               /*                       @G24LB23*/ 01797000
         BAL   @14,DLSPCHK                                         0600 01798000
*     END;                          /*                       @G24LB23*/ 01799000
*                                                                  0601 01800000
*   /*****************************************************************/ 01801000
*   /*                                                               */ 01802000
*   /* TURN ON THE NEW GENERAL SWITCH IF THE VOLUME          @G24LB23*/ 01803000
*   /* IS NOW GROUP-GENERAL AND THE                          @G24LB23*/ 01804000
*   /* ONLY CHANGE IS THAT NEW ATTRIBUTES                    #Y30LB33*/ 01805000
*   /* WILL BE ASSIGNED                                      #Y30LB33*/ 01806000
*   /*                                                               */ 01807000
*   /*****************************************************************/ 01808000
*                                                                  0602 01809000
*   ELSE                                                           0602 01810000
*     IF(BASGENUS=ON&               /*                       @G24LB23*/ 01811000
*         ADDR(GRP)=0&ADDR(NGRP)=0& /*                       #Y30LB33*/ 01812000
*         ADDR(RSTR)=0&ATTRSW=ON)   /*                       #Y30LB33*/ 01813000
*       THEN                                                       0602 01814000
         B     @RC00597                                            0602 01815000
@RF00597 TM    BASGENUS(BASEVPTR),B'00010000'                      0602 01816000
         BNO   @RF00602                                            0602 01817000
         SLR   @07,@07                                             0602 01818000
         L     @15,@PC00001+4                                      0602 01819000
         C     @07,FDTPTR+12(,@15)                                 0602 01820000
         BNE   @RF00602                                            0602 01821000
         C     @07,FDTPTR+76(,@15)                                 0602 01822000
         BNE   @RF00602                                            0602 01823000
         C     @07,FDTPTR+20(,@15)                                 0602 01824000
         BNE   @RF00602                                            0602 01825000
         TM    ATTRSW,B'00100000'                                  0602 01826000
         BNO   @RF00602                                            0602 01827000
*       NEWGENSW=ON;                /*                       @G24LB23*/ 01828000
         OI    NEWGENSW,B'00000100'                                0603 01829000
*   IF NEWGENSW=ON&LASTCOND^=TERMCODE THEN                         0604 01830000
*                                                                  0604 01831000
@RF00602 DS    0H                                                  0604 01832000
@RC00597 TM    NEWGENSW,B'00000100'                                0604 01833000
         BNO   @RF00604                                            0604 01834000
         L     @07,@PC00001+8                                      0604 01835000
         CLC   LASTCOND(2,@07),@CH00038                            0604 01836000
         BE    @RF00604                                            0604 01837000
*     /***************************************************************/ 01838000
*     /*                                                             */ 01839000
*     /* IF THE NEW GENERAL SWITCH IS ON                     @G24LB23*/ 01840000
*     /* THEN CALL THE ROUTINE THAT CHECKS THE               #Y30LB33*/ 01841000
*     /* GROUP RECORD AGAINST THE PROPOSED                   #Y30LB33*/ 01842000
*     /* VOLUME ATTRIBUTES                                   #Y30LB33*/ 01843000
*     /*                                                             */ 01844000
*     /***************************************************************/ 01845000
*                                                                  0605 01846000
*     CALL GRPCHK;                  /*                       #Y30LB33*/ 01847000
*                                                                  0605 01848000
         BAL   @14,GRPCHK                                          0605 01849000
*   /*****************************************************************/ 01850000
*   /*                                                               */ 01851000
*   /* RESTORE RETURN ADDRESS                                #Y30LB33*/ 01852000
*   /*                                                               */ 01853000
*   /*****************************************************************/ 01854000
*                                                                  0606 01855000
*   REG14=GRPROCSV;                 /*                       #Y30LB33*/ 01856000
@RF00604 L     REG14,GRPROCSV                                      0606 01857000
*   RETURN CODE(0);                 /*                       #Y30LB33*/ 01858000
         SLR   @15,@15                                             0607 01859000
@EL00006 DS    0H                                                  0607 01860000
@EF00006 DS    0H                                                  0607 01861000
@ER00006 BR    @14                                                 0607 01862000
*   END GRPPROC;                    /*                       #Y30LB33*/ 01863000
*                                                                  0609 01864000
*/********************************************************** @G24LB23*/ 01865000
*/* PROCEDURE NAME - DLSPCHK                                 @G24LB23*/ 01866000
*/*                                                          @G24LB23*/ 01867000
*/* FUNCTION - FOR A VOLUME THAT IS TO BE GENERAL-USE IN     @G24LB23*/ 01868000
*/*            A GROUP OTHER THAN SYSGROUP, TO MAKE SURE     @G24LB23*/ 01869000
*/*            THAT IF THE VOLUME'S DOWN LEVEL SPACE FLAG    @G24LB23*/ 01870000
*/*            IS ON THAT THE VOLUME IS MOUNTED OR GETS      @G24LB23*/ 01871000
*/*            MOUNTED SO THAT SPACE WILL BE UPDATED AT      @G24LB23*/ 01872000
*/*            DEMOUNT TIME.                                 @G24LB23*/ 01873000
*/*                                                          @G24LB23*/ 01874000
*/* INPUT - THE FDTTBL, AND THE BASE VOLUME RECORD           @G24LB23*/ 01875000
*/*                                                          @G24LB23*/ 01876000
*/* OUTPUT - THE LASTCOND IS SET TO 12 AND MESSAGE IDC3114I  @G24LB23*/ 01877000
*/* IS PRINTED IF THE VOLUME'S DOWN LEVEL SPACE FLAG IS ON,  @G24LB23*/ 01878000
*/* THE VOLUME IS NOT MOUNTED, AND THE ATTEMPT BY THIS       @G24LB23*/ 01879000
*/* ROUTINE TO MOUNT THE VOLUME FAILS.                       @G24LB23*/ 01880000
*/*                                                          @G24LB23*/ 01881000
*/********************************************************** @G24LB23*/ 01882000
*                                                                  0609 01883000
*DLSPCHK:                                                          0609 01884000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB23*/ 01885000
*                                                                  0609 01886000
DLSPCHK  DS    0H                                                  0610 01887000
*   /*****************************************************************/ 01888000
*   /*                                                               */ 01889000
*   /* RETURN ADDRESS SAVE AREA                              @G24LB23*/ 01890000
*   /*                                                               */ 01891000
*   /*****************************************************************/ 01892000
*                                                                  0610 01893000
*   DCL                                                            0610 01894000
*     DLSPCHSV PTR(31);             /*                       @G24LB23*/ 01895000
*   DCL                                                            0611 01896000
*     DLSDDN CHAR(8);               /* DDNAME RETURN AREA    @G24LB23*/ 01897000
*   DCL                                                            0612 01898000
*     DLSUCB PTR(31);               /* UCB ADDR RETURN AREA          */ 01899000
*   DLSPCHSV=REG14;                 /*                       @G24LB23*/ 01900000
         LR    DLSPCHSV,REG14                                      0613 01901000
*   OLDERID2=NEWERID2;                                             0614 01902000
         L     @15,@PC00001                                        0614 01903000
         L     @15,GDTTR2(,@15)                                    0614 01904000
         MVC   @TS00001(95),NEWERID2(@15)                          0614 01905000
         MVC   OLDERID2(95,@15),@TS00001                           0614 01906000
*   NEWID2='MVDL';                  /*                       @G24LB23*/ 01907000
*                                                                  0615 01908000
         MVC   NEWID2(4,@15),@CC01685                              0615 01909000
*   /*****************************************************************/ 01910000
*   /*                                                               */ 01911000
*   /* IF THE GROUP IN WHICH THE VOLUME WILL BE              @G24LB23*/ 01912000
*   /* GENERAL-USE IS NOT SYSGROUP, THE VOLUME'S DOWN        @G24LB23*/ 01913000
*   /* LEVEL SPACE FLAG IS ON, AND THE VOLUME IS NOT         @G24LB23*/ 01914000
*   /* ALREADY GOING TO BE MOUNTED FOR A RENAME              @G24LB23*/ 01915000
*   /* OPERATION, THEN THIS ROUTINE MUST MAKE SURE           @G24LB23*/ 01916000
*   /* THAT THE VOLUME IS MOUNTED OR GETS MOUNTED            @G24LB23*/ 01917000
*   /*                                                               */ 01918000
*   /*****************************************************************/ 01919000
*                                                                  0616 01920000
*   IF((ADDR(GRP)>0&GRPVAL^=SYSGROUP)|(ADDR(GRP)=0&BASGROUP^=SYSGROUP)) 01921000
*       &BASDLSF=ON&RENAMSW=OFF&BASVSMIS=OFF THEN                  0616 01922000
         L     @15,@PC00001+4                                      0616 01923000
         L     @15,FDTPTR+12(,@15)                                 0616 01924000
         LTR   @15,@15                                             0616 01925000
         BNP   @GL00057                                            0616 01926000
         CLC   GRPVAL(8,@15),@CC01573                              0616 01927000
         BNE   @GL00056                                            0616 01928000
@GL00057 L     @15,@PC00001+4                                      0616 01929000
         L     @15,FDTPTR+12(,@15)                                 0616 01930000
         LTR   @15,@15                                             0616 01931000
         BNZ   @RF00616                                            0616 01932000
         CLC   BASGROUP(8,BASEVPTR),@CC01573                       0616 01933000
         BE    @RF00616                                            0616 01934000
@GL00056 TM    BASDLSF(BASEVPTR),B'10000000'                       0616 01935000
         BNO   @RF00616                                            0616 01936000
         TM    RENAMSW,B'01000000'                                 0616 01937000
         BNZ   @RF00616                                            0616 01938000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0616 01939000
         BNZ   @RF00616                                            0616 01940000
*     DO;                           /*                       @G24LB23*/ 01941000
*                                                                  0617 01942000
*       /*************************************************************/ 01943000
*       /*                                                           */ 01944000
*       /* FILE DD SPECIFIED?                                @G24LB23*/ 01945000
*       /*                                                           */ 01946000
*       /*************************************************************/ 01947000
*                                                                  0618 01948000
*       IF ADDR(FYLE)>0 THEN                                       0618 01949000
         L     @15,@PC00001+4                                      0618 01950000
         L     @14,FDTPTR+88(,@15)                                 0618 01951000
         LTR   @14,@14                                             0618 01952000
         BNP   @RF00618                                            0618 01953000
*         DO;                       /*                       @G24LB23*/ 01954000
*                                                                  0619 01955000
*           /*********************************************************/ 01956000
*           /*                                                       */ 01957000
*           /* FILE DD SPECIFIED                             @G24LB23*/ 01958000
*           /* CHECK TO MAKE CERTAIN VOLUME IS MOUNTED       @G24LB23*/ 01959000
*           /*                                                       */ 01960000
*           /*********************************************************/ 01961000
*                                                                  0620 01962000
*           SELAGL=SELAGL&&SELAGL;  /*                       @G24LB23*/ 01963000
         LA    @02,MVSELAGL                                        0620 01964000
         XC    SELAGL(23,@02),SELAGL(@02)                          0620 01965000
*           SELVOL=VOLVAL;          /*                       @G24LB23*/ 01966000
         L     @01,FDTPTR(,@15)                                    0621 01967000
         MVC   SELVOL(6,@02),VOLVAL(@01)                           0621 01968000
*           SELDDNP=ADDR(DLSDDN);   /*                       @G24LB23*/ 01969000
         LA    @15,DLSDDN                                          0622 01970000
         ST    @15,SELDDNP(,@02)                                   0622 01971000
*           SELUCBP=ADDR(DLSUCB);   /*                       @G24LB23*/ 01972000
         LA    @15,DLSUCB                                          0623 01973000
         ST    @15,SELUCBP(,@02)                                   0623 01974000
*           CALL IDCSA060(GDTTBL,SELECTDD,SELAGL);/*         @G24LB23*/ 01975000
         L     @15,@PC00001                                        0624 01976000
         ST    @15,@AL00001                                        0624 01977000
         LA    @14,SELECTDD                                        0624 01978000
         ST    @14,@AL00001+4                                      0624 01979000
         ST    @02,@AL00001+8                                      0624 01980000
         MVI   @AL00001+8,X'80'                                    0624 01981000
         L     @15,GDTUNT(,@15)                                    0624 01982000
         LA    @01,@AL00001                                        0624 01983000
         BALR  @14,@15                                             0624 01984000
*           RESPECIFY                                              0625 01985000
*             RTNREG RSTD;                                         0625 01986000
*           TESTRC=RTNREG;                                         0626 01987000
         LR    TESTRC,RTNREG                                       0626 01988000
*           RESPECIFY                                              0627 01989000
*             RTNREG UNRSTD;        /*                       @G24LB23*/ 01990000
*                                                                  0627 01991000
*           /*********************************************************/ 01992000
*           /*                                                       */ 01993000
*           /* VOLUME MOUNTED?                               @G24LB23*/ 01994000
*           /*                                                       */ 01995000
*           /*********************************************************/ 01996000
*                                                                  0628 01997000
*           IF TESTRC^=0 THEN                                      0628 01998000
         LTR   TESTRC,TESTRC                                       0628 01999000
         BZ    @RF00628                                            0628 02000000
*             DO;                   /*                       @G24LB23*/ 02001000
*                                                                  0629 02002000
*               /*****************************************************/ 02003000
*               /*                                                   */ 02004000
*               /* VOLUME IS NOT MOUNTED, ERROR CONDITION    @G24LB23*/ 02005000
*               /*                                                   */ 02006000
*               /*****************************************************/ 02007000
*                                                                  0630 02008000
*               DARGLIST=DARGLIST&&DARGLIST;/*               @G24LB23*/ 02009000
         L     @15,DDSTRU                                          0630 02010000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0630 02011000
*               DARGSMOD=MODCMN;    /*                       @G24LB23*/ 02012000
         MVC   DARGSMOD(3,@15),MODCMN                              0631 02013000
*               DARGSENT=MSG3114I;  /*                       @G24LB23*/ 02014000
         MVI   DARGSENT(@15),X'46'                                 0632 02015000
*               DARGDBP=ADDR(VOLVAL);/*                      @G24LB23*/ 02016000
         L     @14,@PC00001+4                                      0633 02017000
         L     @01,FDTPTR(,@14)                                    0633 02018000
         LA    @14,VOLVAL(,@01)                                    0633 02019000
         ST    @14,DARGDBP(,@15)                                   0633 02020000
*               DARGILP=LENGTH(VOLVAL);/*                    @G24LB23*/ 02021000
         MVC   DARGILP(2,@15),@CH00159                             0634 02022000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @G24LB23*/ 02023000
         L     @15,@PC00001                                        0635 02024000
         ST    @15,@AL00001                                        0635 02025000
         LA    @14,@CF00117                                        0635 02026000
         ST    @14,@AL00001+4                                      0635 02027000
         LA    @14,DDSTRU                                          0635 02028000
         ST    @14,@AL00001+8                                      0635 02029000
         MVI   @AL00001+8,X'80'                                    0635 02030000
         L     @15,GDTPRT(,@15)                                    0635 02031000
         LA    @01,@AL00001                                        0635 02032000
         BALR  @14,@15                                             0635 02033000
*               LASTCOND=TERMCODE;  /*                       @G24LB23*/ 02034000
         L     @15,@PC00001+8                                      0636 02035000
         MVC   LASTCOND(2,@15),@CH00038                            0636 02036000
*             END;                  /*                       @G24LB23*/ 02037000
*         END;                      /*                       @G24LB23*/ 02038000
*       ELSE                                                       0639 02039000
*         DO;                       /*                       @G24LB23*/ 02040000
*                                                                  0639 02041000
         B     @RC00618                                            0639 02042000
@RF00618 DS    0H                                                  0640 02043000
*           /*********************************************************/ 02044000
*           /*                                                       */ 02045000
*           /* FILE DD NOT SPECIFIED, DYNAMICALLY ALLOCATE   @G24LB23*/ 02046000
*           /* THE VOLUME                                    @G24LB23*/ 02047000
*           /*                                                       */ 02048000
*           /*********************************************************/ 02049000
*                                                                  0640 02050000
*           ALLAGL=ALLAGL&&ALLAGL;  /*                       @G24LB23*/ 02051000
         LA    @02,MVALLAGL                                        0640 02052000
         XC    ALLAGL(31,@02),ALLAGL(@02)                          0640 02053000
*           MVALLUNO=1;             /*                       @G24LB23*/ 02054000
         LA    @02,1                                               0641 02055000
         STH   @02,MVALLUNO                                        0641 02056000
*           MVALLULN=LENGTH(MVUNIT);/*                       @G24LB23*/ 02057000
         MVC   MVALLULN(2),@CH00297                                0642 02058000
*           MVALLUNT=MVUNIT;        /*                       @G24LB23*/ 02059000
         MVI   MVALLUNT+5,C' '                                     0643 02060000
         MVC   MVALLUNT+6(2),MVALLUNT+5                            0643 02061000
         MVC   MVALLUNT(5),@CC01570                                0643 02062000
*           ALLULP=ADDR(MVALLUNO);  /*                       @G24LB23*/ 02063000
         LA    @15,MVALLAGL                                        0644 02064000
         LA    @14,MVALLUNO                                        0644 02065000
         ST    @14,ALLULP(,@15)                                    0644 02066000
*           MVALLVNO=1;             /*                       @G24LB23*/ 02067000
         STH   @02,MVALLVNO                                        0645 02068000
*           MVALLVLN=LENGTH(VOLVAL);/*                       @G24LB23*/ 02069000
         MVC   MVALLVLN(2),@CH00159                                0646 02070000
*           MVALLVOL=VOLVAL;        /*                       @G24LB23*/ 02071000
         L     @02,@PC00001+4                                      0647 02072000
         L     @02,FDTPTR(,@02)                                    0647 02073000
         MVC   MVALLVOL(6),VOLVAL(@02)                             0647 02074000
*           ALLVLP=ADDR(MVALLVNO);  /*                       @G24LB23*/ 02075000
         LA    @02,MVALLVNO                                        0648 02076000
         ST    @02,ALLVLP(,@15)                                    0648 02077000
*           ALLOPTVL=ON;            /*                       @G24LB23*/ 02078000
         OI    ALLOPTVL(@15),B'10000000'                           0649 02079000
*           ALLVLCNT=1;             /*                       @G24LB23*/ 02080000
         MVI   ALLVLCNT(@15),X'01'                                 0650 02081000
*           ALLUNCNT=1;             /*                       @G24LB23*/ 02082000
         MVI   ALLUNCNT(@15),X'01'                                 0651 02083000
*           ALLOPTPV=ON;            /*                       @G24LB23*/ 02084000
*                                                                  0652 02085000
         OI    ALLOPTPV(@15),B'00100000'                           0652 02086000
*           /*********************************************************/ 02087000
*           /*                                                       */ 02088000
*           /* ISSUE UALLOC TO MOUNT THE VOLUME              @G24LB23*/ 02089000
*           /*                                                       */ 02090000
*           /*********************************************************/ 02091000
*                                                                  0653 02092000
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @G24LB23*/ 02093000
         L     @02,@PC00001                                        0653 02094000
         ST    @02,@AL00001                                        0653 02095000
         ST    @15,@AL00001+4                                      0653 02096000
         MVI   @AL00001+4,X'80'                                    0653 02097000
         L     @15,GDTALC(,@02)                                    0653 02098000
         LA    @01,@AL00001                                        0653 02099000
         BALR  @14,@15                                             0653 02100000
*           RESPECIFY                                              0654 02101000
*             RTNREG RSTD;                                         0654 02102000
*           TESTRC=RTNREG;                                         0655 02103000
         LR    TESTRC,RTNREG                                       0655 02104000
*           RESPECIFY                                              0656 02105000
*             RTNREG UNRSTD;        /*                       @G24LB23*/ 02106000
*                                                                  0656 02107000
*           /*********************************************************/ 02108000
*           /*                                                       */ 02109000
*           /* IF UALLOC FAILS, SET LASTCOND AND PRINT       @G24LB23*/ 02110000
*           /* ERROR MESSAGE                                 @G24LB23*/ 02111000
*           /*                                                       */ 02112000
*           /*********************************************************/ 02113000
*                                                                  0657 02114000
*           IF TESTRC^=0 THEN                                      0657 02115000
         LTR   TESTRC,TESTRC                                       0657 02116000
         BZ    @RF00657                                            0657 02117000
*             DO;                   /*                       @G24LB23*/ 02118000
*               DARGLIST=DARGLIST&&DARGLIST;/*               @G24LB23*/ 02119000
         L     @15,DDSTRU                                          0659 02120000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0659 02121000
*               DARGSMOD=MODCMN;    /*                       @G24LB23*/ 02122000
         MVC   DARGSMOD(3,@15),MODCMN                              0660 02123000
*               DARGSENT=MSG3114I;  /*                       @G24LB23*/ 02124000
         MVI   DARGSENT(@15),X'46'                                 0661 02125000
*               DARGDBP=ADDR(VOLVAL);/*                      @G24LB23*/ 02126000
         L     @14,@PC00001+4                                      0662 02127000
         L     @01,FDTPTR(,@14)                                    0662 02128000
         LA    @14,VOLVAL(,@01)                                    0662 02129000
         ST    @14,DARGDBP(,@15)                                   0662 02130000
*               DARGILP=LENGTH(VOLVAL);/*                    @G24LB23*/ 02131000
         MVC   DARGILP(2,@15),@CH00159                             0663 02132000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @G24LB23*/ 02133000
         L     @15,@PC00001                                        0664 02134000
         ST    @15,@AL00001                                        0664 02135000
         LA    @14,@CF00117                                        0664 02136000
         ST    @14,@AL00001+4                                      0664 02137000
         LA    @14,DDSTRU                                          0664 02138000
         ST    @14,@AL00001+8                                      0664 02139000
         MVI   @AL00001+8,X'80'                                    0664 02140000
         L     @15,GDTPRT(,@15)                                    0664 02141000
         LA    @01,@AL00001                                        0664 02142000
         BALR  @14,@15                                             0664 02143000
*               LASTCOND=TERMCODE;  /*                       @G24LB23*/ 02144000
         L     @15,@PC00001+8                                      0665 02145000
         MVC   LASTCOND(2,@15),@CH00038                            0665 02146000
*             END;                  /*                       @G24LB23*/ 02147000
*           ELSE                                                   0667 02148000
*             DO;                   /*                       @G24LB23*/ 02149000
*                                                                  0667 02150000
         B     @RC00657                                            0667 02151000
@RF00657 DS    0H                                                  0668 02152000
*               /*****************************************************/ 02153000
*               /*                                                   */ 02154000
*               /* DEMOUNT THE VOLUME                        @VS44255*/ 02155000
*               /*                                                   */ 02156000
*               /*****************************************************/ 02157000
*                                                                  0668 02158000
*               MDAGL=MDAGL&&MDAGL; /*                       @VS44255*/ 02159000
         LA    @02,MVMDAGL                                         0668 02160000
         XC    MDAGL(37,@02),MDAGL(@02)                            0668 02161000
*               MDDDNAME=ALLDDN;    /*                       @VS44255*/ 02162000
         LA    @15,MVALLAGL                                        0669 02163000
         MVC   MDDDNAME(8,@02),ALLDDN(@15)                         0669 02164000
*               MDUCBPTR=ADDR(MVUCBPTR);/*                   @VS44255*/ 02165000
         LA    @15,MVUCBPTR                                        0670 02166000
         ST    @15,MDUCBPTR(,@02)                                  0670 02167000
*               MDLABEL=VOLVAL;     /*                       @VS44255*/ 02168000
         L     @15,@PC00001+4                                      0671 02169000
         L     @01,FDTPTR(,@15)                                    0671 02170000
         MVC   MDLABEL(6,@02),VOLVAL(@01)                          0671 02171000
*               MDWAIT=ON;          /*                       @VS44255*/ 02172000
*                                                                  0672 02173000
         OI    MDWAIT(@02),B'00010000'                             0672 02174000
*               /*****************************************************/ 02175000
*               /*                                                   */ 02176000
*               /* ISSUE DEMOUNT COMMAND                     @VS44255*/ 02177000
*               /*                                                   */ 02178000
*               /*****************************************************/ 02179000
*                                                                  0673 02180000
*               CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*       @VS44255*/ 02181000
         L     @15,@PC00001                                        0673 02182000
         ST    @15,@AL00001                                        0673 02183000
         LA    @14,DEMOUNT                                         0673 02184000
         ST    @14,@AL00001+4                                      0673 02185000
         ST    @02,@AL00001+8                                      0673 02186000
         MVI   @AL00001+8,X'80'                                    0673 02187000
         L     @15,GDTUNT(,@15)                                    0673 02188000
         LA    @01,@AL00001                                        0673 02189000
         BALR  @14,@15                                             0673 02190000
*               RESPECIFY                                          0674 02191000
*                 RTNREG RSTD;                                     0674 02192000
*               TESTRC=RTNREG;                                     0675 02193000
         LR    TESTRC,RTNREG                                       0675 02194000
*               RESPECIFY                                          0676 02195000
*                 RTNREG UNRSTD;    /*                       @VS44255*/ 02196000
*                                                                  0676 02197000
*               /*****************************************************/ 02198000
*               /*                                                   */ 02199000
*               /* IF DEMOUNT FAILED, SET LASTCOND TO 12     @VS44255*/ 02200000
*               /*                                                   */ 02201000
*               /*****************************************************/ 02202000
*                                                                  0677 02203000
*               IF TESTRC^=0 THEN                                  0677 02204000
         LTR   TESTRC,TESTRC                                       0677 02205000
         BZ    @RF00677                                            0677 02206000
*                 LASTCOND=TERMCODE;/*                       @VS44255*/ 02207000
         L     @15,@PC00001+8                                      0678 02208000
         MVC   LASTCOND(2,@15),@CH00038                            0678 02209000
*               ELSE                                               0679 02210000
*                 DO;               /*                       @VS44255*/ 02211000
*                                                                  0679 02212000
         B     @RC00677                                            0679 02213000
@RF00677 DS    0H                                                  0680 02214000
*                   /*************************************************/ 02215000
*                   /*                                               */ 02216000
*                   /* ISSUE UDEALLOC                        @VS44255*/ 02217000
*                   /*                                               */ 02218000
*                   /*************************************************/ 02219000
*                                                                  0680 02220000
*                   CALL IDCSADL0(GDTTBL,ALLAGL);/*          @G24LB23*/ 02221000
         L     @02,@PC00001                                        0680 02222000
         ST    @02,@AL00001                                        0680 02223000
         LA    @15,MVALLAGL                                        0680 02224000
         ST    @15,@AL00001+4                                      0680 02225000
         MVI   @AL00001+4,X'80'                                    0680 02226000
         L     @15,GDTDLC(,@02)                                    0680 02227000
         LA    @01,@AL00001                                        0680 02228000
         BALR  @14,@15                                             0680 02229000
*                   RESPECIFY                                      0681 02230000
*                     RTNREG RSTD;                                 0681 02231000
*                   TESTRC=RTNREG;                                 0682 02232000
         LR    TESTRC,RTNREG                                       0682 02233000
*                   RESPECIFY                                      0683 02234000
*                     RTNREG UNRSTD;/*                       @G24LB23*/ 02235000
*                                                                  0683 02236000
*                   /*************************************************/ 02237000
*                   /*                                               */ 02238000
*                   /* IF UDEALLOC FAILS, SET LASTCOND       @G24LB23*/ 02239000
*                   /*                                               */ 02240000
*                   /*************************************************/ 02241000
*                                                                  0684 02242000
*                   IF TESTRC^=0 THEN                              0684 02243000
         LTR   TESTRC,TESTRC                                       0684 02244000
         BZ    @RF00684                                            0684 02245000
*                     LASTCOND=4;   /*                       @G24LB23*/ 02246000
         L     @15,@PC00001+8                                      0685 02247000
         MVC   LASTCOND(2,@15),@CH00043                            0685 02248000
*                 END;              /*                       @VS44255*/ 02249000
@RF00684 DS    0H                                                  0687 02250000
*             END;                  /*                       @G24LB23*/ 02251000
@RC00677 DS    0H                                                  0688 02252000
*         END;                      /*                       @G24LB23*/ 02253000
@RC00657 DS    0H                                                  0689 02254000
*     END;                          /*                       @G24LB23*/ 02255000
*                                                                  0689 02256000
@RC00618 DS    0H                                                  0690 02257000
*   /*****************************************************************/ 02258000
*   /*                                                               */ 02259000
*   /* RESTORE RETURN ADDRESS                                @G24LB23*/ 02260000
*   /*                                                               */ 02261000
*   /*****************************************************************/ 02262000
*                                                                  0690 02263000
*   REG14=DLSPCHSV;                 /*                       @G24LB23*/ 02264000
@RF00616 LR    REG14,DLSPCHSV                                      0690 02265000
*   RETURN CODE(0);                 /*                       @G24LB23*/ 02266000
         SLR   @15,@15                                             0691 02267000
@EL00007 DS    0H                                                  0691 02268000
@EF00007 DS    0H                                                  0691 02269000
@ER00007 BR    @14                                                 0691 02270000
*   END DLSPCHK;                    /*                       @G24LB23*/ 02271000
*                                                                  0693 02272000
*/********************************************************   #Y30LB33*/ 02273000
*/* PROCEDURE NAME - GRPCHK                                  #Y30LB33*/ 02274000
*/*                                                          #Y30LB33*/ 02275000
*/* FUNCTION - TO READ THE GROUP RECORD IN WHICH THE VOLUME  #Y30LB33*/ 02276000
*/*      WILL BE GENERAL, AND CHECK THE ATTRIBUTES PROPOSED  #Y30LB33*/ 02277000
*/*      BY THE USER AGAINST THE GROUP'S ATTRIBUTES AND      #Y30LB33*/ 02278000
*/*      INDICATE IF SOME WILL BE COPIED FROM THE GROUP OR   #Y30LB33*/ 02279000
*/*      IF THE USER SPECIFIED ANY ATTRIBUTES INCORRECTLY.   #Y30LB33*/ 02280000
*/*                                                          #Y30LB33*/ 02281000
*/*      MESSAGE IDC2079I IS ISSUED IF THE GROUP RECORD      #Y30LB33*/ 02282000
*/*      WAS NOT READ FROM THE INVENTORY                     #Y30LB33*/ 02283000
*/*                                                          #Y30LB33*/ 02284000
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND SWCHBITS      #Y30LB33*/ 02285000
*/*                                                          #Y30LB33*/ 02286000
*/* OUTPUT - THE LASTCOND IS SET TO 12 IF MODIFICATION       #Y30LB33*/ 02287000
*/*      OF THE VOLUME IS IMPOSSIBLE BECAUSE OF CONFLICTS    #Y30LB33*/ 02288000
*/*      WITH THE ATTRIBUTES OF THE GROUP, OR IF THE         #Y30LB33*/ 02289000
*/*      GROUP RECORD COULD NOT BE READ FROM THE             #Y30LB33*/ 02290000
*/*      INVENTORY.                                          #Y30LB33*/ 02291000
*/*                                                          #Y30LB33*/ 02292000
*/*      THE FOLLOWING BITS IN SWCHBITS ARE SET              #Y30LB33*/ 02293000
*/*                                                          #Y30LB33*/ 02294000
*/*            GRPRCD                                        #Y30LB33*/ 02295000
*/*            COPYATTR                                      #Y30LB33*/ 02296000
*/*            COPYRW                                        #Y30LB33*/ 02297000
*/*            ONLYONLY                                      #Y30LB33*/ 02298000
*/********************************************************   #Y30LB33*/ 02299000
*                                                                  0693 02300000
*GRPCHK:                                                           0693 02301000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB33*/ 02302000
*                                                                  0693 02303000
GRPCHK   DS    0H                                                  0694 02304000
*   /*****************************************************************/ 02305000
*   /*                                                               */ 02306000
*   /* RETURN ADDRESS SAVE AREA                              #Y30LB33*/ 02307000
*   /*                                                               */ 02308000
*   /*****************************************************************/ 02309000
*                                                                  0694 02310000
*   DCL                                                            0694 02311000
*     GRPCHKSV PTR(31);             /*                       #Y30LB33*/ 02312000
*   GRPCHKSV=REG14;                 /*                       #Y30LB33*/ 02313000
         LR    GRPCHKSV,REG14                                      0695 02314000
*   OLDERID2=NEWERID2;                                             0696 02315000
         L     @15,@PC00001                                        0696 02316000
         L     @15,GDTTR2(,@15)                                    0696 02317000
         MVC   @TS00001(95),NEWERID2(@15)                          0696 02318000
         MVC   OLDERID2(95,@15),@TS00001                           0696 02319000
*   NEWID2='MVGC';                  /*                       #Y30LB33*/ 02320000
*                                                                  0697 02321000
         MVC   NEWID2(4,@15),@CC01690                              0697 02322000
*   /*****************************************************************/ 02323000
*   /*                                                               */ 02324000
*   /* READ THE GROUP RECORD OF THE GROUP TO WHICH           #Y30LB33*/ 02325000
*   /* THE VOLUME NOW BELONGS OR IN WHICH THE VOLUME         #Y30LB33*/ 02326000
*   /* WILL BE PLACED                                        #Y30LB33*/ 02327000
*   /*                                                               */ 02328000
*   /*****************************************************************/ 02329000
*                                                                  0698 02330000
*   RVVI=RVVI&&RVVI;                /*                       #Y30LB33*/ 02331000
         L     @15,RVVIPTR                                         0698 02332000
         XC    RVVI(68,@15),RVVI(@15)                              0698 02333000
*   IF ADDR(GRP)>0 THEN                                            0699 02334000
         L     @15,@PC00001+4                                      0699 02335000
         L     @15,FDTPTR+12(,@15)                                 0699 02336000
         LTR   @15,@15                                             0699 02337000
         BNP   @RF00699                                            0699 02338000
*     RVVGROUP=GRPVAL;              /*                       #Y30LB33*/ 02339000
         L     @14,RVVIPTR                                         0700 02340000
         MVC   RVVGROUP(8,@14),GRPVAL(@15)                         0700 02341000
*   ELSE                                                           0701 02342000
*     RVVGROUP=BASGROUP;            /*                       #Y30LB33*/ 02343000
         B     @RC00699                                            0701 02344000
@RF00699 L     @01,RVVIPTR                                         0701 02345000
         MVC   RVVGROUP(8,@01),BASGROUP(BASEVPTR)                  0701 02346000
*   RVVLNGTH=RVVLEN;                /*                       #Y30LB33*/ 02347000
@RC00699 L     @02,RVVIPTR                                         0702 02348000
         LH    @15,RVVLEN                                          0702 02349000
         ST    @15,RVVLNGTH(,@02)                                  0702 02350000
*   RVVCODE=RVVOP;                  /*                       #Y30LB33*/ 02351000
         MVI   RVVCODE(@02),X'87'                                  0703 02352000
*   RVVRTBUF=ADDR(GRPRCDBF);        /*                       #Y30LB33*/ 02353000
         LA    @15,GRPRCDBF                                        0704 02354000
         ST    @15,RVVRTBUF(,@02)                                  0704 02355000
*   RVVRDR=ON;                      /*                       #Y30LB33*/ 02356000
         OI    RVVRDR(@02),B'10000000'                             0705 02357000
*   RVVGRPRC=ON;                    /*                       #Y30LB33*/ 02358000
         OI    RVVGRPRC(@02),B'01000000'                           0706 02359000
*   RVVSGRP=ON;                     /*                       #Y30LB33*/ 02360000
         OI    RVVSGRP(@02),B'10000000'                            0707 02361000
*   RVVBUFLN=LENGTH(GRPRCDBF);      /*                       #Y30LB33*/ 02362000
*                                                                  0708 02363000
         MVC   RVVBUFLN(2,@02),@CH01834                            0708 02364000
*   /*****************************************************************/ 02365000
*   /*                                                               */ 02366000
*   /* ISSUE USSC TO READ GROUP                              #Y30LB33*/ 02367000
*   /*                                                               */ 02368000
*   /*****************************************************************/ 02369000
*                                                                  0709 02370000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,RCAREA);/*             #Y30LB33*/ 02371000
         L     @02,@PC00001                                        0709 02372000
         ST    @02,@AL00001                                        0709 02373000
         LA    @15,VVIC                                            0709 02374000
         ST    @15,@AL00001+4                                      0709 02375000
         LA    @15,RVVIPTR                                         0709 02376000
         ST    @15,@AL00001+8                                      0709 02377000
         LA    @15,RCAREA                                          0709 02378000
         ST    @15,@AL00001+12                                     0709 02379000
         MVI   @AL00001+12,X'80'                                   0709 02380000
         L     @15,GDTSSC(,@02)                                    0709 02381000
         LA    @01,@AL00001                                        0709 02382000
         BALR  @14,@15                                             0709 02383000
*   RESPECIFY                                                      0710 02384000
*     RTNREG RSTD;                                                 0710 02385000
*   TESTRC=RTNREG;                                                 0711 02386000
         LR    TESTRC,RTNREG                                       0711 02387000
*   RESPECIFY                                                      0712 02388000
*     RTNREG UNRSTD;                /*                       #Y30LB33*/ 02389000
*                                                                  0712 02390000
*   /*****************************************************************/ 02391000
*   /*                                                               */ 02392000
*   /* IF THE RECORD WAS NOT READ, CALL SSCMSG TO            #Y30LB33*/ 02393000
*   /* PRINT THE MESSAGE CORRESPONDING TO THE                #Y30LB33*/ 02394000
*   /* REASON CODE AND THEN PRINT THE ERROR MSG              #Y30LB33*/ 02395000
*   /* IDC2079I AND SET LASTCOND TO 12                       #Y30LB33*/ 02396000
*   /*                                                               */ 02397000
*   /*****************************************************************/ 02398000
*                                                                  0713 02399000
*   IF TESTRC=4 THEN                                               0713 02400000
         C     TESTRC,@CF00043                                     0713 02401000
         BNE   @RF00713                                            0713 02402000
*     DO;                           /*                       #Y30LB33*/ 02403000
*       CALL SSCMSG(RCAREA);        /*                       #Y30LB33*/ 02404000
         LA    @15,RCAREA                                          0715 02405000
         ST    @15,@AL00001                                        0715 02406000
         LA    @01,@AL00001                                        0715 02407000
         BAL   @14,SSCMSG                                          0715 02408000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       #Y30LB33*/ 02409000
         L     @15,DDSTRU                                          0716 02410000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0716 02411000
*       DARGSMOD=MODCMN;            /*                       #Y30LB33*/ 02412000
         MVC   DARGSMOD(3,@15),MODCMN                              0717 02413000
*       DARGSENT=MSG2079I;          /*                       #Y30LB33*/ 02414000
         MVI   DARGSENT(@15),X'1B'                                 0718 02415000
*       DARGDBP=ADDR(RVVGROUP);     /*                       #Y30LB33*/ 02416000
         L     @01,RVVIPTR                                         0719 02417000
         LA    @14,RVVGROUP(,@01)                                  0719 02418000
         ST    @14,DARGDBP(,@15)                                   0719 02419000
*       DARGILP=LENGTH(RVVGROUP);   /*                       #Y30LB33*/ 02420000
         MVC   DARGILP(2,@15),@CH00035                             0720 02421000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              #Y30LB33*/ 02422000
         L     @15,@PC00001                                        0721 02423000
         ST    @15,@AL00001                                        0721 02424000
         LA    @14,@CF00117                                        0721 02425000
         ST    @14,@AL00001+4                                      0721 02426000
         LA    @14,DDSTRU                                          0721 02427000
         ST    @14,@AL00001+8                                      0721 02428000
         MVI   @AL00001+8,X'80'                                    0721 02429000
         L     @15,GDTPRT(,@15)                                    0721 02430000
         LA    @01,@AL00001                                        0721 02431000
         BALR  @14,@15                                             0721 02432000
*       LASTCOND=TERMCODE;          /*                       #Y30LB33*/ 02433000
         L     @15,@PC00001+8                                      0722 02434000
         MVC   LASTCOND(2,@15),@CH00038                            0722 02435000
*     END;                          /*                       #Y30LB33*/ 02436000
*                                                                  0724 02437000
*   /*****************************************************************/ 02438000
*   /*                                                               */ 02439000
*   /* IF THE RECORD WAS READ, TURN ON THE SWITCH            #Y30LB33*/ 02440000
*   /* TO INDICATE SO                                        #Y30LB33*/ 02441000
*   /*                                                               */ 02442000
*   /*****************************************************************/ 02443000
*                                                                  0724 02444000
*   ELSE                                                           0724 02445000
*     DO;                           /*                       #Y30LB33*/ 02446000
         B     @RC00713                                            0724 02447000
@RF00713 DS    0H                                                  0725 02448000
*       GRPRCD=ON;                  /*                       #Y30LB33*/ 02449000
*                                                                  0725 02450000
         OI    GRPRCD,B'00001000'                                  0725 02451000
*       /*************************************************************/ 02452000
*       /*                                                           */ 02453000
*       /* SEE IF SOME OF THE                                #Y30LB33*/ 02454000
*       /* ATTRIBUTES ARE GOING TO BE COPIED FROM THE        #Y30LB33*/ 02455000
*       /* GROUP RECORD, AND IF SO, TURN ON THE              #Y30LB33*/ 02456000
*       /* SWITCH THAT INDICATES THAT SITUATION              #Y30LB33*/ 02457000
*       /*                                                           */ 02458000
*       /*************************************************************/ 02459000
*                                                                  0726 02460000
*       IF                          /*                       #Y30LB33*/ 02461000
*                                                                  0726 02462000
*       /*************************************************************/ 02463000
*       /*                                                           */ 02464000
*       /* IF THE USER REQUESTED NEITHER BIND OR             #Y30LB33*/ 02465000
*       /* NOBIND AND THE GROUP BIND ATTRIBUTE DOES          #Y30LB33*/ 02466000
*       /* NOT AGREE WITH THAT OF THE VOLUME                 #Y30LB33*/ 02467000
*       /*                                                           */ 02468000
*       /*************************************************************/ 02469000
*                                                                  0726 02470000
*           ((ADDR(BIND)=0&ADDR(NBIND)=0&/*                  #Y30LB33*/ 02471000
*           ((GROBIND=ON&BASBIND=OFF)|/*                     #Y30LB33*/ 02472000
*           (GROBIND=OFF&BASBIND=ON)))|/*                    #Y30LB33*/ 02473000
*                                                                  0726 02474000
*       /*************************************************************/ 02475000
*       /*                                                           */ 02476000
*       /* OR THE USER REQUESTED NEITHER EXCLUSIVE           #Y30LB33*/ 02477000
*       /* OR SHARED AND THE GROUP SHARED ATTRIBUTE          #Y30LB33*/ 02478000
*       /* DOES NOT AGREE WITH THAT OF THE VOLUME            #Y30LB33*/ 02479000
*       /*                                                           */ 02480000
*       /*************************************************************/ 02481000
*                                                                  0726 02482000
*           (ADDR(EXECL)=0&ADDR(SHRD)=0&/*                   #Y30LB33*/ 02483000
*           ((GROEXCL=ON&BASEXCL=OFF)|/*                     #Y30LB33*/ 02484000
*           (GROEXCL=OFF&BASEXCL=ON)))|/*                    #Y30LB33*/ 02485000
*                                                                  0726 02486000
*       /*************************************************************/ 02487000
*       /*                                                           */ 02488000
*       /* OR THE USER REQUESTED NEITHER DASDERASE           #Y30LB33*/ 02489000
*       /* OR NODASDERASE AND THE GROUP DASDERASE            #Y30LB33*/ 02490000
*       /* ATTRIBUTE DOES NOT AGREE WITH THAT OF THE         #Y30LB33*/ 02491000
*       /* VOLUME                                            #Y30LB33*/ 02492000
*       /*                                                           */ 02493000
*       /*************************************************************/ 02494000
*                                                                  0726 02495000
*           (ADDR(DERAS)=0&ADDR(NDERS)=0&/*                  #Y30LB33*/ 02496000
*           ((GRODAERA=ON&BASDAERA=OFF)|/*                   #Y30LB33*/ 02497000
*           (GRODAERA=OFF&BASDAERA=ON))))/*                  #Y30LB33*/ 02498000
*                                                                  0726 02499000
*       /*************************************************************/ 02500000
*       /*                                                           */ 02501000
*       /* THEN INDICATE THAT SOME ATTRIBUTES MUST BE        #Y30LB33*/ 02502000
*       /* COPIED FROM THE GROUP RECORD                      #Y30LB33*/ 02503000
*       /*                                                           */ 02504000
*       /*************************************************************/ 02505000
*                                                                  0726 02506000
*         THEN                                                     0726 02507000
         SLR   @15,@15                                             0726 02508000
         L     @14,@PC00001+4                                      0726 02509000
         C     @15,FDTPTR+24(,@14)                                 0726 02510000
         BNE   @GL00061                                            0726 02511000
         C     @15,FDTPTR+28(,@14)                                 0726 02512000
         BNE   @GL00061                                            0726 02513000
         TM    GROBIND(GROUPPTR),B'10000000'                       0726 02514000
         BNO   @GL00064                                            0726 02515000
         TM    BASBIND(BASEVPTR),B'00000010'                       0726 02516000
         BZ    @RT00726                                            0726 02517000
@GL00064 TM    GROBIND(GROUPPTR),B'10000000'                       0726 02518000
         BNZ   @GL00061                                            0726 02519000
         TM    BASBIND(BASEVPTR),B'00000010'                       0726 02520000
         BO    @RT00726                                            0726 02521000
@GL00061 SLR   @15,@15                                             0726 02522000
         L     @14,@PC00001+4                                      0726 02523000
         C     @15,FDTPTR+32(,@14)                                 0726 02524000
         BNE   @GL00060                                            0726 02525000
         C     @15,FDTPTR+36(,@14)                                 0726 02526000
         BNE   @GL00060                                            0726 02527000
         TM    GROEXCL(GROUPPTR),B'01000000'                       0726 02528000
         BNO   @GL00069                                            0726 02529000
         TM    BASEXCL(BASEVPTR),B'00000001'                       0726 02530000
         BZ    @RT00726                                            0726 02531000
@GL00069 TM    GROEXCL(GROUPPTR),B'01000000'                       0726 02532000
         BNZ   @GL00060                                            0726 02533000
         TM    BASEXCL(BASEVPTR),B'00000001'                       0726 02534000
         BO    @RT00726                                            0726 02535000
@GL00060 SLR   @15,@15                                             0726 02536000
         L     @14,@PC00001+4                                      0726 02537000
         C     @15,FDTPTR+48(,@14)                                 0726 02538000
         BNE   @RF00726                                            0726 02539000
         C     @15,FDTPTR+52(,@14)                                 0726 02540000
         BNE   @RF00726                                            0726 02541000
         TM    GRODAERA(GROUPPTR),B'00100000'                      0726 02542000
         BNO   @GL00074                                            0726 02543000
         TM    BASDAERA(BASEVPTR),B'10000000'                      0726 02544000
         BZ    @RT00726                                            0726 02545000
@GL00074 TM    GRODAERA(GROUPPTR),B'00100000'                      0726 02546000
         BNZ   @RF00726                                            0726 02547000
         TM    BASDAERA(BASEVPTR),B'10000000'                      0726 02548000
         BNO   @RF00726                                            0726 02549000
@RT00726 DS    0H                                                  0727 02550000
*         COPYATTR=ON;              /*                       #Y30LB33*/ 02551000
*                                                                  0727 02552000
         OI    COPYATTR,B'00000010'                                0727 02553000
*       /*************************************************************/ 02554000
*       /*                                                           */ 02555000
*       /* TEST THE READONLY ATTRIBUTE                       #Y30LB33*/ 02556000
*       /* SEPARATELY. IF IT IS ON IN THE                    #Y30LB33*/ 02557000
*       /* GROUP RECORD, NOT ON IN THE VOLUME                #Y30LB33*/ 02558000
*       /* RECORD, AND NOT SPECIFIED BY THE                  #Y30LB33*/ 02559000
*       /* USER, THEN IT IS TO BE COPIED                     #Y30LB33*/ 02560000
*       /* FROM THE GROUP RECORD. A SEPARATE                 #Y30LB33*/ 02561000
*       /* SWITCH MUST BE USED BECAUSE OF                    #Y30LB33*/ 02562000
*       /* THE POSSIBILITY OF CHANGING THE                   #Y30LB33*/ 02563000
*       /* OWNER OR VOLUME SERIAL                            #Y30LB33*/ 02564000
*       /*                                                           */ 02565000
*       /*************************************************************/ 02566000
*                                                                  0728 02567000
*       IF ADDR(RONLY)=0&ADDR(RW)=0&/*                       #Y30LB33*/ 02568000
*           GRORONLY=ON&BASRONLY=OFF/*                       #Y30LB33*/ 02569000
*           &COPYATTR=OFF THEN                                     0728 02570000
@RF00726 SLR   @15,@15                                             0728 02571000
         L     @14,@PC00001+4                                      0728 02572000
         C     @15,FDTPTR+40(,@14)                                 0728 02573000
         BNE   @RF00728                                            0728 02574000
         C     @15,FDTPTR+44(,@14)                                 0728 02575000
         BNE   @RF00728                                            0728 02576000
         TM    GRORONLY(GROUPPTR),B'00010000'                      0728 02577000
         BNO   @RF00728                                            0728 02578000
         TM    BASRONLY(BASEVPTR),B'01000000'                      0728 02579000
         BNZ   @RF00728                                            0728 02580000
         TM    COPYATTR,B'00000010'                                0728 02581000
         BNZ   @RF00728                                            0728 02582000
*         ONLYONLY=ON;              /*                       #Y30LB33*/ 02583000
*                                                                  0729 02584000
         OI    ONLYONLY,B'10000000'                                0729 02585000
*       /*************************************************************/ 02586000
*       /*                                                           */ 02587000
*       /* TURN ON THE INDICATOR SWITCH IF                   #Y30LB33*/ 02588000
*       /* READWRITE IS TO BE COPIED FROM                    #Y30LB33*/ 02589000
*       /* THE GROUP RECORD                                  #Y30LB33*/ 02590000
*       /*                                                           */ 02591000
*       /*************************************************************/ 02592000
*                                                                  0730 02593000
*       ELSE                                                       0730 02594000
*         IF GRORONLY=OFF&BASRONLY=ON&/*                     #Y30LB33*/ 02595000
*             ADDR(RW)=0 THEN                                      0730 02596000
         B     @RC00728                                            0730 02597000
@RF00728 TM    GRORONLY(GROUPPTR),B'00010000'                      0730 02598000
         BNZ   @RF00730                                            0730 02599000
         TM    BASRONLY(BASEVPTR),B'01000000'                      0730 02600000
         BNO   @RF00730                                            0730 02601000
         L     @15,@PC00001+4                                      0730 02602000
         L     @15,FDTPTR+44(,@15)                                 0730 02603000
         LTR   @15,@15                                             0730 02604000
         BNZ   @RF00730                                            0730 02605000
*           DO;                     /*                       #Y30LB33*/ 02606000
*             COPYRW=ON;            /*                       #Y30LB33*/ 02607000
         OI    COPYRW,B'00010000'                                  0732 02608000
*             COPYATTR=ON;          /*                       #Y30LB33*/ 02609000
         OI    COPYATTR,B'00000010'                                0733 02610000
*           END;                    /*                       #Y30LB33*/ 02611000
*     END;                          /*                       #Y30LB33*/ 02612000
*                                                                  0735 02613000
@RF00730 DS    0H                                                  0735 02614000
@RC00728 DS    0H                                                  0736 02615000
*   /*****************************************************************/ 02616000
*   /*                                                               */ 02617000
*   /* RESTORE RETURN ADDRESS                                #Y30LB33*/ 02618000
*   /*                                                               */ 02619000
*   /*****************************************************************/ 02620000
*                                                                  0736 02621000
*   REG14=GRPCHKSV;                 /*                       #Y30LB33*/ 02622000
@RC00713 LR    REG14,GRPCHKSV                                      0736 02623000
*   RETURN CODE(0);                 /*                       #Y30LB33*/ 02624000
         SLR   @15,@15                                             0737 02625000
@EL00008 DS    0H                                                  0737 02626000
@EF00008 DS    0H                                                  0737 02627000
@ER00008 BR    @14                                                 0737 02628000
*   END GRPCHK;                     /*                       #Y30LB33*/ 02629000
*                                                                  0739 02630000
*/********************************************************   #Y30LB33*/ 02631000
*/* PROCEDURE NAME - DOIT                                    #Y30LB33*/ 02632000
*/*                                                          #Y30LB33*/ 02633000
*/* FUNCTION - TO CALL PROCEDURES TO MAKE THE                #Y30LB33*/ 02634000
*/*      REQUESTED CHANGES AND CORRECT ERRORS                #Y30LB33*/ 02635000
*/*      WHEN ENCOUNTERED                                    #Y30LB33*/ 02636000
*/*                                                          #Y30LB33*/ 02637000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   #Y30LB33*/ 02638000
*/*                                                          #Y30LB33*/ 02639000
*/*            CKAUTH                                        #Y30LB33*/ 02640000
*/*            MODFYIT                                       #Y30LB33*/ 02641000
*/*            LABELIT                                       #Y30LB33*/ 02642000
*/*                                                          #Y30LB33*/ 02643000
*/* INPUT - THE FDTTBL, LASTCOND, AND SWCHBITS               #Y30LB33*/ 02644000
*/*                                                          #Y30LB33*/ 02645000
*/* OUTPUT - THE LASTCOND IS SET TO 4 IF THE VOLUME          #Y30LB33*/ 02646000
*/*      DID NOT DEALLOCATE PROPERLY                         #Y30LB33*/ 02647000
*/*                                                          #Y30LB33*/ 02648000
*/*      THE ALLOCSW IN SWCHBITS IS TURNED OFF WHEN          #Y30LB33*/ 02649000
*/*      DEALLOCATION IS TRIED                               #Y30LB33*/ 02650000
*/********************************************************   #Y30LB33*/ 02651000
*                                                                  0739 02652000
*DOIT:                                                             0739 02653000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB33*/ 02654000
*                                                                  0739 02655000
DOIT     DS    0H                                                  0740 02656000
*   /*****************************************************************/ 02657000
*   /*                                                               */ 02658000
*   /* RETURN ADDRESS SAVE AREA                              #Y30LB33*/ 02659000
*   /*                                                               */ 02660000
*   /*****************************************************************/ 02661000
*                                                                  0740 02662000
*   DCL                                                            0740 02663000
*     DOITSV PTR(31);               /*                       #Y30LB33*/ 02664000
*   DOITSV=REG14;                   /*                       #Y30LB33*/ 02665000
         ST    REG14,DOITSV                                        0741 02666000
*   OLDERID2=NEWERID2;                                             0742 02667000
         L     @07,@PC00001                                        0742 02668000
         L     @07,GDTTR2(,@07)                                    0742 02669000
         MVC   @TS00001(95),NEWERID2(@07)                          0742 02670000
         MVC   OLDERID2(95,@07),@TS00001                           0742 02671000
*   NEWID2='MVCA';                  /*                       #Y30LB33*/ 02672000
*                                                                  0743 02673000
         MVC   NEWID2(4,@07),@CC01695                              0743 02674000
*   /*****************************************************************/ 02675000
*   /*                                                               */ 02676000
*   /* IF WE ARE CHANGING THE VOLUME SERIAL, BUT NOT         #Y30LB33*/ 02677000
*   /* BACKING OUT A PREVIOUS RELABELING FAILURE,            #Y30LB33*/ 02678000
*   /* CALL CKAUTH TO CHECK THE VOLUME CONTENTS AND          #Y30LB33*/ 02679000
*   /* PASSWORDS                                             #Y30LB33*/ 02680000
*   /*                                                               */ 02681000
*   /*****************************************************************/ 02682000
*                                                                  0744 02683000
*   IF ADDR(NEWSR)=NULLPTR|         /*                       #Y30LB33*/ 02684000
*       (BASVSMIS=ON&NEWSRVAL=BASRECOV) THEN                       0744 02685000
         L     @07,@PC00001+4                                      0744 02686000
         L     @07,FDTPTR+4(,@07)                                  0744 02687000
         LTR   @07,@07                                             0744 02688000
         BZ    @RT00744                                            0744 02689000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0744 02690000
         BNO   @RF00744                                            0744 02691000
         CLC   NEWSRVAL(6,@07),BASRECOV(BASEVPTR)                  0744 02692000
         BE    @RT00744                                            0744 02693000
*     ;                             /*                       #Y30LB33*/ 02694000
*   ELSE                                                           0746 02695000
*     CALL CKAUTH;                  /*                       #Y30LB33*/ 02696000
*                                                                  0746 02697000
@RF00744 BAL   @14,CKAUTH                                          0746 02698000
*   /*****************************************************************/ 02699000
*   /*                                                               */ 02700000
*   /* IF NO ERRORS, CALL MODFYIT TO CHANGE                  #Y30LB33*/ 02701000
*   /* THE VOLUME                                            #Y30LB33*/ 02702000
*   /*                                                               */ 02703000
*   /*****************************************************************/ 02704000
*                                                                  0747 02705000
*   IF LASTCOND^=TERMCODE THEN                                     0747 02706000
@RT00744 L     @07,@PC00001+8                                      0747 02707000
         CLC   LASTCOND(2,@07),@CH00038                            0747 02708000
         BE    @RF00747                                            0747 02709000
*     CALL MODFYIT;                 /*                       #Y30LB33*/ 02710000
*                                                                  0748 02711000
         BAL   @14,MODFYIT                                         0748 02712000
*   /*****************************************************************/ 02713000
*   /*                                                               */ 02714000
*   /* IF NO ERRORS FOUND YET, AND IF WE MUST WRITE          #Y30LB33*/ 02715000
*   /* A NEW SOFTWARE LABEL, CALL LABELIT TO WRITE           #Y30LB33*/ 02716000
*   /* THE LABEL                                             #Y30LB33*/ 02717000
*   /*                                                               */ 02718000
*   /*****************************************************************/ 02719000
*                                                                  0749 02720000
*   IF LASTCOND^=TERMCODE&RENAMSW=ON/*                       #Y30LB33*/ 02721000
*     THEN                                                         0749 02722000
@RF00747 L     @07,@PC00001+8                                      0749 02723000
         CLC   LASTCOND(2,@07),@CH00038                            0749 02724000
         BE    @RF00749                                            0749 02725000
         TM    RENAMSW,B'01000000'                                 0749 02726000
         BNO   @RF00749                                            0749 02727000
*     CALL LABELIT;                 /*                       #Y30LB33*/ 02728000
         BAL   @14,LABELIT                                         0750 02729000
*                                                                  0751 02730000
*   /*****************************************************************/ 02731000
*   /*                                                               */ 02732000
*   /* IF THE VOLUME IS ACTIVE, AND IT WAS                   @YD00175*/ 02733000
*   /* DEMOUNTED DURING PROCESSING AND IS NOT                @YD00175*/ 02734000
*   /* MOUNTED NOW, MOUNT THE VOLUME.                        @YD00175*/ 02735000
*   /*                                                               */ 02736000
*   /*****************************************************************/ 02737000
*                                                                  0751 02738000
*   IF INACTSW=OFF&MNTSW=OFF&DMNTSW=ON/*                     @YD00175*/ 02739000
*     THEN                                                         0751 02740000
@RF00749 TM    INACTSW,B'00000100'                                 0751 02741000
         BNZ   @RF00751                                            0751 02742000
         TM    MNTSW,B'00100000'                                   0751 02743000
         BNZ   @RF00751                                            0751 02744000
         TM    DMNTSW,B'10000000'                                  0751 02745000
         BNO   @RF00751                                            0751 02746000
*     DO;                           /*                       @YD00175*/ 02747000
*       CALL MNTVOL;                /*                       @YD00175*/ 02748000
         BAL   @14,MNTVOL                                          0753 02749000
*       IF MNTSW=OFF THEN           /*                       @YD00175*/ 02750000
         TM    MNTSW,B'00100000'                                   0754 02751000
         BNZ   @RF00754                                            0754 02752000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @YD00175*/ 02753000
         L     @15,@PC00001+8                                      0755 02754000
         LH    @14,LASTCOND(,@15)                                  0755 02755000
         LA    @07,4                                               0755 02756000
         CR    @14,@07                                             0755 02757000
         BNL   *+6                                                      02758000
         LR    @14,@07                                             0755 02759000
         STH   @14,LASTCOND(,@15)                                  0755 02760000
*     END;                          /*                       @YD00175*/ 02761000
@RF00754 DS    0H                                                  0757 02762000
*                                                                  0757 02763000
*   /*****************************************************************/ 02764000
*   /*                                                               */ 02765000
*   /* RESTORE RETURN ADDRESS                                #Y30LB33*/ 02766000
*   /*                                                               */ 02767000
*   /*****************************************************************/ 02768000
*                                                                  0757 02769000
*   REG14=DOITSV;                   /*                       #Y30LB33*/ 02770000
@RF00751 L     REG14,DOITSV                                        0757 02771000
*   RETURN CODE(0);                 /*                       #Y30LB33*/ 02772000
         SLR   @15,@15                                             0758 02773000
@EL00009 DS    0H                                                  0758 02774000
@EF00009 DS    0H                                                  0758 02775000
@ER00009 BR    @14                                                 0758 02776000
*   END DOIT;                       /*                       #Y30LB33*/ 02777000
*                                                                  0760 02778000
*/********************************************************   #Y30LB33*/ 02779000
*/* PROCEDURE NAME - CKAUTH                                  #Y30LB33*/ 02780000
*/*                                                          #Y30LB33*/ 02781000
*/* FUNCTION - TO MAKE SURE THAT THE VOLUME, TO BE           #Y30LB33*/ 02782000
*/*      RELABELED, DOES NOT CONTAIN A VSAM DATA SET         #Y30LB33*/ 02783000
*/*      AND ALSO, TO CHECK FOR NON-VSAM PASSWORD-           #Y30LB33*/ 02784000
*/*      PROTECTED DATA SETS                                 #Y30LB33*/ 02785000
*/*                                                          #Y30LB33*/ 02786000
*/* INPUT - THE VOLUME RECORD, THE FDTTBL, AND SWCHBITS      #Y30LB33*/ 02787000
*/*                                                          #Y30LB33*/ 02788000
*/* OUTPUT - THE LASTCOND IS SET TO 4 IF THE VTOC FAILS      #Y30LB33*/ 02789000
*/*      TO CLOSE PROPERLY. IT IS SET TO 12 TO INDICATE THAT #Y30LB33*/ 02790000
*/*      NO MODIFICATION WAS DONE                            #Y30LB33*/ 02791000
*/*                                                          #Y30LB33*/ 02792000
*/*      THE FOLLOWING SWCHBITS ARE SET                      #Y30LB33*/ 02793000
*/*            CKSW                                          #Y30LB33*/ 02794000
*/********************************************************   #Y30LB33*/ 02795000
*                                                                  0760 02796000
*CKAUTH:                                                           0760 02797000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB33*/ 02798000
*                                                                  0760 02799000
CKAUTH   DS    0H                                                  0761 02800000
*   /*****************************************************************/ 02801000
*   /*                                                               */ 02802000
*   /* RETURN ADDRESS SAVE AREA                              #Y30LB33*/ 02803000
*   /*                                                               */ 02804000
*   /*****************************************************************/ 02805000
*                                                                  0761 02806000
*   DCL                                                            0761 02807000
*     CKAUTHSV PTR(31);             /*                       #Y30LB33*/ 02808000
*   CKAUTHSV=REG14;                 /*                       #Y30LB33*/ 02809000
         ST    REG14,CKAUTHSV                                      0762 02810000
*   OLDERID2=NEWERID2;                                             0763 02811000
         L     @07,@PC00001                                        0763 02812000
         L     @07,GDTTR2(,@07)                                    0763 02813000
         MVC   @TS00001(95),NEWERID2(@07)                          0763 02814000
         MVC   OLDERID2(95,@07),@TS00001                           0763 02815000
*   NEWID2='MVFA';                  /*                       #Y30LB33*/ 02816000
*                                                                  0764 02817000
         MVC   NEWID2(4,@07),@CC01703                              0764 02818000
*   /*****************************************************************/ 02819000
*   /*                                                               */ 02820000
*   /* IF THE VOLUME HAS A LABEL MISMATCH                    #Y30LB33*/ 02821000
*   /* MOUNT THE VOLUME FOR AUTHORIZATION CHECKING           #Y30LB33*/ 02822000
*   /*                                                               */ 02823000
*   /*****************************************************************/ 02824000
*                                                                  0765 02825000
*   IF BASVSMIS=ON THEN                                            0765 02826000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0765 02827000
         BNO   @RF00765                                            0765 02828000
*     DO;                           /*                       #Y30LB33*/ 02829000
*       CALL MNTVOL;                /*                       @YD00175*/ 02830000
*                                                                  0767 02831000
         BAL   @14,MNTVOL                                          0767 02832000
*       /*************************************************************/ 02833000
*       /*                                                           */ 02834000
*       /* IF THE MOUNT SWITCH IS OFF, THE MOUNT             @YD00175*/ 02835000
*       /* FAILED, SO TERMINATE THE RUN                      @YD00175*/ 02836000
*       /*                                                           */ 02837000
*       /*************************************************************/ 02838000
*                                                                  0768 02839000
*       IF MNTSW=OFF THEN                                          0768 02840000
         TM    MNTSW,B'00100000'                                   0768 02841000
         BNZ   @RF00768                                            0768 02842000
*         LASTCOND=TERMCODE;        /*                       @YD00175*/ 02843000
         L     @07,@PC00001+8                                      0769 02844000
         MVC   LASTCOND(2,@07),@CH00038                            0769 02845000
*     END;                          /*                       @Y30LB33*/ 02846000
*   ELSE                            /*                       @Y30LB33*/ 02847000
*                                                                  0771 02848000
*     /***************************************************************/ 02849000
*     /*                                                             */ 02850000
*     /* IF THE FILE PARAMETER IS NOT SPECIFIED,             @Y30LB33*/ 02851000
*     /* ALLOCATE AND MOUNT THE VOLUME. IF THE               @Y30LB33*/ 02852000
*     /* ALLOCATE FAILS, SET LASTCOND TO 12                  @Y30LB33*/ 02853000
*     /*                                                             */ 02854000
*     /***************************************************************/ 02855000
*                                                                  0771 02856000
*     IF ADDR(FYLE)=0 THEN                                         0771 02857000
         B     @RC00765                                            0771 02858000
@RF00765 L     @07,@PC00001+4                                      0771 02859000
         L     @15,FDTPTR+88(,@07)                                 0771 02860000
         LTR   @15,@15                                             0771 02861000
         BNZ   @RF00771                                            0771 02862000
*       CALL ALLOVOL(VOLVAL);       /*                       @Y30LB33*/ 02863000
*                                                                  0772 02864000
         L     @07,FDTPTR(,@07)                                    0772 02865000
         LA    @07,VOLVAL(,@07)                                    0772 02866000
         ST    @07,@AL00001                                        0772 02867000
         LA    @01,@AL00001                                        0772 02868000
         BAL   @14,ALLOVOL                                         0772 02869000
*   /*****************************************************************/ 02870000
*   /*                                                               */ 02871000
*   /* IF NO ERRORS WERE FOUND IN MOUNTING                   @Y30LB33*/ 02872000
*   /* OR ALLOCATING, CALL ON VOLUME SERVICES                @Y30LB33*/ 02873000
*   /* TO CHECK AUTHORIZATION                                @Y30LB33*/ 02874000
*   /*                                                               */ 02875000
*   /*****************************************************************/ 02876000
*                                                                  0773 02877000
*   IF LASTCOND<TERMCODE THEN                                      0773 02878000
@RF00771 DS    0H                                                  0773 02879000
@RC00765 L     @07,@PC00001+8                                      0773 02880000
         LH    @07,LASTCOND(,@07)                                  0773 02881000
         C     @07,@CF00038                                        0773 02882000
         BNL   @RF00773                                            0773 02883000
*     DO;                           /*                       @Y30LB33*/ 02884000
*       VS1AGL=VS1AGL&&VS1AGL;      /*                       @Y30LB33*/ 02885000
         LA    @07,MVVS1AGL                                        0775 02886000
         XC    VS1AGL(74,@07),VS1AGL(@07)                          0775 02887000
*       VSNOVSAM=ON;                /*                       @Y30LB33*/ 02888000
*       VSWRITE=ON;                 /*                       @Y30LB33*/ 02889000
         OI    VSNOVSAM(@07),B'10001000'                           0777 02890000
*       VSVOLP=ADDR(VOLVAL);        /*                       @Y30LB33*/ 02891000
         L     @02,@PC00001+4                                      0778 02892000
         L     @01,FDTPTR(,@02)                                    0778 02893000
         LA    @15,VOLVAL(,@01)                                    0778 02894000
         ST    @15,VSVOLP(,@07)                                    0778 02895000
*       VSFILEP=ADDR(MVDDNAME);     /*                       @Y30LB33*/ 02896000
         LA    @15,MVDDNAME                                        0779 02897000
         ST    @15,VSFILEP(,@07)                                   0779 02898000
*       VSRES=ON;                   /*                       @Y30LB33*/ 02899000
         OI    VSRES(@07),B'10000000'                              0780 02900000
*       VSUCBP=ADDR(MVUCBPTR);      /*                       @Y30LB33*/ 02901000
         LA    @15,MVUCBPTR                                        0781 02902000
         ST    @15,VSUCBP(,@07)                                    0781 02903000
*       VSPFILEP=ADDR(PSWD);        /*                       @Y30LB33*/ 02904000
*                                                                  0782 02905000
         L     @02,FDTPTR+92(,@02)                                 0782 02906000
         ST    @02,VSPFILEP(,@07)                                  0782 02907000
*       /*************************************************************/ 02908000
*       /*                                                           */ 02909000
*       /* CALL VOLUME SERVICES. AND                         @YD00175*/ 02910000
*       /* INDICATE VOLUME IS MOUNTED.                       @YD00175*/ 02911000
*       /*                                                           */ 02912000
*       /*************************************************************/ 02913000
*                                                                  0783 02914000
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*  @Y30LB33*/ 02915000
         L     @02,@PC00001                                        0783 02916000
         ST    @02,@AL00001                                        0783 02917000
         LA    @15,@CC01705                                        0783 02918000
         ST    @15,@AL00001+4                                      0783 02919000
         LA    @15,SECCHECK                                        0783 02920000
         ST    @15,@AL00001+8                                      0783 02921000
         ST    @07,@AL00001+12                                     0783 02922000
         MVI   @AL00001+12,X'80'                                   0783 02923000
         L     @15,GDTCAL(,@02)                                    0783 02924000
         LA    @01,@AL00001                                        0783 02925000
         BALR  @14,@15                                             0783 02926000
*       RESPECIFY                                                  0784 02927000
*         RTNREG RSTD;                                             0784 02928000
*       TESTRC=RTNREG;                                             0785 02929000
         LR    TESTRC,RTNREG                                       0785 02930000
*       RESPECIFY                                                  0786 02931000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 02932000
*       MNTSW=ON;                   /*                       @YD00175*/ 02933000
         OI    MNTSW,B'00100000'                                   0787 02934000
*                                                                  0788 02935000
*       /*************************************************************/ 02936000
*       /*                                                           */ 02937000
*       /* TEST THE RETURN CODES FROM VOLUME                 @Y30LB33*/ 02938000
*       /* SERVICES. A 4 IS A FAILURE, SO                    @Y30LB33*/ 02939000
*       /* TERMINATE                                         @Y30LB33*/ 02940000
*       /*                                                           */ 02941000
*       /*************************************************************/ 02942000
*                                                                  0788 02943000
*       IF TESTRC=4 THEN                                           0788 02944000
         C     TESTRC,@CF00043                                     0788 02945000
         BNE   @RF00788                                            0788 02946000
*         DO;                       /*                       @Y30LB33*/ 02947000
*           LASTCOND=TERMCODE;      /*                       @Y30LB33*/ 02948000
*                                                                  0790 02949000
         L     @07,@PC00001+8                                      0790 02950000
         MVC   LASTCOND(2,@07),@CH00038                            0790 02951000
*           /*********************************************************/ 02952000
*           /*                                                       */ 02953000
*           /* ALSO DEQ ON THE RESERVE SINCE WE WILL NOT     @Y30LB33*/ 02954000
*           /* GO ON TO DEMOUNT THE VOLUME BECAUSE OF        @Y30LB33*/ 02955000
*           /* THE ERROR                                     @Y30LB33*/ 02956000
*           /*                                                       */ 02957000
*           /*********************************************************/ 02958000
*                                                                  0791 02959000
*           MINAMVOL=VOLVAL;        /*                       @ZA05119*/ 02960000
         L     @07,@PC00001+4                                      0791 02961000
         L     @07,FDTPTR(,@07)                                    0791 02962000
         MVC   MINAMVOL(6),VOLVAL(@07)                             0791 02963000
*           MINAMLN=LENGTH(MVMINNAM)-1;/*                    @Y30LB33*/ 02964000
         MVI   MINAMLN,X'16'                                       0792 02965000
*           MINAMQL=MINQLR;         /*                       @Y30LB33*/ 02966000
         MVC   MINAMQL(16),@CC01589                                0793 02967000
*           CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*       @YM04300*/ 02968000
         L     @07,@PC00001                                        0794 02969000
         ST    @07,@AL00001                                        0794 02970000
         LA    @02,MVMAJNAM                                        0794 02971000
         ST    @02,@AL00001+4                                      0794 02972000
         LA    @02,MVMINNAM                                        0794 02973000
         ST    @02,@AL00001+8                                      0794 02974000
         MVI   @AL00001+8,X'80'                                    0794 02975000
         L     @15,GDTDEQ(,@07)                                    0794 02976000
         LA    @01,@AL00001                                        0794 02977000
         BALR  @14,@15                                             0794 02978000
*         END;                      /*                       @Y30LB33*/ 02979000
*                                                                  0795 02980000
*       /*************************************************************/ 02981000
*       /*                                                           */ 02982000
*       /* IF THE CODE IS 8, WE HAD TROUBLE                  @Y30LB33*/ 02983000
*       /* CLOSING A DATA SET, SO SET LASTCOND               @Y30LB33*/ 02984000
*       /* TO 4                                              @Y30LB33*/ 02985000
*       /*                                                           */ 02986000
*       /*************************************************************/ 02987000
*                                                                  0796 02988000
*       IF TESTRC=8 THEN            /*                       @YD00175*/ 02989000
@RF00788 C     TESTRC,@CF00035                                     0796 02990000
         BNE   @RF00796                                            0796 02991000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB33*/ 02992000
*                                                                  0797 02993000
         L     @07,@PC00001+8                                      0797 02994000
         LH    @15,LASTCOND(,@07)                                  0797 02995000
         LA    @14,4                                               0797 02996000
         CR    @15,@14                                             0797 02997000
         BNL   *+6                                                      02998000
         LR    @15,@14                                             0797 02999000
         STH   @15,LASTCOND(,@07)                                  0797 03000000
*       /*************************************************************/ 03001000
*       /*                                                           */ 03002000
*       /* IF THE I/O POINTER FROM VOLUME                    @Y30LB33*/ 03003000
*       /* SERVICES IS NOT ZERO, CLOSE VTOC                  @Y30LB33*/ 03004000
*       /*                                                           */ 03005000
*       /*************************************************************/ 03006000
*                                                                  0798 03007000
*       IF VSIOP^=0 THEN                                           0798 03008000
@RF00796 LA    @07,MVVS1AGL                                        0798 03009000
         L     @15,VSIOP(,@07)                                     0798 03010000
         LTR   @15,@15                                             0798 03011000
         BZ    @RF00798                                            0798 03012000
*         DO;                       /*                       @Y30LB33*/ 03013000
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB33*/ 03014000
         L     @02,@PC00001                                        0800 03015000
         ST    @02,@AL00001                                        0800 03016000
         LA    @07,VSIOP(,@07)                                     0800 03017000
         ST    @07,@AL00001+4                                      0800 03018000
         MVI   @AL00001+4,X'80'                                    0800 03019000
         L     @15,GDTCLS(,@02)                                    0800 03020000
         LA    @01,@AL00001                                        0800 03021000
         BALR  @14,@15                                             0800 03022000
*           RESPECIFY                                              0801 03023000
*             RTNREG RSTD;                                         0801 03024000
*           TESTRC=RTNREG;                                         0802 03025000
         LR    TESTRC,RTNREG                                       0802 03026000
*           RESPECIFY                                              0803 03027000
*             RTNREG UNRSTD;        /*                       @Y30LB33*/ 03028000
*                                                                  0803 03029000
*           /*********************************************************/ 03030000
*           /*                                                       */ 03031000
*           /* TEST FOR A CLOSE ERROR                        @Y30LB33*/ 03032000
*           /* AND SET LASTCOND TO 4 IF ONE                  @Y30LB33*/ 03033000
*           /* OCCURRED                                      @Y30LB33*/ 03034000
*           /*                                                       */ 03035000
*           /*********************************************************/ 03036000
*                                                                  0804 03037000
*           IF TESTRC^=0 THEN                                      0804 03038000
         LTR   TESTRC,TESTRC                                       0804 03039000
         BZ    @RF00804                                            0804 03040000
*             LASTCOND=MAX(LASTCOND,LASTCC04);/*             @Y30LB33*/ 03041000
         L     @07,@PC00001+8                                      0805 03042000
         LH    @15,LASTCOND(,@07)                                  0805 03043000
         LA    @14,4                                               0805 03044000
         CR    @15,@14                                             0805 03045000
         BNL   *+6                                                      03046000
         LR    @15,@14                                             0805 03047000
         STH   @15,LASTCOND(,@07)                                  0805 03048000
*         END;                      /*                       @Y30LB33*/ 03049000
@RF00804 DS    0H                                                  0807 03050000
*                                                                  0807 03051000
*       /*************************************************************/ 03052000
*       /*                                                           */ 03053000
*       /* TURN ON THE CHECK SWITCH TO INDICATE              @Y30LB33*/ 03054000
*       /* THAT THE AUTHORIZATION CHECK WAS                  @Y30LB33*/ 03055000
*       /* PERFORMED AND THAT A DEQUEUE IS                   @Y30LB33*/ 03056000
*       /* IN ORDER. IT IS DONE IN CHNGMSC                   @Y30LB33*/ 03057000
*       /*                                                           */ 03058000
*       /*************************************************************/ 03059000
*                                                                  0807 03060000
*       CKSW=ON;                    /*                       @Y30LB33*/ 03061000
@RF00798 OI    CKSW,B'01000000'                                    0807 03062000
*     END;                          /*                       @Y30LB33*/ 03063000
*                                                                  0808 03064000
*   /*****************************************************************/ 03065000
*   /*                                                               */ 03066000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 03067000
*   /*                                                               */ 03068000
*   /*****************************************************************/ 03069000
*                                                                  0809 03070000
*   REG14=CKAUTHSV;                 /*                       @Y30LB33*/ 03071000
@RF00773 L     REG14,CKAUTHSV                                      0809 03072000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 03073000
         SLR   @15,@15                                             0810 03074000
@EL00010 DS    0H                                                  0810 03075000
@EF00010 DS    0H                                                  0810 03076000
@ER00010 BR    @14                                                 0810 03077000
*   END CKAUTH;                     /*                       @Y30LB33*/ 03078000
*                                                                  0812 03079000
*/********************************************************   @Y30LB33*/ 03080000
*/* PROCEDURE NAME - MODFYIT                                 @Y30LB33*/ 03081000
*/*                                                          @Y30LB33*/ 03082000
*/* FUNCTION - TO MODIFY THE VOLUME RECORD AND THE           @Y30LB33*/ 03083000
*/*      CARTRIDGE LABEL                                     @Y30LB33*/ 03084000
*/*                                                          @Y30LB33*/ 03085000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 03086000
*/*                                                          @Y30LB33*/ 03087000
*/*            CHNGMSC                                       @Y30LB33*/ 03088000
*/*            CHNGMSVC                                      @Y30LB33*/ 03089000
*/*                                                          @Y30LB33*/ 03090000
*/*      IF THE MAXIMUM BACKUP NUMBER IS REDUCED BELOW THE   @Y30LB33*/ 03091000
*/*      NUMBER OF BACK COPIES THAT EXIST FOR THE VOLUME     @Y30LB33*/ 03092000
*/*      THEN THE MESSAGE IDC0068I IS PRINTED                @Y30LB33*/ 03093000
*/*                                                          @Y30LB33*/ 03094000
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND THE           @Y30LB33*/ 03095000
*/*      GROUP RECORD                                        @Y30LB33*/ 03096000
*/*                                                          @Y30LB33*/ 03097000
*/* OUTPUT - LASTCOND IS SET BY THE CALLED ROUTINES          @Y30LB33*/ 03098000
*/********************************************************   @Y30LB33*/ 03099000
*                                                                  0812 03100000
*MODFYIT:                                                          0812 03101000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 03102000
*                                                                  0812 03103000
MODFYIT  DS    0H                                                  0813 03104000
*   /*****************************************************************/ 03105000
*   /*                                                               */ 03106000
*   /* RETURN ADDRES SAVE AREA                               @Y30LB33*/ 03107000
*   /*                                                               */ 03108000
*   /*****************************************************************/ 03109000
*                                                                  0813 03110000
*   DCL                                                            0813 03111000
*     MODFYSV PTR(31);              /*                       @Y30LB33*/ 03112000
*   MODFYSV=REG14;                  /*                       @Y30LB33*/ 03113000
         ST    REG14,MODFYSV                                       0814 03114000
*   OLDERID2=NEWERID2;                                             0815 03115000
         L     @07,@PC00001                                        0815 03116000
         L     @07,GDTTR2(,@07)                                    0815 03117000
         MVC   @TS00001(95),NEWERID2(@07)                          0815 03118000
         MVC   OLDERID2(95,@07),@TS00001                           0815 03119000
*   NEWID2='MVGA';                  /*                       @YM02887*/ 03120000
*                                                                  0816 03121000
         MVC   NEWID2(4,@07),@CC01710                              0816 03122000
*   /*****************************************************************/ 03123000
*   /*                                                               */ 03124000
*   /* IF WE ARE CHANGING THE SOFTWARE LABEL OR THE          @Y30LB33*/ 03125000
*   /* VOLUME ATTRIBUTES, CALL CHNGMSC TO                    @Y30LB33*/ 03126000
*   /* MAKE THE MODIFICATION                                 @Y30LB33*/ 03127000
*   /*                                                               */ 03128000
*   /*****************************************************************/ 03129000
*                                                                  0817 03130000
*   IF RENAMSW=ON|ATTRSW=ON|COPYATTR=ON|/*                   @Y30LB33*/ 03131000
*       ONLYONLY=ON THEN                                           0817 03132000
         TM    RENAMSW,B'01100010'                                 0817 03133000
         BNZ   @RT00817                                            0817 03134000
         TM    ONLYONLY,B'10000000'                                0817 03135000
         BNO   @RF00817                                            0817 03136000
@RT00817 DS    0H                                                  0818 03137000
*     CALL CHNGMSC;                 /*                       @Y30LB33*/ 03138000
*                                                                  0818 03139000
         BAL   @14,CHNGMSC                                         0818 03140000
*   /*****************************************************************/ 03141000
*   /*                                                               */ 03142000
*   /* OTHERWISE, CALL CHNGMSVC TO CHANGE THE MSVC           @Y30LB33*/ 03143000
*   /* RECORDS                                               @Y30LB33*/ 03144000
*   /*                                                               */ 03145000
*   /*****************************************************************/ 03146000
*                                                                  0819 03147000
*   ELSE                                                           0819 03148000
*     CALL CHNGMSVC;                /*                       @Y30LB33*/ 03149000
*                                                                  0819 03150000
         B     @RC00817                                            0819 03151000
@RF00817 BAL   @14,CHNGMSVC                                        0819 03152000
*   /*****************************************************************/ 03153000
*   /*                                                               */ 03154000
*   /* AND IF WE GET NO ERRORS, WE HAVE TO TELL              @Y30LB33*/ 03155000
*   /* THE USER THAT HIS BACKUP MAXIMUM HAS BEEN             @Y30LB33*/ 03156000
*   /* REDUCED BELOW THE NUMBER THAT EXIST, IF               @Y30LB33*/ 03157000
*   /* THAT IS INDEED THE CASE                               @Y30LB33*/ 03158000
*   /*                                                               */ 03159000
*   /*****************************************************************/ 03160000
*                                                                  0820 03161000
*   IF ADDR(BKUP)>0&LASTCOND^=TERMCODE/*                     @Y30LB33*/ 03162000
*     THEN                                                         0820 03163000
@RC00817 L     @07,@PC00001+4                                      0820 03164000
         L     @07,FDTPTR+64(,@07)                                 0820 03165000
         LTR   @07,@07                                             0820 03166000
         BNP   @RF00820                                            0820 03167000
         L     @15,@PC00001+8                                      0820 03168000
         CLC   LASTCOND(2,@15),@CH00038                            0820 03169000
         BE    @RF00820                                            0820 03170000
*     DO;                           /*                       @Y30LB33*/ 03171000
*       IF BKUPVAL<BASNBKUP THEN                                   0822 03172000
         L     @07,BKUPVAL(,@07)                                   0822 03173000
         SLR   @15,@15                                             0822 03174000
         IC    @15,BASNBKUP(,BASEVPTR)                             0822 03175000
         CR    @07,@15                                             0822 03176000
         BNL   @RF00822                                            0822 03177000
*         DO;                       /*                       @Y30LB33*/ 03178000
*                                                                  0823 03179000
*           /*********************************************************/ 03180000
*           /*                                                       */ 03181000
*           /* CREATE THE NUMBER TO INSERT IN                @Y30LB33*/ 03182000
*           /* THE MESSAGE                                   @Y30LB33*/ 03183000
*           /*                                                       */ 03184000
*           /*********************************************************/ 03185000
*                                                                  0824 03186000
*           MYBAKUP=BASNBKUP-BKUPVAL;/*                      @Y30LB33*/ 03187000
*                                                                  0824 03188000
         SLR   @15,@07                                             0824 03189000
         STC   @15,MYBAKUP                                         0824 03190000
*           /*********************************************************/ 03191000
*           /*                                                       */ 03192000
*           /* SET UP PRINT ARGUMENT LIST                    @Y30LB33*/ 03193000
*           /*                                                       */ 03194000
*           /*********************************************************/ 03195000
*                                                                  0825 03196000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 03197000
         L     @07,DDSTRU                                          0825 03198000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0825 03199000
*           DARGSENT=MSG0068I;      /*                       @Y30LB33*/ 03200000
         MVI   DARGSENT(@07),X'28'                                 0826 03201000
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/ 03202000
         MVC   DARGSMOD(3,@07),MODCMN                              0827 03203000
*           DARGILP=LENGTH(MYBAKUP);/*                       @Y30LB33*/ 03204000
         MVC   DARGILP(2,@07),@CH00221                             0828 03205000
*           DARGDBP=ADDR(MYBAKUP);  /*                       @Y30LB33*/ 03206000
*                                                                  0829 03207000
         LA    @15,MYBAKUP                                         0829 03208000
         ST    @15,DARGDBP(,@07)                                   0829 03209000
*           /*********************************************************/ 03210000
*           /*                                                       */ 03211000
*           /* PRINT THE MESSAGE                             @Y30LB33*/ 03212000
*           /*                                                       */ 03213000
*           /*********************************************************/ 03214000
*                                                                  0830 03215000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/ 03216000
         L     @07,@PC00001                                        0830 03217000
         ST    @07,@AL00001                                        0830 03218000
         LA    @15,@CF00117                                        0830 03219000
         ST    @15,@AL00001+4                                      0830 03220000
         LA    @15,DDSTRU                                          0830 03221000
         ST    @15,@AL00001+8                                      0830 03222000
         MVI   @AL00001+8,X'80'                                    0830 03223000
         L     @15,GDTPRT(,@07)                                    0830 03224000
         LA    @01,@AL00001                                        0830 03225000
         BALR  @14,@15                                             0830 03226000
*         END;                      /*                       @Y30LB33*/ 03227000
*     END;                          /*                       @Y30LB33*/ 03228000
*                                                                  0832 03229000
@RF00822 DS    0H                                                  0833 03230000
*   /*****************************************************************/ 03231000
*   /*                                                               */ 03232000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 03233000
*   /*                                                               */ 03234000
*   /*****************************************************************/ 03235000
*                                                                  0833 03236000
*   REG14=MODFYSV;                  /*                       @Y30LB33*/ 03237000
@RF00820 L     REG14,MODFYSV                                       0833 03238000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 03239000
         SLR   @15,@15                                             0834 03240000
@EL00011 DS    0H                                                  0834 03241000
@EF00011 DS    0H                                                  0834 03242000
@ER00011 BR    @14                                                 0834 03243000
*   END MODFYIT;                    /*                       @Y30LB33*/ 03244000
*                                                                  0836 03245000
*/********************************************************   @Y30LB33*/ 03246000
*/* PROCEDURE NAME - CHNGMSC                                 @Y30LB33*/ 03247000
*/*                                                          @Y30LB33*/ 03248000
*/* FUNCTION - TO CHANGE THE VOLUME BY ISSUEING THE DEFINE   @Y30LB33*/ 03249000
*/*      VOLUME COMMAND TO UPDATE THE MSC RECORDS AS WELL AS @Y30LB33*/ 03250000
*/*      THE INVENTORY RECORD                                @Y30LB33*/ 03251000
*/*                                                          @Y30LB33*/ 03252000
*/*      IF MOUNTED, THE VOLUME IS DEMOUNTED.                @Y30LB33*/ 03253000
*/*                                                          @Y30LB33*/ 03254000
*/*      IF NECESSARY, THE VOLUME IS CHECKED FOR EXCLUSIVE   @Y30LB33*/ 03255000
*/*      USE                                                 @Y30LB33*/ 03256000
*/*                                                          @Y30LB33*/ 03257000
*/*      USSC IS ISSUED TO CHANGE THE VOLUME, AND THE RETURN @Y30LB33*/ 03258000
*/*      CODE IS TESTED                                      @Y30LB33*/ 03259000
*/*                                                          @Y30LB33*/ 03260000
*/*      MESSAGE IDC0064I IS ISSUED IF THE CHANGE IS         @Y30LB33*/ 03261000
*/*      SUCCESSFUL.                                         @Y30LB33*/ 03262000
*/*                                                          @Y30LB33*/ 03263000
*/*      IF THE ATTRIBUTES WERE CHANGED TO AGREE WITH A      @Y30LB33*/ 03264000
*/*      GROUP, MESSAGE IDC3073I IS ISSUED                   @Y30LB33*/ 03265000
*/*                                                          @Y30LB33*/ 03266000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 03267000
*/*            BLDLIST                                       @Y30LB33*/ 03268000
*/*                                                          @Y30LB33*/ 03269000
*/* INPUT - THE FDTTBL, THE VOLUME RECORD AND THE GROUP      @Y30LB33*/ 03270000
*/*      RECORD                                              @Y30LB33*/ 03271000
*/*                                                          @Y30LB33*/ 03272000
*/* OUTPUT - THE LASTCOND IS SET TO 4 IF THE CHANGE WAS      @Y30LB33*/ 03273000
*/*      MADE BUT THE INVENTORY HAD AN I/O ERROR. IT IS      @Y30LB33*/ 03274000
*/*      SET TO 12 IF THE CHANGE FAILED.                     @Y30LB33*/ 03275000
*/*                                                          @Y30LB33*/ 03276000
*/*      THE INACTSW IN SWCHBITS IS TURNED ON IF THE         @Y30LB33*/ 03277000
*/*      CHANGE MADE THE VOLUME INACTIVE                     @Y30LB33*/ 03278000
*/********************************************************   @Y30LB33*/ 03279000
*                                                                  0836 03280000
*CHNGMSC:                                                          0836 03281000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 03282000
*                                                                  0836 03283000
CHNGMSC  DS    0H                                                  0837 03284000
*   /*****************************************************************/ 03285000
*   /*                                                               */ 03286000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 03287000
*   /*                                                               */ 03288000
*   /*****************************************************************/ 03289000
*                                                                  0837 03290000
*   DCL                                                            0837 03291000
*     CHNG1SV PTR(31);              /*                       @Y30LB33*/ 03292000
*   CHNG1SV=REG14;                  /*                       @Y30LB33*/ 03293000
         LR    CHNG1SV,REG14                                       0838 03294000
*   OLDERID2=NEWERID2;                                             0839 03295000
         L     @15,@PC00001                                        0839 03296000
         L     @14,GDTTR2(,@15)                                    0839 03297000
         MVC   @TS00001(95),NEWERID2(@14)                          0839 03298000
         MVC   OLDERID2(95,@14),@TS00001                           0839 03299000
*   NEWID2='MVHA';                  /*                       @YM02887*/ 03300000
*                                                                  0840 03301000
         MVC   NEWID2(4,@14),@CC01717                              0840 03302000
*   /*****************************************************************/ 03303000
*   /*                                                               */ 03304000
*   /* IF THE CHECK SWITCH IS ON, AN                         @ZA05125*/ 03305000
*   /* AUTHORIZATION CHECK WAS MADE ON THE                   @ZA05125*/ 03306000
*   /* VOLUME BY CKAUTH. SO WE MUST DEQUEUE                  @ZA05125*/ 03307000
*   /* ON THE RESERVE THAT WAS DONE BY THE                   @ZA05125*/ 03308000
*   /* VOLUME SERVICES ROUTINE                               @ZA05125*/ 03309000
*   /*                                                               */ 03310000
*   /*****************************************************************/ 03311000
*                                                                  0841 03312000
*   IF CKSW=ON THEN                                                0841 03313000
         TM    CKSW,B'01000000'                                    0841 03314000
         BNO   @RF00841                                            0841 03315000
*     DO;                           /*                       @ZA05125*/ 03316000
*       MINAMQL=MINQLR;             /*                       @ZA05125*/ 03317000
         MVC   MINAMQL(16),@CC01589                                0843 03318000
*       MINAMVOL=VOLVAL;            /*                       @ZA05125*/ 03319000
         L     @14,@PC00001+4                                      0844 03320000
         L     @01,FDTPTR(,@14)                                    0844 03321000
         MVC   MINAMVOL(6),VOLVAL(@01)                             0844 03322000
*       CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*           @ZA05125*/ 03323000
         ST    @15,@AL00001                                        0845 03324000
         LA    @14,MVMAJNAM                                        0845 03325000
         ST    @14,@AL00001+4                                      0845 03326000
         LA    @14,MVMINNAM                                        0845 03327000
         ST    @14,@AL00001+8                                      0845 03328000
         MVI   @AL00001+8,X'80'                                    0845 03329000
         L     @15,GDTDEQ(,@15)                                    0845 03330000
         LA    @01,@AL00001                                        0845 03331000
         BALR  @14,@15                                             0845 03332000
*     END;                          /*                       @ZA05125*/ 03333000
*                                                                  0846 03334000
*   /*****************************************************************/ 03335000
*   /*                                                               */ 03336000
*   /* IF THE FILE IS SPECIFIED OR THE VOLUME WAS            #Y30LB33*/ 03337000
*   /* MOUNTED, THEN WE MUST DEMOUNT THE VOLUME BEFORE       @YD00175*/ 03338000
*   /* WE ISSUE THE DEFINE VOLUME COMMAND                    @YD00175*/ 03339000
*   /*                                                               */ 03340000
*   /*****************************************************************/ 03341000
*                                                                  0847 03342000
*   IF ADDR(FYLE)>NULLPTR|MNTSW=ON THEN                            0847 03343000
@RF00841 L     @15,@PC00001+4                                      0847 03344000
         L     @15,FDTPTR+88(,@15)                                 0847 03345000
         LTR   @15,@15                                             0847 03346000
         BP    @RT00847                                            0847 03347000
         TM    MNTSW,B'00100000'                                   0847 03348000
         BNO   @RF00847                                            0847 03349000
@RT00847 DS    0H                                                  0848 03350000
*     DO;                           /*                       @YD00175*/ 03351000
*                                                                  0848 03352000
*       /*************************************************************/ 03353000
*       /*                                                           */ 03354000
*       /* FIRST MAKE UP THE ARGUMENT LIST FOR               @Y30LB33*/ 03355000
*       /* DEMOUNTING                                        @Y30LB33*/ 03356000
*       /*                                                           */ 03357000
*       /*************************************************************/ 03358000
*                                                                  0849 03359000
*       MDAGL=MDAGL&&MDAGL;         /*                       @Y30LB33*/ 03360000
         LA    @02,MVMDAGL                                         0849 03361000
         XC    MDAGL(37,@02),MDAGL(@02)                            0849 03362000
*       MDDDNAME=MVDDNAME;          /*                       @Y30LB33*/ 03363000
         MVC   MDDDNAME(8,@02),MVDDNAME                            0850 03364000
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @Y30LB33*/ 03365000
         LA    @15,MVUCBPTR                                        0851 03366000
         ST    @15,MDUCBPTR(,@02)                                  0851 03367000
*       MDLABEL=VOLVAL;             /*                       @Y30LB33*/ 03368000
         L     @15,@PC00001+4                                      0852 03369000
         L     @01,FDTPTR(,@15)                                    0852 03370000
         MVC   MDLABEL(6,@02),VOLVAL(@01)                          0852 03371000
*       MDWAIT=ON;                  /*                       @Y30LB33*/ 03372000
*                                                                  0853 03373000
         OI    MDWAIT(@02),B'00010000'                             0853 03374000
*       /*************************************************************/ 03375000
*       /*                                                           */ 03376000
*       /* ISSUE THE DEMOUNT COMMAND                         @Y30LB33*/ 03377000
*       /*                                                           */ 03378000
*       /*************************************************************/ 03379000
*                                                                  0854 03380000
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB33*/ 03381000
         L     @15,@PC00001                                        0854 03382000
         ST    @15,@AL00001                                        0854 03383000
         LA    @14,DEMOUNT                                         0854 03384000
         ST    @14,@AL00001+4                                      0854 03385000
         ST    @02,@AL00001+8                                      0854 03386000
         MVI   @AL00001+8,X'80'                                    0854 03387000
         L     @15,GDTUNT(,@15)                                    0854 03388000
         LA    @01,@AL00001                                        0854 03389000
         BALR  @14,@15                                             0854 03390000
*       RESPECIFY                                                  0855 03391000
*         RTNREG RSTD;                                             0855 03392000
*       TESTRC=RTNREG;                                             0856 03393000
         LR    TESTRC,RTNREG                                       0856 03394000
*       RESPECIFY                                                  0857 03395000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 03396000
*                                                                  0857 03397000
*       /*************************************************************/ 03398000
*       /*                                                           */ 03399000
*       /* IF DEMOUNT FAILED, TERMINATE BY SETTING           @Y30LB33*/ 03400000
*       /* TO 12                                             @Y30LB33*/ 03401000
*       /*                                                           */ 03402000
*       /*************************************************************/ 03403000
*                                                                  0858 03404000
*       IF TESTRC^=0 THEN           /*                       @Y30LB33*/ 03405000
         LTR   TESTRC,TESTRC                                       0858 03406000
         BZ    @RF00858                                            0858 03407000
*         LASTCOND=TERMCODE;        /*                       @Y30LB33*/ 03408000
*                                                                  0859 03409000
         L     @15,@PC00001+8                                      0859 03410000
         MVC   LASTCOND(2,@15),@CH00038                            0859 03411000
*       /*************************************************************/ 03412000
*       /*                                                           */ 03413000
*       /* OTHERWISE, INDICATE THE DEMOUNT IN THE            @YD00175*/ 03414000
*       /* SWITCH SETTINGS                                   @YD00175*/ 03415000
*       /*                                                           */ 03416000
*       /*************************************************************/ 03417000
*                                                                  0860 03418000
*       ELSE                                                       0860 03419000
*         DO;                       /*                       @YD00175*/ 03420000
         B     @RC00858                                            0860 03421000
@RF00858 DS    0H                                                  0861 03422000
*           MNTSW=OFF;              /*                       @YD00175*/ 03423000
         NI    MNTSW,B'11011111'                                   0861 03424000
*           DMNTSW=ON;              /*                       @YD00175*/ 03425000
         OI    DMNTSW,B'10000000'                                  0862 03426000
*         END;                      /*                       @YD00175*/ 03427000
*     END;                          /*                       @Y30LB33*/ 03428000
*                                                                  0864 03429000
@RC00858 DS    0H                                                  0865 03430000
*   /*****************************************************************/ 03431000
*   /*                                                               */ 03432000
*   /* IF NO ERRORS OCCURRED SO FAR,                         @Y30LB33*/ 03433000
*   /* CALL BLDLIST TO BUILD THE COMMAND                     @Y30LB33*/ 03434000
*   /* ARGUMENT LIST AND BACKOUT LIST                        @Y30LB33*/ 03435000
*   /* AND TAKE CARE OF ERRORS FROM THE                      @Y30LB33*/ 03436000
*   /* COMMAND. IF IT GOES ALRIGHT, PRINT                    @Y30LB33*/ 03437000
*   /* THE MESSAGE THAT INDICATES THAT ATTRIBUTES            @Y30LB33*/ 03438000
*   /* WERE CHANGED IF THEY CHANGED TO AGREE                 @Y30LB33*/ 03439000
*   /* WITH THE GROUP. IF WE GET ERRORS, JUST                @Y30LB33*/ 03440000
*   /* TERMINATE THE RUN                                     @Y30LB33*/ 03441000
*   /*                                                               */ 03442000
*   /*****************************************************************/ 03443000
*                                                                  0865 03444000
*   IF LASTCOND^=TERMCODE THEN                                     0865 03445000
@RF00847 L     @15,@PC00001+8                                      0865 03446000
         CLC   LASTCOND(2,@15),@CH00038                            0865 03447000
         BE    @RF00865                                            0865 03448000
*     DO;                           /*                       @Y30LB33*/ 03449000
*       CALL BLDLIST;               /*                       @Y30LB33*/ 03450000
*                                                                  0867 03451000
         BAL   @14,BLDLIST                                         0867 03452000
*       /*************************************************************/ 03453000
*       /*                                                           */ 03454000
*       /* AFTER BUILDING THE COMMAND                        @Y30LB33*/ 03455000
*       /* ARGUMENT, ISSUE THE COMMAND                       @Y30LB33*/ 03456000
*       /*                                                           */ 03457000
*       /*************************************************************/ 03458000
*                                                                  0868 03459000
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*     0868 03460000
*                                                            @Y30LB33*/ 03461000
         L     @02,@PC00001                                        0868 03462000
         ST    @02,@AL00001                                        0868 03463000
         LA    @15,DEFINE                                          0868 03464000
         ST    @15,@AL00001+4                                      0868 03465000
         LA    @15,DEFVPTR                                         0868 03466000
         ST    @15,@AL00001+8                                      0868 03467000
         LA    @15,RCAREA                                          0868 03468000
         ST    @15,@AL00001+12                                     0868 03469000
         LA    @15,ECBBYTE                                         0868 03470000
         ST    @15,@AL00001+16                                     0868 03471000
         MVI   @AL00001+16,X'80'                                   0868 03472000
         L     @15,GDTSSC(,@02)                                    0868 03473000
         LA    @01,@AL00001                                        0868 03474000
         BALR  @14,@15                                             0868 03475000
*       RESPECIFY                                                  0869 03476000
*         RTNREG RSTD;                                             0869 03477000
*       TESTRC=RTNREG;                                             0870 03478000
         LR    TESTRC,RTNREG                                       0870 03479000
*       RESPECIFY                                                  0871 03480000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 03481000
*                                                                  0871 03482000
*       /*************************************************************/ 03483000
*       /*                                                           */ 03484000
*       /* NOW TEST THE RETURN CODES FROM THE                @Y30LB33*/ 03485000
*       /* COMMAND. IF WE GET A 4, CALL SSCMSG               @Y30LB33*/ 03486000
*       /* TO PRINT THE REASON MESSAGE AND SET               @Y30LB33*/ 03487000
*       /* LASTCOND TO TERMINATE                             @Y30LB33*/ 03488000
*       /*                                                           */ 03489000
*       /*************************************************************/ 03490000
*                                                                  0872 03491000
*       IF TESTRC=4 THEN                                           0872 03492000
         C     TESTRC,@CF00043                                     0872 03493000
         BNE   @RF00872                                            0872 03494000
*         DO;                       /*                       @Y30LB33*/ 03495000
*           CALL SSCMSG(RCAREA,ECBBYTE);/*                   @Y30LB33*/ 03496000
         LA    @02,RCAREA                                          0874 03497000
         ST    @02,@AL00001                                        0874 03498000
         LA    @02,ECBBYTE                                         0874 03499000
         ST    @02,@AL00001+4                                      0874 03500000
         LA    @01,@AL00001                                        0874 03501000
         BAL   @14,SSCMSG                                          0874 03502000
*           LASTCOND=TERMCODE;      /*                       @Y30LB33*/ 03503000
         L     @02,@PC00001+8                                      0875 03504000
         MVC   LASTCOND(2,@02),@CH00038                            0875 03505000
*         END;                      /*                       @Y30LB33*/ 03506000
*                                                                  0876 03507000
*       /*************************************************************/ 03508000
*       /*                                                           */ 03509000
*       /* IF WE GET AN 8, WE COULD NOT GET                  @Y30LB33*/ 03510000
*       /* SPACE FOR THE COMMAND, AND IT FAILED              @Y30LB33*/ 03511000
*       /* WITH A MESSAGE PRINTED                            @Y30LB33*/ 03512000
*       /* SET LASTCOND TO 12                                @Y30LB33*/ 03513000
*       /*                                                           */ 03514000
*       /*************************************************************/ 03515000
*                                                                  0877 03516000
*       IF TESTRC=8 THEN                                           0877 03517000
@RF00872 C     TESTRC,@CF00035                                     0877 03518000
         BNE   @RF00877                                            0877 03519000
*         LASTCOND=TERMCODE;        /*                       @Y30LB33*/ 03520000
         L     @02,@PC00001+8                                      0878 03521000
         MVC   LASTCOND(2,@02),@CH00038                            0878 03522000
*                                                                  0879 03523000
*       /*************************************************************/ 03524000
*       /*                                                           */ 03525000
*       /* SO THE COMMAND HAS BEEN EXECUTED                  @Y30LB33*/ 03526000
*       /* SUCCESSFULLY AND WE MUST TELL THE                 @Y30LB33*/ 03527000
*       /* USER. A RETURN CODE OF ZERO SAYS                  @Y30LB33*/ 03528000
*       /* NOTHING WENT WRONG, AND A 12 INDICATES            @Y30LB33*/ 03529000
*       /* THAT ONLY THE INVENTORY RECORD WAS                @Y30LB33*/ 03530000
*       /* UPDATED                                           @Y30LB33*/ 03531000
*       /*                                                           */ 03532000
*       /*************************************************************/ 03533000
*                                                                  0879 03534000
*       IF TESTRC=0|TESTRC=12       /*                       @Y30LB33*/ 03535000
*         THEN                                                     0879 03536000
@RF00877 LTR   TESTRC,TESTRC                                       0879 03537000
         BZ    @RT00879                                            0879 03538000
         C     TESTRC,@CF00038                                     0879 03539000
         BNE   @RF00879                                            0879 03540000
@RT00879 DS    0H                                                  0880 03541000
*         DO;                       /*                       @Y30LB33*/ 03542000
*                                                                  0880 03543000
*           /*********************************************************/ 03544000
*           /*                                                       */ 03545000
*           /* IF PART OF THE LABEL UPDATE HAS NOW           @Y30LB33*/ 03546000
*           /* BEEN DONE, ISSUE MESSAGE IDC0064I.            @Y30LB33*/ 03547000
*           /* ISSUE ONE OF THE THREE VERSIONS BASED         @Y30LB33*/ 03548000
*           /* ON WHAT PART OF THE LABEL WAS UPDATED         @Y30LB33*/ 03549000
*           /*                                                       */ 03550000
*           /*********************************************************/ 03551000
*                                                                  0881 03552000
*           IF RENAMSW=ON THEN                                     0881 03553000
         TM    RENAMSW,B'01000000'                                 0881 03554000
         BNO   @RF00881                                            0881 03555000
*             DO;                   /*                       @Y30LB33*/ 03556000
*               DARGLIST=DARGLIST&&DARGLIST;/*               @Y30LB33*/ 03557000
         L     @15,DDSTRU                                          0883 03558000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0883 03559000
*               DARGSMOD=MODCMN;    /*                       @Y30LB33*/ 03560000
*                                                                  0884 03561000
         MVC   DARGSMOD(3,@15),MODCMN                              0884 03562000
*               /*****************************************************/ 03563000
*               /*                                                   */ 03564000
*               /* SET TO PRINT OWNER-ONLY UPDATE            @Y30LB33*/ 03565000
*               /*                                                   */ 03566000
*               /*****************************************************/ 03567000
*                                                                  0885 03568000
*               DARGSENT=MSG0064B;  /*                       @Y30LB33*/ 03569000
*                                                                  0885 03570000
         MVI   DARGSENT(@15),X'32'                                 0885 03571000
*               /*****************************************************/ 03572000
*               /*                                                   */ 03573000
*               /* IF NEW SERIAL, SET UP                     @Y30LB33*/ 03574000
*               /*                                                   */ 03575000
*               /*****************************************************/ 03576000
*                                                                  0886 03577000
*               IF ADDR(NEWSR)>NULLPTR THEN                        0886 03578000
         SLR   @15,@15                                             0886 03579000
         L     @14,@PC00001+4                                      0886 03580000
         C     @15,FDTPTR+4(,@14)                                  0886 03581000
         BNL   @RF00886                                            0886 03582000
*                 DO;               /*                       @Y30LB33*/ 03583000
*                                                                  0887 03584000
*                   /*************************************************/ 03585000
*                   /*                                               */ 03586000
*                   /* IF OWNER ALSO, SET UP                 @Y30LB33*/ 03587000
*                   /*                                               */ 03588000
*                   /*************************************************/ 03589000
*                                                                  0888 03590000
*                   IF ADDR(OWNER)>NULLPTR|ADDR(NOWN)>NULLPTR THEN 0888 03591000
         C     @15,FDTPTR+8(,@14)                                  0888 03592000
         BL    @RT00888                                            0888 03593000
         C     @15,FDTPTR+72(,@14)                                 0888 03594000
         BNL   @RF00888                                            0888 03595000
@RT00888 DS    0H                                                  0889 03596000
*                     DARGSENT=MSG0064C;/*                   @Y30LB33*/ 03597000
         L     @01,DDSTRU                                          0889 03598000
         MVI   DARGSENT(@01),X'33'                                 0889 03599000
*                   ELSE                                           0890 03600000
*                     DARGSENT=MSG0064A;/*                   @Y30LB33*/ 03601000
         B     @RC00888                                            0890 03602000
@RF00888 L     @01,DDSTRU                                          0890 03603000
         MVI   DARGSENT(@01),X'2E'                                 0890 03604000
*                 END;              /*                       @Y30LB33*/ 03605000
*                                                                  0891 03606000
@RC00888 DS    0H                                                  0892 03607000
*               /*****************************************************/ 03608000
*               /*                                                   */ 03609000
*               /* PRINT CHANGE COMPLETION MESSAGE           @Y30LB33*/ 03610000
*               /*                                                   */ 03611000
*               /*****************************************************/ 03612000
*                                                                  0892 03613000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB33*/ 03614000
@RF00886 L     @15,@PC00001                                        0892 03615000
         ST    @15,@AL00001                                        0892 03616000
         LA    @14,@CF00117                                        0892 03617000
         ST    @14,@AL00001+4                                      0892 03618000
         LA    @14,DDSTRU                                          0892 03619000
         ST    @14,@AL00001+8                                      0892 03620000
         MVI   @AL00001+8,X'80'                                    0892 03621000
         L     @15,GDTPRT(,@15)                                    0892 03622000
         LA    @01,@AL00001                                        0892 03623000
         BALR  @14,@15                                             0892 03624000
*                                                                  0893 03625000
*               /*****************************************************/ 03626000
*               /*                                                   */ 03627000
*               /* THE VOLUME HAS BEEN MADE INACTIVE,        @Y30LB33*/ 03628000
*               /* SO TURN ON THE SWITCH THAT INDICATES      @Y30LB33*/ 03629000
*               /* THAT CONDITION                            @Y30LB33*/ 03630000
*               /*                                                   */ 03631000
*               /*****************************************************/ 03632000
*                                                                  0893 03633000
*               INACTSW=ON;         /*                       @Y30LB33*/ 03634000
         OI    INACTSW,B'00000100'                                 0893 03635000
*             END;                  /*                       @Y30LB33*/ 03636000
*                                                                  0894 03637000
*           /*********************************************************/ 03638000
*           /*                                                       */ 03639000
*           /* ALSO, IF WE CHANGED THE ATTRIBUTES            @Y30LB33*/ 03640000
*           /* WE MUST TELL THE USER THAT THEY WERE          @Y30LB33*/ 03641000
*           /* CHANGED TO AGREE WITH THE GROUP,              @Y30LB33*/ 03642000
*           /* SINCE HE DID NOT ASK FOR THEM TO              @Y30LB33*/ 03643000
*           /* BE CHANGED WITH PARAMETERS                    @Y30LB33*/ 03644000
*           /* GET THE GROUP NAME FROM THE GROUP             @Y30LB33*/ 03645000
*           /* RECORD                                        @Y30LB33*/ 03646000
*           /*                                                       */ 03647000
*           /*********************************************************/ 03648000
*                                                                  0895 03649000
*           IF COPYATTR=ON|         /*                       @Y30LB33*/ 03650000
*               (ONLYONLY=ON&RENAMSW=OFF)/*                  @Y30LB33*/ 03651000
*             THEN                                                 0895 03652000
@RF00881 TM    COPYATTR,B'00000010'                                0895 03653000
         BO    @RT00895                                            0895 03654000
         TM    ONLYONLY,B'10000000'                                0895 03655000
         BNO   @RF00895                                            0895 03656000
         TM    RENAMSW,B'01000000'                                 0895 03657000
         BNZ   @RF00895                                            0895 03658000
@RT00895 DS    0H                                                  0896 03659000
*             DO;                   /*                       @Y30LB33*/ 03660000
*               DARGLIST=DARGLIST&&DARGLIST;/*               @Y30LB33*/ 03661000
         L     @15,DDSTRU                                          0897 03662000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0897 03663000
*               DARGSMOD=MODCMN;    /*                       @Y30LB33*/ 03664000
         MVC   DARGSMOD(3,@15),MODCMN                              0898 03665000
*               DARGSENT=MSG0073I;  /*                       @Y30LB33*/ 03666000
         MVI   DARGSENT(@15),X'21'                                 0899 03667000
*               DARGILP=LENGTH(GROVVGRP);/*                  @Y30LB33*/ 03668000
         MVC   DARGILP(2,@15),@CH00035                             0900 03669000
*               DARGDBP=ADDR(GROVVGRP);/*                    @Y30LB33*/ 03670000
         LA    @14,GROVVGRP(,GROUPPTR)                             0901 03671000
         ST    @14,DARGDBP(,@15)                                   0901 03672000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB33*/ 03673000
         L     @15,@PC00001                                        0902 03674000
         ST    @15,@AL00001                                        0902 03675000
         LA    @14,@CF00117                                        0902 03676000
         ST    @14,@AL00001+4                                      0902 03677000
         LA    @14,DDSTRU                                          0902 03678000
         ST    @14,@AL00001+8                                      0902 03679000
         MVI   @AL00001+8,X'80'                                    0902 03680000
         L     @15,GDTPRT(,@15)                                    0902 03681000
         LA    @01,@AL00001                                        0902 03682000
         BALR  @14,@15                                             0902 03683000
*             END;                  /*                       @Y30LB33*/ 03684000
*         END;                      /*                       @Y30LB33*/ 03685000
@RF00895 DS    0H                                                  0905 03686000
*     END;                          /*                       @Y30LB33*/ 03687000
*                                                                  0905 03688000
@RF00879 DS    0H                                                  0906 03689000
*   /*****************************************************************/ 03690000
*   /*                                                               */ 03691000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 03692000
*   /*                                                               */ 03693000
*   /*****************************************************************/ 03694000
*                                                                  0906 03695000
*   REG14=CHNG1SV;                  /*                       @Y30LB33*/ 03696000
@RF00865 LR    REG14,CHNG1SV                                       0906 03697000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 03698000
         SLR   @15,@15                                             0907 03699000
@EL00012 DS    0H                                                  0907 03700000
@EF00012 DS    0H                                                  0907 03701000
@ER00012 BR    @14                                                 0907 03702000
*   END CHNGMSC;                    /*                       @Y30LB33*/ 03703000
*                                                                  0909 03704000
*/********************************************************   @Y30LB33*/ 03705000
*/* PROCEDURE NAME - CHNGMSVC                                @Y30LB33*/ 03706000
*/*                                                          @Y30LB33*/ 03707000
*/* FUNCTION - TO UPDATE THE MSVC INVENTORY RECORD ONLY      @Y30LB33*/ 03708000
*/*                                                          @Y30LB33*/ 03709000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 03710000
*/*            BLDMVR                                        @Y30LB33*/ 03711000
*/*                                                          @Y30LB33*/ 03712000
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND               @Y30LB33*/ 03713000
*/*         THE GROUP RECORD                                 @Y30LB33*/ 03714000
*/*                                                          @Y30LB33*/ 03715000
*/* OUTPUT - LASTCOND IS SET TO 4 TO INDICATE THAT AN        @Y30LB33*/ 03716000
*/*      I/O ERROR OCCURRED IN THE INVENTORY. IT IS SET      @Y30LB33*/ 03717000
*/*      TO 12 TO INDICATE THE FAILURE OF THE MODIFY VOLUME  @Y30LB33*/ 03718000
*/*      RECORD COMMAND                                      @Y30LB33*/ 03719000
*/********************************************************   @Y30LB33*/ 03720000
*                                                                  0909 03721000
*CHNGMSVC:                                                         0909 03722000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 03723000
*                                                                  0909 03724000
CHNGMSVC DS    0H                                                  0910 03725000
*   /*****************************************************************/ 03726000
*   /*                                                               */ 03727000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 03728000
*   /*                                                               */ 03729000
*   /*****************************************************************/ 03730000
*                                                                  0910 03731000
*   DCL                                                            0910 03732000
*     CHNG2SV PTR(31);              /*                       @Y30LB33*/ 03733000
*                                                                  0911 03734000
*   /*****************************************************************/ 03735000
*   /*                                                               */ 03736000
*   /* SAVE RETURN ADDRESS                                   @Y30LB33*/ 03737000
*   /*                                                               */ 03738000
*   /*****************************************************************/ 03739000
*                                                                  0911 03740000
*   CHNG2SV=REG14;                  /*                       @Y30LB33*/ 03741000
         LR    CHNG2SV,REG14                                       0911 03742000
*   OLDERID2=NEWERID2;                                             0912 03743000
         L     @15,@PC00001                                        0912 03744000
         L     @15,GDTTR2(,@15)                                    0912 03745000
         MVC   @TS00001(95),NEWERID2(@15)                          0912 03746000
         MVC   OLDERID2(95,@15),@TS00001                           0912 03747000
*   NEWID2='MVIA';                  /*                       @YM02887*/ 03748000
*                                                                  0913 03749000
         MVC   NEWID2(4,@15),@CC01723                              0913 03750000
*   /*****************************************************************/ 03751000
*   /*                                                               */ 03752000
*   /* BUILD THE MODIFY VOLUME COMMAND LIST                  @Y30LB33*/ 03753000
*   /* FOR AN MSVI UPDATE BY CALLING BLDMVR                  @Y30LB33*/ 03754000
*   /*                                                               */ 03755000
*   /*****************************************************************/ 03756000
*                                                                  0914 03757000
*   CALL BLDMVR;                    /*                       @Y30LB33*/ 03758000
*                                                                  0914 03759000
         BAL   @14,BLDMVR                                          0914 03760000
*   /*****************************************************************/ 03761000
*   /*                                                               */ 03762000
*   /* AND AFTER THE LIST IS BUILT, ISSUE                    @Y30LB33*/ 03763000
*   /* THE COMMAND                                           @Y30LB33*/ 03764000
*   /*                                                               */ 03765000
*   /*****************************************************************/ 03766000
*                                                                  0915 03767000
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,RCAREA);/*              @Y30LB33*/ 03768000
         L     @02,@PC00001                                        0915 03769000
         ST    @02,@AL00001                                        0915 03770000
         LA    @15,VVIC                                            0915 03771000
         ST    @15,@AL00001+4                                      0915 03772000
         LA    @15,MVRPTR                                          0915 03773000
         ST    @15,@AL00001+8                                      0915 03774000
         LA    @15,RCAREA                                          0915 03775000
         ST    @15,@AL00001+12                                     0915 03776000
         MVI   @AL00001+12,X'80'                                   0915 03777000
         L     @15,GDTSSC(,@02)                                    0915 03778000
         LA    @01,@AL00001                                        0915 03779000
         BALR  @14,@15                                             0915 03780000
*   RESPECIFY                                                      0916 03781000
*     RTNREG RSTD;                                                 0916 03782000
*   TESTRC=RTNREG;                                                 0917 03783000
         LR    TESTRC,RTNREG                                       0917 03784000
*   RESPECIFY                                                      0918 03785000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 03786000
*                                                                  0918 03787000
*   /*****************************************************************/ 03788000
*   /*                                                               */ 03789000
*   /* TEST FOR ERRORS FROM THE MODIFY                       @Y30LB33*/ 03790000
*   /* COMMAND. IF WE GET A 4, CALL SSCMSG TO PRINT          @Y30LB33*/ 03791000
*   /* THE REASON, AND SET LASTCOND TO 12                    @Y30LB33*/ 03792000
*   /*                                                               */ 03793000
*   /*****************************************************************/ 03794000
*                                                                  0919 03795000
*   IF TESTRC=4 THEN                                               0919 03796000
         C     TESTRC,@CF00043                                     0919 03797000
         BNE   @RF00919                                            0919 03798000
*     DO;                           /*                       @Y30LB33*/ 03799000
*       CALL SSCMSG(RCAREA);        /*                       @Y30LB33*/ 03800000
         LA    @15,RCAREA                                          0921 03801000
         ST    @15,@AL00001                                        0921 03802000
         LA    @01,@AL00001                                        0921 03803000
         BAL   @14,SSCMSG                                          0921 03804000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 03805000
         L     @15,@PC00001+8                                      0922 03806000
         MVC   LASTCOND(2,@15),@CH00038                            0922 03807000
*     END;                          /*                       @Y30LB33*/ 03808000
*                                                                  0923 03809000
*   /*****************************************************************/ 03810000
*   /*                                                               */ 03811000
*   /* IF WE GET A 12 RETURN CODE, INDICATING                @Y30LB33*/ 03812000
*   /* THAT IN I/O ERROR OCCURRED IN THE                     @Y30LB33*/ 03813000
*   /* INVENTORY, THEN SET LASTCOND TO 4                     @Y30LB33*/ 03814000
*   /*                                                               */ 03815000
*   /*****************************************************************/ 03816000
*                                                                  0924 03817000
*   ELSE                                                           0924 03818000
*     IF TESTRC=12 THEN             /*                       @Y30LB33*/ 03819000
         B     @RC00919                                            0924 03820000
@RF00919 C     TESTRC,@CF00038                                     0924 03821000
         BNE   @RF00924                                            0924 03822000
*       LASTCOND=MAX(LASTCOND,LASTCC04);/*                   @Y30LB33*/ 03823000
*                                                                  0925 03824000
         L     @15,@PC00001+8                                      0925 03825000
         LH    @14,LASTCOND(,@15)                                  0925 03826000
         LA    @03,4                                               0925 03827000
         CR    @14,@03                                             0925 03828000
         BNL   *+6                                                      03829000
         LR    @14,@03                                             0925 03830000
         STH   @14,LASTCOND(,@15)                                  0925 03831000
*   /*****************************************************************/ 03832000
*   /*                                                               */ 03833000
*   /* RESTORE THE RETURN ADDRESS                            @Y30LB33*/ 03834000
*   /*                                                               */ 03835000
*   /*****************************************************************/ 03836000
*                                                                  0926 03837000
*   REG14=CHNG2SV;                  /*                       @Y30LB33*/ 03838000
@RF00924 DS    0H                                                  0926 03839000
@RC00919 LR    REG14,CHNG2SV                                       0926 03840000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 03841000
         SLR   @15,@15                                             0927 03842000
@EL00013 DS    0H                                                  0927 03843000
@EF00013 DS    0H                                                  0927 03844000
@ER00013 BR    @14                                                 0927 03845000
*   END CHNGMSVC;                   /*                       @Y30LB33*/ 03846000
*                                                                  0929 03847000
*/********************************************************   @Y30LB33*/ 03848000
*/* PROCEDURE NAME - LABELIT                                 @Y30LB33*/ 03849000
*/*                                                          @Y30LB33*/ 03850000
*/* FUNCTION - TO CHANGE THE VOLUME SOFTWARE                 @Y30LB33*/ 03851000
*/*         LABEL IF A NEW SERIAL IS REQUESTED               @Y30LB33*/ 03852000
*/*         OR THE OWNER IS CHANGING. IF AN ERROR            @Y30LB33*/ 03853000
*/*         OCCURS, THE CHANGE IS BACKED OUT                 @Y30LB33*/ 03854000
*/*                                                          @Y30LB33*/ 03855000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 03856000
*/*            ACTVOL                                        @Y30LB33*/ 03857000
*/*            ALLOVOL                                       @Y30LB33*/ 03858000
*/*            BACKOUT                                       @Y30LB33*/ 03859000
*/*            MNTVOL                                        @Y30LB33*/ 03860000
*/*            NEWLABL                                       @Y30LB33*/ 03861000
*/*            DMNTVOL                                       @Y30LB33*/ 03862000
*/*            SETFLGS                                       @Y30LB33*/ 03863000
*/*                                                          @Y30LB33*/ 03864000
*/* INPUT - THE VOLUME RECORD, THE FDTTBL, AND               @Y30LB33*/ 03865000
*/*         SWCHBITS                                         @Y30LB33*/ 03866000
*/*                                                          @Y30LB33*/ 03867000
*/* OUTPUT - LASTCOND IS SET TO 4 IF THE VOLUME              @Y30LB33*/ 03868000
*/*          FAILED TO DEMOUNT, OR THE VTOC DID              @Y30LB33*/ 03869000
*/*         NOT CLOSE PROPERLY, LASTCOND OF 8 IF             @Y30LB33*/ 03870000
*/*         MODIFICATION WAS DONE BUT READ-ONLY              @Y30LB33*/ 03871000
*/*         ATTRIBUTE WAS NOT SET BECAUSE OF AN ERROR        @Y30LB33*/ 03872000
*/*         AND LASTCOND OF 12 IF THE MODIFICATION           @Y30LB33*/ 03873000
*/*         FAILED COMPLETELY                                @Y30LB33*/ 03874000
*/********************************************************   @Y30LB33*/ 03875000
*                                                                  0929 03876000
*LABELIT:                                                          0929 03877000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 03878000
*                                                                  0929 03879000
LABELIT  DS    0H                                                  0930 03880000
*   /*****************************************************************/ 03881000
*   /*                                                               */ 03882000
*   /* RETURN ADDRESS STORE AREA                             @Y30LB33*/ 03883000
*   /*                                                               */ 03884000
*   /*****************************************************************/ 03885000
*                                                                  0930 03886000
*   DCL                                                            0930 03887000
*     LABELSV PTR(31);              /*                       @Y30LB33*/ 03888000
*   LABELSV=REG14;                  /*                       @Y30LB33*/ 03889000
         ST    REG14,LABELSV                                       0931 03890000
*   OLDERID2=NEWERID2;                                             0932 03891000
         L     @07,@PC00001                                        0932 03892000
         L     @07,GDTTR2(,@07)                                    0932 03893000
         MVC   @TS00001(95),NEWERID2(@07)                          0932 03894000
         MVC   OLDERID2(95,@07),@TS00001                           0932 03895000
*   NEWID2='MVJA';                  /*                       @ZA09560*/ 03896000
*                                                                  0933 03897000
         MVC   NEWID2(4,@07),@CC01729                              0933 03898000
*   /*****************************************************************/ 03899000
*   /*                                                               */ 03900000
*   /* ACTIVATE THE VOLUME, SINCE IT WAS INACTIVE            @Y30LB33*/ 03901000
*   /* AFTER THE PREVIOUS MODIFICATION REQUEST               @Y30LB33*/ 03902000
*   /* DONE IN THE CHNGMSC ROUTINE                           @Y30LB33*/ 03903000
*   /*                                                               */ 03904000
*   /*****************************************************************/ 03905000
*                                                                  0934 03906000
*   CALL ACTVOL;                    /*                       @Y30LB33*/ 03907000
*                                                                  0934 03908000
         BAL   @14,ACTVOL                                          0934 03909000
*   /*****************************************************************/ 03910000
*   /*                                                               */ 03911000
*   /* IF NO ERRORS HAVE BEEN FOUND, AND THE USER HAS        @YD00175*/ 03912000
*   /* NOT PROVIDED A FILE PARAMETER, AND THE SECURITY       @YD00175*/ 03913000
*   /* CHECK WAS NOT PERFORMED, INDICATING THAT THE          @YD00175*/ 03914000
*   /* UNIT HAS NOT YET BEEN ALLOCATED, CALL THE             @YD00175*/ 03915000
*   /* ALLOVOL ROUTINE TO ALLOCATE A UNIT                    @YD00175*/ 03916000
*   /*                                                               */ 03917000
*   /*****************************************************************/ 03918000
*                                                                  0935 03919000
*   IF LASTCOND<TERMCODE&CKSW=OFF&  /*                       @YD00175*/ 03920000
*       ADDR(FYLE)=0 THEN                                          0935 03921000
         L     @07,@PC00001+8                                      0935 03922000
         LH    @07,LASTCOND(,@07)                                  0935 03923000
         C     @07,@CF00038                                        0935 03924000
         BNL   @RF00935                                            0935 03925000
         TM    CKSW,B'01000000'                                    0935 03926000
         BNZ   @RF00935                                            0935 03927000
         L     @07,@PC00001+4                                      0935 03928000
         L     @07,FDTPTR+88(,@07)                                 0935 03929000
         LTR   @07,@07                                             0935 03930000
         BNZ   @RF00935                                            0935 03931000
*     DO;                           /*                       @Y30LB33*/ 03932000
*       CALL ALLOVOL(MVVOLUME);     /*                       @Y30LB33*/ 03933000
*                                                                  0937 03934000
         LA    @07,MVVOLUME                                        0937 03935000
         ST    @07,@AL00001                                        0937 03936000
         LA    @01,@AL00001                                        0937 03937000
         BAL   @14,ALLOVOL                                         0937 03938000
*       /*************************************************************/ 03939000
*       /*                                                           */ 03940000
*       /* IF THE ALLOCATION FAILED, BACKOUT THE             @YD00175*/ 03941000
*       /* PREVIOUS CHANGES BE CALLING THE                   @YD00175*/ 03942000
*       /* BACKOUT ROUTINE                                   @YD00175*/ 03943000
*       /*                                                           */ 03944000
*       /*************************************************************/ 03945000
*                                                                  0938 03946000
*       IF LASTCOND=TERMCODE THEN                                  0938 03947000
         L     @07,@PC00001+8                                      0938 03948000
         CLC   LASTCOND(2,@07),@CH00038                            0938 03949000
         BNE   @RF00938                                            0938 03950000
*         CALL BACKOUT;             /*                       @Y30LB33*/ 03951000
         BAL   @14,BACKOUT                                         0939 03952000
*     END;                          /*                       @Y30LB33*/ 03953000
*                                                                  0940 03954000
*   /*****************************************************************/ 03955000
*   /*                                                               */ 03956000
*   /* OTHERWISE THE UNIT IS ALREADY ALLOCATED AND           @Y30LB33*/ 03957000
*   /* WE HAVE TO MOUNT THE VOLUME ON IT                     @Y30LB33*/ 03958000
*   /* SO CALL THE MNTVOL ROUTINE                            @Y30LB33*/ 03959000
*   /*                                                               */ 03960000
*   /*****************************************************************/ 03961000
*                                                                  0941 03962000
*   ELSE                                                           0941 03963000
*     IF LASTCOND<TERMCODE THEN                                    0941 03964000
         B     @RC00935                                            0941 03965000
@RF00935 L     @07,@PC00001+8                                      0941 03966000
         LH    @07,LASTCOND(,@07)                                  0941 03967000
         C     @07,@CF00038                                        0941 03968000
         BNL   @RF00941                                            0941 03969000
*       DO;                         /*                       @YD00175*/ 03970000
*         CALL MNTVOL;              /*                       @YD00175*/ 03971000
         BAL   @14,MNTVOL                                          0943 03972000
*         IF MNTSW=OFF THEN                                        0944 03973000
         TM    MNTSW,B'00100000'                                   0944 03974000
         BNZ   @RF00944                                            0944 03975000
*           DO;                     /*                       @YD00175*/ 03976000
*             CALL BACKOUT;         /*                       @YD00175*/ 03977000
         BAL   @14,BACKOUT                                         0946 03978000
*             LASTCOND=TERMCODE;    /*                       @YD00175*/ 03979000
         L     @07,@PC00001+8                                      0947 03980000
         MVC   LASTCOND(2,@07),@CH00038                            0947 03981000
*           END;                    /*                       @YD00175*/ 03982000
*       END;                        /*                       @YD00175*/ 03983000
*                                                                  0949 03984000
@RF00944 DS    0H                                                  0950 03985000
*   /*****************************************************************/ 03986000
*   /*                                                               */ 03987000
*   /* IF WE HAVE SUCCESSFULLY ALLOCATED THE                 @Y30LB33*/ 03988000
*   /* UNIT AND MOUNTED THE VOLUME, WE CAN                   @Y30LB33*/ 03989000
*   /* CHANGE THE VOLUME LABEL                               @Y30LB33*/ 03990000
*   /*                                                               */ 03991000
*   /*****************************************************************/ 03992000
*                                                                  0950 03993000
*   IF LASTCOND<TERMCODE THEN                                      0950 03994000
@RF00941 DS    0H                                                  0950 03995000
@RC00935 L     @07,@PC00001+8                                      0950 03996000
         LH    @07,LASTCOND(,@07)                                  0950 03997000
         C     @07,@CF00038                                        0950 03998000
         BNL   @RF00950                                            0950 03999000
*     CALL NEWLABL;                 /*                       @Y30LB33*/ 04000000
*                                                                  0951 04001000
         BAL   @14,NEWLABL                                         0951 04002000
*   /*****************************************************************/ 04003000
*   /*                                                               */ 04004000
*   /* IF NO ERRORS OCCURRED, CALL THE DMNTVOL ROUTINE       @Y30LB33*/ 04005000
*   /* TO PRINT A MESSAGE, DEQUEUE ON THE                    @Y30LB33*/ 04006000
*   /* RESERVE DONE BY VOLUME SERVICES, AND DEMOUNT          @Y30LB33*/ 04007000
*   /* VOLUME. DEMOUNTING IS DONE ONLY IF                    @Y30LB33*/ 04008000
*   /* WE MUST ISSUE ANOTHER COMMAND TO CHANGE               @Y30LB33*/ 04009000
*   /* THE READONLY ATTRIBUTE AND THE MISMATCH               @Y30LB33*/ 04010000
*   /* FLAG                                                  @Y30LB33*/ 04011000
*   /*                                                               */ 04012000
*   /*****************************************************************/ 04013000
*                                                                  0952 04014000
*   IF LASTCOND<TERMCODE THEN                                      0952 04015000
@RF00950 L     @07,@PC00001+8                                      0952 04016000
         LH    @07,LASTCOND(,@07)                                  0952 04017000
         C     @07,@CF00038                                        0952 04018000
         BNL   @RF00952                                            0952 04019000
*     CALL DMNTVOL;                 /*                       @Y30LB33*/ 04020000
*                                                                  0953 04021000
         BAL   @14,DMNTVOL                                         0953 04022000
*   /*****************************************************************/ 04023000
*   /*                                                               */ 04024000
*   /* IF WE DO NOT HAVE A TERMINATING                       @Y30LB33*/ 04025000
*   /* ERROR AND THE MISMATCH FLAG HAS                       @Y30LB33*/ 04026000
*   /* NOT BEEN CLEARED, AND WE HAVE                         @Y30LB33*/ 04027000
*   /* CHANGED THE VOLUME SERIAL, THEN WE                    @Y30LB33*/ 04028000
*   /* MUST TRY TO TURN OFF THE MISMATCH                     @Y30LB33*/ 04029000
*   /*                                                               */ 04030000
*   /*****************************************************************/ 04031000
*                                                                  0954 04032000
*   IF LASTCOND<TERMCODE&           /*                       @Y30LB33*/ 04033000
*       MISCLEAR=OFF&               /*                       @Y30LB33*/ 04034000
*       ADDR(NEWSR)>0 THEN                                         0954 04035000
@RF00952 L     @15,@PC00001+8                                      0954 04036000
         LH    @15,LASTCOND(,@15)                                  0954 04037000
         C     @15,@CF00038                                        0954 04038000
         BNL   @RF00954                                            0954 04039000
         TM    MISCLEAR,B'00000001'                                0954 04040000
         BNZ   @RF00954                                            0954 04041000
         L     @15,@PC00001+4                                      0954 04042000
         L     @15,FDTPTR+4(,@15)                                  0954 04043000
         LTR   @15,@15                                             0954 04044000
         BNP   @RF00954                                            0954 04045000
*     CALL SETFLGS;                 /*                       @Y30LB33*/ 04046000
*                                                                  0955 04047000
         BAL   @14,SETFLGS                                         0955 04048000
*   /*****************************************************************/ 04049000
*   /*                                                               */ 04050000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 04051000
*   /*                                                               */ 04052000
*   /*****************************************************************/ 04053000
*                                                                  0956 04054000
*   REG14=LABELSV;                  /*                       @Y30LB33*/ 04055000
@RF00954 L     REG14,LABELSV                                       0956 04056000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 04057000
         SLR   @15,@15                                             0957 04058000
@EL00014 DS    0H                                                  0957 04059000
@EF00014 DS    0H                                                  0957 04060000
@ER00014 BR    @14                                                 0957 04061000
*   END LABELIT;                    /*                       @Y30LB33*/ 04062000
*                                                                  0959 04063000
*/********************************************************   @Y30LB33*/ 04064000
*/* PROCEDURE NAME - ACTVOL                                  @Y30LB33*/ 04065000
*/*                                                          @Y30LB33*/ 04066000
*/* FUNCTION - TO ACTIVATE THE VOLUME THAT IS TO BE          @Y30LB33*/ 04067000
*/*      TO BE RELABELED. IF THE ACTIVATE FAILS, BACK OUT    @Y30LB33*/ 04068000
*/*      THE CHANGES AND PRINT IDC2075I.                     @Y30LB33*/ 04069000
*/*                                                          @Y30LB33*/ 04070000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 04071000
*/*            BACKOUT                                       @Y30LB33*/ 04072000
*/*                                                          @Y30LB33*/ 04073000
*/*      MESSAGE IDC2075I IS ISSUED IF THE ACTIVATE FAILS    @Y30LB33*/ 04074000
*/*                                                          @Y30LB33*/ 04075000
*/* INPUT - THE VOLUME RECORD, THE FDTTBL, AND SWCHBITS      @Y30LB33*/ 04076000
*/*                                                          @Y30LB33*/ 04077000
*/* OUTPUT - LASTCOND IS SET TO 4 IF THERE IS AN I/O         @Y30LB33*/ 04078000
*/*      ERROR IN THE INVENTORY. LASTCOND IS SET TO 12       @Y30LB33*/ 04079000
*/*      IF THE ACTIVATE FAILS                               @Y30LB33*/ 04080000
*/*                                                          @Y30LB33*/ 04081000
*/*      INACTSW IS SET OFF IF THE ACTIVATE RUNS             @Y30LB33*/ 04082000
*/********************************************************   @Y30LB33*/ 04083000
*                                                                  0959 04084000
*ACTVOL:                                                           0959 04085000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 04086000
*                                                                  0959 04087000
ACTVOL   DS    0H                                                  0960 04088000
*   /*****************************************************************/ 04089000
*   /*                                                               */ 04090000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 04091000
*   /*                                                               */ 04092000
*   /*****************************************************************/ 04093000
*                                                                  0960 04094000
*   DCL                                                            0960 04095000
*     ACTVOLSV PTR(31);             /*                       @Y30LB33*/ 04096000
*   ACTVOLSV=REG14;                 /*                       @Y30LB33*/ 04097000
         LR    ACTVOLSV,REG14                                      0961 04098000
*   OLDERID2=NEWERID2;                                             0962 04099000
         L     @15,@PC00001                                        0962 04100000
         L     @14,GDTTR2(,@15)                                    0962 04101000
         MVC   @TS00001(95),NEWERID2(@14)                          0962 04102000
         MVC   OLDERID2(95,@14),@TS00001                           0962 04103000
*   NEWID2='MVNA';                  /*                       @Y30LB33*/ 04104000
*                                                                  0963 04105000
         MVC   NEWID2(4,@14),@CC01738                              0963 04106000
*   /*****************************************************************/ 04107000
*   /*                                                               */ 04108000
*   /* BUILD THE ACTIVATE COMMAND ARGUMENT LIST              @Y30LB33*/ 04109000
*   /*                                                               */ 04110000
*   /*****************************************************************/ 04111000
*                                                                  0964 04112000
*   DEFLIST=DEFLIST&&DEFLIST;       /*                       @Y30LB33*/ 04113000
         L     @14,DEFVPTR                                         0964 04114000
         XC    DEFLIST(132,@14),DEFLIST(@14)                       0964 04115000
*   DEFVACT=ON;                     /*                       @Y30LB33*/ 04116000
         OI    DEFVACT(@14),B'00000010'                            0965 04117000
*   DEFVCSN1=BASCSN1;               /*                       @Y30LB33*/ 04118000
*                                                                  0966 04119000
         MVC   DEFVCSN1(12,@14),BASCSN1(BASEVPTR)                  0966 04120000
*   /*****************************************************************/ 04121000
*   /*                                                               */ 04122000
*   /* DUMP THE ACTIVATE ARGUMENT LIST                       @Y30LB33*/ 04123000
*   /*                                                               */ 04124000
*   /*****************************************************************/ 04125000
*                                                                  0967 04126000
*   IF GDTDBG=NULLPTR THEN                                         0967 04127000
         L     @15,GDTDBG(,@15)                                    0967 04128000
         LTR   @15,@15                                             0967 04129000
         BZ    @RT00967                                            0967 04130000
*     ;                                                            0968 04131000
*   ELSE                                                           0969 04132000
*     DO;                                                          0969 04133000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 04134000
         LA    DMPINDEX,DUMPAREA                                   0970 04135000
*       DMPITMNM='DEFLIST';                                        0971 04136000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0971 04137000
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       0971 04138000
*       DMPITMPT=ADDR(DEFLIST);                                    0972 04139000
         L     @03,DEFVPTR                                         0972 04140000
         ST    @03,DMPITMPT(,DMPINDEX)                             0972 04141000
*       DMPITMLN=LENGTH(DEFLIST);                                  0973 04142000
         MVC   DMPITMLN(2,DMPINDEX),@CH01836                       0973 04143000
*       DMPITMTP='H';                                              0974 04144000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0974 04145000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0975 04146000
*                                                                  0975 04147000
         AL    DMPINDEX,@CF00507                                   0975 04148000
*       /*************************************************************/ 04149000
*       /*                                                           */ 04150000
*       /*                                                   @Y30LB33*/ 04151000
*       /*                                                           */ 04152000
*       /*************************************************************/ 04153000
*                                                                  0976 04154000
*       DMPTRM=DMPTRMVL;                                           0976 04155000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0976 04156000
*     END;                          /*                       @Y30LB33*/ 04157000
*   IF GDTDBG=NULLPTR THEN                                         0978 04158000
@RT00967 L     @15,@PC00001                                        0978 04159000
         L     @15,GDTDBG(,@15)                                    0978 04160000
         LTR   @15,@15                                             0978 04161000
         BZ    @RT00978                                            0978 04162000
*     ;                                                            0979 04163000
*   ELSE                                                           0980 04164000
*     CALL IDCDB010(GDTTBL,'MVNB',DUMPADDR);/*               @Y30LB33*/ 04165000
*                                                                  0980 04166000
         L     @15,@PC00001                                        0980 04167000
         ST    @15,@AL00001                                        0980 04168000
         LA    @14,@CC01740                                        0980 04169000
         ST    @14,@AL00001+4                                      0980 04170000
         LA    @14,DUMPADDR                                        0980 04171000
         ST    @14,@AL00001+8                                      0980 04172000
         MVI   @AL00001+8,X'80'                                    0980 04173000
         L     @15,GDTDBG(,@15)                                    0980 04174000
         LA    @01,@AL00001                                        0980 04175000
         BALR  @14,@15                                             0980 04176000
*   /*****************************************************************/ 04177000
*   /*                                                               */ 04178000
*   /* ISSUE USSC TO ACTIVATE                                @Y30LB33*/ 04179000
*   /*                                                               */ 04180000
*   /*****************************************************************/ 04181000
*                                                                  0981 04182000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*   @Y30LB33*/ 04183000
@RT00978 L     @02,@PC00001                                        0981 04184000
         ST    @02,@AL00001                                        0981 04185000
         LA    @15,DEFINE                                          0981 04186000
         ST    @15,@AL00001+4                                      0981 04187000
         LA    @15,DEFVPTR                                         0981 04188000
         ST    @15,@AL00001+8                                      0981 04189000
         LA    @15,RCAREA                                          0981 04190000
         ST    @15,@AL00001+12                                     0981 04191000
         LA    @15,ECBBYTE                                         0981 04192000
         ST    @15,@AL00001+16                                     0981 04193000
         MVI   @AL00001+16,X'80'                                   0981 04194000
         L     @15,GDTSSC(,@02)                                    0981 04195000
         LA    @01,@AL00001                                        0981 04196000
         BALR  @14,@15                                             0981 04197000
*   RESPECIFY                                                      0982 04198000
*     RTNREG RSTD;                                                 0982 04199000
*   TESTRC=RTNREG;                                                 0983 04200000
         LR    TESTRC,RTNREG                                       0983 04201000
*   RESPECIFY                                                      0984 04202000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 04203000
*                                                                  0985 04204000
*   /*****************************************************************/ 04205000
*   /*                                                               */ 04206000
*   /* IF THERE WAS AN I/O ERROR IN THE INVENTORY,           @Y30LB33*/ 04207000
*   /* SET THE LASTCOND TO 4                                 @Y30LB33*/ 04208000
*   /*                                                               */ 04209000
*   /*****************************************************************/ 04210000
*                                                                  0985 04211000
*   IF TESTRC=12 THEN               /*                       @Y30LB33*/ 04212000
         C     TESTRC,@CF00038                                     0985 04213000
         BNE   @RF00985                                            0985 04214000
*     LASTCOND=MAX(LASTCOND,LASTCC04);/*                     @Y30LB33*/ 04215000
*                                                                  0986 04216000
         L     @02,@PC00001+8                                      0986 04217000
         LH    @15,LASTCOND(,@02)                                  0986 04218000
         LA    @14,4                                               0986 04219000
         CR    @15,@14                                             0986 04220000
         BNL   *+6                                                      04221000
         LR    @15,@14                                             0986 04222000
         STH   @15,LASTCOND(,@02)                                  0986 04223000
*   /*****************************************************************/ 04224000
*   /*                                                               */ 04225000
*   /* IF WE GOT AN ERROR, WE MUST ALSO TELL THE USER        @Y30LB33*/ 04226000
*   /* THAT WE COULD NOT ACTIVATE THE VOLUME TO CHANGE       @Y30LB33*/ 04227000
*   /* THE LABEL BY ISSUING IDC2075I                         @Y30LB33*/ 04228000
*   /* THEN CALL BACKOUT TO RESTORE THE VOLUME               @Y30LB33*/ 04229000
*   /*                                                               */ 04230000
*   /*****************************************************************/ 04231000
*                                                                  0987 04232000
*   IF TESTRC=4|TESTRC=8 THEN                                      0987 04233000
@RF00985 C     TESTRC,@CF00043                                     0987 04234000
         BE    @RT00987                                            0987 04235000
         C     TESTRC,@CF00035                                     0987 04236000
         BNE   @RF00987                                            0987 04237000
@RT00987 DS    0H                                                  0988 04238000
*     DO;                           /*                       @Y30LB33*/ 04239000
*       IF TESTRC=4 THEN            /*                       @Y30LB33*/ 04240000
         C     TESTRC,@CF00043                                     0989 04241000
         BNE   @RF00989                                            0989 04242000
*         CALL SSCMSG(RCAREA,ECBBYTE);/*                     @Y30LB33*/ 04243000
         LA    @02,RCAREA                                          0990 04244000
         ST    @02,@AL00001                                        0990 04245000
         LA    @02,ECBBYTE                                         0990 04246000
         ST    @02,@AL00001+4                                      0990 04247000
         LA    @01,@AL00001                                        0990 04248000
         BAL   @14,SSCMSG                                          0990 04249000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 04250000
@RF00989 L     @02,DDSTRU                                          0991 04251000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0991 04252000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 04253000
         MVC   DARGSMOD(3,@02),MODCMN                              0992 04254000
*       DARGSENT=MSG2075I;          /*                       @Y30LB33*/ 04255000
         MVI   DARGSENT(@02),X'1F'                                 0993 04256000
*       DARGILP=LENGTH(MVVOLUME);   /*                       @Y30LB33*/ 04257000
         MVC   DARGILP(2,@02),@CH00159                             0994 04258000
*       DARGDBP=ADDR(MVVOLUME);     /*                       @Y30LB33*/ 04259000
         LA    @15,MVVOLUME                                        0995 04260000
         ST    @15,DARGDBP(,@02)                                   0995 04261000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 04262000
*                                                                  0996 04263000
         L     @02,@PC00001                                        0996 04264000
         ST    @02,@AL00001                                        0996 04265000
         LA    @15,@CF00117                                        0996 04266000
         ST    @15,@AL00001+4                                      0996 04267000
         LA    @15,DDSTRU                                          0996 04268000
         ST    @15,@AL00001+8                                      0996 04269000
         MVI   @AL00001+8,X'80'                                    0996 04270000
         L     @15,GDTPRT(,@02)                                    0996 04271000
         LA    @01,@AL00001                                        0996 04272000
         BALR  @14,@15                                             0996 04273000
*       /*************************************************************/ 04274000
*       /*                                                           */ 04275000
*       /* SET THE LASTCOND TO 12                            @Y30LB33*/ 04276000
*       /*                                                           */ 04277000
*       /*************************************************************/ 04278000
*                                                                  0997 04279000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 04280000
*                                                                  0997 04281000
         L     @02,@PC00001+8                                      0997 04282000
         MVC   LASTCOND(2,@02),@CH00038                            0997 04283000
*       /*************************************************************/ 04284000
*       /*                                                           */ 04285000
*       /* THEN RESTORE THE VOLUME                           @Y30LB33*/ 04286000
*       /*                                                           */ 04287000
*       /*************************************************************/ 04288000
*                                                                  0998 04289000
*       CALL BACKOUT;               /*                       @Y30LB33*/ 04290000
         BAL   @14,BACKOUT                                         0998 04291000
*     END;                          /*                       @Y30LB33*/ 04292000
*                                                                  0999 04293000
*   /*****************************************************************/ 04294000
*   /*                                                               */ 04295000
*   /* IF NO ERRORS OCCURRED, TURN OFF THE INACTIVE          @Y30LB33*/ 04296000
*   /* SWITCH IN SWCHBITS                                    @Y30LB33*/ 04297000
*   /*                                                               */ 04298000
*   /*****************************************************************/ 04299000
*                                                                  1000 04300000
*   ELSE                                                           1000 04301000
*     INACTSW=OFF;                  /*                       @Y30LB33*/ 04302000
*                                                                  1000 04303000
         B     @RC00987                                            1000 04304000
@RF00987 NI    INACTSW,B'11111011'                                 1000 04305000
*   /*****************************************************************/ 04306000
*   /*                                                               */ 04307000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 04308000
*   /*                                                               */ 04309000
*   /*****************************************************************/ 04310000
*                                                                  1001 04311000
*   REG14=ACTVOLSV;                 /*                       @Y30LB33*/ 04312000
@RC00987 LR    REG14,ACTVOLSV                                      1001 04313000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 04314000
         SLR   @15,@15                                             1002 04315000
@EL00015 DS    0H                                                  1002 04316000
@EF00015 DS    0H                                                  1002 04317000
@ER00015 BR    @14                                                 1002 04318000
*   END ACTVOL;                     /*                       @Y30LB33*/ 04319000
*                                                                  1004 04320000
*/********************************************************   @Y30LB33*/ 04321000
*/* PROCEDURE NAME - ALLOVOL                                 @Y30LB33*/ 04322000
*/*                                                          @Y30LB33*/ 04323000
*/* FUNCTION - TO ALLOCATE A UNIT AND MOUNT THE              @Y30LB33*/ 04324000
*/*      VOLUME TO BE RELABELED, AND OBTAIN THE ALLOCATED    @YD00175*/ 04325000
*/*      UNIT FOR EXCLUSIVE USE                              @Y30LB33*/ 04326000
*/*                                                          @Y30LB33*/ 04327000
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND SWCHBITS      @Y30LB33*/ 04328000
*/*                                                          @Y30LB33*/ 04329000
*/* OUTPUT - LASTCOND OF 12 FOR AN ALLOCATION FAILURE        @Y30LB33*/ 04330000
*/*      OR A NON-EXCLUSIVE VOLUME                           @Y30LB33*/ 04331000
*/********************************************************   @Y30LB33*/ 04332000
*                                                                  1004 04333000
*ALLOVOL:                                                          1004 04334000
*   PROCEDURE(VOLARG) OPTIONS(NOSAVE,NOSAVEAREA);/*          @Y30LB33*/ 04335000
*                                                                  1004 04336000
ALLOVOL  MVC   @PC00016(4),0(@01)                                  1004 04337000
*   /*****************************************************************/ 04338000
*   /*                                                               */ 04339000
*   /* INPUT VOLUME SERIAL TO BE ALLOCATED                   @Y30LB33*/ 04340000
*   /*                                                               */ 04341000
*   /*****************************************************************/ 04342000
*                                                                  1005 04343000
*   DCL                                                            1005 04344000
*     VOLARG CHAR(6);               /*                       @Y30LB33*/ 04345000
*                                                                  1005 04346000
*   /*****************************************************************/ 04347000
*   /*                                                               */ 04348000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 04349000
*   /*                                                               */ 04350000
*   /*****************************************************************/ 04351000
*                                                                  1006 04352000
*   DCL                                                            1006 04353000
*     ALLOVSV PTR(31);              /*                       @Y30LB33*/ 04354000
*   ALLOVSV=REG14;                  /*                       @Y30LB33*/ 04355000
         LR    ALLOVSV,REG14                                       1007 04356000
*   OLDERID2=NEWERID2;                                             1008 04357000
         L     @02,@PC00001                                        1008 04358000
         L     @15,GDTTR2(,@02)                                    1008 04359000
         MVC   @TS00001(95),NEWERID2(@15)                          1008 04360000
         MVC   OLDERID2(95,@15),@TS00001                           1008 04361000
*   NEWID2='MVOA';                  /*                       @Y30LB33*/ 04362000
*                                                                  1009 04363000
         MVC   NEWID2(4,@15),@CC01747                              1009 04364000
*   /*****************************************************************/ 04365000
*   /*                                                               */ 04366000
*   /* ISSUE UMSSUNIT WITH SELECTX TO DETERMINE              @YD00175*/ 04367000
*   /* IF THE VOLUME IS ALREADY AVAILABLE FOR                @YD00175*/ 04368000
*   /* EXCLUSIVE USE                                         @YD00175*/ 04369000
*   /*                                                               */ 04370000
*   /*****************************************************************/ 04371000
*                                                                  1010 04372000
*   EXCLAGL=EXCLAGL&&EXCLAGL;       /*                       @YD00175*/ 04373000
         LA    @15,MVEXAGL                                         1010 04374000
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        1010 04375000
*   EXCLUCBP=ADDR(MVUCBPTR);        /*                       @YD00175*/ 04376000
         LA    @14,MVUCBPTR                                        1011 04377000
         ST    @14,EXCLUCBP(,@15)                                  1011 04378000
*   EXCLDDP=ADDR(MVDDNAME);         /*                       @YD00175*/ 04379000
         LA    @14,MVDDNAME                                        1012 04380000
         ST    @14,EXCLDDP(,@15)                                   1012 04381000
*   EXCLVOL=VOLARG;                 /*                       @YD00175*/ 04382000
         L     @14,@PC00016                                        1013 04383000
         MVC   EXCLVOL(6,@15),VOLARG(@14)                          1013 04384000
*   CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*                 @YD00175*/ 04385000
         ST    @02,@AL00001                                        1014 04386000
         LA    @14,SELECTX                                         1014 04387000
         ST    @14,@AL00001+4                                      1014 04388000
         ST    @15,@AL00001+8                                      1014 04389000
         MVI   @AL00001+8,X'80'                                    1014 04390000
         L     @15,GDTUNT(,@02)                                    1014 04391000
         LA    @01,@AL00001                                        1014 04392000
         BALR  @14,@15                                             1014 04393000
*   RESPECIFY                                                      1015 04394000
*     RTNREG RSTD;                                                 1015 04395000
*   TESTRC=RTNREG;                                                 1016 04396000
         LR    TESTRC,RTNREG                                       1016 04397000
*   RESPECIFY                                                      1017 04398000
*     RTNREG UNRSTD;                /*                       @YD00175*/ 04399000
*                                                                  1017 04400000
*   /*****************************************************************/ 04401000
*   /*                                                               */ 04402000
*   /* IF THE SELECTX FAILED, TERMINATE THE RUN              @YD00175*/ 04403000
*   /*                                                               */ 04404000
*   /*****************************************************************/ 04405000
*                                                                  1018 04406000
*   IF TESTRC>0 THEN                                               1018 04407000
         LTR   TESTRC,TESTRC                                       1018 04408000
         BNP   @RF01018                                            1018 04409000
*     LASTCOND=TERMCODE;            /*                       @YD00175*/ 04410000
         L     @02,@PC00001+8                                      1019 04411000
         MVC   LASTCOND(2,@02),@CH00038                            1019 04412000
*   ELSE                                                           1020 04413000
*     DO;                           /*                       @YD00175*/ 04414000
*                                                                  1020 04415000
         B     @RC01018                                            1020 04416000
@RF01018 DS    0H                                                  1021 04417000
*       /*************************************************************/ 04418000
*       /*                                                           */ 04419000
*       /* IF WE HAVE NO UCB POINTER, DYNAMICALLY            @YD00175*/ 04420000
*       /* ALLOCATE THE UNIT AND VOLUME                      @YD00175*/ 04421000
*       /*                                                           */ 04422000
*       /*************************************************************/ 04423000
*                                                                  1021 04424000
*       IF MVUCBPTR=0 THEN                                         1021 04425000
         L     @02,MVUCBPTR                                        1021 04426000
         LTR   @02,@02                                             1021 04427000
         BNZ   @RF01021                                            1021 04428000
*         DO;                       /*                       @YD00175*/ 04429000
*                                                                  1022 04430000
*           /*********************************************************/ 04431000
*           /*                                                       */ 04432000
*           /* BUILD THE ALLOCATION ARGUMENT LIST            @Y30LB33*/ 04433000
*           /*                                                       */ 04434000
*           /*********************************************************/ 04435000
*                                                                  1023 04436000
*           ALLAGL=ALLAGL&&ALLAGL;  /*                       @Y30LB33*/ 04437000
         LA    @02,MVALLAGL                                        1023 04438000
         XC    ALLAGL(31,@02),ALLAGL(@02)                          1023 04439000
*           MVALLUNO=1;             /*                       @Y30LB33*/ 04440000
         LA    @02,1                                               1024 04441000
         STH   @02,MVALLUNO                                        1024 04442000
*           MVALLULN=LENGTH(MVUNIT);/*                       @Y30LB33*/ 04443000
         MVC   MVALLULN(2),@CH00297                                1025 04444000
*           MVALLUNT=MVUNIT;        /*                       @Y30LB33*/ 04445000
         MVI   MVALLUNT+5,C' '                                     1026 04446000
         MVC   MVALLUNT+6(2),MVALLUNT+5                            1026 04447000
         MVC   MVALLUNT(5),@CC01570                                1026 04448000
*           ALLULP=ADDR(MVALLUNO);  /*                       @Y30LB33*/ 04449000
         LA    @15,MVALLAGL                                        1027 04450000
         LA    @14,MVALLUNO                                        1027 04451000
         ST    @14,ALLULP(,@15)                                    1027 04452000
*           MVALLVNO=1;             /*                       @Y30LB33*/ 04453000
         STH   @02,MVALLVNO                                        1028 04454000
*           MVALLVLN=LENGTH(VOLARG);/*                       @Y30LB33*/ 04455000
         MVC   MVALLVLN(2),@CH00159                                1029 04456000
*           MVALLVOL=VOLARG;        /*                       @Y30LB33*/ 04457000
         L     @02,@PC00016                                        1030 04458000
         MVC   MVALLVOL(6),VOLARG(@02)                             1030 04459000
*           ALLVLP=ADDR(MVALLVNO);  /*                       @Y30LB33*/ 04460000
         LA    @02,MVALLVNO                                        1031 04461000
         ST    @02,ALLVLP(,@15)                                    1031 04462000
*           ALLOPTVL=ON;            /*                       @Y30LB33*/ 04463000
         OI    ALLOPTVL(@15),B'10000000'                           1032 04464000
*           ALLVLCNT=1;             /*                       @YD00175*/ 04465000
         MVI   ALLVLCNT(@15),X'01'                                 1033 04466000
*           ALLUNCNT=1;             /*                       @Y30LB33*/ 04467000
         MVI   ALLUNCNT(@15),X'01'                                 1034 04468000
*           ALLOPTPV=ON;            /*                       @Y30LB33*/ 04469000
         OI    ALLOPTPV(@15),B'00100000'                           1035 04470000
*                                                                  1036 04471000
*           /*********************************************************/ 04472000
*           /*                                                       */ 04473000
*           /* ISSUE UALLOC TO ALLOCATE AND MOUNT            @Y30LB33*/ 04474000
*           /* THE VOLUME PRIOR TO RE-LABELLING              @Y30LB33*/ 04475000
*           /*                                                       */ 04476000
*           /*********************************************************/ 04477000
*                                                                  1036 04478000
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Y30LB33*/ 04479000
         L     @02,@PC00001                                        1036 04480000
         ST    @02,@AL00001                                        1036 04481000
         ST    @15,@AL00001+4                                      1036 04482000
         MVI   @AL00001+4,X'80'                                    1036 04483000
         L     @15,GDTALC(,@02)                                    1036 04484000
         LA    @01,@AL00001                                        1036 04485000
         BALR  @14,@15                                             1036 04486000
*           RESPECIFY                                              1037 04487000
*             RTNREG RSTD;                                         1037 04488000
*           TESTRC=RTNREG;                                         1038 04489000
         LR    TESTRC,RTNREG                                       1038 04490000
*           RESPECIFY                                              1039 04491000
*             RTNREG UNRSTD;        /*                       @Y30LB33*/ 04492000
*                                                                  1039 04493000
*           /*********************************************************/ 04494000
*           /*                                                       */ 04495000
*           /* IF ALLOCATE FAILS, SET THE LASTCOND TO        @Y30LB33*/ 04496000
*           /* TERMINATE THE RUN                             @Y30LB33*/ 04497000
*           /*                                                       */ 04498000
*           /*********************************************************/ 04499000
*                                                                  1040 04500000
*           IF TESTRC=4 THEN                                       1040 04501000
         C     TESTRC,@CF00043                                     1040 04502000
         BNE   @RF01040                                            1040 04503000
*             LASTCOND=TERMCODE;    /*                       @Y30LB33*/ 04504000
*                                                                  1041 04505000
         L     @02,@PC00001+8                                      1041 04506000
         MVC   LASTCOND(2,@02),@CH00038                            1041 04507000
*           /*********************************************************/ 04508000
*           /*                                                       */ 04509000
*           /* IF ALLOCATE RUNS OK, TURN ON THE              @Y30LB33*/ 04510000
*           /* MOUNT SWITCH                                  @YD00175*/ 04511000
*           /*                                                       */ 04512000
*           /*********************************************************/ 04513000
*                                                                  1042 04514000
*           ELSE                                                   1042 04515000
*             DO;                   /*                       @Y30LB33*/ 04516000
         B     @RC01040                                            1042 04517000
@RF01040 DS    0H                                                  1043 04518000
*               MNTSW=ON;           /*                       @YD00175*/ 04519000
         OI    MNTSW,B'00100000'                                   1043 04520000
*               MVDDNAME=ALLDDN;    /*                       @Y30LB33*/ 04521000
*                                                                  1044 04522000
         LA    @02,MVALLAGL                                        1044 04523000
         MVC   MVDDNAME(8),ALLDDN(@02)                             1044 04524000
*               /*****************************************************/ 04525000
*               /*                                                   */ 04526000
*               /* SET UP CHANGEX ARGUMENT LIST              @YD00175*/ 04527000
*               /*                                                   */ 04528000
*               /*****************************************************/ 04529000
*                                                                  1045 04530000
*               EXCLAGL=EXCLAGL&&EXCLAGL;/*                  @YD00175*/ 04531000
         LA    @02,MVEXAGL                                         1045 04532000
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        1045 04533000
*               EXCLUCBP=ADDR(MVUCBPTR);/*                   @YD00175*/ 04534000
         LA    @15,MVUCBPTR                                        1046 04535000
         ST    @15,EXCLUCBP(,@02)                                  1046 04536000
*               EXCLDDP=ADDR(MVDDNAME);/*                    @YD00175*/ 04537000
         LA    @15,MVDDNAME                                        1047 04538000
         ST    @15,EXCLDDP(,@02)                                   1047 04539000
*               EXCLVOL=VOLARG;     /*                       @YD00175*/ 04540000
*                                                                  1048 04541000
         L     @15,@PC00016                                        1048 04542000
         MVC   EXCLVOL(6,@02),VOLARG(@15)                          1048 04543000
*               /*****************************************************/ 04544000
*               /*                                                   */ 04545000
*               /* ISSUE UMSSUNIT TO CHANGE THE UNIT         @YD00175*/ 04546000
*               /* TO EXCLUSIVE CONTROL                      @YD00175*/ 04547000
*               /*                                                   */ 04548000
*               /*****************************************************/ 04549000
*                                                                  1049 04550000
*               CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*     @YD00175*/ 04551000
         L     @15,@PC00001                                        1049 04552000
         ST    @15,@AL00001                                        1049 04553000
         LA    @14,CHANGEX                                         1049 04554000
         ST    @14,@AL00001+4                                      1049 04555000
         ST    @02,@AL00001+8                                      1049 04556000
         MVI   @AL00001+8,X'80'                                    1049 04557000
         L     @15,GDTUNT(,@15)                                    1049 04558000
         LA    @01,@AL00001                                        1049 04559000
         BALR  @14,@15                                             1049 04560000
*               RESPECIFY                                          1050 04561000
*                 RTNREG RSTD;                                     1050 04562000
*               TESTRC=RTNREG;                                     1051 04563000
         LR    TESTRC,RTNREG                                       1051 04564000
*               RESPECIFY                                          1052 04565000
*                 RTNREG UNRSTD;    /*                       @Y30LB33*/ 04566000
*                                                                  1052 04567000
*               /*****************************************************/ 04568000
*               /*                                                   */ 04569000
*               /* TEST THE RETURN CODE. IF AN               @YD00175*/ 04570000
*               /* ERROR WAS FOUND, WE MUST BACKOUT          @Y30LB33*/ 04571000
*               /* THE CHANGES MADE. SET THE CONDITION CODE  @Y30LB33*/ 04572000
*               /* TO TERMINATE                              @YD00175*/ 04573000
*               /*                                                   */ 04574000
*               /*****************************************************/ 04575000
*                                                                  1053 04576000
*               IF TESTRC>0 THEN    /*                       @YD00175*/ 04577000
         LTR   TESTRC,TESTRC                                       1053 04578000
         BNP   @RF01053                                            1053 04579000
*                 LASTCOND=TERMCODE;/*                       @Y30LB33*/ 04580000
         L     @02,@PC00001+8                                      1054 04581000
         MVC   LASTCOND(2,@02),@CH00038                            1054 04582000
*             END;                  /*                       @Y30LB33*/ 04583000
@RF01053 DS    0H                                                  1056 04584000
*         END;                      /*                       @YD00175*/ 04585000
@RC01040 DS    0H                                                  1057 04586000
*     END;                          /*                       @Y30LB33*/ 04587000
*                                                                  1057 04588000
@RF01021 DS    0H                                                  1058 04589000
*   /*****************************************************************/ 04590000
*   /*                                                               */ 04591000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 04592000
*   /*                                                               */ 04593000
*   /*****************************************************************/ 04594000
*                                                                  1058 04595000
*   REG14=ALLOVSV;                  /*                       @Y30LB33*/ 04596000
@RC01018 LR    REG14,ALLOVSV                                       1058 04597000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 04598000
         SLR   @15,@15                                             1059 04599000
@EL00016 DS    0H                                                  1059 04600000
@EF00016 DS    0H                                                  1059 04601000
@ER00016 BR    @14                                                 1059 04602000
*   END ALLOVOL;                    /*                       @Y30LB33*/ 04603000
*                                                                  1061 04604000
*/********************************************************   @Y30LB33*/ 04605000
*/* PROCEDURE NAME - MNTVOL                                  @Y30LB33*/ 04606000
*/*                                                          @Y30LB33*/ 04607000
*/* FUNCTION - TO MOUNT THE VOLUME PRIOR TO BEING            @Y30LB33*/ 04608000
*/*      RELABELED. IF MOUNT FAILS, BACK OUT THE CHANGES     @Y30LB33*/ 04609000
*/*                                                          @Y30LB33*/ 04610000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 04611000
*/*            BACKOUT                                       @Y30LB33*/ 04612000
*/*                                                          @Y30LB33*/ 04613000
*/* INPUT - THE FDTTBL AND THE VOLUME RECORD                 @Y30LB33*/ 04614000
*/*                                                          @Y30LB33*/ 04615000
*/* OUTPUT - MOUNT SWITCH ON IF MOUNT SUCCESSFUL             @YD00175*/ 04616000
*/********************************************************   @Y30LB33*/ 04617000
*                                                                  1061 04618000
*MNTVOL:                                                           1061 04619000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 04620000
*                                                                  1061 04621000
MNTVOL   DS    0H                                                  1062 04622000
*   /*****************************************************************/ 04623000
*   /*                                                               */ 04624000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 04625000
*   /*                                                               */ 04626000
*   /*****************************************************************/ 04627000
*                                                                  1062 04628000
*   DCL                                                            1062 04629000
*     MNTVOLSV PTR(31);             /*                       @Y30LB33*/ 04630000
*   MNTVOLSV=REG14;                 /*                       @Y30LB33*/ 04631000
         LR    MNTVOLSV,REG14                                      1063 04632000
*   OLDERID2=NEWERID2;                                             1064 04633000
         L     @15,@PC00001                                        1064 04634000
         L     @15,GDTTR2(,@15)                                    1064 04635000
         MVC   @TS00001(95),NEWERID2(@15)                          1064 04636000
         MVC   OLDERID2(95,@15),@TS00001                           1064 04637000
*   NEWID2='MVPA';                  /*                       @Y30LB33*/ 04638000
*                                                                  1065 04639000
         MVC   NEWID2(4,@15),@CC01752                              1065 04640000
*   /*****************************************************************/ 04641000
*   /*                                                               */ 04642000
*   /* CREATE THE MOUNT ARGUMENT LIST                        @Y30LB33*/ 04643000
*   /*                                                               */ 04644000
*   /*****************************************************************/ 04645000
*                                                                  1066 04646000
*   MDAGL=MDAGL&&MDAGL;             /*                       @Y30LB33*/ 04647000
         LA    @15,MVMDAGL                                         1066 04648000
         XC    MDAGL(37,@15),MDAGL(@15)                            1066 04649000
*   MDDDNAME=MVDDNAME;              /*                       @Y30LB33*/ 04650000
         MVC   MDDDNAME(8,@15),MVDDNAME                            1067 04651000
*   MDUCBPTR=ADDR(MVUCBPTR);        /*                       @Y30LB33*/ 04652000
         LA    @14,MVUCBPTR                                        1068 04653000
         ST    @14,MDUCBPTR(,@15)                                  1068 04654000
*   MDLABEL=MVVOLUME;               /*                       @Y30LB33*/ 04655000
*                                                                  1069 04656000
         MVC   MDLABEL(6,@15),MVVOLUME                             1069 04657000
*   /*****************************************************************/ 04658000
*   /*                                                               */ 04659000
*   /* CHECK FOR REBUILD THE LABEL. IF SO, THE LABEL         @ZDR2057*/ 04660000
*   /* CAN BE UNREADABLE. THEREFORE THE VTOC SHOULD          @ZDR2057*/ 04661000
*   /* NOT BE READ AND IS SUPPLIED BY THE USER.              @ZDR2057*/ 04662000
*   /*                                                               */ 04663000
*   /*****************************************************************/ 04664000
*                                                                  1070 04665000
*   IF ADDR(RLBL)^=NULLPTR THEN                                    1070 04666000
         L     @14,@PC00001+4                                      1070 04667000
         L     @14,FDTPTR+100(,@14)                                1070 04668000
         LTR   @14,@14                                             1070 04669000
         BZ    @RF01070                                            1070 04670000
*     DO;                           /*                       @ZDR2057*/ 04671000
*       MDVTOCTR=ON;                /*                       @ZDR2057*/ 04672000
*       MDNEWVOL=ON;                /*                       @ZDR2057*/ 04673000
         OI    MDVTOCTR(@15),B'10000001'                           1073 04674000
*       MDVTOC=TEMPVAL;             /*                       @ZDR2057*/ 04675000
         MVC   MDVTOC(5,@15),TEMPVAL                               1074 04676000
*     END;                          /*                       @ZDR2057*/ 04677000
*                                                                  1075 04678000
*   /*****************************************************************/ 04679000
*   /*                                                               */ 04680000
*   /* ISSUE UMSSUNIT TO MOUNT THE VOLUME PRIOR              #Y30LB33*/ 04681000
*   /* TO RE-LABELLING                                       @Y30LB33*/ 04682000
*   /*                                                               */ 04683000
*   /*****************************************************************/ 04684000
*                                                                  1076 04685000
*   CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                     @Y30LB33*/ 04686000
@RF01070 L     @02,@PC00001                                        1076 04687000
         ST    @02,@AL00001                                        1076 04688000
         LA    @15,MOUNT                                           1076 04689000
         ST    @15,@AL00001+4                                      1076 04690000
         LA    @15,MVMDAGL                                         1076 04691000
         ST    @15,@AL00001+8                                      1076 04692000
         MVI   @AL00001+8,X'80'                                    1076 04693000
         L     @15,GDTUNT(,@02)                                    1076 04694000
         LA    @01,@AL00001                                        1076 04695000
         BALR  @14,@15                                             1076 04696000
*   RESPECIFY                                                      1077 04697000
*     RTNREG RSTD;                                                 1077 04698000
*   TESTRC=RTNREG;                                                 1078 04699000
         LR    TESTRC,RTNREG                                       1078 04700000
*   RESPECIFY                                                      1079 04701000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 04702000
*                                                                  1080 04703000
*   /*****************************************************************/ 04704000
*   /*                                                               */ 04705000
*   /* IF MOUNT GOOD, TURN ON MOUNT SWITCH                   @YD00175*/ 04706000
*   /*                                                               */ 04707000
*   /*****************************************************************/ 04708000
*                                                                  1080 04709000
*   IF TESTRC=0 THEN                                               1080 04710000
         LTR   TESTRC,TESTRC                                       1080 04711000
         BNZ   @RF01080                                            1080 04712000
*     MNTSW=ON;                     /*                       @YD00175*/ 04713000
*                                                                  1081 04714000
         OI    MNTSW,B'00100000'                                   1081 04715000
*   /*****************************************************************/ 04716000
*   /*                                                               */ 04717000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 04718000
*   /*                                                               */ 04719000
*   /*****************************************************************/ 04720000
*                                                                  1082 04721000
*   REG14=MNTVOLSV;                 /*                       @Y30LB33*/ 04722000
@RF01080 LR    REG14,MNTVOLSV                                      1082 04723000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 04724000
         SLR   @15,@15                                             1083 04725000
@EL00017 DS    0H                                                  1083 04726000
@EF00017 DS    0H                                                  1083 04727000
@ER00017 BR    @14                                                 1083 04728000
*   END MNTVOL;                     /*                       @Y30LB33*/ 04729000
*                                                                  1085 04730000
*/********************************************************   @Y30LB33*/ 04731000
*/* PROCEDURE NAME - NEWLABL                                 @Y30LB33*/ 04732000
*/*                                                          @Y30LB33*/ 04733000
*/* FUNCTION - TO WRITE A NEW SOFTWARE LABEL ON THE  VOLUME  @Y30LB33*/ 04734000
*/*      AND BACKOUT THE CHANGES IF IT FAILS                 @Y30LB33*/ 04735000
*/*                                                          @Y30LB33*/ 04736000
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/ 04737000
*/*            BACKOUT                                       @Y30LB33*/ 04738000
*/*                                                  @Y30LB33        */ 04739000
*/* INPUT - THE FDTTBL                               @Y30LB33        */ 04740000
*/*                                                  @Y30LB33        */ 04741000
*/* OUTPUT - LASTCOND IS SET TO 4 IF THE VTOC IS NOT         @Y30LB33*/ 04742000
*/*      CLOSED PROPERLY. IT IS SET TO 8 IF DEMOUNTING FAILS @Y30LB33*/ 04743000
*/*      AND SET TO 12 IF RELABELING FAILS                   @Y30LB33*/ 04744000
*/********************************************************   @Y30LB33*/ 04745000
*                                                                  1085 04746000
*NEWLABL:                                                          1085 04747000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 04748000
*                                                                  1085 04749000
NEWLABL  DS    0H                                                  1086 04750000
*   /*****************************************************************/ 04751000
*   /*                                                               */ 04752000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 04753000
*   /*                                                               */ 04754000
*   /*****************************************************************/ 04755000
*                                                                  1086 04756000
*   DCL                                                            1086 04757000
*     NEWLABSV PTR(31);             /*                       @Y30LB33*/ 04758000
*   NEWLABSV=REG14;                 /*                       @Y30LB33*/ 04759000
         ST    REG14,NEWLABSV                                      1087 04760000
*   OLDERID2=NEWERID2;                                             1088 04761000
         L     @07,@PC00001                                        1088 04762000
         L     @07,GDTTR2(,@07)                                    1088 04763000
         MVC   @TS00001(95),NEWERID2(@07)                          1088 04764000
         MVC   OLDERID2(95,@07),@TS00001                           1088 04765000
*   NEWID2='MVQA';                  /*                       @Y30LB33*/ 04766000
*                                                                  1089 04767000
         MVC   NEWID2(4,@07),@CC01757                              1089 04768000
*   /*****************************************************************/ 04769000
*   /*                                                               */ 04770000
*   /* BUILD THE RELABELING ARGUMENT LIST                    @Y30LB33*/ 04771000
*   /*                                                               */ 04772000
*   /*****************************************************************/ 04773000
*                                                                  1090 04774000
*   VS2AGL=VS2AGL&&VS2AGL;          /*                       @Y30LB33*/ 04775000
         LA    @07,MVVS2AGL                                        1090 04776000
         XC    VS2AGL(52,@07),VS2AGL(@07)                          1090 04777000
*   VSDDNAME=MVDDNAME;              /*                       @Y30LB33*/ 04778000
         MVC   VSDDNAME(8,@07),MVDDNAME                            1091 04779000
*   IF ADDR(NOWN)>0 THEN                                           1092 04780000
         L     @15,@PC00001+4                                      1092 04781000
         L     @15,FDTPTR+72(,@15)                                 1092 04782000
         LTR   @15,@15                                             1092 04783000
         BNP   @RF01092                                            1092 04784000
*     DO;                           /*                       @Y30LB33*/ 04785000
*       VSOWNER=ON;                 /*                       @Y30LB33*/ 04786000
         OI    VSOWNER(@07),B'10000000'                            1094 04787000
*       VSOWNPTR=ADDR(MVBLANKS);    /*                       @Y30LB33*/ 04788000
         LA    @15,@CC01575                                        1095 04789000
         ST    @15,VSOWNPTR(,@07)                                  1095 04790000
*     END;                          /*                       @Y30LB33*/ 04791000
*   IF ADDR(OWNER)>0 THEN                                          1097 04792000
@RF01092 L     @07,@PC00001+4                                      1097 04793000
         L     @07,FDTPTR+8(,@07)                                  1097 04794000
         LTR   @07,@07                                             1097 04795000
         BNP   @RF01097                                            1097 04796000
*     DO;                           /*                       @Y30LB33*/ 04797000
*       VSOWNER=ON;                 /*                       @Y30LB33*/ 04798000
         LA    @15,MVVS2AGL                                        1099 04799000
         OI    VSOWNER(@15),B'10000000'                            1099 04800000
*       VSOWNPTR=ADDR(OWNERVAL);    /*                       @Y30LB33*/ 04801000
         LA    @07,OWNERVAL(,@07)                                  1100 04802000
         ST    @07,VSOWNPTR(,@15)                                  1100 04803000
*     END;                          /*                       @Y30LB33*/ 04804000
*   IF ADDR(NEWSR)>0 THEN                                          1102 04805000
@RF01097 L     @07,@PC00001+4                                      1102 04806000
         L     @07,FDTPTR+4(,@07)                                  1102 04807000
         LTR   @07,@07                                             1102 04808000
         BNP   @RF01102                                            1102 04809000
*     DO;                           /*                       @Y30LB33*/ 04810000
*       VSVOLSER=ON;                /*                       @Y30LB33*/ 04811000
         LA    @15,MVVS2AGL                                        1104 04812000
         OI    VSVOLSER(@15),B'01000000'                           1104 04813000
*       VSVOLPTR=ADDR(NEWSRVAL);    /*                       @Y30LB33*/ 04814000
         LA    @07,NEWSRVAL(,@07)                                  1105 04815000
         ST    @07,VSVOLPTR(,@15)                                  1105 04816000
*     END;                          /*                       @Y30LB33*/ 04817000
*                                                                  1106 04818000
*   /*****************************************************************/ 04819000
*   /*                                                               */ 04820000
*   /* CHECK FOR REBUILD OF A VOLUME LABEL                   @ZDR2057*/ 04821000
*   /*                                                               */ 04822000
*   /*****************************************************************/ 04823000
*                                                                  1107 04824000
*   IF ADDR(VADDR)^=NULLPTR THEN                                   1107 04825000
@RF01102 L     @07,@PC00001+4                                      1107 04826000
         L     @15,FDTPTR+104(,@07)                                1107 04827000
         LTR   @15,@15                                             1107 04828000
         BZ    @RF01107                                            1107 04829000
*     DO;                           /*                       @ZDR2057*/ 04830000
*       VSNOVTOC=ON;                /*                       @ZDR2057*/ 04831000
         LA    @15,MVVS2AGL                                        1109 04832000
         OI    VSNOVTOC(@15),B'00100000'                           1109 04833000
*       VSVTOCPT=ADDR(TEMPVAL);     /*                       @ZDR2057*/ 04834000
         LA    @14,TEMPVAL                                         1110 04835000
         ST    @14,VSVTOCPT(,@15)                                  1110 04836000
*       VSVOLPTR=ADDR(VOLVAL);      /*                       @ZDR2057*/ 04837000
         L     @07,FDTPTR(,@07)                                    1111 04838000
         LA    @07,VOLVAL(,@07)                                    1111 04839000
         ST    @07,VSVOLPTR(,@15)                                  1111 04840000
*       VSOWNPTR=ADDR(BASOWNER);    /*                       @ZDR2057*/ 04841000
         LA    @07,BASOWNER(,BASEVPTR)                             1112 04842000
         ST    @07,VSOWNPTR(,@15)                                  1112 04843000
*       VSIOBKPT=ADDR(IOCTLBKP);    /*                       @ZDR2057*/ 04844000
         LA    @07,IOCTLBKP                                        1113 04845000
         ST    @07,VSIOBKPT(,@15)                                  1113 04846000
*     END;                          /*                       @ZDR2057*/ 04847000
*   VSVOLUME=MVVOLUME;              /*                       @Y30LB33*/ 04848000
@RF01107 LA    @07,MVVS2AGL                                        1115 04849000
         MVC   VSVOLUME(6,@07),MVVOLUME                            1115 04850000
*   VS2RES=ON;                      /*                       @Y30LB33*/ 04851000
         OI    VS2RES(@07),B'10000000'                             1116 04852000
*   VSUCBPTR=ADDR(MVUCBPTR);        /*                       @Y30LB33*/ 04853000
         LA    @15,MVUCBPTR                                        1117 04854000
         ST    @15,VSUCBPTR(,@07)                                  1117 04855000
*                                                                  1118 04856000
*   /*****************************************************************/ 04857000
*   /*                                                               */ 04858000
*   /* CALL VOLUME SERVICES TO REBUILD THE VOLUME LABEL      @ZDR2057*/ 04859000
*   /*                                                               */ 04860000
*   /*****************************************************************/ 04861000
*                                                                  1118 04862000
*   IF ADDR(RLBL)^=NULLPTR THEN                                    1118 04863000
         L     @15,@PC00001+4                                      1118 04864000
         L     @15,FDTPTR+100(,@15)                                1118 04865000
         LTR   @15,@15                                             1118 04866000
         BZ    @RF01118                                            1118 04867000
*     CALL IDCSACL0(GDTTBL,'IDCVS02 ',INITVOL,VS2AGL);/*     @ZDR2057*/ 04868000
         L     @15,@PC00001                                        1119 04869000
         ST    @15,@AL00001                                        1119 04870000
         LA    @14,@CC01758                                        1119 04871000
         ST    @14,@AL00001+4                                      1119 04872000
         LA    @14,INITVOL                                         1119 04873000
         ST    @14,@AL00001+8                                      1119 04874000
         ST    @07,@AL00001+12                                     1119 04875000
         MVI   @AL00001+12,X'80'                                   1119 04876000
         L     @15,GDTCAL(,@15)                                    1119 04877000
         LA    @01,@AL00001                                        1119 04878000
         BALR  @14,@15                                             1119 04879000
*   ELSE                                                           1120 04880000
*                                                                  1120 04881000
*     /***************************************************************/ 04882000
*     /*                                                             */ 04883000
*     /* CALL VOLUME SERVICES TO CHANGE THE                  @Y30LB33*/ 04884000
*     /* VOLUME LABEL. INDICATE THE VOLUME                   @YD00175*/ 04885000
*     /* IS MOUNTED.                                         @YD00175*/ 04886000
*     /*                                                             */ 04887000
*     /***************************************************************/ 04888000
*                                                                  1120 04889000
*     CALL IDCSACL0(GDTTBL,'IDCVS02 ',PUTLABEL,VS2AGL);/*    @Y30LB33*/ 04890000
         B     @RC01118                                            1120 04891000
@RF01118 L     @07,@PC00001                                        1120 04892000
         ST    @07,@AL00001                                        1120 04893000
         LA    @15,@CC01758                                        1120 04894000
         ST    @15,@AL00001+4                                      1120 04895000
         LA    @15,PUTLABEL                                        1120 04896000
         ST    @15,@AL00001+8                                      1120 04897000
         LA    @15,MVVS2AGL                                        1120 04898000
         ST    @15,@AL00001+12                                     1120 04899000
         MVI   @AL00001+12,X'80'                                   1120 04900000
         L     @15,GDTCAL(,@07)                                    1120 04901000
         LA    @01,@AL00001                                        1120 04902000
         BALR  @14,@15                                             1120 04903000
*   RESPECIFY                                                      1121 04904000
*     RTNREG RSTD;                                                 1121 04905000
@RC01118 DS    0H                                                  1122 04906000
*   TESTRC=RTNREG;                                                 1122 04907000
         LR    TESTRC,RTNREG                                       1122 04908000
*   RESPECIFY                                                      1123 04909000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 04910000
*   MNTSW=ON;                       /*                       @YD00175*/ 04911000
         OI    MNTSW,B'00100000'                                   1124 04912000
*                                                                  1125 04913000
*   /*****************************************************************/ 04914000
*   /*                                                               */ 04915000
*   /* IF LABELING FAILS, SET TERMINATING CODE,              @Y30LB33*/ 04916000
*   /* DEQUEUE ON THE RESERVE DONE BY VOLUME                 @Y30LB33*/ 04917000
*   /* SERVICES AND BACKOUT CHANGES                          @YD00175*/ 04918000
*   /*                                                               */ 04919000
*   /*****************************************************************/ 04920000
*                                                                  1125 04921000
*   IF TESTRC=4 THEN                                               1125 04922000
         C     TESTRC,@CF00043                                     1125 04923000
         BNE   @RF01125                                            1125 04924000
*     DO;                           /*                       @Y30LB33*/ 04925000
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/ 04926000
         L     @07,@PC00001+8                                      1127 04927000
         MVC   LASTCOND(2,@07),@CH00038                            1127 04928000
*       MINAMLN=LENGTH(MVMINNAM)-1; /*                       @Y30LB33*/ 04929000
         MVI   MINAMLN,X'16'                                       1128 04930000
*       MINAMVOL=MVVOLUME;          /*                       @Y30LB33*/ 04931000
         MVC   MINAMVOL(6),MVVOLUME                                1129 04932000
*       MINAMQL=MINQLR;             /*                       @Y30LB33*/ 04933000
*                                                                  1130 04934000
         MVC   MINAMQL(16),@CC01589                                1130 04935000
*       /*************************************************************/ 04936000
*       /*                                                           */ 04937000
*       /* ISSUE THE DEQUEUE ON THE RESERVE                  @Y30LB33*/ 04938000
*       /*                                                           */ 04939000
*       /*************************************************************/ 04940000
*                                                                  1131 04941000
*       CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*           @Y30LB33*/ 04942000
         L     @07,@PC00001                                        1131 04943000
         ST    @07,@AL00001                                        1131 04944000
         LA    @02,MVMAJNAM                                        1131 04945000
         ST    @02,@AL00001+4                                      1131 04946000
         LA    @02,MVMINNAM                                        1131 04947000
         ST    @02,@AL00001+8                                      1131 04948000
         MVI   @AL00001+8,X'80'                                    1131 04949000
         L     @15,GDTDEQ(,@07)                                    1131 04950000
         LA    @01,@AL00001                                        1131 04951000
         BALR  @14,@15                                             1131 04952000
*       CALL BACKOUT;               /*                       @YD00175*/ 04953000
         BAL   @14,BACKOUT                                         1132 04954000
*     END;                          /*                       @Y30LB33*/ 04955000
*                                                                  1134 04956000
*   /*****************************************************************/ 04957000
*   /*                                                               */ 04958000
*   /* IF LABEL WAS CHANGED BUT THE VTOC FAILED              @Y30LB33*/ 04959000
*   /* TO CLOSE, SET LASTCOND TO 4                           @Y30LB33*/ 04960000
*   /*                                                               */ 04961000
*   /*****************************************************************/ 04962000
*                                                                  1134 04963000
*   ELSE                                                           1134 04964000
*     DO;                           /*                       @Y30LB33*/ 04965000
         B     @RC01125                                            1134 04966000
@RF01125 DS    0H                                                  1135 04967000
*       IF TESTRC=8 THEN            /*                       @Y30LB33*/ 04968000
         C     TESTRC,@CF00035                                     1135 04969000
         BNE   @RF01135                                            1135 04970000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB33*/ 04971000
         L     @07,@PC00001+8                                      1136 04972000
         LH    @04,LASTCOND(,@07)                                  1136 04973000
         LA    @15,4                                               1136 04974000
         CR    @04,@15                                             1136 04975000
         BNL   *+6                                                      04976000
         LR    @04,@15                                             1136 04977000
         STH   @04,LASTCOND(,@07)                                  1136 04978000
*     END;                          /*                       @Y30LB33*/ 04979000
*                                                                  1137 04980000
@RF01135 DS    0H                                                  1138 04981000
*   /*****************************************************************/ 04982000
*   /*                                                               */ 04983000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 04984000
*   /*                                                               */ 04985000
*   /*****************************************************************/ 04986000
*                                                                  1138 04987000
*   REG14=NEWLABSV;                 /*                       @Y30LB33*/ 04988000
@RC01125 L     REG14,NEWLABSV                                      1138 04989000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 04990000
         SLR   @15,@15                                             1139 04991000
@EL00018 DS    0H                                                  1139 04992000
@EF00018 DS    0H                                                  1139 04993000
@ER00018 BR    @14                                                 1139 04994000
*   END NEWLABL;                    /*                       @Y30LB33*/ 04995000
*                                                                  1141 04996000
*/********************************************************   @Y30LB33*/ 04997000
*/* PROCEDURE NAME - DMNTVOL                                 @Y30LB33*/ 04998000
*/*                                                          @Y30LB33*/ 04999000
*/* FUNCTION - TO PRINT THE MESSAGE INDICATING THAT THE      @Y30LB33*/ 05000000
*/*      VOLUME LABEL WAS CHANGED, TO DEQUEUE                @Y30LB33*/ 05001000
*/*      ON THE RESERVE DONE IN NEWLABL BY VOLUME SERVICES,  @Y30LB33*/ 05002000
*/*      AND TO SET THE READONLY FLAG ON IF REQUESTED AND    @Y30LB33*/ 05003000
*/*      SET THE MISMATCH OFF AND DEMOUNT THE VOLUME WHEN    @Y30LB33*/ 05004000
*/*      FLAGS MUST BE CHANGED.                              @Y30LB33*/ 05005000
*/*                                                          @Y30LB33*/ 05006000
*/*      MESSAGE IDC0086I IS ISSUED WHEN THE VOLUME LABEL    @Y30LB33*/ 05007000
*/*      WAS CHANGED                                         @Y30LB33*/ 05008000
*/*                                                          @Y30LB33*/ 05009000
*/*      MESSAGE IDC2091I OR IDC2093I IS ISSUED WHEN THE     @Y30LB33*/ 05010000
*/*      DEFINE VOLUME COMMAND FAILS TO SET READONLY OR      @Y30LB33*/ 05011000
*/*      TURN OFF THE MISMATCH, OR IF THE VOLUME FAILS       @Y30LB33*/ 05012000
*/*      TO DEMOUNT                                          @Y30LB33*/ 05013000
*/*                                                          @Y30LB33*/ 05014000
*/*      MESSAGE IDC3073I IS ISSUED IF THE READONLY FLAG IS  @Y30LB33*/ 05015000
*/*      CHANGED TO AGREE WITH THE GROUP                     @Y30LB33*/ 05016000
*/*                                                          @Y30LB33*/ 05017000
*/* INPUT - THE FDTTBL, SWCHBITS                             @Y30LB33*/ 05018000
*/*                                                          @Y30LB33*/ 05019000
*/* OUTPUT - LASTCOND IS 4 IF AN I/O ERROR OCCURRED IN THE   @Y30LB33*/ 05020000
*/*      INVENTORY AND 8 IF READONLY FAILED TO BE SET        @Y30LB33*/ 05021000
*/*                                                          @Y30LB33*/ 05022000
*/*      TRYMIS SWITCH IS TURNED ON IF THE LABEL MISMATCH    @Y30LB33*/ 05023000
*/*      FLAG FAILED TO BE TURNED OFF                        @Y30LB33*/ 05024000
*/********************************************************   @Y30LB33*/ 05025000
*                                                                  1141 05026000
*DMNTVOL:                                                          1141 05027000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 05028000
*                                                                  1141 05029000
DMNTVOL  DS    0H                                                  1142 05030000
*   /*****************************************************************/ 05031000
*   /*                                                               */ 05032000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 05033000
*   /*                                                               */ 05034000
*   /*****************************************************************/ 05035000
*                                                                  1142 05036000
*   DCL                                                            1142 05037000
*     DMNTVSV PTR(31);              /*                       @Y30LB33*/ 05038000
*   DMNTVSV=REG14;                  /*                       @Y30LB33*/ 05039000
         LR    DMNTVSV,REG14                                       1143 05040000
*   OLDERID2=NEWERID2;                                             1144 05041000
         L     @07,@PC00001                                        1144 05042000
         L     @07,GDTTR2(,@07)                                    1144 05043000
         MVC   @TS00001(95),NEWERID2(@07)                          1144 05044000
         MVC   OLDERID2(95,@07),@TS00001                           1144 05045000
*   NEWID2='MVRA';                  /*                       @YM02887*/ 05046000
*                                                                  1145 05047000
         MVC   NEWID2(4,@07),@CC01763                              1145 05048000
*   /*****************************************************************/ 05049000
*   /*                                                               */ 05050000
*   /* PRINT MESSAGE IDC0086I, DEQUEUE ON THE                @Y30LB33*/ 05051000
*   /* RESERVE DONE BY VOLUME SERVICES, AND DEMOUNT          @Y30LB33*/ 05052000
*   /* VOLUME. DEMOUNTING IS DONE ONLY IF                    @Y30LB33*/ 05053000
*   /* WE MUST ISSUE ANOTHER COMMAND TO CHANGE               @Y30LB33*/ 05054000
*   /* THE READONLY ATTRIBUTE AND THE MISMATCH               @Y30LB33*/ 05055000
*   /* FLAG                                                  @Y30LB33*/ 05056000
*   /*                                                               */ 05057000
*   /*****************************************************************/ 05058000
*                                                                  1146 05059000
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/ 05060000
         L     @07,DDSTRU                                          1146 05061000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1146 05062000
*   DARGSMOD=MODCMN;                /*                       @Y30LB33*/ 05063000
*                                                                  1147 05064000
         MVC   DARGSMOD(3,@07),MODCMN                              1147 05065000
*   /*****************************************************************/ 05066000
*   /*                                                               */ 05067000
*   /* TELL THE USER THAT THE LABEL WAS CHANGED              @Y30LB33*/ 05068000
*   /* BY PRINTING IDC0086I. SET UP TO INDICATE THAT         @Y30LB33*/ 05069000
*   /* ONLY THE OWNER WAS CHANGED                            @Y30LB33*/ 05070000
*   /*                                                               */ 05071000
*   /*****************************************************************/ 05072000
*                                                                  1148 05073000
*   DARGSENT=MSG0086B;              /*                       @Y30LB33*/ 05074000
*                                                                  1148 05075000
         MVI   DARGSENT(@07),X'0D'                                 1148 05076000
*   /*****************************************************************/ 05077000
*   /*                                                               */ 05078000
*   /* IF THE SERIAL WAS CHANGED, SET UP TO INDICATE         @Y30LB33*/ 05079000
*   /* THAT EITHER ONLY THE SERIAL CHANGED OR BOTH           @Y30LB33*/ 05080000
*   /* OWNER AND SERIAL CHANGED                              @Y30LB33*/ 05081000
*   /*                                                               */ 05082000
*   /*****************************************************************/ 05083000
*                                                                  1149 05084000
*   IF ADDR(NEWSR)>NULLPTR THEN     /*                       @Y30LB33*/ 05085000
         SLR   @07,@07                                             1149 05086000
         L     @15,@PC00001+4                                      1149 05087000
         C     @07,FDTPTR+4(,@15)                                  1149 05088000
         BNL   @RF01149                                            1149 05089000
*     IF ADDR(OWNER)>NULLPTR|       /*                       @Y30LB33*/ 05090000
*         ADDR(NOWN)>NULLPTR THEN   /*                       @Y30LB33*/ 05091000
         C     @07,FDTPTR+8(,@15)                                  1150 05092000
         BL    @RT01150                                            1150 05093000
         C     @07,FDTPTR+72(,@15)                                 1150 05094000
         BNL   @RF01150                                            1150 05095000
@RT01150 DS    0H                                                  1151 05096000
*       DARGSENT=MSG0086C;          /*                       @Y30LB33*/ 05097000
         L     @07,DDSTRU                                          1151 05098000
         MVI   DARGSENT(@07),X'31'                                 1151 05099000
*     ELSE                                                         1152 05100000
*       DARGSENT=MSG0086A;          /*                       @Y30LB33*/ 05101000
*                                                                  1152 05102000
         B     @RC01150                                            1152 05103000
@RF01150 L     @07,DDSTRU                                          1152 05104000
         MVI   DARGSENT(@07),X'14'                                 1152 05105000
*   /*****************************************************************/ 05106000
*   /*                                                               */ 05107000
*   /* PRINT THE MESSAGE                                     @Y30LB33*/ 05108000
*   /*                                                               */ 05109000
*   /*****************************************************************/ 05110000
*                                                                  1153 05111000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/ 05112000
*                                                                  1153 05113000
@RC01150 DS    0H                                                  1153 05114000
@RF01149 L     @07,@PC00001                                        1153 05115000
         ST    @07,@AL00001                                        1153 05116000
         LA    @15,@CF00117                                        1153 05117000
         ST    @15,@AL00001+4                                      1153 05118000
         LA    @15,DDSTRU                                          1153 05119000
         ST    @15,@AL00001+8                                      1153 05120000
         MVI   @AL00001+8,X'80'                                    1153 05121000
         L     @15,GDTPRT(,@07)                                    1153 05122000
         LA    @01,@AL00001                                        1153 05123000
         BALR  @14,@15                                             1153 05124000
*   /*****************************************************************/ 05125000
*   /*                                                               */ 05126000
*   /* SET UP THE DEQUEUE PARAMETERS                         @Y30LB33*/ 05127000
*   /*                                                               */ 05128000
*   /*****************************************************************/ 05129000
*                                                                  1154 05130000
*   MINAMVOL=MVVOLUME;              /*                       @ZA05119*/ 05131000
         MVC   MINAMVOL(6),MVVOLUME                                1154 05132000
*   MINAMQL=MINQLR;                 /*                       @Y30LB33*/ 05133000
*                                                                  1155 05134000
         MVC   MINAMQL(16),@CC01589                                1155 05135000
*   /*****************************************************************/ 05136000
*   /*                                                               */ 05137000
*   /* ISSUE THE DEQUEUE ON THE RESERVE                      @Y30LB33*/ 05138000
*   /*                                                               */ 05139000
*   /*****************************************************************/ 05140000
*                                                                  1156 05141000
*   CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*               @Y30LB33*/ 05142000
         L     @07,@PC00001                                        1156 05143000
         ST    @07,@AL00001                                        1156 05144000
         LA    @15,MVMAJNAM                                        1156 05145000
         ST    @15,@AL00001+4                                      1156 05146000
         LA    @15,MVMINNAM                                        1156 05147000
         ST    @15,@AL00001+8                                      1156 05148000
         MVI   @AL00001+8,X'80'                                    1156 05149000
         L     @15,GDTDEQ(,@07)                                    1156 05150000
         LA    @01,@AL00001                                        1156 05151000
         BALR  @14,@15                                             1156 05152000
*                                                                  1157 05153000
*   /*****************************************************************/ 05154000
*   /*                                                               */ 05155000
*   /* WE MUST DEMOUNT THE VOLUME PRIOR TO                   @Y30LB33*/ 05156000
*   /* CHANGING ATTRIBUTES. THIS MUST BE                     @Y30LB33*/ 05157000
*   /* DONE NOW IN ORDER TO SET THE READONLY                 @Y30LB33*/ 05158000
*   /* FLAG. WE HAVE TO SET THE READONLY FLAG                @Y30LB33*/ 05159000
*   /* NOW IF READONLY WAS REQUESTED IN THE                  @Y30LB33*/ 05160000
*   /* FDTTBL OR READONLY IS TO BE COPIED                    @Y30LB33*/ 05161000
*   /* FROM THE GROUP                                        @Y30LB33*/ 05162000
*   /*                                                               */ 05163000
*   /*****************************************************************/ 05164000
*                                                                  1157 05165000
*   IF ADDR(RONLY)>0|(NEWGENSW=ON&  /*                       @Y30LB33*/ 05166000
*       GRORONLY=ON) THEN                                          1157 05167000
         L     @07,@PC00001+4                                      1157 05168000
         L     @07,FDTPTR+40(,@07)                                 1157 05169000
         LTR   @07,@07                                             1157 05170000
         BP    @RT01157                                            1157 05171000
         TM    NEWGENSW,B'00000100'                                1157 05172000
         BNO   @RF01157                                            1157 05173000
         TM    GRORONLY(GROUPPTR),B'00010000'                      1157 05174000
         BNO   @RF01157                                            1157 05175000
@RT01157 DS    0H                                                  1158 05176000
*     DO;                           /*                       @Y30LB33*/ 05177000
*                                                                  1158 05178000
*       /*************************************************************/ 05179000
*       /*                                                           */ 05180000
*       /* SET UP THE DEMOUNT LIST                           @Y30LB33*/ 05181000
*       /*                                                           */ 05182000
*       /*************************************************************/ 05183000
*                                                                  1159 05184000
*       MDAGL=MDAGL&&MDAGL;         /*                       @Y30LB33*/ 05185000
         LA    @07,MVMDAGL                                         1159 05186000
         XC    MDAGL(37,@07),MDAGL(@07)                            1159 05187000
*       MDDDNAME=MVDDNAME;          /*                       @Y30LB33*/ 05188000
         MVC   MDDDNAME(8,@07),MVDDNAME                            1160 05189000
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @Y30LB33*/ 05190000
         LA    @02,MVUCBPTR                                        1161 05191000
         ST    @02,MDUCBPTR(,@07)                                  1161 05192000
*       MDLABEL=MVVOLUME;           /*                       @Y30LB33*/ 05193000
         MVC   MDLABEL(6,@07),MVVOLUME                             1162 05194000
*       MDWAIT=ON;                  /*                       @Y30LB33*/ 05195000
*                                                                  1163 05196000
         OI    MDWAIT(@07),B'00010000'                             1163 05197000
*       /*************************************************************/ 05198000
*       /*                                                           */ 05199000
*       /* ISSUE THE DEMOUNT                                 @Y30LB33*/ 05200000
*       /*                                                           */ 05201000
*       /*************************************************************/ 05202000
*                                                                  1164 05203000
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB33*/ 05204000
         L     @02,@PC00001                                        1164 05205000
         ST    @02,@AL00001                                        1164 05206000
         LA    @15,DEMOUNT                                         1164 05207000
         ST    @15,@AL00001+4                                      1164 05208000
         ST    @07,@AL00001+8                                      1164 05209000
         MVI   @AL00001+8,X'80'                                    1164 05210000
         L     @15,GDTUNT(,@02)                                    1164 05211000
         LA    @01,@AL00001                                        1164 05212000
         BALR  @14,@15                                             1164 05213000
*       RESPECIFY                                                  1165 05214000
*         RTNREG RSTD;                                             1165 05215000
*       TESTRC=RTNREG;                                             1166 05216000
         LR    TESTRC,RTNREG                                       1166 05217000
*       RESPECIFY                                                  1167 05218000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 05219000
*                                                                  1168 05220000
*       /*************************************************************/ 05221000
*       /*                                                           */ 05222000
*       /* SET THE READONLY ATTRIBUTE ON IF THE              @Y30LB33*/ 05223000
*       /* DEMOUNT WAS SUCCESSFUL                            @Y30LB33*/ 05224000
*       /*                                                           */ 05225000
*       /*************************************************************/ 05226000
*                                                                  1168 05227000
*       IF TESTRC=0 THEN                                           1168 05228000
         SLR   @07,@07                                             1168 05229000
         CR    TESTRC,@07                                          1168 05230000
         BNE   @RF01168                                            1168 05231000
*         DO;                       /*                       @Y30LB33*/ 05232000
*           MNTSW=OFF;              /*                       @YD00175*/ 05233000
         NI    MNTSW,B'11011111'                                   1170 05234000
*           DMNTSW=ON;              /*                       @YD00175*/ 05235000
         OI    DMNTSW,B'10000000'                                  1171 05236000
*           DEFLIST=DEFLIST&&DEFLIST;/*                      @Y30LB33*/ 05237000
         L     @15,DEFVPTR                                         1172 05238000
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1172 05239000
*           DEFVOLD=MVVOLUME;       /*                       @Y30LB33*/ 05240000
         MVC   DEFVOLD(6,@15),MVVOLUME                             1173 05241000
*           DEFVVFLG=MYVVFLG;       /*                       @Y30LB33*/ 05242000
         MVC   DEFVVFLG(1,@15),MYVVFLG                             1174 05243000
*           DEFVREP=ON;             /*                       @Y30LB33*/ 05244000
         OI    DEFVREP(@15),B'00010000'                            1175 05245000
*           DEFVWINH=ON;            /*                       @Y30LB33*/ 05246000
*                                                                  1176 05247000
         OI    DEFVWINH(@15),B'00000010'                           1176 05248000
*           /*********************************************************/ 05249000
*           /*                                                       */ 05250000
*           /* IF THE SERIAL CHANGED, SET UP TO              @Y30LB33*/ 05251000
*           /* TURN OFF LABEL MISMATCH                       @Y30LB33*/ 05252000
*           /*                                                       */ 05253000
*           /*********************************************************/ 05254000
*                                                                  1177 05255000
*           IF ADDR(NEWSR)>0 THEN                                  1177 05256000
         L     @14,@PC00001+4                                      1177 05257000
         C     @07,FDTPTR+4(,@14)                                  1177 05258000
         BNL   @RF01177                                            1177 05259000
*             DO;                   /*                       @Y30LB33*/ 05260000
*               DEFLABEL=MVBLANKS;  /*                       @Y30LB33*/ 05261000
         MVC   DEFLABEL(6,DEFVEPTR),@CC01575                       1179 05262000
*               DEFPVLAB=ON;        /*                       @Y30LB33*/ 05263000
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1180 05264000
*               DEFVVEXT=DEFVEPTR;  /*                       @Y30LB33*/ 05265000
         ST    DEFVEPTR,DEFVVEXT(,@15)                             1181 05266000
*               DEFVE=DEFVE&&DEFVE; /*                       @Y30LB33*/ 05267000
         XC    DEFVE(64,DEFVEPTR),DEFVE(DEFVEPTR)                  1182 05268000
*               DEFLNGTH=DEFLEN;    /*                       @Y30LB33*/ 05269000
         LH    @07,DEFLEN                                          1183 05270000
         ST    @07,DEFLNGTH(,DEFVEPTR)                             1183 05271000
*               DEFCRCVY=ON;        /*                       @Y30LB33*/ 05272000
         OI    DEFCRCVY(DEFVEPTR),B'01000000'                      1184 05273000
*               DEFLAMIS=ON;        /*                       @Y30LB33*/ 05274000
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1185 05275000
*             END;                  /*                       @Y30LB33*/ 05276000
*                                                                  1186 05277000
*           /*********************************************************/ 05278000
*           /*                                                       */ 05279000
*           /* DUMP THE PARAMETER LISTS                      @Y30LB33*/ 05280000
*           /*                                                       */ 05281000
*           /*********************************************************/ 05282000
*                                                                  1187 05283000
*           IF GDTDBG=NULLPTR THEN                                 1187 05284000
@RF01177 L     @07,@PC00001                                        1187 05285000
         L     @07,GDTDBG(,@07)                                    1187 05286000
         LTR   @07,@07                                             1187 05287000
         BZ    @RT01187                                            1187 05288000
*             ;                                                    1188 05289000
*           ELSE                                                   1189 05290000
*             DO;                                                  1189 05291000
*               DMPINDEX=ADDR(DUMPAREA);/*                   @Y30LB33*/ 05292000
         LA    DMPINDEX,DUMPAREA                                   1190 05293000
*               DMPITMNM='DEFLIST';                                1191 05294000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1191 05295000
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       1191 05296000
*               DMPITMPT=ADDR(DEFLIST);                            1192 05297000
         L     @07,DEFVPTR                                         1192 05298000
         ST    @07,DMPITMPT(,DMPINDEX)                             1192 05299000
*               DMPITMLN=LENGTH(DEFLIST);                          1193 05300000
         MVC   DMPITMLN(2,DMPINDEX),@CH01836                       1193 05301000
*               DMPITMTP='H';                                      1194 05302000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1194 05303000
*               DMPINDEX=DMPINDEX+DMPELEMT;                        1195 05304000
*                                                                  1195 05305000
         LA    @07,16                                              1195 05306000
         ALR   DMPINDEX,@07                                        1195 05307000
*               /*****************************************************/ 05308000
*               /*                                                   */ 05309000
*               /*                                           @Y30LB33*/ 05310000
*               /*                                                   */ 05311000
*               /*****************************************************/ 05312000
*                                                                  1196 05313000
*               DMPITMNM='DEFVE';                                  1196 05314000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           1196 05315000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         1196 05316000
         MVC   DMPITMNM(5,DMPINDEX),@CC01764                       1196 05317000
*               DMPITMPT=ADDR(DEFVE);                              1197 05318000
         ST    DEFVEPTR,DMPITMPT(,DMPINDEX)                        1197 05319000
*               DMPITMLN=LENGTH(DEFVE);                            1198 05320000
         MVC   DMPITMLN(2,DMPINDEX),@CH01826                       1198 05321000
*               DMPITMTP='H';                                      1199 05322000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1199 05323000
*               DMPINDEX=DMPINDEX+DMPELEMT;                        1200 05324000
*                                                                  1200 05325000
         ALR   DMPINDEX,@07                                        1200 05326000
*               /*****************************************************/ 05327000
*               /*                                                   */ 05328000
*               /*                                           @Y30LB33*/ 05329000
*               /*                                                   */ 05330000
*               /*****************************************************/ 05331000
*                                                                  1201 05332000
*               DMPTRM=DMPTRMVL;                                   1201 05333000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1201 05334000
*             END;                  /*                       @Y30LB33*/ 05335000
*           IF GDTDBG=NULLPTR THEN                                 1203 05336000
@RT01187 L     @07,@PC00001                                        1203 05337000
         L     @07,GDTDBG(,@07)                                    1203 05338000
         LTR   @07,@07                                             1203 05339000
         BZ    @RT01203                                            1203 05340000
*             ;                                                    1204 05341000
*           ELSE                                                   1205 05342000
*             CALL IDCDB010(GDTTBL,'MVRC',DUMPADDR);/*       @YM02887*/ 05343000
*                                                                  1205 05344000
         L     @07,@PC00001                                        1205 05345000
         ST    @07,@AL00001                                        1205 05346000
         LA    @05,@CC01765                                        1205 05347000
         ST    @05,@AL00001+4                                      1205 05348000
         LA    @05,DUMPADDR                                        1205 05349000
         ST    @05,@AL00001+8                                      1205 05350000
         MVI   @AL00001+8,X'80'                                    1205 05351000
         L     @15,GDTDBG(,@07)                                    1205 05352000
         LA    @01,@AL00001                                        1205 05353000
         BALR  @14,@15                                             1205 05354000
*           /*********************************************************/ 05355000
*           /*                                                       */ 05356000
*           /* ISSUE USSC TO SET READONLY                    @Y30LB33*/ 05357000
*           /*                                                       */ 05358000
*           /*********************************************************/ 05359000
*                                                                  1206 05360000
*           CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/* 1206 05361000
*                                                            @Y30LB33*/ 05362000
@RT01203 L     @07,@PC00001                                        1206 05363000
         ST    @07,@AL00001                                        1206 05364000
         LA    @05,DEFINE                                          1206 05365000
         ST    @05,@AL00001+4                                      1206 05366000
         LA    @05,DEFVPTR                                         1206 05367000
         ST    @05,@AL00001+8                                      1206 05368000
         LA    @05,RCAREA                                          1206 05369000
         ST    @05,@AL00001+12                                     1206 05370000
         LA    @05,ECBBYTE                                         1206 05371000
         ST    @05,@AL00001+16                                     1206 05372000
         MVI   @AL00001+16,X'80'                                   1206 05373000
         L     @15,GDTSSC(,@07)                                    1206 05374000
         LA    @01,@AL00001                                        1206 05375000
         BALR  @14,@15                                             1206 05376000
*           RESPECIFY                                              1207 05377000
*             RTNREG RSTD;                                         1207 05378000
*           TESTRC=RTNREG;                                         1208 05379000
         LR    TESTRC,RTNREG                                       1208 05380000
*           RESPECIFY                                              1209 05381000
*             RTNREG UNRSTD;        /*                       @Y30LB33*/ 05382000
*                                                                  1209 05383000
*           /*********************************************************/ 05384000
*           /*                                                       */ 05385000
*           /* IF WE HAVE AN ERROR, CALL SSCMSG TO           @Y30LB33*/ 05386000
*           /* PRINT THE REASON                              @Y30LB33*/ 05387000
*           /*                                                       */ 05388000
*           /*********************************************************/ 05389000
*                                                                  1210 05390000
*           IF TESTRC=4 THEN        /*                       @Y30LB33*/ 05391000
         C     TESTRC,@CF00043                                     1210 05392000
         BNE   @RF01210                                            1210 05393000
*             CALL SSCMSG(RCAREA);  /*                       @Y30LB33*/ 05394000
         LA    @07,RCAREA                                          1211 05395000
         ST    @07,@AL00001                                        1211 05396000
         LA    @01,@AL00001                                        1211 05397000
         BAL   @14,SSCMSG                                          1211 05398000
*         END;                      /*                       @Y30LB33*/ 05399000
*                                                                  1212 05400000
@RF01210 DS    0H                                                  1213 05401000
*       /*************************************************************/ 05402000
*       /*                                                           */ 05403000
*       /* IF A COMMAND HAD AN ERROR, SET LASTCOND           @Y30LB33*/ 05404000
*       /* TO 8 AND PRINT IDC2091I TO INDICATE               @Y30LB33*/ 05405000
*       /* THAT THE READONLY ATTRIBUTE WAS                   @Y30LB33*/ 05406000
*       /* NOT SET                                           @Y30LB33*/ 05407000
*       /*                                                           */ 05408000
*       /*************************************************************/ 05409000
*                                                                  1213 05410000
*       IF TESTRC=4|TESTRC=8        /*                       @Y30LB33*/ 05411000
*         THEN                                                     1213 05412000
@RF01168 C     TESTRC,@CF00043                                     1213 05413000
         BE    @RT01213                                            1213 05414000
         C     TESTRC,@CF00035                                     1213 05415000
         BNE   @RF01213                                            1213 05416000
@RT01213 DS    0H                                                  1214 05417000
*         DO;                       /*                       @Y30LB33*/ 05418000
*           LASTCOND=MAX(LASTCOND,LASTCC08);/*               @Y30LB33*/ 05419000
         L     @07,@PC00001+8                                      1215 05420000
         LA    @05,8                                               1215 05421000
         LH    @02,LASTCOND(,@07)                                  1215 05422000
         CR    @02,@05                                             1215 05423000
         BNL   *+6                                                      05424000
         LR    @02,@05                                             1215 05425000
         STH   @02,LASTCOND(,@07)                                  1215 05426000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 05427000
         L     @07,DDSTRU                                          1216 05428000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1216 05429000
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/ 05430000
*                                                                  1217 05431000
         MVC   DARGSMOD(3,@07),MODCMN                              1217 05432000
*           /*********************************************************/ 05433000
*           /*                                                       */ 05434000
*           /* PRINT IDC2093I IF READONLY IS THE             @Y30LB33*/ 05435000
*           /* ONLY ATTRIBUTE COPIED FROM THE GROUP          @Y30LB33*/ 05436000
*           /*                                                       */ 05437000
*           /*********************************************************/ 05438000
*                                                                  1218 05439000
*           IF ONLYONLY=ON THEN                                    1218 05440000
         TM    ONLYONLY,B'10000000'                                1218 05441000
         BNO   @RF01218                                            1218 05442000
*             DO;                   /*                       @Y30LB33*/ 05443000
*               DARGSENT=MSG2093I;  /*                       @Y30LB33*/ 05444000
         MVI   DARGSENT(@07),X'36'                                 1220 05445000
*               DARGILP=LENGTH(GROVVGRP);/*                  @Y30LB33*/ 05446000
         STH   @05,DARGILP(,@07)                                   1221 05447000
*               DARGDBP=ADDR(GROVVGRP);/*                    @Y30LB33*/ 05448000
         LA    @05,GROVVGRP(,GROUPPTR)                             1222 05449000
         ST    @05,DARGDBP(,@07)                                   1222 05450000
*             END;                  /*                       @Y30LB33*/ 05451000
*                                                                  1223 05452000
*           /*********************************************************/ 05453000
*           /*                                                       */ 05454000
*           /* OTHERWISE, PRINT IDC2091I                     @Y30LB33*/ 05455000
*           /*                                                       */ 05456000
*           /*********************************************************/ 05457000
*                                                                  1224 05458000
*           ELSE                                                   1224 05459000
*             DO;                   /*                       @Y30LB33*/ 05460000
         B     @RC01218                                            1224 05461000
@RF01218 DS    0H                                                  1225 05462000
*               DARGSENT=MSG2091I;  /*                       @Y30LB33*/ 05463000
         L     @07,DDSTRU                                          1225 05464000
         MVI   DARGSENT(@07),X'0F'                                 1225 05465000
*               DARGILP=LENGTH(MVVOLUME);/*                  @Y30LB33*/ 05466000
         MVC   DARGILP(2,@07),@CH00159                             1226 05467000
*               DARGDBP=ADDR(MVVOLUME);/*                    @Y30LB33*/ 05468000
         LA    @05,MVVOLUME                                        1227 05469000
         ST    @05,DARGDBP(,@07)                                   1227 05470000
*             END;                  /*                       @Y30LB33*/ 05471000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/ 05472000
@RC01218 L     @07,@PC00001                                        1229 05473000
         ST    @07,@AL00001                                        1229 05474000
         LA    @05,@CF00117                                        1229 05475000
         ST    @05,@AL00001+4                                      1229 05476000
         LA    @05,DDSTRU                                          1229 05477000
         ST    @05,@AL00001+8                                      1229 05478000
         MVI   @AL00001+8,X'80'                                    1229 05479000
         L     @15,GDTPRT(,@07)                                    1229 05480000
         LA    @01,@AL00001                                        1229 05481000
         BALR  @14,@15                                             1229 05482000
*         END;                      /*                       @Y30LB33*/ 05483000
*                                                                  1231 05484000
*       /*************************************************************/ 05485000
*       /*                                                           */ 05486000
*       /* IF WE GOT NO ERRORS, TEST FOR AN                  @Y30LB33*/ 05487000
*       /* INVENTORY I/O ERROR AND SET                       @Y30LB33*/ 05488000
*       /* LASTCOND TO 4                                     @Y30LB33*/ 05489000
*       /*                                                           */ 05490000
*       /*************************************************************/ 05491000
*                                                                  1231 05492000
*       ELSE                                                       1231 05493000
*         IF TESTRC=12 THEN         /*                       @Y30LB33*/ 05494000
         B     @RC01213                                            1231 05495000
@RF01213 C     TESTRC,@CF00038                                     1231 05496000
         BNE   @RF01231                                            1231 05497000
*           LASTCOND=MAX(LASTCOND,LASTCC04);/*               @Y30LB33*/ 05498000
*                                                                  1232 05499000
         L     @07,@PC00001+8                                      1232 05500000
         LH    @05,LASTCOND(,@07)                                  1232 05501000
         LA    @02,4                                               1232 05502000
         CR    @05,@02                                             1232 05503000
         BNL   *+6                                                      05504000
         LR    @05,@02                                             1232 05505000
         STH   @05,LASTCOND(,@07)                                  1232 05506000
*       /*************************************************************/ 05507000
*       /*                                                           */ 05508000
*       /* IF WE GET NO ERRORS,                              @Y30LB33*/ 05509000
*       /* TURN ON THE MISMATCH CLEAR SWITCH, AND IF         @Y30LB33*/ 05510000
*       /* THE ONLYONLY SWITCH IS ON,                        @Y30LB33*/ 05511000
*       /* INDICATING THE MESSAGE IDC0073I                   @Y30LB33*/ 05512000
*       /* HAS NOT BEEN SENT YET,                            @Y30LB33*/ 05513000
*       /* ISSUE MESSAGE IDC0073I TO INDICATE                @Y30LB33*/ 05514000
*       /* THAT THE GROUP ATTRIBUTES WERE                    @Y30LB33*/ 05515000
*       /* IMPOSED ON THE VOLUME,                            @Y30LB33*/ 05516000
*       /*                                                           */ 05517000
*       /*************************************************************/ 05518000
*                                                                  1233 05519000
*       IF TESTRC=12|TESTRC=0 THEN                                 1233 05520000
@RF01231 DS    0H                                                  1233 05521000
@RC01213 C     TESTRC,@CF00038                                     1233 05522000
         BE    @RT01233                                            1233 05523000
         LTR   TESTRC,TESTRC                                       1233 05524000
         BNZ   @RF01233                                            1233 05525000
@RT01233 DS    0H                                                  1234 05526000
*         DO;                       /*                       @Y30LB33*/ 05527000
*           MISCLEAR=ON;            /*                       @Y30LB33*/ 05528000
         OI    MISCLEAR,B'00000001'                                1235 05529000
*           IF ONLYONLY=ON THEN                                    1236 05530000
         TM    ONLYONLY,B'10000000'                                1236 05531000
         BNO   @RF01236                                            1236 05532000
*             DO;                   /*                       @Y30LB33*/ 05533000
*               DARGLIST=DARGLIST&&DARGLIST;/*               @Y30LB33*/ 05534000
         L     @07,DDSTRU                                          1238 05535000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1238 05536000
*               DARGSMOD=MODCMN;    /*                       @Y30LB33*/ 05537000
         MVC   DARGSMOD(3,@07),MODCMN                              1239 05538000
*               DARGSENT=MSG0073I;  /*                       @Y30LB33*/ 05539000
         MVI   DARGSENT(@07),X'21'                                 1240 05540000
*               DARGILP=LENGTH(GROVVGRP);/*                  @Y30LB33*/ 05541000
         MVC   DARGILP(2,@07),@CH00035                             1241 05542000
*               DARGDBP=ADDR(GROVVGRP);/*                    @Y30LB33*/ 05543000
         LA    @05,GROVVGRP(,GROUPPTR)                             1242 05544000
         ST    @05,DARGDBP(,@07)                                   1242 05545000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB33*/ 05546000
         L     @05,@PC00001                                        1243 05547000
         ST    @05,@AL00001                                        1243 05548000
         LA    @15,@CF00117                                        1243 05549000
         ST    @15,@AL00001+4                                      1243 05550000
         LA    @15,DDSTRU                                          1243 05551000
         ST    @15,@AL00001+8                                      1243 05552000
         MVI   @AL00001+8,X'80'                                    1243 05553000
         L     @15,GDTPRT(,@05)                                    1243 05554000
         LA    @01,@AL00001                                        1243 05555000
         BALR  @14,@15                                             1243 05556000
*             END;                  /*                       @Y30LB33*/ 05557000
*         END;                      /*                       @Y30LB33*/ 05558000
@RF01236 DS    0H                                                  1246 05559000
*     END;                          /*                       @Y30LB33*/ 05560000
*                                                                  1246 05561000
@RF01233 DS    0H                                                  1247 05562000
*   /*****************************************************************/ 05563000
*   /*                                                               */ 05564000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 05565000
*   /*                                                               */ 05566000
*   /*****************************************************************/ 05567000
*                                                                  1247 05568000
*   REG14=DMNTVSV;                  /*                       @Y30LB33*/ 05569000
@RF01157 LR    REG14,DMNTVSV                                       1247 05570000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 05571000
         SLR   @15,@15                                             1248 05572000
@EL00019 DS    0H                                                  1248 05573000
@EF00019 DS    0H                                                  1248 05574000
@ER00019 BR    @14                                                 1248 05575000
*   END DMNTVOL;                    /*                       @Y30LB33*/ 05576000
*                                                                  1250 05577000
*/********************************************************   @Y30LB33*/ 05578000
*/* PROCEDURE NAME - SETFLGS                                 @Y30LB33*/ 05579000
*/*                                                          @Y30LB33*/ 05580000
*/* FUNCTION - TO TURN OFF THE LABEL MISMATCH                @Y30LB33*/ 05581000
*/*      FLAG                                                @Y30LB33*/ 05582000
*/*                                                          @Y30LB33*/ 05583000
*/*      MESSAGE IDC2065I IS ISSUED IF THE MISMATCH FLAG     @Y30LB33*/ 05584000
*/*      UPDATE FAILS                                        @Y30LB33*/ 05585000
*/*                                                          @Y30LB33*/ 05586000
*/* INPUT - THE FDTTBL AND SWCHBITS                          @Y30LB33*/ 05587000
*/*                                                          @Y30LB33*/ 05588000
*/* OUTPUT - LASTCOND OF 8 IF LABEL MISMATCH UPDATE FAILS    @Y30LB33*/ 05589000
*/********************************************************   @Y30LB33*/ 05590000
*                                                                  1250 05591000
*SETFLGS:                                                          1250 05592000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 05593000
*                                                                  1250 05594000
SETFLGS  DS    0H                                                  1251 05595000
*   /*****************************************************************/ 05596000
*   /*                                                               */ 05597000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 05598000
*   /*                                                               */ 05599000
*   /*****************************************************************/ 05600000
*                                                                  1251 05601000
*   DCL                                                            1251 05602000
*     SETFLGSV PTR(31);             /*                       @Y30LB33*/ 05603000
*   SETFLGSV=REG14;                 /*                       @Y30LB33*/ 05604000
         LR    SETFLGSV,REG14                                      1252 05605000
*   OLDERID2=NEWERID2;                                             1253 05606000
         L     @05,@PC00001                                        1253 05607000
         L     @15,GDTTR2(,@05)                                    1253 05608000
         MVC   @TS00001(95),NEWERID2(@15)                          1253 05609000
         MVC   OLDERID2(95,@15),@TS00001                           1253 05610000
*   NEWID2='MVSA';                  /*                       @Y30LB33*/ 05611000
*                                                                  1254 05612000
         MVC   NEWID2(4,@15),@CC01770                              1254 05613000
*   /*****************************************************************/ 05614000
*   /*                                                               */ 05615000
*   /* BUILD LIST TO TURN OFF                                @Y30LB33*/ 05616000
*   /* MISMATCH                                              @Y30LB33*/ 05617000
*   /*                                                               */ 05618000
*   /*****************************************************************/ 05619000
*                                                                  1255 05620000
*   MVR=MVR&&MVR;                   /*                       @Y30LB33*/ 05621000
         L     @15,MVRPTR                                          1255 05622000
         XC    MVR(88,@15),MVR(@15)                                1255 05623000
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB33*/ 05624000
         LH    @14,MVRLEN                                          1256 05625000
         ST    @14,MVRLNGTH(,@15)                                  1256 05626000
*   MVRCODE=MVROP;                  /*                       @Y30LB33*/ 05627000
         XC    MVRCODE+1(3,@15),MVRCODE+1(@15)                     1257 05628000
         MVI   MVRCODE(@15),X'85'                                  1257 05629000
*   MVRBVOL=MVVOLUME;               /*                       @Y30LB33*/ 05630000
         MVC   MVRBVOL(6,@15),MVVOLUME                             1258 05631000
*   MVRLABEL=MVBLANKS;              /*                       @Y30LB33*/ 05632000
         MVC   MVRLABEL(6,@15),@CC01575                            1259 05633000
*   MVRFLLAB=ON;                    /*                       @Y30LB33*/ 05634000
         OI    MVRFLLAB(@15),B'00000001'                           1260 05635000
*   MVRCLMIS=ON;                    /*                       @Y30LB33*/ 05636000
*                                                                  1261 05637000
         OI    MVRCLMIS(@15),B'00000001'                           1261 05638000
*   /*****************************************************************/ 05639000
*   /*                                                               */ 05640000
*   /* DUMP THE ARGUMENT LIST                                @Y30LB33*/ 05641000
*   /*                                                               */ 05642000
*   /*****************************************************************/ 05643000
*                                                                  1262 05644000
*   IF GDTDBG=NULLPTR THEN                                         1262 05645000
         L     @05,GDTDBG(,@05)                                    1262 05646000
         LTR   @05,@05                                             1262 05647000
         BZ    @RT01262                                            1262 05648000
*     ;                                                            1263 05649000
*   ELSE                                                           1264 05650000
*     DO;                                                          1264 05651000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 05652000
         LA    DMPINDEX,DUMPAREA                                   1265 05653000
*       DMPITMNM='MVR';                                            1266 05654000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1266 05655000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1266 05656000
         MVC   DMPITMNM(3,DMPINDEX),@CC01771                       1266 05657000
*       DMPITMPT=ADDR(MVR);                                        1267 05658000
         L     @05,MVRPTR                                          1267 05659000
         ST    @05,DMPITMPT(,DMPINDEX)                             1267 05660000
*       DMPITMLN=LENGTH(MVR);                                      1268 05661000
         MVC   DMPITMLN(2,DMPINDEX),@CH01823                       1268 05662000
*       DMPITMTP='H';                                              1269 05663000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1269 05664000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1270 05665000
*                                                                  1270 05666000
         AL    DMPINDEX,@CF00507                                   1270 05667000
*       /*************************************************************/ 05668000
*       /*                                                           */ 05669000
*       /*                                                   @Y30LB33*/ 05670000
*       /*                                                           */ 05671000
*       /*************************************************************/ 05672000
*                                                                  1271 05673000
*       DMPTRM=DMPTRMVL;                                           1271 05674000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1271 05675000
*     END;                          /*                       @Y30LB33*/ 05676000
*   IF GDTDBG=NULLPTR THEN                                         1273 05677000
@RT01262 L     @05,@PC00001                                        1273 05678000
         L     @05,GDTDBG(,@05)                                    1273 05679000
         LTR   @05,@05                                             1273 05680000
         BZ    @RT01273                                            1273 05681000
*     ;                                                            1274 05682000
*   ELSE                                                           1275 05683000
*     CALL IDCDB010(GDTTBL,'MVSB',DUMPADDR);/*               @YM02887*/ 05684000
*                                                                  1275 05685000
         L     @05,@PC00001                                        1275 05686000
         ST    @05,@AL00001                                        1275 05687000
         LA    @15,@CC01772                                        1275 05688000
         ST    @15,@AL00001+4                                      1275 05689000
         LA    @15,DUMPADDR                                        1275 05690000
         ST    @15,@AL00001+8                                      1275 05691000
         MVI   @AL00001+8,X'80'                                    1275 05692000
         L     @15,GDTDBG(,@05)                                    1275 05693000
         LA    @01,@AL00001                                        1275 05694000
         BALR  @14,@15                                             1275 05695000
*   /*****************************************************************/ 05696000
*   /*                                                               */ 05697000
*   /* ISSUE USSC TO CHANGE MISMATCH                         @Y30LB33*/ 05698000
*   /*                                                               */ 05699000
*   /*****************************************************************/ 05700000
*                                                                  1276 05701000
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,RCAREA);/*              @Y30LB33*/ 05702000
@RT01273 L     @05,@PC00001                                        1276 05703000
         ST    @05,@AL00001                                        1276 05704000
         LA    @02,VVIC                                            1276 05705000
         ST    @02,@AL00001+4                                      1276 05706000
         LA    @02,MVRPTR                                          1276 05707000
         ST    @02,@AL00001+8                                      1276 05708000
         LA    @02,RCAREA                                          1276 05709000
         ST    @02,@AL00001+12                                     1276 05710000
         MVI   @AL00001+12,X'80'                                   1276 05711000
         L     @15,GDTSSC(,@05)                                    1276 05712000
         LA    @01,@AL00001                                        1276 05713000
         BALR  @14,@15                                             1276 05714000
*   RESPECIFY                                                      1277 05715000
*     RTNREG RSTD;                                                 1277 05716000
*   TESTRC=RTNREG;                                                 1278 05717000
         LR    TESTRC,RTNREG                                       1278 05718000
*   RESPECIFY                                                      1279 05719000
*     RTNREG UNRSTD;                /*                       @Y30LB33*/ 05720000
*                                                                  1279 05721000
*   /*****************************************************************/ 05722000
*   /*                                                               */ 05723000
*   /* TEST FOR AN ERROR TURNING OFF                         @Y30LB33*/ 05724000
*   /* MISMATCH                                              @Y30LB33*/ 05725000
*   /*                                                               */ 05726000
*   /*****************************************************************/ 05727000
*                                                                  1280 05728000
*   IF TESTRC^=0 THEN                                              1280 05729000
         LTR   TESTRC,TESTRC                                       1280 05730000
         BZ    @RF01280                                            1280 05731000
*     DO;                           /*                       @Y30LB33*/ 05732000
*                                                                  1281 05733000
*       /*************************************************************/ 05734000
*       /*                                                           */ 05735000
*       /* CALL SSCMSG TO PRINT THE FAILURE REASON           @Y30LB33*/ 05736000
*       /*                                                           */ 05737000
*       /*************************************************************/ 05738000
*                                                                  1282 05739000
*       CALL SSCMSG(RCAREA);        /*                       @Y30LB33*/ 05740000
*                                                                  1282 05741000
         LA    @05,RCAREA                                          1282 05742000
         ST    @05,@AL00001                                        1282 05743000
         LA    @01,@AL00001                                        1282 05744000
         BAL   @14,SSCMSG                                          1282 05745000
*       /*************************************************************/ 05746000
*       /*                                                           */ 05747000
*       /* PRINT IDC2065I TO TELL                            @Y30LB33*/ 05748000
*       /* USER MISMATCH RESET FAILED                        @Y30LB33*/ 05749000
*       /* AND SET LASTCOND TO 8                             @Y30LB33*/ 05750000
*       /*                                                           */ 05751000
*       /*************************************************************/ 05752000
*                                                                  1283 05753000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 05754000
         L     @05,DDSTRU                                          1283 05755000
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1283 05756000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 05757000
         MVC   DARGSMOD(3,@05),MODCMN                              1284 05758000
*       DARGSENT=MSG2065I;          /*                       @Y30LB33*/ 05759000
         MVI   DARGSENT(@05),X'2D'                                 1285 05760000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 05761000
         L     @05,@PC00001                                        1286 05762000
         ST    @05,@AL00001                                        1286 05763000
         LA    @15,@CF00117                                        1286 05764000
         ST    @15,@AL00001+4                                      1286 05765000
         LA    @15,DDSTRU                                          1286 05766000
         ST    @15,@AL00001+8                                      1286 05767000
         MVI   @AL00001+8,X'80'                                    1286 05768000
         L     @15,GDTPRT(,@05)                                    1286 05769000
         LA    @01,@AL00001                                        1286 05770000
         BALR  @14,@15                                             1286 05771000
*       LASTCOND=LASTCC08;          /*                       @Y30LB33*/ 05772000
         L     @05,@PC00001+8                                      1287 05773000
         MVC   LASTCOND(2,@05),@CH00035                            1287 05774000
*     END;                          /*                       @Y30LB33*/ 05775000
*                                                                  1288 05776000
*   /*****************************************************************/ 05777000
*   /*                                                               */ 05778000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 05779000
*   /*                                                               */ 05780000
*   /*****************************************************************/ 05781000
*                                                                  1289 05782000
*   REG14=SETFLGSV;                 /*                       @Y30LB33*/ 05783000
@RF01280 LR    REG14,SETFLGSV                                      1289 05784000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 05785000
         SLR   @15,@15                                             1290 05786000
@EL00020 DS    0H                                                  1290 05787000
@EF00020 DS    0H                                                  1290 05788000
@ER00020 BR    @14                                                 1290 05789000
*   END SETFLGS;                    /*                       @Y30LB33*/ 05790000
*                                                                  1292 05791000
*/********************************************************   @Y30LB33*/ 05792000
*/* PROCEDURE NAME - BACKOUT                                 @Y30LB33*/ 05793000
*/*                                                          @Y30LB33*/ 05794000
*/* FUNCTION - CHANGES THE VOLUME RECORD AND                 @Y30LB33*/ 05795000
*/*    CARTRIDGE LABEL TO WHAT IT WAS BEFORE THE             @Y30LB33*/ 05796000
*/*    MODIFICATION                                          @Y30LB33*/ 05797000
*/*                                                          @Y30LB33*/ 05798000
*/*      MESSAGE IDC3062I IS ISSUED IF THE CARTRIDGE AND     @Y30LB33*/ 05799000
*/*      RECORD ARE NOT RESTORED                             @Y30LB33*/ 05800000
*/*                                                          @Y30LB33*/ 05801000
*/*      MESSAGE IDC0063I IS ISSUED IF THE BACKOUT RUNS      @Y30LB33*/ 05802000
*/*                                                          @Y30LB33*/ 05803000
*/* INPUT - DEFLIST, SWCHBITS, AND THE DEFLIST               @Y30LB33*/ 05804000
*/*    EXTENSION                                             @Y30LB33*/ 05805000
*/*                                                          @Y30LB33*/ 05806000
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/ 05807000
*/*      BACKFAIL IS TURNED IF THE BACKOUT FAILED            @Y30LB33*/ 05808000
*/*      INACTSW IS TURNED ON WHEN THE DEFINE COMMAND RUNS,  @Y30LB33*/ 05809000
*/*      AND IS TURNED OFF WHEN THE ACTIVATE COMMAND         @Y30LB33*/ 05810000
*/*      RUNS                                                @Y30LB33*/ 05811000
*/********************************************************   @Y30LB33*/ 05812000
*                                                                  1292 05813000
*BACKOUT:                                                          1292 05814000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 05815000
*                                                                  1292 05816000
BACKOUT  DS    0H                                                  1293 05817000
*   /*****************************************************************/ 05818000
*   /*                                                               */ 05819000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 05820000
*   /*                                                               */ 05821000
*   /*****************************************************************/ 05822000
*                                                                  1293 05823000
*   DCL                                                            1293 05824000
*     BACKSV PTR(31);               /*                       @Y30LB33*/ 05825000
*   BACKSV=REG14;                   /*                       @Y30LB33*/ 05826000
         ST    REG14,BACKSV                                        1294 05827000
*   OLDERID2=NEWERID2;                                             1295 05828000
         L     @02,@PC00001                                        1295 05829000
         L     @15,GDTTR2(,@02)                                    1295 05830000
         MVC   @TS00001(95),NEWERID2(@15)                          1295 05831000
         MVC   OLDERID2(95,@15),@TS00001                           1295 05832000
*   NEWID2='MVTA';                  /*                       @Y30LB33*/ 05833000
*                                                                  1296 05834000
         MVC   NEWID2(4,@15),@CC01777                              1296 05835000
*   /*****************************************************************/ 05836000
*   /*                                                               */ 05837000
*   /* IF THE VOLUME IS MOUNTED AFTER BEING PROCESSED        @YM02888*/ 05838000
*   /* IN ALLOVOL FOR EXCLUSIVE CONTROL, WE MUST             @YM02888*/ 05839000
*   /* DEMOUNT IT BEFORE BACKING OUT THE CHANGES             @YM02888*/ 05840000
*   /*                                                               */ 05841000
*   /*****************************************************************/ 05842000
*                                                                  1297 05843000
*   IF MNTSW=ON THEN                                               1297 05844000
         TM    MNTSW,B'00100000'                                   1297 05845000
         BNO   @RF01297                                            1297 05846000
*     DO;                           /*                       @YM02888*/ 05847000
*                                                                  1298 05848000
*       /*************************************************************/ 05849000
*       /*                                                           */ 05850000
*       /* CREATE THE DEMOUNT ARGUMENT LIST                  @YM02888*/ 05851000
*       /*                                                           */ 05852000
*       /*************************************************************/ 05853000
*                                                                  1299 05854000
*       MDAGL=MDAGL&&MDAGL;         /*                       @YM02888*/ 05855000
         LA    @15,MVMDAGL                                         1299 05856000
         XC    MDAGL(37,@15),MDAGL(@15)                            1299 05857000
*       MDDDNAME=MVDDNAME;          /*                       @YM02888*/ 05858000
         MVC   MDDDNAME(8,@15),MVDDNAME                            1300 05859000
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @YM02888*/ 05860000
         LA    @14,MVUCBPTR                                        1301 05861000
         ST    @14,MDUCBPTR(,@15)                                  1301 05862000
*       MDLABEL=MVVOLUME;           /*                       @YM02888*/ 05863000
         MVC   MDLABEL(6,@15),MVVOLUME                             1302 05864000
*       MDWAIT=ON;                  /*                       @YM02888*/ 05865000
*                                                                  1303 05866000
         OI    MDWAIT(@15),B'00010000'                             1303 05867000
*       /*************************************************************/ 05868000
*       /*                                                           */ 05869000
*       /* ISSUE THE DEMOUNT                                 @YM02888*/ 05870000
*       /*                                                           */ 05871000
*       /*************************************************************/ 05872000
*                                                                  1304 05873000
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @YM02888*/ 05874000
         ST    @02,@AL00001                                        1304 05875000
         LA    @14,DEMOUNT                                         1304 05876000
         ST    @14,@AL00001+4                                      1304 05877000
         ST    @15,@AL00001+8                                      1304 05878000
         MVI   @AL00001+8,X'80'                                    1304 05879000
         L     @15,GDTUNT(,@02)                                    1304 05880000
         LA    @01,@AL00001                                        1304 05881000
         BALR  @14,@15                                             1304 05882000
*       RESPECIFY                                                  1305 05883000
*         RTNREG RSTD;                                             1305 05884000
*       TESTRC=RTNREG;                                             1306 05885000
         LR    TESTRC,RTNREG                                       1306 05886000
*       RESPECIFY                                                  1307 05887000
*         RTNREG UNRSTD;            /*                       @YM02888*/ 05888000
*                                                                  1307 05889000
*       /*************************************************************/ 05890000
*       /*                                                           */ 05891000
*       /* IF NO ERRORS, TURN OFF THE MOUNT SWITCH           @YM02888*/ 05892000
*       /*                                                           */ 05893000
*       /*************************************************************/ 05894000
*                                                                  1308 05895000
*       IF TESTRC=0 THEN                                           1308 05896000
         LTR   TESTRC,TESTRC                                       1308 05897000
         BNZ   @RF01308                                            1308 05898000
*         DO;                       /*                       @YD00175*/ 05899000
*           MNTSW=OFF;              /*                       @YD00175*/ 05900000
         NI    MNTSW,B'11011111'                                   1310 05901000
*           DMNTSW=ON;              /*                       @YD00175*/ 05902000
         OI    DMNTSW,B'10000000'                                  1311 05903000
*         END;                      /*                       @YD00175*/ 05904000
*     END;                          /*                       @Y30LB33*/ 05905000
*                                                                  1313 05906000
@RF01308 DS    0H                                                  1314 05907000
*   /*****************************************************************/ 05908000
*   /*                                                               */ 05909000
*   /* IF THE VOLUME IS DEMOUNTED AND THIS IS NOT            @ZDR2057*/ 05910000
*   /* A REBUILD LABEL REQUEST, DO THE BACKOUT.              @ZDR2057*/ 05911000
*   /*                                                               */ 05912000
*   /*****************************************************************/ 05913000
*                                                                  1314 05914000
*   IF MNTSW=OFF&ADDR(RLBL)=NULLPTR THEN                           1314 05915000
@RF01297 TM    MNTSW,B'00100000'                                   1314 05916000
         BNZ   @RF01314                                            1314 05917000
         L     @02,@PC00001+4                                      1314 05918000
         L     @02,FDTPTR+100(,@02)                                1314 05919000
         LTR   @02,@02                                             1314 05920000
         BNZ   @RF01314                                            1314 05921000
*     DO;                           /*                       @ZDR2057*/ 05922000
*                                                                  1315 05923000
*       /*************************************************************/ 05924000
*       /*                                                           */ 05925000
*       /* SET UP BASE POINTER AT THE BACKOUT                @YM02888*/ 05926000
*       /* ARGUMENT LISTS. SET UP TO OPERATE ON AN           @YM02888*/ 05927000
*       /* ACTIVE OR INACTIVE VOLUME                         @Y30LB33*/ 05928000
*       /*                                                           */ 05929000
*       /*************************************************************/ 05930000
*                                                                  1316 05931000
*       DEFVPTR=ADDR(BKDEFLST);     /*                       @Y30LB33*/ 05932000
*                                                                  1316 05933000
         LA    @15,BKDEFLST                                        1316 05934000
         ST    @15,DEFVPTR                                         1316 05935000
*       /*************************************************************/ 05936000
*       /*                                                           */ 05937000
*       /* IF THE VOLUME IS INACTIVE, SET UP ARGUMENT        @Y30LB33*/ 05938000
*       /* LIST TO OPERATE ON AN INACTIVE VOLUME             @Y30LB33*/ 05939000
*       /*                                                           */ 05940000
*       /*************************************************************/ 05941000
*                                                                  1317 05942000
*       IF INACTSW=ON THEN                                         1317 05943000
         TM    INACTSW,B'00000100'                                 1317 05944000
         BNO   @RF01317                                            1317 05945000
*         DO;                       /*                       @Y30LB33*/ 05946000
*           DEFVRNTR=ON;            /*                       @Y30LB33*/ 05947000
         OI    DEFVRNTR(@15),B'00000100'                           1319 05948000
*           DEFVCSN1=BASCSN1;       /*                       @Y30LB33*/ 05949000
         MVC   DEFVCSN1(12,@15),BASCSN1(BASEVPTR)                  1320 05950000
*         END;                      /*                       @Y30LB33*/ 05951000
*                                                                  1321 05952000
*       /*************************************************************/ 05953000
*       /*                                                           */ 05954000
*       /* OTHERWISE, SET UP TO OPERATE ON AN ACTIVE VOLUME  @Y30LB33*/ 05955000
*       /*                                                           */ 05956000
*       /*************************************************************/ 05957000
*                                                                  1322 05958000
*       ELSE                                                       1322 05959000
*         DEFVRNM=ON;               /*                       @Y30LB33*/ 05960000
*                                                                  1322 05961000
         B     @RC01317                                            1322 05962000
@RF01317 L     @01,DEFVPTR                                         1322 05963000
         OI    DEFVRNM(@01),B'00100000'                            1322 05964000
*       /*************************************************************/ 05965000
*       /*                                                           */ 05966000
*       /* ISSUE THE DEFINE COMMAND TO BACKOUT THE           @Y30LB33*/ 05967000
*       /* CHANGES                                           @Y30LB33*/ 05968000
*       /*                                                           */ 05969000
*       /*************************************************************/ 05970000
*                                                                  1323 05971000
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*     1323 05972000
*                                                            @Y30LB33*/ 05973000
@RC01317 L     @02,@PC00001                                        1323 05974000
         ST    @02,@AL00001                                        1323 05975000
         LA    @15,DEFINE                                          1323 05976000
         ST    @15,@AL00001+4                                      1323 05977000
         LA    @15,DEFVPTR                                         1323 05978000
         ST    @15,@AL00001+8                                      1323 05979000
         LA    @15,RCAREA                                          1323 05980000
         ST    @15,@AL00001+12                                     1323 05981000
         LA    @15,ECBBYTE                                         1323 05982000
         ST    @15,@AL00001+16                                     1323 05983000
         MVI   @AL00001+16,X'80'                                   1323 05984000
         L     @15,GDTSSC(,@02)                                    1323 05985000
         LA    @01,@AL00001                                        1323 05986000
         BALR  @14,@15                                             1323 05987000
*       RESPECIFY                                                  1324 05988000
*         RTNREG RSTD;                                             1324 05989000
*       TESTRC=RTNREG;                                             1325 05990000
         LR    TESTRC,RTNREG                                       1325 05991000
*       RESPECIFY                                                  1326 05992000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 05993000
*                                                                  1327 05994000
*       /*************************************************************/ 05995000
*       /*                                                           */ 05996000
*       /* IF WE HAD AN ERROR, PRINT THE                     @Y30LB33*/ 05997000
*       /* MESSAGE IDC3062I AND TURN ON THE BACK FAIL        @Y30LB33*/ 05998000
*       /* SWITCH                                            @Y30LB33*/ 05999000
*       /*                                                           */ 06000000
*       /*************************************************************/ 06001000
*                                                                  1327 06002000
*     END;                          /*                       @YM02888*/ 06003000
*   IF MNTSW=ON|TESTRC=4|TESTRC=8 THEN                             1328 06004000
@RF01314 TM    MNTSW,B'00100000'                                   1328 06005000
         BO    @RT01328                                            1328 06006000
         C     TESTRC,@CF00043                                     1328 06007000
         BE    @RT01328                                            1328 06008000
         C     TESTRC,@CF00035                                     1328 06009000
         BNE   @RF01328                                            1328 06010000
@RT01328 DS    0H                                                  1329 06011000
*     DO;                           /*                       @YM02888*/ 06012000
*                                                                  1329 06013000
*       /*************************************************************/ 06014000
*       /*                                                           */ 06015000
*       /* IF WE GOT A REAL ERROR, NOT JUST NO SPACE         @Y30LB33*/ 06016000
*       /* CALL SSCMSG AND THEN PRINT IDC3062I               @Y30LB33*/ 06017000
*       /*                                                           */ 06018000
*       /*************************************************************/ 06019000
*                                                                  1330 06020000
*       IF TESTRC=4 THEN            /*                       @Y30LB33*/ 06021000
         C     TESTRC,@CF00043                                     1330 06022000
         BNE   @RF01330                                            1330 06023000
*         CALL SSCMSG(RCAREA,ECBBYTE);/*                     @Y30LB33*/ 06024000
         LA    @15,RCAREA                                          1331 06025000
         ST    @15,@AL00001                                        1331 06026000
         LA    @15,ECBBYTE                                         1331 06027000
         ST    @15,@AL00001+4                                      1331 06028000
         LA    @01,@AL00001                                        1331 06029000
         BAL   @14,SSCMSG                                          1331 06030000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 06031000
@RF01330 L     @15,DDSTRU                                          1332 06032000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1332 06033000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 06034000
         MVC   DARGSMOD(3,@15),MODCMN                              1333 06035000
*       DARGSENT=MSG3062I;          /*                       @Y30LB33*/ 06036000
         MVI   DARGSENT(@15),X'30'                                 1334 06037000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 06038000
         L     @15,@PC00001                                        1335 06039000
         ST    @15,@AL00001                                        1335 06040000
         LA    @14,@CF00117                                        1335 06041000
         ST    @14,@AL00001+4                                      1335 06042000
         LA    @14,DDSTRU                                          1335 06043000
         ST    @14,@AL00001+8                                      1335 06044000
         MVI   @AL00001+8,X'80'                                    1335 06045000
         L     @15,GDTPRT(,@15)                                    1335 06046000
         LA    @01,@AL00001                                        1335 06047000
         BALR  @14,@15                                             1335 06048000
*     END;                          /*                       @Y30LB33*/ 06049000
*                                                                  1337 06050000
*   /*****************************************************************/ 06051000
*   /*                                                               */ 06052000
*   /* IF WE GOT NO ERRORS, PRINT MESSAGE                    @Y30LB33*/ 06053000
*   /* IDC0063I TO INDICATE THAT                             @Y30LB33*/ 06054000
*   /* EVERYTHING WAS RESTORED                               @Y30LB33*/ 06055000
*   /*                                                               */ 06056000
*   /*****************************************************************/ 06057000
*                                                                  1337 06058000
*   ELSE                                                           1337 06059000
*     DO;                           /*                       @Y30LB33*/ 06060000
         B     @RC01328                                            1337 06061000
@RF01328 DS    0H                                                  1338 06062000
*       INACTSW=ON;                 /*                       @Y30LB33*/ 06063000
         OI    INACTSW,B'00000100'                                 1338 06064000
*       MVVOLUME=VOLVAL;            /*                       @Y30LB33*/ 06065000
         L     @15,@PC00001+4                                      1339 06066000
         L     @01,FDTPTR(,@15)                                    1339 06067000
         MVC   MVVOLUME(6),VOLVAL(@01)                             1339 06068000
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/ 06069000
         L     @15,DDSTRU                                          1340 06070000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1340 06071000
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/ 06072000
         MVC   DARGSMOD(3,@15),MODCMN                              1341 06073000
*       DARGSENT=MSG0063I;          /*                       @Y30LB33*/ 06074000
         MVI   DARGSENT(@15),X'2F'                                 1342 06075000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/ 06076000
         L     @15,@PC00001                                        1343 06077000
         ST    @15,@AL00001                                        1343 06078000
         LA    @14,@CF00117                                        1343 06079000
         ST    @14,@AL00001+4                                      1343 06080000
         LA    @14,DDSTRU                                          1343 06081000
         ST    @14,@AL00001+8                                      1343 06082000
         MVI   @AL00001+8,X'80'                                    1343 06083000
         L     @15,GDTPRT(,@15)                                    1343 06084000
         LA    @01,@AL00001                                        1343 06085000
         BALR  @14,@15                                             1343 06086000
*     END;                          /*                       @Y30LB33*/ 06087000
*                                                                  1345 06088000
*   /*****************************************************************/ 06089000
*   /*                                                               */ 06090000
*   /* SET UP ARGUMENTS TO ACTIVATE VOLUME                   @Y30LB33*/ 06091000
*   /* IF THE VOLUME IS INACTIVE                             @Y30LB33*/ 06092000
*   /*                                                               */ 06093000
*   /*****************************************************************/ 06094000
*                                                                  1345 06095000
*   IF INACTSW=ON THEN                                             1345 06096000
@RC01328 TM    INACTSW,B'00000100'                                 1345 06097000
         BNO   @RF01345                                            1345 06098000
*     DO;                           /*                       @Y30LB33*/ 06099000
*       DEFLIST=DEFLIST&&DEFLIST;   /*                       @Y30LB33*/ 06100000
         L     @15,DEFVPTR                                         1347 06101000
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1347 06102000
*       DEFVACT=ON;                 /*                       @Y30LB33*/ 06103000
         OI    DEFVACT(@15),B'00000010'                            1348 06104000
*       DEFVCSN1=BASCSN1;           /*                       @Y30LB33*/ 06105000
*                                                                  1349 06106000
         MVC   DEFVCSN1(12,@15),BASCSN1(BASEVPTR)                  1349 06107000
*       /*************************************************************/ 06108000
*       /*                                                           */ 06109000
*       /* DUMP ACTIVATE ARGUMENT LIST                       @Y30LB33*/ 06110000
*       /*                                                           */ 06111000
*       /*************************************************************/ 06112000
*                                                                  1350 06113000
*       IF GDTDBG=NULLPTR THEN                                     1350 06114000
         L     @15,@PC00001                                        1350 06115000
         L     @15,GDTDBG(,@15)                                    1350 06116000
         LTR   @15,@15                                             1350 06117000
         BZ    @RT01350                                            1350 06118000
*         ;                                                        1351 06119000
*       ELSE                                                       1352 06120000
*         DO;                                                      1352 06121000
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB33*/ 06122000
         LA    DMPINDEX,DUMPAREA                                   1353 06123000
*           DMPITMNM='DEFLIST';                                    1354 06124000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1354 06125000
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       1354 06126000
*           DMPITMPT=ADDR(DEFLIST);                                1355 06127000
         L     @03,DEFVPTR                                         1355 06128000
         ST    @03,DMPITMPT(,DMPINDEX)                             1355 06129000
*           DMPITMLN=LENGTH(DEFLIST);                              1356 06130000
         MVC   DMPITMLN(2,DMPINDEX),@CH01836                       1356 06131000
*           DMPITMTP='H';                                          1357 06132000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1357 06133000
*           DMPINDEX=DMPINDEX+DMPELEMT;/*                    @Y30LB33*/ 06134000
         AL    DMPINDEX,@CF00507                                   1358 06135000
*           DMPTRM=DMPTRMVL;                                       1359 06136000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1359 06137000
*         END;                      /*                       @Y30LB33*/ 06138000
*       IF GDTDBG=NULLPTR THEN                                     1361 06139000
@RT01350 L     @15,@PC00001                                        1361 06140000
         L     @15,GDTDBG(,@15)                                    1361 06141000
         LTR   @15,@15                                             1361 06142000
         BZ    @RT01361                                            1361 06143000
*         ;                                                        1362 06144000
*       ELSE                                                       1363 06145000
*         CALL IDCDB010(GDTTBL,'MVTB',DUMPADDR);/*           @Y30LB33*/ 06146000
*                                                                  1363 06147000
         L     @15,@PC00001                                        1363 06148000
         ST    @15,@AL00001                                        1363 06149000
         LA    @14,@CC01778                                        1363 06150000
         ST    @14,@AL00001+4                                      1363 06151000
         LA    @14,DUMPADDR                                        1363 06152000
         ST    @14,@AL00001+8                                      1363 06153000
         MVI   @AL00001+8,X'80'                                    1363 06154000
         L     @15,GDTDBG(,@15)                                    1363 06155000
         LA    @01,@AL00001                                        1363 06156000
         BALR  @14,@15                                             1363 06157000
*       /*************************************************************/ 06158000
*       /*                                                           */ 06159000
*       /* ISSUE USSC TO ACTIVATE VOLUME                     @Y30LB33*/ 06160000
*       /*                                                           */ 06161000
*       /*************************************************************/ 06162000
*                                                                  1364 06163000
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*     1364 06164000
*                                                            @Y30LB33*/ 06165000
@RT01361 L     @02,@PC00001                                        1364 06166000
         ST    @02,@AL00001                                        1364 06167000
         LA    @15,DEFINE                                          1364 06168000
         ST    @15,@AL00001+4                                      1364 06169000
         LA    @15,DEFVPTR                                         1364 06170000
         ST    @15,@AL00001+8                                      1364 06171000
         LA    @15,RCAREA                                          1364 06172000
         ST    @15,@AL00001+12                                     1364 06173000
         LA    @15,ECBBYTE                                         1364 06174000
         ST    @15,@AL00001+16                                     1364 06175000
         MVI   @AL00001+16,X'80'                                   1364 06176000
         L     @15,GDTSSC(,@02)                                    1364 06177000
         LA    @01,@AL00001                                        1364 06178000
         BALR  @14,@15                                             1364 06179000
*       RESPECIFY                                                  1365 06180000
*         RTNREG RSTD;                                             1365 06181000
*       TESTRC=RTNREG;                                             1366 06182000
         LR    TESTRC,RTNREG                                       1366 06183000
*       RESPECIFY                                                  1367 06184000
*         RTNREG UNRSTD;            /*                       @Y30LB33*/ 06185000
*                                                                  1367 06186000
*       /*************************************************************/ 06187000
*       /*                                                           */ 06188000
*       /* IF THE ACTIVATE FAILED, CALL SSCMSG TO PRINT      @Y30LB33*/ 06189000
*       /* THE REASON AND THEN PRINT IDC2075I TO INDICATE    @Y30LB33*/ 06190000
*       /* THAT THE ACTIVATE FAILED                          @Y30LB33*/ 06191000
*       /*                                                           */ 06192000
*       /*************************************************************/ 06193000
*                                                                  1368 06194000
*       IF TESTRC=4|TESTRC=8 THEN                                  1368 06195000
         C     TESTRC,@CF00043                                     1368 06196000
         BE    @RT01368                                            1368 06197000
         C     TESTRC,@CF00035                                     1368 06198000
         BNE   @RF01368                                            1368 06199000
@RT01368 DS    0H                                                  1369 06200000
*         DO;                       /*                       @Y30LB33*/ 06201000
*           IF TESTRC=4 THEN        /*                       @Y30LB33*/ 06202000
         C     TESTRC,@CF00043                                     1370 06203000
         BNE   @RF01370                                            1370 06204000
*             CALL SSCMSG(RCAREA,ECBBYTE);/*                 @Y30LB33*/ 06205000
         LA    @15,RCAREA                                          1371 06206000
         ST    @15,@AL00001                                        1371 06207000
         LA    @15,ECBBYTE                                         1371 06208000
         ST    @15,@AL00001+4                                      1371 06209000
         LA    @01,@AL00001                                        1371 06210000
         BAL   @14,SSCMSG                                          1371 06211000
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/ 06212000
@RF01370 L     @15,DDSTRU                                          1372 06213000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1372 06214000
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/ 06215000
         MVC   DARGSMOD(3,@15),MODCMN                              1373 06216000
*           DARGSENT=MSG2075I;      /*                       @Y30LB33*/ 06217000
         MVI   DARGSENT(@15),X'1F'                                 1374 06218000
*           DARGDBP=ADDR(MVVOLUME); /*                       @Y30LB33*/ 06219000
         LA    @14,MVVOLUME                                        1375 06220000
         ST    @14,DARGDBP(,@15)                                   1375 06221000
*           DARGILP=LENGTH(MVVOLUME);/*                      @Y30LB33*/ 06222000
         MVC   DARGILP(2,@15),@CH00159                             1376 06223000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/ 06224000
         L     @15,@PC00001                                        1377 06225000
         ST    @15,@AL00001                                        1377 06226000
         LA    @14,@CF00117                                        1377 06227000
         ST    @14,@AL00001+4                                      1377 06228000
         LA    @14,DDSTRU                                          1377 06229000
         ST    @14,@AL00001+8                                      1377 06230000
         MVI   @AL00001+8,X'80'                                    1377 06231000
         L     @15,GDTPRT(,@15)                                    1377 06232000
         LA    @01,@AL00001                                        1377 06233000
         BALR  @14,@15                                             1377 06234000
*         END;                      /*                       @Y30LB33*/ 06235000
*                                                                  1378 06236000
*       /*************************************************************/ 06237000
*       /*                                                           */ 06238000
*       /* AND IF THE ACTIVATE WENT WELL,                    @Y30LB33*/ 06239000
*       /* TURN OFF THE INACTIVE SWITCH                      @Y30LB33*/ 06240000
*       /*                                                           */ 06241000
*       /*************************************************************/ 06242000
*                                                                  1379 06243000
*       ELSE                                                       1379 06244000
*         INACTSW=OFF;              /*                       @Y30LB33*/ 06245000
         B     @RC01368                                            1379 06246000
@RF01368 NI    INACTSW,B'11111011'                                 1379 06247000
*     END;                          /*                       @Y30LB33*/ 06248000
*                                                                  1380 06249000
@RC01368 DS    0H                                                  1381 06250000
*   /*****************************************************************/ 06251000
*   /*                                                               */ 06252000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 06253000
*   /*                                                               */ 06254000
*   /*****************************************************************/ 06255000
*                                                                  1381 06256000
*   REG14=BACKSV;                   /*                       @Y30LB33*/ 06257000
@RF01345 L     REG14,BACKSV                                        1381 06258000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 06259000
         SLR   @15,@15                                             1382 06260000
@EL00021 DS    0H                                                  1382 06261000
@EF00021 DS    0H                                                  1382 06262000
@ER00021 BR    @14                                                 1382 06263000
*   END BACKOUT;                    /*                       @Y30LB33*/ 06264000
*                                                                  1384 06265000
*/********************************************************   @Y30LB33*/ 06266000
*/* PROCEDURE NAME - BLDLIST                                 @Y30LB33*/ 06267000
*/*                                                          @Y30LB33*/ 06268000
*/* FUNCTION - TO BUILD THE PARAMETER LISTS TO               @Y30LB33*/ 06269000
*/*    CHANGE THE VOLUME AND TO BACKOUT THE                  @Y30LB33*/ 06270000
*/*    CHANGES IF AN ERROR OCCURS                            @Y30LB33*/ 06271000
*/*                                                          @Y30LB33*/ 06272000
*/*    THE FOLLOWING ROUTINES ARE CALLED                     @Y30LB33*/ 06273000
*/*            BLDEXT                                        @Y30LB33*/ 06274000
*/*                                                          @Y30LB33*/ 06275000
*/* INPUT - THE FDTTBL, SWCHBITS, VOLUME                     @Y30LB33*/ 06276000
*/*    RECORD AND THE GROUP RECORD                           @Y30LB33*/ 06277000
*/*                                                          @Y30LB33*/ 06278000
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/ 06279000
*/********************************************************   @Y30LB33*/ 06280000
*                                                                  1384 06281000
*BLDLIST:                                                          1384 06282000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 06283000
*                                                                  1384 06284000
BLDLIST  DS    0H                                                  1385 06285000
*   /*****************************************************************/ 06286000
*   /*                                                               */ 06287000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 06288000
*   /*                                                               */ 06289000
*   /*****************************************************************/ 06290000
*                                                                  1385 06291000
*   DCL                                                            1385 06292000
*     BLDLSV PTR(31);               /*                       @Y30LB33*/ 06293000
*   BLDLSV=REG14;                   /*                       @Y30LB33*/ 06294000
         ST    REG14,BLDLSV                                        1386 06295000
*   OLDERID2=NEWERID2;                                             1387 06296000
         L     @15,@PC00001                                        1387 06297000
         L     @15,GDTTR2(,@15)                                    1387 06298000
         MVC   @TS00001(95),NEWERID2(@15)                          1387 06299000
         MVC   OLDERID2(95,@15),@TS00001                           1387 06300000
*   NEWID2='MVUA';                  /*                       @Y30LB33*/ 06301000
         MVC   NEWID2(4,@15),@CC01783                              1388 06302000
*   MVDEFLST=MVDEFLST&&MVDEFLST;    /*                       @Y30LB33*/ 06303000
*                                                                  1389 06304000
         XC    MVDEFLST(132),MVDEFLST                              1389 06305000
*   /*****************************************************************/ 06306000
*   /*                                                               */ 06307000
*   /* PUT THE VOLUME SERIAL INTO THE LIST                   @Y30LB33*/ 06308000
*   /*                                                               */ 06309000
*   /*****************************************************************/ 06310000
*                                                                  1390 06311000
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB33*/ 06312000
*                                                                  1390 06313000
         L     @15,DEFVPTR                                         1390 06314000
         L     @14,@PC00001+4                                      1390 06315000
         L     @01,FDTPTR(,@14)                                    1390 06316000
         MVC   DEFVOLD(6,@15),VOLVAL(@01)                          1390 06317000
*   /*****************************************************************/ 06318000
*   /*                                                               */ 06319000
*   /* IF WE ARE RELABELING,                                 @Y30LB33*/ 06320000
*   /*                                                               */ 06321000
*   /*****************************************************************/ 06322000
*                                                                  1391 06323000
*   IF RENAMSW=ON THEN                                             1391 06324000
         TM    RENAMSW,B'01000000'                                 1391 06325000
         BNO   @RF01391                                            1391 06326000
*     DO;                           /*                       @Y30LB33*/ 06327000
*       DEFVRNM=ON;                 /* CHANGE AN ACTIVE VOLUME     1393 06328000
*                                                            @Y30LB33*/ 06329000
         OI    DEFVRNM(@15),B'00100000'                            1393 06330000
*       DEFVNVOL=MVVOLUME;          /* SET SERIAL NUMBER     @Y30LB33*/ 06331000
*                                                                  1394 06332000
         MVC   DEFVNVOL(6,@15),MVVOLUME                            1394 06333000
*       /*************************************************************/ 06334000
*       /*                                                           */ 06335000
*       /* SET UP OWNER UPDATE                               @Y30LB33*/ 06336000
*       /*                                                           */ 06337000
*       /*************************************************************/ 06338000
*                                                                  1395 06339000
*       IF ADDR(NOWN)>0 THEN        /* IF NULLING OWNER      @Y30LB33*/ 06340000
         L     @14,FDTPTR+72(,@14)                                 1395 06341000
         LTR   @14,@14                                             1395 06342000
         BNP   @RF01395                                            1395 06343000
*         DEFOWNID=MVBLANKS;        /* MAKE IT BLANK         @Y30LB33*/ 06344000
         MVI   DEFOWNID+10(@15),C' '                               1396 06345000
         MVC   DEFOWNID+11(3,@15),DEFOWNID+10(@15)                 1396 06346000
         MVC   DEFOWNID(10,@15),@CC01575                           1396 06347000
*       IF ADDR(OWNER)>0 THEN       /* IF CHANGING OWNER     @Y30LB33*/ 06348000
@RF01395 L     @15,@PC00001+4                                      1397 06349000
         L     @15,FDTPTR+8(,@15)                                  1397 06350000
         LTR   @15,@15                                             1397 06351000
         BNP   @RF01397                                            1397 06352000
*         DEFOWNID=OWNERVAL;        /* PUT IN THE VALUE      @Y30LB33*/ 06353000
         L     @01,DEFVPTR                                         1398 06354000
         MVI   DEFOWNID+10(@01),C' '                               1398 06355000
         MVC   DEFOWNID+11(3,@01),DEFOWNID+10(@01)                 1398 06356000
         MVC   DEFOWNID(10,@01),OWNERVAL(@15)                      1398 06357000
*     END;                          /*                       @Y30LB33*/ 06358000
*                                                                  1399 06359000
@RF01397 DS    0H                                                  1400 06360000
*   /*****************************************************************/ 06361000
*   /*                                                               */ 06362000
*   /* IF WE ARE CHANGING ATTRIBUTES ,                       @Y30LB33*/ 06363000
*   /* AND WE ARE NOT RELABELING,                            @Y30LB33*/ 06364000
*   /* THEN SET UP TO CHANGE ATTRIBUTES ONLY                 @Y30LB33*/ 06365000
*   /*                                                               */ 06366000
*   /*****************************************************************/ 06367000
*                                                                  1400 06368000
*   IF(ATTRSW=ON|COPYATTR=ON|ONLYONLY=ON)/*                  @Y30LB33*/ 06369000
*       &RENAMSW=OFF                /* IF NO RELABELING      @Y30LB33*/ 06370000
*     THEN                                                         1400 06371000
@RF01391 TM    ATTRSW,B'00100010'                                  1400 06372000
         BNZ   @GL00109                                            1400 06373000
         TM    ONLYONLY,B'10000000'                                1400 06374000
         BNO   @RF01400                                            1400 06375000
@GL00109 TM    RENAMSW,B'01000000'                                 1400 06376000
         BNZ   @RF01400                                            1400 06377000
*     DEFVREP=ON;                   /* CHANGE ATTR ONLY      @Y30LB33*/ 06378000
*                                                                  1401 06379000
         L     @01,DEFVPTR                                         1401 06380000
         OI    DEFVREP(@01),B'00010000'                            1401 06381000
*   /*****************************************************************/ 06382000
*   /*                                                               */ 06383000
*   /* SET ATTRIBUTES USING THE VOLUME RECORD, THE           @Y30LB33*/ 06384000
*   /* GROUP RECORD, AND THE FDTTBL, OVERRIDING EACH         @Y30LB33*/ 06385000
*   /* OTHER IN THAT ORDER. FIRST, SET UP THE VOLUME         @Y30LB33*/ 06386000
*   /* ATTRIBUTES AS THEY ARE IN THE RECORD, UNLESS          @Y30LB33*/ 06387000
*   /* THE GROUP RECORD ATTRIBUTES ARE BEING COPIED.         @Y30LB33*/ 06388000
*   /* IF THEY ARE BEING COPIED, USE THE GROUP               @Y30LB33*/ 06389000
*   /* ATTRIBUTES                                            @Y30LB33*/ 06390000
*   /*                                                               */ 06391000
*   /*****************************************************************/ 06392000
*                                                                  1402 06393000
*   IF                              /*                       @Y30LB33*/ 06394000
*                                                                  1402 06395000
*   /*****************************************************************/ 06396000
*   /*                                                               */ 06397000
*   /* IF WE ARE COPYING FROM THE GROUP                      @Y30LB33*/ 06398000
*   /* SET REQUEST BLOCK FROM THE GROUP                      @Y30LB33*/ 06399000
*   /*                                                               */ 06400000
*   /*****************************************************************/ 06401000
*                                                                  1402 06402000
*       COPYATTR=ON|(ONLYONLY=ON&RENAMSW=OFF) THEN                 1402 06403000
@RF01400 TM    COPYATTR,B'00000010'                                1402 06404000
         BO    @RT01402                                            1402 06405000
         TM    ONLYONLY,B'10000000'                                1402 06406000
         BNO   @RF01402                                            1402 06407000
         TM    RENAMSW,B'01000000'                                 1402 06408000
         BNZ   @RF01402                                            1402 06409000
@RT01402 DS    0H                                                  1403 06410000
*     DO;                           /*                       @Y30LB33*/ 06411000
*       IF GROEXCL=ON THEN                                         1404 06412000
         TM    GROEXCL(GROUPPTR),B'01000000'                       1404 06413000
         BNO   @RF01404                                            1404 06414000
*         DEFVEXCL=ON;              /*                       @Y30LB33*/ 06415000
         L     @01,DEFVPTR                                         1405 06416000
         OI    DEFVEXCL(@01),B'00010000'                           1405 06417000
*       IF GROBIND=ON THEN                                         1406 06418000
@RF01404 TM    GROBIND(GROUPPTR),B'10000000'                       1406 06419000
         BNO   @RF01406                                            1406 06420000
*         DEFVBIND=ON;              /*                       @Y30LB33*/ 06421000
         L     @01,DEFVPTR                                         1407 06422000
         OI    DEFVBIND(@01),B'00000100'                           1407 06423000
*       IF GRODAERA=ON THEN                                        1408 06424000
@RF01406 TM    GRODAERA(GROUPPTR),B'00100000'                      1408 06425000
         BNO   @RF01408                                            1408 06426000
*         DEFVSEC=ON;               /*                       @Y30LB33*/ 06427000
         L     @01,DEFVPTR                                         1409 06428000
         OI    DEFVSEC(@01),B'00100000'                            1409 06429000
*       IF GRORONLY=ON THEN                                        1410 06430000
@RF01408 TM    GRORONLY(GROUPPTR),B'00010000'                      1410 06431000
         BNO   @RF01410                                            1410 06432000
*         DEFVWINH=ON;              /*                       @Y30LB33*/ 06433000
         L     @01,DEFVPTR                                         1411 06434000
         OI    DEFVWINH(@01),B'00000010'                           1411 06435000
*     END;                          /*                       @Y30LB33*/ 06436000
*                                                                  1412 06437000
*   /*****************************************************************/ 06438000
*   /*                                                               */ 06439000
*   /* OTHERWISE, SET THE REQUEST BLOCK FROM                 @Y30LB33*/ 06440000
*   /* THE VOLUME RECORD                                     @Y30LB33*/ 06441000
*   /*                                                               */ 06442000
*   /*****************************************************************/ 06443000
*                                                                  1413 06444000
*   ELSE                                                           1413 06445000
*     DO;                           /*                       @Y30LB33*/ 06446000
         B     @RC01402                                            1413 06447000
@RF01402 DS    0H                                                  1414 06448000
*       IF BASEXCL=ON THEN                                         1414 06449000
         TM    BASEXCL(BASEVPTR),B'00000001'                       1414 06450000
         BNO   @RF01414                                            1414 06451000
*         DEFVEXCL=ON;              /*                       @Y30LB33*/ 06452000
         L     @01,DEFVPTR                                         1415 06453000
         OI    DEFVEXCL(@01),B'00010000'                           1415 06454000
*       IF BASBIND=ON THEN                                         1416 06455000
@RF01414 TM    BASBIND(BASEVPTR),B'00000010'                       1416 06456000
         BNO   @RF01416                                            1416 06457000
*         DEFVBIND=ON;              /*                       @Y30LB33*/ 06458000
         L     @01,DEFVPTR                                         1417 06459000
         OI    DEFVBIND(@01),B'00000100'                           1417 06460000
*       IF BASDAERA=ON THEN                                        1418 06461000
@RF01416 TM    BASDAERA(BASEVPTR),B'10000000'                      1418 06462000
         BNO   @RF01418                                            1418 06463000
*         DEFVSEC=ON;               /*                       @Y30LB33*/ 06464000
         L     @01,DEFVPTR                                         1419 06465000
         OI    DEFVSEC(@01),B'00100000'                            1419 06466000
*       IF BASRONLY=ON THEN                                        1420 06467000
@RF01418 TM    BASRONLY(BASEVPTR),B'01000000'                      1420 06468000
         BNO   @RF01420                                            1420 06469000
*         DEFVWINH=ON;              /*                       @Y30LB33*/ 06470000
         L     @01,DEFVPTR                                         1421 06471000
         OI    DEFVWINH(@01),B'00000010'                           1421 06472000
*     END;                          /*                       @Y30LB33*/ 06473000
*                                                                  1422 06474000
@RF01420 DS    0H                                                  1423 06475000
*   /*****************************************************************/ 06476000
*   /*                                                               */ 06477000
*   /* IF WE ARE RELABELING, TURN OFF THE                    @Y30LB33*/ 06478000
*   /* READONLY FLAG                                         @Y30LB33*/ 06479000
*   /*                                                               */ 06480000
*   /*****************************************************************/ 06481000
*                                                                  1423 06482000
*   IF RENAMSW=ON THEN                                             1423 06483000
@RC01402 TM    RENAMSW,B'01000000'                                 1423 06484000
         BNO   @RF01423                                            1423 06485000
*     DEFVWINH=OFF;                 /*                       @Y30LB33*/ 06486000
*                                                                  1424 06487000
         L     @01,DEFVPTR                                         1424 06488000
         NI    DEFVWINH(@01),B'11111101'                           1424 06489000
*   /*****************************************************************/ 06490000
*   /*                                                               */ 06491000
*   /* THEN OVERRIDE THE VOLUME RECORD OR GROUP              @Y30LB33*/ 06492000
*   /* RECORD ATTRIBUTES WITH THE USER REQUEST               @Y30LB33*/ 06493000
*   /*                                                               */ 06494000
*   /*****************************************************************/ 06495000
*                                                                  1425 06496000
*   IF ATTRSW=ON THEN                                              1425 06497000
@RF01423 TM    ATTRSW,B'00100000'                                  1425 06498000
         BNO   @RF01425                                            1425 06499000
*     DO;                           /*                       @Y30LB33*/ 06500000
*       IF ADDR(EXECL)>NULLPTR THEN                                1427 06501000
         L     @15,@PC00001+4                                      1427 06502000
         L     @15,FDTPTR+32(,@15)                                 1427 06503000
         LTR   @15,@15                                             1427 06504000
         BNP   @RF01427                                            1427 06505000
*         DEFVEXCL=ON;              /*                       @Y30LB33*/ 06506000
         L     @01,DEFVPTR                                         1428 06507000
         OI    DEFVEXCL(@01),B'00010000'                           1428 06508000
*       IF ADDR(BIND)>NULLPTR THEN                                 1429 06509000
@RF01427 L     @15,@PC00001+4                                      1429 06510000
         L     @15,FDTPTR+24(,@15)                                 1429 06511000
         LTR   @15,@15                                             1429 06512000
         BNP   @RF01429                                            1429 06513000
*         DEFVBIND=ON;              /*                       @Y30LB33*/ 06514000
         L     @01,DEFVPTR                                         1430 06515000
         OI    DEFVBIND(@01),B'00000100'                           1430 06516000
*       IF ADDR(DERAS)>NULLPTR THEN                                1431 06517000
@RF01429 L     @15,@PC00001+4                                      1431 06518000
         L     @15,FDTPTR+48(,@15)                                 1431 06519000
         LTR   @15,@15                                             1431 06520000
         BNP   @RF01431                                            1431 06521000
*         DEFVSEC=ON;               /*                       @Y30LB33*/ 06522000
         L     @01,DEFVPTR                                         1432 06523000
         OI    DEFVSEC(@01),B'00100000'                            1432 06524000
*       IF ADDR(RONLY)>NULLPTR&RENAMSW=OFF THEN                    1433 06525000
@RF01431 L     @15,@PC00001+4                                      1433 06526000
         L     @15,FDTPTR+40(,@15)                                 1433 06527000
         LTR   @15,@15                                             1433 06528000
         BNP   @RF01433                                            1433 06529000
         TM    RENAMSW,B'01000000'                                 1433 06530000
         BNZ   @RF01433                                            1433 06531000
*         DEFVWINH=ON;              /*                       @Y30LB33*/ 06532000
         L     @01,DEFVPTR                                         1434 06533000
         OI    DEFVWINH(@01),B'00000010'                           1434 06534000
*       IF ADDR(SHRD)>NULLPTR THEN                                 1435 06535000
@RF01433 L     @15,@PC00001+4                                      1435 06536000
         L     @15,FDTPTR+36(,@15)                                 1435 06537000
         LTR   @15,@15                                             1435 06538000
         BNP   @RF01435                                            1435 06539000
*         DEFVEXCL=OFF;             /*                       @Y30LB33*/ 06540000
         L     @01,DEFVPTR                                         1436 06541000
         NI    DEFVEXCL(@01),B'11101111'                           1436 06542000
*       IF ADDR(NBIND)>NULLPTR THEN                                1437 06543000
@RF01435 L     @15,@PC00001+4                                      1437 06544000
         L     @15,FDTPTR+28(,@15)                                 1437 06545000
         LTR   @15,@15                                             1437 06546000
         BNP   @RF01437                                            1437 06547000
*         DEFVBIND=OFF;             /*                       @Y30LB33*/ 06548000
         L     @01,DEFVPTR                                         1438 06549000
         NI    DEFVBIND(@01),B'11111011'                           1438 06550000
*       IF ADDR(NDERS)>NULLPTR THEN                                1439 06551000
@RF01437 L     @15,@PC00001+4                                      1439 06552000
         L     @15,FDTPTR+52(,@15)                                 1439 06553000
         LTR   @15,@15                                             1439 06554000
         BNP   @RF01439                                            1439 06555000
*         DEFVSEC=OFF;              /*                       @Y30LB33*/ 06556000
         L     @01,DEFVPTR                                         1440 06557000
         NI    DEFVSEC(@01),B'11011111'                            1440 06558000
*       IF ADDR(RW)>NULLPTR THEN                                   1441 06559000
@RF01439 L     @15,@PC00001+4                                      1441 06560000
         L     @15,FDTPTR+44(,@15)                                 1441 06561000
         LTR   @15,@15                                             1441 06562000
         BNP   @RF01441                                            1441 06563000
*         DEFVWINH=OFF;             /*                       @Y30LB33*/ 06564000
         L     @01,DEFVPTR                                         1442 06565000
         NI    DEFVWINH(@01),B'11111101'                           1442 06566000
*     END;                          /*                       @Y30LB33*/ 06567000
*                                                                  1443 06568000
@RF01441 DS    0H                                                  1444 06569000
*   /*****************************************************************/ 06570000
*   /*                                                               */ 06571000
*   /* SET THE ATTRIBUTES ASIDE FOR USE LATER                @Y30LB33*/ 06572000
*   /* WHEN WE HAVE TO HAVE THEM AGAIN FOR                   @Y30LB33*/ 06573000
*   /* SETTING THE READONLY ATTRIBUTE AFTER                  @Y30LB33*/ 06574000
*   /* RELABELING                                            @Y30LB33*/ 06575000
*   /*                                                               */ 06576000
*   /*****************************************************************/ 06577000
*                                                                  1444 06578000
*   MYVVFLG=DEFVVFLG;               /*                       @Y30LB33*/ 06579000
*                                                                  1444 06580000
@RF01425 L     @01,DEFVPTR                                         1444 06581000
         MVC   MYVVFLG(1),DEFVVFLG(@01)                            1444 06582000
*   /*****************************************************************/ 06583000
*   /*                                                               */ 06584000
*   /* IF WE HAVE TO UPDATE THE INVENTORY BECAUSE OF         @Y30LB33*/ 06585000
*   /* INVENTORY-TYPE CHANGES OR SETTING THE MISMATCH        @Y30LB33*/ 06586000
*   /* DUE TO A NEW SERIAL, PUT THE EXTENSION LIST           @Y30LB33*/ 06587000
*   /* ADDRESS INTO THE DEFINE PARAMETER LIST.               @Y30LB33*/ 06588000
*   /*                                                               */ 06589000
*   /*****************************************************************/ 06590000
*                                                                  1445 06591000
*   IF MSVCSW=ON|ADDR(NEWSR)>0 THEN /*                       @Y30LB33*/ 06592000
         TM    MSVCSW,B'00010000'                                  1445 06593000
         BO    @RT01445                                            1445 06594000
         L     @15,@PC00001+4                                      1445 06595000
         L     @15,FDTPTR+4(,@15)                                  1445 06596000
         LTR   @15,@15                                             1445 06597000
         BNP   @RF01445                                            1445 06598000
@RT01445 DS    0H                                                  1446 06599000
*     DEFVVEXT=DEFVEPTR;            /*                       @Y30LB33*/ 06600000
         L     @01,DEFVPTR                                         1446 06601000
         ST    DEFVEPTR,DEFVVEXT(,@01)                             1446 06602000
*   IF ATTRSW=OFF&                  /* IF USER IS NOT CHANGING     1447 06603000
*                                                            @Y30LB33   06604000
*                                      THE ATTRIBUTES        @Y30LB33*/ 06605000
*       COPYATTR=OFF&               /* AND THE ATTRIBUTES ARE NOT  1447 06606000
*                                                            @Y30LB33   06607000
*                                      CHANGING TO AGREE WITH A    1447 06608000
*                                                            @Y30LB33   06609000
*                                      GROUP                 @Y30LB33*/ 06610000
*       (ONLYONLY=OFF|              /* OR THE READONLY ATTR  @Y30LB33   06611000
*                                      IS NOT BEING COPIED   @Y30LB33*/ 06612000
*       RENAMSW=ON)                 /* OR WE ARE UPDATING LABEL    1447 06613000
*                                                            @Y30LB33*/ 06614000
*     THEN                                                         1447 06615000
@RF01445 TM    ATTRSW,B'00100010'                                  1447 06616000
         BNZ   @RF01447                                            1447 06617000
         TM    ONLYONLY,B'10000000'                                1447 06618000
         BZ    @RT01447                                            1447 06619000
         TM    RENAMSW,B'01000000'                                 1447 06620000
         BNO   @RF01447                                            1447 06621000
@RT01447 DS    0H                                                  1448 06622000
*     DEFVVFLG='FF'X;               /* SET ATTR LIST NULL    @Y30LB33*/ 06623000
*                                                                  1448 06624000
         L     @01,DEFVPTR                                         1448 06625000
         MVI   DEFVVFLG(@01),X'FF'                                 1448 06626000
*   /*****************************************************************/ 06627000
*   /*                                                               */ 06628000
*   /* IF WE ARE RELABELING, WE MUST BUILD THE BACKOUT       @Y30LB33*/ 06629000
*   /* PARAMETER LIST                                        @Y30LB33*/ 06630000
*   /*                                                               */ 06631000
*   /*****************************************************************/ 06632000
*                                                                  1449 06633000
*   IF RENAMSW=ON THEN                                             1449 06634000
@RF01447 TM    RENAMSW,B'01000000'                                 1449 06635000
         BNO   @RF01449                                            1449 06636000
*     DO;                           /*                       @Y30LB33*/ 06637000
*       BKDEFLST=BKDEFLST&&BKDEFLST;/*                       @Y30LB33*/ 06638000
         XC    BKDEFLST(132),BKDEFLST                              1451 06639000
*       DEFVPTR=ADDR(BKDEFLST);     /* BASE THE BACKOUT      @Y30LB33*/ 06640000
         LA    @15,BKDEFLST                                        1452 06641000
         ST    @15,DEFVPTR                                         1452 06642000
*       DEFVEPTR=ADDR(BKDEFVE);     /* PARAMETER AREAS       @Y30LB33*/ 06643000
         LA    DEFVEPTR,BKDEFVE                                    1453 06644000
*       DEFLIST=DEFLIST&&DEFLIST;   /* CLEAR THE             @Y30LB33*/ 06645000
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1454 06646000
*       DEFVE=DEFVE&&DEFVE;         /* AREAS                 @Y30LB33*/ 06647000
         XC    DEFVE(64,DEFVEPTR),DEFVE(DEFVEPTR)                  1455 06648000
*       DEFVNVOL=VOLVAL;            /* SET UP VOLSER         @Y30LB33*/ 06649000
         L     @14,@PC00001+4                                      1456 06650000
         L     @01,FDTPTR(,@14)                                    1456 06651000
         MVC   DEFVNVOL(6,@15),VOLVAL(@01)                         1456 06652000
*       DEFVOLD=MVVOLUME;           /*                       @Y30LB33*/ 06653000
         MVC   DEFVOLD(6,@15),MVVOLUME                             1457 06654000
*       IF ADDR(NOWN)>0|ADDR(OWNER)>0/*                      @Y30LB33*/ 06655000
*         THEN                                                     1458 06656000
         SLR   @15,@15                                             1458 06657000
         C     @15,FDTPTR+72(,@14)                                 1458 06658000
         BL    @RT01458                                            1458 06659000
         C     @15,FDTPTR+8(,@14)                                  1458 06660000
         BNL   @RF01458                                            1458 06661000
@RT01458 DS    0H                                                  1459 06662000
*         DEFOWNID=BASOWNER;        /* SET UP THE            @Y30LB33   06663000
*                                      OWNER FIELD IF IT WILL      1459 06664000
*                                                            @Y30LB33   06665000
*                                      CHANGE                @Y30LB33*/ 06666000
*                                                                  1459 06667000
         L     @01,DEFVPTR                                         1459 06668000
         MVI   DEFOWNID+10(@01),C' '                               1459 06669000
         MVC   DEFOWNID+11(3,@01),DEFOWNID+10(@01)                 1459 06670000
         MVC   DEFOWNID(10,@01),BASOWNER(BASEVPTR)                 1459 06671000
*       /*************************************************************/ 06672000
*       /*                                                           */ 06673000
*       /* IF THE ATTRIBUTES ARE CHANGING, SET               @Y30LB33*/ 06674000
*       /* THEM UP AS THEY ARE IN THE VOLUME RECORD          @Y30LB33*/ 06675000
*       /*                                                           */ 06676000
*       /*************************************************************/ 06677000
*                                                                  1460 06678000
*       IF ATTRSW=ON|COPYATTR=ON THEN                              1460 06679000
@RF01458 TM    ATTRSW,B'00100010'                                  1460 06680000
         BZ    @RF01460                                            1460 06681000
*         DO;                       /*                       @Y30LB33*/ 06682000
*           IF BASEXCL=ON THEN                                     1462 06683000
         TM    BASEXCL(BASEVPTR),B'00000001'                       1462 06684000
         BNO   @RF01462                                            1462 06685000
*             DEFVEXCL=ON;          /*                       @Y30LB33*/ 06686000
         L     @01,DEFVPTR                                         1463 06687000
         OI    DEFVEXCL(@01),B'00010000'                           1463 06688000
*           IF BASBIND=ON THEN                                     1464 06689000
@RF01462 TM    BASBIND(BASEVPTR),B'00000010'                       1464 06690000
         BNO   @RF01464                                            1464 06691000
*             DEFVBIND=ON;          /*                       @Y30LB33*/ 06692000
         L     @01,DEFVPTR                                         1465 06693000
         OI    DEFVBIND(@01),B'00000100'                           1465 06694000
*           IF BASDAERA=ON THEN                                    1466 06695000
@RF01464 TM    BASDAERA(BASEVPTR),B'10000000'                      1466 06696000
         BNO   @RF01466                                            1466 06697000
*             DEFVSEC=ON;           /*                       @Y30LB33*/ 06698000
         L     @01,DEFVPTR                                         1467 06699000
         OI    DEFVSEC(@01),B'00100000'                            1467 06700000
*           IF BASRONLY=ON THEN                                    1468 06701000
@RF01466 TM    BASRONLY(BASEVPTR),B'01000000'                      1468 06702000
         BNO   @RF01468                                            1468 06703000
*             DEFVWINH=ON;          /*                       @Y30LB33*/ 06704000
         L     @01,DEFVPTR                                         1469 06705000
         OI    DEFVWINH(@01),B'00000010'                           1469 06706000
*         END;                      /*                       @Y30LB33*/ 06707000
*                                                                  1470 06708000
*       /*************************************************************/ 06709000
*       /*                                                           */ 06710000
*       /* AND IF THEY ARE NOT CHANGING, SET THAT            @Y30LB33*/ 06711000
*       /* UP WITH THE NULL INDICATOR                        @Y30LB33*/ 06712000
*       /*                                                           */ 06713000
*       /*************************************************************/ 06714000
*                                                                  1471 06715000
*       ELSE                                                       1471 06716000
*         DEFVVFLG='FF'X;           /*                       @Y30LB33*/ 06717000
*                                                                  1471 06718000
         B     @RC01460                                            1471 06719000
@RF01460 L     @01,DEFVPTR                                         1471 06720000
         MVI   DEFVVFLG(@01),X'FF'                                 1471 06721000
*       /*************************************************************/ 06722000
*       /*                                                           */ 06723000
*       /* IF WE ARE CHANGING THE MSVC RECORD OR             @Y30LB33*/ 06724000
*       /* RELABELING AND MUST SET MISMATCH FLAG,            @Y30LB33*/ 06725000
*       /* SET UP THE EXTENSION LIST ADDR                    @Y30LB33*/ 06726000
*       /*                                                           */ 06727000
*       /*************************************************************/ 06728000
*                                                                  1472 06729000
*       IF MSVCSW=ON|ADDR(NEWSR)>0 THEN/*                    @Y30LB33*/ 06730000
@RC01460 TM    MSVCSW,B'00010000'                                  1472 06731000
         BO    @RT01472                                            1472 06732000
         L     @15,@PC00001+4                                      1472 06733000
         L     @15,FDTPTR+4(,@15)                                  1472 06734000
         LTR   @15,@15                                             1472 06735000
         BNP   @RF01472                                            1472 06736000
@RT01472 DS    0H                                                  1473 06737000
*         DEFVVEXT=DEFVEPTR;        /*                       @Y30LB33*/ 06738000
         L     @01,DEFVPTR                                         1473 06739000
         ST    DEFVEPTR,DEFVVEXT(,@01)                             1473 06740000
*                                                                  1474 06741000
*       /*************************************************************/ 06742000
*       /*                                                           */ 06743000
*       /* NOW RESTORE THE POINTERS TO THE LISTS             @Y30LB33*/ 06744000
*       /* TO BE USED FOR THE CHANGE                         @Y30LB33*/ 06745000
*       /*                                                           */ 06746000
*       /*************************************************************/ 06747000
*                                                                  1474 06748000
*       DEFVEPTR=ADDR(MVDEFVE);     /*                       @Y30LB33*/ 06749000
@RF01472 LA    DEFVEPTR,MVDEFVE                                    1474 06750000
*       DEFVPTR=ADDR(MVDEFLST);     /*                       @Y30LB33*/ 06751000
         LA    @15,MVDEFLST                                        1475 06752000
         ST    @15,DEFVPTR                                         1475 06753000
*     END;                          /*                       @Y30LB33*/ 06754000
*                                                                  1476 06755000
*   /*****************************************************************/ 06756000
*   /*                                                               */ 06757000
*   /* IF MSVC IS CHANGING OR WE ARE RE-SERIALLING,          @Y30LB33*/ 06758000
*   /* BUILD THE EXTENSION PARAMETER LIST BY                 @Y30LB33*/ 06759000
*   /* CALLING BLDEXT                                        @Y30LB33*/ 06760000
*   /*                                                               */ 06761000
*   /*****************************************************************/ 06762000
*                                                                  1477 06763000
*   IF MSVCSW=ON|ADDR(NEWSR)>0 THEN /*                       @Y30LB33*/ 06764000
@RF01449 TM    MSVCSW,B'00010000'                                  1477 06765000
         BO    @RT01477                                            1477 06766000
         L     @15,@PC00001+4                                      1477 06767000
         L     @15,FDTPTR+4(,@15)                                  1477 06768000
         LTR   @15,@15                                             1477 06769000
         BNP   @RF01477                                            1477 06770000
@RT01477 DS    0H                                                  1478 06771000
*     CALL BLDEXT;                  /*                       @Y30LB33*/ 06772000
*                                                                  1478 06773000
         BAL   @14,BLDEXT                                          1478 06774000
*   /*****************************************************************/ 06775000
*   /*                                                               */ 06776000
*   /* DUMP ARGUMENT LIST AND BACKOUT LIST                   @Y30LB33*/ 06777000
*   /*                                                               */ 06778000
*   /*****************************************************************/ 06779000
*                                                                  1479 06780000
*   IF GDTDBG=NULLPTR THEN                                         1479 06781000
@RF01477 L     @15,@PC00001                                        1479 06782000
         L     @15,GDTDBG(,@15)                                    1479 06783000
         LTR   @15,@15                                             1479 06784000
         BZ    @RT01479                                            1479 06785000
*     ;                                                            1480 06786000
*   ELSE                                                           1481 06787000
*     DO;                                                          1481 06788000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 06789000
         LA    DMPINDEX,DUMPAREA                                   1482 06790000
*       DMPITMNM='DEFLIST';                                        1483 06791000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1483 06792000
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       1483 06793000
*       DMPITMPT=ADDR(DEFLIST);                                    1484 06794000
         L     @03,DEFVPTR                                         1484 06795000
         ST    @03,DMPITMPT(,DMPINDEX)                             1484 06796000
*       DMPITMLN=LENGTH(DEFLIST);                                  1485 06797000
         LA    @03,132                                             1485 06798000
         STH   @03,DMPITMLN(,DMPINDEX)                             1485 06799000
*       DMPITMTP='H';                                              1486 06800000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1486 06801000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/ 06802000
         LA    @15,16                                              1487 06803000
         ALR   DMPINDEX,@15                                        1487 06804000
*       DMPITMNM='BKDEFLST';                                       1488 06805000
         MVC   DMPITMNM(8,DMPINDEX),@CC01785                       1488 06806000
*       DMPITMPT=ADDR(BKDEFLST);                                   1489 06807000
         LA    @14,BKDEFLST                                        1489 06808000
         ST    @14,DMPITMPT(,DMPINDEX)                             1489 06809000
*       DMPITMLN=LENGTH(BKDEFLST);                                 1490 06810000
         STH   @03,DMPITMLN(,DMPINDEX)                             1490 06811000
*       ;                                                          1491 06812000
*       DMPITMTP='H';                                              1492 06813000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1492 06814000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/ 06815000
         ALR   DMPINDEX,@15                                        1493 06816000
*       DMPTRM=DMPTRMVL;                                           1494 06817000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1494 06818000
*     END;                          /*                       @Y30LB33*/ 06819000
*   IF GDTDBG=NULLPTR THEN                                         1496 06820000
@RT01479 L     @15,@PC00001                                        1496 06821000
         L     @15,GDTDBG(,@15)                                    1496 06822000
         LTR   @15,@15                                             1496 06823000
         BZ    @RT01496                                            1496 06824000
*     ;                                                            1497 06825000
*   ELSE                                                           1498 06826000
*     CALL IDCDB010(GDTTBL,'MVUB',DUMPADDR);/*               @Y30LB33*/ 06827000
*                                                                  1498 06828000
         L     @15,@PC00001                                        1498 06829000
         ST    @15,@AL00001                                        1498 06830000
         LA    @14,@CC01786                                        1498 06831000
         ST    @14,@AL00001+4                                      1498 06832000
         LA    @14,DUMPADDR                                        1498 06833000
         ST    @14,@AL00001+8                                      1498 06834000
         MVI   @AL00001+8,X'80'                                    1498 06835000
         L     @15,GDTDBG(,@15)                                    1498 06836000
         LA    @01,@AL00001                                        1498 06837000
         BALR  @14,@15                                             1498 06838000
*   /*****************************************************************/ 06839000
*   /*                                                               */ 06840000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 06841000
*   /*                                                               */ 06842000
*   /*****************************************************************/ 06843000
*                                                                  1499 06844000
*   REG14=BLDLSV;                   /*                       @Y30LB33*/ 06845000
@RT01496 L     REG14,BLDLSV                                        1499 06846000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 06847000
         SLR   @15,@15                                             1500 06848000
@EL00022 DS    0H                                                  1500 06849000
@EF00022 DS    0H                                                  1500 06850000
@ER00022 BR    @14                                                 1500 06851000
*   END BLDLIST;                    /*                       @Y30LB33*/ 06852000
*                                                                  1502 06853000
*/********************************************************   @Y30LB33*/ 06854000
*/* PROCEDURE NAME - BLDEXT                                  @Y30LB33*/ 06855000
*/*                                                          @Y30LB33*/ 06856000
*/* FUNCTION - BUILDS THE MODIFY EXTENSION                   @Y30LB33*/ 06857000
*/*    LIST TO UPDATE INVENTORY RECORDS DURING               @Y30LB33*/ 06858000
*/*    MODIFICATION OF THE VOLUME                            @Y30LB33*/ 06859000
*/*                                                          @Y30LB33*/ 06860000
*/* INPUT - FDTTBL, SWCHBITS, AND THE VOLUME                 @Y30LB33*/ 06861000
*/*    RECORD                                                @Y30LB33*/ 06862000
*/*                                                          @Y30LB33*/ 06863000
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/ 06864000
*/********************************************************   @Y30LB33*/ 06865000
*                                                                  1502 06866000
*BLDEXT:                                                           1502 06867000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 06868000
*                                                                  1502 06869000
BLDEXT   DS    0H                                                  1503 06870000
*   /*****************************************************************/ 06871000
*   /*                                                               */ 06872000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 06873000
*   /*                                                               */ 06874000
*   /*****************************************************************/ 06875000
*                                                                  1503 06876000
*   DCL                                                            1503 06877000
*     BLDESV PTR(31);               /*                       @Y30LB33*/ 06878000
*   BLDESV=REG14;                   /*                       @Y30LB33*/ 06879000
         LR    BLDESV,REG14                                        1504 06880000
*   OLDERID2=NEWERID2;                                             1505 06881000
         L     @02,@PC00001                                        1505 06882000
         L     @02,GDTTR2(,@02)                                    1505 06883000
         MVC   @TS00001(95),NEWERID2(@02)                          1505 06884000
         MVC   OLDERID2(95,@02),@TS00001                           1505 06885000
*   NEWID2='MVVA';                  /*                       @Y30LB33*/ 06886000
         MVC   NEWID2(4,@02),@CC01791                              1506 06887000
*   MVDEFVE=MVDEFVE&&MVDEFVE;       /*                       @Y30LB33*/ 06888000
         XC    MVDEFVE(64),MVDEFVE                                 1507 06889000
*   DEFLNGTH=DEFLEN;                /*                       @Y30LB33*/ 06890000
*                                                                  1508 06891000
         LH    @02,DEFLEN                                          1508 06892000
         ST    @02,DEFLNGTH(,DEFVEPTR)                             1508 06893000
*   /*****************************************************************/ 06894000
*   /*                                                               */ 06895000
*   /* IF THE USER SAYS NULL THE GROUP, AND THE              @Y30LB33*/ 06896000
*   /* VOLUME IS GROUPED, INDICATE NO GROUP                  @Y30LB33*/ 06897000
*   /*                                                               */ 06898000
*   /*****************************************************************/ 06899000
*                                                                  1509 06900000
*   IF ADDR(NGRP)>0&BASGRPV=ON      /*                       @Y30LB33*/ 06901000
*     THEN                                                         1509 06902000
         L     @02,@PC00001+4                                      1509 06903000
         L     @02,FDTPTR+76(,@02)                                 1509 06904000
         LTR   @02,@02                                             1509 06905000
         BNP   @RF01509                                            1509 06906000
         TM    BASGRPV(BASEVPTR),B'00100000'                       1509 06907000
         BNO   @RF01509                                            1509 06908000
*     DEFNGRP=ON;                   /*                       @Y30LB33*/ 06909000
*                                                                  1510 06910000
         OI    DEFNGRP(DEFVEPTR),B'10000000'                       1510 06911000
*   /*****************************************************************/ 06912000
*   /*                                                               */ 06913000
*   /* IF THE USER SAYS GROUP THE VOLUME, THEN               @Y30LB33*/ 06914000
*   /* INDICATE THE GROUP                                    @Y30LB33*/ 06915000
*   /*                                                               */ 06916000
*   /*****************************************************************/ 06917000
*                                                                  1511 06918000
*   IF ADDR(GRP)>0 THEN                                            1511 06919000
@RF01509 L     @02,@PC00001+4                                      1511 06920000
         L     @02,FDTPTR+12(,@02)                                 1511 06921000
         LTR   @02,@02                                             1511 06922000
         BNP   @RF01511                                            1511 06923000
*     DO;                           /*                       @Y30LB33*/ 06924000
*       DEFPGRO=ON;                 /*                       @Y30LB33*/ 06925000
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       1513 06926000
*       DEFGROUP=GRPVAL;            /*                       @Y30LB33*/ 06927000
         MVC   DEFGROUP(8,DEFVEPTR),GRPVAL(@02)                    1514 06928000
*       DEFNGRP=OFF;                /*                       @Y30LB33*/ 06929000
         NI    DEFNGRP(DEFVEPTR),B'01111111'                       1515 06930000
*     END;                          /*                       @Y30LB33*/ 06931000
*                                                                  1516 06932000
*   /*****************************************************************/ 06933000
*   /*                                                               */ 06934000
*   /* SET UP TO CHANGE OR NULLIFY THE DESCRIPTION           @Y30LB33*/ 06935000
*   /* IF BOTH NULL AND UPDATE ASKED, OVERLAY NULL           @Y30LB33*/ 06936000
*   /*                                                               */ 06937000
*   /*****************************************************************/ 06938000
*                                                                  1517 06939000
*   IF ADDR(NDESC)>0 THEN                                          1517 06940000
@RF01511 L     @02,@PC00001+4                                      1517 06941000
         L     @02,FDTPTR+80(,@02)                                 1517 06942000
         LTR   @02,@02                                             1517 06943000
         BNP   @RF01517                                            1517 06944000
*     DEFNDESC=ON;                  /*                       @Y30LB33*/ 06945000
         OI    DEFNDESC(DEFVEPTR),B'01000000'                      1518 06946000
*   IF ADDR(DESCR)>0 THEN                                          1519 06947000
@RF01517 L     @02,@PC00001+4                                      1519 06948000
         L     @02,FDTPTR+56(,@02)                                 1519 06949000
         LTR   @02,@02                                             1519 06950000
         BNP   @RF01519                                            1519 06951000
*     DO;                           /*                       @Y30LB33*/ 06952000
*       DEFPDESC=ON;                /*                       @Y30LB33*/ 06953000
         OI    DEFPDESC(DEFVEPTR),B'00010000'                      1521 06954000
*       DEFNDESC=OFF;               /*                       @Y30LB33*/ 06955000
         NI    DEFNDESC(DEFVEPTR),B'10111111'                      1522 06956000
*       DEFDESCR=DESCRVAL;          /*                       @Y30LB33*/ 06957000
         MVC   DEFDESCR(30,DEFVEPTR),DESCRVAL(@02)                 1523 06958000
*     END;                          /*                       @Y30LB33*/ 06959000
*                                                                  1524 06960000
*   /*****************************************************************/ 06961000
*   /*                                                               */ 06962000
*   /* SET UP TO CHANGE EXPIRATION OR RETENTION              @Y30LB33*/ 06963000
*   /* IF BOTH NULL AND UPDATE ASKED, OVERLAY NULL           @Y30LB33*/ 06964000
*   /*                                                               */ 06965000
*   /*****************************************************************/ 06966000
*                                                                  1525 06967000
*   IF ADDR(NRET)>0 THEN                                           1525 06968000
@RF01519 L     @02,@PC00001+4                                      1525 06969000
         L     @02,FDTPTR+84(,@02)                                 1525 06970000
         LTR   @02,@02                                             1525 06971000
         BNP   @RF01525                                            1525 06972000
*     DEFNEXPD=ON;                  /*                       @Y30LB33*/ 06973000
         OI    DEFNEXPD(DEFVEPTR),B'00100000'                      1526 06974000
*   IF ADDR(TO)>0 THEN                                             1527 06975000
@RF01525 L     @02,@PC00001+4                                      1527 06976000
         L     @02,FDTPTR+60(,@02)                                 1527 06977000
         LTR   @02,@02                                             1527 06978000
         BNP   @RF01527                                            1527 06979000
*     DO;                           /*                       @Y30LB33*/ 06980000
*       DEFPTO=ON;                  /*                       @Y30LB33*/ 06981000
         OI    DEFPTO(DEFVEPTR),B'00001000'                        1529 06982000
*       DEFNEXPD=OFF;               /*                       @Y30LB33*/ 06983000
         NI    DEFNEXPD(DEFVEPTR),B'11011111'                      1530 06984000
*       CVD(TOVAL,DEFTO);           /*                       @Y30LB33*/ 06985000
         L     @02,TOVAL(,@02)                                     1531 06986000
         CVD   @02,@TS00001                                        1531 06987000
         MVC   DEFTO(4,DEFVEPTR),@TS00001+4                        1531 06988000
*     END;                          /*                       @Y30LB33*/ 06989000
*   IF ADDR(FORE)>0 THEN                                           1533 06990000
@RF01527 L     @02,@PC00001+4                                      1533 06991000
         L     @02,FDTPTR+96(,@02)                                 1533 06992000
         LTR   @02,@02                                             1533 06993000
         BNP   @RF01533                                            1533 06994000
*     DO;                           /*                       @Y30LB33*/ 06995000
*       DEFPFOR=ON;                 /*                       @Y30LB33*/ 06996000
         OI    DEFPFOR(DEFVEPTR),B'10000000'                       1535 06997000
*       DEFNEXPD=OFF;               /*                       @Y30LB33*/ 06998000
         NI    DEFNEXPD(DEFVEPTR),B'11011111'                      1536 06999000
*       DEFFOR=FOREVAL;             /*                       @Y30LB33*/ 07000000
         L     @02,FOREVAL(,@02)                                   1537 07001000
         STH   @02,DEFFOR(,DEFVEPTR)                               1537 07002000
*     END;                          /*                       @Y30LB33*/ 07003000
*                                                                  1538 07004000
*   /*****************************************************************/ 07005000
*   /*                                                               */ 07006000
*   /* SET UP THE BACKUP NUMBER IF SPECIFIED                 @Y30LB33*/ 07007000
*   /*                                                               */ 07008000
*   /*****************************************************************/ 07009000
*                                                                  1539 07010000
*   IF ADDR(BKUP)>0 THEN                                           1539 07011000
@RF01533 L     @02,@PC00001+4                                      1539 07012000
         L     @02,FDTPTR+64(,@02)                                 1539 07013000
         LTR   @02,@02                                             1539 07014000
         BNP   @RF01539                                            1539 07015000
*     DO;                           /*                       @Y30LB33*/ 07016000
*       DEFPBKUP=ON;                /*                       @Y30LB33*/ 07017000
         OI    DEFPBKUP(DEFVEPTR),B'00000100'                      1541 07018000
*       DEFBKUPN=BKUPVAL;           /*                       @Y30LB33*/ 07019000
         MVC   DEFBKUPN(1,DEFVEPTR),BKUPVAL+3(@02)                 1542 07020000
*     END;                          /*                       @Y30LB33*/ 07021000
*                                                                  1543 07022000
*   /*****************************************************************/ 07023000
*   /*                                                               */ 07024000
*   /* SET UP FOR A SERIAL CHANGE AND MISMATCH               @Y30LB33*/ 07025000
*   /* IF THE VOLUME HAS NO MISMATCH NOW AND                 @Y30LB33*/ 07026000
*   /* WE ARE GOING TO UPDATE THE SERIAL NUMBER              @Y30LB33*/ 07027000
*   /*                                                               */ 07028000
*   /*****************************************************************/ 07029000
*                                                                  1544 07030000
*   IF BASVSMIS=OFF&ADDR(NEWSR)>0 THEN                             1544 07031000
@RF01539 TM    BASVSMIS(BASEVPTR),B'00100000'                      1544 07032000
         BNZ   @RF01544                                            1544 07033000
         L     @02,@PC00001+4                                      1544 07034000
         L     @15,FDTPTR+4(,@02)                                  1544 07035000
         LTR   @15,@15                                             1544 07036000
         BNP   @RF01544                                            1544 07037000
*     DO;                           /*                       @Y30LB33*/ 07038000
*       DEFLABEL=VOLVAL;            /*                       @Y30LB33*/ 07039000
         L     @02,FDTPTR(,@02)                                    1546 07040000
         MVC   DEFLABEL(6,DEFVEPTR),VOLVAL(@02)                    1546 07041000
*       DEFPVLAB=ON;                /*                       @Y30LB33*/ 07042000
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1547 07043000
*       DEFSRCVY=ON;                /*                       @Y30LB33*/ 07044000
         OI    DEFSRCVY(DEFVEPTR),B'10000000'                      1548 07045000
*       DEFLAMIS=ON;                /*                       @Y30LB33*/ 07046000
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1549 07047000
*     END;                          /*                       @Y30LB33*/ 07048000
*                                                                  1550 07049000
*   /*****************************************************************/ 07050000
*   /*                                                               */ 07051000
*   /* SET UP FOR GENERAL OR RESTRICTED CHANGE               @Y30LB33*/ 07052000
*   /*                                                               */ 07053000
*   /*****************************************************************/ 07054000
*                                                                  1551 07055000
*   IF NEWGENSW=ON THEN             /*                       @Y30LB33*/ 07056000
@RF01544 TM    NEWGENSW,B'00000100'                                1551 07057000
         BNO   @RF01551                                            1551 07058000
*     DEFGENUS=ON;                  /*                       @Y30LB33*/ 07059000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1552 07060000
*   IF ADDR(RSTR)>NULLPTR THEN                                     1553 07061000
@RF01551 L     @02,@PC00001+4                                      1553 07062000
         L     @02,FDTPTR+20(,@02)                                 1553 07063000
         LTR   @02,@02                                             1553 07064000
         BNP   @RF01553                                            1553 07065000
*     DEFRSTD=ON;                   /*                       @Y30LB33*/ 07066000
*                                                                  1554 07067000
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1554 07068000
*   /*****************************************************************/ 07069000
*   /*                                                               */ 07070000
*   /* IF WE ARE CHANGING THE LABEL, SET UP THE              @Y30LB33*/ 07071000
*   /* BACKOUT PARAMETER LIST                                @Y30LB33*/ 07072000
*   /*                                                               */ 07073000
*   /*****************************************************************/ 07074000
*                                                                  1555 07075000
*   IF RENAMSW=ON THEN                                             1555 07076000
@RF01553 TM    RENAMSW,B'01000000'                                 1555 07077000
         BNO   @RF01555                                            1555 07078000
*     DO;                           /*                       @Y30LB33*/ 07079000
*       DEFVEPTR=ADDR(BKDEFVE);     /* SET BASE              @Y30LB33*/ 07080000
         LA    DEFVEPTR,BKDEFVE                                    1557 07081000
*       BKDEFVE=BKDEFVE&&BKDEFVE;   /*                       @Y30LB33*/ 07082000
         XC    BKDEFVE(64),BKDEFVE                                 1558 07083000
*       DEFLNGTH=DEFLEN;            /*                       @YM02857*/ 07084000
*                                                                  1559 07085000
         LH    @02,DEFLEN                                          1559 07086000
         ST    @02,DEFLNGTH(,DEFVEPTR)                             1559 07087000
*       /*************************************************************/ 07088000
*       /*                                                           */ 07089000
*       /* SET UP NEW GROUP BACKOUT                          @Y30LB33*/ 07090000
*       /*                                                           */ 07091000
*       /*************************************************************/ 07092000
*                                                                  1560 07093000
*       IF(ADDR(NGRP)>0|ADDR(GRP)>0)&/*                      @Y30LB33*/ 07094000
*           BASGRPV=ON THEN                                        1560 07095000
         SLR   @02,@02                                             1560 07096000
         L     @15,@PC00001+4                                      1560 07097000
         C     @02,FDTPTR+76(,@15)                                 1560 07098000
         BL    @GL00122                                            1560 07099000
         C     @02,FDTPTR+12(,@15)                                 1560 07100000
         BNL   @RF01560                                            1560 07101000
@GL00122 TM    BASGRPV(BASEVPTR),B'00100000'                       1560 07102000
         BNO   @RF01560                                            1560 07103000
*         DO;                       /*                       @Y30LB33*/ 07104000
*           DEFPGRO=ON;             /*                       @Y30LB33*/ 07105000
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       1562 07106000
*           DEFGROUP=BASGROUP;      /*                       @Y30LB33*/ 07107000
         MVC   DEFGROUP(8,DEFVEPTR),BASGROUP(BASEVPTR)             1563 07108000
*         END;                      /*                       @Y30LB33*/ 07109000
*                                                                  1564 07110000
*       /*************************************************************/ 07111000
*       /*                                                           */ 07112000
*       /* SET UP TO NULL THE GROUP IN BACKOUT               @Y30LB33*/ 07113000
*       /*                                                           */ 07114000
*       /*************************************************************/ 07115000
*                                                                  1565 07116000
*       IF ADDR(GRP)>0&BASGRPV=OFF  /*                       @Y30LB33*/ 07117000
*         THEN                                                     1565 07118000
@RF01560 L     @02,@PC00001+4                                      1565 07119000
         L     @02,FDTPTR+12(,@02)                                 1565 07120000
         LTR   @02,@02                                             1565 07121000
         BNP   @RF01565                                            1565 07122000
         TM    BASGRPV(BASEVPTR),B'00100000'                       1565 07123000
         BNZ   @RF01565                                            1565 07124000
*         DEFNGRP=ON;               /*                       @Y30LB33*/ 07125000
*                                                                  1566 07126000
         OI    DEFNGRP(DEFVEPTR),B'10000000'                       1566 07127000
*       /*************************************************************/ 07128000
*       /*                                                           */ 07129000
*       /* SET UP BACKUP NUMBER BACKOUT                      @Y30LB33*/ 07130000
*       /*                                                           */ 07131000
*       /*************************************************************/ 07132000
*                                                                  1567 07133000
*       IF ADDR(BKUP)>0 THEN                                       1567 07134000
@RF01565 L     @02,@PC00001+4                                      1567 07135000
         L     @02,FDTPTR+64(,@02)                                 1567 07136000
         LTR   @02,@02                                             1567 07137000
         BNP   @RF01567                                            1567 07138000
*         DO;                       /*                       @Y30LB33*/ 07139000
*           DEFBKUPN=BASBKLMT;      /*                       @Y30LB33*/ 07140000
         MVC   DEFBKUPN(1,DEFVEPTR),BASBKLMT(BASEVPTR)             1569 07141000
*           DEFPBKUP=ON;            /*                       @Y30LB33*/ 07142000
         OI    DEFPBKUP(DEFVEPTR),B'00000100'                      1570 07143000
*         END;                      /*                       @Y30LB33*/ 07144000
*                                                                  1571 07145000
*       /*************************************************************/ 07146000
*       /*                                                           */ 07147000
*       /* SET UP DESCRIPTION BACKOUT                        @Y30LB33*/ 07148000
*       /*                                                           */ 07149000
*       /*************************************************************/ 07150000
*                                                                  1572 07151000
*       IF BASDESCR^=BLANK30&       /*                       @Y30LB33*/ 07152000
*           (ADDR(DESCR)>0|ADDR(NDESC)>0)/*                  @Y30LB33*/ 07153000
*         THEN                                                     1572 07154000
@RF01567 CLC   BASDESCR(30,BASEVPTR),BLANK30                       1572 07155000
         BE    @RF01572                                            1572 07156000
         SLR   @02,@02                                             1572 07157000
         L     @15,@PC00001+4                                      1572 07158000
         C     @02,FDTPTR+56(,@15)                                 1572 07159000
         BL    @RT01572                                            1572 07160000
         C     @02,FDTPTR+80(,@15)                                 1572 07161000
         BNL   @RF01572                                            1572 07162000
@RT01572 DS    0H                                                  1573 07163000
*         DO;                       /*                       @Y30LB33*/ 07164000
*           DEFDESCR=BASDESCR;      /*                       @Y30LB33*/ 07165000
         MVC   DEFDESCR(30,DEFVEPTR),BASDESCR(BASEVPTR)            1574 07166000
*           DEFPDESC=ON;            /*                       @Y30LB33*/ 07167000
         OI    DEFPDESC(DEFVEPTR),B'00010000'                      1575 07168000
*         END;                      /*                       @Y30LB33*/ 07169000
*       IF BASDESCR=BLANK30&        /*                       @Y30LB33*/ 07170000
*           ADDR(DESCR)>0 THEN                                     1577 07171000
@RF01572 CLC   BASDESCR(30,BASEVPTR),BLANK30                       1577 07172000
         BNE   @RF01577                                            1577 07173000
         L     @02,@PC00001+4                                      1577 07174000
         L     @02,FDTPTR+56(,@02)                                 1577 07175000
         LTR   @02,@02                                             1577 07176000
         BNP   @RF01577                                            1577 07177000
*         DEFNDESC=ON;              /*                       @Y30LB33*/ 07178000
*                                                                  1578 07179000
         OI    DEFNDESC(DEFVEPTR),B'01000000'                      1578 07180000
*       /*************************************************************/ 07181000
*       /*                                                           */ 07182000
*       /* SET UP THE RETENTION OR EXPIRATION BACKOUT        @Y30LB33*/ 07183000
*       /*                                                           */ 07184000
*       /*************************************************************/ 07185000
*                                                                  1579 07186000
*       IF                          /*                       @Y30LB33*/ 07187000
*                                                                  1579 07188000
*       /*************************************************************/ 07189000
*       /*                                                           */ 07190000
*       /* IF THE EXPIR DATE NOT NULL                        @Y30LB33*/ 07191000
*       /*                                                           */ 07192000
*       /*************************************************************/ 07193000
*                                                                  1579 07194000
*           BASEXPDT^=NULLEFFS&     /*                       @Y30LB33*/ 07195000
*                                                                  1579 07196000
*       /*************************************************************/ 07197000
*       /*                                                           */ 07198000
*       /* AND USER WANTS A CHANGE                           @Y30LB33*/ 07199000
*       /*                                                           */ 07200000
*       /*************************************************************/ 07201000
*                                                                  1579 07202000
*           (ADDR(TO)>0|ADDR(FORE)>0|ADDR(NRET)>0)/*         @Y30LB33*/ 07203000
*         THEN                                                     1579 07204000
@RF01577 CLC   BASEXPDT(4,BASEVPTR),NULLEFFS                       1579 07205000
         BE    @RF01579                                            1579 07206000
         SLR   @02,@02                                             1579 07207000
         L     @15,@PC00001+4                                      1579 07208000
         C     @02,FDTPTR+60(,@15)                                 1579 07209000
         BL    @RT01579                                            1579 07210000
         C     @02,FDTPTR+96(,@15)                                 1579 07211000
         BL    @RT01579                                            1579 07212000
         C     @02,FDTPTR+84(,@15)                                 1579 07213000
         BNL   @RF01579                                            1579 07214000
@RT01579 DS    0H                                                  1580 07215000
*         DO;                       /*                       @Y30LB33*/ 07216000
*                                                                  1580 07217000
*           /*********************************************************/ 07218000
*           /*                                                       */ 07219000
*           /* SET UP VALUE FROM VOL RECORD                  @Y30LB33*/ 07220000
*           /*                                                       */ 07221000
*           /*********************************************************/ 07222000
*                                                                  1581 07223000
*           DEFTO=BASEXPDT;         /*                       @Y30LB33*/ 07224000
         MVC   DEFTO(4,DEFVEPTR),BASEXPDT(BASEVPTR)                1581 07225000
*           DEFPTO=ON;              /*                       @Y30LB33*/ 07226000
         OI    DEFPTO(DEFVEPTR),B'00001000'                        1582 07227000
*         END;                      /*                       @Y30LB33*/ 07228000
*       IF                                                         1584 07229000
*                                                                  1584 07230000
*       /*************************************************************/ 07231000
*       /*                                                           */ 07232000
*       /* IF EXPDT IS NULL AND                              @Y30LB33*/ 07233000
*       /*                                                           */ 07234000
*       /*************************************************************/ 07235000
*                                                                  1584 07236000
*           BASEXPDT=NULLEFFS&      /*                       @Y30LB33*/ 07237000
*                                                                  1584 07238000
*       /*************************************************************/ 07239000
*       /*                                                           */ 07240000
*       /* USER WANTS A CHANGE                               @Y30LB33*/ 07241000
*       /*                                                           */ 07242000
*       /*************************************************************/ 07243000
*                                                                  1584 07244000
*           (ADDR(TO)>0|ADDR(FORE)>0|ADDR(NRET)>0)/*         @Y30LB33*/ 07245000
*                                                                  1584 07246000
*       /*************************************************************/ 07247000
*       /*                                                           */ 07248000
*       /* THEN WE NULL THE FIELD                            @Y30LB33*/ 07249000
*       /*                                                           */ 07250000
*       /*************************************************************/ 07251000
*                                                                  1584 07252000
*         THEN                                                     1584 07253000
@RF01579 CLC   BASEXPDT(4,BASEVPTR),NULLEFFS                       1584 07254000
         BNE   @RF01584                                            1584 07255000
         SLR   @02,@02                                             1584 07256000
         L     @15,@PC00001+4                                      1584 07257000
         C     @02,FDTPTR+60(,@15)                                 1584 07258000
         BL    @RT01584                                            1584 07259000
         C     @02,FDTPTR+96(,@15)                                 1584 07260000
         BL    @RT01584                                            1584 07261000
         C     @02,FDTPTR+84(,@15)                                 1584 07262000
         BNL   @RF01584                                            1584 07263000
@RT01584 DS    0H                                                  1585 07264000
*         DEFNEXPD=ON;              /*                       @Y30LB33*/ 07265000
*                                                                  1585 07266000
         OI    DEFNEXPD(DEFVEPTR),B'00100000'                      1585 07267000
*       /*************************************************************/ 07268000
*       /*                                                           */ 07269000
*       /* IF LABEL MISMATCH IS OFF IN THE VOLUME            @Y30LB33*/ 07270000
*       /* RECORD, THEN SET IT OFF IN THE BACKOUT            @Y30LB33*/ 07271000
*       /*                                                           */ 07272000
*       /*************************************************************/ 07273000
*                                                                  1586 07274000
*       IF BASVSMIS=OFF THEN                                       1586 07275000
@RF01584 TM    BASVSMIS(BASEVPTR),B'00100000'                      1586 07276000
         BNZ   @RF01586                                            1586 07277000
*         DO;                       /*                       @Y30LB33*/ 07278000
*           DEFLAMIS=ON;            /*                       @Y30LB33*/ 07279000
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1588 07280000
*           DEFCRCVY=ON;            /*                       @Y30LB33*/ 07281000
         OI    DEFCRCVY(DEFVEPTR),B'01000000'                      1589 07282000
*           DEFPVLAB=ON;            /*                       @Y30LB33*/ 07283000
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1590 07284000
*           DEFLABEL=MVBLANKS;      /*                       @Y30LB33*/ 07285000
         MVC   DEFLABEL(6,DEFVEPTR),@CC01575                       1591 07286000
*         END;                      /*                       @Y30LB33*/ 07287000
*                                                                  1592 07288000
*       /*************************************************************/ 07289000
*       /*                                                           */ 07290000
*       /* IF THE VOLUME IS GROUPED, SET UP THE BACKOUT      @Y30LB33*/ 07291000
*       /* ARGUMENT TO RESTORE THE VOLUME TO ITS GROUPED     @Y30LB33*/ 07292000
*       /* POSITION AND SET UP THE FLAGS TO RESTORE IT       @Y30LB33*/ 07293000
*       /* TO GENERAL OR RESTRICTED                          @Y30LB33*/ 07294000
*       /*                                                           */ 07295000
*       /*************************************************************/ 07296000
*                                                                  1593 07297000
*       IF BASGRPV=ON THEN          /*                       @ZA05148*/ 07298000
@RF01586 TM    BASGRPV(BASEVPTR),B'00100000'                       1593 07299000
         BNO   @RF01593                                            1593 07300000
*         DO;                       /*                       @ZA05148*/ 07301000
*           IF BASGENUS=ON THEN     /*                       @ZA05148*/ 07302000
         TM    BASGENUS(BASEVPTR),B'00010000'                      1595 07303000
         BNO   @RF01595                                            1595 07304000
*             DEFGENUS=ON;          /*                       @ZA05148*/ 07305000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1596 07306000
*           IF BASRSTD=ON THEN      /*                       @ZA05148*/ 07307000
@RF01595 TM    BASRSTD(BASEVPTR),B'00001000'                       1597 07308000
         BNO   @RF01597                                            1597 07309000
*             DEFRSTD=ON;           /*                       @ZA05148*/ 07310000
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1598 07311000
*         END;                      /*                       @ZA05148*/ 07312000
@RF01597 DS    0H                                                  1600 07313000
*     END;                          /*                       @Y30LB33*/ 07314000
*                                                                  1600 07315000
@RF01593 DS    0H                                                  1601 07316000
*   /*****************************************************************/ 07317000
*   /*                                                               */ 07318000
*   /* DUMP THE ARGUMENT LIST AND THE BACKOUT LIST           @Y30LB33*/ 07319000
*   /*                                                               */ 07320000
*   /*****************************************************************/ 07321000
*                                                                  1601 07322000
*   IF GDTDBG=NULLPTR THEN                                         1601 07323000
@RF01555 L     @05,@PC00001                                        1601 07324000
         L     @05,GDTDBG(,@05)                                    1601 07325000
         LTR   @05,@05                                             1601 07326000
         BZ    @RT01601                                            1601 07327000
*     ;                                                            1602 07328000
*   ELSE                                                           1603 07329000
*     DO;                                                          1603 07330000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 07331000
         LA    DMPINDEX,DUMPAREA                                   1604 07332000
*       DMPITMNM='MVDEFVE';                                        1605 07333000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1605 07334000
         MVC   DMPITMNM(7,DMPINDEX),@CC01793                       1605 07335000
*       DMPITMPT=ADDR(MVDEFVE);                                    1606 07336000
         LA    @05,MVDEFVE                                         1606 07337000
         ST    @05,DMPITMPT(,DMPINDEX)                             1606 07338000
*       DMPITMLN=LENGTH(DEFVE);                                    1607 07339000
         LA    @05,64                                              1607 07340000
         STH   @05,DMPITMLN(,DMPINDEX)                             1607 07341000
*       DMPITMTP='H';                                              1608 07342000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1608 07343000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1609 07344000
*                                                                  1609 07345000
         LA    @15,16                                              1609 07346000
         ALR   DMPINDEX,@15                                        1609 07347000
*       /*************************************************************/ 07348000
*       /*                                                           */ 07349000
*       /*                                                   @Y30LB33*/ 07350000
*       /*                                                           */ 07351000
*       /*************************************************************/ 07352000
*                                                                  1610 07353000
*       DMPITMNM='BKDEFVE';                                        1610 07354000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1610 07355000
         MVC   DMPITMNM(7,DMPINDEX),@CC01794                       1610 07356000
*       DMPITMPT=ADDR(BKDEFVE);                                    1611 07357000
         LA    @14,BKDEFVE                                         1611 07358000
         ST    @14,DMPITMPT(,DMPINDEX)                             1611 07359000
*       DMPITMLN=LENGTH(DEFVE);                                    1612 07360000
         STH   @05,DMPITMLN(,DMPINDEX)                             1612 07361000
*       DMPITMTP='H';                                              1613 07362000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1613 07363000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/ 07364000
         ALR   DMPINDEX,@15                                        1614 07365000
*       DMPTRM=DMPTRMVL;                                           1615 07366000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1615 07367000
*     END;                          /*                       @Y30LB33*/ 07368000
*   IF GDTDBG=NULLPTR THEN                                         1617 07369000
@RT01601 L     @05,@PC00001                                        1617 07370000
         L     @05,GDTDBG(,@05)                                    1617 07371000
         LTR   @05,@05                                             1617 07372000
         BZ    @RT01617                                            1617 07373000
*     ;                                                            1618 07374000
*   ELSE                                                           1619 07375000
*     CALL IDCDB010(GDTTBL,'MVVB',DUMPADDR);/*               @Y30LB33*/ 07376000
*                                                                  1619 07377000
         L     @05,@PC00001                                        1619 07378000
         ST    @05,@AL00001                                        1619 07379000
         LA    @02,@CC01795                                        1619 07380000
         ST    @02,@AL00001+4                                      1619 07381000
         LA    @02,DUMPADDR                                        1619 07382000
         ST    @02,@AL00001+8                                      1619 07383000
         MVI   @AL00001+8,X'80'                                    1619 07384000
         L     @15,GDTDBG(,@05)                                    1619 07385000
         LA    @01,@AL00001                                        1619 07386000
         BALR  @14,@15                                             1619 07387000
*   /*****************************************************************/ 07388000
*   /*                                                               */ 07389000
*   /* RESTORE POINTERS TO THE ADDRESSES OF THE              @Y30LB33*/ 07390000
*   /* LISTS OF THE ORIGINAL ARGUMENTS                       @Y30LB33*/ 07391000
*   /*                                                               */ 07392000
*   /*****************************************************************/ 07393000
*                                                                  1620 07394000
*   DEFVEPTR=ADDR(MVDEFVE);         /*                       @Y30LB33*/ 07395000
@RT01617 LA    DEFVEPTR,MVDEFVE                                    1620 07396000
*   DEFVPTR=ADDR(MVDEFLST);         /*                       @Y30LB33*/ 07397000
*                                                                  1621 07398000
         LA    @02,MVDEFLST                                        1621 07399000
         ST    @02,DEFVPTR                                         1621 07400000
*   /*****************************************************************/ 07401000
*   /*                                                               */ 07402000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 07403000
*   /*                                                               */ 07404000
*   /*****************************************************************/ 07405000
*                                                                  1622 07406000
*   REG14=BLDESV;                   /*                       @Y30LB33*/ 07407000
         LR    REG14,BLDESV                                        1622 07408000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 07409000
         SLR   @15,@15                                             1623 07410000
@EL00023 DS    0H                                                  1623 07411000
@EF00023 DS    0H                                                  1623 07412000
@ER00023 BR    @14                                                 1623 07413000
*   END BLDEXT;                     /*                       @Y30LB33*/ 07414000
*                                                                  1625 07415000
*/********************************************************   @Y30LB33*/ 07416000
*/* PROCEDURE NAME - BLDMVR                                  @Y30LB33*/ 07417000
*/*                                                          @Y30LB33*/ 07418000
*/* FUNCTION - TO BUILD THE PARAMETERS LIST FOR              @Y30LB33*/ 07419000
*/*    MODIFYING MSVC VOLUME RECORDS ONLY                    @Y30LB33*/ 07420000
*/*                                                          @Y30LB33*/ 07421000
*/* INPUT - THE FDTTBL, SWCHBITS, AND THE VOLUME             @Y30LB33*/ 07422000
*/*    RECORD                                                @Y30LB33*/ 07423000
*/*                                                          @Y30LB33*/ 07424000
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/ 07425000
*/********************************************************   @Y30LB33*/ 07426000
*                                                                  1625 07427000
*BLDMVR:                                                           1625 07428000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/ 07429000
*                                                                  1625 07430000
BLDMVR   DS    0H                                                  1626 07431000
*   /*****************************************************************/ 07432000
*   /*                                                               */ 07433000
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/ 07434000
*   /*                                                               */ 07435000
*   /*****************************************************************/ 07436000
*                                                                  1626 07437000
*   DCL                                                            1626 07438000
*     BLDMSV PTR(31);               /*                       @Y30LB33*/ 07439000
*   BLDMSV=REG14;                   /*                       @Y30LB33*/ 07440000
         LR    BLDMSV,REG14                                        1627 07441000
*   OLDERID2=NEWERID2;                                             1628 07442000
         L     @02,@PC00001                                        1628 07443000
         L     @02,GDTTR2(,@02)                                    1628 07444000
         MVC   @TS00001(95),NEWERID2(@02)                          1628 07445000
         MVC   OLDERID2(95,@02),@TS00001                           1628 07446000
*   NEWID2='MVWA';                  /*                       @Y30LB33*/ 07447000
         MVC   NEWID2(4,@02),@CC01800                              1629 07448000
*   MVR=MVR&&MVR;                   /*                       @Y30LB33*/ 07449000
         L     @02,MVRPTR                                          1630 07450000
         XC    MVR(88,@02),MVR(@02)                                1630 07451000
*   MVRCODE=MVROP;                  /*                       @Y30LB33*/ 07452000
         XC    MVRCODE+1(3,@02),MVRCODE+1(@02)                     1631 07453000
         MVI   MVRCODE(@02),X'85'                                  1631 07454000
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB33*/ 07455000
         LH    @15,MVRLEN                                          1632 07456000
         ST    @15,MVRLNGTH(,@02)                                  1632 07457000
*   MVRBVOL=VOLVAL;                 /*                       @Y30LB33*/ 07458000
         L     @15,@PC00001+4                                      1633 07459000
         L     @01,FDTPTR(,@15)                                    1633 07460000
         MVC   MVRBVOL(6,@02),VOLVAL(@01)                          1633 07461000
*   MVRFLBAS=ON;                    /*                       @Y30LB33*/ 07462000
*                                                                  1634 07463000
         OI    MVRFLBAS(@02),B'00100000'                           1634 07464000
*   /*****************************************************************/ 07465000
*   /*                                                               */ 07466000
*   /* SET UP THE RETENTION OR EXPIRATION CHANGES            @Y30LB33*/ 07467000
*   /* IF BOTH NULL AND UPDATE ASKED, OVERRIDE NULL          @Y30LB33*/ 07468000
*   /*                                                               */ 07469000
*   /*****************************************************************/ 07470000
*                                                                  1635 07471000
*   IF ADDR(NRET)>0 THEN                                           1635 07472000
         L     @15,FDTPTR+84(,@15)                                 1635 07473000
         LTR   @15,@15                                             1635 07474000
         BNP   @RF01635                                            1635 07475000
*     MVRNEXPD=ON;                  /*                       @Y30LB33*/ 07476000
         OI    MVRNEXPD(@02),B'00000100'                           1636 07477000
*   IF ADDR(TO)>0 THEN                                             1637 07478000
@RF01635 L     @02,@PC00001+4                                      1637 07479000
         L     @02,FDTPTR+60(,@02)                                 1637 07480000
         LTR   @02,@02                                             1637 07481000
         BNP   @RF01637                                            1637 07482000
*     DO;                           /*                       @Y30LB33*/ 07483000
*       CVD(TOVAL,MVRTO);           /*                       @Y30LB33*/ 07484000
         L     @02,TOVAL(,@02)                                     1639 07485000
         L     @15,MVRPTR                                          1639 07486000
         CVD   @02,@TS00001                                        1639 07487000
         MVC   MVRTO(4,@15),@TS00001+4                             1639 07488000
*       MVRFLTO=ON;                 /*                       @Y30LB33*/ 07489000
         OI    MVRFLTO(@15),B'00001000'                            1640 07490000
*       MVRNEXPD=OFF;               /*                       @Y30LB33*/ 07491000
         NI    MVRNEXPD(@15),B'11111011'                           1641 07492000
*     END;                          /*                       @Y30LB33*/ 07493000
*   IF ADDR(FORE)>0 THEN                                           1643 07494000
@RF01637 L     @02,@PC00001+4                                      1643 07495000
         L     @02,FDTPTR+96(,@02)                                 1643 07496000
         LTR   @02,@02                                             1643 07497000
         BNP   @RF01643                                            1643 07498000
*     DO;                           /*                       @Y30LB33*/ 07499000
*       MVRFLFOR=ON;                /*                       @Y30LB33*/ 07500000
         L     @15,MVRPTR                                          1645 07501000
         OI    MVRFLFOR(@15),B'10000000'                           1645 07502000
*       MVRFOR=FOREVAL;             /*                       @Y30LB33*/ 07503000
         L     @02,FOREVAL(,@02)                                   1646 07504000
         STH   @02,MVRFOR(,@15)                                    1646 07505000
*       MVRNEXPD=OFF;               /*                       @Y30LB33*/ 07506000
         NI    MVRNEXPD(@15),B'11111011'                           1647 07507000
*     END;                          /*                       @Y30LB33*/ 07508000
*                                                                  1648 07509000
*   /*****************************************************************/ 07510000
*   /*                                                               */ 07511000
*   /* SET UP ANY GROUP CHANGE                               @Y30LB33*/ 07512000
*   /* IF BOTH NULL AND UPDATE ASKED, OVERRIDE NULL          @Y30LB33*/ 07513000
*   /*                                                               */ 07514000
*   /*****************************************************************/ 07515000
*                                                                  1649 07516000
*   IF ADDR(NGRP)>0 THEN                                           1649 07517000
@RF01643 L     @02,@PC00001+4                                      1649 07518000
         L     @02,FDTPTR+76(,@02)                                 1649 07519000
         LTR   @02,@02                                             1649 07520000
         BNP   @RF01649                                            1649 07521000
*     MVRNGRP=ON;                   /*                       @Y30LB33*/ 07522000
         L     @02,MVRPTR                                          1650 07523000
         OI    MVRNGRP(@02),B'00100000'                            1650 07524000
*   IF ADDR(GRP)>0 THEN                                            1651 07525000
@RF01649 L     @02,@PC00001+4                                      1651 07526000
         L     @02,FDTPTR+12(,@02)                                 1651 07527000
         LTR   @02,@02                                             1651 07528000
         BNP   @RF01651                                            1651 07529000
*     DO;                           /*                       @Y30LB33*/ 07530000
*       MVRGROUP=GRPVAL;            /*                       @Y30LB33*/ 07531000
         L     @15,MVRPTR                                          1653 07532000
         MVC   MVRGROUP(8,@15),GRPVAL(@02)                         1653 07533000
*       MVRFLGRO=ON;                /*                       @Y30LB33*/ 07534000
         OI    MVRFLGRO(@15),B'01000000'                           1654 07535000
*       MVRNGRP=OFF;                /*                       @Y30LB33*/ 07536000
         NI    MVRNGRP(@15),B'11011111'                            1655 07537000
*     END;                          /*                       @Y30LB33*/ 07538000
*                                                                  1656 07539000
*   /*****************************************************************/ 07540000
*   /*                                                               */ 07541000
*   /* SET UP DESCRIPTION CHANGES                            @Y30LB33*/ 07542000
*   /* IF BOTH NULL AND UPDATE ASKED, OVERRIDE NULL          @Y30LB33*/ 07543000
*   /*                                                               */ 07544000
*   /*****************************************************************/ 07545000
*                                                                  1657 07546000
*   IF ADDR(NDESC)>0 THEN                                          1657 07547000
@RF01651 L     @02,@PC00001+4                                      1657 07548000
         L     @02,FDTPTR+80(,@02)                                 1657 07549000
         LTR   @02,@02                                             1657 07550000
         BNP   @RF01657                                            1657 07551000
*     MVRNDESC=ON;                  /*                       @Y30LB33*/ 07552000
         L     @02,MVRPTR                                          1658 07553000
         OI    MVRNDESC(@02),B'00001000'                           1658 07554000
*   IF ADDR(DESCR)>0 THEN                                          1659 07555000
@RF01657 L     @02,@PC00001+4                                      1659 07556000
         L     @02,FDTPTR+56(,@02)                                 1659 07557000
         LTR   @02,@02                                             1659 07558000
         BNP   @RF01659                                            1659 07559000
*     DO;                           /*                       @Y30LB33*/ 07560000
*       MVRDES=DESCRVAL;            /*                       @Y30LB33*/ 07561000
         L     @15,MVRPTR                                          1661 07562000
         MVC   MVRDES(30,@15),DESCRVAL(@02)                        1661 07563000
*       MVRFLDES=ON;                /*                       @Y30LB33*/ 07564000
         OI    MVRFLDES(@15),B'00010000'                           1662 07565000
*       MVRNDESC=OFF;               /*                       @Y30LB33*/ 07566000
         NI    MVRNDESC(@15),B'11110111'                           1663 07567000
*     END;                          /*                       @Y30LB33*/ 07568000
*                                                                  1664 07569000
*   /*****************************************************************/ 07570000
*   /*                                                               */ 07571000
*   /* SET UP GENERAL OR RESTRICTED                          @Y30LB33*/ 07572000
*   /* IF IT IS BECOMMING GENERAL, TURN ON GENERAL           @Y30LB33*/ 07573000
*   /* SWITCH                                                @Y30LB33*/ 07574000
*   /*                                                               */ 07575000
*   /*****************************************************************/ 07576000
*                                                                  1665 07577000
*   IF NEWGENSW=ON THEN                                            1665 07578000
@RF01659 TM    NEWGENSW,B'00000100'                                1665 07579000
         BNO   @RF01665                                            1665 07580000
*     MVRGEN=ON;                    /*                       @Y30LB33*/ 07581000
*                                                                  1666 07582000
         L     @02,MVRPTR                                          1666 07583000
         OI    MVRGEN(@02),B'10000000'                             1666 07584000
*   /*****************************************************************/ 07585000
*   /*                                                               */ 07586000
*   /* IF VOLUME BECOMING RESTRICTED                         @Y30LB33*/ 07587000
*   /*                                                               */ 07588000
*   /*****************************************************************/ 07589000
*                                                                  1667 07590000
*   IF ADDR(RSTR)>0                 /*                       @Y30LB33*/ 07591000
*     THEN                                                         1667 07592000
@RF01665 L     @02,@PC00001+4                                      1667 07593000
         L     @02,FDTPTR+20(,@02)                                 1667 07594000
         LTR   @02,@02                                             1667 07595000
         BNP   @RF01667                                            1667 07596000
*     MVRRSTD=ON;                   /*                       @Y30LB33*/ 07597000
*                                                                  1668 07598000
         L     @02,MVRPTR                                          1668 07599000
         OI    MVRRSTD(@02),B'01000000'                            1668 07600000
*   /*****************************************************************/ 07601000
*   /*                                                               */ 07602000
*   /* SET UP THE BACKUP NUMBER IF SPECIFIED                 @Y30LB33*/ 07603000
*   /*                                                               */ 07604000
*   /*****************************************************************/ 07605000
*                                                                  1669 07606000
*   IF ADDR(BKUP)>0 THEN                                           1669 07607000
@RF01667 L     @02,@PC00001+4                                      1669 07608000
         L     @02,FDTPTR+64(,@02)                                 1669 07609000
         LTR   @02,@02                                             1669 07610000
         BNP   @RF01669                                            1669 07611000
*     DO;                           /*                       @Y30LB33*/ 07612000
*       MVRBKUPN=BKUPVAL;           /*                       @Y30LB33*/ 07613000
         L     @15,MVRPTR                                          1671 07614000
         MVC   MVRBKUPN(1,@15),BKUPVAL+3(@02)                      1671 07615000
*       MVRFLBK=ON;                 /*                       @Y30LB33*/ 07616000
         OI    MVRFLBK(@15),B'00000010'                            1672 07617000
*     END;                          /*                       @Y30LB33*/ 07618000
*                                                                  1673 07619000
*   /*****************************************************************/ 07620000
*   /*                                                               */ 07621000
*   /* DUMP THE PARAMETER LIST                               @Y30LB33*/ 07622000
*   /*                                                               */ 07623000
*   /*****************************************************************/ 07624000
*                                                                  1674 07625000
*   IF GDTDBG=NULLPTR THEN                                         1674 07626000
@RF01669 L     @02,@PC00001                                        1674 07627000
         L     @02,GDTDBG(,@02)                                    1674 07628000
         LTR   @02,@02                                             1674 07629000
         BZ    @RT01674                                            1674 07630000
*     ;                                                            1675 07631000
*   ELSE                                                           1676 07632000
*     DO;                                                          1676 07633000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/ 07634000
         LA    DMPINDEX,DUMPAREA                                   1677 07635000
*       DMPITMNM='MVR';                                            1678 07636000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1678 07637000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1678 07638000
         MVC   DMPITMNM(3,DMPINDEX),@CC01771                       1678 07639000
*       DMPITMPT=ADDR(MVR);                                        1679 07640000
         L     @15,MVRPTR                                          1679 07641000
         ST    @15,DMPITMPT(,DMPINDEX)                             1679 07642000
*       DMPITMLN=LENGTH(MVR);                                      1680 07643000
         MVC   DMPITMLN(2,DMPINDEX),@CH01823                       1680 07644000
*       DMPITMTP='H';                                              1681 07645000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1681 07646000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/ 07647000
         AL    DMPINDEX,@CF00507                                   1682 07648000
*       DMPTRM=DMPTRMVL;                                           1683 07649000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1683 07650000
*     END;                          /*                       @Y30LB33*/ 07651000
*   IF GDTDBG=NULLPTR THEN                                         1685 07652000
@RT01674 L     @02,@PC00001                                        1685 07653000
         L     @02,GDTDBG(,@02)                                    1685 07654000
         LTR   @02,@02                                             1685 07655000
         BZ    @RT01685                                            1685 07656000
*     ;                                                            1686 07657000
*   ELSE                                                           1687 07658000
*     CALL IDCDB010(GDTTBL,'MVWB',DUMPADDR);/*               @Y30LB33*/ 07659000
*                                                                  1687 07660000
         L     @02,@PC00001                                        1687 07661000
         ST    @02,@AL00001                                        1687 07662000
         LA    @15,@CC01801                                        1687 07663000
         ST    @15,@AL00001+4                                      1687 07664000
         LA    @15,DUMPADDR                                        1687 07665000
         ST    @15,@AL00001+8                                      1687 07666000
         MVI   @AL00001+8,X'80'                                    1687 07667000
         L     @15,GDTDBG(,@02)                                    1687 07668000
         LA    @01,@AL00001                                        1687 07669000
         BALR  @14,@15                                             1687 07670000
*   /*****************************************************************/ 07671000
*   /*                                                               */ 07672000
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/ 07673000
*   /*                                                               */ 07674000
*   /*****************************************************************/ 07675000
*                                                                  1688 07676000
*   REG14=BLDMSV;                   /*                       @Y30LB33*/ 07677000
@RT01685 LR    REG14,BLDMSV                                        1688 07678000
*   RETURN CODE(0);                 /*                       @Y30LB33*/ 07679000
         SLR   @15,@15                                             1689 07680000
@EL00024 DS    0H                                                  1689 07681000
@EF00024 DS    0H                                                  1689 07682000
@ER00024 BR    @14                                                 1689 07683000
*   END BLDMVR;                     /*                       @Y30LB33*/ 07684000
*                                                                  1691 07685000
*/***********************************************************@Y30LB39*/ 07686000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07687000
*/*                                                          @Y30LB39*/ 07688000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07689000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07690000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07691000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07692000
*/*                                                          @Y30LB39*/ 07693000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07694000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07695000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07696000
*/*                                                          @Y30LB39*/ 07697000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07698000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07699000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07700000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07701000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07702000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07703000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07704000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07705000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07706000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07707000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07708000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07709000
*/*                                                          @Y30LB39*/ 07710000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07711000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07712000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07713000
*/*                                                          @Y30LB39*/ 07714000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07715000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07716000
*/*                                                          @Y30LB39*/ 07717000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07718000
*/*                                                          @Y30LB39*/ 07719000
*/***********************************************************@Y30LB39*/ 07720000
*                                                                  1691 07721000
*                                   /*                       @Y30LB39*/ 07722000
*SSCMSG:                                                           1691 07723000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07724000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07725000
*                                                            @Y30LB39*/ 07726000
SSCMSG   STM   @14,@12,@SA00025                                    1691 07727000
         MVC   @PC00025(8),0(@01)                                  1691 07728000
*                                   /*                       @Y30LB39*/ 07729000
*                                                                  1692 07730000
*   /*****************************************************************/ 07731000
*   /*                                                               */ 07732000
*   /*                                                       @Y30LB39*/ 07733000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07734000
*   /*                                                       @Y30LB39*/ 07735000
*   /*                                                               */ 07736000
*   /*****************************************************************/ 07737000
*                                                                  1692 07738000
*                                   /*                       @Y30LB39   07739000
*                                                            @Y30LB39*/ 07740000
*                                                                  1692 07741000
*   /*****************************************************************/ 07742000
*   /*                                                               */ 07743000
*   /*                                                       @Y30LB39*/ 07744000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07745000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07746000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07747000
*   /*                                                       @Y30LB39*/ 07748000
*   /*                                                               */ 07749000
*   /*****************************************************************/ 07750000
*                                                                  1692 07751000
*                                   /*                       @Y30LB39*/ 07752000
*   DCL                                                            1692 07753000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07754000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07755000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07756000
*   DCL                                                            1693 07757000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07758000
*                                                            @Y30LB39   07759000
*                                                            @Y30LB39*/ 07760000
*                                                                  1693 07761000
*   /*****************************************************************/ 07762000
*   /*                                                               */ 07763000
*   /*                                                       @Y30LB39*/ 07764000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07765000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07766000
*   /*                                                       @Y30LB39*/ 07767000
*   /*                                                               */ 07768000
*   /*****************************************************************/ 07769000
*                                                                  1694 07770000
*                                   /*                       @Y30LB39*/ 07771000
*   DCL                                                            1694 07772000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07773000
*   DCL                                                            1695 07774000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07775000
*                                                            @Y30LB39*/ 07776000
*                                                                  1695 07777000
*   /*****************************************************************/ 07778000
*   /*                                                               */ 07779000
*   /*                                                       @Y30LB39*/ 07780000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07781000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07782000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07783000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07784000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07785000
*   /*                                                       @Y30LB39*/ 07786000
*   /*                                                               */ 07787000
*   /*****************************************************************/ 07788000
*                                                                  1696 07789000
*                                   /*                       @Y30LB39*/ 07790000
*   DECLARE                                                        1696 07791000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07792000
*                                                            @Y30LB39*/ 07793000
*                                                                  1696 07794000
*   /*****************************************************************/ 07795000
*   /*                                                               */ 07796000
*   /*                                                       @Y30LB39*/ 07797000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07798000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07799000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07800000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07801000
*   /*                                                       @Y30LB39*/ 07802000
*   /*                                                               */ 07803000
*   /*****************************************************************/ 07804000
*                                                                  1697 07805000
*                                   /*                       @Y30LB39*/ 07806000
*   DECLARE                                                        1697 07807000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07808000
*                                                            @Y30LB39*/ 07809000
*                                                                  1697 07810000
*   /*****************************************************************/ 07811000
*   /*                                                               */ 07812000
*   /*                                                       @Y30LB39*/ 07813000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07814000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07815000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07816000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07817000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07818000
*   /*                                                       @Y30LB39*/ 07819000
*   /*                                                               */ 07820000
*   /*****************************************************************/ 07821000
*                                                                  1698 07822000
*                                   /*                       @Y30LB39*/ 07823000
*   DECLARE                                                        1698 07824000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07825000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07826000
*                                                            @Y30LB39*/ 07827000
*                                                                  1698 07828000
*   /*****************************************************************/ 07829000
*   /*                                                               */ 07830000
*   /*                                                       @Y30LB39*/ 07831000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07832000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07833000
*   /*                                                       @Y30LB39*/ 07834000
*   /*                                                               */ 07835000
*   /*****************************************************************/ 07836000
*                                                                  1699 07837000
*                                   /*                       @Y30LB39*/ 07838000
*   DECLARE                                                        1699 07839000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07840000
*                                                            @Y30LB39*/ 07841000
*                                                                  1699 07842000
*   /*****************************************************************/ 07843000
*   /*                                                               */ 07844000
*   /*                                                       @Y30LB39*/ 07845000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07846000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07847000
*   /*                                                       @Y30LB39*/ 07848000
*   /*                                                               */ 07849000
*   /*****************************************************************/ 07850000
*                                                                  1700 07851000
*                                   /*                       @Y30LB39*/ 07852000
*   DECLARE                                                        1700 07853000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07854000
*                                                            @Y30LB39*/ 07855000
*                                   /*                       @Y30LB39*/ 07856000
*                                                                  1701 07857000
*   /*****************************************************************/ 07858000
*   /*                                                               */ 07859000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07860000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07861000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07862000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07863000
*   /*                                                       @Y30LB39*/ 07864000
*   /*                                                               */ 07865000
*   /*****************************************************************/ 07866000
*                                                                  1701 07867000
*                                   /*                       @Y30LB39*/ 07868000
*   OLDERID2=NEWERID2;                                             1701 07869000
         L     @15,@PC00001                                        1701 07870000
         L     @14,GDTTR2(,@15)                                    1701 07871000
         MVC   @TS00001(95),NEWERID2(@14)                          1701 07872000
         MVC   OLDERID2(95,@14),@TS00001                           1701 07873000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07874000
*                                                            @Y30LB39*/ 07875000
*                                                                  1702 07876000
         MVC   NEWID2(4,@14),@CC01822                              1702 07877000
*   /*****************************************************************/ 07878000
*   /*                                                               */ 07879000
*   /*                                                       @Y30LB39*/ 07880000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 07881000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 07882000
*   /*                                                       @Y30LB39*/ 07883000
*   /*                                                               */ 07884000
*   /*****************************************************************/ 07885000
*                                                                  1703 07886000
*                                   /*                       @Y30LB39*/ 07887000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   07888000
*                                                            @Y30LB39*/ 07889000
*                                                                  1703 07890000
         LA    @14,SSDRGLT                                         1703 07891000
         ST    @14,SSDLPTR                                         1703 07892000
*   /*****************************************************************/ 07893000
*   /*                                                               */ 07894000
*   /*                                                       @Y30LB39*/ 07895000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 07896000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 07897000
*   /*                                                       @Y30LB39*/ 07898000
*   /*                                                               */ 07899000
*   /*****************************************************************/ 07900000
*                                                                  1704 07901000
*                                   /*                       @Y30LB39*/ 07902000
*   IF SSRCODE>0 THEN                                              1704 07903000
         L     @07,@PC00025                                        1704 07904000
         L     @07,SSRCODE(,@07)                                   1704 07905000
         LTR   @07,@07                                             1704 07906000
         BNP   @RF01704                                            1704 07907000
*     DO;                           /*                       @Y30LB39   07908000
*                                                            @Y30LB39*/ 07909000
*                                                                  1705 07910000
*       /*************************************************************/ 07911000
*       /*                                                           */ 07912000
*       /*                                                   @Y30LB39*/ 07913000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 07914000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 07915000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 07916000
*       /* CODES.                                            @Y30LB39*/ 07917000
*       /*                                                   @Y30LB39*/ 07918000
*       /*                                                           */ 07919000
*       /*************************************************************/ 07920000
*                                                                  1706 07921000
*                                   /*                       @Y30LB39*/ 07922000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07923000
         XC    SSDRGLT(20),SSDRGLT                                 1706 07924000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 07925000
         LA    @03,SSINXLST                                        1707 07926000
         ST    @03,DARGRETP(,@14)                                  1707 07927000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07928000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1708 07929000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 07930000
         MVI   DARGSENT(@14),X'01'                                 1709 07931000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   07932000
*                                                            @Y30LB39*/ 07933000
*                                                                  1710 07934000
         MVC   DARGRETL(2,@14),@CH01837                            1710 07935000
*       /*************************************************************/ 07936000
*       /*                                                           */ 07937000
*       /*                                                   @Y30LB39*/ 07938000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 07939000
*       /* ARRAY.                                            @Y30LB39*/ 07940000
*       /*                                                   @Y30LB39*/ 07941000
*       /*                                                           */ 07942000
*       /*************************************************************/ 07943000
*                                                                  1711 07944000
*                                   /*                       @Y30LB39*/ 07945000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   07946000
*                                                            @Y30LB39*/ 07947000
*                                                                  1711 07948000
         ST    @15,@AL00001                                        1711 07949000
         LA    @03,@CF00117                                        1711 07950000
         ST    @03,@AL00001+4                                      1711 07951000
         LA    @03,SSDLPTR                                         1711 07952000
         ST    @03,@AL00001+8                                      1711 07953000
         MVI   @AL00001+8,X'80'                                    1711 07954000
         L     @15,GDTPRT(,@15)                                    1711 07955000
         LA    @01,@AL00001                                        1711 07956000
         BALR  @14,@15                                             1711 07957000
*       /*************************************************************/ 07958000
*       /*                                                           */ 07959000
*       /*                                                   @Y30LB39*/ 07960000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 07961000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 07962000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 07963000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 07964000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 07965000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 07966000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 07967000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 07968000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 07969000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 07970000
*       /* REASON CODE.                                      @Y30LB39*/ 07971000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 07972000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 07973000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 07974000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 07975000
*       /*                                                   @Y30LB39*/ 07976000
*       /*                                                           */ 07977000
*       /*************************************************************/ 07978000
*                                                                  1712 07979000
*                                   /*                       @Y30LB39*/ 07980000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 07981000
         LA    ENTRYNUM,1                                          1712 07982000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1713 07983000
@DL01713 DS    0H                                                  1714 07984000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 07985000
         AL    ENTRYNUM,@CF00221                                   1714 07986000
*       END;                        /*                       @Y30LB39   07987000
*                                                            @Y30LB39*/ 07988000
*                                                                  1715 07989000
@DE01713 L     @03,@PC00025                                        1715 07990000
         LR    @15,ENTRYNUM                                        1715 07991000
         ALR   @15,@15                                             1715 07992000
         LH    @15,SSARRAY-2(@15)                                  1715 07993000
         CH    @15,SSRHALF(,@03)                                   1715 07994000
         BE    @DC01713                                            1715 07995000
         SLR   @14,@14                                             1715 07996000
         CR    @15,@14                                             1715 07997000
         BNE   @DL01713                                            1715 07998000
@DC01713 DS    0H                                                  1716 07999000
*       /*************************************************************/ 08000000
*       /*                                                           */ 08001000
*       /*                                                   @Y30LB39*/ 08002000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 08003000
*       /*                                                   @Y30LB39*/ 08004000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 08005000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 08006000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 08007000
*       /* CODE OR                                           @Y30LB39*/ 08008000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 08009000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 08010000
*       /*                                                   @Y30LB39*/ 08011000
*       /*                                                           */ 08012000
*       /*************************************************************/ 08013000
*                                                                  1716 08014000
*                                   /*                       @Y30LB39*/ 08015000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08016000
         XC    SSDRGLT(20),SSDRGLT                                 1716 08017000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 08018000
         L     @07,SSDLPTR                                         1717 08019000
         MVC   DARGSMOD(3,@07),SSMODSS0                            1717 08020000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 08021000
         STC   ENTRYNUM,DARGSENT(,@07)                             1718 08022000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 08023000
         CR    @15,@14                                             1719 08024000
         BNE   @RF01719                                            1719 08025000
*         DO;                       /*                       @Y30LB39*/ 08026000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 08027000
         ST    @03,DARGDBP(,@07)                                   1721 08028000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 08029000
         MVC   DARGILP(2,@07),@CH00043                             1722 08030000
*         END;                      /*                       @Y30LB39*/ 08031000
*     END;                          /*                       @Y30LB39*/ 08032000
*                                   /*                       @Y30LB39*/ 08033000
*                                                                  1725 08034000
*   /*****************************************************************/ 08035000
*   /*                                                               */ 08036000
*   /*                                                       @Y30LB39*/ 08037000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 08038000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 08039000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 08040000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 08041000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 08042000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 08043000
*   /* POST CODE.                                            @Y30LB39*/ 08044000
*   /*                                                       @Y30LB39*/ 08045000
*   /*                                                               */ 08046000
*   /*****************************************************************/ 08047000
*                                                                  1725 08048000
*                                   /*                       @Y30LB39*/ 08049000
*   ELSE                            /*                       @Y30LB39*/ 08050000
*     DO;                           /*                       @Y30LB39*/ 08051000
         B     @RC01704                                            1725 08052000
@RF01704 DS    0H                                                  1726 08053000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08054000
         XC    SSDRGLT(20),SSDRGLT                                 1726 08055000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 08056000
         L     @15,SSDLPTR                                         1727 08057000
         MVC   DARGSMOD(3,@15),SSMODCM0                            1727 08058000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 08059000
         MVC   DARGSENT(1,@15),SSMSGNUM                            1728 08060000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 08061000
         L     @14,@PC00025+4                                      1729 08062000
         ST    @14,DARGDBP(,@15)                                   1729 08063000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 08064000
         MVC   DARGILP(2,@15),@CH00221                             1730 08065000
*     END;                          /*                       @Y30LB39   08066000
*                                                            @Y30LB39*/ 08067000
*                                                                  1731 08068000
*   /*****************************************************************/ 08069000
*   /*                                                               */ 08070000
*   /*                                                       @Y30LB39*/ 08071000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 08072000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 08073000
*   /*                                                       @Y30LB39*/ 08074000
*   /*                                                               */ 08075000
*   /*****************************************************************/ 08076000
*                                                                  1732 08077000
*                                   /*                       @Y30LB39*/ 08078000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   08079000
*                                                            @Y30LB39*/ 08080000
*                                                                  1732 08081000
@RC01704 L     @15,@PC00001                                        1732 08082000
         ST    @15,@AL00001                                        1732 08083000
         LA    @14,@CF00117                                        1732 08084000
         ST    @14,@AL00001+4                                      1732 08085000
         LA    @14,SSDLPTR                                         1732 08086000
         ST    @14,@AL00001+8                                      1732 08087000
         MVI   @AL00001+8,X'80'                                    1732 08088000
         L     @15,GDTPRT(,@15)                                    1732 08089000
         LA    @01,@AL00001                                        1732 08090000
         BALR  @14,@15                                             1732 08091000
*   /*****************************************************************/ 08092000
*   /*                                                               */ 08093000
*   /*                                                       @Y30LB39*/ 08094000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 08095000
*   /*                                                       @Y30LB39*/ 08096000
*   /*                                                               */ 08097000
*   /*****************************************************************/ 08098000
*                                                                  1733 08099000
*                                   /*                       @Y30LB39   08100000
*                                                            @Y30LB39*/ 08101000
*   RETURN CODE(0);                 /*                       @Y30LB39   08102000
*                                                            @Y30LB39*/ 08103000
         SLR   @15,@15                                             1733 08104000
         L     @14,@SA00025                                        1733 08105000
         LM    @00,@12,@SA00025+8                                  1733 08106000
         BR    @14                                                 1733 08107000
*   END SSCMSG;                     /*                       @Y30LB39*/ 08108000
*   END IDCMV01                     /*                       @Y30LB33*/ 08109000
*                                                                  1735 08110000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 08111000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 08112000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 08113000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 08114000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 08115000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 08116000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 08117000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 08118000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 08119000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 08120000
*/*%INCLUDE SYSLIB  (IDCCSMV )                                       */ 08121000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 08122000
*                                                                  1735 08123000
*       ;                                                          1735 08124000
@DATA    DS    0H                                                       08125000
@CH00156 DC    H'2'                                                     08126000
@CH00297 DC    H'5'                                                     08127000
@CH00159 DC    H'6'                                                     08128000
@CH01468 DC    H'23'                                                    08129000
@CH01826 DC    H'64'                                                    08130000
@CH01833 DC    H'68'                                                    08131000
@CH01823 DC    H'88'                                                    08132000
@CH01837 DC    H'120'                                                   08133000
@CH01836 DC    H'132'                                                   08134000
@CH01834 DC    H'164'                                                   08135000
@CH01832 DC    H'224'                                                   08136000
@DATD    DSECT                                                          08137000
         DS    0F                                                       08138000
@SA00001 DS    18F                                                      08139000
@PC00001 DS    3F                                                       08140000
@SA00003 DS    1F                                                       08141000
@SA00025 DS    15F                                                      08142000
@PC00025 DS    2F                                                       08143000
@PC00016 DS    1F                                                       08144000
@AL00001 DS    5A                                                       08145000
IDCMV01  CSECT                                                          08146000
         DS    0F                                                       08147000
@CF00117 DC    F'0'                                                     08148000
@CF00221 DC    F'1'                                                     08149000
@CH00221 EQU   @CF00221+2                                               08150000
@CF00043 DC    F'4'                                                     08151000
@CH00043 EQU   @CF00043+2                                               08152000
@CF00035 DC    F'8'                                                     08153000
@CH00035 EQU   @CF00035+2                                               08154000
@CF00038 DC    F'12'                                                    08155000
@CH00038 EQU   @CF00038+2                                               08156000
@CF00507 DC    F'16'                                                    08157000
@DATD    DSECT                                                          08158000
         DS    0D                                                       08159000
LISTSCAN DS    A                                                        08160000
IOCSPTR  DS    A                                                        08161000
DDSTRU   DS    A                                                        08162000
FSADDR   DS    A                                                        08163000
ERCNVADR DS    A                                                        08164000
CCMSGPTR DS    A                                                        08165000
CMMSGPTR DS    A                                                        08166000
CTMSGPTR DS    A                                                        08167000
ELEMENT  DS    F                                                        08168000
RVVIPTR  DS    A                                                        08169000
MVRPTR   DS    A                                                        08170000
DEFVPTR  DS    A                                                        08171000
MVUCBPTR DS    A                                                        08172000
IOCTLBKP DS    A                                                        08173000
RCAREA   DS    F                                                        08174000
DUMPADDR DS    A                                                        08175000
CKOUTSV  DS    A                                                        08176000
GRPROCSV DS    A                                                        08177000
DLSUCB   DS    A                                                        08178000
DOITSV   DS    A                                                        08179000
CKAUTHSV DS    A                                                        08180000
MODFYSV  DS    A                                                        08181000
LABELSV  DS    A                                                        08182000
NEWLABSV DS    A                                                        08183000
BACKSV   DS    A                                                        08184000
BLDLSV   DS    A                                                        08185000
SSDLPTR  DS    A                                                        08186000
LISTPTR  DS    A                                                        08187000
SETRC    DS    H                                                        08188000
MYBAKUP  DS    FL1                                                      08189000
LISTLN   DS    FL1                                                      08190000
         DS    0D                                                       08191000
@TS00001 DS    CL95                                                     08192000
SWCHBITS DS    CL2                                                      08193000
         ORG   SWCHBITS                                                 08194000
DMNTSW   DS    BL1                                                      08195000
RENAMSW  EQU   SWCHBITS+0                                               08196000
ATTRSW   EQU   SWCHBITS+0                                               08197000
MSVCSW   EQU   SWCHBITS+0                                               08198000
GRPRCD   EQU   SWCHBITS+0                                               08199000
INACTSW  EQU   SWCHBITS+0                                               08200000
COPYATTR EQU   SWCHBITS+0                                               08201000
MISCLEAR EQU   SWCHBITS+0                                               08202000
ONLYONLY DS    BL1                                                      08203000
CKSW     EQU   SWCHBITS+1                                               08204000
MNTSW    EQU   SWCHBITS+1                                               08205000
COPYRW   EQU   SWCHBITS+1                                               08206000
VOLRCD   EQU   SWCHBITS+1                                               08207000
NEWGENSW EQU   SWCHBITS+1                                               08208000
         ORG   SWCHBITS+2                                               08209000
MYVVFLG  DS    BL1                                                      08210000
MVALLULP DS    CL12                                                     08211000
         ORG   MVALLULP                                                 08212000
MVALLUNO DS    FL2                                                      08213000
MVALLULN DS    FL2                                                      08214000
MVALLUNT DS    CL8                                                      08215000
         ORG   MVALLULP+12                                              08216000
MVALLVLP DS    CL10                                                     08217000
         ORG   MVALLVLP                                                 08218000
MVALLVNO DS    FL2                                                      08219000
MVALLVLN DS    FL2                                                      08220000
MVALLVOL DS    CL6                                                      08221000
         ORG   MVALLVLP+10                                              08222000
ECBBYTE  DS    CL1                                                      08223000
MVMAJNAM DS    CL8                                                      08224000
MVMINNAM DS    CL23                                                     08225000
         ORG   MVMINNAM                                                 08226000
MINAMLN  DS    CL1                                                      08227000
MINAMVOL DS    CL6                                                      08228000
MINAMQL  DS    CL16                                                     08229000
         ORG   MVMINNAM+23                                              08230000
MVDDNAME DS    CL8                                                      08231000
MVVOLUME DS    CL6                                                      08232000
         DS    CL2                                                      08233000
MVOPNAGL DS    BL48                                                     08234000
MVDRGLST DS    CL36                                                     08235000
MVDEFLST DS    CL132                                                    08236000
MVDEFVE  DS    CL64                                                     08237000
BKDEFLST DS    CL132                                                    08238000
BKDEFVE  DS    CL64                                                     08239000
MVMVRLST DS    CL88                                                     08240000
MVRVVI   DS    CL68                                                     08241000
MVCKAGL  DS    CL29                                                     08242000
         DS    CL3                                                      08243000
MVMDAGL  DS    CL37                                                     08244000
         DS    CL3                                                      08245000
MVALLAGL DS    CL31                                                     08246000
         DS    CL1                                                      08247000
MVSELAGL DS    CL23                                                     08248000
         DS    CL1                                                      08249000
MVVS1AGL DS    CL74                                                     08250000
         DS    CL2                                                      08251000
MVVS2AGL DS    CL52                                                     08252000
VOLRCDBF DS    CL224                                                    08253000
GRPRCDBF DS    CL164                                                    08254000
MVEXAGL  DS    CL23                                                     08255000
DUMPAREA DS    CL33                                                     08256000
TEMPVAL  DS    CL5                                                      08257000
         ORG   TEMPVAL                                                  08258000
VTOCCCHH DS    CL4                                                      08259000
         ORG   VTOCCCHH                                                 08260000
VTOCCC   DS    CL2                                                      08261000
VTOCHH   DS    CL2                                                      08262000
         ORG   TEMPVAL+4                                                08263000
VTOCR    DS    CL1                                                      08264000
         ORG   TEMPVAL+5                                                08265000
DLSDDN   DS    CL8                                                      08266000
SSDRGLT  DS    CL20                                                     08267000
         DS    CL3                                                      08268000
SSINXLST DS    CL120                                                    08269000
         ORG   SSINXLST                                                 08270000
SSARRAY  DS    60H                                                      08271000
         ORG   SSINXLST+120                                             08272000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08273000
@ENDDATD EQU   *                                                        08274000
IDCMV01  CSECT                                                          08275000
         DS    0F                                                       08276000
@SIZDATD DC    AL1(0)                                                   08277000
         DC    AL3(@ENDDATD-@DATD)                                      08278000
         DS    0D                                                       08279000
RVVLEN   DC    AL2(68)                                                  08280000
DEFLEN   DC    AL2(64)                                                  08281000
MVRLEN   DC    AL2(88)                                                  08282000
SSMSGNUM DC    AL1(56)                                                  08283000
@CC01586 DC    C'.VIRTUAL.ENQUEUE'                                      08284000
@CC01589 DC    C'.VIRTUAL.RESERVE'                                      08285000
@CC01575 DC    C'          '                                            08286000
@CC01573 DC    C'SYSGROUP'                                              08287000
@CC01584 DC    C'SYSZAMS '                                              08288000
@CC01705 DC    C'IDCVS01 '                                              08289000
@CC01758 DC    C'IDCVS02 '                                              08290000
@CC01785 DC    C'BKDEFLST'                                              08291000
@CC01648 DC    C'EXCLAGL'                                               08292000
@CC01739 DC    C'DEFLIST'                                               08293000
@CC01793 DC    C'MVDEFVE'                                               08294000
@CC01794 DC    C'BKDEFVE'                                               08295000
@CC01570 DC    C'3330V'                                                 08296000
@CC01764 DC    C'DEFVE'                                                 08297000
@CC01637 DC    C'MVAA'                                                  08298000
@CC01645 DC    C'MVBA'                                                  08299000
@CC01650 DC    C'MVBB'                                                  08300000
@CC01654 DC    C'MVRL'                                                  08301000
@CC01662 DC    C'MVDA'                                                  08302000
@CC01663 DC    C'RVVI'                                                  08303000
@CC01664 DC    C'MVDB'                                                  08304000
@CC01671 DC    C'MVEA'                                                  08305000
@CC01676 DC    C'MVGB'                                                  08306000
@CC01685 DC    C'MVDL'                                                  08307000
@CC01690 DC    C'MVGC'                                                  08308000
@CC01695 DC    C'MVCA'                                                  08309000
@CC01703 DC    C'MVFA'                                                  08310000
@CC01710 DC    C'MVGA'                                                  08311000
@CC01717 DC    C'MVHA'                                                  08312000
@CC01723 DC    C'MVIA'                                                  08313000
@CC01729 DC    C'MVJA'                                                  08314000
@CC01738 DC    C'MVNA'                                                  08315000
@CC01740 DC    C'MVNB'                                                  08316000
@CC01747 DC    C'MVOA'                                                  08317000
@CC01752 DC    C'MVPA'                                                  08318000
@CC01757 DC    C'MVQA'                                                  08319000
@CC01763 DC    C'MVRA'                                                  08320000
@CC01765 DC    C'MVRC'                                                  08321000
@CC01770 DC    C'MVSA'                                                  08322000
@CC01772 DC    C'MVSB'                                                  08323000
@CC01777 DC    C'MVTA'                                                  08324000
@CC01778 DC    C'MVTB'                                                  08325000
@CC01783 DC    C'MVUA'                                                  08326000
@CC01786 DC    C'MVUB'                                                  08327000
@CC01791 DC    C'MVVA'                                                  08328000
@CC01795 DC    C'MVVB'                                                  08329000
@CC01800 DC    C'MVWA'                                                  08330000
@CC01801 DC    C'MVWB'                                                  08331000
@CC01822 DC    C'SSAA'                                                  08332000
@CC01771 EQU   @CC01654                                                 08333000
ALL      DC    CL3'ALL'                                                 08334000
FORMAT   DC    CL4'FORM'                                                08335000
HSECOND  DC    CL4'HSEC'                                                08336000
CLOCK    DC    CL4'KLOK'                                                08337000
SETZERO  DC    CL4'ZERO'                                                08338000
SETBLANK DC    CL4'BLNK'                                                08339000
NOSET    DC    CL4'NSET'                                                08340000
OVERRIDE DC    CL4'OVRD'                                                08341000
ACQUIRE  DC    CL8'ACQUIRE '                                            08342000
RELINQ   DC    CL8'RELINQ  '                                            08343000
MOUNT    DC    CL8'MOUNT   '                                            08344000
DEMOUNT  DC    CL8'DEMOUNT '                                            08345000
DEFINE   DC    CL8'DEFINE  '                                            08346000
MOVE     DC    CL8'MOVE    '                                            08347000
TRACEQ   DC    CL8'TRACEQ  '                                            08348000
COPYTABL DC    CL8'COPYTABL'                                            08349000
COPYCRTG DC    CL8'COPYCRTG'                                            08350000
COPYVOL  DC    CL8'COPYVOL '                                            08351000
VVIC     DC    CL8'VVIC    '                                            08352000
TUNE     DC    CL8'TUNE    '                                            08353000
NAMES    DC    CL4'NAME'                                                08354000
UNIT     DC    CL4'UNIT'                                                08355000
SHR      DC    CL4'SHR '                                                08356000
EXCL     DC    CL4'EXCL'                                                08357000
NOWAIT   DC    CL4'NWAI'                                                08358000
WAIT     DC    CL4'WAIT'                                                08359000
SECCHECK DC    CL8'SECCHECK'                                            08360000
SCRVTOC  DC    CL8'SCRVTOC '                                            08361000
GETVTOC  DC    CL8'GETVTOC '                                            08362000
PUTVTOC  DC    CL8'PUTVTOC '                                            08363000
RECATLG  DC    CL8'RECATLG '                                            08364000
INITVOL  DC    CL8'INITVOL '                                            08365000
CHECK    DC    CL8'CHECK   '                                            08366000
POSTUCB  DC    CL8'POSTUCB '                                            08367000
GET      DC    CL8'GET     '                                            08368000
PUT      DC    CL8'PUT     '                                            08369000
CLOSE    DC    CL8'CLOSE   '                                            08370000
OPEN     DC    CL8'OPEN    '                                            08371000
RVOPENR  DC    CL8'OPENR   '                                            08372000
RVRDCNT  DC    CL8'READCNT '                                            08373000
RVREADKD DC    CL8'READKD  '                                            08374000
RVSPACCR DC    CL8'SPACCR  '                                            08375000
RVFWRITE DC    CL8'FWRITE  '                                            08376000
RVWRITER DC    CL8'WRITEREC'                                            08377000
PUTLABEL DC    CL8'PUTLABEL'                                            08378000
GETLABEL DC    CL8'GETLABEL'                                            08379000
CANCEL   DC    CL8'CANCEL  '                                            08380000
SET      DC    CL8'SET     '                                            08381000
SELECTX  DC    CL8'SELECTX '                                            08382000
CHANGEX  DC    CL8'CHANGEX '                                            08383000
SELECTDD DC    CL8'SELECTDD'                                            08384000
SELECTDS DC    CL8'SELECTDS'                                            08385000
TBLREST  DC    CL8'TBLREST '                                            08386000
NULLIFYC DC    CL8'NULLIFYC'                                            08387000
RDMSC    DC    CL8'RDMSC   '                                            08388000
RDMSCTBL DC    CL8'RDMSCTBL'                                            08389000
RDCARTLB DC    CL8'RDCARTLB'                                            08390000
AUDITCEL DC    CL8'AUDITCEL'                                            08391000
RDSTGAD  DC    CL8'RDSTGAD '                                            08392000
MODIFYC  DC    CL8'MODIFYC '                                            08393000
VTOCRR   DC    X'01'                                                    08394000
MAXHH    DC    X'0012'                                                  08395000
MODID    DC    CL4'MV01'                                                08396000
MODMV0   DC    CL3'MV0'                                                 08397000
MODCMN   DC    CL3'CM0'                                                 08398000
MODUNIV  DC    CL3'UV0'                                                 08399000
BLANK30  DC    CL30'                              '                     08400000
NULLEFFS DC    X'FFFFFFFF'                                              08401000
FIXAREA  DS    CL720                                                    08402000
         ORG   FIXAREA                                                  08403000
@NM00123 DS    CL720                                                    08404000
         ORG   @NM00123                                                 08405000
@NM00124 DC    240X'00'                                                 08406000
@NM00125 DC    240X'00'                                                 08407000
@NM00126 DC    240X'00'                                                 08408000
         ORG   FIXAREA+720                                              08409000
SSMODSS0 DC    CL3'SS0'                                                 08410000
SSMODCM0 DC    CL3'CM0'                                                 08411000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08412000
@01      EQU   01                                                       08413000
@02      EQU   02                                                       08414000
@03      EQU   03                                                       08415000
@04      EQU   04                                                       08416000
@05      EQU   05                                                       08417000
@06      EQU   06                                                       08418000
@07      EQU   07                                                       08419000
@08      EQU   08                                                       08420000
@09      EQU   09                                                       08421000
@10      EQU   10                                                       08422000
@11      EQU   11                                                       08423000
@12      EQU   12                                                       08424000
@13      EQU   13                                                       08425000
@14      EQU   14                                                       08426000
@15      EQU   15                                                       08427000
ENTRYNUM EQU   @02                                                      08428000
BLDMSV   EQU   @03                                                      08429000
BLDESV   EQU   @03                                                      08430000
SETFLGSV EQU   @04                                                      08431000
DMNTVSV  EQU   @04                                                      08432000
MNTVOLSV EQU   @07                                                      08433000
ALLOVSV  EQU   @07                                                      08434000
ACTVOLSV EQU   @07                                                      08435000
CHNG2SV  EQU   @07                                                      08436000
CHNG1SV  EQU   @07                                                      08437000
GRPCHKSV EQU   @07                                                      08438000
DLSPCHSV EQU   @07                                                      08439000
BVOLSV   EQU   @03                                                      08440000
VOLCKSV  EQU   @07                                                      08441000
DEFVEPTR EQU   @05                                                      08442000
GROUPPTR EQU   @06                                                      08443000
BASEVPTR EQU   @04                                                      08444000
DMPINDEX EQU   @02                                                      08445000
OPNPTR   EQU   @02                                                      08446000
TESTRC   EQU   @03                                                      08447000
RTNREG   EQU   @15                                                      08448000
REG14    EQU   @14                                                      08449000
DEFVR1   EQU   @01                                                      08450000
REG0     EQU   @00                                                      08451000
REG1     EQU   @01                                                      08452000
REG10    EQU   @10                                                      08453000
REG11    EQU   @11                                                      08454000
REG12    EQU   @12                                                      08455000
REG13    EQU   @13                                                      08456000
REG15    EQU   @15                                                      08457000
REG2     EQU   @02                                                      08458000
REG3     EQU   @03                                                      08459000
REG4     EQU   @04                                                      08460000
REG5     EQU   @05                                                      08461000
REG6     EQU   @06                                                      08462000
REG7     EQU   @07                                                      08463000
REG8     EQU   @08                                                      08464000
REG9     EQU   @09                                                      08465000
IDCSACL0 EQU   0                                                        08466000
IDCSAEP0 EQU   0                                                        08467000
IDCSAAL0 EQU   0                                                        08468000
IDCSADL0 EQU   0                                                        08469000
IDCSASS0 EQU   0                                                        08470000
IDCSANQ0 EQU   0                                                        08471000
IDCSADQ0 EQU   0                                                        08472000
IDCSA060 EQU   0                                                        08473000
TRACE1   EQU   0                                                        08474000
OLDERID1 EQU   TRACE1                                                   08475000
TRACE2   EQU   0                                                        08476000
OLDERID2 EQU   TRACE2                                                   08477000
NEWID2   EQU   TRACE2+95                                                08478000
NEWERID2 EQU   5                                                        08479000
CIRAGL   EQU   0                                                        08480000
CIRTYPE  EQU   CIRAGL                                                   08481000
ALLAGL   EQU   0                                                        08482000
ALLDDN   EQU   ALLAGL+4                                                 08483000
ALLULP   EQU   ALLAGL+12                                                08484000
ALLVLP   EQU   ALLAGL+16                                                08485000
ALLSTS   EQU   ALLAGL+24                                                08486000
ALLDSP   EQU   ALLAGL+25                                                08487000
ALLORG   EQU   ALLAGL+26                                                08488000
ALLOPT   EQU   ALLAGL+28                                                08489000
ALLOPTVL EQU   ALLOPT                                                   08490000
ALLOPTPV EQU   ALLOPT                                                   08491000
ALLVLCNT EQU   ALLAGL+29                                                08492000
ALLUNCNT EQU   ALLAGL+30                                                08493000
RACFAGL  EQU   0                                                        08494000
RACFFLG1 EQU   RACFAGL                                                  08495000
RACFFLG2 EQU   RACFAGL+1                                                08496000
RACFFLG3 EQU   RACFAGL+2                                                08497000
RACFFLG4 EQU   RACFAGL+3                                                08498000
UNITABL  EQU   0                                                        08499000
UNITADR  EQU   UNITABL+4                                                08500000
@NM00017 EQU   UNITADR                                                  08501000
UNITSTAT EQU   UNITABL+6                                                08502000
IDCIOCL0 EQU   0                                                        08503000
IDCIO050 EQU   0                                                        08504000
IOCSTR   EQU   0                                                        08505000
IOCDSO   EQU   IOCSTR+16                                                08506000
IOCRFM   EQU   IOCSTR+17                                                08507000
IOCMAC   EQU   IOCSTR+18                                                08508000
IOCMAC2  EQU   IOCSTR+19                                                08509000
IOCCHP   EQU   IOCSTR+20                                                08510000
IOCMSG   EQU   IOCSTR+21                                                08511000
IOCRBA   EQU   IOCSTR+40                                                08512000
IOCTTR   EQU   IOCRBA                                                   08513000
IOCMEM   EQU   IOCSTR+44                                                08514000
IOCNWM   EQU   IOCSTR+48                                                08515000
IOCREL   EQU   IOCSTR+60                                                08516000
OPNAGL   EQU   0                                                        08517000
OPNOPT   EQU   OPNAGL                                                   08518000
OPNRFM   EQU   OPNAGL+1                                                 08519000
OPNTYP   EQU   OPNAGL+2                                                 08520000
OPNMOD   EQU   OPNAGL+3                                                 08521000
OPNDEV   EQU   OPNAGL+24                                                08522000
OPNDSO   EQU   OPNAGL+41                                                08523000
OPNOPT2  EQU   OPNAGL+42                                                08524000
IOINFOPT EQU   0                                                        08525000
UVOLLIST EQU   0                                                        08526000
UVOLENT  EQU   UVOLLIST+2                                               08527000
AMSTP011 EQU   0                                                        08528000
DARGLIST EQU   0                                                        08529000
DARGDBP  EQU   DARGLIST                                                 08530000
DARGRETP EQU   DARGLIST+4                                               08531000
DARGSTID EQU   DARGLIST+8                                               08532000
DARGSMOD EQU   DARGSTID                                                 08533000
DARGSENT EQU   DARGSTID+3                                               08534000
DARGILP  EQU   DARGLIST+12                                              08535000
DARGCNT  EQU   DARGLIST+14                                              08536000
DARGRETL EQU   DARGLIST+16                                              08537000
DARGARY  EQU   DARGLIST+20                                              08538000
DARGINS  EQU   DARGARY                                                  08539000
DARGINL  EQU   DARGARY+2                                                08540000
DARGDTM  EQU   DARGARY+4                                                08541000
FMTLIST  EQU   0                                                        08542000
FMTFLGS  EQU   FMTLIST                                                  08543000
FMTSPF   EQU   FMTLIST+2                                                08544000
FMTRFNO  EQU   FMTSPF                                                   08545000
FMTILEN  EQU   FMTRFNO                                                  08546000
FMTIOFF  EQU   FMTLIST+4                                                08547000
FMTTRBC  EQU   FMTIOFF                                                  08548000
FMTSTO   EQU   FMTTRBC                                                  08549000
FMTOCOL  EQU   FMTLIST+6                                                08550000
FMTCNVF  EQU   FMTLIST+10                                               08551000
ERCNVTAB EQU   0                                                        08552000
ERTYPE   EQU   ERCNVTAB                                                 08553000
EROPER   EQU   ERCNVTAB+1                                               08554000
EROSOPER EQU   ERCNVTAB+2                                               08555000
ERCATRC  EQU   ERCNVTAB+16                                              08556000
ERCPLPT  EQU   ERCNVTAB+20                                              08557000
IDCDB010 EQU   0                                                        08558000
DMPITM   EQU   0                                                        08559000
DMPITMNM EQU   DMPITM                                                   08560000
DMPITMPT EQU   DMPITM+8                                                 08561000
DMPITMLN EQU   DMPITM+12                                                08562000
DMPITMTP EQU   DMPITM+14                                                08563000
DMPARY   EQU   0                                                        08564000
DMPTRM   EQU   0                                                        08565000
CCMSG    EQU   0                                                        08566000
CMMSG    EQU   0                                                        08567000
CMVOLFLG EQU   CMMSG+6                                                  08568000
CTMSG    EQU   0                                                        08569000
CTARRAY  EQU   CTMSG+4                                                  08570000
MDAGL    EQU   0                                                        08571000
MDUCBPTR EQU   MDAGL+8                                                  08572000
MDDDNAME EQU   MDAGL+12                                                 08573000
MDLABEL  EQU   MDAGL+24                                                 08574000
MDFLAGS  EQU   MDAGL+30                                                 08575000
MDNEWVOL EQU   MDFLAGS                                                  08576000
MDWAIT   EQU   MDFLAGS                                                  08577000
MDVTOCTR EQU   MDFLAGS                                                  08578000
MDVTOC   EQU   MDAGL+32                                                 08579000
PUAGL    EQU   0                                                        08580000
CKAGL    EQU   0                                                        08581000
CKUCBPTR EQU   CKAGL+8                                                  08582000
CKDDNAME EQU   CKAGL+12                                                 08583000
CKFLAGS  EQU   CKAGL+28                                                 08584000
CKTESTVT EQU   CKFLAGS                                                  08585000
EXCLAGL  EQU   0                                                        08586000
EXCLUCBP EQU   EXCLAGL+8                                                08587000
EXCLDDP  EQU   EXCLAGL+12                                               08588000
EXCLVOL  EQU   EXCLAGL+16                                               08589000
EXCLFLAG EQU   EXCLAGL+22                                               08590000
EXCLMNT  EQU   EXCLFLAG                                                 08591000
EXOARG   EQU   0                                                        08592000
EXOPT    EQU   EXOARG+32                                                08593000
EXFLG    EQU   EXOARG+33                                                08594000
EXGARG   EQU   0                                                        08595000
EXWRARG  EQU   0                                                        08596000
EXRWCHR  EQU   EXWRARG+26                                               08597000
EXSPACE  EQU   EXWRARG+36                                               08598000
EXPARG   EQU   0                                                        08599000
EXPDATA  EQU   EXPARG+12                                                08600000
EXPDATAB EQU   0                                                        08601000
EXPARRAY EQU   EXPDATAB+4                                               08602000
VS2AGL   EQU   0                                                        08603000
VSUCBPTR EQU   VS2AGL+8                                                 08604000
VSOWNPTR EQU   VS2AGL+16                                                08605000
VSVOLPTR EQU   VS2AGL+20                                                08606000
VSIOBKPT EQU   VS2AGL+24                                                08607000
VSLABOPT EQU   VS2AGL+28                                                08608000
VSOWNER  EQU   VSLABOPT                                                 08609000
VSVOLSER EQU   VSLABOPT                                                 08610000
VSNOVTOC EQU   VSLABOPT                                                 08611000
VSVOLUME EQU   VS2AGL+29                                                08612000
VS2MSG   EQU   VS2AGL+35                                                08613000
VS2RESOP EQU   VS2AGL+36                                                08614000
VS2RES   EQU   VS2RESOP                                                 08615000
VSDDNAME EQU   VS2AGL+37                                                08616000
VSVTOCPT EQU   VS2AGL+48                                                08617000
VS1AGL   EQU   0                                                        08618000
VSUCBP   EQU   VS1AGL+8                                                 08619000
VSVOLP   EQU   VS1AGL+12                                                08620000
VSFILEP  EQU   VS1AGL+16                                                08621000
VSIOP    EQU   VS1AGL+20                                                08622000
VSPFILEP EQU   VS1AGL+48                                                08623000
VSSECOPT EQU   VS1AGL+68                                                08624000
VSNOVSAM EQU   VSSECOPT                                                 08625000
VSWRITE  EQU   VSSECOPT                                                 08626000
VSVTOPT  EQU   VS1AGL+69                                                08627000
VSCATOPT EQU   VS1AGL+70                                                08628000
VSRETURN EQU   VS1AGL+71                                                08629000
VSMSG    EQU   VS1AGL+72                                                08630000
VSRESOPT EQU   VS1AGL+73                                                08631000
VSRES    EQU   VSRESOPT                                                 08632000
RCTAGL   EQU   0                                                        08633000
RCTOPT   EQU   RCTAGL+8                                                 08634000
STAEPARM EQU   0                                                        08635000
STARCVY  EQU   STAEPARM+52                                              08636000
STARETRY EQU   STAEPARM+53                                              08637000
VOLLABEL EQU   0                                                        08638000
SV82LIST EQU   0                                                        08639000
@NM00074 EQU   SV82LIST+4                                               08640000
SV82DCBP EQU   @NM00074                                                 08641000
@NM00075 EQU   SV82LIST+12                                              08642000
SV82WRKP EQU   @NM00075                                                 08643000
SRTAGL   EQU   0                                                        08644000
LCTINFO  EQU   0                                                        08645000
LCTFLAGS EQU   LCTINFO+32                                               08646000
UCTAGL   EQU   0                                                        08647000
UCTFLAGS EQU   UCTAGL+68                                                08648000
SELAGL   EQU   0                                                        08649000
SELUCBP  EQU   SELAGL+8                                                 08650000
SELDDNP  EQU   SELAGL+12                                                08651000
SELVOL   EQU   SELAGL+16                                                08652000
SELFLAGS EQU   SELAGL+22                                                08653000
DATESAGL EQU   0                                                        08654000
DATESOPT EQU   DATESAGL+20                                              08655000
VS3AGL   EQU   0                                                        08656000
VS3FLAGS EQU   VS3AGL+58                                                08657000
VSDVTOC  EQU   0                                                        08658000
VSDSTAT  EQU   0                                                        08659000
VSDSFLG1 EQU   VSDSTAT+16                                               08660000
VSDFLG2  EQU   VSDSTAT+17                                               08661000
VSDSCR   EQU   0                                                        08662000
VSDSCRFL EQU   VSDSCR+4                                                 08663000
VSDUSAGE EQU   0                                                        08664000
VSDDORG  EQU   VSDUSAGE+9                                               08665000
VSDALLOC EQU   VSDUSAGE+10                                              08666000
VSDUSEF  EQU   VSDUSAGE+11                                              08667000
VSDDSORG EQU   VSDUSAGE+16                                              08668000
VSDBLOCK EQU   0                                                        08669000
VSDSPACE EQU   VSDBLOCK+12                                              08670000
VSDARRAY EQU   VSDBLOCK+16                                              08671000
VSDVARY  EQU   VSDARRAY+48                                              08672000
BASEV    EQU   0                                                        08673000
BASNAME  EQU   BASEV                                                    08674000
BASID    EQU   BASNAME+11                                               08675000
BASFLAGA EQU   BASEV+14                                                 08676000
BASTYPE  EQU   BASFLAGA                                                 08677000
BASDLSF  EQU   BASFLAGA+2                                               08678000
BASGRPV  EQU   BASFLAGA+2                                               08679000
BASGENUS EQU   BASFLAGA+2                                               08680000
BASRSTD  EQU   BASFLAGA+2                                               08681000
BASINAC  EQU   BASFLAGA+2                                               08682000
BASBIND  EQU   BASFLAGA+2                                               08683000
BASEXCL  EQU   BASFLAGA+2                                               08684000
BASDAERA EQU   BASFLAGA+3                                               08685000
BASRONLY EQU   BASFLAGA+3                                               08686000
BASRCVYF EQU   BASEV+20                                                 08687000
BASSATIA EQU   BASRCVYF                                                 08688000
BASIVCRE EQU   BASSATIA                                                 08689000
BASIVCPY EQU   BASSATIA                                                 08690000
BASVSMIS EQU   BASSATIA                                                 08691000
BASMISCF EQU   BASRCVYF+2                                               08692000
BASCSN1  EQU   BASEV+24                                                 08693000
BASLIB1  EQU   BASEV+36                                                 08694000
BASLID1  EQU   BASLIB1                                                  08695000
BASLIB2  EQU   BASEV+49                                                 08696000
BASLID2  EQU   BASLIB2                                                  08697000
BASNBKUP EQU   BASEV+63                                                 08698000
BASBKLMT EQU   BASEV+64                                                 08699000
BASKLCPY EQU   BASEV+76                                                 08700000
BASCOPID EQU   BASKLCPY+11                                              08701000
BASEXPDT EQU   BASEV+96                                                 08702000
BASDESCR EQU   BASEV+104                                                08703000
BASOWNER EQU   BASEV+134                                                08704000
BASRECOV EQU   BASEV+174                                                08705000
BASGROUP EQU   BASEV+180                                                08706000
GROUP    EQU   0                                                        08707000
GRONAME  EQU   GROUP                                                    08708000
GROVVGRP EQU   GRONAME+3                                                08709000
GROID    EQU   GRONAME+11                                               08710000
GROFLAGA EQU   GROUP+13                                                 08711000
GROTYPE  EQU   GROFLAGA                                                 08712000
GROBIND  EQU   GROFLAGA+2                                               08713000
GROEXCL  EQU   GROFLAGA+2                                               08714000
GRODAERA EQU   GROFLAGA+2                                               08715000
GRORONLY EQU   GROFLAGA+2                                               08716000
GROERRTS EQU   GROUP+56                                                 08717000
RVVI     EQU   0                                                        08718000
RVVLNGTH EQU   RVVI                                                     08719000
RVVOPCOD EQU   RVVI+4                                                   08720000
RVVCODE  EQU   RVVOPCOD                                                 08721000
RVVOLUME EQU   RVVI+8                                                   08722000
RVVGROUP EQU   RVVI+14                                                  08723000
RVVBUFLN EQU   RVVI+30                                                  08724000
RVVRTBUF EQU   RVVI+32                                                  08725000
RVVFLAGA EQU   RVVI+58                                                  08726000
RVVRMODE EQU   RVVFLAGA                                                 08727000
RVVRDR   EQU   RVVRMODE                                                 08728000
RVVCHAIN EQU   RVVFLAGA+1                                               08729000
RVVRDRCD EQU   RVVFLAGA+2                                               08730000
RVVBVRCD EQU   RVVRDRCD                                                 08731000
RVVGRPRC EQU   RVVRDRCD                                                 08732000
RVVRTEST EQU   RVVFLAGA+3                                               08733000
RVVCPYTP EQU   RVVFLAGA+4                                               08734000
RVVSPEC  EQU   RVVFLAGA+5                                               08735000
RVVSGRP  EQU   RVVSPEC                                                  08736000
RVVSVOL  EQU   RVVSPEC                                                  08737000
DEFVE    EQU   0                                                        08738000
DEFLNGTH EQU   DEFVE                                                    08739000
DEFGROUP EQU   DEFVE+4                                                  08740000
DEFDESCR EQU   DEFVE+12                                                 08741000
DEFTO    EQU   DEFVE+42                                                 08742000
DEFFOR   EQU   DEFVE+46                                                 08743000
DEFBKUPN EQU   DEFVE+48                                                 08744000
DEFLABEL EQU   DEFVE+49                                                 08745000
DEFFLAGA EQU   DEFVE+55                                                 08746000
DEFPFOR  EQU   DEFFLAGA                                                 08747000
DEFPVLAB EQU   DEFFLAGA                                                 08748000
DEFPGRO  EQU   DEFFLAGA                                                 08749000
DEFPDESC EQU   DEFFLAGA                                                 08750000
DEFPTO   EQU   DEFFLAGA                                                 08751000
DEFPBKUP EQU   DEFFLAGA                                                 08752000
DEFFLAGB EQU   DEFVE+56                                                 08753000
DEFSETFL EQU   DEFFLAGB                                                 08754000
DEFSRCVY EQU   DEFSETFL                                                 08755000
DEFCRCVY EQU   DEFSETFL                                                 08756000
DEFRECFL EQU   DEFFLAGB+1                                               08757000
DEFLAMIS EQU   DEFRECFL                                                 08758000
DEFTYPFL EQU   DEFFLAGB+2                                               08759000
DEFGENUS EQU   DEFTYPFL                                                 08760000
DEFRSTD  EQU   DEFTYPFL                                                 08761000
DEFNULFL EQU   DEFFLAGB+3                                               08762000
DEFNGRP  EQU   DEFNULFL                                                 08763000
DEFNDESC EQU   DEFNULFL                                                 08764000
DEFNEXPD EQU   DEFNULFL                                                 08765000
MVR      EQU   0                                                        08766000
MVRLNGTH EQU   MVR                                                      08767000
MVRCODE  EQU   MVR+4                                                    08768000
MVRFLAGA EQU   MVR+8                                                    08769000
MVRFLFOR EQU   MVRFLAGA                                                 08770000
MVRFLGRO EQU   MVRFLAGA                                                 08771000
MVRFLBAS EQU   MVRFLAGA                                                 08772000
MVRFLDES EQU   MVRFLAGA                                                 08773000
MVRFLTO  EQU   MVRFLAGA                                                 08774000
MVRFLBK  EQU   MVRFLAGA                                                 08775000
MVRFLLAB EQU   MVRFLAGA                                                 08776000
MVRGEN   EQU   MVRFLAGA+1                                               08777000
MVRRSTD  EQU   MVRFLAGA+1                                               08778000
MVRNGRP  EQU   MVRFLAGA+1                                               08779000
MVRNDESC EQU   MVRFLAGA+1                                               08780000
MVRNEXPD EQU   MVRFLAGA+1                                               08781000
MVRCLMIS EQU   MVRFLAGA+1                                               08782000
MVRBVOL  EQU   MVR+12                                                   08783000
MVRFOR   EQU   MVR+18                                                   08784000
MVRGROUP EQU   MVR+20                                                   08785000
MVRDES   EQU   MVR+28                                                   08786000
MVRTO    EQU   MVR+58                                                   08787000
MVRBKUPN EQU   MVR+74                                                   08788000
MVRLABEL EQU   MVR+76                                                   08789000
DEFLIST  EQU   0                                                        08790000
DEFVFLG  EQU   DEFLIST+6                                                08791000
DEFVRNM  EQU   DEFVFLG                                                  08792000
DEFVREP  EQU   DEFVFLG                                                  08793000
DEFVRNTR EQU   DEFVFLG                                                  08794000
DEFVACT  EQU   DEFVFLG                                                  08795000
DEFVLIB  EQU   DEFLIST+7                                                08796000
DEFVOLD  EQU   DEFLIST+8                                                08797000
DEFVVFLG EQU   DEFLIST+14                                               08798000
DEFVSEC  EQU   DEFVVFLG                                                 08799000
DEFVEXCL EQU   DEFVVFLG                                                 08800000
DEFVBIND EQU   DEFVVFLG                                                 08801000
DEFVWINH EQU   DEFVVFLG                                                 08802000
DEFVNVOL EQU   DEFLIST+16                                               08803000
DEFVCSN1 EQU   DEFLIST+24                                               08804000
DEFVDATA EQU   DEFLIST+56                                               08805000
DEFOWNID EQU   DEFVDATA+29                                              08806000
DEFVVEXT EQU   DEFLIST+128                                              08807000
VOL      EQU   0                                                        08808000
VOLVAL   EQU   VOL+1                                                    08809000
NEWSR    EQU   0                                                        08810000
NEWSRVAL EQU   NEWSR+1                                                  08811000
OWNER    EQU   0                                                        08812000
OWNERVAL EQU   OWNER+1                                                  08813000
GRP      EQU   0                                                        08814000
GRPVAL   EQU   GRP+1                                                    08815000
GNRL     EQU   0                                                        08816000
RSTR     EQU   0                                                        08817000
BIND     EQU   0                                                        08818000
NBIND    EQU   0                                                        08819000
EXECL    EQU   0                                                        08820000
SHRD     EQU   0                                                        08821000
RONLY    EQU   0                                                        08822000
RW       EQU   0                                                        08823000
DERAS    EQU   0                                                        08824000
NDERS    EQU   0                                                        08825000
DESCR    EQU   0                                                        08826000
DESCRVAL EQU   DESCR+1                                                  08827000
TO       EQU   0                                                        08828000
TOVAL    EQU   TO                                                       08829000
BKUP     EQU   0                                                        08830000
BKUPVAL  EQU   BKUP                                                     08831000
NOWN     EQU   0                                                        08832000
NGRP     EQU   0                                                        08833000
NDESC    EQU   0                                                        08834000
NRET     EQU   0                                                        08835000
FYLE     EQU   0                                                        08836000
FYLEVAL  EQU   FYLE+1                                                   08837000
PSWD     EQU   0                                                        08838000
@NM00122 EQU   PSWD+2                                                   08839000
FORE     EQU   0                                                        08840000
FOREVAL  EQU   FORE                                                     08841000
RLBL     EQU   0                                                        08842000
VADDR    EQU   0                                                        08843000
VADDRVAL EQU   VADDR                                                    08844000
AMSTP041 EQU   0                                                        08845000
AMSTP042 EQU   0                                                        08846000
AMSTP043 EQU   0                                                        08847000
AMSTP044 EQU   0                                                        08848000
IDCIOCO0 EQU   0                                                        08849000
IDCIOGT0 EQU   0                                                        08850000
IDCIOIT0 EQU   0                                                        08851000
IDCIOOP0 EQU   0                                                        08852000
IDCIOPO0 EQU   0                                                        08853000
IDCIOPT0 EQU   0                                                        08854000
IDCIOSI0 EQU   0                                                        08855000
IDCIOST0 EQU   0                                                        08856000
IDCIOTM0 EQU   0                                                        08857000
IDCIOVY0 EQU   0                                                        08858000
IDCSACA0 EQU   0                                                        08859000
IDCSACR0 EQU   0                                                        08860000
IDCSADE0 EQU   0                                                        08861000
IDCSAFP0 EQU   0                                                        08862000
IDCSAFS0 EQU   0                                                        08863000
IDCSAGP0 EQU   0                                                        08864000
IDCSAGS0 EQU   0                                                        08865000
IDCSAID0 EQU   0                                                        08866000
IDCSALC0 EQU   0                                                        08867000
IDCSALD0 EQU   0                                                        08868000
IDCSALK0 EQU   0                                                        08869000
IDCSAPR0 EQU   0                                                        08870000
IDCSAPT0 EQU   0                                                        08871000
IDCSAQL0 EQU   0                                                        08872000
IDCSARC0 EQU   0                                                        08873000
IDCSARK0 EQU   0                                                        08874000
IDCSARV0 EQU   0                                                        08875000
IDCSASC0 EQU   0                                                        08876000
IDCSASI0 EQU   0                                                        08877000
IDCSASN0 EQU   0                                                        08878000
IDCSAST0 EQU   0                                                        08879000
IDCSATI0 EQU   0                                                        08880000
IDCSAUC0 EQU   0                                                        08881000
IDCSAWO0 EQU   0                                                        08882000
IDCST010 EQU   0                                                        08883000
IDCTPER0 EQU   0                                                        08884000
LISTTEST EQU   0                                                        08885000
NEWERID1 EQU   5                                                        08886000
NULFY    EQU   0                                                        08887000
GDTTBL   EQU   0                                                        08888000
GDTTR1   EQU   GDTTBL+8                                                 08889000
GDTTR2   EQU   GDTTBL+12                                                08890000
GDTDBG   EQU   GDTTBL+40                                                08891000
GDTSTC   EQU   GDTTBL+44                                                08892000
GDTPRT   EQU   GDTTBL+48                                                08893000
GDTESS   EQU   GDTTBL+52                                                08894000
GDTESA   EQU   GDTTBL+56                                                08895000
GDTRST   EQU   GDTTBL+60                                                08896000
GDTRES   EQU   GDTTBL+64                                                08897000
GDTCAL   EQU   GDTTBL+68                                                08898000
GDTGSP   EQU   GDTTBL+72                                                08899000
GDTFSP   EQU   GDTTBL+76                                                08900000
GDTGPL   EQU   GDTTBL+80                                                08901000
GDTFPL   EQU   GDTTBL+84                                                08902000
GDTLOD   EQU   GDTTBL+88                                                08903000
GDTDEL   EQU   GDTTBL+92                                                08904000
GDTPRL   EQU   GDTTBL+96                                                08905000
GDTEPL   EQU   GDTTBL+100                                               08906000
GDTTIM   EQU   GDTTBL+104                                               08907000
GDTIIO   EQU   GDTTBL+108                                               08908000
GDTTIO   EQU   GDTTBL+112                                               08909000
GDTOPN   EQU   GDTTBL+124                                               08910000
GDTCLS   EQU   GDTTBL+128                                               08911000
GDTGET   EQU   GDTTBL+132                                               08912000
GDTPUT   EQU   GDTTBL+136                                               08913000
GDTPOS   EQU   GDTTBL+140                                               08914000
GDTCPY   EQU   GDTTBL+144                                               08915000
GDTCAT   EQU   GDTTBL+148                                               08916000
GDTSNP   EQU   GDTTBL+164                                               08917000
GDTVFY   EQU   GDTTBL+172                                               08918000
GDTUID   EQU   GDTTBL+192                                               08919000
GDTPMT   EQU   GDTTBL+196                                               08920000
GDTCIR   EQU   GDTTBL+200                                               08921000
GDTLNK   EQU   GDTTBL+204                                               08922000
GDTALC   EQU   GDTTBL+208                                               08923000
GDTDLC   EQU   GDTTBL+212                                               08924000
GDTQAL   EQU   GDTTBL+216                                               08925000
GDTSTW   EQU   GDTTBL+220                                               08926000
GDTSSC   EQU   GDTTBL+224                                               08927000
GDTENQ   EQU   GDTTBL+228                                               08928000
GDTRSV   EQU   GDTTBL+232                                               08929000
GDTDEQ   EQU   GDTTBL+236                                               08930000
GDTSFO   EQU   GDTTBL+240                                               08931000
GDTWTO   EQU   GDTTBL+244                                               08932000
GDTSCR   EQU   GDTTBL+248                                               08933000
GDTUNT   EQU   GDTTBL+252                                               08934000
GDTRCT   EQU   GDTTBL+256                                               08935000
GDTIFO   EQU   GDTTBL+260                                               08936000
GDTEXP   EQU   GDTTBL+264                                               08937000
GDTSTA   EQU   GDTTBL+268                                               08938000
GDTERR   EQU   GDTTBL+272                                               08939000
GDTUNC   EQU   GDTTBL+276                                               08940000
GDTLOC   EQU   GDTTBL+280                                               08941000
GDTRCK   EQU   GDTTBL+284                                               08942000
FDTTBL   EQU   0                                                        08943000
FDTPTR   EQU   FDTTBL+8                                                 08944000
LASTCOND EQU   0                                                        08945000
VOLARG   EQU   0                                                        08946000
SSRCODE  EQU   0                                                        08947000
SSRHALF  EQU   SSRCODE+2                                                08948000
SSECBCD  EQU   0                                                        08949000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08950000
@NM00127 EQU   SSRCODE                                                  08951000
FDTVERB  EQU   FDTTBL                                                   08952000
GDTECT   EQU   GDTTBL+188                                               08953000
GDTPSB   EQU   GDTTBL+184                                               08954000
GDTUPT   EQU   GDTTBL+180                                               08955000
GDTCMB   EQU   GDTTBL+176                                               08956000
GDTSPR   EQU   GDTTBL+168                                               08957000
@NM00001 EQU   GDTTBL+160                                               08958000
GDTABH   EQU   GDTTBL+156                                               08959000
GDTABT   EQU   GDTTBL+152                                               08960000
GDTTOH   EQU   GDTTBL+120                                               08961000
GDTRIP   EQU   GDTTBL+116                                               08962000
GDTIOH   EQU   GDTTBL+36                                                08963000
GDTSAH   EQU   GDTTBL+32                                                08964000
GDTTPH   EQU   GDTTBL+28                                                08965000
GDTRIH   EQU   GDTTBL+24                                                08966000
GDTSTH   EQU   GDTTBL+20                                                08967000
GDTDBH   EQU   GDTTBL+16                                                08968000
GDTPRM   EQU   GDTTBL+4                                                 08969000
GDTHDR   EQU   GDTTBL                                                   08970000
PSWDVAL  EQU   @NM00122+1                                               08971000
PSWDLEN  EQU   @NM00122                                                 08972000
PSWDCNT  EQU   PSWD                                                     08973000
FYLELEN  EQU   FYLE                                                     08974000
DESCRLEN EQU   DESCR                                                    08975000
GRPLEN   EQU   GRP                                                      08976000
OWNERLEN EQU   OWNER                                                    08977000
NEWSRLEN EQU   NEWSR                                                    08978000
VOLLEN   EQU   VOL                                                      08979000
DEFTLAB  EQU   DEFVDATA+71                                              08980000
DEFR60   EQU   DEFVDATA+43                                              08981000
DEFR55   EQU   DEFVDATA+3                                               08982000
DEFACSEC EQU   DEFVDATA+2                                               08983000
DEFR50   EQU   DEFVDATA                                                 08984000
DEFVECB  EQU   DEFLIST+52                                               08985000
DEFVASID EQU   DEFLIST+50                                               08986000
@NM00121 EQU   DEFLIST+48                                               08987000
DEFVCSN2 EQU   DEFLIST+36                                               08988000
@NM00120 EQU   DEFLIST+22                                               08989000
@NM00119 EQU   DEFLIST+15                                               08990000
@NM00118 EQU   DEFVVFLG                                                 08991000
@NM00117 EQU   DEFVVFLG                                                 08992000
@NM00116 EQU   DEFVVFLG                                                 08993000
DEFVCECT EQU   DEFVVFLG                                                 08994000
DEFVLID  EQU   DEFVLIB                                                  08995000
@NM00115 EQU   DEFVLIB                                                  08996000
DEFVDACT EQU   DEFVFLG                                                  08997000
DEFVELTR EQU   DEFVFLG                                                  08998000
DEFVELM  EQU   DEFVFLG                                                  08999000
DEFVCR   EQU   DEFVFLG                                                  09000000
@NM00114 EQU   DEFLIST+5                                                09001000
DEFVOPCD EQU   DEFLIST+4                                                09002000
DEFVLEN  EQU   DEFLIST                                                  09003000
@NM00113 EQU   MVR+82                                                   09004000
MVRBLNK1 EQU   MVR+75                                                   09005000
MVRCSN   EQU   MVR+62                                                   09006000
@NM00112 EQU   MVRFLAGA+2                                               09007000
MVRCICPY EQU   MVRFLAGA+2                                               09008000
MVRCIVCF EQU   MVRFLAGA+2                                               09009000
MVRSLMIS EQU   MVRFLAGA+1                                               09010000
MVRBKUP  EQU   MVRFLAGA+1                                               09011000
MVRFLCSN EQU   MVRFLAGA                                                 09012000
@NM00111 EQU   MVRCODE+1                                                09013000
MVROPCD  EQU   MVRCODE                                                  09014000
@NM00110 EQU   DEFVE+60                                                 09015000
@NM00109 EQU   DEFNULFL                                                 09016000
@NM00108 EQU   DEFTYPFL                                                 09017000
DEFCOPY  EQU   DEFTYPFL                                                 09018000
DEFDUP   EQU   DEFTYPFL                                                 09019000
@NM00107 EQU   DEFRECFL                                                 09020000
DEFCREAT EQU   DEFRECFL                                                 09021000
DEFICOPY EQU   DEFRECFL                                                 09022000
@NM00106 EQU   DEFSETFL                                                 09023000
@NM00105 EQU   DEFFLAGA                                                 09024000
@NM00104 EQU   RVVI+64                                                  09025000
RVVSDUP  EQU   RVVSPEC                                                  09026000
RVVSCPY  EQU   RVVSPEC                                                  09027000
RVVSCSN  EQU   RVVSPEC                                                  09028000
RVVSSEQ  EQU   RVVSPEC                                                  09029000
RVVSDTE  EQU   RVVSPEC                                                  09030000
RVVSEXP  EQU   RVVSPEC                                                  09031000
@NM00103 EQU   RVVCPYTP                                                 09032000
RVVCPLHD EQU   RVVCPYTP                                                 09033000
RVVLCOPY EQU   RVVCPYTP                                                 09034000
RVVOBKUP EQU   RVVCPYTP                                                 09035000
RVVLBKUP EQU   RVVCPYTP                                                 09036000
RVVBPLHD EQU   RVVRTEST                                                 09037000
RVVDVOL  EQU   RVVRTEST                                                 09038000
RVVACTV  EQU   RVVRTEST                                                 09039000
RVVINACT EQU   RVVRTEST                                                 09040000
RVVRSTD  EQU   RVVRTEST                                                 09041000
RVVGSVOL EQU   RVVRTEST                                                 09042000
RVVTHOLD EQU   RVVRTEST                                                 09043000
RVVEXPDT EQU   RVVRTEST                                                 09044000
RVVALL   EQU   RVVRDRCD                                                 09045000
RVVCPURC EQU   RVVRDRCD                                                 09046000
RVVCIRCD EQU   RVVRDRCD                                                 09047000
RVVRUNKN EQU   RVVRDRCD                                                 09048000
RVVDUPRC EQU   RVVRDRCD                                                 09049000
RVVCPYRC EQU   RVVRDRCD                                                 09050000
@NM00102 EQU   RVVCHAIN                                                 09051000
RVVNGVOL EQU   RVVCHAIN                                                 09052000
RVVGPVOL EQU   RVVCHAIN                                                 09053000
@NM00101 EQU   RVVRMODE                                                 09054000
RVVRDCH  EQU   RVVRMODE                                                 09055000
RVVRDNR  EQU   RVVRMODE                                                 09056000
RVVDUPID EQU   RVVI+57                                                  09057000
RVVCPYID EQU   RVVI+56                                                  09058000
RVVRDCSN EQU   RVVI+44                                                  09059000
RVVRDSEQ EQU   RVVI+43                                                  09060000
RVVBLNK1 EQU   RVVI+42                                                  09061000
RVVCDATE EQU   RVVI+38                                                  09062000
RVVEXPIR EQU   RVVI+36                                                  09063000
@NM00100 EQU   RVVI+28                                                  09064000
RVVAREA  EQU   RVVI+24                                                  09065000
RVVARLN  EQU   RVVI+22                                                  09066000
@NM00099 EQU   RVVOPCOD+1                                               09067000
@NM00098 EQU   GROUP+136                                                09068000
GROADDR  EQU   GROUP+106                                                09069000
GROOWNER EQU   GROUP+96                                                 09070000
GRORESSP EQU   GROUP+95                                                 09071000
GROCONUS EQU   GROUP+94                                                 09072000
GRODESCR EQU   GROUP+64                                                 09073000
GROERRTM EQU   GROERRTS+4                                               09074000
GROERRDT EQU   GROERRTS                                                 09075000
GRORETPD EQU   GROUP+52                                                 09076000
GROFREXT EQU   GROUP+48                                                 09077000
GROFRESP EQU   GROUP+44                                                 09078000
GROSTRSH EQU   GROUP+40                                                 09079000
GROSSPD  EQU   GROUP+38                                                 09080000
GROPSPD  EQU   GROUP+36                                                 09081000
GRONINAC EQU   GROUP+34                                                 09082000
GRONRSTD EQU   GROUP+32                                                 09083000
GRONGEN  EQU   GROUP+30                                                 09084000
GROPCENT EQU   GROUP+29                                                 09085000
GROLSN   EQU   GROUP+23                                                 09086000
GROFSN   EQU   GROUP+17                                                 09087000
@NM00097 EQU   GROFLAGA+2                                               09088000
GROMSG1  EQU   GROFLAGA+2                                               09089000
GRORETN  EQU   GROFLAGA+2                                               09090000
GRORLSE  EQU   GROFLAGA+2                                               09091000
GRORES1  EQU   GROTYPE                                                  09092000
GROGVR   EQU   GROTYPE                                                  09093000
GROZERO  EQU   GROID+1                                                  09094000
GROBLANK EQU   GROID                                                    09095000
GROG     EQU   GRONAME                                                  09096000
@NM00096 EQU   BASEV+192                                                09097000
BASXPDT2 EQU   BASEV+188                                                09098000
BASDEST  EQU   BASEV+144                                                09099000
BASDTREM EQU   BASEV+100                                                09100000
BASDLMTD EQU   BASEV+92                                                 09101000
BASRES6  EQU   BASEV+89                                                 09102000
BASCOPNO EQU   BASCOPID+1                                               09103000
BASCOPBK EQU   BASCOPID                                                 09104000
BASCOPSN EQU   BASKLCPY+5                                               09105000
BASCOPV  EQU   BASKLCPY                                                 09106000
BASFREXT EQU   BASEV+72                                                 09107000
BASLEXT  EQU   BASEV+70                                                 09108000
BASFRESP EQU   BASEV+68                                                 09109000
@NM00095 EQU   BASEV+65                                                 09110000
BASNCOPY EQU   BASEV+62                                                 09111000
BASNEXTV EQU   BASEV+56                                                 09112000
BASPREV  EQU   BASEV+50                                                 09113000
BAS2BIT2 EQU   BASLID2                                                  09114000
BAS2BIT1 EQU   BASLID2                                                  09115000
BASRES5  EQU   BASLIB2                                                  09116000
BASCSN2  EQU   BASEV+37                                                 09117000
BAS1BIT2 EQU   BASLID1                                                  09118000
BAS1BIT1 EQU   BASLID1                                                  09119000
BASRES4  EQU   BASLIB1                                                  09120000
BASRES3  EQU   BASMISCF                                                 09121000
BASHOLD  EQU   BASMISCF                                                 09122000
BASRES8  EQU   BASSATIA                                                 09123000
BASCPUID EQU   BASEV+18                                                 09124000
@NM00094 EQU   BASFLAGA+3                                               09125000
BASLAST  EQU   BASFLAGA+3                                               09126000
BASFIRST EQU   BASFLAGA+3                                               09127000
BASREASS EQU   BASFLAGA+3                                               09128000
BASNOCPY EQU   BASFLAGA+2                                               09129000
BASRES2  EQU   BASTYPE                                                  09130000
BASBASVR EQU   BASTYPE                                                  09131000
BASRES1  EQU   BASTYPE                                                  09132000
BASRES7  EQU   BASEV+13                                                 09133000
BASZERO  EQU   BASID+1                                                  09134000
BASBLANK EQU   BASID                                                    09135000
BASSERNO EQU   BASNAME+5                                                09136000
BASEVKEY EQU   BASNAME                                                  09137000
VSDDSN   EQU   VSDARRAY+4                                               09138000
VSDVOLCT EQU   VSDARRAY                                                 09139000
VSDFMT0  EQU   VSDBLOCK+8                                               09140000
VSDVTOCS EQU   VSDBLOCK+4                                               09141000
VSDELEM  EQU   VSDBLOCK                                                 09142000
VSDFREE  EQU   VSDUSAGE+24                                              09143000
VSDALLC  EQU   VSDUSAGE+19                                              09144000
VSDDSOR3 EQU   VSDDSORG+2                                               09145000
@NM00093 EQU   VSDDSORG                                                 09146000
VSDSCAL  EQU   VSDUSAGE+12                                              09147000
@NM00092 EQU   VSDUSEF                                                  09148000
VSDCALFR EQU   VSDUSEF                                                  09149000
@NM00091 EQU   VSDALLOC                                                 09150000
VSDABSTR EQU   VSDALLOC                                                 09151000
VSDABLK  EQU   VSDALLOC                                                 09152000
VSDATRK  EQU   VSDALLOC                                                 09153000
VSDACYL  EQU   VSDALLOC                                                 09154000
@NM00090 EQU   VSDDORG                                                  09155000
VSDOU    EQU   VSDDORG                                                  09156000
VSDOIS   EQU   VSDDORG                                                  09157000
VSDODA   EQU   VSDDORG                                                  09158000
VSDOUN   EQU   VSDDORG                                                  09159000
VSDOPS   EQU   VSDDORG                                                  09160000
VSDOPO   EQU   VSDDORG                                                  09161000
VSDEXTS  EQU   VSDUSAGE+8                                               09162000
VSDSECAL EQU   VSDUSAGE+4                                               09163000
VSDFTRK  EQU   VSDUSAGE+2                                               09164000
VSDTRKS  EQU   VSDUSAGE                                                 09165000
@NM00089 EQU   VSDSCR+5                                                 09166000
@NM00088 EQU   VSDSCRFL                                                 09167000
VSDVSAM  EQU   VSDSCRFL                                                 09168000
VSDCATLC EQU   VSDSCRFL                                                 09169000
VSDACBPT EQU   VSDSCR                                                   09170000
@NM00087 EQU   VSDSTAT+29                                               09171000
VSDPRTC  EQU   VSDSTAT+25                                               09172000
VSDCAT   EQU   VSDSTAT+22                                               09173000
VSDEXP   EQU   VSDSTAT+20                                               09174000
VSDCRE   EQU   VSDSTAT+18                                               09175000
@NM00086 EQU   VSDFLG2                                                  09176000
VSDRACF  EQU   VSDFLG2                                                  09177000
VSDERROR EQU   VSDFLG2                                                  09178000
VSDPROT  EQU   VSDFLG2                                                  09179000
VSDPWW   EQU   VSDFLG2                                                  09180000
VSDPWR   EQU   VSDFLG2                                                  09181000
@NM00085 EQU   VSDSFLG1                                                 09182000
VSDCVSAM EQU   VSDSFLG1                                                 09183000
VSDCATLG EQU   VSDSFLG1                                                 09184000
VSDVSAME EQU   VSDSFLG1                                                 09185000
VSDVSAMC EQU   VSDSFLG1                                                 09186000
VSDVTOCE EQU   VSDSFLG1                                                 09187000
VSDVTOCC EQU   VSDSFLG1                                                 09188000
VSDOWNER EQU   VSDSTAT+8                                                09189000
VSDEXPIR EQU   VSDSTAT+4                                                09190000
VSDCREAT EQU   VSDSTAT                                                  09191000
VSDFRCCL EQU   VSDVTOC+21                                               09192000
@NM00084 EQU   VSDVTOC+20                                               09193000
VSDFREXT EQU   VSDVTOC+16                                               09194000
@NM00083 EQU   VSDVTOC+15                                               09195000
VSDFRTRK EQU   VSDVTOC+11                                               09196000
@NM00082 EQU   VSDVTOC+10                                               09197000
VSDFRCYL EQU   VSDVTOC+6                                                09198000
@NM00081 EQU   VSDVTOC                                                  09199000
@NM00080 EQU   VS3FLAGS                                                 09200000
VS3SYSNM EQU   VS3FLAGS                                                 09201000
VS3UNCAT EQU   VS3FLAGS                                                 09202000
VS3SCR   EQU   VS3FLAGS                                                 09203000
VS3USAGE EQU   VS3FLAGS                                                 09204000
VS3STAT  EQU   VS3FLAGS                                                 09205000
VS3DD    EQU   VS3AGL+50                                                09206000
VS3VOL   EQU   VS3AGL+44                                                09207000
VS3POOL  EQU   VS3AGL+40                                                09208000
VS3DEV   EQU   VS3AGL+36                                                09209000
VS3UCBP  EQU   VS3AGL+32                                                09210000
VS3CREAT EQU   VS3AGL+28                                                09211000
VS3EXPIR EQU   VS3AGL+24                                                09212000
VS3AST   EQU   VS3AGL+22                                                09213000
VS3LEVLN EQU   VS3AGL+20                                                09214000
VS3LEVP  EQU   VS3AGL+16                                                09215000
VS3EXDSP EQU   VS3AGL+12                                                09216000
VS3LISTP EQU   VS3AGL+8                                                 09217000
VS3HEAD  EQU   VS3AGL                                                   09218000
@NM00079 EQU   DATESOPT                                                 09219000
DATDAYOP EQU   DATESOPT                                                 09220000
DATDTEOP EQU   DATESOPT                                                 09221000
DATSUB   EQU   DATESOPT                                                 09222000
DATADD   EQU   DATESOPT                                                 09223000
DATRETRN EQU   DATESAGL+16                                              09224000
DATDAYS  EQU   DATESAGL+12                                              09225000
DATDATE  EQU   DATESAGL+8                                               09226000
DATHEAD  EQU   DATESAGL                                                 09227000
@NM00078 EQU   SELFLAGS                                                 09228000
SELHEAD  EQU   SELAGL                                                   09229000
@NM00077 EQU   UCTFLAGS                                                 09230000
UCTVSCAT EQU   UCTFLAGS                                                 09231000
UCTDD    EQU   UCTAGL+60                                                09232000
UCTVOLP  EQU   UCTAGL+56                                                09233000
UCTACBP  EQU   UCTAGL+52                                                09234000
UCTDSN   EQU   UCTAGL+8                                                 09235000
UCTHEAD  EQU   UCTAGL                                                   09236000
@NM00076 EQU   LCTFLAGS                                                 09237000
LCTVSCAT EQU   LCTFLAGS                                                 09238000
LCTOWNER EQU   LCTINFO+24                                               09239000
LCTEXPIR EQU   LCTINFO+20                                               09240000
LCTCREAT EQU   LCTINFO+16                                               09241000
LCTACBP  EQU   LCTINFO+12                                               09242000
LCTMULVC EQU   LCTINFO+8                                                09243000
LCTHEAD  EQU   LCTINFO                                                  09244000
SRTWORKP EQU   SRTAGL+28                                                09245000
SRTFLDLN EQU   SRTAGL+24                                                09246000
SRTPOSIT EQU   SRTAGL+20                                                09247000
SRTLEN   EQU   SRTAGL+16                                                09248000
SRTNUM   EQU   SRTAGL+12                                                09249000
SRTADDR  EQU   SRTAGL+8                                                 09250000
SRTHEAD  EQU   SRTAGL                                                   09251000
SV82DEBP EQU   SV82WRKP                                                 09252000
SV82TTRP EQU   SV82LIST+8                                               09253000
SV82VOLP EQU   SV82DCBP                                                 09254000
SV82UCBP EQU   SV82LIST+1                                               09255000
SV82CODE EQU   SV82LIST                                                 09256000
VOLRESV3 EQU   VOLLABEL+55                                              09257000
VOLOWNER EQU   VOLLABEL+45                                              09258000
VOLRESV1 EQU   VOLLABEL+20                                              09259000
VOLVTOC  EQU   VOLLABEL+15                                              09260000
VOLSECTY EQU   VOLLABEL+14                                              09261000
VOLSERNO EQU   VOLLABEL+8                                               09262000
VOLNO    EQU   VOLLABEL+7                                               09263000
VOLLABI  EQU   VOLLABEL+4                                               09264000
VOLKEY   EQU   VOLLABEL                                                 09265000
STAVTTR  EQU   STAEPARM+54                                              09266000
@NM00073 EQU   STARETRY                                                 09267000
STAVTOC  EQU   STARETRY                                                 09268000
STAOFF   EQU   STARETRY                                                 09269000
STAIO05  EQU   STARETRY                                                 09270000
@NM00072 EQU   STARCVY                                                  09271000
STACLEAR EQU   STARCVY                                                  09272000
STAVPOST EQU   STARCVY                                                  09273000
STAVENQ  EQU   STARCVY                                                  09274000
STAVDMNT EQU   STARCVY                                                  09275000
STAVMNT  EQU   STARCVY                                                  09276000
STATCB   EQU   STAEPARM+48                                              09277000
STARTADD EQU   STAEPARM+44                                              09278000
STAEXSAV EQU   STAEPARM+40                                              09279000
STARTSAV EQU   STAEPARM+36                                              09280000
STARTTR  EQU   STAEPARM+32                                              09281000
@NM00071 EQU   STAEPARM+30                                              09282000
STARVOL  EQU   STAEPARM+24                                              09283000
STARUCB  EQU   STAEPARM+20                                              09284000
@NM00070 EQU   STAEPARM+18                                              09285000
STAVVOL  EQU   STAEPARM+12                                              09286000
STAVUCB  EQU   STAEPARM+8                                               09287000
STAHEAD  EQU   STAEPARM                                                 09288000
RCTDSET  EQU   RCTAGL+32                                                09289000
RCTNVOL  EQU   RCTAGL+26                                                09290000
RCTOVOL  EQU   RCTAGL+20                                                09291000
RCTNDEV  EQU   RCTAGL+16                                                09292000
RCTODEV  EQU   RCTAGL+12                                                09293000
@NM00069 EQU   RCTAGL+10                                                09294000
@NM00068 EQU   RCTOPT                                                   09295000
RCTVOL   EQU   RCTOPT                                                   09296000
RCTDEV   EQU   RCTOPT                                                   09297000
RCTHEAD  EQU   RCTAGL                                                   09298000
@NM00067 EQU   VSRESOPT                                                 09299000
VSREAL   EQU   VSRESOPT                                                 09300000
@NM00066 EQU   VSMSG                                                    09301000
VSTOV    EQU   VSMSG                                                    09302000
VSFROMV  EQU   VSMSG                                                    09303000
@NM00065 EQU   VSRETURN                                                 09304000
VSUCAT   EQU   VSRETURN                                                 09305000
VSVSAM   EQU   VSRETURN                                                 09306000
@NM00064 EQU   VSCATOPT                                                 09307000
VSLIST   EQU   VSCATOPT                                                 09308000
VSSERIAL EQU   VSCATOPT                                                 09309000
VSDEVICE EQU   VSCATOPT                                                 09310000
@NM00063 EQU   VSVTOPT                                                  09311000
VSVSFLAG EQU   VSVTOPT                                                  09312000
VSALTTRK EQU   VSVTOPT                                                  09313000
VSTIME   EQU   VSVTOPT                                                  09314000
VSUCMAST EQU   VSSECOPT                                                 09315000
VSOPCAT  EQU   VSSECOPT                                                 09316000
VSUCTEST EQU   VSSECOPT                                                 09317000
VSREAD   EQU   VSSECOPT                                                 09318000
VSNONONV EQU   VSSECOPT                                                 09319000
VSMASTER EQU   VSSECOPT                                                 09320000
VSODEVP  EQU   VS1AGL+64                                                09321000
VSOSERP  EQU   VS1AGL+60                                                09322000
VSDEVP   EQU   VS1AGL+56                                                09323000
VSSERP   EQU   VS1AGL+52                                                09324000
VSPSWDP  EQU   VS1AGL+44                                                09325000
VSCATDDP EQU   VS1AGL+40                                                09326000
VSACBP   EQU   VS1AGL+36                                                09327000
VSCATP   EQU   VS1AGL+32                                                09328000
VSNXTATP EQU   VS1AGL+28                                                09329000
VSNUMATP EQU   VS1AGL+24                                                09330000
VSHEAD   EQU   VS1AGL                                                   09331000
@NM00062 EQU   VS2AGL+45                                                09332000
@NM00061 EQU   VS2RESOP                                                 09333000
VS2REAL  EQU   VS2RESOP                                                 09334000
@NM00060 EQU   VS2MSG                                                   09335000
VS2TOV   EQU   VS2MSG                                                   09336000
@NM00059 EQU   VSLABOPT                                                 09337000
VSVTOCSZ EQU   VS2AGL+12                                                09338000
VS2HEAD  EQU   VS2AGL                                                   09339000
EXPDATAL EQU   EXPARRAY+6                                               09340000
@NM00058 EQU   EXPARRAY+5                                               09341000
EXPKEYLN EQU   EXPARRAY+4                                               09342000
EXPDATAP EQU   EXPARRAY                                                 09343000
EXPRECNO EQU   EXPDATAB                                                 09344000
EXPCCHHR EQU   EXPARG+16                                                09345000
EXPCTLBK EQU   EXPARG+8                                                 09346000
EXPHEAD  EQU   EXPARG                                                   09347000
EXRWFUN  EQU   EXWRARG+46                                               09348000
@NM00057 EQU   EXSPACE+8                                                09349000
@NM00056 EQU   EXSPACE+6                                                09350000
@NM00055 EQU   EXSPACE+4                                                09351000
@NM00054 EQU   EXSPACE+1                                                09352000
@NM00053 EQU   EXSPACE                                                  09353000
EXRWKDLN EQU   EXWRARG+32                                               09354000
@NM00052 EQU   EXWRARG+31                                               09355000
EXRECNUM EQU   EXRWCHR+4                                                09356000
EXHH     EQU   EXRWCHR+2                                                09357000
EXCC     EQU   EXRWCHR                                                  09358000
EXCCWCNT EQU   EXWRARG+24                                               09359000
EXLOCPTR EQU   EXWRARG+20                                               09360000
EXRWDARE EQU   EXWRARG+16                                               09361000
EXRWIOAR EQU   EXWRARG+12                                               09362000
EXRWCTBL EQU   EXWRARG+8                                                09363000
EXRWRES  EQU   EXWRARG                                                  09364000
EXGDATAL EQU   EXGARG+30                                                09365000
@NM00051 EQU   EXGARG+29                                                09366000
EXGKEYLN EQU   EXGARG+28                                                09367000
EXGDATAP EQU   EXGARG+24                                                09368000
EXGRECNO EQU   EXGARG+20                                                09369000
EXGCCHH2 EQU   EXGARG+16                                                09370000
EXGCCHH1 EQU   EXGARG+12                                                09371000
EXGCTLBK EQU   EXGARG+8                                                 09372000
EXGHEAD  EQU   EXGARG                                                   09373000
EXOVTH   EQU   EXFLG                                                    09374000
EXORVT   EQU   EXFLG                                                    09375000
EXORDS   EQU   EXFLG                                                    09376000
EXOSPK   EQU   EXFLG                                                    09377000
EXORVS   EQU   EXFLG                                                    09378000
@NM00050 EQU   EXFLG                                                    09379000
EXOREAD  EQU   EXFLG                                                    09380000
@NM00049 EQU   EXOPT                                                    09381000
EXOREP   EQU   EXOPT                                                    09382000
EXOVTOC  EQU   EXOPT                                                    09383000
EXONEW   EQU   EXOPT                                                    09384000
EXOPASS  EQU   EXOPT                                                    09385000
EXOLAB   EQU   EXOPT                                                    09386000
EXOTAB   EQU   EXOPT                                                    09387000
EXOCTLBK EQU   EXOARG+28                                                09388000
EXOEXT   EQU   EXOARG+24                                                09389000
EXOUCB   EQU   EXOARG+20                                                09390000
EXOVSN   EQU   EXOARG+16                                                09391000
EXODSN   EQU   EXOARG+12                                                09392000
EXODDN   EQU   EXOARG+8                                                 09393000
EXOHEAD  EQU   EXOARG                                                   09394000
@NM00048 EQU   EXCLFLAG                                                 09395000
EXCLHEAD EQU   EXCLAGL                                                  09396000
@NM00047 EQU   CKFLAGS                                                  09397000
CKDMTABL EQU   CKFLAGS                                                  09398000
CKRETTYP EQU   CKFLAGS                                                  09399000
CKLABELP EQU   CKAGL+24                                                 09400000
CKDATYPE EQU   CKAGL+20                                                 09401000
CKHEAD   EQU   CKAGL                                                    09402000
PULABELP EQU   PUAGL+16                                                 09403000
PUTTRPTR EQU   PUAGL+12                                                 09404000
PUUCBPTR EQU   PUAGL+8                                                  09405000
PUHEAD   EQU   PUAGL                                                    09406000
MDR      EQU   MDVTOC+4                                                 09407000
MDHH     EQU   MDVTOC+2                                                 09408000
MDCC     EQU   MDVTOC                                                   09409000
@NM00046 EQU   MDAGL+31                                                 09410000
MDFORCE  EQU   MDFLAGS                                                  09411000
MDDEQ    EQU   MDFLAGS                                                  09412000
MDENQ    EQU   MDFLAGS                                                  09413000
MDPOST   EQU   MDFLAGS                                                  09414000
MDCLEAR  EQU   MDFLAGS                                                  09415000
MDPUAGL  EQU   MDAGL+20                                                 09416000
MDHEAD   EQU   MDAGL                                                    09417000
CTTBLRR  EQU   CTARRAY+3                                                09418000
CTTBLHH  EQU   CTARRAY+2                                                09419000
CTTBLCC  EQU   CTARRAY+1                                                09420000
CTTBLID  EQU   CTARRAY                                                  09421000
CTREALH  EQU   CTMSG+3                                                  09422000
CTREALCC EQU   CTMSG+1                                                  09423000
@NM00045 EQU   CTMSG                                                    09424000
CMCSN2   EQU   CMMSG+28                                                 09425000
CMCSN1   EQU   CMMSG+16                                                 09426000
CMNUMCRT EQU   CMMSG+15                                                 09427000
@NM00044 EQU   CMMSG+14                                                 09428000
CMNEWVOL EQU   CMMSG+8                                                  09429000
@NM00043 EQU   CMMSG+7                                                  09430000
@NM00042 EQU   CMVOLFLG                                                 09431000
CMRONLY  EQU   CMVOLFLG                                                 09432000
CMBIND   EQU   CMVOLFLG                                                 09433000
CMSCRCRT EQU   CMVOLFLG                                                 09434000
CMEXCL   EQU   CMVOLFLG                                                 09435000
CMDERAS  EQU   CMVOLFLG                                                 09436000
CMSCRVOL EQU   CMVOLFLG                                                 09437000
CMCECART EQU   CMVOLFLG                                                 09438000
CMOLDVOL EQU   CMMSG                                                    09439000
CCOLDCSN EQU   CCMSG+24                                                 09440000
CCNEWCSN EQU   CCMSG+12                                                 09441000
@NM00041 EQU   CCMSG+10                                                 09442000
CCVOL    EQU   CCMSG+4                                                  09443000
@NM00040 EQU   CCMSG+2                                                  09444000
CCEJCODE EQU   CCMSG+1                                                  09445000
CCPSTCDE EQU   CCMSG                                                    09446000
@NM00039 EQU   DMPARY+15                                                09447000
DMPARYTP EQU   DMPARY+14                                                09448000
DMPARYEX EQU   DMPARY+12                                                09449000
DMPARYIC EQU   DMPARY+10                                                09450000
DMPARYSZ EQU   DMPARY+8                                                 09451000
DMPARYNM EQU   DMPARY                                                   09452000
@NM00038 EQU   DMPITM+15                                                09453000
@NM00037 EQU   ERCNVTAB+24                                              09454000
ERDARBPT EQU   ERCPLPT                                                  09455000
ERDYNRC  EQU   ERCATRC                                                  09456000
ERDSNM   EQU   ERCNVTAB+12                                              09457000
@NM00036 EQU   ERCNVTAB+4                                               09458000
@NM00035 EQU   ERCNVTAB+3                                               09459000
@NM00034 EQU   EROSOPER                                                 09460000
EROSUCDX EQU   EROSOPER                                                 09461000
EROSCATL EQU   EROSOPER                                                 09462000
@NM00033 EQU   EROPER                                                   09463000
ERCATAL  EQU   EROPER                                                   09464000
ERCATDL  EQU   EROPER                                                   09465000
ERCATDE  EQU   EROPER                                                   09466000
ERCATLC  EQU   EROPER                                                   09467000
@NM00032 EQU   ERTYPE                                                   09468000
ERDYNAL  EQU   ERTYPE                                                   09469000
EROSCAT  EQU   ERTYPE                                                   09470000
ERCATLG  EQU   ERTYPE                                                   09471000
@NM00031 EQU   FMTCNVF+1                                                09472000
FMTAR    EQU   FMTCNVF+1                                                09473000
FMTBS    EQU   FMTCNVF+1                                                09474000
FMTSS    EQU   FMTCNVF+1                                                09475000
FMTAL    EQU   FMTCNVF+1                                                09476000
FMTZS    EQU   FMTCNVF+1                                                09477000
@NM00030 EQU   FMTCNVF                                                  09478000
FMTPU    EQU   FMTCNVF                                                  09479000
FMTBD    EQU   FMTCNVF                                                  09480000
FMTBHD   EQU   FMTCNVF                                                  09481000
FMTBHA   EQU   FMTCNVF                                                  09482000
FMTBH    EQU   FMTCNVF                                                  09483000
FMTOLEN  EQU   FMTLIST+8                                                09484000
FMTRIO   EQU   FMTOCOL                                                  09485000
FMTSPT   EQU   FMTSTO                                                   09486000
FMTSTL   EQU   FMTILEN                                                  09487000
@NM00029 EQU   FMTFLGS+1                                                09488000
FMTSMSG  EQU   FMTFLGS+1                                                09489000
FMTHDF   EQU   FMTFLGS                                                  09490000
FMTDFF   EQU   FMTFLGS                                                  09491000
FMTSTF   EQU   FMTFLGS                                                  09492000
FMTREPF  EQU   FMTFLGS                                                  09493000
FMTBDF   EQU   FMTFLGS                                                  09494000
FMTIDF   EQU   FMTFLGS                                                  09495000
FMTSCF   EQU   FMTFLGS                                                  09496000
FMTEOLF  EQU   FMTFLGS                                                  09497000
DARGPCT  EQU   DARGINL                                                  09498000
DARGREP  EQU   DARGINS                                                  09499000
@NM00028 EQU   DARGLIST+19                                              09500000
DARGIND  EQU   DARGLIST+18                                              09501000
UVOLVOL  EQU   UVOLENT+4                                                09502000
UVOLDEV  EQU   UVOLENT                                                  09503000
UVOLCNT  EQU   UVOLLIST                                                 09504000
@NM00027 EQU   IOINFOPT                                                 09505000
IOINFLUB EQU   IOINFOPT                                                 09506000
IOINFTMS EQU   IOINFOPT                                                 09507000
IOINFSUP EQU   IOINFOPT                                                 09508000
IOINFDSN EQU   IOINFOPT                                                 09509000
IOINFVOL EQU   IOINFOPT                                                 09510000
IOINFDVT EQU   IOINFOPT                                                 09511000
OPNVOL   EQU   OPNAGL+44                                                09512000
OPNSTRNO EQU   OPNAGL+43                                                09513000
@NM00026 EQU   OPNOPT2                                                  09514000
OPNOPTJM EQU   OPNOPT2                                                  09515000
@NM00025 EQU   OPNOPT2                                                  09516000
OPNOPTAS EQU   OPNOPT2                                                  09517000
@NM00024 EQU   OPNDSO                                                   09518000
OPNDSOPO EQU   OPNDSO                                                   09519000
OPNDSOIS EQU   OPNDSO                                                   09520000
OPNDSOPS EQU   OPNDSO                                                   09521000
OPNDSOAM EQU   OPNDSO                                                   09522000
OPNKYL   EQU   OPNAGL+40                                                09523000
OPNBLK   EQU   OPNAGL+36                                                09524000
OPNREC   EQU   OPNAGL+32                                                09525000
OPNDEVIX EQU   OPNDEV+4                                                 09526000
OPNDEVDT EQU   OPNDEV                                                   09527000
OPNCBP   EQU   OPNAGL+20                                                09528000
OPNDSN   EQU   OPNAGL+16                                                09529000
OPNPWA   EQU   OPNAGL+12                                                09530000
OPNDDN   EQU   OPNAGL+8                                                 09531000
OPNIOC   EQU   OPNAGL+4                                                 09532000
OPNMODRP EQU   OPNMOD                                                   09533000
OPNMODUB EQU   OPNMOD                                                   09534000
OPNMODRS EQU   OPNMOD                                                   09535000
OPNMODAX EQU   OPNMOD                                                   09536000
OPNMODRR EQU   OPNMOD                                                   09537000
OPNMODRC EQU   OPNMOD                                                   09538000
OPNMODAC EQU   OPNMOD                                                   09539000
OPNMODPD EQU   OPNMOD                                                   09540000
OPNTYPSY EQU   OPNTYP                                                   09541000
OPNTYPRV EQU   OPNTYP                                                   09542000
OPNTYPEX EQU   OPNTYP                                                   09543000
OPNTYPRA EQU   OPNTYP                                                   09544000
OPNTYPXM EQU   OPNTYP                                                   09545000
OPNTYPCI EQU   OPNTYP                                                   09546000
OPNTYPSO EQU   OPNTYP                                                   09547000
OPNTYPSI EQU   OPNTYP                                                   09548000
@NM00023 EQU   OPNRFM                                                   09549000
OPNRFMBK EQU   OPNRFM                                                   09550000
OPNRFMSF EQU   OPNRFM                                                   09551000
OPNRFMUN EQU   OPNRFM                                                   09552000
OPNRFMVR EQU   OPNRFM                                                   09553000
OPNRFMFX EQU   OPNRFM                                                   09554000
OPNOPTSK EQU   OPNOPT                                                   09555000
OPNOPTDR EQU   OPNOPT                                                   09556000
OPNOPTCR EQU   OPNOPT                                                   09557000
OPNOPTKS EQU   OPNOPT                                                   09558000
OPNOPTBK EQU   OPNOPT                                                   09559000
OPNOPTUP EQU   OPNOPT                                                   09560000
OPNOPTOT EQU   OPNOPT                                                   09561000
OPNOPTIN EQU   OPNOPT                                                   09562000
IOCEXT   EQU   IOCSTR+64                                                09563000
IOCTSML  EQU   IOCREL+2                                                 09564000
IOCTPML  EQU   IOCREL                                                   09565000
IOCWORK  EQU   IOCSTR+56                                                09566000
IOCRRN   EQU   IOCSTR+52                                                09567000
IOCPNM   EQU   IOCNWM+2                                                 09568000
IOCPTL   EQU   IOCNWM                                                   09569000
IOCKYA   EQU   IOCMEM                                                   09570000
IOCVRC   EQU   IOCTTR                                                   09571000
IOCCBP   EQU   IOCSTR+36                                                09572000
IOCDSN   EQU   IOCSTR+32                                                09573000
IOCHURBA EQU   IOCSTR+28                                                09574000
IOCVOLSR EQU   IOCSTR+22                                                09575000
@NM00022 EQU   IOCMSG                                                   09576000
IOCMSGSM EQU   IOCMSG                                                   09577000
IOCMSGAE EQU   IOCMSG                                                   09578000
IOCMSGCE EQU   IOCMSG                                                   09579000
IOCMSGOE EQU   IOCMSG                                                   09580000
IOCMSGOP EQU   IOCMSG                                                   09581000
IOCCHPKG EQU   IOCMSG                                                   09582000
IOCCHPKE EQU   IOCMSG                                                   09583000
IOCCHPNU EQU   IOCCHP                                                   09584000
IOCCHPUP EQU   IOCCHP                                                   09585000
IOCCHPBK EQU   IOCCHP                                                   09586000
IOCCHPCR EQU   IOCCHP                                                   09587000
IOCCHPKS EQU   IOCCHP                                                   09588000
IOCCHPSK EQU   IOCCHP                                                   09589000
IOCCHPDR EQU   IOCCHP                                                   09590000
IOCCHPSQ EQU   IOCCHP                                                   09591000
IOCMACNT EQU   IOCMAC2                                                  09592000
IOCMACER EQU   IOCMAC2                                                  09593000
IOCMACPA EQU   IOCMAC2                                                  09594000
IOCMACEN EQU   IOCMAC2                                                  09595000
IOCMACCP EQU   IOCMAC2                                                  09596000
IOCMACRR EQU   IOCMAC2                                                  09597000
IOCMACAS EQU   IOCMAC2                                                  09598000
IOCMACSK EQU   IOCMAC2                                                  09599000
@NM00021 EQU   IOCMAC                                                   09600000
IOCMACCC EQU   IOCMAC                                                   09601000
IOCMACDR EQU   IOCMAC                                                   09602000
IOCMACBK EQU   IOCMAC                                                   09603000
IOCMACCR EQU   IOCMAC                                                   09604000
IOCMACUP EQU   IOCMAC                                                   09605000
IOCMACOT EQU   IOCMAC                                                   09606000
IOCMACIN EQU   IOCMAC                                                   09607000
@NM00020 EQU   IOCRFM                                                   09608000
IOCRFMBK EQU   IOCRFM                                                   09609000
IOCRFMSF EQU   IOCRFM                                                   09610000
IOCRFMUN EQU   IOCRFM                                                   09611000
IOCRFMVR EQU   IOCRFM                                                   09612000
IOCRFMFX EQU   IOCRFM                                                   09613000
@NM00019 EQU   IOCDSO                                                   09614000
IOCDSOPO EQU   IOCDSO                                                   09615000
IOCDSOIS EQU   IOCDSO                                                   09616000
IOCDSOPS EQU   IOCDSO                                                   09617000
IOCDSOAM EQU   IOCDSO                                                   09618000
IOCRKP   EQU   IOCSTR+13                                                09619000
IOCKYL   EQU   IOCSTR+12                                                09620000
IOCTRN   EQU   IOCSTR+8                                                 09621000
IOCDLN   EQU   IOCSTR+4                                                 09622000
IOCDAD   EQU   IOCSTR                                                   09623000
UNITVTOC EQU   UNITABL+7                                                09624000
@NM00018 EQU   UNITSTAT                                                 09625000
UNITUSHR EQU   UNITSTAT                                                 09626000
UNITXSHR EQU   UNITSTAT                                                 09627000
UNITISHR EQU   UNITSTAT                                                 09628000
UNITUA   EQU   @NM00017+1                                               09629000
UNITCHA  EQU   @NM00017                                                 09630000
UNITUCB  EQU   UNITABL                                                  09631000
RACFVOLS EQU   RACFAGL+16                                               09632000
RACFCLN  EQU   RACFAGL+12                                               09633000
RACFPROF EQU   RACFAGL+8                                                09634000
RACFENT  EQU   RACFAGL+4                                                09635000
@NM00016 EQU   RACFFLG4                                                 09636000
@NM00015 EQU   RACFFLG3                                                 09637000
RACFPRF  EQU   RACFFLG3                                                 09638000
@NM00014 EQU   RACFFLG3                                                 09639000
@NM00013 EQU   RACFFLG2                                                 09640000
RACFTRD  EQU   RACFFLG2                                                 09641000
RACFTUPD EQU   RACFFLG2                                                 09642000
RACFTCTL EQU   RACFFLG2                                                 09643000
@NM00012 EQU   RACFFLG2                                                 09644000
RACFTALT EQU   RACFFLG2                                                 09645000
RACFCSA  EQU   RACFFLG1                                                 09646000
RACFLOGN EQU   RACFFLG1                                                 09647000
RACFLOGF EQU   RACFFLG1                                                 09648000
@NM00011 EQU   RACFFLG1                                                 09649000
RACFDSTV EQU   RACFFLG1                                                 09650000
@NM00010 EQU   RACFFLG1                                                 09651000
@NM00009 EQU   ALLOPT                                                   09652000
ALLOPTUN EQU   ALLOPT                                                   09653000
ALLOPTDS EQU   ALLOPT                                                   09654000
@NM00008 EQU   ALLORG+1                                                 09655000
ALLORGVS EQU   ALLORG+1                                                 09656000
@NM00007 EQU   ALLORG+1                                                 09657000
ALLORGGS EQU   ALLORG+1                                                 09658000
ALLORGUN EQU   ALLORG                                                   09659000
ALLORGPO EQU   ALLORG                                                   09660000
ALLORGMQ EQU   ALLORG                                                   09661000
ALLORGCQ EQU   ALLORG                                                   09662000
ALLORGCX EQU   ALLORG                                                   09663000
ALLORGDA EQU   ALLORG                                                   09664000
ALLORGPS EQU   ALLORG                                                   09665000
ALLORGIS EQU   ALLORG                                                   09666000
ALLDSPUN EQU   ALLDSP                                                   09667000
ALLDSPCG EQU   ALLDSP                                                   09668000
ALLDSPDE EQU   ALLDSP                                                   09669000
ALLDSPKP EQU   ALLDSP                                                   09670000
@NM00006 EQU   ALLDSP                                                   09671000
ALLSTSOD EQU   ALLSTS                                                   09672000
ALLSTSMD EQU   ALLSTS                                                   09673000
ALLSTSNW EQU   ALLSTS                                                   09674000
ALLSTSSR EQU   ALLSTS                                                   09675000
@NM00005 EQU   ALLSTS                                                   09676000
ALLPWD   EQU   ALLAGL+20                                                09677000
ALLDSN   EQU   ALLAGL                                                   09678000
CIRPID   EQU   CIRAGL+28                                                09679000
CIRPWD   EQU   CIRAGL+24                                                09680000
CIRCAT   EQU   CIRAGL+20                                                09681000
CIRWKP   EQU   CIRAGL+16                                                09682000
CIRTLR   EQU   CIRAGL+12                                                09683000
CIRHDR   EQU   CIRAGL+8                                                 09684000
CIRTLN   EQU   CIRAGL+6                                                 09685000
CIRHLN   EQU   CIRAGL+4                                                 09686000
@NM00004 EQU   CIRAGL+1                                                 09687000
@NM00003 EQU   CIRTYPE                                                  09688000
CIRTYPAQ EQU   CIRTYPE                                                  09689000
CIRTYP1Q EQU   CIRTYPE                                                  09690000
NEWID1   EQU   TRACE1+95                                                09691000
CALLID   EQU   OLDERID1+90                                              09692000
@NM00002 EQU   OLDERID1                                                 09693000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09694000
@RF00628 EQU   @RC00618                                                 09695000
@RF00768 EQU   @RC00765                                                 09696000
@RF00938 EQU   @RC00935                                                 09697000
@RF01410 EQU   @RC01402                                                 09698000
@RF01468 EQU   @RC01460                                                 09699000
@RF01719 EQU   @RC01704                                                 09700000
@PB00025 EQU   @EL00001                                                 09701000
@PB00024 EQU   @PB00025                                                 09702000
@PB00023 EQU   @PB00024                                                 09703000
@PB00022 EQU   @PB00023                                                 09704000
@PB00021 EQU   @PB00022                                                 09705000
@PB00020 EQU   @PB00021                                                 09706000
@PB00019 EQU   @PB00020                                                 09707000
@PB00018 EQU   @PB00019                                                 09708000
@PB00017 EQU   @PB00018                                                 09709000
@PB00016 EQU   @PB00017                                                 09710000
@PB00015 EQU   @PB00016                                                 09711000
@PB00014 EQU   @PB00015                                                 09712000
@PB00013 EQU   @PB00014                                                 09713000
@PB00012 EQU   @PB00013                                                 09714000
@PB00011 EQU   @PB00012                                                 09715000
@PB00010 EQU   @PB00011                                                 09716000
@PB00009 EQU   @PB00010                                                 09717000
@PB00008 EQU   @PB00009                                                 09718000
@PB00007 EQU   @PB00008                                                 09719000
@PB00006 EQU   @PB00007                                                 09720000
@PB00005 EQU   @PB00006                                                 09721000
@PB00004 EQU   @PB00005                                                 09722000
@PB00003 EQU   @PB00004                                                 09723000
@PB00002 EQU   @PB00003                                                 09724000
@ENDDATA EQU   *                                                        09725000
         END   IDCMV01,(C'PLS2303',0603,76349)                          09726000
